<!doctype html>
<html lang="es">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <!-- Metas de branding que la Agenda lee -->
    <meta name="company-name" content="Mi Empresa S.A.S" />
    <meta name="company-logo" content="/assets/logo-empresa.png" />
    <meta name="software-footer" content="Generado por OdontoCloud" />

    <title>OdontoCloud</title>

    <!-- üëá Sincroniza metas con localStorage: empresa_nombre / empresa_logo_url / software_footer_text -->
    <script>
      (function syncBrandingMeta() {
        function ensureMeta(name, value) {
          var m = document.querySelector('meta[name="' + name + '"]');
          if (!m) {
            m = document.createElement('meta');
            m.setAttribute('name', name);
            document.head.appendChild(m);
          }
          if (value != null && value !== '') m.setAttribute('content', value);
        }
        try {
          var nombre  = localStorage.getItem('empresa_nombre');
          var logo    = localStorage.getItem('empresa_logo_url');
          var footer  = localStorage.getItem('software_footer_text');

          // Si en localStorage hay valores, pisan a las metas por defecto.
          ensureMeta('company-name',   nombre || document.querySelector('meta[name="company-name"]')?.content || 'OdontoCloud');
          ensureMeta('company-logo',   logo   || document.querySelector('meta[name="company-logo"]')?.content   || '');
          ensureMeta('software-footer',footer || document.querySelector('meta[name="software-footer"]')?.content|| 'Generado por OdontoCloud');
        } catch (e) {
          console.warn('No fue posible sincronizar branding desde localStorage:', e);
        }

        // si cambian el branding en otra pesta√±a, reflejarlo aqu√≠ tambi√©n
        window.addEventListener('storage', function(ev){
          if (!ev || !ev.key) return;
          if (ev.key === 'empresa_nombre' || ev.key === 'empresa_logo_url' || ev.key === 'software_footer_text') {
            try { syncBrandingMeta(); } catch(_) {}
          }
        });
      })();
    </script>

    <!-- üëá Paso 2 del fallback SPA (rafgraph): reescribe URLs "fantasma" -->
    <script>
      (function(l) {
        if (l.search[1] === '/') {
          const decoded = l.search.slice(1).split('&').map(s => s.replace(/~and~/g, '&')).join('?');
          const url = l.pathname.slice(0, -1) + decoded + l.hash;
          window.history.replaceState(null, null, url);
        }
      })(window.location);
    </script>

    <!-- ‚úÖ Librer√≠a XLSX (para exportar a Excel sin instalar nada) -->
    <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
    <script type="module" crossorigin src="/odontocloud-react/assets/index-hymOsl2I.js"></script>
    <link rel="stylesheet" crossorigin href="/odontocloud-react/assets/index-DsIqMYSk.css">
  <link rel="manifest" href="/odontocloud-react/manifest.webmanifest"></head>

  <body>
    <div id="root"></div>
  </body>
</html>
