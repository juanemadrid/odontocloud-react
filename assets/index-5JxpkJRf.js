(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();function oR(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var dT={exports:{}},ch={},hT={exports:{}},ke={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var vc=Symbol.for("react.element"),aR=Symbol.for("react.portal"),lR=Symbol.for("react.fragment"),cR=Symbol.for("react.strict_mode"),uR=Symbol.for("react.profiler"),dR=Symbol.for("react.provider"),hR=Symbol.for("react.context"),fR=Symbol.for("react.forward_ref"),pR=Symbol.for("react.suspense"),mR=Symbol.for("react.memo"),gR=Symbol.for("react.lazy"),_v=Symbol.iterator;function yR(t){return t===null||typeof t!="object"?null:(t=_v&&t[_v]||t["@@iterator"],typeof t=="function"?t:null)}var fT={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},pT=Object.assign,mT={};function Ta(t,e,n){this.props=t,this.context=e,this.refs=mT,this.updater=n||fT}Ta.prototype.isReactComponent={};Ta.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Ta.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function gT(){}gT.prototype=Ta.prototype;function ag(t,e,n){this.props=t,this.context=e,this.refs=mT,this.updater=n||fT}var lg=ag.prototype=new gT;lg.constructor=ag;pT(lg,Ta.prototype);lg.isPureReactComponent=!0;var vv=Array.isArray,yT=Object.prototype.hasOwnProperty,cg={current:null},_T={key:!0,ref:!0,__self:!0,__source:!0};function vT(t,e,n){var r,s={},i=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(i=""+e.key),e)yT.call(e,r)&&!_T.hasOwnProperty(r)&&(s[r]=e[r]);var a=arguments.length-2;if(a===1)s.children=n;else if(1<a){for(var l=Array(a),d=0;d<a;d++)l[d]=arguments[d+2];s.children=l}if(t&&t.defaultProps)for(r in a=t.defaultProps,a)s[r]===void 0&&(s[r]=a[r]);return{$$typeof:vc,type:t,key:i,ref:o,props:s,_owner:cg.current}}function _R(t,e){return{$$typeof:vc,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function ug(t){return typeof t=="object"&&t!==null&&t.$$typeof===vc}function vR(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var wv=/\/+/g;function Pf(t,e){return typeof t=="object"&&t!==null&&t.key!=null?vR(""+t.key):e.toString(36)}function Pu(t,e,n,r,s){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case vc:case aR:o=!0}}if(o)return o=t,s=s(o),t=r===""?"."+Pf(o,0):r,vv(s)?(n="",t!=null&&(n=t.replace(wv,"$&/")+"/"),Pu(s,e,n,"",function(d){return d})):s!=null&&(ug(s)&&(s=_R(s,n+(!s.key||o&&o.key===s.key?"":(""+s.key).replace(wv,"$&/")+"/")+t)),e.push(s)),1;if(o=0,r=r===""?".":r+":",vv(t))for(var a=0;a<t.length;a++){i=t[a];var l=r+Pf(i,a);o+=Pu(i,e,n,l,s)}else if(l=yR(t),typeof l=="function")for(t=l.call(t),a=0;!(i=t.next()).done;)i=i.value,l=r+Pf(i,a++),o+=Pu(i,e,n,l,s);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function Zc(t,e,n){if(t==null)return t;var r=[],s=0;return Pu(t,r,"","",function(i){return e.call(n,i,s++)}),r}function wR(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var yn={current:null},Nu={transition:null},ER={ReactCurrentDispatcher:yn,ReactCurrentBatchConfig:Nu,ReactCurrentOwner:cg};function wT(){throw Error("act(...) is not supported in production builds of React.")}ke.Children={map:Zc,forEach:function(t,e,n){Zc(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return Zc(t,function(){e++}),e},toArray:function(t){return Zc(t,function(e){return e})||[]},only:function(t){if(!ug(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};ke.Component=Ta;ke.Fragment=lR;ke.Profiler=uR;ke.PureComponent=ag;ke.StrictMode=cR;ke.Suspense=pR;ke.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ER;ke.act=wT;ke.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=pT({},t.props),s=t.key,i=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,o=cg.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(l in e)yT.call(e,l)&&!_T.hasOwnProperty(l)&&(r[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)r.children=n;else if(1<l){a=Array(l);for(var d=0;d<l;d++)a[d]=arguments[d+2];r.children=a}return{$$typeof:vc,type:t.type,key:s,ref:i,props:r,_owner:o}};ke.createContext=function(t){return t={$$typeof:hR,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:dR,_context:t},t.Consumer=t};ke.createElement=vT;ke.createFactory=function(t){var e=vT.bind(null,t);return e.type=t,e};ke.createRef=function(){return{current:null}};ke.forwardRef=function(t){return{$$typeof:fR,render:t}};ke.isValidElement=ug;ke.lazy=function(t){return{$$typeof:gR,_payload:{_status:-1,_result:t},_init:wR}};ke.memo=function(t,e){return{$$typeof:mR,type:t,compare:e===void 0?null:e}};ke.startTransition=function(t){var e=Nu.transition;Nu.transition={};try{t()}finally{Nu.transition=e}};ke.unstable_act=wT;ke.useCallback=function(t,e){return yn.current.useCallback(t,e)};ke.useContext=function(t){return yn.current.useContext(t)};ke.useDebugValue=function(){};ke.useDeferredValue=function(t){return yn.current.useDeferredValue(t)};ke.useEffect=function(t,e){return yn.current.useEffect(t,e)};ke.useId=function(){return yn.current.useId()};ke.useImperativeHandle=function(t,e,n){return yn.current.useImperativeHandle(t,e,n)};ke.useInsertionEffect=function(t,e){return yn.current.useInsertionEffect(t,e)};ke.useLayoutEffect=function(t,e){return yn.current.useLayoutEffect(t,e)};ke.useMemo=function(t,e){return yn.current.useMemo(t,e)};ke.useReducer=function(t,e,n){return yn.current.useReducer(t,e,n)};ke.useRef=function(t){return yn.current.useRef(t)};ke.useState=function(t){return yn.current.useState(t)};ke.useSyncExternalStore=function(t,e,n){return yn.current.useSyncExternalStore(t,e,n)};ke.useTransition=function(){return yn.current.useTransition()};ke.version="18.3.1";hT.exports=ke;var N=hT.exports;const ET=oR(N);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var IR=N,TR=Symbol.for("react.element"),xR=Symbol.for("react.fragment"),SR=Object.prototype.hasOwnProperty,bR=IR.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,CR={key:!0,ref:!0,__self:!0,__source:!0};function IT(t,e,n){var r,s={},i=null,o=null;n!==void 0&&(i=""+n),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)SR.call(e,r)&&!CR.hasOwnProperty(r)&&(s[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)s[r]===void 0&&(s[r]=e[r]);return{$$typeof:TR,type:t,key:i,ref:o,props:s,_owner:bR.current}}ch.Fragment=xR;ch.jsx=IT;ch.jsxs=IT;dT.exports=ch;var u=dT.exports,TT={exports:{}},Ln={},xT={exports:{}},ST={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(Y,ce){var me=Y.length;Y.push(ce);e:for(;0<me;){var Oe=me-1>>>1,He=Y[Oe];if(0<s(He,ce))Y[Oe]=ce,Y[me]=He,me=Oe;else break e}}function n(Y){return Y.length===0?null:Y[0]}function r(Y){if(Y.length===0)return null;var ce=Y[0],me=Y.pop();if(me!==ce){Y[0]=me;e:for(var Oe=0,He=Y.length,z=He>>>1;Oe<z;){var Z=2*(Oe+1)-1,ae=Y[Z],we=Z+1,Ie=Y[we];if(0>s(ae,me))we<He&&0>s(Ie,ae)?(Y[Oe]=Ie,Y[we]=me,Oe=we):(Y[Oe]=ae,Y[Z]=me,Oe=Z);else if(we<He&&0>s(Ie,me))Y[Oe]=Ie,Y[we]=me,Oe=we;else break e}}return ce}function s(Y,ce){var me=Y.sortIndex-ce.sortIndex;return me!==0?me:Y.id-ce.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var l=[],d=[],h=1,f=null,m=3,w=!1,A=!1,b=!1,P=typeof setTimeout=="function"?setTimeout:null,I=typeof clearTimeout=="function"?clearTimeout:null,E=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function y(Y){for(var ce=n(d);ce!==null;){if(ce.callback===null)r(d);else if(ce.startTime<=Y)r(d),ce.sortIndex=ce.expirationTime,e(l,ce);else break;ce=n(d)}}function j(Y){if(b=!1,y(Y),!A)if(n(l)!==null)A=!0,Mt(V);else{var ce=n(d);ce!==null&&he(j,ce.startTime-Y)}}function V(Y,ce){A=!1,b&&(b=!1,I(_),_=-1),w=!0;var me=m;try{for(y(ce),f=n(l);f!==null&&(!(f.expirationTime>ce)||Y&&!k());){var Oe=f.callback;if(typeof Oe=="function"){f.callback=null,m=f.priorityLevel;var He=Oe(f.expirationTime<=ce);ce=t.unstable_now(),typeof He=="function"?f.callback=He:f===n(l)&&r(l),y(ce)}else r(l);f=n(l)}if(f!==null)var z=!0;else{var Z=n(d);Z!==null&&he(j,Z.startTime-ce),z=!1}return z}finally{f=null,m=me,w=!1}}var M=!1,T=null,_=-1,S=5,C=-1;function k(){return!(t.unstable_now()-C<S)}function D(){if(T!==null){var Y=t.unstable_now();C=Y;var ce=!0;try{ce=T(!0,Y)}finally{ce?R():(M=!1,T=null)}}else M=!1}var R;if(typeof E=="function")R=function(){E(D)};else if(typeof MessageChannel<"u"){var K=new MessageChannel,Ze=K.port2;K.port1.onmessage=D,R=function(){Ze.postMessage(null)}}else R=function(){P(D,0)};function Mt(Y){T=Y,M||(M=!0,R())}function he(Y,ce){_=P(function(){Y(t.unstable_now())},ce)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(Y){Y.callback=null},t.unstable_continueExecution=function(){A||w||(A=!0,Mt(V))},t.unstable_forceFrameRate=function(Y){0>Y||125<Y?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):S=0<Y?Math.floor(1e3/Y):5},t.unstable_getCurrentPriorityLevel=function(){return m},t.unstable_getFirstCallbackNode=function(){return n(l)},t.unstable_next=function(Y){switch(m){case 1:case 2:case 3:var ce=3;break;default:ce=m}var me=m;m=ce;try{return Y()}finally{m=me}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(Y,ce){switch(Y){case 1:case 2:case 3:case 4:case 5:break;default:Y=3}var me=m;m=Y;try{return ce()}finally{m=me}},t.unstable_scheduleCallback=function(Y,ce,me){var Oe=t.unstable_now();switch(typeof me=="object"&&me!==null?(me=me.delay,me=typeof me=="number"&&0<me?Oe+me:Oe):me=Oe,Y){case 1:var He=-1;break;case 2:He=250;break;case 5:He=1073741823;break;case 4:He=1e4;break;default:He=5e3}return He=me+He,Y={id:h++,callback:ce,priorityLevel:Y,startTime:me,expirationTime:He,sortIndex:-1},me>Oe?(Y.sortIndex=me,e(d,Y),n(l)===null&&Y===n(d)&&(b?(I(_),_=-1):b=!0,he(j,me-Oe))):(Y.sortIndex=He,e(l,Y),A||w||(A=!0,Mt(V))),Y},t.unstable_shouldYield=k,t.unstable_wrapCallback=function(Y){var ce=m;return function(){var me=m;m=ce;try{return Y.apply(this,arguments)}finally{m=me}}}})(ST);xT.exports=ST;var AR=xT.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var RR=N,On=AR;function H(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var bT=new Set,$l={};function to(t,e){na(t,e),na(t+"Capture",e)}function na(t,e){for($l[t]=e,t=0;t<e.length;t++)bT.add(e[t])}var Hr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Np=Object.prototype.hasOwnProperty,PR=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Ev={},Iv={};function NR(t){return Np.call(Iv,t)?!0:Np.call(Ev,t)?!1:PR.test(t)?Iv[t]=!0:(Ev[t]=!0,!1)}function kR(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function DR(t,e,n,r){if(e===null||typeof e>"u"||kR(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function _n(t,e,n,r,s,i,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=o}var Xt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Xt[t]=new _n(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Xt[e]=new _n(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Xt[t]=new _n(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Xt[t]=new _n(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Xt[t]=new _n(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Xt[t]=new _n(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Xt[t]=new _n(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Xt[t]=new _n(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Xt[t]=new _n(t,5,!1,t.toLowerCase(),null,!1,!1)});var dg=/[\-:]([a-z])/g;function hg(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(dg,hg);Xt[e]=new _n(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(dg,hg);Xt[e]=new _n(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(dg,hg);Xt[e]=new _n(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Xt[t]=new _n(t,1,!1,t.toLowerCase(),null,!1,!1)});Xt.xlinkHref=new _n("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Xt[t]=new _n(t,1,!1,t.toLowerCase(),null,!0,!0)});function fg(t,e,n,r){var s=Xt.hasOwnProperty(e)?Xt[e]:null;(s!==null?s.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(DR(e,n,s,r)&&(n=null),r||s===null?NR(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):s.mustUseProperty?t[s.propertyName]=n===null?s.type===3?!1:"":n:(e=s.attributeName,r=s.attributeNamespace,n===null?t.removeAttribute(e):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var ts=RR.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,eu=Symbol.for("react.element"),Ro=Symbol.for("react.portal"),Po=Symbol.for("react.fragment"),pg=Symbol.for("react.strict_mode"),kp=Symbol.for("react.profiler"),CT=Symbol.for("react.provider"),AT=Symbol.for("react.context"),mg=Symbol.for("react.forward_ref"),Dp=Symbol.for("react.suspense"),jp=Symbol.for("react.suspense_list"),gg=Symbol.for("react.memo"),ys=Symbol.for("react.lazy"),RT=Symbol.for("react.offscreen"),Tv=Symbol.iterator;function Ka(t){return t===null||typeof t!="object"?null:(t=Tv&&t[Tv]||t["@@iterator"],typeof t=="function"?t:null)}var yt=Object.assign,Nf;function cl(t){if(Nf===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);Nf=e&&e[1]||""}return`
`+Nf+t}var kf=!1;function Df(t,e){if(!t||kf)return"";kf=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(d){var r=d}Reflect.construct(t,[],e)}else{try{e.call()}catch(d){r=d}t.call(e.prototype)}else{try{throw Error()}catch(d){r=d}t()}}catch(d){if(d&&r&&typeof d.stack=="string"){for(var s=d.stack.split(`
`),i=r.stack.split(`
`),o=s.length-1,a=i.length-1;1<=o&&0<=a&&s[o]!==i[a];)a--;for(;1<=o&&0<=a;o--,a--)if(s[o]!==i[a]){if(o!==1||a!==1)do if(o--,a--,0>a||s[o]!==i[a]){var l=`
`+s[o].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=o&&0<=a);break}}}finally{kf=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?cl(t):""}function jR(t){switch(t.tag){case 5:return cl(t.type);case 16:return cl("Lazy");case 13:return cl("Suspense");case 19:return cl("SuspenseList");case 0:case 2:case 15:return t=Df(t.type,!1),t;case 11:return t=Df(t.type.render,!1),t;case 1:return t=Df(t.type,!0),t;default:return""}}function Op(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Po:return"Fragment";case Ro:return"Portal";case kp:return"Profiler";case pg:return"StrictMode";case Dp:return"Suspense";case jp:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case AT:return(t.displayName||"Context")+".Consumer";case CT:return(t._context.displayName||"Context")+".Provider";case mg:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case gg:return e=t.displayName||null,e!==null?e:Op(t.type)||"Memo";case ys:e=t._payload,t=t._init;try{return Op(t(e))}catch{}}return null}function OR(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Op(e);case 8:return e===pg?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Hs(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function PT(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function VR(t){var e=PT(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,i=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(o){r=""+o,i.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function tu(t){t._valueTracker||(t._valueTracker=VR(t))}function NT(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=PT(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function od(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Vp(t,e){var n=e.checked;return yt({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function xv(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=Hs(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function kT(t,e){e=e.checked,e!=null&&fg(t,"checked",e,!1)}function Lp(t,e){kT(t,e);var n=Hs(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Mp(t,e.type,n):e.hasOwnProperty("defaultValue")&&Mp(t,e.type,Hs(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function Sv(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function Mp(t,e,n){(e!=="number"||od(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var ul=Array.isArray;function Bo(t,e,n,r){if(t=t.options,e){e={};for(var s=0;s<n.length;s++)e["$"+n[s]]=!0;for(n=0;n<t.length;n++)s=e.hasOwnProperty("$"+t[n].value),t[n].selected!==s&&(t[n].selected=s),s&&r&&(t[n].defaultSelected=!0)}else{for(n=""+Hs(n),e=null,s=0;s<t.length;s++){if(t[s].value===n){t[s].selected=!0,r&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function Fp(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(H(91));return yt({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function bv(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(H(92));if(ul(n)){if(1<n.length)throw Error(H(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Hs(n)}}function DT(t,e){var n=Hs(e.value),r=Hs(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function Cv(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function jT(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Up(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?jT(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var nu,OT=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,s){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(nu=nu||document.createElement("div"),nu.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=nu.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Bl(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var Il={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},LR=["Webkit","ms","Moz","O"];Object.keys(Il).forEach(function(t){LR.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Il[e]=Il[t]})});function VT(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||Il.hasOwnProperty(t)&&Il[t]?(""+e).trim():e+"px"}function LT(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=VT(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,s):t[n]=s}}var MR=yt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function $p(t,e){if(e){if(MR[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(H(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(H(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(H(61))}if(e.style!=null&&typeof e.style!="object")throw Error(H(62))}}function Bp(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var zp=null;function yg(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var qp=null,zo=null,qo=null;function Av(t){if(t=Ic(t)){if(typeof qp!="function")throw Error(H(280));var e=t.stateNode;e&&(e=ph(e),qp(t.stateNode,t.type,e))}}function MT(t){zo?qo?qo.push(t):qo=[t]:zo=t}function FT(){if(zo){var t=zo,e=qo;if(qo=zo=null,Av(t),e)for(t=0;t<e.length;t++)Av(e[t])}}function UT(t,e){return t(e)}function $T(){}var jf=!1;function BT(t,e,n){if(jf)return t(e,n);jf=!0;try{return UT(t,e,n)}finally{jf=!1,(zo!==null||qo!==null)&&($T(),FT())}}function zl(t,e){var n=t.stateNode;if(n===null)return null;var r=ph(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(H(231,e,typeof n));return n}var Hp=!1;if(Hr)try{var Ga={};Object.defineProperty(Ga,"passive",{get:function(){Hp=!0}}),window.addEventListener("test",Ga,Ga),window.removeEventListener("test",Ga,Ga)}catch{Hp=!1}function FR(t,e,n,r,s,i,o,a,l){var d=Array.prototype.slice.call(arguments,3);try{e.apply(n,d)}catch(h){this.onError(h)}}var Tl=!1,ad=null,ld=!1,Wp=null,UR={onError:function(t){Tl=!0,ad=t}};function $R(t,e,n,r,s,i,o,a,l){Tl=!1,ad=null,FR.apply(UR,arguments)}function BR(t,e,n,r,s,i,o,a,l){if($R.apply(this,arguments),Tl){if(Tl){var d=ad;Tl=!1,ad=null}else throw Error(H(198));ld||(ld=!0,Wp=d)}}function no(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function zT(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function Rv(t){if(no(t)!==t)throw Error(H(188))}function zR(t){var e=t.alternate;if(!e){if(e=no(t),e===null)throw Error(H(188));return e!==t?null:t}for(var n=t,r=e;;){var s=n.return;if(s===null)break;var i=s.alternate;if(i===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===n)return Rv(s),t;if(i===r)return Rv(s),e;i=i.sibling}throw Error(H(188))}if(n.return!==r.return)n=s,r=i;else{for(var o=!1,a=s.child;a;){if(a===n){o=!0,n=s,r=i;break}if(a===r){o=!0,r=s,n=i;break}a=a.sibling}if(!o){for(a=i.child;a;){if(a===n){o=!0,n=i,r=s;break}if(a===r){o=!0,r=i,n=s;break}a=a.sibling}if(!o)throw Error(H(189))}}if(n.alternate!==r)throw Error(H(190))}if(n.tag!==3)throw Error(H(188));return n.stateNode.current===n?t:e}function qT(t){return t=zR(t),t!==null?HT(t):null}function HT(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=HT(t);if(e!==null)return e;t=t.sibling}return null}var WT=On.unstable_scheduleCallback,Pv=On.unstable_cancelCallback,qR=On.unstable_shouldYield,HR=On.unstable_requestPaint,St=On.unstable_now,WR=On.unstable_getCurrentPriorityLevel,_g=On.unstable_ImmediatePriority,KT=On.unstable_UserBlockingPriority,cd=On.unstable_NormalPriority,KR=On.unstable_LowPriority,GT=On.unstable_IdlePriority,uh=null,Ar=null;function GR(t){if(Ar&&typeof Ar.onCommitFiberRoot=="function")try{Ar.onCommitFiberRoot(uh,t,void 0,(t.current.flags&128)===128)}catch{}}var or=Math.clz32?Math.clz32:XR,QR=Math.log,YR=Math.LN2;function XR(t){return t>>>=0,t===0?32:31-(QR(t)/YR|0)|0}var ru=64,su=4194304;function dl(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function ud(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,s=t.suspendedLanes,i=t.pingedLanes,o=n&268435455;if(o!==0){var a=o&~s;a!==0?r=dl(a):(i&=o,i!==0&&(r=dl(i)))}else o=n&~s,o!==0?r=dl(o):i!==0&&(r=dl(i));if(r===0)return 0;if(e!==0&&e!==r&&!(e&s)&&(s=r&-r,i=e&-e,s>=i||s===16&&(i&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-or(e),s=1<<n,r|=t[n],e&=~s;return r}function JR(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function ZR(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,s=t.expirationTimes,i=t.pendingLanes;0<i;){var o=31-or(i),a=1<<o,l=s[o];l===-1?(!(a&n)||a&r)&&(s[o]=JR(a,e)):l<=e&&(t.expiredLanes|=a),i&=~a}}function Kp(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function QT(){var t=ru;return ru<<=1,!(ru&4194240)&&(ru=64),t}function Of(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function wc(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-or(e),t[e]=n}function eP(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var s=31-or(n),i=1<<s;e[s]=0,r[s]=-1,t[s]=-1,n&=~i}}function vg(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-or(n),s=1<<r;s&e|t[r]&e&&(t[r]|=e),n&=~s}}var Xe=0;function YT(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var XT,wg,JT,ZT,e0,Gp=!1,iu=[],Ns=null,ks=null,Ds=null,ql=new Map,Hl=new Map,vs=[],tP="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Nv(t,e){switch(t){case"focusin":case"focusout":Ns=null;break;case"dragenter":case"dragleave":ks=null;break;case"mouseover":case"mouseout":Ds=null;break;case"pointerover":case"pointerout":ql.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Hl.delete(e.pointerId)}}function Qa(t,e,n,r,s,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[s]},e!==null&&(e=Ic(e),e!==null&&wg(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function nP(t,e,n,r,s){switch(e){case"focusin":return Ns=Qa(Ns,t,e,n,r,s),!0;case"dragenter":return ks=Qa(ks,t,e,n,r,s),!0;case"mouseover":return Ds=Qa(Ds,t,e,n,r,s),!0;case"pointerover":var i=s.pointerId;return ql.set(i,Qa(ql.get(i)||null,t,e,n,r,s)),!0;case"gotpointercapture":return i=s.pointerId,Hl.set(i,Qa(Hl.get(i)||null,t,e,n,r,s)),!0}return!1}function t0(t){var e=Ti(t.target);if(e!==null){var n=no(e);if(n!==null){if(e=n.tag,e===13){if(e=zT(n),e!==null){t.blockedOn=e,e0(t.priority,function(){JT(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function ku(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=Qp(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);zp=r,n.target.dispatchEvent(r),zp=null}else return e=Ic(n),e!==null&&wg(e),t.blockedOn=n,!1;e.shift()}return!0}function kv(t,e,n){ku(t)&&n.delete(e)}function rP(){Gp=!1,Ns!==null&&ku(Ns)&&(Ns=null),ks!==null&&ku(ks)&&(ks=null),Ds!==null&&ku(Ds)&&(Ds=null),ql.forEach(kv),Hl.forEach(kv)}function Ya(t,e){t.blockedOn===e&&(t.blockedOn=null,Gp||(Gp=!0,On.unstable_scheduleCallback(On.unstable_NormalPriority,rP)))}function Wl(t){function e(s){return Ya(s,t)}if(0<iu.length){Ya(iu[0],t);for(var n=1;n<iu.length;n++){var r=iu[n];r.blockedOn===t&&(r.blockedOn=null)}}for(Ns!==null&&Ya(Ns,t),ks!==null&&Ya(ks,t),Ds!==null&&Ya(Ds,t),ql.forEach(e),Hl.forEach(e),n=0;n<vs.length;n++)r=vs[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<vs.length&&(n=vs[0],n.blockedOn===null);)t0(n),n.blockedOn===null&&vs.shift()}var Ho=ts.ReactCurrentBatchConfig,dd=!0;function sP(t,e,n,r){var s=Xe,i=Ho.transition;Ho.transition=null;try{Xe=1,Eg(t,e,n,r)}finally{Xe=s,Ho.transition=i}}function iP(t,e,n,r){var s=Xe,i=Ho.transition;Ho.transition=null;try{Xe=4,Eg(t,e,n,r)}finally{Xe=s,Ho.transition=i}}function Eg(t,e,n,r){if(dd){var s=Qp(t,e,n,r);if(s===null)Hf(t,e,r,hd,n),Nv(t,r);else if(nP(s,t,e,n,r))r.stopPropagation();else if(Nv(t,r),e&4&&-1<tP.indexOf(t)){for(;s!==null;){var i=Ic(s);if(i!==null&&XT(i),i=Qp(t,e,n,r),i===null&&Hf(t,e,r,hd,n),i===s)break;s=i}s!==null&&r.stopPropagation()}else Hf(t,e,r,null,n)}}var hd=null;function Qp(t,e,n,r){if(hd=null,t=yg(r),t=Ti(t),t!==null)if(e=no(t),e===null)t=null;else if(n=e.tag,n===13){if(t=zT(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return hd=t,null}function n0(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(WR()){case _g:return 1;case KT:return 4;case cd:case KR:return 16;case GT:return 536870912;default:return 16}default:return 16}}var As=null,Ig=null,Du=null;function r0(){if(Du)return Du;var t,e=Ig,n=e.length,r,s="value"in As?As.value:As.textContent,i=s.length;for(t=0;t<n&&e[t]===s[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===s[i-r];r++);return Du=s.slice(t,1<r?1-r:void 0)}function ju(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function ou(){return!0}function Dv(){return!1}function Mn(t){function e(n,r,s,i,o){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(n=t[a],this[a]=n?n(i):i[a]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?ou:Dv,this.isPropagationStopped=Dv,this}return yt(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=ou)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=ou)},persist:function(){},isPersistent:ou}),e}var xa={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Tg=Mn(xa),Ec=yt({},xa,{view:0,detail:0}),oP=Mn(Ec),Vf,Lf,Xa,dh=yt({},Ec,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:xg,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Xa&&(Xa&&t.type==="mousemove"?(Vf=t.screenX-Xa.screenX,Lf=t.screenY-Xa.screenY):Lf=Vf=0,Xa=t),Vf)},movementY:function(t){return"movementY"in t?t.movementY:Lf}}),jv=Mn(dh),aP=yt({},dh,{dataTransfer:0}),lP=Mn(aP),cP=yt({},Ec,{relatedTarget:0}),Mf=Mn(cP),uP=yt({},xa,{animationName:0,elapsedTime:0,pseudoElement:0}),dP=Mn(uP),hP=yt({},xa,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),fP=Mn(hP),pP=yt({},xa,{data:0}),Ov=Mn(pP),mP={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},gP={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},yP={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function _P(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=yP[t])?!!e[t]:!1}function xg(){return _P}var vP=yt({},Ec,{key:function(t){if(t.key){var e=mP[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=ju(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?gP[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:xg,charCode:function(t){return t.type==="keypress"?ju(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?ju(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),wP=Mn(vP),EP=yt({},dh,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Vv=Mn(EP),IP=yt({},Ec,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:xg}),TP=Mn(IP),xP=yt({},xa,{propertyName:0,elapsedTime:0,pseudoElement:0}),SP=Mn(xP),bP=yt({},dh,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),CP=Mn(bP),AP=[9,13,27,32],Sg=Hr&&"CompositionEvent"in window,xl=null;Hr&&"documentMode"in document&&(xl=document.documentMode);var RP=Hr&&"TextEvent"in window&&!xl,s0=Hr&&(!Sg||xl&&8<xl&&11>=xl),Lv=" ",Mv=!1;function i0(t,e){switch(t){case"keyup":return AP.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function o0(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var No=!1;function PP(t,e){switch(t){case"compositionend":return o0(e);case"keypress":return e.which!==32?null:(Mv=!0,Lv);case"textInput":return t=e.data,t===Lv&&Mv?null:t;default:return null}}function NP(t,e){if(No)return t==="compositionend"||!Sg&&i0(t,e)?(t=r0(),Du=Ig=As=null,No=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return s0&&e.locale!=="ko"?null:e.data;default:return null}}var kP={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Fv(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!kP[t.type]:e==="textarea"}function a0(t,e,n,r){MT(r),e=fd(e,"onChange"),0<e.length&&(n=new Tg("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var Sl=null,Kl=null;function DP(t){_0(t,0)}function hh(t){var e=jo(t);if(NT(e))return t}function jP(t,e){if(t==="change")return e}var l0=!1;if(Hr){var Ff;if(Hr){var Uf="oninput"in document;if(!Uf){var Uv=document.createElement("div");Uv.setAttribute("oninput","return;"),Uf=typeof Uv.oninput=="function"}Ff=Uf}else Ff=!1;l0=Ff&&(!document.documentMode||9<document.documentMode)}function $v(){Sl&&(Sl.detachEvent("onpropertychange",c0),Kl=Sl=null)}function c0(t){if(t.propertyName==="value"&&hh(Kl)){var e=[];a0(e,Kl,t,yg(t)),BT(DP,e)}}function OP(t,e,n){t==="focusin"?($v(),Sl=e,Kl=n,Sl.attachEvent("onpropertychange",c0)):t==="focusout"&&$v()}function VP(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return hh(Kl)}function LP(t,e){if(t==="click")return hh(e)}function MP(t,e){if(t==="input"||t==="change")return hh(e)}function FP(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var cr=typeof Object.is=="function"?Object.is:FP;function Gl(t,e){if(cr(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!Np.call(e,s)||!cr(t[s],e[s]))return!1}return!0}function Bv(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function zv(t,e){var n=Bv(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Bv(n)}}function u0(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?u0(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function d0(){for(var t=window,e=od();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=od(t.document)}return e}function bg(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function UP(t){var e=d0(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&u0(n.ownerDocument.documentElement,n)){if(r!==null&&bg(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=n.textContent.length,i=Math.min(r.start,s);r=r.end===void 0?i:Math.min(r.end,s),!t.extend&&i>r&&(s=r,r=i,i=s),s=zv(n,i);var o=zv(n,r);s&&o&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),i>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var $P=Hr&&"documentMode"in document&&11>=document.documentMode,ko=null,Yp=null,bl=null,Xp=!1;function qv(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Xp||ko==null||ko!==od(r)||(r=ko,"selectionStart"in r&&bg(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),bl&&Gl(bl,r)||(bl=r,r=fd(Yp,"onSelect"),0<r.length&&(e=new Tg("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=ko)))}function au(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Do={animationend:au("Animation","AnimationEnd"),animationiteration:au("Animation","AnimationIteration"),animationstart:au("Animation","AnimationStart"),transitionend:au("Transition","TransitionEnd")},$f={},h0={};Hr&&(h0=document.createElement("div").style,"AnimationEvent"in window||(delete Do.animationend.animation,delete Do.animationiteration.animation,delete Do.animationstart.animation),"TransitionEvent"in window||delete Do.transitionend.transition);function fh(t){if($f[t])return $f[t];if(!Do[t])return t;var e=Do[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in h0)return $f[t]=e[n];return t}var f0=fh("animationend"),p0=fh("animationiteration"),m0=fh("animationstart"),g0=fh("transitionend"),y0=new Map,Hv="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Js(t,e){y0.set(t,e),to(e,[t])}for(var Bf=0;Bf<Hv.length;Bf++){var zf=Hv[Bf],BP=zf.toLowerCase(),zP=zf[0].toUpperCase()+zf.slice(1);Js(BP,"on"+zP)}Js(f0,"onAnimationEnd");Js(p0,"onAnimationIteration");Js(m0,"onAnimationStart");Js("dblclick","onDoubleClick");Js("focusin","onFocus");Js("focusout","onBlur");Js(g0,"onTransitionEnd");na("onMouseEnter",["mouseout","mouseover"]);na("onMouseLeave",["mouseout","mouseover"]);na("onPointerEnter",["pointerout","pointerover"]);na("onPointerLeave",["pointerout","pointerover"]);to("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));to("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));to("onBeforeInput",["compositionend","keypress","textInput","paste"]);to("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));to("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));to("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var hl="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),qP=new Set("cancel close invalid load scroll toggle".split(" ").concat(hl));function Wv(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,BR(r,e,void 0,t),t.currentTarget=null}function _0(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],s=r.event;r=r.listeners;e:{var i=void 0;if(e)for(var o=r.length-1;0<=o;o--){var a=r[o],l=a.instance,d=a.currentTarget;if(a=a.listener,l!==i&&s.isPropagationStopped())break e;Wv(s,a,d),i=l}else for(o=0;o<r.length;o++){if(a=r[o],l=a.instance,d=a.currentTarget,a=a.listener,l!==i&&s.isPropagationStopped())break e;Wv(s,a,d),i=l}}}if(ld)throw t=Wp,ld=!1,Wp=null,t}function at(t,e){var n=e[nm];n===void 0&&(n=e[nm]=new Set);var r=t+"__bubble";n.has(r)||(v0(e,t,2,!1),n.add(r))}function qf(t,e,n){var r=0;e&&(r|=4),v0(n,t,r,e)}var lu="_reactListening"+Math.random().toString(36).slice(2);function Ql(t){if(!t[lu]){t[lu]=!0,bT.forEach(function(n){n!=="selectionchange"&&(qP.has(n)||qf(n,!1,t),qf(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[lu]||(e[lu]=!0,qf("selectionchange",!1,e))}}function v0(t,e,n,r){switch(n0(e)){case 1:var s=sP;break;case 4:s=iP;break;default:s=Eg}n=s.bind(null,e,n,t),s=void 0,!Hp||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),r?s!==void 0?t.addEventListener(e,n,{capture:!0,passive:s}):t.addEventListener(e,n,!0):s!==void 0?t.addEventListener(e,n,{passive:s}):t.addEventListener(e,n,!1)}function Hf(t,e,n,r,s){var i=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var a=r.stateNode.containerInfo;if(a===s||a.nodeType===8&&a.parentNode===s)break;if(o===4)for(o=r.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===s||l.nodeType===8&&l.parentNode===s))return;o=o.return}for(;a!==null;){if(o=Ti(a),o===null)return;if(l=o.tag,l===5||l===6){r=i=o;continue e}a=a.parentNode}}r=r.return}BT(function(){var d=i,h=yg(n),f=[];e:{var m=y0.get(t);if(m!==void 0){var w=Tg,A=t;switch(t){case"keypress":if(ju(n)===0)break e;case"keydown":case"keyup":w=wP;break;case"focusin":A="focus",w=Mf;break;case"focusout":A="blur",w=Mf;break;case"beforeblur":case"afterblur":w=Mf;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":w=jv;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":w=lP;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":w=TP;break;case f0:case p0:case m0:w=dP;break;case g0:w=SP;break;case"scroll":w=oP;break;case"wheel":w=CP;break;case"copy":case"cut":case"paste":w=fP;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":w=Vv}var b=(e&4)!==0,P=!b&&t==="scroll",I=b?m!==null?m+"Capture":null:m;b=[];for(var E=d,y;E!==null;){y=E;var j=y.stateNode;if(y.tag===5&&j!==null&&(y=j,I!==null&&(j=zl(E,I),j!=null&&b.push(Yl(E,j,y)))),P)break;E=E.return}0<b.length&&(m=new w(m,A,null,n,h),f.push({event:m,listeners:b}))}}if(!(e&7)){e:{if(m=t==="mouseover"||t==="pointerover",w=t==="mouseout"||t==="pointerout",m&&n!==zp&&(A=n.relatedTarget||n.fromElement)&&(Ti(A)||A[Wr]))break e;if((w||m)&&(m=h.window===h?h:(m=h.ownerDocument)?m.defaultView||m.parentWindow:window,w?(A=n.relatedTarget||n.toElement,w=d,A=A?Ti(A):null,A!==null&&(P=no(A),A!==P||A.tag!==5&&A.tag!==6)&&(A=null)):(w=null,A=d),w!==A)){if(b=jv,j="onMouseLeave",I="onMouseEnter",E="mouse",(t==="pointerout"||t==="pointerover")&&(b=Vv,j="onPointerLeave",I="onPointerEnter",E="pointer"),P=w==null?m:jo(w),y=A==null?m:jo(A),m=new b(j,E+"leave",w,n,h),m.target=P,m.relatedTarget=y,j=null,Ti(h)===d&&(b=new b(I,E+"enter",A,n,h),b.target=y,b.relatedTarget=P,j=b),P=j,w&&A)t:{for(b=w,I=A,E=0,y=b;y;y=ho(y))E++;for(y=0,j=I;j;j=ho(j))y++;for(;0<E-y;)b=ho(b),E--;for(;0<y-E;)I=ho(I),y--;for(;E--;){if(b===I||I!==null&&b===I.alternate)break t;b=ho(b),I=ho(I)}b=null}else b=null;w!==null&&Kv(f,m,w,b,!1),A!==null&&P!==null&&Kv(f,P,A,b,!0)}}e:{if(m=d?jo(d):window,w=m.nodeName&&m.nodeName.toLowerCase(),w==="select"||w==="input"&&m.type==="file")var V=jP;else if(Fv(m))if(l0)V=MP;else{V=VP;var M=OP}else(w=m.nodeName)&&w.toLowerCase()==="input"&&(m.type==="checkbox"||m.type==="radio")&&(V=LP);if(V&&(V=V(t,d))){a0(f,V,n,h);break e}M&&M(t,m,d),t==="focusout"&&(M=m._wrapperState)&&M.controlled&&m.type==="number"&&Mp(m,"number",m.value)}switch(M=d?jo(d):window,t){case"focusin":(Fv(M)||M.contentEditable==="true")&&(ko=M,Yp=d,bl=null);break;case"focusout":bl=Yp=ko=null;break;case"mousedown":Xp=!0;break;case"contextmenu":case"mouseup":case"dragend":Xp=!1,qv(f,n,h);break;case"selectionchange":if($P)break;case"keydown":case"keyup":qv(f,n,h)}var T;if(Sg)e:{switch(t){case"compositionstart":var _="onCompositionStart";break e;case"compositionend":_="onCompositionEnd";break e;case"compositionupdate":_="onCompositionUpdate";break e}_=void 0}else No?i0(t,n)&&(_="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(_="onCompositionStart");_&&(s0&&n.locale!=="ko"&&(No||_!=="onCompositionStart"?_==="onCompositionEnd"&&No&&(T=r0()):(As=h,Ig="value"in As?As.value:As.textContent,No=!0)),M=fd(d,_),0<M.length&&(_=new Ov(_,t,null,n,h),f.push({event:_,listeners:M}),T?_.data=T:(T=o0(n),T!==null&&(_.data=T)))),(T=RP?PP(t,n):NP(t,n))&&(d=fd(d,"onBeforeInput"),0<d.length&&(h=new Ov("onBeforeInput","beforeinput",null,n,h),f.push({event:h,listeners:d}),h.data=T))}_0(f,e)})}function Yl(t,e,n){return{instance:t,listener:e,currentTarget:n}}function fd(t,e){for(var n=e+"Capture",r=[];t!==null;){var s=t,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=zl(t,n),i!=null&&r.unshift(Yl(t,i,s)),i=zl(t,e),i!=null&&r.push(Yl(t,i,s))),t=t.return}return r}function ho(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function Kv(t,e,n,r,s){for(var i=e._reactName,o=[];n!==null&&n!==r;){var a=n,l=a.alternate,d=a.stateNode;if(l!==null&&l===r)break;a.tag===5&&d!==null&&(a=d,s?(l=zl(n,i),l!=null&&o.unshift(Yl(n,l,a))):s||(l=zl(n,i),l!=null&&o.push(Yl(n,l,a)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var HP=/\r\n?/g,WP=/\u0000|\uFFFD/g;function Gv(t){return(typeof t=="string"?t:""+t).replace(HP,`
`).replace(WP,"")}function cu(t,e,n){if(e=Gv(e),Gv(t)!==e&&n)throw Error(H(425))}function pd(){}var Jp=null,Zp=null;function em(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var tm=typeof setTimeout=="function"?setTimeout:void 0,KP=typeof clearTimeout=="function"?clearTimeout:void 0,Qv=typeof Promise=="function"?Promise:void 0,GP=typeof queueMicrotask=="function"?queueMicrotask:typeof Qv<"u"?function(t){return Qv.resolve(null).then(t).catch(QP)}:tm;function QP(t){setTimeout(function(){throw t})}function Wf(t,e){var n=e,r=0;do{var s=n.nextSibling;if(t.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){t.removeChild(s),Wl(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);Wl(e)}function js(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function Yv(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var Sa=Math.random().toString(36).slice(2),xr="__reactFiber$"+Sa,Xl="__reactProps$"+Sa,Wr="__reactContainer$"+Sa,nm="__reactEvents$"+Sa,YP="__reactListeners$"+Sa,XP="__reactHandles$"+Sa;function Ti(t){var e=t[xr];if(e)return e;for(var n=t.parentNode;n;){if(e=n[Wr]||n[xr]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=Yv(t);t!==null;){if(n=t[xr])return n;t=Yv(t)}return e}t=n,n=t.parentNode}return null}function Ic(t){return t=t[xr]||t[Wr],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function jo(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(H(33))}function ph(t){return t[Xl]||null}var rm=[],Oo=-1;function Zs(t){return{current:t}}function lt(t){0>Oo||(t.current=rm[Oo],rm[Oo]=null,Oo--)}function st(t,e){Oo++,rm[Oo]=t.current,t.current=e}var Ws={},cn=Zs(Ws),Tn=Zs(!1),Vi=Ws;function ra(t,e){var n=t.type.contextTypes;if(!n)return Ws;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in n)s[i]=e[i];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function xn(t){return t=t.childContextTypes,t!=null}function md(){lt(Tn),lt(cn)}function Xv(t,e,n){if(cn.current!==Ws)throw Error(H(168));st(cn,e),st(Tn,n)}function w0(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in e))throw Error(H(108,OR(t)||"Unknown",s));return yt({},n,r)}function gd(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Ws,Vi=cn.current,st(cn,t),st(Tn,Tn.current),!0}function Jv(t,e,n){var r=t.stateNode;if(!r)throw Error(H(169));n?(t=w0(t,e,Vi),r.__reactInternalMemoizedMergedChildContext=t,lt(Tn),lt(cn),st(cn,t)):lt(Tn),st(Tn,n)}var Lr=null,mh=!1,Kf=!1;function E0(t){Lr===null?Lr=[t]:Lr.push(t)}function JP(t){mh=!0,E0(t)}function ei(){if(!Kf&&Lr!==null){Kf=!0;var t=0,e=Xe;try{var n=Lr;for(Xe=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}Lr=null,mh=!1}catch(s){throw Lr!==null&&(Lr=Lr.slice(t+1)),WT(_g,ei),s}finally{Xe=e,Kf=!1}}return null}var Vo=[],Lo=0,yd=null,_d=0,Un=[],$n=0,Li=null,Mr=1,Fr="";function fi(t,e){Vo[Lo++]=_d,Vo[Lo++]=yd,yd=t,_d=e}function I0(t,e,n){Un[$n++]=Mr,Un[$n++]=Fr,Un[$n++]=Li,Li=t;var r=Mr;t=Fr;var s=32-or(r)-1;r&=~(1<<s),n+=1;var i=32-or(e)+s;if(30<i){var o=s-s%5;i=(r&(1<<o)-1).toString(32),r>>=o,s-=o,Mr=1<<32-or(e)+s|n<<s|r,Fr=i+t}else Mr=1<<i|n<<s|r,Fr=t}function Cg(t){t.return!==null&&(fi(t,1),I0(t,1,0))}function Ag(t){for(;t===yd;)yd=Vo[--Lo],Vo[Lo]=null,_d=Vo[--Lo],Vo[Lo]=null;for(;t===Li;)Li=Un[--$n],Un[$n]=null,Fr=Un[--$n],Un[$n]=null,Mr=Un[--$n],Un[$n]=null}var Dn=null,Nn=null,ut=!1,rr=null;function T0(t,e){var n=qn(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function Zv(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Dn=t,Nn=js(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Dn=t,Nn=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=Li!==null?{id:Mr,overflow:Fr}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=qn(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,Dn=t,Nn=null,!0):!1;default:return!1}}function sm(t){return(t.mode&1)!==0&&(t.flags&128)===0}function im(t){if(ut){var e=Nn;if(e){var n=e;if(!Zv(t,e)){if(sm(t))throw Error(H(418));e=js(n.nextSibling);var r=Dn;e&&Zv(t,e)?T0(r,n):(t.flags=t.flags&-4097|2,ut=!1,Dn=t)}}else{if(sm(t))throw Error(H(418));t.flags=t.flags&-4097|2,ut=!1,Dn=t}}}function ew(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Dn=t}function uu(t){if(t!==Dn)return!1;if(!ut)return ew(t),ut=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!em(t.type,t.memoizedProps)),e&&(e=Nn)){if(sm(t))throw x0(),Error(H(418));for(;e;)T0(t,e),e=js(e.nextSibling)}if(ew(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(H(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){Nn=js(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}Nn=null}}else Nn=Dn?js(t.stateNode.nextSibling):null;return!0}function x0(){for(var t=Nn;t;)t=js(t.nextSibling)}function sa(){Nn=Dn=null,ut=!1}function Rg(t){rr===null?rr=[t]:rr.push(t)}var ZP=ts.ReactCurrentBatchConfig;function Ja(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(H(309));var r=n.stateNode}if(!r)throw Error(H(147,t));var s=r,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(o){var a=s.refs;o===null?delete a[i]:a[i]=o},e._stringRef=i,e)}if(typeof t!="string")throw Error(H(284));if(!n._owner)throw Error(H(290,t))}return t}function du(t,e){throw t=Object.prototype.toString.call(e),Error(H(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function tw(t){var e=t._init;return e(t._payload)}function S0(t){function e(I,E){if(t){var y=I.deletions;y===null?(I.deletions=[E],I.flags|=16):y.push(E)}}function n(I,E){if(!t)return null;for(;E!==null;)e(I,E),E=E.sibling;return null}function r(I,E){for(I=new Map;E!==null;)E.key!==null?I.set(E.key,E):I.set(E.index,E),E=E.sibling;return I}function s(I,E){return I=Ms(I,E),I.index=0,I.sibling=null,I}function i(I,E,y){return I.index=y,t?(y=I.alternate,y!==null?(y=y.index,y<E?(I.flags|=2,E):y):(I.flags|=2,E)):(I.flags|=1048576,E)}function o(I){return t&&I.alternate===null&&(I.flags|=2),I}function a(I,E,y,j){return E===null||E.tag!==6?(E=ep(y,I.mode,j),E.return=I,E):(E=s(E,y),E.return=I,E)}function l(I,E,y,j){var V=y.type;return V===Po?h(I,E,y.props.children,j,y.key):E!==null&&(E.elementType===V||typeof V=="object"&&V!==null&&V.$$typeof===ys&&tw(V)===E.type)?(j=s(E,y.props),j.ref=Ja(I,E,y),j.return=I,j):(j=$u(y.type,y.key,y.props,null,I.mode,j),j.ref=Ja(I,E,y),j.return=I,j)}function d(I,E,y,j){return E===null||E.tag!==4||E.stateNode.containerInfo!==y.containerInfo||E.stateNode.implementation!==y.implementation?(E=tp(y,I.mode,j),E.return=I,E):(E=s(E,y.children||[]),E.return=I,E)}function h(I,E,y,j,V){return E===null||E.tag!==7?(E=Ri(y,I.mode,j,V),E.return=I,E):(E=s(E,y),E.return=I,E)}function f(I,E,y){if(typeof E=="string"&&E!==""||typeof E=="number")return E=ep(""+E,I.mode,y),E.return=I,E;if(typeof E=="object"&&E!==null){switch(E.$$typeof){case eu:return y=$u(E.type,E.key,E.props,null,I.mode,y),y.ref=Ja(I,null,E),y.return=I,y;case Ro:return E=tp(E,I.mode,y),E.return=I,E;case ys:var j=E._init;return f(I,j(E._payload),y)}if(ul(E)||Ka(E))return E=Ri(E,I.mode,y,null),E.return=I,E;du(I,E)}return null}function m(I,E,y,j){var V=E!==null?E.key:null;if(typeof y=="string"&&y!==""||typeof y=="number")return V!==null?null:a(I,E,""+y,j);if(typeof y=="object"&&y!==null){switch(y.$$typeof){case eu:return y.key===V?l(I,E,y,j):null;case Ro:return y.key===V?d(I,E,y,j):null;case ys:return V=y._init,m(I,E,V(y._payload),j)}if(ul(y)||Ka(y))return V!==null?null:h(I,E,y,j,null);du(I,y)}return null}function w(I,E,y,j,V){if(typeof j=="string"&&j!==""||typeof j=="number")return I=I.get(y)||null,a(E,I,""+j,V);if(typeof j=="object"&&j!==null){switch(j.$$typeof){case eu:return I=I.get(j.key===null?y:j.key)||null,l(E,I,j,V);case Ro:return I=I.get(j.key===null?y:j.key)||null,d(E,I,j,V);case ys:var M=j._init;return w(I,E,y,M(j._payload),V)}if(ul(j)||Ka(j))return I=I.get(y)||null,h(E,I,j,V,null);du(E,j)}return null}function A(I,E,y,j){for(var V=null,M=null,T=E,_=E=0,S=null;T!==null&&_<y.length;_++){T.index>_?(S=T,T=null):S=T.sibling;var C=m(I,T,y[_],j);if(C===null){T===null&&(T=S);break}t&&T&&C.alternate===null&&e(I,T),E=i(C,E,_),M===null?V=C:M.sibling=C,M=C,T=S}if(_===y.length)return n(I,T),ut&&fi(I,_),V;if(T===null){for(;_<y.length;_++)T=f(I,y[_],j),T!==null&&(E=i(T,E,_),M===null?V=T:M.sibling=T,M=T);return ut&&fi(I,_),V}for(T=r(I,T);_<y.length;_++)S=w(T,I,_,y[_],j),S!==null&&(t&&S.alternate!==null&&T.delete(S.key===null?_:S.key),E=i(S,E,_),M===null?V=S:M.sibling=S,M=S);return t&&T.forEach(function(k){return e(I,k)}),ut&&fi(I,_),V}function b(I,E,y,j){var V=Ka(y);if(typeof V!="function")throw Error(H(150));if(y=V.call(y),y==null)throw Error(H(151));for(var M=V=null,T=E,_=E=0,S=null,C=y.next();T!==null&&!C.done;_++,C=y.next()){T.index>_?(S=T,T=null):S=T.sibling;var k=m(I,T,C.value,j);if(k===null){T===null&&(T=S);break}t&&T&&k.alternate===null&&e(I,T),E=i(k,E,_),M===null?V=k:M.sibling=k,M=k,T=S}if(C.done)return n(I,T),ut&&fi(I,_),V;if(T===null){for(;!C.done;_++,C=y.next())C=f(I,C.value,j),C!==null&&(E=i(C,E,_),M===null?V=C:M.sibling=C,M=C);return ut&&fi(I,_),V}for(T=r(I,T);!C.done;_++,C=y.next())C=w(T,I,_,C.value,j),C!==null&&(t&&C.alternate!==null&&T.delete(C.key===null?_:C.key),E=i(C,E,_),M===null?V=C:M.sibling=C,M=C);return t&&T.forEach(function(D){return e(I,D)}),ut&&fi(I,_),V}function P(I,E,y,j){if(typeof y=="object"&&y!==null&&y.type===Po&&y.key===null&&(y=y.props.children),typeof y=="object"&&y!==null){switch(y.$$typeof){case eu:e:{for(var V=y.key,M=E;M!==null;){if(M.key===V){if(V=y.type,V===Po){if(M.tag===7){n(I,M.sibling),E=s(M,y.props.children),E.return=I,I=E;break e}}else if(M.elementType===V||typeof V=="object"&&V!==null&&V.$$typeof===ys&&tw(V)===M.type){n(I,M.sibling),E=s(M,y.props),E.ref=Ja(I,M,y),E.return=I,I=E;break e}n(I,M);break}else e(I,M);M=M.sibling}y.type===Po?(E=Ri(y.props.children,I.mode,j,y.key),E.return=I,I=E):(j=$u(y.type,y.key,y.props,null,I.mode,j),j.ref=Ja(I,E,y),j.return=I,I=j)}return o(I);case Ro:e:{for(M=y.key;E!==null;){if(E.key===M)if(E.tag===4&&E.stateNode.containerInfo===y.containerInfo&&E.stateNode.implementation===y.implementation){n(I,E.sibling),E=s(E,y.children||[]),E.return=I,I=E;break e}else{n(I,E);break}else e(I,E);E=E.sibling}E=tp(y,I.mode,j),E.return=I,I=E}return o(I);case ys:return M=y._init,P(I,E,M(y._payload),j)}if(ul(y))return A(I,E,y,j);if(Ka(y))return b(I,E,y,j);du(I,y)}return typeof y=="string"&&y!==""||typeof y=="number"?(y=""+y,E!==null&&E.tag===6?(n(I,E.sibling),E=s(E,y),E.return=I,I=E):(n(I,E),E=ep(y,I.mode,j),E.return=I,I=E),o(I)):n(I,E)}return P}var ia=S0(!0),b0=S0(!1),vd=Zs(null),wd=null,Mo=null,Pg=null;function Ng(){Pg=Mo=wd=null}function kg(t){var e=vd.current;lt(vd),t._currentValue=e}function om(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function Wo(t,e){wd=t,Pg=Mo=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(En=!0),t.firstContext=null)}function Gn(t){var e=t._currentValue;if(Pg!==t)if(t={context:t,memoizedValue:e,next:null},Mo===null){if(wd===null)throw Error(H(308));Mo=t,wd.dependencies={lanes:0,firstContext:t}}else Mo=Mo.next=t;return e}var xi=null;function Dg(t){xi===null?xi=[t]:xi.push(t)}function C0(t,e,n,r){var s=e.interleaved;return s===null?(n.next=n,Dg(e)):(n.next=s.next,s.next=n),e.interleaved=n,Kr(t,r)}function Kr(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var _s=!1;function jg(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function A0(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function zr(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Os(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,Be&2){var s=r.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),r.pending=e,Kr(t,n)}return s=r.interleaved,s===null?(e.next=e,Dg(r)):(e.next=s.next,s.next=e),r.interleaved=e,Kr(t,n)}function Ou(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,vg(t,n)}}function nw(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?s=i=o:i=i.next=o,n=n.next}while(n!==null);i===null?s=i=e:i=i.next=e}else s=i=e;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function Ed(t,e,n,r){var s=t.updateQueue;_s=!1;var i=s.firstBaseUpdate,o=s.lastBaseUpdate,a=s.shared.pending;if(a!==null){s.shared.pending=null;var l=a,d=l.next;l.next=null,o===null?i=d:o.next=d,o=l;var h=t.alternate;h!==null&&(h=h.updateQueue,a=h.lastBaseUpdate,a!==o&&(a===null?h.firstBaseUpdate=d:a.next=d,h.lastBaseUpdate=l))}if(i!==null){var f=s.baseState;o=0,h=d=l=null,a=i;do{var m=a.lane,w=a.eventTime;if((r&m)===m){h!==null&&(h=h.next={eventTime:w,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var A=t,b=a;switch(m=e,w=n,b.tag){case 1:if(A=b.payload,typeof A=="function"){f=A.call(w,f,m);break e}f=A;break e;case 3:A.flags=A.flags&-65537|128;case 0:if(A=b.payload,m=typeof A=="function"?A.call(w,f,m):A,m==null)break e;f=yt({},f,m);break e;case 2:_s=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,m=s.effects,m===null?s.effects=[a]:m.push(a))}else w={eventTime:w,lane:m,tag:a.tag,payload:a.payload,callback:a.callback,next:null},h===null?(d=h=w,l=f):h=h.next=w,o|=m;if(a=a.next,a===null){if(a=s.shared.pending,a===null)break;m=a,a=m.next,m.next=null,s.lastBaseUpdate=m,s.shared.pending=null}}while(!0);if(h===null&&(l=f),s.baseState=l,s.firstBaseUpdate=d,s.lastBaseUpdate=h,e=s.shared.interleaved,e!==null){s=e;do o|=s.lane,s=s.next;while(s!==e)}else i===null&&(s.shared.lanes=0);Fi|=o,t.lanes=o,t.memoizedState=f}}function rw(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(H(191,s));s.call(r)}}}var Tc={},Rr=Zs(Tc),Jl=Zs(Tc),Zl=Zs(Tc);function Si(t){if(t===Tc)throw Error(H(174));return t}function Og(t,e){switch(st(Zl,e),st(Jl,t),st(Rr,Tc),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Up(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Up(e,t)}lt(Rr),st(Rr,e)}function oa(){lt(Rr),lt(Jl),lt(Zl)}function R0(t){Si(Zl.current);var e=Si(Rr.current),n=Up(e,t.type);e!==n&&(st(Jl,t),st(Rr,n))}function Vg(t){Jl.current===t&&(lt(Rr),lt(Jl))}var pt=Zs(0);function Id(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Gf=[];function Lg(){for(var t=0;t<Gf.length;t++)Gf[t]._workInProgressVersionPrimary=null;Gf.length=0}var Vu=ts.ReactCurrentDispatcher,Qf=ts.ReactCurrentBatchConfig,Mi=0,gt=null,jt=null,Bt=null,Td=!1,Cl=!1,ec=0,e1=0;function Zt(){throw Error(H(321))}function Mg(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!cr(t[n],e[n]))return!1;return!0}function Fg(t,e,n,r,s,i){if(Mi=i,gt=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Vu.current=t===null||t.memoizedState===null?s1:i1,t=n(r,s),Cl){i=0;do{if(Cl=!1,ec=0,25<=i)throw Error(H(301));i+=1,Bt=jt=null,e.updateQueue=null,Vu.current=o1,t=n(r,s)}while(Cl)}if(Vu.current=xd,e=jt!==null&&jt.next!==null,Mi=0,Bt=jt=gt=null,Td=!1,e)throw Error(H(300));return t}function Ug(){var t=ec!==0;return ec=0,t}function Ir(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Bt===null?gt.memoizedState=Bt=t:Bt=Bt.next=t,Bt}function Qn(){if(jt===null){var t=gt.alternate;t=t!==null?t.memoizedState:null}else t=jt.next;var e=Bt===null?gt.memoizedState:Bt.next;if(e!==null)Bt=e,jt=t;else{if(t===null)throw Error(H(310));jt=t,t={memoizedState:jt.memoizedState,baseState:jt.baseState,baseQueue:jt.baseQueue,queue:jt.queue,next:null},Bt===null?gt.memoizedState=Bt=t:Bt=Bt.next=t}return Bt}function tc(t,e){return typeof e=="function"?e(t):e}function Yf(t){var e=Qn(),n=e.queue;if(n===null)throw Error(H(311));n.lastRenderedReducer=t;var r=jt,s=r.baseQueue,i=n.pending;if(i!==null){if(s!==null){var o=s.next;s.next=i.next,i.next=o}r.baseQueue=s=i,n.pending=null}if(s!==null){i=s.next,r=r.baseState;var a=o=null,l=null,d=i;do{var h=d.lane;if((Mi&h)===h)l!==null&&(l=l.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),r=d.hasEagerState?d.eagerState:t(r,d.action);else{var f={lane:h,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};l===null?(a=l=f,o=r):l=l.next=f,gt.lanes|=h,Fi|=h}d=d.next}while(d!==null&&d!==i);l===null?o=r:l.next=a,cr(r,e.memoizedState)||(En=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=l,n.lastRenderedState=r}if(t=n.interleaved,t!==null){s=t;do i=s.lane,gt.lanes|=i,Fi|=i,s=s.next;while(s!==t)}else s===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function Xf(t){var e=Qn(),n=e.queue;if(n===null)throw Error(H(311));n.lastRenderedReducer=t;var r=n.dispatch,s=n.pending,i=e.memoizedState;if(s!==null){n.pending=null;var o=s=s.next;do i=t(i,o.action),o=o.next;while(o!==s);cr(i,e.memoizedState)||(En=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),n.lastRenderedState=i}return[i,r]}function P0(){}function N0(t,e){var n=gt,r=Qn(),s=e(),i=!cr(r.memoizedState,s);if(i&&(r.memoizedState=s,En=!0),r=r.queue,$g(j0.bind(null,n,r,t),[t]),r.getSnapshot!==e||i||Bt!==null&&Bt.memoizedState.tag&1){if(n.flags|=2048,nc(9,D0.bind(null,n,r,s,e),void 0,null),zt===null)throw Error(H(349));Mi&30||k0(n,e,s)}return s}function k0(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=gt.updateQueue,e===null?(e={lastEffect:null,stores:null},gt.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function D0(t,e,n,r){e.value=n,e.getSnapshot=r,O0(e)&&V0(t)}function j0(t,e,n){return n(function(){O0(e)&&V0(t)})}function O0(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!cr(t,n)}catch{return!0}}function V0(t){var e=Kr(t,1);e!==null&&ar(e,t,1,-1)}function sw(t){var e=Ir();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:tc,lastRenderedState:t},e.queue=t,t=t.dispatch=r1.bind(null,gt,t),[e.memoizedState,t]}function nc(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=gt.updateQueue,e===null?(e={lastEffect:null,stores:null},gt.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function L0(){return Qn().memoizedState}function Lu(t,e,n,r){var s=Ir();gt.flags|=t,s.memoizedState=nc(1|e,n,void 0,r===void 0?null:r)}function gh(t,e,n,r){var s=Qn();r=r===void 0?null:r;var i=void 0;if(jt!==null){var o=jt.memoizedState;if(i=o.destroy,r!==null&&Mg(r,o.deps)){s.memoizedState=nc(e,n,i,r);return}}gt.flags|=t,s.memoizedState=nc(1|e,n,i,r)}function iw(t,e){return Lu(8390656,8,t,e)}function $g(t,e){return gh(2048,8,t,e)}function M0(t,e){return gh(4,2,t,e)}function F0(t,e){return gh(4,4,t,e)}function U0(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function $0(t,e,n){return n=n!=null?n.concat([t]):null,gh(4,4,U0.bind(null,e,t),n)}function Bg(){}function B0(t,e){var n=Qn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Mg(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function z0(t,e){var n=Qn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Mg(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function q0(t,e,n){return Mi&21?(cr(n,e)||(n=QT(),gt.lanes|=n,Fi|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,En=!0),t.memoizedState=n)}function t1(t,e){var n=Xe;Xe=n!==0&&4>n?n:4,t(!0);var r=Qf.transition;Qf.transition={};try{t(!1),e()}finally{Xe=n,Qf.transition=r}}function H0(){return Qn().memoizedState}function n1(t,e,n){var r=Ls(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},W0(t))K0(e,n);else if(n=C0(t,e,n,r),n!==null){var s=pn();ar(n,t,r,s),G0(n,e,r)}}function r1(t,e,n){var r=Ls(t),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(W0(t))K0(e,s);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var o=e.lastRenderedState,a=i(o,n);if(s.hasEagerState=!0,s.eagerState=a,cr(a,o)){var l=e.interleaved;l===null?(s.next=s,Dg(e)):(s.next=l.next,l.next=s),e.interleaved=s;return}}catch{}finally{}n=C0(t,e,s,r),n!==null&&(s=pn(),ar(n,t,r,s),G0(n,e,r))}}function W0(t){var e=t.alternate;return t===gt||e!==null&&e===gt}function K0(t,e){Cl=Td=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function G0(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,vg(t,n)}}var xd={readContext:Gn,useCallback:Zt,useContext:Zt,useEffect:Zt,useImperativeHandle:Zt,useInsertionEffect:Zt,useLayoutEffect:Zt,useMemo:Zt,useReducer:Zt,useRef:Zt,useState:Zt,useDebugValue:Zt,useDeferredValue:Zt,useTransition:Zt,useMutableSource:Zt,useSyncExternalStore:Zt,useId:Zt,unstable_isNewReconciler:!1},s1={readContext:Gn,useCallback:function(t,e){return Ir().memoizedState=[t,e===void 0?null:e],t},useContext:Gn,useEffect:iw,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,Lu(4194308,4,U0.bind(null,e,t),n)},useLayoutEffect:function(t,e){return Lu(4194308,4,t,e)},useInsertionEffect:function(t,e){return Lu(4,2,t,e)},useMemo:function(t,e){var n=Ir();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=Ir();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=n1.bind(null,gt,t),[r.memoizedState,t]},useRef:function(t){var e=Ir();return t={current:t},e.memoizedState=t},useState:sw,useDebugValue:Bg,useDeferredValue:function(t){return Ir().memoizedState=t},useTransition:function(){var t=sw(!1),e=t[0];return t=t1.bind(null,t[1]),Ir().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=gt,s=Ir();if(ut){if(n===void 0)throw Error(H(407));n=n()}else{if(n=e(),zt===null)throw Error(H(349));Mi&30||k0(r,e,n)}s.memoizedState=n;var i={value:n,getSnapshot:e};return s.queue=i,iw(j0.bind(null,r,i,t),[t]),r.flags|=2048,nc(9,D0.bind(null,r,i,n,e),void 0,null),n},useId:function(){var t=Ir(),e=zt.identifierPrefix;if(ut){var n=Fr,r=Mr;n=(r&~(1<<32-or(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=ec++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=e1++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},i1={readContext:Gn,useCallback:B0,useContext:Gn,useEffect:$g,useImperativeHandle:$0,useInsertionEffect:M0,useLayoutEffect:F0,useMemo:z0,useReducer:Yf,useRef:L0,useState:function(){return Yf(tc)},useDebugValue:Bg,useDeferredValue:function(t){var e=Qn();return q0(e,jt.memoizedState,t)},useTransition:function(){var t=Yf(tc)[0],e=Qn().memoizedState;return[t,e]},useMutableSource:P0,useSyncExternalStore:N0,useId:H0,unstable_isNewReconciler:!1},o1={readContext:Gn,useCallback:B0,useContext:Gn,useEffect:$g,useImperativeHandle:$0,useInsertionEffect:M0,useLayoutEffect:F0,useMemo:z0,useReducer:Xf,useRef:L0,useState:function(){return Xf(tc)},useDebugValue:Bg,useDeferredValue:function(t){var e=Qn();return jt===null?e.memoizedState=t:q0(e,jt.memoizedState,t)},useTransition:function(){var t=Xf(tc)[0],e=Qn().memoizedState;return[t,e]},useMutableSource:P0,useSyncExternalStore:N0,useId:H0,unstable_isNewReconciler:!1};function er(t,e){if(t&&t.defaultProps){e=yt({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function am(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:yt({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var yh={isMounted:function(t){return(t=t._reactInternals)?no(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=pn(),s=Ls(t),i=zr(r,s);i.payload=e,n!=null&&(i.callback=n),e=Os(t,i,s),e!==null&&(ar(e,t,s,r),Ou(e,t,s))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=pn(),s=Ls(t),i=zr(r,s);i.tag=1,i.payload=e,n!=null&&(i.callback=n),e=Os(t,i,s),e!==null&&(ar(e,t,s,r),Ou(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=pn(),r=Ls(t),s=zr(n,r);s.tag=2,e!=null&&(s.callback=e),e=Os(t,s,r),e!==null&&(ar(e,t,r,n),Ou(e,t,r))}};function ow(t,e,n,r,s,i,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,i,o):e.prototype&&e.prototype.isPureReactComponent?!Gl(n,r)||!Gl(s,i):!0}function Q0(t,e,n){var r=!1,s=Ws,i=e.contextType;return typeof i=="object"&&i!==null?i=Gn(i):(s=xn(e)?Vi:cn.current,r=e.contextTypes,i=(r=r!=null)?ra(t,s):Ws),e=new e(n,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=yh,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=i),e}function aw(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&yh.enqueueReplaceState(e,e.state,null)}function lm(t,e,n,r){var s=t.stateNode;s.props=n,s.state=t.memoizedState,s.refs={},jg(t);var i=e.contextType;typeof i=="object"&&i!==null?s.context=Gn(i):(i=xn(e)?Vi:cn.current,s.context=ra(t,i)),s.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(am(t,e,i,n),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&yh.enqueueReplaceState(s,s.state,null),Ed(t,n,s,r),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function aa(t,e){try{var n="",r=e;do n+=jR(r),r=r.return;while(r);var s=n}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:s,digest:null}}function Jf(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function cm(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var a1=typeof WeakMap=="function"?WeakMap:Map;function Y0(t,e,n){n=zr(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){bd||(bd=!0,vm=r),cm(t,e)},n}function X0(t,e,n){n=zr(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var s=e.value;n.payload=function(){return r(s)},n.callback=function(){cm(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){cm(t,e),typeof r!="function"&&(Vs===null?Vs=new Set([this]):Vs.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function lw(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new a1;var s=new Set;r.set(e,s)}else s=r.get(e),s===void 0&&(s=new Set,r.set(e,s));s.has(n)||(s.add(n),t=E1.bind(null,t,e,n),e.then(t,t))}function cw(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function uw(t,e,n,r,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=zr(-1,1),e.tag=2,Os(n,e,1))),n.lanes|=1),t)}var l1=ts.ReactCurrentOwner,En=!1;function dn(t,e,n,r){e.child=t===null?b0(e,null,n,r):ia(e,t.child,n,r)}function dw(t,e,n,r,s){n=n.render;var i=e.ref;return Wo(e,s),r=Fg(t,e,n,r,i,s),n=Ug(),t!==null&&!En?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,Gr(t,e,s)):(ut&&n&&Cg(e),e.flags|=1,dn(t,e,r,s),e.child)}function hw(t,e,n,r,s){if(t===null){var i=n.type;return typeof i=="function"&&!Yg(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=i,J0(t,e,i,r,s)):(t=$u(n.type,null,r,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&s)){var o=i.memoizedProps;if(n=n.compare,n=n!==null?n:Gl,n(o,r)&&t.ref===e.ref)return Gr(t,e,s)}return e.flags|=1,t=Ms(i,r),t.ref=e.ref,t.return=e,e.child=t}function J0(t,e,n,r,s){if(t!==null){var i=t.memoizedProps;if(Gl(i,r)&&t.ref===e.ref)if(En=!1,e.pendingProps=r=i,(t.lanes&s)!==0)t.flags&131072&&(En=!0);else return e.lanes=t.lanes,Gr(t,e,s)}return um(t,e,n,r,s)}function Z0(t,e,n){var r=e.pendingProps,s=r.children,i=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},st(Uo,Rn),Rn|=n;else{if(!(n&1073741824))return t=i!==null?i.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,st(Uo,Rn),Rn|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,st(Uo,Rn),Rn|=r}else i!==null?(r=i.baseLanes|n,e.memoizedState=null):r=n,st(Uo,Rn),Rn|=r;return dn(t,e,s,n),e.child}function ex(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function um(t,e,n,r,s){var i=xn(n)?Vi:cn.current;return i=ra(e,i),Wo(e,s),n=Fg(t,e,n,r,i,s),r=Ug(),t!==null&&!En?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,Gr(t,e,s)):(ut&&r&&Cg(e),e.flags|=1,dn(t,e,n,s),e.child)}function fw(t,e,n,r,s){if(xn(n)){var i=!0;gd(e)}else i=!1;if(Wo(e,s),e.stateNode===null)Mu(t,e),Q0(e,n,r),lm(e,n,r,s),r=!0;else if(t===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var l=o.context,d=n.contextType;typeof d=="object"&&d!==null?d=Gn(d):(d=xn(n)?Vi:cn.current,d=ra(e,d));var h=n.getDerivedStateFromProps,f=typeof h=="function"||typeof o.getSnapshotBeforeUpdate=="function";f||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==r||l!==d)&&aw(e,o,r,d),_s=!1;var m=e.memoizedState;o.state=m,Ed(e,r,o,s),l=e.memoizedState,a!==r||m!==l||Tn.current||_s?(typeof h=="function"&&(am(e,n,h,r),l=e.memoizedState),(a=_s||ow(e,n,a,r,m,l,d))?(f||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=l),o.props=r,o.state=l,o.context=d,r=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,A0(t,e),a=e.memoizedProps,d=e.type===e.elementType?a:er(e.type,a),o.props=d,f=e.pendingProps,m=o.context,l=n.contextType,typeof l=="object"&&l!==null?l=Gn(l):(l=xn(n)?Vi:cn.current,l=ra(e,l));var w=n.getDerivedStateFromProps;(h=typeof w=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==f||m!==l)&&aw(e,o,r,l),_s=!1,m=e.memoizedState,o.state=m,Ed(e,r,o,s);var A=e.memoizedState;a!==f||m!==A||Tn.current||_s?(typeof w=="function"&&(am(e,n,w,r),A=e.memoizedState),(d=_s||ow(e,n,d,r,m,A,l)||!1)?(h||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,A,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,A,l)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&m===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&m===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=A),o.props=r,o.state=A,o.context=l,r=d):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&m===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&m===t.memoizedState||(e.flags|=1024),r=!1)}return dm(t,e,n,r,i,s)}function dm(t,e,n,r,s,i){ex(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return s&&Jv(e,n,!1),Gr(t,e,i);r=e.stateNode,l1.current=e;var a=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=ia(e,t.child,null,i),e.child=ia(e,null,a,i)):dn(t,e,a,i),e.memoizedState=r.state,s&&Jv(e,n,!0),e.child}function tx(t){var e=t.stateNode;e.pendingContext?Xv(t,e.pendingContext,e.pendingContext!==e.context):e.context&&Xv(t,e.context,!1),Og(t,e.containerInfo)}function pw(t,e,n,r,s){return sa(),Rg(s),e.flags|=256,dn(t,e,n,r),e.child}var hm={dehydrated:null,treeContext:null,retryLane:0};function fm(t){return{baseLanes:t,cachePool:null,transitions:null}}function nx(t,e,n){var r=e.pendingProps,s=pt.current,i=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=t!==null&&t.memoizedState===null?!1:(s&2)!==0),a?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),st(pt,s&1),t===null)return im(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,i?(r=e.mode,i=e.child,o={mode:"hidden",children:o},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=wh(o,r,0,null),t=Ri(t,r,n,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=fm(n),e.memoizedState=hm,t):zg(e,o));if(s=t.memoizedState,s!==null&&(a=s.dehydrated,a!==null))return c1(t,e,o,r,a,s,n);if(i){i=r.fallback,o=e.mode,s=t.child,a=s.sibling;var l={mode:"hidden",children:r.children};return!(o&1)&&e.child!==s?(r=e.child,r.childLanes=0,r.pendingProps=l,e.deletions=null):(r=Ms(s,l),r.subtreeFlags=s.subtreeFlags&14680064),a!==null?i=Ms(a,i):(i=Ri(i,o,n,null),i.flags|=2),i.return=e,r.return=e,r.sibling=i,e.child=r,r=i,i=e.child,o=t.child.memoizedState,o=o===null?fm(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=t.childLanes&~n,e.memoizedState=hm,r}return i=t.child,t=i.sibling,r=Ms(i,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function zg(t,e){return e=wh({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function hu(t,e,n,r){return r!==null&&Rg(r),ia(e,t.child,null,n),t=zg(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function c1(t,e,n,r,s,i,o){if(n)return e.flags&256?(e.flags&=-257,r=Jf(Error(H(422))),hu(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=r.fallback,s=e.mode,r=wh({mode:"visible",children:r.children},s,0,null),i=Ri(i,s,o,null),i.flags|=2,r.return=e,i.return=e,r.sibling=i,e.child=r,e.mode&1&&ia(e,t.child,null,o),e.child.memoizedState=fm(o),e.memoizedState=hm,i);if(!(e.mode&1))return hu(t,e,o,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var a=r.dgst;return r=a,i=Error(H(419)),r=Jf(i,r,void 0),hu(t,e,o,r)}if(a=(o&t.childLanes)!==0,En||a){if(r=zt,r!==null){switch(o&-o){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|o)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,Kr(t,s),ar(r,t,s,-1))}return Qg(),r=Jf(Error(H(421))),hu(t,e,o,r)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=I1.bind(null,t),s._reactRetry=e,null):(t=i.treeContext,Nn=js(s.nextSibling),Dn=e,ut=!0,rr=null,t!==null&&(Un[$n++]=Mr,Un[$n++]=Fr,Un[$n++]=Li,Mr=t.id,Fr=t.overflow,Li=e),e=zg(e,r.children),e.flags|=4096,e)}function mw(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),om(t.return,e,n)}function Zf(t,e,n,r,s){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=s)}function rx(t,e,n){var r=e.pendingProps,s=r.revealOrder,i=r.tail;if(dn(t,e,r.children,n),r=pt.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&mw(t,n,e);else if(t.tag===19)mw(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(st(pt,r),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(n=e.child,s=null;n!==null;)t=n.alternate,t!==null&&Id(t)===null&&(s=n),n=n.sibling;n=s,n===null?(s=e.child,e.child=null):(s=n.sibling,n.sibling=null),Zf(e,!1,s,n,i);break;case"backwards":for(n=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&Id(t)===null){e.child=s;break}t=s.sibling,s.sibling=n,n=s,s=t}Zf(e,!0,n,null,i);break;case"together":Zf(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Mu(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Gr(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),Fi|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(H(153));if(e.child!==null){for(t=e.child,n=Ms(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Ms(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function u1(t,e,n){switch(e.tag){case 3:tx(e),sa();break;case 5:R0(e);break;case 1:xn(e.type)&&gd(e);break;case 4:Og(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,s=e.memoizedProps.value;st(vd,r._currentValue),r._currentValue=s;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(st(pt,pt.current&1),e.flags|=128,null):n&e.child.childLanes?nx(t,e,n):(st(pt,pt.current&1),t=Gr(t,e,n),t!==null?t.sibling:null);st(pt,pt.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return rx(t,e,n);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),st(pt,pt.current),r)break;return null;case 22:case 23:return e.lanes=0,Z0(t,e,n)}return Gr(t,e,n)}var sx,pm,ix,ox;sx=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};pm=function(){};ix=function(t,e,n,r){var s=t.memoizedProps;if(s!==r){t=e.stateNode,Si(Rr.current);var i=null;switch(n){case"input":s=Vp(t,s),r=Vp(t,r),i=[];break;case"select":s=yt({},s,{value:void 0}),r=yt({},r,{value:void 0}),i=[];break;case"textarea":s=Fp(t,s),r=Fp(t,r),i=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=pd)}$p(n,r);var o;n=null;for(d in s)if(!r.hasOwnProperty(d)&&s.hasOwnProperty(d)&&s[d]!=null)if(d==="style"){var a=s[d];for(o in a)a.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&($l.hasOwnProperty(d)?i||(i=[]):(i=i||[]).push(d,null));for(d in r){var l=r[d];if(a=s!=null?s[d]:void 0,r.hasOwnProperty(d)&&l!==a&&(l!=null||a!=null))if(d==="style")if(a){for(o in a)!a.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in l)l.hasOwnProperty(o)&&a[o]!==l[o]&&(n||(n={}),n[o]=l[o])}else n||(i||(i=[]),i.push(d,n)),n=l;else d==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(i=i||[]).push(d,l)):d==="children"?typeof l!="string"&&typeof l!="number"||(i=i||[]).push(d,""+l):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&($l.hasOwnProperty(d)?(l!=null&&d==="onScroll"&&at("scroll",t),i||a===l||(i=[])):(i=i||[]).push(d,l))}n&&(i=i||[]).push("style",n);var d=i;(e.updateQueue=d)&&(e.flags|=4)}};ox=function(t,e,n,r){n!==r&&(e.flags|=4)};function Za(t,e){if(!ut)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function en(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function d1(t,e,n){var r=e.pendingProps;switch(Ag(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return en(e),null;case 1:return xn(e.type)&&md(),en(e),null;case 3:return r=e.stateNode,oa(),lt(Tn),lt(cn),Lg(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(uu(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,rr!==null&&(Im(rr),rr=null))),pm(t,e),en(e),null;case 5:Vg(e);var s=Si(Zl.current);if(n=e.type,t!==null&&e.stateNode!=null)ix(t,e,n,r,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(H(166));return en(e),null}if(t=Si(Rr.current),uu(e)){r=e.stateNode,n=e.type;var i=e.memoizedProps;switch(r[xr]=e,r[Xl]=i,t=(e.mode&1)!==0,n){case"dialog":at("cancel",r),at("close",r);break;case"iframe":case"object":case"embed":at("load",r);break;case"video":case"audio":for(s=0;s<hl.length;s++)at(hl[s],r);break;case"source":at("error",r);break;case"img":case"image":case"link":at("error",r),at("load",r);break;case"details":at("toggle",r);break;case"input":xv(r,i),at("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},at("invalid",r);break;case"textarea":bv(r,i),at("invalid",r)}$p(n,i),s=null;for(var o in i)if(i.hasOwnProperty(o)){var a=i[o];o==="children"?typeof a=="string"?r.textContent!==a&&(i.suppressHydrationWarning!==!0&&cu(r.textContent,a,t),s=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(i.suppressHydrationWarning!==!0&&cu(r.textContent,a,t),s=["children",""+a]):$l.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&at("scroll",r)}switch(n){case"input":tu(r),Sv(r,i,!0);break;case"textarea":tu(r),Cv(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=pd)}r=s,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=jT(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[xr]=e,t[Xl]=r,sx(t,e,!1,!1),e.stateNode=t;e:{switch(o=Bp(n,r),n){case"dialog":at("cancel",t),at("close",t),s=r;break;case"iframe":case"object":case"embed":at("load",t),s=r;break;case"video":case"audio":for(s=0;s<hl.length;s++)at(hl[s],t);s=r;break;case"source":at("error",t),s=r;break;case"img":case"image":case"link":at("error",t),at("load",t),s=r;break;case"details":at("toggle",t),s=r;break;case"input":xv(t,r),s=Vp(t,r),at("invalid",t);break;case"option":s=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},s=yt({},r,{value:void 0}),at("invalid",t);break;case"textarea":bv(t,r),s=Fp(t,r),at("invalid",t);break;default:s=r}$p(n,s),a=s;for(i in a)if(a.hasOwnProperty(i)){var l=a[i];i==="style"?LT(t,l):i==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&OT(t,l)):i==="children"?typeof l=="string"?(n!=="textarea"||l!=="")&&Bl(t,l):typeof l=="number"&&Bl(t,""+l):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&($l.hasOwnProperty(i)?l!=null&&i==="onScroll"&&at("scroll",t):l!=null&&fg(t,i,l,o))}switch(n){case"input":tu(t),Sv(t,r,!1);break;case"textarea":tu(t),Cv(t);break;case"option":r.value!=null&&t.setAttribute("value",""+Hs(r.value));break;case"select":t.multiple=!!r.multiple,i=r.value,i!=null?Bo(t,!!r.multiple,i,!1):r.defaultValue!=null&&Bo(t,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=pd)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return en(e),null;case 6:if(t&&e.stateNode!=null)ox(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(H(166));if(n=Si(Zl.current),Si(Rr.current),uu(e)){if(r=e.stateNode,n=e.memoizedProps,r[xr]=e,(i=r.nodeValue!==n)&&(t=Dn,t!==null))switch(t.tag){case 3:cu(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&cu(r.nodeValue,n,(t.mode&1)!==0)}i&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[xr]=e,e.stateNode=r}return en(e),null;case 13:if(lt(pt),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(ut&&Nn!==null&&e.mode&1&&!(e.flags&128))x0(),sa(),e.flags|=98560,i=!1;else if(i=uu(e),r!==null&&r.dehydrated!==null){if(t===null){if(!i)throw Error(H(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(H(317));i[xr]=e}else sa(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;en(e),i=!1}else rr!==null&&(Im(rr),rr=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||pt.current&1?Ot===0&&(Ot=3):Qg())),e.updateQueue!==null&&(e.flags|=4),en(e),null);case 4:return oa(),pm(t,e),t===null&&Ql(e.stateNode.containerInfo),en(e),null;case 10:return kg(e.type._context),en(e),null;case 17:return xn(e.type)&&md(),en(e),null;case 19:if(lt(pt),i=e.memoizedState,i===null)return en(e),null;if(r=(e.flags&128)!==0,o=i.rendering,o===null)if(r)Za(i,!1);else{if(Ot!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=Id(t),o!==null){for(e.flags|=128,Za(i,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)i=n,t=r,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,t=o.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return st(pt,pt.current&1|2),e.child}t=t.sibling}i.tail!==null&&St()>la&&(e.flags|=128,r=!0,Za(i,!1),e.lanes=4194304)}else{if(!r)if(t=Id(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Za(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!ut)return en(e),null}else 2*St()-i.renderingStartTime>la&&n!==1073741824&&(e.flags|=128,r=!0,Za(i,!1),e.lanes=4194304);i.isBackwards?(o.sibling=e.child,e.child=o):(n=i.last,n!==null?n.sibling=o:e.child=o,i.last=o)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=St(),e.sibling=null,n=pt.current,st(pt,r?n&1|2:n&1),e):(en(e),null);case 22:case 23:return Gg(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?Rn&1073741824&&(en(e),e.subtreeFlags&6&&(e.flags|=8192)):en(e),null;case 24:return null;case 25:return null}throw Error(H(156,e.tag))}function h1(t,e){switch(Ag(e),e.tag){case 1:return xn(e.type)&&md(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return oa(),lt(Tn),lt(cn),Lg(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return Vg(e),null;case 13:if(lt(pt),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(H(340));sa()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return lt(pt),null;case 4:return oa(),null;case 10:return kg(e.type._context),null;case 22:case 23:return Gg(),null;case 24:return null;default:return null}}var fu=!1,rn=!1,f1=typeof WeakSet=="function"?WeakSet:Set,ie=null;function Fo(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){vt(t,e,r)}else n.current=null}function mm(t,e,n){try{n()}catch(r){vt(t,e,r)}}var gw=!1;function p1(t,e){if(Jp=dd,t=d0(),bg(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var o=0,a=-1,l=-1,d=0,h=0,f=t,m=null;t:for(;;){for(var w;f!==n||s!==0&&f.nodeType!==3||(a=o+s),f!==i||r!==0&&f.nodeType!==3||(l=o+r),f.nodeType===3&&(o+=f.nodeValue.length),(w=f.firstChild)!==null;)m=f,f=w;for(;;){if(f===t)break t;if(m===n&&++d===s&&(a=o),m===i&&++h===r&&(l=o),(w=f.nextSibling)!==null)break;f=m,m=f.parentNode}f=w}n=a===-1||l===-1?null:{start:a,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(Zp={focusedElem:t,selectionRange:n},dd=!1,ie=e;ie!==null;)if(e=ie,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,ie=t;else for(;ie!==null;){e=ie;try{var A=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(A!==null){var b=A.memoizedProps,P=A.memoizedState,I=e.stateNode,E=I.getSnapshotBeforeUpdate(e.elementType===e.type?b:er(e.type,b),P);I.__reactInternalSnapshotBeforeUpdate=E}break;case 3:var y=e.stateNode.containerInfo;y.nodeType===1?y.textContent="":y.nodeType===9&&y.documentElement&&y.removeChild(y.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(H(163))}}catch(j){vt(e,e.return,j)}if(t=e.sibling,t!==null){t.return=e.return,ie=t;break}ie=e.return}return A=gw,gw=!1,A}function Al(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&t)===t){var i=s.destroy;s.destroy=void 0,i!==void 0&&mm(e,n,i)}s=s.next}while(s!==r)}}function _h(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function gm(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function ax(t){var e=t.alternate;e!==null&&(t.alternate=null,ax(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[xr],delete e[Xl],delete e[nm],delete e[YP],delete e[XP])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function lx(t){return t.tag===5||t.tag===3||t.tag===4}function yw(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||lx(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function ym(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=pd));else if(r!==4&&(t=t.child,t!==null))for(ym(t,e,n),t=t.sibling;t!==null;)ym(t,e,n),t=t.sibling}function _m(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(_m(t,e,n),t=t.sibling;t!==null;)_m(t,e,n),t=t.sibling}var qt=null,tr=!1;function hs(t,e,n){for(n=n.child;n!==null;)cx(t,e,n),n=n.sibling}function cx(t,e,n){if(Ar&&typeof Ar.onCommitFiberUnmount=="function")try{Ar.onCommitFiberUnmount(uh,n)}catch{}switch(n.tag){case 5:rn||Fo(n,e);case 6:var r=qt,s=tr;qt=null,hs(t,e,n),qt=r,tr=s,qt!==null&&(tr?(t=qt,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):qt.removeChild(n.stateNode));break;case 18:qt!==null&&(tr?(t=qt,n=n.stateNode,t.nodeType===8?Wf(t.parentNode,n):t.nodeType===1&&Wf(t,n),Wl(t)):Wf(qt,n.stateNode));break;case 4:r=qt,s=tr,qt=n.stateNode.containerInfo,tr=!0,hs(t,e,n),qt=r,tr=s;break;case 0:case 11:case 14:case 15:if(!rn&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var i=s,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&mm(n,e,o),s=s.next}while(s!==r)}hs(t,e,n);break;case 1:if(!rn&&(Fo(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(a){vt(n,e,a)}hs(t,e,n);break;case 21:hs(t,e,n);break;case 22:n.mode&1?(rn=(r=rn)||n.memoizedState!==null,hs(t,e,n),rn=r):hs(t,e,n);break;default:hs(t,e,n)}}function _w(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new f1),e.forEach(function(r){var s=T1.bind(null,t,r);n.has(r)||(n.add(r),r.then(s,s))})}}function Zn(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var i=t,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:qt=a.stateNode,tr=!1;break e;case 3:qt=a.stateNode.containerInfo,tr=!0;break e;case 4:qt=a.stateNode.containerInfo,tr=!0;break e}a=a.return}if(qt===null)throw Error(H(160));cx(i,o,s),qt=null,tr=!1;var l=s.alternate;l!==null&&(l.return=null),s.return=null}catch(d){vt(s,e,d)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)ux(e,t),e=e.sibling}function ux(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Zn(e,t),vr(t),r&4){try{Al(3,t,t.return),_h(3,t)}catch(b){vt(t,t.return,b)}try{Al(5,t,t.return)}catch(b){vt(t,t.return,b)}}break;case 1:Zn(e,t),vr(t),r&512&&n!==null&&Fo(n,n.return);break;case 5:if(Zn(e,t),vr(t),r&512&&n!==null&&Fo(n,n.return),t.flags&32){var s=t.stateNode;try{Bl(s,"")}catch(b){vt(t,t.return,b)}}if(r&4&&(s=t.stateNode,s!=null)){var i=t.memoizedProps,o=n!==null?n.memoizedProps:i,a=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{a==="input"&&i.type==="radio"&&i.name!=null&&kT(s,i),Bp(a,o);var d=Bp(a,i);for(o=0;o<l.length;o+=2){var h=l[o],f=l[o+1];h==="style"?LT(s,f):h==="dangerouslySetInnerHTML"?OT(s,f):h==="children"?Bl(s,f):fg(s,h,f,d)}switch(a){case"input":Lp(s,i);break;case"textarea":DT(s,i);break;case"select":var m=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var w=i.value;w!=null?Bo(s,!!i.multiple,w,!1):m!==!!i.multiple&&(i.defaultValue!=null?Bo(s,!!i.multiple,i.defaultValue,!0):Bo(s,!!i.multiple,i.multiple?[]:"",!1))}s[Xl]=i}catch(b){vt(t,t.return,b)}}break;case 6:if(Zn(e,t),vr(t),r&4){if(t.stateNode===null)throw Error(H(162));s=t.stateNode,i=t.memoizedProps;try{s.nodeValue=i}catch(b){vt(t,t.return,b)}}break;case 3:if(Zn(e,t),vr(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Wl(e.containerInfo)}catch(b){vt(t,t.return,b)}break;case 4:Zn(e,t),vr(t);break;case 13:Zn(e,t),vr(t),s=t.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(Wg=St())),r&4&&_w(t);break;case 22:if(h=n!==null&&n.memoizedState!==null,t.mode&1?(rn=(d=rn)||h,Zn(e,t),rn=d):Zn(e,t),vr(t),r&8192){if(d=t.memoizedState!==null,(t.stateNode.isHidden=d)&&!h&&t.mode&1)for(ie=t,h=t.child;h!==null;){for(f=ie=h;ie!==null;){switch(m=ie,w=m.child,m.tag){case 0:case 11:case 14:case 15:Al(4,m,m.return);break;case 1:Fo(m,m.return);var A=m.stateNode;if(typeof A.componentWillUnmount=="function"){r=m,n=m.return;try{e=r,A.props=e.memoizedProps,A.state=e.memoizedState,A.componentWillUnmount()}catch(b){vt(r,n,b)}}break;case 5:Fo(m,m.return);break;case 22:if(m.memoizedState!==null){ww(f);continue}}w!==null?(w.return=m,ie=w):ww(f)}h=h.sibling}e:for(h=null,f=t;;){if(f.tag===5){if(h===null){h=f;try{s=f.stateNode,d?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(a=f.stateNode,l=f.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=VT("display",o))}catch(b){vt(t,t.return,b)}}}else if(f.tag===6){if(h===null)try{f.stateNode.nodeValue=d?"":f.memoizedProps}catch(b){vt(t,t.return,b)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===t)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===t)break e;for(;f.sibling===null;){if(f.return===null||f.return===t)break e;h===f&&(h=null),f=f.return}h===f&&(h=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:Zn(e,t),vr(t),r&4&&_w(t);break;case 21:break;default:Zn(e,t),vr(t)}}function vr(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(lx(n)){var r=n;break e}n=n.return}throw Error(H(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(Bl(s,""),r.flags&=-33);var i=yw(t);_m(t,i,s);break;case 3:case 4:var o=r.stateNode.containerInfo,a=yw(t);ym(t,a,o);break;default:throw Error(H(161))}}catch(l){vt(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function m1(t,e,n){ie=t,dx(t)}function dx(t,e,n){for(var r=(t.mode&1)!==0;ie!==null;){var s=ie,i=s.child;if(s.tag===22&&r){var o=s.memoizedState!==null||fu;if(!o){var a=s.alternate,l=a!==null&&a.memoizedState!==null||rn;a=fu;var d=rn;if(fu=o,(rn=l)&&!d)for(ie=s;ie!==null;)o=ie,l=o.child,o.tag===22&&o.memoizedState!==null?Ew(s):l!==null?(l.return=o,ie=l):Ew(s);for(;i!==null;)ie=i,dx(i),i=i.sibling;ie=s,fu=a,rn=d}vw(t)}else s.subtreeFlags&8772&&i!==null?(i.return=s,ie=i):vw(t)}}function vw(t){for(;ie!==null;){var e=ie;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:rn||_h(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!rn)if(n===null)r.componentDidMount();else{var s=e.elementType===e.type?n.memoizedProps:er(e.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&rw(e,i,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}rw(e,o,n)}break;case 5:var a=e.stateNode;if(n===null&&e.flags&4){n=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var d=e.alternate;if(d!==null){var h=d.memoizedState;if(h!==null){var f=h.dehydrated;f!==null&&Wl(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(H(163))}rn||e.flags&512&&gm(e)}catch(m){vt(e,e.return,m)}}if(e===t){ie=null;break}if(n=e.sibling,n!==null){n.return=e.return,ie=n;break}ie=e.return}}function ww(t){for(;ie!==null;){var e=ie;if(e===t){ie=null;break}var n=e.sibling;if(n!==null){n.return=e.return,ie=n;break}ie=e.return}}function Ew(t){for(;ie!==null;){var e=ie;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{_h(4,e)}catch(l){vt(e,n,l)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var s=e.return;try{r.componentDidMount()}catch(l){vt(e,s,l)}}var i=e.return;try{gm(e)}catch(l){vt(e,i,l)}break;case 5:var o=e.return;try{gm(e)}catch(l){vt(e,o,l)}}}catch(l){vt(e,e.return,l)}if(e===t){ie=null;break}var a=e.sibling;if(a!==null){a.return=e.return,ie=a;break}ie=e.return}}var g1=Math.ceil,Sd=ts.ReactCurrentDispatcher,qg=ts.ReactCurrentOwner,Wn=ts.ReactCurrentBatchConfig,Be=0,zt=null,At=null,Yt=0,Rn=0,Uo=Zs(0),Ot=0,rc=null,Fi=0,vh=0,Hg=0,Rl=null,wn=null,Wg=0,la=1/0,Vr=null,bd=!1,vm=null,Vs=null,pu=!1,Rs=null,Cd=0,Pl=0,wm=null,Fu=-1,Uu=0;function pn(){return Be&6?St():Fu!==-1?Fu:Fu=St()}function Ls(t){return t.mode&1?Be&2&&Yt!==0?Yt&-Yt:ZP.transition!==null?(Uu===0&&(Uu=QT()),Uu):(t=Xe,t!==0||(t=window.event,t=t===void 0?16:n0(t.type)),t):1}function ar(t,e,n,r){if(50<Pl)throw Pl=0,wm=null,Error(H(185));wc(t,n,r),(!(Be&2)||t!==zt)&&(t===zt&&(!(Be&2)&&(vh|=n),Ot===4&&ws(t,Yt)),Sn(t,r),n===1&&Be===0&&!(e.mode&1)&&(la=St()+500,mh&&ei()))}function Sn(t,e){var n=t.callbackNode;ZR(t,e);var r=ud(t,t===zt?Yt:0);if(r===0)n!==null&&Pv(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&Pv(n),e===1)t.tag===0?JP(Iw.bind(null,t)):E0(Iw.bind(null,t)),GP(function(){!(Be&6)&&ei()}),n=null;else{switch(YT(r)){case 1:n=_g;break;case 4:n=KT;break;case 16:n=cd;break;case 536870912:n=GT;break;default:n=cd}n=vx(n,hx.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function hx(t,e){if(Fu=-1,Uu=0,Be&6)throw Error(H(327));var n=t.callbackNode;if(Ko()&&t.callbackNode!==n)return null;var r=ud(t,t===zt?Yt:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=Ad(t,r);else{e=r;var s=Be;Be|=2;var i=px();(zt!==t||Yt!==e)&&(Vr=null,la=St()+500,Ai(t,e));do try{v1();break}catch(a){fx(t,a)}while(!0);Ng(),Sd.current=i,Be=s,At!==null?e=0:(zt=null,Yt=0,e=Ot)}if(e!==0){if(e===2&&(s=Kp(t),s!==0&&(r=s,e=Em(t,s))),e===1)throw n=rc,Ai(t,0),ws(t,r),Sn(t,St()),n;if(e===6)ws(t,r);else{if(s=t.current.alternate,!(r&30)&&!y1(s)&&(e=Ad(t,r),e===2&&(i=Kp(t),i!==0&&(r=i,e=Em(t,i))),e===1))throw n=rc,Ai(t,0),ws(t,r),Sn(t,St()),n;switch(t.finishedWork=s,t.finishedLanes=r,e){case 0:case 1:throw Error(H(345));case 2:pi(t,wn,Vr);break;case 3:if(ws(t,r),(r&130023424)===r&&(e=Wg+500-St(),10<e)){if(ud(t,0)!==0)break;if(s=t.suspendedLanes,(s&r)!==r){pn(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=tm(pi.bind(null,t,wn,Vr),e);break}pi(t,wn,Vr);break;case 4:if(ws(t,r),(r&4194240)===r)break;for(e=t.eventTimes,s=-1;0<r;){var o=31-or(r);i=1<<o,o=e[o],o>s&&(s=o),r&=~i}if(r=s,r=St()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*g1(r/1960))-r,10<r){t.timeoutHandle=tm(pi.bind(null,t,wn,Vr),r);break}pi(t,wn,Vr);break;case 5:pi(t,wn,Vr);break;default:throw Error(H(329))}}}return Sn(t,St()),t.callbackNode===n?hx.bind(null,t):null}function Em(t,e){var n=Rl;return t.current.memoizedState.isDehydrated&&(Ai(t,e).flags|=256),t=Ad(t,e),t!==2&&(e=wn,wn=n,e!==null&&Im(e)),t}function Im(t){wn===null?wn=t:wn.push.apply(wn,t)}function y1(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],i=s.getSnapshot;s=s.value;try{if(!cr(i(),s))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function ws(t,e){for(e&=~Hg,e&=~vh,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-or(e),r=1<<n;t[n]=-1,e&=~r}}function Iw(t){if(Be&6)throw Error(H(327));Ko();var e=ud(t,0);if(!(e&1))return Sn(t,St()),null;var n=Ad(t,e);if(t.tag!==0&&n===2){var r=Kp(t);r!==0&&(e=r,n=Em(t,r))}if(n===1)throw n=rc,Ai(t,0),ws(t,e),Sn(t,St()),n;if(n===6)throw Error(H(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,pi(t,wn,Vr),Sn(t,St()),null}function Kg(t,e){var n=Be;Be|=1;try{return t(e)}finally{Be=n,Be===0&&(la=St()+500,mh&&ei())}}function Ui(t){Rs!==null&&Rs.tag===0&&!(Be&6)&&Ko();var e=Be;Be|=1;var n=Wn.transition,r=Xe;try{if(Wn.transition=null,Xe=1,t)return t()}finally{Xe=r,Wn.transition=n,Be=e,!(Be&6)&&ei()}}function Gg(){Rn=Uo.current,lt(Uo)}function Ai(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,KP(n)),At!==null)for(n=At.return;n!==null;){var r=n;switch(Ag(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&md();break;case 3:oa(),lt(Tn),lt(cn),Lg();break;case 5:Vg(r);break;case 4:oa();break;case 13:lt(pt);break;case 19:lt(pt);break;case 10:kg(r.type._context);break;case 22:case 23:Gg()}n=n.return}if(zt=t,At=t=Ms(t.current,null),Yt=Rn=e,Ot=0,rc=null,Hg=vh=Fi=0,wn=Rl=null,xi!==null){for(e=0;e<xi.length;e++)if(n=xi[e],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,i=n.pending;if(i!==null){var o=i.next;i.next=s,r.next=o}n.pending=r}xi=null}return t}function fx(t,e){do{var n=At;try{if(Ng(),Vu.current=xd,Td){for(var r=gt.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}Td=!1}if(Mi=0,Bt=jt=gt=null,Cl=!1,ec=0,qg.current=null,n===null||n.return===null){Ot=1,rc=e,At=null;break}e:{var i=t,o=n.return,a=n,l=e;if(e=Yt,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var d=l,h=a,f=h.tag;if(!(h.mode&1)&&(f===0||f===11||f===15)){var m=h.alternate;m?(h.updateQueue=m.updateQueue,h.memoizedState=m.memoizedState,h.lanes=m.lanes):(h.updateQueue=null,h.memoizedState=null)}var w=cw(o);if(w!==null){w.flags&=-257,uw(w,o,a,i,e),w.mode&1&&lw(i,d,e),e=w,l=d;var A=e.updateQueue;if(A===null){var b=new Set;b.add(l),e.updateQueue=b}else A.add(l);break e}else{if(!(e&1)){lw(i,d,e),Qg();break e}l=Error(H(426))}}else if(ut&&a.mode&1){var P=cw(o);if(P!==null){!(P.flags&65536)&&(P.flags|=256),uw(P,o,a,i,e),Rg(aa(l,a));break e}}i=l=aa(l,a),Ot!==4&&(Ot=2),Rl===null?Rl=[i]:Rl.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var I=Y0(i,l,e);nw(i,I);break e;case 1:a=l;var E=i.type,y=i.stateNode;if(!(i.flags&128)&&(typeof E.getDerivedStateFromError=="function"||y!==null&&typeof y.componentDidCatch=="function"&&(Vs===null||!Vs.has(y)))){i.flags|=65536,e&=-e,i.lanes|=e;var j=X0(i,a,e);nw(i,j);break e}}i=i.return}while(i!==null)}gx(n)}catch(V){e=V,At===n&&n!==null&&(At=n=n.return);continue}break}while(!0)}function px(){var t=Sd.current;return Sd.current=xd,t===null?xd:t}function Qg(){(Ot===0||Ot===3||Ot===2)&&(Ot=4),zt===null||!(Fi&268435455)&&!(vh&268435455)||ws(zt,Yt)}function Ad(t,e){var n=Be;Be|=2;var r=px();(zt!==t||Yt!==e)&&(Vr=null,Ai(t,e));do try{_1();break}catch(s){fx(t,s)}while(!0);if(Ng(),Be=n,Sd.current=r,At!==null)throw Error(H(261));return zt=null,Yt=0,Ot}function _1(){for(;At!==null;)mx(At)}function v1(){for(;At!==null&&!qR();)mx(At)}function mx(t){var e=_x(t.alternate,t,Rn);t.memoizedProps=t.pendingProps,e===null?gx(t):At=e,qg.current=null}function gx(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=h1(n,e),n!==null){n.flags&=32767,At=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Ot=6,At=null;return}}else if(n=d1(n,e,Rn),n!==null){At=n;return}if(e=e.sibling,e!==null){At=e;return}At=e=t}while(e!==null);Ot===0&&(Ot=5)}function pi(t,e,n){var r=Xe,s=Wn.transition;try{Wn.transition=null,Xe=1,w1(t,e,n,r)}finally{Wn.transition=s,Xe=r}return null}function w1(t,e,n,r){do Ko();while(Rs!==null);if(Be&6)throw Error(H(327));n=t.finishedWork;var s=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(H(177));t.callbackNode=null,t.callbackPriority=0;var i=n.lanes|n.childLanes;if(eP(t,i),t===zt&&(At=zt=null,Yt=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||pu||(pu=!0,vx(cd,function(){return Ko(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=Wn.transition,Wn.transition=null;var o=Xe;Xe=1;var a=Be;Be|=4,qg.current=null,p1(t,n),ux(n,t),UP(Zp),dd=!!Jp,Zp=Jp=null,t.current=n,m1(n),HR(),Be=a,Xe=o,Wn.transition=i}else t.current=n;if(pu&&(pu=!1,Rs=t,Cd=s),i=t.pendingLanes,i===0&&(Vs=null),GR(n.stateNode),Sn(t,St()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)s=e[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(bd)throw bd=!1,t=vm,vm=null,t;return Cd&1&&t.tag!==0&&Ko(),i=t.pendingLanes,i&1?t===wm?Pl++:(Pl=0,wm=t):Pl=0,ei(),null}function Ko(){if(Rs!==null){var t=YT(Cd),e=Wn.transition,n=Xe;try{if(Wn.transition=null,Xe=16>t?16:t,Rs===null)var r=!1;else{if(t=Rs,Rs=null,Cd=0,Be&6)throw Error(H(331));var s=Be;for(Be|=4,ie=t.current;ie!==null;){var i=ie,o=i.child;if(ie.flags&16){var a=i.deletions;if(a!==null){for(var l=0;l<a.length;l++){var d=a[l];for(ie=d;ie!==null;){var h=ie;switch(h.tag){case 0:case 11:case 15:Al(8,h,i)}var f=h.child;if(f!==null)f.return=h,ie=f;else for(;ie!==null;){h=ie;var m=h.sibling,w=h.return;if(ax(h),h===d){ie=null;break}if(m!==null){m.return=w,ie=m;break}ie=w}}}var A=i.alternate;if(A!==null){var b=A.child;if(b!==null){A.child=null;do{var P=b.sibling;b.sibling=null,b=P}while(b!==null)}}ie=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,ie=o;else e:for(;ie!==null;){if(i=ie,i.flags&2048)switch(i.tag){case 0:case 11:case 15:Al(9,i,i.return)}var I=i.sibling;if(I!==null){I.return=i.return,ie=I;break e}ie=i.return}}var E=t.current;for(ie=E;ie!==null;){o=ie;var y=o.child;if(o.subtreeFlags&2064&&y!==null)y.return=o,ie=y;else e:for(o=E;ie!==null;){if(a=ie,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:_h(9,a)}}catch(V){vt(a,a.return,V)}if(a===o){ie=null;break e}var j=a.sibling;if(j!==null){j.return=a.return,ie=j;break e}ie=a.return}}if(Be=s,ei(),Ar&&typeof Ar.onPostCommitFiberRoot=="function")try{Ar.onPostCommitFiberRoot(uh,t)}catch{}r=!0}return r}finally{Xe=n,Wn.transition=e}}return!1}function Tw(t,e,n){e=aa(n,e),e=Y0(t,e,1),t=Os(t,e,1),e=pn(),t!==null&&(wc(t,1,e),Sn(t,e))}function vt(t,e,n){if(t.tag===3)Tw(t,t,n);else for(;e!==null;){if(e.tag===3){Tw(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Vs===null||!Vs.has(r))){t=aa(n,t),t=X0(e,t,1),e=Os(e,t,1),t=pn(),e!==null&&(wc(e,1,t),Sn(e,t));break}}e=e.return}}function E1(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=pn(),t.pingedLanes|=t.suspendedLanes&n,zt===t&&(Yt&n)===n&&(Ot===4||Ot===3&&(Yt&130023424)===Yt&&500>St()-Wg?Ai(t,0):Hg|=n),Sn(t,e)}function yx(t,e){e===0&&(t.mode&1?(e=su,su<<=1,!(su&130023424)&&(su=4194304)):e=1);var n=pn();t=Kr(t,e),t!==null&&(wc(t,e,n),Sn(t,n))}function I1(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),yx(t,n)}function T1(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,s=t.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(H(314))}r!==null&&r.delete(e),yx(t,n)}var _x;_x=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||Tn.current)En=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return En=!1,u1(t,e,n);En=!!(t.flags&131072)}else En=!1,ut&&e.flags&1048576&&I0(e,_d,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;Mu(t,e),t=e.pendingProps;var s=ra(e,cn.current);Wo(e,n),s=Fg(null,e,r,t,s,n);var i=Ug();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,xn(r)?(i=!0,gd(e)):i=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,jg(e),s.updater=yh,e.stateNode=s,s._reactInternals=e,lm(e,r,t,n),e=dm(null,e,r,!0,i,n)):(e.tag=0,ut&&i&&Cg(e),dn(null,e,s,n),e=e.child),e;case 16:r=e.elementType;e:{switch(Mu(t,e),t=e.pendingProps,s=r._init,r=s(r._payload),e.type=r,s=e.tag=S1(r),t=er(r,t),s){case 0:e=um(null,e,r,t,n);break e;case 1:e=fw(null,e,r,t,n);break e;case 11:e=dw(null,e,r,t,n);break e;case 14:e=hw(null,e,r,er(r.type,t),n);break e}throw Error(H(306,r,""))}return e;case 0:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:er(r,s),um(t,e,r,s,n);case 1:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:er(r,s),fw(t,e,r,s,n);case 3:e:{if(tx(e),t===null)throw Error(H(387));r=e.pendingProps,i=e.memoizedState,s=i.element,A0(t,e),Ed(e,r,null,n);var o=e.memoizedState;if(r=o.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){s=aa(Error(H(423)),e),e=pw(t,e,r,n,s);break e}else if(r!==s){s=aa(Error(H(424)),e),e=pw(t,e,r,n,s);break e}else for(Nn=js(e.stateNode.containerInfo.firstChild),Dn=e,ut=!0,rr=null,n=b0(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(sa(),r===s){e=Gr(t,e,n);break e}dn(t,e,r,n)}e=e.child}return e;case 5:return R0(e),t===null&&im(e),r=e.type,s=e.pendingProps,i=t!==null?t.memoizedProps:null,o=s.children,em(r,s)?o=null:i!==null&&em(r,i)&&(e.flags|=32),ex(t,e),dn(t,e,o,n),e.child;case 6:return t===null&&im(e),null;case 13:return nx(t,e,n);case 4:return Og(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=ia(e,null,r,n):dn(t,e,r,n),e.child;case 11:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:er(r,s),dw(t,e,r,s,n);case 7:return dn(t,e,e.pendingProps,n),e.child;case 8:return dn(t,e,e.pendingProps.children,n),e.child;case 12:return dn(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,s=e.pendingProps,i=e.memoizedProps,o=s.value,st(vd,r._currentValue),r._currentValue=o,i!==null)if(cr(i.value,o)){if(i.children===s.children&&!Tn.current){e=Gr(t,e,n);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var a=i.dependencies;if(a!==null){o=i.child;for(var l=a.firstContext;l!==null;){if(l.context===r){if(i.tag===1){l=zr(-1,n&-n),l.tag=2;var d=i.updateQueue;if(d!==null){d=d.shared;var h=d.pending;h===null?l.next=l:(l.next=h.next,h.next=l),d.pending=l}}i.lanes|=n,l=i.alternate,l!==null&&(l.lanes|=n),om(i.return,n,e),a.lanes|=n;break}l=l.next}}else if(i.tag===10)o=i.type===e.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(H(341));o.lanes|=n,a=o.alternate,a!==null&&(a.lanes|=n),om(o,n,e),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===e){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}dn(t,e,s.children,n),e=e.child}return e;case 9:return s=e.type,r=e.pendingProps.children,Wo(e,n),s=Gn(s),r=r(s),e.flags|=1,dn(t,e,r,n),e.child;case 14:return r=e.type,s=er(r,e.pendingProps),s=er(r.type,s),hw(t,e,r,s,n);case 15:return J0(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:er(r,s),Mu(t,e),e.tag=1,xn(r)?(t=!0,gd(e)):t=!1,Wo(e,n),Q0(e,r,s),lm(e,r,s,n),dm(null,e,r,!0,t,n);case 19:return rx(t,e,n);case 22:return Z0(t,e,n)}throw Error(H(156,e.tag))};function vx(t,e){return WT(t,e)}function x1(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function qn(t,e,n,r){return new x1(t,e,n,r)}function Yg(t){return t=t.prototype,!(!t||!t.isReactComponent)}function S1(t){if(typeof t=="function")return Yg(t)?1:0;if(t!=null){if(t=t.$$typeof,t===mg)return 11;if(t===gg)return 14}return 2}function Ms(t,e){var n=t.alternate;return n===null?(n=qn(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function $u(t,e,n,r,s,i){var o=2;if(r=t,typeof t=="function")Yg(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case Po:return Ri(n.children,s,i,e);case pg:o=8,s|=8;break;case kp:return t=qn(12,n,e,s|2),t.elementType=kp,t.lanes=i,t;case Dp:return t=qn(13,n,e,s),t.elementType=Dp,t.lanes=i,t;case jp:return t=qn(19,n,e,s),t.elementType=jp,t.lanes=i,t;case RT:return wh(n,s,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case CT:o=10;break e;case AT:o=9;break e;case mg:o=11;break e;case gg:o=14;break e;case ys:o=16,r=null;break e}throw Error(H(130,t==null?t:typeof t,""))}return e=qn(o,n,e,s),e.elementType=t,e.type=r,e.lanes=i,e}function Ri(t,e,n,r){return t=qn(7,t,r,e),t.lanes=n,t}function wh(t,e,n,r){return t=qn(22,t,r,e),t.elementType=RT,t.lanes=n,t.stateNode={isHidden:!1},t}function ep(t,e,n){return t=qn(6,t,null,e),t.lanes=n,t}function tp(t,e,n){return e=qn(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function b1(t,e,n,r,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Of(0),this.expirationTimes=Of(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Of(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function Xg(t,e,n,r,s,i,o,a,l){return t=new b1(t,e,n,a,l),e===1?(e=1,i===!0&&(e|=8)):e=0,i=qn(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},jg(i),t}function C1(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Ro,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function wx(t){if(!t)return Ws;t=t._reactInternals;e:{if(no(t)!==t||t.tag!==1)throw Error(H(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(xn(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(H(171))}if(t.tag===1){var n=t.type;if(xn(n))return w0(t,n,e)}return e}function Ex(t,e,n,r,s,i,o,a,l){return t=Xg(n,r,!0,t,s,i,o,a,l),t.context=wx(null),n=t.current,r=pn(),s=Ls(n),i=zr(r,s),i.callback=e??null,Os(n,i,s),t.current.lanes=s,wc(t,s,r),Sn(t,r),t}function Eh(t,e,n,r){var s=e.current,i=pn(),o=Ls(s);return n=wx(n),e.context===null?e.context=n:e.pendingContext=n,e=zr(i,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=Os(s,e,o),t!==null&&(ar(t,s,o,i),Ou(t,s,o)),o}function Rd(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function xw(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function Jg(t,e){xw(t,e),(t=t.alternate)&&xw(t,e)}function A1(){return null}var Ix=typeof reportError=="function"?reportError:function(t){console.error(t)};function Zg(t){this._internalRoot=t}Ih.prototype.render=Zg.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(H(409));Eh(t,e,null,null)};Ih.prototype.unmount=Zg.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Ui(function(){Eh(null,t,null,null)}),e[Wr]=null}};function Ih(t){this._internalRoot=t}Ih.prototype.unstable_scheduleHydration=function(t){if(t){var e=ZT();t={blockedOn:null,target:t,priority:e};for(var n=0;n<vs.length&&e!==0&&e<vs[n].priority;n++);vs.splice(n,0,t),n===0&&t0(t)}};function ey(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Th(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function Sw(){}function R1(t,e,n,r,s){if(s){if(typeof r=="function"){var i=r;r=function(){var d=Rd(o);i.call(d)}}var o=Ex(e,r,t,0,null,!1,!1,"",Sw);return t._reactRootContainer=o,t[Wr]=o.current,Ql(t.nodeType===8?t.parentNode:t),Ui(),o}for(;s=t.lastChild;)t.removeChild(s);if(typeof r=="function"){var a=r;r=function(){var d=Rd(l);a.call(d)}}var l=Xg(t,0,!1,null,null,!1,!1,"",Sw);return t._reactRootContainer=l,t[Wr]=l.current,Ql(t.nodeType===8?t.parentNode:t),Ui(function(){Eh(e,l,n,r)}),l}function xh(t,e,n,r,s){var i=n._reactRootContainer;if(i){var o=i;if(typeof s=="function"){var a=s;s=function(){var l=Rd(o);a.call(l)}}Eh(e,o,t,s)}else o=R1(n,e,t,s,r);return Rd(o)}XT=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=dl(e.pendingLanes);n!==0&&(vg(e,n|1),Sn(e,St()),!(Be&6)&&(la=St()+500,ei()))}break;case 13:Ui(function(){var r=Kr(t,1);if(r!==null){var s=pn();ar(r,t,1,s)}}),Jg(t,1)}};wg=function(t){if(t.tag===13){var e=Kr(t,134217728);if(e!==null){var n=pn();ar(e,t,134217728,n)}Jg(t,134217728)}};JT=function(t){if(t.tag===13){var e=Ls(t),n=Kr(t,e);if(n!==null){var r=pn();ar(n,t,e,r)}Jg(t,e)}};ZT=function(){return Xe};e0=function(t,e){var n=Xe;try{return Xe=t,e()}finally{Xe=n}};qp=function(t,e,n){switch(e){case"input":if(Lp(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var s=ph(r);if(!s)throw Error(H(90));NT(r),Lp(r,s)}}}break;case"textarea":DT(t,n);break;case"select":e=n.value,e!=null&&Bo(t,!!n.multiple,e,!1)}};UT=Kg;$T=Ui;var P1={usingClientEntryPoint:!1,Events:[Ic,jo,ph,MT,FT,Kg]},el={findFiberByHostInstance:Ti,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},N1={bundleType:el.bundleType,version:el.version,rendererPackageName:el.rendererPackageName,rendererConfig:el.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ts.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=qT(t),t===null?null:t.stateNode},findFiberByHostInstance:el.findFiberByHostInstance||A1,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var mu=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!mu.isDisabled&&mu.supportsFiber)try{uh=mu.inject(N1),Ar=mu}catch{}}Ln.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=P1;Ln.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!ey(e))throw Error(H(200));return C1(t,e,null,n)};Ln.createRoot=function(t,e){if(!ey(t))throw Error(H(299));var n=!1,r="",s=Ix;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=Xg(t,1,!1,null,null,n,!1,r,s),t[Wr]=e.current,Ql(t.nodeType===8?t.parentNode:t),new Zg(e)};Ln.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(H(188)):(t=Object.keys(t).join(","),Error(H(268,t)));return t=qT(e),t=t===null?null:t.stateNode,t};Ln.flushSync=function(t){return Ui(t)};Ln.hydrate=function(t,e,n){if(!Th(e))throw Error(H(200));return xh(null,t,e,!0,n)};Ln.hydrateRoot=function(t,e,n){if(!ey(t))throw Error(H(405));var r=n!=null&&n.hydratedSources||null,s=!1,i="",o=Ix;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=Ex(e,null,t,1,n??null,s,!1,i,o),t[Wr]=e.current,Ql(t),r)for(t=0;t<r.length;t++)n=r[t],s=n._getVersion,s=s(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,s]:e.mutableSourceEagerHydrationData.push(n,s);return new Ih(e)};Ln.render=function(t,e,n){if(!Th(e))throw Error(H(200));return xh(null,t,e,!1,n)};Ln.unmountComponentAtNode=function(t){if(!Th(t))throw Error(H(40));return t._reactRootContainer?(Ui(function(){xh(null,null,t,!1,function(){t._reactRootContainer=null,t[Wr]=null})}),!0):!1};Ln.unstable_batchedUpdates=Kg;Ln.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!Th(n))throw Error(H(200));if(t==null||t._reactInternals===void 0)throw Error(H(38));return xh(t,e,n,!1,r)};Ln.version="18.3.1-next-f1338f8080-20240426";function Tx(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Tx)}catch(t){console.error(t)}}Tx(),TT.exports=Ln;var k1=TT.exports,xx,bw=k1;xx=bw.createRoot,bw.hydrateRoot;/**
 * react-router v7.9.6
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var Cw="popstate";function D1(t={}){function e(r,s){let{pathname:i,search:o,hash:a}=r.location;return Tm("",{pathname:i,search:o,hash:a},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function n(r,s){return typeof s=="string"?s:sc(s)}return O1(e,n,null,t)}function dt(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function Yn(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function j1(){return Math.random().toString(36).substring(2,10)}function Aw(t,e){return{usr:t.state,key:t.key,idx:e}}function Tm(t,e,n=null,r){return{pathname:typeof t=="string"?t:t.pathname,search:"",hash:"",...typeof e=="string"?ba(e):e,state:n,key:e&&e.key||r||j1()}}function sc({pathname:t="/",search:e="",hash:n=""}){return e&&e!=="?"&&(t+=e.charAt(0)==="?"?e:"?"+e),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function ba(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substring(n),t=t.substring(0,n));let r=t.indexOf("?");r>=0&&(e.search=t.substring(r),t=t.substring(0,r)),t&&(e.pathname=t)}return e}function O1(t,e,n,r={}){let{window:s=document.defaultView,v5Compat:i=!1}=r,o=s.history,a="POP",l=null,d=h();d==null&&(d=0,o.replaceState({...o.state,idx:d},""));function h(){return(o.state||{idx:null}).idx}function f(){a="POP";let P=h(),I=P==null?null:P-d;d=P,l&&l({action:a,location:b.location,delta:I})}function m(P,I){a="PUSH";let E=Tm(b.location,P,I);d=h()+1;let y=Aw(E,d),j=b.createHref(E);try{o.pushState(y,"",j)}catch(V){if(V instanceof DOMException&&V.name==="DataCloneError")throw V;s.location.assign(j)}i&&l&&l({action:a,location:b.location,delta:1})}function w(P,I){a="REPLACE";let E=Tm(b.location,P,I);d=h();let y=Aw(E,d),j=b.createHref(E);o.replaceState(y,"",j),i&&l&&l({action:a,location:b.location,delta:0})}function A(P){return V1(P)}let b={get action(){return a},get location(){return t(s,o)},listen(P){if(l)throw new Error("A history only accepts one active listener");return s.addEventListener(Cw,f),l=P,()=>{s.removeEventListener(Cw,f),l=null}},createHref(P){return e(s,P)},createURL:A,encodeLocation(P){let I=A(P);return{pathname:I.pathname,search:I.search,hash:I.hash}},push:m,replace:w,go(P){return o.go(P)}};return b}function V1(t,e=!1){let n="http://localhost";typeof window<"u"&&(n=window.location.origin!=="null"?window.location.origin:window.location.href),dt(n,"No window.location.(origin|href) available to create URL");let r=typeof t=="string"?t:sc(t);return r=r.replace(/ $/,"%20"),!e&&r.startsWith("//")&&(r=n+r),new URL(r,n)}function Sx(t,e,n="/"){return L1(t,e,n,!1)}function L1(t,e,n,r){let s=typeof e=="string"?ba(e):e,i=Qr(s.pathname||"/",n);if(i==null)return null;let o=bx(t);M1(o);let a=null;for(let l=0;a==null&&l<o.length;++l){let d=Q1(i);a=K1(o[l],d,r)}return a}function bx(t,e=[],n=[],r="",s=!1){let i=(o,a,l=s,d)=>{let h={relativePath:d===void 0?o.path||"":d,caseSensitive:o.caseSensitive===!0,childrenIndex:a,route:o};if(h.relativePath.startsWith("/")){if(!h.relativePath.startsWith(r)&&l)return;dt(h.relativePath.startsWith(r),`Absolute route path "${h.relativePath}" nested under path "${r}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),h.relativePath=h.relativePath.slice(r.length)}let f=qr([r,h.relativePath]),m=n.concat(h);o.children&&o.children.length>0&&(dt(o.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${f}".`),bx(o.children,e,m,f,l)),!(o.path==null&&!o.index)&&e.push({path:f,score:H1(f,o.index),routesMeta:m})};return t.forEach((o,a)=>{var l;if(o.path===""||!((l=o.path)!=null&&l.includes("?")))i(o,a);else for(let d of Cx(o.path))i(o,a,!0,d)}),e}function Cx(t){let e=t.split("/");if(e.length===0)return[];let[n,...r]=e,s=n.endsWith("?"),i=n.replace(/\?$/,"");if(r.length===0)return s?[i,""]:[i];let o=Cx(r.join("/")),a=[];return a.push(...o.map(l=>l===""?i:[i,l].join("/"))),s&&a.push(...o),a.map(l=>t.startsWith("/")&&l===""?"/":l)}function M1(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:W1(e.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}var F1=/^:[\w-]+$/,U1=3,$1=2,B1=1,z1=10,q1=-2,Rw=t=>t==="*";function H1(t,e){let n=t.split("/"),r=n.length;return n.some(Rw)&&(r+=q1),e&&(r+=$1),n.filter(s=>!Rw(s)).reduce((s,i)=>s+(F1.test(i)?U1:i===""?B1:z1),r)}function W1(t,e){return t.length===e.length&&t.slice(0,-1).every((r,s)=>r===e[s])?t[t.length-1]-e[e.length-1]:0}function K1(t,e,n=!1){let{routesMeta:r}=t,s={},i="/",o=[];for(let a=0;a<r.length;++a){let l=r[a],d=a===r.length-1,h=i==="/"?e:e.slice(i.length)||"/",f=Pd({path:l.relativePath,caseSensitive:l.caseSensitive,end:d},h),m=l.route;if(!f&&d&&n&&!r[r.length-1].route.index&&(f=Pd({path:l.relativePath,caseSensitive:l.caseSensitive,end:!1},h)),!f)return null;Object.assign(s,f.params),o.push({params:s,pathname:qr([i,f.pathname]),pathnameBase:eN(qr([i,f.pathnameBase])),route:m}),f.pathnameBase!=="/"&&(i=qr([i,f.pathnameBase]))}return o}function Pd(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,r]=G1(t.path,t.caseSensitive,t.end),s=e.match(n);if(!s)return null;let i=s[0],o=i.replace(/(.)\/+$/,"$1"),a=s.slice(1);return{params:r.reduce((d,{paramName:h,isOptional:f},m)=>{if(h==="*"){let A=a[m]||"";o=i.slice(0,i.length-A.length).replace(/(.)\/+$/,"$1")}const w=a[m];return f&&!w?d[h]=void 0:d[h]=(w||"").replace(/%2F/g,"/"),d},{}),pathname:i,pathnameBase:o,pattern:t}}function G1(t,e=!1,n=!0){Yn(t==="*"||!t.endsWith("*")||t.endsWith("/*"),`Route path "${t}" will be treated as if it were "${t.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${t.replace(/\*$/,"/*")}".`);let r=[],s="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,a,l)=>(r.push({paramName:a,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return t.endsWith("*")?(r.push({paramName:"*"}),s+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?s+="\\/*$":t!==""&&t!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,e?void 0:"i"),r]}function Q1(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Yn(!1,`The URL path "${t}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),t}}function Qr(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,r=t.charAt(n);return r&&r!=="/"?null:t.slice(n)||"/"}var Y1=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,X1=t=>Y1.test(t);function J1(t,e="/"){let{pathname:n,search:r="",hash:s=""}=typeof t=="string"?ba(t):t,i;if(n)if(X1(n))i=n;else{if(n.includes("//")){let o=n;n=n.replace(/\/\/+/g,"/"),Yn(!1,`Pathnames cannot have embedded double slashes - normalizing ${o} -> ${n}`)}n.startsWith("/")?i=Pw(n.substring(1),"/"):i=Pw(n,e)}else i=e;return{pathname:i,search:tN(r),hash:nN(s)}}function Pw(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(s=>{s===".."?n.length>1&&n.pop():s!=="."&&n.push(s)}),n.length>1?n.join("/"):"/"}function np(t,e,n,r){return`Cannot include a '${t}' character in a manually specified \`to.${e}\` field [${JSON.stringify(r)}].  Please separate it out to the \`to.${n}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function Z1(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function ty(t){let e=Z1(t);return e.map((n,r)=>r===e.length-1?n.pathname:n.pathnameBase)}function ny(t,e,n,r=!1){let s;typeof t=="string"?s=ba(t):(s={...t},dt(!s.pathname||!s.pathname.includes("?"),np("?","pathname","search",s)),dt(!s.pathname||!s.pathname.includes("#"),np("#","pathname","hash",s)),dt(!s.search||!s.search.includes("#"),np("#","search","hash",s)));let i=t===""||s.pathname==="",o=i?"/":s.pathname,a;if(o==null)a=n;else{let f=e.length-1;if(!r&&o.startsWith("..")){let m=o.split("/");for(;m[0]==="..";)m.shift(),f-=1;s.pathname=m.join("/")}a=f>=0?e[f]:"/"}let l=J1(s,a),d=o&&o!=="/"&&o.endsWith("/"),h=(i||o===".")&&n.endsWith("/");return!l.pathname.endsWith("/")&&(d||h)&&(l.pathname+="/"),l}var qr=t=>t.join("/").replace(/\/\/+/g,"/"),eN=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),tN=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,nN=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function rN(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var Ax=["POST","PUT","PATCH","DELETE"];new Set(Ax);var sN=["GET",...Ax];new Set(sN);var Ca=N.createContext(null);Ca.displayName="DataRouter";var Sh=N.createContext(null);Sh.displayName="DataRouterState";N.createContext(!1);var Rx=N.createContext({isTransitioning:!1});Rx.displayName="ViewTransition";var iN=N.createContext(new Map);iN.displayName="Fetchers";var oN=N.createContext(null);oN.displayName="Await";var fr=N.createContext(null);fr.displayName="Navigation";var xc=N.createContext(null);xc.displayName="Location";var Or=N.createContext({outlet:null,matches:[],isDataRoute:!1});Or.displayName="Route";var ry=N.createContext(null);ry.displayName="RouteError";function aN(t,{relative:e}={}){dt(Aa(),"useHref() may be used only in the context of a <Router> component.");let{basename:n,navigator:r}=N.useContext(fr),{hash:s,pathname:i,search:o}=Sc(t,{relative:e}),a=i;return n!=="/"&&(a=i==="/"?n:qr([n,i])),r.createHref({pathname:a,search:o,hash:s})}function Aa(){return N.useContext(xc)!=null}function ns(){return dt(Aa(),"useLocation() may be used only in the context of a <Router> component."),N.useContext(xc).location}var Px="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function Nx(t){N.useContext(fr).static||N.useLayoutEffect(t)}function bh(){let{isDataRoute:t}=N.useContext(Or);return t?wN():lN()}function lN(){dt(Aa(),"useNavigate() may be used only in the context of a <Router> component.");let t=N.useContext(Ca),{basename:e,navigator:n}=N.useContext(fr),{matches:r}=N.useContext(Or),{pathname:s}=ns(),i=JSON.stringify(ty(r)),o=N.useRef(!1);return Nx(()=>{o.current=!0}),N.useCallback((l,d={})=>{if(Yn(o.current,Px),!o.current)return;if(typeof l=="number"){n.go(l);return}let h=ny(l,JSON.parse(i),s,d.relative==="path");t==null&&e!=="/"&&(h.pathname=h.pathname==="/"?e:qr([e,h.pathname])),(d.replace?n.replace:n.push)(h,d.state,d)},[e,n,i,s,t])}N.createContext(null);function Sc(t,{relative:e}={}){let{matches:n}=N.useContext(Or),{pathname:r}=ns(),s=JSON.stringify(ty(n));return N.useMemo(()=>ny(t,JSON.parse(s),r,e==="path"),[t,s,r,e])}function cN(t,e){return kx(t,e)}function kx(t,e,n,r,s){var E;dt(Aa(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:i}=N.useContext(fr),{matches:o}=N.useContext(Or),a=o[o.length-1],l=a?a.params:{},d=a?a.pathname:"/",h=a?a.pathnameBase:"/",f=a&&a.route;{let y=f&&f.path||"";Dx(d,!f||y.endsWith("*")||y.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${d}" (under <Route path="${y}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${y}"> to <Route path="${y==="/"?"*":`${y}/*`}">.`)}let m=ns(),w;if(e){let y=typeof e=="string"?ba(e):e;dt(h==="/"||((E=y.pathname)==null?void 0:E.startsWith(h)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${h}" but pathname "${y.pathname}" was given in the \`location\` prop.`),w=y}else w=m;let A=w.pathname||"/",b=A;if(h!=="/"){let y=h.replace(/^\//,"").split("/");b="/"+A.replace(/^\//,"").split("/").slice(y.length).join("/")}let P=Sx(t,{pathname:b});Yn(f||P!=null,`No routes matched location "${w.pathname}${w.search}${w.hash}" `),Yn(P==null||P[P.length-1].route.element!==void 0||P[P.length-1].route.Component!==void 0||P[P.length-1].route.lazy!==void 0,`Matched leaf route at location "${w.pathname}${w.search}${w.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let I=pN(P&&P.map(y=>Object.assign({},y,{params:Object.assign({},l,y.params),pathname:qr([h,i.encodeLocation?i.encodeLocation(y.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:y.pathname]),pathnameBase:y.pathnameBase==="/"?h:qr([h,i.encodeLocation?i.encodeLocation(y.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:y.pathnameBase])})),o,n,r,s);return e&&I?N.createElement(xc.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...w},navigationType:"POP"}},I):I}function uN(){let t=vN(),e=rN(t)?`${t.status} ${t.statusText}`:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,r="rgba(200,200,200, 0.5)",s={padding:"0.5rem",backgroundColor:r},i={padding:"2px 4px",backgroundColor:r},o=null;return console.error("Error handled by React Router default ErrorBoundary:",t),o=N.createElement(N.Fragment,null,N.createElement("p",null," Hey developer "),N.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",N.createElement("code",{style:i},"ErrorBoundary")," or"," ",N.createElement("code",{style:i},"errorElement")," prop on your route.")),N.createElement(N.Fragment,null,N.createElement("h2",null,"Unexpected Application Error!"),N.createElement("h3",{style:{fontStyle:"italic"}},e),n?N.createElement("pre",{style:s},n):null,o)}var dN=N.createElement(uN,null),hN=class extends N.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,e){return e.location!==t.location||e.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:e.error,location:e.location,revalidation:t.revalidation||e.revalidation}}componentDidCatch(t,e){this.props.onError?this.props.onError(t,e):console.error("React Router caught the following error during render",t)}render(){return this.state.error!==void 0?N.createElement(Or.Provider,{value:this.props.routeContext},N.createElement(ry.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function fN({routeContext:t,match:e,children:n}){let r=N.useContext(Ca);return r&&r.static&&r.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=e.route.id),N.createElement(Or.Provider,{value:t},n)}function pN(t,e=[],n=null,r=null,s=null){if(t==null){if(!n)return null;if(n.errors)t=n.matches;else if(e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let i=t,o=n==null?void 0:n.errors;if(o!=null){let h=i.findIndex(f=>f.route.id&&(o==null?void 0:o[f.route.id])!==void 0);dt(h>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(o).join(",")}`),i=i.slice(0,Math.min(i.length,h+1))}let a=!1,l=-1;if(n)for(let h=0;h<i.length;h++){let f=i[h];if((f.route.HydrateFallback||f.route.hydrateFallbackElement)&&(l=h),f.route.id){let{loaderData:m,errors:w}=n,A=f.route.loader&&!m.hasOwnProperty(f.route.id)&&(!w||w[f.route.id]===void 0);if(f.route.lazy||A){a=!0,l>=0?i=i.slice(0,l+1):i=[i[0]];break}}}let d=n&&r?(h,f)=>{var m,w;r(h,{location:n.location,params:((w=(m=n.matches)==null?void 0:m[0])==null?void 0:w.params)??{},errorInfo:f})}:void 0;return i.reduceRight((h,f,m)=>{let w,A=!1,b=null,P=null;n&&(w=o&&f.route.id?o[f.route.id]:void 0,b=f.route.errorElement||dN,a&&(l<0&&m===0?(Dx("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),A=!0,P=null):l===m&&(A=!0,P=f.route.hydrateFallbackElement||null)));let I=e.concat(i.slice(0,m+1)),E=()=>{let y;return w?y=b:A?y=P:f.route.Component?y=N.createElement(f.route.Component,null):f.route.element?y=f.route.element:y=h,N.createElement(fN,{match:f,routeContext:{outlet:h,matches:I,isDataRoute:n!=null},children:y})};return n&&(f.route.ErrorBoundary||f.route.errorElement||m===0)?N.createElement(hN,{location:n.location,revalidation:n.revalidation,component:b,error:w,children:E(),routeContext:{outlet:null,matches:I,isDataRoute:!0},onError:d}):E()},null)}function sy(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function mN(t){let e=N.useContext(Ca);return dt(e,sy(t)),e}function gN(t){let e=N.useContext(Sh);return dt(e,sy(t)),e}function yN(t){let e=N.useContext(Or);return dt(e,sy(t)),e}function iy(t){let e=yN(t),n=e.matches[e.matches.length-1];return dt(n.route.id,`${t} can only be used on routes that contain a unique "id"`),n.route.id}function _N(){return iy("useRouteId")}function vN(){var r;let t=N.useContext(ry),e=gN("useRouteError"),n=iy("useRouteError");return t!==void 0?t:(r=e.errors)==null?void 0:r[n]}function wN(){let{router:t}=mN("useNavigate"),e=iy("useNavigate"),n=N.useRef(!1);return Nx(()=>{n.current=!0}),N.useCallback(async(s,i={})=>{Yn(n.current,Px),n.current&&(typeof s=="number"?t.navigate(s):await t.navigate(s,{fromRouteId:e,...i}))},[t,e])}var Nw={};function Dx(t,e,n){!e&&!Nw[t]&&(Nw[t]=!0,Yn(!1,n))}N.memo(EN);function EN({routes:t,future:e,state:n,unstable_onError:r}){return kx(t,void 0,n,r,e)}function Nd({to:t,replace:e,state:n,relative:r}){dt(Aa(),"<Navigate> may be used only in the context of a <Router> component.");let{static:s}=N.useContext(fr);Yn(!s,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:i}=N.useContext(Or),{pathname:o}=ns(),a=bh(),l=ny(t,ty(i),o,r==="path"),d=JSON.stringify(l);return N.useEffect(()=>{a(JSON.parse(d),{replace:e,state:n,relative:r})},[a,d,r,e,n]),null}function xo(t){dt(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function IN({basename:t="/",children:e=null,location:n,navigationType:r="POP",navigator:s,static:i=!1}){dt(!Aa(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let o=t.replace(/^\/*/,"/"),a=N.useMemo(()=>({basename:o,navigator:s,static:i,future:{}}),[o,s,i]);typeof n=="string"&&(n=ba(n));let{pathname:l="/",search:d="",hash:h="",state:f=null,key:m="default"}=n,w=N.useMemo(()=>{let A=Qr(l,o);return A==null?null:{location:{pathname:A,search:d,hash:h,state:f,key:m},navigationType:r}},[o,l,d,h,f,m,r]);return Yn(w!=null,`<Router basename="${o}"> is not able to match the URL "${l}${d}${h}" because it does not start with the basename, so the <Router> won't render anything.`),w==null?null:N.createElement(fr.Provider,{value:a},N.createElement(xc.Provider,{children:e,value:w}))}function TN({children:t,location:e}){return cN(xm(t),e)}function xm(t,e=[]){let n=[];return N.Children.forEach(t,(r,s)=>{if(!N.isValidElement(r))return;let i=[...e,s];if(r.type===N.Fragment){n.push.apply(n,xm(r.props.children,i));return}dt(r.type===xo,`[${typeof r.type=="string"?r.type:r.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),dt(!r.props.index||!r.props.children,"An index route cannot have child routes.");let o={id:r.props.id||i.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,middleware:r.props.middleware,loader:r.props.loader,action:r.props.action,hydrateFallbackElement:r.props.hydrateFallbackElement,HydrateFallback:r.props.HydrateFallback,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.hasErrorBoundary===!0||r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(o.children=xm(r.props.children,i)),n.push(o)}),n}var Bu="get",zu="application/x-www-form-urlencoded";function Ch(t){return t!=null&&typeof t.tagName=="string"}function xN(t){return Ch(t)&&t.tagName.toLowerCase()==="button"}function SN(t){return Ch(t)&&t.tagName.toLowerCase()==="form"}function bN(t){return Ch(t)&&t.tagName.toLowerCase()==="input"}function CN(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function AN(t,e){return t.button===0&&(!e||e==="_self")&&!CN(t)}var gu=null;function RN(){if(gu===null)try{new FormData(document.createElement("form"),0),gu=!1}catch{gu=!0}return gu}var PN=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function rp(t){return t!=null&&!PN.has(t)?(Yn(!1,`"${t}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${zu}"`),null):t}function NN(t,e){let n,r,s,i,o;if(SN(t)){let a=t.getAttribute("action");r=a?Qr(a,e):null,n=t.getAttribute("method")||Bu,s=rp(t.getAttribute("enctype"))||zu,i=new FormData(t)}else if(xN(t)||bN(t)&&(t.type==="submit"||t.type==="image")){let a=t.form;if(a==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let l=t.getAttribute("formaction")||a.getAttribute("action");if(r=l?Qr(l,e):null,n=t.getAttribute("formmethod")||a.getAttribute("method")||Bu,s=rp(t.getAttribute("formenctype"))||rp(a.getAttribute("enctype"))||zu,i=new FormData(a,t),!RN()){let{name:d,type:h,value:f}=t;if(h==="image"){let m=d?`${d}.`:"";i.append(`${m}x`,"0"),i.append(`${m}y`,"0")}else d&&i.append(d,f)}}else{if(Ch(t))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');n=Bu,r=null,s=zu,o=t}return i&&s==="text/plain"&&(o=i,i=void 0),{action:r,method:n.toLowerCase(),encType:s,formData:i,body:o}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function oy(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function kN(t,e,n){let r=typeof t=="string"?new URL(t,typeof window>"u"?"server://singlefetch/":window.location.origin):t;return r.pathname==="/"?r.pathname=`_root.${n}`:e&&Qr(r.pathname,e)==="/"?r.pathname=`${e.replace(/\/$/,"")}/_root.${n}`:r.pathname=`${r.pathname.replace(/\/$/,"")}.${n}`,r}async function DN(t,e){if(t.id in e)return e[t.id];try{let n=await import(t.module);return e[t.id]=n,n}catch(n){return console.error(`Error loading route module \`${t.module}\`, reloading page...`),console.error(n),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function jN(t){return t==null?!1:t.href==null?t.rel==="preload"&&typeof t.imageSrcSet=="string"&&typeof t.imageSizes=="string":typeof t.rel=="string"&&typeof t.href=="string"}async function ON(t,e,n){let r=await Promise.all(t.map(async s=>{let i=e.routes[s.route.id];if(i){let o=await DN(i,n);return o.links?o.links():[]}return[]}));return FN(r.flat(1).filter(jN).filter(s=>s.rel==="stylesheet"||s.rel==="preload").map(s=>s.rel==="stylesheet"?{...s,rel:"prefetch",as:"style"}:{...s,rel:"prefetch"}))}function kw(t,e,n,r,s,i){let o=(l,d)=>n[d]?l.route.id!==n[d].route.id:!0,a=(l,d)=>{var h;return n[d].pathname!==l.pathname||((h=n[d].route.path)==null?void 0:h.endsWith("*"))&&n[d].params["*"]!==l.params["*"]};return i==="assets"?e.filter((l,d)=>o(l,d)||a(l,d)):i==="data"?e.filter((l,d)=>{var f;let h=r.routes[l.route.id];if(!h||!h.hasLoader)return!1;if(o(l,d)||a(l,d))return!0;if(l.route.shouldRevalidate){let m=l.route.shouldRevalidate({currentUrl:new URL(s.pathname+s.search+s.hash,window.origin),currentParams:((f=n[0])==null?void 0:f.params)||{},nextUrl:new URL(t,window.origin),nextParams:l.params,defaultShouldRevalidate:!0});if(typeof m=="boolean")return m}return!0}):[]}function VN(t,e,{includeHydrateFallback:n}={}){return LN(t.map(r=>{let s=e.routes[r.route.id];if(!s)return[];let i=[s.module];return s.clientActionModule&&(i=i.concat(s.clientActionModule)),s.clientLoaderModule&&(i=i.concat(s.clientLoaderModule)),n&&s.hydrateFallbackModule&&(i=i.concat(s.hydrateFallbackModule)),s.imports&&(i=i.concat(s.imports)),i}).flat(1))}function LN(t){return[...new Set(t)]}function MN(t){let e={},n=Object.keys(t).sort();for(let r of n)e[r]=t[r];return e}function FN(t,e){let n=new Set;return new Set(e),t.reduce((r,s)=>{let i=JSON.stringify(MN(s));return n.has(i)||(n.add(i),r.push({key:i,link:s})),r},[])}function jx(){let t=N.useContext(Ca);return oy(t,"You must render this element inside a <DataRouterContext.Provider> element"),t}function UN(){let t=N.useContext(Sh);return oy(t,"You must render this element inside a <DataRouterStateContext.Provider> element"),t}var ay=N.createContext(void 0);ay.displayName="FrameworkContext";function Ox(){let t=N.useContext(ay);return oy(t,"You must render this element inside a <HydratedRouter> element"),t}function $N(t,e){let n=N.useContext(ay),[r,s]=N.useState(!1),[i,o]=N.useState(!1),{onFocus:a,onBlur:l,onMouseEnter:d,onMouseLeave:h,onTouchStart:f}=e,m=N.useRef(null);N.useEffect(()=>{if(t==="render"&&o(!0),t==="viewport"){let b=I=>{I.forEach(E=>{o(E.isIntersecting)})},P=new IntersectionObserver(b,{threshold:.5});return m.current&&P.observe(m.current),()=>{P.disconnect()}}},[t]),N.useEffect(()=>{if(r){let b=setTimeout(()=>{o(!0)},100);return()=>{clearTimeout(b)}}},[r]);let w=()=>{s(!0)},A=()=>{s(!1),o(!1)};return n?t!=="intent"?[i,m,{}]:[i,m,{onFocus:tl(a,w),onBlur:tl(l,A),onMouseEnter:tl(d,w),onMouseLeave:tl(h,A),onTouchStart:tl(f,w)}]:[!1,m,{}]}function tl(t,e){return n=>{t&&t(n),n.defaultPrevented||e(n)}}function BN({page:t,...e}){let{router:n}=jx(),r=N.useMemo(()=>Sx(n.routes,t,n.basename),[n.routes,t,n.basename]);return r?N.createElement(qN,{page:t,matches:r,...e}):null}function zN(t){let{manifest:e,routeModules:n}=Ox(),[r,s]=N.useState([]);return N.useEffect(()=>{let i=!1;return ON(t,e,n).then(o=>{i||s(o)}),()=>{i=!0}},[t,e,n]),r}function qN({page:t,matches:e,...n}){let r=ns(),{manifest:s,routeModules:i}=Ox(),{basename:o}=jx(),{loaderData:a,matches:l}=UN(),d=N.useMemo(()=>kw(t,e,l,s,r,"data"),[t,e,l,s,r]),h=N.useMemo(()=>kw(t,e,l,s,r,"assets"),[t,e,l,s,r]),f=N.useMemo(()=>{if(t===r.pathname+r.search+r.hash)return[];let A=new Set,b=!1;if(e.forEach(I=>{var y;let E=s.routes[I.route.id];!E||!E.hasLoader||(!d.some(j=>j.route.id===I.route.id)&&I.route.id in a&&((y=i[I.route.id])!=null&&y.shouldRevalidate)||E.hasClientLoader?b=!0:A.add(I.route.id))}),A.size===0)return[];let P=kN(t,o,"data");return b&&A.size>0&&P.searchParams.set("_routes",e.filter(I=>A.has(I.route.id)).map(I=>I.route.id).join(",")),[P.pathname+P.search]},[o,a,r,s,d,e,t,i]),m=N.useMemo(()=>VN(h,s),[h,s]),w=zN(h);return N.createElement(N.Fragment,null,f.map(A=>N.createElement("link",{key:A,rel:"prefetch",as:"fetch",href:A,...n})),m.map(A=>N.createElement("link",{key:A,rel:"modulepreload",href:A,...n})),w.map(({key:A,link:b})=>N.createElement("link",{key:A,nonce:n.nonce,...b})))}function HN(...t){return e=>{t.forEach(n=>{typeof n=="function"?n(e):n!=null&&(n.current=e)})}}var Vx=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{Vx&&(window.__reactRouterVersion="7.9.6")}catch{}function WN({basename:t,children:e,window:n}){let r=N.useRef();r.current==null&&(r.current=D1({window:n,v5Compat:!0}));let s=r.current,[i,o]=N.useState({action:s.action,location:s.location}),a=N.useCallback(l=>{N.startTransition(()=>o(l))},[o]);return N.useLayoutEffect(()=>s.listen(a),[s,a]),N.createElement(IN,{basename:t,children:e,location:i.location,navigationType:i.action,navigator:s})}var Lx=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Mx=N.forwardRef(function({onClick:e,discover:n="render",prefetch:r="none",relative:s,reloadDocument:i,replace:o,state:a,target:l,to:d,preventScrollReset:h,viewTransition:f,...m},w){let{basename:A}=N.useContext(fr),b=typeof d=="string"&&Lx.test(d),P,I=!1;if(typeof d=="string"&&b&&(P=d,Vx))try{let S=new URL(window.location.href),C=d.startsWith("//")?new URL(S.protocol+d):new URL(d),k=Qr(C.pathname,A);C.origin===S.origin&&k!=null?d=k+C.search+C.hash:I=!0}catch{Yn(!1,`<Link to="${d}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let E=aN(d,{relative:s}),[y,j,V]=$N(r,m),M=YN(d,{replace:o,state:a,target:l,preventScrollReset:h,relative:s,viewTransition:f});function T(S){e&&e(S),S.defaultPrevented||M(S)}let _=N.createElement("a",{...m,...V,href:P||E,onClick:I||i?e:T,ref:HN(w,j),target:l,"data-discover":!b&&n==="render"?"true":void 0});return y&&!b?N.createElement(N.Fragment,null,_,N.createElement(BN,{page:E})):_});Mx.displayName="Link";var KN=N.forwardRef(function({"aria-current":e="page",caseSensitive:n=!1,className:r="",end:s=!1,style:i,to:o,viewTransition:a,children:l,...d},h){let f=Sc(o,{relative:d.relative}),m=ns(),w=N.useContext(Sh),{navigator:A,basename:b}=N.useContext(fr),P=w!=null&&tk(f)&&a===!0,I=A.encodeLocation?A.encodeLocation(f).pathname:f.pathname,E=m.pathname,y=w&&w.navigation&&w.navigation.location?w.navigation.location.pathname:null;n||(E=E.toLowerCase(),y=y?y.toLowerCase():null,I=I.toLowerCase()),y&&b&&(y=Qr(y,b)||y);const j=I!=="/"&&I.endsWith("/")?I.length-1:I.length;let V=E===I||!s&&E.startsWith(I)&&E.charAt(j)==="/",M=y!=null&&(y===I||!s&&y.startsWith(I)&&y.charAt(I.length)==="/"),T={isActive:V,isPending:M,isTransitioning:P},_=V?e:void 0,S;typeof r=="function"?S=r(T):S=[r,V?"active":null,M?"pending":null,P?"transitioning":null].filter(Boolean).join(" ");let C=typeof i=="function"?i(T):i;return N.createElement(Mx,{...d,"aria-current":_,className:S,ref:h,style:C,to:o,viewTransition:a},typeof l=="function"?l(T):l)});KN.displayName="NavLink";var GN=N.forwardRef(({discover:t="render",fetcherKey:e,navigate:n,reloadDocument:r,replace:s,state:i,method:o=Bu,action:a,onSubmit:l,relative:d,preventScrollReset:h,viewTransition:f,...m},w)=>{let A=ZN(),b=ek(a,{relative:d}),P=o.toLowerCase()==="get"?"get":"post",I=typeof a=="string"&&Lx.test(a),E=y=>{if(l&&l(y),y.defaultPrevented)return;y.preventDefault();let j=y.nativeEvent.submitter,V=(j==null?void 0:j.getAttribute("formmethod"))||o;A(j||y.currentTarget,{fetcherKey:e,method:V,navigate:n,replace:s,state:i,relative:d,preventScrollReset:h,viewTransition:f})};return N.createElement("form",{ref:w,method:P,action:b,onSubmit:r?l:E,...m,"data-discover":!I&&t==="render"?"true":void 0})});GN.displayName="Form";function QN(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function Fx(t){let e=N.useContext(Ca);return dt(e,QN(t)),e}function YN(t,{target:e,replace:n,state:r,preventScrollReset:s,relative:i,viewTransition:o}={}){let a=bh(),l=ns(),d=Sc(t,{relative:i});return N.useCallback(h=>{if(AN(h,e)){h.preventDefault();let f=n!==void 0?n:sc(l)===sc(d);a(t,{replace:f,state:r,preventScrollReset:s,relative:i,viewTransition:o})}},[l,a,d,n,r,e,t,s,i,o])}var XN=0,JN=()=>`__${String(++XN)}__`;function ZN(){let{router:t}=Fx("useSubmit"),{basename:e}=N.useContext(fr),n=_N();return N.useCallback(async(r,s={})=>{let{action:i,method:o,encType:a,formData:l,body:d}=NN(r,e);if(s.navigate===!1){let h=s.fetcherKey||JN();await t.fetch(h,n,s.action||i,{preventScrollReset:s.preventScrollReset,formData:l,body:d,formMethod:s.method||o,formEncType:s.encType||a,flushSync:s.flushSync})}else await t.navigate(s.action||i,{preventScrollReset:s.preventScrollReset,formData:l,body:d,formMethod:s.method||o,formEncType:s.encType||a,replace:s.replace,state:s.state,fromRouteId:n,flushSync:s.flushSync,viewTransition:s.viewTransition})},[t,e,n])}function ek(t,{relative:e}={}){let{basename:n}=N.useContext(fr),r=N.useContext(Or);dt(r,"useFormAction must be used inside a RouteContext");let[s]=r.matches.slice(-1),i={...Sc(t||".",{relative:e})},o=ns();if(t==null){i.search=o.search;let a=new URLSearchParams(i.search),l=a.getAll("index");if(l.some(h=>h==="")){a.delete("index"),l.filter(f=>f).forEach(f=>a.append("index",f));let h=a.toString();i.search=h?`?${h}`:""}}return(!t||t===".")&&s.route.index&&(i.search=i.search?i.search.replace(/^\?/,"?index&"):"?index"),n!=="/"&&(i.pathname=i.pathname==="/"?n:qr([n,i.pathname])),sc(i)}function tk(t,{relative:e}={}){let n=N.useContext(Rx);dt(n!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:r}=Fx("useViewTransitionState"),s=Sc(t,{relative:e});if(!n.isTransitioning)return!1;let i=Qr(n.currentLocation.pathname,r)||n.currentLocation.pathname,o=Qr(n.nextLocation.pathname,r)||n.nextLocation.pathname;return Pd(s.pathname,o)!=null||Pd(s.pathname,i)!=null}const nk=()=>{};var Dw={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ux=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let s=t.charCodeAt(r);s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=s&63|128):(s&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=s&63|128):(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=s&63|128)}return e},rk=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const s=t[n++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=t[n++];e[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=t[n++],o=t[n++],a=t[n++],l=((s&7)<<18|(i&63)<<12|(o&63)<<6|a&63)-65536;e[r++]=String.fromCharCode(55296+(l>>10)),e[r++]=String.fromCharCode(56320+(l&1023))}else{const i=t[n++],o=t[n++];e[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|o&63)}}return e.join("")},$x={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<t.length;s+=3){const i=t[s],o=s+1<t.length,a=o?t[s+1]:0,l=s+2<t.length,d=l?t[s+2]:0,h=i>>2,f=(i&3)<<4|a>>4;let m=(a&15)<<2|d>>6,w=d&63;l||(w=64,o||(m=64)),r.push(n[h],n[f],n[m],n[w])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(Ux(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):rk(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<t.length;){const i=n[t.charAt(s++)],a=s<t.length?n[t.charAt(s)]:0;++s;const d=s<t.length?n[t.charAt(s)]:64;++s;const f=s<t.length?n[t.charAt(s)]:64;if(++s,i==null||a==null||d==null||f==null)throw new sk;const m=i<<2|a>>4;if(r.push(m),d!==64){const w=a<<4&240|d>>2;if(r.push(w),f!==64){const A=d<<6&192|f;r.push(A)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class sk extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const ik=function(t){const e=Ux(t);return $x.encodeByteArray(e,!0)},kd=function(t){return ik(t).replace(/\./g,"")},Bx=function(t){try{return $x.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zx(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ok=()=>zx().__FIREBASE_DEFAULTS__,ak=()=>{if(typeof process>"u"||typeof Dw>"u")return;const t=Dw.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},lk=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&Bx(t[1]);return e&&JSON.parse(e)},Ah=()=>{try{return nk()||ok()||ak()||lk()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},qx=t=>{var e,n;return(n=(e=Ah())==null?void 0:e.emulatorHosts)==null?void 0:n[t]},Hx=t=>{const e=qx(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},Wx=()=>{var t;return(t=Ah())==null?void 0:t.config},Kx=t=>{var e;return(e=Ah())==null?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ck{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ti(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function ly(t){return(await fetch(t,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gx(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",s=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o={iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}},...t};return[kd(JSON.stringify(n)),kd(JSON.stringify(o)),""].join(".")}const Nl={};function uk(){const t={prod:[],emulator:[]};for(const e of Object.keys(Nl))Nl[e]?t.emulator.push(e):t.prod.push(e);return t}function dk(t){let e=document.getElementById(t),n=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),n=!0),{created:n,element:e}}let jw=!1;function cy(t,e){if(typeof window>"u"||typeof document>"u"||!ti(window.location.host)||Nl[t]===e||Nl[t]||jw)return;Nl[t]=e;function n(m){return`__firebase__banner__${m}`}const r="__firebase__banner",i=uk().prod.length>0;function o(){const m=document.getElementById(r);m&&m.remove()}function a(m){m.style.display="flex",m.style.background="#7faaf0",m.style.position="fixed",m.style.bottom="5px",m.style.left="5px",m.style.padding=".5em",m.style.borderRadius="5px",m.style.alignItems="center"}function l(m,w){m.setAttribute("width","24"),m.setAttribute("id",w),m.setAttribute("height","24"),m.setAttribute("viewBox","0 0 24 24"),m.setAttribute("fill","none"),m.style.marginLeft="-6px"}function d(){const m=document.createElement("span");return m.style.cursor="pointer",m.style.marginLeft="16px",m.style.fontSize="24px",m.innerHTML=" &times;",m.onclick=()=>{jw=!0,o()},m}function h(m,w){m.setAttribute("id",w),m.innerText="Learn more",m.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",m.setAttribute("target","__blank"),m.style.paddingLeft="5px",m.style.textDecoration="underline"}function f(){const m=dk(r),w=n("text"),A=document.getElementById(w)||document.createElement("span"),b=n("learnmore"),P=document.getElementById(b)||document.createElement("a"),I=n("preprendIcon"),E=document.getElementById(I)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(m.created){const y=m.element;a(y),h(P,b);const j=d();l(E,I),y.append(E,A,P,j),document.body.appendChild(y)}i?(A.innerText="Preview backend disconnected.",E.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(E.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,A.innerText="Preview backend running in this workspace."),A.setAttribute("id",w)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",f):f()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vt(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function hk(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Vt())}function Qx(){var e;const t=(e=Ah())==null?void 0:e.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function fk(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function Yx(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function pk(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function mk(){const t=Vt();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function Xx(){return!Qx()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Jx(){return!Qx()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function uy(){try{return typeof indexedDB=="object"}catch{return!1}}function Zx(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{var i;e(((i=s.error)==null?void 0:i.message)||"")}}catch(n){e(n)}})}function gk(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yk="FirebaseError";class Jn extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=yk,Object.setPrototypeOf(this,Jn.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,ro.prototype.create)}}class ro{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},s=`${this.service}/${e}`,i=this.errors[e],o=i?_k(i,r):"Error",a=`${this.serviceName}: ${o} (${s}).`;return new Jn(s,a,r)}}function _k(t,e){return t.replace(vk,(n,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const vk=/\{\$([^}]+)}/g;function wk(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Yr(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const s of n){if(!r.includes(s))return!1;const i=t[s],o=e[s];if(Ow(i)&&Ow(o)){if(!Yr(i,o))return!1}else if(i!==o)return!1}for(const s of r)if(!n.includes(s))return!1;return!0}function Ow(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bc(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(s=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function fl(t){const e={};return t.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[s,i]=r.split("=");e[decodeURIComponent(s)]=decodeURIComponent(i)}}),e}function pl(t){const e=t.indexOf("?");if(!e)return"";const n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}function Ek(t,e){const n=new Ik(t,e);return n.subscribe.bind(n)}class Ik{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let s;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");Tk(e,["next","error","complete"])?s=e:s={next:e,error:n,complete:r},s.next===void 0&&(s.next=sp),s.error===void 0&&(s.error=sp),s.complete===void 0&&(s.complete=sp);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function Tk(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function sp(){}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xk=1e3,Sk=2,bk=4*60*60*1e3,Ck=.5;function Vw(t,e=xk,n=Sk){const r=e*Math.pow(n,t),s=Math.round(Ck*r*(Math.random()-.5)*2);return Math.min(bk,r+s)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ke(t){return t&&t._delegate?t._delegate:t}class Xn{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mi="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ak{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new ck;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:n});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){const n=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),r=(e==null?void 0:e.optional)??!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(s){if(r)return null;throw s}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(Pk(e))try{this.getOrInitializeService({instanceIdentifier:mi})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(n);try{const i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(e=mi){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=mi){return this.instances.has(e)}getOptions(e=mi){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[i,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(i);r===a&&o.resolve(s)}return s}onInit(e,n){const r=this.normalizeInstanceIdentifier(n),s=this.onInitCallbacks.get(r)??new Set;s.add(e),this.onInitCallbacks.set(r,s);const i=this.instances.get(r);return i&&e(i,r),()=>{s.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const s of r)try{s(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:Rk(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=mi){return this.component?this.component.multipleInstances?e:mi:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function Rk(t){return t===mi?void 0:t}function Pk(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nk{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new Ak(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var De;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(De||(De={}));const kk={debug:De.DEBUG,verbose:De.VERBOSE,info:De.INFO,warn:De.WARN,error:De.ERROR,silent:De.SILENT},Dk=De.INFO,jk={[De.DEBUG]:"log",[De.VERBOSE]:"log",[De.INFO]:"info",[De.WARN]:"warn",[De.ERROR]:"error"},Ok=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),s=jk[e];if(s)console[s](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Rh{constructor(e){this.name=e,this._logLevel=Dk,this._logHandler=Ok,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in De))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?kk[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,De.DEBUG,...e),this._logHandler(this,De.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,De.VERBOSE,...e),this._logHandler(this,De.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,De.INFO,...e),this._logHandler(this,De.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,De.WARN,...e),this._logHandler(this,De.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,De.ERROR,...e),this._logHandler(this,De.ERROR,...e)}}const Vk=(t,e)=>e.some(n=>t instanceof n);let Lw,Mw;function Lk(){return Lw||(Lw=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Mk(){return Mw||(Mw=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const eS=new WeakMap,Sm=new WeakMap,tS=new WeakMap,ip=new WeakMap,dy=new WeakMap;function Fk(t){const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("success",i),t.removeEventListener("error",o)},i=()=>{n(Fs(t.result)),s()},o=()=>{r(t.error),s()};t.addEventListener("success",i),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&eS.set(n,t)}).catch(()=>{}),dy.set(e,t),e}function Uk(t){if(Sm.has(t))return;const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",o),t.removeEventListener("abort",o)},i=()=>{n(),s()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",i),t.addEventListener("error",o),t.addEventListener("abort",o)});Sm.set(t,e)}let bm={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return Sm.get(t);if(e==="objectStoreNames")return t.objectStoreNames||tS.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Fs(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function $k(t){bm=t(bm)}function Bk(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(op(this),e,...n);return tS.set(r,e.sort?e.sort():[e]),Fs(r)}:Mk().includes(t)?function(...e){return t.apply(op(this),e),Fs(eS.get(this))}:function(...e){return Fs(t.apply(op(this),e))}}function zk(t){return typeof t=="function"?Bk(t):(t instanceof IDBTransaction&&Uk(t),Vk(t,Lk())?new Proxy(t,bm):t)}function Fs(t){if(t instanceof IDBRequest)return Fk(t);if(ip.has(t))return ip.get(t);const e=zk(t);return e!==t&&(ip.set(t,e),dy.set(e,t)),e}const op=t=>dy.get(t);function nS(t,e,{blocked:n,upgrade:r,blocking:s,terminated:i}={}){const o=indexedDB.open(t,e),a=Fs(o);return r&&o.addEventListener("upgradeneeded",l=>{r(Fs(o.result),l.oldVersion,l.newVersion,Fs(o.transaction),l)}),n&&o.addEventListener("blocked",l=>n(l.oldVersion,l.newVersion,l)),a.then(l=>{i&&l.addEventListener("close",()=>i()),s&&l.addEventListener("versionchange",d=>s(d.oldVersion,d.newVersion,d))}).catch(()=>{}),a}const qk=["get","getKey","getAll","getAllKeys","count"],Hk=["put","add","delete","clear"],ap=new Map;function Fw(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(ap.get(e))return ap.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,s=Hk.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(s||qk.includes(n)))return;const i=async function(o,...a){const l=this.transaction(o,s?"readwrite":"readonly");let d=l.store;return r&&(d=d.index(a.shift())),(await Promise.all([d[n](...a),s&&l.done]))[0]};return ap.set(e,i),i}$k(t=>({...t,get:(e,n,r)=>Fw(e,n)||t.get(e,n,r),has:(e,n)=>!!Fw(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wk{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(Kk(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function Kk(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Cm="@firebase/app",Uw="0.14.5";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xr=new Rh("@firebase/app"),Gk="@firebase/app-compat",Qk="@firebase/analytics-compat",Yk="@firebase/analytics",Xk="@firebase/app-check-compat",Jk="@firebase/app-check",Zk="@firebase/auth",eD="@firebase/auth-compat",tD="@firebase/database",nD="@firebase/data-connect",rD="@firebase/database-compat",sD="@firebase/functions",iD="@firebase/functions-compat",oD="@firebase/installations",aD="@firebase/installations-compat",lD="@firebase/messaging",cD="@firebase/messaging-compat",uD="@firebase/performance",dD="@firebase/performance-compat",hD="@firebase/remote-config",fD="@firebase/remote-config-compat",pD="@firebase/storage",mD="@firebase/storage-compat",gD="@firebase/firestore",yD="@firebase/ai",_D="@firebase/firestore-compat",vD="firebase",wD="12.5.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Am="[DEFAULT]",ED={[Cm]:"fire-core",[Gk]:"fire-core-compat",[Yk]:"fire-analytics",[Qk]:"fire-analytics-compat",[Jk]:"fire-app-check",[Xk]:"fire-app-check-compat",[Zk]:"fire-auth",[eD]:"fire-auth-compat",[tD]:"fire-rtdb",[nD]:"fire-data-connect",[rD]:"fire-rtdb-compat",[sD]:"fire-fn",[iD]:"fire-fn-compat",[oD]:"fire-iid",[aD]:"fire-iid-compat",[lD]:"fire-fcm",[cD]:"fire-fcm-compat",[uD]:"fire-perf",[dD]:"fire-perf-compat",[hD]:"fire-rc",[fD]:"fire-rc-compat",[pD]:"fire-gcs",[mD]:"fire-gcs-compat",[gD]:"fire-fst",[_D]:"fire-fst-compat",[yD]:"fire-vertex","fire-js":"fire-js",[vD]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dd=new Map,ID=new Map,Rm=new Map;function $w(t,e){try{t.container.addComponent(e)}catch(n){Xr.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function ur(t){const e=t.name;if(Rm.has(e))return Xr.debug(`There were multiple attempts to register component ${e}.`),!1;Rm.set(e,t);for(const n of Dd.values())$w(n,t);for(const n of ID.values())$w(n,t);return!0}function ni(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function Bn(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TD={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Us=new ro("app","Firebase",TD);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xD{constructor(e,n,r){this._isDeleted=!1,this._options={...e},this._config={...n},this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Xn("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Us.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const so=wD;function hy(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r={name:Am,automaticDataCollectionEnabled:!0,...e},s=r.name;if(typeof s!="string"||!s)throw Us.create("bad-app-name",{appName:String(s)});if(n||(n=Wx()),!n)throw Us.create("no-options");const i=Dd.get(s);if(i){if(Yr(n,i.options)&&Yr(r,i.config))return i;throw Us.create("duplicate-app",{appName:s})}const o=new Nk(s);for(const l of Rm.values())o.addComponent(l);const a=new xD(n,r,o);return Dd.set(s,a),a}function Ph(t=Am){const e=Dd.get(t);if(!e&&t===Am&&Wx())return hy();if(!e)throw Us.create("no-app",{appName:t});return e}function bn(t,e,n){let r=ED[t]??t;n&&(r+=`-${n}`);const s=r.match(/\s|\//),i=e.match(/\s|\//);if(s||i){const o=[`Unable to register library "${r}" with version "${e}":`];s&&o.push(`library name "${r}" contains illegal characters (whitespace or "/")`),s&&i&&o.push("and"),i&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Xr.warn(o.join(" "));return}ur(new Xn(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SD="firebase-heartbeat-database",bD=1,ic="firebase-heartbeat-store";let lp=null;function rS(){return lp||(lp=nS(SD,bD,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(ic)}catch(n){console.warn(n)}}}}).catch(t=>{throw Us.create("idb-open",{originalErrorMessage:t.message})})),lp}async function CD(t){try{const n=(await rS()).transaction(ic),r=await n.objectStore(ic).get(sS(t));return await n.done,r}catch(e){if(e instanceof Jn)Xr.warn(e.message);else{const n=Us.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Xr.warn(n.message)}}}async function Bw(t,e){try{const r=(await rS()).transaction(ic,"readwrite");await r.objectStore(ic).put(e,sS(t)),await r.done}catch(n){if(n instanceof Jn)Xr.warn(n.message);else{const r=Us.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});Xr.warn(r.message)}}}function sS(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AD=1024,RD=30;class PD{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new kD(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=zw();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)==null?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(o=>o.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:s}),this._heartbeatsCache.heartbeats.length>RD){const o=DD(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){Xr.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=zw(),{heartbeatsToSend:r,unsentEntries:s}=ND(this._heartbeatsCache.heartbeats),i=kd(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(n){return Xr.warn(n),""}}}function zw(){return new Date().toISOString().substring(0,10)}function ND(t,e=AD){const n=[];let r=t.slice();for(const s of t){const i=n.find(o=>o.agent===s.agent);if(i){if(i.dates.push(s.date),qw(n)>e){i.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),qw(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class kD{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return uy()?Zx().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await CD(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return Bw(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return Bw(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function qw(t){return kd(JSON.stringify({version:2,heartbeats:t})).length}function DD(t){if(t.length===0)return-1;let e=0,n=t[0].date;for(let r=1;r<t.length;r++)t[r].date<n&&(n=t[r].date,e=r);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jD(t){ur(new Xn("platform-logger",e=>new Wk(e),"PRIVATE")),ur(new Xn("heartbeat",e=>new PD(e),"PRIVATE")),bn(Cm,Uw,t),bn(Cm,Uw,"esm2020"),bn("fire-js","")}jD("");var OD="firebase",VD="12.5.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */bn(OD,VD,"app");function iS(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const LD=iS,oS=new ro("auth","Firebase",iS());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jd=new Rh("@firebase/auth");function MD(t,...e){jd.logLevel<=De.WARN&&jd.warn(`Auth (${so}): ${t}`,...e)}function qu(t,...e){jd.logLevel<=De.ERROR&&jd.error(`Auth (${so}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dr(t,...e){throw fy(t,...e)}function Pr(t,...e){return fy(t,...e)}function aS(t,e,n){const r={...LD(),[e]:n};return new ro("auth","Firebase",r).create(e,{appName:t.name})}function $s(t){return aS(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function fy(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return oS.create(t,...e)}function ve(t,e,...n){if(!t)throw fy(e,...n)}function Ur(t){const e="INTERNAL ASSERTION FAILED: "+t;throw qu(e),new Error(e)}function Jr(t,e){t||Ur(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pm(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.href)||""}function FD(){return Hw()==="http:"||Hw()==="https:"}function Hw(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function UD(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(FD()||Yx()||"connection"in navigator)?navigator.onLine:!0}function $D(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cc{constructor(e,n){this.shortDelay=e,this.longDelay=n,Jr(n>e,"Short delay should be less than long delay!"),this.isMobile=hk()||pk()}get(){return UD()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function py(t,e){Jr(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lS{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Ur("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Ur("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Ur("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BD={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zD=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],qD=new Cc(3e4,6e4);function io(t,e){return t.tenantId&&!e.tenantId?{...e,tenantId:t.tenantId}:e}async function ri(t,e,n,r,s={}){return cS(t,s,async()=>{let i={},o={};r&&(e==="GET"?o=r:i={body:JSON.stringify(r)});const a=bc({key:t.config.apiKey,...o}).slice(1),l=await t._getAdditionalHeaders();l["Content-Type"]="application/json",t.languageCode&&(l["X-Firebase-Locale"]=t.languageCode);const d={method:e,headers:l,...i};return fk()||(d.referrerPolicy="no-referrer"),t.emulatorConfig&&ti(t.emulatorConfig.host)&&(d.credentials="include"),lS.fetch()(await uS(t,t.config.apiHost,n,a),d)})}async function cS(t,e,n){t._canInitEmulator=!1;const r={...BD,...e};try{const s=new WD(t),i=await Promise.race([n(),s.promise]);s.clearNetworkTimeout();const o=await i.json();if("needConfirmation"in o)throw yu(t,"account-exists-with-different-credential",o);if(i.ok&&!("errorMessage"in o))return o;{const a=i.ok?o.errorMessage:o.error.message,[l,d]=a.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw yu(t,"credential-already-in-use",o);if(l==="EMAIL_EXISTS")throw yu(t,"email-already-in-use",o);if(l==="USER_DISABLED")throw yu(t,"user-disabled",o);const h=r[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(d)throw aS(t,h,d);dr(t,h)}}catch(s){if(s instanceof Jn)throw s;dr(t,"network-request-failed",{message:String(s)})}}async function Nh(t,e,n,r,s={}){const i=await ri(t,e,n,r,s);return"mfaPendingCredential"in i&&dr(t,"multi-factor-auth-required",{_serverResponse:i}),i}async function uS(t,e,n,r){const s=`${e}${n}?${r}`,i=t,o=i.config.emulator?py(t.config,s):`${t.config.apiScheme}://${s}`;return zD.includes(n)&&(await i._persistenceManagerAvailable,i._getPersistenceType()==="COOKIE")?i._getPersistence()._getFinalTarget(o).toString():o}function HD(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class WD{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(Pr(this.auth,"network-request-failed")),qD.get())})}}function yu(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const s=Pr(t,e,r);return s.customData._tokenResponse=n,s}function Ww(t){return t!==void 0&&t.enterprise!==void 0}class KD{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const n of this.recaptchaEnforcementState)if(n.provider&&n.provider===e)return HD(n.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function GD(t,e){return ri(t,"GET","/v2/recaptchaConfig",io(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function QD(t,e){return ri(t,"POST","/v1/accounts:delete",e)}async function Od(t,e){return ri(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kl(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function YD(t,e=!1){const n=Ke(t),r=await n.getIdToken(e),s=my(r);ve(s&&s.exp&&s.auth_time&&s.iat,n.auth,"internal-error");const i=typeof s.firebase=="object"?s.firebase:void 0,o=i==null?void 0:i.sign_in_provider;return{claims:s,token:r,authTime:kl(cp(s.auth_time)),issuedAtTime:kl(cp(s.iat)),expirationTime:kl(cp(s.exp)),signInProvider:o||null,signInSecondFactor:(i==null?void 0:i.sign_in_second_factor)||null}}function cp(t){return Number(t)*1e3}function my(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return qu("JWT malformed, contained fewer than 3 sections"),null;try{const s=Bx(n);return s?JSON.parse(s):(qu("Failed to decode base64 JWT payload"),null)}catch(s){return qu("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function Kw(t){const e=my(t);return ve(e,"internal-error"),ve(typeof e.exp<"u","internal-error"),ve(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function oc(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof Jn&&XD(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function XD({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JD{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const r=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nm{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=kl(this.lastLoginAt),this.creationTime=kl(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Vd(t){var f;const e=t.auth,n=await t.getIdToken(),r=await oc(t,Od(e,{idToken:n}));ve(r==null?void 0:r.users.length,e,"internal-error");const s=r.users[0];t._notifyReloadListener(s);const i=(f=s.providerUserInfo)!=null&&f.length?dS(s.providerUserInfo):[],o=ej(t.providerData,i),a=t.isAnonymous,l=!(t.email&&s.passwordHash)&&!(o!=null&&o.length),d=a?l:!1,h={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:o,metadata:new Nm(s.createdAt,s.lastLoginAt),isAnonymous:d};Object.assign(t,h)}async function ZD(t){const e=Ke(t);await Vd(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function ej(t,e){return[...t.filter(r=>!e.some(s=>s.providerId===r.providerId)),...e]}function dS(t){return t.map(({providerId:e,...n})=>({providerId:e,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function tj(t,e){const n=await cS(t,{},async()=>{const r=bc({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:i}=t.config,o=await uS(t,s,"/v1/token",`key=${i}`),a=await t._getAdditionalHeaders();a["Content-Type"]="application/x-www-form-urlencoded";const l={method:"POST",headers:a,body:r};return t.emulatorConfig&&ti(t.emulatorConfig.host)&&(l.credentials="include"),lS.fetch()(o,l)});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function nj(t,e){return ri(t,"POST","/v2/accounts:revokeToken",io(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Go{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){ve(e.idToken,"internal-error"),ve(typeof e.idToken<"u","internal-error"),ve(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Kw(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){ve(e.length!==0,"internal-error");const n=Kw(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(ve(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:s,expiresIn:i}=await tj(e,n);this.updateTokensAndExpiration(r,s,Number(i))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:s,expirationTime:i}=n,o=new Go;return r&&(ve(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),s&&(ve(typeof s=="string","internal-error",{appName:e}),o.accessToken=s),i&&(ve(typeof i=="number","internal-error",{appName:e}),o.expirationTime=i),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Go,this.toJSON())}_performRefresh(){return Ur("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fs(t,e){ve(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class ir{constructor({uid:e,auth:n,stsTokenManager:r,...s}){this.providerId="firebase",this.proactiveRefresh=new JD(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=n,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new Nm(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const n=await oc(this,this.stsTokenManager.getToken(this.auth,e));return ve(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return YD(this,e)}reload(){return ZD(this)}_assign(e){this!==e&&(ve(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>({...n})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new ir({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return n.metadata._copy(this.metadata),n}_onReload(e){ve(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await Vd(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Bn(this.auth.app))return Promise.reject($s(this.auth));const e=await this.getIdToken();return await oc(this,QD(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){const r=n.displayName??void 0,s=n.email??void 0,i=n.phoneNumber??void 0,o=n.photoURL??void 0,a=n.tenantId??void 0,l=n._redirectEventId??void 0,d=n.createdAt??void 0,h=n.lastLoginAt??void 0,{uid:f,emailVerified:m,isAnonymous:w,providerData:A,stsTokenManager:b}=n;ve(f&&b,e,"internal-error");const P=Go.fromJSON(this.name,b);ve(typeof f=="string",e,"internal-error"),fs(r,e.name),fs(s,e.name),ve(typeof m=="boolean",e,"internal-error"),ve(typeof w=="boolean",e,"internal-error"),fs(i,e.name),fs(o,e.name),fs(a,e.name),fs(l,e.name),fs(d,e.name),fs(h,e.name);const I=new ir({uid:f,auth:e,email:s,emailVerified:m,displayName:r,isAnonymous:w,photoURL:o,phoneNumber:i,tenantId:a,stsTokenManager:P,createdAt:d,lastLoginAt:h});return A&&Array.isArray(A)&&(I.providerData=A.map(E=>({...E}))),l&&(I._redirectEventId=l),I}static async _fromIdTokenResponse(e,n,r=!1){const s=new Go;s.updateFromServerResponse(n);const i=new ir({uid:n.localId,auth:e,stsTokenManager:s,isAnonymous:r});return await Vd(i),i}static async _fromGetAccountInfoResponse(e,n,r){const s=n.users[0];ve(s.localId!==void 0,"internal-error");const i=s.providerUserInfo!==void 0?dS(s.providerUserInfo):[],o=!(s.email&&s.passwordHash)&&!(i!=null&&i.length),a=new Go;a.updateFromIdToken(r);const l=new ir({uid:s.localId,auth:e,stsTokenManager:a,isAnonymous:o}),d={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:i,metadata:new Nm(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(i!=null&&i.length)};return Object.assign(l,d),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gw=new Map;function $r(t){Jr(t instanceof Function,"Expected a class definition");let e=Gw.get(t);return e?(Jr(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,Gw.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hS{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}hS.type="NONE";const Qw=hS;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hu(t,e,n){return`firebase:${t}:${e}:${n}`}class Qo{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:s,name:i}=this.auth;this.fullUserKey=Hu(this.userKey,s.apiKey,i),this.fullPersistenceKey=Hu("persistence",s.apiKey,i),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const n=await Od(this.auth,{idToken:e}).catch(()=>{});return n?ir._fromGetAccountInfoResponse(this.auth,n,e):null}return ir._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new Qo($r(Qw),e,r);const s=(await Promise.all(n.map(async d=>{if(await d._isAvailable())return d}))).filter(d=>d);let i=s[0]||$r(Qw);const o=Hu(r,e.config.apiKey,e.name);let a=null;for(const d of n)try{const h=await d._get(o);if(h){let f;if(typeof h=="string"){const m=await Od(e,{idToken:h}).catch(()=>{});if(!m)break;f=await ir._fromGetAccountInfoResponse(e,m,h)}else f=ir._fromJSON(e,h);d!==i&&(a=f),i=d;break}}catch{}const l=s.filter(d=>d._shouldAllowMigration);return!i._shouldAllowMigration||!l.length?new Qo(i,e,r):(i=l[0],a&&await i._set(o,a.toJSON()),await Promise.all(n.map(async d=>{if(d!==i)try{await d._remove(o)}catch{}})),new Qo(i,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yw(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(gS(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(fS(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(_S(e))return"Blackberry";if(vS(e))return"Webos";if(pS(e))return"Safari";if((e.includes("chrome/")||mS(e))&&!e.includes("edge/"))return"Chrome";if(yS(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function fS(t=Vt()){return/firefox\//i.test(t)}function pS(t=Vt()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function mS(t=Vt()){return/crios\//i.test(t)}function gS(t=Vt()){return/iemobile/i.test(t)}function yS(t=Vt()){return/android/i.test(t)}function _S(t=Vt()){return/blackberry/i.test(t)}function vS(t=Vt()){return/webos/i.test(t)}function gy(t=Vt()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function rj(t=Vt()){var e;return gy(t)&&!!((e=window.navigator)!=null&&e.standalone)}function sj(){return mk()&&document.documentMode===10}function wS(t=Vt()){return gy(t)||yS(t)||vS(t)||_S(t)||/windows phone/i.test(t)||gS(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ES(t,e=[]){let n;switch(t){case"Browser":n=Yw(Vt());break;case"Worker":n=`${Yw(Vt())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${so}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ij{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=i=>new Promise((o,a)=>{try{const l=e(i);o(l)}catch(l){a(l)}});r.onAbort=n,this.queue.push(r);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const s of n)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function oj(t,e={}){return ri(t,"GET","/v2/passwordPolicy",io(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aj=6;class lj{constructor(e){var r;const n=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=n.minPasswordLength??aj,n.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=n.maxPasswordLength),n.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=n.containsLowercaseCharacter),n.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=n.containsUppercaseCharacter),n.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=n.containsNumericCharacter),n.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=n.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=((r=e.allowedNonAlphanumericCharacters)==null?void 0:r.join(""))??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const n={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,n),this.validatePasswordCharacterOptions(e,n),n.isValid&&(n.isValid=n.meetsMinPasswordLength??!0),n.isValid&&(n.isValid=n.meetsMaxPasswordLength??!0),n.isValid&&(n.isValid=n.containsLowercaseLetter??!0),n.isValid&&(n.isValid=n.containsUppercaseLetter??!0),n.isValid&&(n.isValid=n.containsNumericCharacter??!0),n.isValid&&(n.isValid=n.containsNonAlphanumericCharacter??!0),n}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),s&&(n.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let s=0;s<e.length;s++)r=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,s,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cj{constructor(e,n,r,s){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Xw(this),this.idTokenSubscription=new Xw(this),this.beforeStateQueue=new ij(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=oS,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion,this._persistenceManagerAvailable=new Promise(i=>this._resolvePersistenceManagerAvailable=i)}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=$r(n)),this._initializationPromise=this.queue(async()=>{var r,s,i;if(!this._deleted&&(this.persistenceManager=await Qo.create(this,e),(r=this._resolvePersistenceManagerAvailable)==null||r.call(this),!this._deleted)){if((s=this._popupRedirectResolver)!=null&&s._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((i=this.currentUser)==null?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await Od(this,{idToken:e}),r=await ir._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(r)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var i;if(Bn(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(a,a))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let r=n,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(i=this.redirectUser)==null?void 0:i._redirectEventId,a=r==null?void 0:r._redirectEventId,l=await this.tryRedirectSignIn(e);(!o||o===a)&&(l!=null&&l.user)&&(r=l.user,s=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(r)}catch(o){r=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return ve(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await Vd(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=$D()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Bn(this.app))return Promise.reject($s(this));const n=e?Ke(e):null;return n&&ve(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&ve(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Bn(this.app)?Promise.reject($s(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Bn(this.app)?Promise.reject($s(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence($r(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await oj(this),n=new lj(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new ro("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),await nj(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)==null?void 0:e.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&$r(e)||this._popupRedirectResolver;ve(n,this,"argument-error"),this.redirectPersistenceManager=await Qo.create(this,[$r(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)==null?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)==null?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=((n=this.currentUser)==null?void 0:n.uid)??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,s){if(this._deleted)return()=>{};const i=typeof n=="function"?n:n.next.bind(n);let o=!1;const a=this._isInitialized?Promise.resolve():this._initializationPromise;if(ve(a,this,"internal-error"),a.then(()=>{o||i(this.currentUser)}),typeof n=="function"){const l=e.addObserver(n,r,s);return()=>{o=!0,l()}}else{const l=e.addObserver(n);return()=>{o=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return ve(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=ES(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var s;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const n=await((s=this.heartbeatServiceProvider.getImmediate({optional:!0}))==null?void 0:s.getHeartbeatsHeader());n&&(e["X-Firebase-Client"]=n);const r=await this._getAppCheckToken();return r&&(e["X-Firebase-AppCheck"]=r),e}async _getAppCheckToken(){var n;if(Bn(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await((n=this.appCheckServiceProvider.getImmediate({optional:!0}))==null?void 0:n.getToken());return e!=null&&e.error&&MD(`Error while retrieving App Check token: ${e.error}`),e==null?void 0:e.token}}function Ra(t){return Ke(t)}class Xw{constructor(e){this.auth=e,this.observer=null,this.addObserver=Ek(n=>this.observer=n)}get next(){return ve(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let kh={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function uj(t){kh=t}function IS(t){return kh.loadJS(t)}function dj(){return kh.recaptchaEnterpriseScript}function hj(){return kh.gapiScript}function fj(t){return`__${t}${Math.floor(Math.random()*1e6)}`}class pj{constructor(){this.enterprise=new mj}ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}class mj{ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}const gj="recaptcha-enterprise",TS="NO_RECAPTCHA";class yj{constructor(e){this.type=gj,this.auth=Ra(e)}async verify(e="verify",n=!1){async function r(i){if(!n){if(i.tenantId==null&&i._agentRecaptchaConfig!=null)return i._agentRecaptchaConfig.siteKey;if(i.tenantId!=null&&i._tenantRecaptchaConfigs[i.tenantId]!==void 0)return i._tenantRecaptchaConfigs[i.tenantId].siteKey}return new Promise(async(o,a)=>{GD(i,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(l=>{if(l.recaptchaKey===void 0)a(new Error("recaptcha Enterprise site key undefined"));else{const d=new KD(l);return i.tenantId==null?i._agentRecaptchaConfig=d:i._tenantRecaptchaConfigs[i.tenantId]=d,o(d.siteKey)}}).catch(l=>{a(l)})})}function s(i,o,a){const l=window.grecaptcha;Ww(l)?l.enterprise.ready(()=>{l.enterprise.execute(i,{action:e}).then(d=>{o(d)}).catch(()=>{o(TS)})}):a(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new pj().execute("siteKey",{action:"verify"}):new Promise((i,o)=>{r(this.auth).then(a=>{if(!n&&Ww(window.grecaptcha))s(a,i,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let l=dj();l.length!==0&&(l+=a),IS(l).then(()=>{s(a,i,o)}).catch(d=>{o(d)})}}).catch(a=>{o(a)})})}}async function Jw(t,e,n,r=!1,s=!1){const i=new yj(t);let o;if(s)o=TS;else try{o=await i.verify(n)}catch{o=await i.verify(n,!0)}const a={...e};if(n==="mfaSmsEnrollment"||n==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in a){const l=a.phoneEnrollmentInfo.phoneNumber,d=a.phoneEnrollmentInfo.recaptchaToken;Object.assign(a,{phoneEnrollmentInfo:{phoneNumber:l,recaptchaToken:d,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in a){const l=a.phoneSignInInfo.recaptchaToken;Object.assign(a,{phoneSignInInfo:{recaptchaToken:l,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return a}return r?Object.assign(a,{captchaResp:o}):Object.assign(a,{captchaResponse:o}),Object.assign(a,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(a,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),a}async function Zw(t,e,n,r,s){var i;if((i=t._getRecaptchaConfig())!=null&&i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const o=await Jw(t,e,n,n==="getOobCode");return r(t,o)}else return r(t,e).catch(async o=>{if(o.code==="auth/missing-recaptcha-token"){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const a=await Jw(t,e,n,n==="getOobCode");return r(t,a)}else return Promise.reject(o)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _j(t,e){const n=ni(t,"auth");if(n.isInitialized()){const s=n.getImmediate(),i=n.getOptions();if(Yr(i,e??{}))return s;dr(s,"already-initialized")}return n.initialize({options:e})}function vj(t,e){const n=(e==null?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map($r);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function wj(t,e,n){const r=Ra(t);ve(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const s=!1,i=xS(e),{host:o,port:a}=Ej(e),l=a===null?"":`:${a}`,d={url:`${i}//${o}${l}/`},h=Object.freeze({host:o,port:a,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:s})});if(!r._canInitEmulator){ve(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),ve(Yr(d,r.config.emulator)&&Yr(h,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=d,r.emulatorConfig=h,r.settings.appVerificationDisabledForTesting=!0,ti(o)?(ly(`${i}//${o}${l}`),cy("Auth",!0)):Ij()}function xS(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function Ej(t){const e=xS(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(r);if(s){const i=s[1];return{host:i,port:eE(r.substr(i.length+1))}}else{const[i,o]=r.split(":");return{host:i,port:eE(o)}}}function eE(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function Ij(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yy{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return Ur("not implemented")}_getIdTokenResponse(e){return Ur("not implemented")}_linkToIdToken(e,n){return Ur("not implemented")}_getReauthenticationResolver(e){return Ur("not implemented")}}async function Tj(t,e){return ri(t,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function xj(t,e){return Nh(t,"POST","/v1/accounts:signInWithPassword",io(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Sj(t,e){return Nh(t,"POST","/v1/accounts:signInWithEmailLink",io(t,e))}async function bj(t,e){return Nh(t,"POST","/v1/accounts:signInWithEmailLink",io(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ac extends yy{constructor(e,n,r,s=null){super("password",r),this._email=e,this._password=n,this._tenantId=s}static _fromEmailAndPassword(e,n){return new ac(e,n,"password")}static _fromEmailAndCode(e,n,r=null){return new ac(e,n,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;if(n!=null&&n.email&&(n!=null&&n.password)){if(n.signInMethod==="password")return this._fromEmailAndPassword(n.email,n.password);if(n.signInMethod==="emailLink")return this._fromEmailAndCode(n.email,n.password,n.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const n={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Zw(e,n,"signInWithPassword",xj);case"emailLink":return Sj(e,{email:this._email,oobCode:this._password});default:dr(e,"internal-error")}}async _linkToIdToken(e,n){switch(this.signInMethod){case"password":const r={idToken:n,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Zw(e,r,"signUpPassword",Tj);case"emailLink":return bj(e,{idToken:n,email:this._email,oobCode:this._password});default:dr(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Yo(t,e){return Nh(t,"POST","/v1/accounts:signInWithIdp",io(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cj="http://localhost";class $i extends yy{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new $i(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):dr("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:s,...i}=n;if(!r||!s)return null;const o=new $i(r,s);return o.idToken=i.idToken||void 0,o.accessToken=i.accessToken||void 0,o.secret=i.secret,o.nonce=i.nonce,o.pendingToken=i.pendingToken||null,o}_getIdTokenResponse(e){const n=this.buildRequest();return Yo(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,Yo(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,Yo(e,n)}buildRequest(){const e={requestUri:Cj,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=bc(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Aj(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function Rj(t){const e=fl(pl(t)).link,n=e?fl(pl(e)).deep_link_id:null,r=fl(pl(t)).deep_link_id;return(r?fl(pl(r)).link:null)||r||n||e||t}class _y{constructor(e){const n=fl(pl(e)),r=n.apiKey??null,s=n.oobCode??null,i=Aj(n.mode??null);ve(r&&s&&i,"argument-error"),this.apiKey=r,this.operation=i,this.code=s,this.continueUrl=n.continueUrl??null,this.languageCode=n.lang??null,this.tenantId=n.tenantId??null}static parseLink(e){const n=Rj(e);try{return new _y(n)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pa{constructor(){this.providerId=Pa.PROVIDER_ID}static credential(e,n){return ac._fromEmailAndPassword(e,n)}static credentialWithLink(e,n){const r=_y.parseLink(n);return ve(r,"argument-error"),ac._fromEmailAndCode(e,r.code,r.tenantId)}}Pa.PROVIDER_ID="password";Pa.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Pa.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SS{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ac extends SS{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Es extends Ac{constructor(){super("facebook.com")}static credential(e){return $i._fromParams({providerId:Es.PROVIDER_ID,signInMethod:Es.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Es.credentialFromTaggedObject(e)}static credentialFromError(e){return Es.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Es.credential(e.oauthAccessToken)}catch{return null}}}Es.FACEBOOK_SIGN_IN_METHOD="facebook.com";Es.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Is extends Ac{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return $i._fromParams({providerId:Is.PROVIDER_ID,signInMethod:Is.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return Is.credentialFromTaggedObject(e)}static credentialFromError(e){return Is.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return Is.credential(n,r)}catch{return null}}}Is.GOOGLE_SIGN_IN_METHOD="google.com";Is.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ts extends Ac{constructor(){super("github.com")}static credential(e){return $i._fromParams({providerId:Ts.PROVIDER_ID,signInMethod:Ts.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ts.credentialFromTaggedObject(e)}static credentialFromError(e){return Ts.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ts.credential(e.oauthAccessToken)}catch{return null}}}Ts.GITHUB_SIGN_IN_METHOD="github.com";Ts.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xs extends Ac{constructor(){super("twitter.com")}static credential(e,n){return $i._fromParams({providerId:xs.PROVIDER_ID,signInMethod:xs.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return xs.credentialFromTaggedObject(e)}static credentialFromError(e){return xs.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return xs.credential(n,r)}catch{return null}}}xs.TWITTER_SIGN_IN_METHOD="twitter.com";xs.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ca{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,s=!1){const i=await ir._fromIdTokenResponse(e,r,s),o=tE(r);return new ca({user:i,providerId:o,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const s=tE(r);return new ca({user:e,providerId:s,_tokenResponse:r,operationType:n})}}function tE(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ld extends Jn{constructor(e,n,r,s){super(n.code,n.message),this.operationType=r,this.user=s,Object.setPrototypeOf(this,Ld.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,s){return new Ld(e,n,r,s)}}function bS(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?Ld._fromErrorAndOperation(t,i,e,r):i})}async function Pj(t,e,n=!1){const r=await oc(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return ca._forOperation(t,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Nj(t,e,n=!1){const{auth:r}=t;if(Bn(r.app))return Promise.reject($s(r));const s="reauthenticate";try{const i=await oc(t,bS(r,s,e,t),n);ve(i.idToken,r,"internal-error");const o=my(i.idToken);ve(o,r,"internal-error");const{sub:a}=o;return ve(t.uid===a,r,"user-mismatch"),ca._forOperation(t,s,i)}catch(i){throw(i==null?void 0:i.code)==="auth/user-not-found"&&dr(r,"user-mismatch"),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function CS(t,e,n=!1){if(Bn(t.app))return Promise.reject($s(t));const r="signIn",s=await bS(t,r,e),i=await ca._fromIdTokenResponse(t,r,s);return n||await t._updateCurrentUser(i.user),i}async function kj(t,e){return CS(Ra(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Dj(t){const e=Ra(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}function jj(t,e,n){return Bn(t.app)?Promise.reject($s(t)):kj(Ke(t),Pa.credential(e,n)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&Dj(t),r})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Oj(t,e){return Ke(t).setPersistence(e)}function Vj(t,e,n,r){return Ke(t).onIdTokenChanged(e,n,r)}function Lj(t,e,n){return Ke(t).beforeAuthStateChanged(e,n)}function vy(t,e,n,r){return Ke(t).onAuthStateChanged(e,n,r)}function Mj(t){return Ke(t).signOut()}const Md="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AS{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(Md,"1"),this.storage.removeItem(Md),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fj=1e3,Uj=10;class RS extends AS{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=wS(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),s=this.localCache[n];r!==s&&e(n,s,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((o,a,l)=>{this.notifyListeners(o,l)});return}const r=e.key;n?this.detachListener():this.stopPolling();const s=()=>{const o=this.storage.getItem(r);!n&&this.localCache[r]===o||this.notifyListeners(r,o)},i=this.storage.getItem(r);sj()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,Uj):s()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},Fj)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}RS.type="LOCAL";const PS=RS;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NS extends AS{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}NS.type="SESSION";const kS=NS;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $j(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dh{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(s=>s.isListeningto(e));if(n)return n;const r=new Dh(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:s,data:i}=n.data,o=this.handlersMap[s];if(!(o!=null&&o.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:s});const a=Array.from(o).map(async d=>d(n.origin,i)),l=await $j(a);n.ports[0].postMessage({status:"done",eventId:r,eventType:s,response:l})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Dh.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wy(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bj{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let i,o;return new Promise((a,l)=>{const d=wy("",20);s.port1.start();const h=setTimeout(()=>{l(new Error("unsupported_event"))},r);o={messageChannel:s,onMessage(f){const m=f;if(m.data.eventId===d)switch(m.data.status){case"ack":clearTimeout(h),i=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),a(m.data.response);break;default:clearTimeout(h),clearTimeout(i),l(new Error("invalid_response"));break}}},this.handlers.add(o),s.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:d,data:n},[s.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nr(){return window}function zj(t){Nr().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DS(){return typeof Nr().WorkerGlobalScope<"u"&&typeof Nr().importScripts=="function"}async function qj(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function Hj(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)==null?void 0:t.controller)||null}function Wj(){return DS()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jS="firebaseLocalStorageDb",Kj=1,Fd="firebaseLocalStorage",OS="fbase_key";class Rc{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function jh(t,e){return t.transaction([Fd],e?"readwrite":"readonly").objectStore(Fd)}function Gj(){const t=indexedDB.deleteDatabase(jS);return new Rc(t).toPromise()}function km(){const t=indexedDB.open(jS,Kj);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(Fd,{keyPath:OS})}catch(s){n(s)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(Fd)?e(r):(r.close(),await Gj(),e(await km()))})})}async function nE(t,e,n){const r=jh(t,!0).put({[OS]:e,value:n});return new Rc(r).toPromise()}async function Qj(t,e){const n=jh(t,!1).get(e),r=await new Rc(n).toPromise();return r===void 0?null:r.value}function rE(t,e){const n=jh(t,!0).delete(e);return new Rc(n).toPromise()}const Yj=800,Xj=3;class VS{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await km(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>Xj)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return DS()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Dh._getInstance(Wj()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var n,r;if(this.activeServiceWorker=await qj(),!this.activeServiceWorker)return;this.sender=new Bj(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&(n=e[0])!=null&&n.fulfilled&&(r=e[0])!=null&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||Hj()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await km();return await nE(e,Md,"1"),await rE(e,Md),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>nE(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>Qj(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>rE(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const i=jh(s,!1).getAll();return new Rc(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;if(e.length!==0)for(const{fbase_key:s,value:i}of e)r.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(i)&&(this.notifyListeners(s,i),n.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!r.has(s)&&(this.notifyListeners(s,null),n.push(s));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),Yj)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}VS.type="LOCAL";const Jj=VS;new Cc(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zj(t,e){return e?$r(e):(ve(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ey extends yy{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Yo(e,this._buildIdpRequest())}_linkToIdToken(e,n){return Yo(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return Yo(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function e2(t){return CS(t.auth,new Ey(t),t.bypassAuthState)}function t2(t){const{auth:e,user:n}=t;return ve(n,e,"internal-error"),Nj(n,new Ey(t),t.bypassAuthState)}async function n2(t){const{auth:e,user:n}=t;return ve(n,e,"internal-error"),Pj(n,new Ey(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LS{constructor(e,n,r,s,i=!1){this.auth=e,this.resolver=r,this.user=s,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:s,tenantId:i,error:o,type:a}=e;if(o){this.reject(o);return}const l={auth:this.auth,requestUri:n,sessionId:r,tenantId:i||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(l))}catch(d){this.reject(d)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return e2;case"linkViaPopup":case"linkViaRedirect":return n2;case"reauthViaPopup":case"reauthViaRedirect":return t2;default:dr(this.auth,"internal-error")}}resolve(e){Jr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Jr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const r2=new Cc(2e3,1e4);class $o extends LS{constructor(e,n,r,s,i){super(e,n,s,i),this.provider=r,this.authWindow=null,this.pollId=null,$o.currentPopupAction&&$o.currentPopupAction.cancel(),$o.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return ve(e,this.auth,"internal-error"),e}async onExecution(){Jr(this.filter.length===1,"Popup operations only handle one event");const e=wy();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(Pr(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)==null?void 0:e.associatedEvent)||null}cancel(){this.reject(Pr(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,$o.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,r;if((r=(n=this.authWindow)==null?void 0:n.window)!=null&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Pr(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,r2.get())};e()}}$o.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const s2="pendingRedirect",Wu=new Map;class i2 extends LS{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=Wu.get(this.auth._key());if(!e){try{const r=await o2(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}Wu.set(this.auth._key(),e)}return this.bypassAuthState||Wu.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function o2(t,e){const n=c2(e),r=l2(t);if(!await r._isAvailable())return!1;const s=await r._get(n)==="true";return await r._remove(n),s}function a2(t,e){Wu.set(t._key(),e)}function l2(t){return $r(t._redirectPersistence)}function c2(t){return Hu(s2,t.config.apiKey,t.name)}async function u2(t,e,n=!1){if(Bn(t.app))return Promise.reject($s(t));const r=Ra(t),s=Zj(r,e),o=await new i2(r,s,n).execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const d2=10*60*1e3;class h2{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!f2(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!MS(e)){const s=((r=e.error.code)==null?void 0:r.split("auth/")[1])||"internal-error";n.onError(Pr(this.auth,s))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=d2&&this.cachedEventUids.clear(),this.cachedEventUids.has(sE(e))}saveEventToCache(e){this.cachedEventUids.add(sE(e)),this.lastProcessedEventTime=Date.now()}}function sE(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function MS({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function f2(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return MS(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function p2(t,e={}){return ri(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const m2=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,g2=/^https?/;async function y2(t){if(t.config.emulator)return;const{authorizedDomains:e}=await p2(t);for(const n of e)try{if(_2(n))return}catch{}dr(t,"unauthorized-domain")}function _2(t){const e=Pm(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&o.hostname===r}if(!g2.test(n))return!1;if(m2.test(t))return r===t;const s=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const v2=new Cc(3e4,6e4);function iE(){const t=Nr().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function w2(t){return new Promise((e,n)=>{var s,i,o;function r(){iE(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{iE(),n(Pr(t,"network-request-failed"))},timeout:v2.get()})}if((i=(s=Nr().gapi)==null?void 0:s.iframes)!=null&&i.Iframe)e(gapi.iframes.getContext());else if((o=Nr().gapi)!=null&&o.load)r();else{const a=fj("iframefcb");return Nr()[a]=()=>{gapi.load?r():n(Pr(t,"network-request-failed"))},IS(`${hj()}?onload=${a}`).catch(l=>n(l))}}).catch(e=>{throw Ku=null,e})}let Ku=null;function E2(t){return Ku=Ku||w2(t),Ku}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const I2=new Cc(5e3,15e3),T2="__/auth/iframe",x2="emulator/auth/iframe",S2={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},b2=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function C2(t){const e=t.config;ve(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?py(e,x2):`https://${t.config.authDomain}/${T2}`,r={apiKey:e.apiKey,appName:t.name,v:so},s=b2.get(t.config.apiHost);s&&(r.eid=s);const i=t._getFrameworks();return i.length&&(r.fw=i.join(",")),`${n}?${bc(r).slice(1)}`}async function A2(t){const e=await E2(t),n=Nr().gapi;return ve(n,t,"internal-error"),e.open({where:document.body,url:C2(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:S2,dontclear:!0},r=>new Promise(async(s,i)=>{await r.restyle({setHideOnLeave:!1});const o=Pr(t,"network-request-failed"),a=Nr().setTimeout(()=>{i(o)},I2.get());function l(){Nr().clearTimeout(a),s(r)}r.ping(l).then(l,()=>{i(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const R2={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},P2=500,N2=600,k2="_blank",D2="http://localhost";class oE{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function j2(t,e,n,r=P2,s=N2){const i=Math.max((window.screen.availHeight-s)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let a="";const l={...R2,width:r.toString(),height:s.toString(),top:i,left:o},d=Vt().toLowerCase();n&&(a=mS(d)?k2:n),fS(d)&&(e=e||D2,l.scrollbars="yes");const h=Object.entries(l).reduce((m,[w,A])=>`${m}${w}=${A},`,"");if(rj(d)&&a!=="_self")return O2(e||"",a),new oE(null);const f=window.open(e||"",a,h);ve(f,t,"popup-blocked");try{f.focus()}catch{}return new oE(f)}function O2(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const V2="__/auth/handler",L2="emulator/auth/handler",M2=encodeURIComponent("fac");async function aE(t,e,n,r,s,i){ve(t.config.authDomain,t,"auth-domain-config-required"),ve(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:so,eventId:s};if(e instanceof SS){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",wk(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[h,f]of Object.entries({}))o[h]=f}if(e instanceof Ac){const h=e.getScopes().filter(f=>f!=="");h.length>0&&(o.scopes=h.join(","))}t.tenantId&&(o.tid=t.tenantId);const a=o;for(const h of Object.keys(a))a[h]===void 0&&delete a[h];const l=await t._getAppCheckToken(),d=l?`#${M2}=${encodeURIComponent(l)}`:"";return`${F2(t)}?${bc(a).slice(1)}${d}`}function F2({config:t}){return t.emulator?py(t,L2):`https://${t.authDomain}/${V2}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const up="webStorageSupport";class U2{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=kS,this._completeRedirectFn=u2,this._overrideRedirectResult=a2}async _openPopup(e,n,r,s){var o;Jr((o=this.eventManagers[e._key()])==null?void 0:o.manager,"_initialize() not called before _openPopup()");const i=await aE(e,n,r,Pm(),s);return j2(e,i,wy())}async _openRedirect(e,n,r,s){await this._originValidation(e);const i=await aE(e,n,r,Pm(),s);return zj(i),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:s,promise:i}=this.eventManagers[n];return s?Promise.resolve(s):(Jr(i,"If manager is not set, promise should be"),i)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await A2(e),r=new h2(e);return n.register("authEvent",s=>(ve(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:r.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(up,{type:up},s=>{var o;const i=(o=s==null?void 0:s[0])==null?void 0:o[up];i!==void 0&&n(!!i),dr(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=y2(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return wS()||pS()||gy()}}const $2=U2;var lE="@firebase/auth",cE="1.11.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class B2{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)==null?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){ve(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function z2(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function q2(t){ur(new Xn("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=r.options;ve(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const l={apiKey:o,authDomain:a,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:ES(t)},d=new cj(r,s,i,l);return vj(d,n),d},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),ur(new Xn("auth-internal",e=>{const n=Ra(e.getProvider("auth").getImmediate());return(r=>new B2(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),bn(lE,cE,z2(t)),bn(lE,cE,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const H2=5*60,W2=Kx("authIdTokenMaxAge")||H2;let uE=null;const K2=t=>async e=>{const n=e&&await e.getIdTokenResult(),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>W2)return;const s=n==null?void 0:n.token;uE!==s&&(uE=s,await fetch(t,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function FS(t=Ph()){const e=ni(t,"auth");if(e.isInitialized())return e.getImmediate();const n=_j(t,{popupRedirectResolver:$2,persistence:[Jj,PS,kS]}),r=Kx("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(r,location.origin);if(location.origin===i.origin){const o=K2(i.toString());Lj(n,o,()=>o(n.currentUser)),Vj(n,a=>o(a))}}const s=qx("auth");return s&&wj(n,`http://${s}`),n}function G2(){var t;return((t=document.getElementsByTagName("head"))==null?void 0:t[0])??document}uj({loadJS(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=s=>{const i=Pr("internal-error");i.customData=s,n(i)},r.type="text/javascript",r.charset="UTF-8",G2().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});q2("Browser");var dE=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Bs,US;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(T,_){function S(){}S.prototype=_.prototype,T.F=_.prototype,T.prototype=new S,T.prototype.constructor=T,T.D=function(C,k,D){for(var R=Array(arguments.length-2),K=2;K<arguments.length;K++)R[K-2]=arguments[K];return _.prototype[k].apply(C,R)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(r,n),r.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(T,_,S){S||(S=0);const C=Array(16);if(typeof _=="string")for(var k=0;k<16;++k)C[k]=_.charCodeAt(S++)|_.charCodeAt(S++)<<8|_.charCodeAt(S++)<<16|_.charCodeAt(S++)<<24;else for(k=0;k<16;++k)C[k]=_[S++]|_[S++]<<8|_[S++]<<16|_[S++]<<24;_=T.g[0],S=T.g[1],k=T.g[2];let D=T.g[3],R;R=_+(D^S&(k^D))+C[0]+3614090360&4294967295,_=S+(R<<7&4294967295|R>>>25),R=D+(k^_&(S^k))+C[1]+3905402710&4294967295,D=_+(R<<12&4294967295|R>>>20),R=k+(S^D&(_^S))+C[2]+606105819&4294967295,k=D+(R<<17&4294967295|R>>>15),R=S+(_^k&(D^_))+C[3]+3250441966&4294967295,S=k+(R<<22&4294967295|R>>>10),R=_+(D^S&(k^D))+C[4]+4118548399&4294967295,_=S+(R<<7&4294967295|R>>>25),R=D+(k^_&(S^k))+C[5]+1200080426&4294967295,D=_+(R<<12&4294967295|R>>>20),R=k+(S^D&(_^S))+C[6]+2821735955&4294967295,k=D+(R<<17&4294967295|R>>>15),R=S+(_^k&(D^_))+C[7]+4249261313&4294967295,S=k+(R<<22&4294967295|R>>>10),R=_+(D^S&(k^D))+C[8]+1770035416&4294967295,_=S+(R<<7&4294967295|R>>>25),R=D+(k^_&(S^k))+C[9]+2336552879&4294967295,D=_+(R<<12&4294967295|R>>>20),R=k+(S^D&(_^S))+C[10]+4294925233&4294967295,k=D+(R<<17&4294967295|R>>>15),R=S+(_^k&(D^_))+C[11]+2304563134&4294967295,S=k+(R<<22&4294967295|R>>>10),R=_+(D^S&(k^D))+C[12]+1804603682&4294967295,_=S+(R<<7&4294967295|R>>>25),R=D+(k^_&(S^k))+C[13]+4254626195&4294967295,D=_+(R<<12&4294967295|R>>>20),R=k+(S^D&(_^S))+C[14]+2792965006&4294967295,k=D+(R<<17&4294967295|R>>>15),R=S+(_^k&(D^_))+C[15]+1236535329&4294967295,S=k+(R<<22&4294967295|R>>>10),R=_+(k^D&(S^k))+C[1]+4129170786&4294967295,_=S+(R<<5&4294967295|R>>>27),R=D+(S^k&(_^S))+C[6]+3225465664&4294967295,D=_+(R<<9&4294967295|R>>>23),R=k+(_^S&(D^_))+C[11]+643717713&4294967295,k=D+(R<<14&4294967295|R>>>18),R=S+(D^_&(k^D))+C[0]+3921069994&4294967295,S=k+(R<<20&4294967295|R>>>12),R=_+(k^D&(S^k))+C[5]+3593408605&4294967295,_=S+(R<<5&4294967295|R>>>27),R=D+(S^k&(_^S))+C[10]+38016083&4294967295,D=_+(R<<9&4294967295|R>>>23),R=k+(_^S&(D^_))+C[15]+3634488961&4294967295,k=D+(R<<14&4294967295|R>>>18),R=S+(D^_&(k^D))+C[4]+3889429448&4294967295,S=k+(R<<20&4294967295|R>>>12),R=_+(k^D&(S^k))+C[9]+568446438&4294967295,_=S+(R<<5&4294967295|R>>>27),R=D+(S^k&(_^S))+C[14]+3275163606&4294967295,D=_+(R<<9&4294967295|R>>>23),R=k+(_^S&(D^_))+C[3]+4107603335&4294967295,k=D+(R<<14&4294967295|R>>>18),R=S+(D^_&(k^D))+C[8]+1163531501&4294967295,S=k+(R<<20&4294967295|R>>>12),R=_+(k^D&(S^k))+C[13]+2850285829&4294967295,_=S+(R<<5&4294967295|R>>>27),R=D+(S^k&(_^S))+C[2]+4243563512&4294967295,D=_+(R<<9&4294967295|R>>>23),R=k+(_^S&(D^_))+C[7]+1735328473&4294967295,k=D+(R<<14&4294967295|R>>>18),R=S+(D^_&(k^D))+C[12]+2368359562&4294967295,S=k+(R<<20&4294967295|R>>>12),R=_+(S^k^D)+C[5]+4294588738&4294967295,_=S+(R<<4&4294967295|R>>>28),R=D+(_^S^k)+C[8]+2272392833&4294967295,D=_+(R<<11&4294967295|R>>>21),R=k+(D^_^S)+C[11]+1839030562&4294967295,k=D+(R<<16&4294967295|R>>>16),R=S+(k^D^_)+C[14]+4259657740&4294967295,S=k+(R<<23&4294967295|R>>>9),R=_+(S^k^D)+C[1]+2763975236&4294967295,_=S+(R<<4&4294967295|R>>>28),R=D+(_^S^k)+C[4]+1272893353&4294967295,D=_+(R<<11&4294967295|R>>>21),R=k+(D^_^S)+C[7]+4139469664&4294967295,k=D+(R<<16&4294967295|R>>>16),R=S+(k^D^_)+C[10]+3200236656&4294967295,S=k+(R<<23&4294967295|R>>>9),R=_+(S^k^D)+C[13]+681279174&4294967295,_=S+(R<<4&4294967295|R>>>28),R=D+(_^S^k)+C[0]+3936430074&4294967295,D=_+(R<<11&4294967295|R>>>21),R=k+(D^_^S)+C[3]+3572445317&4294967295,k=D+(R<<16&4294967295|R>>>16),R=S+(k^D^_)+C[6]+76029189&4294967295,S=k+(R<<23&4294967295|R>>>9),R=_+(S^k^D)+C[9]+3654602809&4294967295,_=S+(R<<4&4294967295|R>>>28),R=D+(_^S^k)+C[12]+3873151461&4294967295,D=_+(R<<11&4294967295|R>>>21),R=k+(D^_^S)+C[15]+530742520&4294967295,k=D+(R<<16&4294967295|R>>>16),R=S+(k^D^_)+C[2]+3299628645&4294967295,S=k+(R<<23&4294967295|R>>>9),R=_+(k^(S|~D))+C[0]+4096336452&4294967295,_=S+(R<<6&4294967295|R>>>26),R=D+(S^(_|~k))+C[7]+1126891415&4294967295,D=_+(R<<10&4294967295|R>>>22),R=k+(_^(D|~S))+C[14]+2878612391&4294967295,k=D+(R<<15&4294967295|R>>>17),R=S+(D^(k|~_))+C[5]+4237533241&4294967295,S=k+(R<<21&4294967295|R>>>11),R=_+(k^(S|~D))+C[12]+1700485571&4294967295,_=S+(R<<6&4294967295|R>>>26),R=D+(S^(_|~k))+C[3]+2399980690&4294967295,D=_+(R<<10&4294967295|R>>>22),R=k+(_^(D|~S))+C[10]+4293915773&4294967295,k=D+(R<<15&4294967295|R>>>17),R=S+(D^(k|~_))+C[1]+2240044497&4294967295,S=k+(R<<21&4294967295|R>>>11),R=_+(k^(S|~D))+C[8]+1873313359&4294967295,_=S+(R<<6&4294967295|R>>>26),R=D+(S^(_|~k))+C[15]+4264355552&4294967295,D=_+(R<<10&4294967295|R>>>22),R=k+(_^(D|~S))+C[6]+2734768916&4294967295,k=D+(R<<15&4294967295|R>>>17),R=S+(D^(k|~_))+C[13]+1309151649&4294967295,S=k+(R<<21&4294967295|R>>>11),R=_+(k^(S|~D))+C[4]+4149444226&4294967295,_=S+(R<<6&4294967295|R>>>26),R=D+(S^(_|~k))+C[11]+3174756917&4294967295,D=_+(R<<10&4294967295|R>>>22),R=k+(_^(D|~S))+C[2]+718787259&4294967295,k=D+(R<<15&4294967295|R>>>17),R=S+(D^(k|~_))+C[9]+3951481745&4294967295,T.g[0]=T.g[0]+_&4294967295,T.g[1]=T.g[1]+(k+(R<<21&4294967295|R>>>11))&4294967295,T.g[2]=T.g[2]+k&4294967295,T.g[3]=T.g[3]+D&4294967295}r.prototype.v=function(T,_){_===void 0&&(_=T.length);const S=_-this.blockSize,C=this.C;let k=this.h,D=0;for(;D<_;){if(k==0)for(;D<=S;)s(this,T,D),D+=this.blockSize;if(typeof T=="string"){for(;D<_;)if(C[k++]=T.charCodeAt(D++),k==this.blockSize){s(this,C),k=0;break}}else for(;D<_;)if(C[k++]=T[D++],k==this.blockSize){s(this,C),k=0;break}}this.h=k,this.o+=_},r.prototype.A=function(){var T=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);T[0]=128;for(var _=1;_<T.length-8;++_)T[_]=0;_=this.o*8;for(var S=T.length-8;S<T.length;++S)T[S]=_&255,_/=256;for(this.v(T),T=Array(16),_=0,S=0;S<4;++S)for(let C=0;C<32;C+=8)T[_++]=this.g[S]>>>C&255;return T};function i(T,_){var S=a;return Object.prototype.hasOwnProperty.call(S,T)?S[T]:S[T]=_(T)}function o(T,_){this.h=_;const S=[];let C=!0;for(let k=T.length-1;k>=0;k--){const D=T[k]|0;C&&D==_||(S[k]=D,C=!1)}this.g=S}var a={};function l(T){return-128<=T&&T<128?i(T,function(_){return new o([_|0],_<0?-1:0)}):new o([T|0],T<0?-1:0)}function d(T){if(isNaN(T)||!isFinite(T))return f;if(T<0)return P(d(-T));const _=[];let S=1;for(let C=0;T>=S;C++)_[C]=T/S|0,S*=4294967296;return new o(_,0)}function h(T,_){if(T.length==0)throw Error("number format error: empty string");if(_=_||10,_<2||36<_)throw Error("radix out of range: "+_);if(T.charAt(0)=="-")return P(h(T.substring(1),_));if(T.indexOf("-")>=0)throw Error('number format error: interior "-" character');const S=d(Math.pow(_,8));let C=f;for(let D=0;D<T.length;D+=8){var k=Math.min(8,T.length-D);const R=parseInt(T.substring(D,D+k),_);k<8?(k=d(Math.pow(_,k)),C=C.j(k).add(d(R))):(C=C.j(S),C=C.add(d(R)))}return C}var f=l(0),m=l(1),w=l(16777216);t=o.prototype,t.m=function(){if(b(this))return-P(this).m();let T=0,_=1;for(let S=0;S<this.g.length;S++){const C=this.i(S);T+=(C>=0?C:4294967296+C)*_,_*=4294967296}return T},t.toString=function(T){if(T=T||10,T<2||36<T)throw Error("radix out of range: "+T);if(A(this))return"0";if(b(this))return"-"+P(this).toString(T);const _=d(Math.pow(T,6));var S=this;let C="";for(;;){const k=j(S,_).g;S=I(S,k.j(_));let D=((S.g.length>0?S.g[0]:S.h)>>>0).toString(T);if(S=k,A(S))return D+C;for(;D.length<6;)D="0"+D;C=D+C}},t.i=function(T){return T<0?0:T<this.g.length?this.g[T]:this.h};function A(T){if(T.h!=0)return!1;for(let _=0;_<T.g.length;_++)if(T.g[_]!=0)return!1;return!0}function b(T){return T.h==-1}t.l=function(T){return T=I(this,T),b(T)?-1:A(T)?0:1};function P(T){const _=T.g.length,S=[];for(let C=0;C<_;C++)S[C]=~T.g[C];return new o(S,~T.h).add(m)}t.abs=function(){return b(this)?P(this):this},t.add=function(T){const _=Math.max(this.g.length,T.g.length),S=[];let C=0;for(let k=0;k<=_;k++){let D=C+(this.i(k)&65535)+(T.i(k)&65535),R=(D>>>16)+(this.i(k)>>>16)+(T.i(k)>>>16);C=R>>>16,D&=65535,R&=65535,S[k]=R<<16|D}return new o(S,S[S.length-1]&-2147483648?-1:0)};function I(T,_){return T.add(P(_))}t.j=function(T){if(A(this)||A(T))return f;if(b(this))return b(T)?P(this).j(P(T)):P(P(this).j(T));if(b(T))return P(this.j(P(T)));if(this.l(w)<0&&T.l(w)<0)return d(this.m()*T.m());const _=this.g.length+T.g.length,S=[];for(var C=0;C<2*_;C++)S[C]=0;for(C=0;C<this.g.length;C++)for(let k=0;k<T.g.length;k++){const D=this.i(C)>>>16,R=this.i(C)&65535,K=T.i(k)>>>16,Ze=T.i(k)&65535;S[2*C+2*k]+=R*Ze,E(S,2*C+2*k),S[2*C+2*k+1]+=D*Ze,E(S,2*C+2*k+1),S[2*C+2*k+1]+=R*K,E(S,2*C+2*k+1),S[2*C+2*k+2]+=D*K,E(S,2*C+2*k+2)}for(T=0;T<_;T++)S[T]=S[2*T+1]<<16|S[2*T];for(T=_;T<2*_;T++)S[T]=0;return new o(S,0)};function E(T,_){for(;(T[_]&65535)!=T[_];)T[_+1]+=T[_]>>>16,T[_]&=65535,_++}function y(T,_){this.g=T,this.h=_}function j(T,_){if(A(_))throw Error("division by zero");if(A(T))return new y(f,f);if(b(T))return _=j(P(T),_),new y(P(_.g),P(_.h));if(b(_))return _=j(T,P(_)),new y(P(_.g),_.h);if(T.g.length>30){if(b(T)||b(_))throw Error("slowDivide_ only works with positive integers.");for(var S=m,C=_;C.l(T)<=0;)S=V(S),C=V(C);var k=M(S,1),D=M(C,1);for(C=M(C,2),S=M(S,2);!A(C);){var R=D.add(C);R.l(T)<=0&&(k=k.add(S),D=R),C=M(C,1),S=M(S,1)}return _=I(T,k.j(_)),new y(k,_)}for(k=f;T.l(_)>=0;){for(S=Math.max(1,Math.floor(T.m()/_.m())),C=Math.ceil(Math.log(S)/Math.LN2),C=C<=48?1:Math.pow(2,C-48),D=d(S),R=D.j(_);b(R)||R.l(T)>0;)S-=C,D=d(S),R=D.j(_);A(D)&&(D=m),k=k.add(D),T=I(T,R)}return new y(k,T)}t.B=function(T){return j(this,T).h},t.and=function(T){const _=Math.max(this.g.length,T.g.length),S=[];for(let C=0;C<_;C++)S[C]=this.i(C)&T.i(C);return new o(S,this.h&T.h)},t.or=function(T){const _=Math.max(this.g.length,T.g.length),S=[];for(let C=0;C<_;C++)S[C]=this.i(C)|T.i(C);return new o(S,this.h|T.h)},t.xor=function(T){const _=Math.max(this.g.length,T.g.length),S=[];for(let C=0;C<_;C++)S[C]=this.i(C)^T.i(C);return new o(S,this.h^T.h)};function V(T){const _=T.g.length+1,S=[];for(let C=0;C<_;C++)S[C]=T.i(C)<<1|T.i(C-1)>>>31;return new o(S,T.h)}function M(T,_){const S=_>>5;_%=32;const C=T.g.length-S,k=[];for(let D=0;D<C;D++)k[D]=_>0?T.i(D+S)>>>_|T.i(D+S+1)<<32-_:T.i(D+S);return new o(k,T.h)}r.prototype.digest=r.prototype.A,r.prototype.reset=r.prototype.u,r.prototype.update=r.prototype.v,US=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.B,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=d,o.fromString=h,Bs=o}).apply(typeof dE<"u"?dE:typeof self<"u"?self:typeof window<"u"?window:{});var _u=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var $S,ml,BS,Gu,Dm,zS,qS,HS;(function(){var t,e=Object.defineProperty;function n(c){c=[typeof globalThis=="object"&&globalThis,c,typeof window=="object"&&window,typeof self=="object"&&self,typeof _u=="object"&&_u];for(var p=0;p<c.length;++p){var g=c[p];if(g&&g.Math==Math)return g}throw Error("Cannot find global object")}var r=n(this);function s(c,p){if(p)e:{var g=r;c=c.split(".");for(var x=0;x<c.length-1;x++){var L=c[x];if(!(L in g))break e;g=g[L]}c=c[c.length-1],x=g[c],p=p(x),p!=x&&p!=null&&e(g,c,{configurable:!0,writable:!0,value:p})}}s("Symbol.dispose",function(c){return c||Symbol("Symbol.dispose")}),s("Array.prototype.values",function(c){return c||function(){return this[Symbol.iterator]()}}),s("Object.entries",function(c){return c||function(p){var g=[],x;for(x in p)Object.prototype.hasOwnProperty.call(p,x)&&g.push([x,p[x]]);return g}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var i=i||{},o=this||self;function a(c){var p=typeof c;return p=="object"&&c!=null||p=="function"}function l(c,p,g){return c.call.apply(c.bind,arguments)}function d(c,p,g){return d=l,d.apply(null,arguments)}function h(c,p){var g=Array.prototype.slice.call(arguments,1);return function(){var x=g.slice();return x.push.apply(x,arguments),c.apply(this,x)}}function f(c,p){function g(){}g.prototype=p.prototype,c.Z=p.prototype,c.prototype=new g,c.prototype.constructor=c,c.Ob=function(x,L,$){for(var Q=Array(arguments.length-2),be=2;be<arguments.length;be++)Q[be-2]=arguments[be];return p.prototype[L].apply(x,Q)}}var m=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?c=>c&&AsyncContext.Snapshot.wrap(c):c=>c;function w(c){const p=c.length;if(p>0){const g=Array(p);for(let x=0;x<p;x++)g[x]=c[x];return g}return[]}function A(c,p){for(let x=1;x<arguments.length;x++){const L=arguments[x];var g=typeof L;if(g=g!="object"?g:L?Array.isArray(L)?"array":g:"null",g=="array"||g=="object"&&typeof L.length=="number"){g=c.length||0;const $=L.length||0;c.length=g+$;for(let Q=0;Q<$;Q++)c[g+Q]=L[Q]}else c.push(L)}}class b{constructor(p,g){this.i=p,this.j=g,this.h=0,this.g=null}get(){let p;return this.h>0?(this.h--,p=this.g,this.g=p.next,p.next=null):p=this.i(),p}}function P(c){o.setTimeout(()=>{throw c},0)}function I(){var c=T;let p=null;return c.g&&(p=c.g,c.g=c.g.next,c.g||(c.h=null),p.next=null),p}class E{constructor(){this.h=this.g=null}add(p,g){const x=y.get();x.set(p,g),this.h?this.h.next=x:this.g=x,this.h=x}}var y=new b(()=>new j,c=>c.reset());class j{constructor(){this.next=this.g=this.h=null}set(p,g){this.h=p,this.g=g,this.next=null}reset(){this.next=this.g=this.h=null}}let V,M=!1,T=new E,_=()=>{const c=Promise.resolve(void 0);V=()=>{c.then(S)}};function S(){for(var c;c=I();){try{c.h.call(c.g)}catch(g){P(g)}var p=y;p.j(c),p.h<100&&(p.h++,c.next=p.g,p.g=c)}M=!1}function C(){this.u=this.u,this.C=this.C}C.prototype.u=!1,C.prototype.dispose=function(){this.u||(this.u=!0,this.N())},C.prototype[Symbol.dispose]=function(){this.dispose()},C.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function k(c,p){this.type=c,this.g=this.target=p,this.defaultPrevented=!1}k.prototype.h=function(){this.defaultPrevented=!0};var D=function(){if(!o.addEventListener||!Object.defineProperty)return!1;var c=!1,p=Object.defineProperty({},"passive",{get:function(){c=!0}});try{const g=()=>{};o.addEventListener("test",g,p),o.removeEventListener("test",g,p)}catch{}return c}();function R(c){return/^[\s\xa0]*$/.test(c)}function K(c,p){k.call(this,c?c.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,c&&this.init(c,p)}f(K,k),K.prototype.init=function(c,p){const g=this.type=c.type,x=c.changedTouches&&c.changedTouches.length?c.changedTouches[0]:null;this.target=c.target||c.srcElement,this.g=p,p=c.relatedTarget,p||(g=="mouseover"?p=c.fromElement:g=="mouseout"&&(p=c.toElement)),this.relatedTarget=p,x?(this.clientX=x.clientX!==void 0?x.clientX:x.pageX,this.clientY=x.clientY!==void 0?x.clientY:x.pageY,this.screenX=x.screenX||0,this.screenY=x.screenY||0):(this.clientX=c.clientX!==void 0?c.clientX:c.pageX,this.clientY=c.clientY!==void 0?c.clientY:c.pageY,this.screenX=c.screenX||0,this.screenY=c.screenY||0),this.button=c.button,this.key=c.key||"",this.ctrlKey=c.ctrlKey,this.altKey=c.altKey,this.shiftKey=c.shiftKey,this.metaKey=c.metaKey,this.pointerId=c.pointerId||0,this.pointerType=c.pointerType,this.state=c.state,this.i=c,c.defaultPrevented&&K.Z.h.call(this)},K.prototype.h=function(){K.Z.h.call(this);const c=this.i;c.preventDefault?c.preventDefault():c.returnValue=!1};var Ze="closure_listenable_"+(Math.random()*1e6|0),Mt=0;function he(c,p,g,x,L){this.listener=c,this.proxy=null,this.src=p,this.type=g,this.capture=!!x,this.ha=L,this.key=++Mt,this.da=this.fa=!1}function Y(c){c.da=!0,c.listener=null,c.proxy=null,c.src=null,c.ha=null}function ce(c,p,g){for(const x in c)p.call(g,c[x],x,c)}function me(c,p){for(const g in c)p.call(void 0,c[g],g,c)}function Oe(c){const p={};for(const g in c)p[g]=c[g];return p}const He="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function z(c,p){let g,x;for(let L=1;L<arguments.length;L++){x=arguments[L];for(g in x)c[g]=x[g];for(let $=0;$<He.length;$++)g=He[$],Object.prototype.hasOwnProperty.call(x,g)&&(c[g]=x[g])}}function Z(c){this.src=c,this.g={},this.h=0}Z.prototype.add=function(c,p,g,x,L){const $=c.toString();c=this.g[$],c||(c=this.g[$]=[],this.h++);const Q=we(c,p,x,L);return Q>-1?(p=c[Q],g||(p.fa=!1)):(p=new he(p,this.src,$,!!x,L),p.fa=g,c.push(p)),p};function ae(c,p){const g=p.type;if(g in c.g){var x=c.g[g],L=Array.prototype.indexOf.call(x,p,void 0),$;($=L>=0)&&Array.prototype.splice.call(x,L,1),$&&(Y(p),c.g[g].length==0&&(delete c.g[g],c.h--))}}function we(c,p,g,x){for(let L=0;L<c.length;++L){const $=c[L];if(!$.da&&$.listener==p&&$.capture==!!g&&$.ha==x)return L}return-1}var Ie="closure_lm_"+(Math.random()*1e6|0),Me={};function fe(c,p,g,x,L){if(Array.isArray(p)){for(let $=0;$<p.length;$++)fe(c,p[$],g,x,L);return null}return g=ue(g),c&&c[Ze]?c.J(p,g,a(x)?!!x.capture:!1,L):et(c,p,g,!1,x,L)}function et(c,p,g,x,L,$){if(!p)throw Error("Invalid event type");const Q=a(L)?!!L.capture:!!L;let be=re(c);if(be||(c[Ie]=be=new Z(c)),g=be.add(p,g,x,Q,$),g.proxy)return g;if(x=Te(),g.proxy=x,x.src=c,x.listener=g,c.addEventListener)D||(L=Q),L===void 0&&(L=!1),c.addEventListener(p.toString(),x,L);else if(c.attachEvent)c.attachEvent(bt(p.toString()),x);else if(c.addListener&&c.removeListener)c.addListener(x);else throw Error("addEventListener and attachEvent are unavailable.");return g}function Te(){function c(g){return p.call(c.src,c.listener,g)}const p=Nt;return c}function ne(c,p,g,x,L){if(Array.isArray(p))for(var $=0;$<p.length;$++)ne(c,p[$],g,x,L);else x=a(x)?!!x.capture:!!x,g=ue(g),c&&c[Ze]?(c=c.i,$=String(p).toString(),$ in c.g&&(p=c.g[$],g=we(p,g,x,L),g>-1&&(Y(p[g]),Array.prototype.splice.call(p,g,1),p.length==0&&(delete c.g[$],c.h--)))):c&&(c=re(c))&&(p=c.g[p.toString()],c=-1,p&&(c=we(p,g,x,L)),(g=c>-1?p[c]:null)&&Re(g))}function Re(c){if(typeof c!="number"&&c&&!c.da){var p=c.src;if(p&&p[Ze])ae(p.i,c);else{var g=c.type,x=c.proxy;p.removeEventListener?p.removeEventListener(g,x,c.capture):p.detachEvent?p.detachEvent(bt(g),x):p.addListener&&p.removeListener&&p.removeListener(x),(g=re(p))?(ae(g,c),g.h==0&&(g.src=null,p[Ie]=null)):Y(c)}}}function bt(c){return c in Me?Me[c]:Me[c]="on"+c}function Nt(c,p){if(c.da)c=!0;else{p=new K(p,this);const g=c.listener,x=c.ha||c.src;c.fa&&Re(c),c=g.call(x,p)}return c}function re(c){return c=c[Ie],c instanceof Z?c:null}var se="__closure_events_fn_"+(Math.random()*1e9>>>0);function ue(c){return typeof c=="function"?c:(c[se]||(c[se]=function(p){return c.handleEvent(p)}),c[se])}function G(){C.call(this),this.i=new Z(this),this.M=this,this.G=null}f(G,C),G.prototype[Ze]=!0,G.prototype.removeEventListener=function(c,p,g,x){ne(this,c,p,g,x)};function ee(c,p){var g,x=c.G;if(x)for(g=[];x;x=x.G)g.push(x);if(c=c.M,x=p.type||p,typeof p=="string")p=new k(p,c);else if(p instanceof k)p.target=p.target||c;else{var L=p;p=new k(x,c),z(p,L)}L=!0;let $,Q;if(g)for(Q=g.length-1;Q>=0;Q--)$=p.g=g[Q],L=ge($,x,!0,p)&&L;if($=p.g=c,L=ge($,x,!0,p)&&L,L=ge($,x,!1,p)&&L,g)for(Q=0;Q<g.length;Q++)$=p.g=g[Q],L=ge($,x,!1,p)&&L}G.prototype.N=function(){if(G.Z.N.call(this),this.i){var c=this.i;for(const p in c.g){const g=c.g[p];for(let x=0;x<g.length;x++)Y(g[x]);delete c.g[p],c.h--}}this.G=null},G.prototype.J=function(c,p,g,x){return this.i.add(String(c),p,!1,g,x)},G.prototype.K=function(c,p,g,x){return this.i.add(String(c),p,!0,g,x)};function ge(c,p,g,x){if(p=c.i.g[String(p)],!p)return!0;p=p.concat();let L=!0;for(let $=0;$<p.length;++$){const Q=p[$];if(Q&&!Q.da&&Q.capture==g){const be=Q.listener,Dt=Q.ha||Q.src;Q.fa&&ae(c.i,Q),L=be.call(Dt,x)!==!1&&L}}return L&&!x.defaultPrevented}function de(c,p){if(typeof c!="function")if(c&&typeof c.handleEvent=="function")c=d(c.handleEvent,c);else throw Error("Invalid listener argument");return Number(p)>2147483647?-1:o.setTimeout(c,p||0)}function Se(c){c.g=de(()=>{c.g=null,c.i&&(c.i=!1,Se(c))},c.l);const p=c.h;c.h=null,c.m.apply(null,p)}class Ve extends C{constructor(p,g){super(),this.m=p,this.l=g,this.h=null,this.i=!1,this.g=null}j(p){this.h=arguments,this.g?this.i=!0:Se(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function qe(c){C.call(this),this.h=c,this.g={}}f(qe,C);var rt=[];function Ce(c){ce(c.g,function(p,g){this.g.hasOwnProperty(g)&&Re(p)},c),c.g={}}qe.prototype.N=function(){qe.Z.N.call(this),Ce(this)},qe.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Ge=o.JSON.stringify,F=o.JSON.parse,J=class{stringify(c){return o.JSON.stringify(c,void 0)}parse(c){return o.JSON.parse(c,void 0)}};function v(){}function U(){}var te={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function ye(){k.call(this,"d")}f(ye,k);function Pe(){k.call(this,"c")}f(Pe,k);var Le={},Jt=null;function kt(){return Jt=Jt||new G}Le.Ia="serverreachability";function xt(c){k.call(this,Le.Ia,c)}f(xt,k);function We(c){const p=kt();ee(p,new xt(p))}Le.STAT_EVENT="statevent";function ft(c,p){k.call(this,Le.STAT_EVENT,c),this.stat=p}f(ft,k);function Ne(c){const p=kt();ee(p,new ft(p,c))}Le.Ja="timingevent";function is(c,p){k.call(this,Le.Ja,c),this.size=p}f(is,k);function mr(c,p){if(typeof c!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){c()},p)}function Cn(){this.g=!0}Cn.prototype.ua=function(){this.g=!1};function gr(c,p,g,x,L,$){c.info(function(){if(c.g)if($){var Q="",be=$.split("&");for(let tt=0;tt<be.length;tt++){var Dt=be[tt].split("=");if(Dt.length>1){const Ft=Dt[0];Dt=Dt[1];const _r=Ft.split("_");Q=_r.length>=2&&_r[1]=="type"?Q+(Ft+"="+Dt+"&"):Q+(Ft+"=redacted&")}}}else Q=null;else Q=$;return"XMLHTTP REQ ("+x+") [attempt "+L+"]: "+p+`
`+g+`
`+Q})}function FA(c,p,g,x,L,$,Q){c.info(function(){return"XMLHTTP RESP ("+x+") [ attempt "+L+"]: "+p+`
`+g+`
`+$+" "+Q})}function lo(c,p,g,x){c.info(function(){return"XMLHTTP TEXT ("+p+"): "+$A(c,g)+(x?" "+x:"")})}function UA(c,p){c.info(function(){return"TIMEOUT: "+p})}Cn.prototype.info=function(){};function $A(c,p){if(!c.g)return p;if(!p)return null;try{const $=JSON.parse(p);if($){for(c=0;c<$.length;c++)if(Array.isArray($[c])){var g=$[c];if(!(g.length<2)){var x=g[1];if(Array.isArray(x)&&!(x.length<1)){var L=x[0];if(L!="noop"&&L!="stop"&&L!="close")for(let Q=1;Q<x.length;Q++)x[Q]=""}}}}return Ge($)}catch{return p}}var zc={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},D_={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},j_;function gf(){}f(gf,v),gf.prototype.g=function(){return new XMLHttpRequest},j_=new gf;function Va(c){return encodeURIComponent(String(c))}function BA(c){var p=1;c=c.split(":");const g=[];for(;p>0&&c.length;)g.push(c.shift()),p--;return c.length&&g.push(c.join(":")),g}function os(c,p,g,x){this.j=c,this.i=p,this.l=g,this.S=x||1,this.V=new qe(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new O_}function O_(){this.i=null,this.g="",this.h=!1}var V_={},yf={};function _f(c,p,g){c.M=1,c.A=Hc(yr(p)),c.u=g,c.R=!0,L_(c,null)}function L_(c,p){c.F=Date.now(),qc(c),c.B=yr(c.A);var g=c.B,x=c.S;Array.isArray(x)||(x=[String(x)]),Y_(g.i,"t",x),c.C=0,g=c.j.L,c.h=new O_,c.g=pv(c.j,g?p:null,!c.u),c.P>0&&(c.O=new Ve(d(c.Y,c,c.g),c.P)),p=c.V,g=c.g,x=c.ba;var L="readystatechange";Array.isArray(L)||(L&&(rt[0]=L.toString()),L=rt);for(let $=0;$<L.length;$++){const Q=fe(g,L[$],x||p.handleEvent,!1,p.h||p);if(!Q)break;p.g[Q.key]=Q}p=c.J?Oe(c.J):{},c.u?(c.v||(c.v="POST"),p["Content-Type"]="application/x-www-form-urlencoded",c.g.ea(c.B,c.v,c.u,p)):(c.v="GET",c.g.ea(c.B,c.v,null,p)),We(),gr(c.i,c.v,c.B,c.l,c.S,c.u)}os.prototype.ba=function(c){c=c.target;const p=this.O;p&&cs(c)==3?p.j():this.Y(c)},os.prototype.Y=function(c){try{if(c==this.g)e:{const be=cs(this.g),Dt=this.g.ya(),tt=this.g.ca();if(!(be<3)&&(be!=3||this.g&&(this.h.h||this.g.la()||rv(this.g)))){this.K||be!=4||Dt==7||(Dt==8||tt<=0?We(3):We(2)),vf(this);var p=this.g.ca();this.X=p;var g=zA(this);if(this.o=p==200,FA(this.i,this.v,this.B,this.l,this.S,be,p),this.o){if(this.U&&!this.L){t:{if(this.g){var x,L=this.g;if((x=L.g?L.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!R(x)){var $=x;break t}}$=null}if(c=$)lo(this.i,this.l,c,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,wf(this,c);else{this.o=!1,this.m=3,Ne(12),ai(this),La(this);break e}}if(this.R){c=!0;let Ft;for(;!this.K&&this.C<g.length;)if(Ft=qA(this,g),Ft==yf){be==4&&(this.m=4,Ne(14),c=!1),lo(this.i,this.l,null,"[Incomplete Response]");break}else if(Ft==V_){this.m=4,Ne(15),lo(this.i,this.l,g,"[Invalid Chunk]"),c=!1;break}else lo(this.i,this.l,Ft,null),wf(this,Ft);if(M_(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),be!=4||g.length!=0||this.h.h||(this.m=1,Ne(16),c=!1),this.o=this.o&&c,!c)lo(this.i,this.l,g,"[Invalid Chunked Response]"),ai(this),La(this);else if(g.length>0&&!this.W){this.W=!0;var Q=this.j;Q.g==this&&Q.aa&&!Q.P&&(Q.j.info("Great, no buffering proxy detected. Bytes received: "+g.length),Af(Q),Q.P=!0,Ne(11))}}else lo(this.i,this.l,g,null),wf(this,g);be==4&&ai(this),this.o&&!this.K&&(be==4?uv(this.j,this):(this.o=!1,qc(this)))}else sR(this.g),p==400&&g.indexOf("Unknown SID")>0?(this.m=3,Ne(12)):(this.m=0,Ne(13)),ai(this),La(this)}}}catch{}finally{}};function zA(c){if(!M_(c))return c.g.la();const p=rv(c.g);if(p==="")return"";let g="";const x=p.length,L=cs(c.g)==4;if(!c.h.i){if(typeof TextDecoder>"u")return ai(c),La(c),"";c.h.i=new o.TextDecoder}for(let $=0;$<x;$++)c.h.h=!0,g+=c.h.i.decode(p[$],{stream:!(L&&$==x-1)});return p.length=0,c.h.g+=g,c.C=0,c.h.g}function M_(c){return c.g?c.v=="GET"&&c.M!=2&&c.j.Aa:!1}function qA(c,p){var g=c.C,x=p.indexOf(`
`,g);return x==-1?yf:(g=Number(p.substring(g,x)),isNaN(g)?V_:(x+=1,x+g>p.length?yf:(p=p.slice(x,x+g),c.C=x+g,p)))}os.prototype.cancel=function(){this.K=!0,ai(this)};function qc(c){c.T=Date.now()+c.H,F_(c,c.H)}function F_(c,p){if(c.D!=null)throw Error("WatchDog timer not null");c.D=mr(d(c.aa,c),p)}function vf(c){c.D&&(o.clearTimeout(c.D),c.D=null)}os.prototype.aa=function(){this.D=null;const c=Date.now();c-this.T>=0?(UA(this.i,this.B),this.M!=2&&(We(),Ne(17)),ai(this),this.m=2,La(this)):F_(this,this.T-c)};function La(c){c.j.I==0||c.K||uv(c.j,c)}function ai(c){vf(c);var p=c.O;p&&typeof p.dispose=="function"&&p.dispose(),c.O=null,Ce(c.V),c.g&&(p=c.g,c.g=null,p.abort(),p.dispose())}function wf(c,p){try{var g=c.j;if(g.I!=0&&(g.g==c||Ef(g.h,c))){if(!c.L&&Ef(g.h,c)&&g.I==3){try{var x=g.Ba.g.parse(p)}catch{x=null}if(Array.isArray(x)&&x.length==3){var L=x;if(L[0]==0){e:if(!g.v){if(g.g)if(g.g.F+3e3<c.F)Yc(g),Gc(g);else break e;Cf(g),Ne(18)}}else g.xa=L[1],0<g.xa-g.K&&L[2]<37500&&g.F&&g.A==0&&!g.C&&(g.C=mr(d(g.Va,g),6e3));B_(g.h)<=1&&g.ta&&(g.ta=void 0)}else ci(g,11)}else if((c.L||g.g==c)&&Yc(g),!R(p))for(L=g.Ba.g.parse(p),p=0;p<L.length;p++){let tt=L[p];const Ft=tt[0];if(!(Ft<=g.K))if(g.K=Ft,tt=tt[1],g.I==2)if(tt[0]=="c"){g.M=tt[1],g.ba=tt[2];const _r=tt[3];_r!=null&&(g.ka=_r,g.j.info("VER="+g.ka));const ui=tt[4];ui!=null&&(g.za=ui,g.j.info("SVER="+g.za));const us=tt[5];us!=null&&typeof us=="number"&&us>0&&(x=1.5*us,g.O=x,g.j.info("backChannelRequestTimeoutMs_="+x)),x=g;const ds=c.g;if(ds){const Jc=ds.g?ds.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Jc){var $=x.h;$.g||Jc.indexOf("spdy")==-1&&Jc.indexOf("quic")==-1&&Jc.indexOf("h2")==-1||($.j=$.l,$.g=new Set,$.h&&(If($,$.h),$.h=null))}if(x.G){const Rf=ds.g?ds.g.getResponseHeader("X-HTTP-Session-Id"):null;Rf&&(x.wa=Rf,it(x.J,x.G,Rf))}}g.I=3,g.l&&g.l.ra(),g.aa&&(g.T=Date.now()-c.F,g.j.info("Handshake RTT: "+g.T+"ms")),x=g;var Q=c;if(x.na=fv(x,x.L?x.ba:null,x.W),Q.L){z_(x.h,Q);var be=Q,Dt=x.O;Dt&&(be.H=Dt),be.D&&(vf(be),qc(be)),x.g=Q}else lv(x);g.i.length>0&&Qc(g)}else tt[0]!="stop"&&tt[0]!="close"||ci(g,7);else g.I==3&&(tt[0]=="stop"||tt[0]=="close"?tt[0]=="stop"?ci(g,7):bf(g):tt[0]!="noop"&&g.l&&g.l.qa(tt),g.A=0)}}We(4)}catch{}}var HA=class{constructor(c,p){this.g=c,this.map=p}};function U_(c){this.l=c||10,o.PerformanceNavigationTiming?(c=o.performance.getEntriesByType("navigation"),c=c.length>0&&(c[0].nextHopProtocol=="hq"||c[0].nextHopProtocol=="h2")):c=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=c?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function $_(c){return c.h?!0:c.g?c.g.size>=c.j:!1}function B_(c){return c.h?1:c.g?c.g.size:0}function Ef(c,p){return c.h?c.h==p:c.g?c.g.has(p):!1}function If(c,p){c.g?c.g.add(p):c.h=p}function z_(c,p){c.h&&c.h==p?c.h=null:c.g&&c.g.has(p)&&c.g.delete(p)}U_.prototype.cancel=function(){if(this.i=q_(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const c of this.g.values())c.cancel();this.g.clear()}};function q_(c){if(c.h!=null)return c.i.concat(c.h.G);if(c.g!=null&&c.g.size!==0){let p=c.i;for(const g of c.g.values())p=p.concat(g.G);return p}return w(c.i)}var H_=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function WA(c,p){if(c){c=c.split("&");for(let g=0;g<c.length;g++){const x=c[g].indexOf("=");let L,$=null;x>=0?(L=c[g].substring(0,x),$=c[g].substring(x+1)):L=c[g],p(L,$?decodeURIComponent($.replace(/\+/g," ")):"")}}}function as(c){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let p;c instanceof as?(this.l=c.l,Ma(this,c.j),this.o=c.o,this.g=c.g,Fa(this,c.u),this.h=c.h,Tf(this,X_(c.i)),this.m=c.m):c&&(p=String(c).match(H_))?(this.l=!1,Ma(this,p[1]||"",!0),this.o=Ua(p[2]||""),this.g=Ua(p[3]||"",!0),Fa(this,p[4]),this.h=Ua(p[5]||"",!0),Tf(this,p[6]||"",!0),this.m=Ua(p[7]||"")):(this.l=!1,this.i=new Ba(null,this.l))}as.prototype.toString=function(){const c=[];var p=this.j;p&&c.push($a(p,W_,!0),":");var g=this.g;return(g||p=="file")&&(c.push("//"),(p=this.o)&&c.push($a(p,W_,!0),"@"),c.push(Va(g).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),g=this.u,g!=null&&c.push(":",String(g))),(g=this.h)&&(this.g&&g.charAt(0)!="/"&&c.push("/"),c.push($a(g,g.charAt(0)=="/"?QA:GA,!0))),(g=this.i.toString())&&c.push("?",g),(g=this.m)&&c.push("#",$a(g,XA)),c.join("")},as.prototype.resolve=function(c){const p=yr(this);let g=!!c.j;g?Ma(p,c.j):g=!!c.o,g?p.o=c.o:g=!!c.g,g?p.g=c.g:g=c.u!=null;var x=c.h;if(g)Fa(p,c.u);else if(g=!!c.h){if(x.charAt(0)!="/")if(this.g&&!this.h)x="/"+x;else{var L=p.h.lastIndexOf("/");L!=-1&&(x=p.h.slice(0,L+1)+x)}if(L=x,L==".."||L==".")x="";else if(L.indexOf("./")!=-1||L.indexOf("/.")!=-1){x=L.lastIndexOf("/",0)==0,L=L.split("/");const $=[];for(let Q=0;Q<L.length;){const be=L[Q++];be=="."?x&&Q==L.length&&$.push(""):be==".."?(($.length>1||$.length==1&&$[0]!="")&&$.pop(),x&&Q==L.length&&$.push("")):($.push(be),x=!0)}x=$.join("/")}else x=L}return g?p.h=x:g=c.i.toString()!=="",g?Tf(p,X_(c.i)):g=!!c.m,g&&(p.m=c.m),p};function yr(c){return new as(c)}function Ma(c,p,g){c.j=g?Ua(p,!0):p,c.j&&(c.j=c.j.replace(/:$/,""))}function Fa(c,p){if(p){if(p=Number(p),isNaN(p)||p<0)throw Error("Bad port number "+p);c.u=p}else c.u=null}function Tf(c,p,g){p instanceof Ba?(c.i=p,JA(c.i,c.l)):(g||(p=$a(p,YA)),c.i=new Ba(p,c.l))}function it(c,p,g){c.i.set(p,g)}function Hc(c){return it(c,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),c}function Ua(c,p){return c?p?decodeURI(c.replace(/%25/g,"%2525")):decodeURIComponent(c):""}function $a(c,p,g){return typeof c=="string"?(c=encodeURI(c).replace(p,KA),g&&(c=c.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),c):null}function KA(c){return c=c.charCodeAt(0),"%"+(c>>4&15).toString(16)+(c&15).toString(16)}var W_=/[#\/\?@]/g,GA=/[#\?:]/g,QA=/[#\?]/g,YA=/[#\?@]/g,XA=/#/g;function Ba(c,p){this.h=this.g=null,this.i=c||null,this.j=!!p}function li(c){c.g||(c.g=new Map,c.h=0,c.i&&WA(c.i,function(p,g){c.add(decodeURIComponent(p.replace(/\+/g," ")),g)}))}t=Ba.prototype,t.add=function(c,p){li(this),this.i=null,c=co(this,c);let g=this.g.get(c);return g||this.g.set(c,g=[]),g.push(p),this.h+=1,this};function K_(c,p){li(c),p=co(c,p),c.g.has(p)&&(c.i=null,c.h-=c.g.get(p).length,c.g.delete(p))}function G_(c,p){return li(c),p=co(c,p),c.g.has(p)}t.forEach=function(c,p){li(this),this.g.forEach(function(g,x){g.forEach(function(L){c.call(p,L,x,this)},this)},this)};function Q_(c,p){li(c);let g=[];if(typeof p=="string")G_(c,p)&&(g=g.concat(c.g.get(co(c,p))));else for(c=Array.from(c.g.values()),p=0;p<c.length;p++)g=g.concat(c[p]);return g}t.set=function(c,p){return li(this),this.i=null,c=co(this,c),G_(this,c)&&(this.h-=this.g.get(c).length),this.g.set(c,[p]),this.h+=1,this},t.get=function(c,p){return c?(c=Q_(this,c),c.length>0?String(c[0]):p):p};function Y_(c,p,g){K_(c,p),g.length>0&&(c.i=null,c.g.set(co(c,p),w(g)),c.h+=g.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const c=[],p=Array.from(this.g.keys());for(let x=0;x<p.length;x++){var g=p[x];const L=Va(g);g=Q_(this,g);for(let $=0;$<g.length;$++){let Q=L;g[$]!==""&&(Q+="="+Va(g[$])),c.push(Q)}}return this.i=c.join("&")};function X_(c){const p=new Ba;return p.i=c.i,c.g&&(p.g=new Map(c.g),p.h=c.h),p}function co(c,p){return p=String(p),c.j&&(p=p.toLowerCase()),p}function JA(c,p){p&&!c.j&&(li(c),c.i=null,c.g.forEach(function(g,x){const L=x.toLowerCase();x!=L&&(K_(this,x),Y_(this,L,g))},c)),c.j=p}function ZA(c,p){const g=new Cn;if(o.Image){const x=new Image;x.onload=h(ls,g,"TestLoadImage: loaded",!0,p,x),x.onerror=h(ls,g,"TestLoadImage: error",!1,p,x),x.onabort=h(ls,g,"TestLoadImage: abort",!1,p,x),x.ontimeout=h(ls,g,"TestLoadImage: timeout",!1,p,x),o.setTimeout(function(){x.ontimeout&&x.ontimeout()},1e4),x.src=c}else p(!1)}function eR(c,p){const g=new Cn,x=new AbortController,L=setTimeout(()=>{x.abort(),ls(g,"TestPingServer: timeout",!1,p)},1e4);fetch(c,{signal:x.signal}).then($=>{clearTimeout(L),$.ok?ls(g,"TestPingServer: ok",!0,p):ls(g,"TestPingServer: server error",!1,p)}).catch(()=>{clearTimeout(L),ls(g,"TestPingServer: error",!1,p)})}function ls(c,p,g,x,L){try{L&&(L.onload=null,L.onerror=null,L.onabort=null,L.ontimeout=null),x(g)}catch{}}function tR(){this.g=new J}function xf(c){this.i=c.Sb||null,this.h=c.ab||!1}f(xf,v),xf.prototype.g=function(){return new Wc(this.i,this.h)};function Wc(c,p){G.call(this),this.H=c,this.o=p,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}f(Wc,G),t=Wc.prototype,t.open=function(c,p){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=c,this.D=p,this.readyState=1,qa(this)},t.send=function(c){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const p={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};c&&(p.body=c),(this.H||o).fetch(new Request(this.D,p)).then(this.Pa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,za(this)),this.readyState=0},t.Pa=function(c){if(this.g&&(this.l=c,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=c.headers,this.readyState=2,qa(this)),this.g&&(this.readyState=3,qa(this),this.g)))if(this.responseType==="arraybuffer")c.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in c){if(this.j=c.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;J_(this)}else c.text().then(this.Oa.bind(this),this.ga.bind(this))};function J_(c){c.j.read().then(c.Ma.bind(c)).catch(c.ga.bind(c))}t.Ma=function(c){if(this.g){if(this.o&&c.value)this.response.push(c.value);else if(!this.o){var p=c.value?c.value:new Uint8Array(0);(p=this.B.decode(p,{stream:!c.done}))&&(this.response=this.responseText+=p)}c.done?za(this):qa(this),this.readyState==3&&J_(this)}},t.Oa=function(c){this.g&&(this.response=this.responseText=c,za(this))},t.Na=function(c){this.g&&(this.response=c,za(this))},t.ga=function(){this.g&&za(this)};function za(c){c.readyState=4,c.l=null,c.j=null,c.B=null,qa(c)}t.setRequestHeader=function(c,p){this.A.append(c,p)},t.getResponseHeader=function(c){return this.h&&this.h.get(c.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const c=[],p=this.h.entries();for(var g=p.next();!g.done;)g=g.value,c.push(g[0]+": "+g[1]),g=p.next();return c.join(`\r
`)};function qa(c){c.onreadystatechange&&c.onreadystatechange.call(c)}Object.defineProperty(Wc.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(c){this.m=c?"include":"same-origin"}});function Z_(c){let p="";return ce(c,function(g,x){p+=x,p+=":",p+=g,p+=`\r
`}),p}function Sf(c,p,g){e:{for(x in g){var x=!1;break e}x=!0}x||(g=Z_(g),typeof c=="string"?g!=null&&Va(g):it(c,p,g))}function _t(c){G.call(this),this.headers=new Map,this.L=c||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}f(_t,G);var nR=/^https?$/i,rR=["POST","PUT"];t=_t.prototype,t.Fa=function(c){this.H=c},t.ea=function(c,p,g,x){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+c);p=p?p.toUpperCase():"GET",this.D=c,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():j_.g(),this.g.onreadystatechange=m(d(this.Ca,this));try{this.B=!0,this.g.open(p,String(c),!0),this.B=!1}catch($){ev(this,$);return}if(c=g||"",g=new Map(this.headers),x)if(Object.getPrototypeOf(x)===Object.prototype)for(var L in x)g.set(L,x[L]);else if(typeof x.keys=="function"&&typeof x.get=="function")for(const $ of x.keys())g.set($,x.get($));else throw Error("Unknown input type for opt_headers: "+String(x));x=Array.from(g.keys()).find($=>$.toLowerCase()=="content-type"),L=o.FormData&&c instanceof o.FormData,!(Array.prototype.indexOf.call(rR,p,void 0)>=0)||x||L||g.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[$,Q]of g)this.g.setRequestHeader($,Q);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(c),this.v=!1}catch($){ev(this,$)}};function ev(c,p){c.h=!1,c.g&&(c.j=!0,c.g.abort(),c.j=!1),c.l=p,c.o=5,tv(c),Kc(c)}function tv(c){c.A||(c.A=!0,ee(c,"complete"),ee(c,"error"))}t.abort=function(c){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=c||7,ee(this,"complete"),ee(this,"abort"),Kc(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Kc(this,!0)),_t.Z.N.call(this)},t.Ca=function(){this.u||(this.B||this.v||this.j?nv(this):this.Xa())},t.Xa=function(){nv(this)};function nv(c){if(c.h&&typeof i<"u"){if(c.v&&cs(c)==4)setTimeout(c.Ca.bind(c),0);else if(ee(c,"readystatechange"),cs(c)==4){c.h=!1;try{const $=c.ca();e:switch($){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var p=!0;break e;default:p=!1}var g;if(!(g=p)){var x;if(x=$===0){let Q=String(c.D).match(H_)[1]||null;!Q&&o.self&&o.self.location&&(Q=o.self.location.protocol.slice(0,-1)),x=!nR.test(Q?Q.toLowerCase():"")}g=x}if(g)ee(c,"complete"),ee(c,"success");else{c.o=6;try{var L=cs(c)>2?c.g.statusText:""}catch{L=""}c.l=L+" ["+c.ca()+"]",tv(c)}}finally{Kc(c)}}}}function Kc(c,p){if(c.g){c.m&&(clearTimeout(c.m),c.m=null);const g=c.g;c.g=null,p||ee(c,"ready");try{g.onreadystatechange=null}catch{}}}t.isActive=function(){return!!this.g};function cs(c){return c.g?c.g.readyState:0}t.ca=function(){try{return cs(this)>2?this.g.status:-1}catch{return-1}},t.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.La=function(c){if(this.g){var p=this.g.responseText;return c&&p.indexOf(c)==0&&(p=p.substring(c.length)),F(p)}};function rv(c){try{if(!c.g)return null;if("response"in c.g)return c.g.response;switch(c.F){case"":case"text":return c.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in c.g)return c.g.mozResponseArrayBuffer}return null}catch{return null}}function sR(c){const p={};c=(c.g&&cs(c)>=2&&c.g.getAllResponseHeaders()||"").split(`\r
`);for(let x=0;x<c.length;x++){if(R(c[x]))continue;var g=BA(c[x]);const L=g[0];if(g=g[1],typeof g!="string")continue;g=g.trim();const $=p[L]||[];p[L]=$,$.push(g)}me(p,function(x){return x.join(", ")})}t.ya=function(){return this.o},t.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function Ha(c,p,g){return g&&g.internalChannelParams&&g.internalChannelParams[c]||p}function sv(c){this.za=0,this.i=[],this.j=new Cn,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Ha("failFast",!1,c),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Ha("baseRetryDelayMs",5e3,c),this.Za=Ha("retryDelaySeedMs",1e4,c),this.Ta=Ha("forwardChannelMaxRetries",2,c),this.va=Ha("forwardChannelRequestTimeoutMs",2e4,c),this.ma=c&&c.xmlHttpFactory||void 0,this.Ua=c&&c.Rb||void 0,this.Aa=c&&c.useFetchStreams||!1,this.O=void 0,this.L=c&&c.supportsCrossDomainXhr||!1,this.M="",this.h=new U_(c&&c.concurrentRequestLimit),this.Ba=new tR,this.S=c&&c.fastHandshake||!1,this.R=c&&c.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=c&&c.Pb||!1,c&&c.ua&&this.j.ua(),c&&c.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&c&&c.detectBufferingProxy||!1,this.ia=void 0,c&&c.longPollingTimeout&&c.longPollingTimeout>0&&(this.ia=c.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}t=sv.prototype,t.ka=8,t.I=1,t.connect=function(c,p,g,x){Ne(0),this.W=c,this.H=p||{},g&&x!==void 0&&(this.H.OSID=g,this.H.OAID=x),this.F=this.X,this.J=fv(this,null,this.W),Qc(this)};function bf(c){if(iv(c),c.I==3){var p=c.V++,g=yr(c.J);if(it(g,"SID",c.M),it(g,"RID",p),it(g,"TYPE","terminate"),Wa(c,g),p=new os(c,c.j,p),p.M=2,p.A=Hc(yr(g)),g=!1,o.navigator&&o.navigator.sendBeacon)try{g=o.navigator.sendBeacon(p.A.toString(),"")}catch{}!g&&o.Image&&(new Image().src=p.A,g=!0),g||(p.g=pv(p.j,null),p.g.ea(p.A)),p.F=Date.now(),qc(p)}hv(c)}function Gc(c){c.g&&(Af(c),c.g.cancel(),c.g=null)}function iv(c){Gc(c),c.v&&(o.clearTimeout(c.v),c.v=null),Yc(c),c.h.cancel(),c.m&&(typeof c.m=="number"&&o.clearTimeout(c.m),c.m=null)}function Qc(c){if(!$_(c.h)&&!c.m){c.m=!0;var p=c.Ea;V||_(),M||(V(),M=!0),T.add(p,c),c.D=0}}function iR(c,p){return B_(c.h)>=c.h.j-(c.m?1:0)?!1:c.m?(c.i=p.G.concat(c.i),!0):c.I==1||c.I==2||c.D>=(c.Sa?0:c.Ta)?!1:(c.m=mr(d(c.Ea,c,p),dv(c,c.D)),c.D++,!0)}t.Ea=function(c){if(this.m)if(this.m=null,this.I==1){if(!c){this.V=Math.floor(Math.random()*1e5),c=this.V++;const L=new os(this,this.j,c);let $=this.o;if(this.U&&($?($=Oe($),z($,this.U)):$=this.U),this.u!==null||this.R||(L.J=$,$=null),this.S)e:{for(var p=0,g=0;g<this.i.length;g++){t:{var x=this.i[g];if("__data__"in x.map&&(x=x.map.__data__,typeof x=="string")){x=x.length;break t}x=void 0}if(x===void 0)break;if(p+=x,p>4096){p=g;break e}if(p===4096||g===this.i.length-1){p=g+1;break e}}p=1e3}else p=1e3;p=av(this,L,p),g=yr(this.J),it(g,"RID",c),it(g,"CVER",22),this.G&&it(g,"X-HTTP-Session-Id",this.G),Wa(this,g),$&&(this.R?p="headers="+Va(Z_($))+"&"+p:this.u&&Sf(g,this.u,$)),If(this.h,L),this.Ra&&it(g,"TYPE","init"),this.S?(it(g,"$req",p),it(g,"SID","null"),L.U=!0,_f(L,g,null)):_f(L,g,p),this.I=2}}else this.I==3&&(c?ov(this,c):this.i.length==0||$_(this.h)||ov(this))};function ov(c,p){var g;p?g=p.l:g=c.V++;const x=yr(c.J);it(x,"SID",c.M),it(x,"RID",g),it(x,"AID",c.K),Wa(c,x),c.u&&c.o&&Sf(x,c.u,c.o),g=new os(c,c.j,g,c.D+1),c.u===null&&(g.J=c.o),p&&(c.i=p.G.concat(c.i)),p=av(c,g,1e3),g.H=Math.round(c.va*.5)+Math.round(c.va*.5*Math.random()),If(c.h,g),_f(g,x,p)}function Wa(c,p){c.H&&ce(c.H,function(g,x){it(p,x,g)}),c.l&&ce({},function(g,x){it(p,x,g)})}function av(c,p,g){g=Math.min(c.i.length,g);const x=c.l?d(c.l.Ka,c.l,c):null;e:{var L=c.i;let be=-1;for(;;){const Dt=["count="+g];be==-1?g>0?(be=L[0].g,Dt.push("ofs="+be)):be=0:Dt.push("ofs="+be);let tt=!0;for(let Ft=0;Ft<g;Ft++){var $=L[Ft].g;const _r=L[Ft].map;if($-=be,$<0)be=Math.max(0,L[Ft].g-100),tt=!1;else try{$="req"+$+"_"||"";try{var Q=_r instanceof Map?_r:Object.entries(_r);for(const[ui,us]of Q){let ds=us;a(us)&&(ds=Ge(us)),Dt.push($+ui+"="+encodeURIComponent(ds))}}catch(ui){throw Dt.push($+"type="+encodeURIComponent("_badmap")),ui}}catch{x&&x(_r)}}if(tt){Q=Dt.join("&");break e}}Q=void 0}return c=c.i.splice(0,g),p.G=c,Q}function lv(c){if(!c.g&&!c.v){c.Y=1;var p=c.Da;V||_(),M||(V(),M=!0),T.add(p,c),c.A=0}}function Cf(c){return c.g||c.v||c.A>=3?!1:(c.Y++,c.v=mr(d(c.Da,c),dv(c,c.A)),c.A++,!0)}t.Da=function(){if(this.v=null,cv(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var c=4*this.T;this.j.info("BP detection timer enabled: "+c),this.B=mr(d(this.Wa,this),c)}},t.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,Ne(10),Gc(this),cv(this))};function Af(c){c.B!=null&&(o.clearTimeout(c.B),c.B=null)}function cv(c){c.g=new os(c,c.j,"rpc",c.Y),c.u===null&&(c.g.J=c.o),c.g.P=0;var p=yr(c.na);it(p,"RID","rpc"),it(p,"SID",c.M),it(p,"AID",c.K),it(p,"CI",c.F?"0":"1"),!c.F&&c.ia&&it(p,"TO",c.ia),it(p,"TYPE","xmlhttp"),Wa(c,p),c.u&&c.o&&Sf(p,c.u,c.o),c.O&&(c.g.H=c.O);var g=c.g;c=c.ba,g.M=1,g.A=Hc(yr(p)),g.u=null,g.R=!0,L_(g,c)}t.Va=function(){this.C!=null&&(this.C=null,Gc(this),Cf(this),Ne(19))};function Yc(c){c.C!=null&&(o.clearTimeout(c.C),c.C=null)}function uv(c,p){var g=null;if(c.g==p){Yc(c),Af(c),c.g=null;var x=2}else if(Ef(c.h,p))g=p.G,z_(c.h,p),x=1;else return;if(c.I!=0){if(p.o)if(x==1){g=p.u?p.u.length:0,p=Date.now()-p.F;var L=c.D;x=kt(),ee(x,new is(x,g)),Qc(c)}else lv(c);else if(L=p.m,L==3||L==0&&p.X>0||!(x==1&&iR(c,p)||x==2&&Cf(c)))switch(g&&g.length>0&&(p=c.h,p.i=p.i.concat(g)),L){case 1:ci(c,5);break;case 4:ci(c,10);break;case 3:ci(c,6);break;default:ci(c,2)}}}function dv(c,p){let g=c.Qa+Math.floor(Math.random()*c.Za);return c.isActive()||(g*=2),g*p}function ci(c,p){if(c.j.info("Error code "+p),p==2){var g=d(c.bb,c),x=c.Ua;const L=!x;x=new as(x||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||Ma(x,"https"),Hc(x),L?ZA(x.toString(),g):eR(x.toString(),g)}else Ne(2);c.I=0,c.l&&c.l.pa(p),hv(c),iv(c)}t.bb=function(c){c?(this.j.info("Successfully pinged google.com"),Ne(2)):(this.j.info("Failed to ping google.com"),Ne(1))};function hv(c){if(c.I=0,c.ja=[],c.l){const p=q_(c.h);(p.length!=0||c.i.length!=0)&&(A(c.ja,p),A(c.ja,c.i),c.h.i.length=0,w(c.i),c.i.length=0),c.l.oa()}}function fv(c,p,g){var x=g instanceof as?yr(g):new as(g);if(x.g!="")p&&(x.g=p+"."+x.g),Fa(x,x.u);else{var L=o.location;x=L.protocol,p=p?p+"."+L.hostname:L.hostname,L=+L.port;const $=new as(null);x&&Ma($,x),p&&($.g=p),L&&Fa($,L),g&&($.h=g),x=$}return g=c.G,p=c.wa,g&&p&&it(x,g,p),it(x,"VER",c.ka),Wa(c,x),x}function pv(c,p,g){if(p&&!c.L)throw Error("Can't create secondary domain capable XhrIo object.");return p=c.Aa&&!c.ma?new _t(new xf({ab:g})):new _t(c.ma),p.Fa(c.L),p}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function mv(){}t=mv.prototype,t.ra=function(){},t.qa=function(){},t.pa=function(){},t.oa=function(){},t.isActive=function(){return!0},t.Ka=function(){};function Xc(){}Xc.prototype.g=function(c,p){return new An(c,p)};function An(c,p){G.call(this),this.g=new sv(p),this.l=c,this.h=p&&p.messageUrlParams||null,c=p&&p.messageHeaders||null,p&&p.clientProtocolHeaderRequired&&(c?c["X-Client-Protocol"]="webchannel":c={"X-Client-Protocol":"webchannel"}),this.g.o=c,c=p&&p.initMessageHeaders||null,p&&p.messageContentType&&(c?c["X-WebChannel-Content-Type"]=p.messageContentType:c={"X-WebChannel-Content-Type":p.messageContentType}),p&&p.sa&&(c?c["X-WebChannel-Client-Profile"]=p.sa:c={"X-WebChannel-Client-Profile":p.sa}),this.g.U=c,(c=p&&p.Qb)&&!R(c)&&(this.g.u=c),this.A=p&&p.supportsCrossDomainXhr||!1,this.v=p&&p.sendRawJson||!1,(p=p&&p.httpSessionIdParam)&&!R(p)&&(this.g.G=p,c=this.h,c!==null&&p in c&&(c=this.h,p in c&&delete c[p])),this.j=new uo(this)}f(An,G),An.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},An.prototype.close=function(){bf(this.g)},An.prototype.o=function(c){var p=this.g;if(typeof c=="string"){var g={};g.__data__=c,c=g}else this.v&&(g={},g.__data__=Ge(c),c=g);p.i.push(new HA(p.Ya++,c)),p.I==3&&Qc(p)},An.prototype.N=function(){this.g.l=null,delete this.j,bf(this.g),delete this.g,An.Z.N.call(this)};function gv(c){ye.call(this),c.__headers__&&(this.headers=c.__headers__,this.statusCode=c.__status__,delete c.__headers__,delete c.__status__);var p=c.__sm__;if(p){e:{for(const g in p){c=g;break e}c=void 0}(this.i=c)&&(c=this.i,p=p!==null&&c in p?p[c]:void 0),this.data=p}else this.data=c}f(gv,ye);function yv(){Pe.call(this),this.status=1}f(yv,Pe);function uo(c){this.g=c}f(uo,mv),uo.prototype.ra=function(){ee(this.g,"a")},uo.prototype.qa=function(c){ee(this.g,new gv(c))},uo.prototype.pa=function(c){ee(this.g,new yv)},uo.prototype.oa=function(){ee(this.g,"b")},Xc.prototype.createWebChannel=Xc.prototype.g,An.prototype.send=An.prototype.o,An.prototype.open=An.prototype.m,An.prototype.close=An.prototype.close,HS=function(){return new Xc},qS=function(){return kt()},zS=Le,Dm={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},zc.NO_ERROR=0,zc.TIMEOUT=8,zc.HTTP_ERROR=6,Gu=zc,D_.COMPLETE="complete",BS=D_,U.EventType=te,te.OPEN="a",te.CLOSE="b",te.ERROR="c",te.MESSAGE="d",G.prototype.listen=G.prototype.J,ml=U,_t.prototype.listenOnce=_t.prototype.K,_t.prototype.getLastError=_t.prototype.Ha,_t.prototype.getLastErrorCode=_t.prototype.ya,_t.prototype.getStatus=_t.prototype.ca,_t.prototype.getResponseJson=_t.prototype.La,_t.prototype.getResponseText=_t.prototype.la,_t.prototype.send=_t.prototype.ea,_t.prototype.setWithCredentials=_t.prototype.Fa,$S=_t}).apply(typeof _u<"u"?_u:typeof self<"u"?self:typeof window<"u"?window:{});const hE="@firebase/firestore",fE="4.9.2";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ht{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Ht.UNAUTHENTICATED=new Ht(null),Ht.GOOGLE_CREDENTIALS=new Ht("google-credentials-uid"),Ht.FIRST_PARTY=new Ht("first-party-uid"),Ht.MOCK_USER=new Ht("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Na="12.3.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bi=new Rh("@firebase/firestore");function So(){return Bi.logLevel}function q(t,...e){if(Bi.logLevel<=De.DEBUG){const n=e.map(Iy);Bi.debug(`Firestore (${Na}): ${t}`,...n)}}function hn(t,...e){if(Bi.logLevel<=De.ERROR){const n=e.map(Iy);Bi.error(`Firestore (${Na}): ${t}`,...n)}}function zi(t,...e){if(Bi.logLevel<=De.WARN){const n=e.map(Iy);Bi.warn(`Firestore (${Na}): ${t}`,...n)}}function Iy(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oe(t,e,n){let r="Unexpected state";typeof e=="string"?r=e:n=e,WS(t,r,n)}function WS(t,e,n){let r=`FIRESTORE (${Na}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(n!==void 0)try{r+=" CONTEXT: "+JSON.stringify(n)}catch{r+=" CONTEXT: "+n}throw hn(r),new Error(r)}function le(t,e,n,r){let s="Unexpected state";typeof n=="string"?s=n:r=n,t||WS(e,s,r)}function Ee(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const B={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class W extends Jn{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lr{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KS{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class Q2{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(Ht.UNAUTHENTICATED))}shutdown(){}}class Y2{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class X2{constructor(e){this.t=e,this.currentUser=Ht.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){le(this.o===void 0,42304);let r=this.i;const s=l=>this.i!==r?(r=this.i,n(l)):Promise.resolve();let i=new lr;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new lr,e.enqueueRetryable(()=>s(this.currentUser))};const o=()=>{const l=i;e.enqueueRetryable(async()=>{await l.promise,await s(this.currentUser)})},a=l=>{q("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(l=>a(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?a(l):(q("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new lr)}},0),o()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(q("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(le(typeof r.accessToken=="string",31837,{l:r}),new KS(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return le(e===null||typeof e=="string",2055,{h:e}),new Ht(e)}}class J2{constructor(e,n,r){this.P=e,this.T=n,this.I=r,this.type="FirstParty",this.user=Ht.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class Z2{constructor(e,n,r){this.P=e,this.T=n,this.I=r}getToken(){return Promise.resolve(new J2(this.P,this.T,this.I))}start(e,n){e.enqueueRetryable(()=>n(Ht.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class pE{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class eO{constructor(e,n){this.V=n,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Bn(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,n){le(this.o===void 0,3512);const r=i=>{i.error!=null&&q("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.m;return this.m=i.token,q("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>r(i))};const s=i=>{q("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(i=>s(i)),setTimeout(()=>{if(!this.appCheck){const i=this.V.getImmediate({optional:!0});i?s(i):q("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new pE(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(le(typeof n.token=="string",44558,{tokenResult:n}),this.m=n.token,new pE(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tO(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ty{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const s=tO(40);for(let i=0;i<s.length;++i)r.length<20&&s[i]<n&&(r+=e.charAt(s[i]%62))}return r}}function xe(t,e){return t<e?-1:t>e?1:0}function jm(t,e){const n=Math.min(t.length,e.length);for(let r=0;r<n;r++){const s=t.charAt(r),i=e.charAt(r);if(s!==i)return dp(s)===dp(i)?xe(s,i):dp(s)?1:-1}return xe(t.length,e.length)}const nO=55296,rO=57343;function dp(t){const e=t.charCodeAt(0);return e>=nO&&e<=rO}function ua(t,e,n){return t.length===e.length&&t.every((r,s)=>n(r,e[s]))}function GS(t){return t+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mE="__name__";class Tr{constructor(e,n,r){n===void 0?n=0:n>e.length&&oe(637,{offset:n,range:e.length}),r===void 0?r=e.length-n:r>e.length-n&&oe(1746,{length:r,range:e.length-n}),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return Tr.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof Tr?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let s=0;s<r;s++){const i=Tr.compareSegments(e.get(s),n.get(s));if(i!==0)return i}return xe(e.length,n.length)}static compareSegments(e,n){const r=Tr.isNumericId(e),s=Tr.isNumericId(n);return r&&!s?-1:!r&&s?1:r&&s?Tr.extractNumericId(e).compare(Tr.extractNumericId(n)):jm(e,n)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Bs.fromString(e.substring(4,e.length-2))}}class ze extends Tr{construct(e,n,r){return new ze(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new W(B.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(s=>s.length>0))}return new ze(n)}static emptyPath(){return new ze([])}}const sO=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class mt extends Tr{construct(e,n,r){return new mt(e,n,r)}static isValidIdentifier(e){return sO.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),mt.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===mE}static keyField(){return new mt([mE])}static fromServerFormat(e){const n=[];let r="",s=0;const i=()=>{if(r.length===0)throw new W(B.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let o=!1;for(;s<e.length;){const a=e[s];if(a==="\\"){if(s+1===e.length)throw new W(B.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[s+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new W(B.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=l,s+=2}else a==="`"?(o=!o,s++):a!=="."||o?(r+=a,s++):(i(),s++)}if(i(),o)throw new W(B.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new mt(n)}static emptyPath(){return new mt([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X{constructor(e){this.path=e}static fromPath(e){return new X(ze.fromString(e))}static fromName(e){return new X(ze.fromString(e).popFirst(5))}static empty(){return new X(ze.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&ze.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return ze.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new X(new ze(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function QS(t,e,n){if(!n)throw new W(B.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function iO(t,e,n,r){if(e===!0&&r===!0)throw new W(B.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function gE(t){if(!X.isDocumentKey(t))throw new W(B.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function yE(t){if(X.isDocumentKey(t))throw new W(B.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function YS(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function Oh(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":oe(12329,{type:typeof t})}function an(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new W(B.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Oh(t);throw new W(B.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}function oO(t,e){if(e<=0)throw new W(B.INVALID_ARGUMENT,`Function ${t}() requires a positive number, but it was: ${e}.`)}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rt(t,e){const n={typeString:t};return e&&(n.value=e),n}function Pc(t,e){if(!YS(t))throw new W(B.INVALID_ARGUMENT,"JSON must be an object");let n;for(const r in e)if(e[r]){const s=e[r].typeString,i="value"in e[r]?{value:e[r].value}:void 0;if(!(r in t)){n=`JSON missing required field: '${r}'`;break}const o=t[r];if(s&&typeof o!==s){n=`JSON field '${r}' must be a ${s}.`;break}if(i!==void 0&&o!==i.value){n=`Expected '${r}' field to equal '${i.value}'`;break}}if(n)throw new W(B.INVALID_ARGUMENT,n);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _E=-62135596800,vE=1e6;class $e{static now(){return $e.fromMillis(Date.now())}static fromDate(e){return $e.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor((e-1e3*n)*vE);return new $e(n,r)}constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new W(B.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new W(B.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<_E)throw new W(B.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new W(B.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/vE}_compareTo(e){return this.seconds===e.seconds?xe(this.nanoseconds,e.nanoseconds):xe(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:$e._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Pc(e,$e._jsonSchema))return new $e(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-_E;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}$e._jsonSchemaVersion="firestore/timestamp/1.0",$e._jsonSchema={type:Rt("string",$e._jsonSchemaVersion),seconds:Rt("number"),nanoseconds:Rt("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pe{static fromTimestamp(e){return new pe(e)}static min(){return new pe(new $e(0,0))}static max(){return new pe(new $e(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lc=-1;class Ud{constructor(e,n,r,s){this.indexId=e,this.collectionGroup=n,this.fields=r,this.indexState=s}}function Om(t){return t.fields.find(e=>e.kind===2)}function gi(t){return t.fields.filter(e=>e.kind!==2)}Ud.UNKNOWN_ID=-1;class Qu{constructor(e,n){this.fieldPath=e,this.kind=n}}class cc{constructor(e,n){this.sequenceNumber=e,this.offset=n}static empty(){return new cc(0,Vn.min())}}function aO(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,s=pe.fromTimestamp(r===1e9?new $e(n+1,0):new $e(n,r));return new Vn(s,X.empty(),e)}function XS(t){return new Vn(t.readTime,t.key,lc)}class Vn{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new Vn(pe.min(),X.empty(),lc)}static max(){return new Vn(pe.max(),X.empty(),lc)}}function xy(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=X.comparator(t.documentKey,e.documentKey),n!==0?n:xe(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JS="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class ZS{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function oo(t){if(t.code!==B.FAILED_PRECONDITION||t.message!==JS)throw t;q("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&oe(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new O((r,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(r,s)},this.catchCallback=i=>{this.wrapFailure(n,i).next(r,s)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof O?n:O.resolve(n)}catch(n){return O.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):O.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):O.reject(n)}static resolve(e){return new O((n,r)=>{n(e)})}static reject(e){return new O((n,r)=>{r(e)})}static waitFor(e){return new O((n,r)=>{let s=0,i=0,o=!1;e.forEach(a=>{++s,a.next(()=>{++i,o&&i===s&&n()},l=>r(l))}),o=!0,i===s&&n()})}static or(e){let n=O.resolve(!1);for(const r of e)n=n.next(s=>s?O.resolve(s):r());return n}static forEach(e,n){const r=[];return e.forEach((s,i)=>{r.push(n.call(this,s,i))}),this.waitFor(r)}static mapArray(e,n){return new O((r,s)=>{const i=e.length,o=new Array(i);let a=0;for(let l=0;l<i;l++){const d=l;n(e[d]).next(h=>{o[d]=h,++a,a===i&&r(o)},h=>s(h))}})}static doWhile(e,n){return new O((r,s)=>{const i=()=>{e()===!0?n().next(()=>{i()},s):r()};i()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pn="SimpleDb";class Vh{static open(e,n,r,s){try{return new Vh(n,e.transaction(s,r))}catch(i){throw new Dl(n,i)}}constructor(e,n){this.action=e,this.transaction=n,this.aborted=!1,this.S=new lr,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{n.error?this.S.reject(new Dl(e,n.error)):this.S.resolve()},this.transaction.onerror=r=>{const s=Sy(r.target.error);this.S.reject(new Dl(e,s))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(q(Pn,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}C(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const n=this.transaction.objectStore(e);return new cO(n)}}class zs{static delete(e){return q(Pn,"Removing database:",e),_i(zx().indexedDB.deleteDatabase(e)).toPromise()}static v(){if(!uy())return!1;if(zs.F())return!0;const e=Vt(),n=zs.M(e),r=0<n&&n<10,s=eb(e),i=0<s&&s<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||i)}static F(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)==null?void 0:e.__PRIVATE_USE_MOCK_PERSISTENCE)==="YES"}static O(e,n){return e.store(n)}static M(e){const n=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=n?n[1].split("_").slice(0,2).join("."):"-1";return Number(r)}constructor(e,n,r){this.name=e,this.version=n,this.N=r,this.B=null,zs.M(Vt())===12.2&&hn("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async L(e){return this.db||(q(Pn,"Opening database:",this.name),this.db=await new Promise((n,r)=>{const s=indexedDB.open(this.name,this.version);s.onsuccess=i=>{const o=i.target.result;n(o)},s.onblocked=()=>{r(new Dl(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},s.onerror=i=>{const o=i.target.error;o.name==="VersionError"?r(new W(B.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?r(new W(B.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):r(new Dl(e,o))},s.onupgradeneeded=i=>{q(Pn,'Database "'+this.name+'" requires upgrade from version:',i.oldVersion);const o=i.target.result;this.N.k(o,s.transaction,i.oldVersion,this.version).next(()=>{q(Pn,"Database upgrade to version "+this.version+" complete")})}})),this.q&&(this.db.onversionchange=n=>this.q(n)),this.db}$(e){this.q=e,this.db&&(this.db.onversionchange=n=>e(n))}async runTransaction(e,n,r,s){const i=n==="readonly";let o=0;for(;;){++o;try{this.db=await this.L(e);const a=Vh.open(this.db,e,i?"readonly":"readwrite",r),l=s(a).next(d=>(a.C(),d)).catch(d=>(a.abort(d),O.reject(d))).toPromise();return l.catch(()=>{}),await a.D,l}catch(a){const l=a,d=l.name!=="FirebaseError"&&o<3;if(q(Pn,"Transaction failed with error:",l.message,"Retrying:",d),this.close(),!d)return Promise.reject(l)}}}close(){this.db&&this.db.close(),this.db=void 0}}function eb(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}class lO{constructor(e){this.U=e,this.K=!1,this.W=null}get isDone(){return this.K}get G(){return this.W}set cursor(e){this.U=e}done(){this.K=!0}j(e){this.W=e}delete(){return _i(this.U.delete())}}class Dl extends W{constructor(e,n){super(B.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${n}`),this.name="IndexedDbTransactionError"}}function si(t){return t.name==="IndexedDbTransactionError"}class cO{constructor(e){this.store=e}put(e,n){let r;return n!==void 0?(q(Pn,"PUT",this.store.name,e,n),r=this.store.put(n,e)):(q(Pn,"PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),_i(r)}add(e){return q(Pn,"ADD",this.store.name,e,e),_i(this.store.add(e))}get(e){return _i(this.store.get(e)).next(n=>(n===void 0&&(n=null),q(Pn,"GET",this.store.name,e,n),n))}delete(e){return q(Pn,"DELETE",this.store.name,e),_i(this.store.delete(e))}count(){return q(Pn,"COUNT",this.store.name),_i(this.store.count())}J(e,n){const r=this.options(e,n),s=r.index?this.store.index(r.index):this.store;if(typeof s.getAll=="function"){const i=s.getAll(r.range);return new O((o,a)=>{i.onerror=l=>{a(l.target.error)},i.onsuccess=l=>{o(l.target.result)}})}{const i=this.cursor(r),o=[];return this.H(i,(a,l)=>{o.push(l)}).next(()=>o)}}Y(e,n){const r=this.store.getAll(e,n===null?void 0:n);return new O((s,i)=>{r.onerror=o=>{i(o.target.error)},r.onsuccess=o=>{s(o.target.result)}})}Z(e,n){q(Pn,"DELETE ALL",this.store.name);const r=this.options(e,n);r.X=!1;const s=this.cursor(r);return this.H(s,(i,o,a)=>a.delete())}ee(e,n){let r;n?r=e:(r={},n=e);const s=this.cursor(r);return this.H(s,n)}te(e){const n=this.cursor({});return new O((r,s)=>{n.onerror=i=>{const o=Sy(i.target.error);s(o)},n.onsuccess=i=>{const o=i.target.result;o?e(o.primaryKey,o.value).next(a=>{a?o.continue():r()}):r()}})}H(e,n){const r=[];return new O((s,i)=>{e.onerror=o=>{i(o.target.error)},e.onsuccess=o=>{const a=o.target.result;if(!a)return void s();const l=new lO(a),d=n(a.primaryKey,a.value,l);if(d instanceof O){const h=d.catch(f=>(l.done(),O.reject(f)));r.push(h)}l.isDone?s():l.G===null?a.continue():a.continue(l.G)}}).next(()=>O.waitFor(r))}options(e,n){let r;return e!==void 0&&(typeof e=="string"?r=e:n=e),{index:r,range:n}}cursor(e){let n="next";if(e.reverse&&(n="prev"),e.index){const r=this.store.index(e.index);return e.X?r.openKeyCursor(e.range,n):r.openCursor(e.range,n)}return this.store.openCursor(e.range,n)}}function _i(t){return new O((e,n)=>{t.onsuccess=r=>{const s=r.target.result;e(s)},t.onerror=r=>{const s=Sy(r.target.error);n(s)}})}let wE=!1;function Sy(t){const e=zs.M(Vt());if(e>=12.2&&e<13){const n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){const r=new W("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${n}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return wE||(wE=!0,setTimeout(()=>{throw r},0)),r}}return t}const jl="IndexBackfiller";class uO{constructor(e,n){this.asyncQueue=e,this.ne=n,this.task=null}start(){this.re(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}re(e){q(jl,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{const n=await this.ne.ie();q(jl,`Documents written: ${n}`)}catch(n){si(n)?q(jl,"Ignoring IndexedDB error during index backfill: ",n):await oo(n)}await this.re(6e4)})}}class dO{constructor(e,n){this.localStore=e,this.persistence=n}async ie(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",n=>this.se(n,e))}se(e,n){const r=new Set;let s=n,i=!0;return O.doWhile(()=>i===!0&&s>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(o!==null&&!r.has(o))return q(jl,`Processing collection: ${o}`),this.oe(e,o,s).next(a=>{s-=a,r.add(o)});i=!1})).next(()=>n-s)}oe(e,n,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,n).next(s=>this.localStore.localDocuments.getNextDocuments(e,n,s,r).next(i=>{const o=i.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this._e(s,i)).next(a=>(q(jl,`Updating offset: ${a}`),this.localStore.indexManager.updateCollectionGroup(e,n,a))).next(()=>o.size)}))}_e(e,n){let r=e;return n.changes.forEach((s,i)=>{const o=XS(i);xy(o,r)>0&&(r=o)}),new Vn(r.readTime,r.documentKey,Math.max(n.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hn{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ae(r),this.ue=r=>n.writeSequenceNumber(r))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}Hn.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pi=-1;function Lh(t){return t==null}function uc(t){return t===0&&1/t==-1/0}function hO(t){return typeof t=="number"&&Number.isInteger(t)&&!uc(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $d="";function ln(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=EE(e)),e=fO(t.get(n),e);return EE(e)}function fO(t,e){let n=e;const r=t.length;for(let s=0;s<r;s++){const i=t.charAt(s);switch(i){case"\0":n+="";break;case $d:n+="";break;default:n+=i}}return n}function EE(t){return t+$d+""}function Sr(t){const e=t.length;if(le(e>=2,64408,{path:t}),e===2)return le(t.charAt(0)===$d&&t.charAt(1)==="",56145,{path:t}),ze.emptyPath();const n=e-2,r=[];let s="";for(let i=0;i<e;){const o=t.indexOf($d,i);switch((o<0||o>n)&&oe(50515,{path:t}),t.charAt(o+1)){case"":const a=t.substring(i,o);let l;s.length===0?l=a:(s+=a,l=s,s=""),r.push(l);break;case"":s+=t.substring(i,o),s+="\0";break;case"":s+=t.substring(i,o+1);break;default:oe(61167,{path:t})}i=o+2}return new ze(r)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yi="remoteDocuments",Nc="owner",fo="owner",dc="mutationQueues",pO="userId",nr="mutations",IE="batchId",bi="userMutationsIndex",TE=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yu(t,e){return[t,ln(e)]}function tb(t,e,n){return[t,ln(e),n]}const mO={},da="documentMutations",Bd="remoteDocumentsV14",gO=["prefixPath","collectionGroup","readTime","documentId"],Xu="documentKeyIndex",yO=["prefixPath","collectionGroup","documentId"],nb="collectionGroupIndex",_O=["collectionGroup","readTime","prefixPath","documentId"],hc="remoteDocumentGlobal",Vm="remoteDocumentGlobalKey",ha="targets",rb="queryTargetsIndex",vO=["canonicalId","targetId"],fa="targetDocuments",wO=["targetId","path"],by="documentTargetsIndex",EO=["path","targetId"],zd="targetGlobalKey",Ni="targetGlobal",fc="collectionParents",IO=["collectionId","parent"],pa="clientMetadata",TO="clientId",Mh="bundles",xO="bundleId",Fh="namedQueries",SO="name",Cy="indexConfiguration",bO="indexId",Lm="collectionGroupIndex",CO="collectionGroup",Ol="indexState",AO=["indexId","uid"],sb="sequenceNumberIndex",RO=["uid","sequenceNumber"],Vl="indexEntries",PO=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],ib="documentKeyIndex",NO=["indexId","uid","orderedDocumentKey"],Uh="documentOverlays",kO=["userId","collectionPath","documentId"],Mm="collectionPathOverlayIndex",DO=["userId","collectionPath","largestBatchId"],ob="collectionGroupOverlayIndex",jO=["userId","collectionGroup","largestBatchId"],Ay="globals",OO="name",ab=[dc,nr,da,yi,ha,Nc,Ni,fa,pa,hc,fc,Mh,Fh],VO=[...ab,Uh],lb=[dc,nr,da,Bd,ha,Nc,Ni,fa,pa,hc,fc,Mh,Fh,Uh],cb=lb,Ry=[...cb,Cy,Ol,Vl],LO=Ry,ub=[...Ry,Ay],MO=ub;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fm extends ZS{constructor(e,n){super(),this.le=e,this.currentSequenceNumber=n}}function Lt(t,e){const n=Ee(t);return zs.O(n.le,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xE(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function ii(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function FO(t,e){const n=[];for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&n.push(e(t[r],r,t));return n}function db(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ht{constructor(e,n){this.comparator=e,this.root=n||Wt.EMPTY}insert(e,n){return new ht(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,Wt.BLACK,null,null))}remove(e){return new ht(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Wt.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(e,r.key);if(s===0)return n+r.left.size;s<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new vu(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new vu(this.root,e,this.comparator,!1)}getReverseIterator(){return new vu(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new vu(this.root,e,this.comparator,!0)}}class vu{constructor(e,n,r,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=n?r(e.key,n):1,n&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Wt{constructor(e,n,r,s,i){this.key=e,this.value=n,this.color=r??Wt.RED,this.left=s??Wt.EMPTY,this.right=i??Wt.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,s,i){return new Wt(e??this.key,n??this.value,r??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let s=this;const i=r(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,n,r),null):i===0?s.copy(null,n,null,null,null):s.copy(null,null,null,null,s.right.insert(e,n,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return Wt.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,s=this;if(n(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,n),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),n(e,s.key)===0){if(s.right.isEmpty())return Wt.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,n))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Wt.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Wt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw oe(43730,{key:this.key,value:this.value});if(this.right.isRed())throw oe(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw oe(27949);return e+(this.isRed()?0:1)}}Wt.EMPTY=null,Wt.RED=!0,Wt.BLACK=!1;Wt.EMPTY=new class{constructor(){this.size=0}get key(){throw oe(57766)}get value(){throw oe(16141)}get color(){throw oe(16727)}get left(){throw oe(29726)}get right(){throw oe(36894)}copy(e,n,r,s,i){return this}insert(e,n,r){return new Wt(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Je{constructor(e){this.comparator=e,this.data=new ht(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,e[1])>=0)return;n(s.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new SE(this.data.getIterator())}getIteratorFrom(e){return new SE(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof Je)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new Je(this.comparator);return n.data=e,n}}class SE{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function po(t){return t.hasNext()?t.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class In{constructor(e){this.fields=e,e.sort(mt.comparator)}static empty(){return new In([])}unionWith(e){let n=new Je(mt.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new In(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return ua(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hb extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pt{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(s){try{return atob(s)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new hb("Invalid base64 string: "+i):i}}(e);return new Pt(n)}static fromUint8Array(e){const n=function(s){let i="";for(let o=0;o<s.length;++o)i+=String.fromCharCode(s[o]);return i}(e);return new Pt(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return xe(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Pt.EMPTY_BYTE_STRING=new Pt("");const UO=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Zr(t){if(le(!!t,39018),typeof t=="string"){let e=0;const n=UO.exec(t);if(le(!!n,46558,{timestamp:t}),n[1]){let s=n[1];s=(s+"000000000").substr(0,9),e=Number(s)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:ct(t.seconds),nanos:ct(t.nanos)}}function ct(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function es(t){return typeof t=="string"?Pt.fromBase64String(t):Pt.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fb="server_timestamp",pb="__type__",mb="__previous_value__",gb="__local_write_time__";function $h(t){var n,r;return((r=(((n=t==null?void 0:t.mapValue)==null?void 0:n.fields)||{})[pb])==null?void 0:r.stringValue)===fb}function Bh(t){const e=t.mapValue.fields[mb];return $h(e)?Bh(e):e}function pc(t){const e=Zr(t.mapValue.fields[gb].timestampValue);return new $e(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $O{constructor(e,n,r,s,i,o,a,l,d,h){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=s,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=l,this.useFetchStreams=d,this.isUsingEmulator=h}}const qd="(default)";class qi{constructor(e,n){this.projectId=e,this.database=n||qd}static empty(){return new qi("","")}get isDefaultDatabase(){return this.database===qd}isEqual(e){return e instanceof qi&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Py="__type__",yb="__max__",Ps={mapValue:{fields:{__type__:{stringValue:yb}}}},Ny="__vector__",ma="value",Ju={nullValue:"NULL_VALUE"};function Ks(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?$h(t)?4:_b(t)?9007199254740991:zh(t)?10:11:oe(28295,{value:t})}function jr(t,e){if(t===e)return!0;const n=Ks(t);if(n!==Ks(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return pc(t).isEqual(pc(e));case 3:return function(s,i){if(typeof s.timestampValue=="string"&&typeof i.timestampValue=="string"&&s.timestampValue.length===i.timestampValue.length)return s.timestampValue===i.timestampValue;const o=Zr(s.timestampValue),a=Zr(i.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(s,i){return es(s.bytesValue).isEqual(es(i.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(s,i){return ct(s.geoPointValue.latitude)===ct(i.geoPointValue.latitude)&&ct(s.geoPointValue.longitude)===ct(i.geoPointValue.longitude)}(t,e);case 2:return function(s,i){if("integerValue"in s&&"integerValue"in i)return ct(s.integerValue)===ct(i.integerValue);if("doubleValue"in s&&"doubleValue"in i){const o=ct(s.doubleValue),a=ct(i.doubleValue);return o===a?uc(o)===uc(a):isNaN(o)&&isNaN(a)}return!1}(t,e);case 9:return ua(t.arrayValue.values||[],e.arrayValue.values||[],jr);case 10:case 11:return function(s,i){const o=s.mapValue.fields||{},a=i.mapValue.fields||{};if(xE(o)!==xE(a))return!1;for(const l in o)if(o.hasOwnProperty(l)&&(a[l]===void 0||!jr(o[l],a[l])))return!1;return!0}(t,e);default:return oe(52216,{left:t})}}function mc(t,e){return(t.values||[]).find(n=>jr(n,e))!==void 0}function Gs(t,e){if(t===e)return 0;const n=Ks(t),r=Ks(e);if(n!==r)return xe(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return xe(t.booleanValue,e.booleanValue);case 2:return function(i,o){const a=ct(i.integerValue||i.doubleValue),l=ct(o.integerValue||o.doubleValue);return a<l?-1:a>l?1:a===l?0:isNaN(a)?isNaN(l)?0:-1:1}(t,e);case 3:return bE(t.timestampValue,e.timestampValue);case 4:return bE(pc(t),pc(e));case 5:return jm(t.stringValue,e.stringValue);case 6:return function(i,o){const a=es(i),l=es(o);return a.compareTo(l)}(t.bytesValue,e.bytesValue);case 7:return function(i,o){const a=i.split("/"),l=o.split("/");for(let d=0;d<a.length&&d<l.length;d++){const h=xe(a[d],l[d]);if(h!==0)return h}return xe(a.length,l.length)}(t.referenceValue,e.referenceValue);case 8:return function(i,o){const a=xe(ct(i.latitude),ct(o.latitude));return a!==0?a:xe(ct(i.longitude),ct(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return CE(t.arrayValue,e.arrayValue);case 10:return function(i,o){var m,w,A,b;const a=i.fields||{},l=o.fields||{},d=(m=a[ma])==null?void 0:m.arrayValue,h=(w=l[ma])==null?void 0:w.arrayValue,f=xe(((A=d==null?void 0:d.values)==null?void 0:A.length)||0,((b=h==null?void 0:h.values)==null?void 0:b.length)||0);return f!==0?f:CE(d,h)}(t.mapValue,e.mapValue);case 11:return function(i,o){if(i===Ps.mapValue&&o===Ps.mapValue)return 0;if(i===Ps.mapValue)return 1;if(o===Ps.mapValue)return-1;const a=i.fields||{},l=Object.keys(a),d=o.fields||{},h=Object.keys(d);l.sort(),h.sort();for(let f=0;f<l.length&&f<h.length;++f){const m=jm(l[f],h[f]);if(m!==0)return m;const w=Gs(a[l[f]],d[h[f]]);if(w!==0)return w}return xe(l.length,h.length)}(t.mapValue,e.mapValue);default:throw oe(23264,{he:n})}}function bE(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return xe(t,e);const n=Zr(t),r=Zr(e),s=xe(n.seconds,r.seconds);return s!==0?s:xe(n.nanos,r.nanos)}function CE(t,e){const n=t.values||[],r=e.values||[];for(let s=0;s<n.length&&s<r.length;++s){const i=Gs(n[s],r[s]);if(i)return i}return xe(n.length,r.length)}function ga(t){return Um(t)}function Um(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=Zr(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return es(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return X.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",s=!0;for(const i of n.values||[])s?s=!1:r+=",",r+=Um(i);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let s="{",i=!0;for(const o of r)i?i=!1:s+=",",s+=`${o}:${Um(n.fields[o])}`;return s+"}"}(t.mapValue):oe(61005,{value:t})}function Zu(t){switch(Ks(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Bh(t);return e?16+Zu(e):16;case 5:return 2*t.stringValue.length;case 6:return es(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return function(r){return(r.values||[]).reduce((s,i)=>s+Zu(i),0)}(t.arrayValue);case 10:case 11:return function(r){let s=0;return ii(r.fields,(i,o)=>{s+=i.length+Zu(o)}),s}(t.mapValue);default:throw oe(13486,{value:t})}}function Hi(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function $m(t){return!!t&&"integerValue"in t}function gc(t){return!!t&&"arrayValue"in t}function AE(t){return!!t&&"nullValue"in t}function RE(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function ed(t){return!!t&&"mapValue"in t}function zh(t){var n,r;return((r=(((n=t==null?void 0:t.mapValue)==null?void 0:n.fields)||{})[Py])==null?void 0:r.stringValue)===Ny}function Ll(t){if(t.geoPointValue)return{geoPointValue:{...t.geoPointValue}};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:{...t.timestampValue}};if(t.mapValue){const e={mapValue:{fields:{}}};return ii(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=Ll(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=Ll(t.arrayValue.values[n]);return e}return{...t}}function _b(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===yb}const vb={mapValue:{fields:{[Py]:{stringValue:Ny},[ma]:{arrayValue:{}}}}};function BO(t){return"nullValue"in t?Ju:"booleanValue"in t?{booleanValue:!1}:"integerValue"in t||"doubleValue"in t?{doubleValue:NaN}:"timestampValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in t?{stringValue:""}:"bytesValue"in t?{bytesValue:""}:"referenceValue"in t?Hi(qi.empty(),X.empty()):"geoPointValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in t?{arrayValue:{}}:"mapValue"in t?zh(t)?vb:{mapValue:{}}:oe(35942,{value:t})}function zO(t){return"nullValue"in t?{booleanValue:!1}:"booleanValue"in t?{doubleValue:NaN}:"integerValue"in t||"doubleValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in t?{stringValue:""}:"stringValue"in t?{bytesValue:""}:"bytesValue"in t?Hi(qi.empty(),X.empty()):"referenceValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in t?{arrayValue:{}}:"arrayValue"in t?vb:"mapValue"in t?zh(t)?{mapValue:{}}:Ps:oe(61959,{value:t})}function PE(t,e){const n=Gs(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?-1:!t.inclusive&&e.inclusive?1:0}function NE(t,e){const n=Gs(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?1:!t.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sn{constructor(e){this.value=e}static empty(){return new sn({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!ed(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=Ll(n)}setAll(e){let n=mt.emptyPath(),r={},s=[];e.forEach((o,a)=>{if(!n.isImmediateParentOf(a)){const l=this.getFieldsMap(n);this.applyChanges(l,r,s),r={},s=[],n=a.popLast()}o?r[a.lastSegment()]=Ll(o):s.push(a.lastSegment())});const i=this.getFieldsMap(n);this.applyChanges(i,r,s)}delete(e){const n=this.field(e.popLast());ed(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return jr(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let s=n.mapValue.fields[e.get(r)];ed(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=s),n=s}return n.mapValue.fields}applyChanges(e,n,r){ii(n,(s,i)=>e[s]=i);for(const s of r)delete e[s]}clone(){return new sn(Ll(this.value))}}function wb(t){const e=[];return ii(t.fields,(n,r)=>{const s=new mt([n]);if(ed(r)){const i=wb(r.mapValue).fields;if(i.length===0)e.push(s);else for(const o of i)e.push(s.child(o))}else e.push(s)}),new In(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wt{constructor(e,n,r,s,i,o,a){this.key=e,this.documentType=n,this.version=r,this.readTime=s,this.createTime=i,this.data=o,this.documentState=a}static newInvalidDocument(e){return new wt(e,0,pe.min(),pe.min(),pe.min(),sn.empty(),0)}static newFoundDocument(e,n,r,s){return new wt(e,1,n,pe.min(),r,s,0)}static newNoDocument(e,n){return new wt(e,2,n,pe.min(),pe.min(),sn.empty(),0)}static newUnknownDocument(e,n){return new wt(e,3,n,pe.min(),pe.min(),sn.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(pe.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=sn.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=sn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=pe.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof wt&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new wt(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qs{constructor(e,n){this.position=e,this.inclusive=n}}function kE(t,e,n){let r=0;for(let s=0;s<t.position.length;s++){const i=e[s],o=t.position[s];if(i.field.isKeyField()?r=X.comparator(X.fromName(o.referenceValue),n.key):r=Gs(o,n.data.field(i.field)),i.dir==="desc"&&(r*=-1),r!==0)break}return r}function DE(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!jr(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yc{constructor(e,n="asc"){this.field=e,this.dir=n}}function qO(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Eb{}class je extends Eb{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new HO(e,n,r):n==="array-contains"?new GO(e,r):n==="in"?new Cb(e,r):n==="not-in"?new QO(e,r):n==="array-contains-any"?new YO(e,r):new je(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new WO(e,r):new KO(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&n.nullValue===void 0&&this.matchesComparison(Gs(n,this.value)):n!==null&&Ks(this.value)===Ks(n)&&this.matchesComparison(Gs(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return oe(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Ye extends Eb{constructor(e,n){super(),this.filters=e,this.op=n,this.Pe=null}static create(e,n){return new Ye(e,n)}matches(e){return ya(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function ya(t){return t.op==="and"}function Bm(t){return t.op==="or"}function ky(t){return Ib(t)&&ya(t)}function Ib(t){for(const e of t.filters)if(e instanceof Ye)return!1;return!0}function zm(t){if(t instanceof je)return t.field.canonicalString()+t.op.toString()+ga(t.value);if(ky(t))return t.filters.map(e=>zm(e)).join(",");{const e=t.filters.map(n=>zm(n)).join(",");return`${t.op}(${e})`}}function Tb(t,e){return t instanceof je?function(r,s){return s instanceof je&&r.op===s.op&&r.field.isEqual(s.field)&&jr(r.value,s.value)}(t,e):t instanceof Ye?function(r,s){return s instanceof Ye&&r.op===s.op&&r.filters.length===s.filters.length?r.filters.reduce((i,o,a)=>i&&Tb(o,s.filters[a]),!0):!1}(t,e):void oe(19439)}function xb(t,e){const n=t.filters.concat(e);return Ye.create(n,t.op)}function Sb(t){return t instanceof je?function(n){return`${n.field.canonicalString()} ${n.op} ${ga(n.value)}`}(t):t instanceof Ye?function(n){return n.op.toString()+" {"+n.getFilters().map(Sb).join(" ,")+"}"}(t):"Filter"}class HO extends je{constructor(e,n,r){super(e,n,r),this.key=X.fromName(r.referenceValue)}matches(e){const n=X.comparator(e.key,this.key);return this.matchesComparison(n)}}class WO extends je{constructor(e,n){super(e,"in",n),this.keys=bb("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class KO extends je{constructor(e,n){super(e,"not-in",n),this.keys=bb("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function bb(t,e){var n;return(((n=e.arrayValue)==null?void 0:n.values)||[]).map(r=>X.fromName(r.referenceValue))}class GO extends je{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return gc(n)&&mc(n.arrayValue,this.value)}}class Cb extends je{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&mc(this.value.arrayValue,n)}}class QO extends je{constructor(e,n){super(e,"not-in",n)}matches(e){if(mc(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&n.nullValue===void 0&&!mc(this.value.arrayValue,n)}}class YO extends je{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!gc(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>mc(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XO{constructor(e,n=null,r=[],s=[],i=null,o=null,a=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=s,this.limit=i,this.startAt=o,this.endAt=a,this.Te=null}}function qm(t,e=null,n=[],r=[],s=null,i=null,o=null){return new XO(t,e,n,r,s,i,o)}function Wi(t){const e=Ee(t);if(e.Te===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>zm(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(i){return i.field.canonicalString()+i.dir}(r)).join(","),Lh(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>ga(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>ga(r)).join(",")),e.Te=n}return e.Te}function kc(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!qO(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!Tb(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!DE(t.startAt,e.startAt)&&DE(t.endAt,e.endAt)}function Hd(t){return X.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}function Wd(t,e){return t.filters.filter(n=>n instanceof je&&n.field.isEqual(e))}function jE(t,e,n){let r=Ju,s=!0;for(const i of Wd(t,e)){let o=Ju,a=!0;switch(i.op){case"<":case"<=":o=BO(i.value);break;case"==":case"in":case">=":o=i.value;break;case">":o=i.value,a=!1;break;case"!=":case"not-in":o=Ju}PE({value:r,inclusive:s},{value:o,inclusive:a})<0&&(r=o,s=a)}if(n!==null){for(let i=0;i<t.orderBy.length;++i)if(t.orderBy[i].field.isEqual(e)){const o=n.position[i];PE({value:r,inclusive:s},{value:o,inclusive:n.inclusive})<0&&(r=o,s=n.inclusive);break}}return{value:r,inclusive:s}}function OE(t,e,n){let r=Ps,s=!0;for(const i of Wd(t,e)){let o=Ps,a=!0;switch(i.op){case">=":case">":o=zO(i.value),a=!1;break;case"==":case"in":case"<=":o=i.value;break;case"<":o=i.value,a=!1;break;case"!=":case"not-in":o=Ps}NE({value:r,inclusive:s},{value:o,inclusive:a})>0&&(r=o,s=a)}if(n!==null){for(let i=0;i<t.orderBy.length;++i)if(t.orderBy[i].field.isEqual(e)){const o=n.position[i];NE({value:r,inclusive:s},{value:o,inclusive:n.inclusive})>0&&(r=o,s=n.inclusive);break}}return{value:r,inclusive:s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oi{constructor(e,n=null,r=[],s=[],i=null,o="F",a=null,l=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=s,this.limit=i,this.limitType=o,this.startAt=a,this.endAt=l,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function JO(t,e,n,r,s,i,o,a){return new oi(t,e,n,r,s,i,o,a)}function Dc(t){return new oi(t)}function VE(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function Dy(t){return t.collectionGroup!==null}function Xo(t){const e=Ee(t);if(e.Ie===null){e.Ie=[];const n=new Set;for(const i of e.explicitOrderBy)e.Ie.push(i),n.add(i.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new Je(mt.comparator);return o.filters.forEach(l=>{l.getFlattenedFilters().forEach(d=>{d.isInequality()&&(a=a.add(d.field))})}),a})(e).forEach(i=>{n.has(i.canonicalString())||i.isKeyField()||e.Ie.push(new yc(i,r))}),n.has(mt.keyField().canonicalString())||e.Ie.push(new yc(mt.keyField(),r))}return e.Ie}function Kn(t){const e=Ee(t);return e.Ee||(e.Ee=Ab(e,Xo(t))),e.Ee}function ZO(t){const e=Ee(t);return e.de||(e.de=Ab(e,t.explicitOrderBy)),e.de}function Ab(t,e){if(t.limitType==="F")return qm(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(s=>{const i=s.dir==="desc"?"asc":"desc";return new yc(s.field,i)});const n=t.endAt?new Qs(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new Qs(t.startAt.position,t.startAt.inclusive):null;return qm(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function Hm(t,e){const n=t.filters.concat([e]);return new oi(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function Kd(t,e,n){return new oi(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function qh(t,e){return kc(Kn(t),Kn(e))&&t.limitType===e.limitType}function Rb(t){return`${Wi(Kn(t))}|lt:${t.limitType}`}function bo(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(s=>Sb(s)).join(", ")}]`),Lh(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(s=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(s)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(s=>ga(s)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(s=>ga(s)).join(",")),`Target(${r})`}(Kn(t))}; limitType=${t.limitType})`}function jc(t,e){return e.isFoundDocument()&&function(r,s){const i=s.key.path;return r.collectionGroup!==null?s.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(i):X.isDocumentKey(r.path)?r.path.isEqual(i):r.path.isImmediateParentOf(i)}(t,e)&&function(r,s){for(const i of Xo(r))if(!i.field.isKeyField()&&s.data.field(i.field)===null)return!1;return!0}(t,e)&&function(r,s){for(const i of r.filters)if(!i.matches(s))return!1;return!0}(t,e)&&function(r,s){return!(r.startAt&&!function(o,a,l){const d=kE(o,a,l);return o.inclusive?d<=0:d<0}(r.startAt,Xo(r),s)||r.endAt&&!function(o,a,l){const d=kE(o,a,l);return o.inclusive?d>=0:d>0}(r.endAt,Xo(r),s))}(t,e)}function eV(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function Pb(t){return(e,n)=>{let r=!1;for(const s of Xo(t)){const i=tV(s,e,n);if(i!==0)return i;r=r||s.field.isKeyField()}return 0}}function tV(t,e,n){const r=t.field.isKeyField()?X.comparator(e.key,n.key):function(i,o,a){const l=o.data.field(i),d=a.data.field(i);return l!==null&&d!==null?Gs(l,d):oe(42886)}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return oe(19790,{direction:t.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rs{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[s,i]of r)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),s=this.inner[r];if(s===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,n]);s.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return r.length===1?delete this.inner[n]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(e){ii(this.inner,(n,r)=>{for(const[s,i]of r)e(s,i)})}isEmpty(){return db(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nV=new ht(X.comparator);function kn(){return nV}const Nb=new ht(X.comparator);function gl(...t){let e=Nb;for(const n of t)e=e.insert(n.key,n);return e}function kb(t){let e=Nb;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function br(){return Ml()}function Db(){return Ml()}function Ml(){return new rs(t=>t.toString(),(t,e)=>t.isEqual(e))}const rV=new ht(X.comparator),sV=new Je(X.comparator);function Ae(...t){let e=sV;for(const n of t)e=e.add(n);return e}const iV=new Je(xe);function oV(){return iV}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jy(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:uc(e)?"-0":e}}function jb(t){return{integerValue:""+t}}function Ob(t,e){return hO(e)?jb(e):jy(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hh{constructor(){this._=void 0}}function aV(t,e,n){return t instanceof _a?function(s,i){const o={fields:{[pb]:{stringValue:fb},[gb]:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return i&&$h(i)&&(i=Bh(i)),i&&(o.fields[mb]=i),{mapValue:o}}(n,e):t instanceof Ki?Lb(t,e):t instanceof va?Mb(t,e):function(s,i){const o=Vb(s,i),a=LE(o)+LE(s.Ae);return $m(o)&&$m(s.Ae)?jb(a):jy(s.serializer,a)}(t,e)}function lV(t,e,n){return t instanceof Ki?Lb(t,e):t instanceof va?Mb(t,e):n}function Vb(t,e){return t instanceof wa?function(r){return $m(r)||function(i){return!!i&&"doubleValue"in i}(r)}(e)?e:{integerValue:0}:null}class _a extends Hh{}class Ki extends Hh{constructor(e){super(),this.elements=e}}function Lb(t,e){const n=Fb(e);for(const r of t.elements)n.some(s=>jr(s,r))||n.push(r);return{arrayValue:{values:n}}}class va extends Hh{constructor(e){super(),this.elements=e}}function Mb(t,e){let n=Fb(e);for(const r of t.elements)n=n.filter(s=>!jr(s,r));return{arrayValue:{values:n}}}class wa extends Hh{constructor(e,n){super(),this.serializer=e,this.Ae=n}}function LE(t){return ct(t.integerValue||t.doubleValue)}function Fb(t){return gc(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wh{constructor(e,n){this.field=e,this.transform=n}}function cV(t,e){return t.field.isEqual(e.field)&&function(r,s){return r instanceof Ki&&s instanceof Ki||r instanceof va&&s instanceof va?ua(r.elements,s.elements,jr):r instanceof wa&&s instanceof wa?jr(r.Ae,s.Ae):r instanceof _a&&s instanceof _a}(t.transform,e.transform)}class uV{constructor(e,n){this.version=e,this.transformResults=n}}class on{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new on}static exists(e){return new on(void 0,e)}static updateTime(e){return new on(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function td(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class Kh{}function Ub(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new Gh(t.key,on.none()):new ka(t.key,t.data,on.none());{const n=t.data,r=sn.empty();let s=new Je(mt.comparator);for(let i of e.fields)if(!s.has(i)){let o=n.field(i);o===null&&i.length>1&&(i=i.popLast(),o=n.field(i)),o===null?r.delete(i):r.set(i,o),s=s.add(i)}return new ss(t.key,r,new In(s.toArray()),on.none())}}function dV(t,e,n){t instanceof ka?function(s,i,o){const a=s.value.clone(),l=FE(s.fieldTransforms,i,o.transformResults);a.setAll(l),i.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(t,e,n):t instanceof ss?function(s,i,o){if(!td(s.precondition,i))return void i.convertToUnknownDocument(o.version);const a=FE(s.fieldTransforms,i,o.transformResults),l=i.data;l.setAll($b(s)),l.setAll(a),i.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(t,e,n):function(s,i,o){i.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,n)}function Fl(t,e,n,r){return t instanceof ka?function(i,o,a,l){if(!td(i.precondition,o))return a;const d=i.value.clone(),h=UE(i.fieldTransforms,l,o);return d.setAll(h),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),null}(t,e,n,r):t instanceof ss?function(i,o,a,l){if(!td(i.precondition,o))return a;const d=UE(i.fieldTransforms,l,o),h=o.data;return h.setAll($b(i)),h.setAll(d),o.convertToFoundDocument(o.version,h).setHasLocalMutations(),a===null?null:a.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(f=>f.field))}(t,e,n,r):function(i,o,a){return td(i.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(t,e,n)}function hV(t,e){let n=null;for(const r of t.fieldTransforms){const s=e.data.field(r.field),i=Vb(r.transform,s||null);i!=null&&(n===null&&(n=sn.empty()),n.set(r.field,i))}return n||null}function ME(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,s){return r===void 0&&s===void 0||!(!r||!s)&&ua(r,s,(i,o)=>cV(i,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class ka extends Kh{constructor(e,n,r,s=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class ss extends Kh{constructor(e,n,r,s,i=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function $b(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function FE(t,e,n){const r=new Map;le(t.length===n.length,32656,{Re:n.length,Ve:t.length});for(let s=0;s<n.length;s++){const i=t[s],o=i.transform,a=e.data.field(i.field);r.set(i.field,lV(o,a,n[s]))}return r}function UE(t,e,n){const r=new Map;for(const s of t){const i=s.transform,o=n.data.field(s.field);r.set(s.field,aV(i,o,e))}return r}class Gh extends Kh{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Bb extends Kh{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oy{constructor(e,n,r,s){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&dV(i,e,r[s])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=Fl(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=Fl(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=Db();return this.mutations.forEach(s=>{const i=e.get(s.key),o=i.overlayedDocument;let a=this.applyToLocalView(o,i.mutatedFields);a=n.has(s.key)?null:a;const l=Ub(o,a);l!==null&&r.set(s.key,l),o.isValidDocument()||o.convertToNoDocument(pe.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),Ae())}isEqual(e){return this.batchId===e.batchId&&ua(this.mutations,e.mutations,(n,r)=>ME(n,r))&&ua(this.baseMutations,e.baseMutations,(n,r)=>ME(n,r))}}class Vy{constructor(e,n,r,s){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=s}static from(e,n,r){le(e.mutations.length===r.length,58842,{me:e.mutations.length,fe:r.length});let s=function(){return rV}();const i=e.mutations;for(let o=0;o<i.length;o++)s=s.insert(i[o].key,r[o].version);return new Vy(e,n,r,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ly{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fV{constructor(e,n,r){this.alias=e,this.aggregateType=n,this.fieldPath=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pV{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ct,Fe;function mV(t){switch(t){case B.OK:return oe(64938);case B.CANCELLED:case B.UNKNOWN:case B.DEADLINE_EXCEEDED:case B.RESOURCE_EXHAUSTED:case B.INTERNAL:case B.UNAVAILABLE:case B.UNAUTHENTICATED:return!1;case B.INVALID_ARGUMENT:case B.NOT_FOUND:case B.ALREADY_EXISTS:case B.PERMISSION_DENIED:case B.FAILED_PRECONDITION:case B.ABORTED:case B.OUT_OF_RANGE:case B.UNIMPLEMENTED:case B.DATA_LOSS:return!0;default:return oe(15467,{code:t})}}function zb(t){if(t===void 0)return hn("GRPC error has no .code"),B.UNKNOWN;switch(t){case Ct.OK:return B.OK;case Ct.CANCELLED:return B.CANCELLED;case Ct.UNKNOWN:return B.UNKNOWN;case Ct.DEADLINE_EXCEEDED:return B.DEADLINE_EXCEEDED;case Ct.RESOURCE_EXHAUSTED:return B.RESOURCE_EXHAUSTED;case Ct.INTERNAL:return B.INTERNAL;case Ct.UNAVAILABLE:return B.UNAVAILABLE;case Ct.UNAUTHENTICATED:return B.UNAUTHENTICATED;case Ct.INVALID_ARGUMENT:return B.INVALID_ARGUMENT;case Ct.NOT_FOUND:return B.NOT_FOUND;case Ct.ALREADY_EXISTS:return B.ALREADY_EXISTS;case Ct.PERMISSION_DENIED:return B.PERMISSION_DENIED;case Ct.FAILED_PRECONDITION:return B.FAILED_PRECONDITION;case Ct.ABORTED:return B.ABORTED;case Ct.OUT_OF_RANGE:return B.OUT_OF_RANGE;case Ct.UNIMPLEMENTED:return B.UNIMPLEMENTED;case Ct.DATA_LOSS:return B.DATA_LOSS;default:return oe(39323,{code:t})}}(Fe=Ct||(Ct={}))[Fe.OK=0]="OK",Fe[Fe.CANCELLED=1]="CANCELLED",Fe[Fe.UNKNOWN=2]="UNKNOWN",Fe[Fe.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Fe[Fe.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Fe[Fe.NOT_FOUND=5]="NOT_FOUND",Fe[Fe.ALREADY_EXISTS=6]="ALREADY_EXISTS",Fe[Fe.PERMISSION_DENIED=7]="PERMISSION_DENIED",Fe[Fe.UNAUTHENTICATED=16]="UNAUTHENTICATED",Fe[Fe.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Fe[Fe.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Fe[Fe.ABORTED=10]="ABORTED",Fe[Fe.OUT_OF_RANGE=11]="OUT_OF_RANGE",Fe[Fe.UNIMPLEMENTED=12]="UNIMPLEMENTED",Fe[Fe.INTERNAL=13]="INTERNAL",Fe[Fe.UNAVAILABLE=14]="UNAVAILABLE",Fe[Fe.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gV(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yV=new Bs([4294967295,4294967295],0);function $E(t){const e=gV().encode(t),n=new US;return n.update(e),new Uint8Array(n.digest())}function BE(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),s=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new Bs([n,r],0),new Bs([s,i],0)]}class My{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new yl(`Invalid padding: ${n}`);if(r<0)throw new yl(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new yl(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new yl(`Invalid padding when bitmap length is 0: ${n}`);this.ge=8*e.length-n,this.pe=Bs.fromNumber(this.ge)}ye(e,n,r){let s=e.add(n.multiply(Bs.fromNumber(r)));return s.compare(yV)===1&&(s=new Bs([s.getBits(0),s.getBits(1)],0)),s.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const n=$E(e),[r,s]=BE(n);for(let i=0;i<this.hashCount;i++){const o=this.ye(r,s,i);if(!this.we(o))return!1}return!0}static create(e,n,r){const s=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),o=new My(i,s,n);return r.forEach(a=>o.insert(a)),o}insert(e){if(this.ge===0)return;const n=$E(e),[r,s]=BE(n);for(let i=0;i<this.hashCount;i++){const o=this.ye(r,s,i);this.Se(o)}}Se(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class yl extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qh{constructor(e,n,r,s,i){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const s=new Map;return s.set(e,Oc.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new Qh(pe.min(),s,new ht(xe),kn(),Ae())}}class Oc{constructor(e,n,r,s,i){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new Oc(r,n,Ae(),Ae(),Ae())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nd{constructor(e,n,r,s){this.be=e,this.removedTargetIds=n,this.key=r,this.De=s}}class qb{constructor(e,n){this.targetId=e,this.Ce=n}}class Hb{constructor(e,n,r=Pt.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=s}}class zE{constructor(){this.ve=0,this.Fe=qE(),this.Me=Pt.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=Ae(),n=Ae(),r=Ae();return this.Fe.forEach((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:n=n.add(s);break;case 1:r=r.add(s);break;default:oe(38017,{changeType:i})}}),new Oc(this.Me,this.xe,e,n,r)}qe(){this.Oe=!1,this.Fe=qE()}Qe(e,n){this.Oe=!0,this.Fe=this.Fe.insert(e,n)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,le(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class _V{constructor(e){this.Ge=e,this.ze=new Map,this.je=kn(),this.Je=wu(),this.He=wu(),this.Ye=new ht(xe)}Ze(e){for(const n of e.be)e.De&&e.De.isFoundDocument()?this.Xe(n,e.De):this.et(n,e.key,e.De);for(const n of e.removedTargetIds)this.et(n,e.key,e.De)}tt(e){this.forEachTarget(e,n=>{const r=this.nt(n);switch(e.state){case 0:this.rt(n)&&r.Le(e.resumeToken);break;case 1:r.Ke(),r.Ne||r.qe(),r.Le(e.resumeToken);break;case 2:r.Ke(),r.Ne||this.removeTarget(n);break;case 3:this.rt(n)&&(r.We(),r.Le(e.resumeToken));break;case 4:this.rt(n)&&(this.it(n),r.Le(e.resumeToken));break;default:oe(56790,{state:e.state})}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.ze.forEach((r,s)=>{this.rt(s)&&n(s)})}st(e){const n=e.targetId,r=e.Ce.count,s=this.ot(n);if(s){const i=s.target;if(Hd(i))if(r===0){const o=new X(i.path);this.et(n,o,wt.newNoDocument(o,pe.min()))}else le(r===1,20013,{expectedCount:r});else{const o=this._t(n);if(o!==r){const a=this.ut(e),l=a?this.ct(a,e,o):1;if(l!==0){this.it(n);const d=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(n,d)}}}}}ut(e){const n=e.Ce.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:s=0},hashCount:i=0}=n;let o,a;try{o=es(r).toUint8Array()}catch(l){if(l instanceof hb)return zi("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{a=new My(o,s,i)}catch(l){return zi(l instanceof yl?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return a.ge===0?null:a}ct(e,n,r){return n.Ce.count===r-this.Pt(e,n.targetId)?0:2}Pt(e,n){const r=this.Ge.getRemoteKeysForTarget(n);let s=0;return r.forEach(i=>{const o=this.Ge.ht(),a=`projects/${o.projectId}/databases/${o.database}/documents/${i.path.canonicalString()}`;e.mightContain(a)||(this.et(n,i,null),s++)}),s}Tt(e){const n=new Map;this.ze.forEach((i,o)=>{const a=this.ot(o);if(a){if(i.current&&Hd(a.target)){const l=new X(a.target.path);this.It(l).has(o)||this.Et(o,l)||this.et(o,l,wt.newNoDocument(l,e))}i.Be&&(n.set(o,i.ke()),i.qe())}});let r=Ae();this.He.forEach((i,o)=>{let a=!0;o.forEachWhile(l=>{const d=this.ot(l);return!d||d.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(i))}),this.je.forEach((i,o)=>o.setReadTime(e));const s=new Qh(e,n,this.Ye,this.je,r);return this.je=kn(),this.Je=wu(),this.He=wu(),this.Ye=new ht(xe),s}Xe(e,n){if(!this.rt(e))return;const r=this.Et(e,n.key)?2:0;this.nt(e).Qe(n.key,r),this.je=this.je.insert(n.key,n),this.Je=this.Je.insert(n.key,this.It(n.key).add(e)),this.He=this.He.insert(n.key,this.dt(n.key).add(e))}et(e,n,r){if(!this.rt(e))return;const s=this.nt(e);this.Et(e,n)?s.Qe(n,1):s.$e(n),this.He=this.He.insert(n,this.dt(n).delete(e)),this.He=this.He.insert(n,this.dt(n).add(e)),r&&(this.je=this.je.insert(n,r))}removeTarget(e){this.ze.delete(e)}_t(e){const n=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let n=this.ze.get(e);return n||(n=new zE,this.ze.set(e,n)),n}dt(e){let n=this.He.get(e);return n||(n=new Je(xe),this.He=this.He.insert(e,n)),n}It(e){let n=this.Je.get(e);return n||(n=new Je(xe),this.Je=this.Je.insert(e,n)),n}rt(e){const n=this.ot(e)!==null;return n||q("WatchChangeAggregator","Detected inactive target",e),n}ot(e){const n=this.ze.get(e);return n&&n.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new zE),this.Ge.getRemoteKeysForTarget(e).forEach(n=>{this.et(e,n,null)})}Et(e,n){return this.Ge.getRemoteKeysForTarget(e).has(n)}}function wu(){return new ht(X.comparator)}function qE(){return new ht(X.comparator)}const vV={asc:"ASCENDING",desc:"DESCENDING"},wV={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},EV={and:"AND",or:"OR"};class IV{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function Wm(t,e){return t.useProto3Json||Lh(e)?e:{value:e}}function Ea(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Wb(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function TV(t,e){return Ea(t,e.toTimestamp())}function mn(t){return le(!!t,49232),pe.fromTimestamp(function(n){const r=Zr(n);return new $e(r.seconds,r.nanos)}(t))}function Fy(t,e){return Km(t,e).canonicalString()}function Km(t,e){const n=function(s){return new ze(["projects",s.projectId,"databases",s.database])}(t).child("documents");return e===void 0?n:n.child(e)}function Kb(t){const e=ze.fromString(t);return le(tC(e),10190,{key:e.toString()}),e}function Gd(t,e){return Fy(t.databaseId,e.path)}function ki(t,e){const n=Kb(e);if(n.get(1)!==t.databaseId.projectId)throw new W(B.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new W(B.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new X(Yb(n))}function Gb(t,e){return Fy(t.databaseId,e)}function Qb(t){const e=Kb(t);return e.length===4?ze.emptyPath():Yb(e)}function Gm(t){return new ze(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function Yb(t){return le(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function HE(t,e,n){return{name:Gd(t,e),fields:n.value.mapValue.fields}}function xV(t,e,n){const r=ki(t,e.name),s=mn(e.updateTime),i=e.createTime?mn(e.createTime):pe.min(),o=new sn({mapValue:{fields:e.fields}}),a=wt.newFoundDocument(r,s,i,o);return n&&a.setHasCommittedMutations(),n?a.setHasCommittedMutations():a}function SV(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(d){return d==="NO_CHANGE"?0:d==="ADD"?1:d==="REMOVE"?2:d==="CURRENT"?3:d==="RESET"?4:oe(39313,{state:d})}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=function(d,h){return d.useProto3Json?(le(h===void 0||typeof h=="string",58123),Pt.fromBase64String(h||"")):(le(h===void 0||h instanceof Buffer||h instanceof Uint8Array,16193),Pt.fromUint8Array(h||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(d){const h=d.code===void 0?B.UNKNOWN:zb(d.code);return new W(h,d.message||"")}(o);n=new Hb(r,s,i,a||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const s=ki(t,r.document.name),i=mn(r.document.updateTime),o=r.document.createTime?mn(r.document.createTime):pe.min(),a=new sn({mapValue:{fields:r.document.fields}}),l=wt.newFoundDocument(s,i,o,a),d=r.targetIds||[],h=r.removedTargetIds||[];n=new nd(d,h,l.key,l)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const s=ki(t,r.document),i=r.readTime?mn(r.readTime):pe.min(),o=wt.newNoDocument(s,i),a=r.removedTargetIds||[];n=new nd([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const s=ki(t,r.document),i=r.removedTargetIds||[];n=new nd([],i,s,null)}else{if(!("filter"in e))return oe(11601,{Rt:e});{e.filter;const r=e.filter;r.targetId;const{count:s=0,unchangedNames:i}=r,o=new pV(s,i),a=r.targetId;n=new qb(a,o)}}return n}function Qd(t,e){let n;if(e instanceof ka)n={update:HE(t,e.key,e.value)};else if(e instanceof Gh)n={delete:Gd(t,e.key)};else if(e instanceof ss)n={update:HE(t,e.key,e.data),updateMask:kV(e.fieldMask)};else{if(!(e instanceof Bb))return oe(16599,{Vt:e.type});n={verify:Gd(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(i,o){const a=o.transform;if(a instanceof _a)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof Ki)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof va)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof wa)return{fieldPath:o.field.canonicalString(),increment:a.Ae};throw oe(20930,{transform:o.transform})}(0,r))),e.precondition.isNone||(n.currentDocument=function(s,i){return i.updateTime!==void 0?{updateTime:TV(s,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:oe(27497)}(t,e.precondition)),n}function Qm(t,e){const n=e.currentDocument?function(i){return i.updateTime!==void 0?on.updateTime(mn(i.updateTime)):i.exists!==void 0?on.exists(i.exists):on.none()}(e.currentDocument):on.none(),r=e.updateTransforms?e.updateTransforms.map(s=>function(o,a){let l=null;if("setToServerValue"in a)le(a.setToServerValue==="REQUEST_TIME",16630,{proto:a}),l=new _a;else if("appendMissingElements"in a){const h=a.appendMissingElements.values||[];l=new Ki(h)}else if("removeAllFromArray"in a){const h=a.removeAllFromArray.values||[];l=new va(h)}else"increment"in a?l=new wa(o,a.increment):oe(16584,{proto:a});const d=mt.fromServerFormat(a.fieldPath);return new Wh(d,l)}(t,s)):[];if(e.update){e.update.name;const s=ki(t,e.update.name),i=new sn({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=function(l){const d=l.fieldPaths||[];return new In(d.map(h=>mt.fromServerFormat(h)))}(e.updateMask);return new ss(s,i,o,n,r)}return new ka(s,i,n,r)}if(e.delete){const s=ki(t,e.delete);return new Gh(s,n)}if(e.verify){const s=ki(t,e.verify);return new Bb(s,n)}return oe(1463,{proto:e})}function bV(t,e){return t&&t.length>0?(le(e!==void 0,14353),t.map(n=>function(s,i){let o=s.updateTime?mn(s.updateTime):mn(i);return o.isEqual(pe.min())&&(o=mn(i)),new uV(o,s.transformResults||[])}(n,e))):[]}function Xb(t,e){return{documents:[Gb(t,e.path)]}}function Uy(t,e){const n={structuredQuery:{}},r=e.path;let s;e.collectionGroup!==null?(s=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=Gb(t,s);const i=function(d){if(d.length!==0)return eC(Ye.create(d,"and"))}(e.filters);i&&(n.structuredQuery.where=i);const o=function(d){if(d.length!==0)return d.map(h=>function(m){return{field:Ss(m.field),direction:RV(m.dir)}}(h))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);const a=Wm(t,e.limit);return a!==null&&(n.structuredQuery.limit=a),e.startAt&&(n.structuredQuery.startAt=function(d){return{before:d.inclusive,values:d.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(d){return{before:!d.inclusive,values:d.position}}(e.endAt)),{ft:n,parent:s}}function CV(t,e,n,r){const{ft:s,parent:i}=Uy(t,e),o={},a=[];let l=0;return n.forEach(d=>{const h="aggregate_"+l++;o[h]=d.alias,d.aggregateType==="count"?a.push({alias:h,count:{}}):d.aggregateType==="avg"?a.push({alias:h,avg:{field:Ss(d.fieldPath)}}):d.aggregateType==="sum"&&a.push({alias:h,sum:{field:Ss(d.fieldPath)}})}),{request:{structuredAggregationQuery:{aggregations:a,structuredQuery:s.structuredQuery},parent:s.parent},gt:o,parent:i}}function Jb(t){let e=Qb(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let s=null;if(r>0){le(r===1,65062);const h=n.from[0];h.allDescendants?s=h.collectionId:e=e.child(h.collectionId)}let i=[];n.where&&(i=function(f){const m=Zb(f);return m instanceof Ye&&ky(m)?m.getFilters():[m]}(n.where));let o=[];n.orderBy&&(o=function(f){return f.map(m=>function(A){return new yc(Co(A.field),function(P){switch(P){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(A.direction))}(m))}(n.orderBy));let a=null;n.limit&&(a=function(f){let m;return m=typeof f=="object"?f.value:f,Lh(m)?null:m}(n.limit));let l=null;n.startAt&&(l=function(f){const m=!!f.before,w=f.values||[];return new Qs(w,m)}(n.startAt));let d=null;return n.endAt&&(d=function(f){const m=!f.before,w=f.values||[];return new Qs(w,m)}(n.endAt)),JO(e,s,o,i,a,"F",l,d)}function AV(t,e){const n=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return oe(28987,{purpose:s})}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function Zb(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=Co(n.unaryFilter.field);return je.create(r,"==",{doubleValue:NaN});case"IS_NULL":const s=Co(n.unaryFilter.field);return je.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=Co(n.unaryFilter.field);return je.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=Co(n.unaryFilter.field);return je.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return oe(61313);default:return oe(60726)}}(t):t.fieldFilter!==void 0?function(n){return je.create(Co(n.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return oe(58110);default:return oe(50506)}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return Ye.create(n.compositeFilter.filters.map(r=>Zb(r)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return oe(1026)}}(n.compositeFilter.op))}(t):oe(30097,{filter:t})}function RV(t){return vV[t]}function PV(t){return wV[t]}function NV(t){return EV[t]}function Ss(t){return{fieldPath:t.canonicalString()}}function Co(t){return mt.fromServerFormat(t.fieldPath)}function eC(t){return t instanceof je?function(n){if(n.op==="=="){if(RE(n.value))return{unaryFilter:{field:Ss(n.field),op:"IS_NAN"}};if(AE(n.value))return{unaryFilter:{field:Ss(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(RE(n.value))return{unaryFilter:{field:Ss(n.field),op:"IS_NOT_NAN"}};if(AE(n.value))return{unaryFilter:{field:Ss(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Ss(n.field),op:PV(n.op),value:n.value}}}(t):t instanceof Ye?function(n){const r=n.getFilters().map(s=>eC(s));return r.length===1?r[0]:{compositeFilter:{op:NV(n.op),filters:r}}}(t):oe(54877,{filter:t})}function kV(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function tC(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Br{constructor(e,n,r,s,i=pe.min(),o=pe.min(),a=Pt.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=l}withSequenceNumber(e){return new Br(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new Br(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Br(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Br(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nC{constructor(e){this.yt=e}}function DV(t,e){let n;if(e.document)n=xV(t.yt,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=X.fromSegments(e.noDocument.path),s=Qi(e.noDocument.readTime);n=wt.newNoDocument(r,s),e.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!e.unknownDocument)return oe(56709);{const r=X.fromSegments(e.unknownDocument.path),s=Qi(e.unknownDocument.version);n=wt.newUnknownDocument(r,s)}}return e.readTime&&n.setReadTime(function(s){const i=new $e(s[0],s[1]);return pe.fromTimestamp(i)}(e.readTime)),n}function WE(t,e){const n=e.key,r={prefixPath:n.getCollectionPath().popLast().toArray(),collectionGroup:n.collectionGroup,documentId:n.path.lastSegment(),readTime:Yd(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=function(i,o){return{name:Gd(i,o.key),fields:o.data.value.mapValue.fields,updateTime:Ea(i,o.version.toTimestamp()),createTime:Ea(i,o.createTime.toTimestamp())}}(t.yt,e);else if(e.isNoDocument())r.noDocument={path:n.path.toArray(),readTime:Gi(e.version)};else{if(!e.isUnknownDocument())return oe(57904,{document:e});r.unknownDocument={path:n.path.toArray(),version:Gi(e.version)}}return r}function Yd(t){const e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function Gi(t){const e=t.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function Qi(t){const e=new $e(t.seconds,t.nanoseconds);return pe.fromTimestamp(e)}function vi(t,e){const n=(e.baseMutations||[]).map(i=>Qm(t.yt,i));for(let i=0;i<e.mutations.length-1;++i){const o=e.mutations[i];if(i+1<e.mutations.length&&e.mutations[i+1].transform!==void 0){const a=e.mutations[i+1];o.updateTransforms=a.transform.fieldTransforms,e.mutations.splice(i+1,1),++i}}const r=e.mutations.map(i=>Qm(t.yt,i)),s=$e.fromMillis(e.localWriteTimeMs);return new Oy(e.batchId,s,n,r)}function _l(t){const e=Qi(t.readTime),n=t.lastLimboFreeSnapshotVersion!==void 0?Qi(t.lastLimboFreeSnapshotVersion):pe.min();let r;return r=function(i){return i.documents!==void 0}(t.query)?function(i){const o=i.documents.length;return le(o===1,1966,{count:o}),Kn(Dc(Qb(i.documents[0])))}(t.query):function(i){return Kn(Jb(i))}(t.query),new Br(r,t.targetId,"TargetPurposeListen",t.lastListenSequenceNumber,e,n,Pt.fromBase64String(t.resumeToken))}function rC(t,e){const n=Gi(e.snapshotVersion),r=Gi(e.lastLimboFreeSnapshotVersion);let s;s=Hd(e.target)?Xb(t.yt,e.target):Uy(t.yt,e.target).ft;const i=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Wi(e.target),readTime:n,resumeToken:i,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:s}}function sC(t){const e=Jb({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?Kd(e,e.limit,"L"):e}function hp(t,e){return new Ly(e.largestBatchId,Qm(t.yt,e.overlayMutation))}function KE(t,e){const n=e.path.lastSegment();return[t,ln(e.path.popLast()),n]}function GE(t,e,n,r){return{indexId:t,uid:e,sequenceNumber:n,readTime:Gi(r.readTime),documentKey:ln(r.documentKey.path),largestBatchId:r.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jV{getBundleMetadata(e,n){return QE(e).get(n).next(r=>{if(r)return function(i){return{id:i.bundleId,createTime:Qi(i.createTime),version:i.version}}(r)})}saveBundleMetadata(e,n){return QE(e).put(function(s){return{bundleId:s.id,createTime:Gi(mn(s.createTime)),version:s.version}}(n))}getNamedQuery(e,n){return YE(e).get(n).next(r=>{if(r)return function(i){return{name:i.name,query:sC(i.bundledQuery),readTime:Qi(i.readTime)}}(r)})}saveNamedQuery(e,n){return YE(e).put(function(s){return{name:s.name,readTime:Gi(mn(s.readTime)),bundledQuery:s.bundledQuery}}(n))}}function QE(t){return Lt(t,Mh)}function YE(t){return Lt(t,Fh)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yh{constructor(e,n){this.serializer=e,this.userId=n}static wt(e,n){const r=n.uid||"";return new Yh(e,r)}getOverlay(e,n){return nl(e).get(KE(this.userId,n)).next(r=>r?hp(this.serializer,r):null)}getOverlays(e,n){const r=br();return O.forEach(n,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,n,r){const s=[];return r.forEach((i,o)=>{const a=new Ly(n,o);s.push(this.St(e,a))}),O.waitFor(s)}removeOverlaysForBatchId(e,n,r){const s=new Set;n.forEach(o=>s.add(ln(o.getCollectionPath())));const i=[];return s.forEach(o=>{const a=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,r+1],!1,!0);i.push(nl(e).Z(Mm,a))}),O.waitFor(i)}getOverlaysForCollection(e,n,r){const s=br(),i=ln(n),o=IDBKeyRange.bound([this.userId,i,r],[this.userId,i,Number.POSITIVE_INFINITY],!0);return nl(e).J(Mm,o).next(a=>{for(const l of a){const d=hp(this.serializer,l);s.set(d.getKey(),d)}return s})}getOverlaysForCollectionGroup(e,n,r,s){const i=br();let o;const a=IDBKeyRange.bound([this.userId,n,r],[this.userId,n,Number.POSITIVE_INFINITY],!0);return nl(e).ee({index:ob,range:a},(l,d,h)=>{const f=hp(this.serializer,d);i.size()<s||f.largestBatchId===o?(i.set(f.getKey(),f),o=f.largestBatchId):h.done()}).next(()=>i)}St(e,n){return nl(e).put(function(s,i,o){const[a,l,d]=KE(i,o.mutation.key);return{userId:i,collectionPath:l,documentId:d,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:Qd(s.yt,o.mutation)}}(this.serializer,this.userId,n))}}function nl(t){return Lt(t,Uh)}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OV{bt(e){return Lt(e,Ay)}getSessionToken(e){return this.bt(e).get("sessionToken").next(n=>{const r=n==null?void 0:n.value;return r?Pt.fromUint8Array(r):Pt.EMPTY_BYTE_STRING})}setSessionToken(e,n){return this.bt(e).put({name:"sessionToken",value:n.toUint8Array()})}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wi{constructor(){}Dt(e,n){this.Ct(e,n),n.vt()}Ct(e,n){if("nullValue"in e)this.Ft(n,5);else if("booleanValue"in e)this.Ft(n,10),n.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(n,15),n.Mt(ct(e.integerValue));else if("doubleValue"in e){const r=ct(e.doubleValue);isNaN(r)?this.Ft(n,13):(this.Ft(n,15),uc(r)?n.Mt(0):n.Mt(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Ft(n,20),typeof r=="string"&&(r=Zr(r)),n.xt(`${r.seconds||""}`),n.Mt(r.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,n),this.Nt(n);else if("bytesValue"in e)this.Ft(n,30),n.Bt(es(e.bytesValue)),this.Nt(n);else if("referenceValue"in e)this.Lt(e.referenceValue,n);else if("geoPointValue"in e){const r=e.geoPointValue;this.Ft(n,45),n.Mt(r.latitude||0),n.Mt(r.longitude||0)}else"mapValue"in e?_b(e)?this.Ft(n,Number.MAX_SAFE_INTEGER):zh(e)?this.kt(e.mapValue,n):(this.qt(e.mapValue,n),this.Nt(n)):"arrayValue"in e?(this.Qt(e.arrayValue,n),this.Nt(n)):oe(19022,{$t:e})}Ot(e,n){this.Ft(n,25),this.Ut(e,n)}Ut(e,n){n.xt(e)}qt(e,n){const r=e.fields||{};this.Ft(n,55);for(const s of Object.keys(r))this.Ot(s,n),this.Ct(r[s],n)}kt(e,n){var o,a;const r=e.fields||{};this.Ft(n,53);const s=ma,i=((a=(o=r[s].arrayValue)==null?void 0:o.values)==null?void 0:a.length)||0;this.Ft(n,15),n.Mt(ct(i)),this.Ot(s,n),this.Ct(r[s],n)}Qt(e,n){const r=e.values||[];this.Ft(n,50);for(const s of r)this.Ct(s,n)}Lt(e,n){this.Ft(n,37),X.fromName(e).path.forEach(r=>{this.Ft(n,60),this.Ut(r,n)})}Ft(e,n){e.Mt(n)}Nt(e){e.Mt(2)}}wi.Kt=new wi;/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law | agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES | CONDITIONS OF ANY KIND, either express | implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mo=255;function VV(t){if(t===0)return 8;let e=0;return t>>4||(e+=4,t<<=4),t>>6||(e+=2,t<<=2),t>>7||(e+=1),e}function XE(t){const e=64-function(r){let s=0;for(let i=0;i<8;++i){const o=VV(255&r[i]);if(s+=o,o!==8)break}return s}(t);return Math.ceil(e/8)}class LV{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Wt(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.Gt(r.value),r=n.next();this.zt()}jt(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.Jt(r.value),r=n.next();this.Ht()}Yt(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.Gt(r);else if(r<2048)this.Gt(960|r>>>6),this.Gt(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Gt(480|r>>>12),this.Gt(128|63&r>>>6),this.Gt(128|63&r);else{const s=n.codePointAt(0);this.Gt(240|s>>>18),this.Gt(128|63&s>>>12),this.Gt(128|63&s>>>6),this.Gt(128|63&s)}}this.zt()}Zt(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.Jt(r);else if(r<2048)this.Jt(960|r>>>6),this.Jt(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Jt(480|r>>>12),this.Jt(128|63&r>>>6),this.Jt(128|63&r);else{const s=n.codePointAt(0);this.Jt(240|s>>>18),this.Jt(128|63&s>>>12),this.Jt(128|63&s>>>6),this.Jt(128|63&s)}}this.Ht()}Xt(e){const n=this.en(e),r=XE(n);this.tn(1+r),this.buffer[this.position++]=255&r;for(let s=n.length-r;s<n.length;++s)this.buffer[this.position++]=255&n[s]}nn(e){const n=this.en(e),r=XE(n);this.tn(1+r),this.buffer[this.position++]=~(255&r);for(let s=n.length-r;s<n.length;++s)this.buffer[this.position++]=~(255&n[s])}rn(){this.sn(mo),this.sn(255)}_n(){this.an(mo),this.an(255)}reset(){this.position=0}seed(e){this.tn(e.length),this.buffer.set(e,this.position),this.position+=e.length}un(){return this.buffer.slice(0,this.position)}en(e){const n=function(i){const o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,i,!1),new Uint8Array(o.buffer)}(e),r=!!(128&n[0]);n[0]^=r?255:128;for(let s=1;s<n.length;++s)n[s]^=r?255:0;return n}Gt(e){const n=255&e;n===0?(this.sn(0),this.sn(255)):n===mo?(this.sn(mo),this.sn(0)):this.sn(n)}Jt(e){const n=255&e;n===0?(this.an(0),this.an(255)):n===mo?(this.an(mo),this.an(0)):this.an(e)}zt(){this.sn(0),this.sn(1)}Ht(){this.an(0),this.an(1)}sn(e){this.tn(1),this.buffer[this.position++]=e}an(e){this.tn(1),this.buffer[this.position++]=~e}tn(e){const n=e+this.position;if(n<=this.buffer.length)return;let r=2*this.buffer.length;r<n&&(r=n);const s=new Uint8Array(r);s.set(this.buffer),this.buffer=s}}class MV{constructor(e){this.cn=e}Bt(e){this.cn.Wt(e)}xt(e){this.cn.Yt(e)}Mt(e){this.cn.Xt(e)}vt(){this.cn.rn()}}class FV{constructor(e){this.cn=e}Bt(e){this.cn.jt(e)}xt(e){this.cn.Zt(e)}Mt(e){this.cn.nn(e)}vt(){this.cn._n()}}class rl{constructor(){this.cn=new LV,this.ln=new MV(this.cn),this.hn=new FV(this.cn)}seed(e){this.cn.seed(e)}Pn(e){return e===0?this.ln:this.hn}un(){return this.cn.un()}reset(){this.cn.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ei{constructor(e,n,r,s){this.Tn=e,this.In=n,this.En=r,this.dn=s}An(){const e=this.dn.length,n=e===0||this.dn[e-1]===255?e+1:e,r=new Uint8Array(n);return r.set(this.dn,0),n!==e?r.set([0],this.dn.length):++r[r.length-1],new Ei(this.Tn,this.In,this.En,r)}Rn(e,n,r){return{indexId:this.Tn,uid:e,arrayValue:rd(this.En),directionalValue:rd(this.dn),orderedDocumentKey:rd(n),documentKey:r.path.toArray()}}Vn(e,n,r){const s=this.Rn(e,n,r);return[s.indexId,s.uid,s.arrayValue,s.directionalValue,s.orderedDocumentKey,s.documentKey]}}function ps(t,e){let n=t.Tn-e.Tn;return n!==0?n:(n=JE(t.En,e.En),n!==0?n:(n=JE(t.dn,e.dn),n!==0?n:X.comparator(t.In,e.In)))}function JE(t,e){for(let n=0;n<t.length&&n<e.length;++n){const r=t[n]-e[n];if(r!==0)return r}return t.length-e.length}function rd(t){return Jx()?function(n){let r="";for(let s=0;s<n.length;s++)r+=String.fromCharCode(n[s]);return r}(t):t}function ZE(t){return typeof t!="string"?t:function(n){const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}(t)}class eI{constructor(e){this.mn=new Je((n,r)=>mt.comparator(n.field,r.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.fn=e.orderBy,this.gn=[];for(const n of e.filters){const r=n;r.isInequality()?this.mn=this.mn.add(r):this.gn.push(r)}}get pn(){return this.mn.size>1}yn(e){if(le(e.collectionGroup===this.collectionId,49279),this.pn)return!1;const n=Om(e);if(n!==void 0&&!this.wn(n))return!1;const r=gi(e);let s=new Set,i=0,o=0;for(;i<r.length&&this.wn(r[i]);++i)s=s.add(r[i].fieldPath.canonicalString());if(i===r.length)return!0;if(this.mn.size>0){const a=this.mn.getIterator().getNext();if(!s.has(a.field.canonicalString())){const l=r[i];if(!this.Sn(a,l)||!this.bn(this.fn[o++],l))return!1}++i}for(;i<r.length;++i){const a=r[i];if(o>=this.fn.length||!this.bn(this.fn[o++],a))return!1}return!0}Dn(){if(this.pn)return null;let e=new Je(mt.comparator);const n=[];for(const r of this.gn)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")n.push(new Qu(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),n.push(new Qu(r.field,0))}for(const r of this.fn)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),n.push(new Qu(r.field,r.dir==="asc"?0:1)));return new Ud(Ud.UNKNOWN_ID,this.collectionId,n,cc.empty())}wn(e){for(const n of this.gn)if(this.Sn(n,e))return!0;return!1}Sn(e,n){if(e===void 0||!e.field.isEqual(n.fieldPath))return!1;const r=e.op==="array-contains"||e.op==="array-contains-any";return n.kind===2===r}bn(e,n){return!!e.field.isEqual(n.fieldPath)&&(n.kind===0&&e.dir==="asc"||n.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iC(t){var n,r;if(le(t instanceof je||t instanceof Ye,20012),t instanceof je){if(t instanceof Cb){const s=((r=(n=t.value.arrayValue)==null?void 0:n.values)==null?void 0:r.map(i=>je.create(t.field,"==",i)))||[];return Ye.create(s,"or")}return t}const e=t.filters.map(s=>iC(s));return Ye.create(e,t.op)}function UV(t){if(t.getFilters().length===0)return[];const e=Jm(iC(t));return le(oC(e),7391),Ym(e)||Xm(e)?[e]:e.getFilters()}function Ym(t){return t instanceof je}function Xm(t){return t instanceof Ye&&ky(t)}function oC(t){return Ym(t)||Xm(t)||function(n){if(n instanceof Ye&&Bm(n)){for(const r of n.getFilters())if(!Ym(r)&&!Xm(r))return!1;return!0}return!1}(t)}function Jm(t){if(le(t instanceof je||t instanceof Ye,34018),t instanceof je)return t;if(t.filters.length===1)return Jm(t.filters[0]);const e=t.filters.map(r=>Jm(r));let n=Ye.create(e,t.op);return n=Xd(n),oC(n)?n:(le(n instanceof Ye,64498),le(ya(n),40251),le(n.filters.length>1,57927),n.filters.reduce((r,s)=>$y(r,s)))}function $y(t,e){let n;return le(t instanceof je||t instanceof Ye,38388),le(e instanceof je||e instanceof Ye,25473),n=t instanceof je?e instanceof je?function(s,i){return Ye.create([s,i],"and")}(t,e):tI(t,e):e instanceof je?tI(e,t):function(s,i){if(le(s.filters.length>0&&i.filters.length>0,48005),ya(s)&&ya(i))return xb(s,i.getFilters());const o=Bm(s)?s:i,a=Bm(s)?i:s,l=o.filters.map(d=>$y(d,a));return Ye.create(l,"or")}(t,e),Xd(n)}function tI(t,e){if(ya(e))return xb(e,t.getFilters());{const n=e.filters.map(r=>$y(t,r));return Ye.create(n,"or")}}function Xd(t){if(le(t instanceof je||t instanceof Ye,11850),t instanceof je)return t;const e=t.getFilters();if(e.length===1)return Xd(e[0]);if(Ib(t))return t;const n=e.map(s=>Xd(s)),r=[];return n.forEach(s=>{s instanceof je?r.push(s):s instanceof Ye&&(s.op===t.op?r.push(...s.filters):r.push(s))}),r.length===1?r[0]:Ye.create(r,t.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $V{constructor(){this.Cn=new By}addToCollectionParentIndex(e,n){return this.Cn.add(n),O.resolve()}getCollectionParents(e,n){return O.resolve(this.Cn.getEntries(n))}addFieldIndex(e,n){return O.resolve()}deleteFieldIndex(e,n){return O.resolve()}deleteAllFieldIndexes(e){return O.resolve()}createTargetIndexes(e,n){return O.resolve()}getDocumentsMatchingTarget(e,n){return O.resolve(null)}getIndexType(e,n){return O.resolve(0)}getFieldIndexes(e,n){return O.resolve([])}getNextCollectionGroupToUpdate(e){return O.resolve(null)}getMinOffset(e,n){return O.resolve(Vn.min())}getMinOffsetFromCollectionGroup(e,n){return O.resolve(Vn.min())}updateCollectionGroup(e,n,r){return O.resolve()}updateIndexEntries(e,n){return O.resolve()}}class By{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n]||new Je(ze.comparator),i=!s.has(r);return this.index[n]=s.add(r),i}has(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n];return s&&s.has(r)}getEntries(e){return(this.index[e]||new Je(ze.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nI="IndexedDbIndexManager",Eu=new Uint8Array(0);class BV{constructor(e,n){this.databaseId=n,this.vn=new By,this.Fn=new rs(r=>Wi(r),(r,s)=>kc(r,s)),this.uid=e.uid||""}addToCollectionParentIndex(e,n){if(!this.vn.has(n)){const r=n.lastSegment(),s=n.popLast();e.addOnCommittedListener(()=>{this.vn.add(n)});const i={collectionId:r,parent:ln(s)};return rI(e).put(i)}return O.resolve()}getCollectionParents(e,n){const r=[],s=IDBKeyRange.bound([n,""],[GS(n),""],!1,!0);return rI(e).J(s).next(i=>{for(const o of i){if(o.collectionId!==n)break;r.push(Sr(o.parent))}return r})}addFieldIndex(e,n){const r=sl(e),s=function(a){return{indexId:a.indexId,collectionGroup:a.collectionGroup,fields:a.fields.map(l=>[l.fieldPath.canonicalString(),l.kind])}}(n);delete s.indexId;const i=r.add(s);if(n.indexState){const o=yo(e);return i.next(a=>{o.put(GE(a,this.uid,n.indexState.sequenceNumber,n.indexState.offset))})}return i.next()}deleteFieldIndex(e,n){const r=sl(e),s=yo(e),i=go(e);return r.delete(n.indexId).next(()=>s.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0))).next(()=>i.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){const n=sl(e),r=go(e),s=yo(e);return n.Z().next(()=>r.Z()).next(()=>s.Z())}createTargetIndexes(e,n){return O.forEach(this.Mn(n),r=>this.getIndexType(e,r).next(s=>{if(s===0||s===1){const i=new eI(r).Dn();if(i!=null)return this.addFieldIndex(e,i)}}))}getDocumentsMatchingTarget(e,n){const r=go(e);let s=!0;const i=new Map;return O.forEach(this.Mn(n),o=>this.xn(e,o).next(a=>{s&&(s=!!a),i.set(o,a)})).next(()=>{if(s){let o=Ae();const a=[];return O.forEach(i,(l,d)=>{q(nI,`Using index ${function(y){return`id=${y.indexId}|cg=${y.collectionGroup}|f=${y.fields.map(j=>`${j.fieldPath}:${j.kind}`).join(",")}`}(l)} to execute ${Wi(n)}`);const h=function(y,j){const V=Om(j);if(V===void 0)return null;for(const M of Wd(y,V.fieldPath))switch(M.op){case"array-contains-any":return M.value.arrayValue.values||[];case"array-contains":return[M.value]}return null}(d,l),f=function(y,j){const V=new Map;for(const M of gi(j))for(const T of Wd(y,M.fieldPath))switch(T.op){case"==":case"in":V.set(M.fieldPath.canonicalString(),T.value);break;case"not-in":case"!=":return V.set(M.fieldPath.canonicalString(),T.value),Array.from(V.values())}return null}(d,l),m=function(y,j){const V=[];let M=!0;for(const T of gi(j)){const _=T.kind===0?jE(y,T.fieldPath,y.startAt):OE(y,T.fieldPath,y.startAt);V.push(_.value),M&&(M=_.inclusive)}return new Qs(V,M)}(d,l),w=function(y,j){const V=[];let M=!0;for(const T of gi(j)){const _=T.kind===0?OE(y,T.fieldPath,y.endAt):jE(y,T.fieldPath,y.endAt);V.push(_.value),M&&(M=_.inclusive)}return new Qs(V,M)}(d,l),A=this.On(l,d,m),b=this.On(l,d,w),P=this.Nn(l,d,f),I=this.Bn(l.indexId,h,A,m.inclusive,b,w.inclusive,P);return O.forEach(I,E=>r.Y(E,n.limit).next(y=>{y.forEach(j=>{const V=X.fromSegments(j.documentKey);o.has(V)||(o=o.add(V),a.push(V))})}))}).next(()=>a)}return O.resolve(null)})}Mn(e){let n=this.Fn.get(e);return n||(e.filters.length===0?n=[e]:n=UV(Ye.create(e.filters,"and")).map(r=>qm(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.Fn.set(e,n),n)}Bn(e,n,r,s,i,o,a){const l=(n!=null?n.length:1)*Math.max(r.length,i.length),d=l/(n!=null?n.length:1),h=[];for(let f=0;f<l;++f){const m=n?this.Ln(n[f/d]):Eu,w=this.kn(e,m,r[f%d],s),A=this.qn(e,m,i[f%d],o),b=a.map(P=>this.kn(e,m,P,!0));h.push(...this.createRange(w,A,b))}return h}kn(e,n,r,s){const i=new Ei(e,X.empty(),n,r);return s?i:i.An()}qn(e,n,r,s){const i=new Ei(e,X.empty(),n,r);return s?i.An():i}xn(e,n){const r=new eI(n),s=n.collectionGroup!=null?n.collectionGroup:n.path.lastSegment();return this.getFieldIndexes(e,s).next(i=>{let o=null;for(const a of i)r.yn(a)&&(!o||a.fields.length>o.fields.length)&&(o=a);return o})}getIndexType(e,n){let r=2;const s=this.Mn(n);return O.forEach(s,i=>this.xn(e,i).next(o=>{o?r!==0&&o.fields.length<function(l){let d=new Je(mt.comparator),h=!1;for(const f of l.filters)for(const m of f.getFlattenedFilters())m.field.isKeyField()||(m.op==="array-contains"||m.op==="array-contains-any"?h=!0:d=d.add(m.field));for(const f of l.orderBy)f.field.isKeyField()||(d=d.add(f.field));return d.size+(h?1:0)}(i)&&(r=1):r=0})).next(()=>function(o){return o.limit!==null}(n)&&s.length>1&&r===2?1:r)}Qn(e,n){const r=new rl;for(const s of gi(e)){const i=n.data.field(s.fieldPath);if(i==null)return null;const o=r.Pn(s.kind);wi.Kt.Dt(i,o)}return r.un()}Ln(e){const n=new rl;return wi.Kt.Dt(e,n.Pn(0)),n.un()}$n(e,n){const r=new rl;return wi.Kt.Dt(Hi(this.databaseId,n),r.Pn(function(i){const o=gi(i);return o.length===0?0:o[o.length-1].kind}(e))),r.un()}Nn(e,n,r){if(r===null)return[];let s=[];s.push(new rl);let i=0;for(const o of gi(e)){const a=r[i++];for(const l of s)if(this.Un(n,o.fieldPath)&&gc(a))s=this.Kn(s,o,a);else{const d=l.Pn(o.kind);wi.Kt.Dt(a,d)}}return this.Wn(s)}On(e,n,r){return this.Nn(e,n,r.position)}Wn(e){const n=[];for(let r=0;r<e.length;++r)n[r]=e[r].un();return n}Kn(e,n,r){const s=[...e],i=[];for(const o of r.arrayValue.values||[])for(const a of s){const l=new rl;l.seed(a.un()),wi.Kt.Dt(o,l.Pn(n.kind)),i.push(l)}return i}Un(e,n){return!!e.filters.find(r=>r instanceof je&&r.field.isEqual(n)&&(r.op==="in"||r.op==="not-in"))}getFieldIndexes(e,n){const r=sl(e),s=yo(e);return(n?r.J(Lm,IDBKeyRange.bound(n,n)):r.J()).next(i=>{const o=[];return O.forEach(i,a=>s.get([a.indexId,this.uid]).next(l=>{o.push(function(h,f){const m=f?new cc(f.sequenceNumber,new Vn(Qi(f.readTime),new X(Sr(f.documentKey)),f.largestBatchId)):cc.empty(),w=h.fields.map(([A,b])=>new Qu(mt.fromServerFormat(A),b));return new Ud(h.indexId,h.collectionGroup,w,m)}(a,l))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(n=>n.length===0?null:(n.sort((r,s)=>{const i=r.indexState.sequenceNumber-s.indexState.sequenceNumber;return i!==0?i:xe(r.collectionGroup,s.collectionGroup)}),n[0].collectionGroup))}updateCollectionGroup(e,n,r){const s=sl(e),i=yo(e);return this.Gn(e).next(o=>s.J(Lm,IDBKeyRange.bound(n,n)).next(a=>O.forEach(a,l=>i.put(GE(l.indexId,this.uid,o,r)))))}updateIndexEntries(e,n){const r=new Map;return O.forEach(n,(s,i)=>{const o=r.get(s.collectionGroup);return(o?O.resolve(o):this.getFieldIndexes(e,s.collectionGroup)).next(a=>(r.set(s.collectionGroup,a),O.forEach(a,l=>this.zn(e,s,l).next(d=>{const h=this.jn(i,l);return d.isEqual(h)?O.resolve():this.Jn(e,i,l,d,h)}))))})}Hn(e,n,r,s){return go(e).put(s.Rn(this.uid,this.$n(r,n.key),n.key))}Yn(e,n,r,s){return go(e).delete(s.Vn(this.uid,this.$n(r,n.key),n.key))}zn(e,n,r){const s=go(e);let i=new Je(ps);return s.ee({index:ib,range:IDBKeyRange.only([r.indexId,this.uid,rd(this.$n(r,n))])},(o,a)=>{i=i.add(new Ei(r.indexId,n,ZE(a.arrayValue),ZE(a.directionalValue)))}).next(()=>i)}jn(e,n){let r=new Je(ps);const s=this.Qn(n,e);if(s==null)return r;const i=Om(n);if(i!=null){const o=e.data.field(i.fieldPath);if(gc(o))for(const a of o.arrayValue.values||[])r=r.add(new Ei(n.indexId,e.key,this.Ln(a),s))}else r=r.add(new Ei(n.indexId,e.key,Eu,s));return r}Jn(e,n,r,s,i){q(nI,"Updating index entries for document '%s'",n.key);const o=[];return function(l,d,h,f,m){const w=l.getIterator(),A=d.getIterator();let b=po(w),P=po(A);for(;b||P;){let I=!1,E=!1;if(b&&P){const y=h(b,P);y<0?E=!0:y>0&&(I=!0)}else b!=null?E=!0:I=!0;I?(f(P),P=po(A)):E?(m(b),b=po(w)):(b=po(w),P=po(A))}}(s,i,ps,a=>{o.push(this.Hn(e,n,r,a))},a=>{o.push(this.Yn(e,n,r,a))}),O.waitFor(o)}Gn(e){let n=1;return yo(e).ee({index:sb,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,s,i)=>{i.done(),n=s.sequenceNumber+1}).next(()=>n)}createRange(e,n,r){r=r.sort((o,a)=>ps(o,a)).filter((o,a,l)=>!a||ps(o,l[a-1])!==0);const s=[];s.push(e);for(const o of r){const a=ps(o,e),l=ps(o,n);if(a===0)s[0]=e.An();else if(a>0&&l<0)s.push(o),s.push(o.An());else if(l>0)break}s.push(n);const i=[];for(let o=0;o<s.length;o+=2){if(this.Zn(s[o],s[o+1]))return[];const a=s[o].Vn(this.uid,Eu,X.empty()),l=s[o+1].Vn(this.uid,Eu,X.empty());i.push(IDBKeyRange.bound(a,l))}return i}Zn(e,n){return ps(e,n)>0}getMinOffsetFromCollectionGroup(e,n){return this.getFieldIndexes(e,n).next(sI)}getMinOffset(e,n){return O.mapArray(this.Mn(n),r=>this.xn(e,r).next(s=>s||oe(44426))).next(sI)}}function rI(t){return Lt(t,fc)}function go(t){return Lt(t,Vl)}function sl(t){return Lt(t,Cy)}function yo(t){return Lt(t,Ol)}function sI(t){le(t.length!==0,28825);let e=t[0].indexState.offset,n=e.largestBatchId;for(let r=1;r<t.length;r++){const s=t[r].indexState.offset;xy(s,e)<0&&(e=s),n<s.largestBatchId&&(n=s.largestBatchId)}return new Vn(e.readTime,e.documentKey,n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iI={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},aC=41943040;class nn{static withCacheSize(e){return new nn(e,nn.DEFAULT_COLLECTION_PERCENTILE,nn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lC(t,e,n){const r=t.store(nr),s=t.store(da),i=[],o=IDBKeyRange.only(n.batchId);let a=0;const l=r.ee({range:o},(h,f,m)=>(a++,m.delete()));i.push(l.next(()=>{le(a===1,47070,{batchId:n.batchId})}));const d=[];for(const h of n.mutations){const f=tb(e,h.key.path,n.batchId);i.push(s.delete(f)),d.push(h.key)}return O.waitFor(i).next(()=>d)}function Jd(t){if(!t)return 0;let e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw oe(14731);e=t.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */nn.DEFAULT_COLLECTION_PERCENTILE=10,nn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,nn.DEFAULT=new nn(aC,nn.DEFAULT_COLLECTION_PERCENTILE,nn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),nn.DISABLED=new nn(-1,0,0);class Xh{constructor(e,n,r,s){this.userId=e,this.serializer=n,this.indexManager=r,this.referenceDelegate=s,this.Xn={}}static wt(e,n,r,s){le(e.uid!=="",64387);const i=e.isAuthenticated()?e.uid:"";return new Xh(i,n,r,s)}checkEmpty(e){let n=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return ms(e).ee({index:bi,range:r},(s,i,o)=>{n=!1,o.done()}).next(()=>n)}addMutationBatch(e,n,r,s){const i=Ao(e),o=ms(e);return o.add({}).next(a=>{le(typeof a=="number",49019);const l=new Oy(a,n,r,s),d=function(w,A,b){const P=b.baseMutations.map(E=>Qd(w.yt,E)),I=b.mutations.map(E=>Qd(w.yt,E));return{userId:A,batchId:b.batchId,localWriteTimeMs:b.localWriteTime.toMillis(),baseMutations:P,mutations:I}}(this.serializer,this.userId,l),h=[];let f=new Je((m,w)=>xe(m.canonicalString(),w.canonicalString()));for(const m of s){const w=tb(this.userId,m.key.path,a);f=f.add(m.key.path.popLast()),h.push(o.put(d)),h.push(i.put(w,mO))}return f.forEach(m=>{h.push(this.indexManager.addToCollectionParentIndex(e,m))}),e.addOnCommittedListener(()=>{this.Xn[a]=l.keys()}),O.waitFor(h).next(()=>l)})}lookupMutationBatch(e,n){return ms(e).get(n).next(r=>r?(le(r.userId===this.userId,48,"Unexpected user for mutation batch",{userId:r.userId,batchId:n}),vi(this.serializer,r)):null)}er(e,n){return this.Xn[n]?O.resolve(this.Xn[n]):this.lookupMutationBatch(e,n).next(r=>{if(r){const s=r.keys();return this.Xn[n]=s,s}return null})}getNextMutationBatchAfterBatchId(e,n){const r=n+1,s=IDBKeyRange.lowerBound([this.userId,r]);let i=null;return ms(e).ee({index:bi,range:s},(o,a,l)=>{a.userId===this.userId&&(le(a.batchId>=r,47524,{tr:r}),i=vi(this.serializer,a)),l.done()}).next(()=>i)}getHighestUnacknowledgedBatchId(e){const n=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=Pi;return ms(e).ee({index:bi,range:n,reverse:!0},(s,i,o)=>{r=i.batchId,o.done()}).next(()=>r)}getAllMutationBatches(e){const n=IDBKeyRange.bound([this.userId,Pi],[this.userId,Number.POSITIVE_INFINITY]);return ms(e).J(bi,n).next(r=>r.map(s=>vi(this.serializer,s)))}getAllMutationBatchesAffectingDocumentKey(e,n){const r=Yu(this.userId,n.path),s=IDBKeyRange.lowerBound(r),i=[];return Ao(e).ee({range:s},(o,a,l)=>{const[d,h,f]=o,m=Sr(h);if(d===this.userId&&n.path.isEqual(m))return ms(e).get(f).next(w=>{if(!w)throw oe(61480,{nr:o,batchId:f});le(w.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:w.userId,batchId:f}),i.push(vi(this.serializer,w))});l.done()}).next(()=>i)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Je(xe);const s=[];return n.forEach(i=>{const o=Yu(this.userId,i.path),a=IDBKeyRange.lowerBound(o),l=Ao(e).ee({range:a},(d,h,f)=>{const[m,w,A]=d,b=Sr(w);m===this.userId&&i.path.isEqual(b)?r=r.add(A):f.done()});s.push(l)}),O.waitFor(s).next(()=>this.rr(e,r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,s=r.length+1,i=Yu(this.userId,r),o=IDBKeyRange.lowerBound(i);let a=new Je(xe);return Ao(e).ee({range:o},(l,d,h)=>{const[f,m,w]=l,A=Sr(m);f===this.userId&&r.isPrefixOf(A)?A.length===s&&(a=a.add(w)):h.done()}).next(()=>this.rr(e,a))}rr(e,n){const r=[],s=[];return n.forEach(i=>{s.push(ms(e).get(i).next(o=>{if(o===null)throw oe(35274,{batchId:i});le(o.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:o.userId,batchId:i}),r.push(vi(this.serializer,o))}))}),O.waitFor(s).next(()=>r)}removeMutationBatch(e,n){return lC(e.le,this.userId,n).next(r=>(e.addOnCommittedListener(()=>{this.ir(n.batchId)}),O.forEach(r,s=>this.referenceDelegate.markPotentiallyOrphaned(e,s))))}ir(e){delete this.Xn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(n=>{if(!n)return O.resolve();const r=IDBKeyRange.lowerBound(function(o){return[o]}(this.userId)),s=[];return Ao(e).ee({range:r},(i,o,a)=>{if(i[0]===this.userId){const l=Sr(i[1]);s.push(l)}else a.done()}).next(()=>{le(s.length===0,56720,{sr:s.map(i=>i.canonicalString())})})})}containsKey(e,n){return cC(e,this.userId,n)}_r(e){return uC(e).get(this.userId).next(n=>n||{userId:this.userId,lastAcknowledgedBatchId:Pi,lastStreamToken:""})}}function cC(t,e,n){const r=Yu(e,n.path),s=r[1],i=IDBKeyRange.lowerBound(r);let o=!1;return Ao(t).ee({range:i,X:!0},(a,l,d)=>{const[h,f,m]=a;h===e&&f===s&&(o=!0),d.done()}).next(()=>o)}function ms(t){return Lt(t,nr)}function Ao(t){return Lt(t,da)}function uC(t){return Lt(t,dc)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yi{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new Yi(0)}static cr(){return new Yi(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zV{constructor(e,n){this.referenceDelegate=e,this.serializer=n}allocateTargetId(e){return this.lr(e).next(n=>{const r=new Yi(n.highestTargetId);return n.highestTargetId=r.next(),this.hr(e,n).next(()=>n.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.lr(e).next(n=>pe.fromTimestamp(new $e(n.lastRemoteSnapshotVersion.seconds,n.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.lr(e).next(n=>n.highestListenSequenceNumber)}setTargetsMetadata(e,n,r){return this.lr(e).next(s=>(s.highestListenSequenceNumber=n,r&&(s.lastRemoteSnapshotVersion=r.toTimestamp()),n>s.highestListenSequenceNumber&&(s.highestListenSequenceNumber=n),this.hr(e,s)))}addTargetData(e,n){return this.Pr(e,n).next(()=>this.lr(e).next(r=>(r.targetCount+=1,this.Tr(n,r),this.hr(e,r))))}updateTargetData(e,n){return this.Pr(e,n)}removeTargetData(e,n){return this.removeMatchingKeysForTargetId(e,n.targetId).next(()=>_o(e).delete(n.targetId)).next(()=>this.lr(e)).next(r=>(le(r.targetCount>0,8065),r.targetCount-=1,this.hr(e,r)))}removeTargets(e,n,r){let s=0;const i=[];return _o(e).ee((o,a)=>{const l=_l(a);l.sequenceNumber<=n&&r.get(l.targetId)===null&&(s++,i.push(this.removeTargetData(e,l)))}).next(()=>O.waitFor(i)).next(()=>s)}forEachTarget(e,n){return _o(e).ee((r,s)=>{const i=_l(s);n(i)})}lr(e){return oI(e).get(zd).next(n=>(le(n!==null,2888),n))}hr(e,n){return oI(e).put(zd,n)}Pr(e,n){return _o(e).put(rC(this.serializer,n))}Tr(e,n){let r=!1;return e.targetId>n.highestTargetId&&(n.highestTargetId=e.targetId,r=!0),e.sequenceNumber>n.highestListenSequenceNumber&&(n.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.lr(e).next(n=>n.targetCount)}getTargetData(e,n){const r=Wi(n),s=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let i=null;return _o(e).ee({range:s,index:rb},(o,a,l)=>{const d=_l(a);kc(n,d.target)&&(i=d,l.done())}).next(()=>i)}addMatchingKeys(e,n,r){const s=[],i=bs(e);return n.forEach(o=>{const a=ln(o.path);s.push(i.put({targetId:r,path:a})),s.push(this.referenceDelegate.addReference(e,r,o))}),O.waitFor(s)}removeMatchingKeys(e,n,r){const s=bs(e);return O.forEach(n,i=>{const o=ln(i.path);return O.waitFor([s.delete([r,o]),this.referenceDelegate.removeReference(e,r,i)])})}removeMatchingKeysForTargetId(e,n){const r=bs(e),s=IDBKeyRange.bound([n],[n+1],!1,!0);return r.delete(s)}getMatchingKeysForTargetId(e,n){const r=IDBKeyRange.bound([n],[n+1],!1,!0),s=bs(e);let i=Ae();return s.ee({range:r,X:!0},(o,a,l)=>{const d=Sr(o[1]),h=new X(d);i=i.add(h)}).next(()=>i)}containsKey(e,n){const r=ln(n.path),s=IDBKeyRange.bound([r],[GS(r)],!1,!0);let i=0;return bs(e).ee({index:by,X:!0,range:s},([o,a],l,d)=>{o!==0&&(i++,d.done())}).next(()=>i>0)}At(e,n){return _o(e).get(n).next(r=>r?_l(r):null)}}function _o(t){return Lt(t,ha)}function oI(t){return Lt(t,Ni)}function bs(t){return Lt(t,fa)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aI="LruGarbageCollector",qV=1048576;function lI([t,e],[n,r]){const s=xe(t,n);return s===0?xe(e,r):s}class HV{constructor(e){this.Ir=e,this.buffer=new Je(lI),this.Er=0}dr(){return++this.Er}Ar(e){const n=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(n);else{const r=this.buffer.last();lI(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}}class dC{constructor(e,n,r){this.garbageCollector=e,this.asyncQueue=n,this.localStore=r,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){q(aI,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){si(n)?q(aI,"Ignoring IndexedDB error during garbage collection: ",n):await oo(n)}await this.Vr(3e5)})}}class WV{constructor(e,n){this.mr=e,this.params=n}calculateTargetCount(e,n){return this.mr.gr(e).next(r=>Math.floor(n/100*r))}nthSequenceNumber(e,n){if(n===0)return O.resolve(Hn.ce);const r=new HV(n);return this.mr.forEachTarget(e,s=>r.Ar(s.sequenceNumber)).next(()=>this.mr.pr(e,s=>r.Ar(s))).next(()=>r.maxValue)}removeTargets(e,n,r){return this.mr.removeTargets(e,n,r)}removeOrphanedDocuments(e,n){return this.mr.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(q("LruGarbageCollector","Garbage collection skipped; disabled"),O.resolve(iI)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(q("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),iI):this.yr(e,n))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,n){let r,s,i,o,a,l,d;const h=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(f=>(f>this.params.maximumSequenceNumbersToCollect?(q("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${f}`),s=this.params.maximumSequenceNumbersToCollect):s=f,o=Date.now(),this.nthSequenceNumber(e,s))).next(f=>(r=f,a=Date.now(),this.removeTargets(e,r,n))).next(f=>(i=f,l=Date.now(),this.removeOrphanedDocuments(e,r))).next(f=>(d=Date.now(),So()<=De.DEBUG&&q("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-h}ms
	Determined least recently used ${s} in `+(a-o)+`ms
	Removed ${i} targets in `+(l-a)+`ms
	Removed ${f} documents in `+(d-l)+`ms
Total Duration: ${d-h}ms`),O.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:i,documentsRemoved:f})))}}function hC(t,e){return new WV(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KV{constructor(e,n){this.db=e,this.garbageCollector=hC(this,n)}gr(e){const n=this.wr(e);return this.db.getTargetCache().getTargetCount(e).next(r=>n.next(s=>r+s))}wr(e){let n=0;return this.pr(e,r=>{n++}).next(()=>n)}forEachTarget(e,n){return this.db.getTargetCache().forEachTarget(e,n)}pr(e,n){return this.Sr(e,(r,s)=>n(s))}addReference(e,n,r){return Iu(e,r)}removeReference(e,n,r){return Iu(e,r)}removeTargets(e,n,r){return this.db.getTargetCache().removeTargets(e,n,r)}markPotentiallyOrphaned(e,n){return Iu(e,n)}br(e,n){return function(s,i){let o=!1;return uC(s).te(a=>cC(s,a,i).next(l=>(l&&(o=!0),O.resolve(!l)))).next(()=>o)}(e,n)}removeOrphanedDocuments(e,n){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),s=[];let i=0;return this.Sr(e,(o,a)=>{if(a<=n){const l=this.br(e,o).next(d=>{if(!d)return i++,r.getEntry(e,o).next(()=>(r.removeEntry(o,pe.min()),bs(e).delete(function(f){return[0,ln(f.path)]}(o))))});s.push(l)}}).next(()=>O.waitFor(s)).next(()=>r.apply(e)).next(()=>i)}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,n){return Iu(e,n)}Sr(e,n){const r=bs(e);let s,i=Hn.ce;return r.ee({index:by},([o,a],{path:l,sequenceNumber:d})=>{o===0?(i!==Hn.ce&&n(new X(Sr(s)),i),i=d,s=l):i=Hn.ce}).next(()=>{i!==Hn.ce&&n(new X(Sr(s)),i)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function Iu(t,e){return bs(t).put(function(r,s){return{targetId:0,path:ln(r.path),sequenceNumber:s}}(e,t.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fC{constructor(){this.changes=new rs(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,wt.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?O.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GV{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,n,r){return di(e).put(r)}removeEntry(e,n,r){return di(e).delete(function(i,o){const a=i.path.toArray();return[a.slice(0,a.length-2),a[a.length-2],Yd(o),a[a.length-1]]}(n,r))}updateMetadata(e,n){return this.getMetadata(e).next(r=>(r.byteSize+=n,this.Dr(e,r)))}getEntry(e,n){let r=wt.newInvalidDocument(n);return di(e).ee({index:Xu,range:IDBKeyRange.only(il(n))},(s,i)=>{r=this.Cr(n,i)}).next(()=>r)}vr(e,n){let r={size:0,document:wt.newInvalidDocument(n)};return di(e).ee({index:Xu,range:IDBKeyRange.only(il(n))},(s,i)=>{r={document:this.Cr(n,i),size:Jd(i)}}).next(()=>r)}getEntries(e,n){let r=kn();return this.Fr(e,n,(s,i)=>{const o=this.Cr(s,i);r=r.insert(s,o)}).next(()=>r)}Mr(e,n){let r=kn(),s=new ht(X.comparator);return this.Fr(e,n,(i,o)=>{const a=this.Cr(i,o);r=r.insert(i,a),s=s.insert(i,Jd(o))}).next(()=>({documents:r,Or:s}))}Fr(e,n,r){if(n.isEmpty())return O.resolve();let s=new Je(dI);n.forEach(l=>s=s.add(l));const i=IDBKeyRange.bound(il(s.first()),il(s.last())),o=s.getIterator();let a=o.getNext();return di(e).ee({index:Xu,range:i},(l,d,h)=>{const f=X.fromSegments([...d.prefixPath,d.collectionGroup,d.documentId]);for(;a&&dI(a,f)<0;)r(a,null),a=o.getNext();a&&a.isEqual(f)&&(r(a,d),a=o.hasNext()?o.getNext():null),a?h.j(il(a)):h.done()}).next(()=>{for(;a;)r(a,null),a=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,n,r,s,i){const o=n.path,a=[o.popLast().toArray(),o.lastSegment(),Yd(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],l=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return di(e).J(IDBKeyRange.bound(a,l,!0)).next(d=>{i==null||i.incrementDocumentReadCount(d.length);let h=kn();for(const f of d){const m=this.Cr(X.fromSegments(f.prefixPath.concat(f.collectionGroup,f.documentId)),f);m.isFoundDocument()&&(jc(n,m)||s.has(m.key))&&(h=h.insert(m.key,m))}return h})}getAllFromCollectionGroup(e,n,r,s){let i=kn();const o=uI(n,r),a=uI(n,Vn.max());return di(e).ee({index:nb,range:IDBKeyRange.bound(o,a,!0)},(l,d,h)=>{const f=this.Cr(X.fromSegments(d.prefixPath.concat(d.collectionGroup,d.documentId)),d);i=i.insert(f.key,f),i.size===s&&h.done()}).next(()=>i)}newChangeBuffer(e){return new QV(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(n=>n.byteSize)}getMetadata(e){return cI(e).get(Vm).next(n=>(le(!!n,20021),n))}Dr(e,n){return cI(e).put(Vm,n)}Cr(e,n){if(n){const r=DV(this.serializer,n);if(!(r.isNoDocument()&&r.version.isEqual(pe.min())))return r}return wt.newInvalidDocument(e)}}function pC(t){return new GV(t)}class QV extends fC{constructor(e,n){super(),this.Nr=e,this.trackRemovals=n,this.Br=new rs(r=>r.toString(),(r,s)=>r.isEqual(s))}applyChanges(e){const n=[];let r=0,s=new Je((i,o)=>xe(i.canonicalString(),o.canonicalString()));return this.changes.forEach((i,o)=>{const a=this.Br.get(i);if(n.push(this.Nr.removeEntry(e,i,a.readTime)),o.isValidDocument()){const l=WE(this.Nr.serializer,o);s=s.add(i.path.popLast());const d=Jd(l);r+=d-a.size,n.push(this.Nr.addEntry(e,i,l))}else if(r-=a.size,this.trackRemovals){const l=WE(this.Nr.serializer,o.convertToNoDocument(pe.min()));n.push(this.Nr.addEntry(e,i,l))}}),s.forEach(i=>{n.push(this.Nr.indexManager.addToCollectionParentIndex(e,i))}),n.push(this.Nr.updateMetadata(e,r)),O.waitFor(n)}getFromCache(e,n){return this.Nr.vr(e,n).next(r=>(this.Br.set(n,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,n){return this.Nr.Mr(e,n).next(({documents:r,Or:s})=>(s.forEach((i,o)=>{this.Br.set(i,{size:o,readTime:r.get(i).readTime})}),r))}}function cI(t){return Lt(t,hc)}function di(t){return Lt(t,Bd)}function il(t){const e=t.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function uI(t,e){const n=e.documentKey.path.toArray();return[t,Yd(e.readTime),n.slice(0,n.length-2),n.length>0?n[n.length-1]:""]}function dI(t,e){const n=t.path.toArray(),r=e.path.toArray();let s=0;for(let i=0;i<n.length-2&&i<r.length-2;++i)if(s=xe(n[i],r[i]),s)return s;return s=xe(n.length,r.length),s||(s=xe(n[n.length-2],r[r.length-2]),s||xe(n[n.length-1],r[r.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YV{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mC{constructor(e,n,r,s){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=s}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(s=>(r=s,this.remoteDocumentCache.getEntry(e,n))).next(s=>(r!==null&&Fl(r.mutation,s,In.empty(),$e.now()),s))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,Ae()).next(()=>r))}getLocalViewOfDocuments(e,n,r=Ae()){const s=br();return this.populateOverlays(e,s,n).next(()=>this.computeViews(e,n,s,r).next(i=>{let o=gl();return i.forEach((a,l)=>{o=o.insert(a,l.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){const r=br();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,Ae()))}populateOverlays(e,n,r){const s=[];return r.forEach(i=>{n.has(i)||s.push(i)}),this.documentOverlayCache.getOverlays(e,s).next(i=>{i.forEach((o,a)=>{n.set(o,a)})})}computeViews(e,n,r,s){let i=kn();const o=Ml(),a=function(){return Ml()}();return n.forEach((l,d)=>{const h=r.get(d.key);s.has(d.key)&&(h===void 0||h.mutation instanceof ss)?i=i.insert(d.key,d):h!==void 0?(o.set(d.key,h.mutation.getFieldMask()),Fl(h.mutation,d,h.mutation.getFieldMask(),$e.now())):o.set(d.key,In.empty())}),this.recalculateAndSaveOverlays(e,i).next(l=>(l.forEach((d,h)=>o.set(d,h)),n.forEach((d,h)=>a.set(d,new YV(h,o.get(d)??null))),a))}recalculateAndSaveOverlays(e,n){const r=Ml();let s=new ht((o,a)=>o-a),i=Ae();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(const a of o)a.keys().forEach(l=>{const d=n.get(l);if(d===null)return;let h=r.get(l)||In.empty();h=a.applyToLocalView(d,h),r.set(l,h);const f=(s.get(a.batchId)||Ae()).add(l);s=s.insert(a.batchId,f)})}).next(()=>{const o=[],a=s.getReverseIterator();for(;a.hasNext();){const l=a.getNext(),d=l.key,h=l.value,f=Db();h.forEach(m=>{if(!i.has(m)){const w=Ub(n.get(m),r.get(m));w!==null&&f.set(m,w),i=i.add(m)}}),o.push(this.documentOverlayCache.saveOverlays(e,d,f))}return O.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,s){return function(o){return X.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):Dy(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,s):this.getDocumentsMatchingCollectionQuery(e,n,r,s)}getNextDocuments(e,n,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,s).next(i=>{const o=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,s-i.size):O.resolve(br());let a=lc,l=i;return o.next(d=>O.forEach(d,(h,f)=>(a<f.largestBatchId&&(a=f.largestBatchId),i.get(h)?O.resolve():this.remoteDocumentCache.getEntry(e,h).next(m=>{l=l.insert(h,m)}))).next(()=>this.populateOverlays(e,d,i)).next(()=>this.computeViews(e,l,d,Ae())).next(h=>({batchId:a,changes:kb(h)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new X(n)).next(r=>{let s=gl();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s})}getDocumentsMatchingCollectionGroupQuery(e,n,r,s){const i=n.collectionGroup;let o=gl();return this.indexManager.getCollectionParents(e,i).next(a=>O.forEach(a,l=>{const d=function(f,m){return new oi(m,null,f.explicitOrderBy.slice(),f.filters.slice(),f.limit,f.limitType,f.startAt,f.endAt)}(n,l.child(i));return this.getDocumentsMatchingCollectionQuery(e,d,r,s).next(h=>{h.forEach((f,m)=>{o=o.insert(f,m)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,n,r,s){let i;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(o=>(i=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,i,s))).next(o=>{i.forEach((l,d)=>{const h=d.getKey();o.get(h)===null&&(o=o.insert(h,wt.newInvalidDocument(h)))});let a=gl();return o.forEach((l,d)=>{const h=i.get(l);h!==void 0&&Fl(h.mutation,d,In.empty(),$e.now()),jc(n,d)&&(a=a.insert(l,d))}),a})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XV{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,n){return O.resolve(this.Lr.get(n))}saveBundleMetadata(e,n){return this.Lr.set(n.id,function(s){return{id:s.id,version:s.version,createTime:mn(s.createTime)}}(n)),O.resolve()}getNamedQuery(e,n){return O.resolve(this.kr.get(n))}saveNamedQuery(e,n){return this.kr.set(n.name,function(s){return{name:s.name,query:sC(s.bundledQuery),readTime:mn(s.readTime)}}(n)),O.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JV{constructor(){this.overlays=new ht(X.comparator),this.qr=new Map}getOverlay(e,n){return O.resolve(this.overlays.get(n))}getOverlays(e,n){const r=br();return O.forEach(n,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((s,i)=>{this.St(e,n,i)}),O.resolve()}removeOverlaysForBatchId(e,n,r){const s=this.qr.get(r);return s!==void 0&&(s.forEach(i=>this.overlays=this.overlays.remove(i)),this.qr.delete(r)),O.resolve()}getOverlaysForCollection(e,n,r){const s=br(),i=n.length+1,o=new X(n.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const l=a.getNext().value,d=l.getKey();if(!n.isPrefixOf(d.path))break;d.path.length===i&&l.largestBatchId>r&&s.set(l.getKey(),l)}return O.resolve(s)}getOverlaysForCollectionGroup(e,n,r,s){let i=new ht((d,h)=>d-h);const o=this.overlays.getIterator();for(;o.hasNext();){const d=o.getNext().value;if(d.getKey().getCollectionGroup()===n&&d.largestBatchId>r){let h=i.get(d.largestBatchId);h===null&&(h=br(),i=i.insert(d.largestBatchId,h)),h.set(d.getKey(),d)}}const a=br(),l=i.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((d,h)=>a.set(d,h)),!(a.size()>=s)););return O.resolve(a)}St(e,n,r){const s=this.overlays.get(r.key);if(s!==null){const o=this.qr.get(s.largestBatchId).delete(r.key);this.qr.set(s.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new Ly(n,r));let i=this.qr.get(n);i===void 0&&(i=Ae(),this.qr.set(n,i)),this.qr.set(n,i.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZV{constructor(){this.sessionToken=Pt.EMPTY_BYTE_STRING}getSessionToken(e){return O.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,O.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zy{constructor(){this.Qr=new Je($t.$r),this.Ur=new Je($t.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,n){const r=new $t(e,n);this.Qr=this.Qr.add(r),this.Ur=this.Ur.add(r)}Wr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Gr(new $t(e,n))}zr(e,n){e.forEach(r=>this.removeReference(r,n))}jr(e){const n=new X(new ze([])),r=new $t(n,e),s=new $t(n,e+1),i=[];return this.Ur.forEachInRange([r,s],o=>{this.Gr(o),i.push(o.key)}),i}Jr(){this.Qr.forEach(e=>this.Gr(e))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const n=new X(new ze([])),r=new $t(n,e),s=new $t(n,e+1);let i=Ae();return this.Ur.forEachInRange([r,s],o=>{i=i.add(o.key)}),i}containsKey(e){const n=new $t(e,0),r=this.Qr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class $t{constructor(e,n){this.key=e,this.Yr=n}static $r(e,n){return X.comparator(e.key,n.key)||xe(e.Yr,n.Yr)}static Kr(e,n){return xe(e.Yr,n.Yr)||X.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eL{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.tr=1,this.Zr=new Je($t.$r)}checkEmpty(e){return O.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,s){const i=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new Oy(i,n,r,s);this.mutationQueue.push(o);for(const a of s)this.Zr=this.Zr.add(new $t(a.key,i)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return O.resolve(o)}lookupMutationBatch(e,n){return O.resolve(this.Xr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,s=this.ei(r),i=s<0?0:s;return O.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return O.resolve(this.mutationQueue.length===0?Pi:this.tr-1)}getAllMutationBatches(e){return O.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new $t(n,0),s=new $t(n,Number.POSITIVE_INFINITY),i=[];return this.Zr.forEachInRange([r,s],o=>{const a=this.Xr(o.Yr);i.push(a)}),O.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Je(xe);return n.forEach(s=>{const i=new $t(s,0),o=new $t(s,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([i,o],a=>{r=r.add(a.Yr)})}),O.resolve(this.ti(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,s=r.length+1;let i=r;X.isDocumentKey(i)||(i=i.child(""));const o=new $t(new X(i),0);let a=new Je(xe);return this.Zr.forEachWhile(l=>{const d=l.key.path;return!!r.isPrefixOf(d)&&(d.length===s&&(a=a.add(l.Yr)),!0)},o),O.resolve(this.ti(a))}ti(e){const n=[];return e.forEach(r=>{const s=this.Xr(r);s!==null&&n.push(s)}),n}removeMutationBatch(e,n){le(this.ni(n.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Zr;return O.forEach(n.mutations,s=>{const i=new $t(s.key,n.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.Zr=r})}ir(e){}containsKey(e,n){const r=new $t(n,0),s=this.Zr.firstAfterOrEqual(r);return O.resolve(n.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,O.resolve()}ni(e,n){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const n=this.ei(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tL{constructor(e){this.ri=e,this.docs=function(){return new ht(X.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,s=this.docs.get(r),i=s?s.size:0,o=this.ri(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return O.resolve(r?r.document.mutableCopy():wt.newInvalidDocument(n))}getEntries(e,n){let r=kn();return n.forEach(s=>{const i=this.docs.get(s);r=r.insert(s,i?i.document.mutableCopy():wt.newInvalidDocument(s))}),O.resolve(r)}getDocumentsMatchingQuery(e,n,r,s){let i=kn();const o=n.path,a=new X(o.child("__id-9223372036854775808__")),l=this.docs.getIteratorFrom(a);for(;l.hasNext();){const{key:d,value:{document:h}}=l.getNext();if(!o.isPrefixOf(d.path))break;d.path.length>o.length+1||xy(XS(h),r)<=0||(s.has(h.key)||jc(n,h))&&(i=i.insert(h.key,h.mutableCopy()))}return O.resolve(i)}getAllFromCollectionGroup(e,n,r,s){oe(9500)}ii(e,n){return O.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new nL(this)}getSize(e){return O.resolve(this.size)}}class nL extends fC{constructor(e){super(),this.Nr=e}applyChanges(e){const n=[];return this.changes.forEach((r,s)=>{s.isValidDocument()?n.push(this.Nr.addEntry(e,s)):this.Nr.removeEntry(r)}),O.waitFor(n)}getFromCache(e,n){return this.Nr.getEntry(e,n)}getAllFromCache(e,n){return this.Nr.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rL{constructor(e){this.persistence=e,this.si=new rs(n=>Wi(n),kc),this.lastRemoteSnapshotVersion=pe.min(),this.highestTargetId=0,this.oi=0,this._i=new zy,this.targetCount=0,this.ai=Yi.ur()}forEachTarget(e,n){return this.si.forEach((r,s)=>n(s)),O.resolve()}getLastRemoteSnapshotVersion(e){return O.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return O.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),O.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.oi&&(this.oi=n),O.resolve()}Pr(e){this.si.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.ai=new Yi(n),this.highestTargetId=n),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,n){return this.Pr(n),this.targetCount+=1,O.resolve()}updateTargetData(e,n){return this.Pr(n),O.resolve()}removeTargetData(e,n){return this.si.delete(n.target),this._i.jr(n.targetId),this.targetCount-=1,O.resolve()}removeTargets(e,n,r){let s=0;const i=[];return this.si.forEach((o,a)=>{a.sequenceNumber<=n&&r.get(a.targetId)===null&&(this.si.delete(o),i.push(this.removeMatchingKeysForTargetId(e,a.targetId)),s++)}),O.waitFor(i).next(()=>s)}getTargetCount(e){return O.resolve(this.targetCount)}getTargetData(e,n){const r=this.si.get(n)||null;return O.resolve(r)}addMatchingKeys(e,n,r){return this._i.Wr(n,r),O.resolve()}removeMatchingKeys(e,n,r){this._i.zr(n,r);const s=this.persistence.referenceDelegate,i=[];return s&&n.forEach(o=>{i.push(s.markPotentiallyOrphaned(e,o))}),O.waitFor(i)}removeMatchingKeysForTargetId(e,n){return this._i.jr(n),O.resolve()}getMatchingKeysForTargetId(e,n){const r=this._i.Hr(n);return O.resolve(r)}containsKey(e,n){return O.resolve(this._i.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qy{constructor(e,n){this.ui={},this.overlays={},this.ci=new Hn(0),this.li=!1,this.li=!0,this.hi=new ZV,this.referenceDelegate=e(this),this.Pi=new rL(this),this.indexManager=new $V,this.remoteDocumentCache=function(s){return new tL(s)}(r=>this.referenceDelegate.Ti(r)),this.serializer=new nC(n),this.Ii=new XV(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new JV,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.ui[e.toKey()];return r||(r=new eL(n,this.referenceDelegate),this.ui[e.toKey()]=r),r}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,n,r){q("MemoryPersistence","Starting transaction:",e);const s=new sL(this.ci.next());return this.referenceDelegate.Ei(),r(s).next(i=>this.referenceDelegate.di(s).next(()=>i)).toPromise().then(i=>(s.raiseOnCommittedEvent(),i))}Ai(e,n){return O.or(Object.values(this.ui).map(r=>()=>r.containsKey(e,n)))}}class sL extends ZS{constructor(e){super(),this.currentSequenceNumber=e}}class Jh{constructor(e){this.persistence=e,this.Ri=new zy,this.Vi=null}static mi(e){return new Jh(e)}get fi(){if(this.Vi)return this.Vi;throw oe(60996)}addReference(e,n,r){return this.Ri.addReference(r,n),this.fi.delete(r.toString()),O.resolve()}removeReference(e,n,r){return this.Ri.removeReference(r,n),this.fi.add(r.toString()),O.resolve()}markPotentiallyOrphaned(e,n){return this.fi.add(n.toString()),O.resolve()}removeTarget(e,n){this.Ri.jr(n.targetId).forEach(s=>this.fi.add(s.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(s=>{s.forEach(i=>this.fi.add(i.toString()))}).next(()=>r.removeTargetData(e,n))}Ei(){this.Vi=new Set}di(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return O.forEach(this.fi,r=>{const s=X.fromPath(r);return this.gi(e,s).next(i=>{i||n.removeEntry(s,pe.min())})}).next(()=>(this.Vi=null,n.apply(e)))}updateLimboDocument(e,n){return this.gi(e,n).next(r=>{r?this.fi.delete(n.toString()):this.fi.add(n.toString())})}Ti(e){return 0}gi(e,n){return O.or([()=>O.resolve(this.Ri.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Ai(e,n)])}}class Zd{constructor(e,n){this.persistence=e,this.pi=new rs(r=>ln(r.path),(r,s)=>r.isEqual(s)),this.garbageCollector=hC(this,n)}static mi(e,n){return new Zd(e,n)}Ei(){}di(e){return O.resolve()}forEachTarget(e,n){return this.persistence.getTargetCache().forEachTarget(e,n)}gr(e){const n=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next(r=>n.next(s=>r+s))}wr(e){let n=0;return this.pr(e,r=>{n++}).next(()=>n)}pr(e,n){return O.forEach(this.pi,(r,s)=>this.br(e,r,s).next(i=>i?O.resolve():n(s)))}removeTargets(e,n,r){return this.persistence.getTargetCache().removeTargets(e,n,r)}removeOrphanedDocuments(e,n){let r=0;const s=this.persistence.getRemoteDocumentCache(),i=s.newChangeBuffer();return s.ii(e,o=>this.br(e,o,n).next(a=>{a||(r++,i.removeEntry(o,pe.min()))})).next(()=>i.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,n){return this.pi.set(n,e.currentSequenceNumber),O.resolve()}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,n,r){return this.pi.set(r,e.currentSequenceNumber),O.resolve()}removeReference(e,n,r){return this.pi.set(r,e.currentSequenceNumber),O.resolve()}updateLimboDocument(e,n){return this.pi.set(n,e.currentSequenceNumber),O.resolve()}Ti(e){let n=e.key.toString().length;return e.isFoundDocument()&&(n+=Zu(e.data.value)),n}br(e,n,r){return O.or([()=>this.persistence.Ai(e,n),()=>this.persistence.getTargetCache().containsKey(e,n),()=>{const s=this.pi.get(n);return O.resolve(s!==void 0&&s>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iL{constructor(e){this.serializer=e}k(e,n,r,s){const i=new Vh("createOrUpgrade",n);r<1&&s>=1&&(function(l){l.createObjectStore(Nc)}(e),function(l){l.createObjectStore(dc,{keyPath:pO}),l.createObjectStore(nr,{keyPath:IE,autoIncrement:!0}).createIndex(bi,TE,{unique:!0}),l.createObjectStore(da)}(e),hI(e),function(l){l.createObjectStore(yi)}(e));let o=O.resolve();return r<3&&s>=3&&(r!==0&&(function(l){l.deleteObjectStore(fa),l.deleteObjectStore(ha),l.deleteObjectStore(Ni)}(e),hI(e)),o=o.next(()=>function(l){const d=l.store(Ni),h={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:pe.min().toTimestamp(),targetCount:0};return d.put(zd,h)}(i))),r<4&&s>=4&&(r!==0&&(o=o.next(()=>function(l,d){return d.store(nr).J().next(f=>{l.deleteObjectStore(nr),l.createObjectStore(nr,{keyPath:IE,autoIncrement:!0}).createIndex(bi,TE,{unique:!0});const m=d.store(nr),w=f.map(A=>m.put(A));return O.waitFor(w)})}(e,i))),o=o.next(()=>{(function(l){l.createObjectStore(pa,{keyPath:TO})})(e)})),r<5&&s>=5&&(o=o.next(()=>this.yi(i))),r<6&&s>=6&&(o=o.next(()=>(function(l){l.createObjectStore(hc)}(e),this.wi(i)))),r<7&&s>=7&&(o=o.next(()=>this.Si(i))),r<8&&s>=8&&(o=o.next(()=>this.bi(e,i))),r<9&&s>=9&&(o=o.next(()=>{(function(l){l.objectStoreNames.contains("remoteDocumentChanges")&&l.deleteObjectStore("remoteDocumentChanges")})(e)})),r<10&&s>=10&&(o=o.next(()=>this.Di(i))),r<11&&s>=11&&(o=o.next(()=>{(function(l){l.createObjectStore(Mh,{keyPath:xO})})(e),function(l){l.createObjectStore(Fh,{keyPath:SO})}(e)})),r<12&&s>=12&&(o=o.next(()=>{(function(l){const d=l.createObjectStore(Uh,{keyPath:kO});d.createIndex(Mm,DO,{unique:!1}),d.createIndex(ob,jO,{unique:!1})})(e)})),r<13&&s>=13&&(o=o.next(()=>function(l){const d=l.createObjectStore(Bd,{keyPath:gO});d.createIndex(Xu,yO),d.createIndex(nb,_O)}(e)).next(()=>this.Ci(e,i)).next(()=>e.deleteObjectStore(yi))),r<14&&s>=14&&(o=o.next(()=>this.Fi(e,i))),r<15&&s>=15&&(o=o.next(()=>function(l){l.createObjectStore(Cy,{keyPath:bO,autoIncrement:!0}).createIndex(Lm,CO,{unique:!1}),l.createObjectStore(Ol,{keyPath:AO}).createIndex(sb,RO,{unique:!1}),l.createObjectStore(Vl,{keyPath:PO}).createIndex(ib,NO,{unique:!1})}(e))),r<16&&s>=16&&(o=o.next(()=>{n.objectStore(Ol).clear()}).next(()=>{n.objectStore(Vl).clear()})),r<17&&s>=17&&(o=o.next(()=>{(function(l){l.createObjectStore(Ay,{keyPath:OO})})(e)})),r<18&&s>=18&&Jx()&&(o=o.next(()=>{n.objectStore(Ol).clear()}).next(()=>{n.objectStore(Vl).clear()})),o}wi(e){let n=0;return e.store(yi).ee((r,s)=>{n+=Jd(s)}).next(()=>{const r={byteSize:n};return e.store(hc).put(Vm,r)})}yi(e){const n=e.store(dc),r=e.store(nr);return n.J().next(s=>O.forEach(s,i=>{const o=IDBKeyRange.bound([i.userId,Pi],[i.userId,i.lastAcknowledgedBatchId]);return r.J(bi,o).next(a=>O.forEach(a,l=>{le(l.userId===i.userId,18650,"Cannot process batch from unexpected user",{batchId:l.batchId});const d=vi(this.serializer,l);return lC(e,i.userId,d).next(()=>{})}))}))}Si(e){const n=e.store(fa),r=e.store(yi);return e.store(Ni).get(zd).next(s=>{const i=[];return r.ee((o,a)=>{const l=new ze(o),d=function(f){return[0,ln(f)]}(l);i.push(n.get(d).next(h=>h?O.resolve():(f=>n.put({targetId:0,path:ln(f),sequenceNumber:s.highestListenSequenceNumber}))(l)))}).next(()=>O.waitFor(i))})}bi(e,n){e.createObjectStore(fc,{keyPath:IO});const r=n.store(fc),s=new By,i=o=>{if(s.add(o)){const a=o.lastSegment(),l=o.popLast();return r.put({collectionId:a,parent:ln(l)})}};return n.store(yi).ee({X:!0},(o,a)=>{const l=new ze(o);return i(l.popLast())}).next(()=>n.store(da).ee({X:!0},([o,a,l],d)=>{const h=Sr(a);return i(h.popLast())}))}Di(e){const n=e.store(ha);return n.ee((r,s)=>{const i=_l(s),o=rC(this.serializer,i);return n.put(o)})}Ci(e,n){const r=n.store(yi),s=[];return r.ee((i,o)=>{const a=n.store(Bd),l=function(f){return f.document?new X(ze.fromString(f.document.name).popFirst(5)):f.noDocument?X.fromSegments(f.noDocument.path):f.unknownDocument?X.fromSegments(f.unknownDocument.path):oe(36783)}(o).path.toArray(),d={prefixPath:l.slice(0,l.length-2),collectionGroup:l[l.length-2],documentId:l[l.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};s.push(a.put(d))}).next(()=>O.waitFor(s))}Fi(e,n){const r=n.store(nr),s=pC(this.serializer),i=new qy(Jh.mi,this.serializer.yt);return r.J().next(o=>{const a=new Map;return o.forEach(l=>{let d=a.get(l.userId)??Ae();vi(this.serializer,l).keys().forEach(h=>d=d.add(h)),a.set(l.userId,d)}),O.forEach(a,(l,d)=>{const h=new Ht(d),f=Yh.wt(this.serializer,h),m=i.getIndexManager(h),w=Xh.wt(h,this.serializer,m,i.referenceDelegate);return new mC(s,w,f,m).recalculateAndSaveOverlaysForDocumentKeys(new Fm(n,Hn.ce),l).next()})})}}function hI(t){t.createObjectStore(fa,{keyPath:wO}).createIndex(by,EO,{unique:!0}),t.createObjectStore(ha,{keyPath:"targetId"}).createIndex(rb,vO,{unique:!0}),t.createObjectStore(Ni)}const gs="IndexedDbPersistence",fp=18e5,pp=5e3,mp="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",oL="main";class Hy{constructor(e,n,r,s,i,o,a,l,d,h,f=18){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.Mi=i,this.window=o,this.document=a,this.xi=d,this.Oi=h,this.Ni=f,this.ci=null,this.li=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Bi=null,this.inForeground=!1,this.Li=null,this.ki=null,this.qi=Number.NEGATIVE_INFINITY,this.Qi=m=>Promise.resolve(),!Hy.v())throw new W(B.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new KV(this,s),this.$i=n+oL,this.serializer=new nC(l),this.Ui=new zs(this.$i,this.Ni,new iL(this.serializer)),this.hi=new OV,this.Pi=new zV(this.referenceDelegate,this.serializer),this.remoteDocumentCache=pC(this.serializer),this.Ii=new jV,this.window&&this.window.localStorage?this.Ki=this.window.localStorage:(this.Ki=null,h===!1&&hn(gs,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Wi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new W(B.FAILED_PRECONDITION,mp);return this.Gi(),this.zi(),this.ji(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Pi.getHighestSequenceNumber(e))}).then(e=>{this.ci=new Hn(e,this.xi)}).then(()=>{this.li=!0}).catch(e=>(this.Ui&&this.Ui.close(),Promise.reject(e)))}Ji(e){return this.Qi=async n=>{if(this.started)return e(n)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ui.$(async n=>{n.newVersion===null&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Mi.enqueueAndForget(async()=>{this.started&&await this.Wi()}))}Wi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>Tu(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.Hi(e).next(n=>{n||(this.isPrimary=!1,this.Mi.enqueueRetryable(()=>this.Qi(!1)))})}).next(()=>this.Yi(e)).next(n=>this.isPrimary&&!n?this.Zi(e).next(()=>!1):!!n&&this.Xi(e).next(()=>!0))).catch(e=>{if(si(e))return q(gs,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return q(gs,"Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.Mi.enqueueRetryable(()=>this.Qi(e)),this.isPrimary=e})}Hi(e){return ol(e).get(fo).next(n=>O.resolve(this.es(n)))}ts(e){return Tu(e).delete(this.clientId)}async ns(){if(this.isPrimary&&!this.rs(this.qi,fp)){this.qi=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",n=>{const r=Lt(n,pa);return r.J().next(s=>{const i=this.ss(s,fp),o=s.filter(a=>i.indexOf(a)===-1);return O.forEach(o,a=>r.delete(a.clientId)).next(()=>o)})}).catch(()=>[]);if(this.Ki)for(const n of e)this.Ki.removeItem(this._s(n.clientId))}}ji(){this.ki=this.Mi.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.Wi().then(()=>this.ns()).then(()=>this.ji()))}es(e){return!!e&&e.ownerId===this.clientId}Yi(e){return this.Oi?O.resolve(!0):ol(e).get(fo).next(n=>{if(n!==null&&this.rs(n.leaseTimestampMs,pp)&&!this.us(n.ownerId)){if(this.es(n)&&this.networkEnabled)return!0;if(!this.es(n)){if(!n.allowTabSynchronization)throw new W(B.FAILED_PRECONDITION,mp);return!1}}return!(!this.networkEnabled||!this.inForeground)||Tu(e).J().next(r=>this.ss(r,pp).find(s=>{if(this.clientId!==s.clientId){const i=!this.networkEnabled&&s.networkEnabled,o=!this.inForeground&&s.inForeground,a=this.networkEnabled===s.networkEnabled;if(i||o&&a)return!0}return!1})===void 0)}).next(n=>(this.isPrimary!==n&&q(gs,`Client ${n?"is":"is not"} eligible for a primary lease.`),n))}async shutdown(){this.li=!1,this.cs(),this.ki&&(this.ki.cancel(),this.ki=null),this.ls(),this.hs(),await this.Ui.runTransaction("shutdown","readwrite",[Nc,pa],e=>{const n=new Fm(e,Hn.ce);return this.Zi(n).next(()=>this.ts(n))}),this.Ui.close(),this.Ps()}ss(e,n){return e.filter(r=>this.rs(r.updateTimeMs,n)&&!this.us(r.clientId))}Ts(){return this.runTransaction("getActiveClients","readonly",e=>Tu(e).J().next(n=>this.ss(n,fp).map(r=>r.clientId)))}get started(){return this.li}getGlobalsCache(){return this.hi}getMutationQueue(e,n){return Xh.wt(e,this.serializer,n,this.referenceDelegate)}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new BV(e,this.serializer.yt.databaseId)}getDocumentOverlayCache(e){return Yh.wt(this.serializer,e)}getBundleCache(){return this.Ii}runTransaction(e,n,r){q(gs,"Starting transaction:",e);const s=n==="readonly"?"readonly":"readwrite",i=function(l){return l===18?MO:l===17?ub:l===16?LO:l===15?Ry:l===14?cb:l===13?lb:l===12?VO:l===11?ab:void oe(60245)}(this.Ni);let o;return this.Ui.runTransaction(e,s,i,a=>(o=new Fm(a,this.ci?this.ci.next():Hn.ce),n==="readwrite-primary"?this.Hi(o).next(l=>!!l||this.Yi(o)).next(l=>{if(!l)throw hn(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Mi.enqueueRetryable(()=>this.Qi(!1)),new W(B.FAILED_PRECONDITION,JS);return r(o)}).next(l=>this.Xi(o).next(()=>l)):this.Is(o).next(()=>r(o)))).then(a=>(o.raiseOnCommittedEvent(),a))}Is(e){return ol(e).get(fo).next(n=>{if(n!==null&&this.rs(n.leaseTimestampMs,pp)&&!this.us(n.ownerId)&&!this.es(n)&&!(this.Oi||this.allowTabSynchronization&&n.allowTabSynchronization))throw new W(B.FAILED_PRECONDITION,mp)})}Xi(e){const n={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return ol(e).put(fo,n)}static v(){return zs.v()}Zi(e){const n=ol(e);return n.get(fo).next(r=>this.es(r)?(q(gs,"Releasing primary lease."),n.delete(fo)):O.resolve())}rs(e,n){const r=Date.now();return!(e<r-n)&&(!(e>r)||(hn(`Detected an update time that is in the future: ${e} > ${r}`),!1))}Gi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Li=()=>{this.Mi.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.Wi()))},this.document.addEventListener("visibilitychange",this.Li),this.inForeground=this.document.visibilityState==="visible")}ls(){this.Li&&(this.document.removeEventListener("visibilitychange",this.Li),this.Li=null)}zi(){var e;typeof((e=this.window)==null?void 0:e.addEventListener)=="function"&&(this.Bi=()=>{this.cs();const n=/(?:Version|Mobile)\/1[456]/;Xx()&&(navigator.appVersion.match(n)||navigator.userAgent.match(n))&&this.Mi.enterRestrictedMode(!0),this.Mi.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Bi))}hs(){this.Bi&&(this.window.removeEventListener("pagehide",this.Bi),this.Bi=null)}us(e){var n;try{const r=((n=this.Ki)==null?void 0:n.getItem(this._s(e)))!==null;return q(gs,`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return hn(gs,"Failed to get zombied client id.",r),!1}}cs(){if(this.Ki)try{this.Ki.setItem(this._s(this.clientId),String(Date.now()))}catch(e){hn("Failed to set zombie client id.",e)}}Ps(){if(this.Ki)try{this.Ki.removeItem(this._s(this.clientId))}catch{}}_s(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function ol(t){return Lt(t,Nc)}function Tu(t){return Lt(t,pa)}function aL(t,e){let n=t.projectId;return t.isDefaultDatabase||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wy{constructor(e,n,r,s){this.targetId=e,this.fromCache=n,this.Es=r,this.ds=s}static As(e,n){let r=Ae(),s=Ae();for(const i of n.docChanges)switch(i.type){case 0:r=r.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new Wy(e,n.fromCache,r,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lL{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gC{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=function(){return Xx()?8:eb(Vt())>0?6:4}()}initialize(e,n){this.ps=e,this.indexManager=n,this.Rs=!0}getDocumentsMatchingQuery(e,n,r,s){const i={result:null};return this.ys(e,n).next(o=>{i.result=o}).next(()=>{if(!i.result)return this.ws(e,n,s,r).next(o=>{i.result=o})}).next(()=>{if(i.result)return;const o=new lL;return this.Ss(e,n,o).next(a=>{if(i.result=a,this.Vs)return this.bs(e,n,o,a.size)})}).next(()=>i.result)}bs(e,n,r,s){return r.documentReadCount<this.fs?(So()<=De.DEBUG&&q("QueryEngine","SDK will not create cache indexes for query:",bo(n),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),O.resolve()):(So()<=De.DEBUG&&q("QueryEngine","Query:",bo(n),"scans",r.documentReadCount,"local documents and returns",s,"documents as results."),r.documentReadCount>this.gs*s?(So()<=De.DEBUG&&q("QueryEngine","The SDK decides to create cache indexes for query:",bo(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Kn(n))):O.resolve())}ys(e,n){if(VE(n))return O.resolve(null);let r=Kn(n);return this.indexManager.getIndexType(e,r).next(s=>s===0?null:(n.limit!==null&&s===1&&(n=Kd(n,null,"F"),r=Kn(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(i=>{const o=Ae(...i);return this.ps.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,r).next(l=>{const d=this.Ds(n,a);return this.Cs(n,d,o,l.readTime)?this.ys(e,Kd(n,null,"F")):this.vs(e,d,n,l)}))})))}ws(e,n,r,s){return VE(n)||s.isEqual(pe.min())?O.resolve(null):this.ps.getDocuments(e,r).next(i=>{const o=this.Ds(n,i);return this.Cs(n,o,r,s)?O.resolve(null):(So()<=De.DEBUG&&q("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),bo(n)),this.vs(e,o,n,aO(s,lc)).next(a=>a))})}Ds(e,n){let r=new Je(Pb(e));return n.forEach((s,i)=>{jc(e,i)&&(r=r.add(i))}),r}Cs(e,n,r,s){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const i=e.limitType==="F"?n.last():n.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}Ss(e,n,r){return So()<=De.DEBUG&&q("QueryEngine","Using full collection scan to execute query:",bo(n)),this.ps.getDocumentsMatchingQuery(e,n,Vn.min(),r)}vs(e,n,r,s){return this.ps.getDocumentsMatchingQuery(e,r,s).next(i=>(n.forEach(o=>{i=i.insert(o.key,o)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ky="LocalStore",cL=3e8;class uL{constructor(e,n,r,s){this.persistence=e,this.Fs=n,this.serializer=s,this.Ms=new ht(xe),this.xs=new rs(i=>Wi(i),kc),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(r)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new mC(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.Ms))}}function yC(t,e,n,r){return new uL(t,e,n,r)}async function _C(t,e){const n=Ee(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let s;return n.mutationQueue.getAllMutationBatches(r).next(i=>(s=i,n.Bs(e),n.mutationQueue.getAllMutationBatches(r))).next(i=>{const o=[],a=[];let l=Ae();for(const d of s){o.push(d.batchId);for(const h of d.mutations)l=l.add(h.key)}for(const d of i){a.push(d.batchId);for(const h of d.mutations)l=l.add(h.key)}return n.localDocuments.getDocuments(r,l).next(d=>({Ls:d,removedBatchIds:o,addedBatchIds:a}))})})}function dL(t,e){const n=Ee(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const s=e.batch.keys(),i=n.Ns.newChangeBuffer({trackRemovals:!0});return function(a,l,d,h){const f=d.batch,m=f.keys();let w=O.resolve();return m.forEach(A=>{w=w.next(()=>h.getEntry(l,A)).next(b=>{const P=d.docVersions.get(A);le(P!==null,48541),b.version.compareTo(P)<0&&(f.applyToRemoteDocument(b,d),b.isValidDocument()&&(b.setReadTime(d.commitVersion),h.addEntry(b)))})}),w.next(()=>a.mutationQueue.removeMutationBatch(l,f))}(n,r,e,i).next(()=>i.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,s,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let l=Ae();for(let d=0;d<a.mutationResults.length;++d)a.mutationResults[d].transformResults.length>0&&(l=l.add(a.batch.mutations[d].key));return l}(e))).next(()=>n.localDocuments.getDocuments(r,s))})}function vC(t){const e=Ee(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Pi.getLastRemoteSnapshotVersion(n))}function hL(t,e){const n=Ee(t),r=e.snapshotVersion;let s=n.Ms;return n.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const o=n.Ns.newChangeBuffer({trackRemovals:!0});s=n.Ms;const a=[];e.targetChanges.forEach((h,f)=>{const m=s.get(f);if(!m)return;a.push(n.Pi.removeMatchingKeys(i,h.removedDocuments,f).next(()=>n.Pi.addMatchingKeys(i,h.addedDocuments,f)));let w=m.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(f)!==null?w=w.withResumeToken(Pt.EMPTY_BYTE_STRING,pe.min()).withLastLimboFreeSnapshotVersion(pe.min()):h.resumeToken.approximateByteSize()>0&&(w=w.withResumeToken(h.resumeToken,r)),s=s.insert(f,w),function(b,P,I){return b.resumeToken.approximateByteSize()===0||P.snapshotVersion.toMicroseconds()-b.snapshotVersion.toMicroseconds()>=cL?!0:I.addedDocuments.size+I.modifiedDocuments.size+I.removedDocuments.size>0}(m,w,h)&&a.push(n.Pi.updateTargetData(i,w))});let l=kn(),d=Ae();if(e.documentUpdates.forEach(h=>{e.resolvedLimboDocuments.has(h)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(i,h))}),a.push(fL(i,o,e.documentUpdates).next(h=>{l=h.ks,d=h.qs})),!r.isEqual(pe.min())){const h=n.Pi.getLastRemoteSnapshotVersion(i).next(f=>n.Pi.setTargetsMetadata(i,i.currentSequenceNumber,r));a.push(h)}return O.waitFor(a).next(()=>o.apply(i)).next(()=>n.localDocuments.getLocalViewOfDocuments(i,l,d)).next(()=>l)}).then(i=>(n.Ms=s,i))}function fL(t,e,n){let r=Ae(),s=Ae();return n.forEach(i=>r=r.add(i)),e.getEntries(t,r).next(i=>{let o=kn();return n.forEach((a,l)=>{const d=i.get(a);l.isFoundDocument()!==d.isFoundDocument()&&(s=s.add(a)),l.isNoDocument()&&l.version.isEqual(pe.min())?(e.removeEntry(a,l.readTime),o=o.insert(a,l)):!d.isValidDocument()||l.version.compareTo(d.version)>0||l.version.compareTo(d.version)===0&&d.hasPendingWrites?(e.addEntry(l),o=o.insert(a,l)):q(Ky,"Ignoring outdated watch update for ",a,". Current version:",d.version," Watch version:",l.version)}),{ks:o,qs:s}})}function pL(t,e){const n=Ee(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=Pi),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function mL(t,e){const n=Ee(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let s;return n.Pi.getTargetData(r,e).next(i=>i?(s=i,O.resolve(s)):n.Pi.allocateTargetId(r).next(o=>(s=new Br(e,o,"TargetPurposeListen",r.currentSequenceNumber),n.Pi.addTargetData(r,s).next(()=>s))))}).then(r=>{const s=n.Ms.get(r.targetId);return(s===null||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(n.Ms=n.Ms.insert(r.targetId,r),n.xs.set(e,r.targetId)),r})}async function Zm(t,e,n){const r=Ee(t),s=r.Ms.get(e),i=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",i,o=>r.persistence.referenceDelegate.removeTarget(o,s))}catch(o){if(!si(o))throw o;q(Ky,`Failed to update sequence numbers for target ${e}: ${o}`)}r.Ms=r.Ms.remove(e),r.xs.delete(s.target)}function fI(t,e,n){const r=Ee(t);let s=pe.min(),i=Ae();return r.persistence.runTransaction("Execute query","readwrite",o=>function(l,d,h){const f=Ee(l),m=f.xs.get(h);return m!==void 0?O.resolve(f.Ms.get(m)):f.Pi.getTargetData(d,h)}(r,o,Kn(e)).next(a=>{if(a)return s=a.lastLimboFreeSnapshotVersion,r.Pi.getMatchingKeysForTargetId(o,a.targetId).next(l=>{i=l})}).next(()=>r.Fs.getDocumentsMatchingQuery(o,e,n?s:pe.min(),n?i:Ae())).next(a=>(gL(r,eV(e),a),{documents:a,Qs:i})))}function gL(t,e,n){let r=t.Os.get(e)||pe.min();n.forEach((s,i)=>{i.readTime.compareTo(r)>0&&(r=i.readTime)}),t.Os.set(e,r)}class pI{constructor(){this.activeTargetIds=oV()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class wC{constructor(){this.Mo=new pI,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,n,r){this.xo[e]=n}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new pI,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yL{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mI="ConnectivityMonitor";class gI{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){q(mI,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){q(mI,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let xu=null;function eg(){return xu===null?xu=function(){return 268435456+Math.round(2147483648*Math.random())}():xu++,"0x"+xu.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gp="RestConnection",_L={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class vL{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const n=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Uo=n+"://"+e.host,this.Ko=`projects/${r}/databases/${s}`,this.Wo=this.databaseId.database===qd?`project_id=${r}`:`project_id=${r}&database_id=${s}`}Go(e,n,r,s,i){const o=eg(),a=this.zo(e,n.toUriEncodedString());q(gp,`Sending RPC '${e}' ${o}:`,a,r);const l={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(l,s,i);const{host:d}=new URL(a),h=ti(d);return this.Jo(e,a,l,r,h).then(f=>(q(gp,`Received RPC '${e}' ${o}: `,f),f),f=>{throw zi(gp,`RPC '${e}' ${o} failed with error: `,f,"url: ",a,"request:",r),f})}Ho(e,n,r,s,i,o){return this.Go(e,n,r,s,i)}jo(e,n,r){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Na}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((s,i)=>e[i]=s),r&&r.headers.forEach((s,i)=>e[i]=s)}zo(e,n){const r=_L[e];return`${this.Uo}/v1/${n}:${r}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wL{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tn="WebChannelConnection";class EL extends vL{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,n,r,s,i){const o=eg();return new Promise((a,l)=>{const d=new $S;d.setWithCredentials(!0),d.listenOnce(BS.COMPLETE,()=>{try{switch(d.getLastErrorCode()){case Gu.NO_ERROR:const f=d.getResponseJson();q(tn,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(f)),a(f);break;case Gu.TIMEOUT:q(tn,`RPC '${e}' ${o} timed out`),l(new W(B.DEADLINE_EXCEEDED,"Request time out"));break;case Gu.HTTP_ERROR:const m=d.getStatus();if(q(tn,`RPC '${e}' ${o} failed with status:`,m,"response text:",d.getResponseText()),m>0){let w=d.getResponseJson();Array.isArray(w)&&(w=w[0]);const A=w==null?void 0:w.error;if(A&&A.status&&A.message){const b=function(I){const E=I.toLowerCase().replace(/_/g,"-");return Object.values(B).indexOf(E)>=0?E:B.UNKNOWN}(A.status);l(new W(b,A.message))}else l(new W(B.UNKNOWN,"Server responded with status "+d.getStatus()))}else l(new W(B.UNAVAILABLE,"Connection failed."));break;default:oe(9055,{l_:e,streamId:o,h_:d.getLastErrorCode(),P_:d.getLastError()})}}finally{q(tn,`RPC '${e}' ${o} completed.`)}});const h=JSON.stringify(s);q(tn,`RPC '${e}' ${o} sending request:`,s),d.send(n,"POST",h,r,15)})}T_(e,n,r){const s=eg(),i=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=HS(),a=qS(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},d=this.longPollingOptions.timeoutSeconds;d!==void 0&&(l.longPollingTimeout=Math.round(1e3*d)),this.useFetchStreams&&(l.useFetchStreams=!0),this.jo(l.initMessageHeaders,n,r),l.encodeInitMessageHeaders=!0;const h=i.join("");q(tn,`Creating RPC '${e}' stream ${s}: ${h}`,l);const f=o.createWebChannel(h,l);this.I_(f);let m=!1,w=!1;const A=new wL({Yo:P=>{w?q(tn,`Not sending because RPC '${e}' stream ${s} is closed:`,P):(m||(q(tn,`Opening RPC '${e}' stream ${s} transport.`),f.open(),m=!0),q(tn,`RPC '${e}' stream ${s} sending:`,P),f.send(P))},Zo:()=>f.close()}),b=(P,I,E)=>{P.listen(I,y=>{try{E(y)}catch(j){setTimeout(()=>{throw j},0)}})};return b(f,ml.EventType.OPEN,()=>{w||(q(tn,`RPC '${e}' stream ${s} transport opened.`),A.o_())}),b(f,ml.EventType.CLOSE,()=>{w||(w=!0,q(tn,`RPC '${e}' stream ${s} transport closed`),A.a_(),this.E_(f))}),b(f,ml.EventType.ERROR,P=>{w||(w=!0,zi(tn,`RPC '${e}' stream ${s} transport errored. Name:`,P.name,"Message:",P.message),A.a_(new W(B.UNAVAILABLE,"The operation could not be completed")))}),b(f,ml.EventType.MESSAGE,P=>{var I;if(!w){const E=P.data[0];le(!!E,16349);const y=E,j=(y==null?void 0:y.error)||((I=y[0])==null?void 0:I.error);if(j){q(tn,`RPC '${e}' stream ${s} received error:`,j);const V=j.status;let M=function(S){const C=Ct[S];if(C!==void 0)return zb(C)}(V),T=j.message;M===void 0&&(M=B.INTERNAL,T="Unknown error status: "+V+" with message "+j.message),w=!0,A.a_(new W(M,T)),f.close()}else q(tn,`RPC '${e}' stream ${s} received:`,E),A.u_(E)}}),b(a,zS.STAT_EVENT,P=>{P.stat===Dm.PROXY?q(tn,`RPC '${e}' stream ${s} detected buffering proxy`):P.stat===Dm.NOPROXY&&q(tn,`RPC '${e}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{A.__()},0),A}terminate(){this.c_.forEach(e=>e.close()),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter(n=>n===e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function IL(){return typeof window<"u"?window:null}function sd(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zh(t){return new IV(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EC{constructor(e,n,r=1e3,s=1.5,i=6e4){this.Mi=e,this.timerId=n,this.d_=r,this.A_=s,this.R_=i,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const n=Math.floor(this.V_+this.y_()),r=Math.max(0,Date.now()-this.f_),s=Math.max(0,n-r);s>0&&q("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.V_} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,s,()=>(this.f_=Date.now(),e())),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yI="PersistentStream";class IC{constructor(e,n,r,s,i,o,a,l){this.Mi=e,this.S_=r,this.b_=s,this.connection=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=l,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new EC(e,n)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,()=>this.k_()))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,n){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():n&&n.code===B.RESOURCE_EXHAUSTED?(hn(n.toString()),hn("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):n&&n.code===B.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(n)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),n=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,s])=>{this.D_===n&&this.G_(r,s)},r=>{e(()=>{const s=new W(B.UNKNOWN,"Fetching auth token failed: "+r.message);return this.z_(s)})})}G_(e,n){const r=this.W_(this.D_);this.stream=this.j_(e,n),this.stream.Xo(()=>{r(()=>this.listener.Xo())}),this.stream.t_(()=>{r(()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.t_()))}),this.stream.r_(s=>{r(()=>this.z_(s))}),this.stream.onMessage(s=>{r(()=>++this.F_==1?this.J_(s):this.onNext(s))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return q(yI,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return n=>{this.Mi.enqueueAndForget(()=>this.D_===e?n():(q(yI,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class TL extends IC{constructor(e,n,r,s,i,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,s,o),this.serializer=i}j_(e,n){return this.connection.T_("Listen",e,n)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const n=SV(this.serializer,e),r=function(i){if(!("targetChange"in i))return pe.min();const o=i.targetChange;return o.targetIds&&o.targetIds.length?pe.min():o.readTime?mn(o.readTime):pe.min()}(e);return this.listener.H_(n,r)}Y_(e){const n={};n.database=Gm(this.serializer),n.addTarget=function(i,o){let a;const l=o.target;if(a=Hd(l)?{documents:Xb(i,l)}:{query:Uy(i,l).ft},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=Wb(i,o.resumeToken);const d=Wm(i,o.expectedCount);d!==null&&(a.expectedCount=d)}else if(o.snapshotVersion.compareTo(pe.min())>0){a.readTime=Ea(i,o.snapshotVersion.toTimestamp());const d=Wm(i,o.expectedCount);d!==null&&(a.expectedCount=d)}return a}(this.serializer,e);const r=AV(this.serializer,e);r&&(n.labels=r),this.q_(n)}Z_(e){const n={};n.database=Gm(this.serializer),n.removeTarget=e,this.q_(n)}}class xL extends IC{constructor(e,n,r,s,i,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,s,o),this.serializer=i}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,n){return this.connection.T_("Write",e,n)}J_(e){return le(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,le(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){le(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const n=bV(e.writeResults,e.commitTime),r=mn(e.commitTime);return this.listener.na(r,n)}ra(){const e={};e.database=Gm(this.serializer),this.q_(e)}ea(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>Qd(this.serializer,r))};this.q_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SL{}class bL extends SL{constructor(e,n,r,s){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=s,this.ia=!1}sa(){if(this.ia)throw new W(B.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,n,r,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.connection.Go(e,Km(n,r),s,i,o)).catch(i=>{throw i.name==="FirebaseError"?(i.code===B.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new W(B.UNKNOWN,i.toString())})}Ho(e,n,r,s,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.Ho(e,Km(n,r),s,o,a,i)).catch(o=>{throw o.name==="FirebaseError"?(o.code===B.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new W(B.UNKNOWN,o.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}class CL{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(hn(n),this.aa=!1):q("OnlineStateTracker",n)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xi="RemoteStore";class AL{constructor(e,n,r,s,i){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=i,this.Aa.Oo(o=>{r.enqueueAndForget(async()=>{ao(this)&&(q(Xi,"Restarting streams for network reachability change."),await async function(l){const d=Ee(l);d.Ea.add(4),await Vc(d),d.Ra.set("Unknown"),d.Ea.delete(4),await ef(d)}(this))})}),this.Ra=new CL(r,s)}}async function ef(t){if(ao(t))for(const e of t.da)await e(!0)}async function Vc(t){for(const e of t.da)await e(!1)}function TC(t,e){const n=Ee(t);n.Ia.has(e.targetId)||(n.Ia.set(e.targetId,e),Xy(n)?Yy(n):Da(n).O_()&&Qy(n,e))}function Gy(t,e){const n=Ee(t),r=Da(n);n.Ia.delete(e),r.O_()&&xC(n,e),n.Ia.size===0&&(r.O_()?r.L_():ao(n)&&n.Ra.set("Unknown"))}function Qy(t,e){if(t.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(pe.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}Da(t).Y_(e)}function xC(t,e){t.Va.Ue(e),Da(t).Z_(e)}function Yy(t){t.Va=new _V({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),At:e=>t.Ia.get(e)||null,ht:()=>t.datastore.serializer.databaseId}),Da(t).start(),t.Ra.ua()}function Xy(t){return ao(t)&&!Da(t).x_()&&t.Ia.size>0}function ao(t){return Ee(t).Ea.size===0}function SC(t){t.Va=void 0}async function RL(t){t.Ra.set("Online")}async function PL(t){t.Ia.forEach((e,n)=>{Qy(t,e)})}async function NL(t,e){SC(t),Xy(t)?(t.Ra.ha(e),Yy(t)):t.Ra.set("Unknown")}async function kL(t,e,n){if(t.Ra.set("Online"),e instanceof Hb&&e.state===2&&e.cause)try{await async function(s,i){const o=i.cause;for(const a of i.targetIds)s.Ia.has(a)&&(await s.remoteSyncer.rejectListen(a,o),s.Ia.delete(a),s.Va.removeTarget(a))}(t,e)}catch(r){q(Xi,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await eh(t,r)}else if(e instanceof nd?t.Va.Ze(e):e instanceof qb?t.Va.st(e):t.Va.tt(e),!n.isEqual(pe.min()))try{const r=await vC(t.localStore);n.compareTo(r)>=0&&await function(i,o){const a=i.Va.Tt(o);return a.targetChanges.forEach((l,d)=>{if(l.resumeToken.approximateByteSize()>0){const h=i.Ia.get(d);h&&i.Ia.set(d,h.withResumeToken(l.resumeToken,o))}}),a.targetMismatches.forEach((l,d)=>{const h=i.Ia.get(l);if(!h)return;i.Ia.set(l,h.withResumeToken(Pt.EMPTY_BYTE_STRING,h.snapshotVersion)),xC(i,l);const f=new Br(h.target,l,d,h.sequenceNumber);Qy(i,f)}),i.remoteSyncer.applyRemoteEvent(a)}(t,n)}catch(r){q(Xi,"Failed to raise snapshot:",r),await eh(t,r)}}async function eh(t,e,n){if(!si(e))throw e;t.Ea.add(1),await Vc(t),t.Ra.set("Offline"),n||(n=()=>vC(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{q(Xi,"Retrying IndexedDB access"),await n(),t.Ea.delete(1),await ef(t)})}function bC(t,e){return e().catch(n=>eh(t,n,e))}async function Lc(t){const e=Ee(t),n=Ys(e);let r=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:Pi;for(;DL(e);)try{const s=await pL(e.localStore,r);if(s===null){e.Ta.length===0&&n.L_();break}r=s.batchId,jL(e,s)}catch(s){await eh(e,s)}CC(e)&&AC(e)}function DL(t){return ao(t)&&t.Ta.length<10}function jL(t,e){t.Ta.push(e);const n=Ys(t);n.O_()&&n.X_&&n.ea(e.mutations)}function CC(t){return ao(t)&&!Ys(t).x_()&&t.Ta.length>0}function AC(t){Ys(t).start()}async function OL(t){Ys(t).ra()}async function VL(t){const e=Ys(t);for(const n of t.Ta)e.ea(n.mutations)}async function LL(t,e,n){const r=t.Ta.shift(),s=Vy.from(r,e,n);await bC(t,()=>t.remoteSyncer.applySuccessfulWrite(s)),await Lc(t)}async function ML(t,e){e&&Ys(t).X_&&await async function(r,s){if(function(o){return mV(o)&&o!==B.ABORTED}(s.code)){const i=r.Ta.shift();Ys(r).B_(),await bC(r,()=>r.remoteSyncer.rejectFailedWrite(i.batchId,s)),await Lc(r)}}(t,e),CC(t)&&AC(t)}async function _I(t,e){const n=Ee(t);n.asyncQueue.verifyOperationInProgress(),q(Xi,"RemoteStore received new credentials");const r=ao(n);n.Ea.add(3),await Vc(n),r&&n.Ra.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.Ea.delete(3),await ef(n)}async function FL(t,e){const n=Ee(t);e?(n.Ea.delete(2),await ef(n)):e||(n.Ea.add(2),await Vc(n),n.Ra.set("Unknown"))}function Da(t){return t.ma||(t.ma=function(n,r,s){const i=Ee(n);return i.sa(),new TL(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Xo:RL.bind(null,t),t_:PL.bind(null,t),r_:NL.bind(null,t),H_:kL.bind(null,t)}),t.da.push(async e=>{e?(t.ma.B_(),Xy(t)?Yy(t):t.Ra.set("Unknown")):(await t.ma.stop(),SC(t))})),t.ma}function Ys(t){return t.fa||(t.fa=function(n,r,s){const i=Ee(n);return i.sa(),new xL(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Xo:()=>Promise.resolve(),t_:OL.bind(null,t),r_:ML.bind(null,t),ta:VL.bind(null,t),na:LL.bind(null,t)}),t.da.push(async e=>{e?(t.fa.B_(),await Lc(t)):(await t.fa.stop(),t.Ta.length>0&&(q(Xi,`Stopping write stream with ${t.Ta.length} pending writes`),t.Ta=[]))})),t.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jy{constructor(e,n,r,s,i){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=s,this.removalCallback=i,this.deferred=new lr,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,s,i){const o=Date.now()+r,a=new Jy(e,n,o,s,i);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new W(B.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Zy(t,e){if(hn("AsyncQueue",`${e}: ${t}`),si(t))return new W(B.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jo{static emptySet(e){return new Jo(e.comparator)}constructor(e){this.comparator=e?(n,r)=>e(n,r)||X.comparator(n.key,r.key):(n,r)=>X.comparator(n.key,r.key),this.keyedMap=gl(),this.sortedSet=new ht(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof Jo)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new Jo;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vI{constructor(){this.ga=new ht(X.comparator)}track(e){const n=e.doc.key,r=this.ga.get(n);r?e.type!==0&&r.type===3?this.ga=this.ga.insert(n,e):e.type===3&&r.type!==1?this.ga=this.ga.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.ga=this.ga.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.ga=this.ga.remove(n):e.type===1&&r.type===2?this.ga=this.ga.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):oe(63341,{Rt:e,pa:r}):this.ga=this.ga.insert(n,e)}ya(){const e=[];return this.ga.inorderTraversal((n,r)=>{e.push(r)}),e}}class Ia{constructor(e,n,r,s,i,o,a,l,d){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=l,this.hasCachedResults=d}static fromInitialDocuments(e,n,r,s,i){const o=[];return n.forEach(a=>{o.push({type:0,doc:a})}),new Ia(e,n,Jo.emptySet(n),o,r,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&qh(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let s=0;s<n.length;s++)if(n[s].type!==r[s].type||!n[s].doc.isEqual(r[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UL{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some(e=>e.Da())}}class $L{constructor(){this.queries=wI(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(n,r){const s=Ee(n),i=s.queries;s.queries=wI(),i.forEach((o,a)=>{for(const l of a.Sa)l.onError(r)})})(this,new W(B.ABORTED,"Firestore shutting down"))}}function wI(){return new rs(t=>Rb(t),qh)}async function e_(t,e){const n=Ee(t);let r=3;const s=e.query;let i=n.queries.get(s);i?!i.ba()&&e.Da()&&(r=2):(i=new UL,r=e.Da()?0:1);try{switch(r){case 0:i.wa=await n.onListen(s,!0);break;case 1:i.wa=await n.onListen(s,!1);break;case 2:await n.onFirstRemoteStoreListen(s)}}catch(o){const a=Zy(o,`Initialization of query '${bo(e.query)}' failed`);return void e.onError(a)}n.queries.set(s,i),i.Sa.push(e),e.va(n.onlineState),i.wa&&e.Fa(i.wa)&&n_(n)}async function t_(t,e){const n=Ee(t),r=e.query;let s=3;const i=n.queries.get(r);if(i){const o=i.Sa.indexOf(e);o>=0&&(i.Sa.splice(o,1),i.Sa.length===0?s=e.Da()?0:1:!i.ba()&&e.Da()&&(s=2))}switch(s){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function BL(t,e){const n=Ee(t);let r=!1;for(const s of e){const i=s.query,o=n.queries.get(i);if(o){for(const a of o.Sa)a.Fa(s)&&(r=!0);o.wa=s}}r&&n_(n)}function zL(t,e,n){const r=Ee(t),s=r.queries.get(e);if(s)for(const i of s.Sa)i.onError(n);r.queries.delete(e)}function n_(t){t.Ca.forEach(e=>{e.next()})}var tg,EI;(EI=tg||(tg={})).Ma="default",EI.Cache="cache";class r_{constructor(e,n,r){this.query=e,this.xa=n,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=r||{}}Fa(e){if(!this.options.includeMetadataChanges){const r=[];for(const s of e.docChanges)s.type!==3&&r.push(s);e=new Ia(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),n=!0):this.La(e,this.onlineState)&&(this.ka(e),n=!0),this.Na=e,n}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let n=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),n=!0),n}La(e,n){if(!e.fromCache||!this.Da())return!0;const r=n!=="Offline";return(!this.options.qa||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const n=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}ka(e){e=Ia.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==tg.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RC{constructor(e){this.key=e}}class PC{constructor(e){this.key=e}}class qL{constructor(e,n){this.query=e,this.Ya=n,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=Ae(),this.mutatedKeys=Ae(),this.eu=Pb(e),this.tu=new Jo(this.eu)}get nu(){return this.Ya}ru(e,n){const r=n?n.iu:new vI,s=n?n.tu:this.tu;let i=n?n.mutatedKeys:this.mutatedKeys,o=s,a=!1;const l=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,d=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((h,f)=>{const m=s.get(h),w=jc(this.query,f)?f:null,A=!!m&&this.mutatedKeys.has(m.key),b=!!w&&(w.hasLocalMutations||this.mutatedKeys.has(w.key)&&w.hasCommittedMutations);let P=!1;m&&w?m.data.isEqual(w.data)?A!==b&&(r.track({type:3,doc:w}),P=!0):this.su(m,w)||(r.track({type:2,doc:w}),P=!0,(l&&this.eu(w,l)>0||d&&this.eu(w,d)<0)&&(a=!0)):!m&&w?(r.track({type:0,doc:w}),P=!0):m&&!w&&(r.track({type:1,doc:m}),P=!0,(l||d)&&(a=!0)),P&&(w?(o=o.add(w),i=b?i.add(h):i.delete(h)):(o=o.delete(h),i=i.delete(h)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const h=this.query.limitType==="F"?o.last():o.first();o=o.delete(h.key),i=i.delete(h.key),r.track({type:1,doc:h})}return{tu:o,iu:r,Cs:a,mutatedKeys:i}}su(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,s){const i=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const o=e.iu.ya();o.sort((h,f)=>function(w,A){const b=P=>{switch(P){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return oe(20277,{Rt:P})}};return b(w)-b(A)}(h.type,f.type)||this.eu(h.doc,f.doc)),this.ou(r),s=s??!1;const a=n&&!s?this._u():[],l=this.Xa.size===0&&this.current&&!s?1:0,d=l!==this.Za;return this.Za=l,o.length!==0||d?{snapshot:new Ia(this.query,e.tu,i,o,e.mutatedKeys,l===0,d,!1,!!r&&r.resumeToken.approximateByteSize()>0),au:a}:{au:a}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new vI,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(n=>this.Ya=this.Ya.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Ya=this.Ya.delete(n)),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=Ae(),this.tu.forEach(r=>{this.uu(r.key)&&(this.Xa=this.Xa.add(r.key))});const n=[];return e.forEach(r=>{this.Xa.has(r)||n.push(new PC(r))}),this.Xa.forEach(r=>{e.has(r)||n.push(new RC(r))}),n}cu(e){this.Ya=e.Qs,this.Xa=Ae();const n=this.ru(e.documents);return this.applyChanges(n,!0)}lu(){return Ia.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const s_="SyncEngine";class HL{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class WL{constructor(e){this.key=e,this.hu=!1}}class KL{constructor(e,n,r,s,i,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.Pu={},this.Tu=new rs(a=>Rb(a),qh),this.Iu=new Map,this.Eu=new Set,this.du=new ht(X.comparator),this.Au=new Map,this.Ru=new zy,this.Vu={},this.mu=new Map,this.fu=Yi.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function GL(t,e,n=!0){const r=VC(t);let s;const i=r.Tu.get(e);return i?(r.sharedClientState.addLocalQueryTarget(i.targetId),s=i.view.lu()):s=await NC(r,e,n,!0),s}async function QL(t,e){const n=VC(t);await NC(n,e,!0,!1)}async function NC(t,e,n,r){const s=await mL(t.localStore,Kn(e)),i=s.targetId,o=t.sharedClientState.addLocalQueryTarget(i,n);let a;return r&&(a=await YL(t,e,i,o==="current",s.resumeToken)),t.isPrimaryClient&&n&&TC(t.remoteStore,s),a}async function YL(t,e,n,r,s){t.pu=(f,m,w)=>async function(b,P,I,E){let y=P.view.ru(I);y.Cs&&(y=await fI(b.localStore,P.query,!1).then(({documents:T})=>P.view.ru(T,y)));const j=E&&E.targetChanges.get(P.targetId),V=E&&E.targetMismatches.get(P.targetId)!=null,M=P.view.applyChanges(y,b.isPrimaryClient,j,V);return TI(b,P.targetId,M.au),M.snapshot}(t,f,m,w);const i=await fI(t.localStore,e,!0),o=new qL(e,i.Qs),a=o.ru(i.documents),l=Oc.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",s),d=o.applyChanges(a,t.isPrimaryClient,l);TI(t,n,d.au);const h=new HL(e,n,o);return t.Tu.set(e,h),t.Iu.has(n)?t.Iu.get(n).push(e):t.Iu.set(n,[e]),d.snapshot}async function XL(t,e,n){const r=Ee(t),s=r.Tu.get(e),i=r.Iu.get(s.targetId);if(i.length>1)return r.Iu.set(s.targetId,i.filter(o=>!qh(o,e))),void r.Tu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(s.targetId),r.sharedClientState.isActiveQueryTarget(s.targetId)||await Zm(r.localStore,s.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(s.targetId),n&&Gy(r.remoteStore,s.targetId),ng(r,s.targetId)}).catch(oo)):(ng(r,s.targetId),await Zm(r.localStore,s.targetId,!0))}async function JL(t,e){const n=Ee(t),r=n.Tu.get(e),s=n.Iu.get(r.targetId);n.isPrimaryClient&&s.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),Gy(n.remoteStore,r.targetId))}async function ZL(t,e,n){const r=LC(t);try{const s=await function(o,a){const l=Ee(o),d=$e.now(),h=a.reduce((w,A)=>w.add(A.key),Ae());let f,m;return l.persistence.runTransaction("Locally write mutations","readwrite",w=>{let A=kn(),b=Ae();return l.Ns.getEntries(w,h).next(P=>{A=P,A.forEach((I,E)=>{E.isValidDocument()||(b=b.add(I))})}).next(()=>l.localDocuments.getOverlayedDocuments(w,A)).next(P=>{f=P;const I=[];for(const E of a){const y=hV(E,f.get(E.key).overlayedDocument);y!=null&&I.push(new ss(E.key,y,wb(y.value.mapValue),on.exists(!0)))}return l.mutationQueue.addMutationBatch(w,d,I,a)}).next(P=>{m=P;const I=P.applyToLocalDocumentSet(f,b);return l.documentOverlayCache.saveOverlays(w,P.batchId,I)})}).then(()=>({batchId:m.batchId,changes:kb(f)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(s.batchId),function(o,a,l){let d=o.Vu[o.currentUser.toKey()];d||(d=new ht(xe)),d=d.insert(a,l),o.Vu[o.currentUser.toKey()]=d}(r,s.batchId,n),await Mc(r,s.changes),await Lc(r.remoteStore)}catch(s){const i=Zy(s,"Failed to persist write");n.reject(i)}}async function kC(t,e){const n=Ee(t);try{const r=await hL(n.localStore,e);e.targetChanges.forEach((s,i)=>{const o=n.Au.get(i);o&&(le(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1,22616),s.addedDocuments.size>0?o.hu=!0:s.modifiedDocuments.size>0?le(o.hu,14607):s.removedDocuments.size>0&&(le(o.hu,42227),o.hu=!1))}),await Mc(n,r,e)}catch(r){await oo(r)}}function II(t,e,n){const r=Ee(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const s=[];r.Tu.forEach((i,o)=>{const a=o.view.va(e);a.snapshot&&s.push(a.snapshot)}),function(o,a){const l=Ee(o);l.onlineState=a;let d=!1;l.queries.forEach((h,f)=>{for(const m of f.Sa)m.va(a)&&(d=!0)}),d&&n_(l)}(r.eventManager,e),s.length&&r.Pu.H_(s),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function eM(t,e,n){const r=Ee(t);r.sharedClientState.updateQueryState(e,"rejected",n);const s=r.Au.get(e),i=s&&s.key;if(i){let o=new ht(X.comparator);o=o.insert(i,wt.newNoDocument(i,pe.min()));const a=Ae().add(i),l=new Qh(pe.min(),new Map,new ht(xe),o,a);await kC(r,l),r.du=r.du.remove(i),r.Au.delete(e),i_(r)}else await Zm(r.localStore,e,!1).then(()=>ng(r,e,n)).catch(oo)}async function tM(t,e){const n=Ee(t),r=e.batch.batchId;try{const s=await dL(n.localStore,e);jC(n,r,null),DC(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await Mc(n,s)}catch(s){await oo(s)}}async function nM(t,e,n){const r=Ee(t);try{const s=await function(o,a){const l=Ee(o);return l.persistence.runTransaction("Reject batch","readwrite-primary",d=>{let h;return l.mutationQueue.lookupMutationBatch(d,a).next(f=>(le(f!==null,37113),h=f.keys(),l.mutationQueue.removeMutationBatch(d,f))).next(()=>l.mutationQueue.performConsistencyCheck(d)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(d,h,a)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(d,h)).next(()=>l.localDocuments.getDocuments(d,h))})}(r.localStore,e);jC(r,e,n),DC(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await Mc(r,s)}catch(s){await oo(s)}}function DC(t,e){(t.mu.get(e)||[]).forEach(n=>{n.resolve()}),t.mu.delete(e)}function jC(t,e,n){const r=Ee(t);let s=r.Vu[r.currentUser.toKey()];if(s){const i=s.get(e);i&&(n?i.reject(n):i.resolve(),s=s.remove(e)),r.Vu[r.currentUser.toKey()]=s}}function ng(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Iu.get(e))t.Tu.delete(r),n&&t.Pu.yu(r,n);t.Iu.delete(e),t.isPrimaryClient&&t.Ru.jr(e).forEach(r=>{t.Ru.containsKey(r)||OC(t,r)})}function OC(t,e){t.Eu.delete(e.path.canonicalString());const n=t.du.get(e);n!==null&&(Gy(t.remoteStore,n),t.du=t.du.remove(e),t.Au.delete(n),i_(t))}function TI(t,e,n){for(const r of n)r instanceof RC?(t.Ru.addReference(r.key,e),rM(t,r)):r instanceof PC?(q(s_,"Document no longer in limbo: "+r.key),t.Ru.removeReference(r.key,e),t.Ru.containsKey(r.key)||OC(t,r.key)):oe(19791,{wu:r})}function rM(t,e){const n=e.key,r=n.path.canonicalString();t.du.get(n)||t.Eu.has(r)||(q(s_,"New document in limbo: "+n),t.Eu.add(r),i_(t))}function i_(t){for(;t.Eu.size>0&&t.du.size<t.maxConcurrentLimboResolutions;){const e=t.Eu.values().next().value;t.Eu.delete(e);const n=new X(ze.fromString(e)),r=t.fu.next();t.Au.set(r,new WL(n)),t.du=t.du.insert(n,r),TC(t.remoteStore,new Br(Kn(Dc(n.path)),r,"TargetPurposeLimboResolution",Hn.ce))}}async function Mc(t,e,n){const r=Ee(t),s=[],i=[],o=[];r.Tu.isEmpty()||(r.Tu.forEach((a,l)=>{o.push(r.pu(l,e,n).then(d=>{var h;if((d||n)&&r.isPrimaryClient){const f=d?!d.fromCache:(h=n==null?void 0:n.targetChanges.get(l.targetId))==null?void 0:h.current;r.sharedClientState.updateQueryState(l.targetId,f?"current":"not-current")}if(d){s.push(d);const f=Wy.As(l.targetId,d);i.push(f)}}))}),await Promise.all(o),r.Pu.H_(s),await async function(l,d){const h=Ee(l);try{await h.persistence.runTransaction("notifyLocalViewChanges","readwrite",f=>O.forEach(d,m=>O.forEach(m.Es,w=>h.persistence.referenceDelegate.addReference(f,m.targetId,w)).next(()=>O.forEach(m.ds,w=>h.persistence.referenceDelegate.removeReference(f,m.targetId,w)))))}catch(f){if(!si(f))throw f;q(Ky,"Failed to update sequence numbers: "+f)}for(const f of d){const m=f.targetId;if(!f.fromCache){const w=h.Ms.get(m),A=w.snapshotVersion,b=w.withLastLimboFreeSnapshotVersion(A);h.Ms=h.Ms.insert(m,b)}}}(r.localStore,i))}async function sM(t,e){const n=Ee(t);if(!n.currentUser.isEqual(e)){q(s_,"User change. New user:",e.toKey());const r=await _C(n.localStore,e);n.currentUser=e,function(i,o){i.mu.forEach(a=>{a.forEach(l=>{l.reject(new W(B.CANCELLED,o))})}),i.mu.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await Mc(n,r.Ls)}}function iM(t,e){const n=Ee(t),r=n.Au.get(e);if(r&&r.hu)return Ae().add(r.key);{let s=Ae();const i=n.Iu.get(e);if(!i)return s;for(const o of i){const a=n.Tu.get(o);s=s.unionWith(a.view.nu)}return s}}function VC(t){const e=Ee(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=kC.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=iM.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=eM.bind(null,e),e.Pu.H_=BL.bind(null,e.eventManager),e.Pu.yu=zL.bind(null,e.eventManager),e}function LC(t){const e=Ee(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=tM.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=nM.bind(null,e),e}class _c{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Zh(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,n){return null}Mu(e,n){return null}vu(e){return yC(this.persistence,new gC,e.initialUser,this.serializer)}Cu(e){return new qy(Jh.mi,this.serializer)}Du(e){return new wC}async terminate(){var e,n;(e=this.gcScheduler)==null||e.stop(),(n=this.indexBackfillerScheduler)==null||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}_c.provider={build:()=>new _c};class oM extends _c{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,n){le(this.persistence.referenceDelegate instanceof Zd,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new dC(r,e.asyncQueue,n)}Cu(e){const n=this.cacheSizeBytes!==void 0?nn.withCacheSize(this.cacheSizeBytes):nn.DEFAULT;return new qy(r=>Zd.mi(r,n),this.serializer)}}class aM extends _c{constructor(e,n,r){super(),this.xu=e,this.cacheSizeBytes=n,this.forceOwnership=r,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.xu.initialize(this,e),await LC(this.xu.syncEngine),await Lc(this.xu.remoteStore),await this.persistence.Ji(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}vu(e){return yC(this.persistence,new gC,e.initialUser,this.serializer)}Fu(e,n){const r=this.persistence.referenceDelegate.garbageCollector;return new dC(r,e.asyncQueue,n)}Mu(e,n){const r=new dO(n,this.persistence);return new uO(e.asyncQueue,r)}Cu(e){const n=aL(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?nn.withCacheSize(this.cacheSizeBytes):nn.DEFAULT;return new Hy(this.synchronizeTabs,n,e.clientId,r,e.asyncQueue,IL(),sd(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Du(e){return new wC}}class th{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>II(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=sM.bind(null,this.syncEngine),await FL(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new $L}()}createDatastore(e){const n=Zh(e.databaseInfo.databaseId),r=function(i){return new EL(i)}(e.databaseInfo);return function(i,o,a,l){return new bL(i,o,a,l)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,s,i,o,a){return new AL(r,s,i,o,a)}(this.localStore,this.datastore,e.asyncQueue,n=>II(this.syncEngine,n,0),function(){return gI.v()?new gI:new yL}())}createSyncEngine(e,n){return function(s,i,o,a,l,d,h){const f=new KL(s,i,o,a,l,d);return h&&(f.gu=!0),f}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(s){const i=Ee(s);q(Xi,"RemoteStore shutting down."),i.Ea.add(5),await Vc(i),i.Aa.shutdown(),i.Ra.set("Unknown")}(this.remoteStore),(e=this.datastore)==null||e.terminate(),(n=this.eventManager)==null||n.terminate()}}th.provider={build:()=>new th};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class o_{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):hn("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xs="FirestoreClient";class lM{constructor(e,n,r,s,i){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=s,this.user=Ht.UNAUTHENTICATED,this.clientId=Ty.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(r,async o=>{q(Xs,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>(q(Xs,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new lr;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=Zy(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function yp(t,e){t.asyncQueue.verifyOperationInProgress(),q(Xs,"Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async s=>{r.isEqual(s)||(await _C(e.localStore,s),r=s)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function xI(t,e){t.asyncQueue.verifyOperationInProgress();const n=await cM(t);q(Xs,"Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>_I(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,s)=>_I(e.remoteStore,s)),t._onlineComponents=e}async function cM(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){q(Xs,"Using user provided OfflineComponentProvider");try{await yp(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(s){return s.name==="FirebaseError"?s.code===B.FAILED_PRECONDITION||s.code===B.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(n))throw n;zi("Error using user provided cache. Falling back to memory cache: "+n),await yp(t,new _c)}}else q(Xs,"Using default OfflineComponentProvider"),await yp(t,new oM(void 0));return t._offlineComponents}async function a_(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(q(Xs,"Using user provided OnlineComponentProvider"),await xI(t,t._uninitializedComponentsProvider._online)):(q(Xs,"Using default OnlineComponentProvider"),await xI(t,new th))),t._onlineComponents}function uM(t){return a_(t).then(e=>e.syncEngine)}function dM(t){return a_(t).then(e=>e.datastore)}async function nh(t){const e=await a_(t),n=e.eventManager;return n.onListen=GL.bind(null,e.syncEngine),n.onUnlisten=XL.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=QL.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=JL.bind(null,e.syncEngine),n}function hM(t,e,n={}){const r=new lr;return t.asyncQueue.enqueueAndForget(async()=>function(i,o,a,l,d){const h=new o_({next:m=>{h.Nu(),o.enqueueAndForget(()=>t_(i,f));const w=m.docs.has(a);!w&&m.fromCache?d.reject(new W(B.UNAVAILABLE,"Failed to get document because the client is offline.")):w&&m.fromCache&&l&&l.source==="server"?d.reject(new W(B.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):d.resolve(m)},error:m=>d.reject(m)}),f=new r_(Dc(a.path),h,{includeMetadataChanges:!0,qa:!0});return e_(i,f)}(await nh(t),t.asyncQueue,e,n,r)),r.promise}function fM(t,e,n={}){const r=new lr;return t.asyncQueue.enqueueAndForget(async()=>function(i,o,a,l,d){const h=new o_({next:m=>{h.Nu(),o.enqueueAndForget(()=>t_(i,f)),m.fromCache&&l.source==="server"?d.reject(new W(B.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):d.resolve(m)},error:m=>d.reject(m)}),f=new r_(a,h,{includeMetadataChanges:!0,qa:!0});return e_(i,f)}(await nh(t),t.asyncQueue,e,n,r)),r.promise}function pM(t,e,n){const r=new lr;return t.asyncQueue.enqueueAndForget(async()=>{try{const s=await dM(t);r.resolve(async function(o,a,l){var b;const d=Ee(o),{request:h,gt:f,parent:m}=CV(d.serializer,ZO(a),l);d.connection.$o||delete h.parent;const w=(await d.Ho("RunAggregationQuery",d.serializer.databaseId,m,h,1)).filter(P=>!!P.result);le(w.length===1,64727);const A=(b=w[0].result)==null?void 0:b.aggregateFields;return Object.keys(A).reduce((P,I)=>(P[f[I]]=A[I],P),{})}(s,e,n))}catch(s){r.reject(s)}}),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function MC(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SI=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FC="firestore.googleapis.com",bI=!0;class CI{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new W(B.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=FC,this.ssl=bI}else this.host=e.host,this.ssl=e.ssl??bI;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=aC;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<qV)throw new W(B.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}iO("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=MC(e.experimentalLongPollingOptions??{}),function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new W(B.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new W(B.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new W(B.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,s){return r.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class tf{constructor(e,n,r,s){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new CI({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new W(B.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new W(B.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new CI(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new Q2;switch(r.type){case"firstParty":return new Z2(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new W(B.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=SI.get(n);r&&(q("ComponentProvider","Removing Datastore"),SI.delete(n),r.terminate())}(this),Promise.resolve()}}function mM(t,e,n,r={}){var d;t=an(t,tf);const s=ti(e),i=t._getSettings(),o={...i,emulatorOptions:t._getEmulatorOptions()},a=`${e}:${n}`;s&&(ly(`https://${a}`),cy("Firestore",!0)),i.host!==FC&&i.host!==a&&zi("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const l={...i,host:a,ssl:s,emulatorOptions:r};if(!Yr(l,o)&&(t._setSettings(l),r.mockUserToken)){let h,f;if(typeof r.mockUserToken=="string")h=r.mockUserToken,f=Ht.MOCK_USER;else{h=Gx(r.mockUserToken,(d=t._app)==null?void 0:d.options.projectId);const m=r.mockUserToken.sub||r.mockUserToken.user_id;if(!m)throw new W(B.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");f=new Ht(m)}t._authCredentials=new Y2(new KS(h,f))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pr{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new pr(this.firestore,e,this._query)}}class Et{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new qs(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Et(this.firestore,e,this._key)}toJSON(){return{type:Et._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,n,r){if(Pc(n,Et._jsonSchema))return new Et(e,r||null,new X(ze.fromString(n.referencePath)))}}Et._jsonSchemaVersion="firestore/documentReference/1.0",Et._jsonSchema={type:Rt("string",Et._jsonSchemaVersion),referencePath:Rt("string")};class qs extends pr{constructor(e,n,r){super(e,n,Dc(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Et(this.firestore,null,new X(e))}withConverter(e){return new qs(this.firestore,e,this._path)}}function Ue(t,e,...n){if(t=Ke(t),QS("collection","path",e),t instanceof tf){const r=ze.fromString(e,...n);return yE(r),new qs(t,null,r)}{if(!(t instanceof Et||t instanceof qs))throw new W(B.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(ze.fromString(e,...n));return yE(r),new qs(t.firestore,null,r)}}function Gt(t,e,...n){if(t=Ke(t),arguments.length===1&&(e=Ty.newId()),QS("doc","path",e),t instanceof tf){const r=ze.fromString(e,...n);return gE(r),new Et(t,null,new X(r))}{if(!(t instanceof Et||t instanceof qs))throw new W(B.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(ze.fromString(e,...n));return gE(r),new Et(t.firestore,t instanceof qs?t.converter:null,new X(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AI="AsyncQueue";class RI{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new EC(this,"async_queue_retry"),this._c=()=>{const r=sd();r&&q(AI,"Visibility state changed to "+r.visibilityState),this.M_.w_()},this.ac=e;const n=sd();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const n=sd();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});const n=new lr;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Xu.push(e),this.lc()))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!si(e))throw e;q(AI,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){const n=this.ac.then(()=>(this.rc=!0,e().catch(r=>{throw this.nc=r,this.rc=!1,hn("INTERNAL UNHANDLED ERROR: ",PI(r)),r}).then(r=>(this.rc=!1,r))));return this.ac=n,n}enqueueAfterDelay(e,n,r){this.uc(),this.oc.indexOf(e)>-1&&(n=0);const s=Jy.createAndSchedule(this,e,n,r,i=>this.hc(i));return this.tc.push(s),s}uc(){this.nc&&oe(47125,{Pc:PI(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const n of this.tc)if(n.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.tc)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.Tc()})}dc(e){this.oc.push(e)}hc(e){const n=this.tc.indexOf(e);this.tc.splice(n,1)}}function PI(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NI(t){return function(n,r){if(typeof n!="object"||n===null)return!1;const s=n;for(const i of r)if(i in s&&typeof s[i]=="function")return!0;return!1}(t,["next","error","complete"])}class hr extends tf{constructor(e,n,r,s){super(e,n,r,s),this.type="firestore",this._queue=new RI,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new RI(e),this._firestoreClient=void 0,await e}}}function UC(t,e){const n=typeof t=="object"?t:Ph(),r=typeof t=="string"?t:qd,s=ni(n,"firestore").getImmediate({identifier:r});if(!s._initialized){const i=Hx("firestore");i&&mM(s,...i)}return s}function Fc(t){if(t._terminated)throw new W(B.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||$C(t),t._firestoreClient}function $C(t){var r,s,i;const e=t._freezeSettings(),n=function(a,l,d,h){return new $O(a,l,d,h.host,h.ssl,h.experimentalForceLongPolling,h.experimentalAutoDetectLongPolling,MC(h.experimentalLongPollingOptions),h.useFetchStreams,h.isUsingEmulator)}(t._databaseId,((r=t._app)==null?void 0:r.options.appId)||"",t._persistenceKey,e);t._componentsProvider||(s=e.localCache)!=null&&s._offlineComponentProvider&&((i=e.localCache)!=null&&i._onlineComponentProvider)&&(t._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),t._firestoreClient=new lM(t._authCredentials,t._appCheckCredentials,t._queue,n,t._componentsProvider&&function(a){const l=a==null?void 0:a._online.build();return{_offline:a==null?void 0:a._offline.build(l),_online:l}}(t._componentsProvider))}function gM(t,e){zi("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const n=t._freezeSettings();return yM(t,th.provider,{build:r=>new aM(r,n.cacheSizeBytes,e==null?void 0:e.forceOwnership)}),Promise.resolve()}function yM(t,e,n){if((t=an(t,hr))._firestoreClient||t._terminated)throw new W(B.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(t._componentsProvider||t._getSettings().localCache)throw new W(B.FAILED_PRECONDITION,"SDK cache is already specified.");t._componentsProvider={_online:e,_offline:n},$C(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _M{constructor(e="count",n){this._internalFieldPath=n,this.type="AggregateField",this.aggregateType=e}}class vM{constructor(e,n,r){this._userDataWriter=n,this._data=r,this.type="AggregateQuerySnapshot",this.query=e}data(){return this._userDataWriter.convertObjectMap(this._data)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zn{constructor(e){this._byteString=e}static fromBase64String(e){try{return new zn(Pt.fromBase64String(e))}catch(n){throw new W(B.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new zn(Pt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:zn._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Pc(e,zn._jsonSchema))return zn.fromBase64String(e.bytes)}}zn._jsonSchemaVersion="firestore/bytes/1.0",zn._jsonSchema={type:Rt("string",zn._jsonSchemaVersion),bytes:Rt("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nf{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new W(B.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new mt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ja{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kr{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new W(B.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new W(B.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return xe(this._lat,e._lat)||xe(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:kr._jsonSchemaVersion}}static fromJSON(e){if(Pc(e,kr._jsonSchema))return new kr(e.latitude,e.longitude)}}kr._jsonSchemaVersion="firestore/geoPoint/1.0",kr._jsonSchema={type:Rt("string",kr._jsonSchemaVersion),latitude:Rt("number"),longitude:Rt("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dr{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,s){if(r.length!==s.length)return!1;for(let i=0;i<r.length;++i)if(r[i]!==s[i])return!1;return!0}(this._values,e._values)}toJSON(){return{type:Dr._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Pc(e,Dr._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(n=>typeof n=="number"))return new Dr(e.vectorValues);throw new W(B.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Dr._jsonSchemaVersion="firestore/vectorValue/1.0",Dr._jsonSchema={type:Rt("string",Dr._jsonSchemaVersion),vectorValues:Rt("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wM=/^__.*__$/;class EM{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new ss(e,this.data,this.fieldMask,n,this.fieldTransforms):new ka(e,this.data,n,this.fieldTransforms)}}class BC{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new ss(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function zC(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw oe(40011,{Ac:t})}}class rf{constructor(e,n,r,s,i,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=s,i===void 0&&this.Rc(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new rf({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){var s;const n=(s=this.path)==null?void 0:s.child(e),r=this.Vc({path:n,fc:!1});return r.gc(e),r}yc(e){var s;const n=(s=this.path)==null?void 0:s.child(e),r=this.Vc({path:n,fc:!1});return r.Rc(),r}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return rh(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(zC(this.Ac)&&wM.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class IM{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||Zh(e)}Cc(e,n,r,s=!1){return new rf({Ac:e,methodName:n,Dc:r,path:mt.emptyPath(),fc:!1,bc:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Uc(t){const e=t._freezeSettings(),n=Zh(t._databaseId);return new IM(t._databaseId,!!e.ignoreUndefinedProperties,n)}function qC(t,e,n,r,s,i={}){const o=t.Cc(i.merge||i.mergeFields?2:0,e,n,s);d_("Data must be an object, but it was:",o,r);const a=WC(r,o);let l,d;if(i.merge)l=new In(o.fieldMask),d=o.fieldTransforms;else if(i.mergeFields){const h=[];for(const f of i.mergeFields){const m=rg(e,f,n);if(!o.contains(m))throw new W(B.INVALID_ARGUMENT,`Field '${m}' is specified in your field mask but missing from your input data.`);GC(h,m)||h.push(m)}l=new In(h),d=o.fieldTransforms.filter(f=>l.covers(f.field))}else l=null,d=o.fieldTransforms;return new EM(new sn(a),l,d)}class sf extends ja{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof sf}}function TM(t,e,n){return new rf({Ac:3,Dc:e.settings.Dc,methodName:t._methodName,fc:n},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class l_ extends ja{_toFieldTransform(e){return new Wh(e.path,new _a)}isEqual(e){return e instanceof l_}}class c_ extends ja{constructor(e,n){super(e),this.vc=n}_toFieldTransform(e){const n=TM(this,e,!0),r=this.vc.map(i=>Oa(i,n)),s=new Ki(r);return new Wh(e.path,s)}isEqual(e){return e instanceof c_&&Yr(this.vc,e.vc)}}class u_ extends ja{constructor(e,n){super(e),this.Fc=n}_toFieldTransform(e){const n=new wa(e.serializer,Ob(e.serializer,this.Fc));return new Wh(e.path,n)}isEqual(e){return e instanceof u_&&this.Fc===e.Fc}}function xM(t,e,n,r){const s=t.Cc(1,e,n);d_("Data must be an object, but it was:",s,r);const i=[],o=sn.empty();ii(r,(l,d)=>{const h=h_(e,l,n);d=Ke(d);const f=s.yc(h);if(d instanceof sf)i.push(h);else{const m=Oa(d,f);m!=null&&(i.push(h),o.set(h,m))}});const a=new In(i);return new BC(o,a,s.fieldTransforms)}function SM(t,e,n,r,s,i){const o=t.Cc(1,e,n),a=[rg(e,r,n)],l=[s];if(i.length%2!=0)throw new W(B.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let m=0;m<i.length;m+=2)a.push(rg(e,i[m])),l.push(i[m+1]);const d=[],h=sn.empty();for(let m=a.length-1;m>=0;--m)if(!GC(d,a[m])){const w=a[m];let A=l[m];A=Ke(A);const b=o.yc(w);if(A instanceof sf)d.push(w);else{const P=Oa(A,b);P!=null&&(d.push(w),h.set(w,P))}}const f=new In(d);return new BC(h,f,o.fieldTransforms)}function HC(t,e,n,r=!1){return Oa(n,t.Cc(r?4:3,e))}function Oa(t,e){if(KC(t=Ke(t)))return d_("Unsupported field value:",e,t),WC(t,e);if(t instanceof ja)return function(r,s){if(!zC(s.Ac))throw s.Sc(`${r._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Sc(`${r._methodName}() is not currently supported inside arrays`);const i=r._toFieldTransform(s);i&&s.fieldTransforms.push(i)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return function(r,s){const i=[];let o=0;for(const a of r){let l=Oa(a,s.wc(o));l==null&&(l={nullValue:"NULL_VALUE"}),i.push(l),o++}return{arrayValue:{values:i}}}(t,e)}return function(r,s){if((r=Ke(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return Ob(s.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const i=$e.fromDate(r);return{timestampValue:Ea(s.serializer,i)}}if(r instanceof $e){const i=new $e(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Ea(s.serializer,i)}}if(r instanceof kr)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof zn)return{bytesValue:Wb(s.serializer,r._byteString)};if(r instanceof Et){const i=s.databaseId,o=r.firestore._databaseId;if(!o.isEqual(i))throw s.Sc(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:Fy(r.firestore._databaseId||s.databaseId,r._key.path)}}if(r instanceof Dr)return function(o,a){return{mapValue:{fields:{[Py]:{stringValue:Ny},[ma]:{arrayValue:{values:o.toArray().map(d=>{if(typeof d!="number")throw a.Sc("VectorValues must only contain numeric values.");return jy(a.serializer,d)})}}}}}}(r,s);throw s.Sc(`Unsupported field value: ${Oh(r)}`)}(t,e)}function WC(t,e){const n={};return db(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):ii(t,(r,s)=>{const i=Oa(s,e.mc(r));i!=null&&(n[r]=i)}),{mapValue:{fields:n}}}function KC(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof $e||t instanceof kr||t instanceof zn||t instanceof Et||t instanceof ja||t instanceof Dr)}function d_(t,e,n){if(!KC(n)||!YS(n)){const r=Oh(n);throw r==="an object"?e.Sc(t+" a custom object"):e.Sc(t+" "+r)}}function rg(t,e,n){if((e=Ke(e))instanceof nf)return e._internalPath;if(typeof e=="string")return h_(t,e);throw rh("Field path arguments must be of type string or ",t,!1,void 0,n)}const bM=new RegExp("[~\\*/\\[\\]]");function h_(t,e,n){if(e.search(bM)>=0)throw rh(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new nf(...e.split("."))._internalPath}catch{throw rh(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function rh(t,e,n,r,s){const i=r&&!r.isEmpty(),o=s!==void 0;let a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let l="";return(i||o)&&(l+=" (found",i&&(l+=` in field ${r}`),o&&(l+=` in document ${s}`),l+=")"),new W(B.INVALID_ARGUMENT,a+t+l)}function GC(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f_{constructor(e,n,r,s,i){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new Et(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new CM(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(of("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class CM extends f_{data(){return super.data()}}function of(t,e){return typeof e=="string"?h_(t,e):e instanceof nf?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function QC(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new W(B.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class p_{}class $c extends p_{}function nt(t,e,...n){let r=[];e instanceof p_&&r.push(e),r=r.concat(n),function(i){const o=i.filter(l=>l instanceof m_).length,a=i.filter(l=>l instanceof af).length;if(o>1||o>0&&a>0)throw new W(B.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const s of r)t=s._apply(t);return t}class af extends $c{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new af(e,n,r)}_apply(e){const n=this._parse(e);return XC(e._query,n),new pr(e.firestore,e.converter,Hm(e._query,n))}_parse(e){const n=Uc(e.firestore);return function(i,o,a,l,d,h,f){let m;if(d.isKeyField()){if(h==="array-contains"||h==="array-contains-any")throw new W(B.INVALID_ARGUMENT,`Invalid Query. You can't perform '${h}' queries on documentId().`);if(h==="in"||h==="not-in"){OI(f,h);const A=[];for(const b of f)A.push(jI(l,i,b));m={arrayValue:{values:A}}}else m=jI(l,i,f)}else h!=="in"&&h!=="not-in"&&h!=="array-contains-any"||OI(f,h),m=HC(a,o,f,h==="in"||h==="not-in");return je.create(d,h,m)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function Qe(t,e,n){const r=e,s=of("where",t);return af._create(s,r,n)}class m_ extends p_{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new m_(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:Ye.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(s,i){let o=s;const a=i.getFlattenedFilters();for(const l of a)XC(o,l),o=Hm(o,l)}(e._query,n),new pr(e.firestore,e.converter,Hm(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class g_ extends $c{constructor(e,n){super(),this._field=e,this._direction=n,this.type="orderBy"}static _create(e,n){return new g_(e,n)}_apply(e){const n=function(s,i,o){if(s.startAt!==null)throw new W(B.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(s.endAt!==null)throw new W(B.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new yc(i,o)}(e._query,this._field,this._direction);return new pr(e.firestore,e.converter,function(s,i){const o=s.explicitOrderBy.concat([i]);return new oi(s.path,s.collectionGroup,o,s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt)}(e._query,n))}}function Qt(t,e="asc"){const n=e,r=of("orderBy",t);return g_._create(r,n)}class y_ extends $c{constructor(e,n,r){super(),this.type=e,this._limit=n,this._limitType=r}static _create(e,n,r){return new y_(e,n,r)}_apply(e){return new pr(e.firestore,e.converter,Kd(e._query,this._limit,this._limitType))}}function Zo(t){return oO("limit",t),y_._create("limit",t,"F")}class lf extends $c{constructor(e,n,r){super(),this.type=e,this._docOrFields=n,this._inclusive=r}static _create(e,n,r){return new lf(e,n,r)}_apply(e){const n=YC(e,this.type,this._docOrFields,this._inclusive);return new pr(e.firestore,e.converter,function(s,i){return new oi(s.path,s.collectionGroup,s.explicitOrderBy.slice(),s.filters.slice(),s.limit,s.limitType,i,s.endAt)}(e._query,n))}}function kI(...t){return lf._create("startAt",t,!0)}function AM(...t){return lf._create("startAfter",t,!1)}class __ extends $c{constructor(e,n,r){super(),this.type=e,this._docOrFields=n,this._inclusive=r}static _create(e,n,r){return new __(e,n,r)}_apply(e){const n=YC(e,this.type,this._docOrFields,this._inclusive);return new pr(e.firestore,e.converter,function(s,i){return new oi(s.path,s.collectionGroup,s.explicitOrderBy.slice(),s.filters.slice(),s.limit,s.limitType,s.startAt,i)}(e._query,n))}}function DI(...t){return __._create("endAt",t,!0)}function YC(t,e,n,r){if(n[0]=Ke(n[0]),n[0]instanceof f_)return function(i,o,a,l,d){if(!l)throw new W(B.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${a}().`);const h=[];for(const f of Xo(i))if(f.field.isKeyField())h.push(Hi(o,l.key));else{const m=l.data.field(f.field);if($h(m))throw new W(B.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+f.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(m===null){const w=f.field.canonicalString();throw new W(B.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${w}' (used as the orderBy) does not exist.`)}h.push(m)}return new Qs(h,d)}(t._query,t.firestore._databaseId,e,n[0]._document,r);{const s=Uc(t.firestore);return function(o,a,l,d,h,f){const m=o.explicitOrderBy;if(h.length>m.length)throw new W(B.INVALID_ARGUMENT,`Too many arguments provided to ${d}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const w=[];for(let A=0;A<h.length;A++){const b=h[A];if(m[A].field.isKeyField()){if(typeof b!="string")throw new W(B.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${d}(), but got a ${typeof b}`);if(!Dy(o)&&b.indexOf("/")!==-1)throw new W(B.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${d}() must be a plain document ID, but '${b}' contains a slash.`);const P=o.path.child(ze.fromString(b));if(!X.isDocumentKey(P))throw new W(B.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${d}() must result in a valid document path, but '${P}' is not because it contains an odd number of segments.`);const I=new X(P);w.push(Hi(a,I))}else{const P=HC(l,d,b);w.push(P)}}return new Qs(w,f)}(t._query,t.firestore._databaseId,s,e,n,r)}}function jI(t,e,n){if(typeof(n=Ke(n))=="string"){if(n==="")throw new W(B.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Dy(e)&&n.indexOf("/")!==-1)throw new W(B.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(ze.fromString(n));if(!X.isDocumentKey(r))throw new W(B.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Hi(t,new X(r))}if(n instanceof Et)return Hi(t,n._key);throw new W(B.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Oh(n)}.`)}function OI(t,e){if(!Array.isArray(t)||t.length===0)throw new W(B.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function XC(t,e){const n=function(s,i){for(const o of s)for(const a of o.getFlattenedFilters())if(i.indexOf(a.op)>=0)return a.op;return null}(t.filters,function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new W(B.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new W(B.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class RM{convertValue(e,n="none"){switch(Ks(e)){case 0:return null;case 1:return e.booleanValue;case 2:return ct(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(es(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw oe(62114,{value:e})}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return ii(e,(s,i)=>{r[s]=this.convertValue(i,n)}),r}convertVectorValue(e){var r,s,i;const n=(i=(s=(r=e.fields)==null?void 0:r[ma].arrayValue)==null?void 0:s.values)==null?void 0:i.map(o=>ct(o.doubleValue));return new Dr(n)}convertGeoPoint(e){return new kr(ct(e.latitude),ct(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=Bh(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(pc(e));default:return null}}convertTimestamp(e){const n=Zr(e);return new $e(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=ze.fromString(e);le(tC(r),9688,{name:e});const s=new qi(r.get(1),r.get(3)),i=new X(r.popFirst(5));return s.isEqual(n)||hn(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function JC(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}function PM(){return new _M("count")}class vl{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Di extends f_{constructor(e,n,r,s,i,o){super(e,n,r,s,o),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new id(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(of("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new W(B.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,n={};return n.type=Di._jsonSchemaVersion,n.bundle="",n.bundleSource="DocumentSnapshot",n.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?n:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),n.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),n)}}Di._jsonSchemaVersion="firestore/documentSnapshot/1.0",Di._jsonSchema={type:Rt("string",Di._jsonSchemaVersion),bundleSource:Rt("string","DocumentSnapshot"),bundleName:Rt("string"),bundle:Rt("string")};class id extends Di{data(e={}){return super.data(e)}}class ji{constructor(e,n,r,s){this._firestore=e,this._userDataWriter=n,this._snapshot=s,this.metadata=new vl(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new id(this._firestore,this._userDataWriter,r.key,r,new vl(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new W(B.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(s,i){if(s._snapshot.oldDocs.isEmpty()){let o=0;return s._snapshot.docChanges.map(a=>{const l=new id(s._firestore,s._userDataWriter,a.doc.key,a.doc,new vl(s._snapshot.mutatedKeys.has(a.doc.key),s._snapshot.fromCache),s.query.converter);return a.doc,{type:"added",doc:l,oldIndex:-1,newIndex:o++}})}{let o=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(a=>i||a.type!==3).map(a=>{const l=new id(s._firestore,s._userDataWriter,a.doc.key,a.doc,new vl(s._snapshot.mutatedKeys.has(a.doc.key),s._snapshot.fromCache),s.query.converter);let d=-1,h=-1;return a.type!==0&&(d=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),h=o.indexOf(a.doc.key)),{type:NM(a.type),doc:l,oldIndex:d,newIndex:h}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new W(B.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=ji._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Ty.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const n=[],r=[],s=[];return this.docs.forEach(i=>{i._document!==null&&(n.push(i._document),r.push(this._userDataWriter.convertObjectMap(i._document.data.value.mapValue.fields,"previous")),s.push(i.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function NM(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return oe(61501,{type:t})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sh(t){t=an(t,Et);const e=an(t.firestore,hr);return hM(Fc(e),t._key).then(n=>eA(e,t,n))}ji._jsonSchemaVersion="firestore/querySnapshot/1.0",ji._jsonSchema={type:Rt("string",ji._jsonSchemaVersion),bundleSource:Rt("string","QuerySnapshot"),bundleName:Rt("string"),bundle:Rt("string")};class cf extends RM{constructor(e){super(),this.firestore=e}convertBytes(e){return new zn(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new Et(this.firestore,null,n)}}function Kt(t){t=an(t,pr);const e=an(t.firestore,hr),n=Fc(e),r=new cf(e);return QC(t._query),fM(n,t._query).then(s=>new ji(e,r,t,s))}function ih(t,e,n){t=an(t,Et);const r=an(t.firestore,hr),s=JC(t.converter,e,n);return uf(r,[qC(Uc(r),"setDoc",t._key,s,t.converter!==null,n).toMutation(t._key,on.none())])}function ea(t,e,n,...r){t=an(t,Et);const s=an(t.firestore,hr),i=Uc(s);let o;return o=typeof(e=Ke(e))=="string"||e instanceof nf?SM(i,"updateDoc",t._key,e,n,r):xM(i,"updateDoc",t._key,e),uf(s,[o.toMutation(t._key,on.exists(!0))])}function ZC(t){return uf(an(t.firestore,hr),[new Gh(t._key,on.none())])}function wl(t,e){const n=an(t.firestore,hr),r=Gt(t),s=JC(t.converter,e);return uf(n,[qC(Uc(t.firestore),"addDoc",r._key,s,t.converter!==null,{}).toMutation(r._key,on.exists(!1))]).then(()=>r)}function sr(t,...e){var l,d,h;t=Ke(t);let n={includeMetadataChanges:!1,source:"default"},r=0;typeof e[r]!="object"||NI(e[r])||(n=e[r++]);const s={includeMetadataChanges:n.includeMetadataChanges,source:n.source};if(NI(e[r])){const f=e[r];e[r]=(l=f.next)==null?void 0:l.bind(f),e[r+1]=(d=f.error)==null?void 0:d.bind(f),e[r+2]=(h=f.complete)==null?void 0:h.bind(f)}let i,o,a;if(t instanceof Et)o=an(t.firestore,hr),a=Dc(t._key.path),i={next:f=>{e[r]&&e[r](eA(o,t,f))},error:e[r+1],complete:e[r+2]};else{const f=an(t,pr);o=an(f.firestore,hr),a=f._query;const m=new cf(o);i={next:w=>{e[r]&&e[r](new ji(o,m,f,w))},error:e[r+1],complete:e[r+2]},QC(t._query)}return function(m,w,A,b){const P=new o_(b),I=new r_(w,P,A);return m.asyncQueue.enqueueAndForget(async()=>e_(await nh(m),I)),()=>{P.Nu(),m.asyncQueue.enqueueAndForget(async()=>t_(await nh(m),I))}}(Fc(o),a,s,i)}function uf(t,e){return function(r,s){const i=new lr;return r.asyncQueue.enqueueAndForget(async()=>ZL(await uM(r),s,i)),i.promise}(Fc(t),e)}function eA(t,e,n){const r=n.docs.get(e._key),s=new cf(t);return new Di(t,s,e._key,r,new vl(n.hasPendingWrites,n.fromCache),e.converter)}function kM(t){return DM(t,{count:PM()})}function DM(t,e){const n=an(t.firestore,hr),r=Fc(n),s=FO(e,(i,o)=>new fV(o,i.aggregateType,i._internalFieldPath));return pM(r,t._query,s).then(i=>function(a,l,d){const h=new cf(a);return new vM(l,h,d)}(n,t,i))}function Fn(){return new l_("serverTimestamp")}function jM(...t){return new c_("arrayUnion",t)}function VI(t){return new u_("increment",t)}(function(e,n=!0){(function(s){Na=s})(so),ur(new Xn("firestore",(r,{instanceIdentifier:s,options:i})=>{const o=r.getProvider("app").getImmediate(),a=new hr(new X2(r.getProvider("auth-internal")),new eO(o,r.getProvider("app-check-internal")),function(d,h){if(!Object.prototype.hasOwnProperty.apply(d.options,["projectId"]))throw new W(B.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new qi(d.options.projectId,h)}(o,s),o);return i={useFetchStreams:n,...i},a._setSettings(i),a},"PUBLIC").setMultipleInstances(!0)),bn(hE,fE,e),bn(hE,fE,"esm2020")})();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tA="firebasestorage.googleapis.com",nA="storageBucket",OM=2*60*1e3,VM=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tt extends Jn{constructor(e,n,r=0){super(_p(e),`Firebase Storage: ${n} (${_p(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Tt.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return _p(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var It;(function(t){t.UNKNOWN="unknown",t.OBJECT_NOT_FOUND="object-not-found",t.BUCKET_NOT_FOUND="bucket-not-found",t.PROJECT_NOT_FOUND="project-not-found",t.QUOTA_EXCEEDED="quota-exceeded",t.UNAUTHENTICATED="unauthenticated",t.UNAUTHORIZED="unauthorized",t.UNAUTHORIZED_APP="unauthorized-app",t.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",t.INVALID_CHECKSUM="invalid-checksum",t.CANCELED="canceled",t.INVALID_EVENT_NAME="invalid-event-name",t.INVALID_URL="invalid-url",t.INVALID_DEFAULT_BUCKET="invalid-default-bucket",t.NO_DEFAULT_BUCKET="no-default-bucket",t.CANNOT_SLICE_BLOB="cannot-slice-blob",t.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",t.NO_DOWNLOAD_URL="no-download-url",t.INVALID_ARGUMENT="invalid-argument",t.INVALID_ARGUMENT_COUNT="invalid-argument-count",t.APP_DELETED="app-deleted",t.INVALID_ROOT_OPERATION="invalid-root-operation",t.INVALID_FORMAT="invalid-format",t.INTERNAL_ERROR="internal-error",t.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(It||(It={}));function _p(t){return"storage/"+t}function v_(){const t="An unknown error occurred, please check the error payload for server response.";return new Tt(It.UNKNOWN,t)}function LM(t){return new Tt(It.OBJECT_NOT_FOUND,"Object '"+t+"' does not exist.")}function MM(t){return new Tt(It.QUOTA_EXCEEDED,"Quota for bucket '"+t+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function FM(){const t="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new Tt(It.UNAUTHENTICATED,t)}function UM(){return new Tt(It.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function $M(t){return new Tt(It.UNAUTHORIZED,"User does not have permission to access '"+t+"'.")}function BM(){return new Tt(It.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function zM(){return new Tt(It.CANCELED,"User canceled the upload/download.")}function qM(t){return new Tt(It.INVALID_URL,"Invalid URL '"+t+"'.")}function HM(t){return new Tt(It.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}function WM(){return new Tt(It.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+nA+"' property when initializing the app?")}function KM(){return new Tt(It.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function GM(){return new Tt(It.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function QM(t){return new Tt(It.UNSUPPORTED_ENVIRONMENT,`${t} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function sg(t){return new Tt(It.INVALID_ARGUMENT,t)}function rA(){return new Tt(It.APP_DELETED,"The Firebase app was deleted.")}function YM(t){return new Tt(It.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function Ul(t,e){return new Tt(It.INVALID_FORMAT,"String does not match format '"+t+"': "+e)}function al(t){throw new Tt(It.INTERNAL_ERROR,"Internal error: "+t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fn{constructor(e,n){this.bucket=e,this.path_=n}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,n){let r;try{r=fn.makeFromUrl(e,n)}catch{return new fn(e,"")}if(r.path==="")return r;throw HM(e)}static makeFromUrl(e,n){let r=null;const s="([A-Za-z0-9.\\-_]+)";function i(j){j.path.charAt(j.path.length-1)==="/"&&(j.path_=j.path_.slice(0,-1))}const o="(/(.*))?$",a=new RegExp("^gs://"+s+o,"i"),l={bucket:1,path:3};function d(j){j.path_=decodeURIComponent(j.path)}const h="v[A-Za-z0-9_]+",f=n.replace(/[.]/g,"\\."),m="(/([^?#]*).*)?$",w=new RegExp(`^https?://${f}/${h}/b/${s}/o${m}`,"i"),A={bucket:1,path:3},b=n===tA?"(?:storage.googleapis.com|storage.cloud.google.com)":n,P="([^?#]*)",I=new RegExp(`^https?://${b}/${s}/${P}`,"i"),y=[{regex:a,indices:l,postModify:i},{regex:w,indices:A,postModify:d},{regex:I,indices:{bucket:1,path:2},postModify:d}];for(let j=0;j<y.length;j++){const V=y[j],M=V.regex.exec(e);if(M){const T=M[V.indices.bucket];let _=M[V.indices.path];_||(_=""),r=new fn(T,_),V.postModify(r);break}}if(r==null)throw qM(e);return r}}class XM{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function JM(t,e,n){let r=1,s=null,i=null,o=!1,a=0;function l(){return a===2}let d=!1;function h(...P){d||(d=!0,e.apply(null,P))}function f(P){s=setTimeout(()=>{s=null,t(w,l())},P)}function m(){i&&clearTimeout(i)}function w(P,...I){if(d){m();return}if(P){m(),h.call(null,P,...I);return}if(l()||o){m(),h.call(null,P,...I);return}r<64&&(r*=2);let y;a===1?(a=2,y=0):y=(r+Math.random())*1e3,f(y)}let A=!1;function b(P){A||(A=!0,m(),!d&&(s!==null?(P||(a=2),clearTimeout(s),f(0)):P||(a=1)))}return f(0),i=setTimeout(()=>{o=!0,b(!0)},n),b}function ZM(t){t(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eF(t){return t!==void 0}function tF(t){return typeof t=="object"&&!Array.isArray(t)}function w_(t){return typeof t=="string"||t instanceof String}function LI(t){return E_()&&t instanceof Blob}function E_(){return typeof Blob<"u"}function ig(t,e,n,r){if(r<e)throw sg(`Invalid value for '${t}'. Expected ${e} or greater.`);if(r>n)throw sg(`Invalid value for '${t}'. Expected ${n} or less.`)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bc(t,e,n){let r=e;return n==null&&(r=`https://${e}`),`${n}://${r}/v0${t}`}function sA(t){const e=encodeURIComponent;let n="?";for(const r in t)if(t.hasOwnProperty(r)){const s=e(r)+"="+e(t[r]);n=n+s+"&"}return n=n.slice(0,-1),n}var Oi;(function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"})(Oi||(Oi={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nF(t,e){const n=t>=500&&t<600,s=[408,429].indexOf(t)!==-1,i=e.indexOf(t)!==-1;return n||s||i}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rF{constructor(e,n,r,s,i,o,a,l,d,h,f,m=!0,w=!1){this.url_=e,this.method_=n,this.headers_=r,this.body_=s,this.successCodes_=i,this.additionalRetryCodes_=o,this.callback_=a,this.errorCallback_=l,this.timeout_=d,this.progressCallback_=h,this.connectionFactory_=f,this.retry=m,this.isUsingEmulator=w,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((A,b)=>{this.resolve_=A,this.reject_=b,this.start_()})}start_(){const e=(r,s)=>{if(s){r(!1,new Su(!1,null,!0));return}const i=this.connectionFactory_();this.pendingConnection_=i;const o=a=>{const l=a.loaded,d=a.lengthComputable?a.total:-1;this.progressCallback_!==null&&this.progressCallback_(l,d)};this.progressCallback_!==null&&i.addUploadProgressListener(o),i.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&i.removeUploadProgressListener(o),this.pendingConnection_=null;const a=i.getErrorCode()===Oi.NO_ERROR,l=i.getStatus();if(!a||nF(l,this.additionalRetryCodes_)&&this.retry){const h=i.getErrorCode()===Oi.ABORT;r(!1,new Su(!1,null,h));return}const d=this.successCodes_.indexOf(l)!==-1;r(!0,new Su(d,i))})},n=(r,s)=>{const i=this.resolve_,o=this.reject_,a=s.connection;if(s.wasSuccessCode)try{const l=this.callback_(a,a.getResponse());eF(l)?i(l):i()}catch(l){o(l)}else if(a!==null){const l=v_();l.serverResponse=a.getErrorText(),this.errorCallback_?o(this.errorCallback_(a,l)):o(l)}else if(s.canceled){const l=this.appDelete_?rA():zM();o(l)}else{const l=BM();o(l)}};this.canceled_?n(!1,new Su(!1,null,!0)):this.backoffId_=JM(e,n,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&ZM(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class Su{constructor(e,n,r){this.wasSuccessCode=e,this.connection=n,this.canceled=!!r}}function sF(t,e){e!==null&&e.length>0&&(t.Authorization="Firebase "+e)}function iF(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function oF(t,e){e&&(t["X-Firebase-GMPID"]=e)}function aF(t,e){e!==null&&(t["X-Firebase-AppCheck"]=e)}function lF(t,e,n,r,s,i,o=!0,a=!1){const l=sA(t.urlParams),d=t.url+l,h=Object.assign({},t.headers);return oF(h,e),sF(h,n),iF(h,i),aF(h,r),new rF(d,t.method,h,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,s,o,a)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cF(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function uF(...t){const e=cF();if(e!==void 0){const n=new e;for(let r=0;r<t.length;r++)n.append(t[r]);return n.getBlob()}else{if(E_())return new Blob(t);throw new Tt(It.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function dF(t,e,n){return t.webkitSlice?t.webkitSlice(e,n):t.mozSlice?t.mozSlice(e,n):t.slice?t.slice(e,n):null}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hF(t){if(typeof atob>"u")throw QM("base-64");return atob(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cr={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class vp{constructor(e,n){this.data=e,this.contentType=n||null}}function fF(t,e){switch(t){case Cr.RAW:return new vp(iA(e));case Cr.BASE64:case Cr.BASE64URL:return new vp(oA(t,e));case Cr.DATA_URL:return new vp(mF(e),gF(e))}throw v_()}function iA(t){const e=[];for(let n=0;n<t.length;n++){let r=t.charCodeAt(n);if(r<=127)e.push(r);else if(r<=2047)e.push(192|r>>6,128|r&63);else if((r&64512)===55296)if(!(n<t.length-1&&(t.charCodeAt(n+1)&64512)===56320))e.push(239,191,189);else{const i=r,o=t.charCodeAt(++n);r=65536|(i&1023)<<10|o&1023,e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|r&63)}else(r&64512)===56320?e.push(239,191,189):e.push(224|r>>12,128|r>>6&63,128|r&63)}return new Uint8Array(e)}function pF(t){let e;try{e=decodeURIComponent(t)}catch{throw Ul(Cr.DATA_URL,"Malformed data URL.")}return iA(e)}function oA(t,e){switch(t){case Cr.BASE64:{const s=e.indexOf("-")!==-1,i=e.indexOf("_")!==-1;if(s||i)throw Ul(t,"Invalid character '"+(s?"-":"_")+"' found: is it base64url encoded?");break}case Cr.BASE64URL:{const s=e.indexOf("+")!==-1,i=e.indexOf("/")!==-1;if(s||i)throw Ul(t,"Invalid character '"+(s?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let n;try{n=hF(e)}catch(s){throw s.message.includes("polyfill")?s:Ul(t,"Invalid character found")}const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}class aA{constructor(e){this.base64=!1,this.contentType=null;const n=e.match(/^data:([^,]+)?,/);if(n===null)throw Ul(Cr.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const r=n[1]||null;r!=null&&(this.base64=yF(r,";base64"),this.contentType=this.base64?r.substring(0,r.length-7):r),this.rest=e.substring(e.indexOf(",")+1)}}function mF(t){const e=new aA(t);return e.base64?oA(Cr.BASE64,e.rest):pF(e.rest)}function gF(t){return new aA(t).contentType}function yF(t,e){return t.length>=e.length?t.substring(t.length-e.length)===e:!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cs{constructor(e,n){let r=0,s="";LI(e)?(this.data_=e,r=e.size,s=e.type):e instanceof ArrayBuffer?(n?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),r=this.data_.length):e instanceof Uint8Array&&(n?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),r=e.length),this.size_=r,this.type_=s}size(){return this.size_}type(){return this.type_}slice(e,n){if(LI(this.data_)){const r=this.data_,s=dF(r,e,n);return s===null?null:new Cs(s)}else{const r=new Uint8Array(this.data_.buffer,e,n-e);return new Cs(r,!0)}}static getBlob(...e){if(E_()){const n=e.map(r=>r instanceof Cs?r.data_:r);return new Cs(uF.apply(null,n))}else{const n=e.map(o=>w_(o)?fF(Cr.RAW,o).data:o.data_);let r=0;n.forEach(o=>{r+=o.byteLength});const s=new Uint8Array(r);let i=0;return n.forEach(o=>{for(let a=0;a<o.length;a++)s[i++]=o[a]}),new Cs(s,!0)}}uploadData(){return this.data_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function I_(t){let e;try{e=JSON.parse(t)}catch{return null}return tF(e)?e:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _F(t){if(t.length===0)return null;const e=t.lastIndexOf("/");return e===-1?"":t.slice(0,e)}function vF(t,e){const n=e.split("/").filter(r=>r.length>0).join("/");return t.length===0?n:t+"/"+n}function lA(t){const e=t.lastIndexOf("/",t.length-2);return e===-1?t:t.slice(e+1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wF(t,e){return e}class un{constructor(e,n,r,s){this.server=e,this.local=n||e,this.writable=!!r,this.xform=s||wF}}let bu=null;function EF(t){return!w_(t)||t.length<2?t:lA(t)}function cA(){if(bu)return bu;const t=[];t.push(new un("bucket")),t.push(new un("generation")),t.push(new un("metageneration")),t.push(new un("name","fullPath",!0));function e(i,o){return EF(o)}const n=new un("name");n.xform=e,t.push(n);function r(i,o){return o!==void 0?Number(o):o}const s=new un("size");return s.xform=r,t.push(s),t.push(new un("timeCreated")),t.push(new un("updated")),t.push(new un("md5Hash",null,!0)),t.push(new un("cacheControl",null,!0)),t.push(new un("contentDisposition",null,!0)),t.push(new un("contentEncoding",null,!0)),t.push(new un("contentLanguage",null,!0)),t.push(new un("contentType",null,!0)),t.push(new un("metadata","customMetadata",!0)),bu=t,bu}function IF(t,e){function n(){const r=t.bucket,s=t.fullPath,i=new fn(r,s);return e._makeStorageReference(i)}Object.defineProperty(t,"ref",{get:n})}function TF(t,e,n){const r={};r.type="file";const s=n.length;for(let i=0;i<s;i++){const o=n[i];r[o.local]=o.xform(r,e[o.server])}return IF(r,t),r}function uA(t,e,n){const r=I_(e);return r===null?null:TF(t,r,n)}function xF(t,e,n,r){const s=I_(e);if(s===null||!w_(s.downloadTokens))return null;const i=s.downloadTokens;if(i.length===0)return null;const o=encodeURIComponent;return i.split(",").map(d=>{const h=t.bucket,f=t.fullPath,m="/b/"+o(h)+"/o/"+o(f),w=Bc(m,n,r),A=sA({alt:"media",token:d});return w+A})[0]}function SF(t,e){const n={},r=e.length;for(let s=0;s<r;s++){const i=e[s];i.writable&&(n[i.server]=t[i.local])}return JSON.stringify(n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MI="prefixes",FI="items";function bF(t,e,n){const r={prefixes:[],items:[],nextPageToken:n.nextPageToken};if(n[MI])for(const s of n[MI]){const i=s.replace(/\/$/,""),o=t._makeStorageReference(new fn(e,i));r.prefixes.push(o)}if(n[FI])for(const s of n[FI]){const i=t._makeStorageReference(new fn(e,s.name));r.items.push(i)}return r}function CF(t,e,n){const r=I_(n);return r===null?null:bF(t,e,r)}class df{constructor(e,n,r,s){this.url=e,this.method=n,this.handler=r,this.timeout=s,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function T_(t){if(!t)throw v_()}function AF(t,e){function n(r,s){const i=uA(t,s,e);return T_(i!==null),i}return n}function RF(t,e){function n(r,s){const i=CF(t,e,s);return T_(i!==null),i}return n}function PF(t,e){function n(r,s){const i=uA(t,s,e);return T_(i!==null),xF(i,s,t.host,t._protocol)}return n}function x_(t){function e(n,r){let s;return n.getStatus()===401?n.getErrorText().includes("Firebase App Check token is invalid")?s=UM():s=FM():n.getStatus()===402?s=MM(t.bucket):n.getStatus()===403?s=$M(t.path):s=r,s.status=n.getStatus(),s.serverResponse=r.serverResponse,s}return e}function dA(t){const e=x_(t);function n(r,s){let i=e(r,s);return r.getStatus()===404&&(i=LM(t.path)),i.serverResponse=s.serverResponse,i}return n}function NF(t,e,n,r,s){const i={};e.isRoot?i.prefix="":i.prefix=e.path+"/",n.length>0&&(i.delimiter=n),r&&(i.pageToken=r),s&&(i.maxResults=s);const o=e.bucketOnlyServerUrl(),a=Bc(o,t.host,t._protocol),l="GET",d=t.maxOperationRetryTime,h=new df(a,l,RF(t,e.bucket),d);return h.urlParams=i,h.errorHandler=x_(e),h}function kF(t,e,n){const r=e.fullServerUrl(),s=Bc(r,t.host,t._protocol),i="GET",o=t.maxOperationRetryTime,a=new df(s,i,PF(t,n),o);return a.errorHandler=dA(e),a}function DF(t,e){const n=e.fullServerUrl(),r=Bc(n,t.host,t._protocol),s="DELETE",i=t.maxOperationRetryTime;function o(l,d){}const a=new df(r,s,o,i);return a.successCodes=[200,204],a.errorHandler=dA(e),a}function jF(t,e){return t&&t.contentType||e&&e.type()||"application/octet-stream"}function OF(t,e,n){const r=Object.assign({},n);return r.fullPath=t.path,r.size=e.size(),r.contentType||(r.contentType=jF(null,e)),r}function VF(t,e,n,r,s){const i=e.bucketOnlyServerUrl(),o={"X-Goog-Upload-Protocol":"multipart"};function a(){let y="";for(let j=0;j<2;j++)y=y+Math.random().toString().slice(2);return y}const l=a();o["Content-Type"]="multipart/related; boundary="+l;const d=OF(e,r,s),h=SF(d,n),f="--"+l+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+h+`\r
--`+l+`\r
Content-Type: `+d.contentType+`\r
\r
`,m=`\r
--`+l+"--",w=Cs.getBlob(f,r,m);if(w===null)throw KM();const A={name:d.fullPath},b=Bc(i,t.host,t._protocol),P="POST",I=t.maxUploadRetryTime,E=new df(b,P,AF(t,n),I);return E.urlParams=A,E.headers=o,E.body=w.uploadData(),E.errorHandler=x_(e),E}class LF{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=Oi.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=Oi.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=Oi.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,n,r,s,i){if(this.sent_)throw al("cannot .send() more than once");if(ti(e)&&r&&(this.xhr_.withCredentials=!0),this.sent_=!0,this.xhr_.open(n,e,!0),i!==void 0)for(const o in i)i.hasOwnProperty(o)&&this.xhr_.setRequestHeader(o,i[o].toString());return s!==void 0?this.xhr_.send(s):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw al("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw al("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw al("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw al("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class MF extends LF{initXhr(){this.xhr_.responseType="text"}}function hf(){return new MF}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ji{constructor(e,n){this._service=e,n instanceof fn?this._location=n:this._location=fn.makeFromUrl(n,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,n){return new Ji(e,n)}get root(){const e=new fn(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return lA(this._location.path)}get storage(){return this._service}get parent(){const e=_F(this._location.path);if(e===null)return null;const n=new fn(this._location.bucket,e);return new Ji(this._service,n)}_throwIfRoot(e){if(this._location.path==="")throw YM(e)}}function FF(t,e,n){t._throwIfRoot("uploadBytes");const r=VF(t.storage,t._location,cA(),new Cs(e,!0),n);return t.storage.makeRequestWithTokens(r,hf).then(s=>({metadata:s,ref:t}))}function UF(t){const e={prefixes:[],items:[]};return hA(t,e).then(()=>e)}async function hA(t,e,n){const s=await $F(t,{pageToken:n});e.prefixes.push(...s.prefixes),e.items.push(...s.items),s.nextPageToken!=null&&await hA(t,e,s.nextPageToken)}function $F(t,e){e!=null&&typeof e.maxResults=="number"&&ig("options.maxResults",1,1e3,e.maxResults);const n=e||{},r=NF(t.storage,t._location,"/",n.pageToken,n.maxResults);return t.storage.makeRequestWithTokens(r,hf)}function BF(t){t._throwIfRoot("getDownloadURL");const e=kF(t.storage,t._location,cA());return t.storage.makeRequestWithTokens(e,hf).then(n=>{if(n===null)throw GM();return n})}function zF(t){t._throwIfRoot("deleteObject");const e=DF(t.storage,t._location);return t.storage.makeRequestWithTokens(e,hf)}function qF(t,e){const n=vF(t._location.path,e),r=new fn(t._location.bucket,n);return new Ji(t.storage,r)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function HF(t){return/^[A-Za-z]+:\/\//.test(t)}function WF(t,e){return new Ji(t,e)}function fA(t,e){if(t instanceof S_){const n=t;if(n._bucket==null)throw WM();const r=new Ji(n,n._bucket);return e!=null?fA(r,e):r}else return e!==void 0?qF(t,e):t}function KF(t,e){if(e&&HF(e)){if(t instanceof S_)return WF(t,e);throw sg("To use ref(service, url), the first argument must be a Storage instance.")}else return fA(t,e)}function UI(t,e){const n=e==null?void 0:e[nA];return n==null?null:fn.makeFromBucketSpec(n,t)}function GF(t,e,n,r={}){t.host=`${e}:${n}`;const s=ti(e);s&&(ly(`https://${t.host}/b`),cy("Storage",!0)),t._isUsingEmulator=!0,t._protocol=s?"https":"http";const{mockUserToken:i}=r;i&&(t._overrideAuthToken=typeof i=="string"?i:Gx(i,t.app.options.projectId))}class S_{constructor(e,n,r,s,i,o=!1){this.app=e,this._authProvider=n,this._appCheckProvider=r,this._url=s,this._firebaseVersion=i,this._isUsingEmulator=o,this._bucket=null,this._host=tA,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=OM,this._maxUploadRetryTime=VM,this._requests=new Set,s!=null?this._bucket=fn.makeFromBucketSpec(s,this._host):this._bucket=UI(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=fn.makeFromBucketSpec(this._url,e):this._bucket=UI(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){ig("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){ig("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const n=await e.getToken();if(n!==null)return n.accessToken}return null}async _getAppCheckToken(){if(Bn(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Ji(this,e)}_makeRequest(e,n,r,s,i=!0){if(this._deleted)return new XM(rA());{const o=lF(e,this._appId,r,s,n,this._firebaseVersion,i,this._isUsingEmulator);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}async makeRequestWithTokens(e,n){const[r,s]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,n,r,s).getPromise()}}const $I="@firebase/storage",BI="0.14.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pA="storage";function zI(t,e,n){return t=Ke(t),FF(t,e,n)}function qI(t){return t=Ke(t),UF(t)}function HI(t){return t=Ke(t),BF(t)}function wp(t){return t=Ke(t),zF(t)}function ll(t,e){return t=Ke(t),KF(t,e)}function Ii(t=Ph(),e){t=Ke(t);const r=ni(t,pA).getImmediate({identifier:e}),s=Hx("storage");return s&&QF(r,...s),r}function QF(t,e,n,r={}){GF(t,e,n,r)}function YF(t,{instanceIdentifier:e}){const n=t.getProvider("app").getImmediate(),r=t.getProvider("auth-internal"),s=t.getProvider("app-check-internal");return new S_(n,r,s,e,so)}function XF(){ur(new Xn(pA,YF,"PUBLIC").setMultipleInstances(!0)),bn($I,BI,""),bn($I,BI,"esm2020")}XF();const JF={apiKey:"AIzaSyC70mGCRrjE8iOap8iTHuid8HEuyadue8Y",authDomain:"odontocloud-d92ac.firebaseapp.com",projectId:"odontocloud-d92ac",storageBucket:"odontocloud-d92ac.firebasestorage.app",messagingSenderId:"267020714981",appId:"1:267020714981:web:a44416ea83aa1d1172650c",measurementId:"G-ZMCC5CFY0C"},b_=hy(JF),WI=FS(b_),KI=UC(b_);Ii(b_);const ZF="/odontocloud-react/assets/fondo.png",mA="/odontocloud-react/assets/logo.png",GI=(t,e)=>{const n={email:t,rol:e,timestamp:Date.now()};localStorage.setItem("odc_session",JSON.stringify(n))},Ep=()=>{try{const t=JSON.parse(localStorage.getItem("odc_session"));return t&&Date.now()-t.timestamp<1e3*60*60*24?t:null}catch{return null}},e4=()=>{const t=bh(),[e,n]=N.useState(""),[r,s]=N.useState(""),[i,o]=N.useState(""),[a,l]=N.useState(navigator.onLine);N.useEffect(()=>{const f=()=>l(!0),m=()=>l(!1);return window.addEventListener("online",f),window.addEventListener("offline",m),()=>{window.removeEventListener("online",f),window.removeEventListener("offline",m)}},[]);const d=f=>{const m=(f||"").toLowerCase();m==="administrador"?t("/dashboard_admin",{replace:!0}):m==="doctor"?t("/dashboard_doctor",{replace:!0}):m==="recepcionista"?t("/dashboard_recepcion",{replace:!0}):o("Rol no reconocido. Contacte al administrador.")};N.useEffect(()=>{if(!navigator.onLine){const m=Ep();m!=null&&m.rol?d(m.rol):o("Sin conexin y no hay sesin guardada.");return}const f=vy(WI,async m=>{if(m){const w=Ep();if(w!=null&&w.rol){d(w.rol);return}try{const A=nt(Ue(KI,"users"),Qe("correo","==",m.email||"")),b=await Kt(A);if(!b.empty){const P=b.docs[0].data().rol||"sin_rol";GI(m.email||"",P),d(P)}}catch{d("administrador")}}});return()=>f()},[]);const h=async f=>{if(f.preventDefault(),o(""),!a){const m=Ep();m!=null&&m.rol?d(m.rol):o("Sin conexin y no hay sesin guardada.");return}try{const w=(await jj(WI,e,r)).user,A=nt(Ue(KI,"users"),Qe("correo","==",e)),b=await Kt(A);if(b.empty){o("Usuario no encontrado en la base de datos.");return}const I=b.docs[0].data().rol||"sin_rol";GI(e,I),d(I)}catch(m){switch(console.error("Error login:",m),m.code){case"auth/user-not-found":o("Usuario no registrado.");break;case"auth/wrong-password":o("Contrasea incorrecta.");break;case"auth/invalid-email":o("Correo no vlido.");break;case"auth/network-request-failed":o("Sin conexin. Usa la sesin guardada o reconecta.");break;default:o("Error al iniciar sesin.")}}};return u.jsx("div",{className:"login-root",style:{backgroundImage:`url(${ZF})`,backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat",backgroundAttachment:"fixed",width:"100vw",height:"100vh",display:"flex",justifyContent:"center",alignItems:"center",overflow:"hidden"},children:u.jsxs("div",{className:"container",children:[u.jsxs("div",{className:"left-panel",children:[u.jsx("img",{src:mA,alt:"OdontoCloud Logo",className:"logo"}),u.jsxs("h2",{children:["Su clnica, ",u.jsx("br",{})," ms conectada."]}),u.jsx("p",{children:"OdontoCloud optimiza cada detalle de su gestin."})]}),u.jsxs("div",{className:"right-panel",children:[u.jsx("h3",{children:"Acceso a la plataforma"}),u.jsxs("form",{onSubmit:h,children:[u.jsx("input",{type:"email",placeholder:"usuario@ejemplo.com",value:e,onChange:f=>n(f.target.value),required:a}),u.jsx("input",{type:"password",placeholder:"Contrasea",value:r,onChange:f=>s(f.target.value),required:a}),u.jsx("button",{type:"submit",children:a?"Iniciar sesin":"Entrar (modo offline)"}),i&&u.jsx("p",{style:{color:"red",marginTop:10},children:i}),!a&&u.jsx("p",{style:{color:"orange",marginTop:10},children:" Modo offline activado"})]})]})]})})},gA="@firebase/installations",C_="0.6.19";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yA=1e4,_A=`w:${C_}`,vA="FIS_v2",t4="https://firebaseinstallations.googleapis.com/v1",n4=60*60*1e3,r4="installations",s4="Installations";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const i4={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},Zi=new ro(r4,s4,i4);function wA(t){return t instanceof Jn&&t.code.includes("request-failed")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function EA({projectId:t}){return`${t4}/projects/${t}/installations`}function IA(t){return{token:t.token,requestStatus:2,expiresIn:a4(t.expiresIn),creationTime:Date.now()}}async function TA(t,e){const r=(await e.json()).error;return Zi.create("request-failed",{requestName:t,serverCode:r.code,serverMessage:r.message,serverStatus:r.status})}function xA({apiKey:t}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t})}function o4(t,{refreshToken:e}){const n=xA(t);return n.append("Authorization",l4(e)),n}async function SA(t){const e=await t();return e.status>=500&&e.status<600?t():e}function a4(t){return Number(t.replace("s","000"))}function l4(t){return`${vA} ${t}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function c4({appConfig:t,heartbeatServiceProvider:e},{fid:n}){const r=EA(t),s=xA(t),i=e.getImmediate({optional:!0});if(i){const d=await i.getHeartbeatsHeader();d&&s.append("x-firebase-client",d)}const o={fid:n,authVersion:vA,appId:t.appId,sdkVersion:_A},a={method:"POST",headers:s,body:JSON.stringify(o)},l=await SA(()=>fetch(r,a));if(l.ok){const d=await l.json();return{fid:d.fid||n,registrationStatus:2,refreshToken:d.refreshToken,authToken:IA(d.authToken)}}else throw await TA("Create Installation",l)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bA(t){return new Promise(e=>{setTimeout(e,t)})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function u4(t){return btoa(String.fromCharCode(...t)).replace(/\+/g,"-").replace(/\//g,"_")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const d4=/^[cdef][\w-]{21}$/,og="";function h4(){try{const t=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(t),t[0]=112+t[0]%16;const n=f4(t);return d4.test(n)?n:og}catch{return og}}function f4(t){return u4(t).substr(0,22)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ff(t){return`${t.appName}!${t.appId}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CA=new Map;function AA(t,e){const n=ff(t);RA(n,e),p4(n,e)}function RA(t,e){const n=CA.get(t);if(n)for(const r of n)r(e)}function p4(t,e){const n=m4();n&&n.postMessage({key:t,fid:e}),g4()}let Ci=null;function m4(){return!Ci&&"BroadcastChannel"in self&&(Ci=new BroadcastChannel("[Firebase] FID Change"),Ci.onmessage=t=>{RA(t.data.key,t.data.fid)}),Ci}function g4(){CA.size===0&&Ci&&(Ci.close(),Ci=null)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const y4="firebase-installations-database",_4=1,eo="firebase-installations-store";let Ip=null;function A_(){return Ip||(Ip=nS(y4,_4,{upgrade:(t,e)=>{switch(e){case 0:t.createObjectStore(eo)}}})),Ip}async function oh(t,e){const n=ff(t),s=(await A_()).transaction(eo,"readwrite"),i=s.objectStore(eo),o=await i.get(n);return await i.put(e,n),await s.done,(!o||o.fid!==e.fid)&&AA(t,e.fid),e}async function PA(t){const e=ff(t),r=(await A_()).transaction(eo,"readwrite");await r.objectStore(eo).delete(e),await r.done}async function pf(t,e){const n=ff(t),s=(await A_()).transaction(eo,"readwrite"),i=s.objectStore(eo),o=await i.get(n),a=e(o);return a===void 0?await i.delete(n):await i.put(a,n),await s.done,a&&(!o||o.fid!==a.fid)&&AA(t,a.fid),a}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function R_(t){let e;const n=await pf(t.appConfig,r=>{const s=v4(r),i=w4(t,s);return e=i.registrationPromise,i.installationEntry});return n.fid===og?{installationEntry:await e}:{installationEntry:n,registrationPromise:e}}function v4(t){const e=t||{fid:h4(),registrationStatus:0};return NA(e)}function w4(t,e){if(e.registrationStatus===0){if(!navigator.onLine){const s=Promise.reject(Zi.create("app-offline"));return{installationEntry:e,registrationPromise:s}}const n={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},r=E4(t,n);return{installationEntry:n,registrationPromise:r}}else return e.registrationStatus===1?{installationEntry:e,registrationPromise:I4(t)}:{installationEntry:e}}async function E4(t,e){try{const n=await c4(t,e);return oh(t.appConfig,n)}catch(n){throw wA(n)&&n.customData.serverCode===409?await PA(t.appConfig):await oh(t.appConfig,{fid:e.fid,registrationStatus:0}),n}}async function I4(t){let e=await QI(t.appConfig);for(;e.registrationStatus===1;)await bA(100),e=await QI(t.appConfig);if(e.registrationStatus===0){const{installationEntry:n,registrationPromise:r}=await R_(t);return r||n}return e}function QI(t){return pf(t,e=>{if(!e)throw Zi.create("installation-not-found");return NA(e)})}function NA(t){return T4(t)?{fid:t.fid,registrationStatus:0}:t}function T4(t){return t.registrationStatus===1&&t.registrationTime+yA<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function x4({appConfig:t,heartbeatServiceProvider:e},n){const r=S4(t,n),s=o4(t,n),i=e.getImmediate({optional:!0});if(i){const d=await i.getHeartbeatsHeader();d&&s.append("x-firebase-client",d)}const o={installation:{sdkVersion:_A,appId:t.appId}},a={method:"POST",headers:s,body:JSON.stringify(o)},l=await SA(()=>fetch(r,a));if(l.ok){const d=await l.json();return IA(d)}else throw await TA("Generate Auth Token",l)}function S4(t,{fid:e}){return`${EA(t)}/${e}/authTokens:generate`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function P_(t,e=!1){let n;const r=await pf(t.appConfig,i=>{if(!kA(i))throw Zi.create("not-registered");const o=i.authToken;if(!e&&A4(o))return i;if(o.requestStatus===1)return n=b4(t,e),i;{if(!navigator.onLine)throw Zi.create("app-offline");const a=P4(i);return n=C4(t,a),a}});return n?await n:r.authToken}async function b4(t,e){let n=await YI(t.appConfig);for(;n.authToken.requestStatus===1;)await bA(100),n=await YI(t.appConfig);const r=n.authToken;return r.requestStatus===0?P_(t,e):r}function YI(t){return pf(t,e=>{if(!kA(e))throw Zi.create("not-registered");const n=e.authToken;return N4(n)?{...e,authToken:{requestStatus:0}}:e})}async function C4(t,e){try{const n=await x4(t,e),r={...e,authToken:n};return await oh(t.appConfig,r),n}catch(n){if(wA(n)&&(n.customData.serverCode===401||n.customData.serverCode===404))await PA(t.appConfig);else{const r={...e,authToken:{requestStatus:0}};await oh(t.appConfig,r)}throw n}}function kA(t){return t!==void 0&&t.registrationStatus===2}function A4(t){return t.requestStatus===2&&!R4(t)}function R4(t){const e=Date.now();return e<t.creationTime||t.creationTime+t.expiresIn<e+n4}function P4(t){const e={requestStatus:1,requestTime:Date.now()};return{...t,authToken:e}}function N4(t){return t.requestStatus===1&&t.requestTime+yA<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function k4(t){const e=t,{installationEntry:n,registrationPromise:r}=await R_(e);return r?r.catch(console.error):P_(e).catch(console.error),n.fid}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function D4(t,e=!1){const n=t;return await j4(n),(await P_(n,e)).token}async function j4(t){const{registrationPromise:e}=await R_(t);e&&await e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function O4(t){if(!t||!t.options)throw Tp("App Configuration");if(!t.name)throw Tp("App Name");const e=["projectId","apiKey","appId"];for(const n of e)if(!t.options[n])throw Tp(n);return{appName:t.name,projectId:t.options.projectId,apiKey:t.options.apiKey,appId:t.options.appId}}function Tp(t){return Zi.create("missing-app-config-values",{valueName:t})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DA="installations",V4="installations-internal",L4=t=>{const e=t.getProvider("app").getImmediate(),n=O4(e),r=ni(e,"heartbeat");return{app:e,appConfig:n,heartbeatServiceProvider:r,_delete:()=>Promise.resolve()}},M4=t=>{const e=t.getProvider("app").getImmediate(),n=ni(e,DA).getImmediate();return{getId:()=>k4(n),getToken:s=>D4(n,s)}};function F4(){ur(new Xn(DA,L4,"PUBLIC")),ur(new Xn(V4,M4,"PRIVATE"))}F4();bn(gA,C_);bn(gA,C_,"esm2020");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ah="analytics",U4="firebase_id",$4="origin",B4=60*1e3,z4="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",N_="https://www.googletagmanager.com/gtag/js";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gn=new Rh("@firebase/analytics");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const q4={"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-initialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."},jn=new ro("analytics","Analytics",q4);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function H4(t){if(!t.startsWith(N_)){const e=jn.create("invalid-gtag-resource",{gtagURL:t});return gn.warn(e.message),""}return t}function jA(t){return Promise.all(t.map(e=>e.catch(n=>n)))}function W4(t,e){let n;return window.trustedTypes&&(n=window.trustedTypes.createPolicy(t,e)),n}function K4(t,e){const n=W4("firebase-js-sdk-policy",{createScriptURL:H4}),r=document.createElement("script"),s=`${N_}?l=${t}&id=${e}`;r.src=n?n==null?void 0:n.createScriptURL(s):s,r.async=!0,document.head.appendChild(r)}function G4(t){let e=[];return Array.isArray(window[t])?e=window[t]:window[t]=e,e}async function Q4(t,e,n,r,s,i){const o=r[s];try{if(o)await e[o];else{const l=(await jA(n)).find(d=>d.measurementId===s);l&&await e[l.appId]}}catch(a){gn.error(a)}t("config",s,i)}async function Y4(t,e,n,r,s){try{let i=[];if(s&&s.send_to){let o=s.send_to;Array.isArray(o)||(o=[o]);const a=await jA(n);for(const l of o){const d=a.find(f=>f.measurementId===l),h=d&&e[d.appId];if(h)i.push(h);else{i=[];break}}}i.length===0&&(i=Object.values(e)),await Promise.all(i),t("event",r,s||{})}catch(i){gn.error(i)}}function X4(t,e,n,r){async function s(i,...o){try{if(i==="event"){const[a,l]=o;await Y4(t,e,n,a,l)}else if(i==="config"){const[a,l]=o;await Q4(t,e,n,r,a,l)}else if(i==="consent"){const[a,l]=o;t("consent",a,l)}else if(i==="get"){const[a,l,d]=o;t("get",a,l,d)}else if(i==="set"){const[a]=o;t("set",a)}else t(i,...o)}catch(a){gn.error(a)}}return s}function J4(t,e,n,r,s){let i=function(...o){window[r].push(arguments)};return window[s]&&typeof window[s]=="function"&&(i=window[s]),window[s]=X4(i,t,e,n),{gtagCore:i,wrappedGtag:window[s]}}function Z4(t){const e=window.document.getElementsByTagName("script");for(const n of Object.values(e))if(n.src&&n.src.includes(N_)&&n.src.includes(t))return n;return null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eU=30,tU=1e3;class nU{constructor(e={},n=tU){this.throttleMetadata=e,this.intervalMillis=n}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,n){this.throttleMetadata[e]=n}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}}const OA=new nU;function rU(t){return new Headers({Accept:"application/json","x-goog-api-key":t})}async function sU(t){var o;const{appId:e,apiKey:n}=t,r={method:"GET",headers:rU(n)},s=z4.replace("{app-id}",e),i=await fetch(s,r);if(i.status!==200&&i.status!==304){let a="";try{const l=await i.json();(o=l.error)!=null&&o.message&&(a=l.error.message)}catch{}throw jn.create("config-fetch-failed",{httpStatus:i.status,responseMessage:a})}return i.json()}async function iU(t,e=OA,n){const{appId:r,apiKey:s,measurementId:i}=t.options;if(!r)throw jn.create("no-app-id");if(!s){if(i)return{measurementId:i,appId:r};throw jn.create("no-api-key")}const o=e.getThrottleMetadata(r)||{backoffCount:0,throttleEndTimeMillis:Date.now()},a=new lU;return setTimeout(async()=>{a.abort()},B4),VA({appId:r,apiKey:s,measurementId:i},o,a,e)}async function VA(t,{throttleEndTimeMillis:e,backoffCount:n},r,s=OA){var a;const{appId:i,measurementId:o}=t;try{await oU(r,e)}catch(l){if(o)return gn.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${o} provided in the "measurementId" field in the local Firebase config. [${l==null?void 0:l.message}]`),{appId:i,measurementId:o};throw l}try{const l=await sU(t);return s.deleteThrottleMetadata(i),l}catch(l){const d=l;if(!aU(d)){if(s.deleteThrottleMetadata(i),o)return gn.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${o} provided in the "measurementId" field in the local Firebase config. [${d==null?void 0:d.message}]`),{appId:i,measurementId:o};throw l}const h=Number((a=d==null?void 0:d.customData)==null?void 0:a.httpStatus)===503?Vw(n,s.intervalMillis,eU):Vw(n,s.intervalMillis),f={throttleEndTimeMillis:Date.now()+h,backoffCount:n+1};return s.setThrottleMetadata(i,f),gn.debug(`Calling attemptFetch again in ${h} millis`),VA(t,f,r,s)}}function oU(t,e){return new Promise((n,r)=>{const s=Math.max(e-Date.now(),0),i=setTimeout(n,s);t.addEventListener(()=>{clearTimeout(i),r(jn.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}function aU(t){if(!(t instanceof Jn)||!t.customData)return!1;const e=Number(t.customData.httpStatus);return e===429||e===500||e===503||e===504}class lU{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach(e=>e())}}async function cU(t,e,n,r,s){if(s&&s.global){t("event",n,r);return}else{const i=await e,o={...r,send_to:i};t("event",n,o)}}async function uU(t,e,n,r){if(r&&r.global){const s={};for(const i of Object.keys(n))s[`user_properties.${i}`]=n[i];return t("set",s),Promise.resolve()}else{const s=await e;t("config",s,{update:!0,user_properties:n})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function dU(){if(uy())try{await Zx()}catch(t){return gn.warn(jn.create("indexeddb-unavailable",{errorInfo:t==null?void 0:t.toString()}).message),!1}else return gn.warn(jn.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;return!0}async function hU(t,e,n,r,s,i,o){const a=iU(t);a.then(m=>{n[m.measurementId]=m.appId,t.options.measurementId&&m.measurementId!==t.options.measurementId&&gn.warn(`The measurement ID in the local Firebase config (${t.options.measurementId}) does not match the measurement ID fetched from the server (${m.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(m=>gn.error(m)),e.push(a);const l=dU().then(m=>{if(m)return r.getId()}),[d,h]=await Promise.all([a,l]);Z4(i)||K4(i,d.measurementId),s("js",new Date);const f=(o==null?void 0:o.config)??{};return f[$4]="firebase",f.update=!0,h!=null&&(f[U4]=h),s("config",d.measurementId,f),d.measurementId}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fU{constructor(e){this.app=e}_delete(){return delete ta[this.app.options.appId],Promise.resolve()}}let ta={},XI=[];const JI={};let xp="dataLayer",pU="gtag",ZI,k_,eT=!1;function mU(){const t=[];if(Yx()&&t.push("This is a browser extension environment."),gk()||t.push("Cookies are not available."),t.length>0){const e=t.map((r,s)=>`(${s+1}) ${r}`).join(" "),n=jn.create("invalid-analytics-context",{errorInfo:e});gn.warn(n.message)}}function gU(t,e,n){mU();const r=t.options.appId;if(!r)throw jn.create("no-app-id");if(!t.options.apiKey)if(t.options.measurementId)gn.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${t.options.measurementId} provided in the "measurementId" field in the local Firebase config.`);else throw jn.create("no-api-key");if(ta[r]!=null)throw jn.create("already-exists",{id:r});if(!eT){G4(xp);const{wrappedGtag:i,gtagCore:o}=J4(ta,XI,JI,xp,pU);k_=i,ZI=o,eT=!0}return ta[r]=hU(t,XI,JI,e,ZI,xp,n),new fU(t)}function yU(t=Ph()){t=Ke(t);const e=ni(t,ah);return e.isInitialized()?e.getImmediate():_U(t)}function _U(t,e={}){const n=ni(t,ah);if(n.isInitialized()){const s=n.getImmediate();if(Yr(e,n.getOptions()))return s;throw jn.create("already-initialized")}return n.initialize({options:e})}function vU(t,e,n){t=Ke(t),uU(k_,ta[t.app.options.appId],e,n).catch(r=>gn.error(r))}function wU(t,e,n,r){t=Ke(t),cU(k_,ta[t.app.options.appId],e,n,r).catch(s=>gn.error(s))}const tT="@firebase/analytics",nT="0.10.19";function EU(){ur(new Xn(ah,(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("installations-internal").getImmediate();return gU(r,s,n)},"PUBLIC")),ur(new Xn("analytics-internal",t,"PRIVATE")),bn(tT,nT),bn(tT,nT,"esm2020");function t(e){try{const n=e.getProvider(ah).getImmediate();return{logEvent:(r,s,i)=>wU(n,r,s,i),setUserProperties:(r,s)=>vU(n,r,s)}}catch(n){throw jn.create("interop-component-reg-failed",{reason:n})}}}EU();const IU={apiKey:"AIzaSyC70mGCRrjE8iOap8iTHuid8HEuyadue8Y",authDomain:"odontocloud-d92ac.firebaseapp.com",projectId:"odontocloud-d92ac",storageBucket:"odontocloud-d92ac.firebasestorage.app",messagingSenderId:"267020714981",appId:"1:267020714981:web:a44416ea83aa1d1172650c",measurementId:"G-ZMCC5CFY0C"},mf=hy(IU),lh=FS(mf),_e=UC(mf);Ii(mf);yU(mf);const Sp="TU EMPRESA S.A.S.",TU="Generado por OdontoCloud",Cu=()=>{const t=new Date;return t.setHours(0,0,0,0),t},hi=t=>{const e=new Date(t);return e.setHours(0,0,0,0),e},bp=t=>{const e=new Date(t);return e.setHours(23,59,59,999),e},wr=(t,e)=>{const n=new Date(t);return n.setDate(n.getDate()+e),n},rT=t=>{const e=new Date(t),n=e.getDay(),r=(n===0?-6:1)-n;return e.setDate(e.getDate()+r),e.setHours(0,0,0,0),e},sT=(t,e)=>t.getFullYear()===e.getFullYear()&&t.getMonth()===e.getMonth()&&t.getDate()===e.getDate();var cT;const vn=typeof navigator<"u"&&((cT=navigator.language)!=null&&cT.startsWith("es"))?"es-ES":"en-US",Cp=t=>{const e=t.getFullYear(),n=String(t.getMonth()+1).padStart(2,"0"),r=String(t.getDate()).padStart(2,"0");return`${e}-${n}-${r}`},vo=t=>(t||"").toString().toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/\s+/g," ").trim();function xU(){const[t,e]=N.useState("day"),[n,r]=N.useState(Cu()),[s,i]=N.useState(Cu()),[o,a]=N.useState(!0),[l,d]=N.useState([]),[h,f]=N.useState(""),[m,w]=N.useState(""),[A,b]=N.useState("");N.useEffect(()=>{a(!0);const z=Ue(_e,"citas"),Z=nt(z,Qt("fecha","asc")),ae=sr(Z,we=>{const Ie=we.docs.map(Te=>{const ne=Te.data(),Re=ne.horaInicio||ne.hora||"00:00",[bt="0",Nt="0"]=Re.split(":"),re=parseInt(bt,10)||0,se=parseInt(Nt,10)||0;let ue;if(ne.fecha&&ne.fecha.toDate)ue=ne.fecha.toDate(),ue.setHours(re,se,0,0);else if(typeof ne.fecha=="string"){const[ge,de,Se]=ne.fecha.split("-");ue=new Date(parseInt(ge,10),parseInt(de,10)-1,parseInt(Se,10),re,se,0,0)}else ne.fecha instanceof Date?(ue=new Date(ne.fecha),ue.setHours(re,se,0,0)):(ue=new Date,ue.setHours(re,se,0,0));const G=ne.documentoPaciente||ne.docPaciente||ne.pacienteDocumento||ne.documento||"",ee=ne.celularPaciente||ne.telefonoPaciente||ne.celular||ne.telefono||"";return{id:Te.id,raw:ne,fecha:ue,horaInicio:Re,paciente:ne.paciente||ne.pacienteNombre||"Sin nombre",doctor:ne.doctor||ne.doctorNombre||"",sucursal:ne.sucursal||"",espacio:ne.espacio||ne.consultorio||"",comentario:ne.comentario||"",estado:ne.estado||"En espera",recordatorio:ne.recordatorio||"",documento:G,telefono:ee}});let Me,fe;if(t==="day")Me=hi(n),fe=bp(n);else if(t==="week"){const Te=rT(n),ne=wr(Te,6);Me=hi(Te),fe=bp(ne)}else{const Te=hi(n),ne=wr(Te,-30),Re=wr(Te,60);Me=hi(ne),fe=bp(Re)}const et=Ie.filter(Te=>Te.fecha>=Me&&Te.fecha<=fe);d(et),a(!1)},we=>{console.error("Error leyendo citas:",we),d([]),a(!1)});return()=>ae()},[t,n]);const P=N.useMemo(()=>{const z=new Set;return l.forEach(Z=>Z.sucursal&&z.add(Z.sucursal)),Array.from(z)},[l]),I=N.useMemo(()=>{const z=new Set;return l.forEach(Z=>Z.doctor&&z.add(Z.doctor)),Array.from(z)},[l]),E=N.useMemo(()=>{const z=A.trim().toLowerCase();return l.filter(Z=>{if(h&&Z.sucursal!==h||m&&Z.doctor!==m)return!1;if(!z)return!0;const ae=[Z.paciente,Z.doctor,Z.comentario,Z.documento,Z.sucursal,Z.espacio,Z.estado],we=Z.raw?JSON.stringify(Z.raw):"";return[...ae,we].filter(Boolean).some(Me=>String(Me).toLowerCase().includes(z))})},[l,h,m,A]),y=N.useMemo(()=>o?"Ocupacin: cargando...":E.length===0?"Ocupacin: sin citas para el rango seleccionado.":`Ocupacin: ${E.length} cita${E.length!==1?"s":""} en el rango actual.`,[E,o]),j=N.useMemo(()=>{const z=new Date(s.getFullYear(),s.getMonth(),1),Z=(z.getDay()+6)%7,ae=new Date(z);ae.setDate(ae.getDate()-Z);const we=[];for(let Ie=0;Ie<6;Ie++){const Me=[];for(let fe=0;fe<7;fe++){const et=new Date(ae),Te=et.getMonth()===s.getMonth(),ne=sT(et,Cu()),Re=sT(et,n);Me.push({date:et,isCurrentMonth:Te,isToday:ne,isSelected:Re}),ae.setDate(ae.getDate()+1)}we.push(Me)}return we},[s,n]),V=()=>{const z=new Date(s);z.setMonth(z.getMonth()-1),i(z)},M=()=>{const z=new Date(s);z.setMonth(z.getMonth()+1),i(z)},T=z=>{r(hi(z)),i(hi(z)),e("day")},_=N.useMemo(()=>s.toLocaleDateString(vn,{month:"long",year:"numeric"}),[s]),S=N.useMemo(()=>{if(t==="day")return n.toLocaleDateString(vn,{weekday:"long",day:"2-digit",month:"long",year:"numeric"});if(t==="week"){const z=rT(n),Z=wr(z,6);return z.toLocaleDateString(vn,{day:"2-digit",month:"short"})+" - "+Z.toLocaleDateString(vn,{day:"2-digit",month:"short",year:"numeric"})}return"ltimas citas (detalle)"},[t,n]),C=()=>{r(t==="day"?wr(n,-1):t==="week"?wr(n,-7):wr(n,-1))},k=()=>{r(t==="day"?wr(n,1):t==="week"?wr(n,7):wr(n,1))},D=()=>{const z=Cu();r(z),i(z),e("day")},R=()=>{var bt,Nt,re;const z=se=>String(se??"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),Z=((bt=document.querySelector('meta[name="company-name"]'))==null?void 0:bt.getAttribute("content"))||Sp,ae=((Nt=document.querySelector('meta[name="company-logo"]'))==null?void 0:Nt.getAttribute("content"))||"",we="Generado por OdontoCloud",Ie=E.length===0?'<tr><td colspan="6" style="padding:8px 6px;color:#6b7280">No hay citas registradas para este rango.</td></tr>':E.map(se=>{const ue=se.fecha.toLocaleDateString(vn),G=se.fecha.toLocaleTimeString(vn,{hour:"2-digit",minute:"2-digit",hour12:!0});return`<tr>
              <td>${z(ue)}</td>
              <td>${z(G)}</td>
              <td>${z(se.paciente)}</td>
              <td>${z(se.doctor)}</td>
              <td>${z(se.espacio)}</td>
              <td>${z(se.comentario)}</td>
            </tr>`}).join(""),fe=`<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>Imprimir  ${z(Z)}</title>
  <style>
    @page { size: A4 portrait; margin: 18mm; }
    body { font-family: Segoe UI, Roboto, Arial, sans-serif; color:#0f172a; }
    .hdr { display:flex; align-items:center; gap:12px; border-bottom:2px solid #e5e7eb; padding-bottom:8px; margin-bottom:12px; }
    .brand { font-size:18px; font-weight:700; color:#0a86d8; line-height:1.1; }
    .sub { font-size:12px; color:#6b7280; }
    table { width:100%; border-collapse:collapse; font-size:12px; }
    th { text-align:left; background:#f3f4f6; border-bottom:1px solid #e5e7eb; padding:8px 6px; }
    td { border-bottom:1px solid #f1f5f9; padding:7px 6px; vertical-align:top; }
    .note { margin-top:8px; font-size:10px; color:#9ca3af; }
    tr, .hdr { page-break-inside: avoid; }
  </style>
</head>
<body>
  <div class="hdr">
    ${ae?`<img src="${ae}" alt="Logo" style="height:36px;object-fit:contain">`:""}
    <div>
      <div class="brand">${z(Z)}</div>
      <div class="sub">Agenda de citas  ${z(S)}</div>
    </div>
  </div>

  <table>
    <thead>
      <tr>
        <th style="width:18%">Fecha</th>
        <th style="width:10%">Hora</th>
        <th style="width:22%">Paciente</th>
        <th style="width:20%">Doctor</th>
        <th style="width:15%">Espacio</th>
        <th>Comentario</th>
      </tr>
    </thead>
    <tbody>${Ie}</tbody>
  </table>

  <div class="note">${z(we)}. ${z(new Date().toLocaleString(vn))}</div>
  <script>
    // Imprimir cuando termine de cargar la pestaa (incluye el logo)
    window.addEventListener('load', function() {
      try { window.focus(); window.print(); } catch (e) {}
    });
  <\/script>
</body>
</html>`,et=new Blob([fe],{type:"text/html;charset=utf-8"}),Te=URL.createObjectURL(et),ne=window.open(Te,"_blank","noopener,noreferrer,width=900,height=700");if(!ne){alert("El navegador bloque la ventana de impresin. Permite pop-ups para este sitio."),URL.revokeObjectURL(Te);return}const Re=()=>{try{URL.revokeObjectURL(Te)}catch{}};(re=ne.addEventListener)==null||re.call(ne,"load",Re),setTimeout(Re,15e3)},K=()=>alert("Funcin de confirmar citas se integrar con n8n / correo."),Ze=()=>D(),Mt=()=>{if(E.length===0){alert("No hay citas para exportar.");return}const z=[`Empresa: ${Sp}`],Z=["Fecha","Hora","Paciente","Doctor","Espacio","Comentario"],ae=E.map(ne=>{const Re=ne.fecha.toLocaleDateString(vn),bt=ne.fecha.toLocaleTimeString(vn,{hour:"2-digit",minute:"2-digit",hour12:!0});return[Re,bt,ne.paciente||"",ne.doctor||"",ne.espacio||"",(ne.comentario||"").replace(/\r?\n/g," ")]}),we=[TU],Ie=[z,[],Z,...ae,[],we].map(ne=>(ne||[]).map(Re=>`"${String(Re??"").replace(/"/g,'""')}"`).join(",")).join(`
`),Me=`citas_${Sp.toLowerCase().replace(/\s+/g,"_")}_${Cp(hi(n))}`+(t==="week"?"_semana":t==="detail"?"_detalle":"")+".csv",fe=new Blob(["\uFEFF"+Ie],{type:"text/csv;charset=utf-8;"}),et=URL.createObjectURL(fe),Te=document.createElement("a");Te.href=et,Te.download=Me,Te.click(),URL.revokeObjectURL(et)},he=async(z,Z)=>{try{const ae=Gt(_e,"citas",z);await ea(ae,{estado:Z})}catch(ae){console.error("Error actualizando estado:",ae),alert("No se pudo actualizar el estado de la cita.")}},Y=(z,Z)=>{if(!z){alert("Este paciente no tiene celular registrado.");return}const ae=String(z).replace(/\D/g,""),we=Z.fecha.toLocaleDateString(vn),Ie=Z.fecha.toLocaleTimeString(vn,{hour:"numeric",minute:"2-digit",hour12:!0}),Me=encodeURIComponent(`Hola ${Z.paciente}, le recordamos su cita odontolgica el ${we} a las ${Ie}. Por favor confirme su asistencia.`),fe=`https://wa.me/${ae}?text=${Me}`;window.open(fe,"_blank")},ce=async z=>{if(window.confirm(`Seguro que deseas eliminar la cita de ${z.paciente} del ${z.fecha.toLocaleDateString(vn)}?`))try{const ae=Gt(_e,"citas",z.id);await ZC(ae)}catch(ae){console.error("Error eliminando cita:",ae),alert(" No se pudo eliminar la cita.")}},me=()=>{const z=document.createElement("div");Object.assign(z.style,{position:"fixed",top:"0",left:"0",width:"100%",height:"100%",background:"rgba(0,0,0,0.55)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:"9999"});const Z=document.createElement("div");Object.assign(Z.style,{background:"#fff",padding:"25px 30px",borderRadius:"14px",width:"520px",maxWidth:"95%",maxHeight:"95%",overflowY:"auto",boxShadow:"0 8px 30px rgba(0,0,0,0.3)",fontFamily:"Segoe UI, Roboto, sans-serif"}),Z.innerHTML=`
      <h2 style="margin-top:0;text-align:center;color:#0a86d8;font-weight:600;"> Nueva Cita</h2>
      <form id="formNuevaCita" style="display:flex;flex-direction:column;gap:12px;margin-top:10px;">
        <label style="font-weight:600;">Paciente existente</label>
        <div style="position:relative;">
          <input type="text" id="buscarPaciente" placeholder="Buscar por nombre, apellido o documento..." autocomplete="off"/>
          <div id="acResultados" style="position:absolute;left:0;right:0;top:calc(100% + 6px);z-index:10000;display:none;background:#fff;border:1px solid #ddd;border-radius:8px;box-shadow:0 8px 22px rgba(0,0,0,.12);max-height:240px;overflow:auto;"></div>
        </div>
        <small style="color:gray;">Si el paciente no existe, marca Registrar nuevo paciente.</small>

        <label style="display:flex;align-items:center;gap:8px;margin-top:5px;">
          <input type="checkbox" id="esNuevoPaciente" />
          <span>Registrar nuevo paciente</span>
        </label>

        <div id="nuevoPacienteCampos" style="display:none;flex-direction:column;gap:8px;margin-top:10px;padding:10px;border-radius:8px;background:#f9f9f9;border:1px solid #ddd;">
          <h4 style="margin:0;text-align:center;color:#0a86d8;">Datos del paciente</h4>
          <div style="display:flex;gap:8px;">
            <input type="text" id="npNombre" placeholder="Nombre" style="flex:1;" />
            <input type="text" id="npApellido" placeholder="Apellido" style="flex:1;" />
          </div>
          <select id="npTipoDocumento">
            <option value="">Tipo de documento</option>
            <option value="CC">Cdula de Ciudadana</option>
            <option value="CE">Cdula de Extranjera</option>
            <option value="TI">Tarjeta de Identidad</option>
            <option value="PA">Pasaporte</option>
            <option value="DI">Documento Internacional</option>
            <option value="OTRO">Otro</option>
          </select>
          <input type="text" id="npDocumento" placeholder="Nmero de documento" />
          <input type="email" id="npCorreo" placeholder="Correo electrnico" />
          <div style="display:flex;gap:5px;">
            <select id="npIndicativo" style="width:40%;">
              <option value="+57"> +57</option>
              <option value="+1"> +1</option>
              <option value="+34"> +34</option>
              <option value="+52"> +52</option>
              <option value="+54"> +54</option>
              <option value="+593"> +593</option>
              <option value="+56"> +56</option>
              <option value="+58"> +58</option>
            </select>
            <input type="tel" id="npCelular" placeholder="Celular (obligatorio)" style="flex:1;" />
          </div>
          <input type="tel" id="npTelefono" placeholder="Telfono fijo (opcional)" />
          <label style="font-weight:500;">Fecha de nacimiento:</label>
          <input type="date" id="npNacimiento" />
          <select id="npSexo">
            <option value="">Sexo</option>
            <option value="Masculino">Masculino</option>
            <option value="Femenino">Femenino</option>
            <option value="Otro">Otro</option>
          </select>
          <textarea id="npComentario" placeholder="Comentario o antecedentes del paciente" rows="2"></textarea>
        </div>

        <hr style="margin:10px 0;border:none;border-top:1px solid #ddd;" />
        <h4 style="margin:0;text-align:center;color:#0a86d8;">Detalles de la cita</h4>
        <input type="text" id="ncDoctor" placeholder="Doctor asignado" required />
        <input type="date" id="ncFecha" required value="${Cp(n)}" />
        <input type="time" id="ncHora" required />
        <input type="text" id="ncEspacio" placeholder="Espacio fsico / Sala" />
        <textarea id="ncComentario" placeholder="Comentario sobre la cita" rows="3"></textarea>

        <div style="display:flex;justify-content:flex-end;gap:10px;margin-top:10px;">
          <button type="button" id="btnCancelarModal" class="btn-cancelar">Cancelar</button>
          <button type="submit" class="btn-guardar">Guardar</button>
        </div>
      </form>
    `;const ae=document.createElement("style");ae.textContent=`
      .btn-cancelar, .btn-guardar { padding: 8px 14px; border: none; border-radius: 6px; cursor: pointer; font-weight: 600; font-size: 14px; transition: .2s; }
      .btn-cancelar { background: #e0e0e0; color: #333; } .btn-cancelar:hover { background: #d5d5d5; }
      .btn-guardar { background: #0a86d8; color: white; } .btn-guardar:hover { background: #0669ac; }
      input, select, textarea { width: 100%; padding: 8px 10px; border: 1px solid #ccc; border-radius: 6px; font-size: 14px; outline: none; }
      input:focus, select:focus, textarea:focus { border-color: #0a86d8; box-shadow: 0 0 0 2px rgba(10,134,216,.2); }
      .ac-item { padding: 8px 10px; display:flex; gap:8px; align-items:baseline; cursor:pointer; }
      .ac-item:hover, .ac-item.active { background:#f5f7fb; }
      .ac-name { font-weight:600; } .ac-doc { color:#64748b; font-size:12px; } .ac-tel { margin-left:auto; font-size:12px; color:#0f172a; }
      .ac-empty { padding:10px; color:#9aa4b2; font-size:13px; }
    `,document.head.appendChild(ae),z.appendChild(Z),document.body.appendChild(z);const we=Z.querySelector("#esNuevoPaciente"),Ie=Z.querySelector("#nuevoPacienteCampos"),Me=Z.querySelector("#buscarPaciente"),fe=Z.querySelector("#acResultados");we.addEventListener("change",()=>{Ie.style.display=we.checked?"flex":"none",we.checked&&(fe.style.display="none")}),Z.querySelector("#btnCancelarModal").addEventListener("click",()=>z.remove());let et=null,Te=null,ne=-1,Re=[];const bt=ee=>{if(Re=ee||[],ne=-1,!ee||ee.length===0){fe.innerHTML='<div class="ac-empty">Sin resultados</div>',fe.style.display="block";return}fe.innerHTML=ee.map((ge,de)=>`
            <div class="ac-item" data-index="${de}" data-id="${ge.id}">
              <span class="ac-name">${ge.nombre}</span>
              <span class="ac-doc"> ${ge.documento||"s/doc"}</span>
              <span class="ac-tel">${ge.celular||ge.telefono||""}</span>
            </div>`).join(""),fe.style.display="block",[...fe.querySelectorAll(".ac-item")].forEach(ge=>{ge.addEventListener("click",()=>{const de=Number(ge.getAttribute("data-index"));Nt(de)})})},Nt=ee=>{const ge=Re[ee];ge&&(Te=ge,Me.value=ge.nombre,fe.style.display="none",we.checked=!1,Ie.style.display="none")},re=ee=>{Re.length&&(ne=(ne+ee+Re.length)%Re.length,[...fe.querySelectorAll(".ac-item")].forEach((ge,de)=>{de===ne?ge.classList.add("active"):ge.classList.remove("active")}))},se=(ee,ge)=>ee.nombreCompleto||ee.paciente||[ee.nombres,ee.apellidos].filter(Boolean).join(" ")||ge,ue=async ee=>{const ge=(ee||"").toString().trim(),de=vo(ge);if(!de||de.length<2)return[];if(/^\d{5,}$/.test(ge))try{const Se=nt(Ue(_e,"pacientes"),Qe("documento","==",ge)),Ve=nt(Ue(_e,"pacientes"),Qe("nroDocumento","==",ge)),[qe,rt]=await Promise.all([Kt(Se),Kt(Ve)]),Ce=qe.empty?rt:qe;if(!Ce.empty)return Ce.docs.slice(0,10).map(Ge=>{const F=Ge.data()||{};return{id:Ge.id,nombre:se(F,Ge.id),documento:F.documento||F.nroDocumento||Ge.id,celular:F.celularPaciente||F.celular||"",telefono:F.telefonoPaciente||F.telefono||""}})}catch{}try{const Se=nt(Ue(_e,"pacientes"),Qt("nombre_busqueda"),kI(de),DI(de+""),Zo(10)),Ve=await Kt(Se);if(!Ve.empty)return Ve.docs.map(qe=>{const rt=qe.data()||{};return{id:qe.id,nombre:se(rt,qe.id),documento:rt.documento||rt.nroDocumento||qe.id,celular:rt.celularPaciente||rt.celular||"",telefono:rt.telefonoPaciente||rt.telefono||""}})}catch{}try{const Se=nt(Ue(_e,"pacientes"),Qt("creado","desc"),Zo(50));return(await Kt(Se)).docs.map(Ce=>({id:Ce.id,...Ce.data()||{}})).map(Ce=>({id:Ce.id,nombre:se(Ce,Ce.id),documento:Ce.documento||Ce.nroDocumento||Ce.id,celular:Ce.celularPaciente||Ce.celular||"",telefono:Ce.telefonoPaciente||Ce.telefono||"",_norm:vo(`${Ce.nombreCompleto||Ce.paciente||""} ${Ce.nombres||""} ${Ce.apellidos||""} ${Ce.documento||Ce.nroDocumento||""}`)})).filter(Ce=>Ce._norm.includes(de)).slice(0,10).map(({_norm:Ce,...Ge})=>Ge)}catch{}return[]};Me.addEventListener("input",()=>{Te=null;const ee=Me.value;if(clearTimeout(et),!ee||ee.trim().length<2){fe.style.display="none";return}et=setTimeout(async()=>{const ge=await ue(ee.trim());bt(ge)},220)}),Me.addEventListener("keydown",ee=>{fe.style.display==="block"&&(ee.key==="ArrowDown"?(ee.preventDefault(),re(1)):ee.key==="ArrowUp"?(ee.preventDefault(),re(-1)):ee.key==="Enter"?ne>=0&&(ee.preventDefault(),Nt(ne)):ee.key==="Escape"&&(fe.style.display="none"))}),document.addEventListener("click",ee=>{Z.contains(ee.target)&&!fe.contains(ee.target)&&ee.target!==Me&&(fe.style.display="none")},{capture:!0});const G=Z.querySelector("#formNuevaCita");G.addEventListener("submit",async ee=>{ee.preventDefault();const ge=we.checked,de=(G.querySelector("#buscarPaciente").value||"").trim(),Se=G.querySelector("#ncDoctor").value.trim(),Ve=G.querySelector("#ncFecha").value,qe=G.querySelector("#ncHora").value,rt=G.querySelector("#ncEspacio").value.trim(),Ce=G.querySelector("#ncComentario").value.trim();if(!Ve||!qe){alert(" Debes seleccionar fecha y hora para la cita.");return}if(!Se){alert(" Indica el doctor asignado.");return}try{let Ge=null,F=null,J="",v="",U="";if(ge){const Le=(G.querySelector("#npNombre").value||"").trim(),Jt=(G.querySelector("#npApellido").value||"").trim();if(J=`${Le} ${Jt}`.trim(),!J){alert(" Debes indicar nombre y apellido para el nuevo paciente.");return}const kt=(G.querySelector("#npDocumento").value||"").trim(),xt=(G.querySelector("#npCelular").value||"").trim(),We=(G.querySelector("#npTelefono").value||"").trim();if(!xt&&!We){alert(" Debes registrar al menos un telfono (celular o fijo) del paciente o de un acudiente.");return}if(Ge=kt||J.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/\s+/g,"_"),F=Gt(_e,"pacientes",Ge),!(await sh(F)).exists()){const Ne=vo(J);await ih(F,{nombres:Le,apellidos:Jt,nombreCompleto:J,paciente:J,nombre_busqueda:Ne,variantes_busqueda:[Ne,vo(Le),vo(Jt)],tipoDocumento:G.querySelector("#npTipoDocumento").value,documento:kt,correo:(G.querySelector("#npCorreo").value||"").trim(),indicativo:G.querySelector("#npIndicativo").value,celular:xt,telefono:We,celularPaciente:xt,telefonoPaciente:We,fechaNacimiento:G.querySelector("#npNacimiento").value,sexo:G.querySelector("#npSexo").value,notas:(G.querySelector("#npComentario").value||"").trim(),creado:new Date().toISOString(),activo:!0,citas:[]},{merge:!0})}v=xt,U=We}else if(Te)Ge=Te.id,J=Te.nombre,F=Gt(_e,"pacientes",Ge),v=Te.celular||"",U=Te.telefono||"";else{if(!de){alert(" Por favor, escribe o selecciona un paciente.");return}const Le=nt(Ue(_e,"pacientes"),Qe("documento","==",de)),Jt=nt(Ue(_e,"pacientes"),Qe("nroDocumento","==",de)),[kt,xt]=await Promise.all([Kt(Le),Kt(Jt)]),We=kt.empty?xt:kt;if(We.empty){let ft=null;try{const Ne=vo(de),is=nt(Ue(_e,"pacientes"),Qt("nombre_busqueda"),kI(Ne),DI(Ne+""),Zo(1)),mr=await Kt(is);if(!mr.empty){const Cn=mr.docs[0],gr=Cn.data()||{};ft={id:Cn.id,ref:Cn.ref,nombre:gr.nombreCompleto||gr.paciente||[gr.nombres,gr.apellidos].filter(Boolean).join(" "),cel:gr.celularPaciente||gr.celular||"",tel:gr.telefonoPaciente||gr.telefono||""}}}catch{}ft?(Ge=ft.id,F=ft.ref,J=ft.nombre||de,v=ft.cel||"",U=ft.tel||""):J=de}else{const ft=We.docs[0],Ne=ft.data()||{};Ge=ft.id,F=ft.ref,J=Ne.nombreCompleto||Ne.paciente||[Ne.nombres,Ne.apellidos].filter(Boolean).join(" ")||de,v=Ne.celularPaciente||Ne.celular||"",U=Ne.telefonoPaciente||Ne.telefono||""}}if(!(v||U||"").trim()){alert(" Este paciente no tiene ningn telfono registrado. Edita sus datos y agrega un nmero antes de guardar la cita.");return}const ye={paciente:J||"Paciente",pacienteId:Ge||null,doctor:Se,fecha:Ve,horaInicio:qe,espacio:rt,comentario:Ce,estado:"En espera",creado:new Date().toISOString(),celularPaciente:v||"",telefonoPaciente:U||""},Pe=await wl(Ue(_e,"citas"),ye);F&&await ih(F,{citas:jM(Pe.id)},{merge:!0}),alert(" Cita registrada correctamente y vinculada al paciente."),z.remove()}catch(Ge){console.error(" Error al guardar cita:",Ge),alert(" Error al guardar la cita. Revisa la consola para ms detalles.")}})},Oe=z=>{var et,Te;const Z=document.createElement("div");Object.assign(Z.style,{position:"fixed",top:"0",left:"0",width:"100%",height:"100%",background:"rgba(0,0,0,0.55)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:"9999"});const ae=document.createElement("div");Object.assign(ae.style,{background:"#fff",padding:"25px 30px",borderRadius:"14px",width:"520px",maxWidth:"95%",maxHeight:"95%",overflowY:"auto",boxShadow:"0 8px 30px rgba(0,0,0,0.3)",fontFamily:"Segoe UI, Roboto, sans-serif"});const we=(et=z.raw)!=null&&et.fecha&&typeof z.raw.fecha=="string"?z.raw.fecha:Cp(z.fecha),Ie=((Te=z.raw)==null?void 0:Te.horaInicio)||z.fecha.toTimeString().slice(0,5);ae.innerHTML=`
      <h2 style="margin-top:0;text-align:center;color:#0a86d8;font-weight:600;"> Editar Cita</h2>
      <form id="formEditarCita" style="display:flex;flex-direction:column;gap:12px;margin-top:10px;">
        <label>Paciente</label>
        <input type="text" id="editPaciente" value="${z.paciente||""}" />

        <label>Doctor asignado</label>
        <input type="text" id="editDoctor" value="${z.doctor||""}" />

        <div style="display:flex;gap:8px;">
          <div style="flex:1;">
            <label>Fecha</label>
            <input type="date" id="editFecha" value="${we}" />
          </div>
          <div style="flex:1;">
            <label>Hora</label>
            <input type="time" id="editHora" value="${Ie}" />
          </div>
        </div>

        <label>Espacio fsico / Sala</label>
        <input type="text" id="editEspacio" value="${z.espacio||""}" />

        <label>Estado</label>
        <select id="editEstado" className="estado-select">
          <option value="En espera" ${z.estado==="En espera"?"selected":""}>En espera</option>
          <option value="En sala" ${z.estado==="En sala"?"selected":""}>En sala</option>
          <option value="Atendiendo" ${z.estado==="Atendiendo"?"selected":""}>Atendiendo</option>
          <option value="Finalizada" ${z.estado==="Finalizada"?"selected":""}>Finalizada</option>
          <option value="pendiente" ${z.estado==="pendiente"?"selected":""}>Pendiente</option>
          <option value="No asisti" ${z.estado==="No asisti"?"selected":""}>No asisti</option>
        </select>

        <label>Comentario</label>
        <textarea id="editComentario" rows="3">${z.comentario||""}</textarea>

        <div style="display:flex;justify-content:flex-end;gap:10px;margin-top:10px;">
          <button type="button" id="btnCancelarEdit" className="btn-cancelar">Cancelar</button>
          <button type="submit" className="btn-guardar">Guardar cambios</button>
        </div>
      </form>
    `;const Me=document.createElement("style");Me.textContent=`
      .btn-cancelar, .btn-guardar { padding: 8px 14px; border: none; border-radius: 6px; cursor: pointer; font-weight: 600; font-size: 14px; transition: .2s; }
      .btn-cancelar { background: #e0e0e0; color: #333; } .btn-cancelar:hover { background: #d5d5d5; }
      .btn-guardar { background: #0a86d8; color: white; } .btn-guardar:hover { background: #0669ac; }
      #formEditarCita input, #formEditarCita select, #formEditarCita textarea { width: 100%; padding: 8px 10px; border: 1px solid #ccc; border-radius: 6px; font-size: 14px; outline: none; }
      #formEditarCita input:focus, #formEditarCita select:focus, #formEditarCita textarea:focus { border-color: #0a86d8; box-shadow: 0 0 0 2px rgba(10,134,216,.2); }
    `,document.head.appendChild(Me),Z.appendChild(ae),document.body.appendChild(Z),ae.querySelector("#btnCancelarEdit").addEventListener("click",()=>Z.remove());const fe=ae.querySelector("#formEditarCita");fe.addEventListener("submit",async ne=>{ne.preventDefault();const Re=fe.querySelector("#editPaciente").value.trim(),bt=fe.querySelector("#editDoctor").value.trim(),Nt=fe.querySelector("#editFecha").value,re=fe.querySelector("#editHora").value,se=fe.querySelector("#editEspacio").value.trim(),ue=fe.querySelector("#editEstado").value,G=fe.querySelector("#editComentario").value.trim();if(!Re)return alert(" El nombre del paciente es obligatorio.");if(!Nt||!re)return alert(" Debes indicar fecha y hora.");try{const ee=Gt(_e,"citas",z.id);await ea(ee,{paciente:Re,doctor:bt,fecha:Nt,horaInicio:re,espacio:se,estado:ue,comentario:G}),alert(" Cita actualizada correctamente."),Z.remove()}catch(ee){console.error(" Error al actualizar cita:",ee),alert(" Error al actualizar la cita. Revisa la consola para ms detalles.")}})},He=z=>{const Z=z.fecha.toLocaleDateString(vn),ae=z.fecha.toLocaleTimeString(vn,{hour:"numeric",minute:"2-digit",hour12:!0}),we=`${Z}  ${ae}`;return u.jsxs("tr",{className:"fade-in-row",onClick:()=>Oe(z),style:{cursor:"pointer"},children:[u.jsx("td",{children:we}),u.jsx("td",{children:z.paciente}),u.jsx("td",{children:z.doctor}),u.jsx("td",{children:z.espacio}),u.jsx("td",{children:z.comentario}),u.jsx("td",{onClick:Ie=>{Ie.stopPropagation()},children:u.jsxs("select",{className:"estado-select",value:z.estado,onChange:Ie=>he(z.id,Ie.target.value),children:[u.jsx("option",{value:"En espera",children:"En espera"}),u.jsx("option",{value:"En sala",children:"En sala"}),u.jsx("option",{value:"Atendiendo",children:"Atendiendo"}),u.jsx("option",{value:"Finalizada",children:"Finalizada"}),u.jsx("option",{value:"pendiente",children:"Pendiente"}),u.jsx("option",{value:"No asisti",children:"No asisti"})]})}),u.jsxs("td",{className:"acciones-cell",onClick:Ie=>{Ie.stopPropagation()},children:[z.telefono?u.jsx("button",{type:"button",className:"btn-whatsapp",onClick:Ie=>{Ie.stopPropagation(),Y(z.telefono,z)},children:"WhatsApp"}):u.jsx("span",{className:"acciones-texto",children:"Sin celular"}),u.jsx("button",{type:"button",className:"btn-delete",onClick:Ie=>{Ie.stopPropagation(),ce(z)},children:"Eliminar"}),z.recordatorio&&u.jsx("span",{className:"acciones-texto",children:z.recordatorio})]})]},z.id)};return u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"odc-topbar-green"}),u.jsx("div",{className:"odc-topbar-blue",children:"Agenda"}),u.jsx("section",{className:"odc-agenda-root",children:u.jsxs("div",{className:"odc-agenda-inner",children:[u.jsxs("aside",{className:"odc-left","aria-label":"Panel izquierdo - calendario y filtros",children:[u.jsxs("div",{className:"odc-mini-calendar-card",role:"region","aria-label":"Mini calendario",children:[u.jsxs("div",{className:"mini-cal-header",children:[u.jsx("button",{className:"cal-arrow",id:"miniCalPrev","aria-label":"Mes anterior",onClick:V,children:""}),u.jsx("div",{id:"miniCalMonthYear","aria-live":"polite",children:_}),u.jsx("button",{className:"cal-arrow",id:"miniCalNext","aria-label":"Mes siguiente",onClick:M,children:""})]}),u.jsxs("table",{className:"mini-month-table","aria-hidden":"false",children:[u.jsx("thead",{children:u.jsxs("tr",{children:[u.jsx("th",{children:"Lu"}),u.jsx("th",{children:"Ma"}),u.jsx("th",{children:"Mi"}),u.jsx("th",{children:"Ju"}),u.jsx("th",{children:"Vi"}),u.jsx("th",{children:"Sa"}),u.jsx("th",{children:"Do"})]})}),u.jsx("tbody",{id:"miniCalendar",children:j.map((z,Z)=>u.jsx("tr",{children:z.map((ae,we)=>u.jsx("td",{className:[ae.isCurrentMonth?"":"empty",ae.isToday?"today":"",ae.isSelected?"selected":""].filter(Boolean).join(" "),onClick:()=>ae.isCurrentMonth&&T(ae.date),children:ae.date.getDate()},we))},Z))})]})]}),u.jsxs("div",{className:"odc-filters-card","aria-label":"Filtros de agenda",children:[u.jsx("label",{htmlFor:"filterSucursal",children:"Sucursal"}),u.jsxs("select",{id:"filterSucursal",value:h,onChange:z=>f(z.target.value),children:[u.jsx("option",{value:"",children:" Todas "}),P.map(z=>u.jsx("option",{value:z,children:z},z))]}),u.jsx("label",{htmlFor:"filterDoctor",children:"Doctores"}),u.jsxs("select",{id:"filterDoctor",value:m,onChange:z=>w(z.target.value),children:[u.jsx("option",{value:"",children:" Todos "}),I.map(z=>u.jsx("option",{value:z,children:z},z))]})]})]}),u.jsxs("main",{className:"odc-right","aria-label":"Panel principal - agenda",children:[u.jsxs("div",{className:"odc-header-bar",role:"region","aria-label":"Controles de la agenda",style:{display:"flex",alignItems:"center",justifyContent:"space-between",gap:12},children:[u.jsxs("div",{className:"odc-header-left",style:{display:"flex",alignItems:"center",gap:12,flexWrap:"wrap"},children:[u.jsx("h3",{className:"odc-title",style:{marginRight:8},children:"Agenda"}),u.jsxs("div",{className:"view-buttons",role:"tablist","aria-label":"Vistas",style:{display:"flex",gap:6},children:[u.jsx("button",{className:`btn view ${t==="day"?"active":""}`,"data-view":"day",role:"tab","aria-selected":t==="day",onClick:()=>e("day"),children:"Da"}),u.jsx("button",{className:`btn view ${t==="week"?"active":""}`,"data-view":"week",role:"tab","aria-selected":t==="week",onClick:()=>e("week"),children:"Semana"}),u.jsx("button",{className:`btn view ${t==="detail"?"active":""}`,"data-view":"detail",role:"tab","aria-selected":t==="detail",onClick:()=>e("detail"),children:"Detalle"})]}),u.jsxs("div",{className:"date-nav",style:{display:"flex",alignItems:"center",gap:6,flex:"0 0 auto"},children:[u.jsx("button",{className:"btn icon",id:"btnPrev","aria-label":"Anterior",onClick:C,children:""}),u.jsx("button",{className:"btn icon",id:"btnNext","aria-label":"Siguiente",onClick:k,children:""}),u.jsx("span",{id:"currentDateDisplay",className:"current-date","aria-live":"polite",style:{whiteSpace:"nowrap"},children:S}),u.jsx("button",{id:"btnHoy",className:"btn small",onClick:D,children:"Hoy"})]})]}),u.jsx("div",{className:"odc-header-right",style:{display:"flex",alignItems:"center",gap:8,flexShrink:0},children:u.jsxs("div",{className:"right-actions",style:{display:"flex",alignItems:"center",gap:8},children:[u.jsx("input",{id:"searchCitas",placeholder:"Buscar...",className:"search-input","aria-label":"Buscar citas",value:A,onChange:z=>b(z.target.value)}),u.jsx("button",{id:"btnNuevaCita",className:"btn green","aria-label":"Nueva cita",onClick:me,children:"+ Nueva cita"})]})})]}),u.jsxs("div",{className:"odc-content-card",role:"region","aria-label":"Contenido agenda",children:[u.jsxs("div",{className:"tools-row",children:[u.jsx("div",{className:"tools-left",children:u.jsx("div",{id:"ocupacionInfo",className:"ocupacion-info",children:y})}),u.jsxs("div",{className:"tools-right",children:[u.jsx("button",{id:"btnPrint",className:"btn",title:"Imprimir agenda",onClick:R,children:" Imprimir"}),u.jsx("button",{id:"btnConfirmar",className:"btn blue",title:"Confirmar citas",onClick:K,children:" Confirmar"}),u.jsx("button",{id:"btnHoyCitas",className:"btn",title:"Ver citas de hoy",onClick:Ze,children:" Hoy"}),u.jsx("button",{id:"btnExportar",className:"btn",title:"Exportar citas a CSV",onClick:Mt,children:" Exportar"})]})]}),u.jsx("div",{className:"table-wrap",role:"region","aria-label":"Lista de citas",children:u.jsxs("table",{className:"appointments-table","aria-live":"polite",children:[u.jsx("thead",{children:u.jsxs("tr",{children:[u.jsx("th",{style:{width:"180px"},children:"Fecha / Hora"}),u.jsx("th",{children:"Paciente"}),u.jsx("th",{children:"Doctor"}),u.jsx("th",{children:"Espacio fsico"}),u.jsx("th",{children:"Comentario"}),u.jsx("th",{style:{width:"120px"},children:"Estado"}),u.jsx("th",{children:"Acciones"})]})}),u.jsx("tbody",{id:"citasTbody",children:o?u.jsx("tr",{children:u.jsx("td",{colSpan:7,className:"no-data",children:"Cargando citas..."})}):E.length===0?u.jsx("tr",{children:u.jsx("td",{colSpan:7,className:"no-data",children:"No hay citas registradas para este rango."})}):E.map(He)})]})})]})]})]})})]})}function SU(){return u.jsxs("div",{style:{padding:"20px"},children:[u.jsx("h2",{children:"Mdulo de Facturacin"}),u.jsx("p",{children:"Aqu se registrarn los pagos, facturas y cobros."})]})}function bU(){return u.jsxs("div",{style:{padding:"20px"},children:[u.jsx("h2",{children:"Mdulo de Facturacin"}),u.jsx("p",{children:"Aqu se registrarn los pagos, facturas y cobros."})]})}function CU(){return u.jsxs("div",{style:{padding:"20px"},children:[u.jsx("h2",{children:"Mdulo de Facturacin"}),u.jsx("p",{children:"Aqu se registrarn los pagos, facturas y cobros."})]})}const Au={caja:"caja",pagos:"facturacion/pagos",facturas:"facturacion/facturas"};var uT;const Ru=typeof navigator<"u"&&((uT=navigator.language)!=null&&uT.startsWith("es"))?"es-ES":"en-US",AU=["Colombia","Argentina","Bolivia","Chile","Costa Rica","Cuba","Ecuador","El Salvador","Espaa","Guatemala","Honduras","Mxico","Nicaragua","Panam","Paraguay","Per","Puerto Rico","Repblica Dominicana","Uruguay","Venezuela","Estados Unidos","Canad"],iT={Colombia:["Bogot","Medelln","Cali","Barranquilla","Cartagena","Ccuta","Bucaramanga","Pereira","Santa Marta","Ibagu"],Mxico:["Ciudad de Mxico","Guadalajara","Monterrey","Puebla","Quertaro","Tijuana","Mrida","Len"],Per:["Lima","Arequipa","Trujillo","Chiclayo","Cusco","Piura"],Chile:["Santiago","Valparaso","Concepcin","La Serena","Antofagasta"],Argentina:["Buenos Aires","Crdoba","Rosario","Mendoza","La Plata"],Espaa:["Madrid","Barcelona","Valencia","Sevilla","Zaragoza","Bilbao"],"Estados Unidos":["Miami","New York","Los ngeles","Houston","Chicago"],Ecuador:["Quito","Guayaquil","Cuenca","Manta"],Venezuela:["Caracas","Maracaibo","Valencia","Barquisimeto","Maracay"]},RU=t=>{if(!t)return"";const[e,n,r]=t.split("-").map(l=>parseInt(l,10)),s=new Date(e,(n||1)-1,r||1),i=new Date;let o=i.getFullYear()-s.getFullYear();const a=i.getMonth()-s.getMonth();return(a<0||a===0&&i.getDate()<s.getDate())&&o--,isNaN(o)?"":String(o)};async function PU(t,{maxW:e=900,maxH:n=900,quality:r=.82}={}){var m;if(!t||!((m=t.type)!=null&&m.startsWith("image/")))return t;const s=await new Promise((w,A)=>{const b=new Image;b.onload=()=>w(b),b.onerror=A,b.src=URL.createObjectURL(t)});let{width:i,height:o}=s;const a=Math.min(e/i,n/o,1);i=Math.round(i*a),o=Math.round(o*a);const l=document.createElement("canvas");l.width=i,l.height=o,l.getContext("2d").drawImage(s,0,0,i,o);const h=await new Promise(w=>l.toBlob(w,"image/jpeg",r)),f=new File([h],(t.name||"foto.jpg").replace(/\.[^.]+$/,".jpg"),{type:"image/jpeg",lastModified:Date.now()});return URL.revokeObjectURL(s.src),f}const El=t=>(t||"").toString().toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/\s+/g," ").trim(),NU=t=>El([t.nombres,t.apellidos,t.nombreCompleto,t.nroDocumento,t.celular,t.email].filter(Boolean).join(" ")),wo={tipoDocumento:"",nroDocumento:"",nroHistoria:"",nombres:"",apellidos:"",nombreCompleto:"",sexo:"",estadoCivil:"",paisNacimiento:"",ciudadNacimiento:"",fechaIngreso:"",fechaNacimiento:"",edad:"",paisDomicilio:"",ciudadDomicilio:"",barrio:"",lugarResidencia:"",estrato:"",zonaResidencial:"",esExtranjero:!1,permitePublicidad:!1,celular:"",telDomicilio:"",telOficina:"",extension:"",email:"",ocupacion:"",nombreResponsable:"",parentesco:"",celularResponsable:"",telefonoResponsable:"",emailResponsable:"",nombreAcompanante:"",telefonoAcompanante:"",convenioBeneficio:"",comoConocio:"",campania:"",remitidoPor:"",asesorComercial:"",tipoVinculacion:"",nombreEps:"",polizaSalud:"",doctor:"",notas:"",rxImagenes:[],historiaClinica:{antecedentes:"",alergias:"",medicamentos:"",motivoConsulta:"",notas:""},odontograma:[],periodontograma:[],presupuestos:[],evoluciones:[],facturacion:{saldoFavor:0,saldoCredito:0},fotoUrl:"",activo:!0},Ap=20,Eo=t=>Number(t||0);function kU(t){const[e,n]=N.useState(!1),[r,s]=N.useState([]),[i,o]=N.useState([]),[a,l]=N.useState("");N.useEffect(()=>{let P=!0;return(async()=>{if(!t){s([]),o([]);return}n(!0),l("");try{let E=nt(Ue(_e,"facturas"),Qe("patientId","==",t),Qt("fechaISO","desc"));const V=(await Kt(E)).docs.map(C=>({id:C.id,...C.data()})).map(C=>({...C,total:Eo(C.total??C.valor??C.montoTotal),estado:(C.estado||"pendiente").toLowerCase(),fechaISO:C.fechaISO||C.fecha||null}));let M=nt(Ue(_e,"pagos"),Qe("patientId","==",t),Qt("fechaISO","desc"));const S=(await Kt(M)).docs.map(C=>({id:C.id,...C.data()})).map(C=>({...C,monto:Eo(C.monto??C.valor??C.total),fechaISO:C.fechaISO||C.fecha||null,medio:C.medio||C.metodo||""}));if(!P)return;s(V),o(S)}catch(E){console.warn("Finanzas: no se pudo leer colecciones. Contino solo con saldos del paciente.",E),P&&l("No se pudieron leer facturas/pagos.")}finally{P&&n(!1)}})(),()=>{P=!1}},[t]);const d=r.reduce((P,I)=>P+Eo(I.total),0),h=i.reduce((P,I)=>P+Eo(I.monto),0),f=r.filter(P=>["pagada","pagado","paid"].includes((P.estado||"").toLowerCase())),m=r.filter(P=>["pendiente","abierta","open","deuda"].includes((P.estado||"").toLowerCase())),w=f.reduce((P,I)=>P+Eo(I.total),0),A=m.reduce((P,I)=>P+Eo(I.total),0);return{loading:e,error:a,facturas:r,pagos:i,totalFacturado:d,totalPagado:h,totalFacturasPagadas:w,totalFacturasPendientes:A}}function DU(t){const[e,n]=N.useState(!1),[r,s]=N.useState([]);return N.useEffect(()=>{let i=!0;return(async()=>{if(!t){s([]);return}n(!0);try{const a=nt(Ue(_e,"citas"),Qe("patientId","==",t),Qt("fechaISO","desc"));let d=(await Kt(a)).docs.map(h=>({id:h.id,...h.data()}));if(d.length===0){const h=nt(Ue(_e,"citas"),Qe("pacienteId","==",t),Qt("fechaISO","desc"));d=(await Kt(h)).docs.map(m=>({id:m.id,...m.data()}))}i&&s(d)}catch(a){console.warn("No se pudieron leer citas:",a),i&&s([])}finally{i&&n(!1)}})(),()=>{i=!1}},[t]),{loading:e,citas:r}}function jU(){var de,Se,Ve,qe,rt,Ce,Ge,F,J;const t=bh(),e=ns(),n=ET.useMemo(()=>{const v=e.pathname.split("/").filter(Boolean),U=v.findIndex(Pe=>["pacientes","agenda","caja","facturacion","config","reportes","software"].includes(Pe)),ye="/"+v.slice(0,U>=0?U:v.length).join("/");return ye==="/"?"":ye},[e.pathname]),r=v=>{const U=String(v||"").replace(/^\//,""),te=n?`${n}/`:"/";t(`${te}${U}`)},s=(v,U)=>{const te=String(v).replace(/^\//,""),ye=U?new URLSearchParams(U).toString():"";return`${n?`${n}/`:"/"}${te}${ye?`?${ye}`:""}`},[i,o]=N.useState(!0),[a,l]=N.useState([]),[d,h]=N.useState(""),[f,m]=N.useState(null),[w,A]=N.useState(!0),[b,P]=N.useState(!1),[I,E]=N.useState(null),[y,j]=N.useState(null),V=N.useRef(null),[M,T]=N.useState("datos"),[_,S]=N.useState(wo),[C,k]=N.useState(null),[D,R]=N.useState(""),[K,Ze]=N.useState([]),Mt=N.useMemo(()=>iT[_.paisNacimiento]||[],[_.paisNacimiento]);N.useEffect(()=>((async()=>{o(!0);try{const te=(await Kt(Ue(_e,"eps"))).docs.map(Pe=>{var Le;return(Le=Pe.data())==null?void 0:Le.nombre}).filter(Boolean),ye=Array.from(new Map(te.map(Pe=>[String(Pe).toLowerCase(),Pe])).values()).sort((Pe,Le)=>Pe.localeCompare(Le,"es"));Ze(ye),await me(!0)}catch(U){console.error(U),alert("No se pudieron cargar pacientes/EPS.")}finally{o(!1)}})(),()=>{V.current&&(V.current(),V.current=null)}),[]),N.useEffect(()=>{S(v=>({...v,nombreCompleto:`${v.nombres} ${v.apellidos}`.trim()}))},[_.nombres,_.apellidos]),N.useEffect(()=>{S(v=>({...v,nroHistoria:v.nroDocumento}))},[_.nroDocumento]),N.useEffect(()=>{S(v=>({...v,edad:RU(v.fechaNacimiento)}))},[_.fechaNacimiento]),N.useEffect(()=>{const v=new Date,U=v.toLocaleDateString(Ru)+" - "+v.toLocaleTimeString(Ru,{hour:"2-digit",minute:"2-digit",hour12:!0});S(te=>({...te,fechaIngreso:U}))},[]);const he=(v,U)=>S(te=>({...te,[v]:U})),Y=()=>{S(wo);const v=new Date,U=v.toLocaleDateString(Ru)+" - "+v.toLocaleTimeString(Ru,{hour:"2-digit",minute:"2-digit",hour12:!0});S(te=>({...te,fechaIngreso:U})),k(null),R(""),E(null)},ce=async v=>{if(!v){k(null),R("");return}try{const U=await PU(v,{maxW:900,maxH:900,quality:.82});k(U);const te=new FileReader;te.onload=ye=>R(ye.target.result),te.readAsDataURL(U)}catch{k(v);const U=new FileReader;U.onload=te=>R(te.target.result),U.readAsDataURL(v)}},me=async(v=!1)=>{o(!0);try{let U;v||!f?U=nt(Ue(_e,"pacientes"),Qt("creado","desc"),Zo(Ap)):U=nt(Ue(_e,"pacientes"),Qt("creado","desc"),AM(f),Zo(Ap));const te=await Kt(U),ye=te.docs.map(Pe=>({id:Pe.id,...Pe.data()}));l(v?ye:Pe=>[...Pe,...ye]),m(te.docs[te.docs.length-1]||null),A(te.size===Ap)}catch(U){console.error(U),alert("No se pudo cargar pacientes.")}finally{o(!1)}},Oe=async v=>{if(v.preventDefault(),!_.nroDocumento.trim())return alert("El nmero de documento es obligatorio.");if(!_.nombres.trim())return alert("Los nombres son obligatorios.");if(!_.apellidos.trim())return alert("Los apellidos son obligatorios.");if(!_.sexo.trim())return alert("El sexo es obligatorio.");if(!_.fechaNacimiento.trim())return alert("La fecha de nacimiento es obligatoria.");if(!_.celular.trim())return alert("El celular es obligatorio.");if(!_.email.trim())return alert("El correo electrnico es obligatorio.");if(!_.tipoVinculacion.trim())return alert("El tipo de vinculacin es obligatorio.");if(!_.nombreEps.trim())return alert("El nombre de la EPS es obligatorio.");try{const U=_.nroDocumento.trim();if(!I&&(await sh(Gt(_e,"pacientes",U))).exists())return alert("Ya existe un paciente con ese nmero de documento.");const te=(_.nombreEps||"").trim(),ye=K.map(We=>We.toLowerCase()).includes(te.toLowerCase());if(te&&!ye&&window.confirm(`La EPS "${te}" no existe. Deseas guardarla para futuras selecciones?`)){const ft=te.toLowerCase().replace(/\s+/g,"_");await ih(Gt(_e,"eps",ft),{nombre:te,nombreLower:te.toLowerCase(),creado:Fn()},{merge:!0})}let Pe=_.fotoUrl||"",Le="";if(C)try{const We=Ii(),ft=(C.name||"foto.jpg").replace(/\s+/g,"_");Le=`pacientes/${U}/${Date.now()}_${ft}`;const Ne=ll(We,Le),is={contentType:C.type||"image/jpeg",cacheControl:"public, max-age=86400"};await zI(Ne,C,is),Pe=await HI(Ne)}catch(We){console.error("Foto (warning):",We)}const Jt=_.creado||null,kt=I&&Jt||Fn(),xt={..._,fotoUrl:Pe,nombre_busqueda:NU({..._,fotoUrl:Pe}),nombresLower:El(_.nombres),apellidosLower:El(_.apellidos),documentoLower:El(_.nroDocumento),emailLower:El(_.email),creado:kt,createdAt:kt,actualizado:Fn(),updatedAt:Fn(),activo:_.activo??!0,celularPaciente:_.celular,telefonoPaciente:_.telDomicilio||"",documento:_.nroDocumento,paciente:_.nombreCompleto};if(await ih(Gt(_e,"pacientes",U),xt,{merge:!0}),Le)try{const We=Ii(),ft=ll(We,`pacientes/${U}`),Ne=await qI(ft),is=Le,mr=Ne.items.filter(Cn=>Cn.fullPath!==is).map(Cn=>wp(Cn).catch(()=>null));await Promise.allSettled(mr)}catch(We){console.warn("No se pudo limpiar fotos antiguas:",We)}alert(I?" Paciente actualizado.":" Paciente guardado."),l(We=>{const ft=We.filter(Ne=>Ne.id!==U);return[{id:U,...xt},...ft]}),P(!1),E(null),Y()}catch(U){console.error("Error guardando paciente:",U),alert(`No se pudo guardar el paciente.

`+((U==null?void 0:U.message)||U))}},He=()=>{Y(),P(!0)},z=()=>{y&&(S({...wo,...y,fotoUrl:y.fotoUrl||""}),k(null),R(y.fotoUrl||""),E(y.id),Ie(),P(!0))},Z=async v=>{if(window.confirm(`Eliminar al paciente "${v.nombreCompleto}"?`))try{await ZC(Gt(_e,"pacientes",v.id)),l(U=>U.filter(te=>te.id!==v.id));try{const U=Ii(),te=ll(U,`pacientes/${v.id}`),Pe=(await qI(te)).items.map(Le=>wp(Le).catch(()=>null));await Promise.allSettled(Pe)}catch(U){console.warn("No se pudo borrar la carpeta de fotos:",U)}}catch(U){console.error(U),alert("No se pudo eliminar.")}},ae=N.useMemo(()=>{const v=d.trim().toLowerCase();return v?a.filter(U=>`${U.nombreCompleto||U.paciente||""} ${U.nroDocumento||""} ${U.celular||U.celularPaciente||""} ${U.email||""}`.toLowerCase().includes(v)):a},[a,d]),we=v=>{Ie();const U=Gt(_e,"pacientes",v.id),te=sr(U,ye=>{ye.exists()?j({id:ye.id,...Me(ye.data())}):j(null)});V.current=te,T("datos")},Ie=()=>{V.current&&(V.current(),V.current=null),j(null)},Me=v=>({...wo,...v,historiaClinica:{...wo.historiaClinica,...v.historiaClinica||{}},facturacion:{...wo.facturacion,...v.facturacion||{}},rxImagenes:Array.isArray(v.rxImagenes)?v.rxImagenes:[],odontograma:Array.isArray(v.odontograma)?v.odontograma:[],periodontograma:Array.isArray(v.periodontograma)?v.periodontograma:[],presupuestos:Array.isArray(v.presupuestos)?v.presupuestos:[],evoluciones:Array.isArray(v.evoluciones)?v.evoluciones:[]}),fe=async v=>{if(y!=null&&y.id)try{await ea(Gt(_e,"pacientes",y.id),{...v,actualizado:Fn(),updatedAt:Fn()})}catch(U){console.error(U),alert("No se pudo actualizar.")}},et=async v=>{if(!(y!=null&&y.id)||!(v!=null&&v.length))return;const U=Ii(),te=[];for(const ye of v){const Pe=(ye.name||"archivo").replace(/\s+/g,"_"),Le=`pacientes/${y.id}/rx/${Date.now()}_${Pe}`,Jt=ll(U,Le);await zI(Jt,ye,{contentType:ye.type});const kt=await HI(Jt);te.push({url:kt,name:ye.name,type:ye.type,size:ye.size||0,created:Date.now(),path:Le})}await fe({rxImagenes:[...y.rxImagenes||[],...te]})},Te=async v=>{if(!(y!=null&&y.id))return;const U=y.rxImagenes[v],te=y.rxImagenes.filter((ye,Pe)=>Pe!==v);await fe({rxImagenes:te});try{if(U!=null&&U.path){const ye=Ii();await wp(ll(ye,U.path))}}catch(ye){console.warn("No se pudo borrar del Storage:",ye)}},ne=(v,U)=>{const te={...y.historiaClinica||{},[v]:U};fe({historiaClinica:te})},Re=v=>{const U=[...y.presupuestos||[],{id:String(Date.now()),...v}];fe({presupuestos:U})},bt=v=>{fe({presupuestos:(y.presupuestos||[]).filter(U=>U.id!==v)})},Nt=v=>{const U=[...y.evoluciones||[],{id:String(Date.now()),fechaISO:new Date().toISOString(),nota:v}];fe({evoluciones:U})},re=v=>{fe({evoluciones:(y.evoluciones||[]).filter(U=>U.id!==v)})},se=(v,U)=>{const te=Array.isArray(y[v])?y[v]:[],ye=te.find(Le=>Le.pieza===U);let Pe;ye?Pe=te.filter(Le=>Le.pieza!==U):Pe=[...te,{pieza:U,estado:"marcada"}],fe({[v]:Pe})},ue=(y==null?void 0:y.id)||null,G=kU(ue),{loading:ee,citas:ge}=DU(ue);return u.jsxs("div",{className:"odc-container",children:[u.jsx("div",{className:"odc-topbar-green"}),u.jsx("div",{className:"odc-topbar-blue",children:u.jsx("div",{className:"odc-top-inner",children:u.jsx("div",{className:"odc-breadcrumbs",children:"Pacientes"})})}),u.jsxs("div",{className:"odc-card",children:[u.jsxs("div",{className:"odc-card-header",children:[u.jsx("h3",{className:"odc-title",children:"Pacientes"}),u.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[u.jsx("input",{className:"search-input",style:{minWidth:280},placeholder:"Buscar por nombre, documento o telfono",value:d,onChange:v=>h(v.target.value)}),u.jsx("button",{type:"button",className:"btn green",onClick:He,children:"+ Nuevo paciente"})]})]}),u.jsx("div",{className:"table-wrap",children:u.jsxs("table",{className:"appointments-table",children:[u.jsx("thead",{children:u.jsxs("tr",{children:[u.jsx("th",{children:"Foto"}),u.jsx("th",{children:"Nombre"}),u.jsx("th",{children:"Documento"}),u.jsx("th",{children:"Celular"}),u.jsx("th",{children:"Correo"}),u.jsx("th",{children:"Estado"})]})}),u.jsx("tbody",{children:i&&a.length===0?u.jsx("tr",{children:u.jsx("td",{className:"no-data",colSpan:6,children:"Cargando"})}):ae.length===0?u.jsx("tr",{children:u.jsx("td",{className:"no-data",colSpan:6,children:"No hay pacientes o no coinciden con la bsqueda."})}):ae.map(v=>u.jsxs("tr",{className:"row-click",onClick:()=>we(v),children:[u.jsx("td",{onClick:U=>U.stopPropagation(),children:v.fotoUrl?u.jsx("img",{src:v.fotoUrl,alt:"Foto",style:{width:36,height:36,borderRadius:"50%",objectFit:"cover"}}):u.jsx("div",{className:"avatar-fallback",children:(v.nombreCompleto||"P")[0]})}),u.jsx("td",{children:v.nombreCompleto||v.paciente||""}),u.jsx("td",{children:v.nroDocumento||v.documento||""}),u.jsx("td",{children:v.celular||v.celularPaciente||""}),u.jsx("td",{children:v.email||""}),u.jsx("td",{children:u.jsx("span",{className:"pill pill-ok",children:v.activo?"Activo":"Inactivo"})})]},v.id))})]})}),u.jsxs("div",{className:"footer-actions",children:[u.jsx("button",{type:"button",className:"btn",disabled:i||!w,onClick:()=>me(!1),children:w?"Cargar ms":"No hay ms"}),u.jsxs("div",{className:"hint",children:[a.length," registros cargados"]})]})]}),b&&u.jsxs("div",{className:"odc-modal",role:"dialog","aria-modal":"true",children:[u.jsx("div",{className:"odc-modal-backdrop",onClick:()=>P(!1)}),u.jsxs("div",{className:"odc-card",style:{width:1e3,maxWidth:"95%",maxHeight:"92vh",overflowY:"auto"},children:[u.jsxs("div",{className:"odc-card-header",children:[u.jsx("h3",{className:"odc-title",children:I?"Editar paciente":"Nuevo paciente"}),u.jsx("button",{type:"button",className:"btn",onClick:()=>P(!1),children:""})]}),u.jsxs("form",{onSubmit:Oe,children:[u.jsx("div",{className:"form-section-title",children:"Foto del paciente"}),u.jsxs("div",{className:"foto-row",children:[u.jsxs("label",{className:"foto-drop",children:[u.jsx("input",{type:"file",accept:"image/*",onChange:v=>{var U;return ce(((U=v.target.files)==null?void 0:U[0])||null)},style:{display:"none"}}),D?u.jsx("img",{src:D,alt:"Preview",className:"foto-preview"}):u.jsx("div",{className:"foto-empty",children:"Arrastra o haz clic para cargar"})]}),D&&u.jsx("button",{type:"button",className:"btn",onClick:()=>ce(null),children:"Quitar foto"})]}),u.jsx("div",{className:"form-section-title",children:"Datos de identificacin"}),u.jsxs("div",{className:"form-grid",children:[u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Tipo de documento *"}),u.jsxs("select",{className:"form-input",value:_.tipoDocumento,onChange:v=>he("tipoDocumento",v.target.value),children:[u.jsx("option",{value:"",children:"Seleccione"}),u.jsx("option",{value:"CC",children:"Cdula"}),u.jsx("option",{value:"TI",children:"Tarjeta de identidad"}),u.jsx("option",{value:"PA",children:"Pasaporte"}),u.jsx("option",{value:"OTRO",children:"Otro"})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Nro. de documento *"}),u.jsx("input",{className:"form-input",value:_.nroDocumento,onChange:v=>he("nroDocumento",v.target.value),placeholder:"Nmero de documento",required:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Nmero de Historia"}),u.jsx("input",{className:"form-input",value:_.nroHistoria,readOnly:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Nombres *"}),u.jsx("input",{className:"form-input",value:_.nombres,onChange:v=>he("nombres",v.target.value),required:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Apellidos *"}),u.jsx("input",{className:"form-input",value:_.apellidos,onChange:v=>he("apellidos",v.target.value),required:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Nombre completo"}),u.jsx("input",{className:"form-input",value:_.nombreCompleto,readOnly:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Sexo *"}),u.jsxs("select",{className:"form-input",value:_.sexo,onChange:v=>he("sexo",v.target.value),required:!0,children:[u.jsx("option",{value:"",children:"Seleccione"}),u.jsx("option",{children:"Masculino"}),u.jsx("option",{children:"Femenino"}),u.jsx("option",{children:"Otro"})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Estado civil *"}),u.jsxs("select",{className:"form-input",value:_.estadoCivil,onChange:v=>he("estadoCivil",v.target.value),required:!0,children:[u.jsx("option",{value:"",children:"Seleccione"}),u.jsx("option",{children:"Soltero"}),u.jsx("option",{children:"Casado"}),u.jsx("option",{children:"Unin libre"}),u.jsx("option",{children:"Divorciado"}),u.jsx("option",{children:"Viudo"})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Pas de nacimiento *"}),u.jsx("input",{className:"form-input",list:"listCountries",value:_.paisNacimiento,onChange:v=>he("paisNacimiento",v.target.value),placeholder:"Escribe y elige",required:!0}),u.jsx("datalist",{id:"listCountries",children:AU.map(v=>u.jsx("option",{value:v},v))})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Ciudad de nacimiento"}),u.jsx("input",{className:"form-input",list:"listCitiesBirth",value:_.ciudadNacimiento,onChange:v=>he("ciudadNacimiento",v.target.value),placeholder:"Escribe y elige"}),u.jsx("datalist",{id:"listCitiesBirth",children:Mt.map(v=>u.jsx("option",{value:v},v))})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Fecha de ingreso"}),u.jsx("input",{className:"form-input",value:_.fechaIngreso,readOnly:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Fecha de nacimiento *"}),u.jsx("input",{type:"date",className:"form-input",value:_.fechaNacimiento,onChange:v=>he("fechaNacimiento",v.target.value),required:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Edad"}),u.jsx("input",{className:"form-input",value:_.edad,readOnly:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Pas de domicilio *"}),u.jsx("input",{className:"form-input",list:"listCountries",value:_.paisDomicilio,onChange:v=>he("paisDomicilio",v.target.value),required:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Ciudad de domicilio *"}),u.jsx("input",{className:"form-input",list:"listCitiesHome",value:_.ciudadDomicilio,onChange:v=>he("ciudadDomicilio",v.target.value),required:!0}),u.jsx("datalist",{id:"listCitiesHome",children:(iT[_.paisDomicilio]||[]).map(v=>u.jsx("option",{value:v},v))})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Barrio *"}),u.jsx("input",{className:"form-input",value:_.barrio,onChange:v=>he("barrio",v.target.value),required:!0,placeholder:"Barrio"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Lugar de residencia *"}),u.jsx("input",{className:"form-input",value:_.lugarResidencia,onChange:v=>he("lugarResidencia",v.target.value),required:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Estrato"}),u.jsxs("select",{className:"form-input",value:_.estrato,onChange:v=>he("estrato",v.target.value),children:[u.jsx("option",{value:"",children:"Seleccione"}),u.jsx("option",{children:"1"}),u.jsx("option",{children:"2"}),u.jsx("option",{children:"3"}),u.jsx("option",{children:"4"}),u.jsx("option",{children:"5"}),u.jsx("option",{children:"6"})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Zona residencial *"}),u.jsxs("select",{className:"form-input",value:_.zonaResidencial,onChange:v=>he("zonaResidencial",v.target.value),required:!0,children:[u.jsx("option",{value:"",children:"Seleccione"}),u.jsx("option",{children:"Urbana"}),u.jsx("option",{children:"Rural"})]})]}),u.jsxs("div",{className:"checkbox-cell",children:[u.jsx("label",{className:"form-label",children:"Es extranjero?"}),u.jsx("input",{type:"checkbox",checked:_.esExtranjero,onChange:v=>he("esExtranjero",v.target.checked)})]}),u.jsxs("div",{className:"checkbox-cell",children:[u.jsx("label",{className:"form-label",children:"Permite publicidad?"}),u.jsx("input",{type:"checkbox",checked:_.permitePublicidad,onChange:v=>he("permitePublicidad",v.target.checked)})]})]}),u.jsx("div",{className:"form-section-title",children:"Contacto"}),u.jsxs("div",{className:"form-grid",children:[u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Celular *"}),u.jsx("input",{className:"form-input",value:_.celular,onChange:v=>he("celular",v.target.value),required:!0,placeholder:"Celular del paciente"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Telfono de domicilio"}),u.jsx("input",{className:"form-input",value:_.telDomicilio,onChange:v=>he("telDomicilio",v.target.value)})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Telfono de oficina"}),u.jsx("input",{className:"form-input",value:_.telOficina,onChange:v=>he("telOficina",v.target.value)})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Extensin"}),u.jsx("input",{className:"form-input",value:_.extension,onChange:v=>he("extension",v.target.value)})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Correo electrnico *"}),u.jsx("input",{type:"email",className:"form-input",value:_.email,onChange:v=>he("email",v.target.value),required:!0,placeholder:"correo@dominio.com"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Ocupacin *"}),u.jsx("input",{className:"form-input",value:_.ocupacion,onChange:v=>he("ocupacion",v.target.value),required:!0})]})]}),u.jsx("div",{className:"form-section-title",children:"Datos de facturacin"}),u.jsxs("div",{className:"form-grid",children:[u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Responsable"}),u.jsx("input",{className:"form-input",value:_.nombreResponsable,onChange:v=>he("nombreResponsable",v.target.value)})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Parentesco"}),u.jsxs("select",{className:"form-input",value:_.parentesco,onChange:v=>he("parentesco",v.target.value),children:[u.jsx("option",{value:"",children:"Seleccione"}),u.jsx("option",{children:"Padre/Madre"}),u.jsx("option",{children:"Hermano"}),u.jsx("option",{children:"Esposo/a"}),u.jsx("option",{children:"Otro"})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Celular"}),u.jsx("input",{className:"form-input",value:_.celularResponsable,onChange:v=>he("celularResponsable",v.target.value)})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Telfono"}),u.jsx("input",{className:"form-input",value:_.telefonoResponsable,onChange:v=>he("telefonoResponsable",v.target.value)})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Correo electrnico"}),u.jsx("input",{type:"email",className:"form-input",value:_.emailResponsable,onChange:v=>he("emailResponsable",v.target.value)})]})]}),u.jsx("div",{className:"form-section-title",children:"Acompaante"}),u.jsxs("div",{className:"form-grid",children:[u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Nombre"}),u.jsx("input",{className:"form-input",value:_.nombreAcompanante,onChange:v=>he("nombreAcompanante",v.target.value),placeholder:"Nombre acompaante"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Telfono"}),u.jsx("input",{className:"form-input",value:_.telefonoAcompanante,onChange:v=>he("telefonoAcompanante",v.target.value),placeholder:"Telfono acompaante"})]})]}),u.jsx("div",{className:"form-section-title",children:"Mercadeo"}),u.jsxs("div",{className:"form-grid",children:[u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Convenio beneficio"}),u.jsx("input",{className:"form-input",value:_.convenioBeneficio,onChange:v=>he("convenioBeneficio",v.target.value)})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Cmo nos conoci?"}),u.jsxs("select",{className:"form-input",value:_.comoConocio,onChange:v=>he("comoConocio",v.target.value),children:[u.jsx("option",{value:"",children:"Seleccione"}),u.jsx("option",{children:"Redes sociales"}),u.jsx("option",{children:"Publicidad"}),u.jsx("option",{children:"Recomendacin"}),u.jsx("option",{children:"Otro"})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Campaa"}),u.jsx("input",{className:"form-input",value:_.campania,onChange:v=>he("campania",v.target.value)})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Remitido por"}),u.jsx("input",{className:"form-input",value:_.remitidoPor,onChange:v=>he("remitidoPor",v.target.value)})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Asesor comercial"}),u.jsx("input",{className:"form-input",value:_.asesorComercial,onChange:v=>he("asesorComercial",v.target.value)})]})]}),u.jsx("div",{className:"form-section-title",children:"EPS"}),u.jsxs("div",{className:"form-grid",children:[u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Tipo de vinculacin *"}),u.jsxs("select",{className:"form-input",value:_.tipoVinculacion,onChange:v=>he("tipoVinculacion",v.target.value),required:!0,children:[u.jsx("option",{value:"",children:"Seleccione"}),u.jsx("option",{children:"Contributivo"}),u.jsx("option",{children:"Subsidiado"}),u.jsx("option",{children:"Particular"}),u.jsx("option",{children:"Otro"})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Nombre de la EPS *"}),u.jsx("input",{className:"form-input",list:"listEps",value:_.nombreEps,onChange:v=>he("nombreEps",v.target.value),placeholder:"Escribe y selecciona",required:!0}),u.jsx("datalist",{id:"listEps",children:K.map(v=>u.jsx("option",{value:v},v))})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Pliza de salud"}),u.jsx("input",{className:"form-input",value:_.polizaSalud,onChange:v=>he("polizaSalud",v.target.value)})]})]}),u.jsx("div",{className:"form-section-title",children:"Doctor"}),u.jsx("div",{className:"form-grid",children:u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Doctor"}),u.jsx("input",{className:"form-input",value:_.doctor,onChange:v=>he("doctor",v.target.value),placeholder:"Usuario / Libre"})]})}),u.jsx("div",{className:"form-section-title",children:"Alertas y Notas"}),u.jsx("div",{className:"form-grid",children:u.jsx("textarea",{className:"form-input",rows:3,value:_.notas,onChange:v=>he("notas",v.target.value),placeholder:"Notas del paciente"})}),u.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:8,marginTop:12},children:[I?u.jsx("button",{type:"button",className:"btn",onClick:()=>Z({id:I,nombreCompleto:_.nombreCompleto}),children:"Eliminar"}):u.jsx("div",{}),u.jsxs("div",{style:{display:"flex",gap:8},children:[u.jsx("button",{type:"button",className:"btn",onClick:()=>P(!1),children:"Cancelar"}),u.jsx("button",{type:"submit",className:"btn blue",children:I?"Actualizar":"Guardar paciente"})]})]})]})]})]}),y&&u.jsxs("div",{className:"odc-modal",role:"dialog","aria-modal":"true",children:[u.jsx("div",{className:"odc-modal-backdrop",onClick:Ie}),u.jsxs("div",{className:"odc-card ficha-card",children:[u.jsxs("div",{className:"ficha-header",children:[u.jsxs("div",{className:"ficha-header-left",children:[y.fotoUrl?u.jsx("img",{src:y.fotoUrl,alt:"Foto",className:"ficha-avatar"}):u.jsx("div",{className:"avatar-fallback ficha-avatar-fallback",children:(y.nombreCompleto||"P")[0]}),u.jsxs("div",{children:[u.jsx("div",{className:"ficha-nombre",children:y.nombreCompleto||""}),u.jsxs("div",{className:"ficha-doc",children:[y.tipoDocumento||""," ",y.nroDocumento||""]}),u.jsxs("div",{className:"ficha-badges",children:[u.jsx("span",{className:"ficha-badge blue",children:"En valoracin"}),u.jsx("span",{className:"ficha-badge green",children:"Sin deuda"})]})]})]}),u.jsx("div",{className:"ficha-header-right",children:u.jsxs("div",{className:"ficha-actions",children:[u.jsx("button",{type:"button",className:"btn",onClick:Ie,children:"Cerrar"}),u.jsx("button",{type:"button",className:"btn blue",onClick:z,children:"Editar"}),u.jsx("button",{type:"button",className:"btn green",onClick:()=>t(s(Au.caja,{cobro:1,patientId:y.id})),title:"Ir a Caja para cobrar a este paciente",children:"Cobrar"})]})})]}),u.jsxs("div",{className:"ficha-body",children:[u.jsxs("aside",{className:"ficha-sidebar",children:[u.jsx("div",{className:"ficha-sidebar-title",children:"Informacin general"}),u.jsx("button",{type:"button",className:`ficha-link ${M==="datos"?"active":""}`,onClick:()=>T("datos"),children:"Datos personales"}),u.jsx("button",{type:"button",className:`ficha-link ${M==="marketing"?"active":""}`,onClick:()=>T("marketing"),children:"Marketing"}),u.jsx("button",{type:"button",className:`ficha-link ${M==="eps"?"active":""}`,onClick:()=>T("eps"),children:"EPS"}),u.jsx("button",{type:"button",className:`ficha-link ${M==="prof"?"active":""}`,onClick:()=>T("prof"),children:"Profesionales"}),u.jsx("button",{type:"button",className:`ficha-link ${M==="rx"?"active":""}`,onClick:()=>T("rx"),children:"Rx/Imgenes/Doc"}),u.jsx("button",{type:"button",className:`ficha-link ${M==="citas"?"active":""}`,onClick:()=>T("citas"),children:"Citas"}),u.jsx("button",{type:"button",className:`ficha-link ${M==="crm"?"active":""}`,onClick:()=>T("crm"),children:"CRM"}),u.jsx("div",{className:"ficha-sidebar-title mt",children:"Historia clnica"}),u.jsx("button",{type:"button",className:`ficha-link ${M==="doc"?"active":""}`,onClick:()=>T("doc"),children:"Doc. Clnicos"}),u.jsx("button",{type:"button",className:`ficha-link ${M==="odonto"?"active":""}`,onClick:()=>T("odonto"),children:"Odontogramas"}),u.jsx("button",{type:"button",className:`ficha-link ${M==="perio"?"active":""}`,onClick:()=>T("perio"),children:"Periodontogramas"}),u.jsx("button",{type:"button",className:`ficha-link ${M==="presu"?"active":""}`,onClick:()=>T("presu"),children:"Presupuestos"}),u.jsx("button",{type:"button",className:`ficha-link ${M==="evo"?"active":""}`,onClick:()=>T("evo"),children:"Evoluciones"}),u.jsx("div",{className:"ficha-sidebar-title mt",children:"Facturacin"}),u.jsx("button",{type:"button",className:`ficha-link ${M==="fact"?"active":""}`,onClick:()=>T("fact"),children:"Resumen"}),u.jsxs("div",{className:"ficha-sidebar-actions",style:{display:"grid",gap:8,marginTop:8},children:[u.jsx("button",{type:"button",className:"btn pay",onClick:()=>t(s(Au.caja,{cobro:1,patientId:y.id})),title:"Cobrar a este paciente",children:"Realizar pago"}),u.jsx("button",{type:"button",className:"btn history",onClick:()=>r(`${Au.pagos}?patientId=${encodeURIComponent(y.id)}`),title:"Ver histrico de pagos",children:"Histrico de pagos"}),u.jsx("button",{type:"button",className:"btn history",onClick:()=>r(`${Au.facturas}?patientId=${encodeURIComponent(y.id)}`),title:"Ver histrico de facturacin",children:"Histrico de facturacin"})]})]}),u.jsxs("main",{className:"ficha-content",children:[M==="datos"&&u.jsxs("section",{className:"ficha-section",children:[u.jsx("h4",{className:"ficha-section-title",children:"Datos personales"}),u.jsx("div",{className:"ficha-grid",children:[["Tipo de documento",y.tipoDocumento],["Nro. de documento",y.nroDocumento],["Nmero de Historia",y.nroHistoria],["Fecha de ingreso",y.fechaIngreso],["Nombres",y.nombres],["Apellidos",y.apellidos],["Nombre completo",y.nombreCompleto],["Sexo",y.sexo],["Estado civil",y.estadoCivil],["Pas de nacimiento",y.paisNacimiento],["Ciudad de nacimiento",y.ciudadNacimiento],["Fecha de nacimiento",y.fechaNacimiento],["Edad",y.edad],["Pas de domicilio",y.paisDomicilio],["Ciudad de domicilio",y.ciudadDomicilio],["Barrio",y.barrio],["Lugar de residencia",y.lugarResidencia],["Estrato",y.estrato],["Zona residencial",y.zonaResidencial],["Extranjero",y.esExtranjero?"S":"No"],["Permite publicidad",y.permitePublicidad?"S":"No"],["Celular",y.celular||y.celularPaciente],["Telfono domicilio",y.telDomicilio||y.telefonoPaciente],["Telfono oficina",y.telOficina],["Extensin",y.extension],["Correo electrnico",y.email],["Ocupacin",y.ocupacion],["Responsable",y.nombreResponsable],["Parentesco",y.parentesco],["Cel. responsable",y.celularResponsable],["Tel. responsable",y.telefonoResponsable],["Email responsable",y.emailResponsable],["Acompaante",y.nombreAcompanante],["Tel. acompaante",y.telefonoAcompanante]].map(([v,U])=>u.jsxs("div",{className:"field",children:[u.jsx("label",{children:v}),u.jsx("input",{className:"form-input",value:U||"",readOnly:!0})]},v))})]}),M==="marketing"&&u.jsxs("section",{className:"ficha-section",children:[u.jsx("h4",{className:"ficha-section-title",children:"Marketing"}),u.jsx("div",{className:"ficha-grid",children:[["Convenio beneficio",y.convenioBeneficio],["Cmo nos conoci?",y.comoConocio],["Campaa",y.campania],["Remitido por",y.remitidoPor],["Asesor comercial",y.asesorComercial]].map(([v,U])=>u.jsxs("div",{className:"field",children:[u.jsx("label",{children:v}),u.jsx("input",{className:"form-input",value:U||"",readOnly:!0})]},v))})]}),M==="eps"&&u.jsxs("section",{className:"ficha-section",children:[u.jsx("h4",{className:"ficha-section-title",children:"EPS"}),u.jsx("div",{className:"ficha-grid",children:[["Tipo de vinculacin",y.tipoVinculacion],["Nombre EPS",y.nombreEps],["Pliza de salud",y.polizaSalud]].map(([v,U])=>u.jsxs("div",{className:"field",children:[u.jsx("label",{children:v}),u.jsx("input",{className:"form-input",value:U||"",readOnly:!0})]},v))})]}),M==="prof"&&u.jsxs("section",{className:"ficha-section",children:[u.jsx("h4",{className:"ficha-section-title",children:"Profesionales"}),u.jsx("div",{className:"ficha-grid",children:u.jsxs("div",{className:"field",children:[u.jsx("label",{children:"Doctor"}),u.jsx("input",{className:"form-input",value:y.doctor||"",readOnly:!0})]})})]}),M==="rx"&&u.jsxs("section",{className:"ficha-section",children:[u.jsx("h4",{className:"ficha-section-title",children:"Rx / Imgenes / Documentos"}),u.jsx("div",{className:"rx-actions",children:u.jsxs("label",{className:"btn blue",children:["Subir archivos",u.jsx("input",{type:"file",multiple:!0,style:{display:"none"},onChange:v=>et([...v.target.files])})]})}),u.jsxs("div",{className:"rx-grid",children:[(y.rxImagenes||[]).map((v,U)=>{var te;return u.jsxs("div",{className:"rx-item",children:[(te=v.type)!=null&&te.startsWith("image/")?u.jsx("a",{href:v.url,target:"_blank",rel:"noreferrer",children:u.jsx("img",{src:v.url,alt:v.name})}):u.jsx("a",{className:"rx-file",href:v.url,target:"_blank",rel:"noreferrer",children:v.name||"archivo"}),u.jsxs("div",{className:"rx-meta",children:[u.jsx("span",{children:v.name}),u.jsx("button",{type:"button",className:"btn small",onClick:()=>Te(U),children:"Eliminar"})]})]},`${v.url}-${U}`)}),(!y.rxImagenes||y.rxImagenes.length===0)&&u.jsx("div",{className:"no-data",children:"Sin archivos an."})]})]}),M==="doc"&&u.jsxs("section",{className:"ficha-section",children:[u.jsx("h4",{className:"ficha-section-title",children:"Doc. Clnicos"}),u.jsxs("div",{className:"ficha-grid",children:[u.jsxs("div",{className:"field",children:[u.jsx("label",{children:"Motivo de consulta"}),u.jsx("textarea",{className:"form-input",rows:3,value:((de=y.historiaClinica)==null?void 0:de.motivoConsulta)||"",onChange:v=>ne("motivoConsulta",v.target.value)})]}),u.jsxs("div",{className:"field",children:[u.jsx("label",{children:"Antecedentes"}),u.jsx("textarea",{className:"form-input",rows:3,value:((Se=y.historiaClinica)==null?void 0:Se.antecedentes)||"",onChange:v=>ne("antecedentes",v.target.value)})]}),u.jsxs("div",{className:"field",children:[u.jsx("label",{children:"Alergias"}),u.jsx("textarea",{className:"form-input",rows:2,value:((Ve=y.historiaClinica)==null?void 0:Ve.alergias)||"",onChange:v=>ne("alergias",v.target.value)})]}),u.jsxs("div",{className:"field",children:[u.jsx("label",{children:"Medicamentos"}),u.jsx("textarea",{className:"form-input",rows:2,value:((qe=y.historiaClinica)==null?void 0:qe.medicamentos)||"",onChange:v=>ne("medicamentos",v.target.value)})]}),u.jsxs("div",{className:"field",children:[u.jsx("label",{children:"Notas"}),u.jsx("textarea",{className:"form-input",rows:3,value:((rt=y.historiaClinica)==null?void 0:rt.notas)||"",onChange:v=>ne("notas",v.target.value)})]})]})]}),M==="odonto"&&u.jsxs("section",{className:"ficha-section",children:[u.jsx("h4",{className:"ficha-section-title",children:"Odontograma (placeholder)"}),u.jsx("div",{className:"odont-grid",children:Array.from({length:32},(v,U)=>U+1).map(v=>{const U=(y.odontograma||[]).some(te=>te.pieza===v);return u.jsx("button",{type:"button",className:`tooth ${U?"on":""}`,onClick:()=>se("odontograma",v),title:`Pieza ${v}`,children:v},v)})})]}),M==="perio"&&u.jsxs("section",{className:"ficha-section",children:[u.jsx("h4",{className:"ficha-section-title",children:"Periodontograma (placeholder)"}),u.jsx("div",{className:"odont-grid",children:Array.from({length:32},(v,U)=>U+1).map(v=>{const U=(y.periodontograma||[]).some(te=>te.pieza===v);return u.jsx("button",{type:"button",className:`tooth ${U?"on":""}`,onClick:()=>se("periodontograma",v),title:`Pieza ${v}`,children:v},v)})})]}),M==="presu"&&u.jsxs("section",{className:"ficha-section",children:[u.jsx("h4",{className:"ficha-section-title",children:"Presupuestos & planes"}),u.jsx(OU,{onAdd:Re}),u.jsxs("div",{className:"presu-list",children:[(y.presupuestos||[]).map(v=>u.jsxs("div",{className:"presu-item",children:[u.jsxs("div",{children:[u.jsx("div",{className:"presu-title",children:v.titulo}),u.jsxs("div",{className:"presu-meta",children:["Costo: $",v.costo||0,"  Estado: ",v.estado||"Pendiente"]})]}),u.jsx("button",{type:"button",className:"btn small",onClick:()=>bt(v.id),children:"Eliminar"})]},v.id)),(!y.presupuestos||y.presupuestos.length===0)&&u.jsx("div",{className:"no-data",children:"Sin presupuestos an."})]})]}),M==="evo"&&u.jsxs("section",{className:"ficha-section",children:[u.jsx("h4",{className:"ficha-section-title",children:"Evoluciones & Remisiones"}),u.jsx(VU,{onAdd:Nt}),u.jsxs("div",{className:"evo-list",children:[(y.evoluciones||[]).map(v=>u.jsxs("div",{className:"evo-item",children:[u.jsx("div",{className:"evo-date",children:new Date(v.fechaISO).toLocaleString()}),u.jsx("div",{className:"evo-note",children:v.nota}),u.jsx("button",{type:"button",className:"btn small",onClick:()=>re(v.id),children:"Eliminar"})]},v.id)),(!y.evoluciones||y.evoluciones.length===0)&&u.jsx("div",{className:"no-data",children:"Sin evoluciones an."})]})]}),M==="fact"&&u.jsxs("section",{className:"ficha-section",children:[u.jsx("h4",{className:"ficha-section-title",children:"Facturacin"}),u.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(220px,1fr))",gap:12},children:[u.jsx(Io,{title:"Total facturado",value:`$ ${G.totalFacturado.toLocaleString()}`}),u.jsx(Io,{title:"Total pagado",value:`$ ${G.totalPagado.toLocaleString()}`}),u.jsx(Io,{title:"Facturas pendientes",value:`$ ${G.totalFacturasPendientes.toLocaleString()}`}),u.jsx(Io,{title:"Saldo pendiente (facturas - pagos)",value:`$ ${(G.totalFacturado-G.totalPagado).toLocaleString()}`}),u.jsx(Io,{title:"Saldo a favor",value:`$ ${(((Ce=y.facturacion)==null?void 0:Ce.saldoFavor)??0).toLocaleString()}`}),u.jsx(Io,{title:"Saldo crdito",value:`$ ${(((Ge=y.facturacion)==null?void 0:Ge.saldoCredito)??0).toLocaleString()}`})]}),G.error&&u.jsxs("div",{className:"hint",style:{marginTop:6},children:[" ",G.error]}),u.jsxs("div",{className:"ficha-grid",style:{marginTop:12},children:[u.jsxs("div",{className:"field",children:[u.jsx("label",{children:"Saldo a favor"}),u.jsx("input",{type:"number",className:"form-input",value:((F=y.facturacion)==null?void 0:F.saldoFavor)??0,onChange:v=>fe({facturacion:{...y.facturacion||{},saldoFavor:Number(v.target.value||0)}})})]}),u.jsxs("div",{className:"field",children:[u.jsx("label",{children:"Saldo crdito"}),u.jsx("input",{type:"number",className:"form-input",value:((J=y.facturacion)==null?void 0:J.saldoCredito)??0,onChange:v=>fe({facturacion:{...y.facturacion||{},saldoCredito:Number(v.target.value||0)}})})]})]}),u.jsxs("div",{style:{marginTop:14,display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:[u.jsxs("div",{className:"mini-card",children:[u.jsx("div",{className:"mini-card-title",children:"ltimas facturas"}),u.jsx("div",{className:"table-wrap",children:u.jsxs("table",{className:"appointments-table",children:[u.jsx("thead",{children:u.jsxs("tr",{children:[u.jsx("th",{children:"Fecha"}),u.jsx("th",{children:"Estado"}),u.jsx("th",{children:"Total"})]})}),u.jsxs("tbody",{children:[G.facturas.slice(0,8).map(v=>u.jsxs("tr",{children:[u.jsx("td",{children:v.fechaISO?new Date(v.fechaISO).toLocaleString():""}),u.jsx("td",{children:String(v.estado||"").toUpperCase()}),u.jsxs("td",{children:["$",(v.total||0).toLocaleString()]})]},v.id)),G.facturas.length===0&&u.jsx("tr",{children:u.jsx("td",{className:"no-data",colSpan:3,children:"Sin facturas."})})]})]})})]}),u.jsxs("div",{className:"mini-card",children:[u.jsx("div",{className:"mini-card-title",children:"ltimos pagos"}),u.jsx("div",{className:"table-wrap",children:u.jsxs("table",{className:"appointments-table",children:[u.jsx("thead",{children:u.jsxs("tr",{children:[u.jsx("th",{children:"Fecha"}),u.jsx("th",{children:"Medio"}),u.jsx("th",{children:"Monto"})]})}),u.jsxs("tbody",{children:[G.pagos.slice(0,8).map(v=>u.jsxs("tr",{children:[u.jsx("td",{children:v.fechaISO?new Date(v.fechaISO).toLocaleString():""}),u.jsx("td",{children:v.medio}),u.jsxs("td",{children:["$",(v.monto||0).toLocaleString()]})]},v.id)),G.pagos.length===0&&u.jsx("tr",{children:u.jsx("td",{className:"no-data",colSpan:3,children:"Sin pagos."})})]})]})})]})]})]}),M==="citas"&&u.jsxs("section",{className:"ficha-section",children:[u.jsx("h4",{className:"ficha-section-title",children:"Citas"}),u.jsx("div",{className:"table-wrap",children:u.jsxs("table",{className:"appointments-table",children:[u.jsx("thead",{children:u.jsxs("tr",{children:[u.jsx("th",{children:"Fecha"}),u.jsx("th",{children:"Estado"}),u.jsx("th",{children:"Motivo"}),u.jsx("th",{children:"Profesional"})]})}),u.jsx("tbody",{children:ee?u.jsx("tr",{children:u.jsx("td",{className:"no-data",colSpan:4,children:"Cargando"})}):ge.length===0?u.jsx("tr",{children:u.jsx("td",{className:"no-data",colSpan:4,children:"Sin citas registradas."})}):ge.map(v=>u.jsxs("tr",{children:[u.jsx("td",{children:v.fechaISO?new Date(v.fechaISO).toLocaleString():""}),u.jsx("td",{children:v.estado||""}),u.jsx("td",{children:v.motivo||""}),u.jsx("td",{children:v.profesional||""})]},v.id))})]})})]}),M==="crm"&&u.jsxs("section",{className:"ficha-section",children:[u.jsx("h4",{className:"ficha-section-title",children:"CRM"}),u.jsx("div",{className:"no-data",children:"Notas / recordatorios comerciales del paciente."})]}),u.jsx("div",{className:"ficha-footer"})]})]})]})]})]})}function Io({title:t,value:e}){return u.jsxs("div",{className:"mini-card",children:[u.jsx("div",{className:"mini-card-title",children:t}),u.jsx("div",{style:{fontWeight:700,fontSize:20,marginTop:6},children:e})]})}function OU({onAdd:t}){const[e,n]=N.useState(""),[r,s]=N.useState(""),[i,o]=N.useState("Pendiente");return u.jsxs("div",{className:"presu-form",children:[u.jsx("input",{className:"form-input",placeholder:"Procedimiento / plan",value:e,onChange:a=>n(a.target.value)}),u.jsx("input",{type:"number",className:"form-input",placeholder:"Costo",value:r,onChange:a=>s(a.target.value)}),u.jsxs("select",{className:"form-input",value:i,onChange:a=>o(a.target.value),children:[u.jsx("option",{children:"Pendiente"}),u.jsx("option",{children:"Aprobado"}),u.jsx("option",{children:"Rechazado"})]}),u.jsx("button",{type:"button",className:"btn blue",onClick:()=>{if(!e)return alert("Ttulo requerido");t({titulo:e,costo:Number(r||0),estado:i}),n(""),s(""),o("Pendiente")},children:"Agregar"})]})}function VU({onAdd:t}){const[e,n]=N.useState("");return u.jsxs("div",{className:"evo-form",children:[u.jsx("textarea",{className:"form-input",rows:2,placeholder:"Escribe la evolucin / remisin",value:e,onChange:r=>n(r.target.value)}),u.jsx("button",{type:"button",className:"btn blue",onClick:()=>{e.trim()&&(t(e.trim()),n(""))},children:"Guardar evolucin"})]})}function LU(){return u.jsxs("div",{style:{padding:"20px"},children:[u.jsx("h2",{children:"Mdulo de Facturacin"}),u.jsx("p",{children:"Aqu se registrarn los pagos, facturas y cobros."})]})}const Er=t=>(Number(t)||0).toLocaleString("es-CO",{maximumFractionDigits:0}),To=()=>new Date().toISOString().slice(0,10),MU=(t=new Date)=>new Date(t.getFullYear(),t.getMonth(),t.getDate(),0,0,0,0),FU=(t=new Date)=>new Date(t.getFullYear(),t.getMonth(),t.getDate()+1,0,0,0,0),oT=t=>$e.fromDate(t),UU=()=>{const[t,e]=N.useState(null);return N.useEffect(()=>{const n=vy(lh,r=>e(r||null));return()=>n()},[]),t},Ut=({children:t,align:e})=>u.jsx("th",{className:"oc-th",style:{position:"sticky",top:0,zIndex:1,textAlign:e||"left",background:"var(--oc-surface, #fff)"},children:t}),$U=()=>Math.random().toString(36).slice(2)+Math.random().toString(36).slice(2);function BU(){var Ge;const t=UU(),e=[{key:"abrir",label:"Abrir caja",icon:""},{key:"abiertas",label:"Cajas abiertas",icon:""},{key:"cerradas",label:"Cajas cerradas",icon:""},{key:"mio",label:"Mi caja (hoy)",icon:""},{key:"simulados",label:"Cierres simulados",icon:""},{key:"bancos",label:"Bancos",icon:""}],[n,r]=N.useState("abiertas"),[s,i]=N.useState(""),[o,a]=N.useState(""),l=N.useRef(null),[d,h]=N.useState(!1),[f,m]=N.useState(""),[w,A]=N.useState([]),[b,P]=N.useState(!0),[I,E]=N.useState([]),[y,j]=N.useState(!0),[V,M]=N.useState(null),[T,_]=N.useState(!0),[S,C]=N.useState(""),[k,D]=N.useState([]),[R,K]=N.useState(null),[Ze,Mt]=N.useState(""),[he,Y]=N.useState("efectivo"),[ce,me]=N.useState(!1),[Oe,He]=N.useState("ingreso"),[z,Z]=N.useState(""),[ae,we]=N.useState(""),[Ie,Me]=N.useState(!1),[fe,et]=N.useState([]),[Te,ne]=N.useState([]);N.useEffect(()=>{const F=nt(Ue(_e,"cajas"),Qe("estado","==","abierta"),Qt("fechaApertura","desc")),J=sr(F,v=>{A(v.docs.map(U=>Re(U.id,U.data()))),P(!1),i("")},v=>{console.error(v),i((v==null?void 0:v.code)==="failed-precondition"?"Falta ndice (estado, fechaApertura) en Firestore.":(v==null?void 0:v.code)==="permission-denied"?"Permiso denegado en Firestore (revisa reglas).":"No se pudieron leer las cajas."),P(!1)});return()=>J()},[]),N.useEffect(()=>{const F=nt(Ue(_e,"cajas"),Qe("estado","==","cerrada"),Qt("fechaCierre","desc")),J=sr(F,v=>{E(v.docs.map(U=>Re(U.id,U.data()))),j(!1)},v=>{console.error(v),j(!1)});return()=>J()},[]),N.useEffect(()=>{if(!t){M(null),_(!1);return}_(!0);const F=nt(Ue(_e,"cajas"),Qe("estado","==","abierta"),Qe("usuarioId","==",t.uid),Qe("fechaApertura",">=",oT(MU())),Qe("fechaApertura","<",oT(FU()))),J=sr(F,v=>{const U=v.docs[0];M(U?Re(U.id,U.data()):null),_(!1)},v=>{console.error(v),_(!1),(v==null?void 0:v.code)==="failed-precondition"&&i("Falta ndice (estado, usuarioId, fechaApertura) en Firestore.")});return()=>J()},[t]),N.useEffect(()=>{if(!(V!=null&&V.id)){et([]),ne([]);return}const F=nt(Ue(_e,"movimientos"),Qe("cashId","==",V.id),Qe("dia","==",To()),Qt("fecha","desc")),J=sr(F,te=>et(te.docs.map(ye=>({id:ye.id,...ye.data()}))),te=>console.error(te)),v=nt(Ue(_e,"payments"),Qe("cashId","==",V.id),Qe("dia","==",To()),Qt("fecha","desc")),U=sr(v,te=>ne(te.docs.map(ye=>({id:ye.id,...ye.data()}))),te=>console.error(te));return()=>{J(),U()}},[V==null?void 0:V.id]),N.useEffect(()=>{if(!(S!=null&&S.trim())){D([]);return}const F=nt(Ue(_e,"patients"),Qe("q",">=",G(S)),Qe("q","<=",G(S)+""),Qt("q","asc")),J=sr(F,v=>D(v.docs.map(U=>({id:U.id,...U.data()}))),v=>console.error(v));return()=>J()},[S]);function Re(F,J={}){const v=xt=>{var We;return((We=xt==null?void 0:xt.toDate)==null?void 0:We.call(xt))||(typeof xt=="string"?new Date(xt):xt||null)},U=v(J.fechaApertura),te=v(J.fechaCierre),ye=Number(J.baseInicial||0),Pe=Number(J.baseActual!==void 0?J.baseActual:ye),Le=Number(J.saldoInicial||0),Jt=Number(J.saldoActual!==void 0?J.saldoActual:Le),kt=[];return Jt<0&&kt.push("Saldo negativo"),Pe<0&&kt.push("Base negativa"),{id:F,estado:J.estado||"abierta",usuarioId:J.usuarioId||"",usuarioNombre:J.usuarioNombre||"Usuario",nombre:J.nombre||J.usuarioNombre||"Caja",fechaApertura:U,fechaCierre:te,baseInicial:ye,baseActual:Pe,saldoInicial:Le,saldoActual:Jt,ia:kt}}const bt=async F=>{var J;if((J=F==null?void 0:F.preventDefault)==null||J.call(F),!t){i("Debes iniciar sesin para abrir una caja.");return}h(!0);try{const v=Number(f||0);await wl(Ue(_e,"cajas"),{estado:"abierta",usuarioId:t.uid,usuarioNombre:t.displayName||t.email||"Usuario",fechaApertura:Fn(),baseInicial:v,baseActual:v,saldoInicial:0,saldoActual:0,dia:To()}),m(""),r("mio"),i("")}catch(v){console.error(v),i("No se pudo abrir la caja.")}finally{h(!1)}},Nt=async F=>{try{await ea(Gt(_e,"cajas",F),{estado:"cerrada",fechaCierre:Fn()}),r("cerradas")}catch(J){console.error(J),i("No se pudo cerrar la caja.")}},re=async F=>{var v;if((v=F==null?void 0:F.preventDefault)==null||v.call(F),!(V!=null&&V.id)){i("Debes abrir tu caja para registrar movimientos.");return}const J=Number(ae||0);if(!(!J||J<=0)){Me(!0);try{await wl(Ue(_e,"movimientos"),{cashId:V.id,tipo:Oe,concepto:z||(Oe==="ingreso"?"Ingreso":"Egreso"),valor:J,fecha:Fn(),dia:To(),usuarioId:(t==null?void 0:t.uid)||null});const U=Oe==="ingreso"?J:-J;await ea(Gt(_e,"cajas",V.id),{saldoActual:VI(U)}),Z(""),we("")}catch(U){console.error(U),i("No se pudo registrar el movimiento.")}finally{Me(!1)}}},se=async F=>{var v;if((v=F==null?void 0:F.preventDefault)==null||v.call(F),!(V!=null&&V.id))return i("Abre tu caja para cobrar.");const J=Number(Ze||0);if(!(!J||J<=0)){if(!R)return i("Selecciona un paciente.");me(!0);try{const U=await wl(Ue(_e,"payments"),{cashId:V.id,patientId:R.id,patientName:R.nombre||R.name||"Paciente",invoiceId:null,valor:J,medio:he,estado:"aprobado",fecha:Fn(),dia:To()});await ea(Gt(_e,"cajas",V.id),{saldoActual:VI(J)}),Mt(""),Y("efectivo"),i(`Pago registrado (${U.id}).`)}catch(U){console.error(U),i("No se pudo registrar el pago.")}finally{me(!1)}}},ue=async F=>{var v;if((v=F==null?void 0:F.preventDefault)==null||v.call(F),!(V!=null&&V.id))return i("Abre tu caja para cobrar.");const J=Number(Ze||0);if(!(!J||J<=0)){if(!R)return i("Selecciona un paciente.");me(!0);try{const te=`https://pay.odontocloud/mock/${$U()}`,ye=await wl(Ue(_e,"payments"),{cashId:V.id,patientId:R.id,patientName:R.nombre||R.name||"Paciente",invoiceId:null,valor:J,medio:"link",estado:"pending",linkUrl:te,fecha:Fn(),dia:To()});i(`Link de pago generado: ${te}`),Mt("")}catch(U){console.error(U),i("No se pudo generar link de pago.")}finally{me(!1)}}},G=F=>(F||"").toString().normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase(),ee=N.useMemo(()=>{const F=G(o);return F?w.filter(J=>[J.nombre,J.usuarioNombre,Er(J.saldoActual),Er(J.baseActual)].map(G).some(v=>v.includes(F))):w},[o,w]),ge=()=>u.jsxs("div",{className:"card",children:[u.jsx("div",{className:"oc-card-head",style:{marginBottom:8},children:u.jsx("h3",{children:"Abrir caja"})}),u.jsxs("form",{className:"oc-form",onSubmit:bt,style:{display:"flex",gap:12,alignItems:"end",flexWrap:"wrap"},children:[u.jsxs("label",{style:{display:"inline-flex",flexDirection:"column",gap:6},children:[u.jsx("span",{children:"Base inicial (COP)"}),u.jsx("input",{type:"number",className:"oc-input",min:"0",step:"1000",value:f,onChange:F=>m(F.target.value),placeholder:"0"})]}),u.jsx("button",{className:"oc-btn",type:"submit",disabled:d,children:d?"Abriendo...":"Abrir caja"})]}),u.jsxs("p",{className:"oc-muted",style:{marginTop:8},children:["Se asociar a tu usuario y quedar visible en ",u.jsx("b",{children:"Mi caja (hoy)"}),"."]})]}),de=()=>u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"card",style:{marginBottom:10},children:u.jsxs("div",{className:"oc-card-head",style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[u.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[u.jsx("h3",{style:{margin:0},children:"Cajas Abiertas"}),u.jsx("span",{className:"oc-tag",children:ee.length}),s&&u.jsx("span",{className:"oc-tag oc-tag-danger",children:s})]}),u.jsx("input",{ref:l,className:"oc-input",style:{maxWidth:280},placeholder:"Buscar...",value:o,onChange:F=>a(F.target.value)})]})}),u.jsx("div",{className:"card",children:u.jsx("div",{className:"oc-table-wrap",children:u.jsxs("table",{className:"oc-table",children:[u.jsx("thead",{className:"oc-thead",children:u.jsxs("tr",{className:"oc-tr",children:[u.jsx(Ut,{children:"Caja"}),u.jsx(Ut,{children:"Fecha apertura"}),u.jsx(Ut,{align:"right",children:"Base actual"}),u.jsx(Ut,{align:"right",children:"Saldo inicial"}),u.jsx(Ut,{align:"right",children:"Saldo actual"}),u.jsx(Ut,{children:"Usuario"}),u.jsx(Ut,{children:"Acciones"})]})}),u.jsx("tbody",{className:"oc-tbody",children:b?u.jsx(aT,{cols:7}):ee.length===0?u.jsx("tr",{className:"oc-tr",children:u.jsx("td",{className:"oc-td",colSpan:7,children:u.jsx("span",{className:"oc-muted",children:"Sin cajas abiertas."})})}):ee.map(F=>{var J;return u.jsxs("tr",{className:"oc-tr",children:[u.jsxs("td",{className:"oc-td",children:[u.jsx("b",{children:F.nombre})," ",(J=F.ia)!=null&&J.length?u.jsx("span",{className:"oc-tag oc-tag-danger",title:F.ia.join("  "),children:"IA"}):null]}),u.jsx("td",{className:"oc-td",children:F.fechaApertura?F.fechaApertura.toLocaleString("es-CO"):""}),u.jsxs("td",{className:"oc-td",style:{textAlign:"right"},children:["$",Er(F.baseActual)]}),u.jsxs("td",{className:"oc-td",style:{textAlign:"right"},children:["$",Er(F.saldoInicial)]}),u.jsxs("td",{className:"oc-td",style:{textAlign:"right",color:F.saldoActual<0?"#b91c1c":void 0,fontWeight:600},children:["$",Er(F.saldoActual)]}),u.jsx("td",{className:"oc-td",children:F.usuarioNombre}),u.jsxs("td",{className:"oc-td",style:{whiteSpace:"nowrap"},children:[u.jsx("button",{className:"oc-small-btn",onClick:()=>r("mio"),children:"Ver"})," ",u.jsx("button",{className:"oc-small-btn oc-danger",onClick:()=>Nt(F.id),children:"Cerrar"})]})]},F.id)})})]})})})]}),Se=()=>u.jsxs("div",{className:"card",children:[u.jsxs("div",{className:"oc-card-head",style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[u.jsx("h3",{children:"Mi caja (hoy)"}),(V==null?void 0:V.estado)==="abierta"&&u.jsxs("div",{style:{display:"flex",gap:8},children:[u.jsx("span",{className:"oc-tag oc-tag-success",children:"Abierta"}),u.jsx("button",{className:"oc-small-btn oc-danger",onClick:()=>Nt(V.id),children:"Cerrar caja"})]})]}),T?u.jsx("div",{className:"oc-muted",children:"Cargando"}):V?u.jsxs(u.Fragment,{children:[u.jsxs("div",{className:"oc-stats-row",style:{marginBottom:12},children:[u.jsxs("div",{className:"stat-card",children:[u.jsx("span",{className:"stat-label",children:"Base actual"}),u.jsxs("span",{className:"stat-value",children:["$",Er(V.baseActual)]})]}),u.jsxs("div",{className:"stat-card",children:[u.jsx("span",{className:"stat-label",children:"Saldo actual"}),u.jsxs("span",{className:"stat-value",style:{color:V.saldoActual<0?"#b91c1c":void 0},children:["$",Er(V.saldoActual)]})]})]}),u.jsxs("div",{className:"card",style:{marginBottom:12},children:[u.jsx("h4",{style:{marginBottom:8},children:"Cobro rpido"}),u.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr auto",gap:8},children:[u.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:6},children:[u.jsx("label",{className:"oc-muted",children:"Paciente"}),u.jsx("input",{className:"oc-input",placeholder:"Buscar nombre o documento",value:S,onChange:F=>C(F.target.value)}),S&&k.length>0&&u.jsx("div",{className:"oc-dropdown",children:k.slice(0,6).map(F=>u.jsx("button",{className:`oc-menu-item ${(R==null?void 0:R.id)===F.id?"active":""}`,onClick:()=>{K(F),C(F.nombre||F.name||F.doc||"")},type:"button",children:(F.nombre||F.name||"Paciente")+(F.doc?`  ${F.doc}`:"")},F.id))})]}),u.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:6},children:[u.jsx("label",{className:"oc-muted",children:"Monto (COP)"}),u.jsx("input",{className:"oc-input",type:"number",min:"0",step:"1000",placeholder:"0",value:Ze,onChange:F=>Mt(F.target.value)})]}),u.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:6},children:[u.jsx("label",{className:"oc-muted",children:"Medio"}),u.jsxs("select",{className:"oc-input",value:he,onChange:F=>Y(F.target.value),children:[u.jsx("option",{value:"efectivo",children:"Efectivo"}),u.jsx("option",{value:"tarjeta",children:"Tarjeta"}),u.jsx("option",{value:"transferencia",children:"Transferencia"}),u.jsx("option",{value:"link",children:"Link (en lnea)"})]})]}),u.jsx("div",{style:{display:"flex",alignItems:"end",gap:6},children:he==="link"?u.jsx("button",{className:"oc-btn",onClick:ue,disabled:ce,children:ce?"Creando":"Generar link"}):u.jsx("button",{className:"oc-btn",onClick:se,disabled:ce,children:ce?"Guardando":"Registrar pago"})})]}),u.jsxs("p",{className:"oc-muted",style:{marginTop:8},children:["Para link, el saldo se actualiza cuando el pago pase a ",u.jsx("b",{children:"aprobado"})," (webhook)."]})]}),u.jsxs("div",{className:"card",style:{marginBottom:12},children:[u.jsx("h4",{style:{marginBottom:8},children:"Movimiento manual"}),u.jsxs("form",{onSubmit:re,style:{display:"grid",gridTemplateColumns:"120px 1fr 180px auto",gap:8},children:[u.jsxs("select",{className:"oc-input",value:Oe,onChange:F=>He(F.target.value),children:[u.jsx("option",{value:"ingreso",children:"Ingreso"}),u.jsx("option",{value:"egreso",children:"Egreso"})]}),u.jsx("input",{className:"oc-input",placeholder:"Concepto (ej. Caja chica, Arriendo, etc.)",value:z,onChange:F=>Z(F.target.value)}),u.jsx("input",{className:"oc-input",type:"number",min:"0",step:"1000",placeholder:"0",value:ae,onChange:F=>we(F.target.value)}),u.jsx("button",{className:"oc-btn",disabled:Ie,children:Ie?"Guardando":"Agregar"})]})]}),u.jsxs("div",{className:"card",children:[u.jsx("h4",{style:{marginBottom:8},children:"Movimientos y pagos (hoy)"}),u.jsx("div",{className:"oc-table-wrap",style:{marginBottom:12},children:u.jsxs("table",{className:"oc-table",children:[u.jsx("thead",{className:"oc-thead",children:u.jsxs("tr",{className:"oc-tr",children:[u.jsx(Ut,{children:"Tipo"}),u.jsx(Ut,{children:"Concepto / Paciente"}),u.jsx(Ut,{children:"Medio"}),u.jsx(Ut,{children:"Estado"}),u.jsx(Ut,{align:"right",children:"Valor"}),u.jsx(Ut,{children:"Hora"})]})}),u.jsx("tbody",{className:"oc-tbody",children:fe.length===0&&Te.length===0?u.jsx("tr",{className:"oc-tr",children:u.jsx("td",{className:"oc-td",colSpan:6,children:u.jsx("span",{className:"oc-muted",children:"Sin movimientos ni pagos an."})})}):u.jsxs(u.Fragment,{children:[Te.map(F=>{var J,v;return u.jsxs("tr",{className:"oc-tr",children:[u.jsx("td",{className:"oc-td",children:"Pago"}),u.jsxs("td",{className:"oc-td",children:[F.patientName||"Paciente"," ",F.linkUrl?u.jsx("a",{href:F.linkUrl,target:"_blank",rel:"noreferrer",children:"(link)"}):null]}),u.jsx("td",{className:"oc-td",children:F.medio}),u.jsx("td",{className:"oc-td",children:u.jsx("span",{className:`oc-tag ${F.estado==="aprobado"?"oc-tag-success":F.estado==="pending"?"oc-tag-warning":"oc-tag-danger"}`,children:F.estado})}),u.jsxs("td",{className:"oc-td",style:{textAlign:"right"},children:["$",Er(F.valor)]}),u.jsx("td",{className:"oc-td",children:(v=(J=F.fecha)==null?void 0:J.toDate)!=null&&v.call(J)?F.fecha.toDate().toLocaleTimeString("es-CO"):""})]},`pay-${F.id}`)}),fe.map(F=>{var J,v;return u.jsxs("tr",{className:"oc-tr",children:[u.jsx("td",{className:"oc-td",children:F.tipo}),u.jsx("td",{className:"oc-td",children:F.concepto}),u.jsx("td",{className:"oc-td",children:""}),u.jsx("td",{className:"oc-td",children:u.jsx("span",{className:"oc-tag",children:(F.tipo==="ingreso","ok")})}),u.jsxs("td",{className:"oc-td",style:{textAlign:"right"},children:["$",Er(F.valor)]}),u.jsx("td",{className:"oc-td",children:(v=(J=F.fecha)==null?void 0:J.toDate)!=null&&v.call(J)?F.fecha.toDate().toLocaleTimeString("es-CO"):""})]},`mov-${F.id}`)})]})})]})}),u.jsx("p",{className:"oc-muted",children:"Sugerencia: crea ndice compuesto para `movimientos(cashId, dia, fecha)` y `payments(cashId, dia, fecha)` para rendimiento."})]})]}):u.jsxs("div",{className:"oc-empty",children:[u.jsx("p",{className:"oc-muted",children:"No tienes una caja abierta hoy."}),u.jsx("button",{className:"oc-btn",onClick:()=>r("abrir"),children:"Abrir caja"})]})]}),Ve=()=>u.jsxs("div",{className:"card",children:[u.jsx("div",{className:"oc-card-head",style:{marginBottom:8},children:u.jsxs("h3",{children:["Cajas cerradas ",u.jsx("span",{className:"oc-tag",children:I.length})]})}),u.jsx("div",{className:"oc-table-wrap",children:u.jsxs("table",{className:"oc-table",children:[u.jsx("thead",{className:"oc-thead",children:u.jsxs("tr",{className:"oc-tr",children:[u.jsx(Ut,{children:"Caja"}),u.jsx(Ut,{children:"Usuario"}),u.jsx(Ut,{children:"Apertura"}),u.jsx(Ut,{children:"Cierre"}),u.jsx(Ut,{align:"right",children:"Saldo final"})]})}),u.jsx("tbody",{className:"oc-tbody",children:y?u.jsx(aT,{cols:5}):I.length===0?u.jsx("tr",{className:"oc-tr",children:u.jsx("td",{className:"oc-td",colSpan:5,children:u.jsx("span",{className:"oc-muted",children:"Sin cajas cerradas."})})}):I.map(F=>u.jsxs("tr",{className:"oc-tr",children:[u.jsx("td",{className:"oc-td",children:F.nombre}),u.jsx("td",{className:"oc-td",children:F.usuarioNombre}),u.jsx("td",{className:"oc-td",children:F.fechaApertura?F.fechaApertura.toLocaleString("es-CO"):""}),u.jsx("td",{className:"oc-td",children:F.fechaCierre?F.fechaCierre.toLocaleString("es-CO"):""}),u.jsxs("td",{className:"oc-td",style:{textAlign:"right"},children:["$",Er(F.saldoActual)]})]},F.id))})]})})]}),qe=()=>u.jsxs("div",{className:"card",children:[u.jsx("h3",{children:"Cierres simulados"}),u.jsx("p",{className:"oc-muted",children:"El cierre hipottico compara ventas y movimientos detectando errores y descuadres con IA. (Conectar fuente de datos para activarlo)."})]}),rt=()=>u.jsxs("div",{className:"card",children:[u.jsx("h3",{children:"Bancos"}),u.jsx("p",{className:"oc-muted",children:"Conciliacin de consignaciones/pagos electrnicos contra caja del da. (Conectar pasarela o extractos para habilitar)."})]}),Ce=({m:F})=>u.jsxs("button",{type:"button",onClick:()=>r(F.key),className:`oc-menu-item ${n===F.key?"active":""}`,style:{width:"100%",textAlign:"left",padding:"10px 12px",borderRadius:10,border:"1px solid transparent",background:n===F.key?"var(--oc-surface-2, #f3f6ff)":"transparent",fontWeight:600},title:F.label,children:[u.jsx("span",{style:{opacity:.8,marginRight:6},children:F.icon}),F.label]});return u.jsxs("div",{className:"oc-main-content",style:{display:"grid",gridTemplateColumns:"240px 1fr",gap:16},children:[u.jsx("aside",{className:"card",role:"navigation","aria-label":"Men de caja",style:{height:"fit-content",padding:12},children:u.jsx("div",{style:{display:"flex",flexDirection:"column",gap:8},children:e.map(F=>u.jsx(Ce,{m:F},F.key))})}),u.jsxs("section",{children:[u.jsx("div",{className:"card",style:{marginBottom:12,padding:12},children:u.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",gap:12},children:[u.jsxs("div",{className:"oc-breadcrumb",children:[u.jsx("span",{children:"Caja"}),u.jsx("span",{children:""}),u.jsx("b",{children:(Ge=e.find(F=>F.key===n))==null?void 0:Ge.label})]}),n==="abiertas"&&u.jsx("input",{ref:l,className:"oc-input",placeholder:"Buscar...",value:o,onChange:F=>a(F.target.value),style:{maxWidth:300}})]})}),n==="abrir"&&u.jsx(ge,{}),n==="abiertas"&&u.jsx(de,{}),n==="cerradas"&&u.jsx(Ve,{}),n==="mio"&&u.jsx(Se,{}),n==="simulados"&&u.jsx(qe,{}),n==="bancos"&&u.jsx(rt,{})]})]})}function aT({cols:t=6,n:e=3}){return u.jsx(u.Fragment,{children:Array.from({length:e}).map((n,r)=>u.jsx("tr",{className:"oc-tr",children:Array.from({length:t}).map((s,i)=>u.jsx("td",{className:"oc-td",children:u.jsx("div",{style:{height:12,width:i===0?160:100+i%3*40,background:"var(--oc-skeleton, #e5e7eb)",borderRadius:6}})},i))},r))})}function zU({items:t=[]}){return u.jsxs("div",{className:"card activity-card",children:[u.jsx("h4",{children:"Actividad reciente"}),u.jsx("ul",{className:"activity-list",children:t.map(e=>u.jsxs("li",{children:[u.jsx("strong",{children:e.title}),u.jsx("div",{className:"time",children:e.time})]},e.id))})]})}function qU({status:t}){return t?u.jsxs("div",{className:"card",children:[u.jsx("h4",{children:"Automatizaciones (N8N)"}),u.jsxs("div",{className:"n8n-line",children:[u.jsx("strong",{children:"Conectado:"})," ",t.connected?"S":"No"]}),u.jsxs("div",{className:"n8n-line",children:[u.jsx("strong",{children:"Flujos activos:"})," ",t.flowsRunning]}),t.lastError&&u.jsxs("div",{className:"n8n-error",children:["Error: ",t.lastError]})]}):null}const ot={es:{nav_home:"Inicio",nav_agenda:"Agenda",nav_patients:"Pacientes",nav_billing:"Facturacin",nav_inventory:"Inventario",nav_odontogram:"Odontograma",nav_reports:"Reportes",nav_cash:"Caja",nav_admin:"Administracin",welcomeTitle:"Bienvenido a OdontoCloud",welcomeSubtitle:"Administra tus pacientes, agenda, inventario y facturacin de manera inteligente y moderna.",clinicLabel:"Clnica",userLabel:"Usuario",roleLabel:"Rol",searchPlaceholder:"Buscar acciones o ir a",stats_patientsToday:"Pacientes totales",stats_appointmentsToday:"Citas hoy",stats_revenueToday:"Facturacin hoy",stats_waiting:"En espera",stats_currency:"COP",n8n_title:"Automatizaciones (n8n)",recent_title:"Actividad reciente",recent_empty:"Sin actividad registrada.",loading:"Cargando...",logout:"Cerrar sesin",module_coming:"Mdulo prximamente.",todays_appts:"Citas de hoy",see_schedule:"Ir a Agenda",no_appts_today:"No hay citas programadas hoy.",at:"a las"},en:{nav_home:"Overview",nav_agenda:"Schedule",nav_patients:"Patients",nav_billing:"Billing",nav_inventory:"Inventory",nav_odontogram:"Odontogram",nav_reports:"Reports",nav_cash:"Cash",nav_admin:"Administration",welcomeTitle:"Welcome to OdontoCloud",welcomeSubtitle:"Manage your patients, schedule, inventory and billing in a smart and modern way.",clinicLabel:"Clinic",userLabel:"User",roleLabel:"Role",searchPlaceholder:"Search actions or go to",stats_patientsToday:"Total patients",stats_appointmentsToday:"Appointments today",stats_revenueToday:"Revenue today",stats_waiting:"In waiting room",stats_currency:"COP",n8n_title:"Automations (n8n)",recent_title:"Recent activity",recent_empty:"No activity yet.",loading:"Loading...",logout:"Log out",module_coming:"Module coming soon.",todays_appts:"Today's appointments",see_schedule:"Open Schedule",no_appts_today:"No appointments today.",at:"at"}},HU=()=>typeof navigator>"u"||(navigator.language||navigator.userLanguage||"es").toLowerCase().startsWith("es")?"es":"en",WU=()=>{try{const t=JSON.parse(localStorage.getItem("odc_session"));return t&&Date.now()-t.timestamp<1e3*60*60*24?t:null}catch{return null}},KU=()=>N.useMemo(()=>{const t=new Date,e=new Date(t.getFullYear(),t.getMonth(),t.getDate(),0,0,0,0),n=new Date(t.getFullYear(),t.getMonth(),t.getDate()+1,0,0,0,0);return{startToday:$e.fromDate(e),endToday:$e.fromDate(n),startTodayJS:e}},[]),GU=t=>`${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,"0")}-${String(t.getDate()).padStart(2,"0")}`,QU=(t,e)=>t.toLocaleTimeString(e==="es"?"es-CO":"en-US",{hour:"2-digit",minute:"2-digit"}),YU=(t,e)=>{try{const[n,r,s]=(t||"").split("-").map(a=>parseInt(a,10)),[i=0,o=0]=(e||"00:00").split(":").map(a=>parseInt(a,10));return new Date(n,(r||1)-1,s||1,i,o,0,0)}catch{return new Date}};function XU({data:t=[]}){const s=Math.max(1,...t.map(d=>Number(d.value)||0)),i=t.length||7,o=10,a=Math.max(16,Math.min(44,(640-o*(i+1))/i)),l=(a+o)*i+o;return u.jsx("div",{style:{width:"100%",overflowX:"auto"},children:u.jsxs("svg",{width:l,height:240,role:"img","aria-label":"Pacientes registrados por da en la ltima semana",children:[[.25,.5,.75,1].map((d,h)=>{const f=18+(1-d)*182;return u.jsx("line",{x1:0,x2:l,y1:f,y2:f,stroke:"#e5e7eb",strokeDasharray:"4 4"},h)}),t.map((d,h)=>{const f=Number(d.value)||0,m=Math.round(f/s*182),w=o+h*(a+o),A=200-m;return u.jsxs("g",{children:[u.jsx("rect",{x:w,y:A,width:a,height:m,rx:"6",ry:"6",fill:f>0?"#0ea5e9":"#cbd5e1",children:u.jsx("title",{children:`${d.label||d.shortLabel||""}  ${f} paciente${f!==1?"s":""}`})}),f>0&&m>14&&u.jsx("text",{x:w+a/2,y:A-6,textAnchor:"middle",fontSize:"11",fill:"#0f172a",children:f}),u.jsx("text",{x:w+a/2,y:214,textAnchor:"middle",fontSize:"11",fill:"#64748b",children:d.shortLabel||""})]},h)})]})})}function JU({onNavigate:t,onAction:e,placeholder:n}){const[r,s]=N.useState(""),[i,o]=N.useState(!1),[a,l]=N.useState(0),d=N.useRef(null),h=N.useMemo(()=>[{group:"Navegacin",label:"Ir a Inicio",keywords:"inicio home overview",run:()=>t==null?void 0:t("Inicio")},{group:"Navegacin",label:"Ir a Agenda",keywords:"agenda calendario schedule",run:()=>t==null?void 0:t("Agenda")},{group:"Navegacin",label:"Ir a Pacientes",keywords:"pacientes",run:()=>t==null?void 0:t("Pacientes")},{group:"Navegacin",label:"Ir a Facturacin",keywords:"facturacion facturas billing",run:()=>t==null?void 0:t("Facturacin")},{group:"Navegacin",label:"Ir a Inventario",keywords:"inventario stock",run:()=>t==null?void 0:t("Inventario")},{group:"Navegacin",label:"Ir a Odontograma",keywords:"odontograma",run:()=>t==null?void 0:t("Odontograma")},{group:"Navegacin",label:"Ir a Reportes",keywords:"reportes informes",run:()=>t==null?void 0:t("Reportes")},{group:"Acciones",label:"Nueva cita",keywords:"nueva cita agendar",run:()=>e==null?void 0:e("new_appointment")},{group:"Acciones",label:"Nuevo paciente",keywords:"nuevo paciente alta",run:()=>e==null?void 0:e("new_patient")},{group:"Acciones",label:"Nueva factura",keywords:"nueva factura",run:()=>e==null?void 0:e("new_invoice")},{group:"Acciones",label:"Exportar agenda",keywords:"exportar agenda",run:()=>e==null?void 0:e("export_agenda")},{group:"Acciones",label:"Ir a hoy (Agenda)",keywords:"hoy today",run:()=>e==null?void 0:e("agenda_today")},{group:"Acciones",label:"Cambiar modo oscuro",keywords:"oscuro dark mode",run:()=>e==null?void 0:e("toggle_dark")},{group:"Acciones",label:"Cerrar sesin",keywords:"logout salir cerrar",run:()=>e==null?void 0:e("logout")},{group:"Ayuda",label:"Ver atajos de teclado",keywords:"atajos ayuda",run:()=>e==null?void 0:e("show_shortcuts")},{group:"Ayuda",label:"Soporte / Contacto",keywords:"soporte ayuda contacto",run:()=>e==null?void 0:e("support")}],[t,e]),f=N.useMemo(()=>{const b=r.toLowerCase().trim();return b?h.filter(P=>P.label.toLowerCase().includes(b)||P.keywords.includes(b)):[]},[r,h]);N.useEffect(()=>{const b=P=>{d.current&&(d.current.contains(P.target)||o(!1))};return document.addEventListener("mousedown",b),()=>document.removeEventListener("mousedown",b)},[]);const m=b=>{var P;(P=b.run)==null||P.call(b),s(""),o(!1)},w=b=>{!i||f.length===0||(b.key==="ArrowDown"&&(b.preventDefault(),l(P=>(P+1)%f.length)),b.key==="ArrowUp"&&(b.preventDefault(),l(P=>(P-1+f.length)%f.length)),b.key==="Enter"&&(b.preventDefault(),f[a]&&m(f[a])),b.key==="Escape"&&o(!1))},A=N.useMemo(()=>{const b=new Map;return f.forEach(P=>{b.has(P.group)||b.set(P.group,[]),b.get(P.group).push(P)}),Array.from(b.entries())},[f]);return u.jsxs("div",{className:"oc-search-wrap",ref:d,children:[u.jsx("input",{className:"oc-search",type:"search",inputMode:"search",placeholder:n,"aria-label":n,value:r,onChange:b=>{s(b.target.value),o(!!b.target.value),l(0)},onFocus:()=>o(!!r),onKeyDown:w}),i&&u.jsx("div",{className:"oc-search-dropdown",role:"listbox","aria-label":"Resultados de comandos",children:A.length===0?u.jsx("div",{className:"oc-search-item empty",children:"Escribe para ver opciones"}):A.map(([b,P])=>u.jsxs("div",{children:[u.jsx("div",{className:"oc-search-group",children:b}),P.map(I=>{const E=f.indexOf(I);return u.jsx("button",{className:`oc-search-item ${E===a?"active":""}`,onMouseEnter:()=>l(E),onClick:()=>m(I),role:"option",children:u.jsx("span",{className:"oc-search-title",children:I.label})},I.label)})]},b))})]})}function ZU({open:t,anchorRect:e,onClose:n,onGo:r,onSoon:s,onFact:i,dark:o}){const[a,l]=N.useState(null),d=N.useRef(null);if(N.useEffect(()=>{if(!t)return;const K=Mt=>Mt.key==="Escape"&&(n==null?void 0:n()),Ze=()=>n==null?void 0:n();return window.addEventListener("keydown",K),window.addEventListener("scroll",Ze,!0),()=>{window.removeEventListener("keydown",K),window.removeEventListener("scroll",Ze,!0)}},[t,n]),!t)return null;const h=((e==null?void 0:e.bottom)||60)+8,f=Math.max(12,Math.min(((e==null?void 0:e.left)||300)-160,window.innerWidth-920)),m=10,w=f+360+m,A=o?"#0b1220":"#ffffff",b=o?"#e5e7eb":"#0f172a",P=o?"#0f1a32":"#f3f6ff",I=o?"#1f2a44":"#e2e8f0",E=o?"#b6c1d1":"#475569",y={position:"fixed",top:h,left:f,width:880,maxWidth:"calc(100vw - 24px)",background:A,color:b,borderRadius:14,boxShadow:"0 18px 40px rgba(2,6,23,.18)",border:`1px solid ${I}`,zIndex:400,padding:12},j={position:"fixed",top:h,left:w,width:420,maxWidth:"calc(100vw - 24px)",background:A,color:b,borderRadius:14,boxShadow:"0 18px 40px rgba(2,6,23,.18)",border:`1px solid ${I}`,zIndex:410,padding:12},V={display:"flex",flexDirection:"column",gap:6,padding:"8px 10px"},M={height:38,borderRadius:10,padding:"0 12px",display:"flex",alignItems:"center",gap:8,fontSize:".92rem",cursor:"pointer",border:"1px solid transparent",background:"transparent",color:b,fontWeight:500,textAlign:"left"},T=(K,Ze=!0)=>Object.assign(K.currentTarget.style,Ze?{background:P,borderColor:I}:{background:"transparent",borderColor:"transparent"}),_=()=>{d.current&&clearTimeout(d.current)},S=()=>{_(),d.current=setTimeout(()=>n==null?void 0:n(),180)},C={position:"fixed",top:h,left:f+360,width:m,height:520,zIndex:405},k=[{label:"Recibo de caja",key:"recibo"},{label:"Saldo a favor",key:"saldo"},{label:"Nota crdito",key:"nc"},{label:"Nota dbito",key:"nd"},{label:"Liquidaciones",key:"liq"},{label:"Traslados",key:"tras"},{label:"Pagos",key:"pagos"},{label:"rdenes de compra",key:"oc"},{label:"Factura de venta",key:"fv"},{label:"Facturas de compra",key:"fc"}],D=[{label:"RIPS anteriores (RS-3374)",key:"rips3374"},{label:"RIPS nuevo (RS-2275)",key:"rips2275"}],R=K=>{i==null||i(K),r==null||r("Facturacin")};return u.jsxs(u.Fragment,{children:[u.jsx("div",{onClick:n,style:{position:"fixed",inset:0,background:"transparent",zIndex:399}}),u.jsx("div",{style:y,onMouseEnter:_,onMouseLeave:S,children:u.jsxs("div",{style:{display:"grid",gridTemplateColumns:"360px 1fr",gap:8,alignItems:"start"},children:[u.jsxs("div",{style:V,children:[u.jsx("button",{type:"button",style:M,onMouseEnter:()=>{_(),l("facturacion")},onFocus:()=>{_(),l("facturacion")},onClick:()=>l(K=>K==="facturacion"?null:"facturacion"),onMouseOver:K=>T(K,!0),onMouseOut:K=>T(K,!1),children:" Facturacin "}),u.jsx("button",{type:"button",style:M,onMouseEnter:()=>{_(),l("rips")},onFocus:()=>{_(),l("rips")},onClick:()=>l(K=>K==="rips"?null:"rips"),onMouseOver:K=>T(K,!0),onMouseOut:K=>T(K,!1),children:" RIPS "}),u.jsx("button",{type:"button",style:M,onClick:()=>s==null?void 0:s(),onMouseOver:K=>T(K,!0),onMouseOut:K=>T(K,!1),children:" Convenios"}),u.jsx("button",{type:"button",style:M,onClick:()=>r==null?void 0:r("Agenda"),onMouseOver:K=>T(K,!0),onMouseOut:K=>T(K,!1),children:" Gestin de agenda"}),u.jsx("button",{type:"button",style:M,onClick:()=>s==null?void 0:s(),onMouseOver:K=>T(K,!0),onMouseOut:K=>T(K,!1),children:" Terceros"}),u.jsx("button",{type:"button",style:M,onClick:()=>s==null?void 0:s(),onMouseOver:K=>T(K,!0),onMouseOut:K=>T(K,!1),children:" Campaas"}),u.jsx("button",{type:"button",style:M,onClick:()=>s==null?void 0:s(),onMouseOver:K=>T(K,!0),onMouseOut:K=>T(K,!1),children:" Temperatura y humedad"}),u.jsx("button",{type:"button",style:M,onClick:()=>s==null?void 0:s(),onMouseOver:K=>T(K,!0),onMouseOut:K=>T(K,!1),children:" Residuos"}),u.jsx("button",{type:"button",style:M,onClick:()=>r==null?void 0:r("Inventario"),onMouseOver:K=>T(K,!0),onMouseOut:K=>T(K,!1),children:" Inventario"}),u.jsx("button",{type:"button",style:M,onClick:()=>s==null?void 0:s(),onMouseOver:K=>T(K,!0),onMouseOut:K=>T(K,!1),children:" Medicamentos y planes"}),u.jsx("button",{type:"button",style:M,onClick:()=>s==null?void 0:s(),onMouseOver:K=>T(K,!0),onMouseOut:K=>T(K,!1),children:" Esterilizacin"})]}),u.jsx("div",{style:V,children:u.jsxs("div",{style:{fontSize:".85rem",color:E},children:["Accesos rpidos a mdulos de administracin. Pasa el mouse por ",u.jsx("b",{children:"Facturacin"})," o ",u.jsx("b",{children:"RIPS"})," para ver sus acciones."]})})]})}),u.jsx("div",{style:C,onMouseEnter:_,onMouseLeave:S}),a&&u.jsx("div",{style:j,onMouseEnter:_,onMouseLeave:S,children:u.jsx("div",{style:{...V,display:"grid",gridTemplateColumns:"1fr"},children:(a==="facturacion"?k:D).map(K=>u.jsx("button",{type:"button",style:M,onClick:()=>a==="facturacion"?R(K.key):s==null?void 0:s(),onMouseOver:Ze=>T(Ze,!0),onMouseOut:Ze=>T(Ze,!1),children:K.label},K.label))})})]})}function Rp(){const[t]=N.useState(HU()),e=re=>ot[t][re]||re,[n,r]=N.useState("Inicio"),[s,i]=N.useState("recibo"),[o,a]=N.useState(()=>{try{return localStorage.getItem("odontocloud:dark")==="1"}catch{return!1}});N.useEffect(()=>{try{localStorage.setItem("odontocloud:dark",o?"1":"0")}catch{}document.documentElement.classList.toggle("dark",o)},[o]);const[l]=N.useState(()=>WU()),[d]=N.useState((l==null?void 0:l.rol)||""),[h]=N.useState((l==null?void 0:l.email)||""),[f,m]=N.useState("OdontoCloud"),[w,A]=N.useState(h||"Usuario"),[b,P]=N.useState(!0);N.useEffect(()=>{const re=vy(lh,async se=>{try{if(!se){A(h||"Usuario"),m("OdontoCloud"),P(!1);return}A(se.displayName||se.email||h||"Usuario");const ue=Gt(_e,"empresas",se.uid),G=await sh(ue);m(G.exists()&&G.data().nombre||"OdontoCloud")}catch(ue){console.error("Error cargando empresa/usuario:",ue)}finally{P(!1)}});return()=>re()},[h]);const[I,E]=N.useState({pacientesHoy:0,citasHoy:0,facturacionHoy:0,enEspera:0}),[y,j]=N.useState(!0),[V,M]=N.useState([]),[T,_]=N.useState([]),[S,C]=N.useState(!0),{startToday:k,endToday:D,startTodayJS:R}=KU(),K=N.useMemo(()=>GU(R),[R]),Ze=N.useMemo(()=>{const re=new Date,se=new Date(re.getFullYear(),re.getMonth(),re.getDate()-6),ue=re,G=ee=>ee.toLocaleDateString(t==="es"?"es-ES":"en-US",{weekday:"short",day:"2-digit",month:"short"}).replace(".","");return`${G(se)}  ${G(ue)}`},[t]),Mt=re=>{var ge;const se=re.data()||{};let ue;if((ge=se.fecha)!=null&&ge.toDate){ue=se.fecha.toDate();const de=se.horaInicio||se.hora;if(de&&typeof de=="string"){const[Se=0,Ve=0]=de.split(":").map(qe=>parseInt(qe,10));ue.setHours(Se||0,Ve||0,0,0)}}else if(typeof se.fecha=="string"){const de=se.horaInicio||se.hora||"00:00";ue=YU(se.fecha,de)}else ue=new Date;const G=se.pacienteNombre||se.paciente||"Paciente",ee=se.estado&&String(se.estado)||"programada";return{id:re.id,fecha:ue,pacienteId:se.pacienteId||"",pacienteNombre:G,estado:ee,motivo:se.motivo||""}};N.useEffect(()=>{const re=nt(Ue(_e,"citas"),Qe("fecha",">=",k),Qe("fecha","<",D),Qt("fecha","asc")),se=nt(Ue(_e,"citas"),Qe("fecha","==",K));let ue=new Map,G=!1,ee=!1;const ge=()=>{const de=Array.from(ue.values()).sort((Ve,qe)=>Ve.fecha.getTime()-qe.fecha.getTime()),Se=de.filter(Ve=>String(Ve.estado).toLowerCase().trim()==="en espera").length;_(de),E(Ve=>({...Ve,citasHoy:de.length,enEspera:Se})),G&&ee&&C(!1)};sr(re,de=>{G=!0;const Se=new Map(ue);de.docs.forEach(Ve=>Se.set(Ve.id,Mt(Ve))),ue=Se,ge()},de=>{console.error("Realtime citas hoy (TS):",de),G=!0,ge()}),sr(se,de=>{ee=!0;const Se=new Map(ue);de.docs.forEach(Ve=>Se.set(Ve.id,Mt(Ve))),ue=Se,ge()},de=>{console.error("Realtime citas hoy (STR):",de),ee=!0,ge()})},[k,D,K]),N.useEffect(()=>{(async()=>{try{const ue=(await kM(Ue(_e,"pacientes"))).data().count||0;let G=0;try{const ee=nt(Ue(_e,"facturas"),Qe("fecha",">=",k),Qe("fecha","<",D));(await Kt(ee)).forEach(de=>{const Se=de.data();typeof Se.monto=="number"&&(G+=Se.monto)})}catch{G=0}E(ee=>({...ee,pacientesHoy:ue,facturacionHoy:G}))}catch(se){console.error("Error cargando mtricas:",se),E(ue=>({...ue,pacientesHoy:0,facturacionHoy:0}))}finally{j(!1)}})()},[k,D]),N.useEffect(()=>{const re=new Date,se=new Date(re.getFullYear(),re.getMonth(),re.getDate()-6),ue=new Date(re.getFullYear(),re.getMonth(),re.getDate()+1),G=new Map;for(let de=0;de<7;de++){const Se=new Date(re.getFullYear(),re.getMonth(),re.getDate()-(6-de)),Ve=Se.toISOString().slice(0,10),qe=Se.toLocaleDateString(t==="es"?"es-ES":"en-US"),rt=Se.toLocaleDateString(t==="es"?"es-ES":"en-US",{weekday:"short",day:"2-digit"}).replace(".","");G.set(Ve,{label:qe,shortLabel:rt,value:0})}const ee=nt(Ue(_e,"pacientes"),Qe("createdAt",">=",$e.fromDate(se)),Qe("createdAt","<",$e.fromDate(ue))),ge=sr(ee,de=>{const Se=new Map(G);de.docs.forEach(Ve=>{var F;const qe=Ve.data()||{},rt=(F=Ve.data().createdAt)!=null&&F.toDate?Ve.data().createdAt.toDate():qe.createdAt?new Date(qe.createdAt):null;if(!rt||isNaN(rt))return;const Ce=rt.toISOString().slice(0,10);if(!Se.has(Ce))return;const Ge=Se.get(Ce);Ge.value+=1,Se.set(Ce,Ge)}),M(Array.from(Se.values()))},de=>{console.error("Error realtime serie semanal (pacientes):",de),M(Array.from(G.values()))});return()=>{try{ge()}catch{}}},[t]);const[he,Y]=N.useState([]),[ce,me]=N.useState(!0);N.useEffect(()=>{(async()=>{try{const se=nt(Ue(_e,"actividad"),Qt("fecha","desc"),Zo(5)),ue=await Kt(se);Y(ue.docs.map(G=>({id:G.id,title:G.data().descripcion||G.data().titulo||"Actividad",time:G.data().resumenTiempo||""})))}catch(se){console.error("Error cargando actividad:",se),Y([])}finally{me(!1)}})()},[]);const[Oe,He]=N.useState(null),[z,Z]=N.useState(!0);N.useEffect(()=>{(async()=>{try{const se=Gt(_e,"integraciones","n8n"),ue=await sh(se);He(ue.exists()?{connected:!!ue.data().connected,flowsRunning:ue.data().flowsRunning||0,lastError:ue.data().lastError||null}:{connected:!1,flowsRunning:0,lastError:null})}catch(se){console.error("Error cargando estado n8n:",se),He({connected:!1,flowsRunning:0,lastError:"No se pudo leer el estado desde Firebase."})}finally{Z(!1)}})()},[]);const ae=async()=>{try{localStorage.removeItem("odc_session")}catch{}try{await Mj(lh)}catch(re){console.error("Error al cerrar sesin:",re)}window.location.href="/"},[we,Ie]=N.useState(!1),[Me,fe]=N.useState(null),et=N.useRef(null),Te=N.useRef(null),ne=()=>{var se,ue;const re=(ue=(se=et.current)==null?void 0:se.getBoundingClientRect)==null?void 0:ue.call(se);fe(re),Ie(!0)},Re=()=>{Ie(!1),Te.current&&(clearTimeout(Te.current),Te.current=null)},bt=()=>{Te.current&&(clearTimeout(Te.current),Te.current=null)},Nt=()=>{switch(n){case"Agenda":return u.jsx(xU,{});case"Pacientes":return u.jsx(jU,{});case"Facturacin":return u.jsx(SU,{view:s});case"Inventario":return u.jsx(bU,{});case"Odontograma":return u.jsx(CU,{});case"Reportes":return u.jsx(LU,{});case"Caja":return u.jsx(BU,{});case"Inicio":default:return null}};return u.jsxs("div",{className:`oc-shell ${o?"oc-dark":""}`,children:[u.jsx("a",{href:"#oc-main",className:"oc-skip-link",children:"Saltar al contenido"}),u.jsxs("header",{className:"oc-header",role:"banner",children:[u.jsxs("div",{className:"oc-header-left",children:[u.jsx("img",{src:mA,alt:"OdontoCloud",className:"oc-logo"}),u.jsxs("div",{className:"oc-brand-text",children:[u.jsx("span",{className:"oc-brand-main",children:"OdontoCloud"}),u.jsx("span",{className:"oc-brand-sub",children:b?"...":f})]})]}),u.jsxs("nav",{className:"oc-nav",role:"navigation","aria-label":"Navegacin principal",children:[u.jsx("button",{type:"button",className:n==="Inicio"?"oc-nav-btn active":"oc-nav-btn","aria-current":n==="Inicio"?"page":void 0,onClick:()=>r("Inicio"),title:e("nav_home"),children:e("nav_home")}),u.jsx("button",{type:"button",className:n==="Agenda"?"oc-nav-btn active":"oc-nav-btn","aria-current":n==="Agenda"?"page":void 0,onClick:()=>r("Agenda"),title:e("nav_agenda"),children:e("nav_agenda")}),u.jsx("button",{type:"button",className:n==="Pacientes"?"oc-nav-btn active":"oc-nav-btn","aria-current":n==="Pacientes"?"page":void 0,onClick:()=>r("Pacientes"),title:e("nav_patients"),children:e("nav_patients")}),u.jsx("button",{type:"button",className:n==="Caja"?"oc-nav-btn active":"oc-nav-btn",onClick:()=>r("Caja"),title:e("nav_cash"),children:e("nav_cash")}),u.jsx("button",{type:"button",ref:et,className:"oc-nav-btn",title:e("nav_admin"),"aria-haspopup":"true","aria-expanded":we,onClick:()=>we?Re():ne(),onMouseEnter:()=>{bt(),ne()},onFocus:()=>{bt(),ne()},children:e("nav_admin")}),u.jsx("button",{type:"button",className:n==="Reportes"?"oc-nav-btn active":"oc-nav-btn","aria-current":n==="Reportes"?"page":void 0,onClick:()=>r("Reportes"),title:e("nav_reports"),children:e("nav_reports")})]}),u.jsxs("div",{className:"oc-header-right",children:[u.jsx(JU,{placeholder:e("searchPlaceholder"),onNavigate:re=>r(re),onAction:re=>{switch(re){case"new_appointment":r("Agenda");break;case"new_patient":r("Pacientes");break;case"new_invoice":r("Facturacin"),i("fv");break;case"export_agenda":r("Agenda");break;case"agenda_today":r("Agenda");break;case"toggle_dark":a(se=>!se);break;case"logout":ae();break;case"show_shortcuts":alert("Atajos: Ctrl/Cmd + K para abrir bsqueda, / para moverse, Enter para ejecutar.");break;case"support":window.open("https://tu-soporte.odc","_blank");break}}}),u.jsx("button",{className:"oc-icon-btn",type:"button",onClick:()=>a(re=>!re),"aria-pressed":o,title:o?"Activar modo claro":"Activar modo oscuro",children:o?"":""}),u.jsx("button",{className:"oc-icon-btn",type:"button",onClick:ae,title:ot[t].logout,children:ot[t].logout})]})]}),u.jsx(ZU,{open:we,anchorRect:Me,dark:o,onClose:Re,onGo:re=>{r(re),Re()},onSoon:()=>{alert("Prximamente"),Re()},onFact:re=>{i(re)}}),u.jsxs("main",{id:"oc-main",className:"oc-main-wrapper",role:"main",children:[n!=="Inicio"&&Nt(),n==="Inicio"&&u.jsxs("div",{className:"oc-main-content",children:[u.jsxs("section",{className:"oc-hero","aria-label":"Resumen general",children:[u.jsxs("div",{className:"oc-hero-text",children:[u.jsx("h1",{children:ot[t].welcomeTitle}),u.jsx("p",{children:ot[t].welcomeSubtitle}),u.jsxs("p",{className:"oc-hero-meta",children:[ot[t].clinicLabel,": ",f,"  ",ot[t].userLabel,":"," ",w,"  ",ot[t].roleLabel,": ",d||""]})]}),u.jsxs("div",{className:"oc-hero-badge","aria-live":"polite",children:[u.jsx("span",{className:"oc-hero-badge-title",children:ot[t].stats_appointmentsToday}),u.jsx("span",{className:"oc-hero-badge-value",children:y&&S?"":I.citasHoy}),u.jsxs("span",{className:"oc-hero-badge-sub",children:[ot[t].stats_patientsToday,": ",y?"":I.pacientesHoy]})]})]}),u.jsxs("section",{className:"oc-stats-row","aria-label":"Indicadores del da",children:[u.jsxs("div",{className:"stat-card",children:[u.jsx("span",{className:"stat-label",children:ot[t].stats_patientsToday}),u.jsx("span",{className:"stat-value",children:I.pacientesHoy})]}),u.jsxs("div",{className:"stat-card",children:[u.jsx("span",{className:"stat-label",children:ot[t].stats_appointmentsToday}),u.jsx("span",{className:"stat-value",children:I.citasHoy})]}),u.jsxs("div",{className:"stat-card",children:[u.jsx("span",{className:"stat-label",children:ot[t].stats_revenueToday}),u.jsxs("span",{className:"stat-value",children:[I.facturacionHoy.toLocaleString("es-CO")," ",u.jsx("span",{className:"stat-currency",children:ot[t].stats_currency})]})]}),u.jsxs("div",{className:"stat-card",children:[u.jsx("span",{className:"stat-label",children:ot[t].stats_waiting}),u.jsx("span",{className:"stat-value",children:I.enEspera})]})]}),u.jsxs("section",{className:"oc-grid","aria-label":"Contenido principal del dashboard",children:[u.jsx("div",{className:"oc-grid-main",children:u.jsxs("div",{className:"card card-quickcharts",children:[u.jsxs("div",{className:"oc-card-head",style:{display:"flex",justifyContent:"space-between",alignItems:"center",gap:8},children:[u.jsx("h3",{children:"Pacientes registrados  ltimos 7 das"}),u.jsx("span",{className:"oc-muted",style:{marginLeft:8,fontSize:12},children:Ze})]}),V.length===0||V.every(re=>((re==null?void 0:re.value)||0)===0)?u.jsx("p",{className:"oc-weekly-empty",children:"Sin pacientes registrados en la ltima semana."}):u.jsx(XU,{data:V})]})}),u.jsxs("aside",{className:"oc-grid-side","aria-label":"Panel lateral",children:[u.jsxs("div",{className:"card",children:[u.jsx("h3",{children:ot[t].n8n_title}),z?u.jsx("span",{className:"oc-muted",children:ot[t].loading}):u.jsx(qU,{status:Oe})]}),u.jsxs("div",{className:"card",children:[u.jsxs("div",{className:"oc-card-head",style:{display:"flex",justifyContent:"space-between",alignItems:"center",gap:8},children:[u.jsx("h3",{children:ot[t].todays_appts}),u.jsx("button",{className:"oc-small-link",type:"button",onClick:()=>r("Agenda"),children:ot[t].see_schedule})]}),S?u.jsx("span",{className:"oc-muted",children:ot[t].loading}):T.length===0?u.jsx("p",{className:"oc-muted",children:ot[t].no_appts_today}):u.jsx("ul",{className:"oc-list",children:T.slice(0,5).map(re=>u.jsxs("li",{className:"oc-list-item",children:[u.jsxs("div",{className:"oc-list-main",children:[u.jsx("b",{children:re.pacienteNombre||"Paciente"})," ",u.jsxs("span",{className:"oc-muted",children:[ot[t].at," ",QU(re.fecha,t)]})]}),u.jsx("div",{className:`oc-tag oc-tag-${(re.estado||"programada").toLowerCase().replace(/\s+/g,"-")}`,children:re.estado||"programada"})]},re.id))})]}),u.jsxs("div",{className:"card",children:[u.jsx("h3",{children:ot[t].recent_title}),ce?u.jsx("span",{className:"oc-muted",children:ot[t].loading}):he.length===0?u.jsx("p",{className:"oc-muted",children:ot[t].recent_empty}):u.jsx(zU,{items:he})]})]})]}),u.jsxs("footer",{className:"oc-footer",children:[" ",new Date().getFullYear()," OdontoCloud | Creado por Ingeniero Juan Madrid"]})]})]})]})}const LA=()=>{try{const t=JSON.parse(localStorage.getItem("odc_session"));return t&&Date.now()-t.timestamp<1e3*60*60*24?t:null}catch{return null}},MA=t=>{const e=(t||"").toLowerCase();return e==="administrador"?"/dashboard_admin":e==="doctor"?"/dashboard_doctor":e==="recepcionista"?"/dashboard_recepcion":"/"};function Pp({allowedRoles:t,children:e}){var s;const n=LA();if(!n)return u.jsx(Nd,{to:"/",replace:!0});const r=(s=n.rol)==null?void 0:s.toLowerCase();return t.map(i=>i.toLowerCase()).includes(r)?e:u.jsx(Nd,{to:MA(n.rol),replace:!0})}function e6(){const t=LA();return u.jsxs(TN,{children:[u.jsx(xo,{path:"/",element:t?u.jsx(Nd,{to:MA(t.rol),replace:!0}):u.jsx(e4,{})}),u.jsx(xo,{path:"/dashboard_admin/*",element:u.jsx(Pp,{allowedRoles:["administrador"],children:u.jsx(Rp,{})})}),u.jsx(xo,{path:"/dashboard_doctor/*",element:u.jsx(Pp,{allowedRoles:["doctor"],children:u.jsx(Rp,{})})}),u.jsx(xo,{path:"/dashboard_recepcion/*",element:u.jsx(Pp,{allowedRoles:["recepcionista"],children:u.jsx(Rp,{})})}),u.jsx(xo,{path:"*",element:u.jsx(Nd,{to:"/",replace:!0})})]})}async function t6(){try{await Oj(lh,PS),await gM(_e),console.log(" Firebase listo con sesin persistente y modo offline.")}catch(t){console.warn(" Firebase offline/persistencia fall:",t.message)}}const n6="modulepreload",r6=function(t){return"/odontocloud-react/"+t},lT={},s6=function(e,n,r){let s=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),a=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));s=Promise.allSettled(n.map(l=>{if(l=r6(l),l in lT)return;lT[l]=!0;const d=l.endsWith(".css"),h=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${h}`))return;const f=document.createElement("link");if(f.rel=d?"stylesheet":n6,d||(f.as="script"),f.crossOrigin="",f.href=l,a&&f.setAttribute("nonce",a),document.head.appendChild(f),d)return new Promise((m,w)=>{f.addEventListener("load",m),f.addEventListener("error",()=>w(new Error(`Unable to preload CSS for ${l}`)))})}))}function i(o){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=o,window.dispatchEvent(a),!a.defaultPrevented)throw o}return s.then(o=>{for(const a of o||[])a.status==="rejected"&&i(a.reason);return e().catch(i)})};function i6(t={}){const{immediate:e=!1,onNeedRefresh:n,onOfflineReady:r,onRegistered:s,onRegisteredSW:i,onRegisterError:o}=t;let a,l;const d=async(f=!0)=>{await l};async function h(){if("serviceWorker"in navigator){if(a=await s6(async()=>{const{Workbox:f}=await import("./workbox-window.prod.es5-vqzQaGvo.js");return{Workbox:f}},[]).then(({Workbox:f})=>new f("/odontocloud-react/sw.js",{scope:"/odontocloud-react/",type:"classic"})).catch(f=>{o==null||o(f)}),!a)return;a.addEventListener("activated",f=>{(f.isUpdate||f.isExternal)&&window.location.reload()}),a.addEventListener("installed",f=>{f.isUpdate||r==null||r()}),a.register({immediate:e}).then(f=>{i?i("/odontocloud-react/sw.js",f):s==null||s(f)}).catch(f=>{o==null||o(f)})}}return l=h(),d}const o6="/odontocloud-react/";t6();i6({immediate:!0});xx(document.getElementById("root")).render(u.jsx(ET.StrictMode,{children:u.jsx(WN,{basename:o6,children:u.jsx(e6,{})})}));
