(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();function cR(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var mT={exports:{}},hh={},gT={exports:{}},De={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ic=Symbol.for("react.element"),uR=Symbol.for("react.portal"),dR=Symbol.for("react.fragment"),hR=Symbol.for("react.strict_mode"),fR=Symbol.for("react.profiler"),pR=Symbol.for("react.provider"),mR=Symbol.for("react.context"),gR=Symbol.for("react.forward_ref"),yR=Symbol.for("react.suspense"),_R=Symbol.for("react.memo"),vR=Symbol.for("react.lazy"),Ev=Symbol.iterator;function wR(t){return t===null||typeof t!="object"?null:(t=Ev&&t[Ev]||t["@@iterator"],typeof t=="function"?t:null)}var yT={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},_T=Object.assign,vT={};function Ta(t,e,n){this.props=t,this.context=e,this.refs=vT,this.updater=n||yT}Ta.prototype.isReactComponent={};Ta.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Ta.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function wT(){}wT.prototype=Ta.prototype;function ug(t,e,n){this.props=t,this.context=e,this.refs=vT,this.updater=n||yT}var dg=ug.prototype=new wT;dg.constructor=ug;_T(dg,Ta.prototype);dg.isPureReactComponent=!0;var Iv=Array.isArray,ET=Object.prototype.hasOwnProperty,hg={current:null},IT={key:!0,ref:!0,__self:!0,__source:!0};function TT(t,e,n){var r,s={},i=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(i=""+e.key),e)ET.call(e,r)&&!IT.hasOwnProperty(r)&&(s[r]=e[r]);var a=arguments.length-2;if(a===1)s.children=n;else if(1<a){for(var l=Array(a),d=0;d<a;d++)l[d]=arguments[d+2];s.children=l}if(t&&t.defaultProps)for(r in a=t.defaultProps,a)s[r]===void 0&&(s[r]=a[r]);return{$$typeof:Ic,type:t,key:i,ref:o,props:s,_owner:hg.current}}function ER(t,e){return{$$typeof:Ic,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function fg(t){return typeof t=="object"&&t!==null&&t.$$typeof===Ic}function IR(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var Tv=/\/+/g;function kf(t,e){return typeof t=="object"&&t!==null&&t.key!=null?IR(""+t.key):e.toString(36)}function ju(t,e,n,r,s){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case Ic:case uR:o=!0}}if(o)return o=t,s=s(o),t=r===""?"."+kf(o,0):r,Iv(s)?(n="",t!=null&&(n=t.replace(Tv,"$&/")+"/"),ju(s,e,n,"",function(d){return d})):s!=null&&(fg(s)&&(s=ER(s,n+(!s.key||o&&o.key===s.key?"":(""+s.key).replace(Tv,"$&/")+"/")+t)),e.push(s)),1;if(o=0,r=r===""?".":r+":",Iv(t))for(var a=0;a<t.length;a++){i=t[a];var l=r+kf(i,a);o+=ju(i,e,n,l,s)}else if(l=wR(t),typeof l=="function")for(t=l.call(t),a=0;!(i=t.next()).done;)i=i.value,l=r+kf(i,a++),o+=ju(i,e,n,l,s);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function ru(t,e,n){if(t==null)return t;var r=[],s=0;return ju(t,r,"","",function(i){return e.call(n,i,s++)}),r}function TR(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var vn={current:null},Ou={transition:null},xR={ReactCurrentDispatcher:vn,ReactCurrentBatchConfig:Ou,ReactCurrentOwner:hg};function xT(){throw Error("act(...) is not supported in production builds of React.")}De.Children={map:ru,forEach:function(t,e,n){ru(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return ru(t,function(){e++}),e},toArray:function(t){return ru(t,function(e){return e})||[]},only:function(t){if(!fg(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};De.Component=Ta;De.Fragment=dR;De.Profiler=fR;De.PureComponent=ug;De.StrictMode=hR;De.Suspense=yR;De.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=xR;De.act=xT;De.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=_T({},t.props),s=t.key,i=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,o=hg.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(l in e)ET.call(e,l)&&!IT.hasOwnProperty(l)&&(r[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)r.children=n;else if(1<l){a=Array(l);for(var d=0;d<l;d++)a[d]=arguments[d+2];r.children=a}return{$$typeof:Ic,type:t.type,key:s,ref:i,props:r,_owner:o}};De.createContext=function(t){return t={$$typeof:mR,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:pR,_context:t},t.Consumer=t};De.createElement=TT;De.createFactory=function(t){var e=TT.bind(null,t);return e.type=t,e};De.createRef=function(){return{current:null}};De.forwardRef=function(t){return{$$typeof:gR,render:t}};De.isValidElement=fg;De.lazy=function(t){return{$$typeof:vR,_payload:{_status:-1,_result:t},_init:TR}};De.memo=function(t,e){return{$$typeof:_R,type:t,compare:e===void 0?null:e}};De.startTransition=function(t){var e=Ou.transition;Ou.transition={};try{t()}finally{Ou.transition=e}};De.unstable_act=xT;De.useCallback=function(t,e){return vn.current.useCallback(t,e)};De.useContext=function(t){return vn.current.useContext(t)};De.useDebugValue=function(){};De.useDeferredValue=function(t){return vn.current.useDeferredValue(t)};De.useEffect=function(t,e){return vn.current.useEffect(t,e)};De.useId=function(){return vn.current.useId()};De.useImperativeHandle=function(t,e,n){return vn.current.useImperativeHandle(t,e,n)};De.useInsertionEffect=function(t,e){return vn.current.useInsertionEffect(t,e)};De.useLayoutEffect=function(t,e){return vn.current.useLayoutEffect(t,e)};De.useMemo=function(t,e){return vn.current.useMemo(t,e)};De.useReducer=function(t,e,n){return vn.current.useReducer(t,e,n)};De.useRef=function(t){return vn.current.useRef(t)};De.useState=function(t){return vn.current.useState(t)};De.useSyncExternalStore=function(t,e,n){return vn.current.useSyncExternalStore(t,e,n)};De.useTransition=function(){return vn.current.useTransition()};De.version="18.3.1";gT.exports=De;var N=gT.exports;const ST=cR(N);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var SR=N,bR=Symbol.for("react.element"),CR=Symbol.for("react.fragment"),AR=Object.prototype.hasOwnProperty,RR=SR.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,PR={key:!0,ref:!0,__self:!0,__source:!0};function bT(t,e,n){var r,s={},i=null,o=null;n!==void 0&&(i=""+n),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)AR.call(e,r)&&!PR.hasOwnProperty(r)&&(s[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)s[r]===void 0&&(s[r]=e[r]);return{$$typeof:bR,type:t,key:i,ref:o,props:s,_owner:RR.current}}hh.Fragment=CR;hh.jsx=bT;hh.jsxs=bT;mT.exports=hh;var u=mT.exports,CT={exports:{}},Fn={},AT={exports:{}},RT={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(J,de){var G=J.length;J.push(de);e:for(;0<G;){var je=G-1>>>1,Ke=J[je];if(0<s(Ke,de))J[je]=de,J[G]=Ke,G=je;else break e}}function n(J){return J.length===0?null:J[0]}function r(J){if(J.length===0)return null;var de=J[0],G=J.pop();if(G!==de){J[0]=G;e:for(var je=0,Ke=J.length,z=Ke>>>1;je<z;){var ne=2*(je+1)-1,he=J[ne],Ie=ne+1,xe=J[Ie];if(0>s(he,G))Ie<Ke&&0>s(xe,he)?(J[je]=xe,J[Ie]=G,je=Ie):(J[je]=he,J[ne]=G,je=ne);else if(Ie<Ke&&0>s(xe,G))J[je]=xe,J[Ie]=G,je=Ie;else break e}}return de}function s(J,de){var G=J.sortIndex-de.sortIndex;return G!==0?G:J.id-de.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var l=[],d=[],h=1,f=null,m=3,v=!1,R=!1,b=!1,A=typeof setTimeout=="function"?setTimeout:null,I=typeof clearTimeout=="function"?clearTimeout:null,w=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function y(J){for(var de=n(d);de!==null;){if(de.callback===null)r(d);else if(de.startTime<=J)r(d),de.sortIndex=de.expirationTime,e(l,de);else break;de=n(d)}}function j(J){if(b=!1,y(J),!R)if(n(l)!==null)R=!0,Lt(V);else{var de=n(d);de!==null&&en(j,de.startTime-J)}}function V(J,de){R=!1,b&&(b=!1,I(_),_=-1),v=!0;var G=m;try{for(y(de),f=n(l);f!==null&&(!(f.expirationTime>de)||J&&!k());){var je=f.callback;if(typeof je=="function"){f.callback=null,m=f.priorityLevel;var Ke=je(f.expirationTime<=de);de=t.unstable_now(),typeof Ke=="function"?f.callback=Ke:f===n(l)&&r(l),y(de)}else r(l);f=n(l)}if(f!==null)var z=!0;else{var ne=n(d);ne!==null&&en(j,ne.startTime-de),z=!1}return z}finally{f=null,m=G,v=!1}}var M=!1,T=null,_=-1,S=5,C=-1;function k(){return!(t.unstable_now()-C<S)}function D(){if(T!==null){var J=t.unstable_now();C=J;var de=!0;try{de=T(!0,J)}finally{de?P():(M=!1,T=null)}}else M=!1}var P;if(typeof w=="function")P=function(){w(D)};else if(typeof MessageChannel<"u"){var Y=new MessageChannel,Ye=Y.port2;Y.port1.onmessage=D,P=function(){Ye.postMessage(null)}}else P=function(){A(D,0)};function Lt(J){T=J,M||(M=!0,P())}function en(J,de){_=A(function(){J(t.unstable_now())},de)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(J){J.callback=null},t.unstable_continueExecution=function(){R||v||(R=!0,Lt(V))},t.unstable_forceFrameRate=function(J){0>J||125<J?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):S=0<J?Math.floor(1e3/J):5},t.unstable_getCurrentPriorityLevel=function(){return m},t.unstable_getFirstCallbackNode=function(){return n(l)},t.unstable_next=function(J){switch(m){case 1:case 2:case 3:var de=3;break;default:de=m}var G=m;m=de;try{return J()}finally{m=G}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(J,de){switch(J){case 1:case 2:case 3:case 4:case 5:break;default:J=3}var G=m;m=J;try{return de()}finally{m=G}},t.unstable_scheduleCallback=function(J,de,G){var je=t.unstable_now();switch(typeof G=="object"&&G!==null?(G=G.delay,G=typeof G=="number"&&0<G?je+G:je):G=je,J){case 1:var Ke=-1;break;case 2:Ke=250;break;case 5:Ke=1073741823;break;case 4:Ke=1e4;break;default:Ke=5e3}return Ke=G+Ke,J={id:h++,callback:de,priorityLevel:J,startTime:G,expirationTime:Ke,sortIndex:-1},G>je?(J.sortIndex=G,e(d,J),n(l)===null&&J===n(d)&&(b?(I(_),_=-1):b=!0,en(j,G-je))):(J.sortIndex=Ke,e(l,J),R||v||(R=!0,Lt(V))),J},t.unstable_shouldYield=k,t.unstable_wrapCallback=function(J){var de=m;return function(){var G=m;m=de;try{return J.apply(this,arguments)}finally{m=G}}}})(RT);AT.exports=RT;var NR=AT.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var kR=N,Ln=NR;function W(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var PT=new Set,ql={};function to(t,e){na(t,e),na(t+"Capture",e)}function na(t,e){for(ql[t]=e,t=0;t<e.length;t++)PT.add(e[t])}var Wr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),jp=Object.prototype.hasOwnProperty,DR=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,xv={},Sv={};function jR(t){return jp.call(Sv,t)?!0:jp.call(xv,t)?!1:DR.test(t)?Sv[t]=!0:(xv[t]=!0,!1)}function OR(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function VR(t,e,n,r){if(e===null||typeof e>"u"||OR(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function wn(t,e,n,r,s,i,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=o}var Zt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Zt[t]=new wn(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Zt[e]=new wn(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Zt[t]=new wn(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Zt[t]=new wn(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Zt[t]=new wn(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Zt[t]=new wn(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Zt[t]=new wn(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Zt[t]=new wn(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Zt[t]=new wn(t,5,!1,t.toLowerCase(),null,!1,!1)});var pg=/[\-:]([a-z])/g;function mg(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(pg,mg);Zt[e]=new wn(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(pg,mg);Zt[e]=new wn(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(pg,mg);Zt[e]=new wn(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Zt[t]=new wn(t,1,!1,t.toLowerCase(),null,!1,!1)});Zt.xlinkHref=new wn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Zt[t]=new wn(t,1,!1,t.toLowerCase(),null,!0,!0)});function gg(t,e,n,r){var s=Zt.hasOwnProperty(e)?Zt[e]:null;(s!==null?s.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(VR(e,n,s,r)&&(n=null),r||s===null?jR(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):s.mustUseProperty?t[s.propertyName]=n===null?s.type===3?!1:"":n:(e=s.attributeName,r=s.attributeNamespace,n===null?t.removeAttribute(e):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var ns=kR.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,su=Symbol.for("react.element"),Ro=Symbol.for("react.portal"),Po=Symbol.for("react.fragment"),yg=Symbol.for("react.strict_mode"),Op=Symbol.for("react.profiler"),NT=Symbol.for("react.provider"),kT=Symbol.for("react.context"),_g=Symbol.for("react.forward_ref"),Vp=Symbol.for("react.suspense"),Lp=Symbol.for("react.suspense_list"),vg=Symbol.for("react.memo"),ys=Symbol.for("react.lazy"),DT=Symbol.for("react.offscreen"),bv=Symbol.iterator;function Qa(t){return t===null||typeof t!="object"?null:(t=bv&&t[bv]||t["@@iterator"],typeof t=="function"?t:null)}var _t=Object.assign,Df;function dl(t){if(Df===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);Df=e&&e[1]||""}return`
`+Df+t}var jf=!1;function Of(t,e){if(!t||jf)return"";jf=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(d){var r=d}Reflect.construct(t,[],e)}else{try{e.call()}catch(d){r=d}t.call(e.prototype)}else{try{throw Error()}catch(d){r=d}t()}}catch(d){if(d&&r&&typeof d.stack=="string"){for(var s=d.stack.split(`
`),i=r.stack.split(`
`),o=s.length-1,a=i.length-1;1<=o&&0<=a&&s[o]!==i[a];)a--;for(;1<=o&&0<=a;o--,a--)if(s[o]!==i[a]){if(o!==1||a!==1)do if(o--,a--,0>a||s[o]!==i[a]){var l=`
`+s[o].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=o&&0<=a);break}}}finally{jf=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?dl(t):""}function LR(t){switch(t.tag){case 5:return dl(t.type);case 16:return dl("Lazy");case 13:return dl("Suspense");case 19:return dl("SuspenseList");case 0:case 2:case 15:return t=Of(t.type,!1),t;case 11:return t=Of(t.type.render,!1),t;case 1:return t=Of(t.type,!0),t;default:return""}}function Mp(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Po:return"Fragment";case Ro:return"Portal";case Op:return"Profiler";case yg:return"StrictMode";case Vp:return"Suspense";case Lp:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case kT:return(t.displayName||"Context")+".Consumer";case NT:return(t._context.displayName||"Context")+".Provider";case _g:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case vg:return e=t.displayName||null,e!==null?e:Mp(t.type)||"Memo";case ys:e=t._payload,t=t._init;try{return Mp(t(e))}catch{}}return null}function MR(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Mp(e);case 8:return e===yg?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Hs(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function jT(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function FR(t){var e=jT(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,i=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(o){r=""+o,i.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function iu(t){t._valueTracker||(t._valueTracker=FR(t))}function OT(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=jT(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function ud(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Fp(t,e){var n=e.checked;return _t({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function Cv(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=Hs(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function VT(t,e){e=e.checked,e!=null&&gg(t,"checked",e,!1)}function Up(t,e){VT(t,e);var n=Hs(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?$p(t,e.type,n):e.hasOwnProperty("defaultValue")&&$p(t,e.type,Hs(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function Av(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function $p(t,e,n){(e!=="number"||ud(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var hl=Array.isArray;function Bo(t,e,n,r){if(t=t.options,e){e={};for(var s=0;s<n.length;s++)e["$"+n[s]]=!0;for(n=0;n<t.length;n++)s=e.hasOwnProperty("$"+t[n].value),t[n].selected!==s&&(t[n].selected=s),s&&r&&(t[n].defaultSelected=!0)}else{for(n=""+Hs(n),e=null,s=0;s<t.length;s++){if(t[s].value===n){t[s].selected=!0,r&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function Bp(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(W(91));return _t({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function Rv(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(W(92));if(hl(n)){if(1<n.length)throw Error(W(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Hs(n)}}function LT(t,e){var n=Hs(e.value),r=Hs(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function Pv(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function MT(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function zp(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?MT(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var ou,FT=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,s){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(ou=ou||document.createElement("div"),ou.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=ou.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Hl(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var xl={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},UR=["Webkit","ms","Moz","O"];Object.keys(xl).forEach(function(t){UR.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),xl[e]=xl[t]})});function UT(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||xl.hasOwnProperty(t)&&xl[t]?(""+e).trim():e+"px"}function $T(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=UT(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,s):t[n]=s}}var $R=_t({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function qp(t,e){if(e){if($R[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(W(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(W(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(W(61))}if(e.style!=null&&typeof e.style!="object")throw Error(W(62))}}function Hp(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Wp=null;function wg(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Kp=null,zo=null,qo=null;function Nv(t){if(t=Sc(t)){if(typeof Kp!="function")throw Error(W(280));var e=t.stateNode;e&&(e=yh(e),Kp(t.stateNode,t.type,e))}}function BT(t){zo?qo?qo.push(t):qo=[t]:zo=t}function zT(){if(zo){var t=zo,e=qo;if(qo=zo=null,Nv(t),e)for(t=0;t<e.length;t++)Nv(e[t])}}function qT(t,e){return t(e)}function HT(){}var Vf=!1;function WT(t,e,n){if(Vf)return t(e,n);Vf=!0;try{return qT(t,e,n)}finally{Vf=!1,(zo!==null||qo!==null)&&(HT(),zT())}}function Wl(t,e){var n=t.stateNode;if(n===null)return null;var r=yh(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(W(231,e,typeof n));return n}var Gp=!1;if(Wr)try{var Ya={};Object.defineProperty(Ya,"passive",{get:function(){Gp=!0}}),window.addEventListener("test",Ya,Ya),window.removeEventListener("test",Ya,Ya)}catch{Gp=!1}function BR(t,e,n,r,s,i,o,a,l){var d=Array.prototype.slice.call(arguments,3);try{e.apply(n,d)}catch(h){this.onError(h)}}var Sl=!1,dd=null,hd=!1,Qp=null,zR={onError:function(t){Sl=!0,dd=t}};function qR(t,e,n,r,s,i,o,a,l){Sl=!1,dd=null,BR.apply(zR,arguments)}function HR(t,e,n,r,s,i,o,a,l){if(qR.apply(this,arguments),Sl){if(Sl){var d=dd;Sl=!1,dd=null}else throw Error(W(198));hd||(hd=!0,Qp=d)}}function no(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function KT(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function kv(t){if(no(t)!==t)throw Error(W(188))}function WR(t){var e=t.alternate;if(!e){if(e=no(t),e===null)throw Error(W(188));return e!==t?null:t}for(var n=t,r=e;;){var s=n.return;if(s===null)break;var i=s.alternate;if(i===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===n)return kv(s),t;if(i===r)return kv(s),e;i=i.sibling}throw Error(W(188))}if(n.return!==r.return)n=s,r=i;else{for(var o=!1,a=s.child;a;){if(a===n){o=!0,n=s,r=i;break}if(a===r){o=!0,r=s,n=i;break}a=a.sibling}if(!o){for(a=i.child;a;){if(a===n){o=!0,n=i,r=s;break}if(a===r){o=!0,r=i,n=s;break}a=a.sibling}if(!o)throw Error(W(189))}}if(n.alternate!==r)throw Error(W(190))}if(n.tag!==3)throw Error(W(188));return n.stateNode.current===n?t:e}function GT(t){return t=WR(t),t!==null?QT(t):null}function QT(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=QT(t);if(e!==null)return e;t=t.sibling}return null}var YT=Ln.unstable_scheduleCallback,Dv=Ln.unstable_cancelCallback,KR=Ln.unstable_shouldYield,GR=Ln.unstable_requestPaint,bt=Ln.unstable_now,QR=Ln.unstable_getCurrentPriorityLevel,Eg=Ln.unstable_ImmediatePriority,XT=Ln.unstable_UserBlockingPriority,fd=Ln.unstable_NormalPriority,YR=Ln.unstable_LowPriority,JT=Ln.unstable_IdlePriority,fh=null,Ar=null;function XR(t){if(Ar&&typeof Ar.onCommitFiberRoot=="function")try{Ar.onCommitFiberRoot(fh,t,void 0,(t.current.flags&128)===128)}catch{}}var ar=Math.clz32?Math.clz32:e1,JR=Math.log,ZR=Math.LN2;function e1(t){return t>>>=0,t===0?32:31-(JR(t)/ZR|0)|0}var au=64,lu=4194304;function fl(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function pd(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,s=t.suspendedLanes,i=t.pingedLanes,o=n&268435455;if(o!==0){var a=o&~s;a!==0?r=fl(a):(i&=o,i!==0&&(r=fl(i)))}else o=n&~s,o!==0?r=fl(o):i!==0&&(r=fl(i));if(r===0)return 0;if(e!==0&&e!==r&&!(e&s)&&(s=r&-r,i=e&-e,s>=i||s===16&&(i&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-ar(e),s=1<<n,r|=t[n],e&=~s;return r}function t1(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function n1(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,s=t.expirationTimes,i=t.pendingLanes;0<i;){var o=31-ar(i),a=1<<o,l=s[o];l===-1?(!(a&n)||a&r)&&(s[o]=t1(a,e)):l<=e&&(t.expiredLanes|=a),i&=~a}}function Yp(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function ZT(){var t=au;return au<<=1,!(au&4194240)&&(au=64),t}function Lf(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Tc(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-ar(e),t[e]=n}function r1(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var s=31-ar(n),i=1<<s;e[s]=0,r[s]=-1,t[s]=-1,n&=~i}}function Ig(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-ar(n),s=1<<r;s&e|t[r]&e&&(t[r]|=e),n&=~s}}var et=0;function e0(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var t0,Tg,n0,r0,s0,Xp=!1,cu=[],Ns=null,ks=null,Ds=null,Kl=new Map,Gl=new Map,vs=[],s1="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function jv(t,e){switch(t){case"focusin":case"focusout":Ns=null;break;case"dragenter":case"dragleave":ks=null;break;case"mouseover":case"mouseout":Ds=null;break;case"pointerover":case"pointerout":Kl.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Gl.delete(e.pointerId)}}function Xa(t,e,n,r,s,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[s]},e!==null&&(e=Sc(e),e!==null&&Tg(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function i1(t,e,n,r,s){switch(e){case"focusin":return Ns=Xa(Ns,t,e,n,r,s),!0;case"dragenter":return ks=Xa(ks,t,e,n,r,s),!0;case"mouseover":return Ds=Xa(Ds,t,e,n,r,s),!0;case"pointerover":var i=s.pointerId;return Kl.set(i,Xa(Kl.get(i)||null,t,e,n,r,s)),!0;case"gotpointercapture":return i=s.pointerId,Gl.set(i,Xa(Gl.get(i)||null,t,e,n,r,s)),!0}return!1}function i0(t){var e=Ti(t.target);if(e!==null){var n=no(e);if(n!==null){if(e=n.tag,e===13){if(e=KT(n),e!==null){t.blockedOn=e,s0(t.priority,function(){n0(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Vu(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=Jp(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);Wp=r,n.target.dispatchEvent(r),Wp=null}else return e=Sc(n),e!==null&&Tg(e),t.blockedOn=n,!1;e.shift()}return!0}function Ov(t,e,n){Vu(t)&&n.delete(e)}function o1(){Xp=!1,Ns!==null&&Vu(Ns)&&(Ns=null),ks!==null&&Vu(ks)&&(ks=null),Ds!==null&&Vu(Ds)&&(Ds=null),Kl.forEach(Ov),Gl.forEach(Ov)}function Ja(t,e){t.blockedOn===e&&(t.blockedOn=null,Xp||(Xp=!0,Ln.unstable_scheduleCallback(Ln.unstable_NormalPriority,o1)))}function Ql(t){function e(s){return Ja(s,t)}if(0<cu.length){Ja(cu[0],t);for(var n=1;n<cu.length;n++){var r=cu[n];r.blockedOn===t&&(r.blockedOn=null)}}for(Ns!==null&&Ja(Ns,t),ks!==null&&Ja(ks,t),Ds!==null&&Ja(Ds,t),Kl.forEach(e),Gl.forEach(e),n=0;n<vs.length;n++)r=vs[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<vs.length&&(n=vs[0],n.blockedOn===null);)i0(n),n.blockedOn===null&&vs.shift()}var Ho=ns.ReactCurrentBatchConfig,md=!0;function a1(t,e,n,r){var s=et,i=Ho.transition;Ho.transition=null;try{et=1,xg(t,e,n,r)}finally{et=s,Ho.transition=i}}function l1(t,e,n,r){var s=et,i=Ho.transition;Ho.transition=null;try{et=4,xg(t,e,n,r)}finally{et=s,Ho.transition=i}}function xg(t,e,n,r){if(md){var s=Jp(t,e,n,r);if(s===null)Kf(t,e,r,gd,n),jv(t,r);else if(i1(s,t,e,n,r))r.stopPropagation();else if(jv(t,r),e&4&&-1<s1.indexOf(t)){for(;s!==null;){var i=Sc(s);if(i!==null&&t0(i),i=Jp(t,e,n,r),i===null&&Kf(t,e,r,gd,n),i===s)break;s=i}s!==null&&r.stopPropagation()}else Kf(t,e,r,null,n)}}var gd=null;function Jp(t,e,n,r){if(gd=null,t=wg(r),t=Ti(t),t!==null)if(e=no(t),e===null)t=null;else if(n=e.tag,n===13){if(t=KT(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return gd=t,null}function o0(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(QR()){case Eg:return 1;case XT:return 4;case fd:case YR:return 16;case JT:return 536870912;default:return 16}default:return 16}}var As=null,Sg=null,Lu=null;function a0(){if(Lu)return Lu;var t,e=Sg,n=e.length,r,s="value"in As?As.value:As.textContent,i=s.length;for(t=0;t<n&&e[t]===s[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===s[i-r];r++);return Lu=s.slice(t,1<r?1-r:void 0)}function Mu(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function uu(){return!0}function Vv(){return!1}function Un(t){function e(n,r,s,i,o){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(n=t[a],this[a]=n?n(i):i[a]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?uu:Vv,this.isPropagationStopped=Vv,this}return _t(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=uu)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=uu)},persist:function(){},isPersistent:uu}),e}var xa={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},bg=Un(xa),xc=_t({},xa,{view:0,detail:0}),c1=Un(xc),Mf,Ff,Za,ph=_t({},xc,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Cg,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Za&&(Za&&t.type==="mousemove"?(Mf=t.screenX-Za.screenX,Ff=t.screenY-Za.screenY):Ff=Mf=0,Za=t),Mf)},movementY:function(t){return"movementY"in t?t.movementY:Ff}}),Lv=Un(ph),u1=_t({},ph,{dataTransfer:0}),d1=Un(u1),h1=_t({},xc,{relatedTarget:0}),Uf=Un(h1),f1=_t({},xa,{animationName:0,elapsedTime:0,pseudoElement:0}),p1=Un(f1),m1=_t({},xa,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),g1=Un(m1),y1=_t({},xa,{data:0}),Mv=Un(y1),_1={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},v1={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},w1={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function E1(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=w1[t])?!!e[t]:!1}function Cg(){return E1}var I1=_t({},xc,{key:function(t){if(t.key){var e=_1[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Mu(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?v1[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Cg,charCode:function(t){return t.type==="keypress"?Mu(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Mu(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),T1=Un(I1),x1=_t({},ph,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Fv=Un(x1),S1=_t({},xc,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Cg}),b1=Un(S1),C1=_t({},xa,{propertyName:0,elapsedTime:0,pseudoElement:0}),A1=Un(C1),R1=_t({},ph,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),P1=Un(R1),N1=[9,13,27,32],Ag=Wr&&"CompositionEvent"in window,bl=null;Wr&&"documentMode"in document&&(bl=document.documentMode);var k1=Wr&&"TextEvent"in window&&!bl,l0=Wr&&(!Ag||bl&&8<bl&&11>=bl),Uv=" ",$v=!1;function c0(t,e){switch(t){case"keyup":return N1.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function u0(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var No=!1;function D1(t,e){switch(t){case"compositionend":return u0(e);case"keypress":return e.which!==32?null:($v=!0,Uv);case"textInput":return t=e.data,t===Uv&&$v?null:t;default:return null}}function j1(t,e){if(No)return t==="compositionend"||!Ag&&c0(t,e)?(t=a0(),Lu=Sg=As=null,No=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return l0&&e.locale!=="ko"?null:e.data;default:return null}}var O1={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Bv(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!O1[t.type]:e==="textarea"}function d0(t,e,n,r){BT(r),e=yd(e,"onChange"),0<e.length&&(n=new bg("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var Cl=null,Yl=null;function V1(t){I0(t,0)}function mh(t){var e=jo(t);if(OT(e))return t}function L1(t,e){if(t==="change")return e}var h0=!1;if(Wr){var $f;if(Wr){var Bf="oninput"in document;if(!Bf){var zv=document.createElement("div");zv.setAttribute("oninput","return;"),Bf=typeof zv.oninput=="function"}$f=Bf}else $f=!1;h0=$f&&(!document.documentMode||9<document.documentMode)}function qv(){Cl&&(Cl.detachEvent("onpropertychange",f0),Yl=Cl=null)}function f0(t){if(t.propertyName==="value"&&mh(Yl)){var e=[];d0(e,Yl,t,wg(t)),WT(V1,e)}}function M1(t,e,n){t==="focusin"?(qv(),Cl=e,Yl=n,Cl.attachEvent("onpropertychange",f0)):t==="focusout"&&qv()}function F1(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return mh(Yl)}function U1(t,e){if(t==="click")return mh(e)}function $1(t,e){if(t==="input"||t==="change")return mh(e)}function B1(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var ur=typeof Object.is=="function"?Object.is:B1;function Xl(t,e){if(ur(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!jp.call(e,s)||!ur(t[s],e[s]))return!1}return!0}function Hv(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Wv(t,e){var n=Hv(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Hv(n)}}function p0(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?p0(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function m0(){for(var t=window,e=ud();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=ud(t.document)}return e}function Rg(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function z1(t){var e=m0(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&p0(n.ownerDocument.documentElement,n)){if(r!==null&&Rg(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=n.textContent.length,i=Math.min(r.start,s);r=r.end===void 0?i:Math.min(r.end,s),!t.extend&&i>r&&(s=r,r=i,i=s),s=Wv(n,i);var o=Wv(n,r);s&&o&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),i>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var q1=Wr&&"documentMode"in document&&11>=document.documentMode,ko=null,Zp=null,Al=null,em=!1;function Kv(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;em||ko==null||ko!==ud(r)||(r=ko,"selectionStart"in r&&Rg(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Al&&Xl(Al,r)||(Al=r,r=yd(Zp,"onSelect"),0<r.length&&(e=new bg("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=ko)))}function du(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Do={animationend:du("Animation","AnimationEnd"),animationiteration:du("Animation","AnimationIteration"),animationstart:du("Animation","AnimationStart"),transitionend:du("Transition","TransitionEnd")},zf={},g0={};Wr&&(g0=document.createElement("div").style,"AnimationEvent"in window||(delete Do.animationend.animation,delete Do.animationiteration.animation,delete Do.animationstart.animation),"TransitionEvent"in window||delete Do.transitionend.transition);function gh(t){if(zf[t])return zf[t];if(!Do[t])return t;var e=Do[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in g0)return zf[t]=e[n];return t}var y0=gh("animationend"),_0=gh("animationiteration"),v0=gh("animationstart"),w0=gh("transitionend"),E0=new Map,Gv="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Js(t,e){E0.set(t,e),to(e,[t])}for(var qf=0;qf<Gv.length;qf++){var Hf=Gv[qf],H1=Hf.toLowerCase(),W1=Hf[0].toUpperCase()+Hf.slice(1);Js(H1,"on"+W1)}Js(y0,"onAnimationEnd");Js(_0,"onAnimationIteration");Js(v0,"onAnimationStart");Js("dblclick","onDoubleClick");Js("focusin","onFocus");Js("focusout","onBlur");Js(w0,"onTransitionEnd");na("onMouseEnter",["mouseout","mouseover"]);na("onMouseLeave",["mouseout","mouseover"]);na("onPointerEnter",["pointerout","pointerover"]);na("onPointerLeave",["pointerout","pointerover"]);to("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));to("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));to("onBeforeInput",["compositionend","keypress","textInput","paste"]);to("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));to("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));to("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var pl="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),K1=new Set("cancel close invalid load scroll toggle".split(" ").concat(pl));function Qv(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,HR(r,e,void 0,t),t.currentTarget=null}function I0(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],s=r.event;r=r.listeners;e:{var i=void 0;if(e)for(var o=r.length-1;0<=o;o--){var a=r[o],l=a.instance,d=a.currentTarget;if(a=a.listener,l!==i&&s.isPropagationStopped())break e;Qv(s,a,d),i=l}else for(o=0;o<r.length;o++){if(a=r[o],l=a.instance,d=a.currentTarget,a=a.listener,l!==i&&s.isPropagationStopped())break e;Qv(s,a,d),i=l}}}if(hd)throw t=Qp,hd=!1,Qp=null,t}function at(t,e){var n=e[im];n===void 0&&(n=e[im]=new Set);var r=t+"__bubble";n.has(r)||(T0(e,t,2,!1),n.add(r))}function Wf(t,e,n){var r=0;e&&(r|=4),T0(n,t,r,e)}var hu="_reactListening"+Math.random().toString(36).slice(2);function Jl(t){if(!t[hu]){t[hu]=!0,PT.forEach(function(n){n!=="selectionchange"&&(K1.has(n)||Wf(n,!1,t),Wf(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[hu]||(e[hu]=!0,Wf("selectionchange",!1,e))}}function T0(t,e,n,r){switch(o0(e)){case 1:var s=a1;break;case 4:s=l1;break;default:s=xg}n=s.bind(null,e,n,t),s=void 0,!Gp||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),r?s!==void 0?t.addEventListener(e,n,{capture:!0,passive:s}):t.addEventListener(e,n,!0):s!==void 0?t.addEventListener(e,n,{passive:s}):t.addEventListener(e,n,!1)}function Kf(t,e,n,r,s){var i=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var a=r.stateNode.containerInfo;if(a===s||a.nodeType===8&&a.parentNode===s)break;if(o===4)for(o=r.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===s||l.nodeType===8&&l.parentNode===s))return;o=o.return}for(;a!==null;){if(o=Ti(a),o===null)return;if(l=o.tag,l===5||l===6){r=i=o;continue e}a=a.parentNode}}r=r.return}WT(function(){var d=i,h=wg(n),f=[];e:{var m=E0.get(t);if(m!==void 0){var v=bg,R=t;switch(t){case"keypress":if(Mu(n)===0)break e;case"keydown":case"keyup":v=T1;break;case"focusin":R="focus",v=Uf;break;case"focusout":R="blur",v=Uf;break;case"beforeblur":case"afterblur":v=Uf;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":v=Lv;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":v=d1;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":v=b1;break;case y0:case _0:case v0:v=p1;break;case w0:v=A1;break;case"scroll":v=c1;break;case"wheel":v=P1;break;case"copy":case"cut":case"paste":v=g1;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":v=Fv}var b=(e&4)!==0,A=!b&&t==="scroll",I=b?m!==null?m+"Capture":null:m;b=[];for(var w=d,y;w!==null;){y=w;var j=y.stateNode;if(y.tag===5&&j!==null&&(y=j,I!==null&&(j=Wl(w,I),j!=null&&b.push(Zl(w,j,y)))),A)break;w=w.return}0<b.length&&(m=new v(m,R,null,n,h),f.push({event:m,listeners:b}))}}if(!(e&7)){e:{if(m=t==="mouseover"||t==="pointerover",v=t==="mouseout"||t==="pointerout",m&&n!==Wp&&(R=n.relatedTarget||n.fromElement)&&(Ti(R)||R[Kr]))break e;if((v||m)&&(m=h.window===h?h:(m=h.ownerDocument)?m.defaultView||m.parentWindow:window,v?(R=n.relatedTarget||n.toElement,v=d,R=R?Ti(R):null,R!==null&&(A=no(R),R!==A||R.tag!==5&&R.tag!==6)&&(R=null)):(v=null,R=d),v!==R)){if(b=Lv,j="onMouseLeave",I="onMouseEnter",w="mouse",(t==="pointerout"||t==="pointerover")&&(b=Fv,j="onPointerLeave",I="onPointerEnter",w="pointer"),A=v==null?m:jo(v),y=R==null?m:jo(R),m=new b(j,w+"leave",v,n,h),m.target=A,m.relatedTarget=y,j=null,Ti(h)===d&&(b=new b(I,w+"enter",R,n,h),b.target=y,b.relatedTarget=A,j=b),A=j,v&&R)t:{for(b=v,I=R,w=0,y=b;y;y=uo(y))w++;for(y=0,j=I;j;j=uo(j))y++;for(;0<w-y;)b=uo(b),w--;for(;0<y-w;)I=uo(I),y--;for(;w--;){if(b===I||I!==null&&b===I.alternate)break t;b=uo(b),I=uo(I)}b=null}else b=null;v!==null&&Yv(f,m,v,b,!1),R!==null&&A!==null&&Yv(f,A,R,b,!0)}}e:{if(m=d?jo(d):window,v=m.nodeName&&m.nodeName.toLowerCase(),v==="select"||v==="input"&&m.type==="file")var V=L1;else if(Bv(m))if(h0)V=$1;else{V=F1;var M=M1}else(v=m.nodeName)&&v.toLowerCase()==="input"&&(m.type==="checkbox"||m.type==="radio")&&(V=U1);if(V&&(V=V(t,d))){d0(f,V,n,h);break e}M&&M(t,m,d),t==="focusout"&&(M=m._wrapperState)&&M.controlled&&m.type==="number"&&$p(m,"number",m.value)}switch(M=d?jo(d):window,t){case"focusin":(Bv(M)||M.contentEditable==="true")&&(ko=M,Zp=d,Al=null);break;case"focusout":Al=Zp=ko=null;break;case"mousedown":em=!0;break;case"contextmenu":case"mouseup":case"dragend":em=!1,Kv(f,n,h);break;case"selectionchange":if(q1)break;case"keydown":case"keyup":Kv(f,n,h)}var T;if(Ag)e:{switch(t){case"compositionstart":var _="onCompositionStart";break e;case"compositionend":_="onCompositionEnd";break e;case"compositionupdate":_="onCompositionUpdate";break e}_=void 0}else No?c0(t,n)&&(_="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(_="onCompositionStart");_&&(l0&&n.locale!=="ko"&&(No||_!=="onCompositionStart"?_==="onCompositionEnd"&&No&&(T=a0()):(As=h,Sg="value"in As?As.value:As.textContent,No=!0)),M=yd(d,_),0<M.length&&(_=new Mv(_,t,null,n,h),f.push({event:_,listeners:M}),T?_.data=T:(T=u0(n),T!==null&&(_.data=T)))),(T=k1?D1(t,n):j1(t,n))&&(d=yd(d,"onBeforeInput"),0<d.length&&(h=new Mv("onBeforeInput","beforeinput",null,n,h),f.push({event:h,listeners:d}),h.data=T))}I0(f,e)})}function Zl(t,e,n){return{instance:t,listener:e,currentTarget:n}}function yd(t,e){for(var n=e+"Capture",r=[];t!==null;){var s=t,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=Wl(t,n),i!=null&&r.unshift(Zl(t,i,s)),i=Wl(t,e),i!=null&&r.push(Zl(t,i,s))),t=t.return}return r}function uo(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function Yv(t,e,n,r,s){for(var i=e._reactName,o=[];n!==null&&n!==r;){var a=n,l=a.alternate,d=a.stateNode;if(l!==null&&l===r)break;a.tag===5&&d!==null&&(a=d,s?(l=Wl(n,i),l!=null&&o.unshift(Zl(n,l,a))):s||(l=Wl(n,i),l!=null&&o.push(Zl(n,l,a)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var G1=/\r\n?/g,Q1=/\u0000|\uFFFD/g;function Xv(t){return(typeof t=="string"?t:""+t).replace(G1,`
`).replace(Q1,"")}function fu(t,e,n){if(e=Xv(e),Xv(t)!==e&&n)throw Error(W(425))}function _d(){}var tm=null,nm=null;function rm(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var sm=typeof setTimeout=="function"?setTimeout:void 0,Y1=typeof clearTimeout=="function"?clearTimeout:void 0,Jv=typeof Promise=="function"?Promise:void 0,X1=typeof queueMicrotask=="function"?queueMicrotask:typeof Jv<"u"?function(t){return Jv.resolve(null).then(t).catch(J1)}:sm;function J1(t){setTimeout(function(){throw t})}function Gf(t,e){var n=e,r=0;do{var s=n.nextSibling;if(t.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){t.removeChild(s),Ql(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);Ql(e)}function js(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function Zv(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var Sa=Math.random().toString(36).slice(2),xr="__reactFiber$"+Sa,ec="__reactProps$"+Sa,Kr="__reactContainer$"+Sa,im="__reactEvents$"+Sa,Z1="__reactListeners$"+Sa,eP="__reactHandles$"+Sa;function Ti(t){var e=t[xr];if(e)return e;for(var n=t.parentNode;n;){if(e=n[Kr]||n[xr]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=Zv(t);t!==null;){if(n=t[xr])return n;t=Zv(t)}return e}t=n,n=t.parentNode}return null}function Sc(t){return t=t[xr]||t[Kr],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function jo(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(W(33))}function yh(t){return t[ec]||null}var om=[],Oo=-1;function Zs(t){return{current:t}}function lt(t){0>Oo||(t.current=om[Oo],om[Oo]=null,Oo--)}function st(t,e){Oo++,om[Oo]=t.current,t.current=e}var Ws={},dn=Zs(Ws),bn=Zs(!1),Vi=Ws;function ra(t,e){var n=t.type.contextTypes;if(!n)return Ws;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in n)s[i]=e[i];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function Cn(t){return t=t.childContextTypes,t!=null}function vd(){lt(bn),lt(dn)}function ew(t,e,n){if(dn.current!==Ws)throw Error(W(168));st(dn,e),st(bn,n)}function x0(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in e))throw Error(W(108,MR(t)||"Unknown",s));return _t({},n,r)}function wd(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Ws,Vi=dn.current,st(dn,t),st(bn,bn.current),!0}function tw(t,e,n){var r=t.stateNode;if(!r)throw Error(W(169));n?(t=x0(t,e,Vi),r.__reactInternalMemoizedMergedChildContext=t,lt(bn),lt(dn),st(dn,t)):lt(bn),st(bn,n)}var Mr=null,_h=!1,Qf=!1;function S0(t){Mr===null?Mr=[t]:Mr.push(t)}function tP(t){_h=!0,S0(t)}function ei(){if(!Qf&&Mr!==null){Qf=!0;var t=0,e=et;try{var n=Mr;for(et=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}Mr=null,_h=!1}catch(s){throw Mr!==null&&(Mr=Mr.slice(t+1)),YT(Eg,ei),s}finally{et=e,Qf=!1}}return null}var Vo=[],Lo=0,Ed=null,Id=0,$n=[],Bn=0,Li=null,Fr=1,Ur="";function fi(t,e){Vo[Lo++]=Id,Vo[Lo++]=Ed,Ed=t,Id=e}function b0(t,e,n){$n[Bn++]=Fr,$n[Bn++]=Ur,$n[Bn++]=Li,Li=t;var r=Fr;t=Ur;var s=32-ar(r)-1;r&=~(1<<s),n+=1;var i=32-ar(e)+s;if(30<i){var o=s-s%5;i=(r&(1<<o)-1).toString(32),r>>=o,s-=o,Fr=1<<32-ar(e)+s|n<<s|r,Ur=i+t}else Fr=1<<i|n<<s|r,Ur=t}function Pg(t){t.return!==null&&(fi(t,1),b0(t,1,0))}function Ng(t){for(;t===Ed;)Ed=Vo[--Lo],Vo[Lo]=null,Id=Vo[--Lo],Vo[Lo]=null;for(;t===Li;)Li=$n[--Bn],$n[Bn]=null,Ur=$n[--Bn],$n[Bn]=null,Fr=$n[--Bn],$n[Bn]=null}var On=null,Dn=null,dt=!1,sr=null;function C0(t,e){var n=Hn(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function nw(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,On=t,Dn=js(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,On=t,Dn=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=Li!==null?{id:Fr,overflow:Ur}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=Hn(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,On=t,Dn=null,!0):!1;default:return!1}}function am(t){return(t.mode&1)!==0&&(t.flags&128)===0}function lm(t){if(dt){var e=Dn;if(e){var n=e;if(!nw(t,e)){if(am(t))throw Error(W(418));e=js(n.nextSibling);var r=On;e&&nw(t,e)?C0(r,n):(t.flags=t.flags&-4097|2,dt=!1,On=t)}}else{if(am(t))throw Error(W(418));t.flags=t.flags&-4097|2,dt=!1,On=t}}}function rw(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;On=t}function pu(t){if(t!==On)return!1;if(!dt)return rw(t),dt=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!rm(t.type,t.memoizedProps)),e&&(e=Dn)){if(am(t))throw A0(),Error(W(418));for(;e;)C0(t,e),e=js(e.nextSibling)}if(rw(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(W(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){Dn=js(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}Dn=null}}else Dn=On?js(t.stateNode.nextSibling):null;return!0}function A0(){for(var t=Dn;t;)t=js(t.nextSibling)}function sa(){Dn=On=null,dt=!1}function kg(t){sr===null?sr=[t]:sr.push(t)}var nP=ns.ReactCurrentBatchConfig;function el(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(W(309));var r=n.stateNode}if(!r)throw Error(W(147,t));var s=r,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(o){var a=s.refs;o===null?delete a[i]:a[i]=o},e._stringRef=i,e)}if(typeof t!="string")throw Error(W(284));if(!n._owner)throw Error(W(290,t))}return t}function mu(t,e){throw t=Object.prototype.toString.call(e),Error(W(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function sw(t){var e=t._init;return e(t._payload)}function R0(t){function e(I,w){if(t){var y=I.deletions;y===null?(I.deletions=[w],I.flags|=16):y.push(w)}}function n(I,w){if(!t)return null;for(;w!==null;)e(I,w),w=w.sibling;return null}function r(I,w){for(I=new Map;w!==null;)w.key!==null?I.set(w.key,w):I.set(w.index,w),w=w.sibling;return I}function s(I,w){return I=Ms(I,w),I.index=0,I.sibling=null,I}function i(I,w,y){return I.index=y,t?(y=I.alternate,y!==null?(y=y.index,y<w?(I.flags|=2,w):y):(I.flags|=2,w)):(I.flags|=1048576,w)}function o(I){return t&&I.alternate===null&&(I.flags|=2),I}function a(I,w,y,j){return w===null||w.tag!==6?(w=np(y,I.mode,j),w.return=I,w):(w=s(w,y),w.return=I,w)}function l(I,w,y,j){var V=y.type;return V===Po?h(I,w,y.props.children,j,y.key):w!==null&&(w.elementType===V||typeof V=="object"&&V!==null&&V.$$typeof===ys&&sw(V)===w.type)?(j=s(w,y.props),j.ref=el(I,w,y),j.return=I,j):(j=Hu(y.type,y.key,y.props,null,I.mode,j),j.ref=el(I,w,y),j.return=I,j)}function d(I,w,y,j){return w===null||w.tag!==4||w.stateNode.containerInfo!==y.containerInfo||w.stateNode.implementation!==y.implementation?(w=rp(y,I.mode,j),w.return=I,w):(w=s(w,y.children||[]),w.return=I,w)}function h(I,w,y,j,V){return w===null||w.tag!==7?(w=Ri(y,I.mode,j,V),w.return=I,w):(w=s(w,y),w.return=I,w)}function f(I,w,y){if(typeof w=="string"&&w!==""||typeof w=="number")return w=np(""+w,I.mode,y),w.return=I,w;if(typeof w=="object"&&w!==null){switch(w.$$typeof){case su:return y=Hu(w.type,w.key,w.props,null,I.mode,y),y.ref=el(I,null,w),y.return=I,y;case Ro:return w=rp(w,I.mode,y),w.return=I,w;case ys:var j=w._init;return f(I,j(w._payload),y)}if(hl(w)||Qa(w))return w=Ri(w,I.mode,y,null),w.return=I,w;mu(I,w)}return null}function m(I,w,y,j){var V=w!==null?w.key:null;if(typeof y=="string"&&y!==""||typeof y=="number")return V!==null?null:a(I,w,""+y,j);if(typeof y=="object"&&y!==null){switch(y.$$typeof){case su:return y.key===V?l(I,w,y,j):null;case Ro:return y.key===V?d(I,w,y,j):null;case ys:return V=y._init,m(I,w,V(y._payload),j)}if(hl(y)||Qa(y))return V!==null?null:h(I,w,y,j,null);mu(I,y)}return null}function v(I,w,y,j,V){if(typeof j=="string"&&j!==""||typeof j=="number")return I=I.get(y)||null,a(w,I,""+j,V);if(typeof j=="object"&&j!==null){switch(j.$$typeof){case su:return I=I.get(j.key===null?y:j.key)||null,l(w,I,j,V);case Ro:return I=I.get(j.key===null?y:j.key)||null,d(w,I,j,V);case ys:var M=j._init;return v(I,w,y,M(j._payload),V)}if(hl(j)||Qa(j))return I=I.get(y)||null,h(w,I,j,V,null);mu(w,j)}return null}function R(I,w,y,j){for(var V=null,M=null,T=w,_=w=0,S=null;T!==null&&_<y.length;_++){T.index>_?(S=T,T=null):S=T.sibling;var C=m(I,T,y[_],j);if(C===null){T===null&&(T=S);break}t&&T&&C.alternate===null&&e(I,T),w=i(C,w,_),M===null?V=C:M.sibling=C,M=C,T=S}if(_===y.length)return n(I,T),dt&&fi(I,_),V;if(T===null){for(;_<y.length;_++)T=f(I,y[_],j),T!==null&&(w=i(T,w,_),M===null?V=T:M.sibling=T,M=T);return dt&&fi(I,_),V}for(T=r(I,T);_<y.length;_++)S=v(T,I,_,y[_],j),S!==null&&(t&&S.alternate!==null&&T.delete(S.key===null?_:S.key),w=i(S,w,_),M===null?V=S:M.sibling=S,M=S);return t&&T.forEach(function(k){return e(I,k)}),dt&&fi(I,_),V}function b(I,w,y,j){var V=Qa(y);if(typeof V!="function")throw Error(W(150));if(y=V.call(y),y==null)throw Error(W(151));for(var M=V=null,T=w,_=w=0,S=null,C=y.next();T!==null&&!C.done;_++,C=y.next()){T.index>_?(S=T,T=null):S=T.sibling;var k=m(I,T,C.value,j);if(k===null){T===null&&(T=S);break}t&&T&&k.alternate===null&&e(I,T),w=i(k,w,_),M===null?V=k:M.sibling=k,M=k,T=S}if(C.done)return n(I,T),dt&&fi(I,_),V;if(T===null){for(;!C.done;_++,C=y.next())C=f(I,C.value,j),C!==null&&(w=i(C,w,_),M===null?V=C:M.sibling=C,M=C);return dt&&fi(I,_),V}for(T=r(I,T);!C.done;_++,C=y.next())C=v(T,I,_,C.value,j),C!==null&&(t&&C.alternate!==null&&T.delete(C.key===null?_:C.key),w=i(C,w,_),M===null?V=C:M.sibling=C,M=C);return t&&T.forEach(function(D){return e(I,D)}),dt&&fi(I,_),V}function A(I,w,y,j){if(typeof y=="object"&&y!==null&&y.type===Po&&y.key===null&&(y=y.props.children),typeof y=="object"&&y!==null){switch(y.$$typeof){case su:e:{for(var V=y.key,M=w;M!==null;){if(M.key===V){if(V=y.type,V===Po){if(M.tag===7){n(I,M.sibling),w=s(M,y.props.children),w.return=I,I=w;break e}}else if(M.elementType===V||typeof V=="object"&&V!==null&&V.$$typeof===ys&&sw(V)===M.type){n(I,M.sibling),w=s(M,y.props),w.ref=el(I,M,y),w.return=I,I=w;break e}n(I,M);break}else e(I,M);M=M.sibling}y.type===Po?(w=Ri(y.props.children,I.mode,j,y.key),w.return=I,I=w):(j=Hu(y.type,y.key,y.props,null,I.mode,j),j.ref=el(I,w,y),j.return=I,I=j)}return o(I);case Ro:e:{for(M=y.key;w!==null;){if(w.key===M)if(w.tag===4&&w.stateNode.containerInfo===y.containerInfo&&w.stateNode.implementation===y.implementation){n(I,w.sibling),w=s(w,y.children||[]),w.return=I,I=w;break e}else{n(I,w);break}else e(I,w);w=w.sibling}w=rp(y,I.mode,j),w.return=I,I=w}return o(I);case ys:return M=y._init,A(I,w,M(y._payload),j)}if(hl(y))return R(I,w,y,j);if(Qa(y))return b(I,w,y,j);mu(I,y)}return typeof y=="string"&&y!==""||typeof y=="number"?(y=""+y,w!==null&&w.tag===6?(n(I,w.sibling),w=s(w,y),w.return=I,I=w):(n(I,w),w=np(y,I.mode,j),w.return=I,I=w),o(I)):n(I,w)}return A}var ia=R0(!0),P0=R0(!1),Td=Zs(null),xd=null,Mo=null,Dg=null;function jg(){Dg=Mo=xd=null}function Og(t){var e=Td.current;lt(Td),t._currentValue=e}function cm(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function Wo(t,e){xd=t,Dg=Mo=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(xn=!0),t.firstContext=null)}function Qn(t){var e=t._currentValue;if(Dg!==t)if(t={context:t,memoizedValue:e,next:null},Mo===null){if(xd===null)throw Error(W(308));Mo=t,xd.dependencies={lanes:0,firstContext:t}}else Mo=Mo.next=t;return e}var xi=null;function Vg(t){xi===null?xi=[t]:xi.push(t)}function N0(t,e,n,r){var s=e.interleaved;return s===null?(n.next=n,Vg(e)):(n.next=s.next,s.next=n),e.interleaved=n,Gr(t,r)}function Gr(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var _s=!1;function Lg(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function k0(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function qr(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Os(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,ze&2){var s=r.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),r.pending=e,Gr(t,n)}return s=r.interleaved,s===null?(e.next=e,Vg(r)):(e.next=s.next,s.next=e),r.interleaved=e,Gr(t,n)}function Fu(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Ig(t,n)}}function iw(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?s=i=o:i=i.next=o,n=n.next}while(n!==null);i===null?s=i=e:i=i.next=e}else s=i=e;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function Sd(t,e,n,r){var s=t.updateQueue;_s=!1;var i=s.firstBaseUpdate,o=s.lastBaseUpdate,a=s.shared.pending;if(a!==null){s.shared.pending=null;var l=a,d=l.next;l.next=null,o===null?i=d:o.next=d,o=l;var h=t.alternate;h!==null&&(h=h.updateQueue,a=h.lastBaseUpdate,a!==o&&(a===null?h.firstBaseUpdate=d:a.next=d,h.lastBaseUpdate=l))}if(i!==null){var f=s.baseState;o=0,h=d=l=null,a=i;do{var m=a.lane,v=a.eventTime;if((r&m)===m){h!==null&&(h=h.next={eventTime:v,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var R=t,b=a;switch(m=e,v=n,b.tag){case 1:if(R=b.payload,typeof R=="function"){f=R.call(v,f,m);break e}f=R;break e;case 3:R.flags=R.flags&-65537|128;case 0:if(R=b.payload,m=typeof R=="function"?R.call(v,f,m):R,m==null)break e;f=_t({},f,m);break e;case 2:_s=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,m=s.effects,m===null?s.effects=[a]:m.push(a))}else v={eventTime:v,lane:m,tag:a.tag,payload:a.payload,callback:a.callback,next:null},h===null?(d=h=v,l=f):h=h.next=v,o|=m;if(a=a.next,a===null){if(a=s.shared.pending,a===null)break;m=a,a=m.next,m.next=null,s.lastBaseUpdate=m,s.shared.pending=null}}while(!0);if(h===null&&(l=f),s.baseState=l,s.firstBaseUpdate=d,s.lastBaseUpdate=h,e=s.shared.interleaved,e!==null){s=e;do o|=s.lane,s=s.next;while(s!==e)}else i===null&&(s.shared.lanes=0);Fi|=o,t.lanes=o,t.memoizedState=f}}function ow(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(W(191,s));s.call(r)}}}var bc={},Rr=Zs(bc),tc=Zs(bc),nc=Zs(bc);function Si(t){if(t===bc)throw Error(W(174));return t}function Mg(t,e){switch(st(nc,e),st(tc,t),st(Rr,bc),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:zp(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=zp(e,t)}lt(Rr),st(Rr,e)}function oa(){lt(Rr),lt(tc),lt(nc)}function D0(t){Si(nc.current);var e=Si(Rr.current),n=zp(e,t.type);e!==n&&(st(tc,t),st(Rr,n))}function Fg(t){tc.current===t&&(lt(Rr),lt(tc))}var mt=Zs(0);function bd(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Yf=[];function Ug(){for(var t=0;t<Yf.length;t++)Yf[t]._workInProgressVersionPrimary=null;Yf.length=0}var Uu=ns.ReactCurrentDispatcher,Xf=ns.ReactCurrentBatchConfig,Mi=0,yt=null,Dt=null,Bt=null,Cd=!1,Rl=!1,rc=0,rP=0;function tn(){throw Error(W(321))}function $g(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!ur(t[n],e[n]))return!1;return!0}function Bg(t,e,n,r,s,i){if(Mi=i,yt=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Uu.current=t===null||t.memoizedState===null?aP:lP,t=n(r,s),Rl){i=0;do{if(Rl=!1,rc=0,25<=i)throw Error(W(301));i+=1,Bt=Dt=null,e.updateQueue=null,Uu.current=cP,t=n(r,s)}while(Rl)}if(Uu.current=Ad,e=Dt!==null&&Dt.next!==null,Mi=0,Bt=Dt=yt=null,Cd=!1,e)throw Error(W(300));return t}function zg(){var t=rc!==0;return rc=0,t}function Ir(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Bt===null?yt.memoizedState=Bt=t:Bt=Bt.next=t,Bt}function Yn(){if(Dt===null){var t=yt.alternate;t=t!==null?t.memoizedState:null}else t=Dt.next;var e=Bt===null?yt.memoizedState:Bt.next;if(e!==null)Bt=e,Dt=t;else{if(t===null)throw Error(W(310));Dt=t,t={memoizedState:Dt.memoizedState,baseState:Dt.baseState,baseQueue:Dt.baseQueue,queue:Dt.queue,next:null},Bt===null?yt.memoizedState=Bt=t:Bt=Bt.next=t}return Bt}function sc(t,e){return typeof e=="function"?e(t):e}function Jf(t){var e=Yn(),n=e.queue;if(n===null)throw Error(W(311));n.lastRenderedReducer=t;var r=Dt,s=r.baseQueue,i=n.pending;if(i!==null){if(s!==null){var o=s.next;s.next=i.next,i.next=o}r.baseQueue=s=i,n.pending=null}if(s!==null){i=s.next,r=r.baseState;var a=o=null,l=null,d=i;do{var h=d.lane;if((Mi&h)===h)l!==null&&(l=l.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),r=d.hasEagerState?d.eagerState:t(r,d.action);else{var f={lane:h,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};l===null?(a=l=f,o=r):l=l.next=f,yt.lanes|=h,Fi|=h}d=d.next}while(d!==null&&d!==i);l===null?o=r:l.next=a,ur(r,e.memoizedState)||(xn=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=l,n.lastRenderedState=r}if(t=n.interleaved,t!==null){s=t;do i=s.lane,yt.lanes|=i,Fi|=i,s=s.next;while(s!==t)}else s===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function Zf(t){var e=Yn(),n=e.queue;if(n===null)throw Error(W(311));n.lastRenderedReducer=t;var r=n.dispatch,s=n.pending,i=e.memoizedState;if(s!==null){n.pending=null;var o=s=s.next;do i=t(i,o.action),o=o.next;while(o!==s);ur(i,e.memoizedState)||(xn=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),n.lastRenderedState=i}return[i,r]}function j0(){}function O0(t,e){var n=yt,r=Yn(),s=e(),i=!ur(r.memoizedState,s);if(i&&(r.memoizedState=s,xn=!0),r=r.queue,qg(M0.bind(null,n,r,t),[t]),r.getSnapshot!==e||i||Bt!==null&&Bt.memoizedState.tag&1){if(n.flags|=2048,ic(9,L0.bind(null,n,r,s,e),void 0,null),qt===null)throw Error(W(349));Mi&30||V0(n,e,s)}return s}function V0(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=yt.updateQueue,e===null?(e={lastEffect:null,stores:null},yt.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function L0(t,e,n,r){e.value=n,e.getSnapshot=r,F0(e)&&U0(t)}function M0(t,e,n){return n(function(){F0(e)&&U0(t)})}function F0(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!ur(t,n)}catch{return!0}}function U0(t){var e=Gr(t,1);e!==null&&lr(e,t,1,-1)}function aw(t){var e=Ir();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:sc,lastRenderedState:t},e.queue=t,t=t.dispatch=oP.bind(null,yt,t),[e.memoizedState,t]}function ic(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=yt.updateQueue,e===null?(e={lastEffect:null,stores:null},yt.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function $0(){return Yn().memoizedState}function $u(t,e,n,r){var s=Ir();yt.flags|=t,s.memoizedState=ic(1|e,n,void 0,r===void 0?null:r)}function vh(t,e,n,r){var s=Yn();r=r===void 0?null:r;var i=void 0;if(Dt!==null){var o=Dt.memoizedState;if(i=o.destroy,r!==null&&$g(r,o.deps)){s.memoizedState=ic(e,n,i,r);return}}yt.flags|=t,s.memoizedState=ic(1|e,n,i,r)}function lw(t,e){return $u(8390656,8,t,e)}function qg(t,e){return vh(2048,8,t,e)}function B0(t,e){return vh(4,2,t,e)}function z0(t,e){return vh(4,4,t,e)}function q0(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function H0(t,e,n){return n=n!=null?n.concat([t]):null,vh(4,4,q0.bind(null,e,t),n)}function Hg(){}function W0(t,e){var n=Yn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&$g(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function K0(t,e){var n=Yn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&$g(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function G0(t,e,n){return Mi&21?(ur(n,e)||(n=ZT(),yt.lanes|=n,Fi|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,xn=!0),t.memoizedState=n)}function sP(t,e){var n=et;et=n!==0&&4>n?n:4,t(!0);var r=Xf.transition;Xf.transition={};try{t(!1),e()}finally{et=n,Xf.transition=r}}function Q0(){return Yn().memoizedState}function iP(t,e,n){var r=Ls(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},Y0(t))X0(e,n);else if(n=N0(t,e,n,r),n!==null){var s=gn();lr(n,t,r,s),J0(n,e,r)}}function oP(t,e,n){var r=Ls(t),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(Y0(t))X0(e,s);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var o=e.lastRenderedState,a=i(o,n);if(s.hasEagerState=!0,s.eagerState=a,ur(a,o)){var l=e.interleaved;l===null?(s.next=s,Vg(e)):(s.next=l.next,l.next=s),e.interleaved=s;return}}catch{}finally{}n=N0(t,e,s,r),n!==null&&(s=gn(),lr(n,t,r,s),J0(n,e,r))}}function Y0(t){var e=t.alternate;return t===yt||e!==null&&e===yt}function X0(t,e){Rl=Cd=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function J0(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Ig(t,n)}}var Ad={readContext:Qn,useCallback:tn,useContext:tn,useEffect:tn,useImperativeHandle:tn,useInsertionEffect:tn,useLayoutEffect:tn,useMemo:tn,useReducer:tn,useRef:tn,useState:tn,useDebugValue:tn,useDeferredValue:tn,useTransition:tn,useMutableSource:tn,useSyncExternalStore:tn,useId:tn,unstable_isNewReconciler:!1},aP={readContext:Qn,useCallback:function(t,e){return Ir().memoizedState=[t,e===void 0?null:e],t},useContext:Qn,useEffect:lw,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,$u(4194308,4,q0.bind(null,e,t),n)},useLayoutEffect:function(t,e){return $u(4194308,4,t,e)},useInsertionEffect:function(t,e){return $u(4,2,t,e)},useMemo:function(t,e){var n=Ir();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=Ir();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=iP.bind(null,yt,t),[r.memoizedState,t]},useRef:function(t){var e=Ir();return t={current:t},e.memoizedState=t},useState:aw,useDebugValue:Hg,useDeferredValue:function(t){return Ir().memoizedState=t},useTransition:function(){var t=aw(!1),e=t[0];return t=sP.bind(null,t[1]),Ir().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=yt,s=Ir();if(dt){if(n===void 0)throw Error(W(407));n=n()}else{if(n=e(),qt===null)throw Error(W(349));Mi&30||V0(r,e,n)}s.memoizedState=n;var i={value:n,getSnapshot:e};return s.queue=i,lw(M0.bind(null,r,i,t),[t]),r.flags|=2048,ic(9,L0.bind(null,r,i,n,e),void 0,null),n},useId:function(){var t=Ir(),e=qt.identifierPrefix;if(dt){var n=Ur,r=Fr;n=(r&~(1<<32-ar(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=rc++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=rP++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},lP={readContext:Qn,useCallback:W0,useContext:Qn,useEffect:qg,useImperativeHandle:H0,useInsertionEffect:B0,useLayoutEffect:z0,useMemo:K0,useReducer:Jf,useRef:$0,useState:function(){return Jf(sc)},useDebugValue:Hg,useDeferredValue:function(t){var e=Yn();return G0(e,Dt.memoizedState,t)},useTransition:function(){var t=Jf(sc)[0],e=Yn().memoizedState;return[t,e]},useMutableSource:j0,useSyncExternalStore:O0,useId:Q0,unstable_isNewReconciler:!1},cP={readContext:Qn,useCallback:W0,useContext:Qn,useEffect:qg,useImperativeHandle:H0,useInsertionEffect:B0,useLayoutEffect:z0,useMemo:K0,useReducer:Zf,useRef:$0,useState:function(){return Zf(sc)},useDebugValue:Hg,useDeferredValue:function(t){var e=Yn();return Dt===null?e.memoizedState=t:G0(e,Dt.memoizedState,t)},useTransition:function(){var t=Zf(sc)[0],e=Yn().memoizedState;return[t,e]},useMutableSource:j0,useSyncExternalStore:O0,useId:Q0,unstable_isNewReconciler:!1};function tr(t,e){if(t&&t.defaultProps){e=_t({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function um(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:_t({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var wh={isMounted:function(t){return(t=t._reactInternals)?no(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=gn(),s=Ls(t),i=qr(r,s);i.payload=e,n!=null&&(i.callback=n),e=Os(t,i,s),e!==null&&(lr(e,t,s,r),Fu(e,t,s))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=gn(),s=Ls(t),i=qr(r,s);i.tag=1,i.payload=e,n!=null&&(i.callback=n),e=Os(t,i,s),e!==null&&(lr(e,t,s,r),Fu(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=gn(),r=Ls(t),s=qr(n,r);s.tag=2,e!=null&&(s.callback=e),e=Os(t,s,r),e!==null&&(lr(e,t,r,n),Fu(e,t,r))}};function cw(t,e,n,r,s,i,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,i,o):e.prototype&&e.prototype.isPureReactComponent?!Xl(n,r)||!Xl(s,i):!0}function Z0(t,e,n){var r=!1,s=Ws,i=e.contextType;return typeof i=="object"&&i!==null?i=Qn(i):(s=Cn(e)?Vi:dn.current,r=e.contextTypes,i=(r=r!=null)?ra(t,s):Ws),e=new e(n,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=wh,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=i),e}function uw(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&wh.enqueueReplaceState(e,e.state,null)}function dm(t,e,n,r){var s=t.stateNode;s.props=n,s.state=t.memoizedState,s.refs={},Lg(t);var i=e.contextType;typeof i=="object"&&i!==null?s.context=Qn(i):(i=Cn(e)?Vi:dn.current,s.context=ra(t,i)),s.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(um(t,e,i,n),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&wh.enqueueReplaceState(s,s.state,null),Sd(t,n,s,r),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function aa(t,e){try{var n="",r=e;do n+=LR(r),r=r.return;while(r);var s=n}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:s,digest:null}}function ep(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function hm(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var uP=typeof WeakMap=="function"?WeakMap:Map;function ex(t,e,n){n=qr(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){Pd||(Pd=!0,Im=r),hm(t,e)},n}function tx(t,e,n){n=qr(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var s=e.value;n.payload=function(){return r(s)},n.callback=function(){hm(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){hm(t,e),typeof r!="function"&&(Vs===null?Vs=new Set([this]):Vs.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function dw(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new uP;var s=new Set;r.set(e,s)}else s=r.get(e),s===void 0&&(s=new Set,r.set(e,s));s.has(n)||(s.add(n),t=xP.bind(null,t,e,n),e.then(t,t))}function hw(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function fw(t,e,n,r,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=qr(-1,1),e.tag=2,Os(n,e,1))),n.lanes|=1),t)}var dP=ns.ReactCurrentOwner,xn=!1;function fn(t,e,n,r){e.child=t===null?P0(e,null,n,r):ia(e,t.child,n,r)}function pw(t,e,n,r,s){n=n.render;var i=e.ref;return Wo(e,s),r=Bg(t,e,n,r,i,s),n=zg(),t!==null&&!xn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,Qr(t,e,s)):(dt&&n&&Pg(e),e.flags|=1,fn(t,e,r,s),e.child)}function mw(t,e,n,r,s){if(t===null){var i=n.type;return typeof i=="function"&&!Zg(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=i,nx(t,e,i,r,s)):(t=Hu(n.type,null,r,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&s)){var o=i.memoizedProps;if(n=n.compare,n=n!==null?n:Xl,n(o,r)&&t.ref===e.ref)return Qr(t,e,s)}return e.flags|=1,t=Ms(i,r),t.ref=e.ref,t.return=e,e.child=t}function nx(t,e,n,r,s){if(t!==null){var i=t.memoizedProps;if(Xl(i,r)&&t.ref===e.ref)if(xn=!1,e.pendingProps=r=i,(t.lanes&s)!==0)t.flags&131072&&(xn=!0);else return e.lanes=t.lanes,Qr(t,e,s)}return fm(t,e,n,r,s)}function rx(t,e,n){var r=e.pendingProps,s=r.children,i=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},st(Uo,Nn),Nn|=n;else{if(!(n&1073741824))return t=i!==null?i.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,st(Uo,Nn),Nn|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,st(Uo,Nn),Nn|=r}else i!==null?(r=i.baseLanes|n,e.memoizedState=null):r=n,st(Uo,Nn),Nn|=r;return fn(t,e,s,n),e.child}function sx(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function fm(t,e,n,r,s){var i=Cn(n)?Vi:dn.current;return i=ra(e,i),Wo(e,s),n=Bg(t,e,n,r,i,s),r=zg(),t!==null&&!xn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,Qr(t,e,s)):(dt&&r&&Pg(e),e.flags|=1,fn(t,e,n,s),e.child)}function gw(t,e,n,r,s){if(Cn(n)){var i=!0;wd(e)}else i=!1;if(Wo(e,s),e.stateNode===null)Bu(t,e),Z0(e,n,r),dm(e,n,r,s),r=!0;else if(t===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var l=o.context,d=n.contextType;typeof d=="object"&&d!==null?d=Qn(d):(d=Cn(n)?Vi:dn.current,d=ra(e,d));var h=n.getDerivedStateFromProps,f=typeof h=="function"||typeof o.getSnapshotBeforeUpdate=="function";f||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==r||l!==d)&&uw(e,o,r,d),_s=!1;var m=e.memoizedState;o.state=m,Sd(e,r,o,s),l=e.memoizedState,a!==r||m!==l||bn.current||_s?(typeof h=="function"&&(um(e,n,h,r),l=e.memoizedState),(a=_s||cw(e,n,a,r,m,l,d))?(f||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=l),o.props=r,o.state=l,o.context=d,r=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,k0(t,e),a=e.memoizedProps,d=e.type===e.elementType?a:tr(e.type,a),o.props=d,f=e.pendingProps,m=o.context,l=n.contextType,typeof l=="object"&&l!==null?l=Qn(l):(l=Cn(n)?Vi:dn.current,l=ra(e,l));var v=n.getDerivedStateFromProps;(h=typeof v=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==f||m!==l)&&uw(e,o,r,l),_s=!1,m=e.memoizedState,o.state=m,Sd(e,r,o,s);var R=e.memoizedState;a!==f||m!==R||bn.current||_s?(typeof v=="function"&&(um(e,n,v,r),R=e.memoizedState),(d=_s||cw(e,n,d,r,m,R,l)||!1)?(h||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,R,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,R,l)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&m===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&m===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=R),o.props=r,o.state=R,o.context=l,r=d):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&m===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&m===t.memoizedState||(e.flags|=1024),r=!1)}return pm(t,e,n,r,i,s)}function pm(t,e,n,r,s,i){sx(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return s&&tw(e,n,!1),Qr(t,e,i);r=e.stateNode,dP.current=e;var a=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=ia(e,t.child,null,i),e.child=ia(e,null,a,i)):fn(t,e,a,i),e.memoizedState=r.state,s&&tw(e,n,!0),e.child}function ix(t){var e=t.stateNode;e.pendingContext?ew(t,e.pendingContext,e.pendingContext!==e.context):e.context&&ew(t,e.context,!1),Mg(t,e.containerInfo)}function yw(t,e,n,r,s){return sa(),kg(s),e.flags|=256,fn(t,e,n,r),e.child}var mm={dehydrated:null,treeContext:null,retryLane:0};function gm(t){return{baseLanes:t,cachePool:null,transitions:null}}function ox(t,e,n){var r=e.pendingProps,s=mt.current,i=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=t!==null&&t.memoizedState===null?!1:(s&2)!==0),a?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),st(mt,s&1),t===null)return lm(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,i?(r=e.mode,i=e.child,o={mode:"hidden",children:o},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=Th(o,r,0,null),t=Ri(t,r,n,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=gm(n),e.memoizedState=mm,t):Wg(e,o));if(s=t.memoizedState,s!==null&&(a=s.dehydrated,a!==null))return hP(t,e,o,r,a,s,n);if(i){i=r.fallback,o=e.mode,s=t.child,a=s.sibling;var l={mode:"hidden",children:r.children};return!(o&1)&&e.child!==s?(r=e.child,r.childLanes=0,r.pendingProps=l,e.deletions=null):(r=Ms(s,l),r.subtreeFlags=s.subtreeFlags&14680064),a!==null?i=Ms(a,i):(i=Ri(i,o,n,null),i.flags|=2),i.return=e,r.return=e,r.sibling=i,e.child=r,r=i,i=e.child,o=t.child.memoizedState,o=o===null?gm(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=t.childLanes&~n,e.memoizedState=mm,r}return i=t.child,t=i.sibling,r=Ms(i,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function Wg(t,e){return e=Th({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function gu(t,e,n,r){return r!==null&&kg(r),ia(e,t.child,null,n),t=Wg(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function hP(t,e,n,r,s,i,o){if(n)return e.flags&256?(e.flags&=-257,r=ep(Error(W(422))),gu(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=r.fallback,s=e.mode,r=Th({mode:"visible",children:r.children},s,0,null),i=Ri(i,s,o,null),i.flags|=2,r.return=e,i.return=e,r.sibling=i,e.child=r,e.mode&1&&ia(e,t.child,null,o),e.child.memoizedState=gm(o),e.memoizedState=mm,i);if(!(e.mode&1))return gu(t,e,o,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var a=r.dgst;return r=a,i=Error(W(419)),r=ep(i,r,void 0),gu(t,e,o,r)}if(a=(o&t.childLanes)!==0,xn||a){if(r=qt,r!==null){switch(o&-o){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|o)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,Gr(t,s),lr(r,t,s,-1))}return Jg(),r=ep(Error(W(421))),gu(t,e,o,r)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=SP.bind(null,t),s._reactRetry=e,null):(t=i.treeContext,Dn=js(s.nextSibling),On=e,dt=!0,sr=null,t!==null&&($n[Bn++]=Fr,$n[Bn++]=Ur,$n[Bn++]=Li,Fr=t.id,Ur=t.overflow,Li=e),e=Wg(e,r.children),e.flags|=4096,e)}function _w(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),cm(t.return,e,n)}function tp(t,e,n,r,s){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=s)}function ax(t,e,n){var r=e.pendingProps,s=r.revealOrder,i=r.tail;if(fn(t,e,r.children,n),r=mt.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&_w(t,n,e);else if(t.tag===19)_w(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(st(mt,r),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(n=e.child,s=null;n!==null;)t=n.alternate,t!==null&&bd(t)===null&&(s=n),n=n.sibling;n=s,n===null?(s=e.child,e.child=null):(s=n.sibling,n.sibling=null),tp(e,!1,s,n,i);break;case"backwards":for(n=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&bd(t)===null){e.child=s;break}t=s.sibling,s.sibling=n,n=s,s=t}tp(e,!0,n,null,i);break;case"together":tp(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Bu(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Qr(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),Fi|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(W(153));if(e.child!==null){for(t=e.child,n=Ms(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Ms(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function fP(t,e,n){switch(e.tag){case 3:ix(e),sa();break;case 5:D0(e);break;case 1:Cn(e.type)&&wd(e);break;case 4:Mg(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,s=e.memoizedProps.value;st(Td,r._currentValue),r._currentValue=s;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(st(mt,mt.current&1),e.flags|=128,null):n&e.child.childLanes?ox(t,e,n):(st(mt,mt.current&1),t=Qr(t,e,n),t!==null?t.sibling:null);st(mt,mt.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return ax(t,e,n);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),st(mt,mt.current),r)break;return null;case 22:case 23:return e.lanes=0,rx(t,e,n)}return Qr(t,e,n)}var lx,ym,cx,ux;lx=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};ym=function(){};cx=function(t,e,n,r){var s=t.memoizedProps;if(s!==r){t=e.stateNode,Si(Rr.current);var i=null;switch(n){case"input":s=Fp(t,s),r=Fp(t,r),i=[];break;case"select":s=_t({},s,{value:void 0}),r=_t({},r,{value:void 0}),i=[];break;case"textarea":s=Bp(t,s),r=Bp(t,r),i=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=_d)}qp(n,r);var o;n=null;for(d in s)if(!r.hasOwnProperty(d)&&s.hasOwnProperty(d)&&s[d]!=null)if(d==="style"){var a=s[d];for(o in a)a.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(ql.hasOwnProperty(d)?i||(i=[]):(i=i||[]).push(d,null));for(d in r){var l=r[d];if(a=s!=null?s[d]:void 0,r.hasOwnProperty(d)&&l!==a&&(l!=null||a!=null))if(d==="style")if(a){for(o in a)!a.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in l)l.hasOwnProperty(o)&&a[o]!==l[o]&&(n||(n={}),n[o]=l[o])}else n||(i||(i=[]),i.push(d,n)),n=l;else d==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(i=i||[]).push(d,l)):d==="children"?typeof l!="string"&&typeof l!="number"||(i=i||[]).push(d,""+l):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(ql.hasOwnProperty(d)?(l!=null&&d==="onScroll"&&at("scroll",t),i||a===l||(i=[])):(i=i||[]).push(d,l))}n&&(i=i||[]).push("style",n);var d=i;(e.updateQueue=d)&&(e.flags|=4)}};ux=function(t,e,n,r){n!==r&&(e.flags|=4)};function tl(t,e){if(!dt)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function nn(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function pP(t,e,n){var r=e.pendingProps;switch(Ng(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return nn(e),null;case 1:return Cn(e.type)&&vd(),nn(e),null;case 3:return r=e.stateNode,oa(),lt(bn),lt(dn),Ug(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(pu(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,sr!==null&&(Sm(sr),sr=null))),ym(t,e),nn(e),null;case 5:Fg(e);var s=Si(nc.current);if(n=e.type,t!==null&&e.stateNode!=null)cx(t,e,n,r,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(W(166));return nn(e),null}if(t=Si(Rr.current),pu(e)){r=e.stateNode,n=e.type;var i=e.memoizedProps;switch(r[xr]=e,r[ec]=i,t=(e.mode&1)!==0,n){case"dialog":at("cancel",r),at("close",r);break;case"iframe":case"object":case"embed":at("load",r);break;case"video":case"audio":for(s=0;s<pl.length;s++)at(pl[s],r);break;case"source":at("error",r);break;case"img":case"image":case"link":at("error",r),at("load",r);break;case"details":at("toggle",r);break;case"input":Cv(r,i),at("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},at("invalid",r);break;case"textarea":Rv(r,i),at("invalid",r)}qp(n,i),s=null;for(var o in i)if(i.hasOwnProperty(o)){var a=i[o];o==="children"?typeof a=="string"?r.textContent!==a&&(i.suppressHydrationWarning!==!0&&fu(r.textContent,a,t),s=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(i.suppressHydrationWarning!==!0&&fu(r.textContent,a,t),s=["children",""+a]):ql.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&at("scroll",r)}switch(n){case"input":iu(r),Av(r,i,!0);break;case"textarea":iu(r),Pv(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=_d)}r=s,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=MT(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[xr]=e,t[ec]=r,lx(t,e,!1,!1),e.stateNode=t;e:{switch(o=Hp(n,r),n){case"dialog":at("cancel",t),at("close",t),s=r;break;case"iframe":case"object":case"embed":at("load",t),s=r;break;case"video":case"audio":for(s=0;s<pl.length;s++)at(pl[s],t);s=r;break;case"source":at("error",t),s=r;break;case"img":case"image":case"link":at("error",t),at("load",t),s=r;break;case"details":at("toggle",t),s=r;break;case"input":Cv(t,r),s=Fp(t,r),at("invalid",t);break;case"option":s=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},s=_t({},r,{value:void 0}),at("invalid",t);break;case"textarea":Rv(t,r),s=Bp(t,r),at("invalid",t);break;default:s=r}qp(n,s),a=s;for(i in a)if(a.hasOwnProperty(i)){var l=a[i];i==="style"?$T(t,l):i==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&FT(t,l)):i==="children"?typeof l=="string"?(n!=="textarea"||l!=="")&&Hl(t,l):typeof l=="number"&&Hl(t,""+l):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(ql.hasOwnProperty(i)?l!=null&&i==="onScroll"&&at("scroll",t):l!=null&&gg(t,i,l,o))}switch(n){case"input":iu(t),Av(t,r,!1);break;case"textarea":iu(t),Pv(t);break;case"option":r.value!=null&&t.setAttribute("value",""+Hs(r.value));break;case"select":t.multiple=!!r.multiple,i=r.value,i!=null?Bo(t,!!r.multiple,i,!1):r.defaultValue!=null&&Bo(t,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=_d)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return nn(e),null;case 6:if(t&&e.stateNode!=null)ux(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(W(166));if(n=Si(nc.current),Si(Rr.current),pu(e)){if(r=e.stateNode,n=e.memoizedProps,r[xr]=e,(i=r.nodeValue!==n)&&(t=On,t!==null))switch(t.tag){case 3:fu(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&fu(r.nodeValue,n,(t.mode&1)!==0)}i&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[xr]=e,e.stateNode=r}return nn(e),null;case 13:if(lt(mt),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(dt&&Dn!==null&&e.mode&1&&!(e.flags&128))A0(),sa(),e.flags|=98560,i=!1;else if(i=pu(e),r!==null&&r.dehydrated!==null){if(t===null){if(!i)throw Error(W(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(W(317));i[xr]=e}else sa(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;nn(e),i=!1}else sr!==null&&(Sm(sr),sr=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||mt.current&1?jt===0&&(jt=3):Jg())),e.updateQueue!==null&&(e.flags|=4),nn(e),null);case 4:return oa(),ym(t,e),t===null&&Jl(e.stateNode.containerInfo),nn(e),null;case 10:return Og(e.type._context),nn(e),null;case 17:return Cn(e.type)&&vd(),nn(e),null;case 19:if(lt(mt),i=e.memoizedState,i===null)return nn(e),null;if(r=(e.flags&128)!==0,o=i.rendering,o===null)if(r)tl(i,!1);else{if(jt!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=bd(t),o!==null){for(e.flags|=128,tl(i,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)i=n,t=r,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,t=o.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return st(mt,mt.current&1|2),e.child}t=t.sibling}i.tail!==null&&bt()>la&&(e.flags|=128,r=!0,tl(i,!1),e.lanes=4194304)}else{if(!r)if(t=bd(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),tl(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!dt)return nn(e),null}else 2*bt()-i.renderingStartTime>la&&n!==1073741824&&(e.flags|=128,r=!0,tl(i,!1),e.lanes=4194304);i.isBackwards?(o.sibling=e.child,e.child=o):(n=i.last,n!==null?n.sibling=o:e.child=o,i.last=o)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=bt(),e.sibling=null,n=mt.current,st(mt,r?n&1|2:n&1),e):(nn(e),null);case 22:case 23:return Xg(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?Nn&1073741824&&(nn(e),e.subtreeFlags&6&&(e.flags|=8192)):nn(e),null;case 24:return null;case 25:return null}throw Error(W(156,e.tag))}function mP(t,e){switch(Ng(e),e.tag){case 1:return Cn(e.type)&&vd(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return oa(),lt(bn),lt(dn),Ug(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return Fg(e),null;case 13:if(lt(mt),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(W(340));sa()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return lt(mt),null;case 4:return oa(),null;case 10:return Og(e.type._context),null;case 22:case 23:return Xg(),null;case 24:return null;default:return null}}var yu=!1,on=!1,gP=typeof WeakSet=="function"?WeakSet:Set,oe=null;function Fo(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Et(t,e,r)}else n.current=null}function _m(t,e,n){try{n()}catch(r){Et(t,e,r)}}var vw=!1;function yP(t,e){if(tm=md,t=m0(),Rg(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var o=0,a=-1,l=-1,d=0,h=0,f=t,m=null;t:for(;;){for(var v;f!==n||s!==0&&f.nodeType!==3||(a=o+s),f!==i||r!==0&&f.nodeType!==3||(l=o+r),f.nodeType===3&&(o+=f.nodeValue.length),(v=f.firstChild)!==null;)m=f,f=v;for(;;){if(f===t)break t;if(m===n&&++d===s&&(a=o),m===i&&++h===r&&(l=o),(v=f.nextSibling)!==null)break;f=m,m=f.parentNode}f=v}n=a===-1||l===-1?null:{start:a,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(nm={focusedElem:t,selectionRange:n},md=!1,oe=e;oe!==null;)if(e=oe,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,oe=t;else for(;oe!==null;){e=oe;try{var R=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(R!==null){var b=R.memoizedProps,A=R.memoizedState,I=e.stateNode,w=I.getSnapshotBeforeUpdate(e.elementType===e.type?b:tr(e.type,b),A);I.__reactInternalSnapshotBeforeUpdate=w}break;case 3:var y=e.stateNode.containerInfo;y.nodeType===1?y.textContent="":y.nodeType===9&&y.documentElement&&y.removeChild(y.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(W(163))}}catch(j){Et(e,e.return,j)}if(t=e.sibling,t!==null){t.return=e.return,oe=t;break}oe=e.return}return R=vw,vw=!1,R}function Pl(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&t)===t){var i=s.destroy;s.destroy=void 0,i!==void 0&&_m(e,n,i)}s=s.next}while(s!==r)}}function Eh(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function vm(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function dx(t){var e=t.alternate;e!==null&&(t.alternate=null,dx(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[xr],delete e[ec],delete e[im],delete e[Z1],delete e[eP])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function hx(t){return t.tag===5||t.tag===3||t.tag===4}function ww(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||hx(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function wm(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=_d));else if(r!==4&&(t=t.child,t!==null))for(wm(t,e,n),t=t.sibling;t!==null;)wm(t,e,n),t=t.sibling}function Em(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(Em(t,e,n),t=t.sibling;t!==null;)Em(t,e,n),t=t.sibling}var Kt=null,nr=!1;function hs(t,e,n){for(n=n.child;n!==null;)fx(t,e,n),n=n.sibling}function fx(t,e,n){if(Ar&&typeof Ar.onCommitFiberUnmount=="function")try{Ar.onCommitFiberUnmount(fh,n)}catch{}switch(n.tag){case 5:on||Fo(n,e);case 6:var r=Kt,s=nr;Kt=null,hs(t,e,n),Kt=r,nr=s,Kt!==null&&(nr?(t=Kt,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Kt.removeChild(n.stateNode));break;case 18:Kt!==null&&(nr?(t=Kt,n=n.stateNode,t.nodeType===8?Gf(t.parentNode,n):t.nodeType===1&&Gf(t,n),Ql(t)):Gf(Kt,n.stateNode));break;case 4:r=Kt,s=nr,Kt=n.stateNode.containerInfo,nr=!0,hs(t,e,n),Kt=r,nr=s;break;case 0:case 11:case 14:case 15:if(!on&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var i=s,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&_m(n,e,o),s=s.next}while(s!==r)}hs(t,e,n);break;case 1:if(!on&&(Fo(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(a){Et(n,e,a)}hs(t,e,n);break;case 21:hs(t,e,n);break;case 22:n.mode&1?(on=(r=on)||n.memoizedState!==null,hs(t,e,n),on=r):hs(t,e,n);break;default:hs(t,e,n)}}function Ew(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new gP),e.forEach(function(r){var s=bP.bind(null,t,r);n.has(r)||(n.add(r),r.then(s,s))})}}function er(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var i=t,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:Kt=a.stateNode,nr=!1;break e;case 3:Kt=a.stateNode.containerInfo,nr=!0;break e;case 4:Kt=a.stateNode.containerInfo,nr=!0;break e}a=a.return}if(Kt===null)throw Error(W(160));fx(i,o,s),Kt=null,nr=!1;var l=s.alternate;l!==null&&(l.return=null),s.return=null}catch(d){Et(s,e,d)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)px(e,t),e=e.sibling}function px(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(er(e,t),vr(t),r&4){try{Pl(3,t,t.return),Eh(3,t)}catch(b){Et(t,t.return,b)}try{Pl(5,t,t.return)}catch(b){Et(t,t.return,b)}}break;case 1:er(e,t),vr(t),r&512&&n!==null&&Fo(n,n.return);break;case 5:if(er(e,t),vr(t),r&512&&n!==null&&Fo(n,n.return),t.flags&32){var s=t.stateNode;try{Hl(s,"")}catch(b){Et(t,t.return,b)}}if(r&4&&(s=t.stateNode,s!=null)){var i=t.memoizedProps,o=n!==null?n.memoizedProps:i,a=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{a==="input"&&i.type==="radio"&&i.name!=null&&VT(s,i),Hp(a,o);var d=Hp(a,i);for(o=0;o<l.length;o+=2){var h=l[o],f=l[o+1];h==="style"?$T(s,f):h==="dangerouslySetInnerHTML"?FT(s,f):h==="children"?Hl(s,f):gg(s,h,f,d)}switch(a){case"input":Up(s,i);break;case"textarea":LT(s,i);break;case"select":var m=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var v=i.value;v!=null?Bo(s,!!i.multiple,v,!1):m!==!!i.multiple&&(i.defaultValue!=null?Bo(s,!!i.multiple,i.defaultValue,!0):Bo(s,!!i.multiple,i.multiple?[]:"",!1))}s[ec]=i}catch(b){Et(t,t.return,b)}}break;case 6:if(er(e,t),vr(t),r&4){if(t.stateNode===null)throw Error(W(162));s=t.stateNode,i=t.memoizedProps;try{s.nodeValue=i}catch(b){Et(t,t.return,b)}}break;case 3:if(er(e,t),vr(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Ql(e.containerInfo)}catch(b){Et(t,t.return,b)}break;case 4:er(e,t),vr(t);break;case 13:er(e,t),vr(t),s=t.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(Qg=bt())),r&4&&Ew(t);break;case 22:if(h=n!==null&&n.memoizedState!==null,t.mode&1?(on=(d=on)||h,er(e,t),on=d):er(e,t),vr(t),r&8192){if(d=t.memoizedState!==null,(t.stateNode.isHidden=d)&&!h&&t.mode&1)for(oe=t,h=t.child;h!==null;){for(f=oe=h;oe!==null;){switch(m=oe,v=m.child,m.tag){case 0:case 11:case 14:case 15:Pl(4,m,m.return);break;case 1:Fo(m,m.return);var R=m.stateNode;if(typeof R.componentWillUnmount=="function"){r=m,n=m.return;try{e=r,R.props=e.memoizedProps,R.state=e.memoizedState,R.componentWillUnmount()}catch(b){Et(r,n,b)}}break;case 5:Fo(m,m.return);break;case 22:if(m.memoizedState!==null){Tw(f);continue}}v!==null?(v.return=m,oe=v):Tw(f)}h=h.sibling}e:for(h=null,f=t;;){if(f.tag===5){if(h===null){h=f;try{s=f.stateNode,d?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(a=f.stateNode,l=f.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=UT("display",o))}catch(b){Et(t,t.return,b)}}}else if(f.tag===6){if(h===null)try{f.stateNode.nodeValue=d?"":f.memoizedProps}catch(b){Et(t,t.return,b)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===t)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===t)break e;for(;f.sibling===null;){if(f.return===null||f.return===t)break e;h===f&&(h=null),f=f.return}h===f&&(h=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:er(e,t),vr(t),r&4&&Ew(t);break;case 21:break;default:er(e,t),vr(t)}}function vr(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(hx(n)){var r=n;break e}n=n.return}throw Error(W(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(Hl(s,""),r.flags&=-33);var i=ww(t);Em(t,i,s);break;case 3:case 4:var o=r.stateNode.containerInfo,a=ww(t);wm(t,a,o);break;default:throw Error(W(161))}}catch(l){Et(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function _P(t,e,n){oe=t,mx(t)}function mx(t,e,n){for(var r=(t.mode&1)!==0;oe!==null;){var s=oe,i=s.child;if(s.tag===22&&r){var o=s.memoizedState!==null||yu;if(!o){var a=s.alternate,l=a!==null&&a.memoizedState!==null||on;a=yu;var d=on;if(yu=o,(on=l)&&!d)for(oe=s;oe!==null;)o=oe,l=o.child,o.tag===22&&o.memoizedState!==null?xw(s):l!==null?(l.return=o,oe=l):xw(s);for(;i!==null;)oe=i,mx(i),i=i.sibling;oe=s,yu=a,on=d}Iw(t)}else s.subtreeFlags&8772&&i!==null?(i.return=s,oe=i):Iw(t)}}function Iw(t){for(;oe!==null;){var e=oe;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:on||Eh(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!on)if(n===null)r.componentDidMount();else{var s=e.elementType===e.type?n.memoizedProps:tr(e.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&ow(e,i,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}ow(e,o,n)}break;case 5:var a=e.stateNode;if(n===null&&e.flags&4){n=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var d=e.alternate;if(d!==null){var h=d.memoizedState;if(h!==null){var f=h.dehydrated;f!==null&&Ql(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(W(163))}on||e.flags&512&&vm(e)}catch(m){Et(e,e.return,m)}}if(e===t){oe=null;break}if(n=e.sibling,n!==null){n.return=e.return,oe=n;break}oe=e.return}}function Tw(t){for(;oe!==null;){var e=oe;if(e===t){oe=null;break}var n=e.sibling;if(n!==null){n.return=e.return,oe=n;break}oe=e.return}}function xw(t){for(;oe!==null;){var e=oe;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{Eh(4,e)}catch(l){Et(e,n,l)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var s=e.return;try{r.componentDidMount()}catch(l){Et(e,s,l)}}var i=e.return;try{vm(e)}catch(l){Et(e,i,l)}break;case 5:var o=e.return;try{vm(e)}catch(l){Et(e,o,l)}}}catch(l){Et(e,e.return,l)}if(e===t){oe=null;break}var a=e.sibling;if(a!==null){a.return=e.return,oe=a;break}oe=e.return}}var vP=Math.ceil,Rd=ns.ReactCurrentDispatcher,Kg=ns.ReactCurrentOwner,Kn=ns.ReactCurrentBatchConfig,ze=0,qt=null,At=null,Jt=0,Nn=0,Uo=Zs(0),jt=0,oc=null,Fi=0,Ih=0,Gg=0,Nl=null,Tn=null,Qg=0,la=1/0,Lr=null,Pd=!1,Im=null,Vs=null,_u=!1,Rs=null,Nd=0,kl=0,Tm=null,zu=-1,qu=0;function gn(){return ze&6?bt():zu!==-1?zu:zu=bt()}function Ls(t){return t.mode&1?ze&2&&Jt!==0?Jt&-Jt:nP.transition!==null?(qu===0&&(qu=ZT()),qu):(t=et,t!==0||(t=window.event,t=t===void 0?16:o0(t.type)),t):1}function lr(t,e,n,r){if(50<kl)throw kl=0,Tm=null,Error(W(185));Tc(t,n,r),(!(ze&2)||t!==qt)&&(t===qt&&(!(ze&2)&&(Ih|=n),jt===4&&ws(t,Jt)),An(t,r),n===1&&ze===0&&!(e.mode&1)&&(la=bt()+500,_h&&ei()))}function An(t,e){var n=t.callbackNode;n1(t,e);var r=pd(t,t===qt?Jt:0);if(r===0)n!==null&&Dv(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&Dv(n),e===1)t.tag===0?tP(Sw.bind(null,t)):S0(Sw.bind(null,t)),X1(function(){!(ze&6)&&ei()}),n=null;else{switch(e0(r)){case 1:n=Eg;break;case 4:n=XT;break;case 16:n=fd;break;case 536870912:n=JT;break;default:n=fd}n=Tx(n,gx.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function gx(t,e){if(zu=-1,qu=0,ze&6)throw Error(W(327));var n=t.callbackNode;if(Ko()&&t.callbackNode!==n)return null;var r=pd(t,t===qt?Jt:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=kd(t,r);else{e=r;var s=ze;ze|=2;var i=_x();(qt!==t||Jt!==e)&&(Lr=null,la=bt()+500,Ai(t,e));do try{IP();break}catch(a){yx(t,a)}while(!0);jg(),Rd.current=i,ze=s,At!==null?e=0:(qt=null,Jt=0,e=jt)}if(e!==0){if(e===2&&(s=Yp(t),s!==0&&(r=s,e=xm(t,s))),e===1)throw n=oc,Ai(t,0),ws(t,r),An(t,bt()),n;if(e===6)ws(t,r);else{if(s=t.current.alternate,!(r&30)&&!wP(s)&&(e=kd(t,r),e===2&&(i=Yp(t),i!==0&&(r=i,e=xm(t,i))),e===1))throw n=oc,Ai(t,0),ws(t,r),An(t,bt()),n;switch(t.finishedWork=s,t.finishedLanes=r,e){case 0:case 1:throw Error(W(345));case 2:pi(t,Tn,Lr);break;case 3:if(ws(t,r),(r&130023424)===r&&(e=Qg+500-bt(),10<e)){if(pd(t,0)!==0)break;if(s=t.suspendedLanes,(s&r)!==r){gn(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=sm(pi.bind(null,t,Tn,Lr),e);break}pi(t,Tn,Lr);break;case 4:if(ws(t,r),(r&4194240)===r)break;for(e=t.eventTimes,s=-1;0<r;){var o=31-ar(r);i=1<<o,o=e[o],o>s&&(s=o),r&=~i}if(r=s,r=bt()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*vP(r/1960))-r,10<r){t.timeoutHandle=sm(pi.bind(null,t,Tn,Lr),r);break}pi(t,Tn,Lr);break;case 5:pi(t,Tn,Lr);break;default:throw Error(W(329))}}}return An(t,bt()),t.callbackNode===n?gx.bind(null,t):null}function xm(t,e){var n=Nl;return t.current.memoizedState.isDehydrated&&(Ai(t,e).flags|=256),t=kd(t,e),t!==2&&(e=Tn,Tn=n,e!==null&&Sm(e)),t}function Sm(t){Tn===null?Tn=t:Tn.push.apply(Tn,t)}function wP(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],i=s.getSnapshot;s=s.value;try{if(!ur(i(),s))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function ws(t,e){for(e&=~Gg,e&=~Ih,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-ar(e),r=1<<n;t[n]=-1,e&=~r}}function Sw(t){if(ze&6)throw Error(W(327));Ko();var e=pd(t,0);if(!(e&1))return An(t,bt()),null;var n=kd(t,e);if(t.tag!==0&&n===2){var r=Yp(t);r!==0&&(e=r,n=xm(t,r))}if(n===1)throw n=oc,Ai(t,0),ws(t,e),An(t,bt()),n;if(n===6)throw Error(W(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,pi(t,Tn,Lr),An(t,bt()),null}function Yg(t,e){var n=ze;ze|=1;try{return t(e)}finally{ze=n,ze===0&&(la=bt()+500,_h&&ei())}}function Ui(t){Rs!==null&&Rs.tag===0&&!(ze&6)&&Ko();var e=ze;ze|=1;var n=Kn.transition,r=et;try{if(Kn.transition=null,et=1,t)return t()}finally{et=r,Kn.transition=n,ze=e,!(ze&6)&&ei()}}function Xg(){Nn=Uo.current,lt(Uo)}function Ai(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,Y1(n)),At!==null)for(n=At.return;n!==null;){var r=n;switch(Ng(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&vd();break;case 3:oa(),lt(bn),lt(dn),Ug();break;case 5:Fg(r);break;case 4:oa();break;case 13:lt(mt);break;case 19:lt(mt);break;case 10:Og(r.type._context);break;case 22:case 23:Xg()}n=n.return}if(qt=t,At=t=Ms(t.current,null),Jt=Nn=e,jt=0,oc=null,Gg=Ih=Fi=0,Tn=Nl=null,xi!==null){for(e=0;e<xi.length;e++)if(n=xi[e],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,i=n.pending;if(i!==null){var o=i.next;i.next=s,r.next=o}n.pending=r}xi=null}return t}function yx(t,e){do{var n=At;try{if(jg(),Uu.current=Ad,Cd){for(var r=yt.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}Cd=!1}if(Mi=0,Bt=Dt=yt=null,Rl=!1,rc=0,Kg.current=null,n===null||n.return===null){jt=1,oc=e,At=null;break}e:{var i=t,o=n.return,a=n,l=e;if(e=Jt,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var d=l,h=a,f=h.tag;if(!(h.mode&1)&&(f===0||f===11||f===15)){var m=h.alternate;m?(h.updateQueue=m.updateQueue,h.memoizedState=m.memoizedState,h.lanes=m.lanes):(h.updateQueue=null,h.memoizedState=null)}var v=hw(o);if(v!==null){v.flags&=-257,fw(v,o,a,i,e),v.mode&1&&dw(i,d,e),e=v,l=d;var R=e.updateQueue;if(R===null){var b=new Set;b.add(l),e.updateQueue=b}else R.add(l);break e}else{if(!(e&1)){dw(i,d,e),Jg();break e}l=Error(W(426))}}else if(dt&&a.mode&1){var A=hw(o);if(A!==null){!(A.flags&65536)&&(A.flags|=256),fw(A,o,a,i,e),kg(aa(l,a));break e}}i=l=aa(l,a),jt!==4&&(jt=2),Nl===null?Nl=[i]:Nl.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var I=ex(i,l,e);iw(i,I);break e;case 1:a=l;var w=i.type,y=i.stateNode;if(!(i.flags&128)&&(typeof w.getDerivedStateFromError=="function"||y!==null&&typeof y.componentDidCatch=="function"&&(Vs===null||!Vs.has(y)))){i.flags|=65536,e&=-e,i.lanes|=e;var j=tx(i,a,e);iw(i,j);break e}}i=i.return}while(i!==null)}wx(n)}catch(V){e=V,At===n&&n!==null&&(At=n=n.return);continue}break}while(!0)}function _x(){var t=Rd.current;return Rd.current=Ad,t===null?Ad:t}function Jg(){(jt===0||jt===3||jt===2)&&(jt=4),qt===null||!(Fi&268435455)&&!(Ih&268435455)||ws(qt,Jt)}function kd(t,e){var n=ze;ze|=2;var r=_x();(qt!==t||Jt!==e)&&(Lr=null,Ai(t,e));do try{EP();break}catch(s){yx(t,s)}while(!0);if(jg(),ze=n,Rd.current=r,At!==null)throw Error(W(261));return qt=null,Jt=0,jt}function EP(){for(;At!==null;)vx(At)}function IP(){for(;At!==null&&!KR();)vx(At)}function vx(t){var e=Ix(t.alternate,t,Nn);t.memoizedProps=t.pendingProps,e===null?wx(t):At=e,Kg.current=null}function wx(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=mP(n,e),n!==null){n.flags&=32767,At=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{jt=6,At=null;return}}else if(n=pP(n,e,Nn),n!==null){At=n;return}if(e=e.sibling,e!==null){At=e;return}At=e=t}while(e!==null);jt===0&&(jt=5)}function pi(t,e,n){var r=et,s=Kn.transition;try{Kn.transition=null,et=1,TP(t,e,n,r)}finally{Kn.transition=s,et=r}return null}function TP(t,e,n,r){do Ko();while(Rs!==null);if(ze&6)throw Error(W(327));n=t.finishedWork;var s=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(W(177));t.callbackNode=null,t.callbackPriority=0;var i=n.lanes|n.childLanes;if(r1(t,i),t===qt&&(At=qt=null,Jt=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||_u||(_u=!0,Tx(fd,function(){return Ko(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=Kn.transition,Kn.transition=null;var o=et;et=1;var a=ze;ze|=4,Kg.current=null,yP(t,n),px(n,t),z1(nm),md=!!tm,nm=tm=null,t.current=n,_P(n),GR(),ze=a,et=o,Kn.transition=i}else t.current=n;if(_u&&(_u=!1,Rs=t,Nd=s),i=t.pendingLanes,i===0&&(Vs=null),XR(n.stateNode),An(t,bt()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)s=e[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(Pd)throw Pd=!1,t=Im,Im=null,t;return Nd&1&&t.tag!==0&&Ko(),i=t.pendingLanes,i&1?t===Tm?kl++:(kl=0,Tm=t):kl=0,ei(),null}function Ko(){if(Rs!==null){var t=e0(Nd),e=Kn.transition,n=et;try{if(Kn.transition=null,et=16>t?16:t,Rs===null)var r=!1;else{if(t=Rs,Rs=null,Nd=0,ze&6)throw Error(W(331));var s=ze;for(ze|=4,oe=t.current;oe!==null;){var i=oe,o=i.child;if(oe.flags&16){var a=i.deletions;if(a!==null){for(var l=0;l<a.length;l++){var d=a[l];for(oe=d;oe!==null;){var h=oe;switch(h.tag){case 0:case 11:case 15:Pl(8,h,i)}var f=h.child;if(f!==null)f.return=h,oe=f;else for(;oe!==null;){h=oe;var m=h.sibling,v=h.return;if(dx(h),h===d){oe=null;break}if(m!==null){m.return=v,oe=m;break}oe=v}}}var R=i.alternate;if(R!==null){var b=R.child;if(b!==null){R.child=null;do{var A=b.sibling;b.sibling=null,b=A}while(b!==null)}}oe=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,oe=o;else e:for(;oe!==null;){if(i=oe,i.flags&2048)switch(i.tag){case 0:case 11:case 15:Pl(9,i,i.return)}var I=i.sibling;if(I!==null){I.return=i.return,oe=I;break e}oe=i.return}}var w=t.current;for(oe=w;oe!==null;){o=oe;var y=o.child;if(o.subtreeFlags&2064&&y!==null)y.return=o,oe=y;else e:for(o=w;oe!==null;){if(a=oe,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:Eh(9,a)}}catch(V){Et(a,a.return,V)}if(a===o){oe=null;break e}var j=a.sibling;if(j!==null){j.return=a.return,oe=j;break e}oe=a.return}}if(ze=s,ei(),Ar&&typeof Ar.onPostCommitFiberRoot=="function")try{Ar.onPostCommitFiberRoot(fh,t)}catch{}r=!0}return r}finally{et=n,Kn.transition=e}}return!1}function bw(t,e,n){e=aa(n,e),e=ex(t,e,1),t=Os(t,e,1),e=gn(),t!==null&&(Tc(t,1,e),An(t,e))}function Et(t,e,n){if(t.tag===3)bw(t,t,n);else for(;e!==null;){if(e.tag===3){bw(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Vs===null||!Vs.has(r))){t=aa(n,t),t=tx(e,t,1),e=Os(e,t,1),t=gn(),e!==null&&(Tc(e,1,t),An(e,t));break}}e=e.return}}function xP(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=gn(),t.pingedLanes|=t.suspendedLanes&n,qt===t&&(Jt&n)===n&&(jt===4||jt===3&&(Jt&130023424)===Jt&&500>bt()-Qg?Ai(t,0):Gg|=n),An(t,e)}function Ex(t,e){e===0&&(t.mode&1?(e=lu,lu<<=1,!(lu&130023424)&&(lu=4194304)):e=1);var n=gn();t=Gr(t,e),t!==null&&(Tc(t,e,n),An(t,n))}function SP(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),Ex(t,n)}function bP(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,s=t.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(W(314))}r!==null&&r.delete(e),Ex(t,n)}var Ix;Ix=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||bn.current)xn=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return xn=!1,fP(t,e,n);xn=!!(t.flags&131072)}else xn=!1,dt&&e.flags&1048576&&b0(e,Id,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;Bu(t,e),t=e.pendingProps;var s=ra(e,dn.current);Wo(e,n),s=Bg(null,e,r,t,s,n);var i=zg();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Cn(r)?(i=!0,wd(e)):i=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,Lg(e),s.updater=wh,e.stateNode=s,s._reactInternals=e,dm(e,r,t,n),e=pm(null,e,r,!0,i,n)):(e.tag=0,dt&&i&&Pg(e),fn(null,e,s,n),e=e.child),e;case 16:r=e.elementType;e:{switch(Bu(t,e),t=e.pendingProps,s=r._init,r=s(r._payload),e.type=r,s=e.tag=AP(r),t=tr(r,t),s){case 0:e=fm(null,e,r,t,n);break e;case 1:e=gw(null,e,r,t,n);break e;case 11:e=pw(null,e,r,t,n);break e;case 14:e=mw(null,e,r,tr(r.type,t),n);break e}throw Error(W(306,r,""))}return e;case 0:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:tr(r,s),fm(t,e,r,s,n);case 1:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:tr(r,s),gw(t,e,r,s,n);case 3:e:{if(ix(e),t===null)throw Error(W(387));r=e.pendingProps,i=e.memoizedState,s=i.element,k0(t,e),Sd(e,r,null,n);var o=e.memoizedState;if(r=o.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){s=aa(Error(W(423)),e),e=yw(t,e,r,n,s);break e}else if(r!==s){s=aa(Error(W(424)),e),e=yw(t,e,r,n,s);break e}else for(Dn=js(e.stateNode.containerInfo.firstChild),On=e,dt=!0,sr=null,n=P0(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(sa(),r===s){e=Qr(t,e,n);break e}fn(t,e,r,n)}e=e.child}return e;case 5:return D0(e),t===null&&lm(e),r=e.type,s=e.pendingProps,i=t!==null?t.memoizedProps:null,o=s.children,rm(r,s)?o=null:i!==null&&rm(r,i)&&(e.flags|=32),sx(t,e),fn(t,e,o,n),e.child;case 6:return t===null&&lm(e),null;case 13:return ox(t,e,n);case 4:return Mg(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=ia(e,null,r,n):fn(t,e,r,n),e.child;case 11:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:tr(r,s),pw(t,e,r,s,n);case 7:return fn(t,e,e.pendingProps,n),e.child;case 8:return fn(t,e,e.pendingProps.children,n),e.child;case 12:return fn(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,s=e.pendingProps,i=e.memoizedProps,o=s.value,st(Td,r._currentValue),r._currentValue=o,i!==null)if(ur(i.value,o)){if(i.children===s.children&&!bn.current){e=Qr(t,e,n);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var a=i.dependencies;if(a!==null){o=i.child;for(var l=a.firstContext;l!==null;){if(l.context===r){if(i.tag===1){l=qr(-1,n&-n),l.tag=2;var d=i.updateQueue;if(d!==null){d=d.shared;var h=d.pending;h===null?l.next=l:(l.next=h.next,h.next=l),d.pending=l}}i.lanes|=n,l=i.alternate,l!==null&&(l.lanes|=n),cm(i.return,n,e),a.lanes|=n;break}l=l.next}}else if(i.tag===10)o=i.type===e.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(W(341));o.lanes|=n,a=o.alternate,a!==null&&(a.lanes|=n),cm(o,n,e),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===e){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}fn(t,e,s.children,n),e=e.child}return e;case 9:return s=e.type,r=e.pendingProps.children,Wo(e,n),s=Qn(s),r=r(s),e.flags|=1,fn(t,e,r,n),e.child;case 14:return r=e.type,s=tr(r,e.pendingProps),s=tr(r.type,s),mw(t,e,r,s,n);case 15:return nx(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:tr(r,s),Bu(t,e),e.tag=1,Cn(r)?(t=!0,wd(e)):t=!1,Wo(e,n),Z0(e,r,s),dm(e,r,s,n),pm(null,e,r,!0,t,n);case 19:return ax(t,e,n);case 22:return rx(t,e,n)}throw Error(W(156,e.tag))};function Tx(t,e){return YT(t,e)}function CP(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Hn(t,e,n,r){return new CP(t,e,n,r)}function Zg(t){return t=t.prototype,!(!t||!t.isReactComponent)}function AP(t){if(typeof t=="function")return Zg(t)?1:0;if(t!=null){if(t=t.$$typeof,t===_g)return 11;if(t===vg)return 14}return 2}function Ms(t,e){var n=t.alternate;return n===null?(n=Hn(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Hu(t,e,n,r,s,i){var o=2;if(r=t,typeof t=="function")Zg(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case Po:return Ri(n.children,s,i,e);case yg:o=8,s|=8;break;case Op:return t=Hn(12,n,e,s|2),t.elementType=Op,t.lanes=i,t;case Vp:return t=Hn(13,n,e,s),t.elementType=Vp,t.lanes=i,t;case Lp:return t=Hn(19,n,e,s),t.elementType=Lp,t.lanes=i,t;case DT:return Th(n,s,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case NT:o=10;break e;case kT:o=9;break e;case _g:o=11;break e;case vg:o=14;break e;case ys:o=16,r=null;break e}throw Error(W(130,t==null?t:typeof t,""))}return e=Hn(o,n,e,s),e.elementType=t,e.type=r,e.lanes=i,e}function Ri(t,e,n,r){return t=Hn(7,t,r,e),t.lanes=n,t}function Th(t,e,n,r){return t=Hn(22,t,r,e),t.elementType=DT,t.lanes=n,t.stateNode={isHidden:!1},t}function np(t,e,n){return t=Hn(6,t,null,e),t.lanes=n,t}function rp(t,e,n){return e=Hn(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function RP(t,e,n,r,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Lf(0),this.expirationTimes=Lf(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Lf(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function ey(t,e,n,r,s,i,o,a,l){return t=new RP(t,e,n,a,l),e===1?(e=1,i===!0&&(e|=8)):e=0,i=Hn(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Lg(i),t}function PP(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Ro,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function xx(t){if(!t)return Ws;t=t._reactInternals;e:{if(no(t)!==t||t.tag!==1)throw Error(W(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Cn(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(W(171))}if(t.tag===1){var n=t.type;if(Cn(n))return x0(t,n,e)}return e}function Sx(t,e,n,r,s,i,o,a,l){return t=ey(n,r,!0,t,s,i,o,a,l),t.context=xx(null),n=t.current,r=gn(),s=Ls(n),i=qr(r,s),i.callback=e??null,Os(n,i,s),t.current.lanes=s,Tc(t,s,r),An(t,r),t}function xh(t,e,n,r){var s=e.current,i=gn(),o=Ls(s);return n=xx(n),e.context===null?e.context=n:e.pendingContext=n,e=qr(i,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=Os(s,e,o),t!==null&&(lr(t,s,o,i),Fu(t,s,o)),o}function Dd(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function Cw(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function ty(t,e){Cw(t,e),(t=t.alternate)&&Cw(t,e)}function NP(){return null}var bx=typeof reportError=="function"?reportError:function(t){console.error(t)};function ny(t){this._internalRoot=t}Sh.prototype.render=ny.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(W(409));xh(t,e,null,null)};Sh.prototype.unmount=ny.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Ui(function(){xh(null,t,null,null)}),e[Kr]=null}};function Sh(t){this._internalRoot=t}Sh.prototype.unstable_scheduleHydration=function(t){if(t){var e=r0();t={blockedOn:null,target:t,priority:e};for(var n=0;n<vs.length&&e!==0&&e<vs[n].priority;n++);vs.splice(n,0,t),n===0&&i0(t)}};function ry(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function bh(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function Aw(){}function kP(t,e,n,r,s){if(s){if(typeof r=="function"){var i=r;r=function(){var d=Dd(o);i.call(d)}}var o=Sx(e,r,t,0,null,!1,!1,"",Aw);return t._reactRootContainer=o,t[Kr]=o.current,Jl(t.nodeType===8?t.parentNode:t),Ui(),o}for(;s=t.lastChild;)t.removeChild(s);if(typeof r=="function"){var a=r;r=function(){var d=Dd(l);a.call(d)}}var l=ey(t,0,!1,null,null,!1,!1,"",Aw);return t._reactRootContainer=l,t[Kr]=l.current,Jl(t.nodeType===8?t.parentNode:t),Ui(function(){xh(e,l,n,r)}),l}function Ch(t,e,n,r,s){var i=n._reactRootContainer;if(i){var o=i;if(typeof s=="function"){var a=s;s=function(){var l=Dd(o);a.call(l)}}xh(e,o,t,s)}else o=kP(n,e,t,s,r);return Dd(o)}t0=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=fl(e.pendingLanes);n!==0&&(Ig(e,n|1),An(e,bt()),!(ze&6)&&(la=bt()+500,ei()))}break;case 13:Ui(function(){var r=Gr(t,1);if(r!==null){var s=gn();lr(r,t,1,s)}}),ty(t,1)}};Tg=function(t){if(t.tag===13){var e=Gr(t,134217728);if(e!==null){var n=gn();lr(e,t,134217728,n)}ty(t,134217728)}};n0=function(t){if(t.tag===13){var e=Ls(t),n=Gr(t,e);if(n!==null){var r=gn();lr(n,t,e,r)}ty(t,e)}};r0=function(){return et};s0=function(t,e){var n=et;try{return et=t,e()}finally{et=n}};Kp=function(t,e,n){switch(e){case"input":if(Up(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var s=yh(r);if(!s)throw Error(W(90));OT(r),Up(r,s)}}}break;case"textarea":LT(t,n);break;case"select":e=n.value,e!=null&&Bo(t,!!n.multiple,e,!1)}};qT=Yg;HT=Ui;var DP={usingClientEntryPoint:!1,Events:[Sc,jo,yh,BT,zT,Yg]},nl={findFiberByHostInstance:Ti,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},jP={bundleType:nl.bundleType,version:nl.version,rendererPackageName:nl.rendererPackageName,rendererConfig:nl.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ns.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=GT(t),t===null?null:t.stateNode},findFiberByHostInstance:nl.findFiberByHostInstance||NP,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var vu=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!vu.isDisabled&&vu.supportsFiber)try{fh=vu.inject(jP),Ar=vu}catch{}}Fn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=DP;Fn.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!ry(e))throw Error(W(200));return PP(t,e,null,n)};Fn.createRoot=function(t,e){if(!ry(t))throw Error(W(299));var n=!1,r="",s=bx;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=ey(t,1,!1,null,null,n,!1,r,s),t[Kr]=e.current,Jl(t.nodeType===8?t.parentNode:t),new ny(e)};Fn.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(W(188)):(t=Object.keys(t).join(","),Error(W(268,t)));return t=GT(e),t=t===null?null:t.stateNode,t};Fn.flushSync=function(t){return Ui(t)};Fn.hydrate=function(t,e,n){if(!bh(e))throw Error(W(200));return Ch(null,t,e,!0,n)};Fn.hydrateRoot=function(t,e,n){if(!ry(t))throw Error(W(405));var r=n!=null&&n.hydratedSources||null,s=!1,i="",o=bx;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=Sx(e,null,t,1,n??null,s,!1,i,o),t[Kr]=e.current,Jl(t),r)for(t=0;t<r.length;t++)n=r[t],s=n._getVersion,s=s(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,s]:e.mutableSourceEagerHydrationData.push(n,s);return new Sh(e)};Fn.render=function(t,e,n){if(!bh(e))throw Error(W(200));return Ch(null,t,e,!1,n)};Fn.unmountComponentAtNode=function(t){if(!bh(t))throw Error(W(40));return t._reactRootContainer?(Ui(function(){Ch(null,null,t,!1,function(){t._reactRootContainer=null,t[Kr]=null})}),!0):!1};Fn.unstable_batchedUpdates=Yg;Fn.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!bh(n))throw Error(W(200));if(t==null||t._reactInternals===void 0)throw Error(W(38));return Ch(t,e,n,!1,r)};Fn.version="18.3.1-next-f1338f8080-20240426";function Cx(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Cx)}catch(t){console.error(t)}}Cx(),CT.exports=Fn;var OP=CT.exports,Ax,Rw=OP;Ax=Rw.createRoot,Rw.hydrateRoot;/**
 * react-router v7.9.6
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var Pw="popstate";function VP(t={}){function e(r,s){let{pathname:i,search:o,hash:a}=r.location;return bm("",{pathname:i,search:o,hash:a},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function n(r,s){return typeof s=="string"?s:ac(s)}return MP(e,n,null,t)}function ht(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function Xn(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function LP(){return Math.random().toString(36).substring(2,10)}function Nw(t,e){return{usr:t.state,key:t.key,idx:e}}function bm(t,e,n=null,r){return{pathname:typeof t=="string"?t:t.pathname,search:"",hash:"",...typeof e=="string"?ba(e):e,state:n,key:e&&e.key||r||LP()}}function ac({pathname:t="/",search:e="",hash:n=""}){return e&&e!=="?"&&(t+=e.charAt(0)==="?"?e:"?"+e),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function ba(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substring(n),t=t.substring(0,n));let r=t.indexOf("?");r>=0&&(e.search=t.substring(r),t=t.substring(0,r)),t&&(e.pathname=t)}return e}function MP(t,e,n,r={}){let{window:s=document.defaultView,v5Compat:i=!1}=r,o=s.history,a="POP",l=null,d=h();d==null&&(d=0,o.replaceState({...o.state,idx:d},""));function h(){return(o.state||{idx:null}).idx}function f(){a="POP";let A=h(),I=A==null?null:A-d;d=A,l&&l({action:a,location:b.location,delta:I})}function m(A,I){a="PUSH";let w=bm(b.location,A,I);d=h()+1;let y=Nw(w,d),j=b.createHref(w);try{o.pushState(y,"",j)}catch(V){if(V instanceof DOMException&&V.name==="DataCloneError")throw V;s.location.assign(j)}i&&l&&l({action:a,location:b.location,delta:1})}function v(A,I){a="REPLACE";let w=bm(b.location,A,I);d=h();let y=Nw(w,d),j=b.createHref(w);o.replaceState(y,"",j),i&&l&&l({action:a,location:b.location,delta:0})}function R(A){return FP(A)}let b={get action(){return a},get location(){return t(s,o)},listen(A){if(l)throw new Error("A history only accepts one active listener");return s.addEventListener(Pw,f),l=A,()=>{s.removeEventListener(Pw,f),l=null}},createHref(A){return e(s,A)},createURL:R,encodeLocation(A){let I=R(A);return{pathname:I.pathname,search:I.search,hash:I.hash}},push:m,replace:v,go(A){return o.go(A)}};return b}function FP(t,e=!1){let n="http://localhost";typeof window<"u"&&(n=window.location.origin!=="null"?window.location.origin:window.location.href),ht(n,"No window.location.(origin|href) available to create URL");let r=typeof t=="string"?t:ac(t);return r=r.replace(/ $/,"%20"),!e&&r.startsWith("//")&&(r=n+r),new URL(r,n)}function Rx(t,e,n="/"){return UP(t,e,n,!1)}function UP(t,e,n,r){let s=typeof e=="string"?ba(e):e,i=Yr(s.pathname||"/",n);if(i==null)return null;let o=Px(t);$P(o);let a=null;for(let l=0;a==null&&l<o.length;++l){let d=JP(i);a=YP(o[l],d,r)}return a}function Px(t,e=[],n=[],r="",s=!1){let i=(o,a,l=s,d)=>{let h={relativePath:d===void 0?o.path||"":d,caseSensitive:o.caseSensitive===!0,childrenIndex:a,route:o};if(h.relativePath.startsWith("/")){if(!h.relativePath.startsWith(r)&&l)return;ht(h.relativePath.startsWith(r),`Absolute route path "${h.relativePath}" nested under path "${r}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),h.relativePath=h.relativePath.slice(r.length)}let f=Hr([r,h.relativePath]),m=n.concat(h);o.children&&o.children.length>0&&(ht(o.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${f}".`),Px(o.children,e,m,f,l)),!(o.path==null&&!o.index)&&e.push({path:f,score:GP(f,o.index),routesMeta:m})};return t.forEach((o,a)=>{var l;if(o.path===""||!((l=o.path)!=null&&l.includes("?")))i(o,a);else for(let d of Nx(o.path))i(o,a,!0,d)}),e}function Nx(t){let e=t.split("/");if(e.length===0)return[];let[n,...r]=e,s=n.endsWith("?"),i=n.replace(/\?$/,"");if(r.length===0)return s?[i,""]:[i];let o=Nx(r.join("/")),a=[];return a.push(...o.map(l=>l===""?i:[i,l].join("/"))),s&&a.push(...o),a.map(l=>t.startsWith("/")&&l===""?"/":l)}function $P(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:QP(e.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}var BP=/^:[\w-]+$/,zP=3,qP=2,HP=1,WP=10,KP=-2,kw=t=>t==="*";function GP(t,e){let n=t.split("/"),r=n.length;return n.some(kw)&&(r+=KP),e&&(r+=qP),n.filter(s=>!kw(s)).reduce((s,i)=>s+(BP.test(i)?zP:i===""?HP:WP),r)}function QP(t,e){return t.length===e.length&&t.slice(0,-1).every((r,s)=>r===e[s])?t[t.length-1]-e[e.length-1]:0}function YP(t,e,n=!1){let{routesMeta:r}=t,s={},i="/",o=[];for(let a=0;a<r.length;++a){let l=r[a],d=a===r.length-1,h=i==="/"?e:e.slice(i.length)||"/",f=jd({path:l.relativePath,caseSensitive:l.caseSensitive,end:d},h),m=l.route;if(!f&&d&&n&&!r[r.length-1].route.index&&(f=jd({path:l.relativePath,caseSensitive:l.caseSensitive,end:!1},h)),!f)return null;Object.assign(s,f.params),o.push({params:s,pathname:Hr([i,f.pathname]),pathnameBase:rN(Hr([i,f.pathnameBase])),route:m}),f.pathnameBase!=="/"&&(i=Hr([i,f.pathnameBase]))}return o}function jd(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,r]=XP(t.path,t.caseSensitive,t.end),s=e.match(n);if(!s)return null;let i=s[0],o=i.replace(/(.)\/+$/,"$1"),a=s.slice(1);return{params:r.reduce((d,{paramName:h,isOptional:f},m)=>{if(h==="*"){let R=a[m]||"";o=i.slice(0,i.length-R.length).replace(/(.)\/+$/,"$1")}const v=a[m];return f&&!v?d[h]=void 0:d[h]=(v||"").replace(/%2F/g,"/"),d},{}),pathname:i,pathnameBase:o,pattern:t}}function XP(t,e=!1,n=!0){Xn(t==="*"||!t.endsWith("*")||t.endsWith("/*"),`Route path "${t}" will be treated as if it were "${t.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${t.replace(/\*$/,"/*")}".`);let r=[],s="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,a,l)=>(r.push({paramName:a,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return t.endsWith("*")?(r.push({paramName:"*"}),s+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?s+="\\/*$":t!==""&&t!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,e?void 0:"i"),r]}function JP(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Xn(!1,`The URL path "${t}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),t}}function Yr(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,r=t.charAt(n);return r&&r!=="/"?null:t.slice(n)||"/"}var ZP=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,eN=t=>ZP.test(t);function tN(t,e="/"){let{pathname:n,search:r="",hash:s=""}=typeof t=="string"?ba(t):t,i;if(n)if(eN(n))i=n;else{if(n.includes("//")){let o=n;n=n.replace(/\/\/+/g,"/"),Xn(!1,`Pathnames cannot have embedded double slashes - normalizing ${o} -> ${n}`)}n.startsWith("/")?i=Dw(n.substring(1),"/"):i=Dw(n,e)}else i=e;return{pathname:i,search:sN(r),hash:iN(s)}}function Dw(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(s=>{s===".."?n.length>1&&n.pop():s!=="."&&n.push(s)}),n.length>1?n.join("/"):"/"}function sp(t,e,n,r){return`Cannot include a '${t}' character in a manually specified \`to.${e}\` field [${JSON.stringify(r)}].  Please separate it out to the \`to.${n}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function nN(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function sy(t){let e=nN(t);return e.map((n,r)=>r===e.length-1?n.pathname:n.pathnameBase)}function iy(t,e,n,r=!1){let s;typeof t=="string"?s=ba(t):(s={...t},ht(!s.pathname||!s.pathname.includes("?"),sp("?","pathname","search",s)),ht(!s.pathname||!s.pathname.includes("#"),sp("#","pathname","hash",s)),ht(!s.search||!s.search.includes("#"),sp("#","search","hash",s)));let i=t===""||s.pathname==="",o=i?"/":s.pathname,a;if(o==null)a=n;else{let f=e.length-1;if(!r&&o.startsWith("..")){let m=o.split("/");for(;m[0]==="..";)m.shift(),f-=1;s.pathname=m.join("/")}a=f>=0?e[f]:"/"}let l=tN(s,a),d=o&&o!=="/"&&o.endsWith("/"),h=(i||o===".")&&n.endsWith("/");return!l.pathname.endsWith("/")&&(d||h)&&(l.pathname+="/"),l}var Hr=t=>t.join("/").replace(/\/\/+/g,"/"),rN=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),sN=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,iN=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function oN(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var kx=["POST","PUT","PATCH","DELETE"];new Set(kx);var aN=["GET",...kx];new Set(aN);var Ca=N.createContext(null);Ca.displayName="DataRouter";var Ah=N.createContext(null);Ah.displayName="DataRouterState";N.createContext(!1);var Dx=N.createContext({isTransitioning:!1});Dx.displayName="ViewTransition";var lN=N.createContext(new Map);lN.displayName="Fetchers";var cN=N.createContext(null);cN.displayName="Await";var pr=N.createContext(null);pr.displayName="Navigation";var Cc=N.createContext(null);Cc.displayName="Location";var Or=N.createContext({outlet:null,matches:[],isDataRoute:!1});Or.displayName="Route";var oy=N.createContext(null);oy.displayName="RouteError";function uN(t,{relative:e}={}){ht(Aa(),"useHref() may be used only in the context of a <Router> component.");let{basename:n,navigator:r}=N.useContext(pr),{hash:s,pathname:i,search:o}=Rc(t,{relative:e}),a=i;return n!=="/"&&(a=i==="/"?n:Hr([n,i])),r.createHref({pathname:a,search:o,hash:s})}function Aa(){return N.useContext(Cc)!=null}function Vr(){return ht(Aa(),"useLocation() may be used only in the context of a <Router> component."),N.useContext(Cc).location}var jx="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function Ox(t){N.useContext(pr).static||N.useLayoutEffect(t)}function Ac(){let{isDataRoute:t}=N.useContext(Or);return t?TN():dN()}function dN(){ht(Aa(),"useNavigate() may be used only in the context of a <Router> component.");let t=N.useContext(Ca),{basename:e,navigator:n}=N.useContext(pr),{matches:r}=N.useContext(Or),{pathname:s}=Vr(),i=JSON.stringify(sy(r)),o=N.useRef(!1);return Ox(()=>{o.current=!0}),N.useCallback((l,d={})=>{if(Xn(o.current,jx),!o.current)return;if(typeof l=="number"){n.go(l);return}let h=iy(l,JSON.parse(i),s,d.relative==="path");t==null&&e!=="/"&&(h.pathname=h.pathname==="/"?e:Hr([e,h.pathname])),(d.replace?n.replace:n.push)(h,d.state,d)},[e,n,i,s,t])}N.createContext(null);function Rc(t,{relative:e}={}){let{matches:n}=N.useContext(Or),{pathname:r}=Vr(),s=JSON.stringify(sy(n));return N.useMemo(()=>iy(t,JSON.parse(s),r,e==="path"),[t,s,r,e])}function hN(t,e){return Vx(t,e)}function Vx(t,e,n,r,s){var w;ht(Aa(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:i}=N.useContext(pr),{matches:o}=N.useContext(Or),a=o[o.length-1],l=a?a.params:{},d=a?a.pathname:"/",h=a?a.pathnameBase:"/",f=a&&a.route;{let y=f&&f.path||"";Lx(d,!f||y.endsWith("*")||y.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${d}" (under <Route path="${y}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${y}"> to <Route path="${y==="/"?"*":`${y}/*`}">.`)}let m=Vr(),v;if(e){let y=typeof e=="string"?ba(e):e;ht(h==="/"||((w=y.pathname)==null?void 0:w.startsWith(h)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${h}" but pathname "${y.pathname}" was given in the \`location\` prop.`),v=y}else v=m;let R=v.pathname||"/",b=R;if(h!=="/"){let y=h.replace(/^\//,"").split("/");b="/"+R.replace(/^\//,"").split("/").slice(y.length).join("/")}let A=Rx(t,{pathname:b});Xn(f||A!=null,`No routes matched location "${v.pathname}${v.search}${v.hash}" `),Xn(A==null||A[A.length-1].route.element!==void 0||A[A.length-1].route.Component!==void 0||A[A.length-1].route.lazy!==void 0,`Matched leaf route at location "${v.pathname}${v.search}${v.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let I=yN(A&&A.map(y=>Object.assign({},y,{params:Object.assign({},l,y.params),pathname:Hr([h,i.encodeLocation?i.encodeLocation(y.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:y.pathname]),pathnameBase:y.pathnameBase==="/"?h:Hr([h,i.encodeLocation?i.encodeLocation(y.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:y.pathnameBase])})),o,n,r,s);return e&&I?N.createElement(Cc.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...v},navigationType:"POP"}},I):I}function fN(){let t=IN(),e=oN(t)?`${t.status} ${t.statusText}`:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,r="rgba(200,200,200, 0.5)",s={padding:"0.5rem",backgroundColor:r},i={padding:"2px 4px",backgroundColor:r},o=null;return console.error("Error handled by React Router default ErrorBoundary:",t),o=N.createElement(N.Fragment,null,N.createElement("p",null," Hey developer "),N.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",N.createElement("code",{style:i},"ErrorBoundary")," or"," ",N.createElement("code",{style:i},"errorElement")," prop on your route.")),N.createElement(N.Fragment,null,N.createElement("h2",null,"Unexpected Application Error!"),N.createElement("h3",{style:{fontStyle:"italic"}},e),n?N.createElement("pre",{style:s},n):null,o)}var pN=N.createElement(fN,null),mN=class extends N.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,e){return e.location!==t.location||e.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:e.error,location:e.location,revalidation:t.revalidation||e.revalidation}}componentDidCatch(t,e){this.props.onError?this.props.onError(t,e):console.error("React Router caught the following error during render",t)}render(){return this.state.error!==void 0?N.createElement(Or.Provider,{value:this.props.routeContext},N.createElement(oy.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function gN({routeContext:t,match:e,children:n}){let r=N.useContext(Ca);return r&&r.static&&r.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=e.route.id),N.createElement(Or.Provider,{value:t},n)}function yN(t,e=[],n=null,r=null,s=null){if(t==null){if(!n)return null;if(n.errors)t=n.matches;else if(e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let i=t,o=n==null?void 0:n.errors;if(o!=null){let h=i.findIndex(f=>f.route.id&&(o==null?void 0:o[f.route.id])!==void 0);ht(h>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(o).join(",")}`),i=i.slice(0,Math.min(i.length,h+1))}let a=!1,l=-1;if(n)for(let h=0;h<i.length;h++){let f=i[h];if((f.route.HydrateFallback||f.route.hydrateFallbackElement)&&(l=h),f.route.id){let{loaderData:m,errors:v}=n,R=f.route.loader&&!m.hasOwnProperty(f.route.id)&&(!v||v[f.route.id]===void 0);if(f.route.lazy||R){a=!0,l>=0?i=i.slice(0,l+1):i=[i[0]];break}}}let d=n&&r?(h,f)=>{var m,v;r(h,{location:n.location,params:((v=(m=n.matches)==null?void 0:m[0])==null?void 0:v.params)??{},errorInfo:f})}:void 0;return i.reduceRight((h,f,m)=>{let v,R=!1,b=null,A=null;n&&(v=o&&f.route.id?o[f.route.id]:void 0,b=f.route.errorElement||pN,a&&(l<0&&m===0?(Lx("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),R=!0,A=null):l===m&&(R=!0,A=f.route.hydrateFallbackElement||null)));let I=e.concat(i.slice(0,m+1)),w=()=>{let y;return v?y=b:R?y=A:f.route.Component?y=N.createElement(f.route.Component,null):f.route.element?y=f.route.element:y=h,N.createElement(gN,{match:f,routeContext:{outlet:h,matches:I,isDataRoute:n!=null},children:y})};return n&&(f.route.ErrorBoundary||f.route.errorElement||m===0)?N.createElement(mN,{location:n.location,revalidation:n.revalidation,component:b,error:v,children:w(),routeContext:{outlet:null,matches:I,isDataRoute:!0},onError:d}):w()},null)}function ay(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function _N(t){let e=N.useContext(Ca);return ht(e,ay(t)),e}function vN(t){let e=N.useContext(Ah);return ht(e,ay(t)),e}function wN(t){let e=N.useContext(Or);return ht(e,ay(t)),e}function ly(t){let e=wN(t),n=e.matches[e.matches.length-1];return ht(n.route.id,`${t} can only be used on routes that contain a unique "id"`),n.route.id}function EN(){return ly("useRouteId")}function IN(){var r;let t=N.useContext(oy),e=vN("useRouteError"),n=ly("useRouteError");return t!==void 0?t:(r=e.errors)==null?void 0:r[n]}function TN(){let{router:t}=_N("useNavigate"),e=ly("useNavigate"),n=N.useRef(!1);return Ox(()=>{n.current=!0}),N.useCallback(async(s,i={})=>{Xn(n.current,jx),n.current&&(typeof s=="number"?t.navigate(s):await t.navigate(s,{fromRouteId:e,...i}))},[t,e])}var jw={};function Lx(t,e,n){!e&&!jw[t]&&(jw[t]=!0,Xn(!1,n))}N.memo(xN);function xN({routes:t,future:e,state:n,unstable_onError:r}){return Vx(t,void 0,n,r,e)}function Od({to:t,replace:e,state:n,relative:r}){ht(Aa(),"<Navigate> may be used only in the context of a <Router> component.");let{static:s}=N.useContext(pr);Xn(!s,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:i}=N.useContext(Or),{pathname:o}=Vr(),a=Ac(),l=iy(t,sy(i),o,r==="path"),d=JSON.stringify(l);return N.useEffect(()=>{a(JSON.parse(d),{replace:e,state:n,relative:r})},[a,d,r,e,n]),null}function To(t){ht(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function SN({basename:t="/",children:e=null,location:n,navigationType:r="POP",navigator:s,static:i=!1}){ht(!Aa(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let o=t.replace(/^\/*/,"/"),a=N.useMemo(()=>({basename:o,navigator:s,static:i,future:{}}),[o,s,i]);typeof n=="string"&&(n=ba(n));let{pathname:l="/",search:d="",hash:h="",state:f=null,key:m="default"}=n,v=N.useMemo(()=>{let R=Yr(l,o);return R==null?null:{location:{pathname:R,search:d,hash:h,state:f,key:m},navigationType:r}},[o,l,d,h,f,m,r]);return Xn(v!=null,`<Router basename="${o}"> is not able to match the URL "${l}${d}${h}" because it does not start with the basename, so the <Router> won't render anything.`),v==null?null:N.createElement(pr.Provider,{value:a},N.createElement(Cc.Provider,{children:e,value:v}))}function bN({children:t,location:e}){return hN(Cm(t),e)}function Cm(t,e=[]){let n=[];return N.Children.forEach(t,(r,s)=>{if(!N.isValidElement(r))return;let i=[...e,s];if(r.type===N.Fragment){n.push.apply(n,Cm(r.props.children,i));return}ht(r.type===To,`[${typeof r.type=="string"?r.type:r.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),ht(!r.props.index||!r.props.children,"An index route cannot have child routes.");let o={id:r.props.id||i.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,middleware:r.props.middleware,loader:r.props.loader,action:r.props.action,hydrateFallbackElement:r.props.hydrateFallbackElement,HydrateFallback:r.props.HydrateFallback,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.hasErrorBoundary===!0||r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(o.children=Cm(r.props.children,i)),n.push(o)}),n}var Wu="get",Ku="application/x-www-form-urlencoded";function Rh(t){return t!=null&&typeof t.tagName=="string"}function CN(t){return Rh(t)&&t.tagName.toLowerCase()==="button"}function AN(t){return Rh(t)&&t.tagName.toLowerCase()==="form"}function RN(t){return Rh(t)&&t.tagName.toLowerCase()==="input"}function PN(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function NN(t,e){return t.button===0&&(!e||e==="_self")&&!PN(t)}var wu=null;function kN(){if(wu===null)try{new FormData(document.createElement("form"),0),wu=!1}catch{wu=!0}return wu}var DN=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function ip(t){return t!=null&&!DN.has(t)?(Xn(!1,`"${t}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Ku}"`),null):t}function jN(t,e){let n,r,s,i,o;if(AN(t)){let a=t.getAttribute("action");r=a?Yr(a,e):null,n=t.getAttribute("method")||Wu,s=ip(t.getAttribute("enctype"))||Ku,i=new FormData(t)}else if(CN(t)||RN(t)&&(t.type==="submit"||t.type==="image")){let a=t.form;if(a==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let l=t.getAttribute("formaction")||a.getAttribute("action");if(r=l?Yr(l,e):null,n=t.getAttribute("formmethod")||a.getAttribute("method")||Wu,s=ip(t.getAttribute("formenctype"))||ip(a.getAttribute("enctype"))||Ku,i=new FormData(a,t),!kN()){let{name:d,type:h,value:f}=t;if(h==="image"){let m=d?`${d}.`:"";i.append(`${m}x`,"0"),i.append(`${m}y`,"0")}else d&&i.append(d,f)}}else{if(Rh(t))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');n=Wu,r=null,s=Ku,o=t}return i&&s==="text/plain"&&(o=i,i=void 0),{action:r,method:n.toLowerCase(),encType:s,formData:i,body:o}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function cy(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function ON(t,e,n){let r=typeof t=="string"?new URL(t,typeof window>"u"?"server://singlefetch/":window.location.origin):t;return r.pathname==="/"?r.pathname=`_root.${n}`:e&&Yr(r.pathname,e)==="/"?r.pathname=`${e.replace(/\/$/,"")}/_root.${n}`:r.pathname=`${r.pathname.replace(/\/$/,"")}.${n}`,r}async function VN(t,e){if(t.id in e)return e[t.id];try{let n=await import(t.module);return e[t.id]=n,n}catch(n){return console.error(`Error loading route module \`${t.module}\`, reloading page...`),console.error(n),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function LN(t){return t==null?!1:t.href==null?t.rel==="preload"&&typeof t.imageSrcSet=="string"&&typeof t.imageSizes=="string":typeof t.rel=="string"&&typeof t.href=="string"}async function MN(t,e,n){let r=await Promise.all(t.map(async s=>{let i=e.routes[s.route.id];if(i){let o=await VN(i,n);return o.links?o.links():[]}return[]}));return BN(r.flat(1).filter(LN).filter(s=>s.rel==="stylesheet"||s.rel==="preload").map(s=>s.rel==="stylesheet"?{...s,rel:"prefetch",as:"style"}:{...s,rel:"prefetch"}))}function Ow(t,e,n,r,s,i){let o=(l,d)=>n[d]?l.route.id!==n[d].route.id:!0,a=(l,d)=>{var h;return n[d].pathname!==l.pathname||((h=n[d].route.path)==null?void 0:h.endsWith("*"))&&n[d].params["*"]!==l.params["*"]};return i==="assets"?e.filter((l,d)=>o(l,d)||a(l,d)):i==="data"?e.filter((l,d)=>{var f;let h=r.routes[l.route.id];if(!h||!h.hasLoader)return!1;if(o(l,d)||a(l,d))return!0;if(l.route.shouldRevalidate){let m=l.route.shouldRevalidate({currentUrl:new URL(s.pathname+s.search+s.hash,window.origin),currentParams:((f=n[0])==null?void 0:f.params)||{},nextUrl:new URL(t,window.origin),nextParams:l.params,defaultShouldRevalidate:!0});if(typeof m=="boolean")return m}return!0}):[]}function FN(t,e,{includeHydrateFallback:n}={}){return UN(t.map(r=>{let s=e.routes[r.route.id];if(!s)return[];let i=[s.module];return s.clientActionModule&&(i=i.concat(s.clientActionModule)),s.clientLoaderModule&&(i=i.concat(s.clientLoaderModule)),n&&s.hydrateFallbackModule&&(i=i.concat(s.hydrateFallbackModule)),s.imports&&(i=i.concat(s.imports)),i}).flat(1))}function UN(t){return[...new Set(t)]}function $N(t){let e={},n=Object.keys(t).sort();for(let r of n)e[r]=t[r];return e}function BN(t,e){let n=new Set;return new Set(e),t.reduce((r,s)=>{let i=JSON.stringify($N(s));return n.has(i)||(n.add(i),r.push({key:i,link:s})),r},[])}function Mx(){let t=N.useContext(Ca);return cy(t,"You must render this element inside a <DataRouterContext.Provider> element"),t}function zN(){let t=N.useContext(Ah);return cy(t,"You must render this element inside a <DataRouterStateContext.Provider> element"),t}var uy=N.createContext(void 0);uy.displayName="FrameworkContext";function Fx(){let t=N.useContext(uy);return cy(t,"You must render this element inside a <HydratedRouter> element"),t}function qN(t,e){let n=N.useContext(uy),[r,s]=N.useState(!1),[i,o]=N.useState(!1),{onFocus:a,onBlur:l,onMouseEnter:d,onMouseLeave:h,onTouchStart:f}=e,m=N.useRef(null);N.useEffect(()=>{if(t==="render"&&o(!0),t==="viewport"){let b=I=>{I.forEach(w=>{o(w.isIntersecting)})},A=new IntersectionObserver(b,{threshold:.5});return m.current&&A.observe(m.current),()=>{A.disconnect()}}},[t]),N.useEffect(()=>{if(r){let b=setTimeout(()=>{o(!0)},100);return()=>{clearTimeout(b)}}},[r]);let v=()=>{s(!0)},R=()=>{s(!1),o(!1)};return n?t!=="intent"?[i,m,{}]:[i,m,{onFocus:rl(a,v),onBlur:rl(l,R),onMouseEnter:rl(d,v),onMouseLeave:rl(h,R),onTouchStart:rl(f,v)}]:[!1,m,{}]}function rl(t,e){return n=>{t&&t(n),n.defaultPrevented||e(n)}}function HN({page:t,...e}){let{router:n}=Mx(),r=N.useMemo(()=>Rx(n.routes,t,n.basename),[n.routes,t,n.basename]);return r?N.createElement(KN,{page:t,matches:r,...e}):null}function WN(t){let{manifest:e,routeModules:n}=Fx(),[r,s]=N.useState([]);return N.useEffect(()=>{let i=!1;return MN(t,e,n).then(o=>{i||s(o)}),()=>{i=!0}},[t,e,n]),r}function KN({page:t,matches:e,...n}){let r=Vr(),{manifest:s,routeModules:i}=Fx(),{basename:o}=Mx(),{loaderData:a,matches:l}=zN(),d=N.useMemo(()=>Ow(t,e,l,s,r,"data"),[t,e,l,s,r]),h=N.useMemo(()=>Ow(t,e,l,s,r,"assets"),[t,e,l,s,r]),f=N.useMemo(()=>{if(t===r.pathname+r.search+r.hash)return[];let R=new Set,b=!1;if(e.forEach(I=>{var y;let w=s.routes[I.route.id];!w||!w.hasLoader||(!d.some(j=>j.route.id===I.route.id)&&I.route.id in a&&((y=i[I.route.id])!=null&&y.shouldRevalidate)||w.hasClientLoader?b=!0:R.add(I.route.id))}),R.size===0)return[];let A=ON(t,o,"data");return b&&R.size>0&&A.searchParams.set("_routes",e.filter(I=>R.has(I.route.id)).map(I=>I.route.id).join(",")),[A.pathname+A.search]},[o,a,r,s,d,e,t,i]),m=N.useMemo(()=>FN(h,s),[h,s]),v=WN(h);return N.createElement(N.Fragment,null,f.map(R=>N.createElement("link",{key:R,rel:"prefetch",as:"fetch",href:R,...n})),m.map(R=>N.createElement("link",{key:R,rel:"modulepreload",href:R,...n})),v.map(({key:R,link:b})=>N.createElement("link",{key:R,nonce:n.nonce,...b})))}function GN(...t){return e=>{t.forEach(n=>{typeof n=="function"?n(e):n!=null&&(n.current=e)})}}var Ux=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{Ux&&(window.__reactRouterVersion="7.9.6")}catch{}function QN({basename:t,children:e,window:n}){let r=N.useRef();r.current==null&&(r.current=VP({window:n,v5Compat:!0}));let s=r.current,[i,o]=N.useState({action:s.action,location:s.location}),a=N.useCallback(l=>{N.startTransition(()=>o(l))},[o]);return N.useLayoutEffect(()=>s.listen(a),[s,a]),N.createElement(SN,{basename:t,children:e,location:i.location,navigationType:i.action,navigator:s})}var $x=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Bx=N.forwardRef(function({onClick:e,discover:n="render",prefetch:r="none",relative:s,reloadDocument:i,replace:o,state:a,target:l,to:d,preventScrollReset:h,viewTransition:f,...m},v){let{basename:R}=N.useContext(pr),b=typeof d=="string"&&$x.test(d),A,I=!1;if(typeof d=="string"&&b&&(A=d,Ux))try{let S=new URL(window.location.href),C=d.startsWith("//")?new URL(S.protocol+d):new URL(d),k=Yr(C.pathname,R);C.origin===S.origin&&k!=null?d=k+C.search+C.hash:I=!0}catch{Xn(!1,`<Link to="${d}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let w=uN(d,{relative:s}),[y,j,V]=qN(r,m),M=JN(d,{replace:o,state:a,target:l,preventScrollReset:h,relative:s,viewTransition:f});function T(S){e&&e(S),S.defaultPrevented||M(S)}let _=N.createElement("a",{...m,...V,href:A||w,onClick:I||i?e:T,ref:GN(v,j),target:l,"data-discover":!b&&n==="render"?"true":void 0});return y&&!b?N.createElement(N.Fragment,null,_,N.createElement(HN,{page:w})):_});Bx.displayName="Link";var xo=N.forwardRef(function({"aria-current":e="page",caseSensitive:n=!1,className:r="",end:s=!1,style:i,to:o,viewTransition:a,children:l,...d},h){let f=Rc(o,{relative:d.relative}),m=Vr(),v=N.useContext(Ah),{navigator:R,basename:b}=N.useContext(pr),A=v!=null&&rk(f)&&a===!0,I=R.encodeLocation?R.encodeLocation(f).pathname:f.pathname,w=m.pathname,y=v&&v.navigation&&v.navigation.location?v.navigation.location.pathname:null;n||(w=w.toLowerCase(),y=y?y.toLowerCase():null,I=I.toLowerCase()),y&&b&&(y=Yr(y,b)||y);const j=I!=="/"&&I.endsWith("/")?I.length-1:I.length;let V=w===I||!s&&w.startsWith(I)&&w.charAt(j)==="/",M=y!=null&&(y===I||!s&&y.startsWith(I)&&y.charAt(I.length)==="/"),T={isActive:V,isPending:M,isTransitioning:A},_=V?e:void 0,S;typeof r=="function"?S=r(T):S=[r,V?"active":null,M?"pending":null,A?"transitioning":null].filter(Boolean).join(" ");let C=typeof i=="function"?i(T):i;return N.createElement(Bx,{...d,"aria-current":_,className:S,ref:h,style:C,to:o,viewTransition:a},typeof l=="function"?l(T):l)});xo.displayName="NavLink";var YN=N.forwardRef(({discover:t="render",fetcherKey:e,navigate:n,reloadDocument:r,replace:s,state:i,method:o=Wu,action:a,onSubmit:l,relative:d,preventScrollReset:h,viewTransition:f,...m},v)=>{let R=tk(),b=nk(a,{relative:d}),A=o.toLowerCase()==="get"?"get":"post",I=typeof a=="string"&&$x.test(a),w=y=>{if(l&&l(y),y.defaultPrevented)return;y.preventDefault();let j=y.nativeEvent.submitter,V=(j==null?void 0:j.getAttribute("formmethod"))||o;R(j||y.currentTarget,{fetcherKey:e,method:V,navigate:n,replace:s,state:i,relative:d,preventScrollReset:h,viewTransition:f})};return N.createElement("form",{ref:v,method:A,action:b,onSubmit:r?l:w,...m,"data-discover":!I&&t==="render"?"true":void 0})});YN.displayName="Form";function XN(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function zx(t){let e=N.useContext(Ca);return ht(e,XN(t)),e}function JN(t,{target:e,replace:n,state:r,preventScrollReset:s,relative:i,viewTransition:o}={}){let a=Ac(),l=Vr(),d=Rc(t,{relative:i});return N.useCallback(h=>{if(NN(h,e)){h.preventDefault();let f=n!==void 0?n:ac(l)===ac(d);a(t,{replace:f,state:r,preventScrollReset:s,relative:i,viewTransition:o})}},[l,a,d,n,r,e,t,s,i,o])}var ZN=0,ek=()=>`__${String(++ZN)}__`;function tk(){let{router:t}=zx("useSubmit"),{basename:e}=N.useContext(pr),n=EN();return N.useCallback(async(r,s={})=>{let{action:i,method:o,encType:a,formData:l,body:d}=jN(r,e);if(s.navigate===!1){let h=s.fetcherKey||ek();await t.fetch(h,n,s.action||i,{preventScrollReset:s.preventScrollReset,formData:l,body:d,formMethod:s.method||o,formEncType:s.encType||a,flushSync:s.flushSync})}else await t.navigate(s.action||i,{preventScrollReset:s.preventScrollReset,formData:l,body:d,formMethod:s.method||o,formEncType:s.encType||a,replace:s.replace,state:s.state,fromRouteId:n,flushSync:s.flushSync,viewTransition:s.viewTransition})},[t,e,n])}function nk(t,{relative:e}={}){let{basename:n}=N.useContext(pr),r=N.useContext(Or);ht(r,"useFormAction must be used inside a RouteContext");let[s]=r.matches.slice(-1),i={...Rc(t||".",{relative:e})},o=Vr();if(t==null){i.search=o.search;let a=new URLSearchParams(i.search),l=a.getAll("index");if(l.some(h=>h==="")){a.delete("index"),l.filter(f=>f).forEach(f=>a.append("index",f));let h=a.toString();i.search=h?`?${h}`:""}}return(!t||t===".")&&s.route.index&&(i.search=i.search?i.search.replace(/^\?/,"?index&"):"?index"),n!=="/"&&(i.pathname=i.pathname==="/"?n:Hr([n,i.pathname])),ac(i)}function rk(t,{relative:e}={}){let n=N.useContext(Dx);ht(n!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:r}=zx("useViewTransitionState"),s=Rc(t,{relative:e});if(!n.isTransitioning)return!1;let i=Yr(n.currentLocation.pathname,r)||n.currentLocation.pathname,o=Yr(n.nextLocation.pathname,r)||n.nextLocation.pathname;return jd(s.pathname,o)!=null||jd(s.pathname,i)!=null}const sk=()=>{};var Vw={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qx=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let s=t.charCodeAt(r);s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=s&63|128):(s&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=s&63|128):(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=s&63|128)}return e},ik=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const s=t[n++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=t[n++];e[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=t[n++],o=t[n++],a=t[n++],l=((s&7)<<18|(i&63)<<12|(o&63)<<6|a&63)-65536;e[r++]=String.fromCharCode(55296+(l>>10)),e[r++]=String.fromCharCode(56320+(l&1023))}else{const i=t[n++],o=t[n++];e[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|o&63)}}return e.join("")},Hx={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<t.length;s+=3){const i=t[s],o=s+1<t.length,a=o?t[s+1]:0,l=s+2<t.length,d=l?t[s+2]:0,h=i>>2,f=(i&3)<<4|a>>4;let m=(a&15)<<2|d>>6,v=d&63;l||(v=64,o||(m=64)),r.push(n[h],n[f],n[m],n[v])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(qx(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):ik(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<t.length;){const i=n[t.charAt(s++)],a=s<t.length?n[t.charAt(s)]:0;++s;const d=s<t.length?n[t.charAt(s)]:64;++s;const f=s<t.length?n[t.charAt(s)]:64;if(++s,i==null||a==null||d==null||f==null)throw new ok;const m=i<<2|a>>4;if(r.push(m),d!==64){const v=a<<4&240|d>>2;if(r.push(v),f!==64){const R=d<<6&192|f;r.push(R)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class ok extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const ak=function(t){const e=qx(t);return Hx.encodeByteArray(e,!0)},Vd=function(t){return ak(t).replace(/\./g,"")},Wx=function(t){try{return Hx.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kx(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lk=()=>Kx().__FIREBASE_DEFAULTS__,ck=()=>{if(typeof process>"u"||typeof Vw>"u")return;const t=Vw.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},uk=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&Wx(t[1]);return e&&JSON.parse(e)},Ph=()=>{try{return sk()||lk()||ck()||uk()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},Gx=t=>{var e,n;return(n=(e=Ph())==null?void 0:e.emulatorHosts)==null?void 0:n[t]},Qx=t=>{const e=Gx(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},Yx=()=>{var t;return(t=Ph())==null?void 0:t.config},Xx=t=>{var e;return(e=Ph())==null?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dk{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ti(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function dy(t){return(await fetch(t,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Jx(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",s=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o={iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}},...t};return[Vd(JSON.stringify(n)),Vd(JSON.stringify(o)),""].join(".")}const Dl={};function hk(){const t={prod:[],emulator:[]};for(const e of Object.keys(Dl))Dl[e]?t.emulator.push(e):t.prod.push(e);return t}function fk(t){let e=document.getElementById(t),n=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),n=!0),{created:n,element:e}}let Lw=!1;function hy(t,e){if(typeof window>"u"||typeof document>"u"||!ti(window.location.host)||Dl[t]===e||Dl[t]||Lw)return;Dl[t]=e;function n(m){return`__firebase__banner__${m}`}const r="__firebase__banner",i=hk().prod.length>0;function o(){const m=document.getElementById(r);m&&m.remove()}function a(m){m.style.display="flex",m.style.background="#7faaf0",m.style.position="fixed",m.style.bottom="5px",m.style.left="5px",m.style.padding=".5em",m.style.borderRadius="5px",m.style.alignItems="center"}function l(m,v){m.setAttribute("width","24"),m.setAttribute("id",v),m.setAttribute("height","24"),m.setAttribute("viewBox","0 0 24 24"),m.setAttribute("fill","none"),m.style.marginLeft="-6px"}function d(){const m=document.createElement("span");return m.style.cursor="pointer",m.style.marginLeft="16px",m.style.fontSize="24px",m.innerHTML=" &times;",m.onclick=()=>{Lw=!0,o()},m}function h(m,v){m.setAttribute("id",v),m.innerText="Learn more",m.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",m.setAttribute("target","__blank"),m.style.paddingLeft="5px",m.style.textDecoration="underline"}function f(){const m=fk(r),v=n("text"),R=document.getElementById(v)||document.createElement("span"),b=n("learnmore"),A=document.getElementById(b)||document.createElement("a"),I=n("preprendIcon"),w=document.getElementById(I)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(m.created){const y=m.element;a(y),h(A,b);const j=d();l(w,I),y.append(w,R,A,j),document.body.appendChild(y)}i?(R.innerText="Preview backend disconnected.",w.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(w.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,R.innerText="Preview backend running in this workspace."),R.setAttribute("id",v)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",f):f()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ot(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function pk(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Ot())}function Zx(){var e;const t=(e=Ph())==null?void 0:e.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function mk(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function eS(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function gk(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function yk(){const t=Ot();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function tS(){return!Zx()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function nS(){return!Zx()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function fy(){try{return typeof indexedDB=="object"}catch{return!1}}function rS(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{var i;e(((i=s.error)==null?void 0:i.message)||"")}}catch(n){e(n)}})}function _k(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vk="FirebaseError";class Zn extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=vk,Object.setPrototypeOf(this,Zn.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,ro.prototype.create)}}class ro{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},s=`${this.service}/${e}`,i=this.errors[e],o=i?wk(i,r):"Error",a=`${this.serviceName}: ${o} (${s}).`;return new Zn(s,a,r)}}function wk(t,e){return t.replace(Ek,(n,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const Ek=/\{\$([^}]+)}/g;function Ik(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Xr(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const s of n){if(!r.includes(s))return!1;const i=t[s],o=e[s];if(Mw(i)&&Mw(o)){if(!Xr(i,o))return!1}else if(i!==o)return!1}for(const s of r)if(!n.includes(s))return!1;return!0}function Mw(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pc(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(s=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function ml(t){const e={};return t.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[s,i]=r.split("=");e[decodeURIComponent(s)]=decodeURIComponent(i)}}),e}function gl(t){const e=t.indexOf("?");if(!e)return"";const n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}function Tk(t,e){const n=new xk(t,e);return n.subscribe.bind(n)}class xk{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let s;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");Sk(e,["next","error","complete"])?s=e:s={next:e,error:n,complete:r},s.next===void 0&&(s.next=op),s.error===void 0&&(s.error=op),s.complete===void 0&&(s.complete=op);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function Sk(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function op(){}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bk=1e3,Ck=2,Ak=4*60*60*1e3,Rk=.5;function Fw(t,e=bk,n=Ck){const r=e*Math.pow(n,t),s=Math.round(Rk*r*(Math.random()-.5)*2);return Math.min(Ak,r+s)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qe(t){return t&&t._delegate?t._delegate:t}class Jn{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mi="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pk{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new dk;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:n});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){const n=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),r=(e==null?void 0:e.optional)??!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(s){if(r)return null;throw s}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(kk(e))try{this.getOrInitializeService({instanceIdentifier:mi})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(n);try{const i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(e=mi){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=mi){return this.instances.has(e)}getOptions(e=mi){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[i,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(i);r===a&&o.resolve(s)}return s}onInit(e,n){const r=this.normalizeInstanceIdentifier(n),s=this.onInitCallbacks.get(r)??new Set;s.add(e),this.onInitCallbacks.set(r,s);const i=this.instances.get(r);return i&&e(i,r),()=>{s.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const s of r)try{s(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:Nk(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=mi){return this.component?this.component.multipleInstances?e:mi:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function Nk(t){return t===mi?void 0:t}function kk(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dk{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new Pk(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Le;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Le||(Le={}));const jk={debug:Le.DEBUG,verbose:Le.VERBOSE,info:Le.INFO,warn:Le.WARN,error:Le.ERROR,silent:Le.SILENT},Ok=Le.INFO,Vk={[Le.DEBUG]:"log",[Le.VERBOSE]:"log",[Le.INFO]:"info",[Le.WARN]:"warn",[Le.ERROR]:"error"},Lk=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),s=Vk[e];if(s)console[s](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Nh{constructor(e){this.name=e,this._logLevel=Ok,this._logHandler=Lk,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Le))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?jk[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Le.DEBUG,...e),this._logHandler(this,Le.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Le.VERBOSE,...e),this._logHandler(this,Le.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Le.INFO,...e),this._logHandler(this,Le.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Le.WARN,...e),this._logHandler(this,Le.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Le.ERROR,...e),this._logHandler(this,Le.ERROR,...e)}}const Mk=(t,e)=>e.some(n=>t instanceof n);let Uw,$w;function Fk(){return Uw||(Uw=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Uk(){return $w||($w=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const sS=new WeakMap,Am=new WeakMap,iS=new WeakMap,ap=new WeakMap,py=new WeakMap;function $k(t){const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("success",i),t.removeEventListener("error",o)},i=()=>{n(Fs(t.result)),s()},o=()=>{r(t.error),s()};t.addEventListener("success",i),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&sS.set(n,t)}).catch(()=>{}),py.set(e,t),e}function Bk(t){if(Am.has(t))return;const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",o),t.removeEventListener("abort",o)},i=()=>{n(),s()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",i),t.addEventListener("error",o),t.addEventListener("abort",o)});Am.set(t,e)}let Rm={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return Am.get(t);if(e==="objectStoreNames")return t.objectStoreNames||iS.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Fs(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function zk(t){Rm=t(Rm)}function qk(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(lp(this),e,...n);return iS.set(r,e.sort?e.sort():[e]),Fs(r)}:Uk().includes(t)?function(...e){return t.apply(lp(this),e),Fs(sS.get(this))}:function(...e){return Fs(t.apply(lp(this),e))}}function Hk(t){return typeof t=="function"?qk(t):(t instanceof IDBTransaction&&Bk(t),Mk(t,Fk())?new Proxy(t,Rm):t)}function Fs(t){if(t instanceof IDBRequest)return $k(t);if(ap.has(t))return ap.get(t);const e=Hk(t);return e!==t&&(ap.set(t,e),py.set(e,t)),e}const lp=t=>py.get(t);function oS(t,e,{blocked:n,upgrade:r,blocking:s,terminated:i}={}){const o=indexedDB.open(t,e),a=Fs(o);return r&&o.addEventListener("upgradeneeded",l=>{r(Fs(o.result),l.oldVersion,l.newVersion,Fs(o.transaction),l)}),n&&o.addEventListener("blocked",l=>n(l.oldVersion,l.newVersion,l)),a.then(l=>{i&&l.addEventListener("close",()=>i()),s&&l.addEventListener("versionchange",d=>s(d.oldVersion,d.newVersion,d))}).catch(()=>{}),a}const Wk=["get","getKey","getAll","getAllKeys","count"],Kk=["put","add","delete","clear"],cp=new Map;function Bw(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(cp.get(e))return cp.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,s=Kk.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(s||Wk.includes(n)))return;const i=async function(o,...a){const l=this.transaction(o,s?"readwrite":"readonly");let d=l.store;return r&&(d=d.index(a.shift())),(await Promise.all([d[n](...a),s&&l.done]))[0]};return cp.set(e,i),i}zk(t=>({...t,get:(e,n,r)=>Bw(e,n)||t.get(e,n,r),has:(e,n)=>!!Bw(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gk{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(Qk(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function Qk(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Pm="@firebase/app",zw="0.14.5";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jr=new Nh("@firebase/app"),Yk="@firebase/app-compat",Xk="@firebase/analytics-compat",Jk="@firebase/analytics",Zk="@firebase/app-check-compat",eD="@firebase/app-check",tD="@firebase/auth",nD="@firebase/auth-compat",rD="@firebase/database",sD="@firebase/data-connect",iD="@firebase/database-compat",oD="@firebase/functions",aD="@firebase/functions-compat",lD="@firebase/installations",cD="@firebase/installations-compat",uD="@firebase/messaging",dD="@firebase/messaging-compat",hD="@firebase/performance",fD="@firebase/performance-compat",pD="@firebase/remote-config",mD="@firebase/remote-config-compat",gD="@firebase/storage",yD="@firebase/storage-compat",_D="@firebase/firestore",vD="@firebase/ai",wD="@firebase/firestore-compat",ED="firebase",ID="12.5.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nm="[DEFAULT]",TD={[Pm]:"fire-core",[Yk]:"fire-core-compat",[Jk]:"fire-analytics",[Xk]:"fire-analytics-compat",[eD]:"fire-app-check",[Zk]:"fire-app-check-compat",[tD]:"fire-auth",[nD]:"fire-auth-compat",[rD]:"fire-rtdb",[sD]:"fire-data-connect",[iD]:"fire-rtdb-compat",[oD]:"fire-fn",[aD]:"fire-fn-compat",[lD]:"fire-iid",[cD]:"fire-iid-compat",[uD]:"fire-fcm",[dD]:"fire-fcm-compat",[hD]:"fire-perf",[fD]:"fire-perf-compat",[pD]:"fire-rc",[mD]:"fire-rc-compat",[gD]:"fire-gcs",[yD]:"fire-gcs-compat",[_D]:"fire-fst",[wD]:"fire-fst-compat",[vD]:"fire-vertex","fire-js":"fire-js",[ED]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ld=new Map,xD=new Map,km=new Map;function qw(t,e){try{t.container.addComponent(e)}catch(n){Jr.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function dr(t){const e=t.name;if(km.has(e))return Jr.debug(`There were multiple attempts to register component ${e}.`),!1;km.set(e,t);for(const n of Ld.values())qw(n,t);for(const n of xD.values())qw(n,t);return!0}function ni(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function zn(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SD={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Us=new ro("app","Firebase",SD);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bD{constructor(e,n,r){this._isDeleted=!1,this._options={...e},this._config={...n},this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Jn("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Us.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const so=ID;function my(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r={name:Nm,automaticDataCollectionEnabled:!0,...e},s=r.name;if(typeof s!="string"||!s)throw Us.create("bad-app-name",{appName:String(s)});if(n||(n=Yx()),!n)throw Us.create("no-options");const i=Ld.get(s);if(i){if(Xr(n,i.options)&&Xr(r,i.config))return i;throw Us.create("duplicate-app",{appName:s})}const o=new Dk(s);for(const l of km.values())o.addComponent(l);const a=new bD(n,r,o);return Ld.set(s,a),a}function kh(t=Nm){const e=Ld.get(t);if(!e&&t===Nm&&Yx())return my();if(!e)throw Us.create("no-app",{appName:t});return e}function Rn(t,e,n){let r=TD[t]??t;n&&(r+=`-${n}`);const s=r.match(/\s|\//),i=e.match(/\s|\//);if(s||i){const o=[`Unable to register library "${r}" with version "${e}":`];s&&o.push(`library name "${r}" contains illegal characters (whitespace or "/")`),s&&i&&o.push("and"),i&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Jr.warn(o.join(" "));return}dr(new Jn(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CD="firebase-heartbeat-database",AD=1,lc="firebase-heartbeat-store";let up=null;function aS(){return up||(up=oS(CD,AD,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(lc)}catch(n){console.warn(n)}}}}).catch(t=>{throw Us.create("idb-open",{originalErrorMessage:t.message})})),up}async function RD(t){try{const n=(await aS()).transaction(lc),r=await n.objectStore(lc).get(lS(t));return await n.done,r}catch(e){if(e instanceof Zn)Jr.warn(e.message);else{const n=Us.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Jr.warn(n.message)}}}async function Hw(t,e){try{const r=(await aS()).transaction(lc,"readwrite");await r.objectStore(lc).put(e,lS(t)),await r.done}catch(n){if(n instanceof Zn)Jr.warn(n.message);else{const r=Us.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});Jr.warn(r.message)}}}function lS(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PD=1024,ND=30;class kD{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new jD(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=Ww();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)==null?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(o=>o.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:s}),this._heartbeatsCache.heartbeats.length>ND){const o=OD(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){Jr.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=Ww(),{heartbeatsToSend:r,unsentEntries:s}=DD(this._heartbeatsCache.heartbeats),i=Vd(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(n){return Jr.warn(n),""}}}function Ww(){return new Date().toISOString().substring(0,10)}function DD(t,e=PD){const n=[];let r=t.slice();for(const s of t){const i=n.find(o=>o.agent===s.agent);if(i){if(i.dates.push(s.date),Kw(n)>e){i.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),Kw(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class jD{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return fy()?rS().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await RD(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return Hw(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return Hw(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function Kw(t){return Vd(JSON.stringify({version:2,heartbeats:t})).length}function OD(t){if(t.length===0)return-1;let e=0,n=t[0].date;for(let r=1;r<t.length;r++)t[r].date<n&&(n=t[r].date,e=r);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VD(t){dr(new Jn("platform-logger",e=>new Gk(e),"PRIVATE")),dr(new Jn("heartbeat",e=>new kD(e),"PRIVATE")),Rn(Pm,zw,t),Rn(Pm,zw,"esm2020"),Rn("fire-js","")}VD("");var LD="firebase",MD="12.5.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Rn(LD,MD,"app");function cS(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const FD=cS,uS=new ro("auth","Firebase",cS());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Md=new Nh("@firebase/auth");function UD(t,...e){Md.logLevel<=Le.WARN&&Md.warn(`Auth (${so}): ${t}`,...e)}function Gu(t,...e){Md.logLevel<=Le.ERROR&&Md.error(`Auth (${so}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hr(t,...e){throw gy(t,...e)}function Pr(t,...e){return gy(t,...e)}function dS(t,e,n){const r={...FD(),[e]:n};return new ro("auth","Firebase",r).create(e,{appName:t.name})}function $s(t){return dS(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function gy(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return uS.create(t,...e)}function ve(t,e,...n){if(!t)throw gy(e,...n)}function $r(t){const e="INTERNAL ASSERTION FAILED: "+t;throw Gu(e),new Error(e)}function Zr(t,e){t||$r(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dm(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.href)||""}function $D(){return Gw()==="http:"||Gw()==="https:"}function Gw(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function BD(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&($D()||eS()||"connection"in navigator)?navigator.onLine:!0}function zD(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nc{constructor(e,n){this.shortDelay=e,this.longDelay=n,Zr(n>e,"Short delay should be less than long delay!"),this.isMobile=pk()||gk()}get(){return BD()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yy(t,e){Zr(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hS{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;$r("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;$r("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;$r("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qD={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HD=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],WD=new Nc(3e4,6e4);function io(t,e){return t.tenantId&&!e.tenantId?{...e,tenantId:t.tenantId}:e}async function ri(t,e,n,r,s={}){return fS(t,s,async()=>{let i={},o={};r&&(e==="GET"?o=r:i={body:JSON.stringify(r)});const a=Pc({key:t.config.apiKey,...o}).slice(1),l=await t._getAdditionalHeaders();l["Content-Type"]="application/json",t.languageCode&&(l["X-Firebase-Locale"]=t.languageCode);const d={method:e,headers:l,...i};return mk()||(d.referrerPolicy="no-referrer"),t.emulatorConfig&&ti(t.emulatorConfig.host)&&(d.credentials="include"),hS.fetch()(await pS(t,t.config.apiHost,n,a),d)})}async function fS(t,e,n){t._canInitEmulator=!1;const r={...qD,...e};try{const s=new GD(t),i=await Promise.race([n(),s.promise]);s.clearNetworkTimeout();const o=await i.json();if("needConfirmation"in o)throw Eu(t,"account-exists-with-different-credential",o);if(i.ok&&!("errorMessage"in o))return o;{const a=i.ok?o.errorMessage:o.error.message,[l,d]=a.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw Eu(t,"credential-already-in-use",o);if(l==="EMAIL_EXISTS")throw Eu(t,"email-already-in-use",o);if(l==="USER_DISABLED")throw Eu(t,"user-disabled",o);const h=r[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(d)throw dS(t,h,d);hr(t,h)}}catch(s){if(s instanceof Zn)throw s;hr(t,"network-request-failed",{message:String(s)})}}async function Dh(t,e,n,r,s={}){const i=await ri(t,e,n,r,s);return"mfaPendingCredential"in i&&hr(t,"multi-factor-auth-required",{_serverResponse:i}),i}async function pS(t,e,n,r){const s=`${e}${n}?${r}`,i=t,o=i.config.emulator?yy(t.config,s):`${t.config.apiScheme}://${s}`;return HD.includes(n)&&(await i._persistenceManagerAvailable,i._getPersistenceType()==="COOKIE")?i._getPersistence()._getFinalTarget(o).toString():o}function KD(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class GD{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(Pr(this.auth,"network-request-failed")),WD.get())})}}function Eu(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const s=Pr(t,e,r);return s.customData._tokenResponse=n,s}function Qw(t){return t!==void 0&&t.enterprise!==void 0}class QD{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const n of this.recaptchaEnforcementState)if(n.provider&&n.provider===e)return KD(n.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function YD(t,e){return ri(t,"GET","/v2/recaptchaConfig",io(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function XD(t,e){return ri(t,"POST","/v1/accounts:delete",e)}async function Fd(t,e){return ri(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jl(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function JD(t,e=!1){const n=Qe(t),r=await n.getIdToken(e),s=_y(r);ve(s&&s.exp&&s.auth_time&&s.iat,n.auth,"internal-error");const i=typeof s.firebase=="object"?s.firebase:void 0,o=i==null?void 0:i.sign_in_provider;return{claims:s,token:r,authTime:jl(dp(s.auth_time)),issuedAtTime:jl(dp(s.iat)),expirationTime:jl(dp(s.exp)),signInProvider:o||null,signInSecondFactor:(i==null?void 0:i.sign_in_second_factor)||null}}function dp(t){return Number(t)*1e3}function _y(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return Gu("JWT malformed, contained fewer than 3 sections"),null;try{const s=Wx(n);return s?JSON.parse(s):(Gu("Failed to decode base64 JWT payload"),null)}catch(s){return Gu("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function Yw(t){const e=_y(t);return ve(e,"internal-error"),ve(typeof e.exp<"u","internal-error"),ve(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function cc(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof Zn&&ZD(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function ZD({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ej{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const r=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jm{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=jl(this.lastLoginAt),this.creationTime=jl(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ud(t){var f;const e=t.auth,n=await t.getIdToken(),r=await cc(t,Fd(e,{idToken:n}));ve(r==null?void 0:r.users.length,e,"internal-error");const s=r.users[0];t._notifyReloadListener(s);const i=(f=s.providerUserInfo)!=null&&f.length?mS(s.providerUserInfo):[],o=nj(t.providerData,i),a=t.isAnonymous,l=!(t.email&&s.passwordHash)&&!(o!=null&&o.length),d=a?l:!1,h={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:o,metadata:new jm(s.createdAt,s.lastLoginAt),isAnonymous:d};Object.assign(t,h)}async function tj(t){const e=Qe(t);await Ud(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function nj(t,e){return[...t.filter(r=>!e.some(s=>s.providerId===r.providerId)),...e]}function mS(t){return t.map(({providerId:e,...n})=>({providerId:e,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function rj(t,e){const n=await fS(t,{},async()=>{const r=Pc({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:i}=t.config,o=await pS(t,s,"/v1/token",`key=${i}`),a=await t._getAdditionalHeaders();a["Content-Type"]="application/x-www-form-urlencoded";const l={method:"POST",headers:a,body:r};return t.emulatorConfig&&ti(t.emulatorConfig.host)&&(l.credentials="include"),hS.fetch()(o,l)});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function sj(t,e){return ri(t,"POST","/v2/accounts:revokeToken",io(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Go{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){ve(e.idToken,"internal-error"),ve(typeof e.idToken<"u","internal-error"),ve(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Yw(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){ve(e.length!==0,"internal-error");const n=Yw(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(ve(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:s,expiresIn:i}=await rj(e,n);this.updateTokensAndExpiration(r,s,Number(i))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:s,expirationTime:i}=n,o=new Go;return r&&(ve(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),s&&(ve(typeof s=="string","internal-error",{appName:e}),o.accessToken=s),i&&(ve(typeof i=="number","internal-error",{appName:e}),o.expirationTime=i),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Go,this.toJSON())}_performRefresh(){return $r("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fs(t,e){ve(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class or{constructor({uid:e,auth:n,stsTokenManager:r,...s}){this.providerId="firebase",this.proactiveRefresh=new ej(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=n,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new jm(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const n=await cc(this,this.stsTokenManager.getToken(this.auth,e));return ve(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return JD(this,e)}reload(){return tj(this)}_assign(e){this!==e&&(ve(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>({...n})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new or({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return n.metadata._copy(this.metadata),n}_onReload(e){ve(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await Ud(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(zn(this.auth.app))return Promise.reject($s(this.auth));const e=await this.getIdToken();return await cc(this,XD(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){const r=n.displayName??void 0,s=n.email??void 0,i=n.phoneNumber??void 0,o=n.photoURL??void 0,a=n.tenantId??void 0,l=n._redirectEventId??void 0,d=n.createdAt??void 0,h=n.lastLoginAt??void 0,{uid:f,emailVerified:m,isAnonymous:v,providerData:R,stsTokenManager:b}=n;ve(f&&b,e,"internal-error");const A=Go.fromJSON(this.name,b);ve(typeof f=="string",e,"internal-error"),fs(r,e.name),fs(s,e.name),ve(typeof m=="boolean",e,"internal-error"),ve(typeof v=="boolean",e,"internal-error"),fs(i,e.name),fs(o,e.name),fs(a,e.name),fs(l,e.name),fs(d,e.name),fs(h,e.name);const I=new or({uid:f,auth:e,email:s,emailVerified:m,displayName:r,isAnonymous:v,photoURL:o,phoneNumber:i,tenantId:a,stsTokenManager:A,createdAt:d,lastLoginAt:h});return R&&Array.isArray(R)&&(I.providerData=R.map(w=>({...w}))),l&&(I._redirectEventId=l),I}static async _fromIdTokenResponse(e,n,r=!1){const s=new Go;s.updateFromServerResponse(n);const i=new or({uid:n.localId,auth:e,stsTokenManager:s,isAnonymous:r});return await Ud(i),i}static async _fromGetAccountInfoResponse(e,n,r){const s=n.users[0];ve(s.localId!==void 0,"internal-error");const i=s.providerUserInfo!==void 0?mS(s.providerUserInfo):[],o=!(s.email&&s.passwordHash)&&!(i!=null&&i.length),a=new Go;a.updateFromIdToken(r);const l=new or({uid:s.localId,auth:e,stsTokenManager:a,isAnonymous:o}),d={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:i,metadata:new jm(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(i!=null&&i.length)};return Object.assign(l,d),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xw=new Map;function Br(t){Zr(t instanceof Function,"Expected a class definition");let e=Xw.get(t);return e?(Zr(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,Xw.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gS{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}gS.type="NONE";const Jw=gS;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qu(t,e,n){return`firebase:${t}:${e}:${n}`}class Qo{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:s,name:i}=this.auth;this.fullUserKey=Qu(this.userKey,s.apiKey,i),this.fullPersistenceKey=Qu("persistence",s.apiKey,i),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const n=await Fd(this.auth,{idToken:e}).catch(()=>{});return n?or._fromGetAccountInfoResponse(this.auth,n,e):null}return or._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new Qo(Br(Jw),e,r);const s=(await Promise.all(n.map(async d=>{if(await d._isAvailable())return d}))).filter(d=>d);let i=s[0]||Br(Jw);const o=Qu(r,e.config.apiKey,e.name);let a=null;for(const d of n)try{const h=await d._get(o);if(h){let f;if(typeof h=="string"){const m=await Fd(e,{idToken:h}).catch(()=>{});if(!m)break;f=await or._fromGetAccountInfoResponse(e,m,h)}else f=or._fromJSON(e,h);d!==i&&(a=f),i=d;break}}catch{}const l=s.filter(d=>d._shouldAllowMigration);return!i._shouldAllowMigration||!l.length?new Qo(i,e,r):(i=l[0],a&&await i._set(o,a.toJSON()),await Promise.all(n.map(async d=>{if(d!==i)try{await d._remove(o)}catch{}})),new Qo(i,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zw(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(wS(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(yS(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(IS(e))return"Blackberry";if(TS(e))return"Webos";if(_S(e))return"Safari";if((e.includes("chrome/")||vS(e))&&!e.includes("edge/"))return"Chrome";if(ES(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function yS(t=Ot()){return/firefox\//i.test(t)}function _S(t=Ot()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function vS(t=Ot()){return/crios\//i.test(t)}function wS(t=Ot()){return/iemobile/i.test(t)}function ES(t=Ot()){return/android/i.test(t)}function IS(t=Ot()){return/blackberry/i.test(t)}function TS(t=Ot()){return/webos/i.test(t)}function vy(t=Ot()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function ij(t=Ot()){var e;return vy(t)&&!!((e=window.navigator)!=null&&e.standalone)}function oj(){return yk()&&document.documentMode===10}function xS(t=Ot()){return vy(t)||ES(t)||TS(t)||IS(t)||/windows phone/i.test(t)||wS(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function SS(t,e=[]){let n;switch(t){case"Browser":n=Zw(Ot());break;case"Worker":n=`${Zw(Ot())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${so}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aj{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=i=>new Promise((o,a)=>{try{const l=e(i);o(l)}catch(l){a(l)}});r.onAbort=n,this.queue.push(r);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const s of n)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function lj(t,e={}){return ri(t,"GET","/v2/passwordPolicy",io(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cj=6;class uj{constructor(e){var r;const n=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=n.minPasswordLength??cj,n.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=n.maxPasswordLength),n.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=n.containsLowercaseCharacter),n.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=n.containsUppercaseCharacter),n.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=n.containsNumericCharacter),n.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=n.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=((r=e.allowedNonAlphanumericCharacters)==null?void 0:r.join(""))??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const n={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,n),this.validatePasswordCharacterOptions(e,n),n.isValid&&(n.isValid=n.meetsMinPasswordLength??!0),n.isValid&&(n.isValid=n.meetsMaxPasswordLength??!0),n.isValid&&(n.isValid=n.containsLowercaseLetter??!0),n.isValid&&(n.isValid=n.containsUppercaseLetter??!0),n.isValid&&(n.isValid=n.containsNumericCharacter??!0),n.isValid&&(n.isValid=n.containsNonAlphanumericCharacter??!0),n}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),s&&(n.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let s=0;s<e.length;s++)r=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,s,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dj{constructor(e,n,r,s){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new eE(this),this.idTokenSubscription=new eE(this),this.beforeStateQueue=new aj(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=uS,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion,this._persistenceManagerAvailable=new Promise(i=>this._resolvePersistenceManagerAvailable=i)}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=Br(n)),this._initializationPromise=this.queue(async()=>{var r,s,i;if(!this._deleted&&(this.persistenceManager=await Qo.create(this,e),(r=this._resolvePersistenceManagerAvailable)==null||r.call(this),!this._deleted)){if((s=this._popupRedirectResolver)!=null&&s._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((i=this.currentUser)==null?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await Fd(this,{idToken:e}),r=await or._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(r)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var i;if(zn(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(a,a))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let r=n,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(i=this.redirectUser)==null?void 0:i._redirectEventId,a=r==null?void 0:r._redirectEventId,l=await this.tryRedirectSignIn(e);(!o||o===a)&&(l!=null&&l.user)&&(r=l.user,s=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(r)}catch(o){r=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return ve(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await Ud(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=zD()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(zn(this.app))return Promise.reject($s(this));const n=e?Qe(e):null;return n&&ve(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&ve(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return zn(this.app)?Promise.reject($s(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return zn(this.app)?Promise.reject($s(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Br(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await lj(this),n=new uj(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new ro("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),await sj(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)==null?void 0:e.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&Br(e)||this._popupRedirectResolver;ve(n,this,"argument-error"),this.redirectPersistenceManager=await Qo.create(this,[Br(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)==null?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)==null?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=((n=this.currentUser)==null?void 0:n.uid)??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,s){if(this._deleted)return()=>{};const i=typeof n=="function"?n:n.next.bind(n);let o=!1;const a=this._isInitialized?Promise.resolve():this._initializationPromise;if(ve(a,this,"internal-error"),a.then(()=>{o||i(this.currentUser)}),typeof n=="function"){const l=e.addObserver(n,r,s);return()=>{o=!0,l()}}else{const l=e.addObserver(n);return()=>{o=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return ve(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=SS(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var s;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const n=await((s=this.heartbeatServiceProvider.getImmediate({optional:!0}))==null?void 0:s.getHeartbeatsHeader());n&&(e["X-Firebase-Client"]=n);const r=await this._getAppCheckToken();return r&&(e["X-Firebase-AppCheck"]=r),e}async _getAppCheckToken(){var n;if(zn(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await((n=this.appCheckServiceProvider.getImmediate({optional:!0}))==null?void 0:n.getToken());return e!=null&&e.error&&UD(`Error while retrieving App Check token: ${e.error}`),e==null?void 0:e.token}}function Ra(t){return Qe(t)}class eE{constructor(e){this.auth=e,this.observer=null,this.addObserver=Tk(n=>this.observer=n)}get next(){return ve(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let jh={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function hj(t){jh=t}function bS(t){return jh.loadJS(t)}function fj(){return jh.recaptchaEnterpriseScript}function pj(){return jh.gapiScript}function mj(t){return`__${t}${Math.floor(Math.random()*1e6)}`}class gj{constructor(){this.enterprise=new yj}ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}class yj{ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}const _j="recaptcha-enterprise",CS="NO_RECAPTCHA";class vj{constructor(e){this.type=_j,this.auth=Ra(e)}async verify(e="verify",n=!1){async function r(i){if(!n){if(i.tenantId==null&&i._agentRecaptchaConfig!=null)return i._agentRecaptchaConfig.siteKey;if(i.tenantId!=null&&i._tenantRecaptchaConfigs[i.tenantId]!==void 0)return i._tenantRecaptchaConfigs[i.tenantId].siteKey}return new Promise(async(o,a)=>{YD(i,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(l=>{if(l.recaptchaKey===void 0)a(new Error("recaptcha Enterprise site key undefined"));else{const d=new QD(l);return i.tenantId==null?i._agentRecaptchaConfig=d:i._tenantRecaptchaConfigs[i.tenantId]=d,o(d.siteKey)}}).catch(l=>{a(l)})})}function s(i,o,a){const l=window.grecaptcha;Qw(l)?l.enterprise.ready(()=>{l.enterprise.execute(i,{action:e}).then(d=>{o(d)}).catch(()=>{o(CS)})}):a(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new gj().execute("siteKey",{action:"verify"}):new Promise((i,o)=>{r(this.auth).then(a=>{if(!n&&Qw(window.grecaptcha))s(a,i,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let l=fj();l.length!==0&&(l+=a),bS(l).then(()=>{s(a,i,o)}).catch(d=>{o(d)})}}).catch(a=>{o(a)})})}}async function tE(t,e,n,r=!1,s=!1){const i=new vj(t);let o;if(s)o=CS;else try{o=await i.verify(n)}catch{o=await i.verify(n,!0)}const a={...e};if(n==="mfaSmsEnrollment"||n==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in a){const l=a.phoneEnrollmentInfo.phoneNumber,d=a.phoneEnrollmentInfo.recaptchaToken;Object.assign(a,{phoneEnrollmentInfo:{phoneNumber:l,recaptchaToken:d,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in a){const l=a.phoneSignInInfo.recaptchaToken;Object.assign(a,{phoneSignInInfo:{recaptchaToken:l,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return a}return r?Object.assign(a,{captchaResp:o}):Object.assign(a,{captchaResponse:o}),Object.assign(a,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(a,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),a}async function nE(t,e,n,r,s){var i;if((i=t._getRecaptchaConfig())!=null&&i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const o=await tE(t,e,n,n==="getOobCode");return r(t,o)}else return r(t,e).catch(async o=>{if(o.code==="auth/missing-recaptcha-token"){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const a=await tE(t,e,n,n==="getOobCode");return r(t,a)}else return Promise.reject(o)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wj(t,e){const n=ni(t,"auth");if(n.isInitialized()){const s=n.getImmediate(),i=n.getOptions();if(Xr(i,e??{}))return s;hr(s,"already-initialized")}return n.initialize({options:e})}function Ej(t,e){const n=(e==null?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(Br);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function Ij(t,e,n){const r=Ra(t);ve(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const s=!1,i=AS(e),{host:o,port:a}=Tj(e),l=a===null?"":`:${a}`,d={url:`${i}//${o}${l}/`},h=Object.freeze({host:o,port:a,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:s})});if(!r._canInitEmulator){ve(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),ve(Xr(d,r.config.emulator)&&Xr(h,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=d,r.emulatorConfig=h,r.settings.appVerificationDisabledForTesting=!0,ti(o)?(dy(`${i}//${o}${l}`),hy("Auth",!0)):xj()}function AS(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function Tj(t){const e=AS(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(r);if(s){const i=s[1];return{host:i,port:rE(r.substr(i.length+1))}}else{const[i,o]=r.split(":");return{host:i,port:rE(o)}}}function rE(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function xj(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wy{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return $r("not implemented")}_getIdTokenResponse(e){return $r("not implemented")}_linkToIdToken(e,n){return $r("not implemented")}_getReauthenticationResolver(e){return $r("not implemented")}}async function Sj(t,e){return ri(t,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function bj(t,e){return Dh(t,"POST","/v1/accounts:signInWithPassword",io(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Cj(t,e){return Dh(t,"POST","/v1/accounts:signInWithEmailLink",io(t,e))}async function Aj(t,e){return Dh(t,"POST","/v1/accounts:signInWithEmailLink",io(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uc extends wy{constructor(e,n,r,s=null){super("password",r),this._email=e,this._password=n,this._tenantId=s}static _fromEmailAndPassword(e,n){return new uc(e,n,"password")}static _fromEmailAndCode(e,n,r=null){return new uc(e,n,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;if(n!=null&&n.email&&(n!=null&&n.password)){if(n.signInMethod==="password")return this._fromEmailAndPassword(n.email,n.password);if(n.signInMethod==="emailLink")return this._fromEmailAndCode(n.email,n.password,n.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const n={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return nE(e,n,"signInWithPassword",bj);case"emailLink":return Cj(e,{email:this._email,oobCode:this._password});default:hr(e,"internal-error")}}async _linkToIdToken(e,n){switch(this.signInMethod){case"password":const r={idToken:n,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return nE(e,r,"signUpPassword",Sj);case"emailLink":return Aj(e,{idToken:n,email:this._email,oobCode:this._password});default:hr(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Yo(t,e){return Dh(t,"POST","/v1/accounts:signInWithIdp",io(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rj="http://localhost";class $i extends wy{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new $i(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):hr("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:s,...i}=n;if(!r||!s)return null;const o=new $i(r,s);return o.idToken=i.idToken||void 0,o.accessToken=i.accessToken||void 0,o.secret=i.secret,o.nonce=i.nonce,o.pendingToken=i.pendingToken||null,o}_getIdTokenResponse(e){const n=this.buildRequest();return Yo(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,Yo(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,Yo(e,n)}buildRequest(){const e={requestUri:Rj,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=Pc(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pj(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function Nj(t){const e=ml(gl(t)).link,n=e?ml(gl(e)).deep_link_id:null,r=ml(gl(t)).deep_link_id;return(r?ml(gl(r)).link:null)||r||n||e||t}class Ey{constructor(e){const n=ml(gl(e)),r=n.apiKey??null,s=n.oobCode??null,i=Pj(n.mode??null);ve(r&&s&&i,"argument-error"),this.apiKey=r,this.operation=i,this.code=s,this.continueUrl=n.continueUrl??null,this.languageCode=n.lang??null,this.tenantId=n.tenantId??null}static parseLink(e){const n=Nj(e);try{return new Ey(n)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pa{constructor(){this.providerId=Pa.PROVIDER_ID}static credential(e,n){return uc._fromEmailAndPassword(e,n)}static credentialWithLink(e,n){const r=Ey.parseLink(n);return ve(r,"argument-error"),uc._fromEmailAndCode(e,r.code,r.tenantId)}}Pa.PROVIDER_ID="password";Pa.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Pa.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RS{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kc extends RS{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Es extends kc{constructor(){super("facebook.com")}static credential(e){return $i._fromParams({providerId:Es.PROVIDER_ID,signInMethod:Es.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Es.credentialFromTaggedObject(e)}static credentialFromError(e){return Es.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Es.credential(e.oauthAccessToken)}catch{return null}}}Es.FACEBOOK_SIGN_IN_METHOD="facebook.com";Es.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Is extends kc{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return $i._fromParams({providerId:Is.PROVIDER_ID,signInMethod:Is.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return Is.credentialFromTaggedObject(e)}static credentialFromError(e){return Is.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return Is.credential(n,r)}catch{return null}}}Is.GOOGLE_SIGN_IN_METHOD="google.com";Is.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ts extends kc{constructor(){super("github.com")}static credential(e){return $i._fromParams({providerId:Ts.PROVIDER_ID,signInMethod:Ts.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ts.credentialFromTaggedObject(e)}static credentialFromError(e){return Ts.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ts.credential(e.oauthAccessToken)}catch{return null}}}Ts.GITHUB_SIGN_IN_METHOD="github.com";Ts.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xs extends kc{constructor(){super("twitter.com")}static credential(e,n){return $i._fromParams({providerId:xs.PROVIDER_ID,signInMethod:xs.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return xs.credentialFromTaggedObject(e)}static credentialFromError(e){return xs.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return xs.credential(n,r)}catch{return null}}}xs.TWITTER_SIGN_IN_METHOD="twitter.com";xs.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ca{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,s=!1){const i=await or._fromIdTokenResponse(e,r,s),o=sE(r);return new ca({user:i,providerId:o,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const s=sE(r);return new ca({user:e,providerId:s,_tokenResponse:r,operationType:n})}}function sE(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $d extends Zn{constructor(e,n,r,s){super(n.code,n.message),this.operationType=r,this.user=s,Object.setPrototypeOf(this,$d.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,s){return new $d(e,n,r,s)}}function PS(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?$d._fromErrorAndOperation(t,i,e,r):i})}async function kj(t,e,n=!1){const r=await cc(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return ca._forOperation(t,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Dj(t,e,n=!1){const{auth:r}=t;if(zn(r.app))return Promise.reject($s(r));const s="reauthenticate";try{const i=await cc(t,PS(r,s,e,t),n);ve(i.idToken,r,"internal-error");const o=_y(i.idToken);ve(o,r,"internal-error");const{sub:a}=o;return ve(t.uid===a,r,"user-mismatch"),ca._forOperation(t,s,i)}catch(i){throw(i==null?void 0:i.code)==="auth/user-not-found"&&hr(r,"user-mismatch"),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function NS(t,e,n=!1){if(zn(t.app))return Promise.reject($s(t));const r="signIn",s=await PS(t,r,e),i=await ca._fromIdTokenResponse(t,r,s);return n||await t._updateCurrentUser(i.user),i}async function jj(t,e){return NS(Ra(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Oj(t){const e=Ra(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}function Vj(t,e,n){return zn(t.app)?Promise.reject($s(t)):jj(Qe(t),Pa.credential(e,n)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&Oj(t),r})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lj(t,e){return Qe(t).setPersistence(e)}function Mj(t,e,n,r){return Qe(t).onIdTokenChanged(e,n,r)}function Fj(t,e,n){return Qe(t).beforeAuthStateChanged(e,n)}function Iy(t,e,n,r){return Qe(t).onAuthStateChanged(e,n,r)}function Uj(t){return Qe(t).signOut()}const Bd="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kS{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(Bd,"1"),this.storage.removeItem(Bd),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $j=1e3,Bj=10;class DS extends kS{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=xS(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),s=this.localCache[n];r!==s&&e(n,s,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((o,a,l)=>{this.notifyListeners(o,l)});return}const r=e.key;n?this.detachListener():this.stopPolling();const s=()=>{const o=this.storage.getItem(r);!n&&this.localCache[r]===o||this.notifyListeners(r,o)},i=this.storage.getItem(r);oj()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,Bj):s()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},$j)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}DS.type="LOCAL";const jS=DS;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OS extends kS{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}OS.type="SESSION";const VS=OS;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zj(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oh{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(s=>s.isListeningto(e));if(n)return n;const r=new Oh(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:s,data:i}=n.data,o=this.handlersMap[s];if(!(o!=null&&o.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:s});const a=Array.from(o).map(async d=>d(n.origin,i)),l=await zj(a);n.ports[0].postMessage({status:"done",eventId:r,eventType:s,response:l})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Oh.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ty(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qj{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let i,o;return new Promise((a,l)=>{const d=Ty("",20);s.port1.start();const h=setTimeout(()=>{l(new Error("unsupported_event"))},r);o={messageChannel:s,onMessage(f){const m=f;if(m.data.eventId===d)switch(m.data.status){case"ack":clearTimeout(h),i=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),a(m.data.response);break;default:clearTimeout(h),clearTimeout(i),l(new Error("invalid_response"));break}}},this.handlers.add(o),s.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:d,data:n},[s.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nr(){return window}function Hj(t){Nr().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function LS(){return typeof Nr().WorkerGlobalScope<"u"&&typeof Nr().importScripts=="function"}async function Wj(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function Kj(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)==null?void 0:t.controller)||null}function Gj(){return LS()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MS="firebaseLocalStorageDb",Qj=1,zd="firebaseLocalStorage",FS="fbase_key";class Dc{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function Vh(t,e){return t.transaction([zd],e?"readwrite":"readonly").objectStore(zd)}function Yj(){const t=indexedDB.deleteDatabase(MS);return new Dc(t).toPromise()}function Om(){const t=indexedDB.open(MS,Qj);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(zd,{keyPath:FS})}catch(s){n(s)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(zd)?e(r):(r.close(),await Yj(),e(await Om()))})})}async function iE(t,e,n){const r=Vh(t,!0).put({[FS]:e,value:n});return new Dc(r).toPromise()}async function Xj(t,e){const n=Vh(t,!1).get(e),r=await new Dc(n).toPromise();return r===void 0?null:r.value}function oE(t,e){const n=Vh(t,!0).delete(e);return new Dc(n).toPromise()}const Jj=800,Zj=3;class US{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Om(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>Zj)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return LS()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Oh._getInstance(Gj()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var n,r;if(this.activeServiceWorker=await Wj(),!this.activeServiceWorker)return;this.sender=new qj(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&(n=e[0])!=null&&n.fulfilled&&(r=e[0])!=null&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||Kj()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Om();return await iE(e,Bd,"1"),await oE(e,Bd),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>iE(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>Xj(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>oE(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const i=Vh(s,!1).getAll();return new Dc(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;if(e.length!==0)for(const{fbase_key:s,value:i}of e)r.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(i)&&(this.notifyListeners(s,i),n.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!r.has(s)&&(this.notifyListeners(s,null),n.push(s));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),Jj)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}US.type="LOCAL";const e2=US;new Nc(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function t2(t,e){return e?Br(e):(ve(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xy extends wy{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Yo(e,this._buildIdpRequest())}_linkToIdToken(e,n){return Yo(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return Yo(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function n2(t){return NS(t.auth,new xy(t),t.bypassAuthState)}function r2(t){const{auth:e,user:n}=t;return ve(n,e,"internal-error"),Dj(n,new xy(t),t.bypassAuthState)}async function s2(t){const{auth:e,user:n}=t;return ve(n,e,"internal-error"),kj(n,new xy(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $S{constructor(e,n,r,s,i=!1){this.auth=e,this.resolver=r,this.user=s,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:s,tenantId:i,error:o,type:a}=e;if(o){this.reject(o);return}const l={auth:this.auth,requestUri:n,sessionId:r,tenantId:i||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(l))}catch(d){this.reject(d)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return n2;case"linkViaPopup":case"linkViaRedirect":return s2;case"reauthViaPopup":case"reauthViaRedirect":return r2;default:hr(this.auth,"internal-error")}}resolve(e){Zr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Zr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const i2=new Nc(2e3,1e4);class $o extends $S{constructor(e,n,r,s,i){super(e,n,s,i),this.provider=r,this.authWindow=null,this.pollId=null,$o.currentPopupAction&&$o.currentPopupAction.cancel(),$o.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return ve(e,this.auth,"internal-error"),e}async onExecution(){Zr(this.filter.length===1,"Popup operations only handle one event");const e=Ty();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(Pr(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)==null?void 0:e.associatedEvent)||null}cancel(){this.reject(Pr(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,$o.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,r;if((r=(n=this.authWindow)==null?void 0:n.window)!=null&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Pr(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,i2.get())};e()}}$o.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const o2="pendingRedirect",Yu=new Map;class a2 extends $S{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=Yu.get(this.auth._key());if(!e){try{const r=await l2(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}Yu.set(this.auth._key(),e)}return this.bypassAuthState||Yu.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function l2(t,e){const n=d2(e),r=u2(t);if(!await r._isAvailable())return!1;const s=await r._get(n)==="true";return await r._remove(n),s}function c2(t,e){Yu.set(t._key(),e)}function u2(t){return Br(t._redirectPersistence)}function d2(t){return Qu(o2,t.config.apiKey,t.name)}async function h2(t,e,n=!1){if(zn(t.app))return Promise.reject($s(t));const r=Ra(t),s=t2(r,e),o=await new a2(r,s,n).execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const f2=10*60*1e3;class p2{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!m2(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!BS(e)){const s=((r=e.error.code)==null?void 0:r.split("auth/")[1])||"internal-error";n.onError(Pr(this.auth,s))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=f2&&this.cachedEventUids.clear(),this.cachedEventUids.has(aE(e))}saveEventToCache(e){this.cachedEventUids.add(aE(e)),this.lastProcessedEventTime=Date.now()}}function aE(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function BS({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function m2(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return BS(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function g2(t,e={}){return ri(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const y2=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,_2=/^https?/;async function v2(t){if(t.config.emulator)return;const{authorizedDomains:e}=await g2(t);for(const n of e)try{if(w2(n))return}catch{}hr(t,"unauthorized-domain")}function w2(t){const e=Dm(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&o.hostname===r}if(!_2.test(n))return!1;if(y2.test(t))return r===t;const s=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const E2=new Nc(3e4,6e4);function lE(){const t=Nr().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function I2(t){return new Promise((e,n)=>{var s,i,o;function r(){lE(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{lE(),n(Pr(t,"network-request-failed"))},timeout:E2.get()})}if((i=(s=Nr().gapi)==null?void 0:s.iframes)!=null&&i.Iframe)e(gapi.iframes.getContext());else if((o=Nr().gapi)!=null&&o.load)r();else{const a=mj("iframefcb");return Nr()[a]=()=>{gapi.load?r():n(Pr(t,"network-request-failed"))},bS(`${pj()}?onload=${a}`).catch(l=>n(l))}}).catch(e=>{throw Xu=null,e})}let Xu=null;function T2(t){return Xu=Xu||I2(t),Xu}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const x2=new Nc(5e3,15e3),S2="__/auth/iframe",b2="emulator/auth/iframe",C2={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},A2=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function R2(t){const e=t.config;ve(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?yy(e,b2):`https://${t.config.authDomain}/${S2}`,r={apiKey:e.apiKey,appName:t.name,v:so},s=A2.get(t.config.apiHost);s&&(r.eid=s);const i=t._getFrameworks();return i.length&&(r.fw=i.join(",")),`${n}?${Pc(r).slice(1)}`}async function P2(t){const e=await T2(t),n=Nr().gapi;return ve(n,t,"internal-error"),e.open({where:document.body,url:R2(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:C2,dontclear:!0},r=>new Promise(async(s,i)=>{await r.restyle({setHideOnLeave:!1});const o=Pr(t,"network-request-failed"),a=Nr().setTimeout(()=>{i(o)},x2.get());function l(){Nr().clearTimeout(a),s(r)}r.ping(l).then(l,()=>{i(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const N2={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},k2=500,D2=600,j2="_blank",O2="http://localhost";class cE{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function V2(t,e,n,r=k2,s=D2){const i=Math.max((window.screen.availHeight-s)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let a="";const l={...N2,width:r.toString(),height:s.toString(),top:i,left:o},d=Ot().toLowerCase();n&&(a=vS(d)?j2:n),yS(d)&&(e=e||O2,l.scrollbars="yes");const h=Object.entries(l).reduce((m,[v,R])=>`${m}${v}=${R},`,"");if(ij(d)&&a!=="_self")return L2(e||"",a),new cE(null);const f=window.open(e||"",a,h);ve(f,t,"popup-blocked");try{f.focus()}catch{}return new cE(f)}function L2(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const M2="__/auth/handler",F2="emulator/auth/handler",U2=encodeURIComponent("fac");async function uE(t,e,n,r,s,i){ve(t.config.authDomain,t,"auth-domain-config-required"),ve(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:so,eventId:s};if(e instanceof RS){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",Ik(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[h,f]of Object.entries({}))o[h]=f}if(e instanceof kc){const h=e.getScopes().filter(f=>f!=="");h.length>0&&(o.scopes=h.join(","))}t.tenantId&&(o.tid=t.tenantId);const a=o;for(const h of Object.keys(a))a[h]===void 0&&delete a[h];const l=await t._getAppCheckToken(),d=l?`#${U2}=${encodeURIComponent(l)}`:"";return`${$2(t)}?${Pc(a).slice(1)}${d}`}function $2({config:t}){return t.emulator?yy(t,F2):`https://${t.authDomain}/${M2}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hp="webStorageSupport";class B2{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=VS,this._completeRedirectFn=h2,this._overrideRedirectResult=c2}async _openPopup(e,n,r,s){var o;Zr((o=this.eventManagers[e._key()])==null?void 0:o.manager,"_initialize() not called before _openPopup()");const i=await uE(e,n,r,Dm(),s);return V2(e,i,Ty())}async _openRedirect(e,n,r,s){await this._originValidation(e);const i=await uE(e,n,r,Dm(),s);return Hj(i),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:s,promise:i}=this.eventManagers[n];return s?Promise.resolve(s):(Zr(i,"If manager is not set, promise should be"),i)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await P2(e),r=new p2(e);return n.register("authEvent",s=>(ve(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:r.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(hp,{type:hp},s=>{var o;const i=(o=s==null?void 0:s[0])==null?void 0:o[hp];i!==void 0&&n(!!i),hr(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=v2(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return xS()||_S()||vy()}}const z2=B2;var dE="@firebase/auth",hE="1.11.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q2{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)==null?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){ve(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function H2(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function W2(t){dr(new Jn("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=r.options;ve(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const l={apiKey:o,authDomain:a,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:SS(t)},d=new dj(r,s,i,l);return Ej(d,n),d},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),dr(new Jn("auth-internal",e=>{const n=Ra(e.getProvider("auth").getImmediate());return(r=>new q2(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),Rn(dE,hE,H2(t)),Rn(dE,hE,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const K2=5*60,G2=Xx("authIdTokenMaxAge")||K2;let fE=null;const Q2=t=>async e=>{const n=e&&await e.getIdTokenResult(),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>G2)return;const s=n==null?void 0:n.token;fE!==s&&(fE=s,await fetch(t,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function zS(t=kh()){const e=ni(t,"auth");if(e.isInitialized())return e.getImmediate();const n=wj(t,{popupRedirectResolver:z2,persistence:[e2,jS,VS]}),r=Xx("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(r,location.origin);if(location.origin===i.origin){const o=Q2(i.toString());Fj(n,o,()=>o(n.currentUser)),Mj(n,a=>o(a))}}const s=Gx("auth");return s&&Ij(n,`http://${s}`),n}function Y2(){var t;return((t=document.getElementsByTagName("head"))==null?void 0:t[0])??document}hj({loadJS(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=s=>{const i=Pr("internal-error");i.customData=s,n(i)},r.type="text/javascript",r.charset="UTF-8",Y2().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});W2("Browser");var pE=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Bs,qS;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(T,_){function S(){}S.prototype=_.prototype,T.F=_.prototype,T.prototype=new S,T.prototype.constructor=T,T.D=function(C,k,D){for(var P=Array(arguments.length-2),Y=2;Y<arguments.length;Y++)P[Y-2]=arguments[Y];return _.prototype[k].apply(C,P)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(r,n),r.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(T,_,S){S||(S=0);const C=Array(16);if(typeof _=="string")for(var k=0;k<16;++k)C[k]=_.charCodeAt(S++)|_.charCodeAt(S++)<<8|_.charCodeAt(S++)<<16|_.charCodeAt(S++)<<24;else for(k=0;k<16;++k)C[k]=_[S++]|_[S++]<<8|_[S++]<<16|_[S++]<<24;_=T.g[0],S=T.g[1],k=T.g[2];let D=T.g[3],P;P=_+(D^S&(k^D))+C[0]+3614090360&4294967295,_=S+(P<<7&4294967295|P>>>25),P=D+(k^_&(S^k))+C[1]+3905402710&4294967295,D=_+(P<<12&4294967295|P>>>20),P=k+(S^D&(_^S))+C[2]+606105819&4294967295,k=D+(P<<17&4294967295|P>>>15),P=S+(_^k&(D^_))+C[3]+3250441966&4294967295,S=k+(P<<22&4294967295|P>>>10),P=_+(D^S&(k^D))+C[4]+4118548399&4294967295,_=S+(P<<7&4294967295|P>>>25),P=D+(k^_&(S^k))+C[5]+1200080426&4294967295,D=_+(P<<12&4294967295|P>>>20),P=k+(S^D&(_^S))+C[6]+2821735955&4294967295,k=D+(P<<17&4294967295|P>>>15),P=S+(_^k&(D^_))+C[7]+4249261313&4294967295,S=k+(P<<22&4294967295|P>>>10),P=_+(D^S&(k^D))+C[8]+1770035416&4294967295,_=S+(P<<7&4294967295|P>>>25),P=D+(k^_&(S^k))+C[9]+2336552879&4294967295,D=_+(P<<12&4294967295|P>>>20),P=k+(S^D&(_^S))+C[10]+4294925233&4294967295,k=D+(P<<17&4294967295|P>>>15),P=S+(_^k&(D^_))+C[11]+2304563134&4294967295,S=k+(P<<22&4294967295|P>>>10),P=_+(D^S&(k^D))+C[12]+1804603682&4294967295,_=S+(P<<7&4294967295|P>>>25),P=D+(k^_&(S^k))+C[13]+4254626195&4294967295,D=_+(P<<12&4294967295|P>>>20),P=k+(S^D&(_^S))+C[14]+2792965006&4294967295,k=D+(P<<17&4294967295|P>>>15),P=S+(_^k&(D^_))+C[15]+1236535329&4294967295,S=k+(P<<22&4294967295|P>>>10),P=_+(k^D&(S^k))+C[1]+4129170786&4294967295,_=S+(P<<5&4294967295|P>>>27),P=D+(S^k&(_^S))+C[6]+3225465664&4294967295,D=_+(P<<9&4294967295|P>>>23),P=k+(_^S&(D^_))+C[11]+643717713&4294967295,k=D+(P<<14&4294967295|P>>>18),P=S+(D^_&(k^D))+C[0]+3921069994&4294967295,S=k+(P<<20&4294967295|P>>>12),P=_+(k^D&(S^k))+C[5]+3593408605&4294967295,_=S+(P<<5&4294967295|P>>>27),P=D+(S^k&(_^S))+C[10]+38016083&4294967295,D=_+(P<<9&4294967295|P>>>23),P=k+(_^S&(D^_))+C[15]+3634488961&4294967295,k=D+(P<<14&4294967295|P>>>18),P=S+(D^_&(k^D))+C[4]+3889429448&4294967295,S=k+(P<<20&4294967295|P>>>12),P=_+(k^D&(S^k))+C[9]+568446438&4294967295,_=S+(P<<5&4294967295|P>>>27),P=D+(S^k&(_^S))+C[14]+3275163606&4294967295,D=_+(P<<9&4294967295|P>>>23),P=k+(_^S&(D^_))+C[3]+4107603335&4294967295,k=D+(P<<14&4294967295|P>>>18),P=S+(D^_&(k^D))+C[8]+1163531501&4294967295,S=k+(P<<20&4294967295|P>>>12),P=_+(k^D&(S^k))+C[13]+2850285829&4294967295,_=S+(P<<5&4294967295|P>>>27),P=D+(S^k&(_^S))+C[2]+4243563512&4294967295,D=_+(P<<9&4294967295|P>>>23),P=k+(_^S&(D^_))+C[7]+1735328473&4294967295,k=D+(P<<14&4294967295|P>>>18),P=S+(D^_&(k^D))+C[12]+2368359562&4294967295,S=k+(P<<20&4294967295|P>>>12),P=_+(S^k^D)+C[5]+4294588738&4294967295,_=S+(P<<4&4294967295|P>>>28),P=D+(_^S^k)+C[8]+2272392833&4294967295,D=_+(P<<11&4294967295|P>>>21),P=k+(D^_^S)+C[11]+1839030562&4294967295,k=D+(P<<16&4294967295|P>>>16),P=S+(k^D^_)+C[14]+4259657740&4294967295,S=k+(P<<23&4294967295|P>>>9),P=_+(S^k^D)+C[1]+2763975236&4294967295,_=S+(P<<4&4294967295|P>>>28),P=D+(_^S^k)+C[4]+1272893353&4294967295,D=_+(P<<11&4294967295|P>>>21),P=k+(D^_^S)+C[7]+4139469664&4294967295,k=D+(P<<16&4294967295|P>>>16),P=S+(k^D^_)+C[10]+3200236656&4294967295,S=k+(P<<23&4294967295|P>>>9),P=_+(S^k^D)+C[13]+681279174&4294967295,_=S+(P<<4&4294967295|P>>>28),P=D+(_^S^k)+C[0]+3936430074&4294967295,D=_+(P<<11&4294967295|P>>>21),P=k+(D^_^S)+C[3]+3572445317&4294967295,k=D+(P<<16&4294967295|P>>>16),P=S+(k^D^_)+C[6]+76029189&4294967295,S=k+(P<<23&4294967295|P>>>9),P=_+(S^k^D)+C[9]+3654602809&4294967295,_=S+(P<<4&4294967295|P>>>28),P=D+(_^S^k)+C[12]+3873151461&4294967295,D=_+(P<<11&4294967295|P>>>21),P=k+(D^_^S)+C[15]+530742520&4294967295,k=D+(P<<16&4294967295|P>>>16),P=S+(k^D^_)+C[2]+3299628645&4294967295,S=k+(P<<23&4294967295|P>>>9),P=_+(k^(S|~D))+C[0]+4096336452&4294967295,_=S+(P<<6&4294967295|P>>>26),P=D+(S^(_|~k))+C[7]+1126891415&4294967295,D=_+(P<<10&4294967295|P>>>22),P=k+(_^(D|~S))+C[14]+2878612391&4294967295,k=D+(P<<15&4294967295|P>>>17),P=S+(D^(k|~_))+C[5]+4237533241&4294967295,S=k+(P<<21&4294967295|P>>>11),P=_+(k^(S|~D))+C[12]+1700485571&4294967295,_=S+(P<<6&4294967295|P>>>26),P=D+(S^(_|~k))+C[3]+2399980690&4294967295,D=_+(P<<10&4294967295|P>>>22),P=k+(_^(D|~S))+C[10]+4293915773&4294967295,k=D+(P<<15&4294967295|P>>>17),P=S+(D^(k|~_))+C[1]+2240044497&4294967295,S=k+(P<<21&4294967295|P>>>11),P=_+(k^(S|~D))+C[8]+1873313359&4294967295,_=S+(P<<6&4294967295|P>>>26),P=D+(S^(_|~k))+C[15]+4264355552&4294967295,D=_+(P<<10&4294967295|P>>>22),P=k+(_^(D|~S))+C[6]+2734768916&4294967295,k=D+(P<<15&4294967295|P>>>17),P=S+(D^(k|~_))+C[13]+1309151649&4294967295,S=k+(P<<21&4294967295|P>>>11),P=_+(k^(S|~D))+C[4]+4149444226&4294967295,_=S+(P<<6&4294967295|P>>>26),P=D+(S^(_|~k))+C[11]+3174756917&4294967295,D=_+(P<<10&4294967295|P>>>22),P=k+(_^(D|~S))+C[2]+718787259&4294967295,k=D+(P<<15&4294967295|P>>>17),P=S+(D^(k|~_))+C[9]+3951481745&4294967295,T.g[0]=T.g[0]+_&4294967295,T.g[1]=T.g[1]+(k+(P<<21&4294967295|P>>>11))&4294967295,T.g[2]=T.g[2]+k&4294967295,T.g[3]=T.g[3]+D&4294967295}r.prototype.v=function(T,_){_===void 0&&(_=T.length);const S=_-this.blockSize,C=this.C;let k=this.h,D=0;for(;D<_;){if(k==0)for(;D<=S;)s(this,T,D),D+=this.blockSize;if(typeof T=="string"){for(;D<_;)if(C[k++]=T.charCodeAt(D++),k==this.blockSize){s(this,C),k=0;break}}else for(;D<_;)if(C[k++]=T[D++],k==this.blockSize){s(this,C),k=0;break}}this.h=k,this.o+=_},r.prototype.A=function(){var T=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);T[0]=128;for(var _=1;_<T.length-8;++_)T[_]=0;_=this.o*8;for(var S=T.length-8;S<T.length;++S)T[S]=_&255,_/=256;for(this.v(T),T=Array(16),_=0,S=0;S<4;++S)for(let C=0;C<32;C+=8)T[_++]=this.g[S]>>>C&255;return T};function i(T,_){var S=a;return Object.prototype.hasOwnProperty.call(S,T)?S[T]:S[T]=_(T)}function o(T,_){this.h=_;const S=[];let C=!0;for(let k=T.length-1;k>=0;k--){const D=T[k]|0;C&&D==_||(S[k]=D,C=!1)}this.g=S}var a={};function l(T){return-128<=T&&T<128?i(T,function(_){return new o([_|0],_<0?-1:0)}):new o([T|0],T<0?-1:0)}function d(T){if(isNaN(T)||!isFinite(T))return f;if(T<0)return A(d(-T));const _=[];let S=1;for(let C=0;T>=S;C++)_[C]=T/S|0,S*=4294967296;return new o(_,0)}function h(T,_){if(T.length==0)throw Error("number format error: empty string");if(_=_||10,_<2||36<_)throw Error("radix out of range: "+_);if(T.charAt(0)=="-")return A(h(T.substring(1),_));if(T.indexOf("-")>=0)throw Error('number format error: interior "-" character');const S=d(Math.pow(_,8));let C=f;for(let D=0;D<T.length;D+=8){var k=Math.min(8,T.length-D);const P=parseInt(T.substring(D,D+k),_);k<8?(k=d(Math.pow(_,k)),C=C.j(k).add(d(P))):(C=C.j(S),C=C.add(d(P)))}return C}var f=l(0),m=l(1),v=l(16777216);t=o.prototype,t.m=function(){if(b(this))return-A(this).m();let T=0,_=1;for(let S=0;S<this.g.length;S++){const C=this.i(S);T+=(C>=0?C:4294967296+C)*_,_*=4294967296}return T},t.toString=function(T){if(T=T||10,T<2||36<T)throw Error("radix out of range: "+T);if(R(this))return"0";if(b(this))return"-"+A(this).toString(T);const _=d(Math.pow(T,6));var S=this;let C="";for(;;){const k=j(S,_).g;S=I(S,k.j(_));let D=((S.g.length>0?S.g[0]:S.h)>>>0).toString(T);if(S=k,R(S))return D+C;for(;D.length<6;)D="0"+D;C=D+C}},t.i=function(T){return T<0?0:T<this.g.length?this.g[T]:this.h};function R(T){if(T.h!=0)return!1;for(let _=0;_<T.g.length;_++)if(T.g[_]!=0)return!1;return!0}function b(T){return T.h==-1}t.l=function(T){return T=I(this,T),b(T)?-1:R(T)?0:1};function A(T){const _=T.g.length,S=[];for(let C=0;C<_;C++)S[C]=~T.g[C];return new o(S,~T.h).add(m)}t.abs=function(){return b(this)?A(this):this},t.add=function(T){const _=Math.max(this.g.length,T.g.length),S=[];let C=0;for(let k=0;k<=_;k++){let D=C+(this.i(k)&65535)+(T.i(k)&65535),P=(D>>>16)+(this.i(k)>>>16)+(T.i(k)>>>16);C=P>>>16,D&=65535,P&=65535,S[k]=P<<16|D}return new o(S,S[S.length-1]&-2147483648?-1:0)};function I(T,_){return T.add(A(_))}t.j=function(T){if(R(this)||R(T))return f;if(b(this))return b(T)?A(this).j(A(T)):A(A(this).j(T));if(b(T))return A(this.j(A(T)));if(this.l(v)<0&&T.l(v)<0)return d(this.m()*T.m());const _=this.g.length+T.g.length,S=[];for(var C=0;C<2*_;C++)S[C]=0;for(C=0;C<this.g.length;C++)for(let k=0;k<T.g.length;k++){const D=this.i(C)>>>16,P=this.i(C)&65535,Y=T.i(k)>>>16,Ye=T.i(k)&65535;S[2*C+2*k]+=P*Ye,w(S,2*C+2*k),S[2*C+2*k+1]+=D*Ye,w(S,2*C+2*k+1),S[2*C+2*k+1]+=P*Y,w(S,2*C+2*k+1),S[2*C+2*k+2]+=D*Y,w(S,2*C+2*k+2)}for(T=0;T<_;T++)S[T]=S[2*T+1]<<16|S[2*T];for(T=_;T<2*_;T++)S[T]=0;return new o(S,0)};function w(T,_){for(;(T[_]&65535)!=T[_];)T[_+1]+=T[_]>>>16,T[_]&=65535,_++}function y(T,_){this.g=T,this.h=_}function j(T,_){if(R(_))throw Error("division by zero");if(R(T))return new y(f,f);if(b(T))return _=j(A(T),_),new y(A(_.g),A(_.h));if(b(_))return _=j(T,A(_)),new y(A(_.g),_.h);if(T.g.length>30){if(b(T)||b(_))throw Error("slowDivide_ only works with positive integers.");for(var S=m,C=_;C.l(T)<=0;)S=V(S),C=V(C);var k=M(S,1),D=M(C,1);for(C=M(C,2),S=M(S,2);!R(C);){var P=D.add(C);P.l(T)<=0&&(k=k.add(S),D=P),C=M(C,1),S=M(S,1)}return _=I(T,k.j(_)),new y(k,_)}for(k=f;T.l(_)>=0;){for(S=Math.max(1,Math.floor(T.m()/_.m())),C=Math.ceil(Math.log(S)/Math.LN2),C=C<=48?1:Math.pow(2,C-48),D=d(S),P=D.j(_);b(P)||P.l(T)>0;)S-=C,D=d(S),P=D.j(_);R(D)&&(D=m),k=k.add(D),T=I(T,P)}return new y(k,T)}t.B=function(T){return j(this,T).h},t.and=function(T){const _=Math.max(this.g.length,T.g.length),S=[];for(let C=0;C<_;C++)S[C]=this.i(C)&T.i(C);return new o(S,this.h&T.h)},t.or=function(T){const _=Math.max(this.g.length,T.g.length),S=[];for(let C=0;C<_;C++)S[C]=this.i(C)|T.i(C);return new o(S,this.h|T.h)},t.xor=function(T){const _=Math.max(this.g.length,T.g.length),S=[];for(let C=0;C<_;C++)S[C]=this.i(C)^T.i(C);return new o(S,this.h^T.h)};function V(T){const _=T.g.length+1,S=[];for(let C=0;C<_;C++)S[C]=T.i(C)<<1|T.i(C-1)>>>31;return new o(S,T.h)}function M(T,_){const S=_>>5;_%=32;const C=T.g.length-S,k=[];for(let D=0;D<C;D++)k[D]=_>0?T.i(D+S)>>>_|T.i(D+S+1)<<32-_:T.i(D+S);return new o(k,T.h)}r.prototype.digest=r.prototype.A,r.prototype.reset=r.prototype.u,r.prototype.update=r.prototype.v,qS=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.B,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=d,o.fromString=h,Bs=o}).apply(typeof pE<"u"?pE:typeof self<"u"?self:typeof window<"u"?window:{});var Iu=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var HS,yl,WS,Ju,Vm,KS,GS,QS;(function(){var t,e=Object.defineProperty;function n(c){c=[typeof globalThis=="object"&&globalThis,c,typeof window=="object"&&window,typeof self=="object"&&self,typeof Iu=="object"&&Iu];for(var p=0;p<c.length;++p){var g=c[p];if(g&&g.Math==Math)return g}throw Error("Cannot find global object")}var r=n(this);function s(c,p){if(p)e:{var g=r;c=c.split(".");for(var E=0;E<c.length-1;E++){var L=c[E];if(!(L in g))break e;g=g[L]}c=c[c.length-1],E=g[c],p=p(E),p!=E&&p!=null&&e(g,c,{configurable:!0,writable:!0,value:p})}}s("Symbol.dispose",function(c){return c||Symbol("Symbol.dispose")}),s("Array.prototype.values",function(c){return c||function(){return this[Symbol.iterator]()}}),s("Object.entries",function(c){return c||function(p){var g=[],E;for(E in p)Object.prototype.hasOwnProperty.call(p,E)&&g.push([E,p[E]]);return g}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var i=i||{},o=this||self;function a(c){var p=typeof c;return p=="object"&&c!=null||p=="function"}function l(c,p,g){return c.call.apply(c.bind,arguments)}function d(c,p,g){return d=l,d.apply(null,arguments)}function h(c,p){var g=Array.prototype.slice.call(arguments,1);return function(){var E=g.slice();return E.push.apply(E,arguments),c.apply(this,E)}}function f(c,p){function g(){}g.prototype=p.prototype,c.Z=p.prototype,c.prototype=new g,c.prototype.constructor=c,c.Ob=function(E,L,U){for(var ee=Array(arguments.length-2),Pe=2;Pe<arguments.length;Pe++)ee[Pe-2]=arguments[Pe];return p.prototype[L].apply(E,ee)}}var m=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?c=>c&&AsyncContext.Snapshot.wrap(c):c=>c;function v(c){const p=c.length;if(p>0){const g=Array(p);for(let E=0;E<p;E++)g[E]=c[E];return g}return[]}function R(c,p){for(let E=1;E<arguments.length;E++){const L=arguments[E];var g=typeof L;if(g=g!="object"?g:L?Array.isArray(L)?"array":g:"null",g=="array"||g=="object"&&typeof L.length=="number"){g=c.length||0;const U=L.length||0;c.length=g+U;for(let ee=0;ee<U;ee++)c[g+ee]=L[ee]}else c.push(L)}}class b{constructor(p,g){this.i=p,this.j=g,this.h=0,this.g=null}get(){let p;return this.h>0?(this.h--,p=this.g,this.g=p.next,p.next=null):p=this.i(),p}}function A(c){o.setTimeout(()=>{throw c},0)}function I(){var c=T;let p=null;return c.g&&(p=c.g,c.g=c.g.next,c.g||(c.h=null),p.next=null),p}class w{constructor(){this.h=this.g=null}add(p,g){const E=y.get();E.set(p,g),this.h?this.h.next=E:this.g=E,this.h=E}}var y=new b(()=>new j,c=>c.reset());class j{constructor(){this.next=this.g=this.h=null}set(p,g){this.h=p,this.g=g,this.next=null}reset(){this.next=this.g=this.h=null}}let V,M=!1,T=new w,_=()=>{const c=Promise.resolve(void 0);V=()=>{c.then(S)}};function S(){for(var c;c=I();){try{c.h.call(c.g)}catch(g){A(g)}var p=y;p.j(c),p.h<100&&(p.h++,c.next=p.g,p.g=c)}M=!1}function C(){this.u=this.u,this.C=this.C}C.prototype.u=!1,C.prototype.dispose=function(){this.u||(this.u=!0,this.N())},C.prototype[Symbol.dispose]=function(){this.dispose()},C.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function k(c,p){this.type=c,this.g=this.target=p,this.defaultPrevented=!1}k.prototype.h=function(){this.defaultPrevented=!0};var D=function(){if(!o.addEventListener||!Object.defineProperty)return!1;var c=!1,p=Object.defineProperty({},"passive",{get:function(){c=!0}});try{const g=()=>{};o.addEventListener("test",g,p),o.removeEventListener("test",g,p)}catch{}return c}();function P(c){return/^[\s\xa0]*$/.test(c)}function Y(c,p){k.call(this,c?c.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,c&&this.init(c,p)}f(Y,k),Y.prototype.init=function(c,p){const g=this.type=c.type,E=c.changedTouches&&c.changedTouches.length?c.changedTouches[0]:null;this.target=c.target||c.srcElement,this.g=p,p=c.relatedTarget,p||(g=="mouseover"?p=c.fromElement:g=="mouseout"&&(p=c.toElement)),this.relatedTarget=p,E?(this.clientX=E.clientX!==void 0?E.clientX:E.pageX,this.clientY=E.clientY!==void 0?E.clientY:E.pageY,this.screenX=E.screenX||0,this.screenY=E.screenY||0):(this.clientX=c.clientX!==void 0?c.clientX:c.pageX,this.clientY=c.clientY!==void 0?c.clientY:c.pageY,this.screenX=c.screenX||0,this.screenY=c.screenY||0),this.button=c.button,this.key=c.key||"",this.ctrlKey=c.ctrlKey,this.altKey=c.altKey,this.shiftKey=c.shiftKey,this.metaKey=c.metaKey,this.pointerId=c.pointerId||0,this.pointerType=c.pointerType,this.state=c.state,this.i=c,c.defaultPrevented&&Y.Z.h.call(this)},Y.prototype.h=function(){Y.Z.h.call(this);const c=this.i;c.preventDefault?c.preventDefault():c.returnValue=!1};var Ye="closure_listenable_"+(Math.random()*1e6|0),Lt=0;function en(c,p,g,E,L){this.listener=c,this.proxy=null,this.src=p,this.type=g,this.capture=!!E,this.ha=L,this.key=++Lt,this.da=this.fa=!1}function J(c){c.da=!0,c.listener=null,c.proxy=null,c.src=null,c.ha=null}function de(c,p,g){for(const E in c)p.call(g,c[E],E,c)}function G(c,p){for(const g in c)p.call(void 0,c[g],g,c)}function je(c){const p={};for(const g in c)p[g]=c[g];return p}const Ke="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function z(c,p){let g,E;for(let L=1;L<arguments.length;L++){E=arguments[L];for(g in E)c[g]=E[g];for(let U=0;U<Ke.length;U++)g=Ke[U],Object.prototype.hasOwnProperty.call(E,g)&&(c[g]=E[g])}}function ne(c){this.src=c,this.g={},this.h=0}ne.prototype.add=function(c,p,g,E,L){const U=c.toString();c=this.g[U],c||(c=this.g[U]=[],this.h++);const ee=Ie(c,p,E,L);return ee>-1?(p=c[ee],g||(p.fa=!1)):(p=new en(p,this.src,U,!!E,L),p.fa=g,c.push(p)),p};function he(c,p){const g=p.type;if(g in c.g){var E=c.g[g],L=Array.prototype.indexOf.call(E,p,void 0),U;(U=L>=0)&&Array.prototype.splice.call(E,L,1),U&&(J(p),c.g[g].length==0&&(delete c.g[g],c.h--))}}function Ie(c,p,g,E){for(let L=0;L<c.length;++L){const U=c[L];if(!U.da&&U.listener==p&&U.capture==!!g&&U.ha==E)return L}return-1}var xe="closure_lm_"+(Math.random()*1e6|0),ke={};function ye(c,p,g,E,L){if(Array.isArray(p)){for(let U=0;U<p.length;U++)ye(c,p[U],g,E,L);return null}return g=se(g),c&&c[Ye]?c.J(p,g,a(E)?!!E.capture:!1,L):Xe(c,p,g,!1,E,L)}function Xe(c,p,g,E,L,U){if(!p)throw Error("Invalid event type");const ee=a(L)?!!L.capture:!!L;let Pe=pt(c);if(Pe||(c[xe]=Pe=new ne(c)),g=Pe.add(p,g,E,ee,U),g.proxy)return g;if(E=be(),g.proxy=E,E.src=c,E.listener=g,c.addEventListener)D||(L=ee),L===void 0&&(L=!1),c.addEventListener(p.toString(),E,L);else if(c.attachEvent)c.attachEvent(it(p.toString()),E);else if(c.addListener&&c.removeListener)c.addListener(E);else throw Error("addEventListener and attachEvent are unavailable.");return g}function be(){function c(g){return p.call(c.src,c.listener,g)}const p=Ge;return c}function re(c,p,g,E,L){if(Array.isArray(p))for(var U=0;U<p.length;U++)re(c,p[U],g,E,L);else E=a(E)?!!E.capture:!!E,g=se(g),c&&c[Ye]?(c=c.i,U=String(p).toString(),U in c.g&&(p=c.g[U],g=Ie(p,g,E,L),g>-1&&(J(p[g]),Array.prototype.splice.call(p,g,1),p.length==0&&(delete c.g[U],c.h--)))):c&&(c=pt(c))&&(p=c.g[p.toString()],c=-1,p&&(c=Ie(p,g,E,L)),(g=c>-1?p[c]:null)&&Oe(g))}function Oe(c){if(typeof c!="number"&&c&&!c.da){var p=c.src;if(p&&p[Ye])he(p.i,c);else{var g=c.type,E=c.proxy;p.removeEventListener?p.removeEventListener(g,E,c.capture):p.detachEvent?p.detachEvent(it(g),E):p.addListener&&p.removeListener&&p.removeListener(E),(g=pt(p))?(he(g,c),g.h==0&&(g.src=null,p[xe]=null)):J(c)}}}function it(c){return c in ke?ke[c]:ke[c]="on"+c}function Ge(c,p){if(c.da)c=!0;else{p=new Y(p,this);const g=c.listener,E=c.ha||c.src;c.fa&&Oe(c),c=g.call(E,p)}return c}function pt(c){return c=c[xe],c instanceof ne?c:null}var q="__closure_events_fn_"+(Math.random()*1e9>>>0);function se(c){return typeof c=="function"?c:(c[q]||(c[q]=function(p){return c.handleEvent(p)}),c[q])}function X(){C.call(this),this.i=new ne(this),this.M=this,this.G=null}f(X,C),X.prototype[Ye]=!0,X.prototype.removeEventListener=function(c,p,g,E){re(this,c,p,g,E)};function Q(c,p){var g,E=c.G;if(E)for(g=[];E;E=E.G)g.push(E);if(c=c.M,E=p.type||p,typeof p=="string")p=new k(p,c);else if(p instanceof k)p.target=p.target||c;else{var L=p;p=new k(E,c),z(p,L)}L=!0;let U,ee;if(g)for(ee=g.length-1;ee>=0;ee--)U=p.g=g[ee],L=fe(U,E,!0,p)&&L;if(U=p.g=c,L=fe(U,E,!0,p)&&L,L=fe(U,E,!1,p)&&L,g)for(ee=0;ee<g.length;ee++)U=p.g=g[ee],L=fe(U,E,!1,p)&&L}X.prototype.N=function(){if(X.Z.N.call(this),this.i){var c=this.i;for(const p in c.g){const g=c.g[p];for(let E=0;E<g.length;E++)J(g[E]);delete c.g[p],c.h--}}this.G=null},X.prototype.J=function(c,p,g,E){return this.i.add(String(c),p,!1,g,E)},X.prototype.K=function(c,p,g,E){return this.i.add(String(c),p,!0,g,E)};function fe(c,p,g,E){if(p=c.i.g[String(p)],!p)return!0;p=p.concat();let L=!0;for(let U=0;U<p.length;++U){const ee=p[U];if(ee&&!ee.da&&ee.capture==g){const Pe=ee.listener,kt=ee.ha||ee.src;ee.fa&&he(c.i,ee),L=Pe.call(kt,E)!==!1&&L}}return L&&!E.defaultPrevented}function Ce(c,p){if(typeof c!="function")if(c&&typeof c.handleEvent=="function")c=d(c.handleEvent,c);else throw Error("Invalid listener argument");return Number(p)>2147483647?-1:o.setTimeout(c,p||0)}function we(c){c.g=Ce(()=>{c.g=null,c.i&&(c.i=!1,we(c))},c.l);const p=c.h;c.h=null,c.m.apply(null,p)}class qe extends C{constructor(p,g){super(),this.m=p,this.l=g,this.h=null,this.i=!1,this.g=null}j(p){this.h=arguments,this.g?this.i=!0:we(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Se(c){C.call(this),this.h=c,this.g={}}f(Se,C);var Fe=[];function ge(c){de(c.g,function(p,g){this.g.hasOwnProperty(g)&&Oe(p)},c),c.g={}}Se.prototype.N=function(){Se.Z.N.call(this),ge(this)},Se.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var He=o.JSON.stringify,F=o.JSON.parse,Z=class{stringify(c){return o.JSON.stringify(c,void 0)}parse(c){return o.JSON.parse(c,void 0)}};function ae(){}function Ae(){}var vt={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function Mt(){k.call(this,"d")}f(Mt,k);function x(){k.call(this,"c")}f(x,k);var B={},ie=null;function pe(){return ie=ie||new X}B.Ia="serverreachability";function ce(c){k.call(this,B.Ia,c)}f(ce,k);function Re(c){const p=pe();Q(p,new ce(p))}B.STAT_EVENT="statevent";function Nt(c,p){k.call(this,B.STAT_EVENT,c),this.stat=p}f(Nt,k);function Ve(c){const p=pe();Q(p,new Nt(p,c))}B.Ja="timingevent";function gr(c,p){k.call(this,B.Ja,c),this.size=p}f(gr,k);function ct(c,p){if(typeof c!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){c()},p)}function Ht(){this.g=!0}Ht.prototype.ua=function(){this.g=!1};function Wt(c,p,g,E,L,U){c.info(function(){if(c.g)if(U){var ee="",Pe=U.split("&");for(let nt=0;nt<Pe.length;nt++){var kt=Pe[nt].split("=");if(kt.length>1){const Ft=kt[0];kt=kt[1];const _r=Ft.split("_");ee=_r.length>=2&&_r[1]=="type"?ee+(Ft+"="+kt+"&"):ee+(Ft+"=redacted&")}}}else ee=null;else ee=U;return"XMLHTTP REQ ("+E+") [attempt "+L+"]: "+p+`
`+g+`
`+ee})}function Va(c,p,g,E,L,U,ee){c.info(function(){return"XMLHTTP RESP ("+E+") [ attempt "+L+"]: "+p+`
`+g+`
`+U+" "+ee})}function is(c,p,g,E){c.info(function(){return"XMLHTTP TEXT ("+p+"): "+qA(c,g)+(E?" "+E:"")})}function La(c,p){c.info(function(){return"TIMEOUT: "+p})}Ht.prototype.info=function(){};function qA(c,p){if(!c.g)return p;if(!p)return null;try{const U=JSON.parse(p);if(U){for(c=0;c<U.length;c++)if(Array.isArray(U[c])){var g=U[c];if(!(g.length<2)){var E=g[1];if(Array.isArray(E)&&!(E.length<1)){var L=E[0];if(L!="noop"&&L!="stop"&&L!="close")for(let ee=1;ee<E.length;ee++)E[ee]=""}}}}return He(U)}catch{return p}}var Kc={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},V_={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},L_;function _f(){}f(_f,ae),_f.prototype.g=function(){return new XMLHttpRequest},L_=new _f;function Ma(c){return encodeURIComponent(String(c))}function HA(c){var p=1;c=c.split(":");const g=[];for(;p>0&&c.length;)g.push(c.shift()),p--;return c.length&&g.push(c.join(":")),g}function os(c,p,g,E){this.j=c,this.i=p,this.l=g,this.S=E||1,this.V=new Se(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new M_}function M_(){this.i=null,this.g="",this.h=!1}var F_={},vf={};function wf(c,p,g){c.M=1,c.A=Qc(yr(p)),c.u=g,c.R=!0,U_(c,null)}function U_(c,p){c.F=Date.now(),Gc(c),c.B=yr(c.A);var g=c.B,E=c.S;Array.isArray(E)||(E=[String(E)]),Z_(g.i,"t",E),c.C=0,g=c.j.L,c.h=new M_,c.g=yv(c.j,g?p:null,!c.u),c.P>0&&(c.O=new qe(d(c.Y,c,c.g),c.P)),p=c.V,g=c.g,E=c.ba;var L="readystatechange";Array.isArray(L)||(L&&(Fe[0]=L.toString()),L=Fe);for(let U=0;U<L.length;U++){const ee=ye(g,L[U],E||p.handleEvent,!1,p.h||p);if(!ee)break;p.g[ee.key]=ee}p=c.J?je(c.J):{},c.u?(c.v||(c.v="POST"),p["Content-Type"]="application/x-www-form-urlencoded",c.g.ea(c.B,c.v,c.u,p)):(c.v="GET",c.g.ea(c.B,c.v,null,p)),Re(),Wt(c.i,c.v,c.B,c.l,c.S,c.u)}os.prototype.ba=function(c){c=c.target;const p=this.O;p&&cs(c)==3?p.j():this.Y(c)},os.prototype.Y=function(c){try{if(c==this.g)e:{const Pe=cs(this.g),kt=this.g.ya(),nt=this.g.ca();if(!(Pe<3)&&(Pe!=3||this.g&&(this.h.h||this.g.la()||ov(this.g)))){this.K||Pe!=4||kt==7||(kt==8||nt<=0?Re(3):Re(2)),Ef(this);var p=this.g.ca();this.X=p;var g=WA(this);if(this.o=p==200,Va(this.i,this.v,this.B,this.l,this.S,Pe,p),this.o){if(this.U&&!this.L){t:{if(this.g){var E,L=this.g;if((E=L.g?L.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!P(E)){var U=E;break t}}U=null}if(c=U)is(this.i,this.l,c,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,If(this,c);else{this.o=!1,this.m=3,Ve(12),ai(this),Fa(this);break e}}if(this.R){c=!0;let Ft;for(;!this.K&&this.C<g.length;)if(Ft=KA(this,g),Ft==vf){Pe==4&&(this.m=4,Ve(14),c=!1),is(this.i,this.l,null,"[Incomplete Response]");break}else if(Ft==F_){this.m=4,Ve(15),is(this.i,this.l,g,"[Invalid Chunk]"),c=!1;break}else is(this.i,this.l,Ft,null),If(this,Ft);if($_(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Pe!=4||g.length!=0||this.h.h||(this.m=1,Ve(16),c=!1),this.o=this.o&&c,!c)is(this.i,this.l,g,"[Invalid Chunked Response]"),ai(this),Fa(this);else if(g.length>0&&!this.W){this.W=!0;var ee=this.j;ee.g==this&&ee.aa&&!ee.P&&(ee.j.info("Great, no buffering proxy detected. Bytes received: "+g.length),Pf(ee),ee.P=!0,Ve(11))}}else is(this.i,this.l,g,null),If(this,g);Pe==4&&ai(this),this.o&&!this.K&&(Pe==4?fv(this.j,this):(this.o=!1,Gc(this)))}else aR(this.g),p==400&&g.indexOf("Unknown SID")>0?(this.m=3,Ve(12)):(this.m=0,Ve(13)),ai(this),Fa(this)}}}catch{}finally{}};function WA(c){if(!$_(c))return c.g.la();const p=ov(c.g);if(p==="")return"";let g="";const E=p.length,L=cs(c.g)==4;if(!c.h.i){if(typeof TextDecoder>"u")return ai(c),Fa(c),"";c.h.i=new o.TextDecoder}for(let U=0;U<E;U++)c.h.h=!0,g+=c.h.i.decode(p[U],{stream:!(L&&U==E-1)});return p.length=0,c.h.g+=g,c.C=0,c.h.g}function $_(c){return c.g?c.v=="GET"&&c.M!=2&&c.j.Aa:!1}function KA(c,p){var g=c.C,E=p.indexOf(`
`,g);return E==-1?vf:(g=Number(p.substring(g,E)),isNaN(g)?F_:(E+=1,E+g>p.length?vf:(p=p.slice(E,E+g),c.C=E+g,p)))}os.prototype.cancel=function(){this.K=!0,ai(this)};function Gc(c){c.T=Date.now()+c.H,B_(c,c.H)}function B_(c,p){if(c.D!=null)throw Error("WatchDog timer not null");c.D=ct(d(c.aa,c),p)}function Ef(c){c.D&&(o.clearTimeout(c.D),c.D=null)}os.prototype.aa=function(){this.D=null;const c=Date.now();c-this.T>=0?(La(this.i,this.B),this.M!=2&&(Re(),Ve(17)),ai(this),this.m=2,Fa(this)):B_(this,this.T-c)};function Fa(c){c.j.I==0||c.K||fv(c.j,c)}function ai(c){Ef(c);var p=c.O;p&&typeof p.dispose=="function"&&p.dispose(),c.O=null,ge(c.V),c.g&&(p=c.g,c.g=null,p.abort(),p.dispose())}function If(c,p){try{var g=c.j;if(g.I!=0&&(g.g==c||Tf(g.h,c))){if(!c.L&&Tf(g.h,c)&&g.I==3){try{var E=g.Ba.g.parse(p)}catch{E=null}if(Array.isArray(E)&&E.length==3){var L=E;if(L[0]==0){e:if(!g.v){if(g.g)if(g.g.F+3e3<c.F)eu(g),Jc(g);else break e;Rf(g),Ve(18)}}else g.xa=L[1],0<g.xa-g.K&&L[2]<37500&&g.F&&g.A==0&&!g.C&&(g.C=ct(d(g.Va,g),6e3));H_(g.h)<=1&&g.ta&&(g.ta=void 0)}else ci(g,11)}else if((c.L||g.g==c)&&eu(g),!P(p))for(L=g.Ba.g.parse(p),p=0;p<L.length;p++){let nt=L[p];const Ft=nt[0];if(!(Ft<=g.K))if(g.K=Ft,nt=nt[1],g.I==2)if(nt[0]=="c"){g.M=nt[1],g.ba=nt[2];const _r=nt[3];_r!=null&&(g.ka=_r,g.j.info("VER="+g.ka));const ui=nt[4];ui!=null&&(g.za=ui,g.j.info("SVER="+g.za));const us=nt[5];us!=null&&typeof us=="number"&&us>0&&(E=1.5*us,g.O=E,g.j.info("backChannelRequestTimeoutMs_="+E)),E=g;const ds=c.g;if(ds){const nu=ds.g?ds.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(nu){var U=E.h;U.g||nu.indexOf("spdy")==-1&&nu.indexOf("quic")==-1&&nu.indexOf("h2")==-1||(U.j=U.l,U.g=new Set,U.h&&(xf(U,U.h),U.h=null))}if(E.G){const Nf=ds.g?ds.g.getResponseHeader("X-HTTP-Session-Id"):null;Nf&&(E.wa=Nf,ot(E.J,E.G,Nf))}}g.I=3,g.l&&g.l.ra(),g.aa&&(g.T=Date.now()-c.F,g.j.info("Handshake RTT: "+g.T+"ms")),E=g;var ee=c;if(E.na=gv(E,E.L?E.ba:null,E.W),ee.L){W_(E.h,ee);var Pe=ee,kt=E.O;kt&&(Pe.H=kt),Pe.D&&(Ef(Pe),Gc(Pe)),E.g=ee}else dv(E);g.i.length>0&&Zc(g)}else nt[0]!="stop"&&nt[0]!="close"||ci(g,7);else g.I==3&&(nt[0]=="stop"||nt[0]=="close"?nt[0]=="stop"?ci(g,7):Af(g):nt[0]!="noop"&&g.l&&g.l.qa(nt),g.A=0)}}Re(4)}catch{}}var GA=class{constructor(c,p){this.g=c,this.map=p}};function z_(c){this.l=c||10,o.PerformanceNavigationTiming?(c=o.performance.getEntriesByType("navigation"),c=c.length>0&&(c[0].nextHopProtocol=="hq"||c[0].nextHopProtocol=="h2")):c=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=c?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function q_(c){return c.h?!0:c.g?c.g.size>=c.j:!1}function H_(c){return c.h?1:c.g?c.g.size:0}function Tf(c,p){return c.h?c.h==p:c.g?c.g.has(p):!1}function xf(c,p){c.g?c.g.add(p):c.h=p}function W_(c,p){c.h&&c.h==p?c.h=null:c.g&&c.g.has(p)&&c.g.delete(p)}z_.prototype.cancel=function(){if(this.i=K_(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const c of this.g.values())c.cancel();this.g.clear()}};function K_(c){if(c.h!=null)return c.i.concat(c.h.G);if(c.g!=null&&c.g.size!==0){let p=c.i;for(const g of c.g.values())p=p.concat(g.G);return p}return v(c.i)}var G_=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function QA(c,p){if(c){c=c.split("&");for(let g=0;g<c.length;g++){const E=c[g].indexOf("=");let L,U=null;E>=0?(L=c[g].substring(0,E),U=c[g].substring(E+1)):L=c[g],p(L,U?decodeURIComponent(U.replace(/\+/g," ")):"")}}}function as(c){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let p;c instanceof as?(this.l=c.l,Ua(this,c.j),this.o=c.o,this.g=c.g,$a(this,c.u),this.h=c.h,Sf(this,ev(c.i)),this.m=c.m):c&&(p=String(c).match(G_))?(this.l=!1,Ua(this,p[1]||"",!0),this.o=Ba(p[2]||""),this.g=Ba(p[3]||"",!0),$a(this,p[4]),this.h=Ba(p[5]||"",!0),Sf(this,p[6]||"",!0),this.m=Ba(p[7]||"")):(this.l=!1,this.i=new qa(null,this.l))}as.prototype.toString=function(){const c=[];var p=this.j;p&&c.push(za(p,Q_,!0),":");var g=this.g;return(g||p=="file")&&(c.push("//"),(p=this.o)&&c.push(za(p,Q_,!0),"@"),c.push(Ma(g).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),g=this.u,g!=null&&c.push(":",String(g))),(g=this.h)&&(this.g&&g.charAt(0)!="/"&&c.push("/"),c.push(za(g,g.charAt(0)=="/"?JA:XA,!0))),(g=this.i.toString())&&c.push("?",g),(g=this.m)&&c.push("#",za(g,eR)),c.join("")},as.prototype.resolve=function(c){const p=yr(this);let g=!!c.j;g?Ua(p,c.j):g=!!c.o,g?p.o=c.o:g=!!c.g,g?p.g=c.g:g=c.u!=null;var E=c.h;if(g)$a(p,c.u);else if(g=!!c.h){if(E.charAt(0)!="/")if(this.g&&!this.h)E="/"+E;else{var L=p.h.lastIndexOf("/");L!=-1&&(E=p.h.slice(0,L+1)+E)}if(L=E,L==".."||L==".")E="";else if(L.indexOf("./")!=-1||L.indexOf("/.")!=-1){E=L.lastIndexOf("/",0)==0,L=L.split("/");const U=[];for(let ee=0;ee<L.length;){const Pe=L[ee++];Pe=="."?E&&ee==L.length&&U.push(""):Pe==".."?((U.length>1||U.length==1&&U[0]!="")&&U.pop(),E&&ee==L.length&&U.push("")):(U.push(Pe),E=!0)}E=U.join("/")}else E=L}return g?p.h=E:g=c.i.toString()!=="",g?Sf(p,ev(c.i)):g=!!c.m,g&&(p.m=c.m),p};function yr(c){return new as(c)}function Ua(c,p,g){c.j=g?Ba(p,!0):p,c.j&&(c.j=c.j.replace(/:$/,""))}function $a(c,p){if(p){if(p=Number(p),isNaN(p)||p<0)throw Error("Bad port number "+p);c.u=p}else c.u=null}function Sf(c,p,g){p instanceof qa?(c.i=p,tR(c.i,c.l)):(g||(p=za(p,ZA)),c.i=new qa(p,c.l))}function ot(c,p,g){c.i.set(p,g)}function Qc(c){return ot(c,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),c}function Ba(c,p){return c?p?decodeURI(c.replace(/%25/g,"%2525")):decodeURIComponent(c):""}function za(c,p,g){return typeof c=="string"?(c=encodeURI(c).replace(p,YA),g&&(c=c.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),c):null}function YA(c){return c=c.charCodeAt(0),"%"+(c>>4&15).toString(16)+(c&15).toString(16)}var Q_=/[#\/\?@]/g,XA=/[#\?:]/g,JA=/[#\?]/g,ZA=/[#\?@]/g,eR=/#/g;function qa(c,p){this.h=this.g=null,this.i=c||null,this.j=!!p}function li(c){c.g||(c.g=new Map,c.h=0,c.i&&QA(c.i,function(p,g){c.add(decodeURIComponent(p.replace(/\+/g," ")),g)}))}t=qa.prototype,t.add=function(c,p){li(this),this.i=null,c=lo(this,c);let g=this.g.get(c);return g||this.g.set(c,g=[]),g.push(p),this.h+=1,this};function Y_(c,p){li(c),p=lo(c,p),c.g.has(p)&&(c.i=null,c.h-=c.g.get(p).length,c.g.delete(p))}function X_(c,p){return li(c),p=lo(c,p),c.g.has(p)}t.forEach=function(c,p){li(this),this.g.forEach(function(g,E){g.forEach(function(L){c.call(p,L,E,this)},this)},this)};function J_(c,p){li(c);let g=[];if(typeof p=="string")X_(c,p)&&(g=g.concat(c.g.get(lo(c,p))));else for(c=Array.from(c.g.values()),p=0;p<c.length;p++)g=g.concat(c[p]);return g}t.set=function(c,p){return li(this),this.i=null,c=lo(this,c),X_(this,c)&&(this.h-=this.g.get(c).length),this.g.set(c,[p]),this.h+=1,this},t.get=function(c,p){return c?(c=J_(this,c),c.length>0?String(c[0]):p):p};function Z_(c,p,g){Y_(c,p),g.length>0&&(c.i=null,c.g.set(lo(c,p),v(g)),c.h+=g.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const c=[],p=Array.from(this.g.keys());for(let E=0;E<p.length;E++){var g=p[E];const L=Ma(g);g=J_(this,g);for(let U=0;U<g.length;U++){let ee=L;g[U]!==""&&(ee+="="+Ma(g[U])),c.push(ee)}}return this.i=c.join("&")};function ev(c){const p=new qa;return p.i=c.i,c.g&&(p.g=new Map(c.g),p.h=c.h),p}function lo(c,p){return p=String(p),c.j&&(p=p.toLowerCase()),p}function tR(c,p){p&&!c.j&&(li(c),c.i=null,c.g.forEach(function(g,E){const L=E.toLowerCase();E!=L&&(Y_(this,E),Z_(this,L,g))},c)),c.j=p}function nR(c,p){const g=new Ht;if(o.Image){const E=new Image;E.onload=h(ls,g,"TestLoadImage: loaded",!0,p,E),E.onerror=h(ls,g,"TestLoadImage: error",!1,p,E),E.onabort=h(ls,g,"TestLoadImage: abort",!1,p,E),E.ontimeout=h(ls,g,"TestLoadImage: timeout",!1,p,E),o.setTimeout(function(){E.ontimeout&&E.ontimeout()},1e4),E.src=c}else p(!1)}function rR(c,p){const g=new Ht,E=new AbortController,L=setTimeout(()=>{E.abort(),ls(g,"TestPingServer: timeout",!1,p)},1e4);fetch(c,{signal:E.signal}).then(U=>{clearTimeout(L),U.ok?ls(g,"TestPingServer: ok",!0,p):ls(g,"TestPingServer: server error",!1,p)}).catch(()=>{clearTimeout(L),ls(g,"TestPingServer: error",!1,p)})}function ls(c,p,g,E,L){try{L&&(L.onload=null,L.onerror=null,L.onabort=null,L.ontimeout=null),E(g)}catch{}}function sR(){this.g=new Z}function bf(c){this.i=c.Sb||null,this.h=c.ab||!1}f(bf,ae),bf.prototype.g=function(){return new Yc(this.i,this.h)};function Yc(c,p){X.call(this),this.H=c,this.o=p,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}f(Yc,X),t=Yc.prototype,t.open=function(c,p){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=c,this.D=p,this.readyState=1,Wa(this)},t.send=function(c){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const p={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};c&&(p.body=c),(this.H||o).fetch(new Request(this.D,p)).then(this.Pa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,Ha(this)),this.readyState=0},t.Pa=function(c){if(this.g&&(this.l=c,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=c.headers,this.readyState=2,Wa(this)),this.g&&(this.readyState=3,Wa(this),this.g)))if(this.responseType==="arraybuffer")c.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in c){if(this.j=c.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;tv(this)}else c.text().then(this.Oa.bind(this),this.ga.bind(this))};function tv(c){c.j.read().then(c.Ma.bind(c)).catch(c.ga.bind(c))}t.Ma=function(c){if(this.g){if(this.o&&c.value)this.response.push(c.value);else if(!this.o){var p=c.value?c.value:new Uint8Array(0);(p=this.B.decode(p,{stream:!c.done}))&&(this.response=this.responseText+=p)}c.done?Ha(this):Wa(this),this.readyState==3&&tv(this)}},t.Oa=function(c){this.g&&(this.response=this.responseText=c,Ha(this))},t.Na=function(c){this.g&&(this.response=c,Ha(this))},t.ga=function(){this.g&&Ha(this)};function Ha(c){c.readyState=4,c.l=null,c.j=null,c.B=null,Wa(c)}t.setRequestHeader=function(c,p){this.A.append(c,p)},t.getResponseHeader=function(c){return this.h&&this.h.get(c.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const c=[],p=this.h.entries();for(var g=p.next();!g.done;)g=g.value,c.push(g[0]+": "+g[1]),g=p.next();return c.join(`\r
`)};function Wa(c){c.onreadystatechange&&c.onreadystatechange.call(c)}Object.defineProperty(Yc.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(c){this.m=c?"include":"same-origin"}});function nv(c){let p="";return de(c,function(g,E){p+=E,p+=":",p+=g,p+=`\r
`}),p}function Cf(c,p,g){e:{for(E in g){var E=!1;break e}E=!0}E||(g=nv(g),typeof c=="string"?g!=null&&Ma(g):ot(c,p,g))}function wt(c){X.call(this),this.headers=new Map,this.L=c||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}f(wt,X);var iR=/^https?$/i,oR=["POST","PUT"];t=wt.prototype,t.Fa=function(c){this.H=c},t.ea=function(c,p,g,E){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+c);p=p?p.toUpperCase():"GET",this.D=c,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():L_.g(),this.g.onreadystatechange=m(d(this.Ca,this));try{this.B=!0,this.g.open(p,String(c),!0),this.B=!1}catch(U){rv(this,U);return}if(c=g||"",g=new Map(this.headers),E)if(Object.getPrototypeOf(E)===Object.prototype)for(var L in E)g.set(L,E[L]);else if(typeof E.keys=="function"&&typeof E.get=="function")for(const U of E.keys())g.set(U,E.get(U));else throw Error("Unknown input type for opt_headers: "+String(E));E=Array.from(g.keys()).find(U=>U.toLowerCase()=="content-type"),L=o.FormData&&c instanceof o.FormData,!(Array.prototype.indexOf.call(oR,p,void 0)>=0)||E||L||g.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[U,ee]of g)this.g.setRequestHeader(U,ee);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(c),this.v=!1}catch(U){rv(this,U)}};function rv(c,p){c.h=!1,c.g&&(c.j=!0,c.g.abort(),c.j=!1),c.l=p,c.o=5,sv(c),Xc(c)}function sv(c){c.A||(c.A=!0,Q(c,"complete"),Q(c,"error"))}t.abort=function(c){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=c||7,Q(this,"complete"),Q(this,"abort"),Xc(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Xc(this,!0)),wt.Z.N.call(this)},t.Ca=function(){this.u||(this.B||this.v||this.j?iv(this):this.Xa())},t.Xa=function(){iv(this)};function iv(c){if(c.h&&typeof i<"u"){if(c.v&&cs(c)==4)setTimeout(c.Ca.bind(c),0);else if(Q(c,"readystatechange"),cs(c)==4){c.h=!1;try{const U=c.ca();e:switch(U){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var p=!0;break e;default:p=!1}var g;if(!(g=p)){var E;if(E=U===0){let ee=String(c.D).match(G_)[1]||null;!ee&&o.self&&o.self.location&&(ee=o.self.location.protocol.slice(0,-1)),E=!iR.test(ee?ee.toLowerCase():"")}g=E}if(g)Q(c,"complete"),Q(c,"success");else{c.o=6;try{var L=cs(c)>2?c.g.statusText:""}catch{L=""}c.l=L+" ["+c.ca()+"]",sv(c)}}finally{Xc(c)}}}}function Xc(c,p){if(c.g){c.m&&(clearTimeout(c.m),c.m=null);const g=c.g;c.g=null,p||Q(c,"ready");try{g.onreadystatechange=null}catch{}}}t.isActive=function(){return!!this.g};function cs(c){return c.g?c.g.readyState:0}t.ca=function(){try{return cs(this)>2?this.g.status:-1}catch{return-1}},t.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.La=function(c){if(this.g){var p=this.g.responseText;return c&&p.indexOf(c)==0&&(p=p.substring(c.length)),F(p)}};function ov(c){try{if(!c.g)return null;if("response"in c.g)return c.g.response;switch(c.F){case"":case"text":return c.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in c.g)return c.g.mozResponseArrayBuffer}return null}catch{return null}}function aR(c){const p={};c=(c.g&&cs(c)>=2&&c.g.getAllResponseHeaders()||"").split(`\r
`);for(let E=0;E<c.length;E++){if(P(c[E]))continue;var g=HA(c[E]);const L=g[0];if(g=g[1],typeof g!="string")continue;g=g.trim();const U=p[L]||[];p[L]=U,U.push(g)}G(p,function(E){return E.join(", ")})}t.ya=function(){return this.o},t.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function Ka(c,p,g){return g&&g.internalChannelParams&&g.internalChannelParams[c]||p}function av(c){this.za=0,this.i=[],this.j=new Ht,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Ka("failFast",!1,c),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Ka("baseRetryDelayMs",5e3,c),this.Za=Ka("retryDelaySeedMs",1e4,c),this.Ta=Ka("forwardChannelMaxRetries",2,c),this.va=Ka("forwardChannelRequestTimeoutMs",2e4,c),this.ma=c&&c.xmlHttpFactory||void 0,this.Ua=c&&c.Rb||void 0,this.Aa=c&&c.useFetchStreams||!1,this.O=void 0,this.L=c&&c.supportsCrossDomainXhr||!1,this.M="",this.h=new z_(c&&c.concurrentRequestLimit),this.Ba=new sR,this.S=c&&c.fastHandshake||!1,this.R=c&&c.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=c&&c.Pb||!1,c&&c.ua&&this.j.ua(),c&&c.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&c&&c.detectBufferingProxy||!1,this.ia=void 0,c&&c.longPollingTimeout&&c.longPollingTimeout>0&&(this.ia=c.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}t=av.prototype,t.ka=8,t.I=1,t.connect=function(c,p,g,E){Ve(0),this.W=c,this.H=p||{},g&&E!==void 0&&(this.H.OSID=g,this.H.OAID=E),this.F=this.X,this.J=gv(this,null,this.W),Zc(this)};function Af(c){if(lv(c),c.I==3){var p=c.V++,g=yr(c.J);if(ot(g,"SID",c.M),ot(g,"RID",p),ot(g,"TYPE","terminate"),Ga(c,g),p=new os(c,c.j,p),p.M=2,p.A=Qc(yr(g)),g=!1,o.navigator&&o.navigator.sendBeacon)try{g=o.navigator.sendBeacon(p.A.toString(),"")}catch{}!g&&o.Image&&(new Image().src=p.A,g=!0),g||(p.g=yv(p.j,null),p.g.ea(p.A)),p.F=Date.now(),Gc(p)}mv(c)}function Jc(c){c.g&&(Pf(c),c.g.cancel(),c.g=null)}function lv(c){Jc(c),c.v&&(o.clearTimeout(c.v),c.v=null),eu(c),c.h.cancel(),c.m&&(typeof c.m=="number"&&o.clearTimeout(c.m),c.m=null)}function Zc(c){if(!q_(c.h)&&!c.m){c.m=!0;var p=c.Ea;V||_(),M||(V(),M=!0),T.add(p,c),c.D=0}}function lR(c,p){return H_(c.h)>=c.h.j-(c.m?1:0)?!1:c.m?(c.i=p.G.concat(c.i),!0):c.I==1||c.I==2||c.D>=(c.Sa?0:c.Ta)?!1:(c.m=ct(d(c.Ea,c,p),pv(c,c.D)),c.D++,!0)}t.Ea=function(c){if(this.m)if(this.m=null,this.I==1){if(!c){this.V=Math.floor(Math.random()*1e5),c=this.V++;const L=new os(this,this.j,c);let U=this.o;if(this.U&&(U?(U=je(U),z(U,this.U)):U=this.U),this.u!==null||this.R||(L.J=U,U=null),this.S)e:{for(var p=0,g=0;g<this.i.length;g++){t:{var E=this.i[g];if("__data__"in E.map&&(E=E.map.__data__,typeof E=="string")){E=E.length;break t}E=void 0}if(E===void 0)break;if(p+=E,p>4096){p=g;break e}if(p===4096||g===this.i.length-1){p=g+1;break e}}p=1e3}else p=1e3;p=uv(this,L,p),g=yr(this.J),ot(g,"RID",c),ot(g,"CVER",22),this.G&&ot(g,"X-HTTP-Session-Id",this.G),Ga(this,g),U&&(this.R?p="headers="+Ma(nv(U))+"&"+p:this.u&&Cf(g,this.u,U)),xf(this.h,L),this.Ra&&ot(g,"TYPE","init"),this.S?(ot(g,"$req",p),ot(g,"SID","null"),L.U=!0,wf(L,g,null)):wf(L,g,p),this.I=2}}else this.I==3&&(c?cv(this,c):this.i.length==0||q_(this.h)||cv(this))};function cv(c,p){var g;p?g=p.l:g=c.V++;const E=yr(c.J);ot(E,"SID",c.M),ot(E,"RID",g),ot(E,"AID",c.K),Ga(c,E),c.u&&c.o&&Cf(E,c.u,c.o),g=new os(c,c.j,g,c.D+1),c.u===null&&(g.J=c.o),p&&(c.i=p.G.concat(c.i)),p=uv(c,g,1e3),g.H=Math.round(c.va*.5)+Math.round(c.va*.5*Math.random()),xf(c.h,g),wf(g,E,p)}function Ga(c,p){c.H&&de(c.H,function(g,E){ot(p,E,g)}),c.l&&de({},function(g,E){ot(p,E,g)})}function uv(c,p,g){g=Math.min(c.i.length,g);const E=c.l?d(c.l.Ka,c.l,c):null;e:{var L=c.i;let Pe=-1;for(;;){const kt=["count="+g];Pe==-1?g>0?(Pe=L[0].g,kt.push("ofs="+Pe)):Pe=0:kt.push("ofs="+Pe);let nt=!0;for(let Ft=0;Ft<g;Ft++){var U=L[Ft].g;const _r=L[Ft].map;if(U-=Pe,U<0)Pe=Math.max(0,L[Ft].g-100),nt=!1;else try{U="req"+U+"_"||"";try{var ee=_r instanceof Map?_r:Object.entries(_r);for(const[ui,us]of ee){let ds=us;a(us)&&(ds=He(us)),kt.push(U+ui+"="+encodeURIComponent(ds))}}catch(ui){throw kt.push(U+"type="+encodeURIComponent("_badmap")),ui}}catch{E&&E(_r)}}if(nt){ee=kt.join("&");break e}}ee=void 0}return c=c.i.splice(0,g),p.G=c,ee}function dv(c){if(!c.g&&!c.v){c.Y=1;var p=c.Da;V||_(),M||(V(),M=!0),T.add(p,c),c.A=0}}function Rf(c){return c.g||c.v||c.A>=3?!1:(c.Y++,c.v=ct(d(c.Da,c),pv(c,c.A)),c.A++,!0)}t.Da=function(){if(this.v=null,hv(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var c=4*this.T;this.j.info("BP detection timer enabled: "+c),this.B=ct(d(this.Wa,this),c)}},t.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,Ve(10),Jc(this),hv(this))};function Pf(c){c.B!=null&&(o.clearTimeout(c.B),c.B=null)}function hv(c){c.g=new os(c,c.j,"rpc",c.Y),c.u===null&&(c.g.J=c.o),c.g.P=0;var p=yr(c.na);ot(p,"RID","rpc"),ot(p,"SID",c.M),ot(p,"AID",c.K),ot(p,"CI",c.F?"0":"1"),!c.F&&c.ia&&ot(p,"TO",c.ia),ot(p,"TYPE","xmlhttp"),Ga(c,p),c.u&&c.o&&Cf(p,c.u,c.o),c.O&&(c.g.H=c.O);var g=c.g;c=c.ba,g.M=1,g.A=Qc(yr(p)),g.u=null,g.R=!0,U_(g,c)}t.Va=function(){this.C!=null&&(this.C=null,Jc(this),Rf(this),Ve(19))};function eu(c){c.C!=null&&(o.clearTimeout(c.C),c.C=null)}function fv(c,p){var g=null;if(c.g==p){eu(c),Pf(c),c.g=null;var E=2}else if(Tf(c.h,p))g=p.G,W_(c.h,p),E=1;else return;if(c.I!=0){if(p.o)if(E==1){g=p.u?p.u.length:0,p=Date.now()-p.F;var L=c.D;E=pe(),Q(E,new gr(E,g)),Zc(c)}else dv(c);else if(L=p.m,L==3||L==0&&p.X>0||!(E==1&&lR(c,p)||E==2&&Rf(c)))switch(g&&g.length>0&&(p=c.h,p.i=p.i.concat(g)),L){case 1:ci(c,5);break;case 4:ci(c,10);break;case 3:ci(c,6);break;default:ci(c,2)}}}function pv(c,p){let g=c.Qa+Math.floor(Math.random()*c.Za);return c.isActive()||(g*=2),g*p}function ci(c,p){if(c.j.info("Error code "+p),p==2){var g=d(c.bb,c),E=c.Ua;const L=!E;E=new as(E||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||Ua(E,"https"),Qc(E),L?nR(E.toString(),g):rR(E.toString(),g)}else Ve(2);c.I=0,c.l&&c.l.pa(p),mv(c),lv(c)}t.bb=function(c){c?(this.j.info("Successfully pinged google.com"),Ve(2)):(this.j.info("Failed to ping google.com"),Ve(1))};function mv(c){if(c.I=0,c.ja=[],c.l){const p=K_(c.h);(p.length!=0||c.i.length!=0)&&(R(c.ja,p),R(c.ja,c.i),c.h.i.length=0,v(c.i),c.i.length=0),c.l.oa()}}function gv(c,p,g){var E=g instanceof as?yr(g):new as(g);if(E.g!="")p&&(E.g=p+"."+E.g),$a(E,E.u);else{var L=o.location;E=L.protocol,p=p?p+"."+L.hostname:L.hostname,L=+L.port;const U=new as(null);E&&Ua(U,E),p&&(U.g=p),L&&$a(U,L),g&&(U.h=g),E=U}return g=c.G,p=c.wa,g&&p&&ot(E,g,p),ot(E,"VER",c.ka),Ga(c,E),E}function yv(c,p,g){if(p&&!c.L)throw Error("Can't create secondary domain capable XhrIo object.");return p=c.Aa&&!c.ma?new wt(new bf({ab:g})):new wt(c.ma),p.Fa(c.L),p}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function _v(){}t=_v.prototype,t.ra=function(){},t.qa=function(){},t.pa=function(){},t.oa=function(){},t.isActive=function(){return!0},t.Ka=function(){};function tu(){}tu.prototype.g=function(c,p){return new Pn(c,p)};function Pn(c,p){X.call(this),this.g=new av(p),this.l=c,this.h=p&&p.messageUrlParams||null,c=p&&p.messageHeaders||null,p&&p.clientProtocolHeaderRequired&&(c?c["X-Client-Protocol"]="webchannel":c={"X-Client-Protocol":"webchannel"}),this.g.o=c,c=p&&p.initMessageHeaders||null,p&&p.messageContentType&&(c?c["X-WebChannel-Content-Type"]=p.messageContentType:c={"X-WebChannel-Content-Type":p.messageContentType}),p&&p.sa&&(c?c["X-WebChannel-Client-Profile"]=p.sa:c={"X-WebChannel-Client-Profile":p.sa}),this.g.U=c,(c=p&&p.Qb)&&!P(c)&&(this.g.u=c),this.A=p&&p.supportsCrossDomainXhr||!1,this.v=p&&p.sendRawJson||!1,(p=p&&p.httpSessionIdParam)&&!P(p)&&(this.g.G=p,c=this.h,c!==null&&p in c&&(c=this.h,p in c&&delete c[p])),this.j=new co(this)}f(Pn,X),Pn.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},Pn.prototype.close=function(){Af(this.g)},Pn.prototype.o=function(c){var p=this.g;if(typeof c=="string"){var g={};g.__data__=c,c=g}else this.v&&(g={},g.__data__=He(c),c=g);p.i.push(new GA(p.Ya++,c)),p.I==3&&Zc(p)},Pn.prototype.N=function(){this.g.l=null,delete this.j,Af(this.g),delete this.g,Pn.Z.N.call(this)};function vv(c){Mt.call(this),c.__headers__&&(this.headers=c.__headers__,this.statusCode=c.__status__,delete c.__headers__,delete c.__status__);var p=c.__sm__;if(p){e:{for(const g in p){c=g;break e}c=void 0}(this.i=c)&&(c=this.i,p=p!==null&&c in p?p[c]:void 0),this.data=p}else this.data=c}f(vv,Mt);function wv(){x.call(this),this.status=1}f(wv,x);function co(c){this.g=c}f(co,_v),co.prototype.ra=function(){Q(this.g,"a")},co.prototype.qa=function(c){Q(this.g,new vv(c))},co.prototype.pa=function(c){Q(this.g,new wv)},co.prototype.oa=function(){Q(this.g,"b")},tu.prototype.createWebChannel=tu.prototype.g,Pn.prototype.send=Pn.prototype.o,Pn.prototype.open=Pn.prototype.m,Pn.prototype.close=Pn.prototype.close,QS=function(){return new tu},GS=function(){return pe()},KS=B,Vm={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},Kc.NO_ERROR=0,Kc.TIMEOUT=8,Kc.HTTP_ERROR=6,Ju=Kc,V_.COMPLETE="complete",WS=V_,Ae.EventType=vt,vt.OPEN="a",vt.CLOSE="b",vt.ERROR="c",vt.MESSAGE="d",X.prototype.listen=X.prototype.J,yl=Ae,wt.prototype.listenOnce=wt.prototype.K,wt.prototype.getLastError=wt.prototype.Ha,wt.prototype.getLastErrorCode=wt.prototype.ya,wt.prototype.getStatus=wt.prototype.ca,wt.prototype.getResponseJson=wt.prototype.La,wt.prototype.getResponseText=wt.prototype.la,wt.prototype.send=wt.prototype.ea,wt.prototype.setWithCredentials=wt.prototype.Fa,HS=wt}).apply(typeof Iu<"u"?Iu:typeof self<"u"?self:typeof window<"u"?window:{});const mE="@firebase/firestore",gE="4.9.2";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gt{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Gt.UNAUTHENTICATED=new Gt(null),Gt.GOOGLE_CREDENTIALS=new Gt("google-credentials-uid"),Gt.FIRST_PARTY=new Gt("first-party-uid"),Gt.MOCK_USER=new Gt("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Na="12.3.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bi=new Nh("@firebase/firestore");function So(){return Bi.logLevel}function H(t,...e){if(Bi.logLevel<=Le.DEBUG){const n=e.map(Sy);Bi.debug(`Firestore (${Na}): ${t}`,...n)}}function pn(t,...e){if(Bi.logLevel<=Le.ERROR){const n=e.map(Sy);Bi.error(`Firestore (${Na}): ${t}`,...n)}}function zi(t,...e){if(Bi.logLevel<=Le.WARN){const n=e.map(Sy);Bi.warn(`Firestore (${Na}): ${t}`,...n)}}function Sy(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function le(t,e,n){let r="Unexpected state";typeof e=="string"?r=e:n=e,YS(t,r,n)}function YS(t,e,n){let r=`FIRESTORE (${Na}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(n!==void 0)try{r+=" CONTEXT: "+JSON.stringify(n)}catch{r+=" CONTEXT: "+n}throw pn(r),new Error(r)}function ue(t,e,n,r){let s="Unexpected state";typeof n=="string"?s=n:r=n,t||YS(e,s,r)}function Ee(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class K extends Zn{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cr{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XS{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class X2{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(Gt.UNAUTHENTICATED))}shutdown(){}}class J2{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class Z2{constructor(e){this.t=e,this.currentUser=Gt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){ue(this.o===void 0,42304);let r=this.i;const s=l=>this.i!==r?(r=this.i,n(l)):Promise.resolve();let i=new cr;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new cr,e.enqueueRetryable(()=>s(this.currentUser))};const o=()=>{const l=i;e.enqueueRetryable(async()=>{await l.promise,await s(this.currentUser)})},a=l=>{H("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(l=>a(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?a(l):(H("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new cr)}},0),o()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(H("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(ue(typeof r.accessToken=="string",31837,{l:r}),new XS(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return ue(e===null||typeof e=="string",2055,{h:e}),new Gt(e)}}class eO{constructor(e,n,r){this.P=e,this.T=n,this.I=r,this.type="FirstParty",this.user=Gt.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class tO{constructor(e,n,r){this.P=e,this.T=n,this.I=r}getToken(){return Promise.resolve(new eO(this.P,this.T,this.I))}start(e,n){e.enqueueRetryable(()=>n(Gt.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class yE{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class nO{constructor(e,n){this.V=n,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,zn(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,n){ue(this.o===void 0,3512);const r=i=>{i.error!=null&&H("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.m;return this.m=i.token,H("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>r(i))};const s=i=>{H("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(i=>s(i)),setTimeout(()=>{if(!this.appCheck){const i=this.V.getImmediate({optional:!0});i?s(i):H("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new yE(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(ue(typeof n.token=="string",44558,{tokenResult:n}),this.m=n.token,new yE(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rO(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class by{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const s=rO(40);for(let i=0;i<s.length;++i)r.length<20&&s[i]<n&&(r+=e.charAt(s[i]%62))}return r}}function Te(t,e){return t<e?-1:t>e?1:0}function Lm(t,e){const n=Math.min(t.length,e.length);for(let r=0;r<n;r++){const s=t.charAt(r),i=e.charAt(r);if(s!==i)return fp(s)===fp(i)?Te(s,i):fp(s)?1:-1}return Te(t.length,e.length)}const sO=55296,iO=57343;function fp(t){const e=t.charCodeAt(0);return e>=sO&&e<=iO}function ua(t,e,n){return t.length===e.length&&t.every((r,s)=>n(r,e[s]))}function JS(t){return t+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _E="__name__";class Tr{constructor(e,n,r){n===void 0?n=0:n>e.length&&le(637,{offset:n,range:e.length}),r===void 0?r=e.length-n:r>e.length-n&&le(1746,{length:r,range:e.length-n}),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return Tr.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof Tr?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let s=0;s<r;s++){const i=Tr.compareSegments(e.get(s),n.get(s));if(i!==0)return i}return Te(e.length,n.length)}static compareSegments(e,n){const r=Tr.isNumericId(e),s=Tr.isNumericId(n);return r&&!s?-1:!r&&s?1:r&&s?Tr.extractNumericId(e).compare(Tr.extractNumericId(n)):Lm(e,n)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Bs.fromString(e.substring(4,e.length-2))}}class We extends Tr{construct(e,n,r){return new We(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new K($.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(s=>s.length>0))}return new We(n)}static emptyPath(){return new We([])}}const oO=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class gt extends Tr{construct(e,n,r){return new gt(e,n,r)}static isValidIdentifier(e){return oO.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),gt.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===_E}static keyField(){return new gt([_E])}static fromServerFormat(e){const n=[];let r="",s=0;const i=()=>{if(r.length===0)throw new K($.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let o=!1;for(;s<e.length;){const a=e[s];if(a==="\\"){if(s+1===e.length)throw new K($.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[s+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new K($.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=l,s+=2}else a==="`"?(o=!o,s++):a!=="."||o?(r+=a,s++):(i(),s++)}if(i(),o)throw new K($.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new gt(n)}static emptyPath(){return new gt([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class te{constructor(e){this.path=e}static fromPath(e){return new te(We.fromString(e))}static fromName(e){return new te(We.fromString(e).popFirst(5))}static empty(){return new te(We.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&We.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return We.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new te(new We(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZS(t,e,n){if(!n)throw new K($.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function aO(t,e,n,r){if(e===!0&&r===!0)throw new K($.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function vE(t){if(!te.isDocumentKey(t))throw new K($.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function wE(t){if(te.isDocumentKey(t))throw new K($.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function eb(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function Lh(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":le(12329,{type:typeof t})}function cn(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new K($.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Lh(t);throw new K($.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}function lO(t,e){if(e<=0)throw new K($.INVALID_ARGUMENT,`Function ${t}() requires a positive number, but it was: ${e}.`)}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rt(t,e){const n={typeString:t};return e&&(n.value=e),n}function jc(t,e){if(!eb(t))throw new K($.INVALID_ARGUMENT,"JSON must be an object");let n;for(const r in e)if(e[r]){const s=e[r].typeString,i="value"in e[r]?{value:e[r].value}:void 0;if(!(r in t)){n=`JSON missing required field: '${r}'`;break}const o=t[r];if(s&&typeof o!==s){n=`JSON field '${r}' must be a ${s}.`;break}if(i!==void 0&&o!==i.value){n=`Expected '${r}' field to equal '${i.value}'`;break}}if(n)throw new K($.INVALID_ARGUMENT,n);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EE=-62135596800,IE=1e6;class Be{static now(){return Be.fromMillis(Date.now())}static fromDate(e){return Be.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor((e-1e3*n)*IE);return new Be(n,r)}constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new K($.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new K($.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<EE)throw new K($.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new K($.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/IE}_compareTo(e){return this.seconds===e.seconds?Te(this.nanoseconds,e.nanoseconds):Te(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:Be._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(jc(e,Be._jsonSchema))return new Be(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-EE;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}Be._jsonSchemaVersion="firestore/timestamp/1.0",Be._jsonSchema={type:Rt("string",Be._jsonSchemaVersion),seconds:Rt("number"),nanoseconds:Rt("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class me{static fromTimestamp(e){return new me(e)}static min(){return new me(new Be(0,0))}static max(){return new me(new Be(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dc=-1;class qd{constructor(e,n,r,s){this.indexId=e,this.collectionGroup=n,this.fields=r,this.indexState=s}}function Mm(t){return t.fields.find(e=>e.kind===2)}function gi(t){return t.fields.filter(e=>e.kind!==2)}qd.UNKNOWN_ID=-1;class Zu{constructor(e,n){this.fieldPath=e,this.kind=n}}class hc{constructor(e,n){this.sequenceNumber=e,this.offset=n}static empty(){return new hc(0,Mn.min())}}function cO(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,s=me.fromTimestamp(r===1e9?new Be(n+1,0):new Be(n,r));return new Mn(s,te.empty(),e)}function tb(t){return new Mn(t.readTime,t.key,dc)}class Mn{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new Mn(me.min(),te.empty(),dc)}static max(){return new Mn(me.max(),te.empty(),dc)}}function Cy(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=te.comparator(t.documentKey,e.documentKey),n!==0?n:Te(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nb="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class rb{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function oo(t){if(t.code!==$.FAILED_PRECONDITION||t.message!==nb)throw t;H("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&le(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new O((r,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(r,s)},this.catchCallback=i=>{this.wrapFailure(n,i).next(r,s)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof O?n:O.resolve(n)}catch(n){return O.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):O.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):O.reject(n)}static resolve(e){return new O((n,r)=>{n(e)})}static reject(e){return new O((n,r)=>{r(e)})}static waitFor(e){return new O((n,r)=>{let s=0,i=0,o=!1;e.forEach(a=>{++s,a.next(()=>{++i,o&&i===s&&n()},l=>r(l))}),o=!0,i===s&&n()})}static or(e){let n=O.resolve(!1);for(const r of e)n=n.next(s=>s?O.resolve(s):r());return n}static forEach(e,n){const r=[];return e.forEach((s,i)=>{r.push(n.call(this,s,i))}),this.waitFor(r)}static mapArray(e,n){return new O((r,s)=>{const i=e.length,o=new Array(i);let a=0;for(let l=0;l<i;l++){const d=l;n(e[d]).next(h=>{o[d]=h,++a,a===i&&r(o)},h=>s(h))}})}static doWhile(e,n){return new O((r,s)=>{const i=()=>{e()===!0?n().next(()=>{i()},s):r()};i()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kn="SimpleDb";class Mh{static open(e,n,r,s){try{return new Mh(n,e.transaction(s,r))}catch(i){throw new Ol(n,i)}}constructor(e,n){this.action=e,this.transaction=n,this.aborted=!1,this.S=new cr,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{n.error?this.S.reject(new Ol(e,n.error)):this.S.resolve()},this.transaction.onerror=r=>{const s=Ay(r.target.error);this.S.reject(new Ol(e,s))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(H(kn,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}C(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const n=this.transaction.objectStore(e);return new dO(n)}}class zs{static delete(e){return H(kn,"Removing database:",e),_i(Kx().indexedDB.deleteDatabase(e)).toPromise()}static v(){if(!fy())return!1;if(zs.F())return!0;const e=Ot(),n=zs.M(e),r=0<n&&n<10,s=sb(e),i=0<s&&s<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||i)}static F(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)==null?void 0:e.__PRIVATE_USE_MOCK_PERSISTENCE)==="YES"}static O(e,n){return e.store(n)}static M(e){const n=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=n?n[1].split("_").slice(0,2).join("."):"-1";return Number(r)}constructor(e,n,r){this.name=e,this.version=n,this.N=r,this.B=null,zs.M(Ot())===12.2&&pn("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async L(e){return this.db||(H(kn,"Opening database:",this.name),this.db=await new Promise((n,r)=>{const s=indexedDB.open(this.name,this.version);s.onsuccess=i=>{const o=i.target.result;n(o)},s.onblocked=()=>{r(new Ol(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},s.onerror=i=>{const o=i.target.error;o.name==="VersionError"?r(new K($.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?r(new K($.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):r(new Ol(e,o))},s.onupgradeneeded=i=>{H(kn,'Database "'+this.name+'" requires upgrade from version:',i.oldVersion);const o=i.target.result;this.N.k(o,s.transaction,i.oldVersion,this.version).next(()=>{H(kn,"Database upgrade to version "+this.version+" complete")})}})),this.q&&(this.db.onversionchange=n=>this.q(n)),this.db}$(e){this.q=e,this.db&&(this.db.onversionchange=n=>e(n))}async runTransaction(e,n,r,s){const i=n==="readonly";let o=0;for(;;){++o;try{this.db=await this.L(e);const a=Mh.open(this.db,e,i?"readonly":"readwrite",r),l=s(a).next(d=>(a.C(),d)).catch(d=>(a.abort(d),O.reject(d))).toPromise();return l.catch(()=>{}),await a.D,l}catch(a){const l=a,d=l.name!=="FirebaseError"&&o<3;if(H(kn,"Transaction failed with error:",l.message,"Retrying:",d),this.close(),!d)return Promise.reject(l)}}}close(){this.db&&this.db.close(),this.db=void 0}}function sb(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}class uO{constructor(e){this.U=e,this.K=!1,this.W=null}get isDone(){return this.K}get G(){return this.W}set cursor(e){this.U=e}done(){this.K=!0}j(e){this.W=e}delete(){return _i(this.U.delete())}}class Ol extends K{constructor(e,n){super($.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${n}`),this.name="IndexedDbTransactionError"}}function si(t){return t.name==="IndexedDbTransactionError"}class dO{constructor(e){this.store=e}put(e,n){let r;return n!==void 0?(H(kn,"PUT",this.store.name,e,n),r=this.store.put(n,e)):(H(kn,"PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),_i(r)}add(e){return H(kn,"ADD",this.store.name,e,e),_i(this.store.add(e))}get(e){return _i(this.store.get(e)).next(n=>(n===void 0&&(n=null),H(kn,"GET",this.store.name,e,n),n))}delete(e){return H(kn,"DELETE",this.store.name,e),_i(this.store.delete(e))}count(){return H(kn,"COUNT",this.store.name),_i(this.store.count())}J(e,n){const r=this.options(e,n),s=r.index?this.store.index(r.index):this.store;if(typeof s.getAll=="function"){const i=s.getAll(r.range);return new O((o,a)=>{i.onerror=l=>{a(l.target.error)},i.onsuccess=l=>{o(l.target.result)}})}{const i=this.cursor(r),o=[];return this.H(i,(a,l)=>{o.push(l)}).next(()=>o)}}Y(e,n){const r=this.store.getAll(e,n===null?void 0:n);return new O((s,i)=>{r.onerror=o=>{i(o.target.error)},r.onsuccess=o=>{s(o.target.result)}})}Z(e,n){H(kn,"DELETE ALL",this.store.name);const r=this.options(e,n);r.X=!1;const s=this.cursor(r);return this.H(s,(i,o,a)=>a.delete())}ee(e,n){let r;n?r=e:(r={},n=e);const s=this.cursor(r);return this.H(s,n)}te(e){const n=this.cursor({});return new O((r,s)=>{n.onerror=i=>{const o=Ay(i.target.error);s(o)},n.onsuccess=i=>{const o=i.target.result;o?e(o.primaryKey,o.value).next(a=>{a?o.continue():r()}):r()}})}H(e,n){const r=[];return new O((s,i)=>{e.onerror=o=>{i(o.target.error)},e.onsuccess=o=>{const a=o.target.result;if(!a)return void s();const l=new uO(a),d=n(a.primaryKey,a.value,l);if(d instanceof O){const h=d.catch(f=>(l.done(),O.reject(f)));r.push(h)}l.isDone?s():l.G===null?a.continue():a.continue(l.G)}}).next(()=>O.waitFor(r))}options(e,n){let r;return e!==void 0&&(typeof e=="string"?r=e:n=e),{index:r,range:n}}cursor(e){let n="next";if(e.reverse&&(n="prev"),e.index){const r=this.store.index(e.index);return e.X?r.openKeyCursor(e.range,n):r.openCursor(e.range,n)}return this.store.openCursor(e.range,n)}}function _i(t){return new O((e,n)=>{t.onsuccess=r=>{const s=r.target.result;e(s)},t.onerror=r=>{const s=Ay(r.target.error);n(s)}})}let TE=!1;function Ay(t){const e=zs.M(Ot());if(e>=12.2&&e<13){const n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){const r=new K("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${n}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return TE||(TE=!0,setTimeout(()=>{throw r},0)),r}}return t}const Vl="IndexBackfiller";class hO{constructor(e,n){this.asyncQueue=e,this.ne=n,this.task=null}start(){this.re(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}re(e){H(Vl,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{const n=await this.ne.ie();H(Vl,`Documents written: ${n}`)}catch(n){si(n)?H(Vl,"Ignoring IndexedDB error during index backfill: ",n):await oo(n)}await this.re(6e4)})}}class fO{constructor(e,n){this.localStore=e,this.persistence=n}async ie(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",n=>this.se(n,e))}se(e,n){const r=new Set;let s=n,i=!0;return O.doWhile(()=>i===!0&&s>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(o!==null&&!r.has(o))return H(Vl,`Processing collection: ${o}`),this.oe(e,o,s).next(a=>{s-=a,r.add(o)});i=!1})).next(()=>n-s)}oe(e,n,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,n).next(s=>this.localStore.localDocuments.getNextDocuments(e,n,s,r).next(i=>{const o=i.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this._e(s,i)).next(a=>(H(Vl,`Updating offset: ${a}`),this.localStore.indexManager.updateCollectionGroup(e,n,a))).next(()=>o.size)}))}_e(e,n){let r=e;return n.changes.forEach((s,i)=>{const o=tb(i);Cy(o,r)>0&&(r=o)}),new Mn(r.readTime,r.documentKey,Math.max(n.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wn{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ae(r),this.ue=r=>n.writeSequenceNumber(r))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}Wn.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pi=-1;function Fh(t){return t==null}function fc(t){return t===0&&1/t==-1/0}function pO(t){return typeof t=="number"&&Number.isInteger(t)&&!fc(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hd="";function un(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=xE(e)),e=mO(t.get(n),e);return xE(e)}function mO(t,e){let n=e;const r=t.length;for(let s=0;s<r;s++){const i=t.charAt(s);switch(i){case"\0":n+="";break;case Hd:n+="";break;default:n+=i}}return n}function xE(t){return t+Hd+""}function Sr(t){const e=t.length;if(ue(e>=2,64408,{path:t}),e===2)return ue(t.charAt(0)===Hd&&t.charAt(1)==="",56145,{path:t}),We.emptyPath();const n=e-2,r=[];let s="";for(let i=0;i<e;){const o=t.indexOf(Hd,i);switch((o<0||o>n)&&le(50515,{path:t}),t.charAt(o+1)){case"":const a=t.substring(i,o);let l;s.length===0?l=a:(s+=a,l=s,s=""),r.push(l);break;case"":s+=t.substring(i,o),s+="\0";break;case"":s+=t.substring(i,o+1);break;default:le(61167,{path:t})}i=o+2}return new We(r)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yi="remoteDocuments",Oc="owner",ho="owner",pc="mutationQueues",gO="userId",rr="mutations",SE="batchId",bi="userMutationsIndex",bE=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ed(t,e){return[t,un(e)]}function ib(t,e,n){return[t,un(e),n]}const yO={},da="documentMutations",Wd="remoteDocumentsV14",_O=["prefixPath","collectionGroup","readTime","documentId"],td="documentKeyIndex",vO=["prefixPath","collectionGroup","documentId"],ob="collectionGroupIndex",wO=["collectionGroup","readTime","prefixPath","documentId"],mc="remoteDocumentGlobal",Fm="remoteDocumentGlobalKey",ha="targets",ab="queryTargetsIndex",EO=["canonicalId","targetId"],fa="targetDocuments",IO=["targetId","path"],Ry="documentTargetsIndex",TO=["path","targetId"],Kd="targetGlobalKey",Ni="targetGlobal",gc="collectionParents",xO=["collectionId","parent"],pa="clientMetadata",SO="clientId",Uh="bundles",bO="bundleId",$h="namedQueries",CO="name",Py="indexConfiguration",AO="indexId",Um="collectionGroupIndex",RO="collectionGroup",Ll="indexState",PO=["indexId","uid"],lb="sequenceNumberIndex",NO=["uid","sequenceNumber"],Ml="indexEntries",kO=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],cb="documentKeyIndex",DO=["indexId","uid","orderedDocumentKey"],Bh="documentOverlays",jO=["userId","collectionPath","documentId"],$m="collectionPathOverlayIndex",OO=["userId","collectionPath","largestBatchId"],ub="collectionGroupOverlayIndex",VO=["userId","collectionGroup","largestBatchId"],Ny="globals",LO="name",db=[pc,rr,da,yi,ha,Oc,Ni,fa,pa,mc,gc,Uh,$h],MO=[...db,Bh],hb=[pc,rr,da,Wd,ha,Oc,Ni,fa,pa,mc,gc,Uh,$h,Bh],fb=hb,ky=[...fb,Py,Ll,Ml],FO=ky,pb=[...ky,Ny],UO=pb;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bm extends rb{constructor(e,n){super(),this.le=e,this.currentSequenceNumber=n}}function Vt(t,e){const n=Ee(t);return zs.O(n.le,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function CE(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function ii(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function $O(t,e){const n=[];for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&n.push(e(t[r],r,t));return n}function mb(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ft{constructor(e,n){this.comparator=e,this.root=n||Qt.EMPTY}insert(e,n){return new ft(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,Qt.BLACK,null,null))}remove(e){return new ft(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Qt.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(e,r.key);if(s===0)return n+r.left.size;s<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Tu(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Tu(this.root,e,this.comparator,!1)}getReverseIterator(){return new Tu(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Tu(this.root,e,this.comparator,!0)}}class Tu{constructor(e,n,r,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=n?r(e.key,n):1,n&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Qt{constructor(e,n,r,s,i){this.key=e,this.value=n,this.color=r??Qt.RED,this.left=s??Qt.EMPTY,this.right=i??Qt.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,s,i){return new Qt(e??this.key,n??this.value,r??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let s=this;const i=r(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,n,r),null):i===0?s.copy(null,n,null,null,null):s.copy(null,null,null,null,s.right.insert(e,n,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return Qt.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,s=this;if(n(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,n),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),n(e,s.key)===0){if(s.right.isEmpty())return Qt.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,n))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Qt.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Qt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw le(43730,{key:this.key,value:this.value});if(this.right.isRed())throw le(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw le(27949);return e+(this.isRed()?0:1)}}Qt.EMPTY=null,Qt.RED=!0,Qt.BLACK=!1;Qt.EMPTY=new class{constructor(){this.size=0}get key(){throw le(57766)}get value(){throw le(16141)}get color(){throw le(16727)}get left(){throw le(29726)}get right(){throw le(36894)}copy(e,n,r,s,i){return this}insert(e,n,r){return new Qt(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tt{constructor(e){this.comparator=e,this.data=new ft(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,e[1])>=0)return;n(s.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new AE(this.data.getIterator())}getIteratorFrom(e){return new AE(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof tt)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new tt(this.comparator);return n.data=e,n}}class AE{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function fo(t){return t.hasNext()?t.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sn{constructor(e){this.fields=e,e.sort(gt.comparator)}static empty(){return new Sn([])}unionWith(e){let n=new tt(gt.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new Sn(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return ua(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gb extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pt{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(s){try{return atob(s)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new gb("Invalid base64 string: "+i):i}}(e);return new Pt(n)}static fromUint8Array(e){const n=function(s){let i="";for(let o=0;o<s.length;++o)i+=String.fromCharCode(s[o]);return i}(e);return new Pt(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Te(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Pt.EMPTY_BYTE_STRING=new Pt("");const BO=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function es(t){if(ue(!!t,39018),typeof t=="string"){let e=0;const n=BO.exec(t);if(ue(!!n,46558,{timestamp:t}),n[1]){let s=n[1];s=(s+"000000000").substr(0,9),e=Number(s)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:ut(t.seconds),nanos:ut(t.nanos)}}function ut(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function ts(t){return typeof t=="string"?Pt.fromBase64String(t):Pt.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yb="server_timestamp",_b="__type__",vb="__previous_value__",wb="__local_write_time__";function zh(t){var n,r;return((r=(((n=t==null?void 0:t.mapValue)==null?void 0:n.fields)||{})[_b])==null?void 0:r.stringValue)===yb}function qh(t){const e=t.mapValue.fields[vb];return zh(e)?qh(e):e}function yc(t){const e=es(t.mapValue.fields[wb].timestampValue);return new Be(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zO{constructor(e,n,r,s,i,o,a,l,d,h){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=s,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=l,this.useFetchStreams=d,this.isUsingEmulator=h}}const Gd="(default)";class qi{constructor(e,n){this.projectId=e,this.database=n||Gd}static empty(){return new qi("","")}get isDefaultDatabase(){return this.database===Gd}isEqual(e){return e instanceof qi&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dy="__type__",Eb="__max__",Ps={mapValue:{fields:{__type__:{stringValue:Eb}}}},jy="__vector__",ma="value",nd={nullValue:"NULL_VALUE"};function Ks(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?zh(t)?4:Ib(t)?9007199254740991:Hh(t)?10:11:le(28295,{value:t})}function jr(t,e){if(t===e)return!0;const n=Ks(t);if(n!==Ks(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return yc(t).isEqual(yc(e));case 3:return function(s,i){if(typeof s.timestampValue=="string"&&typeof i.timestampValue=="string"&&s.timestampValue.length===i.timestampValue.length)return s.timestampValue===i.timestampValue;const o=es(s.timestampValue),a=es(i.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(s,i){return ts(s.bytesValue).isEqual(ts(i.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(s,i){return ut(s.geoPointValue.latitude)===ut(i.geoPointValue.latitude)&&ut(s.geoPointValue.longitude)===ut(i.geoPointValue.longitude)}(t,e);case 2:return function(s,i){if("integerValue"in s&&"integerValue"in i)return ut(s.integerValue)===ut(i.integerValue);if("doubleValue"in s&&"doubleValue"in i){const o=ut(s.doubleValue),a=ut(i.doubleValue);return o===a?fc(o)===fc(a):isNaN(o)&&isNaN(a)}return!1}(t,e);case 9:return ua(t.arrayValue.values||[],e.arrayValue.values||[],jr);case 10:case 11:return function(s,i){const o=s.mapValue.fields||{},a=i.mapValue.fields||{};if(CE(o)!==CE(a))return!1;for(const l in o)if(o.hasOwnProperty(l)&&(a[l]===void 0||!jr(o[l],a[l])))return!1;return!0}(t,e);default:return le(52216,{left:t})}}function _c(t,e){return(t.values||[]).find(n=>jr(n,e))!==void 0}function Gs(t,e){if(t===e)return 0;const n=Ks(t),r=Ks(e);if(n!==r)return Te(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return Te(t.booleanValue,e.booleanValue);case 2:return function(i,o){const a=ut(i.integerValue||i.doubleValue),l=ut(o.integerValue||o.doubleValue);return a<l?-1:a>l?1:a===l?0:isNaN(a)?isNaN(l)?0:-1:1}(t,e);case 3:return RE(t.timestampValue,e.timestampValue);case 4:return RE(yc(t),yc(e));case 5:return Lm(t.stringValue,e.stringValue);case 6:return function(i,o){const a=ts(i),l=ts(o);return a.compareTo(l)}(t.bytesValue,e.bytesValue);case 7:return function(i,o){const a=i.split("/"),l=o.split("/");for(let d=0;d<a.length&&d<l.length;d++){const h=Te(a[d],l[d]);if(h!==0)return h}return Te(a.length,l.length)}(t.referenceValue,e.referenceValue);case 8:return function(i,o){const a=Te(ut(i.latitude),ut(o.latitude));return a!==0?a:Te(ut(i.longitude),ut(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return PE(t.arrayValue,e.arrayValue);case 10:return function(i,o){var m,v,R,b;const a=i.fields||{},l=o.fields||{},d=(m=a[ma])==null?void 0:m.arrayValue,h=(v=l[ma])==null?void 0:v.arrayValue,f=Te(((R=d==null?void 0:d.values)==null?void 0:R.length)||0,((b=h==null?void 0:h.values)==null?void 0:b.length)||0);return f!==0?f:PE(d,h)}(t.mapValue,e.mapValue);case 11:return function(i,o){if(i===Ps.mapValue&&o===Ps.mapValue)return 0;if(i===Ps.mapValue)return 1;if(o===Ps.mapValue)return-1;const a=i.fields||{},l=Object.keys(a),d=o.fields||{},h=Object.keys(d);l.sort(),h.sort();for(let f=0;f<l.length&&f<h.length;++f){const m=Lm(l[f],h[f]);if(m!==0)return m;const v=Gs(a[l[f]],d[h[f]]);if(v!==0)return v}return Te(l.length,h.length)}(t.mapValue,e.mapValue);default:throw le(23264,{he:n})}}function RE(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return Te(t,e);const n=es(t),r=es(e),s=Te(n.seconds,r.seconds);return s!==0?s:Te(n.nanos,r.nanos)}function PE(t,e){const n=t.values||[],r=e.values||[];for(let s=0;s<n.length&&s<r.length;++s){const i=Gs(n[s],r[s]);if(i)return i}return Te(n.length,r.length)}function ga(t){return zm(t)}function zm(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=es(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return ts(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return te.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",s=!0;for(const i of n.values||[])s?s=!1:r+=",",r+=zm(i);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let s="{",i=!0;for(const o of r)i?i=!1:s+=",",s+=`${o}:${zm(n.fields[o])}`;return s+"}"}(t.mapValue):le(61005,{value:t})}function rd(t){switch(Ks(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=qh(t);return e?16+rd(e):16;case 5:return 2*t.stringValue.length;case 6:return ts(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return function(r){return(r.values||[]).reduce((s,i)=>s+rd(i),0)}(t.arrayValue);case 10:case 11:return function(r){let s=0;return ii(r.fields,(i,o)=>{s+=i.length+rd(o)}),s}(t.mapValue);default:throw le(13486,{value:t})}}function Hi(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function qm(t){return!!t&&"integerValue"in t}function vc(t){return!!t&&"arrayValue"in t}function NE(t){return!!t&&"nullValue"in t}function kE(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function sd(t){return!!t&&"mapValue"in t}function Hh(t){var n,r;return((r=(((n=t==null?void 0:t.mapValue)==null?void 0:n.fields)||{})[Dy])==null?void 0:r.stringValue)===jy}function Fl(t){if(t.geoPointValue)return{geoPointValue:{...t.geoPointValue}};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:{...t.timestampValue}};if(t.mapValue){const e={mapValue:{fields:{}}};return ii(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=Fl(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=Fl(t.arrayValue.values[n]);return e}return{...t}}function Ib(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===Eb}const Tb={mapValue:{fields:{[Dy]:{stringValue:jy},[ma]:{arrayValue:{}}}}};function qO(t){return"nullValue"in t?nd:"booleanValue"in t?{booleanValue:!1}:"integerValue"in t||"doubleValue"in t?{doubleValue:NaN}:"timestampValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in t?{stringValue:""}:"bytesValue"in t?{bytesValue:""}:"referenceValue"in t?Hi(qi.empty(),te.empty()):"geoPointValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in t?{arrayValue:{}}:"mapValue"in t?Hh(t)?Tb:{mapValue:{}}:le(35942,{value:t})}function HO(t){return"nullValue"in t?{booleanValue:!1}:"booleanValue"in t?{doubleValue:NaN}:"integerValue"in t||"doubleValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in t?{stringValue:""}:"stringValue"in t?{bytesValue:""}:"bytesValue"in t?Hi(qi.empty(),te.empty()):"referenceValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in t?{arrayValue:{}}:"arrayValue"in t?Tb:"mapValue"in t?Hh(t)?{mapValue:{}}:Ps:le(61959,{value:t})}function DE(t,e){const n=Gs(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?-1:!t.inclusive&&e.inclusive?1:0}function jE(t,e){const n=Gs(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?1:!t.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class an{constructor(e){this.value=e}static empty(){return new an({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!sd(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=Fl(n)}setAll(e){let n=gt.emptyPath(),r={},s=[];e.forEach((o,a)=>{if(!n.isImmediateParentOf(a)){const l=this.getFieldsMap(n);this.applyChanges(l,r,s),r={},s=[],n=a.popLast()}o?r[a.lastSegment()]=Fl(o):s.push(a.lastSegment())});const i=this.getFieldsMap(n);this.applyChanges(i,r,s)}delete(e){const n=this.field(e.popLast());sd(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return jr(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let s=n.mapValue.fields[e.get(r)];sd(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=s),n=s}return n.mapValue.fields}applyChanges(e,n,r){ii(n,(s,i)=>e[s]=i);for(const s of r)delete e[s]}clone(){return new an(Fl(this.value))}}function xb(t){const e=[];return ii(t.fields,(n,r)=>{const s=new gt([n]);if(sd(r)){const i=xb(r.mapValue).fields;if(i.length===0)e.push(s);else for(const o of i)e.push(s.child(o))}else e.push(s)}),new Sn(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class It{constructor(e,n,r,s,i,o,a){this.key=e,this.documentType=n,this.version=r,this.readTime=s,this.createTime=i,this.data=o,this.documentState=a}static newInvalidDocument(e){return new It(e,0,me.min(),me.min(),me.min(),an.empty(),0)}static newFoundDocument(e,n,r,s){return new It(e,1,n,me.min(),r,s,0)}static newNoDocument(e,n){return new It(e,2,n,me.min(),me.min(),an.empty(),0)}static newUnknownDocument(e,n){return new It(e,3,n,me.min(),me.min(),an.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(me.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=an.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=an.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=me.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof It&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new It(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qs{constructor(e,n){this.position=e,this.inclusive=n}}function OE(t,e,n){let r=0;for(let s=0;s<t.position.length;s++){const i=e[s],o=t.position[s];if(i.field.isKeyField()?r=te.comparator(te.fromName(o.referenceValue),n.key):r=Gs(o,n.data.field(i.field)),i.dir==="desc"&&(r*=-1),r!==0)break}return r}function VE(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!jr(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wc{constructor(e,n="asc"){this.field=e,this.dir=n}}function WO(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sb{}class Me extends Sb{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new KO(e,n,r):n==="array-contains"?new YO(e,r):n==="in"?new Nb(e,r):n==="not-in"?new XO(e,r):n==="array-contains-any"?new JO(e,r):new Me(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new GO(e,r):new QO(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&n.nullValue===void 0&&this.matchesComparison(Gs(n,this.value)):n!==null&&Ks(this.value)===Ks(n)&&this.matchesComparison(Gs(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return le(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Ze extends Sb{constructor(e,n){super(),this.filters=e,this.op=n,this.Pe=null}static create(e,n){return new Ze(e,n)}matches(e){return ya(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function ya(t){return t.op==="and"}function Hm(t){return t.op==="or"}function Oy(t){return bb(t)&&ya(t)}function bb(t){for(const e of t.filters)if(e instanceof Ze)return!1;return!0}function Wm(t){if(t instanceof Me)return t.field.canonicalString()+t.op.toString()+ga(t.value);if(Oy(t))return t.filters.map(e=>Wm(e)).join(",");{const e=t.filters.map(n=>Wm(n)).join(",");return`${t.op}(${e})`}}function Cb(t,e){return t instanceof Me?function(r,s){return s instanceof Me&&r.op===s.op&&r.field.isEqual(s.field)&&jr(r.value,s.value)}(t,e):t instanceof Ze?function(r,s){return s instanceof Ze&&r.op===s.op&&r.filters.length===s.filters.length?r.filters.reduce((i,o,a)=>i&&Cb(o,s.filters[a]),!0):!1}(t,e):void le(19439)}function Ab(t,e){const n=t.filters.concat(e);return Ze.create(n,t.op)}function Rb(t){return t instanceof Me?function(n){return`${n.field.canonicalString()} ${n.op} ${ga(n.value)}`}(t):t instanceof Ze?function(n){return n.op.toString()+" {"+n.getFilters().map(Rb).join(" ,")+"}"}(t):"Filter"}class KO extends Me{constructor(e,n,r){super(e,n,r),this.key=te.fromName(r.referenceValue)}matches(e){const n=te.comparator(e.key,this.key);return this.matchesComparison(n)}}class GO extends Me{constructor(e,n){super(e,"in",n),this.keys=Pb("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class QO extends Me{constructor(e,n){super(e,"not-in",n),this.keys=Pb("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function Pb(t,e){var n;return(((n=e.arrayValue)==null?void 0:n.values)||[]).map(r=>te.fromName(r.referenceValue))}class YO extends Me{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return vc(n)&&_c(n.arrayValue,this.value)}}class Nb extends Me{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&_c(this.value.arrayValue,n)}}class XO extends Me{constructor(e,n){super(e,"not-in",n)}matches(e){if(_c(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&n.nullValue===void 0&&!_c(this.value.arrayValue,n)}}class JO extends Me{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!vc(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>_c(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZO{constructor(e,n=null,r=[],s=[],i=null,o=null,a=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=s,this.limit=i,this.startAt=o,this.endAt=a,this.Te=null}}function Km(t,e=null,n=[],r=[],s=null,i=null,o=null){return new ZO(t,e,n,r,s,i,o)}function Wi(t){const e=Ee(t);if(e.Te===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>Wm(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(i){return i.field.canonicalString()+i.dir}(r)).join(","),Fh(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>ga(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>ga(r)).join(",")),e.Te=n}return e.Te}function Vc(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!WO(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!Cb(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!VE(t.startAt,e.startAt)&&VE(t.endAt,e.endAt)}function Qd(t){return te.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}function Yd(t,e){return t.filters.filter(n=>n instanceof Me&&n.field.isEqual(e))}function LE(t,e,n){let r=nd,s=!0;for(const i of Yd(t,e)){let o=nd,a=!0;switch(i.op){case"<":case"<=":o=qO(i.value);break;case"==":case"in":case">=":o=i.value;break;case">":o=i.value,a=!1;break;case"!=":case"not-in":o=nd}DE({value:r,inclusive:s},{value:o,inclusive:a})<0&&(r=o,s=a)}if(n!==null){for(let i=0;i<t.orderBy.length;++i)if(t.orderBy[i].field.isEqual(e)){const o=n.position[i];DE({value:r,inclusive:s},{value:o,inclusive:n.inclusive})<0&&(r=o,s=n.inclusive);break}}return{value:r,inclusive:s}}function ME(t,e,n){let r=Ps,s=!0;for(const i of Yd(t,e)){let o=Ps,a=!0;switch(i.op){case">=":case">":o=HO(i.value),a=!1;break;case"==":case"in":case"<=":o=i.value;break;case"<":o=i.value,a=!1;break;case"!=":case"not-in":o=Ps}jE({value:r,inclusive:s},{value:o,inclusive:a})>0&&(r=o,s=a)}if(n!==null){for(let i=0;i<t.orderBy.length;++i)if(t.orderBy[i].field.isEqual(e)){const o=n.position[i];jE({value:r,inclusive:s},{value:o,inclusive:n.inclusive})>0&&(r=o,s=n.inclusive);break}}return{value:r,inclusive:s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oi{constructor(e,n=null,r=[],s=[],i=null,o="F",a=null,l=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=s,this.limit=i,this.limitType=o,this.startAt=a,this.endAt=l,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function eV(t,e,n,r,s,i,o,a){return new oi(t,e,n,r,s,i,o,a)}function Lc(t){return new oi(t)}function FE(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function Vy(t){return t.collectionGroup!==null}function Xo(t){const e=Ee(t);if(e.Ie===null){e.Ie=[];const n=new Set;for(const i of e.explicitOrderBy)e.Ie.push(i),n.add(i.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new tt(gt.comparator);return o.filters.forEach(l=>{l.getFlattenedFilters().forEach(d=>{d.isInequality()&&(a=a.add(d.field))})}),a})(e).forEach(i=>{n.has(i.canonicalString())||i.isKeyField()||e.Ie.push(new wc(i,r))}),n.has(gt.keyField().canonicalString())||e.Ie.push(new wc(gt.keyField(),r))}return e.Ie}function Gn(t){const e=Ee(t);return e.Ee||(e.Ee=kb(e,Xo(t))),e.Ee}function tV(t){const e=Ee(t);return e.de||(e.de=kb(e,t.explicitOrderBy)),e.de}function kb(t,e){if(t.limitType==="F")return Km(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(s=>{const i=s.dir==="desc"?"asc":"desc";return new wc(s.field,i)});const n=t.endAt?new Qs(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new Qs(t.startAt.position,t.startAt.inclusive):null;return Km(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function Gm(t,e){const n=t.filters.concat([e]);return new oi(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function Xd(t,e,n){return new oi(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Wh(t,e){return Vc(Gn(t),Gn(e))&&t.limitType===e.limitType}function Db(t){return`${Wi(Gn(t))}|lt:${t.limitType}`}function bo(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(s=>Rb(s)).join(", ")}]`),Fh(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(s=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(s)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(s=>ga(s)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(s=>ga(s)).join(",")),`Target(${r})`}(Gn(t))}; limitType=${t.limitType})`}function Mc(t,e){return e.isFoundDocument()&&function(r,s){const i=s.key.path;return r.collectionGroup!==null?s.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(i):te.isDocumentKey(r.path)?r.path.isEqual(i):r.path.isImmediateParentOf(i)}(t,e)&&function(r,s){for(const i of Xo(r))if(!i.field.isKeyField()&&s.data.field(i.field)===null)return!1;return!0}(t,e)&&function(r,s){for(const i of r.filters)if(!i.matches(s))return!1;return!0}(t,e)&&function(r,s){return!(r.startAt&&!function(o,a,l){const d=OE(o,a,l);return o.inclusive?d<=0:d<0}(r.startAt,Xo(r),s)||r.endAt&&!function(o,a,l){const d=OE(o,a,l);return o.inclusive?d>=0:d>0}(r.endAt,Xo(r),s))}(t,e)}function nV(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function jb(t){return(e,n)=>{let r=!1;for(const s of Xo(t)){const i=rV(s,e,n);if(i!==0)return i;r=r||s.field.isKeyField()}return 0}}function rV(t,e,n){const r=t.field.isKeyField()?te.comparator(e.key,n.key):function(i,o,a){const l=o.data.field(i),d=a.data.field(i);return l!==null&&d!==null?Gs(l,d):le(42886)}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return le(19790,{direction:t.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rs{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[s,i]of r)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),s=this.inner[r];if(s===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,n]);s.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return r.length===1?delete this.inner[n]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(e){ii(this.inner,(n,r)=>{for(const[s,i]of r)e(s,i)})}isEmpty(){return mb(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sV=new ft(te.comparator);function jn(){return sV}const Ob=new ft(te.comparator);function _l(...t){let e=Ob;for(const n of t)e=e.insert(n.key,n);return e}function Vb(t){let e=Ob;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function br(){return Ul()}function Lb(){return Ul()}function Ul(){return new rs(t=>t.toString(),(t,e)=>t.isEqual(e))}const iV=new ft(te.comparator),oV=new tt(te.comparator);function Ne(...t){let e=oV;for(const n of t)e=e.add(n);return e}const aV=new tt(Te);function lV(){return aV}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ly(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:fc(e)?"-0":e}}function Mb(t){return{integerValue:""+t}}function Fb(t,e){return pO(e)?Mb(e):Ly(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kh{constructor(){this._=void 0}}function cV(t,e,n){return t instanceof _a?function(s,i){const o={fields:{[_b]:{stringValue:yb},[wb]:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return i&&zh(i)&&(i=qh(i)),i&&(o.fields[vb]=i),{mapValue:o}}(n,e):t instanceof Ki?$b(t,e):t instanceof va?Bb(t,e):function(s,i){const o=Ub(s,i),a=UE(o)+UE(s.Ae);return qm(o)&&qm(s.Ae)?Mb(a):Ly(s.serializer,a)}(t,e)}function uV(t,e,n){return t instanceof Ki?$b(t,e):t instanceof va?Bb(t,e):n}function Ub(t,e){return t instanceof wa?function(r){return qm(r)||function(i){return!!i&&"doubleValue"in i}(r)}(e)?e:{integerValue:0}:null}class _a extends Kh{}class Ki extends Kh{constructor(e){super(),this.elements=e}}function $b(t,e){const n=zb(e);for(const r of t.elements)n.some(s=>jr(s,r))||n.push(r);return{arrayValue:{values:n}}}class va extends Kh{constructor(e){super(),this.elements=e}}function Bb(t,e){let n=zb(e);for(const r of t.elements)n=n.filter(s=>!jr(s,r));return{arrayValue:{values:n}}}class wa extends Kh{constructor(e,n){super(),this.serializer=e,this.Ae=n}}function UE(t){return ut(t.integerValue||t.doubleValue)}function zb(t){return vc(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gh{constructor(e,n){this.field=e,this.transform=n}}function dV(t,e){return t.field.isEqual(e.field)&&function(r,s){return r instanceof Ki&&s instanceof Ki||r instanceof va&&s instanceof va?ua(r.elements,s.elements,jr):r instanceof wa&&s instanceof wa?jr(r.Ae,s.Ae):r instanceof _a&&s instanceof _a}(t.transform,e.transform)}class hV{constructor(e,n){this.version=e,this.transformResults=n}}class ln{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new ln}static exists(e){return new ln(void 0,e)}static updateTime(e){return new ln(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function id(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class Qh{}function qb(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new Yh(t.key,ln.none()):new ka(t.key,t.data,ln.none());{const n=t.data,r=an.empty();let s=new tt(gt.comparator);for(let i of e.fields)if(!s.has(i)){let o=n.field(i);o===null&&i.length>1&&(i=i.popLast(),o=n.field(i)),o===null?r.delete(i):r.set(i,o),s=s.add(i)}return new ss(t.key,r,new Sn(s.toArray()),ln.none())}}function fV(t,e,n){t instanceof ka?function(s,i,o){const a=s.value.clone(),l=BE(s.fieldTransforms,i,o.transformResults);a.setAll(l),i.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(t,e,n):t instanceof ss?function(s,i,o){if(!id(s.precondition,i))return void i.convertToUnknownDocument(o.version);const a=BE(s.fieldTransforms,i,o.transformResults),l=i.data;l.setAll(Hb(s)),l.setAll(a),i.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(t,e,n):function(s,i,o){i.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,n)}function $l(t,e,n,r){return t instanceof ka?function(i,o,a,l){if(!id(i.precondition,o))return a;const d=i.value.clone(),h=zE(i.fieldTransforms,l,o);return d.setAll(h),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),null}(t,e,n,r):t instanceof ss?function(i,o,a,l){if(!id(i.precondition,o))return a;const d=zE(i.fieldTransforms,l,o),h=o.data;return h.setAll(Hb(i)),h.setAll(d),o.convertToFoundDocument(o.version,h).setHasLocalMutations(),a===null?null:a.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(f=>f.field))}(t,e,n,r):function(i,o,a){return id(i.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(t,e,n)}function pV(t,e){let n=null;for(const r of t.fieldTransforms){const s=e.data.field(r.field),i=Ub(r.transform,s||null);i!=null&&(n===null&&(n=an.empty()),n.set(r.field,i))}return n||null}function $E(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,s){return r===void 0&&s===void 0||!(!r||!s)&&ua(r,s,(i,o)=>dV(i,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class ka extends Qh{constructor(e,n,r,s=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class ss extends Qh{constructor(e,n,r,s,i=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function Hb(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function BE(t,e,n){const r=new Map;ue(t.length===n.length,32656,{Re:n.length,Ve:t.length});for(let s=0;s<n.length;s++){const i=t[s],o=i.transform,a=e.data.field(i.field);r.set(i.field,uV(o,a,n[s]))}return r}function zE(t,e,n){const r=new Map;for(const s of t){const i=s.transform,o=n.data.field(s.field);r.set(s.field,cV(i,o,e))}return r}class Yh extends Qh{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Wb extends Qh{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class My{constructor(e,n,r,s){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&fV(i,e,r[s])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=$l(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=$l(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=Lb();return this.mutations.forEach(s=>{const i=e.get(s.key),o=i.overlayedDocument;let a=this.applyToLocalView(o,i.mutatedFields);a=n.has(s.key)?null:a;const l=qb(o,a);l!==null&&r.set(s.key,l),o.isValidDocument()||o.convertToNoDocument(me.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),Ne())}isEqual(e){return this.batchId===e.batchId&&ua(this.mutations,e.mutations,(n,r)=>$E(n,r))&&ua(this.baseMutations,e.baseMutations,(n,r)=>$E(n,r))}}class Fy{constructor(e,n,r,s){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=s}static from(e,n,r){ue(e.mutations.length===r.length,58842,{me:e.mutations.length,fe:r.length});let s=function(){return iV}();const i=e.mutations;for(let o=0;o<i.length;o++)s=s.insert(i[o].key,r[o].version);return new Fy(e,n,r,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uy{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mV{constructor(e,n,r){this.alias=e,this.aggregateType=n,this.fieldPath=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gV{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ct,$e;function yV(t){switch(t){case $.OK:return le(64938);case $.CANCELLED:case $.UNKNOWN:case $.DEADLINE_EXCEEDED:case $.RESOURCE_EXHAUSTED:case $.INTERNAL:case $.UNAVAILABLE:case $.UNAUTHENTICATED:return!1;case $.INVALID_ARGUMENT:case $.NOT_FOUND:case $.ALREADY_EXISTS:case $.PERMISSION_DENIED:case $.FAILED_PRECONDITION:case $.ABORTED:case $.OUT_OF_RANGE:case $.UNIMPLEMENTED:case $.DATA_LOSS:return!0;default:return le(15467,{code:t})}}function Kb(t){if(t===void 0)return pn("GRPC error has no .code"),$.UNKNOWN;switch(t){case Ct.OK:return $.OK;case Ct.CANCELLED:return $.CANCELLED;case Ct.UNKNOWN:return $.UNKNOWN;case Ct.DEADLINE_EXCEEDED:return $.DEADLINE_EXCEEDED;case Ct.RESOURCE_EXHAUSTED:return $.RESOURCE_EXHAUSTED;case Ct.INTERNAL:return $.INTERNAL;case Ct.UNAVAILABLE:return $.UNAVAILABLE;case Ct.UNAUTHENTICATED:return $.UNAUTHENTICATED;case Ct.INVALID_ARGUMENT:return $.INVALID_ARGUMENT;case Ct.NOT_FOUND:return $.NOT_FOUND;case Ct.ALREADY_EXISTS:return $.ALREADY_EXISTS;case Ct.PERMISSION_DENIED:return $.PERMISSION_DENIED;case Ct.FAILED_PRECONDITION:return $.FAILED_PRECONDITION;case Ct.ABORTED:return $.ABORTED;case Ct.OUT_OF_RANGE:return $.OUT_OF_RANGE;case Ct.UNIMPLEMENTED:return $.UNIMPLEMENTED;case Ct.DATA_LOSS:return $.DATA_LOSS;default:return le(39323,{code:t})}}($e=Ct||(Ct={}))[$e.OK=0]="OK",$e[$e.CANCELLED=1]="CANCELLED",$e[$e.UNKNOWN=2]="UNKNOWN",$e[$e.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",$e[$e.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",$e[$e.NOT_FOUND=5]="NOT_FOUND",$e[$e.ALREADY_EXISTS=6]="ALREADY_EXISTS",$e[$e.PERMISSION_DENIED=7]="PERMISSION_DENIED",$e[$e.UNAUTHENTICATED=16]="UNAUTHENTICATED",$e[$e.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",$e[$e.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",$e[$e.ABORTED=10]="ABORTED",$e[$e.OUT_OF_RANGE=11]="OUT_OF_RANGE",$e[$e.UNIMPLEMENTED=12]="UNIMPLEMENTED",$e[$e.INTERNAL=13]="INTERNAL",$e[$e.UNAVAILABLE=14]="UNAVAILABLE",$e[$e.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _V(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vV=new Bs([4294967295,4294967295],0);function qE(t){const e=_V().encode(t),n=new qS;return n.update(e),new Uint8Array(n.digest())}function HE(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),s=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new Bs([n,r],0),new Bs([s,i],0)]}class $y{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new vl(`Invalid padding: ${n}`);if(r<0)throw new vl(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new vl(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new vl(`Invalid padding when bitmap length is 0: ${n}`);this.ge=8*e.length-n,this.pe=Bs.fromNumber(this.ge)}ye(e,n,r){let s=e.add(n.multiply(Bs.fromNumber(r)));return s.compare(vV)===1&&(s=new Bs([s.getBits(0),s.getBits(1)],0)),s.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const n=qE(e),[r,s]=HE(n);for(let i=0;i<this.hashCount;i++){const o=this.ye(r,s,i);if(!this.we(o))return!1}return!0}static create(e,n,r){const s=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),o=new $y(i,s,n);return r.forEach(a=>o.insert(a)),o}insert(e){if(this.ge===0)return;const n=qE(e),[r,s]=HE(n);for(let i=0;i<this.hashCount;i++){const o=this.ye(r,s,i);this.Se(o)}}Se(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class vl extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xh{constructor(e,n,r,s,i){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const s=new Map;return s.set(e,Fc.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new Xh(me.min(),s,new ft(Te),jn(),Ne())}}class Fc{constructor(e,n,r,s,i){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new Fc(r,n,Ne(),Ne(),Ne())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class od{constructor(e,n,r,s){this.be=e,this.removedTargetIds=n,this.key=r,this.De=s}}class Gb{constructor(e,n){this.targetId=e,this.Ce=n}}class Qb{constructor(e,n,r=Pt.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=s}}class WE{constructor(){this.ve=0,this.Fe=KE(),this.Me=Pt.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=Ne(),n=Ne(),r=Ne();return this.Fe.forEach((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:n=n.add(s);break;case 1:r=r.add(s);break;default:le(38017,{changeType:i})}}),new Fc(this.Me,this.xe,e,n,r)}qe(){this.Oe=!1,this.Fe=KE()}Qe(e,n){this.Oe=!0,this.Fe=this.Fe.insert(e,n)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,ue(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class wV{constructor(e){this.Ge=e,this.ze=new Map,this.je=jn(),this.Je=xu(),this.He=xu(),this.Ye=new ft(Te)}Ze(e){for(const n of e.be)e.De&&e.De.isFoundDocument()?this.Xe(n,e.De):this.et(n,e.key,e.De);for(const n of e.removedTargetIds)this.et(n,e.key,e.De)}tt(e){this.forEachTarget(e,n=>{const r=this.nt(n);switch(e.state){case 0:this.rt(n)&&r.Le(e.resumeToken);break;case 1:r.Ke(),r.Ne||r.qe(),r.Le(e.resumeToken);break;case 2:r.Ke(),r.Ne||this.removeTarget(n);break;case 3:this.rt(n)&&(r.We(),r.Le(e.resumeToken));break;case 4:this.rt(n)&&(this.it(n),r.Le(e.resumeToken));break;default:le(56790,{state:e.state})}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.ze.forEach((r,s)=>{this.rt(s)&&n(s)})}st(e){const n=e.targetId,r=e.Ce.count,s=this.ot(n);if(s){const i=s.target;if(Qd(i))if(r===0){const o=new te(i.path);this.et(n,o,It.newNoDocument(o,me.min()))}else ue(r===1,20013,{expectedCount:r});else{const o=this._t(n);if(o!==r){const a=this.ut(e),l=a?this.ct(a,e,o):1;if(l!==0){this.it(n);const d=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(n,d)}}}}}ut(e){const n=e.Ce.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:s=0},hashCount:i=0}=n;let o,a;try{o=ts(r).toUint8Array()}catch(l){if(l instanceof gb)return zi("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{a=new $y(o,s,i)}catch(l){return zi(l instanceof vl?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return a.ge===0?null:a}ct(e,n,r){return n.Ce.count===r-this.Pt(e,n.targetId)?0:2}Pt(e,n){const r=this.Ge.getRemoteKeysForTarget(n);let s=0;return r.forEach(i=>{const o=this.Ge.ht(),a=`projects/${o.projectId}/databases/${o.database}/documents/${i.path.canonicalString()}`;e.mightContain(a)||(this.et(n,i,null),s++)}),s}Tt(e){const n=new Map;this.ze.forEach((i,o)=>{const a=this.ot(o);if(a){if(i.current&&Qd(a.target)){const l=new te(a.target.path);this.It(l).has(o)||this.Et(o,l)||this.et(o,l,It.newNoDocument(l,e))}i.Be&&(n.set(o,i.ke()),i.qe())}});let r=Ne();this.He.forEach((i,o)=>{let a=!0;o.forEachWhile(l=>{const d=this.ot(l);return!d||d.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(i))}),this.je.forEach((i,o)=>o.setReadTime(e));const s=new Xh(e,n,this.Ye,this.je,r);return this.je=jn(),this.Je=xu(),this.He=xu(),this.Ye=new ft(Te),s}Xe(e,n){if(!this.rt(e))return;const r=this.Et(e,n.key)?2:0;this.nt(e).Qe(n.key,r),this.je=this.je.insert(n.key,n),this.Je=this.Je.insert(n.key,this.It(n.key).add(e)),this.He=this.He.insert(n.key,this.dt(n.key).add(e))}et(e,n,r){if(!this.rt(e))return;const s=this.nt(e);this.Et(e,n)?s.Qe(n,1):s.$e(n),this.He=this.He.insert(n,this.dt(n).delete(e)),this.He=this.He.insert(n,this.dt(n).add(e)),r&&(this.je=this.je.insert(n,r))}removeTarget(e){this.ze.delete(e)}_t(e){const n=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let n=this.ze.get(e);return n||(n=new WE,this.ze.set(e,n)),n}dt(e){let n=this.He.get(e);return n||(n=new tt(Te),this.He=this.He.insert(e,n)),n}It(e){let n=this.Je.get(e);return n||(n=new tt(Te),this.Je=this.Je.insert(e,n)),n}rt(e){const n=this.ot(e)!==null;return n||H("WatchChangeAggregator","Detected inactive target",e),n}ot(e){const n=this.ze.get(e);return n&&n.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new WE),this.Ge.getRemoteKeysForTarget(e).forEach(n=>{this.et(e,n,null)})}Et(e,n){return this.Ge.getRemoteKeysForTarget(e).has(n)}}function xu(){return new ft(te.comparator)}function KE(){return new ft(te.comparator)}const EV={asc:"ASCENDING",desc:"DESCENDING"},IV={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},TV={and:"AND",or:"OR"};class xV{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function Qm(t,e){return t.useProto3Json||Fh(e)?e:{value:e}}function Ea(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Yb(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function SV(t,e){return Ea(t,e.toTimestamp())}function yn(t){return ue(!!t,49232),me.fromTimestamp(function(n){const r=es(n);return new Be(r.seconds,r.nanos)}(t))}function By(t,e){return Ym(t,e).canonicalString()}function Ym(t,e){const n=function(s){return new We(["projects",s.projectId,"databases",s.database])}(t).child("documents");return e===void 0?n:n.child(e)}function Xb(t){const e=We.fromString(t);return ue(iC(e),10190,{key:e.toString()}),e}function Jd(t,e){return By(t.databaseId,e.path)}function ki(t,e){const n=Xb(e);if(n.get(1)!==t.databaseId.projectId)throw new K($.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new K($.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new te(eC(n))}function Jb(t,e){return By(t.databaseId,e)}function Zb(t){const e=Xb(t);return e.length===4?We.emptyPath():eC(e)}function Xm(t){return new We(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function eC(t){return ue(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function GE(t,e,n){return{name:Jd(t,e),fields:n.value.mapValue.fields}}function bV(t,e,n){const r=ki(t,e.name),s=yn(e.updateTime),i=e.createTime?yn(e.createTime):me.min(),o=new an({mapValue:{fields:e.fields}}),a=It.newFoundDocument(r,s,i,o);return n&&a.setHasCommittedMutations(),n?a.setHasCommittedMutations():a}function CV(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(d){return d==="NO_CHANGE"?0:d==="ADD"?1:d==="REMOVE"?2:d==="CURRENT"?3:d==="RESET"?4:le(39313,{state:d})}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=function(d,h){return d.useProto3Json?(ue(h===void 0||typeof h=="string",58123),Pt.fromBase64String(h||"")):(ue(h===void 0||h instanceof Buffer||h instanceof Uint8Array,16193),Pt.fromUint8Array(h||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(d){const h=d.code===void 0?$.UNKNOWN:Kb(d.code);return new K(h,d.message||"")}(o);n=new Qb(r,s,i,a||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const s=ki(t,r.document.name),i=yn(r.document.updateTime),o=r.document.createTime?yn(r.document.createTime):me.min(),a=new an({mapValue:{fields:r.document.fields}}),l=It.newFoundDocument(s,i,o,a),d=r.targetIds||[],h=r.removedTargetIds||[];n=new od(d,h,l.key,l)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const s=ki(t,r.document),i=r.readTime?yn(r.readTime):me.min(),o=It.newNoDocument(s,i),a=r.removedTargetIds||[];n=new od([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const s=ki(t,r.document),i=r.removedTargetIds||[];n=new od([],i,s,null)}else{if(!("filter"in e))return le(11601,{Rt:e});{e.filter;const r=e.filter;r.targetId;const{count:s=0,unchangedNames:i}=r,o=new gV(s,i),a=r.targetId;n=new Gb(a,o)}}return n}function Zd(t,e){let n;if(e instanceof ka)n={update:GE(t,e.key,e.value)};else if(e instanceof Yh)n={delete:Jd(t,e.key)};else if(e instanceof ss)n={update:GE(t,e.key,e.data),updateMask:jV(e.fieldMask)};else{if(!(e instanceof Wb))return le(16599,{Vt:e.type});n={verify:Jd(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(i,o){const a=o.transform;if(a instanceof _a)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof Ki)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof va)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof wa)return{fieldPath:o.field.canonicalString(),increment:a.Ae};throw le(20930,{transform:o.transform})}(0,r))),e.precondition.isNone||(n.currentDocument=function(s,i){return i.updateTime!==void 0?{updateTime:SV(s,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:le(27497)}(t,e.precondition)),n}function Jm(t,e){const n=e.currentDocument?function(i){return i.updateTime!==void 0?ln.updateTime(yn(i.updateTime)):i.exists!==void 0?ln.exists(i.exists):ln.none()}(e.currentDocument):ln.none(),r=e.updateTransforms?e.updateTransforms.map(s=>function(o,a){let l=null;if("setToServerValue"in a)ue(a.setToServerValue==="REQUEST_TIME",16630,{proto:a}),l=new _a;else if("appendMissingElements"in a){const h=a.appendMissingElements.values||[];l=new Ki(h)}else if("removeAllFromArray"in a){const h=a.removeAllFromArray.values||[];l=new va(h)}else"increment"in a?l=new wa(o,a.increment):le(16584,{proto:a});const d=gt.fromServerFormat(a.fieldPath);return new Gh(d,l)}(t,s)):[];if(e.update){e.update.name;const s=ki(t,e.update.name),i=new an({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=function(l){const d=l.fieldPaths||[];return new Sn(d.map(h=>gt.fromServerFormat(h)))}(e.updateMask);return new ss(s,i,o,n,r)}return new ka(s,i,n,r)}if(e.delete){const s=ki(t,e.delete);return new Yh(s,n)}if(e.verify){const s=ki(t,e.verify);return new Wb(s,n)}return le(1463,{proto:e})}function AV(t,e){return t&&t.length>0?(ue(e!==void 0,14353),t.map(n=>function(s,i){let o=s.updateTime?yn(s.updateTime):yn(i);return o.isEqual(me.min())&&(o=yn(i)),new hV(o,s.transformResults||[])}(n,e))):[]}function tC(t,e){return{documents:[Jb(t,e.path)]}}function zy(t,e){const n={structuredQuery:{}},r=e.path;let s;e.collectionGroup!==null?(s=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=Jb(t,s);const i=function(d){if(d.length!==0)return sC(Ze.create(d,"and"))}(e.filters);i&&(n.structuredQuery.where=i);const o=function(d){if(d.length!==0)return d.map(h=>function(m){return{field:Ss(m.field),direction:NV(m.dir)}}(h))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);const a=Qm(t,e.limit);return a!==null&&(n.structuredQuery.limit=a),e.startAt&&(n.structuredQuery.startAt=function(d){return{before:d.inclusive,values:d.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(d){return{before:!d.inclusive,values:d.position}}(e.endAt)),{ft:n,parent:s}}function RV(t,e,n,r){const{ft:s,parent:i}=zy(t,e),o={},a=[];let l=0;return n.forEach(d=>{const h="aggregate_"+l++;o[h]=d.alias,d.aggregateType==="count"?a.push({alias:h,count:{}}):d.aggregateType==="avg"?a.push({alias:h,avg:{field:Ss(d.fieldPath)}}):d.aggregateType==="sum"&&a.push({alias:h,sum:{field:Ss(d.fieldPath)}})}),{request:{structuredAggregationQuery:{aggregations:a,structuredQuery:s.structuredQuery},parent:s.parent},gt:o,parent:i}}function nC(t){let e=Zb(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let s=null;if(r>0){ue(r===1,65062);const h=n.from[0];h.allDescendants?s=h.collectionId:e=e.child(h.collectionId)}let i=[];n.where&&(i=function(f){const m=rC(f);return m instanceof Ze&&Oy(m)?m.getFilters():[m]}(n.where));let o=[];n.orderBy&&(o=function(f){return f.map(m=>function(R){return new wc(Co(R.field),function(A){switch(A){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(R.direction))}(m))}(n.orderBy));let a=null;n.limit&&(a=function(f){let m;return m=typeof f=="object"?f.value:f,Fh(m)?null:m}(n.limit));let l=null;n.startAt&&(l=function(f){const m=!!f.before,v=f.values||[];return new Qs(v,m)}(n.startAt));let d=null;return n.endAt&&(d=function(f){const m=!f.before,v=f.values||[];return new Qs(v,m)}(n.endAt)),eV(e,s,o,i,a,"F",l,d)}function PV(t,e){const n=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return le(28987,{purpose:s})}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function rC(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=Co(n.unaryFilter.field);return Me.create(r,"==",{doubleValue:NaN});case"IS_NULL":const s=Co(n.unaryFilter.field);return Me.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=Co(n.unaryFilter.field);return Me.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=Co(n.unaryFilter.field);return Me.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return le(61313);default:return le(60726)}}(t):t.fieldFilter!==void 0?function(n){return Me.create(Co(n.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return le(58110);default:return le(50506)}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return Ze.create(n.compositeFilter.filters.map(r=>rC(r)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return le(1026)}}(n.compositeFilter.op))}(t):le(30097,{filter:t})}function NV(t){return EV[t]}function kV(t){return IV[t]}function DV(t){return TV[t]}function Ss(t){return{fieldPath:t.canonicalString()}}function Co(t){return gt.fromServerFormat(t.fieldPath)}function sC(t){return t instanceof Me?function(n){if(n.op==="=="){if(kE(n.value))return{unaryFilter:{field:Ss(n.field),op:"IS_NAN"}};if(NE(n.value))return{unaryFilter:{field:Ss(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(kE(n.value))return{unaryFilter:{field:Ss(n.field),op:"IS_NOT_NAN"}};if(NE(n.value))return{unaryFilter:{field:Ss(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Ss(n.field),op:kV(n.op),value:n.value}}}(t):t instanceof Ze?function(n){const r=n.getFilters().map(s=>sC(s));return r.length===1?r[0]:{compositeFilter:{op:DV(n.op),filters:r}}}(t):le(54877,{filter:t})}function jV(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function iC(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zr{constructor(e,n,r,s,i=me.min(),o=me.min(),a=Pt.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=l}withSequenceNumber(e){return new zr(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new zr(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new zr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new zr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oC{constructor(e){this.yt=e}}function OV(t,e){let n;if(e.document)n=bV(t.yt,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=te.fromSegments(e.noDocument.path),s=Qi(e.noDocument.readTime);n=It.newNoDocument(r,s),e.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!e.unknownDocument)return le(56709);{const r=te.fromSegments(e.unknownDocument.path),s=Qi(e.unknownDocument.version);n=It.newUnknownDocument(r,s)}}return e.readTime&&n.setReadTime(function(s){const i=new Be(s[0],s[1]);return me.fromTimestamp(i)}(e.readTime)),n}function QE(t,e){const n=e.key,r={prefixPath:n.getCollectionPath().popLast().toArray(),collectionGroup:n.collectionGroup,documentId:n.path.lastSegment(),readTime:eh(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=function(i,o){return{name:Jd(i,o.key),fields:o.data.value.mapValue.fields,updateTime:Ea(i,o.version.toTimestamp()),createTime:Ea(i,o.createTime.toTimestamp())}}(t.yt,e);else if(e.isNoDocument())r.noDocument={path:n.path.toArray(),readTime:Gi(e.version)};else{if(!e.isUnknownDocument())return le(57904,{document:e});r.unknownDocument={path:n.path.toArray(),version:Gi(e.version)}}return r}function eh(t){const e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function Gi(t){const e=t.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function Qi(t){const e=new Be(t.seconds,t.nanoseconds);return me.fromTimestamp(e)}function vi(t,e){const n=(e.baseMutations||[]).map(i=>Jm(t.yt,i));for(let i=0;i<e.mutations.length-1;++i){const o=e.mutations[i];if(i+1<e.mutations.length&&e.mutations[i+1].transform!==void 0){const a=e.mutations[i+1];o.updateTransforms=a.transform.fieldTransforms,e.mutations.splice(i+1,1),++i}}const r=e.mutations.map(i=>Jm(t.yt,i)),s=Be.fromMillis(e.localWriteTimeMs);return new My(e.batchId,s,n,r)}function wl(t){const e=Qi(t.readTime),n=t.lastLimboFreeSnapshotVersion!==void 0?Qi(t.lastLimboFreeSnapshotVersion):me.min();let r;return r=function(i){return i.documents!==void 0}(t.query)?function(i){const o=i.documents.length;return ue(o===1,1966,{count:o}),Gn(Lc(Zb(i.documents[0])))}(t.query):function(i){return Gn(nC(i))}(t.query),new zr(r,t.targetId,"TargetPurposeListen",t.lastListenSequenceNumber,e,n,Pt.fromBase64String(t.resumeToken))}function aC(t,e){const n=Gi(e.snapshotVersion),r=Gi(e.lastLimboFreeSnapshotVersion);let s;s=Qd(e.target)?tC(t.yt,e.target):zy(t.yt,e.target).ft;const i=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Wi(e.target),readTime:n,resumeToken:i,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:s}}function lC(t){const e=nC({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?Xd(e,e.limit,"L"):e}function pp(t,e){return new Uy(e.largestBatchId,Jm(t.yt,e.overlayMutation))}function YE(t,e){const n=e.path.lastSegment();return[t,un(e.path.popLast()),n]}function XE(t,e,n,r){return{indexId:t,uid:e,sequenceNumber:n,readTime:Gi(r.readTime),documentKey:un(r.documentKey.path),largestBatchId:r.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VV{getBundleMetadata(e,n){return JE(e).get(n).next(r=>{if(r)return function(i){return{id:i.bundleId,createTime:Qi(i.createTime),version:i.version}}(r)})}saveBundleMetadata(e,n){return JE(e).put(function(s){return{bundleId:s.id,createTime:Gi(yn(s.createTime)),version:s.version}}(n))}getNamedQuery(e,n){return ZE(e).get(n).next(r=>{if(r)return function(i){return{name:i.name,query:lC(i.bundledQuery),readTime:Qi(i.readTime)}}(r)})}saveNamedQuery(e,n){return ZE(e).put(function(s){return{name:s.name,readTime:Gi(yn(s.readTime)),bundledQuery:s.bundledQuery}}(n))}}function JE(t){return Vt(t,Uh)}function ZE(t){return Vt(t,$h)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jh{constructor(e,n){this.serializer=e,this.userId=n}static wt(e,n){const r=n.uid||"";return new Jh(e,r)}getOverlay(e,n){return sl(e).get(YE(this.userId,n)).next(r=>r?pp(this.serializer,r):null)}getOverlays(e,n){const r=br();return O.forEach(n,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,n,r){const s=[];return r.forEach((i,o)=>{const a=new Uy(n,o);s.push(this.St(e,a))}),O.waitFor(s)}removeOverlaysForBatchId(e,n,r){const s=new Set;n.forEach(o=>s.add(un(o.getCollectionPath())));const i=[];return s.forEach(o=>{const a=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,r+1],!1,!0);i.push(sl(e).Z($m,a))}),O.waitFor(i)}getOverlaysForCollection(e,n,r){const s=br(),i=un(n),o=IDBKeyRange.bound([this.userId,i,r],[this.userId,i,Number.POSITIVE_INFINITY],!0);return sl(e).J($m,o).next(a=>{for(const l of a){const d=pp(this.serializer,l);s.set(d.getKey(),d)}return s})}getOverlaysForCollectionGroup(e,n,r,s){const i=br();let o;const a=IDBKeyRange.bound([this.userId,n,r],[this.userId,n,Number.POSITIVE_INFINITY],!0);return sl(e).ee({index:ub,range:a},(l,d,h)=>{const f=pp(this.serializer,d);i.size()<s||f.largestBatchId===o?(i.set(f.getKey(),f),o=f.largestBatchId):h.done()}).next(()=>i)}St(e,n){return sl(e).put(function(s,i,o){const[a,l,d]=YE(i,o.mutation.key);return{userId:i,collectionPath:l,documentId:d,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:Zd(s.yt,o.mutation)}}(this.serializer,this.userId,n))}}function sl(t){return Vt(t,Bh)}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LV{bt(e){return Vt(e,Ny)}getSessionToken(e){return this.bt(e).get("sessionToken").next(n=>{const r=n==null?void 0:n.value;return r?Pt.fromUint8Array(r):Pt.EMPTY_BYTE_STRING})}setSessionToken(e,n){return this.bt(e).put({name:"sessionToken",value:n.toUint8Array()})}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wi{constructor(){}Dt(e,n){this.Ct(e,n),n.vt()}Ct(e,n){if("nullValue"in e)this.Ft(n,5);else if("booleanValue"in e)this.Ft(n,10),n.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(n,15),n.Mt(ut(e.integerValue));else if("doubleValue"in e){const r=ut(e.doubleValue);isNaN(r)?this.Ft(n,13):(this.Ft(n,15),fc(r)?n.Mt(0):n.Mt(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Ft(n,20),typeof r=="string"&&(r=es(r)),n.xt(`${r.seconds||""}`),n.Mt(r.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,n),this.Nt(n);else if("bytesValue"in e)this.Ft(n,30),n.Bt(ts(e.bytesValue)),this.Nt(n);else if("referenceValue"in e)this.Lt(e.referenceValue,n);else if("geoPointValue"in e){const r=e.geoPointValue;this.Ft(n,45),n.Mt(r.latitude||0),n.Mt(r.longitude||0)}else"mapValue"in e?Ib(e)?this.Ft(n,Number.MAX_SAFE_INTEGER):Hh(e)?this.kt(e.mapValue,n):(this.qt(e.mapValue,n),this.Nt(n)):"arrayValue"in e?(this.Qt(e.arrayValue,n),this.Nt(n)):le(19022,{$t:e})}Ot(e,n){this.Ft(n,25),this.Ut(e,n)}Ut(e,n){n.xt(e)}qt(e,n){const r=e.fields||{};this.Ft(n,55);for(const s of Object.keys(r))this.Ot(s,n),this.Ct(r[s],n)}kt(e,n){var o,a;const r=e.fields||{};this.Ft(n,53);const s=ma,i=((a=(o=r[s].arrayValue)==null?void 0:o.values)==null?void 0:a.length)||0;this.Ft(n,15),n.Mt(ut(i)),this.Ot(s,n),this.Ct(r[s],n)}Qt(e,n){const r=e.values||[];this.Ft(n,50);for(const s of r)this.Ct(s,n)}Lt(e,n){this.Ft(n,37),te.fromName(e).path.forEach(r=>{this.Ft(n,60),this.Ut(r,n)})}Ft(e,n){e.Mt(n)}Nt(e){e.Mt(2)}}wi.Kt=new wi;/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law | agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES | CONDITIONS OF ANY KIND, either express | implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const po=255;function MV(t){if(t===0)return 8;let e=0;return t>>4||(e+=4,t<<=4),t>>6||(e+=2,t<<=2),t>>7||(e+=1),e}function eI(t){const e=64-function(r){let s=0;for(let i=0;i<8;++i){const o=MV(255&r[i]);if(s+=o,o!==8)break}return s}(t);return Math.ceil(e/8)}class FV{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Wt(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.Gt(r.value),r=n.next();this.zt()}jt(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.Jt(r.value),r=n.next();this.Ht()}Yt(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.Gt(r);else if(r<2048)this.Gt(960|r>>>6),this.Gt(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Gt(480|r>>>12),this.Gt(128|63&r>>>6),this.Gt(128|63&r);else{const s=n.codePointAt(0);this.Gt(240|s>>>18),this.Gt(128|63&s>>>12),this.Gt(128|63&s>>>6),this.Gt(128|63&s)}}this.zt()}Zt(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.Jt(r);else if(r<2048)this.Jt(960|r>>>6),this.Jt(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Jt(480|r>>>12),this.Jt(128|63&r>>>6),this.Jt(128|63&r);else{const s=n.codePointAt(0);this.Jt(240|s>>>18),this.Jt(128|63&s>>>12),this.Jt(128|63&s>>>6),this.Jt(128|63&s)}}this.Ht()}Xt(e){const n=this.en(e),r=eI(n);this.tn(1+r),this.buffer[this.position++]=255&r;for(let s=n.length-r;s<n.length;++s)this.buffer[this.position++]=255&n[s]}nn(e){const n=this.en(e),r=eI(n);this.tn(1+r),this.buffer[this.position++]=~(255&r);for(let s=n.length-r;s<n.length;++s)this.buffer[this.position++]=~(255&n[s])}rn(){this.sn(po),this.sn(255)}_n(){this.an(po),this.an(255)}reset(){this.position=0}seed(e){this.tn(e.length),this.buffer.set(e,this.position),this.position+=e.length}un(){return this.buffer.slice(0,this.position)}en(e){const n=function(i){const o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,i,!1),new Uint8Array(o.buffer)}(e),r=!!(128&n[0]);n[0]^=r?255:128;for(let s=1;s<n.length;++s)n[s]^=r?255:0;return n}Gt(e){const n=255&e;n===0?(this.sn(0),this.sn(255)):n===po?(this.sn(po),this.sn(0)):this.sn(n)}Jt(e){const n=255&e;n===0?(this.an(0),this.an(255)):n===po?(this.an(po),this.an(0)):this.an(e)}zt(){this.sn(0),this.sn(1)}Ht(){this.an(0),this.an(1)}sn(e){this.tn(1),this.buffer[this.position++]=e}an(e){this.tn(1),this.buffer[this.position++]=~e}tn(e){const n=e+this.position;if(n<=this.buffer.length)return;let r=2*this.buffer.length;r<n&&(r=n);const s=new Uint8Array(r);s.set(this.buffer),this.buffer=s}}class UV{constructor(e){this.cn=e}Bt(e){this.cn.Wt(e)}xt(e){this.cn.Yt(e)}Mt(e){this.cn.Xt(e)}vt(){this.cn.rn()}}class $V{constructor(e){this.cn=e}Bt(e){this.cn.jt(e)}xt(e){this.cn.Zt(e)}Mt(e){this.cn.nn(e)}vt(){this.cn._n()}}class il{constructor(){this.cn=new FV,this.ln=new UV(this.cn),this.hn=new $V(this.cn)}seed(e){this.cn.seed(e)}Pn(e){return e===0?this.ln:this.hn}un(){return this.cn.un()}reset(){this.cn.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ei{constructor(e,n,r,s){this.Tn=e,this.In=n,this.En=r,this.dn=s}An(){const e=this.dn.length,n=e===0||this.dn[e-1]===255?e+1:e,r=new Uint8Array(n);return r.set(this.dn,0),n!==e?r.set([0],this.dn.length):++r[r.length-1],new Ei(this.Tn,this.In,this.En,r)}Rn(e,n,r){return{indexId:this.Tn,uid:e,arrayValue:ad(this.En),directionalValue:ad(this.dn),orderedDocumentKey:ad(n),documentKey:r.path.toArray()}}Vn(e,n,r){const s=this.Rn(e,n,r);return[s.indexId,s.uid,s.arrayValue,s.directionalValue,s.orderedDocumentKey,s.documentKey]}}function ps(t,e){let n=t.Tn-e.Tn;return n!==0?n:(n=tI(t.En,e.En),n!==0?n:(n=tI(t.dn,e.dn),n!==0?n:te.comparator(t.In,e.In)))}function tI(t,e){for(let n=0;n<t.length&&n<e.length;++n){const r=t[n]-e[n];if(r!==0)return r}return t.length-e.length}function ad(t){return nS()?function(n){let r="";for(let s=0;s<n.length;s++)r+=String.fromCharCode(n[s]);return r}(t):t}function nI(t){return typeof t!="string"?t:function(n){const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}(t)}class rI{constructor(e){this.mn=new tt((n,r)=>gt.comparator(n.field,r.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.fn=e.orderBy,this.gn=[];for(const n of e.filters){const r=n;r.isInequality()?this.mn=this.mn.add(r):this.gn.push(r)}}get pn(){return this.mn.size>1}yn(e){if(ue(e.collectionGroup===this.collectionId,49279),this.pn)return!1;const n=Mm(e);if(n!==void 0&&!this.wn(n))return!1;const r=gi(e);let s=new Set,i=0,o=0;for(;i<r.length&&this.wn(r[i]);++i)s=s.add(r[i].fieldPath.canonicalString());if(i===r.length)return!0;if(this.mn.size>0){const a=this.mn.getIterator().getNext();if(!s.has(a.field.canonicalString())){const l=r[i];if(!this.Sn(a,l)||!this.bn(this.fn[o++],l))return!1}++i}for(;i<r.length;++i){const a=r[i];if(o>=this.fn.length||!this.bn(this.fn[o++],a))return!1}return!0}Dn(){if(this.pn)return null;let e=new tt(gt.comparator);const n=[];for(const r of this.gn)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")n.push(new Zu(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),n.push(new Zu(r.field,0))}for(const r of this.fn)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),n.push(new Zu(r.field,r.dir==="asc"?0:1)));return new qd(qd.UNKNOWN_ID,this.collectionId,n,hc.empty())}wn(e){for(const n of this.gn)if(this.Sn(n,e))return!0;return!1}Sn(e,n){if(e===void 0||!e.field.isEqual(n.fieldPath))return!1;const r=e.op==="array-contains"||e.op==="array-contains-any";return n.kind===2===r}bn(e,n){return!!e.field.isEqual(n.fieldPath)&&(n.kind===0&&e.dir==="asc"||n.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cC(t){var n,r;if(ue(t instanceof Me||t instanceof Ze,20012),t instanceof Me){if(t instanceof Nb){const s=((r=(n=t.value.arrayValue)==null?void 0:n.values)==null?void 0:r.map(i=>Me.create(t.field,"==",i)))||[];return Ze.create(s,"or")}return t}const e=t.filters.map(s=>cC(s));return Ze.create(e,t.op)}function BV(t){if(t.getFilters().length===0)return[];const e=tg(cC(t));return ue(uC(e),7391),Zm(e)||eg(e)?[e]:e.getFilters()}function Zm(t){return t instanceof Me}function eg(t){return t instanceof Ze&&Oy(t)}function uC(t){return Zm(t)||eg(t)||function(n){if(n instanceof Ze&&Hm(n)){for(const r of n.getFilters())if(!Zm(r)&&!eg(r))return!1;return!0}return!1}(t)}function tg(t){if(ue(t instanceof Me||t instanceof Ze,34018),t instanceof Me)return t;if(t.filters.length===1)return tg(t.filters[0]);const e=t.filters.map(r=>tg(r));let n=Ze.create(e,t.op);return n=th(n),uC(n)?n:(ue(n instanceof Ze,64498),ue(ya(n),40251),ue(n.filters.length>1,57927),n.filters.reduce((r,s)=>qy(r,s)))}function qy(t,e){let n;return ue(t instanceof Me||t instanceof Ze,38388),ue(e instanceof Me||e instanceof Ze,25473),n=t instanceof Me?e instanceof Me?function(s,i){return Ze.create([s,i],"and")}(t,e):sI(t,e):e instanceof Me?sI(e,t):function(s,i){if(ue(s.filters.length>0&&i.filters.length>0,48005),ya(s)&&ya(i))return Ab(s,i.getFilters());const o=Hm(s)?s:i,a=Hm(s)?i:s,l=o.filters.map(d=>qy(d,a));return Ze.create(l,"or")}(t,e),th(n)}function sI(t,e){if(ya(e))return Ab(e,t.getFilters());{const n=e.filters.map(r=>qy(t,r));return Ze.create(n,"or")}}function th(t){if(ue(t instanceof Me||t instanceof Ze,11850),t instanceof Me)return t;const e=t.getFilters();if(e.length===1)return th(e[0]);if(bb(t))return t;const n=e.map(s=>th(s)),r=[];return n.forEach(s=>{s instanceof Me?r.push(s):s instanceof Ze&&(s.op===t.op?r.push(...s.filters):r.push(s))}),r.length===1?r[0]:Ze.create(r,t.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zV{constructor(){this.Cn=new Hy}addToCollectionParentIndex(e,n){return this.Cn.add(n),O.resolve()}getCollectionParents(e,n){return O.resolve(this.Cn.getEntries(n))}addFieldIndex(e,n){return O.resolve()}deleteFieldIndex(e,n){return O.resolve()}deleteAllFieldIndexes(e){return O.resolve()}createTargetIndexes(e,n){return O.resolve()}getDocumentsMatchingTarget(e,n){return O.resolve(null)}getIndexType(e,n){return O.resolve(0)}getFieldIndexes(e,n){return O.resolve([])}getNextCollectionGroupToUpdate(e){return O.resolve(null)}getMinOffset(e,n){return O.resolve(Mn.min())}getMinOffsetFromCollectionGroup(e,n){return O.resolve(Mn.min())}updateCollectionGroup(e,n,r){return O.resolve()}updateIndexEntries(e,n){return O.resolve()}}class Hy{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n]||new tt(We.comparator),i=!s.has(r);return this.index[n]=s.add(r),i}has(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n];return s&&s.has(r)}getEntries(e){return(this.index[e]||new tt(We.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iI="IndexedDbIndexManager",Su=new Uint8Array(0);class qV{constructor(e,n){this.databaseId=n,this.vn=new Hy,this.Fn=new rs(r=>Wi(r),(r,s)=>Vc(r,s)),this.uid=e.uid||""}addToCollectionParentIndex(e,n){if(!this.vn.has(n)){const r=n.lastSegment(),s=n.popLast();e.addOnCommittedListener(()=>{this.vn.add(n)});const i={collectionId:r,parent:un(s)};return oI(e).put(i)}return O.resolve()}getCollectionParents(e,n){const r=[],s=IDBKeyRange.bound([n,""],[JS(n),""],!1,!0);return oI(e).J(s).next(i=>{for(const o of i){if(o.collectionId!==n)break;r.push(Sr(o.parent))}return r})}addFieldIndex(e,n){const r=ol(e),s=function(a){return{indexId:a.indexId,collectionGroup:a.collectionGroup,fields:a.fields.map(l=>[l.fieldPath.canonicalString(),l.kind])}}(n);delete s.indexId;const i=r.add(s);if(n.indexState){const o=go(e);return i.next(a=>{o.put(XE(a,this.uid,n.indexState.sequenceNumber,n.indexState.offset))})}return i.next()}deleteFieldIndex(e,n){const r=ol(e),s=go(e),i=mo(e);return r.delete(n.indexId).next(()=>s.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0))).next(()=>i.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){const n=ol(e),r=mo(e),s=go(e);return n.Z().next(()=>r.Z()).next(()=>s.Z())}createTargetIndexes(e,n){return O.forEach(this.Mn(n),r=>this.getIndexType(e,r).next(s=>{if(s===0||s===1){const i=new rI(r).Dn();if(i!=null)return this.addFieldIndex(e,i)}}))}getDocumentsMatchingTarget(e,n){const r=mo(e);let s=!0;const i=new Map;return O.forEach(this.Mn(n),o=>this.xn(e,o).next(a=>{s&&(s=!!a),i.set(o,a)})).next(()=>{if(s){let o=Ne();const a=[];return O.forEach(i,(l,d)=>{H(iI,`Using index ${function(y){return`id=${y.indexId}|cg=${y.collectionGroup}|f=${y.fields.map(j=>`${j.fieldPath}:${j.kind}`).join(",")}`}(l)} to execute ${Wi(n)}`);const h=function(y,j){const V=Mm(j);if(V===void 0)return null;for(const M of Yd(y,V.fieldPath))switch(M.op){case"array-contains-any":return M.value.arrayValue.values||[];case"array-contains":return[M.value]}return null}(d,l),f=function(y,j){const V=new Map;for(const M of gi(j))for(const T of Yd(y,M.fieldPath))switch(T.op){case"==":case"in":V.set(M.fieldPath.canonicalString(),T.value);break;case"not-in":case"!=":return V.set(M.fieldPath.canonicalString(),T.value),Array.from(V.values())}return null}(d,l),m=function(y,j){const V=[];let M=!0;for(const T of gi(j)){const _=T.kind===0?LE(y,T.fieldPath,y.startAt):ME(y,T.fieldPath,y.startAt);V.push(_.value),M&&(M=_.inclusive)}return new Qs(V,M)}(d,l),v=function(y,j){const V=[];let M=!0;for(const T of gi(j)){const _=T.kind===0?ME(y,T.fieldPath,y.endAt):LE(y,T.fieldPath,y.endAt);V.push(_.value),M&&(M=_.inclusive)}return new Qs(V,M)}(d,l),R=this.On(l,d,m),b=this.On(l,d,v),A=this.Nn(l,d,f),I=this.Bn(l.indexId,h,R,m.inclusive,b,v.inclusive,A);return O.forEach(I,w=>r.Y(w,n.limit).next(y=>{y.forEach(j=>{const V=te.fromSegments(j.documentKey);o.has(V)||(o=o.add(V),a.push(V))})}))}).next(()=>a)}return O.resolve(null)})}Mn(e){let n=this.Fn.get(e);return n||(e.filters.length===0?n=[e]:n=BV(Ze.create(e.filters,"and")).map(r=>Km(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.Fn.set(e,n),n)}Bn(e,n,r,s,i,o,a){const l=(n!=null?n.length:1)*Math.max(r.length,i.length),d=l/(n!=null?n.length:1),h=[];for(let f=0;f<l;++f){const m=n?this.Ln(n[f/d]):Su,v=this.kn(e,m,r[f%d],s),R=this.qn(e,m,i[f%d],o),b=a.map(A=>this.kn(e,m,A,!0));h.push(...this.createRange(v,R,b))}return h}kn(e,n,r,s){const i=new Ei(e,te.empty(),n,r);return s?i:i.An()}qn(e,n,r,s){const i=new Ei(e,te.empty(),n,r);return s?i.An():i}xn(e,n){const r=new rI(n),s=n.collectionGroup!=null?n.collectionGroup:n.path.lastSegment();return this.getFieldIndexes(e,s).next(i=>{let o=null;for(const a of i)r.yn(a)&&(!o||a.fields.length>o.fields.length)&&(o=a);return o})}getIndexType(e,n){let r=2;const s=this.Mn(n);return O.forEach(s,i=>this.xn(e,i).next(o=>{o?r!==0&&o.fields.length<function(l){let d=new tt(gt.comparator),h=!1;for(const f of l.filters)for(const m of f.getFlattenedFilters())m.field.isKeyField()||(m.op==="array-contains"||m.op==="array-contains-any"?h=!0:d=d.add(m.field));for(const f of l.orderBy)f.field.isKeyField()||(d=d.add(f.field));return d.size+(h?1:0)}(i)&&(r=1):r=0})).next(()=>function(o){return o.limit!==null}(n)&&s.length>1&&r===2?1:r)}Qn(e,n){const r=new il;for(const s of gi(e)){const i=n.data.field(s.fieldPath);if(i==null)return null;const o=r.Pn(s.kind);wi.Kt.Dt(i,o)}return r.un()}Ln(e){const n=new il;return wi.Kt.Dt(e,n.Pn(0)),n.un()}$n(e,n){const r=new il;return wi.Kt.Dt(Hi(this.databaseId,n),r.Pn(function(i){const o=gi(i);return o.length===0?0:o[o.length-1].kind}(e))),r.un()}Nn(e,n,r){if(r===null)return[];let s=[];s.push(new il);let i=0;for(const o of gi(e)){const a=r[i++];for(const l of s)if(this.Un(n,o.fieldPath)&&vc(a))s=this.Kn(s,o,a);else{const d=l.Pn(o.kind);wi.Kt.Dt(a,d)}}return this.Wn(s)}On(e,n,r){return this.Nn(e,n,r.position)}Wn(e){const n=[];for(let r=0;r<e.length;++r)n[r]=e[r].un();return n}Kn(e,n,r){const s=[...e],i=[];for(const o of r.arrayValue.values||[])for(const a of s){const l=new il;l.seed(a.un()),wi.Kt.Dt(o,l.Pn(n.kind)),i.push(l)}return i}Un(e,n){return!!e.filters.find(r=>r instanceof Me&&r.field.isEqual(n)&&(r.op==="in"||r.op==="not-in"))}getFieldIndexes(e,n){const r=ol(e),s=go(e);return(n?r.J(Um,IDBKeyRange.bound(n,n)):r.J()).next(i=>{const o=[];return O.forEach(i,a=>s.get([a.indexId,this.uid]).next(l=>{o.push(function(h,f){const m=f?new hc(f.sequenceNumber,new Mn(Qi(f.readTime),new te(Sr(f.documentKey)),f.largestBatchId)):hc.empty(),v=h.fields.map(([R,b])=>new Zu(gt.fromServerFormat(R),b));return new qd(h.indexId,h.collectionGroup,v,m)}(a,l))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(n=>n.length===0?null:(n.sort((r,s)=>{const i=r.indexState.sequenceNumber-s.indexState.sequenceNumber;return i!==0?i:Te(r.collectionGroup,s.collectionGroup)}),n[0].collectionGroup))}updateCollectionGroup(e,n,r){const s=ol(e),i=go(e);return this.Gn(e).next(o=>s.J(Um,IDBKeyRange.bound(n,n)).next(a=>O.forEach(a,l=>i.put(XE(l.indexId,this.uid,o,r)))))}updateIndexEntries(e,n){const r=new Map;return O.forEach(n,(s,i)=>{const o=r.get(s.collectionGroup);return(o?O.resolve(o):this.getFieldIndexes(e,s.collectionGroup)).next(a=>(r.set(s.collectionGroup,a),O.forEach(a,l=>this.zn(e,s,l).next(d=>{const h=this.jn(i,l);return d.isEqual(h)?O.resolve():this.Jn(e,i,l,d,h)}))))})}Hn(e,n,r,s){return mo(e).put(s.Rn(this.uid,this.$n(r,n.key),n.key))}Yn(e,n,r,s){return mo(e).delete(s.Vn(this.uid,this.$n(r,n.key),n.key))}zn(e,n,r){const s=mo(e);let i=new tt(ps);return s.ee({index:cb,range:IDBKeyRange.only([r.indexId,this.uid,ad(this.$n(r,n))])},(o,a)=>{i=i.add(new Ei(r.indexId,n,nI(a.arrayValue),nI(a.directionalValue)))}).next(()=>i)}jn(e,n){let r=new tt(ps);const s=this.Qn(n,e);if(s==null)return r;const i=Mm(n);if(i!=null){const o=e.data.field(i.fieldPath);if(vc(o))for(const a of o.arrayValue.values||[])r=r.add(new Ei(n.indexId,e.key,this.Ln(a),s))}else r=r.add(new Ei(n.indexId,e.key,Su,s));return r}Jn(e,n,r,s,i){H(iI,"Updating index entries for document '%s'",n.key);const o=[];return function(l,d,h,f,m){const v=l.getIterator(),R=d.getIterator();let b=fo(v),A=fo(R);for(;b||A;){let I=!1,w=!1;if(b&&A){const y=h(b,A);y<0?w=!0:y>0&&(I=!0)}else b!=null?w=!0:I=!0;I?(f(A),A=fo(R)):w?(m(b),b=fo(v)):(b=fo(v),A=fo(R))}}(s,i,ps,a=>{o.push(this.Hn(e,n,r,a))},a=>{o.push(this.Yn(e,n,r,a))}),O.waitFor(o)}Gn(e){let n=1;return go(e).ee({index:lb,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,s,i)=>{i.done(),n=s.sequenceNumber+1}).next(()=>n)}createRange(e,n,r){r=r.sort((o,a)=>ps(o,a)).filter((o,a,l)=>!a||ps(o,l[a-1])!==0);const s=[];s.push(e);for(const o of r){const a=ps(o,e),l=ps(o,n);if(a===0)s[0]=e.An();else if(a>0&&l<0)s.push(o),s.push(o.An());else if(l>0)break}s.push(n);const i=[];for(let o=0;o<s.length;o+=2){if(this.Zn(s[o],s[o+1]))return[];const a=s[o].Vn(this.uid,Su,te.empty()),l=s[o+1].Vn(this.uid,Su,te.empty());i.push(IDBKeyRange.bound(a,l))}return i}Zn(e,n){return ps(e,n)>0}getMinOffsetFromCollectionGroup(e,n){return this.getFieldIndexes(e,n).next(aI)}getMinOffset(e,n){return O.mapArray(this.Mn(n),r=>this.xn(e,r).next(s=>s||le(44426))).next(aI)}}function oI(t){return Vt(t,gc)}function mo(t){return Vt(t,Ml)}function ol(t){return Vt(t,Py)}function go(t){return Vt(t,Ll)}function aI(t){ue(t.length!==0,28825);let e=t[0].indexState.offset,n=e.largestBatchId;for(let r=1;r<t.length;r++){const s=t[r].indexState.offset;Cy(s,e)<0&&(e=s),n<s.largestBatchId&&(n=s.largestBatchId)}return new Mn(e.readTime,e.documentKey,n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lI={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},dC=41943040;class sn{static withCacheSize(e){return new sn(e,sn.DEFAULT_COLLECTION_PERCENTILE,sn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hC(t,e,n){const r=t.store(rr),s=t.store(da),i=[],o=IDBKeyRange.only(n.batchId);let a=0;const l=r.ee({range:o},(h,f,m)=>(a++,m.delete()));i.push(l.next(()=>{ue(a===1,47070,{batchId:n.batchId})}));const d=[];for(const h of n.mutations){const f=ib(e,h.key.path,n.batchId);i.push(s.delete(f)),d.push(h.key)}return O.waitFor(i).next(()=>d)}function nh(t){if(!t)return 0;let e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw le(14731);e=t.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */sn.DEFAULT_COLLECTION_PERCENTILE=10,sn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,sn.DEFAULT=new sn(dC,sn.DEFAULT_COLLECTION_PERCENTILE,sn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),sn.DISABLED=new sn(-1,0,0);class Zh{constructor(e,n,r,s){this.userId=e,this.serializer=n,this.indexManager=r,this.referenceDelegate=s,this.Xn={}}static wt(e,n,r,s){ue(e.uid!=="",64387);const i=e.isAuthenticated()?e.uid:"";return new Zh(i,n,r,s)}checkEmpty(e){let n=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return ms(e).ee({index:bi,range:r},(s,i,o)=>{n=!1,o.done()}).next(()=>n)}addMutationBatch(e,n,r,s){const i=Ao(e),o=ms(e);return o.add({}).next(a=>{ue(typeof a=="number",49019);const l=new My(a,n,r,s),d=function(v,R,b){const A=b.baseMutations.map(w=>Zd(v.yt,w)),I=b.mutations.map(w=>Zd(v.yt,w));return{userId:R,batchId:b.batchId,localWriteTimeMs:b.localWriteTime.toMillis(),baseMutations:A,mutations:I}}(this.serializer,this.userId,l),h=[];let f=new tt((m,v)=>Te(m.canonicalString(),v.canonicalString()));for(const m of s){const v=ib(this.userId,m.key.path,a);f=f.add(m.key.path.popLast()),h.push(o.put(d)),h.push(i.put(v,yO))}return f.forEach(m=>{h.push(this.indexManager.addToCollectionParentIndex(e,m))}),e.addOnCommittedListener(()=>{this.Xn[a]=l.keys()}),O.waitFor(h).next(()=>l)})}lookupMutationBatch(e,n){return ms(e).get(n).next(r=>r?(ue(r.userId===this.userId,48,"Unexpected user for mutation batch",{userId:r.userId,batchId:n}),vi(this.serializer,r)):null)}er(e,n){return this.Xn[n]?O.resolve(this.Xn[n]):this.lookupMutationBatch(e,n).next(r=>{if(r){const s=r.keys();return this.Xn[n]=s,s}return null})}getNextMutationBatchAfterBatchId(e,n){const r=n+1,s=IDBKeyRange.lowerBound([this.userId,r]);let i=null;return ms(e).ee({index:bi,range:s},(o,a,l)=>{a.userId===this.userId&&(ue(a.batchId>=r,47524,{tr:r}),i=vi(this.serializer,a)),l.done()}).next(()=>i)}getHighestUnacknowledgedBatchId(e){const n=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=Pi;return ms(e).ee({index:bi,range:n,reverse:!0},(s,i,o)=>{r=i.batchId,o.done()}).next(()=>r)}getAllMutationBatches(e){const n=IDBKeyRange.bound([this.userId,Pi],[this.userId,Number.POSITIVE_INFINITY]);return ms(e).J(bi,n).next(r=>r.map(s=>vi(this.serializer,s)))}getAllMutationBatchesAffectingDocumentKey(e,n){const r=ed(this.userId,n.path),s=IDBKeyRange.lowerBound(r),i=[];return Ao(e).ee({range:s},(o,a,l)=>{const[d,h,f]=o,m=Sr(h);if(d===this.userId&&n.path.isEqual(m))return ms(e).get(f).next(v=>{if(!v)throw le(61480,{nr:o,batchId:f});ue(v.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:v.userId,batchId:f}),i.push(vi(this.serializer,v))});l.done()}).next(()=>i)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new tt(Te);const s=[];return n.forEach(i=>{const o=ed(this.userId,i.path),a=IDBKeyRange.lowerBound(o),l=Ao(e).ee({range:a},(d,h,f)=>{const[m,v,R]=d,b=Sr(v);m===this.userId&&i.path.isEqual(b)?r=r.add(R):f.done()});s.push(l)}),O.waitFor(s).next(()=>this.rr(e,r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,s=r.length+1,i=ed(this.userId,r),o=IDBKeyRange.lowerBound(i);let a=new tt(Te);return Ao(e).ee({range:o},(l,d,h)=>{const[f,m,v]=l,R=Sr(m);f===this.userId&&r.isPrefixOf(R)?R.length===s&&(a=a.add(v)):h.done()}).next(()=>this.rr(e,a))}rr(e,n){const r=[],s=[];return n.forEach(i=>{s.push(ms(e).get(i).next(o=>{if(o===null)throw le(35274,{batchId:i});ue(o.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:o.userId,batchId:i}),r.push(vi(this.serializer,o))}))}),O.waitFor(s).next(()=>r)}removeMutationBatch(e,n){return hC(e.le,this.userId,n).next(r=>(e.addOnCommittedListener(()=>{this.ir(n.batchId)}),O.forEach(r,s=>this.referenceDelegate.markPotentiallyOrphaned(e,s))))}ir(e){delete this.Xn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(n=>{if(!n)return O.resolve();const r=IDBKeyRange.lowerBound(function(o){return[o]}(this.userId)),s=[];return Ao(e).ee({range:r},(i,o,a)=>{if(i[0]===this.userId){const l=Sr(i[1]);s.push(l)}else a.done()}).next(()=>{ue(s.length===0,56720,{sr:s.map(i=>i.canonicalString())})})})}containsKey(e,n){return fC(e,this.userId,n)}_r(e){return pC(e).get(this.userId).next(n=>n||{userId:this.userId,lastAcknowledgedBatchId:Pi,lastStreamToken:""})}}function fC(t,e,n){const r=ed(e,n.path),s=r[1],i=IDBKeyRange.lowerBound(r);let o=!1;return Ao(t).ee({range:i,X:!0},(a,l,d)=>{const[h,f,m]=a;h===e&&f===s&&(o=!0),d.done()}).next(()=>o)}function ms(t){return Vt(t,rr)}function Ao(t){return Vt(t,da)}function pC(t){return Vt(t,pc)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yi{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new Yi(0)}static cr(){return new Yi(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HV{constructor(e,n){this.referenceDelegate=e,this.serializer=n}allocateTargetId(e){return this.lr(e).next(n=>{const r=new Yi(n.highestTargetId);return n.highestTargetId=r.next(),this.hr(e,n).next(()=>n.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.lr(e).next(n=>me.fromTimestamp(new Be(n.lastRemoteSnapshotVersion.seconds,n.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.lr(e).next(n=>n.highestListenSequenceNumber)}setTargetsMetadata(e,n,r){return this.lr(e).next(s=>(s.highestListenSequenceNumber=n,r&&(s.lastRemoteSnapshotVersion=r.toTimestamp()),n>s.highestListenSequenceNumber&&(s.highestListenSequenceNumber=n),this.hr(e,s)))}addTargetData(e,n){return this.Pr(e,n).next(()=>this.lr(e).next(r=>(r.targetCount+=1,this.Tr(n,r),this.hr(e,r))))}updateTargetData(e,n){return this.Pr(e,n)}removeTargetData(e,n){return this.removeMatchingKeysForTargetId(e,n.targetId).next(()=>yo(e).delete(n.targetId)).next(()=>this.lr(e)).next(r=>(ue(r.targetCount>0,8065),r.targetCount-=1,this.hr(e,r)))}removeTargets(e,n,r){let s=0;const i=[];return yo(e).ee((o,a)=>{const l=wl(a);l.sequenceNumber<=n&&r.get(l.targetId)===null&&(s++,i.push(this.removeTargetData(e,l)))}).next(()=>O.waitFor(i)).next(()=>s)}forEachTarget(e,n){return yo(e).ee((r,s)=>{const i=wl(s);n(i)})}lr(e){return cI(e).get(Kd).next(n=>(ue(n!==null,2888),n))}hr(e,n){return cI(e).put(Kd,n)}Pr(e,n){return yo(e).put(aC(this.serializer,n))}Tr(e,n){let r=!1;return e.targetId>n.highestTargetId&&(n.highestTargetId=e.targetId,r=!0),e.sequenceNumber>n.highestListenSequenceNumber&&(n.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.lr(e).next(n=>n.targetCount)}getTargetData(e,n){const r=Wi(n),s=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let i=null;return yo(e).ee({range:s,index:ab},(o,a,l)=>{const d=wl(a);Vc(n,d.target)&&(i=d,l.done())}).next(()=>i)}addMatchingKeys(e,n,r){const s=[],i=bs(e);return n.forEach(o=>{const a=un(o.path);s.push(i.put({targetId:r,path:a})),s.push(this.referenceDelegate.addReference(e,r,o))}),O.waitFor(s)}removeMatchingKeys(e,n,r){const s=bs(e);return O.forEach(n,i=>{const o=un(i.path);return O.waitFor([s.delete([r,o]),this.referenceDelegate.removeReference(e,r,i)])})}removeMatchingKeysForTargetId(e,n){const r=bs(e),s=IDBKeyRange.bound([n],[n+1],!1,!0);return r.delete(s)}getMatchingKeysForTargetId(e,n){const r=IDBKeyRange.bound([n],[n+1],!1,!0),s=bs(e);let i=Ne();return s.ee({range:r,X:!0},(o,a,l)=>{const d=Sr(o[1]),h=new te(d);i=i.add(h)}).next(()=>i)}containsKey(e,n){const r=un(n.path),s=IDBKeyRange.bound([r],[JS(r)],!1,!0);let i=0;return bs(e).ee({index:Ry,X:!0,range:s},([o,a],l,d)=>{o!==0&&(i++,d.done())}).next(()=>i>0)}At(e,n){return yo(e).get(n).next(r=>r?wl(r):null)}}function yo(t){return Vt(t,ha)}function cI(t){return Vt(t,Ni)}function bs(t){return Vt(t,fa)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uI="LruGarbageCollector",WV=1048576;function dI([t,e],[n,r]){const s=Te(t,n);return s===0?Te(e,r):s}class KV{constructor(e){this.Ir=e,this.buffer=new tt(dI),this.Er=0}dr(){return++this.Er}Ar(e){const n=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(n);else{const r=this.buffer.last();dI(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}}class mC{constructor(e,n,r){this.garbageCollector=e,this.asyncQueue=n,this.localStore=r,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){H(uI,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){si(n)?H(uI,"Ignoring IndexedDB error during garbage collection: ",n):await oo(n)}await this.Vr(3e5)})}}class GV{constructor(e,n){this.mr=e,this.params=n}calculateTargetCount(e,n){return this.mr.gr(e).next(r=>Math.floor(n/100*r))}nthSequenceNumber(e,n){if(n===0)return O.resolve(Wn.ce);const r=new KV(n);return this.mr.forEachTarget(e,s=>r.Ar(s.sequenceNumber)).next(()=>this.mr.pr(e,s=>r.Ar(s))).next(()=>r.maxValue)}removeTargets(e,n,r){return this.mr.removeTargets(e,n,r)}removeOrphanedDocuments(e,n){return this.mr.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(H("LruGarbageCollector","Garbage collection skipped; disabled"),O.resolve(lI)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(H("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),lI):this.yr(e,n))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,n){let r,s,i,o,a,l,d;const h=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(f=>(f>this.params.maximumSequenceNumbersToCollect?(H("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${f}`),s=this.params.maximumSequenceNumbersToCollect):s=f,o=Date.now(),this.nthSequenceNumber(e,s))).next(f=>(r=f,a=Date.now(),this.removeTargets(e,r,n))).next(f=>(i=f,l=Date.now(),this.removeOrphanedDocuments(e,r))).next(f=>(d=Date.now(),So()<=Le.DEBUG&&H("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-h}ms
	Determined least recently used ${s} in `+(a-o)+`ms
	Removed ${i} targets in `+(l-a)+`ms
	Removed ${f} documents in `+(d-l)+`ms
Total Duration: ${d-h}ms`),O.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:i,documentsRemoved:f})))}}function gC(t,e){return new GV(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QV{constructor(e,n){this.db=e,this.garbageCollector=gC(this,n)}gr(e){const n=this.wr(e);return this.db.getTargetCache().getTargetCount(e).next(r=>n.next(s=>r+s))}wr(e){let n=0;return this.pr(e,r=>{n++}).next(()=>n)}forEachTarget(e,n){return this.db.getTargetCache().forEachTarget(e,n)}pr(e,n){return this.Sr(e,(r,s)=>n(s))}addReference(e,n,r){return bu(e,r)}removeReference(e,n,r){return bu(e,r)}removeTargets(e,n,r){return this.db.getTargetCache().removeTargets(e,n,r)}markPotentiallyOrphaned(e,n){return bu(e,n)}br(e,n){return function(s,i){let o=!1;return pC(s).te(a=>fC(s,a,i).next(l=>(l&&(o=!0),O.resolve(!l)))).next(()=>o)}(e,n)}removeOrphanedDocuments(e,n){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),s=[];let i=0;return this.Sr(e,(o,a)=>{if(a<=n){const l=this.br(e,o).next(d=>{if(!d)return i++,r.getEntry(e,o).next(()=>(r.removeEntry(o,me.min()),bs(e).delete(function(f){return[0,un(f.path)]}(o))))});s.push(l)}}).next(()=>O.waitFor(s)).next(()=>r.apply(e)).next(()=>i)}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,n){return bu(e,n)}Sr(e,n){const r=bs(e);let s,i=Wn.ce;return r.ee({index:Ry},([o,a],{path:l,sequenceNumber:d})=>{o===0?(i!==Wn.ce&&n(new te(Sr(s)),i),i=d,s=l):i=Wn.ce}).next(()=>{i!==Wn.ce&&n(new te(Sr(s)),i)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function bu(t,e){return bs(t).put(function(r,s){return{targetId:0,path:un(r.path),sequenceNumber:s}}(e,t.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yC{constructor(){this.changes=new rs(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,It.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?O.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YV{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,n,r){return di(e).put(r)}removeEntry(e,n,r){return di(e).delete(function(i,o){const a=i.path.toArray();return[a.slice(0,a.length-2),a[a.length-2],eh(o),a[a.length-1]]}(n,r))}updateMetadata(e,n){return this.getMetadata(e).next(r=>(r.byteSize+=n,this.Dr(e,r)))}getEntry(e,n){let r=It.newInvalidDocument(n);return di(e).ee({index:td,range:IDBKeyRange.only(al(n))},(s,i)=>{r=this.Cr(n,i)}).next(()=>r)}vr(e,n){let r={size:0,document:It.newInvalidDocument(n)};return di(e).ee({index:td,range:IDBKeyRange.only(al(n))},(s,i)=>{r={document:this.Cr(n,i),size:nh(i)}}).next(()=>r)}getEntries(e,n){let r=jn();return this.Fr(e,n,(s,i)=>{const o=this.Cr(s,i);r=r.insert(s,o)}).next(()=>r)}Mr(e,n){let r=jn(),s=new ft(te.comparator);return this.Fr(e,n,(i,o)=>{const a=this.Cr(i,o);r=r.insert(i,a),s=s.insert(i,nh(o))}).next(()=>({documents:r,Or:s}))}Fr(e,n,r){if(n.isEmpty())return O.resolve();let s=new tt(pI);n.forEach(l=>s=s.add(l));const i=IDBKeyRange.bound(al(s.first()),al(s.last())),o=s.getIterator();let a=o.getNext();return di(e).ee({index:td,range:i},(l,d,h)=>{const f=te.fromSegments([...d.prefixPath,d.collectionGroup,d.documentId]);for(;a&&pI(a,f)<0;)r(a,null),a=o.getNext();a&&a.isEqual(f)&&(r(a,d),a=o.hasNext()?o.getNext():null),a?h.j(al(a)):h.done()}).next(()=>{for(;a;)r(a,null),a=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,n,r,s,i){const o=n.path,a=[o.popLast().toArray(),o.lastSegment(),eh(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],l=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return di(e).J(IDBKeyRange.bound(a,l,!0)).next(d=>{i==null||i.incrementDocumentReadCount(d.length);let h=jn();for(const f of d){const m=this.Cr(te.fromSegments(f.prefixPath.concat(f.collectionGroup,f.documentId)),f);m.isFoundDocument()&&(Mc(n,m)||s.has(m.key))&&(h=h.insert(m.key,m))}return h})}getAllFromCollectionGroup(e,n,r,s){let i=jn();const o=fI(n,r),a=fI(n,Mn.max());return di(e).ee({index:ob,range:IDBKeyRange.bound(o,a,!0)},(l,d,h)=>{const f=this.Cr(te.fromSegments(d.prefixPath.concat(d.collectionGroup,d.documentId)),d);i=i.insert(f.key,f),i.size===s&&h.done()}).next(()=>i)}newChangeBuffer(e){return new XV(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(n=>n.byteSize)}getMetadata(e){return hI(e).get(Fm).next(n=>(ue(!!n,20021),n))}Dr(e,n){return hI(e).put(Fm,n)}Cr(e,n){if(n){const r=OV(this.serializer,n);if(!(r.isNoDocument()&&r.version.isEqual(me.min())))return r}return It.newInvalidDocument(e)}}function _C(t){return new YV(t)}class XV extends yC{constructor(e,n){super(),this.Nr=e,this.trackRemovals=n,this.Br=new rs(r=>r.toString(),(r,s)=>r.isEqual(s))}applyChanges(e){const n=[];let r=0,s=new tt((i,o)=>Te(i.canonicalString(),o.canonicalString()));return this.changes.forEach((i,o)=>{const a=this.Br.get(i);if(n.push(this.Nr.removeEntry(e,i,a.readTime)),o.isValidDocument()){const l=QE(this.Nr.serializer,o);s=s.add(i.path.popLast());const d=nh(l);r+=d-a.size,n.push(this.Nr.addEntry(e,i,l))}else if(r-=a.size,this.trackRemovals){const l=QE(this.Nr.serializer,o.convertToNoDocument(me.min()));n.push(this.Nr.addEntry(e,i,l))}}),s.forEach(i=>{n.push(this.Nr.indexManager.addToCollectionParentIndex(e,i))}),n.push(this.Nr.updateMetadata(e,r)),O.waitFor(n)}getFromCache(e,n){return this.Nr.vr(e,n).next(r=>(this.Br.set(n,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,n){return this.Nr.Mr(e,n).next(({documents:r,Or:s})=>(s.forEach((i,o)=>{this.Br.set(i,{size:o,readTime:r.get(i).readTime})}),r))}}function hI(t){return Vt(t,mc)}function di(t){return Vt(t,Wd)}function al(t){const e=t.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function fI(t,e){const n=e.documentKey.path.toArray();return[t,eh(e.readTime),n.slice(0,n.length-2),n.length>0?n[n.length-1]:""]}function pI(t,e){const n=t.path.toArray(),r=e.path.toArray();let s=0;for(let i=0;i<n.length-2&&i<r.length-2;++i)if(s=Te(n[i],r[i]),s)return s;return s=Te(n.length,r.length),s||(s=Te(n[n.length-2],r[r.length-2]),s||Te(n[n.length-1],r[r.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JV{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vC{constructor(e,n,r,s){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=s}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(s=>(r=s,this.remoteDocumentCache.getEntry(e,n))).next(s=>(r!==null&&$l(r.mutation,s,Sn.empty(),Be.now()),s))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,Ne()).next(()=>r))}getLocalViewOfDocuments(e,n,r=Ne()){const s=br();return this.populateOverlays(e,s,n).next(()=>this.computeViews(e,n,s,r).next(i=>{let o=_l();return i.forEach((a,l)=>{o=o.insert(a,l.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){const r=br();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,Ne()))}populateOverlays(e,n,r){const s=[];return r.forEach(i=>{n.has(i)||s.push(i)}),this.documentOverlayCache.getOverlays(e,s).next(i=>{i.forEach((o,a)=>{n.set(o,a)})})}computeViews(e,n,r,s){let i=jn();const o=Ul(),a=function(){return Ul()}();return n.forEach((l,d)=>{const h=r.get(d.key);s.has(d.key)&&(h===void 0||h.mutation instanceof ss)?i=i.insert(d.key,d):h!==void 0?(o.set(d.key,h.mutation.getFieldMask()),$l(h.mutation,d,h.mutation.getFieldMask(),Be.now())):o.set(d.key,Sn.empty())}),this.recalculateAndSaveOverlays(e,i).next(l=>(l.forEach((d,h)=>o.set(d,h)),n.forEach((d,h)=>a.set(d,new JV(h,o.get(d)??null))),a))}recalculateAndSaveOverlays(e,n){const r=Ul();let s=new ft((o,a)=>o-a),i=Ne();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(const a of o)a.keys().forEach(l=>{const d=n.get(l);if(d===null)return;let h=r.get(l)||Sn.empty();h=a.applyToLocalView(d,h),r.set(l,h);const f=(s.get(a.batchId)||Ne()).add(l);s=s.insert(a.batchId,f)})}).next(()=>{const o=[],a=s.getReverseIterator();for(;a.hasNext();){const l=a.getNext(),d=l.key,h=l.value,f=Lb();h.forEach(m=>{if(!i.has(m)){const v=qb(n.get(m),r.get(m));v!==null&&f.set(m,v),i=i.add(m)}}),o.push(this.documentOverlayCache.saveOverlays(e,d,f))}return O.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,s){return function(o){return te.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):Vy(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,s):this.getDocumentsMatchingCollectionQuery(e,n,r,s)}getNextDocuments(e,n,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,s).next(i=>{const o=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,s-i.size):O.resolve(br());let a=dc,l=i;return o.next(d=>O.forEach(d,(h,f)=>(a<f.largestBatchId&&(a=f.largestBatchId),i.get(h)?O.resolve():this.remoteDocumentCache.getEntry(e,h).next(m=>{l=l.insert(h,m)}))).next(()=>this.populateOverlays(e,d,i)).next(()=>this.computeViews(e,l,d,Ne())).next(h=>({batchId:a,changes:Vb(h)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new te(n)).next(r=>{let s=_l();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s})}getDocumentsMatchingCollectionGroupQuery(e,n,r,s){const i=n.collectionGroup;let o=_l();return this.indexManager.getCollectionParents(e,i).next(a=>O.forEach(a,l=>{const d=function(f,m){return new oi(m,null,f.explicitOrderBy.slice(),f.filters.slice(),f.limit,f.limitType,f.startAt,f.endAt)}(n,l.child(i));return this.getDocumentsMatchingCollectionQuery(e,d,r,s).next(h=>{h.forEach((f,m)=>{o=o.insert(f,m)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,n,r,s){let i;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(o=>(i=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,i,s))).next(o=>{i.forEach((l,d)=>{const h=d.getKey();o.get(h)===null&&(o=o.insert(h,It.newInvalidDocument(h)))});let a=_l();return o.forEach((l,d)=>{const h=i.get(l);h!==void 0&&$l(h.mutation,d,Sn.empty(),Be.now()),Mc(n,d)&&(a=a.insert(l,d))}),a})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZV{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,n){return O.resolve(this.Lr.get(n))}saveBundleMetadata(e,n){return this.Lr.set(n.id,function(s){return{id:s.id,version:s.version,createTime:yn(s.createTime)}}(n)),O.resolve()}getNamedQuery(e,n){return O.resolve(this.kr.get(n))}saveNamedQuery(e,n){return this.kr.set(n.name,function(s){return{name:s.name,query:lC(s.bundledQuery),readTime:yn(s.readTime)}}(n)),O.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eL{constructor(){this.overlays=new ft(te.comparator),this.qr=new Map}getOverlay(e,n){return O.resolve(this.overlays.get(n))}getOverlays(e,n){const r=br();return O.forEach(n,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((s,i)=>{this.St(e,n,i)}),O.resolve()}removeOverlaysForBatchId(e,n,r){const s=this.qr.get(r);return s!==void 0&&(s.forEach(i=>this.overlays=this.overlays.remove(i)),this.qr.delete(r)),O.resolve()}getOverlaysForCollection(e,n,r){const s=br(),i=n.length+1,o=new te(n.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const l=a.getNext().value,d=l.getKey();if(!n.isPrefixOf(d.path))break;d.path.length===i&&l.largestBatchId>r&&s.set(l.getKey(),l)}return O.resolve(s)}getOverlaysForCollectionGroup(e,n,r,s){let i=new ft((d,h)=>d-h);const o=this.overlays.getIterator();for(;o.hasNext();){const d=o.getNext().value;if(d.getKey().getCollectionGroup()===n&&d.largestBatchId>r){let h=i.get(d.largestBatchId);h===null&&(h=br(),i=i.insert(d.largestBatchId,h)),h.set(d.getKey(),d)}}const a=br(),l=i.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((d,h)=>a.set(d,h)),!(a.size()>=s)););return O.resolve(a)}St(e,n,r){const s=this.overlays.get(r.key);if(s!==null){const o=this.qr.get(s.largestBatchId).delete(r.key);this.qr.set(s.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new Uy(n,r));let i=this.qr.get(n);i===void 0&&(i=Ne(),this.qr.set(n,i)),this.qr.set(n,i.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tL{constructor(){this.sessionToken=Pt.EMPTY_BYTE_STRING}getSessionToken(e){return O.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,O.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wy{constructor(){this.Qr=new tt($t.$r),this.Ur=new tt($t.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,n){const r=new $t(e,n);this.Qr=this.Qr.add(r),this.Ur=this.Ur.add(r)}Wr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Gr(new $t(e,n))}zr(e,n){e.forEach(r=>this.removeReference(r,n))}jr(e){const n=new te(new We([])),r=new $t(n,e),s=new $t(n,e+1),i=[];return this.Ur.forEachInRange([r,s],o=>{this.Gr(o),i.push(o.key)}),i}Jr(){this.Qr.forEach(e=>this.Gr(e))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const n=new te(new We([])),r=new $t(n,e),s=new $t(n,e+1);let i=Ne();return this.Ur.forEachInRange([r,s],o=>{i=i.add(o.key)}),i}containsKey(e){const n=new $t(e,0),r=this.Qr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class $t{constructor(e,n){this.key=e,this.Yr=n}static $r(e,n){return te.comparator(e.key,n.key)||Te(e.Yr,n.Yr)}static Kr(e,n){return Te(e.Yr,n.Yr)||te.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nL{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.tr=1,this.Zr=new tt($t.$r)}checkEmpty(e){return O.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,s){const i=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new My(i,n,r,s);this.mutationQueue.push(o);for(const a of s)this.Zr=this.Zr.add(new $t(a.key,i)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return O.resolve(o)}lookupMutationBatch(e,n){return O.resolve(this.Xr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,s=this.ei(r),i=s<0?0:s;return O.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return O.resolve(this.mutationQueue.length===0?Pi:this.tr-1)}getAllMutationBatches(e){return O.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new $t(n,0),s=new $t(n,Number.POSITIVE_INFINITY),i=[];return this.Zr.forEachInRange([r,s],o=>{const a=this.Xr(o.Yr);i.push(a)}),O.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new tt(Te);return n.forEach(s=>{const i=new $t(s,0),o=new $t(s,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([i,o],a=>{r=r.add(a.Yr)})}),O.resolve(this.ti(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,s=r.length+1;let i=r;te.isDocumentKey(i)||(i=i.child(""));const o=new $t(new te(i),0);let a=new tt(Te);return this.Zr.forEachWhile(l=>{const d=l.key.path;return!!r.isPrefixOf(d)&&(d.length===s&&(a=a.add(l.Yr)),!0)},o),O.resolve(this.ti(a))}ti(e){const n=[];return e.forEach(r=>{const s=this.Xr(r);s!==null&&n.push(s)}),n}removeMutationBatch(e,n){ue(this.ni(n.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Zr;return O.forEach(n.mutations,s=>{const i=new $t(s.key,n.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.Zr=r})}ir(e){}containsKey(e,n){const r=new $t(n,0),s=this.Zr.firstAfterOrEqual(r);return O.resolve(n.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,O.resolve()}ni(e,n){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const n=this.ei(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rL{constructor(e){this.ri=e,this.docs=function(){return new ft(te.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,s=this.docs.get(r),i=s?s.size:0,o=this.ri(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return O.resolve(r?r.document.mutableCopy():It.newInvalidDocument(n))}getEntries(e,n){let r=jn();return n.forEach(s=>{const i=this.docs.get(s);r=r.insert(s,i?i.document.mutableCopy():It.newInvalidDocument(s))}),O.resolve(r)}getDocumentsMatchingQuery(e,n,r,s){let i=jn();const o=n.path,a=new te(o.child("__id-9223372036854775808__")),l=this.docs.getIteratorFrom(a);for(;l.hasNext();){const{key:d,value:{document:h}}=l.getNext();if(!o.isPrefixOf(d.path))break;d.path.length>o.length+1||Cy(tb(h),r)<=0||(s.has(h.key)||Mc(n,h))&&(i=i.insert(h.key,h.mutableCopy()))}return O.resolve(i)}getAllFromCollectionGroup(e,n,r,s){le(9500)}ii(e,n){return O.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new sL(this)}getSize(e){return O.resolve(this.size)}}class sL extends yC{constructor(e){super(),this.Nr=e}applyChanges(e){const n=[];return this.changes.forEach((r,s)=>{s.isValidDocument()?n.push(this.Nr.addEntry(e,s)):this.Nr.removeEntry(r)}),O.waitFor(n)}getFromCache(e,n){return this.Nr.getEntry(e,n)}getAllFromCache(e,n){return this.Nr.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iL{constructor(e){this.persistence=e,this.si=new rs(n=>Wi(n),Vc),this.lastRemoteSnapshotVersion=me.min(),this.highestTargetId=0,this.oi=0,this._i=new Wy,this.targetCount=0,this.ai=Yi.ur()}forEachTarget(e,n){return this.si.forEach((r,s)=>n(s)),O.resolve()}getLastRemoteSnapshotVersion(e){return O.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return O.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),O.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.oi&&(this.oi=n),O.resolve()}Pr(e){this.si.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.ai=new Yi(n),this.highestTargetId=n),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,n){return this.Pr(n),this.targetCount+=1,O.resolve()}updateTargetData(e,n){return this.Pr(n),O.resolve()}removeTargetData(e,n){return this.si.delete(n.target),this._i.jr(n.targetId),this.targetCount-=1,O.resolve()}removeTargets(e,n,r){let s=0;const i=[];return this.si.forEach((o,a)=>{a.sequenceNumber<=n&&r.get(a.targetId)===null&&(this.si.delete(o),i.push(this.removeMatchingKeysForTargetId(e,a.targetId)),s++)}),O.waitFor(i).next(()=>s)}getTargetCount(e){return O.resolve(this.targetCount)}getTargetData(e,n){const r=this.si.get(n)||null;return O.resolve(r)}addMatchingKeys(e,n,r){return this._i.Wr(n,r),O.resolve()}removeMatchingKeys(e,n,r){this._i.zr(n,r);const s=this.persistence.referenceDelegate,i=[];return s&&n.forEach(o=>{i.push(s.markPotentiallyOrphaned(e,o))}),O.waitFor(i)}removeMatchingKeysForTargetId(e,n){return this._i.jr(n),O.resolve()}getMatchingKeysForTargetId(e,n){const r=this._i.Hr(n);return O.resolve(r)}containsKey(e,n){return O.resolve(this._i.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ky{constructor(e,n){this.ui={},this.overlays={},this.ci=new Wn(0),this.li=!1,this.li=!0,this.hi=new tL,this.referenceDelegate=e(this),this.Pi=new iL(this),this.indexManager=new zV,this.remoteDocumentCache=function(s){return new rL(s)}(r=>this.referenceDelegate.Ti(r)),this.serializer=new oC(n),this.Ii=new ZV(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new eL,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.ui[e.toKey()];return r||(r=new nL(n,this.referenceDelegate),this.ui[e.toKey()]=r),r}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,n,r){H("MemoryPersistence","Starting transaction:",e);const s=new oL(this.ci.next());return this.referenceDelegate.Ei(),r(s).next(i=>this.referenceDelegate.di(s).next(()=>i)).toPromise().then(i=>(s.raiseOnCommittedEvent(),i))}Ai(e,n){return O.or(Object.values(this.ui).map(r=>()=>r.containsKey(e,n)))}}class oL extends rb{constructor(e){super(),this.currentSequenceNumber=e}}class ef{constructor(e){this.persistence=e,this.Ri=new Wy,this.Vi=null}static mi(e){return new ef(e)}get fi(){if(this.Vi)return this.Vi;throw le(60996)}addReference(e,n,r){return this.Ri.addReference(r,n),this.fi.delete(r.toString()),O.resolve()}removeReference(e,n,r){return this.Ri.removeReference(r,n),this.fi.add(r.toString()),O.resolve()}markPotentiallyOrphaned(e,n){return this.fi.add(n.toString()),O.resolve()}removeTarget(e,n){this.Ri.jr(n.targetId).forEach(s=>this.fi.add(s.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(s=>{s.forEach(i=>this.fi.add(i.toString()))}).next(()=>r.removeTargetData(e,n))}Ei(){this.Vi=new Set}di(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return O.forEach(this.fi,r=>{const s=te.fromPath(r);return this.gi(e,s).next(i=>{i||n.removeEntry(s,me.min())})}).next(()=>(this.Vi=null,n.apply(e)))}updateLimboDocument(e,n){return this.gi(e,n).next(r=>{r?this.fi.delete(n.toString()):this.fi.add(n.toString())})}Ti(e){return 0}gi(e,n){return O.or([()=>O.resolve(this.Ri.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Ai(e,n)])}}class rh{constructor(e,n){this.persistence=e,this.pi=new rs(r=>un(r.path),(r,s)=>r.isEqual(s)),this.garbageCollector=gC(this,n)}static mi(e,n){return new rh(e,n)}Ei(){}di(e){return O.resolve()}forEachTarget(e,n){return this.persistence.getTargetCache().forEachTarget(e,n)}gr(e){const n=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next(r=>n.next(s=>r+s))}wr(e){let n=0;return this.pr(e,r=>{n++}).next(()=>n)}pr(e,n){return O.forEach(this.pi,(r,s)=>this.br(e,r,s).next(i=>i?O.resolve():n(s)))}removeTargets(e,n,r){return this.persistence.getTargetCache().removeTargets(e,n,r)}removeOrphanedDocuments(e,n){let r=0;const s=this.persistence.getRemoteDocumentCache(),i=s.newChangeBuffer();return s.ii(e,o=>this.br(e,o,n).next(a=>{a||(r++,i.removeEntry(o,me.min()))})).next(()=>i.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,n){return this.pi.set(n,e.currentSequenceNumber),O.resolve()}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,n,r){return this.pi.set(r,e.currentSequenceNumber),O.resolve()}removeReference(e,n,r){return this.pi.set(r,e.currentSequenceNumber),O.resolve()}updateLimboDocument(e,n){return this.pi.set(n,e.currentSequenceNumber),O.resolve()}Ti(e){let n=e.key.toString().length;return e.isFoundDocument()&&(n+=rd(e.data.value)),n}br(e,n,r){return O.or([()=>this.persistence.Ai(e,n),()=>this.persistence.getTargetCache().containsKey(e,n),()=>{const s=this.pi.get(n);return O.resolve(s!==void 0&&s>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aL{constructor(e){this.serializer=e}k(e,n,r,s){const i=new Mh("createOrUpgrade",n);r<1&&s>=1&&(function(l){l.createObjectStore(Oc)}(e),function(l){l.createObjectStore(pc,{keyPath:gO}),l.createObjectStore(rr,{keyPath:SE,autoIncrement:!0}).createIndex(bi,bE,{unique:!0}),l.createObjectStore(da)}(e),mI(e),function(l){l.createObjectStore(yi)}(e));let o=O.resolve();return r<3&&s>=3&&(r!==0&&(function(l){l.deleteObjectStore(fa),l.deleteObjectStore(ha),l.deleteObjectStore(Ni)}(e),mI(e)),o=o.next(()=>function(l){const d=l.store(Ni),h={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:me.min().toTimestamp(),targetCount:0};return d.put(Kd,h)}(i))),r<4&&s>=4&&(r!==0&&(o=o.next(()=>function(l,d){return d.store(rr).J().next(f=>{l.deleteObjectStore(rr),l.createObjectStore(rr,{keyPath:SE,autoIncrement:!0}).createIndex(bi,bE,{unique:!0});const m=d.store(rr),v=f.map(R=>m.put(R));return O.waitFor(v)})}(e,i))),o=o.next(()=>{(function(l){l.createObjectStore(pa,{keyPath:SO})})(e)})),r<5&&s>=5&&(o=o.next(()=>this.yi(i))),r<6&&s>=6&&(o=o.next(()=>(function(l){l.createObjectStore(mc)}(e),this.wi(i)))),r<7&&s>=7&&(o=o.next(()=>this.Si(i))),r<8&&s>=8&&(o=o.next(()=>this.bi(e,i))),r<9&&s>=9&&(o=o.next(()=>{(function(l){l.objectStoreNames.contains("remoteDocumentChanges")&&l.deleteObjectStore("remoteDocumentChanges")})(e)})),r<10&&s>=10&&(o=o.next(()=>this.Di(i))),r<11&&s>=11&&(o=o.next(()=>{(function(l){l.createObjectStore(Uh,{keyPath:bO})})(e),function(l){l.createObjectStore($h,{keyPath:CO})}(e)})),r<12&&s>=12&&(o=o.next(()=>{(function(l){const d=l.createObjectStore(Bh,{keyPath:jO});d.createIndex($m,OO,{unique:!1}),d.createIndex(ub,VO,{unique:!1})})(e)})),r<13&&s>=13&&(o=o.next(()=>function(l){const d=l.createObjectStore(Wd,{keyPath:_O});d.createIndex(td,vO),d.createIndex(ob,wO)}(e)).next(()=>this.Ci(e,i)).next(()=>e.deleteObjectStore(yi))),r<14&&s>=14&&(o=o.next(()=>this.Fi(e,i))),r<15&&s>=15&&(o=o.next(()=>function(l){l.createObjectStore(Py,{keyPath:AO,autoIncrement:!0}).createIndex(Um,RO,{unique:!1}),l.createObjectStore(Ll,{keyPath:PO}).createIndex(lb,NO,{unique:!1}),l.createObjectStore(Ml,{keyPath:kO}).createIndex(cb,DO,{unique:!1})}(e))),r<16&&s>=16&&(o=o.next(()=>{n.objectStore(Ll).clear()}).next(()=>{n.objectStore(Ml).clear()})),r<17&&s>=17&&(o=o.next(()=>{(function(l){l.createObjectStore(Ny,{keyPath:LO})})(e)})),r<18&&s>=18&&nS()&&(o=o.next(()=>{n.objectStore(Ll).clear()}).next(()=>{n.objectStore(Ml).clear()})),o}wi(e){let n=0;return e.store(yi).ee((r,s)=>{n+=nh(s)}).next(()=>{const r={byteSize:n};return e.store(mc).put(Fm,r)})}yi(e){const n=e.store(pc),r=e.store(rr);return n.J().next(s=>O.forEach(s,i=>{const o=IDBKeyRange.bound([i.userId,Pi],[i.userId,i.lastAcknowledgedBatchId]);return r.J(bi,o).next(a=>O.forEach(a,l=>{ue(l.userId===i.userId,18650,"Cannot process batch from unexpected user",{batchId:l.batchId});const d=vi(this.serializer,l);return hC(e,i.userId,d).next(()=>{})}))}))}Si(e){const n=e.store(fa),r=e.store(yi);return e.store(Ni).get(Kd).next(s=>{const i=[];return r.ee((o,a)=>{const l=new We(o),d=function(f){return[0,un(f)]}(l);i.push(n.get(d).next(h=>h?O.resolve():(f=>n.put({targetId:0,path:un(f),sequenceNumber:s.highestListenSequenceNumber}))(l)))}).next(()=>O.waitFor(i))})}bi(e,n){e.createObjectStore(gc,{keyPath:xO});const r=n.store(gc),s=new Hy,i=o=>{if(s.add(o)){const a=o.lastSegment(),l=o.popLast();return r.put({collectionId:a,parent:un(l)})}};return n.store(yi).ee({X:!0},(o,a)=>{const l=new We(o);return i(l.popLast())}).next(()=>n.store(da).ee({X:!0},([o,a,l],d)=>{const h=Sr(a);return i(h.popLast())}))}Di(e){const n=e.store(ha);return n.ee((r,s)=>{const i=wl(s),o=aC(this.serializer,i);return n.put(o)})}Ci(e,n){const r=n.store(yi),s=[];return r.ee((i,o)=>{const a=n.store(Wd),l=function(f){return f.document?new te(We.fromString(f.document.name).popFirst(5)):f.noDocument?te.fromSegments(f.noDocument.path):f.unknownDocument?te.fromSegments(f.unknownDocument.path):le(36783)}(o).path.toArray(),d={prefixPath:l.slice(0,l.length-2),collectionGroup:l[l.length-2],documentId:l[l.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};s.push(a.put(d))}).next(()=>O.waitFor(s))}Fi(e,n){const r=n.store(rr),s=_C(this.serializer),i=new Ky(ef.mi,this.serializer.yt);return r.J().next(o=>{const a=new Map;return o.forEach(l=>{let d=a.get(l.userId)??Ne();vi(this.serializer,l).keys().forEach(h=>d=d.add(h)),a.set(l.userId,d)}),O.forEach(a,(l,d)=>{const h=new Gt(d),f=Jh.wt(this.serializer,h),m=i.getIndexManager(h),v=Zh.wt(h,this.serializer,m,i.referenceDelegate);return new vC(s,v,f,m).recalculateAndSaveOverlaysForDocumentKeys(new Bm(n,Wn.ce),l).next()})})}}function mI(t){t.createObjectStore(fa,{keyPath:IO}).createIndex(Ry,TO,{unique:!0}),t.createObjectStore(ha,{keyPath:"targetId"}).createIndex(ab,EO,{unique:!0}),t.createObjectStore(Ni)}const gs="IndexedDbPersistence",mp=18e5,gp=5e3,yp="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",lL="main";class Gy{constructor(e,n,r,s,i,o,a,l,d,h,f=18){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.Mi=i,this.window=o,this.document=a,this.xi=d,this.Oi=h,this.Ni=f,this.ci=null,this.li=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Bi=null,this.inForeground=!1,this.Li=null,this.ki=null,this.qi=Number.NEGATIVE_INFINITY,this.Qi=m=>Promise.resolve(),!Gy.v())throw new K($.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new QV(this,s),this.$i=n+lL,this.serializer=new oC(l),this.Ui=new zs(this.$i,this.Ni,new aL(this.serializer)),this.hi=new LV,this.Pi=new HV(this.referenceDelegate,this.serializer),this.remoteDocumentCache=_C(this.serializer),this.Ii=new VV,this.window&&this.window.localStorage?this.Ki=this.window.localStorage:(this.Ki=null,h===!1&&pn(gs,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Wi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new K($.FAILED_PRECONDITION,yp);return this.Gi(),this.zi(),this.ji(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Pi.getHighestSequenceNumber(e))}).then(e=>{this.ci=new Wn(e,this.xi)}).then(()=>{this.li=!0}).catch(e=>(this.Ui&&this.Ui.close(),Promise.reject(e)))}Ji(e){return this.Qi=async n=>{if(this.started)return e(n)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ui.$(async n=>{n.newVersion===null&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Mi.enqueueAndForget(async()=>{this.started&&await this.Wi()}))}Wi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>Cu(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.Hi(e).next(n=>{n||(this.isPrimary=!1,this.Mi.enqueueRetryable(()=>this.Qi(!1)))})}).next(()=>this.Yi(e)).next(n=>this.isPrimary&&!n?this.Zi(e).next(()=>!1):!!n&&this.Xi(e).next(()=>!0))).catch(e=>{if(si(e))return H(gs,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return H(gs,"Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.Mi.enqueueRetryable(()=>this.Qi(e)),this.isPrimary=e})}Hi(e){return ll(e).get(ho).next(n=>O.resolve(this.es(n)))}ts(e){return Cu(e).delete(this.clientId)}async ns(){if(this.isPrimary&&!this.rs(this.qi,mp)){this.qi=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",n=>{const r=Vt(n,pa);return r.J().next(s=>{const i=this.ss(s,mp),o=s.filter(a=>i.indexOf(a)===-1);return O.forEach(o,a=>r.delete(a.clientId)).next(()=>o)})}).catch(()=>[]);if(this.Ki)for(const n of e)this.Ki.removeItem(this._s(n.clientId))}}ji(){this.ki=this.Mi.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.Wi().then(()=>this.ns()).then(()=>this.ji()))}es(e){return!!e&&e.ownerId===this.clientId}Yi(e){return this.Oi?O.resolve(!0):ll(e).get(ho).next(n=>{if(n!==null&&this.rs(n.leaseTimestampMs,gp)&&!this.us(n.ownerId)){if(this.es(n)&&this.networkEnabled)return!0;if(!this.es(n)){if(!n.allowTabSynchronization)throw new K($.FAILED_PRECONDITION,yp);return!1}}return!(!this.networkEnabled||!this.inForeground)||Cu(e).J().next(r=>this.ss(r,gp).find(s=>{if(this.clientId!==s.clientId){const i=!this.networkEnabled&&s.networkEnabled,o=!this.inForeground&&s.inForeground,a=this.networkEnabled===s.networkEnabled;if(i||o&&a)return!0}return!1})===void 0)}).next(n=>(this.isPrimary!==n&&H(gs,`Client ${n?"is":"is not"} eligible for a primary lease.`),n))}async shutdown(){this.li=!1,this.cs(),this.ki&&(this.ki.cancel(),this.ki=null),this.ls(),this.hs(),await this.Ui.runTransaction("shutdown","readwrite",[Oc,pa],e=>{const n=new Bm(e,Wn.ce);return this.Zi(n).next(()=>this.ts(n))}),this.Ui.close(),this.Ps()}ss(e,n){return e.filter(r=>this.rs(r.updateTimeMs,n)&&!this.us(r.clientId))}Ts(){return this.runTransaction("getActiveClients","readonly",e=>Cu(e).J().next(n=>this.ss(n,mp).map(r=>r.clientId)))}get started(){return this.li}getGlobalsCache(){return this.hi}getMutationQueue(e,n){return Zh.wt(e,this.serializer,n,this.referenceDelegate)}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new qV(e,this.serializer.yt.databaseId)}getDocumentOverlayCache(e){return Jh.wt(this.serializer,e)}getBundleCache(){return this.Ii}runTransaction(e,n,r){H(gs,"Starting transaction:",e);const s=n==="readonly"?"readonly":"readwrite",i=function(l){return l===18?UO:l===17?pb:l===16?FO:l===15?ky:l===14?fb:l===13?hb:l===12?MO:l===11?db:void le(60245)}(this.Ni);let o;return this.Ui.runTransaction(e,s,i,a=>(o=new Bm(a,this.ci?this.ci.next():Wn.ce),n==="readwrite-primary"?this.Hi(o).next(l=>!!l||this.Yi(o)).next(l=>{if(!l)throw pn(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Mi.enqueueRetryable(()=>this.Qi(!1)),new K($.FAILED_PRECONDITION,nb);return r(o)}).next(l=>this.Xi(o).next(()=>l)):this.Is(o).next(()=>r(o)))).then(a=>(o.raiseOnCommittedEvent(),a))}Is(e){return ll(e).get(ho).next(n=>{if(n!==null&&this.rs(n.leaseTimestampMs,gp)&&!this.us(n.ownerId)&&!this.es(n)&&!(this.Oi||this.allowTabSynchronization&&n.allowTabSynchronization))throw new K($.FAILED_PRECONDITION,yp)})}Xi(e){const n={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return ll(e).put(ho,n)}static v(){return zs.v()}Zi(e){const n=ll(e);return n.get(ho).next(r=>this.es(r)?(H(gs,"Releasing primary lease."),n.delete(ho)):O.resolve())}rs(e,n){const r=Date.now();return!(e<r-n)&&(!(e>r)||(pn(`Detected an update time that is in the future: ${e} > ${r}`),!1))}Gi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Li=()=>{this.Mi.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.Wi()))},this.document.addEventListener("visibilitychange",this.Li),this.inForeground=this.document.visibilityState==="visible")}ls(){this.Li&&(this.document.removeEventListener("visibilitychange",this.Li),this.Li=null)}zi(){var e;typeof((e=this.window)==null?void 0:e.addEventListener)=="function"&&(this.Bi=()=>{this.cs();const n=/(?:Version|Mobile)\/1[456]/;tS()&&(navigator.appVersion.match(n)||navigator.userAgent.match(n))&&this.Mi.enterRestrictedMode(!0),this.Mi.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Bi))}hs(){this.Bi&&(this.window.removeEventListener("pagehide",this.Bi),this.Bi=null)}us(e){var n;try{const r=((n=this.Ki)==null?void 0:n.getItem(this._s(e)))!==null;return H(gs,`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return pn(gs,"Failed to get zombied client id.",r),!1}}cs(){if(this.Ki)try{this.Ki.setItem(this._s(this.clientId),String(Date.now()))}catch(e){pn("Failed to set zombie client id.",e)}}Ps(){if(this.Ki)try{this.Ki.removeItem(this._s(this.clientId))}catch{}}_s(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function ll(t){return Vt(t,Oc)}function Cu(t){return Vt(t,pa)}function cL(t,e){let n=t.projectId;return t.isDefaultDatabase||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qy{constructor(e,n,r,s){this.targetId=e,this.fromCache=n,this.Es=r,this.ds=s}static As(e,n){let r=Ne(),s=Ne();for(const i of n.docChanges)switch(i.type){case 0:r=r.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new Qy(e,n.fromCache,r,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uL{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wC{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=function(){return tS()?8:sb(Ot())>0?6:4}()}initialize(e,n){this.ps=e,this.indexManager=n,this.Rs=!0}getDocumentsMatchingQuery(e,n,r,s){const i={result:null};return this.ys(e,n).next(o=>{i.result=o}).next(()=>{if(!i.result)return this.ws(e,n,s,r).next(o=>{i.result=o})}).next(()=>{if(i.result)return;const o=new uL;return this.Ss(e,n,o).next(a=>{if(i.result=a,this.Vs)return this.bs(e,n,o,a.size)})}).next(()=>i.result)}bs(e,n,r,s){return r.documentReadCount<this.fs?(So()<=Le.DEBUG&&H("QueryEngine","SDK will not create cache indexes for query:",bo(n),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),O.resolve()):(So()<=Le.DEBUG&&H("QueryEngine","Query:",bo(n),"scans",r.documentReadCount,"local documents and returns",s,"documents as results."),r.documentReadCount>this.gs*s?(So()<=Le.DEBUG&&H("QueryEngine","The SDK decides to create cache indexes for query:",bo(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Gn(n))):O.resolve())}ys(e,n){if(FE(n))return O.resolve(null);let r=Gn(n);return this.indexManager.getIndexType(e,r).next(s=>s===0?null:(n.limit!==null&&s===1&&(n=Xd(n,null,"F"),r=Gn(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(i=>{const o=Ne(...i);return this.ps.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,r).next(l=>{const d=this.Ds(n,a);return this.Cs(n,d,o,l.readTime)?this.ys(e,Xd(n,null,"F")):this.vs(e,d,n,l)}))})))}ws(e,n,r,s){return FE(n)||s.isEqual(me.min())?O.resolve(null):this.ps.getDocuments(e,r).next(i=>{const o=this.Ds(n,i);return this.Cs(n,o,r,s)?O.resolve(null):(So()<=Le.DEBUG&&H("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),bo(n)),this.vs(e,o,n,cO(s,dc)).next(a=>a))})}Ds(e,n){let r=new tt(jb(e));return n.forEach((s,i)=>{Mc(e,i)&&(r=r.add(i))}),r}Cs(e,n,r,s){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const i=e.limitType==="F"?n.last():n.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}Ss(e,n,r){return So()<=Le.DEBUG&&H("QueryEngine","Using full collection scan to execute query:",bo(n)),this.ps.getDocumentsMatchingQuery(e,n,Mn.min(),r)}vs(e,n,r,s){return this.ps.getDocumentsMatchingQuery(e,r,s).next(i=>(n.forEach(o=>{i=i.insert(o.key,o)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yy="LocalStore",dL=3e8;class hL{constructor(e,n,r,s){this.persistence=e,this.Fs=n,this.serializer=s,this.Ms=new ft(Te),this.xs=new rs(i=>Wi(i),Vc),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(r)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new vC(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.Ms))}}function EC(t,e,n,r){return new hL(t,e,n,r)}async function IC(t,e){const n=Ee(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let s;return n.mutationQueue.getAllMutationBatches(r).next(i=>(s=i,n.Bs(e),n.mutationQueue.getAllMutationBatches(r))).next(i=>{const o=[],a=[];let l=Ne();for(const d of s){o.push(d.batchId);for(const h of d.mutations)l=l.add(h.key)}for(const d of i){a.push(d.batchId);for(const h of d.mutations)l=l.add(h.key)}return n.localDocuments.getDocuments(r,l).next(d=>({Ls:d,removedBatchIds:o,addedBatchIds:a}))})})}function fL(t,e){const n=Ee(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const s=e.batch.keys(),i=n.Ns.newChangeBuffer({trackRemovals:!0});return function(a,l,d,h){const f=d.batch,m=f.keys();let v=O.resolve();return m.forEach(R=>{v=v.next(()=>h.getEntry(l,R)).next(b=>{const A=d.docVersions.get(R);ue(A!==null,48541),b.version.compareTo(A)<0&&(f.applyToRemoteDocument(b,d),b.isValidDocument()&&(b.setReadTime(d.commitVersion),h.addEntry(b)))})}),v.next(()=>a.mutationQueue.removeMutationBatch(l,f))}(n,r,e,i).next(()=>i.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,s,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let l=Ne();for(let d=0;d<a.mutationResults.length;++d)a.mutationResults[d].transformResults.length>0&&(l=l.add(a.batch.mutations[d].key));return l}(e))).next(()=>n.localDocuments.getDocuments(r,s))})}function TC(t){const e=Ee(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Pi.getLastRemoteSnapshotVersion(n))}function pL(t,e){const n=Ee(t),r=e.snapshotVersion;let s=n.Ms;return n.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const o=n.Ns.newChangeBuffer({trackRemovals:!0});s=n.Ms;const a=[];e.targetChanges.forEach((h,f)=>{const m=s.get(f);if(!m)return;a.push(n.Pi.removeMatchingKeys(i,h.removedDocuments,f).next(()=>n.Pi.addMatchingKeys(i,h.addedDocuments,f)));let v=m.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(f)!==null?v=v.withResumeToken(Pt.EMPTY_BYTE_STRING,me.min()).withLastLimboFreeSnapshotVersion(me.min()):h.resumeToken.approximateByteSize()>0&&(v=v.withResumeToken(h.resumeToken,r)),s=s.insert(f,v),function(b,A,I){return b.resumeToken.approximateByteSize()===0||A.snapshotVersion.toMicroseconds()-b.snapshotVersion.toMicroseconds()>=dL?!0:I.addedDocuments.size+I.modifiedDocuments.size+I.removedDocuments.size>0}(m,v,h)&&a.push(n.Pi.updateTargetData(i,v))});let l=jn(),d=Ne();if(e.documentUpdates.forEach(h=>{e.resolvedLimboDocuments.has(h)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(i,h))}),a.push(mL(i,o,e.documentUpdates).next(h=>{l=h.ks,d=h.qs})),!r.isEqual(me.min())){const h=n.Pi.getLastRemoteSnapshotVersion(i).next(f=>n.Pi.setTargetsMetadata(i,i.currentSequenceNumber,r));a.push(h)}return O.waitFor(a).next(()=>o.apply(i)).next(()=>n.localDocuments.getLocalViewOfDocuments(i,l,d)).next(()=>l)}).then(i=>(n.Ms=s,i))}function mL(t,e,n){let r=Ne(),s=Ne();return n.forEach(i=>r=r.add(i)),e.getEntries(t,r).next(i=>{let o=jn();return n.forEach((a,l)=>{const d=i.get(a);l.isFoundDocument()!==d.isFoundDocument()&&(s=s.add(a)),l.isNoDocument()&&l.version.isEqual(me.min())?(e.removeEntry(a,l.readTime),o=o.insert(a,l)):!d.isValidDocument()||l.version.compareTo(d.version)>0||l.version.compareTo(d.version)===0&&d.hasPendingWrites?(e.addEntry(l),o=o.insert(a,l)):H(Yy,"Ignoring outdated watch update for ",a,". Current version:",d.version," Watch version:",l.version)}),{ks:o,qs:s}})}function gL(t,e){const n=Ee(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=Pi),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function yL(t,e){const n=Ee(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let s;return n.Pi.getTargetData(r,e).next(i=>i?(s=i,O.resolve(s)):n.Pi.allocateTargetId(r).next(o=>(s=new zr(e,o,"TargetPurposeListen",r.currentSequenceNumber),n.Pi.addTargetData(r,s).next(()=>s))))}).then(r=>{const s=n.Ms.get(r.targetId);return(s===null||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(n.Ms=n.Ms.insert(r.targetId,r),n.xs.set(e,r.targetId)),r})}async function ng(t,e,n){const r=Ee(t),s=r.Ms.get(e),i=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",i,o=>r.persistence.referenceDelegate.removeTarget(o,s))}catch(o){if(!si(o))throw o;H(Yy,`Failed to update sequence numbers for target ${e}: ${o}`)}r.Ms=r.Ms.remove(e),r.xs.delete(s.target)}function gI(t,e,n){const r=Ee(t);let s=me.min(),i=Ne();return r.persistence.runTransaction("Execute query","readwrite",o=>function(l,d,h){const f=Ee(l),m=f.xs.get(h);return m!==void 0?O.resolve(f.Ms.get(m)):f.Pi.getTargetData(d,h)}(r,o,Gn(e)).next(a=>{if(a)return s=a.lastLimboFreeSnapshotVersion,r.Pi.getMatchingKeysForTargetId(o,a.targetId).next(l=>{i=l})}).next(()=>r.Fs.getDocumentsMatchingQuery(o,e,n?s:me.min(),n?i:Ne())).next(a=>(_L(r,nV(e),a),{documents:a,Qs:i})))}function _L(t,e,n){let r=t.Os.get(e)||me.min();n.forEach((s,i)=>{i.readTime.compareTo(r)>0&&(r=i.readTime)}),t.Os.set(e,r)}class yI{constructor(){this.activeTargetIds=lV()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class xC{constructor(){this.Mo=new yI,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,n,r){this.xo[e]=n}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new yI,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vL{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _I="ConnectivityMonitor";class vI{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){H(_I,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){H(_I,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Au=null;function rg(){return Au===null?Au=function(){return 268435456+Math.round(2147483648*Math.random())}():Au++,"0x"+Au.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _p="RestConnection",wL={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class EL{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const n=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Uo=n+"://"+e.host,this.Ko=`projects/${r}/databases/${s}`,this.Wo=this.databaseId.database===Gd?`project_id=${r}`:`project_id=${r}&database_id=${s}`}Go(e,n,r,s,i){const o=rg(),a=this.zo(e,n.toUriEncodedString());H(_p,`Sending RPC '${e}' ${o}:`,a,r);const l={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(l,s,i);const{host:d}=new URL(a),h=ti(d);return this.Jo(e,a,l,r,h).then(f=>(H(_p,`Received RPC '${e}' ${o}: `,f),f),f=>{throw zi(_p,`RPC '${e}' ${o} failed with error: `,f,"url: ",a,"request:",r),f})}Ho(e,n,r,s,i,o){return this.Go(e,n,r,s,i)}jo(e,n,r){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Na}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((s,i)=>e[i]=s),r&&r.headers.forEach((s,i)=>e[i]=s)}zo(e,n){const r=wL[e];return`${this.Uo}/v1/${n}:${r}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IL{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rn="WebChannelConnection";class TL extends EL{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,n,r,s,i){const o=rg();return new Promise((a,l)=>{const d=new HS;d.setWithCredentials(!0),d.listenOnce(WS.COMPLETE,()=>{try{switch(d.getLastErrorCode()){case Ju.NO_ERROR:const f=d.getResponseJson();H(rn,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(f)),a(f);break;case Ju.TIMEOUT:H(rn,`RPC '${e}' ${o} timed out`),l(new K($.DEADLINE_EXCEEDED,"Request time out"));break;case Ju.HTTP_ERROR:const m=d.getStatus();if(H(rn,`RPC '${e}' ${o} failed with status:`,m,"response text:",d.getResponseText()),m>0){let v=d.getResponseJson();Array.isArray(v)&&(v=v[0]);const R=v==null?void 0:v.error;if(R&&R.status&&R.message){const b=function(I){const w=I.toLowerCase().replace(/_/g,"-");return Object.values($).indexOf(w)>=0?w:$.UNKNOWN}(R.status);l(new K(b,R.message))}else l(new K($.UNKNOWN,"Server responded with status "+d.getStatus()))}else l(new K($.UNAVAILABLE,"Connection failed."));break;default:le(9055,{l_:e,streamId:o,h_:d.getLastErrorCode(),P_:d.getLastError()})}}finally{H(rn,`RPC '${e}' ${o} completed.`)}});const h=JSON.stringify(s);H(rn,`RPC '${e}' ${o} sending request:`,s),d.send(n,"POST",h,r,15)})}T_(e,n,r){const s=rg(),i=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=QS(),a=GS(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},d=this.longPollingOptions.timeoutSeconds;d!==void 0&&(l.longPollingTimeout=Math.round(1e3*d)),this.useFetchStreams&&(l.useFetchStreams=!0),this.jo(l.initMessageHeaders,n,r),l.encodeInitMessageHeaders=!0;const h=i.join("");H(rn,`Creating RPC '${e}' stream ${s}: ${h}`,l);const f=o.createWebChannel(h,l);this.I_(f);let m=!1,v=!1;const R=new IL({Yo:A=>{v?H(rn,`Not sending because RPC '${e}' stream ${s} is closed:`,A):(m||(H(rn,`Opening RPC '${e}' stream ${s} transport.`),f.open(),m=!0),H(rn,`RPC '${e}' stream ${s} sending:`,A),f.send(A))},Zo:()=>f.close()}),b=(A,I,w)=>{A.listen(I,y=>{try{w(y)}catch(j){setTimeout(()=>{throw j},0)}})};return b(f,yl.EventType.OPEN,()=>{v||(H(rn,`RPC '${e}' stream ${s} transport opened.`),R.o_())}),b(f,yl.EventType.CLOSE,()=>{v||(v=!0,H(rn,`RPC '${e}' stream ${s} transport closed`),R.a_(),this.E_(f))}),b(f,yl.EventType.ERROR,A=>{v||(v=!0,zi(rn,`RPC '${e}' stream ${s} transport errored. Name:`,A.name,"Message:",A.message),R.a_(new K($.UNAVAILABLE,"The operation could not be completed")))}),b(f,yl.EventType.MESSAGE,A=>{var I;if(!v){const w=A.data[0];ue(!!w,16349);const y=w,j=(y==null?void 0:y.error)||((I=y[0])==null?void 0:I.error);if(j){H(rn,`RPC '${e}' stream ${s} received error:`,j);const V=j.status;let M=function(S){const C=Ct[S];if(C!==void 0)return Kb(C)}(V),T=j.message;M===void 0&&(M=$.INTERNAL,T="Unknown error status: "+V+" with message "+j.message),v=!0,R.a_(new K(M,T)),f.close()}else H(rn,`RPC '${e}' stream ${s} received:`,w),R.u_(w)}}),b(a,KS.STAT_EVENT,A=>{A.stat===Vm.PROXY?H(rn,`RPC '${e}' stream ${s} detected buffering proxy`):A.stat===Vm.NOPROXY&&H(rn,`RPC '${e}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{R.__()},0),R}terminate(){this.c_.forEach(e=>e.close()),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter(n=>n===e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xL(){return typeof window<"u"?window:null}function ld(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tf(t){return new xV(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SC{constructor(e,n,r=1e3,s=1.5,i=6e4){this.Mi=e,this.timerId=n,this.d_=r,this.A_=s,this.R_=i,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const n=Math.floor(this.V_+this.y_()),r=Math.max(0,Date.now()-this.f_),s=Math.max(0,n-r);s>0&&H("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.V_} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,s,()=>(this.f_=Date.now(),e())),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wI="PersistentStream";class bC{constructor(e,n,r,s,i,o,a,l){this.Mi=e,this.S_=r,this.b_=s,this.connection=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=l,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new SC(e,n)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,()=>this.k_()))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,n){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():n&&n.code===$.RESOURCE_EXHAUSTED?(pn(n.toString()),pn("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):n&&n.code===$.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(n)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),n=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,s])=>{this.D_===n&&this.G_(r,s)},r=>{e(()=>{const s=new K($.UNKNOWN,"Fetching auth token failed: "+r.message);return this.z_(s)})})}G_(e,n){const r=this.W_(this.D_);this.stream=this.j_(e,n),this.stream.Xo(()=>{r(()=>this.listener.Xo())}),this.stream.t_(()=>{r(()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.t_()))}),this.stream.r_(s=>{r(()=>this.z_(s))}),this.stream.onMessage(s=>{r(()=>++this.F_==1?this.J_(s):this.onNext(s))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return H(wI,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return n=>{this.Mi.enqueueAndForget(()=>this.D_===e?n():(H(wI,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class SL extends bC{constructor(e,n,r,s,i,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,s,o),this.serializer=i}j_(e,n){return this.connection.T_("Listen",e,n)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const n=CV(this.serializer,e),r=function(i){if(!("targetChange"in i))return me.min();const o=i.targetChange;return o.targetIds&&o.targetIds.length?me.min():o.readTime?yn(o.readTime):me.min()}(e);return this.listener.H_(n,r)}Y_(e){const n={};n.database=Xm(this.serializer),n.addTarget=function(i,o){let a;const l=o.target;if(a=Qd(l)?{documents:tC(i,l)}:{query:zy(i,l).ft},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=Yb(i,o.resumeToken);const d=Qm(i,o.expectedCount);d!==null&&(a.expectedCount=d)}else if(o.snapshotVersion.compareTo(me.min())>0){a.readTime=Ea(i,o.snapshotVersion.toTimestamp());const d=Qm(i,o.expectedCount);d!==null&&(a.expectedCount=d)}return a}(this.serializer,e);const r=PV(this.serializer,e);r&&(n.labels=r),this.q_(n)}Z_(e){const n={};n.database=Xm(this.serializer),n.removeTarget=e,this.q_(n)}}class bL extends bC{constructor(e,n,r,s,i,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,s,o),this.serializer=i}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,n){return this.connection.T_("Write",e,n)}J_(e){return ue(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,ue(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){ue(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const n=AV(e.writeResults,e.commitTime),r=yn(e.commitTime);return this.listener.na(r,n)}ra(){const e={};e.database=Xm(this.serializer),this.q_(e)}ea(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>Zd(this.serializer,r))};this.q_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CL{}class AL extends CL{constructor(e,n,r,s){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=s,this.ia=!1}sa(){if(this.ia)throw new K($.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,n,r,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.connection.Go(e,Ym(n,r),s,i,o)).catch(i=>{throw i.name==="FirebaseError"?(i.code===$.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new K($.UNKNOWN,i.toString())})}Ho(e,n,r,s,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.Ho(e,Ym(n,r),s,o,a,i)).catch(o=>{throw o.name==="FirebaseError"?(o.code===$.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new K($.UNKNOWN,o.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}class RL{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(pn(n),this.aa=!1):H("OnlineStateTracker",n)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xi="RemoteStore";class PL{constructor(e,n,r,s,i){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=i,this.Aa.Oo(o=>{r.enqueueAndForget(async()=>{ao(this)&&(H(Xi,"Restarting streams for network reachability change."),await async function(l){const d=Ee(l);d.Ea.add(4),await Uc(d),d.Ra.set("Unknown"),d.Ea.delete(4),await nf(d)}(this))})}),this.Ra=new RL(r,s)}}async function nf(t){if(ao(t))for(const e of t.da)await e(!0)}async function Uc(t){for(const e of t.da)await e(!1)}function CC(t,e){const n=Ee(t);n.Ia.has(e.targetId)||(n.Ia.set(e.targetId,e),e_(n)?Zy(n):Da(n).O_()&&Jy(n,e))}function Xy(t,e){const n=Ee(t),r=Da(n);n.Ia.delete(e),r.O_()&&AC(n,e),n.Ia.size===0&&(r.O_()?r.L_():ao(n)&&n.Ra.set("Unknown"))}function Jy(t,e){if(t.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(me.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}Da(t).Y_(e)}function AC(t,e){t.Va.Ue(e),Da(t).Z_(e)}function Zy(t){t.Va=new wV({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),At:e=>t.Ia.get(e)||null,ht:()=>t.datastore.serializer.databaseId}),Da(t).start(),t.Ra.ua()}function e_(t){return ao(t)&&!Da(t).x_()&&t.Ia.size>0}function ao(t){return Ee(t).Ea.size===0}function RC(t){t.Va=void 0}async function NL(t){t.Ra.set("Online")}async function kL(t){t.Ia.forEach((e,n)=>{Jy(t,e)})}async function DL(t,e){RC(t),e_(t)?(t.Ra.ha(e),Zy(t)):t.Ra.set("Unknown")}async function jL(t,e,n){if(t.Ra.set("Online"),e instanceof Qb&&e.state===2&&e.cause)try{await async function(s,i){const o=i.cause;for(const a of i.targetIds)s.Ia.has(a)&&(await s.remoteSyncer.rejectListen(a,o),s.Ia.delete(a),s.Va.removeTarget(a))}(t,e)}catch(r){H(Xi,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await sh(t,r)}else if(e instanceof od?t.Va.Ze(e):e instanceof Gb?t.Va.st(e):t.Va.tt(e),!n.isEqual(me.min()))try{const r=await TC(t.localStore);n.compareTo(r)>=0&&await function(i,o){const a=i.Va.Tt(o);return a.targetChanges.forEach((l,d)=>{if(l.resumeToken.approximateByteSize()>0){const h=i.Ia.get(d);h&&i.Ia.set(d,h.withResumeToken(l.resumeToken,o))}}),a.targetMismatches.forEach((l,d)=>{const h=i.Ia.get(l);if(!h)return;i.Ia.set(l,h.withResumeToken(Pt.EMPTY_BYTE_STRING,h.snapshotVersion)),AC(i,l);const f=new zr(h.target,l,d,h.sequenceNumber);Jy(i,f)}),i.remoteSyncer.applyRemoteEvent(a)}(t,n)}catch(r){H(Xi,"Failed to raise snapshot:",r),await sh(t,r)}}async function sh(t,e,n){if(!si(e))throw e;t.Ea.add(1),await Uc(t),t.Ra.set("Offline"),n||(n=()=>TC(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{H(Xi,"Retrying IndexedDB access"),await n(),t.Ea.delete(1),await nf(t)})}function PC(t,e){return e().catch(n=>sh(t,n,e))}async function $c(t){const e=Ee(t),n=Ys(e);let r=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:Pi;for(;OL(e);)try{const s=await gL(e.localStore,r);if(s===null){e.Ta.length===0&&n.L_();break}r=s.batchId,VL(e,s)}catch(s){await sh(e,s)}NC(e)&&kC(e)}function OL(t){return ao(t)&&t.Ta.length<10}function VL(t,e){t.Ta.push(e);const n=Ys(t);n.O_()&&n.X_&&n.ea(e.mutations)}function NC(t){return ao(t)&&!Ys(t).x_()&&t.Ta.length>0}function kC(t){Ys(t).start()}async function LL(t){Ys(t).ra()}async function ML(t){const e=Ys(t);for(const n of t.Ta)e.ea(n.mutations)}async function FL(t,e,n){const r=t.Ta.shift(),s=Fy.from(r,e,n);await PC(t,()=>t.remoteSyncer.applySuccessfulWrite(s)),await $c(t)}async function UL(t,e){e&&Ys(t).X_&&await async function(r,s){if(function(o){return yV(o)&&o!==$.ABORTED}(s.code)){const i=r.Ta.shift();Ys(r).B_(),await PC(r,()=>r.remoteSyncer.rejectFailedWrite(i.batchId,s)),await $c(r)}}(t,e),NC(t)&&kC(t)}async function EI(t,e){const n=Ee(t);n.asyncQueue.verifyOperationInProgress(),H(Xi,"RemoteStore received new credentials");const r=ao(n);n.Ea.add(3),await Uc(n),r&&n.Ra.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.Ea.delete(3),await nf(n)}async function $L(t,e){const n=Ee(t);e?(n.Ea.delete(2),await nf(n)):e||(n.Ea.add(2),await Uc(n),n.Ra.set("Unknown"))}function Da(t){return t.ma||(t.ma=function(n,r,s){const i=Ee(n);return i.sa(),new SL(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Xo:NL.bind(null,t),t_:kL.bind(null,t),r_:DL.bind(null,t),H_:jL.bind(null,t)}),t.da.push(async e=>{e?(t.ma.B_(),e_(t)?Zy(t):t.Ra.set("Unknown")):(await t.ma.stop(),RC(t))})),t.ma}function Ys(t){return t.fa||(t.fa=function(n,r,s){const i=Ee(n);return i.sa(),new bL(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Xo:()=>Promise.resolve(),t_:LL.bind(null,t),r_:UL.bind(null,t),ta:ML.bind(null,t),na:FL.bind(null,t)}),t.da.push(async e=>{e?(t.fa.B_(),await $c(t)):(await t.fa.stop(),t.Ta.length>0&&(H(Xi,`Stopping write stream with ${t.Ta.length} pending writes`),t.Ta=[]))})),t.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class t_{constructor(e,n,r,s,i){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=s,this.removalCallback=i,this.deferred=new cr,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,s,i){const o=Date.now()+r,a=new t_(e,n,o,s,i);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new K($.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function n_(t,e){if(pn("AsyncQueue",`${e}: ${t}`),si(t))return new K($.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jo{static emptySet(e){return new Jo(e.comparator)}constructor(e){this.comparator=e?(n,r)=>e(n,r)||te.comparator(n.key,r.key):(n,r)=>te.comparator(n.key,r.key),this.keyedMap=_l(),this.sortedSet=new ft(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof Jo)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new Jo;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class II{constructor(){this.ga=new ft(te.comparator)}track(e){const n=e.doc.key,r=this.ga.get(n);r?e.type!==0&&r.type===3?this.ga=this.ga.insert(n,e):e.type===3&&r.type!==1?this.ga=this.ga.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.ga=this.ga.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.ga=this.ga.remove(n):e.type===1&&r.type===2?this.ga=this.ga.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):le(63341,{Rt:e,pa:r}):this.ga=this.ga.insert(n,e)}ya(){const e=[];return this.ga.inorderTraversal((n,r)=>{e.push(r)}),e}}class Ia{constructor(e,n,r,s,i,o,a,l,d){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=l,this.hasCachedResults=d}static fromInitialDocuments(e,n,r,s,i){const o=[];return n.forEach(a=>{o.push({type:0,doc:a})}),new Ia(e,n,Jo.emptySet(n),o,r,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Wh(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let s=0;s<n.length;s++)if(n[s].type!==r[s].type||!n[s].doc.isEqual(r[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BL{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some(e=>e.Da())}}class zL{constructor(){this.queries=TI(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(n,r){const s=Ee(n),i=s.queries;s.queries=TI(),i.forEach((o,a)=>{for(const l of a.Sa)l.onError(r)})})(this,new K($.ABORTED,"Firestore shutting down"))}}function TI(){return new rs(t=>Db(t),Wh)}async function r_(t,e){const n=Ee(t);let r=3;const s=e.query;let i=n.queries.get(s);i?!i.ba()&&e.Da()&&(r=2):(i=new BL,r=e.Da()?0:1);try{switch(r){case 0:i.wa=await n.onListen(s,!0);break;case 1:i.wa=await n.onListen(s,!1);break;case 2:await n.onFirstRemoteStoreListen(s)}}catch(o){const a=n_(o,`Initialization of query '${bo(e.query)}' failed`);return void e.onError(a)}n.queries.set(s,i),i.Sa.push(e),e.va(n.onlineState),i.wa&&e.Fa(i.wa)&&i_(n)}async function s_(t,e){const n=Ee(t),r=e.query;let s=3;const i=n.queries.get(r);if(i){const o=i.Sa.indexOf(e);o>=0&&(i.Sa.splice(o,1),i.Sa.length===0?s=e.Da()?0:1:!i.ba()&&e.Da()&&(s=2))}switch(s){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function qL(t,e){const n=Ee(t);let r=!1;for(const s of e){const i=s.query,o=n.queries.get(i);if(o){for(const a of o.Sa)a.Fa(s)&&(r=!0);o.wa=s}}r&&i_(n)}function HL(t,e,n){const r=Ee(t),s=r.queries.get(e);if(s)for(const i of s.Sa)i.onError(n);r.queries.delete(e)}function i_(t){t.Ca.forEach(e=>{e.next()})}var sg,xI;(xI=sg||(sg={})).Ma="default",xI.Cache="cache";class o_{constructor(e,n,r){this.query=e,this.xa=n,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=r||{}}Fa(e){if(!this.options.includeMetadataChanges){const r=[];for(const s of e.docChanges)s.type!==3&&r.push(s);e=new Ia(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),n=!0):this.La(e,this.onlineState)&&(this.ka(e),n=!0),this.Na=e,n}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let n=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),n=!0),n}La(e,n){if(!e.fromCache||!this.Da())return!0;const r=n!=="Offline";return(!this.options.qa||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const n=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}ka(e){e=Ia.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==sg.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DC{constructor(e){this.key=e}}class jC{constructor(e){this.key=e}}class WL{constructor(e,n){this.query=e,this.Ya=n,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=Ne(),this.mutatedKeys=Ne(),this.eu=jb(e),this.tu=new Jo(this.eu)}get nu(){return this.Ya}ru(e,n){const r=n?n.iu:new II,s=n?n.tu:this.tu;let i=n?n.mutatedKeys:this.mutatedKeys,o=s,a=!1;const l=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,d=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((h,f)=>{const m=s.get(h),v=Mc(this.query,f)?f:null,R=!!m&&this.mutatedKeys.has(m.key),b=!!v&&(v.hasLocalMutations||this.mutatedKeys.has(v.key)&&v.hasCommittedMutations);let A=!1;m&&v?m.data.isEqual(v.data)?R!==b&&(r.track({type:3,doc:v}),A=!0):this.su(m,v)||(r.track({type:2,doc:v}),A=!0,(l&&this.eu(v,l)>0||d&&this.eu(v,d)<0)&&(a=!0)):!m&&v?(r.track({type:0,doc:v}),A=!0):m&&!v&&(r.track({type:1,doc:m}),A=!0,(l||d)&&(a=!0)),A&&(v?(o=o.add(v),i=b?i.add(h):i.delete(h)):(o=o.delete(h),i=i.delete(h)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const h=this.query.limitType==="F"?o.last():o.first();o=o.delete(h.key),i=i.delete(h.key),r.track({type:1,doc:h})}return{tu:o,iu:r,Cs:a,mutatedKeys:i}}su(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,s){const i=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const o=e.iu.ya();o.sort((h,f)=>function(v,R){const b=A=>{switch(A){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return le(20277,{Rt:A})}};return b(v)-b(R)}(h.type,f.type)||this.eu(h.doc,f.doc)),this.ou(r),s=s??!1;const a=n&&!s?this._u():[],l=this.Xa.size===0&&this.current&&!s?1:0,d=l!==this.Za;return this.Za=l,o.length!==0||d?{snapshot:new Ia(this.query,e.tu,i,o,e.mutatedKeys,l===0,d,!1,!!r&&r.resumeToken.approximateByteSize()>0),au:a}:{au:a}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new II,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(n=>this.Ya=this.Ya.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Ya=this.Ya.delete(n)),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=Ne(),this.tu.forEach(r=>{this.uu(r.key)&&(this.Xa=this.Xa.add(r.key))});const n=[];return e.forEach(r=>{this.Xa.has(r)||n.push(new jC(r))}),this.Xa.forEach(r=>{e.has(r)||n.push(new DC(r))}),n}cu(e){this.Ya=e.Qs,this.Xa=Ne();const n=this.ru(e.documents);return this.applyChanges(n,!0)}lu(){return Ia.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const a_="SyncEngine";class KL{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class GL{constructor(e){this.key=e,this.hu=!1}}class QL{constructor(e,n,r,s,i,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.Pu={},this.Tu=new rs(a=>Db(a),Wh),this.Iu=new Map,this.Eu=new Set,this.du=new ft(te.comparator),this.Au=new Map,this.Ru=new Wy,this.Vu={},this.mu=new Map,this.fu=Yi.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function YL(t,e,n=!0){const r=UC(t);let s;const i=r.Tu.get(e);return i?(r.sharedClientState.addLocalQueryTarget(i.targetId),s=i.view.lu()):s=await OC(r,e,n,!0),s}async function XL(t,e){const n=UC(t);await OC(n,e,!0,!1)}async function OC(t,e,n,r){const s=await yL(t.localStore,Gn(e)),i=s.targetId,o=t.sharedClientState.addLocalQueryTarget(i,n);let a;return r&&(a=await JL(t,e,i,o==="current",s.resumeToken)),t.isPrimaryClient&&n&&CC(t.remoteStore,s),a}async function JL(t,e,n,r,s){t.pu=(f,m,v)=>async function(b,A,I,w){let y=A.view.ru(I);y.Cs&&(y=await gI(b.localStore,A.query,!1).then(({documents:T})=>A.view.ru(T,y)));const j=w&&w.targetChanges.get(A.targetId),V=w&&w.targetMismatches.get(A.targetId)!=null,M=A.view.applyChanges(y,b.isPrimaryClient,j,V);return bI(b,A.targetId,M.au),M.snapshot}(t,f,m,v);const i=await gI(t.localStore,e,!0),o=new WL(e,i.Qs),a=o.ru(i.documents),l=Fc.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",s),d=o.applyChanges(a,t.isPrimaryClient,l);bI(t,n,d.au);const h=new KL(e,n,o);return t.Tu.set(e,h),t.Iu.has(n)?t.Iu.get(n).push(e):t.Iu.set(n,[e]),d.snapshot}async function ZL(t,e,n){const r=Ee(t),s=r.Tu.get(e),i=r.Iu.get(s.targetId);if(i.length>1)return r.Iu.set(s.targetId,i.filter(o=>!Wh(o,e))),void r.Tu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(s.targetId),r.sharedClientState.isActiveQueryTarget(s.targetId)||await ng(r.localStore,s.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(s.targetId),n&&Xy(r.remoteStore,s.targetId),ig(r,s.targetId)}).catch(oo)):(ig(r,s.targetId),await ng(r.localStore,s.targetId,!0))}async function eM(t,e){const n=Ee(t),r=n.Tu.get(e),s=n.Iu.get(r.targetId);n.isPrimaryClient&&s.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),Xy(n.remoteStore,r.targetId))}async function tM(t,e,n){const r=$C(t);try{const s=await function(o,a){const l=Ee(o),d=Be.now(),h=a.reduce((v,R)=>v.add(R.key),Ne());let f,m;return l.persistence.runTransaction("Locally write mutations","readwrite",v=>{let R=jn(),b=Ne();return l.Ns.getEntries(v,h).next(A=>{R=A,R.forEach((I,w)=>{w.isValidDocument()||(b=b.add(I))})}).next(()=>l.localDocuments.getOverlayedDocuments(v,R)).next(A=>{f=A;const I=[];for(const w of a){const y=pV(w,f.get(w.key).overlayedDocument);y!=null&&I.push(new ss(w.key,y,xb(y.value.mapValue),ln.exists(!0)))}return l.mutationQueue.addMutationBatch(v,d,I,a)}).next(A=>{m=A;const I=A.applyToLocalDocumentSet(f,b);return l.documentOverlayCache.saveOverlays(v,A.batchId,I)})}).then(()=>({batchId:m.batchId,changes:Vb(f)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(s.batchId),function(o,a,l){let d=o.Vu[o.currentUser.toKey()];d||(d=new ft(Te)),d=d.insert(a,l),o.Vu[o.currentUser.toKey()]=d}(r,s.batchId,n),await Bc(r,s.changes),await $c(r.remoteStore)}catch(s){const i=n_(s,"Failed to persist write");n.reject(i)}}async function VC(t,e){const n=Ee(t);try{const r=await pL(n.localStore,e);e.targetChanges.forEach((s,i)=>{const o=n.Au.get(i);o&&(ue(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1,22616),s.addedDocuments.size>0?o.hu=!0:s.modifiedDocuments.size>0?ue(o.hu,14607):s.removedDocuments.size>0&&(ue(o.hu,42227),o.hu=!1))}),await Bc(n,r,e)}catch(r){await oo(r)}}function SI(t,e,n){const r=Ee(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const s=[];r.Tu.forEach((i,o)=>{const a=o.view.va(e);a.snapshot&&s.push(a.snapshot)}),function(o,a){const l=Ee(o);l.onlineState=a;let d=!1;l.queries.forEach((h,f)=>{for(const m of f.Sa)m.va(a)&&(d=!0)}),d&&i_(l)}(r.eventManager,e),s.length&&r.Pu.H_(s),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function nM(t,e,n){const r=Ee(t);r.sharedClientState.updateQueryState(e,"rejected",n);const s=r.Au.get(e),i=s&&s.key;if(i){let o=new ft(te.comparator);o=o.insert(i,It.newNoDocument(i,me.min()));const a=Ne().add(i),l=new Xh(me.min(),new Map,new ft(Te),o,a);await VC(r,l),r.du=r.du.remove(i),r.Au.delete(e),l_(r)}else await ng(r.localStore,e,!1).then(()=>ig(r,e,n)).catch(oo)}async function rM(t,e){const n=Ee(t),r=e.batch.batchId;try{const s=await fL(n.localStore,e);MC(n,r,null),LC(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await Bc(n,s)}catch(s){await oo(s)}}async function sM(t,e,n){const r=Ee(t);try{const s=await function(o,a){const l=Ee(o);return l.persistence.runTransaction("Reject batch","readwrite-primary",d=>{let h;return l.mutationQueue.lookupMutationBatch(d,a).next(f=>(ue(f!==null,37113),h=f.keys(),l.mutationQueue.removeMutationBatch(d,f))).next(()=>l.mutationQueue.performConsistencyCheck(d)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(d,h,a)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(d,h)).next(()=>l.localDocuments.getDocuments(d,h))})}(r.localStore,e);MC(r,e,n),LC(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await Bc(r,s)}catch(s){await oo(s)}}function LC(t,e){(t.mu.get(e)||[]).forEach(n=>{n.resolve()}),t.mu.delete(e)}function MC(t,e,n){const r=Ee(t);let s=r.Vu[r.currentUser.toKey()];if(s){const i=s.get(e);i&&(n?i.reject(n):i.resolve(),s=s.remove(e)),r.Vu[r.currentUser.toKey()]=s}}function ig(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Iu.get(e))t.Tu.delete(r),n&&t.Pu.yu(r,n);t.Iu.delete(e),t.isPrimaryClient&&t.Ru.jr(e).forEach(r=>{t.Ru.containsKey(r)||FC(t,r)})}function FC(t,e){t.Eu.delete(e.path.canonicalString());const n=t.du.get(e);n!==null&&(Xy(t.remoteStore,n),t.du=t.du.remove(e),t.Au.delete(n),l_(t))}function bI(t,e,n){for(const r of n)r instanceof DC?(t.Ru.addReference(r.key,e),iM(t,r)):r instanceof jC?(H(a_,"Document no longer in limbo: "+r.key),t.Ru.removeReference(r.key,e),t.Ru.containsKey(r.key)||FC(t,r.key)):le(19791,{wu:r})}function iM(t,e){const n=e.key,r=n.path.canonicalString();t.du.get(n)||t.Eu.has(r)||(H(a_,"New document in limbo: "+n),t.Eu.add(r),l_(t))}function l_(t){for(;t.Eu.size>0&&t.du.size<t.maxConcurrentLimboResolutions;){const e=t.Eu.values().next().value;t.Eu.delete(e);const n=new te(We.fromString(e)),r=t.fu.next();t.Au.set(r,new GL(n)),t.du=t.du.insert(n,r),CC(t.remoteStore,new zr(Gn(Lc(n.path)),r,"TargetPurposeLimboResolution",Wn.ce))}}async function Bc(t,e,n){const r=Ee(t),s=[],i=[],o=[];r.Tu.isEmpty()||(r.Tu.forEach((a,l)=>{o.push(r.pu(l,e,n).then(d=>{var h;if((d||n)&&r.isPrimaryClient){const f=d?!d.fromCache:(h=n==null?void 0:n.targetChanges.get(l.targetId))==null?void 0:h.current;r.sharedClientState.updateQueryState(l.targetId,f?"current":"not-current")}if(d){s.push(d);const f=Qy.As(l.targetId,d);i.push(f)}}))}),await Promise.all(o),r.Pu.H_(s),await async function(l,d){const h=Ee(l);try{await h.persistence.runTransaction("notifyLocalViewChanges","readwrite",f=>O.forEach(d,m=>O.forEach(m.Es,v=>h.persistence.referenceDelegate.addReference(f,m.targetId,v)).next(()=>O.forEach(m.ds,v=>h.persistence.referenceDelegate.removeReference(f,m.targetId,v)))))}catch(f){if(!si(f))throw f;H(Yy,"Failed to update sequence numbers: "+f)}for(const f of d){const m=f.targetId;if(!f.fromCache){const v=h.Ms.get(m),R=v.snapshotVersion,b=v.withLastLimboFreeSnapshotVersion(R);h.Ms=h.Ms.insert(m,b)}}}(r.localStore,i))}async function oM(t,e){const n=Ee(t);if(!n.currentUser.isEqual(e)){H(a_,"User change. New user:",e.toKey());const r=await IC(n.localStore,e);n.currentUser=e,function(i,o){i.mu.forEach(a=>{a.forEach(l=>{l.reject(new K($.CANCELLED,o))})}),i.mu.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await Bc(n,r.Ls)}}function aM(t,e){const n=Ee(t),r=n.Au.get(e);if(r&&r.hu)return Ne().add(r.key);{let s=Ne();const i=n.Iu.get(e);if(!i)return s;for(const o of i){const a=n.Tu.get(o);s=s.unionWith(a.view.nu)}return s}}function UC(t){const e=Ee(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=VC.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=aM.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=nM.bind(null,e),e.Pu.H_=qL.bind(null,e.eventManager),e.Pu.yu=HL.bind(null,e.eventManager),e}function $C(t){const e=Ee(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=rM.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=sM.bind(null,e),e}class Ec{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=tf(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,n){return null}Mu(e,n){return null}vu(e){return EC(this.persistence,new wC,e.initialUser,this.serializer)}Cu(e){return new Ky(ef.mi,this.serializer)}Du(e){return new xC}async terminate(){var e,n;(e=this.gcScheduler)==null||e.stop(),(n=this.indexBackfillerScheduler)==null||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Ec.provider={build:()=>new Ec};class lM extends Ec{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,n){ue(this.persistence.referenceDelegate instanceof rh,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new mC(r,e.asyncQueue,n)}Cu(e){const n=this.cacheSizeBytes!==void 0?sn.withCacheSize(this.cacheSizeBytes):sn.DEFAULT;return new Ky(r=>rh.mi(r,n),this.serializer)}}class cM extends Ec{constructor(e,n,r){super(),this.xu=e,this.cacheSizeBytes=n,this.forceOwnership=r,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.xu.initialize(this,e),await $C(this.xu.syncEngine),await $c(this.xu.remoteStore),await this.persistence.Ji(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}vu(e){return EC(this.persistence,new wC,e.initialUser,this.serializer)}Fu(e,n){const r=this.persistence.referenceDelegate.garbageCollector;return new mC(r,e.asyncQueue,n)}Mu(e,n){const r=new fO(n,this.persistence);return new hO(e.asyncQueue,r)}Cu(e){const n=cL(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?sn.withCacheSize(this.cacheSizeBytes):sn.DEFAULT;return new Gy(this.synchronizeTabs,n,e.clientId,r,e.asyncQueue,xL(),ld(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Du(e){return new xC}}class ih{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>SI(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=oM.bind(null,this.syncEngine),await $L(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new zL}()}createDatastore(e){const n=tf(e.databaseInfo.databaseId),r=function(i){return new TL(i)}(e.databaseInfo);return function(i,o,a,l){return new AL(i,o,a,l)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,s,i,o,a){return new PL(r,s,i,o,a)}(this.localStore,this.datastore,e.asyncQueue,n=>SI(this.syncEngine,n,0),function(){return vI.v()?new vI:new vL}())}createSyncEngine(e,n){return function(s,i,o,a,l,d,h){const f=new QL(s,i,o,a,l,d);return h&&(f.gu=!0),f}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(s){const i=Ee(s);H(Xi,"RemoteStore shutting down."),i.Ea.add(5),await Uc(i),i.Aa.shutdown(),i.Ra.set("Unknown")}(this.remoteStore),(e=this.datastore)==null||e.terminate(),(n=this.eventManager)==null||n.terminate()}}ih.provider={build:()=>new ih};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c_{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):pn("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xs="FirestoreClient";class uM{constructor(e,n,r,s,i){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=s,this.user=Gt.UNAUTHENTICATED,this.clientId=by.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(r,async o=>{H(Xs,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>(H(Xs,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new cr;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=n_(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function vp(t,e){t.asyncQueue.verifyOperationInProgress(),H(Xs,"Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async s=>{r.isEqual(s)||(await IC(e.localStore,s),r=s)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function CI(t,e){t.asyncQueue.verifyOperationInProgress();const n=await dM(t);H(Xs,"Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>EI(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,s)=>EI(e.remoteStore,s)),t._onlineComponents=e}async function dM(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){H(Xs,"Using user provided OfflineComponentProvider");try{await vp(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(s){return s.name==="FirebaseError"?s.code===$.FAILED_PRECONDITION||s.code===$.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(n))throw n;zi("Error using user provided cache. Falling back to memory cache: "+n),await vp(t,new Ec)}}else H(Xs,"Using default OfflineComponentProvider"),await vp(t,new lM(void 0));return t._offlineComponents}async function u_(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(H(Xs,"Using user provided OnlineComponentProvider"),await CI(t,t._uninitializedComponentsProvider._online)):(H(Xs,"Using default OnlineComponentProvider"),await CI(t,new ih))),t._onlineComponents}function hM(t){return u_(t).then(e=>e.syncEngine)}function fM(t){return u_(t).then(e=>e.datastore)}async function oh(t){const e=await u_(t),n=e.eventManager;return n.onListen=YL.bind(null,e.syncEngine),n.onUnlisten=ZL.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=XL.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=eM.bind(null,e.syncEngine),n}function pM(t,e,n={}){const r=new cr;return t.asyncQueue.enqueueAndForget(async()=>function(i,o,a,l,d){const h=new c_({next:m=>{h.Nu(),o.enqueueAndForget(()=>s_(i,f));const v=m.docs.has(a);!v&&m.fromCache?d.reject(new K($.UNAVAILABLE,"Failed to get document because the client is offline.")):v&&m.fromCache&&l&&l.source==="server"?d.reject(new K($.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):d.resolve(m)},error:m=>d.reject(m)}),f=new o_(Lc(a.path),h,{includeMetadataChanges:!0,qa:!0});return r_(i,f)}(await oh(t),t.asyncQueue,e,n,r)),r.promise}function mM(t,e,n={}){const r=new cr;return t.asyncQueue.enqueueAndForget(async()=>function(i,o,a,l,d){const h=new c_({next:m=>{h.Nu(),o.enqueueAndForget(()=>s_(i,f)),m.fromCache&&l.source==="server"?d.reject(new K($.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):d.resolve(m)},error:m=>d.reject(m)}),f=new o_(a,h,{includeMetadataChanges:!0,qa:!0});return r_(i,f)}(await oh(t),t.asyncQueue,e,n,r)),r.promise}function gM(t,e,n){const r=new cr;return t.asyncQueue.enqueueAndForget(async()=>{try{const s=await fM(t);r.resolve(async function(o,a,l){var b;const d=Ee(o),{request:h,gt:f,parent:m}=RV(d.serializer,tV(a),l);d.connection.$o||delete h.parent;const v=(await d.Ho("RunAggregationQuery",d.serializer.databaseId,m,h,1)).filter(A=>!!A.result);ue(v.length===1,64727);const R=(b=v[0].result)==null?void 0:b.aggregateFields;return Object.keys(R).reduce((A,I)=>(A[f[I]]=R[I],A),{})}(s,e,n))}catch(s){r.reject(s)}}),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function BC(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AI=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zC="firestore.googleapis.com",RI=!0;class PI{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new K($.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=zC,this.ssl=RI}else this.host=e.host,this.ssl=e.ssl??RI;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=dC;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<WV)throw new K($.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}aO("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=BC(e.experimentalLongPollingOptions??{}),function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new K($.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new K($.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new K($.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,s){return r.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class rf{constructor(e,n,r,s){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new PI({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new K($.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new K($.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new PI(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new X2;switch(r.type){case"firstParty":return new tO(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new K($.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=AI.get(n);r&&(H("ComponentProvider","Removing Datastore"),AI.delete(n),r.terminate())}(this),Promise.resolve()}}function yM(t,e,n,r={}){var d;t=cn(t,rf);const s=ti(e),i=t._getSettings(),o={...i,emulatorOptions:t._getEmulatorOptions()},a=`${e}:${n}`;s&&(dy(`https://${a}`),hy("Firestore",!0)),i.host!==zC&&i.host!==a&&zi("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const l={...i,host:a,ssl:s,emulatorOptions:r};if(!Xr(l,o)&&(t._setSettings(l),r.mockUserToken)){let h,f;if(typeof r.mockUserToken=="string")h=r.mockUserToken,f=Gt.MOCK_USER;else{h=Jx(r.mockUserToken,(d=t._app)==null?void 0:d.options.projectId);const m=r.mockUserToken.sub||r.mockUserToken.user_id;if(!m)throw new K($.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");f=new Gt(m)}t._authCredentials=new J2(new XS(h,f))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mr{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new mr(this.firestore,e,this._query)}}class Tt{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new qs(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Tt(this.firestore,e,this._key)}toJSON(){return{type:Tt._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,n,r){if(jc(n,Tt._jsonSchema))return new Tt(e,r||null,new te(We.fromString(n.referencePath)))}}Tt._jsonSchemaVersion="firestore/documentReference/1.0",Tt._jsonSchema={type:Rt("string",Tt._jsonSchemaVersion),referencePath:Rt("string")};class qs extends mr{constructor(e,n,r){super(e,n,Lc(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Tt(this.firestore,null,new te(e))}withConverter(e){return new qs(this.firestore,e,this._path)}}function Ue(t,e,...n){if(t=Qe(t),ZS("collection","path",e),t instanceof rf){const r=We.fromString(e,...n);return wE(r),new qs(t,null,r)}{if(!(t instanceof Tt||t instanceof qs))throw new K($.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(We.fromString(e,...n));return wE(r),new qs(t.firestore,null,r)}}function zt(t,e,...n){if(t=Qe(t),arguments.length===1&&(e=by.newId()),ZS("doc","path",e),t instanceof rf){const r=We.fromString(e,...n);return vE(r),new Tt(t,null,new te(r))}{if(!(t instanceof Tt||t instanceof qs))throw new K($.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(We.fromString(e,...n));return vE(r),new Tt(t.firestore,t instanceof qs?t.converter:null,new te(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NI="AsyncQueue";class kI{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new SC(this,"async_queue_retry"),this._c=()=>{const r=ld();r&&H(NI,"Visibility state changed to "+r.visibilityState),this.M_.w_()},this.ac=e;const n=ld();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const n=ld();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});const n=new cr;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Xu.push(e),this.lc()))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!si(e))throw e;H(NI,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){const n=this.ac.then(()=>(this.rc=!0,e().catch(r=>{throw this.nc=r,this.rc=!1,pn("INTERNAL UNHANDLED ERROR: ",DI(r)),r}).then(r=>(this.rc=!1,r))));return this.ac=n,n}enqueueAfterDelay(e,n,r){this.uc(),this.oc.indexOf(e)>-1&&(n=0);const s=t_.createAndSchedule(this,e,n,r,i=>this.hc(i));return this.tc.push(s),s}uc(){this.nc&&le(47125,{Pc:DI(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const n of this.tc)if(n.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.tc)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.Tc()})}dc(e){this.oc.push(e)}hc(e){const n=this.tc.indexOf(e);this.tc.splice(n,1)}}function DI(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jI(t){return function(n,r){if(typeof n!="object"||n===null)return!1;const s=n;for(const i of r)if(i in s&&typeof s[i]=="function")return!0;return!1}(t,["next","error","complete"])}class fr extends rf{constructor(e,n,r,s){super(e,n,r,s),this.type="firestore",this._queue=new kI,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new kI(e),this._firestoreClient=void 0,await e}}}function qC(t,e){const n=typeof t=="object"?t:kh(),r=typeof t=="string"?t:Gd,s=ni(n,"firestore").getImmediate({identifier:r});if(!s._initialized){const i=Qx("firestore");i&&yM(s,...i)}return s}function zc(t){if(t._terminated)throw new K($.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||HC(t),t._firestoreClient}function HC(t){var r,s,i;const e=t._freezeSettings(),n=function(a,l,d,h){return new zO(a,l,d,h.host,h.ssl,h.experimentalForceLongPolling,h.experimentalAutoDetectLongPolling,BC(h.experimentalLongPollingOptions),h.useFetchStreams,h.isUsingEmulator)}(t._databaseId,((r=t._app)==null?void 0:r.options.appId)||"",t._persistenceKey,e);t._componentsProvider||(s=e.localCache)!=null&&s._offlineComponentProvider&&((i=e.localCache)!=null&&i._onlineComponentProvider)&&(t._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),t._firestoreClient=new uM(t._authCredentials,t._appCheckCredentials,t._queue,n,t._componentsProvider&&function(a){const l=a==null?void 0:a._online.build();return{_offline:a==null?void 0:a._offline.build(l),_online:l}}(t._componentsProvider))}function _M(t,e){zi("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const n=t._freezeSettings();return vM(t,ih.provider,{build:r=>new cM(r,n.cacheSizeBytes,e==null?void 0:e.forceOwnership)}),Promise.resolve()}function vM(t,e,n){if((t=cn(t,fr))._firestoreClient||t._terminated)throw new K($.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(t._componentsProvider||t._getSettings().localCache)throw new K($.FAILED_PRECONDITION,"SDK cache is already specified.");t._componentsProvider={_online:e,_offline:n},HC(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wM{constructor(e="count",n){this._internalFieldPath=n,this.type="AggregateField",this.aggregateType=e}}class EM{constructor(e,n,r){this._userDataWriter=n,this._data=r,this.type="AggregateQuerySnapshot",this.query=e}data(){return this._userDataWriter.convertObjectMap(this._data)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qn{constructor(e){this._byteString=e}static fromBase64String(e){try{return new qn(Pt.fromBase64String(e))}catch(n){throw new K($.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new qn(Pt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:qn._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(jc(e,qn._jsonSchema))return qn.fromBase64String(e.bytes)}}qn._jsonSchemaVersion="firestore/bytes/1.0",qn._jsonSchema={type:Rt("string",qn._jsonSchemaVersion),bytes:Rt("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sf{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new K($.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new gt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ja{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kr{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new K($.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new K($.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return Te(this._lat,e._lat)||Te(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:kr._jsonSchemaVersion}}static fromJSON(e){if(jc(e,kr._jsonSchema))return new kr(e.latitude,e.longitude)}}kr._jsonSchemaVersion="firestore/geoPoint/1.0",kr._jsonSchema={type:Rt("string",kr._jsonSchemaVersion),latitude:Rt("number"),longitude:Rt("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dr{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,s){if(r.length!==s.length)return!1;for(let i=0;i<r.length;++i)if(r[i]!==s[i])return!1;return!0}(this._values,e._values)}toJSON(){return{type:Dr._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(jc(e,Dr._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(n=>typeof n=="number"))return new Dr(e.vectorValues);throw new K($.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Dr._jsonSchemaVersion="firestore/vectorValue/1.0",Dr._jsonSchema={type:Rt("string",Dr._jsonSchemaVersion),vectorValues:Rt("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IM=/^__.*__$/;class TM{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new ss(e,this.data,this.fieldMask,n,this.fieldTransforms):new ka(e,this.data,n,this.fieldTransforms)}}class WC{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new ss(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function KC(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw le(40011,{Ac:t})}}class of{constructor(e,n,r,s,i,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=s,i===void 0&&this.Rc(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new of({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){var s;const n=(s=this.path)==null?void 0:s.child(e),r=this.Vc({path:n,fc:!1});return r.gc(e),r}yc(e){var s;const n=(s=this.path)==null?void 0:s.child(e),r=this.Vc({path:n,fc:!1});return r.Rc(),r}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return ah(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(KC(this.Ac)&&IM.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class xM{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||tf(e)}Cc(e,n,r,s=!1){return new of({Ac:e,methodName:n,Dc:r,path:gt.emptyPath(),fc:!1,bc:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function qc(t){const e=t._freezeSettings(),n=tf(t._databaseId);return new xM(t._databaseId,!!e.ignoreUndefinedProperties,n)}function GC(t,e,n,r,s,i={}){const o=t.Cc(i.merge||i.mergeFields?2:0,e,n,s);p_("Data must be an object, but it was:",o,r);const a=YC(r,o);let l,d;if(i.merge)l=new Sn(o.fieldMask),d=o.fieldTransforms;else if(i.mergeFields){const h=[];for(const f of i.mergeFields){const m=og(e,f,n);if(!o.contains(m))throw new K($.INVALID_ARGUMENT,`Field '${m}' is specified in your field mask but missing from your input data.`);JC(h,m)||h.push(m)}l=new Sn(h),d=o.fieldTransforms.filter(f=>l.covers(f.field))}else l=null,d=o.fieldTransforms;return new TM(new an(a),l,d)}class af extends ja{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof af}}function SM(t,e,n){return new of({Ac:3,Dc:e.settings.Dc,methodName:t._methodName,fc:n},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class d_ extends ja{_toFieldTransform(e){return new Gh(e.path,new _a)}isEqual(e){return e instanceof d_}}class h_ extends ja{constructor(e,n){super(e),this.vc=n}_toFieldTransform(e){const n=SM(this,e,!0),r=this.vc.map(i=>Oa(i,n)),s=new Ki(r);return new Gh(e.path,s)}isEqual(e){return e instanceof h_&&Xr(this.vc,e.vc)}}class f_ extends ja{constructor(e,n){super(e),this.Fc=n}_toFieldTransform(e){const n=new wa(e.serializer,Fb(e.serializer,this.Fc));return new Gh(e.path,n)}isEqual(e){return e instanceof f_&&this.Fc===e.Fc}}function bM(t,e,n,r){const s=t.Cc(1,e,n);p_("Data must be an object, but it was:",s,r);const i=[],o=an.empty();ii(r,(l,d)=>{const h=m_(e,l,n);d=Qe(d);const f=s.yc(h);if(d instanceof af)i.push(h);else{const m=Oa(d,f);m!=null&&(i.push(h),o.set(h,m))}});const a=new Sn(i);return new WC(o,a,s.fieldTransforms)}function CM(t,e,n,r,s,i){const o=t.Cc(1,e,n),a=[og(e,r,n)],l=[s];if(i.length%2!=0)throw new K($.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let m=0;m<i.length;m+=2)a.push(og(e,i[m])),l.push(i[m+1]);const d=[],h=an.empty();for(let m=a.length-1;m>=0;--m)if(!JC(d,a[m])){const v=a[m];let R=l[m];R=Qe(R);const b=o.yc(v);if(R instanceof af)d.push(v);else{const A=Oa(R,b);A!=null&&(d.push(v),h.set(v,A))}}const f=new Sn(d);return new WC(h,f,o.fieldTransforms)}function QC(t,e,n,r=!1){return Oa(n,t.Cc(r?4:3,e))}function Oa(t,e){if(XC(t=Qe(t)))return p_("Unsupported field value:",e,t),YC(t,e);if(t instanceof ja)return function(r,s){if(!KC(s.Ac))throw s.Sc(`${r._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Sc(`${r._methodName}() is not currently supported inside arrays`);const i=r._toFieldTransform(s);i&&s.fieldTransforms.push(i)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return function(r,s){const i=[];let o=0;for(const a of r){let l=Oa(a,s.wc(o));l==null&&(l={nullValue:"NULL_VALUE"}),i.push(l),o++}return{arrayValue:{values:i}}}(t,e)}return function(r,s){if((r=Qe(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return Fb(s.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const i=Be.fromDate(r);return{timestampValue:Ea(s.serializer,i)}}if(r instanceof Be){const i=new Be(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Ea(s.serializer,i)}}if(r instanceof kr)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof qn)return{bytesValue:Yb(s.serializer,r._byteString)};if(r instanceof Tt){const i=s.databaseId,o=r.firestore._databaseId;if(!o.isEqual(i))throw s.Sc(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:By(r.firestore._databaseId||s.databaseId,r._key.path)}}if(r instanceof Dr)return function(o,a){return{mapValue:{fields:{[Dy]:{stringValue:jy},[ma]:{arrayValue:{values:o.toArray().map(d=>{if(typeof d!="number")throw a.Sc("VectorValues must only contain numeric values.");return Ly(a.serializer,d)})}}}}}}(r,s);throw s.Sc(`Unsupported field value: ${Lh(r)}`)}(t,e)}function YC(t,e){const n={};return mb(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):ii(t,(r,s)=>{const i=Oa(s,e.mc(r));i!=null&&(n[r]=i)}),{mapValue:{fields:n}}}function XC(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof Be||t instanceof kr||t instanceof qn||t instanceof Tt||t instanceof ja||t instanceof Dr)}function p_(t,e,n){if(!XC(n)||!eb(n)){const r=Lh(n);throw r==="an object"?e.Sc(t+" a custom object"):e.Sc(t+" "+r)}}function og(t,e,n){if((e=Qe(e))instanceof sf)return e._internalPath;if(typeof e=="string")return m_(t,e);throw ah("Field path arguments must be of type string or ",t,!1,void 0,n)}const AM=new RegExp("[~\\*/\\[\\]]");function m_(t,e,n){if(e.search(AM)>=0)throw ah(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new sf(...e.split("."))._internalPath}catch{throw ah(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function ah(t,e,n,r,s){const i=r&&!r.isEmpty(),o=s!==void 0;let a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let l="";return(i||o)&&(l+=" (found",i&&(l+=` in field ${r}`),o&&(l+=` in document ${s}`),l+=")"),new K($.INVALID_ARGUMENT,a+t+l)}function JC(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g_{constructor(e,n,r,s,i){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new Tt(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new RM(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(lf("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class RM extends g_{data(){return super.data()}}function lf(t,e){return typeof e=="string"?m_(t,e):e instanceof sf?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZC(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new K($.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class y_{}class Hc extends y_{}function rt(t,e,...n){let r=[];e instanceof y_&&r.push(e),r=r.concat(n),function(i){const o=i.filter(l=>l instanceof __).length,a=i.filter(l=>l instanceof cf).length;if(o>1||o>0&&a>0)throw new K($.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const s of r)t=s._apply(t);return t}class cf extends Hc{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new cf(e,n,r)}_apply(e){const n=this._parse(e);return tA(e._query,n),new mr(e.firestore,e.converter,Gm(e._query,n))}_parse(e){const n=qc(e.firestore);return function(i,o,a,l,d,h,f){let m;if(d.isKeyField()){if(h==="array-contains"||h==="array-contains-any")throw new K($.INVALID_ARGUMENT,`Invalid Query. You can't perform '${h}' queries on documentId().`);if(h==="in"||h==="not-in"){MI(f,h);const R=[];for(const b of f)R.push(LI(l,i,b));m={arrayValue:{values:R}}}else m=LI(l,i,f)}else h!=="in"&&h!=="not-in"&&h!=="array-contains-any"||MI(f,h),m=QC(a,o,f,h==="in"||h==="not-in");return Me.create(d,h,m)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function Je(t,e,n){const r=e,s=lf("where",t);return cf._create(s,r,n)}class __ extends y_{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new __(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:Ze.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(s,i){let o=s;const a=i.getFlattenedFilters();for(const l of a)tA(o,l),o=Gm(o,l)}(e._query,n),new mr(e.firestore,e.converter,Gm(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class v_ extends Hc{constructor(e,n){super(),this._field=e,this._direction=n,this.type="orderBy"}static _create(e,n){return new v_(e,n)}_apply(e){const n=function(s,i,o){if(s.startAt!==null)throw new K($.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(s.endAt!==null)throw new K($.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new wc(i,o)}(e._query,this._field,this._direction);return new mr(e.firestore,e.converter,function(s,i){const o=s.explicitOrderBy.concat([i]);return new oi(s.path,s.collectionGroup,o,s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt)}(e._query,n))}}function Xt(t,e="asc"){const n=e,r=lf("orderBy",t);return v_._create(r,n)}class w_ extends Hc{constructor(e,n,r){super(),this.type=e,this._limit=n,this._limitType=r}static _create(e,n,r){return new w_(e,n,r)}_apply(e){return new mr(e.firestore,e.converter,Xd(e._query,this._limit,this._limitType))}}function Zo(t){return lO("limit",t),w_._create("limit",t,"F")}class uf extends Hc{constructor(e,n,r){super(),this.type=e,this._docOrFields=n,this._inclusive=r}static _create(e,n,r){return new uf(e,n,r)}_apply(e){const n=eA(e,this.type,this._docOrFields,this._inclusive);return new mr(e.firestore,e.converter,function(s,i){return new oi(s.path,s.collectionGroup,s.explicitOrderBy.slice(),s.filters.slice(),s.limit,s.limitType,i,s.endAt)}(e._query,n))}}function OI(...t){return uf._create("startAt",t,!0)}function PM(...t){return uf._create("startAfter",t,!1)}class E_ extends Hc{constructor(e,n,r){super(),this.type=e,this._docOrFields=n,this._inclusive=r}static _create(e,n,r){return new E_(e,n,r)}_apply(e){const n=eA(e,this.type,this._docOrFields,this._inclusive);return new mr(e.firestore,e.converter,function(s,i){return new oi(s.path,s.collectionGroup,s.explicitOrderBy.slice(),s.filters.slice(),s.limit,s.limitType,s.startAt,i)}(e._query,n))}}function VI(...t){return E_._create("endAt",t,!0)}function eA(t,e,n,r){if(n[0]=Qe(n[0]),n[0]instanceof g_)return function(i,o,a,l,d){if(!l)throw new K($.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${a}().`);const h=[];for(const f of Xo(i))if(f.field.isKeyField())h.push(Hi(o,l.key));else{const m=l.data.field(f.field);if(zh(m))throw new K($.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+f.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(m===null){const v=f.field.canonicalString();throw new K($.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${v}' (used as the orderBy) does not exist.`)}h.push(m)}return new Qs(h,d)}(t._query,t.firestore._databaseId,e,n[0]._document,r);{const s=qc(t.firestore);return function(o,a,l,d,h,f){const m=o.explicitOrderBy;if(h.length>m.length)throw new K($.INVALID_ARGUMENT,`Too many arguments provided to ${d}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const v=[];for(let R=0;R<h.length;R++){const b=h[R];if(m[R].field.isKeyField()){if(typeof b!="string")throw new K($.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${d}(), but got a ${typeof b}`);if(!Vy(o)&&b.indexOf("/")!==-1)throw new K($.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${d}() must be a plain document ID, but '${b}' contains a slash.`);const A=o.path.child(We.fromString(b));if(!te.isDocumentKey(A))throw new K($.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${d}() must result in a valid document path, but '${A}' is not because it contains an odd number of segments.`);const I=new te(A);v.push(Hi(a,I))}else{const A=QC(l,d,b);v.push(A)}}return new Qs(v,f)}(t._query,t.firestore._databaseId,s,e,n,r)}}function LI(t,e,n){if(typeof(n=Qe(n))=="string"){if(n==="")throw new K($.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Vy(e)&&n.indexOf("/")!==-1)throw new K($.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(We.fromString(n));if(!te.isDocumentKey(r))throw new K($.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Hi(t,new te(r))}if(n instanceof Tt)return Hi(t,n._key);throw new K($.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Lh(n)}.`)}function MI(t,e){if(!Array.isArray(t)||t.length===0)throw new K($.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function tA(t,e){const n=function(s,i){for(const o of s)for(const a of o.getFlattenedFilters())if(i.indexOf(a.op)>=0)return a.op;return null}(t.filters,function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new K($.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new K($.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class NM{convertValue(e,n="none"){switch(Ks(e)){case 0:return null;case 1:return e.booleanValue;case 2:return ut(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(ts(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw le(62114,{value:e})}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return ii(e,(s,i)=>{r[s]=this.convertValue(i,n)}),r}convertVectorValue(e){var r,s,i;const n=(i=(s=(r=e.fields)==null?void 0:r[ma].arrayValue)==null?void 0:s.values)==null?void 0:i.map(o=>ut(o.doubleValue));return new Dr(n)}convertGeoPoint(e){return new kr(ut(e.latitude),ut(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=qh(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(yc(e));default:return null}}convertTimestamp(e){const n=es(e);return new Be(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=We.fromString(e);ue(iC(r),9688,{name:e});const s=new qi(r.get(1),r.get(3)),i=new te(r.popFirst(5));return s.isEqual(n)||pn(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nA(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}function kM(){return new wM("count")}class El{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Di extends g_{constructor(e,n,r,s,i,o){super(e,n,r,s,o),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new cd(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(lf("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new K($.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,n={};return n.type=Di._jsonSchemaVersion,n.bundle="",n.bundleSource="DocumentSnapshot",n.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?n:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),n.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),n)}}Di._jsonSchemaVersion="firestore/documentSnapshot/1.0",Di._jsonSchema={type:Rt("string",Di._jsonSchemaVersion),bundleSource:Rt("string","DocumentSnapshot"),bundleName:Rt("string"),bundle:Rt("string")};class cd extends Di{data(e={}){return super.data(e)}}class ji{constructor(e,n,r,s){this._firestore=e,this._userDataWriter=n,this._snapshot=s,this.metadata=new El(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new cd(this._firestore,this._userDataWriter,r.key,r,new El(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new K($.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(s,i){if(s._snapshot.oldDocs.isEmpty()){let o=0;return s._snapshot.docChanges.map(a=>{const l=new cd(s._firestore,s._userDataWriter,a.doc.key,a.doc,new El(s._snapshot.mutatedKeys.has(a.doc.key),s._snapshot.fromCache),s.query.converter);return a.doc,{type:"added",doc:l,oldIndex:-1,newIndex:o++}})}{let o=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(a=>i||a.type!==3).map(a=>{const l=new cd(s._firestore,s._userDataWriter,a.doc.key,a.doc,new El(s._snapshot.mutatedKeys.has(a.doc.key),s._snapshot.fromCache),s.query.converter);let d=-1,h=-1;return a.type!==0&&(d=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),h=o.indexOf(a.doc.key)),{type:DM(a.type),doc:l,oldIndex:d,newIndex:h}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new K($.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=ji._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=by.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const n=[],r=[],s=[];return this.docs.forEach(i=>{i._document!==null&&(n.push(i._document),r.push(this._userDataWriter.convertObjectMap(i._document.data.value.mapValue.fields,"previous")),s.push(i.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function DM(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return le(61501,{type:t})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lh(t){t=cn(t,Tt);const e=cn(t.firestore,fr);return pM(zc(e),t._key).then(n=>sA(e,t,n))}ji._jsonSchemaVersion="firestore/querySnapshot/1.0",ji._jsonSchema={type:Rt("string",ji._jsonSchemaVersion),bundleSource:Rt("string","QuerySnapshot"),bundleName:Rt("string"),bundle:Rt("string")};class df extends NM{constructor(e){super(),this.firestore=e}convertBytes(e){return new qn(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new Tt(this.firestore,null,n)}}function Yt(t){t=cn(t,mr);const e=cn(t.firestore,fr),n=zc(e),r=new df(e);return ZC(t._query),mM(n,t._query).then(s=>new ji(e,r,t,s))}function Bl(t,e,n){t=cn(t,Tt);const r=cn(t.firestore,fr),s=nA(t.converter,e,n);return hf(r,[GC(qc(r),"setDoc",t._key,s,t.converter!==null,n).toMutation(t._key,ln.none())])}function ea(t,e,n,...r){t=cn(t,Tt);const s=cn(t.firestore,fr),i=qc(s);let o;return o=typeof(e=Qe(e))=="string"||e instanceof sf?CM(i,"updateDoc",t._key,e,n,r):bM(i,"updateDoc",t._key,e),hf(s,[o.toMutation(t._key,ln.exists(!0))])}function rA(t){return hf(cn(t.firestore,fr),[new Yh(t._key,ln.none())])}function Il(t,e){const n=cn(t.firestore,fr),r=zt(t),s=nA(t.converter,e);return hf(n,[GC(qc(t.firestore),"addDoc",r._key,s,t.converter!==null,{}).toMutation(r._key,ln.exists(!1))]).then(()=>r)}function ir(t,...e){var l,d,h;t=Qe(t);let n={includeMetadataChanges:!1,source:"default"},r=0;typeof e[r]!="object"||jI(e[r])||(n=e[r++]);const s={includeMetadataChanges:n.includeMetadataChanges,source:n.source};if(jI(e[r])){const f=e[r];e[r]=(l=f.next)==null?void 0:l.bind(f),e[r+1]=(d=f.error)==null?void 0:d.bind(f),e[r+2]=(h=f.complete)==null?void 0:h.bind(f)}let i,o,a;if(t instanceof Tt)o=cn(t.firestore,fr),a=Lc(t._key.path),i={next:f=>{e[r]&&e[r](sA(o,t,f))},error:e[r+1],complete:e[r+2]};else{const f=cn(t,mr);o=cn(f.firestore,fr),a=f._query;const m=new df(o);i={next:v=>{e[r]&&e[r](new ji(o,m,f,v))},error:e[r+1],complete:e[r+2]},ZC(t._query)}return function(m,v,R,b){const A=new c_(b),I=new o_(v,A,R);return m.asyncQueue.enqueueAndForget(async()=>r_(await oh(m),I)),()=>{A.Nu(),m.asyncQueue.enqueueAndForget(async()=>s_(await oh(m),I))}}(zc(o),a,s,i)}function hf(t,e){return function(r,s){const i=new cr;return r.asyncQueue.enqueueAndForget(async()=>tM(await hM(r),s,i)),i.promise}(zc(t),e)}function sA(t,e,n){const r=n.docs.get(e._key),s=new df(t);return new Di(t,s,e._key,r,new El(n.hasPendingWrites,n.fromCache),e.converter)}function jM(t){return OM(t,{count:kM()})}function OM(t,e){const n=cn(t.firestore,fr),r=zc(n),s=$O(e,(i,o)=>new mV(o,i.aggregateType,i._internalFieldPath));return gM(r,t._query,s).then(i=>function(a,l,d){const h=new df(a);return new EM(l,h,d)}(n,t,i))}function In(){return new d_("serverTimestamp")}function VM(...t){return new h_("arrayUnion",t)}function FI(t){return new f_("increment",t)}(function(e,n=!0){(function(s){Na=s})(so),dr(new Jn("firestore",(r,{instanceIdentifier:s,options:i})=>{const o=r.getProvider("app").getImmediate(),a=new fr(new Z2(r.getProvider("auth-internal")),new nO(o,r.getProvider("app-check-internal")),function(d,h){if(!Object.prototype.hasOwnProperty.apply(d.options,["projectId"]))throw new K($.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new qi(d.options.projectId,h)}(o,s),o);return i={useFetchStreams:n,...i},a._setSettings(i),a},"PUBLIC").setMultipleInstances(!0)),Rn(mE,gE,e),Rn(mE,gE,"esm2020")})();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iA="firebasestorage.googleapis.com",oA="storageBucket",LM=2*60*1e3,MM=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class St extends Zn{constructor(e,n,r=0){super(wp(e),`Firebase Storage: ${n} (${wp(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,St.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return wp(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var xt;(function(t){t.UNKNOWN="unknown",t.OBJECT_NOT_FOUND="object-not-found",t.BUCKET_NOT_FOUND="bucket-not-found",t.PROJECT_NOT_FOUND="project-not-found",t.QUOTA_EXCEEDED="quota-exceeded",t.UNAUTHENTICATED="unauthenticated",t.UNAUTHORIZED="unauthorized",t.UNAUTHORIZED_APP="unauthorized-app",t.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",t.INVALID_CHECKSUM="invalid-checksum",t.CANCELED="canceled",t.INVALID_EVENT_NAME="invalid-event-name",t.INVALID_URL="invalid-url",t.INVALID_DEFAULT_BUCKET="invalid-default-bucket",t.NO_DEFAULT_BUCKET="no-default-bucket",t.CANNOT_SLICE_BLOB="cannot-slice-blob",t.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",t.NO_DOWNLOAD_URL="no-download-url",t.INVALID_ARGUMENT="invalid-argument",t.INVALID_ARGUMENT_COUNT="invalid-argument-count",t.APP_DELETED="app-deleted",t.INVALID_ROOT_OPERATION="invalid-root-operation",t.INVALID_FORMAT="invalid-format",t.INTERNAL_ERROR="internal-error",t.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(xt||(xt={}));function wp(t){return"storage/"+t}function I_(){const t="An unknown error occurred, please check the error payload for server response.";return new St(xt.UNKNOWN,t)}function FM(t){return new St(xt.OBJECT_NOT_FOUND,"Object '"+t+"' does not exist.")}function UM(t){return new St(xt.QUOTA_EXCEEDED,"Quota for bucket '"+t+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function $M(){const t="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new St(xt.UNAUTHENTICATED,t)}function BM(){return new St(xt.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function zM(t){return new St(xt.UNAUTHORIZED,"User does not have permission to access '"+t+"'.")}function qM(){return new St(xt.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function HM(){return new St(xt.CANCELED,"User canceled the upload/download.")}function WM(t){return new St(xt.INVALID_URL,"Invalid URL '"+t+"'.")}function KM(t){return new St(xt.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}function GM(){return new St(xt.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+oA+"' property when initializing the app?")}function QM(){return new St(xt.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function YM(){return new St(xt.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function XM(t){return new St(xt.UNSUPPORTED_ENVIRONMENT,`${t} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function ag(t){return new St(xt.INVALID_ARGUMENT,t)}function aA(){return new St(xt.APP_DELETED,"The Firebase app was deleted.")}function JM(t){return new St(xt.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function zl(t,e){return new St(xt.INVALID_FORMAT,"String does not match format '"+t+"': "+e)}function cl(t){throw new St(xt.INTERNAL_ERROR,"Internal error: "+t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mn{constructor(e,n){this.bucket=e,this.path_=n}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,n){let r;try{r=mn.makeFromUrl(e,n)}catch{return new mn(e,"")}if(r.path==="")return r;throw KM(e)}static makeFromUrl(e,n){let r=null;const s="([A-Za-z0-9.\\-_]+)";function i(j){j.path.charAt(j.path.length-1)==="/"&&(j.path_=j.path_.slice(0,-1))}const o="(/(.*))?$",a=new RegExp("^gs://"+s+o,"i"),l={bucket:1,path:3};function d(j){j.path_=decodeURIComponent(j.path)}const h="v[A-Za-z0-9_]+",f=n.replace(/[.]/g,"\\."),m="(/([^?#]*).*)?$",v=new RegExp(`^https?://${f}/${h}/b/${s}/o${m}`,"i"),R={bucket:1,path:3},b=n===iA?"(?:storage.googleapis.com|storage.cloud.google.com)":n,A="([^?#]*)",I=new RegExp(`^https?://${b}/${s}/${A}`,"i"),y=[{regex:a,indices:l,postModify:i},{regex:v,indices:R,postModify:d},{regex:I,indices:{bucket:1,path:2},postModify:d}];for(let j=0;j<y.length;j++){const V=y[j],M=V.regex.exec(e);if(M){const T=M[V.indices.bucket];let _=M[V.indices.path];_||(_=""),r=new mn(T,_),V.postModify(r);break}}if(r==null)throw WM(e);return r}}class ZM{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eF(t,e,n){let r=1,s=null,i=null,o=!1,a=0;function l(){return a===2}let d=!1;function h(...A){d||(d=!0,e.apply(null,A))}function f(A){s=setTimeout(()=>{s=null,t(v,l())},A)}function m(){i&&clearTimeout(i)}function v(A,...I){if(d){m();return}if(A){m(),h.call(null,A,...I);return}if(l()||o){m(),h.call(null,A,...I);return}r<64&&(r*=2);let y;a===1?(a=2,y=0):y=(r+Math.random())*1e3,f(y)}let R=!1;function b(A){R||(R=!0,m(),!d&&(s!==null?(A||(a=2),clearTimeout(s),f(0)):A||(a=1)))}return f(0),i=setTimeout(()=>{o=!0,b(!0)},n),b}function tF(t){t(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nF(t){return t!==void 0}function rF(t){return typeof t=="object"&&!Array.isArray(t)}function T_(t){return typeof t=="string"||t instanceof String}function UI(t){return x_()&&t instanceof Blob}function x_(){return typeof Blob<"u"}function lg(t,e,n,r){if(r<e)throw ag(`Invalid value for '${t}'. Expected ${e} or greater.`);if(r>n)throw ag(`Invalid value for '${t}'. Expected ${n} or less.`)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wc(t,e,n){let r=e;return n==null&&(r=`https://${e}`),`${n}://${r}/v0${t}`}function lA(t){const e=encodeURIComponent;let n="?";for(const r in t)if(t.hasOwnProperty(r)){const s=e(r)+"="+e(t[r]);n=n+s+"&"}return n=n.slice(0,-1),n}var Oi;(function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"})(Oi||(Oi={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sF(t,e){const n=t>=500&&t<600,s=[408,429].indexOf(t)!==-1,i=e.indexOf(t)!==-1;return n||s||i}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iF{constructor(e,n,r,s,i,o,a,l,d,h,f,m=!0,v=!1){this.url_=e,this.method_=n,this.headers_=r,this.body_=s,this.successCodes_=i,this.additionalRetryCodes_=o,this.callback_=a,this.errorCallback_=l,this.timeout_=d,this.progressCallback_=h,this.connectionFactory_=f,this.retry=m,this.isUsingEmulator=v,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((R,b)=>{this.resolve_=R,this.reject_=b,this.start_()})}start_(){const e=(r,s)=>{if(s){r(!1,new Ru(!1,null,!0));return}const i=this.connectionFactory_();this.pendingConnection_=i;const o=a=>{const l=a.loaded,d=a.lengthComputable?a.total:-1;this.progressCallback_!==null&&this.progressCallback_(l,d)};this.progressCallback_!==null&&i.addUploadProgressListener(o),i.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&i.removeUploadProgressListener(o),this.pendingConnection_=null;const a=i.getErrorCode()===Oi.NO_ERROR,l=i.getStatus();if(!a||sF(l,this.additionalRetryCodes_)&&this.retry){const h=i.getErrorCode()===Oi.ABORT;r(!1,new Ru(!1,null,h));return}const d=this.successCodes_.indexOf(l)!==-1;r(!0,new Ru(d,i))})},n=(r,s)=>{const i=this.resolve_,o=this.reject_,a=s.connection;if(s.wasSuccessCode)try{const l=this.callback_(a,a.getResponse());nF(l)?i(l):i()}catch(l){o(l)}else if(a!==null){const l=I_();l.serverResponse=a.getErrorText(),this.errorCallback_?o(this.errorCallback_(a,l)):o(l)}else if(s.canceled){const l=this.appDelete_?aA():HM();o(l)}else{const l=qM();o(l)}};this.canceled_?n(!1,new Ru(!1,null,!0)):this.backoffId_=eF(e,n,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&tF(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class Ru{constructor(e,n,r){this.wasSuccessCode=e,this.connection=n,this.canceled=!!r}}function oF(t,e){e!==null&&e.length>0&&(t.Authorization="Firebase "+e)}function aF(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function lF(t,e){e&&(t["X-Firebase-GMPID"]=e)}function cF(t,e){e!==null&&(t["X-Firebase-AppCheck"]=e)}function uF(t,e,n,r,s,i,o=!0,a=!1){const l=lA(t.urlParams),d=t.url+l,h=Object.assign({},t.headers);return lF(h,e),oF(h,n),aF(h,i),cF(h,r),new iF(d,t.method,h,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,s,o,a)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dF(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function hF(...t){const e=dF();if(e!==void 0){const n=new e;for(let r=0;r<t.length;r++)n.append(t[r]);return n.getBlob()}else{if(x_())return new Blob(t);throw new St(xt.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function fF(t,e,n){return t.webkitSlice?t.webkitSlice(e,n):t.mozSlice?t.mozSlice(e,n):t.slice?t.slice(e,n):null}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pF(t){if(typeof atob>"u")throw XM("base-64");return atob(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cr={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class Ep{constructor(e,n){this.data=e,this.contentType=n||null}}function mF(t,e){switch(t){case Cr.RAW:return new Ep(cA(e));case Cr.BASE64:case Cr.BASE64URL:return new Ep(uA(t,e));case Cr.DATA_URL:return new Ep(yF(e),_F(e))}throw I_()}function cA(t){const e=[];for(let n=0;n<t.length;n++){let r=t.charCodeAt(n);if(r<=127)e.push(r);else if(r<=2047)e.push(192|r>>6,128|r&63);else if((r&64512)===55296)if(!(n<t.length-1&&(t.charCodeAt(n+1)&64512)===56320))e.push(239,191,189);else{const i=r,o=t.charCodeAt(++n);r=65536|(i&1023)<<10|o&1023,e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|r&63)}else(r&64512)===56320?e.push(239,191,189):e.push(224|r>>12,128|r>>6&63,128|r&63)}return new Uint8Array(e)}function gF(t){let e;try{e=decodeURIComponent(t)}catch{throw zl(Cr.DATA_URL,"Malformed data URL.")}return cA(e)}function uA(t,e){switch(t){case Cr.BASE64:{const s=e.indexOf("-")!==-1,i=e.indexOf("_")!==-1;if(s||i)throw zl(t,"Invalid character '"+(s?"-":"_")+"' found: is it base64url encoded?");break}case Cr.BASE64URL:{const s=e.indexOf("+")!==-1,i=e.indexOf("/")!==-1;if(s||i)throw zl(t,"Invalid character '"+(s?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let n;try{n=pF(e)}catch(s){throw s.message.includes("polyfill")?s:zl(t,"Invalid character found")}const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}class dA{constructor(e){this.base64=!1,this.contentType=null;const n=e.match(/^data:([^,]+)?,/);if(n===null)throw zl(Cr.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const r=n[1]||null;r!=null&&(this.base64=vF(r,";base64"),this.contentType=this.base64?r.substring(0,r.length-7):r),this.rest=e.substring(e.indexOf(",")+1)}}function yF(t){const e=new dA(t);return e.base64?uA(Cr.BASE64,e.rest):gF(e.rest)}function _F(t){return new dA(t).contentType}function vF(t,e){return t.length>=e.length?t.substring(t.length-e.length)===e:!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cs{constructor(e,n){let r=0,s="";UI(e)?(this.data_=e,r=e.size,s=e.type):e instanceof ArrayBuffer?(n?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),r=this.data_.length):e instanceof Uint8Array&&(n?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),r=e.length),this.size_=r,this.type_=s}size(){return this.size_}type(){return this.type_}slice(e,n){if(UI(this.data_)){const r=this.data_,s=fF(r,e,n);return s===null?null:new Cs(s)}else{const r=new Uint8Array(this.data_.buffer,e,n-e);return new Cs(r,!0)}}static getBlob(...e){if(x_()){const n=e.map(r=>r instanceof Cs?r.data_:r);return new Cs(hF.apply(null,n))}else{const n=e.map(o=>T_(o)?mF(Cr.RAW,o).data:o.data_);let r=0;n.forEach(o=>{r+=o.byteLength});const s=new Uint8Array(r);let i=0;return n.forEach(o=>{for(let a=0;a<o.length;a++)s[i++]=o[a]}),new Cs(s,!0)}}uploadData(){return this.data_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function S_(t){let e;try{e=JSON.parse(t)}catch{return null}return rF(e)?e:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wF(t){if(t.length===0)return null;const e=t.lastIndexOf("/");return e===-1?"":t.slice(0,e)}function EF(t,e){const n=e.split("/").filter(r=>r.length>0).join("/");return t.length===0?n:t+"/"+n}function hA(t){const e=t.lastIndexOf("/",t.length-2);return e===-1?t:t.slice(e+1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function IF(t,e){return e}class hn{constructor(e,n,r,s){this.server=e,this.local=n||e,this.writable=!!r,this.xform=s||IF}}let Pu=null;function TF(t){return!T_(t)||t.length<2?t:hA(t)}function fA(){if(Pu)return Pu;const t=[];t.push(new hn("bucket")),t.push(new hn("generation")),t.push(new hn("metageneration")),t.push(new hn("name","fullPath",!0));function e(i,o){return TF(o)}const n=new hn("name");n.xform=e,t.push(n);function r(i,o){return o!==void 0?Number(o):o}const s=new hn("size");return s.xform=r,t.push(s),t.push(new hn("timeCreated")),t.push(new hn("updated")),t.push(new hn("md5Hash",null,!0)),t.push(new hn("cacheControl",null,!0)),t.push(new hn("contentDisposition",null,!0)),t.push(new hn("contentEncoding",null,!0)),t.push(new hn("contentLanguage",null,!0)),t.push(new hn("contentType",null,!0)),t.push(new hn("metadata","customMetadata",!0)),Pu=t,Pu}function xF(t,e){function n(){const r=t.bucket,s=t.fullPath,i=new mn(r,s);return e._makeStorageReference(i)}Object.defineProperty(t,"ref",{get:n})}function SF(t,e,n){const r={};r.type="file";const s=n.length;for(let i=0;i<s;i++){const o=n[i];r[o.local]=o.xform(r,e[o.server])}return xF(r,t),r}function pA(t,e,n){const r=S_(e);return r===null?null:SF(t,r,n)}function bF(t,e,n,r){const s=S_(e);if(s===null||!T_(s.downloadTokens))return null;const i=s.downloadTokens;if(i.length===0)return null;const o=encodeURIComponent;return i.split(",").map(d=>{const h=t.bucket,f=t.fullPath,m="/b/"+o(h)+"/o/"+o(f),v=Wc(m,n,r),R=lA({alt:"media",token:d});return v+R})[0]}function CF(t,e){const n={},r=e.length;for(let s=0;s<r;s++){const i=e[s];i.writable&&(n[i.server]=t[i.local])}return JSON.stringify(n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $I="prefixes",BI="items";function AF(t,e,n){const r={prefixes:[],items:[],nextPageToken:n.nextPageToken};if(n[$I])for(const s of n[$I]){const i=s.replace(/\/$/,""),o=t._makeStorageReference(new mn(e,i));r.prefixes.push(o)}if(n[BI])for(const s of n[BI]){const i=t._makeStorageReference(new mn(e,s.name));r.items.push(i)}return r}function RF(t,e,n){const r=S_(n);return r===null?null:AF(t,e,r)}class ff{constructor(e,n,r,s){this.url=e,this.method=n,this.handler=r,this.timeout=s,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function b_(t){if(!t)throw I_()}function PF(t,e){function n(r,s){const i=pA(t,s,e);return b_(i!==null),i}return n}function NF(t,e){function n(r,s){const i=RF(t,e,s);return b_(i!==null),i}return n}function kF(t,e){function n(r,s){const i=pA(t,s,e);return b_(i!==null),bF(i,s,t.host,t._protocol)}return n}function C_(t){function e(n,r){let s;return n.getStatus()===401?n.getErrorText().includes("Firebase App Check token is invalid")?s=BM():s=$M():n.getStatus()===402?s=UM(t.bucket):n.getStatus()===403?s=zM(t.path):s=r,s.status=n.getStatus(),s.serverResponse=r.serverResponse,s}return e}function mA(t){const e=C_(t);function n(r,s){let i=e(r,s);return r.getStatus()===404&&(i=FM(t.path)),i.serverResponse=s.serverResponse,i}return n}function DF(t,e,n,r,s){const i={};e.isRoot?i.prefix="":i.prefix=e.path+"/",n.length>0&&(i.delimiter=n),r&&(i.pageToken=r),s&&(i.maxResults=s);const o=e.bucketOnlyServerUrl(),a=Wc(o,t.host,t._protocol),l="GET",d=t.maxOperationRetryTime,h=new ff(a,l,NF(t,e.bucket),d);return h.urlParams=i,h.errorHandler=C_(e),h}function jF(t,e,n){const r=e.fullServerUrl(),s=Wc(r,t.host,t._protocol),i="GET",o=t.maxOperationRetryTime,a=new ff(s,i,kF(t,n),o);return a.errorHandler=mA(e),a}function OF(t,e){const n=e.fullServerUrl(),r=Wc(n,t.host,t._protocol),s="DELETE",i=t.maxOperationRetryTime;function o(l,d){}const a=new ff(r,s,o,i);return a.successCodes=[200,204],a.errorHandler=mA(e),a}function VF(t,e){return t&&t.contentType||e&&e.type()||"application/octet-stream"}function LF(t,e,n){const r=Object.assign({},n);return r.fullPath=t.path,r.size=e.size(),r.contentType||(r.contentType=VF(null,e)),r}function MF(t,e,n,r,s){const i=e.bucketOnlyServerUrl(),o={"X-Goog-Upload-Protocol":"multipart"};function a(){let y="";for(let j=0;j<2;j++)y=y+Math.random().toString().slice(2);return y}const l=a();o["Content-Type"]="multipart/related; boundary="+l;const d=LF(e,r,s),h=CF(d,n),f="--"+l+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+h+`\r
--`+l+`\r
Content-Type: `+d.contentType+`\r
\r
`,m=`\r
--`+l+"--",v=Cs.getBlob(f,r,m);if(v===null)throw QM();const R={name:d.fullPath},b=Wc(i,t.host,t._protocol),A="POST",I=t.maxUploadRetryTime,w=new ff(b,A,PF(t,n),I);return w.urlParams=R,w.headers=o,w.body=v.uploadData(),w.errorHandler=C_(e),w}class FF{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=Oi.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=Oi.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=Oi.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,n,r,s,i){if(this.sent_)throw cl("cannot .send() more than once");if(ti(e)&&r&&(this.xhr_.withCredentials=!0),this.sent_=!0,this.xhr_.open(n,e,!0),i!==void 0)for(const o in i)i.hasOwnProperty(o)&&this.xhr_.setRequestHeader(o,i[o].toString());return s!==void 0?this.xhr_.send(s):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw cl("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw cl("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw cl("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw cl("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class UF extends FF{initXhr(){this.xhr_.responseType="text"}}function pf(){return new UF}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ji{constructor(e,n){this._service=e,n instanceof mn?this._location=n:this._location=mn.makeFromUrl(n,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,n){return new Ji(e,n)}get root(){const e=new mn(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return hA(this._location.path)}get storage(){return this._service}get parent(){const e=wF(this._location.path);if(e===null)return null;const n=new mn(this._location.bucket,e);return new Ji(this._service,n)}_throwIfRoot(e){if(this._location.path==="")throw JM(e)}}function $F(t,e,n){t._throwIfRoot("uploadBytes");const r=MF(t.storage,t._location,fA(),new Cs(e,!0),n);return t.storage.makeRequestWithTokens(r,pf).then(s=>({metadata:s,ref:t}))}function BF(t){const e={prefixes:[],items:[]};return gA(t,e).then(()=>e)}async function gA(t,e,n){const s=await zF(t,{pageToken:n});e.prefixes.push(...s.prefixes),e.items.push(...s.items),s.nextPageToken!=null&&await gA(t,e,s.nextPageToken)}function zF(t,e){e!=null&&typeof e.maxResults=="number"&&lg("options.maxResults",1,1e3,e.maxResults);const n=e||{},r=DF(t.storage,t._location,"/",n.pageToken,n.maxResults);return t.storage.makeRequestWithTokens(r,pf)}function qF(t){t._throwIfRoot("getDownloadURL");const e=jF(t.storage,t._location,fA());return t.storage.makeRequestWithTokens(e,pf).then(n=>{if(n===null)throw YM();return n})}function HF(t){t._throwIfRoot("deleteObject");const e=OF(t.storage,t._location);return t.storage.makeRequestWithTokens(e,pf)}function WF(t,e){const n=EF(t._location.path,e),r=new mn(t._location.bucket,n);return new Ji(t.storage,r)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function KF(t){return/^[A-Za-z]+:\/\//.test(t)}function GF(t,e){return new Ji(t,e)}function yA(t,e){if(t instanceof A_){const n=t;if(n._bucket==null)throw GM();const r=new Ji(n,n._bucket);return e!=null?yA(r,e):r}else return e!==void 0?WF(t,e):t}function QF(t,e){if(e&&KF(e)){if(t instanceof A_)return GF(t,e);throw ag("To use ref(service, url), the first argument must be a Storage instance.")}else return yA(t,e)}function zI(t,e){const n=e==null?void 0:e[oA];return n==null?null:mn.makeFromBucketSpec(n,t)}function YF(t,e,n,r={}){t.host=`${e}:${n}`;const s=ti(e);s&&(dy(`https://${t.host}/b`),hy("Storage",!0)),t._isUsingEmulator=!0,t._protocol=s?"https":"http";const{mockUserToken:i}=r;i&&(t._overrideAuthToken=typeof i=="string"?i:Jx(i,t.app.options.projectId))}class A_{constructor(e,n,r,s,i,o=!1){this.app=e,this._authProvider=n,this._appCheckProvider=r,this._url=s,this._firebaseVersion=i,this._isUsingEmulator=o,this._bucket=null,this._host=iA,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=LM,this._maxUploadRetryTime=MM,this._requests=new Set,s!=null?this._bucket=mn.makeFromBucketSpec(s,this._host):this._bucket=zI(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=mn.makeFromBucketSpec(this._url,e):this._bucket=zI(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){lg("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){lg("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const n=await e.getToken();if(n!==null)return n.accessToken}return null}async _getAppCheckToken(){if(zn(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Ji(this,e)}_makeRequest(e,n,r,s,i=!0){if(this._deleted)return new ZM(aA());{const o=uF(e,this._appId,r,s,n,this._firebaseVersion,i,this._isUsingEmulator);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}async makeRequestWithTokens(e,n){const[r,s]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,n,r,s).getPromise()}}const qI="@firebase/storage",HI="0.14.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _A="storage";function WI(t,e,n){return t=Qe(t),$F(t,e,n)}function KI(t){return t=Qe(t),BF(t)}function GI(t){return t=Qe(t),qF(t)}function Ip(t){return t=Qe(t),HF(t)}function ul(t,e){return t=Qe(t),QF(t,e)}function Ii(t=kh(),e){t=Qe(t);const r=ni(t,_A).getImmediate({identifier:e}),s=Qx("storage");return s&&XF(r,...s),r}function XF(t,e,n,r={}){YF(t,e,n,r)}function JF(t,{instanceIdentifier:e}){const n=t.getProvider("app").getImmediate(),r=t.getProvider("auth-internal"),s=t.getProvider("app-check-internal");return new A_(n,r,s,e,so)}function ZF(){dr(new Jn(_A,JF,"PUBLIC").setMultipleInstances(!0)),Rn(qI,HI,""),Rn(qI,HI,"esm2020")}ZF();const e4={apiKey:"AIzaSyC70mGCRrjE8iOap8iTHuid8HEuyadue8Y",authDomain:"odontocloud-d92ac.firebaseapp.com",projectId:"odontocloud-d92ac",storageBucket:"odontocloud-d92ac.firebasestorage.app",messagingSenderId:"267020714981",appId:"1:267020714981:web:a44416ea83aa1d1172650c",measurementId:"G-ZMCC5CFY0C"},R_=my(e4),QI=zS(R_),YI=qC(R_);Ii(R_);const t4="/odontocloud-react/assets/fondo.png",vA="/odontocloud-react/assets/logo.png",XI=(t,e)=>{const n={email:t,rol:e,timestamp:Date.now()};localStorage.setItem("odc_session",JSON.stringify(n))},Tp=()=>{try{const t=JSON.parse(localStorage.getItem("odc_session"));return t&&Date.now()-t.timestamp<1e3*60*60*24?t:null}catch{return null}},n4=()=>{const t=Ac(),[e,n]=N.useState(""),[r,s]=N.useState(""),[i,o]=N.useState(""),[a,l]=N.useState(navigator.onLine);N.useEffect(()=>{const f=()=>l(!0),m=()=>l(!1);return window.addEventListener("online",f),window.addEventListener("offline",m),()=>{window.removeEventListener("online",f),window.removeEventListener("offline",m)}},[]);const d=f=>{const m=(f||"").toLowerCase();m==="administrador"?t("/dashboard_admin",{replace:!0}):m==="doctor"?t("/dashboard_doctor",{replace:!0}):m==="recepcionista"?t("/dashboard_recepcion",{replace:!0}):o("Rol no reconocido. Contacte al administrador.")};N.useEffect(()=>{if(!navigator.onLine){const m=Tp();m!=null&&m.rol?d(m.rol):o("Sin conexin y no hay sesin guardada.");return}const f=Iy(QI,async m=>{if(m){const v=Tp();if(v!=null&&v.rol){d(v.rol);return}try{const R=rt(Ue(YI,"users"),Je("correo","==",m.email||"")),b=await Yt(R);if(!b.empty){const A=b.docs[0].data().rol||"sin_rol";XI(m.email||"",A),d(A)}}catch{d("administrador")}}});return()=>f()},[]);const h=async f=>{if(f.preventDefault(),o(""),!a){const m=Tp();m!=null&&m.rol?d(m.rol):o("Sin conexin y no hay sesin guardada.");return}try{const v=(await Vj(QI,e,r)).user,R=rt(Ue(YI,"users"),Je("correo","==",e)),b=await Yt(R);if(b.empty){o("Usuario no encontrado en la base de datos.");return}const I=b.docs[0].data().rol||"sin_rol";XI(e,I),d(I)}catch(m){switch(console.error("Error login:",m),m.code){case"auth/user-not-found":o("Usuario no registrado.");break;case"auth/wrong-password":o("Contrasea incorrecta.");break;case"auth/invalid-email":o("Correo no vlido.");break;case"auth/network-request-failed":o("Sin conexin. Usa la sesin guardada o reconecta.");break;default:o("Error al iniciar sesin.")}}};return u.jsx("div",{className:"login-root",style:{backgroundImage:`url(${t4})`,backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat",backgroundAttachment:"fixed",width:"100vw",height:"100vh",display:"flex",justifyContent:"center",alignItems:"center",overflow:"hidden"},children:u.jsxs("div",{className:"container",children:[u.jsxs("div",{className:"left-panel",children:[u.jsx("img",{src:vA,alt:"OdontoCloud Logo",className:"logo"}),u.jsxs("h2",{children:["Su clnica, ",u.jsx("br",{})," ms conectada."]}),u.jsx("p",{children:"OdontoCloud optimiza cada detalle de su gestin."})]}),u.jsxs("div",{className:"right-panel",children:[u.jsx("h3",{children:"Acceso a la plataforma"}),u.jsxs("form",{onSubmit:h,children:[u.jsx("input",{type:"email",placeholder:"usuario@ejemplo.com",value:e,onChange:f=>n(f.target.value),required:a}),u.jsx("input",{type:"password",placeholder:"Contrasea",value:r,onChange:f=>s(f.target.value),required:a}),u.jsx("button",{type:"submit",children:a?"Iniciar sesin":"Entrar (modo offline)"}),i&&u.jsx("p",{style:{color:"red",marginTop:10},children:i}),!a&&u.jsx("p",{style:{color:"orange",marginTop:10},children:" Modo offline activado"})]})]})]})})},wA="@firebase/installations",P_="0.6.19";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EA=1e4,IA=`w:${P_}`,TA="FIS_v2",r4="https://firebaseinstallations.googleapis.com/v1",s4=60*60*1e3,i4="installations",o4="Installations";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const a4={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},Zi=new ro(i4,o4,a4);function xA(t){return t instanceof Zn&&t.code.includes("request-failed")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function SA({projectId:t}){return`${r4}/projects/${t}/installations`}function bA(t){return{token:t.token,requestStatus:2,expiresIn:c4(t.expiresIn),creationTime:Date.now()}}async function CA(t,e){const r=(await e.json()).error;return Zi.create("request-failed",{requestName:t,serverCode:r.code,serverMessage:r.message,serverStatus:r.status})}function AA({apiKey:t}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t})}function l4(t,{refreshToken:e}){const n=AA(t);return n.append("Authorization",u4(e)),n}async function RA(t){const e=await t();return e.status>=500&&e.status<600?t():e}function c4(t){return Number(t.replace("s","000"))}function u4(t){return`${TA} ${t}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function d4({appConfig:t,heartbeatServiceProvider:e},{fid:n}){const r=SA(t),s=AA(t),i=e.getImmediate({optional:!0});if(i){const d=await i.getHeartbeatsHeader();d&&s.append("x-firebase-client",d)}const o={fid:n,authVersion:TA,appId:t.appId,sdkVersion:IA},a={method:"POST",headers:s,body:JSON.stringify(o)},l=await RA(()=>fetch(r,a));if(l.ok){const d=await l.json();return{fid:d.fid||n,registrationStatus:2,refreshToken:d.refreshToken,authToken:bA(d.authToken)}}else throw await CA("Create Installation",l)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PA(t){return new Promise(e=>{setTimeout(e,t)})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function h4(t){return btoa(String.fromCharCode(...t)).replace(/\+/g,"-").replace(/\//g,"_")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const f4=/^[cdef][\w-]{21}$/,cg="";function p4(){try{const t=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(t),t[0]=112+t[0]%16;const n=m4(t);return f4.test(n)?n:cg}catch{return cg}}function m4(t){return h4(t).substr(0,22)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mf(t){return`${t.appName}!${t.appId}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NA=new Map;function kA(t,e){const n=mf(t);DA(n,e),g4(n,e)}function DA(t,e){const n=NA.get(t);if(n)for(const r of n)r(e)}function g4(t,e){const n=y4();n&&n.postMessage({key:t,fid:e}),_4()}let Ci=null;function y4(){return!Ci&&"BroadcastChannel"in self&&(Ci=new BroadcastChannel("[Firebase] FID Change"),Ci.onmessage=t=>{DA(t.data.key,t.data.fid)}),Ci}function _4(){NA.size===0&&Ci&&(Ci.close(),Ci=null)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const v4="firebase-installations-database",w4=1,eo="firebase-installations-store";let xp=null;function N_(){return xp||(xp=oS(v4,w4,{upgrade:(t,e)=>{switch(e){case 0:t.createObjectStore(eo)}}})),xp}async function ch(t,e){const n=mf(t),s=(await N_()).transaction(eo,"readwrite"),i=s.objectStore(eo),o=await i.get(n);return await i.put(e,n),await s.done,(!o||o.fid!==e.fid)&&kA(t,e.fid),e}async function jA(t){const e=mf(t),r=(await N_()).transaction(eo,"readwrite");await r.objectStore(eo).delete(e),await r.done}async function gf(t,e){const n=mf(t),s=(await N_()).transaction(eo,"readwrite"),i=s.objectStore(eo),o=await i.get(n),a=e(o);return a===void 0?await i.delete(n):await i.put(a,n),await s.done,a&&(!o||o.fid!==a.fid)&&kA(t,a.fid),a}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function k_(t){let e;const n=await gf(t.appConfig,r=>{const s=E4(r),i=I4(t,s);return e=i.registrationPromise,i.installationEntry});return n.fid===cg?{installationEntry:await e}:{installationEntry:n,registrationPromise:e}}function E4(t){const e=t||{fid:p4(),registrationStatus:0};return OA(e)}function I4(t,e){if(e.registrationStatus===0){if(!navigator.onLine){const s=Promise.reject(Zi.create("app-offline"));return{installationEntry:e,registrationPromise:s}}const n={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},r=T4(t,n);return{installationEntry:n,registrationPromise:r}}else return e.registrationStatus===1?{installationEntry:e,registrationPromise:x4(t)}:{installationEntry:e}}async function T4(t,e){try{const n=await d4(t,e);return ch(t.appConfig,n)}catch(n){throw xA(n)&&n.customData.serverCode===409?await jA(t.appConfig):await ch(t.appConfig,{fid:e.fid,registrationStatus:0}),n}}async function x4(t){let e=await JI(t.appConfig);for(;e.registrationStatus===1;)await PA(100),e=await JI(t.appConfig);if(e.registrationStatus===0){const{installationEntry:n,registrationPromise:r}=await k_(t);return r||n}return e}function JI(t){return gf(t,e=>{if(!e)throw Zi.create("installation-not-found");return OA(e)})}function OA(t){return S4(t)?{fid:t.fid,registrationStatus:0}:t}function S4(t){return t.registrationStatus===1&&t.registrationTime+EA<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function b4({appConfig:t,heartbeatServiceProvider:e},n){const r=C4(t,n),s=l4(t,n),i=e.getImmediate({optional:!0});if(i){const d=await i.getHeartbeatsHeader();d&&s.append("x-firebase-client",d)}const o={installation:{sdkVersion:IA,appId:t.appId}},a={method:"POST",headers:s,body:JSON.stringify(o)},l=await RA(()=>fetch(r,a));if(l.ok){const d=await l.json();return bA(d)}else throw await CA("Generate Auth Token",l)}function C4(t,{fid:e}){return`${SA(t)}/${e}/authTokens:generate`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function D_(t,e=!1){let n;const r=await gf(t.appConfig,i=>{if(!VA(i))throw Zi.create("not-registered");const o=i.authToken;if(!e&&P4(o))return i;if(o.requestStatus===1)return n=A4(t,e),i;{if(!navigator.onLine)throw Zi.create("app-offline");const a=k4(i);return n=R4(t,a),a}});return n?await n:r.authToken}async function A4(t,e){let n=await ZI(t.appConfig);for(;n.authToken.requestStatus===1;)await PA(100),n=await ZI(t.appConfig);const r=n.authToken;return r.requestStatus===0?D_(t,e):r}function ZI(t){return gf(t,e=>{if(!VA(e))throw Zi.create("not-registered");const n=e.authToken;return D4(n)?{...e,authToken:{requestStatus:0}}:e})}async function R4(t,e){try{const n=await b4(t,e),r={...e,authToken:n};return await ch(t.appConfig,r),n}catch(n){if(xA(n)&&(n.customData.serverCode===401||n.customData.serverCode===404))await jA(t.appConfig);else{const r={...e,authToken:{requestStatus:0}};await ch(t.appConfig,r)}throw n}}function VA(t){return t!==void 0&&t.registrationStatus===2}function P4(t){return t.requestStatus===2&&!N4(t)}function N4(t){const e=Date.now();return e<t.creationTime||t.creationTime+t.expiresIn<e+s4}function k4(t){const e={requestStatus:1,requestTime:Date.now()};return{...t,authToken:e}}function D4(t){return t.requestStatus===1&&t.requestTime+EA<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function j4(t){const e=t,{installationEntry:n,registrationPromise:r}=await k_(e);return r?r.catch(console.error):D_(e).catch(console.error),n.fid}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function O4(t,e=!1){const n=t;return await V4(n),(await D_(n,e)).token}async function V4(t){const{registrationPromise:e}=await k_(t);e&&await e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function L4(t){if(!t||!t.options)throw Sp("App Configuration");if(!t.name)throw Sp("App Name");const e=["projectId","apiKey","appId"];for(const n of e)if(!t.options[n])throw Sp(n);return{appName:t.name,projectId:t.options.projectId,apiKey:t.options.apiKey,appId:t.options.appId}}function Sp(t){return Zi.create("missing-app-config-values",{valueName:t})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LA="installations",M4="installations-internal",F4=t=>{const e=t.getProvider("app").getImmediate(),n=L4(e),r=ni(e,"heartbeat");return{app:e,appConfig:n,heartbeatServiceProvider:r,_delete:()=>Promise.resolve()}},U4=t=>{const e=t.getProvider("app").getImmediate(),n=ni(e,LA).getImmediate();return{getId:()=>j4(n),getToken:s=>O4(n,s)}};function $4(){dr(new Jn(LA,F4,"PUBLIC")),dr(new Jn(M4,U4,"PRIVATE"))}$4();Rn(wA,P_);Rn(wA,P_,"esm2020");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uh="analytics",B4="firebase_id",z4="origin",q4=60*1e3,H4="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",j_="https://www.googletagmanager.com/gtag/js";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _n=new Nh("@firebase/analytics");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const W4={"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-initialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."},Vn=new ro("analytics","Analytics",W4);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function K4(t){if(!t.startsWith(j_)){const e=Vn.create("invalid-gtag-resource",{gtagURL:t});return _n.warn(e.message),""}return t}function MA(t){return Promise.all(t.map(e=>e.catch(n=>n)))}function G4(t,e){let n;return window.trustedTypes&&(n=window.trustedTypes.createPolicy(t,e)),n}function Q4(t,e){const n=G4("firebase-js-sdk-policy",{createScriptURL:K4}),r=document.createElement("script"),s=`${j_}?l=${t}&id=${e}`;r.src=n?n==null?void 0:n.createScriptURL(s):s,r.async=!0,document.head.appendChild(r)}function Y4(t){let e=[];return Array.isArray(window[t])?e=window[t]:window[t]=e,e}async function X4(t,e,n,r,s,i){const o=r[s];try{if(o)await e[o];else{const l=(await MA(n)).find(d=>d.measurementId===s);l&&await e[l.appId]}}catch(a){_n.error(a)}t("config",s,i)}async function J4(t,e,n,r,s){try{let i=[];if(s&&s.send_to){let o=s.send_to;Array.isArray(o)||(o=[o]);const a=await MA(n);for(const l of o){const d=a.find(f=>f.measurementId===l),h=d&&e[d.appId];if(h)i.push(h);else{i=[];break}}}i.length===0&&(i=Object.values(e)),await Promise.all(i),t("event",r,s||{})}catch(i){_n.error(i)}}function Z4(t,e,n,r){async function s(i,...o){try{if(i==="event"){const[a,l]=o;await J4(t,e,n,a,l)}else if(i==="config"){const[a,l]=o;await X4(t,e,n,r,a,l)}else if(i==="consent"){const[a,l]=o;t("consent",a,l)}else if(i==="get"){const[a,l,d]=o;t("get",a,l,d)}else if(i==="set"){const[a]=o;t("set",a)}else t(i,...o)}catch(a){_n.error(a)}}return s}function eU(t,e,n,r,s){let i=function(...o){window[r].push(arguments)};return window[s]&&typeof window[s]=="function"&&(i=window[s]),window[s]=Z4(i,t,e,n),{gtagCore:i,wrappedGtag:window[s]}}function tU(t){const e=window.document.getElementsByTagName("script");for(const n of Object.values(e))if(n.src&&n.src.includes(j_)&&n.src.includes(t))return n;return null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nU=30,rU=1e3;class sU{constructor(e={},n=rU){this.throttleMetadata=e,this.intervalMillis=n}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,n){this.throttleMetadata[e]=n}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}}const FA=new sU;function iU(t){return new Headers({Accept:"application/json","x-goog-api-key":t})}async function oU(t){var o;const{appId:e,apiKey:n}=t,r={method:"GET",headers:iU(n)},s=H4.replace("{app-id}",e),i=await fetch(s,r);if(i.status!==200&&i.status!==304){let a="";try{const l=await i.json();(o=l.error)!=null&&o.message&&(a=l.error.message)}catch{}throw Vn.create("config-fetch-failed",{httpStatus:i.status,responseMessage:a})}return i.json()}async function aU(t,e=FA,n){const{appId:r,apiKey:s,measurementId:i}=t.options;if(!r)throw Vn.create("no-app-id");if(!s){if(i)return{measurementId:i,appId:r};throw Vn.create("no-api-key")}const o=e.getThrottleMetadata(r)||{backoffCount:0,throttleEndTimeMillis:Date.now()},a=new uU;return setTimeout(async()=>{a.abort()},q4),UA({appId:r,apiKey:s,measurementId:i},o,a,e)}async function UA(t,{throttleEndTimeMillis:e,backoffCount:n},r,s=FA){var a;const{appId:i,measurementId:o}=t;try{await lU(r,e)}catch(l){if(o)return _n.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${o} provided in the "measurementId" field in the local Firebase config. [${l==null?void 0:l.message}]`),{appId:i,measurementId:o};throw l}try{const l=await oU(t);return s.deleteThrottleMetadata(i),l}catch(l){const d=l;if(!cU(d)){if(s.deleteThrottleMetadata(i),o)return _n.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${o} provided in the "measurementId" field in the local Firebase config. [${d==null?void 0:d.message}]`),{appId:i,measurementId:o};throw l}const h=Number((a=d==null?void 0:d.customData)==null?void 0:a.httpStatus)===503?Fw(n,s.intervalMillis,nU):Fw(n,s.intervalMillis),f={throttleEndTimeMillis:Date.now()+h,backoffCount:n+1};return s.setThrottleMetadata(i,f),_n.debug(`Calling attemptFetch again in ${h} millis`),UA(t,f,r,s)}}function lU(t,e){return new Promise((n,r)=>{const s=Math.max(e-Date.now(),0),i=setTimeout(n,s);t.addEventListener(()=>{clearTimeout(i),r(Vn.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}function cU(t){if(!(t instanceof Zn)||!t.customData)return!1;const e=Number(t.customData.httpStatus);return e===429||e===500||e===503||e===504}class uU{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach(e=>e())}}async function dU(t,e,n,r,s){if(s&&s.global){t("event",n,r);return}else{const i=await e,o={...r,send_to:i};t("event",n,o)}}async function hU(t,e,n,r){if(r&&r.global){const s={};for(const i of Object.keys(n))s[`user_properties.${i}`]=n[i];return t("set",s),Promise.resolve()}else{const s=await e;t("config",s,{update:!0,user_properties:n})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function fU(){if(fy())try{await rS()}catch(t){return _n.warn(Vn.create("indexeddb-unavailable",{errorInfo:t==null?void 0:t.toString()}).message),!1}else return _n.warn(Vn.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;return!0}async function pU(t,e,n,r,s,i,o){const a=aU(t);a.then(m=>{n[m.measurementId]=m.appId,t.options.measurementId&&m.measurementId!==t.options.measurementId&&_n.warn(`The measurement ID in the local Firebase config (${t.options.measurementId}) does not match the measurement ID fetched from the server (${m.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(m=>_n.error(m)),e.push(a);const l=fU().then(m=>{if(m)return r.getId()}),[d,h]=await Promise.all([a,l]);tU(i)||Q4(i,d.measurementId),s("js",new Date);const f=(o==null?void 0:o.config)??{};return f[z4]="firebase",f.update=!0,h!=null&&(f[B4]=h),s("config",d.measurementId,f),d.measurementId}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mU{constructor(e){this.app=e}_delete(){return delete ta[this.app.options.appId],Promise.resolve()}}let ta={},eT=[];const tT={};let bp="dataLayer",gU="gtag",nT,O_,rT=!1;function yU(){const t=[];if(eS()&&t.push("This is a browser extension environment."),_k()||t.push("Cookies are not available."),t.length>0){const e=t.map((r,s)=>`(${s+1}) ${r}`).join(" "),n=Vn.create("invalid-analytics-context",{errorInfo:e});_n.warn(n.message)}}function _U(t,e,n){yU();const r=t.options.appId;if(!r)throw Vn.create("no-app-id");if(!t.options.apiKey)if(t.options.measurementId)_n.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${t.options.measurementId} provided in the "measurementId" field in the local Firebase config.`);else throw Vn.create("no-api-key");if(ta[r]!=null)throw Vn.create("already-exists",{id:r});if(!rT){Y4(bp);const{wrappedGtag:i,gtagCore:o}=eU(ta,eT,tT,bp,gU);O_=i,nT=o,rT=!0}return ta[r]=pU(t,eT,tT,e,nT,bp,n),new mU(t)}function vU(t=kh()){t=Qe(t);const e=ni(t,uh);return e.isInitialized()?e.getImmediate():wU(t)}function wU(t,e={}){const n=ni(t,uh);if(n.isInitialized()){const s=n.getImmediate();if(Xr(e,n.getOptions()))return s;throw Vn.create("already-initialized")}return n.initialize({options:e})}function EU(t,e,n){t=Qe(t),hU(O_,ta[t.app.options.appId],e,n).catch(r=>_n.error(r))}function IU(t,e,n,r){t=Qe(t),dU(O_,ta[t.app.options.appId],e,n,r).catch(s=>_n.error(s))}const sT="@firebase/analytics",iT="0.10.19";function TU(){dr(new Jn(uh,(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("installations-internal").getImmediate();return _U(r,s,n)},"PUBLIC")),dr(new Jn("analytics-internal",t,"PRIVATE")),Rn(sT,iT),Rn(sT,iT,"esm2020");function t(e){try{const n=e.getProvider(uh).getImmediate();return{logEvent:(r,s,i)=>IU(n,r,s,i),setUserProperties:(r,s)=>EU(n,r,s)}}catch(n){throw Vn.create("interop-component-reg-failed",{reason:n})}}}TU();const xU={apiKey:"AIzaSyC70mGCRrjE8iOap8iTHuid8HEuyadue8Y",authDomain:"odontocloud-d92ac.firebaseapp.com",projectId:"odontocloud-d92ac",storageBucket:"odontocloud-d92ac.firebasestorage.app",messagingSenderId:"267020714981",appId:"1:267020714981:web:a44416ea83aa1d1172650c",measurementId:"G-ZMCC5CFY0C"},yf=my(xU),dh=zS(yf),_e=qC(yf);Ii(yf);vU(yf);const Cp="TU EMPRESA S.A.S.",SU="Generado por OdontoCloud",Nu=()=>{const t=new Date;return t.setHours(0,0,0,0),t},hi=t=>{const e=new Date(t);return e.setHours(0,0,0,0),e},Ap=t=>{const e=new Date(t);return e.setHours(23,59,59,999),e},wr=(t,e)=>{const n=new Date(t);return n.setDate(n.getDate()+e),n},oT=t=>{const e=new Date(t),n=e.getDay(),r=(n===0?-6:1)-n;return e.setDate(e.getDate()+r),e.setHours(0,0,0,0),e},aT=(t,e)=>t.getFullYear()===e.getFullYear()&&t.getMonth()===e.getMonth()&&t.getDate()===e.getDate();var fT;const En=typeof navigator<"u"&&((fT=navigator.language)!=null&&fT.startsWith("es"))?"es-ES":"en-US",Rp=t=>{const e=t.getFullYear(),n=String(t.getMonth()+1).padStart(2,"0"),r=String(t.getDate()).padStart(2,"0");return`${e}-${n}-${r}`},_o=t=>(t||"").toString().toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/\s+/g," ").trim();function bU(){const[t,e]=N.useState("day"),[n,r]=N.useState(Nu()),[s,i]=N.useState(Nu()),[o,a]=N.useState(!0),[l,d]=N.useState([]),[h,f]=N.useState(""),[m,v]=N.useState(""),[R,b]=N.useState("");N.useEffect(()=>{a(!0);const z=Ue(_e,"citas"),ne=rt(z,Xt("fecha","asc")),he=ir(ne,Ie=>{const xe=Ie.docs.map(be=>{const re=be.data(),Oe=re.horaInicio||re.hora||"00:00",[it="0",Ge="0"]=Oe.split(":"),pt=parseInt(it,10)||0,q=parseInt(Ge,10)||0;let se;if(re.fecha&&re.fecha.toDate)se=re.fecha.toDate(),se.setHours(pt,q,0,0);else if(typeof re.fecha=="string"){const[fe,Ce,we]=re.fecha.split("-");se=new Date(parseInt(fe,10),parseInt(Ce,10)-1,parseInt(we,10),pt,q,0,0)}else re.fecha instanceof Date?(se=new Date(re.fecha),se.setHours(pt,q,0,0)):(se=new Date,se.setHours(pt,q,0,0));const X=re.documentoPaciente||re.docPaciente||re.pacienteDocumento||re.documento||"",Q=re.celularPaciente||re.telefonoPaciente||re.celular||re.telefono||"";return{id:be.id,raw:re,fecha:se,horaInicio:Oe,paciente:re.paciente||re.pacienteNombre||"Sin nombre",doctor:re.doctor||re.doctorNombre||"",sucursal:re.sucursal||"",espacio:re.espacio||re.consultorio||"",comentario:re.comentario||"",estado:re.estado||"En espera",recordatorio:re.recordatorio||"",documento:X,telefono:Q}});let ke,ye;if(t==="day")ke=hi(n),ye=Ap(n);else if(t==="week"){const be=oT(n),re=wr(be,6);ke=hi(be),ye=Ap(re)}else{const be=hi(n),re=wr(be,-30),Oe=wr(be,60);ke=hi(re),ye=Ap(Oe)}const Xe=xe.filter(be=>be.fecha>=ke&&be.fecha<=ye);d(Xe),a(!1)},Ie=>{console.error("Error leyendo citas:",Ie),d([]),a(!1)});return()=>he()},[t,n]);const A=N.useMemo(()=>{const z=new Set;return l.forEach(ne=>ne.sucursal&&z.add(ne.sucursal)),Array.from(z)},[l]),I=N.useMemo(()=>{const z=new Set;return l.forEach(ne=>ne.doctor&&z.add(ne.doctor)),Array.from(z)},[l]),w=N.useMemo(()=>{const z=R.trim().toLowerCase();return l.filter(ne=>{if(h&&ne.sucursal!==h||m&&ne.doctor!==m)return!1;if(!z)return!0;const he=[ne.paciente,ne.doctor,ne.comentario,ne.documento,ne.sucursal,ne.espacio,ne.estado],Ie=ne.raw?JSON.stringify(ne.raw):"";return[...he,Ie].filter(Boolean).some(ke=>String(ke).toLowerCase().includes(z))})},[l,h,m,R]),y=N.useMemo(()=>o?"Ocupacin: cargando...":w.length===0?"Ocupacin: sin citas para el rango seleccionado.":`Ocupacin: ${w.length} cita${w.length!==1?"s":""} en el rango actual.`,[w,o]),j=N.useMemo(()=>{const z=new Date(s.getFullYear(),s.getMonth(),1),ne=(z.getDay()+6)%7,he=new Date(z);he.setDate(he.getDate()-ne);const Ie=[];for(let xe=0;xe<6;xe++){const ke=[];for(let ye=0;ye<7;ye++){const Xe=new Date(he),be=Xe.getMonth()===s.getMonth(),re=aT(Xe,Nu()),Oe=aT(Xe,n);ke.push({date:Xe,isCurrentMonth:be,isToday:re,isSelected:Oe}),he.setDate(he.getDate()+1)}Ie.push(ke)}return Ie},[s,n]),V=()=>{const z=new Date(s);z.setMonth(z.getMonth()-1),i(z)},M=()=>{const z=new Date(s);z.setMonth(z.getMonth()+1),i(z)},T=z=>{r(hi(z)),i(hi(z)),e("day")},_=N.useMemo(()=>s.toLocaleDateString(En,{month:"long",year:"numeric"}),[s]),S=N.useMemo(()=>{if(t==="day")return n.toLocaleDateString(En,{weekday:"long",day:"2-digit",month:"long",year:"numeric"});if(t==="week"){const z=oT(n),ne=wr(z,6);return z.toLocaleDateString(En,{day:"2-digit",month:"short"})+" - "+ne.toLocaleDateString(En,{day:"2-digit",month:"short",year:"numeric"})}return"ltimas citas (detalle)"},[t,n]),C=()=>{r(t==="day"?wr(n,-1):t==="week"?wr(n,-7):wr(n,-1))},k=()=>{r(t==="day"?wr(n,1):t==="week"?wr(n,7):wr(n,1))},D=()=>{const z=Nu();r(z),i(z),e("day")},P=()=>{var it,Ge,pt;const z=q=>String(q??"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),ne=((it=document.querySelector('meta[name="company-name"]'))==null?void 0:it.getAttribute("content"))||Cp,he=((Ge=document.querySelector('meta[name="company-logo"]'))==null?void 0:Ge.getAttribute("content"))||"",Ie="Generado por OdontoCloud",xe=w.length===0?'<tr><td colspan="6" style="padding:8px 6px;color:#6b7280">No hay citas registradas para este rango.</td></tr>':w.map(q=>{const se=q.fecha.toLocaleDateString(En),X=q.fecha.toLocaleTimeString(En,{hour:"2-digit",minute:"2-digit",hour12:!0});return`<tr>
              <td>${z(se)}</td>
              <td>${z(X)}</td>
              <td>${z(q.paciente)}</td>
              <td>${z(q.doctor)}</td>
              <td>${z(q.espacio)}</td>
              <td>${z(q.comentario)}</td>
            </tr>`}).join(""),ye=`<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>Imprimir  ${z(ne)}</title>
  <style>
    @page { size: A4 portrait; margin: 18mm; }
    body { font-family: Segoe UI, Roboto, Arial, sans-serif; color:#0f172a; }
    .hdr { display:flex; align-items:center; gap:12px; border-bottom:2px solid #e5e7eb; padding-bottom:8px; margin-bottom:12px; }
    .brand { font-size:18px; font-weight:700; color:#0a86d8; line-height:1.1; }
    .sub { font-size:12px; color:#6b7280; }
    table { width:100%; border-collapse:collapse; font-size:12px; }
    th { text-align:left; background:#f3f4f6; border-bottom:1px solid #e5e7eb; padding:8px 6px; }
    td { border-bottom:1px solid #f1f5f9; padding:7px 6px; vertical-align:top; }
    .note { margin-top:8px; font-size:10px; color:#9ca3af; }
    tr, .hdr { page-break-inside: avoid; }
  </style>
</head>
<body>
  <div class="hdr">
    ${he?`<img src="${he}" alt="Logo" style="height:36px;object-fit:contain">`:""}
    <div>
      <div class="brand">${z(ne)}</div>
      <div class="sub">Agenda de citas  ${z(S)}</div>
    </div>
  </div>

  <table>
    <thead>
      <tr>
        <th style="width:18%">Fecha</th>
        <th style="width:10%">Hora</th>
        <th style="width:22%">Paciente</th>
        <th style="width:20%">Doctor</th>
        <th style="width:15%">Espacio</th>
        <th>Comentario</th>
      </tr>
    </thead>
    <tbody>${xe}</tbody>
  </table>

  <div class="note">${z(Ie)}. ${z(new Date().toLocaleString(En))}</div>
  <script>
    // Imprimir cuando termine de cargar la pestaa (incluye el logo)
    window.addEventListener('load', function() {
      try { window.focus(); window.print(); } catch (e) {}
    });
  <\/script>
</body>
</html>`,Xe=new Blob([ye],{type:"text/html;charset=utf-8"}),be=URL.createObjectURL(Xe),re=window.open(be,"_blank","noopener,noreferrer,width=900,height=700");if(!re){alert("El navegador bloque la ventana de impresin. Permite pop-ups para este sitio."),URL.revokeObjectURL(be);return}const Oe=()=>{try{URL.revokeObjectURL(be)}catch{}};(pt=re.addEventListener)==null||pt.call(re,"load",Oe),setTimeout(Oe,15e3)},Y=()=>alert("Funcin de confirmar citas se integrar con n8n / correo."),Ye=()=>D(),Lt=()=>{if(w.length===0){alert("No hay citas para exportar.");return}const z=[`Empresa: ${Cp}`],ne=["Fecha","Hora","Paciente","Doctor","Espacio","Comentario"],he=w.map(re=>{const Oe=re.fecha.toLocaleDateString(En),it=re.fecha.toLocaleTimeString(En,{hour:"2-digit",minute:"2-digit",hour12:!0});return[Oe,it,re.paciente||"",re.doctor||"",re.espacio||"",(re.comentario||"").replace(/\r?\n/g," ")]}),Ie=[SU],xe=[z,[],ne,...he,[],Ie].map(re=>(re||[]).map(Oe=>`"${String(Oe??"").replace(/"/g,'""')}"`).join(",")).join(`
`),ke=`citas_${Cp.toLowerCase().replace(/\s+/g,"_")}_${Rp(hi(n))}`+(t==="week"?"_semana":t==="detail"?"_detalle":"")+".csv",ye=new Blob(["\uFEFF"+xe],{type:"text/csv;charset=utf-8;"}),Xe=URL.createObjectURL(ye),be=document.createElement("a");be.href=Xe,be.download=ke,be.click(),URL.revokeObjectURL(Xe)},en=async(z,ne)=>{try{const he=zt(_e,"citas",z);await ea(he,{estado:ne})}catch(he){console.error("Error actualizando estado:",he),alert("No se pudo actualizar el estado de la cita.")}},J=(z,ne)=>{if(!z){alert("Este paciente no tiene celular registrado.");return}const he=String(z).replace(/\D/g,""),Ie=ne.fecha.toLocaleDateString(En),xe=ne.fecha.toLocaleTimeString(En,{hour:"numeric",minute:"2-digit",hour12:!0}),ke=encodeURIComponent(`Hola ${ne.paciente}, le recordamos su cita odontolgica el ${Ie} a las ${xe}. Por favor confirme su asistencia.`),ye=`https://wa.me/${he}?text=${ke}`;window.open(ye,"_blank")},de=async z=>{if(window.confirm(`Seguro que deseas eliminar la cita de ${z.paciente} del ${z.fecha.toLocaleDateString(En)}?`))try{const he=zt(_e,"citas",z.id);await rA(he)}catch(he){console.error("Error eliminando cita:",he),alert(" No se pudo eliminar la cita.")}},G=()=>{const z=document.createElement("div");Object.assign(z.style,{position:"fixed",top:"0",left:"0",width:"100%",height:"100%",background:"rgba(0,0,0,0.55)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:"9999"});const ne=document.createElement("div");Object.assign(ne.style,{background:"#fff",padding:"25px 30px",borderRadius:"14px",width:"520px",maxWidth:"95%",maxHeight:"95%",overflowY:"auto",boxShadow:"0 8px 30px rgba(0,0,0,0.3)",fontFamily:"Segoe UI, Roboto, sans-serif"}),ne.innerHTML=`
      <h2 style="margin-top:0;text-align:center;color:#0a86d8;font-weight:600;"> Nueva Cita</h2>
      <form id="formNuevaCita" style="display:flex;flex-direction:column;gap:12px;margin-top:10px;">
        <label style="font-weight:600;">Paciente existente</label>
        <div style="position:relative;">
          <input type="text" id="buscarPaciente" placeholder="Buscar por nombre, apellido o documento..." autocomplete="off"/>
          <div id="acResultados" style="position:absolute;left:0;right:0;top:calc(100% + 6px);z-index:10000;display:none;background:#fff;border:1px solid #ddd;border-radius:8px;box-shadow:0 8px 22px rgba(0,0,0,.12);max-height:240px;overflow:auto;"></div>
        </div>
        <small style="color:gray;">Si el paciente no existe, marca Registrar nuevo paciente.</small>

        <label style="display:flex;align-items:center;gap:8px;margin-top:5px;">
          <input type="checkbox" id="esNuevoPaciente" />
          <span>Registrar nuevo paciente</span>
        </label>

        <div id="nuevoPacienteCampos" style="display:none;flex-direction:column;gap:8px;margin-top:10px;padding:10px;border-radius:8px;background:#f9f9f9;border:1px solid #ddd;">
          <h4 style="margin:0;text-align:center;color:#0a86d8;">Datos del paciente</h4>
          <div style="display:flex;gap:8px;">
            <input type="text" id="npNombre" placeholder="Nombre" style="flex:1;" />
            <input type="text" id="npApellido" placeholder="Apellido" style="flex:1;" />
          </div>
          <select id="npTipoDocumento">
            <option value="">Tipo de documento</option>
            <option value="CC">Cdula de Ciudadana</option>
            <option value="CE">Cdula de Extranjera</option>
            <option value="TI">Tarjeta de Identidad</option>
            <option value="PA">Pasaporte</option>
            <option value="DI">Documento Internacional</option>
            <option value="OTRO">Otro</option>
          </select>
          <input type="text" id="npDocumento" placeholder="Nmero de documento" />
          <input type="email" id="npCorreo" placeholder="Correo electrnico" />
          <div style="display:flex;gap:5px;">
            <select id="npIndicativo" style="width:40%;">
              <option value="+57"> +57</option>
              <option value="+1"> +1</option>
              <option value="+34"> +34</option>
              <option value="+52"> +52</option>
              <option value="+54"> +54</option>
              <option value="+593"> +593</option>
              <option value="+56"> +56</option>
              <option value="+58"> +58</option>
            </select>
            <input type="tel" id="npCelular" placeholder="Celular (obligatorio)" style="flex:1;" />
          </div>
          <input type="tel" id="npTelefono" placeholder="Telfono fijo (opcional)" />
          <label style="font-weight:500;">Fecha de nacimiento:</label>
          <input type="date" id="npNacimiento" />
          <select id="npSexo">
            <option value="">Sexo</option>
            <option value="Masculino">Masculino</option>
            <option value="Femenino">Femenino</option>
            <option value="Otro">Otro</option>
          </select>
          <textarea id="npComentario" placeholder="Comentario o antecedentes del paciente" rows="2"></textarea>
        </div>

        <hr style="margin:10px 0;border:none;border-top:1px solid #ddd;" />
        <h4 style="margin:0;text-align:center;color:#0a86d8;">Detalles de la cita</h4>
        <input type="text" id="ncDoctor" placeholder="Doctor asignado" required />
        <input type="date" id="ncFecha" required value="${Rp(n)}" />
        <input type="time" id="ncHora" required />
        <input type="text" id="ncEspacio" placeholder="Espacio fsico / Sala" />
        <textarea id="ncComentario" placeholder="Comentario sobre la cita" rows="3"></textarea>

        <div style="display:flex;justify-content:flex-end;gap:10px;margin-top:10px;">
          <button type="button" id="btnCancelarModal" class="btn-cancelar">Cancelar</button>
          <button type="submit" class="btn-guardar">Guardar</button>
        </div>
      </form>
    `;const he=document.createElement("style");he.textContent=`
      .btn-cancelar, .btn-guardar { padding: 8px 14px; border: none; border-radius: 6px; cursor: pointer; font-weight: 600; font-size: 14px; transition: .2s; }
      .btn-cancelar { background: #e0e0e0; color: #333; } .btn-cancelar:hover { background: #d5d5d5; }
      .btn-guardar { background: #0a86d8; color: white; } .btn-guardar:hover { background: #0669ac; }
      input, select, textarea { width: 100%; padding: 8px 10px; border: 1px solid #ccc; border-radius: 6px; font-size: 14px; outline: none; }
      input:focus, select:focus, textarea:focus { border-color: #0a86d8; box-shadow: 0 0 0 2px rgba(10,134,216,.2); }
      .ac-item { padding: 8px 10px; display:flex; gap:8px; align-items:baseline; cursor:pointer; }
      .ac-item:hover, .ac-item.active { background:#f5f7fb; }
      .ac-name { font-weight:600; } .ac-doc { color:#64748b; font-size:12px; } .ac-tel { margin-left:auto; font-size:12px; color:#0f172a; }
      .ac-empty { padding:10px; color:#9aa4b2; font-size:13px; }
    `,document.head.appendChild(he),z.appendChild(ne),document.body.appendChild(z);const Ie=ne.querySelector("#esNuevoPaciente"),xe=ne.querySelector("#nuevoPacienteCampos"),ke=ne.querySelector("#buscarPaciente"),ye=ne.querySelector("#acResultados");Ie.addEventListener("change",()=>{xe.style.display=Ie.checked?"flex":"none",Ie.checked&&(ye.style.display="none")}),ne.querySelector("#btnCancelarModal").addEventListener("click",()=>z.remove());let Xe=null,be=null,re=-1,Oe=[];const it=Q=>{if(Oe=Q||[],re=-1,!Q||Q.length===0){ye.innerHTML='<div class="ac-empty">Sin resultados</div>',ye.style.display="block";return}ye.innerHTML=Q.map((fe,Ce)=>`
            <div class="ac-item" data-index="${Ce}" data-id="${fe.id}">
              <span class="ac-name">${fe.nombre}</span>
              <span class="ac-doc"> ${fe.documento||"s/doc"}</span>
              <span class="ac-tel">${fe.celular||fe.telefono||""}</span>
            </div>`).join(""),ye.style.display="block",[...ye.querySelectorAll(".ac-item")].forEach(fe=>{fe.addEventListener("click",()=>{const Ce=Number(fe.getAttribute("data-index"));Ge(Ce)})})},Ge=Q=>{const fe=Oe[Q];fe&&(be=fe,ke.value=fe.nombre,ye.style.display="none",Ie.checked=!1,xe.style.display="none")},pt=Q=>{Oe.length&&(re=(re+Q+Oe.length)%Oe.length,[...ye.querySelectorAll(".ac-item")].forEach((fe,Ce)=>{Ce===re?fe.classList.add("active"):fe.classList.remove("active")}))},q=(Q,fe)=>Q.nombreCompleto||Q.paciente||[Q.nombres,Q.apellidos].filter(Boolean).join(" ")||fe,se=async Q=>{const fe=(Q||"").toString().trim(),Ce=_o(fe);if(!Ce||Ce.length<2)return[];if(/^\d{5,}$/.test(fe))try{const we=rt(Ue(_e,"pacientes"),Je("documento","==",fe)),qe=rt(Ue(_e,"pacientes"),Je("nroDocumento","==",fe)),[Se,Fe]=await Promise.all([Yt(we),Yt(qe)]),ge=Se.empty?Fe:Se;if(!ge.empty)return ge.docs.slice(0,10).map(He=>{const F=He.data()||{};return{id:He.id,nombre:q(F,He.id),documento:F.documento||F.nroDocumento||He.id,celular:F.celularPaciente||F.celular||"",telefono:F.telefonoPaciente||F.telefono||""}})}catch{}try{const we=rt(Ue(_e,"pacientes"),Xt("nombre_busqueda"),OI(Ce),VI(Ce+""),Zo(10)),qe=await Yt(we);if(!qe.empty)return qe.docs.map(Se=>{const Fe=Se.data()||{};return{id:Se.id,nombre:q(Fe,Se.id),documento:Fe.documento||Fe.nroDocumento||Se.id,celular:Fe.celularPaciente||Fe.celular||"",telefono:Fe.telefonoPaciente||Fe.telefono||""}})}catch{}try{const we=rt(Ue(_e,"pacientes"),Xt("creado","desc"),Zo(50));return(await Yt(we)).docs.map(ge=>({id:ge.id,...ge.data()||{}})).map(ge=>({id:ge.id,nombre:q(ge,ge.id),documento:ge.documento||ge.nroDocumento||ge.id,celular:ge.celularPaciente||ge.celular||"",telefono:ge.telefonoPaciente||ge.telefono||"",_norm:_o(`${ge.nombreCompleto||ge.paciente||""} ${ge.nombres||""} ${ge.apellidos||""} ${ge.documento||ge.nroDocumento||""}`)})).filter(ge=>ge._norm.includes(Ce)).slice(0,10).map(({_norm:ge,...He})=>He)}catch{}return[]};ke.addEventListener("input",()=>{be=null;const Q=ke.value;if(clearTimeout(Xe),!Q||Q.trim().length<2){ye.style.display="none";return}Xe=setTimeout(async()=>{const fe=await se(Q.trim());it(fe)},220)}),ke.addEventListener("keydown",Q=>{ye.style.display==="block"&&(Q.key==="ArrowDown"?(Q.preventDefault(),pt(1)):Q.key==="ArrowUp"?(Q.preventDefault(),pt(-1)):Q.key==="Enter"?re>=0&&(Q.preventDefault(),Ge(re)):Q.key==="Escape"&&(ye.style.display="none"))}),document.addEventListener("click",Q=>{ne.contains(Q.target)&&!ye.contains(Q.target)&&Q.target!==ke&&(ye.style.display="none")},{capture:!0});const X=ne.querySelector("#formNuevaCita");X.addEventListener("submit",async Q=>{Q.preventDefault();const fe=Ie.checked,Ce=(X.querySelector("#buscarPaciente").value||"").trim(),we=X.querySelector("#ncDoctor").value.trim(),qe=X.querySelector("#ncFecha").value,Se=X.querySelector("#ncHora").value,Fe=X.querySelector("#ncEspacio").value.trim(),ge=X.querySelector("#ncComentario").value.trim();if(!qe||!Se){alert(" Debes seleccionar fecha y hora para la cita.");return}if(!we){alert(" Indica el doctor asignado.");return}try{let He=null,F=null,Z="",ae="",Ae="";if(fe){const B=(X.querySelector("#npNombre").value||"").trim(),ie=(X.querySelector("#npApellido").value||"").trim();if(Z=`${B} ${ie}`.trim(),!Z){alert(" Debes indicar nombre y apellido para el nuevo paciente.");return}const pe=(X.querySelector("#npDocumento").value||"").trim(),ce=(X.querySelector("#npCelular").value||"").trim(),Re=(X.querySelector("#npTelefono").value||"").trim();if(!ce&&!Re){alert(" Debes registrar al menos un telfono (celular o fijo) del paciente o de un acudiente.");return}if(He=pe||Z.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/\s+/g,"_"),F=zt(_e,"pacientes",He),!(await lh(F)).exists()){const Ve=_o(Z);await Bl(F,{nombres:B,apellidos:ie,nombreCompleto:Z,paciente:Z,nombre_busqueda:Ve,variantes_busqueda:[Ve,_o(B),_o(ie)],tipoDocumento:X.querySelector("#npTipoDocumento").value,documento:pe,correo:(X.querySelector("#npCorreo").value||"").trim(),indicativo:X.querySelector("#npIndicativo").value,celular:ce,telefono:Re,celularPaciente:ce,telefonoPaciente:Re,fechaNacimiento:X.querySelector("#npNacimiento").value,sexo:X.querySelector("#npSexo").value,notas:(X.querySelector("#npComentario").value||"").trim(),creado:new Date().toISOString(),activo:!0,citas:[]},{merge:!0})}ae=ce,Ae=Re}else if(be)He=be.id,Z=be.nombre,F=zt(_e,"pacientes",He),ae=be.celular||"",Ae=be.telefono||"";else{if(!Ce){alert(" Por favor, escribe o selecciona un paciente.");return}const B=rt(Ue(_e,"pacientes"),Je("documento","==",Ce)),ie=rt(Ue(_e,"pacientes"),Je("nroDocumento","==",Ce)),[pe,ce]=await Promise.all([Yt(B),Yt(ie)]),Re=pe.empty?ce:pe;if(Re.empty){let Nt=null;try{const Ve=_o(Ce),gr=rt(Ue(_e,"pacientes"),Xt("nombre_busqueda"),OI(Ve),VI(Ve+""),Zo(1)),ct=await Yt(gr);if(!ct.empty){const Ht=ct.docs[0],Wt=Ht.data()||{};Nt={id:Ht.id,ref:Ht.ref,nombre:Wt.nombreCompleto||Wt.paciente||[Wt.nombres,Wt.apellidos].filter(Boolean).join(" "),cel:Wt.celularPaciente||Wt.celular||"",tel:Wt.telefonoPaciente||Wt.telefono||""}}}catch{}Nt?(He=Nt.id,F=Nt.ref,Z=Nt.nombre||Ce,ae=Nt.cel||"",Ae=Nt.tel||""):Z=Ce}else{const Nt=Re.docs[0],Ve=Nt.data()||{};He=Nt.id,F=Nt.ref,Z=Ve.nombreCompleto||Ve.paciente||[Ve.nombres,Ve.apellidos].filter(Boolean).join(" ")||Ce,ae=Ve.celularPaciente||Ve.celular||"",Ae=Ve.telefonoPaciente||Ve.telefono||""}}if(!(ae||Ae||"").trim()){alert(" Este paciente no tiene ningn telfono registrado. Edita sus datos y agrega un nmero antes de guardar la cita.");return}const Mt={paciente:Z||"Paciente",pacienteId:He||null,doctor:we,fecha:qe,horaInicio:Se,espacio:Fe,comentario:ge,estado:"En espera",creado:new Date().toISOString(),celularPaciente:ae||"",telefonoPaciente:Ae||""},x=await Il(Ue(_e,"citas"),Mt);F&&await Bl(F,{citas:VM(x.id)},{merge:!0}),alert(" Cita registrada correctamente y vinculada al paciente."),z.remove()}catch(He){console.error(" Error al guardar cita:",He),alert(" Error al guardar la cita. Revisa la consola para ms detalles.")}})},je=z=>{var Xe,be;const ne=document.createElement("div");Object.assign(ne.style,{position:"fixed",top:"0",left:"0",width:"100%",height:"100%",background:"rgba(0,0,0,0.55)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:"9999"});const he=document.createElement("div");Object.assign(he.style,{background:"#fff",padding:"25px 30px",borderRadius:"14px",width:"520px",maxWidth:"95%",maxHeight:"95%",overflowY:"auto",boxShadow:"0 8px 30px rgba(0,0,0,0.3)",fontFamily:"Segoe UI, Roboto, sans-serif"});const Ie=(Xe=z.raw)!=null&&Xe.fecha&&typeof z.raw.fecha=="string"?z.raw.fecha:Rp(z.fecha),xe=((be=z.raw)==null?void 0:be.horaInicio)||z.fecha.toTimeString().slice(0,5);he.innerHTML=`
      <h2 style="margin-top:0;text-align:center;color:#0a86d8;font-weight:600;"> Editar Cita</h2>
      <form id="formEditarCita" style="display:flex;flex-direction:column;gap:12px;margin-top:10px;">
        <label>Paciente</label>
        <input type="text" id="editPaciente" value="${z.paciente||""}" />

        <label>Doctor asignado</label>
        <input type="text" id="editDoctor" value="${z.doctor||""}" />

        <div style="display:flex;gap:8px;">
          <div style="flex:1;">
            <label>Fecha</label>
            <input type="date" id="editFecha" value="${Ie}" />
          </div>
          <div style="flex:1;">
            <label>Hora</label>
            <input type="time" id="editHora" value="${xe}" />
          </div>
        </div>

        <label>Espacio fsico / Sala</label>
        <input type="text" id="editEspacio" value="${z.espacio||""}" />

        <label>Estado</label>
        <select id="editEstado" className="estado-select">
          <option value="En espera" ${z.estado==="En espera"?"selected":""}>En espera</option>
          <option value="En sala" ${z.estado==="En sala"?"selected":""}>En sala</option>
          <option value="Atendiendo" ${z.estado==="Atendiendo"?"selected":""}>Atendiendo</option>
          <option value="Finalizada" ${z.estado==="Finalizada"?"selected":""}>Finalizada</option>
          <option value="pendiente" ${z.estado==="pendiente"?"selected":""}>Pendiente</option>
          <option value="No asisti" ${z.estado==="No asisti"?"selected":""}>No asisti</option>
        </select>

        <label>Comentario</label>
        <textarea id="editComentario" rows="3">${z.comentario||""}</textarea>

        <div style="display:flex;justify-content:flex-end;gap:10px;margin-top:10px;">
          <button type="button" id="btnCancelarEdit" className="btn-cancelar">Cancelar</button>
          <button type="submit" className="btn-guardar">Guardar cambios</button>
        </div>
      </form>
    `;const ke=document.createElement("style");ke.textContent=`
      .btn-cancelar, .btn-guardar { padding: 8px 14px; border: none; border-radius: 6px; cursor: pointer; font-weight: 600; font-size: 14px; transition: .2s; }
      .btn-cancelar { background: #e0e0e0; color: #333; } .btn-cancelar:hover { background: #d5d5d5; }
      .btn-guardar { background: #0a86d8; color: white; } .btn-guardar:hover { background: #0669ac; }
      #formEditarCita input, #formEditarCita select, #formEditarCita textarea { width: 100%; padding: 8px 10px; border: 1px solid #ccc; border-radius: 6px; font-size: 14px; outline: none; }
      #formEditarCita input:focus, #formEditarCita select:focus, #formEditarCita textarea:focus { border-color: #0a86d8; box-shadow: 0 0 0 2px rgba(10,134,216,.2); }
    `,document.head.appendChild(ke),ne.appendChild(he),document.body.appendChild(ne),he.querySelector("#btnCancelarEdit").addEventListener("click",()=>ne.remove());const ye=he.querySelector("#formEditarCita");ye.addEventListener("submit",async re=>{re.preventDefault();const Oe=ye.querySelector("#editPaciente").value.trim(),it=ye.querySelector("#editDoctor").value.trim(),Ge=ye.querySelector("#editFecha").value,pt=ye.querySelector("#editHora").value,q=ye.querySelector("#editEspacio").value.trim(),se=ye.querySelector("#editEstado").value,X=ye.querySelector("#editComentario").value.trim();if(!Oe)return alert(" El nombre del paciente es obligatorio.");if(!Ge||!pt)return alert(" Debes indicar fecha y hora.");try{const Q=zt(_e,"citas",z.id);await ea(Q,{paciente:Oe,doctor:it,fecha:Ge,horaInicio:pt,espacio:q,estado:se,comentario:X}),alert(" Cita actualizada correctamente."),ne.remove()}catch(Q){console.error(" Error al actualizar cita:",Q),alert(" Error al actualizar la cita. Revisa la consola para ms detalles.")}})},Ke=z=>{const ne=z.fecha.toLocaleDateString(En),he=z.fecha.toLocaleTimeString(En,{hour:"numeric",minute:"2-digit",hour12:!0}),Ie=`${ne}  ${he}`;return u.jsxs("tr",{className:"fade-in-row",onClick:()=>je(z),style:{cursor:"pointer"},children:[u.jsx("td",{children:Ie}),u.jsx("td",{children:z.paciente}),u.jsx("td",{children:z.doctor}),u.jsx("td",{children:z.espacio}),u.jsx("td",{children:z.comentario}),u.jsx("td",{onClick:xe=>{xe.stopPropagation()},children:u.jsxs("select",{className:"estado-select",value:z.estado,onChange:xe=>en(z.id,xe.target.value),children:[u.jsx("option",{value:"En espera",children:"En espera"}),u.jsx("option",{value:"En sala",children:"En sala"}),u.jsx("option",{value:"Atendiendo",children:"Atendiendo"}),u.jsx("option",{value:"Finalizada",children:"Finalizada"}),u.jsx("option",{value:"pendiente",children:"Pendiente"}),u.jsx("option",{value:"No asisti",children:"No asisti"})]})}),u.jsxs("td",{className:"acciones-cell",onClick:xe=>{xe.stopPropagation()},children:[z.telefono?u.jsx("button",{type:"button",className:"btn-whatsapp",onClick:xe=>{xe.stopPropagation(),J(z.telefono,z)},children:"WhatsApp"}):u.jsx("span",{className:"acciones-texto",children:"Sin celular"}),u.jsx("button",{type:"button",className:"btn-delete",onClick:xe=>{xe.stopPropagation(),de(z)},children:"Eliminar"}),z.recordatorio&&u.jsx("span",{className:"acciones-texto",children:z.recordatorio})]})]},z.id)};return u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"odc-topbar-green"}),u.jsx("div",{className:"odc-topbar-blue",children:"Agenda"}),u.jsx("section",{className:"odc-agenda-root",children:u.jsxs("div",{className:"odc-agenda-inner",children:[u.jsxs("aside",{className:"odc-left","aria-label":"Panel izquierdo - calendario y filtros",children:[u.jsxs("div",{className:"odc-mini-calendar-card",role:"region","aria-label":"Mini calendario",children:[u.jsxs("div",{className:"mini-cal-header",children:[u.jsx("button",{className:"cal-arrow",id:"miniCalPrev","aria-label":"Mes anterior",onClick:V,children:""}),u.jsx("div",{id:"miniCalMonthYear","aria-live":"polite",children:_}),u.jsx("button",{className:"cal-arrow",id:"miniCalNext","aria-label":"Mes siguiente",onClick:M,children:""})]}),u.jsxs("table",{className:"mini-month-table","aria-hidden":"false",children:[u.jsx("thead",{children:u.jsxs("tr",{children:[u.jsx("th",{children:"Lu"}),u.jsx("th",{children:"Ma"}),u.jsx("th",{children:"Mi"}),u.jsx("th",{children:"Ju"}),u.jsx("th",{children:"Vi"}),u.jsx("th",{children:"Sa"}),u.jsx("th",{children:"Do"})]})}),u.jsx("tbody",{id:"miniCalendar",children:j.map((z,ne)=>u.jsx("tr",{children:z.map((he,Ie)=>u.jsx("td",{className:[he.isCurrentMonth?"":"empty",he.isToday?"today":"",he.isSelected?"selected":""].filter(Boolean).join(" "),onClick:()=>he.isCurrentMonth&&T(he.date),children:he.date.getDate()},Ie))},ne))})]})]}),u.jsxs("div",{className:"odc-filters-card","aria-label":"Filtros de agenda",children:[u.jsx("label",{htmlFor:"filterSucursal",children:"Sucursal"}),u.jsxs("select",{id:"filterSucursal",value:h,onChange:z=>f(z.target.value),children:[u.jsx("option",{value:"",children:" Todas "}),A.map(z=>u.jsx("option",{value:z,children:z},z))]}),u.jsx("label",{htmlFor:"filterDoctor",children:"Doctores"}),u.jsxs("select",{id:"filterDoctor",value:m,onChange:z=>v(z.target.value),children:[u.jsx("option",{value:"",children:" Todos "}),I.map(z=>u.jsx("option",{value:z,children:z},z))]})]})]}),u.jsxs("main",{className:"odc-right","aria-label":"Panel principal - agenda",children:[u.jsxs("div",{className:"odc-header-bar",role:"region","aria-label":"Controles de la agenda",style:{display:"flex",alignItems:"center",justifyContent:"space-between",gap:12},children:[u.jsxs("div",{className:"odc-header-left",style:{display:"flex",alignItems:"center",gap:12,flexWrap:"wrap"},children:[u.jsx("h3",{className:"odc-title",style:{marginRight:8},children:"Agenda"}),u.jsxs("div",{className:"view-buttons",role:"tablist","aria-label":"Vistas",style:{display:"flex",gap:6},children:[u.jsx("button",{className:`btn view ${t==="day"?"active":""}`,"data-view":"day",role:"tab","aria-selected":t==="day",onClick:()=>e("day"),children:"Da"}),u.jsx("button",{className:`btn view ${t==="week"?"active":""}`,"data-view":"week",role:"tab","aria-selected":t==="week",onClick:()=>e("week"),children:"Semana"}),u.jsx("button",{className:`btn view ${t==="detail"?"active":""}`,"data-view":"detail",role:"tab","aria-selected":t==="detail",onClick:()=>e("detail"),children:"Detalle"})]}),u.jsxs("div",{className:"date-nav",style:{display:"flex",alignItems:"center",gap:6,flex:"0 0 auto"},children:[u.jsx("button",{className:"btn icon",id:"btnPrev","aria-label":"Anterior",onClick:C,children:""}),u.jsx("button",{className:"btn icon",id:"btnNext","aria-label":"Siguiente",onClick:k,children:""}),u.jsx("span",{id:"currentDateDisplay",className:"current-date","aria-live":"polite",style:{whiteSpace:"nowrap"},children:S}),u.jsx("button",{id:"btnHoy",className:"btn small",onClick:D,children:"Hoy"})]})]}),u.jsx("div",{className:"odc-header-right",style:{display:"flex",alignItems:"center",gap:8,flexShrink:0},children:u.jsxs("div",{className:"right-actions",style:{display:"flex",alignItems:"center",gap:8},children:[u.jsx("input",{id:"searchCitas",placeholder:"Buscar...",className:"search-input","aria-label":"Buscar citas",value:R,onChange:z=>b(z.target.value)}),u.jsx("button",{id:"btnNuevaCita",className:"btn green","aria-label":"Nueva cita",onClick:G,children:"+ Nueva cita"})]})})]}),u.jsxs("div",{className:"odc-content-card",role:"region","aria-label":"Contenido agenda",children:[u.jsxs("div",{className:"tools-row",children:[u.jsx("div",{className:"tools-left",children:u.jsx("div",{id:"ocupacionInfo",className:"ocupacion-info",children:y})}),u.jsxs("div",{className:"tools-right",children:[u.jsx("button",{id:"btnPrint",className:"btn",title:"Imprimir agenda",onClick:P,children:" Imprimir"}),u.jsx("button",{id:"btnConfirmar",className:"btn blue",title:"Confirmar citas",onClick:Y,children:" Confirmar"}),u.jsx("button",{id:"btnHoyCitas",className:"btn",title:"Ver citas de hoy",onClick:Ye,children:" Hoy"}),u.jsx("button",{id:"btnExportar",className:"btn",title:"Exportar citas a CSV",onClick:Lt,children:" Exportar"})]})]}),u.jsx("div",{className:"table-wrap",role:"region","aria-label":"Lista de citas",children:u.jsxs("table",{className:"appointments-table","aria-live":"polite",children:[u.jsx("thead",{children:u.jsxs("tr",{children:[u.jsx("th",{style:{width:"180px"},children:"Fecha / Hora"}),u.jsx("th",{children:"Paciente"}),u.jsx("th",{children:"Doctor"}),u.jsx("th",{children:"Espacio fsico"}),u.jsx("th",{children:"Comentario"}),u.jsx("th",{style:{width:"120px"},children:"Estado"}),u.jsx("th",{children:"Acciones"})]})}),u.jsx("tbody",{id:"citasTbody",children:o?u.jsx("tr",{children:u.jsx("td",{colSpan:7,className:"no-data",children:"Cargando citas..."})}):w.length===0?u.jsx("tr",{children:u.jsx("td",{colSpan:7,className:"no-data",children:"No hay citas registradas para este rango."})}):w.map(Ke)})]})})]})]})]})})]})}function CU(){return u.jsxs("div",{style:{padding:"20px"},children:[u.jsx("h2",{children:"Mdulo de Facturacin"}),u.jsx("p",{children:"Aqu se registrarn los pagos, facturas y cobros."})]})}function AU(){return u.jsxs("div",{style:{padding:"20px"},children:[u.jsx("h2",{children:"Mdulo de Facturacin"}),u.jsx("p",{children:"Aqu se registrarn los pagos, facturas y cobros."})]})}function RU(){return u.jsxs("div",{style:{padding:"20px"},children:[u.jsx("h2",{children:"Mdulo de Facturacin"}),u.jsx("p",{children:"Aqu se registrarn los pagos, facturas y cobros."})]})}const ku={caja:"caja",pagos:"facturacion/pagos",facturas:"facturacion/facturas"};var pT;const Du=typeof navigator<"u"&&((pT=navigator.language)!=null&&pT.startsWith("es"))?"es-ES":"en-US",PU=["Colombia","Argentina","Bolivia","Chile","Costa Rica","Cuba","Ecuador","El Salvador","Espaa","Guatemala","Honduras","Mxico","Nicaragua","Panam","Paraguay","Per","Puerto Rico","Repblica Dominicana","Uruguay","Venezuela","Estados Unidos","Canad"],lT={Colombia:["Bogot","Medelln","Cali","Barranquilla","Cartagena","Ccuta","Bucaramanga","Pereira","Santa Marta","Ibagu"],Mxico:["Ciudad de Mxico","Guadalajara","Monterrey","Puebla","Quertaro","Tijuana","Mrida","Len"],Per:["Lima","Arequipa","Trujillo","Chiclayo","Cusco","Piura"],Chile:["Santiago","Valparaso","Concepcin","La Serena","Antofagasta"],Argentina:["Buenos Aires","Crdoba","Rosario","Mendoza","La Plata"],Espaa:["Madrid","Barcelona","Valencia","Sevilla","Zaragoza","Bilbao"],"Estados Unidos":["Miami","New York","Los ngeles","Houston","Chicago"],Ecuador:["Quito","Guayaquil","Cuenca","Manta"],Venezuela:["Caracas","Maracaibo","Valencia","Barquisimeto","Maracay"]},NU=t=>{if(!t)return"";const[e,n,r]=t.split("-").map(l=>parseInt(l,10)),s=new Date(e,(n||1)-1,r||1),i=new Date;let o=i.getFullYear()-s.getFullYear();const a=i.getMonth()-s.getMonth();return(a<0||a===0&&i.getDate()<s.getDate())&&o--,isNaN(o)?"":String(o)};async function cT(t,{maxW:e=900,maxH:n=900,quality:r=.82}={}){var m;if(!t||!((m=t.type)!=null&&m.startsWith("image/")))return t;const s=await new Promise((v,R)=>{const b=new Image;b.onload=()=>v(b),b.onerror=R,b.src=URL.createObjectURL(t)});let{width:i,height:o}=s;const a=Math.min(e/i,n/o,1);i=Math.round(i*a),o=Math.round(o*a);const l=document.createElement("canvas");l.width=i,l.height=o,l.getContext("2d").drawImage(s,0,0,i,o);const h=await new Promise(v=>l.toBlob(v,"image/jpeg",r)),f=new File([h],(t.name||"foto.jpg").replace(/\.[^.]+$/,".jpg"),{type:"image/jpeg",lastModified:Date.now()});return URL.revokeObjectURL(s.src),f}const Tl=t=>(t||"").toString().toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/\s+/g," ").trim(),kU=t=>Tl([t.nombres,t.apellidos,t.nombreCompleto,t.nroDocumento,t.celular,t.email].filter(Boolean).join(" ")),vo={tipoDocumento:"",nroDocumento:"",nroHistoria:"",nombres:"",apellidos:"",nombreCompleto:"",sexo:"",estadoCivil:"",paisNacimiento:"",ciudadNacimiento:"",fechaIngreso:"",fechaNacimiento:"",edad:"",paisDomicilio:"",ciudadDomicilio:"",barrio:"",lugarResidencia:"",estrato:"",zonaResidencial:"",esExtranjero:!1,permitePublicidad:!1,celular:"",telDomicilio:"",telOficina:"",extension:"",email:"",ocupacion:"",nombreResponsable:"",parentesco:"",celularResponsable:"",telefonoResponsable:"",emailResponsable:"",nombreAcompanante:"",telefonoAcompanante:"",convenioBeneficio:"",comoConocio:"",campania:"",remitidoPor:"",asesorComercial:"",tipoVinculacion:"",nombreEps:"",polizaSalud:"",doctor:"",notas:"",rxImagenes:[],historiaClinica:{antecedentes:"",alergias:"",medicamentos:"",motivoConsulta:"",notas:""},odontograma:[],periodontograma:[],presupuestos:[],evoluciones:[],facturacion:{saldoFavor:0,saldoCredito:0},fotoUrl:"",activo:!0},Pp=20,wo=t=>Number(t||0);function DU(t){const[e,n]=N.useState(!1),[r,s]=N.useState([]),[i,o]=N.useState([]),[a,l]=N.useState("");N.useEffect(()=>{let A=!0;return(async()=>{if(!t){s([]),o([]);return}n(!0),l("");try{let w=rt(Ue(_e,"facturas"),Je("patientId","==",t),Xt("fechaISO","desc"));const V=(await Yt(w)).docs.map(C=>({id:C.id,...C.data()})).map(C=>({...C,total:wo(C.total??C.valor??C.montoTotal),estado:(C.estado||"pendiente").toLowerCase(),fechaISO:C.fechaISO||C.fecha||null}));let M=rt(Ue(_e,"pagos"),Je("patientId","==",t),Xt("fechaISO","desc"));const S=(await Yt(M)).docs.map(C=>({id:C.id,...C.data()})).map(C=>({...C,monto:wo(C.monto??C.valor??C.total),fechaISO:C.fechaISO||C.fecha||null,medio:C.medio||C.metodo||""}));if(!A)return;s(V),o(S)}catch(w){console.warn("Finanzas: no se pudo leer colecciones. Contino solo con saldos del paciente.",w),A&&l("No se pudieron leer facturas/pagos.")}finally{A&&n(!1)}})(),()=>{A=!1}},[t]);const d=r.reduce((A,I)=>A+wo(I.total),0),h=i.reduce((A,I)=>A+wo(I.monto),0),f=r.filter(A=>["pagada","pagado","paid"].includes((A.estado||"").toLowerCase())),m=r.filter(A=>["pendiente","abierta","open","deuda"].includes((A.estado||"").toLowerCase())),v=f.reduce((A,I)=>A+wo(I.total),0),R=m.reduce((A,I)=>A+wo(I.total),0);return{loading:e,error:a,facturas:r,pagos:i,totalFacturado:d,totalPagado:h,totalFacturasPagadas:v,totalFacturasPendientes:R}}function jU(t){const[e,n]=N.useState(!1),[r,s]=N.useState([]);return N.useEffect(()=>{let i=!0;return(async()=>{if(!t){s([]);return}n(!0);try{const a=rt(Ue(_e,"citas"),Je("patientId","==",t),Xt("fechaISO","desc"));let d=(await Yt(a)).docs.map(h=>({id:h.id,...h.data()}));if(d.length===0){const h=rt(Ue(_e,"citas"),Je("pacienteId","==",t),Xt("fechaISO","desc"));d=(await Yt(h)).docs.map(m=>({id:m.id,...m.data()}))}i&&s(d)}catch(a){console.warn("No se pudieron leer citas:",a),i&&s([])}finally{i&&n(!1)}})(),()=>{i=!1}},[t]),{loading:e,citas:r}}function OU(){var Fe,ge,He,F,Z,ae,Ae,vt,Mt;const t=Ac(),e=Vr(),n=ST.useMemo(()=>{const x=e.pathname.split("/").filter(Boolean),B=x.findIndex(ce=>["pacientes","agenda","caja","facturacion","config","reportes","software"].includes(ce)),pe="/"+x.slice(0,B>=0?B:x.length).join("/");return pe==="/"?"":pe},[e.pathname]),r=x=>{const B=String(x||"").replace(/^\//,""),ie=n?`${n}/`:"/";t(`${ie}${B}`)},s=(x,B)=>{const ie=String(x).replace(/^\//,""),pe=B?new URLSearchParams(B).toString():"";return`${n?`${n}/`:"/"}${ie}${pe?`?${pe}`:""}`},[i,o]=N.useState(!0),[a,l]=N.useState([]),[d,h]=N.useState(""),[f,m]=N.useState(null),[v,R]=N.useState(!0),[b,A]=N.useState(!1),[I,w]=N.useState(null),[y,j]=N.useState(null),V=N.useRef(null),[M,T]=N.useState("datos"),[_,S]=N.useState(vo),[C,k]=N.useState(null),[D,P]=N.useState(""),[Y,Ye]=N.useState([]),[Lt,en]=N.useState(!1),J=N.useRef(null),de=N.useMemo(()=>lT[_.paisNacimiento]||[],[_.paisNacimiento]);N.useEffect(()=>((async()=>{o(!0);try{const ie=(await Yt(Ue(_e,"eps"))).docs.map(ce=>{var Re;return(Re=ce.data())==null?void 0:Re.nombre}).filter(Boolean),pe=Array.from(new Map(ie.map(ce=>[String(ce).toLowerCase(),ce])).values()).sort((ce,Re)=>ce.localeCompare(Re,"es"));Ye(pe),await z(!0)}catch(B){console.error(B),alert("No se pudieron cargar pacientes/EPS.")}finally{o(!1)}})(),()=>{V.current&&(V.current(),V.current=null)}),[]),N.useEffect(()=>{S(x=>({...x,nombreCompleto:`${x.nombres} ${x.apellidos}`.trim()}))},[_.nombres,_.apellidos]),N.useEffect(()=>{S(x=>({...x,nroHistoria:x.nroDocumento}))},[_.nroDocumento]),N.useEffect(()=>{S(x=>({...x,edad:NU(x.fechaNacimiento)}))},[_.fechaNacimiento]),N.useEffect(()=>{const x=new Date,B=x.toLocaleDateString(Du)+" - "+x.toLocaleTimeString(Du,{hour:"2-digit",minute:"2-digit",hour12:!0});S(ie=>({...ie,fechaIngreso:B}))},[]);const G=(x,B)=>S(ie=>({...ie,[x]:B})),je=()=>{S(vo);const x=new Date,B=x.toLocaleDateString(Du)+" - "+x.toLocaleTimeString(Du,{hour:"2-digit",minute:"2-digit",hour12:!0});S(ie=>({...ie,fechaIngreso:B})),k(null),P(""),w(null)},Ke=async x=>{if(!x){k(null),P("");return}try{const B=await cT(x,{maxW:900,maxH:900,quality:.82});k(B);const ie=new FileReader;ie.onload=pe=>P(pe.target.result),ie.readAsDataURL(B)}catch{k(x);const B=new FileReader;B.onload=ie=>P(ie.target.result),B.readAsDataURL(x)}},z=async(x=!1)=>{o(!0);try{let B;x||!f?B=rt(Ue(_e,"pacientes"),Xt("creado","desc"),Zo(Pp)):B=rt(Ue(_e,"pacientes"),Xt("creado","desc"),PM(f),Zo(Pp));const ie=await Yt(B),pe=ie.docs.map(ce=>({id:ce.id,...ce.data()}));l(x?pe:ce=>[...ce,...pe]),m(ie.docs[ie.docs.length-1]||null),R(ie.size===Pp)}catch(B){console.error(B),alert("No se pudo cargar pacientes.")}finally{o(!1)}},ne=async x=>{if(x.preventDefault(),!_.nroDocumento.trim())return alert("El nmero de documento es obligatorio.");if(!_.nombres.trim())return alert("Los nombres son obligatorios.");if(!_.apellidos.trim())return alert("Los apellidos son obligatorios.");if(!_.sexo.trim())return alert("El sexo es obligatorio.");if(!_.fechaNacimiento.trim())return alert("La fecha de nacimiento es obligatoria.");if(!_.celular.trim())return alert("El celular es obligatorio.");if(!_.email.trim())return alert("El correo electrnico es obligatorio.");if(!_.tipoVinculacion.trim())return alert("El tipo de vinculacin es obligatorio.");if(!_.nombreEps.trim())return alert("El nombre de la EPS es obligatorio.");try{const B=_.nroDocumento.trim();if(!I&&(await lh(zt(_e,"pacientes",B))).exists())return alert("Ya existe un paciente con ese nmero de documento.");const ie=(_.nombreEps||"").trim(),pe=Y.map(ct=>ct.toLowerCase()).includes(ie.toLowerCase());if(ie&&!pe&&window.confirm(`La EPS "${ie}" no existe. Deseas guardarla para futuras selecciones?`)){const Ht=ie.toLowerCase().replace(/\s+/g,"_");await Bl(zt(_e,"eps",Ht),{nombre:ie,nombreLower:ie.toLowerCase(),creado:In()},{merge:!0})}let ce=_.fotoUrl||"",Re="";if(C)try{const ct=Ii(),Ht=(C.name||"foto.jpg").replace(/\s+/g,"_");Re=`pacientes/${B}/${Date.now()}_${Ht}`;const Wt=ul(ct,Re),Va={contentType:C.type||"image/jpeg",cacheControl:"public, max-age=86400"};await WI(Wt,C,Va),ce=await GI(Wt)}catch(ct){console.error("Foto (warning):",ct)}const Nt=_.creado||null,Ve=I&&Nt||In(),gr={..._,fotoUrl:ce,nombre_busqueda:kU({..._,fotoUrl:ce}),nombresLower:Tl(_.nombres),apellidosLower:Tl(_.apellidos),documentoLower:Tl(_.nroDocumento),emailLower:Tl(_.email),creado:Ve,createdAt:Ve,actualizado:In(),updatedAt:In(),activo:_.activo??!0,celularPaciente:_.celular,telefonoPaciente:_.telDomicilio||"",documento:_.nroDocumento,paciente:_.nombreCompleto};if(await Bl(zt(_e,"pacientes",B),gr,{merge:!0}),Re)try{const ct=Ii(),Ht=ul(ct,`pacientes/${B}`),Wt=await KI(Ht),Va=Re,is=Wt.items.filter(La=>La.fullPath!==Va).map(La=>Ip(La).catch(()=>null));await Promise.allSettled(is)}catch(ct){console.warn("No se pudo limpiar fotos antiguas:",ct)}alert(I?" Paciente actualizado.":" Paciente guardado."),l(ct=>{const Ht=ct.filter(Wt=>Wt.id!==B);return[{id:B,...gr},...Ht]}),A(!1),w(null),je()}catch(B){console.error("Error guardando paciente:",B),alert(`No se pudo guardar el paciente.

`+((B==null?void 0:B.message)||B))}},he=()=>{je(),A(!0)},Ie=()=>{y&&(S({...vo,...y,fotoUrl:y.fotoUrl||""}),k(null),P(y.fotoUrl||""),w(y.id),Xe(),A(!0))},xe=async x=>{if(window.confirm(`Eliminar al paciente "${x.nombreCompleto}"?`))try{await rA(zt(_e,"pacientes",x.id)),l(B=>B.filter(ie=>ie.id!==x.id));try{const B=Ii(),ie=ul(B,`pacientes/${x.id}`),ce=(await KI(ie)).items.map(Re=>Ip(Re).catch(()=>null));await Promise.allSettled(ce)}catch(B){console.warn("No se pudo borrar la carpeta de fotos:",B)}}catch(B){console.error(B),alert("No se pudo eliminar.")}},ke=N.useMemo(()=>{const x=d.trim().toLowerCase();return x?a.filter(B=>`${B.nombreCompleto||B.paciente||""} ${B.nroDocumento||""} ${B.celular||B.celularPaciente||""} ${B.email||""}`.toLowerCase().includes(x)):a},[a,d]),ye=x=>{Xe();const B=zt(_e,"pacientes",x.id),ie=ir(B,pe=>{pe.exists()?j({id:pe.id,...be(pe.data())}):j(null)});V.current=ie,T("datos")},Xe=()=>{V.current&&(V.current(),V.current=null),j(null)},be=x=>({...vo,...x,historiaClinica:{...vo.historiaClinica,...x.historiaClinica||{}},facturacion:{...vo.facturacion,...x.facturacion||{}},rxImagenes:Array.isArray(x.rxImagenes)?x.rxImagenes:[],odontograma:Array.isArray(x.odontograma)?x.odontograma:[],periodontograma:Array.isArray(x.periodontograma)?x.periodontograma:[],presupuestos:Array.isArray(x.presupuestos)?x.presupuestos:[],evoluciones:Array.isArray(x.evoluciones)?x.evoluciones:[]}),re=async x=>{if(y!=null&&y.id)try{await ea(zt(_e,"pacientes",y.id),{...x,actualizado:In(),updatedAt:In()})}catch(B){console.error(B),alert("No se pudo actualizar.")}},Oe=async x=>{var ie;if(!(y!=null&&y.id)||!(x!=null&&x.length))return;const B=Ii();try{en(!0);const pe=[];for(const ce of x){let Re=ce;if((ie=ce.type)!=null&&ie.startsWith("image/"))try{Re=await cT(ce,{maxW:1600,maxH:1600,quality:.85})}catch{Re=ce}const Nt=(Re.name||"archivo").replace(/\s+/g,"_"),Ve=`pacientes/${y.id}/rx/${Date.now()}_${Nt}`,gr=ul(B,Ve);await WI(gr,Re,{contentType:Re.type||"application/octet-stream",cacheControl:"public, max-age=31536000"});const ct=await GI(gr);pe.push({url:ct,name:ce.name,type:ce.type,size:ce.size||0,created:Date.now(),path:Ve})}await re({rxImagenes:[...y.rxImagenes||[],...pe]})}catch(pe){console.error("RX upload error:",pe),alert(`No se pudo subir el/los archivo(s). Revisa las reglas de Storage/Firestore o la conexin.

`+((pe==null?void 0:pe.message)||pe))}finally{en(!1);try{J.current&&(J.current.value="")}catch{}}},it=async x=>{if(!(y!=null&&y.id))return;const B=y.rxImagenes[x],ie=y.rxImagenes.filter((pe,ce)=>ce!==x);await re({rxImagenes:ie});try{if(B!=null&&B.path){const pe=Ii();await Ip(ul(pe,B.path))}}catch(pe){console.warn("No se pudo borrar del Storage:",pe)}},Ge=(x,B)=>{const ie={...y.historiaClinica||{},[x]:B};re({historiaClinica:ie})},pt=x=>{const B=[...y.presupuestos||[],{id:String(Date.now()),...x}];re({presupuestos:B})},q=x=>{re({presupuestos:(y.presupuestos||[]).filter(B=>B.id!==x)})},se=x=>{const B=[...y.evoluciones||[],{id:String(Date.now()),fechaISO:new Date().toISOString(),nota:x}];re({evoluciones:B})},X=x=>{re({evoluciones:(y.evoluciones||[]).filter(B=>B.id!==x)})},Q=(x,B)=>{const ie=Array.isArray(y[x])?y[x]:[],pe=ie.find(Re=>Re.pieza===B);let ce;pe?ce=ie.filter(Re=>Re.pieza!==B):ce=[...ie,{pieza:B,estado:"marcada"}],re({[x]:ce})},fe=async({dateISO:x,timeHHMM:B="09:00",motivo:ie="",profesional:pe=""})=>{if(!(y!=null&&y.id))return alert("Primero selecciona un paciente.");try{const ce=new Date(`${x}T${B}:00`),Re={patientId:y.id,pacienteId:y.id,pacienteNombre:y.nombreCompleto||"",fechaISO:ce.toISOString(),fecha:x,horaInicio:B,estado:"programada",motivo:ie||"Consulta",profesional:pe||y.doctor||"",creado:In(),actualizado:In()};await Bl(zt(Ue(_e,"citas")),Re),alert(" Cita creada.")}catch(ce){console.error("Create cita error:",ce),alert("No se pudo crear la cita: "+((ce==null?void 0:ce.message)||ce))}},Ce=(y==null?void 0:y.id)||null,we=DU(Ce),{loading:qe,citas:Se}=jU(Ce);return u.jsxs("div",{className:"odc-container",children:[u.jsx("div",{className:"odc-topbar-green"}),u.jsx("div",{className:"odc-topbar-blue",children:u.jsx("div",{className:"odc-top-inner",children:u.jsx("div",{className:"odc-breadcrumbs",children:"Pacientes"})})}),u.jsxs("div",{className:"odc-card",children:[u.jsxs("div",{className:"odc-card-header",children:[u.jsx("h3",{className:"odc-title",children:"Pacientes"}),u.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[u.jsx("input",{className:"search-input",style:{minWidth:280},placeholder:"Buscar por nombre, documento o telfono",value:d,onChange:x=>h(x.target.value)}),u.jsx("button",{type:"button",className:"btn green",onClick:he,children:"+ Nuevo paciente"})]})]}),u.jsx("div",{className:"table-wrap",children:u.jsxs("table",{className:"appointments-table",children:[u.jsx("thead",{children:u.jsxs("tr",{children:[u.jsx("th",{children:"Foto"}),u.jsx("th",{children:"Nombre"}),u.jsx("th",{children:"Documento"}),u.jsx("th",{children:"Celular"}),u.jsx("th",{children:"Correo"}),u.jsx("th",{children:"Estado"})]})}),u.jsx("tbody",{children:i&&a.length===0?u.jsx("tr",{children:u.jsx("td",{className:"no-data",colSpan:6,children:"Cargando"})}):ke.length===0?u.jsx("tr",{children:u.jsx("td",{className:"no-data",colSpan:6,children:"No hay pacientes o no coinciden con la bsqueda."})}):ke.map(x=>u.jsxs("tr",{className:"row-click",onClick:()=>ye(x),children:[u.jsx("td",{onClick:B=>B.stopPropagation(),children:x.fotoUrl?u.jsx("img",{src:x.fotoUrl,alt:"Foto",style:{width:36,height:36,borderRadius:"50%",objectFit:"cover"}}):u.jsx("div",{className:"avatar-fallback",children:(x.nombreCompleto||"P")[0]})}),u.jsx("td",{children:x.nombreCompleto||x.paciente||""}),u.jsx("td",{children:x.nroDocumento||x.documento||""}),u.jsx("td",{children:x.celular||x.celularPaciente||""}),u.jsx("td",{children:x.email||""}),u.jsx("td",{children:u.jsx("span",{className:"pill pill-ok",children:x.activo?"Activo":"Inactivo"})})]},x.id))})]})}),u.jsxs("div",{className:"footer-actions",children:[u.jsx("button",{type:"button",className:"btn",disabled:i||!v,onClick:()=>z(!1),children:v?"Cargar ms":"No hay ms"}),u.jsxs("div",{className:"hint",children:[a.length," registros cargados"]})]})]}),b&&u.jsxs("div",{className:"odc-modal",role:"dialog","aria-modal":"true",children:[u.jsx("div",{className:"odc-modal-backdrop",onClick:()=>A(!1)}),u.jsxs("div",{className:"odc-card",style:{width:1e3,maxWidth:"95%",maxHeight:"92vh",overflowY:"auto"},children:[u.jsxs("div",{className:"odc-card-header",children:[u.jsx("h3",{className:"odc-title",children:I?"Editar paciente":"Nuevo paciente"}),u.jsx("button",{type:"button",className:"btn",onClick:()=>A(!1),children:""})]}),u.jsxs("form",{onSubmit:ne,children:[u.jsx("div",{className:"form-section-title",children:"Foto del paciente"}),u.jsxs("div",{className:"foto-row",children:[u.jsxs("label",{className:"foto-drop",children:[u.jsx("input",{type:"file",accept:"image/*",onChange:x=>{var B;return Ke(((B=x.target.files)==null?void 0:B[0])||null)},style:{display:"none"}}),D?u.jsx("img",{src:D,alt:"Preview",className:"foto-preview"}):u.jsx("div",{className:"foto-empty",children:"Arrastra o haz clic para cargar"})]}),D&&u.jsx("button",{type:"button",className:"btn",onClick:()=>Ke(null),children:"Quitar foto"})]}),u.jsx("div",{className:"form-section-title",children:"Datos de identificacin"}),u.jsxs("div",{className:"form-grid",children:[u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Tipo de documento *"}),u.jsxs("select",{className:"form-input",value:_.tipoDocumento,onChange:x=>G("tipoDocumento",x.target.value),children:[u.jsx("option",{value:"",children:"Seleccione"}),u.jsx("option",{value:"CC",children:"Cdula"}),u.jsx("option",{value:"TI",children:"Tarjeta de identidad"}),u.jsx("option",{value:"PA",children:"Pasaporte"}),u.jsx("option",{value:"OTRO",children:"Otro"})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Nro. de documento *"}),u.jsx("input",{className:"form-input",value:_.nroDocumento,onChange:x=>G("nroDocumento",x.target.value),placeholder:"Nmero de documento",required:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Nmero de Historia"}),u.jsx("input",{className:"form-input",value:_.nroHistoria,readOnly:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Nombres *"}),u.jsx("input",{className:"form-input",value:_.nombres,onChange:x=>G("nombres",x.target.value),required:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Apellidos *"}),u.jsx("input",{className:"form-input",value:_.apellidos,onChange:x=>G("apellidos",x.target.value),required:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Nombre completo"}),u.jsx("input",{className:"form-input",value:_.nombreCompleto,readOnly:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Sexo *"}),u.jsxs("select",{className:"form-input",value:_.sexo,onChange:x=>G("sexo",x.target.value),required:!0,children:[u.jsx("option",{value:"",children:"Seleccione"}),u.jsx("option",{children:"Masculino"}),u.jsx("option",{children:"Femenino"}),u.jsx("option",{children:"Otro"})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Estado civil *"}),u.jsxs("select",{className:"form-input",value:_.estadoCivil,onChange:x=>G("estadoCivil",x.target.value),required:!0,children:[u.jsx("option",{value:"",children:"Seleccione"}),u.jsx("option",{children:"Soltero"}),u.jsx("option",{children:"Casado"}),u.jsx("option",{children:"Unin libre"}),u.jsx("option",{children:"Divorciado"}),u.jsx("option",{children:"Viudo"})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Pas de nacimiento *"}),u.jsx("input",{className:"form-input",list:"listCountries",value:_.paisNacimiento,onChange:x=>G("paisNacimiento",x.target.value),placeholder:"Escribe y elige",required:!0}),u.jsx("datalist",{id:"listCountries",children:PU.map(x=>u.jsx("option",{value:x},x))})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Ciudad de nacimiento"}),u.jsx("input",{className:"form-input",list:"listCitiesBirth",value:_.ciudadNacimiento,onChange:x=>G("ciudadNacimiento",x.target.value),placeholder:"Escribe y elige"}),u.jsx("datalist",{id:"listCitiesBirth",children:de.map(x=>u.jsx("option",{value:x},x))})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Fecha de ingreso"}),u.jsx("input",{className:"form-input",value:_.fechaIngreso,readOnly:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Fecha de nacimiento *"}),u.jsx("input",{type:"date",className:"form-input",value:_.fechaNacimiento,onChange:x=>G("fechaNacimiento",x.target.value),required:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Edad"}),u.jsx("input",{className:"form-input",value:_.edad,readOnly:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Pas de domicilio *"}),u.jsx("input",{className:"form-input",list:"listCountries",value:_.paisDomicilio,onChange:x=>G("paisDomicilio",x.target.value),required:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Ciudad de domicilio *"}),u.jsx("input",{className:"form-input",list:"listCitiesHome",value:_.ciudadDomicilio,onChange:x=>G("ciudadDomicilio",x.target.value),required:!0}),u.jsx("datalist",{id:"listCitiesHome",children:(lT[_.paisDomicilio]||[]).map(x=>u.jsx("option",{value:x},x))})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Barrio *"}),u.jsx("input",{className:"form-input",value:_.barrio,onChange:x=>G("barrio",x.target.value),required:!0,placeholder:"Barrio"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Lugar de residencia *"}),u.jsx("input",{className:"form-input",value:_.lugarResidencia,onChange:x=>G("lugarResidencia",x.target.value),required:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Estrato"}),u.jsxs("select",{className:"form-input",value:_.estrato,onChange:x=>G("estrato",x.target.value),children:[u.jsx("option",{value:"",children:"Seleccione"}),u.jsx("option",{children:"1"}),u.jsx("option",{children:"2"}),u.jsx("option",{children:"3"}),u.jsx("option",{children:"4"}),u.jsx("option",{children:"5"}),u.jsx("option",{children:"6"})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Zona residencial *"}),u.jsxs("select",{className:"form-input",value:_.zonaResidencial,onChange:x=>G("zonaResidencial",x.target.value),required:!0,children:[u.jsx("option",{value:"",children:"Seleccione"}),u.jsx("option",{children:"Urbana"}),u.jsx("option",{children:"Rural"})]})]}),u.jsxs("div",{className:"checkbox-cell",children:[u.jsx("label",{className:"form-label",children:"Es extranjero?"}),u.jsx("input",{type:"checkbox",checked:_.esExtranjero,onChange:x=>G("esExtranjero",x.target.checked)})]}),u.jsxs("div",{className:"checkbox-cell",children:[u.jsx("label",{className:"form-label",children:"Permite publicidad?"}),u.jsx("input",{type:"checkbox",checked:_.permitePublicidad,onChange:x=>G("permitePublicidad",x.target.checked)})]})]}),u.jsx("div",{className:"form-section-title",children:"Contacto"}),u.jsxs("div",{className:"form-grid",children:[u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Celular *"}),u.jsx("input",{className:"form-input",value:_.celular,onChange:x=>G("celular",x.target.value),required:!0,placeholder:"Celular del paciente"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Telfono de domicilio"}),u.jsx("input",{className:"form-input",value:_.telDomicilio,onChange:x=>G("telDomicilio",x.target.value)})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Telfono de oficina"}),u.jsx("input",{className:"form-input",value:_.telOficina,onChange:x=>G("telOficina",x.target.value)})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Extensin"}),u.jsx("input",{className:"form-input",value:_.extension,onChange:x=>G("extension",x.target.value)})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Correo electrnico *"}),u.jsx("input",{type:"email",className:"form-input",value:_.email,onChange:x=>G("email",x.target.value),required:!0,placeholder:"correo@dominio.com"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Ocupacin *"}),u.jsx("input",{className:"form-input",value:_.ocupacion,onChange:x=>G("ocupacion",x.target.value),required:!0})]})]}),u.jsx("div",{className:"form-section-title",children:"Datos de facturacin"}),u.jsxs("div",{className:"form-grid",children:[u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Responsable"}),u.jsx("input",{className:"form-input",value:_.nombreResponsable,onChange:x=>G("nombreResponsable",x.target.value)})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Parentesco"}),u.jsxs("select",{className:"form-input",value:_.parentesco,onChange:x=>G("parentesco",x.target.value),children:[u.jsx("option",{value:"",children:"Seleccione"}),u.jsx("option",{children:"Padre/Madre"}),u.jsx("option",{children:"Hermano"}),u.jsx("option",{children:"Esposo/a"}),u.jsx("option",{children:"Otro"})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Celular"}),u.jsx("input",{className:"form-input",value:_.celularResponsable,onChange:x=>G("celularResponsable",x.target.value)})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Telfono"}),u.jsx("input",{className:"form-input",value:_.telefonoResponsable,onChange:x=>G("telefonoResponsable",x.target.value)})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Correo electrnico"}),u.jsx("input",{type:"email",className:"form-input",value:_.emailResponsable,onChange:x=>G("emailResponsable",x.target.value)})]})]}),u.jsx("div",{className:"form-section-title",children:"Acompaante"}),u.jsxs("div",{className:"form-grid",children:[u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Nombre"}),u.jsx("input",{className:"form-input",value:_.nombreAcompanante,onChange:x=>G("nombreAcompanante",x.target.value),placeholder:"Nombre acompaante"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Telfono"}),u.jsx("input",{className:"form-input",value:_.telefonoAcompanante,onChange:x=>G("telefonoAcompanante",x.target.value),placeholder:"Telfono acompaante"})]})]}),u.jsx("div",{className:"form-section-title",children:"Mercadeo"}),u.jsxs("div",{className:"form-grid",children:[u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Convenio beneficio"}),u.jsx("input",{className:"form-input",value:_.convenioBeneficio,onChange:x=>G("convenioBeneficio",x.target.value)})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Cmo nos conoci?"}),u.jsxs("select",{className:"form-input",value:_.comoConocio,onChange:x=>G("comoConocio",x.target.value),children:[u.jsx("option",{value:"",children:"Seleccione"}),u.jsx("option",{children:"Redes sociales"}),u.jsx("option",{children:"Publicidad"}),u.jsx("option",{children:"Recomendacin"}),u.jsx("option",{children:"Otro"})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Campaa"}),u.jsx("input",{className:"form-input",value:_.campania,onChange:x=>G("campania",x.target.value)})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Remitido por"}),u.jsx("input",{className:"form-input",value:_.remitidoPor,onChange:x=>G("remitidoPor",x.target.value)})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Asesor comercial"}),u.jsx("input",{className:"form-input",value:_.asesorComercial,onChange:x=>G("asesorComercial",x.target.value)})]})]}),u.jsx("div",{className:"form-section-title",children:"EPS"}),u.jsxs("div",{className:"form-grid",children:[u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Tipo de vinculacin *"}),u.jsxs("select",{className:"form-input",value:_.tipoVinculacion,onChange:x=>G("tipoVinculacion",x.target.value),required:!0,children:[u.jsx("option",{value:"",children:"Seleccione"}),u.jsx("option",{children:"Contributivo"}),u.jsx("option",{children:"Subsidiado"}),u.jsx("option",{children:"Particular"}),u.jsx("option",{children:"Otro"})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Nombre de la EPS *"}),u.jsx("input",{className:"form-input",list:"listEps",value:_.nombreEps,onChange:x=>G("nombreEps",x.target.value),placeholder:"Escribe y selecciona",required:!0}),u.jsx("datalist",{id:"listEps",children:Y.map(x=>u.jsx("option",{value:x},x))})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Pliza de salud"}),u.jsx("input",{className:"form-input",value:_.polizaSalud,onChange:x=>G("polizaSalud",x.target.value)})]})]}),u.jsx("div",{className:"form-section-title",children:"Doctor"}),u.jsx("div",{className:"form-grid",children:u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Doctor"}),u.jsx("input",{className:"form-input",value:_.doctor,onChange:x=>G("doctor",x.target.value),placeholder:"Usuario / Libre"})]})}),u.jsx("div",{className:"form-section-title",children:"Alertas y Notas"}),u.jsx("div",{className:"form-grid",children:u.jsx("textarea",{className:"form-input",rows:3,value:_.notas,onChange:x=>G("notas",x.target.value),placeholder:"Notas del paciente"})}),u.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:8,marginTop:12},children:[I?u.jsx("button",{type:"button",className:"btn",onClick:()=>xe({id:I,nombreCompleto:_.nombreCompleto}),children:"Eliminar"}):u.jsx("div",{}),u.jsxs("div",{style:{display:"flex",gap:8},children:[u.jsx("button",{type:"button",className:"btn",onClick:()=>A(!1),children:"Cancelar"}),u.jsx("button",{type:"submit",className:"btn blue",children:I?"Actualizar":"Guardar paciente"})]})]})]})]})]}),y&&u.jsxs("div",{className:"odc-modal",role:"dialog","aria-modal":"true",children:[u.jsx("div",{className:"odc-modal-backdrop",onClick:Xe}),u.jsxs("div",{className:"odc-card ficha-card",children:[u.jsxs("div",{className:"ficha-header",children:[u.jsxs("div",{className:"ficha-header-left",children:[y.fotoUrl?u.jsx("img",{src:y.fotoUrl,alt:"Foto",className:"ficha-avatar"}):u.jsx("div",{className:"avatar-fallback ficha-avatar-fallback",children:(y.nombreCompleto||"P")[0]}),u.jsxs("div",{children:[u.jsx("div",{className:"ficha-nombre",children:y.nombreCompleto||""}),u.jsxs("div",{className:"ficha-doc",children:[y.tipoDocumento||""," ",y.nroDocumento||""]}),u.jsxs("div",{className:"ficha-badges",children:[u.jsx("span",{className:"ficha-badge blue",children:"En valoracin"}),u.jsx("span",{className:"ficha-badge green",children:"Sin deuda"})]})]})]}),u.jsx("div",{className:"ficha-header-right",children:u.jsxs("div",{className:"ficha-actions",children:[u.jsx("button",{type:"button",className:"btn",onClick:Xe,children:"Cerrar"}),u.jsx("button",{type:"button",className:"btn blue",onClick:Ie,children:"Editar"}),u.jsx("button",{type:"button",className:"btn green",onClick:()=>t(s(ku.caja,{cobro:1,patientId:y.id})),title:"Ir a Caja para cobrar a este paciente",children:"Cobrar"})]})})]}),u.jsxs("div",{className:"ficha-body",children:[u.jsxs("aside",{className:"ficha-sidebar",children:[u.jsx("div",{className:"ficha-sidebar-title",children:"Informacin general"}),u.jsx("button",{type:"button",className:`ficha-link ${M==="datos"?"active":""}`,onClick:()=>T("datos"),children:"Datos personales"}),u.jsx("button",{type:"button",className:`ficha-link ${M==="marketing"?"active":""}`,onClick:()=>T("marketing"),children:"Marketing"}),u.jsx("button",{type:"button",className:`ficha-link ${M==="eps"?"active":""}`,onClick:()=>T("eps"),children:"EPS"}),u.jsx("button",{type:"button",className:`ficha-link ${M==="prof"?"active":""}`,onClick:()=>T("prof"),children:"Profesionales"}),u.jsx("button",{type:"button",className:`ficha-link ${M==="rx"?"active":""}`,onClick:()=>T("rx"),children:"Rx/Imgenes/Doc"}),u.jsx("button",{type:"button",className:`ficha-link ${M==="citas"?"active":""}`,onClick:()=>T("citas"),children:"Citas"}),u.jsx("button",{type:"button",className:`ficha-link ${M==="crm"?"active":""}`,onClick:()=>T("crm"),children:"CRM"}),u.jsx("div",{className:"ficha-sidebar-title mt",children:"Historia clnica"}),u.jsx("button",{type:"button",className:`ficha-link ${M==="doc"?"active":""}`,onClick:()=>T("doc"),children:"Doc. Clnicos"}),u.jsx("button",{type:"button",className:`ficha-link ${M==="odonto"?"active":""}`,onClick:()=>T("odonto"),children:"Odontogramas"}),u.jsx("button",{type:"button",className:`ficha-link ${M==="perio"?"active":""}`,onClick:()=>T("perio"),children:"Periodontogramas"}),u.jsx("button",{type:"button",className:`ficha-link ${M==="presu"?"active":""}`,onClick:()=>T("presu"),children:"Presupuestos"}),u.jsx("button",{type:"button",className:`ficha-link ${M==="evo"?"active":""}`,onClick:()=>T("evo"),children:"Evoluciones"}),u.jsx("div",{className:"ficha-sidebar-title mt",children:"Facturacin"}),u.jsx("button",{type:"button",className:`ficha-link ${M==="fact"?"active":""}`,onClick:()=>T("fact"),children:"Resumen"}),u.jsxs("div",{className:"ficha-sidebar-actions",style:{display:"grid",gap:8,marginTop:8},children:[u.jsx("button",{type:"button",className:"btn pay",onClick:()=>t(s(ku.caja,{cobro:1,patientId:y.id})),title:"Cobrar a este paciente",children:"Realizar pago"}),u.jsx("button",{type:"button",className:"btn history",onClick:()=>r(`${ku.pagos}?patientId=${encodeURIComponent(y.id)}`),title:"Ver histrico de pagos",children:"Histrico de pagos"}),u.jsx("button",{type:"button",className:"btn history",onClick:()=>r(`${ku.facturas}?patientId=${encodeURIComponent(y.id)}`),title:"Ver histrico de facturacin",children:"Histrico de facturacin"})]})]}),u.jsxs("main",{className:"ficha-content",children:[M==="datos"&&u.jsxs("section",{className:"ficha-section",children:[u.jsx("h4",{className:"ficha-section-title",children:"Datos personales"}),u.jsx("div",{className:"ficha-grid",children:[["Tipo de documento",y.tipoDocumento],["Nro. de documento",y.nroDocumento],["Nmero de Historia",y.nroHistoria],["Fecha de ingreso",y.fechaIngreso],["Nombres",y.nombres],["Apellidos",y.apellidos],["Nombre completo",y.nombreCompleto],["Sexo",y.sexo],["Estado civil",y.estadoCivil],["Pas de nacimiento",y.paisNacimiento],["Ciudad de nacimiento",y.ciudadNacimiento],["Fecha de nacimiento",y.fechaNacimiento],["Edad",y.edad],["Pas de domicilio",y.paisDomicilio],["Ciudad de domicilio",y.ciudadDomicilio],["Barrio",y.barrio],["Lugar de residencia",y.lugarResidencia],["Estrato",y.estrato],["Zona residencial",y.zonaResidencial],["Extranjero",y.esExtranjero?"S":"No"],["Permite publicidad",y.permitePublicidad?"S":"No"],["Celular",y.celular||y.celularPaciente],["Telfono domicilio",y.telDomicilio||y.telefonoPaciente],["Telfono oficina",y.telOficina],["Extensin",y.extension],["Correo electrnico",y.email],["Ocupacin",y.ocupacion],["Responsable",y.nombreResponsable],["Parentesco",y.parentesco],["Cel. responsable",y.celularResponsable],["Tel. responsable",y.telefonoResponsable],["Email responsable",y.emailResponsable],["Acompaante",y.nombreAcompanante],["Tel. acompaante",y.telefonoAcompanante]].map(([x,B])=>u.jsxs("div",{className:"field",children:[u.jsx("label",{children:x}),u.jsx("input",{className:"form-input",value:B||"",readOnly:!0})]},x))})]}),M==="marketing"&&u.jsxs("section",{className:"ficha-section",children:[u.jsx("h4",{className:"ficha-section-title",children:"Marketing"}),u.jsx("div",{className:"ficha-grid",children:[["Convenio beneficio",y.convenioBeneficio],["Cmo nos conoci?",y.comoConocio],["Campaa",y.campania],["Remitido por",y.remitidoPor],["Asesor comercial",y.asesorComercial]].map(([x,B])=>u.jsxs("div",{className:"field",children:[u.jsx("label",{children:x}),u.jsx("input",{className:"form-input",value:B||"",readOnly:!0})]},x))})]}),M==="eps"&&u.jsxs("section",{className:"ficha-section",children:[u.jsx("h4",{className:"ficha-section-title",children:"EPS"}),u.jsx("div",{className:"ficha-grid",children:[["Tipo de vinculacin",y.tipoVinculacion],["Nombre EPS",y.nombreEps],["Pliza de salud",y.polizaSalud]].map(([x,B])=>u.jsxs("div",{className:"field",children:[u.jsx("label",{children:x}),u.jsx("input",{className:"form-input",value:B||"",readOnly:!0})]},x))})]}),M==="prof"&&u.jsxs("section",{className:"ficha-section",children:[u.jsx("h4",{className:"ficha-section-title",children:"Profesionales"}),u.jsx("div",{className:"ficha-grid",children:u.jsxs("div",{className:"field",children:[u.jsx("label",{children:"Doctor"}),u.jsx("input",{className:"form-input",value:y.doctor||"",readOnly:!0})]})})]}),M==="rx"&&u.jsxs("section",{className:"ficha-section",children:[u.jsx("h4",{className:"ficha-section-title",children:"Rx / Imgenes / Documentos"}),u.jsxs("div",{className:"rx-actions",children:[u.jsxs("label",{className:"btn blue",children:["Subir archivos",u.jsx("input",{ref:J,type:"file",multiple:!0,accept:"image/*,.pdf,.doc,.docx,.xls,.xlsx",style:{display:"none"},onChange:x=>Oe([...x.target.files||[]])})]}),Lt&&u.jsx("span",{className:"hint",style:{marginLeft:10},children:"Subiendo"})]}),u.jsxs("div",{className:"rx-grid",children:[(y.rxImagenes||[]).map((x,B)=>{var ie;return u.jsxs("div",{className:"rx-item",children:[(ie=x.type)!=null&&ie.startsWith("image/")?u.jsx("a",{href:x.url,target:"_blank",rel:"noreferrer",children:u.jsx("img",{src:x.url,alt:x.name})}):u.jsx("a",{className:"rx-file",href:x.url,target:"_blank",rel:"noreferrer",children:x.name||"archivo"}),u.jsxs("div",{className:"rx-meta",children:[u.jsx("span",{children:x.name}),u.jsx("button",{type:"button",className:"btn small",onClick:()=>it(B),children:"Eliminar"})]})]},`${x.url}-${B}`)}),(!y.rxImagenes||y.rxImagenes.length===0)&&u.jsx("div",{className:"no-data",children:"Sin archivos an."})]})]}),M==="doc"&&u.jsxs("section",{className:"ficha-section",children:[u.jsx("h4",{className:"ficha-section-title",children:"Doc. Clnicos"}),u.jsxs("div",{className:"ficha-grid",children:[u.jsxs("div",{className:"field",children:[u.jsx("label",{children:"Motivo de consulta"}),u.jsx("textarea",{className:"form-input",rows:3,value:((Fe=y.historiaClinica)==null?void 0:Fe.motivoConsulta)||"",onChange:x=>Ge("motivoConsulta",x.target.value)})]}),u.jsxs("div",{className:"field",children:[u.jsx("label",{children:"Antecedentes"}),u.jsx("textarea",{className:"form-input",rows:3,value:((ge=y.historiaClinica)==null?void 0:ge.antecedentes)||"",onChange:x=>Ge("antecedentes",x.target.value)})]}),u.jsxs("div",{className:"field",children:[u.jsx("label",{children:"Alergias"}),u.jsx("textarea",{className:"form-input",rows:2,value:((He=y.historiaClinica)==null?void 0:He.alergias)||"",onChange:x=>Ge("alergias",x.target.value)})]}),u.jsxs("div",{className:"field",children:[u.jsx("label",{children:"Medicamentos"}),u.jsx("textarea",{className:"form-input",rows:2,value:((F=y.historiaClinica)==null?void 0:F.medicamentos)||"",onChange:x=>Ge("medicamentos",x.target.value)})]}),u.jsxs("div",{className:"field",children:[u.jsx("label",{children:"Notas"}),u.jsx("textarea",{className:"form-input",rows:3,value:((Z=y.historiaClinica)==null?void 0:Z.notas)||"",onChange:x=>Ge("notas",x.target.value)})]})]})]}),M==="odonto"&&u.jsxs("section",{className:"ficha-section",children:[u.jsx("h4",{className:"ficha-section-title",children:"Odontograma (placeholder)"}),u.jsx("div",{className:"odont-grid",children:Array.from({length:32},(x,B)=>B+1).map(x=>{const B=(y.odontograma||[]).some(ie=>ie.pieza===x);return u.jsx("button",{type:"button",className:`tooth ${B?"on":""}`,onClick:()=>Q("odontograma",x),title:`Pieza ${x}`,children:x},x)})})]}),M==="perio"&&u.jsxs("section",{className:"ficha-section",children:[u.jsx("h4",{className:"ficha-section-title",children:"Periodontograma (placeholder)"}),u.jsx("div",{className:"odont-grid",children:Array.from({length:32},(x,B)=>B+1).map(x=>{const B=(y.periodontograma||[]).some(ie=>ie.pieza===x);return u.jsx("button",{type:"button",className:`tooth ${B?"on":""}`,onClick:()=>Q("periodontograma",x),title:`Pieza ${x}`,children:x},x)})})]}),M==="presu"&&u.jsxs("section",{className:"ficha-section",children:[u.jsx("h4",{className:"ficha-section-title",children:"Presupuestos & planes"}),u.jsx(VU,{onAdd:pt}),u.jsxs("div",{className:"presu-list",children:[(y.presupuestos||[]).map(x=>u.jsxs("div",{className:"presu-item",children:[u.jsxs("div",{children:[u.jsx("div",{className:"presu-title",children:x.titulo}),u.jsxs("div",{className:"presu-meta",children:["Costo: $",x.costo||0,"  Estado: ",x.estado||"Pendiente"]})]}),u.jsx("button",{type:"button",className:"btn small",onClick:()=>q(x.id),children:"Eliminar"})]},x.id)),(!y.presupuestos||y.presupuestos.length===0)&&u.jsx("div",{className:"no-data",children:"Sin presupuestos an."})]})]}),M==="evo"&&u.jsxs("section",{className:"ficha-section",children:[u.jsx("h4",{className:"ficha-section-title",children:"Evoluciones & Remisiones"}),u.jsx(LU,{onAdd:se}),u.jsxs("div",{className:"evo-list",children:[(y.evoluciones||[]).map(x=>u.jsxs("div",{className:"evo-item",children:[u.jsx("div",{className:"evo-date",children:new Date(x.fechaISO).toLocaleString()}),u.jsx("div",{className:"evo-note",children:x.nota}),u.jsx("button",{type:"button",className:"btn small",onClick:()=>X(x.id),children:"Eliminar"})]},x.id)),(!y.evoluciones||y.evoluciones.length===0)&&u.jsx("div",{className:"no-data",children:"Sin evoluciones an."})]})]}),M==="fact"&&u.jsxs("section",{className:"ficha-section",children:[u.jsx("h4",{className:"ficha-section-title",children:"Facturacin"}),u.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(220px,1fr))",gap:12},children:[u.jsx(Eo,{title:"Total facturado",value:`$ ${we.totalFacturado.toLocaleString()}`}),u.jsx(Eo,{title:"Total pagado",value:`$ ${we.totalPagado.toLocaleString()}`}),u.jsx(Eo,{title:"Facturas pendientes",value:`$ ${we.totalFacturasPendientes.toLocaleString()}`}),u.jsx(Eo,{title:"Saldo pendiente (facturas - pagos)",value:`$ ${(we.totalFacturado-we.totalPagado).toLocaleString()}`}),u.jsx(Eo,{title:"Saldo a favor",value:`$ ${(((ae=y.facturacion)==null?void 0:ae.saldoFavor)??0).toLocaleString()}`}),u.jsx(Eo,{title:"Saldo crdito",value:`$ ${(((Ae=y.facturacion)==null?void 0:Ae.saldoCredito)??0).toLocaleString()}`})]}),we.error&&u.jsxs("div",{className:"hint",style:{marginTop:6},children:[" ",we.error]}),u.jsxs("div",{className:"ficha-grid",style:{marginTop:12},children:[u.jsxs("div",{className:"field",children:[u.jsx("label",{children:"Saldo a favor"}),u.jsx("input",{type:"number",className:"form-input",value:((vt=y.facturacion)==null?void 0:vt.saldoFavor)??0,onChange:x=>re({facturacion:{...y.facturacion||{},saldoFavor:Number(x.target.value||0)}})})]}),u.jsxs("div",{className:"field",children:[u.jsx("label",{children:"Saldo crdito"}),u.jsx("input",{type:"number",className:"form-input",value:((Mt=y.facturacion)==null?void 0:Mt.saldoCredito)??0,onChange:x=>re({facturacion:{...y.facturacion||{},saldoCredito:Number(x.target.value||0)}})})]})]}),u.jsxs("div",{style:{marginTop:14,display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:[u.jsxs("div",{className:"mini-card",children:[u.jsx("div",{className:"mini-card-title",children:"ltimas facturas"}),u.jsx("div",{className:"table-wrap",children:u.jsxs("table",{className:"appointments-table",children:[u.jsx("thead",{children:u.jsxs("tr",{children:[u.jsx("th",{children:"Fecha"}),u.jsx("th",{children:"Estado"}),u.jsx("th",{children:"Total"})]})}),u.jsxs("tbody",{children:[we.facturas.slice(0,8).map(x=>u.jsxs("tr",{children:[u.jsx("td",{children:x.fechaISO?new Date(x.fechaISO).toLocaleString():""}),u.jsx("td",{children:String(x.estado||"").toUpperCase()}),u.jsxs("td",{children:["$",(x.total||0).toLocaleString()]})]},x.id)),we.facturas.length===0&&u.jsx("tr",{children:u.jsx("td",{className:"no-data",colSpan:3,children:"Sin facturas."})})]})]})})]}),u.jsxs("div",{className:"mini-card",children:[u.jsx("div",{className:"mini-card-title",children:"ltimos pagos"}),u.jsx("div",{className:"table-wrap",children:u.jsxs("table",{className:"appointments-table",children:[u.jsx("thead",{children:u.jsxs("tr",{children:[u.jsx("th",{children:"Fecha"}),u.jsx("th",{children:"Medio"}),u.jsx("th",{children:"Monto"})]})}),u.jsxs("tbody",{children:[we.pagos.slice(0,8).map(x=>u.jsxs("tr",{children:[u.jsx("td",{children:x.fechaISO?new Date(x.fechaISO).toLocaleString():""}),u.jsx("td",{children:x.medio}),u.jsxs("td",{children:["$",(x.monto||0).toLocaleString()]})]},x.id)),we.pagos.length===0&&u.jsx("tr",{children:u.jsx("td",{className:"no-data",colSpan:3,children:"Sin pagos."})})]})]})})]})]})]}),M==="citas"&&u.jsxs("section",{className:"ficha-section",children:[u.jsx("h4",{className:"ficha-section-title",children:"Citas"}),u.jsxs("div",{className:"mini-card",style:{marginBottom:12},children:[u.jsx("div",{className:"mini-card-title",children:"Nueva cita rpida"}),u.jsxs("div",{style:{display:"grid",gridTemplateColumns:"150px 120px 1fr 1fr auto",gap:8},children:[u.jsx("input",{id:"citaDate",type:"date",className:"form-input",defaultValue:new Date().toISOString().slice(0,10)}),u.jsx("input",{id:"citaTime",type:"time",className:"form-input",defaultValue:"09:00"}),u.jsx("input",{id:"citaMotivo",className:"form-input",placeholder:"Motivo (opcional)"}),u.jsx("input",{id:"citaProf",className:"form-input",placeholder:"Profesional (opcional)",defaultValue:(y==null?void 0:y.doctor)||""}),u.jsx("button",{type:"button",className:"btn blue",onClick:()=>{const x=document.getElementById("citaDate").value,B=document.getElementById("citaTime").value||"09:00",ie=document.getElementById("citaMotivo").value||"",pe=document.getElementById("citaProf").value||"";if(!x)return alert("Selecciona la fecha de la cita.");fe({dateISO:x,timeHHMM:B,motivo:ie,profesional:pe})},children:"Guardar cita"})]})]}),u.jsx("div",{className:"table-wrap",children:u.jsxs("table",{className:"appointments-table",children:[u.jsx("thead",{children:u.jsxs("tr",{children:[u.jsx("th",{children:"Fecha"}),u.jsx("th",{children:"Estado"}),u.jsx("th",{children:"Motivo"}),u.jsx("th",{children:"Profesional / Acciones"})]})}),u.jsx("tbody",{children:qe?u.jsx("tr",{children:u.jsx("td",{className:"no-data",colSpan:4,children:"Cargando"})}):Se.length===0?u.jsx("tr",{children:u.jsx("td",{className:"no-data",colSpan:4,children:"Sin citas registradas."})}):Se.map(x=>u.jsxs("tr",{children:[u.jsx("td",{children:x.fechaISO?new Date(x.fechaISO).toLocaleString():""}),u.jsx("td",{children:x.estado||""}),u.jsx("td",{children:x.motivo||""}),u.jsx("td",{children:u.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[u.jsx("span",{children:x.profesional||""}),u.jsx("button",{type:"button",className:"btn small",onClick:()=>{const B=x.fechaISO?new Date(x.fechaISO):null,ie=B?B.toISOString().slice(0,10):"";r(`agenda?date=${encodeURIComponent(ie)}&patientId=${encodeURIComponent(y.id)}`)},title:"Abrir en Agenda",children:"Ver en Agenda"})]})})]},x.id))})]})})]}),M==="crm"&&u.jsxs("section",{className:"ficha-section",children:[u.jsx("h4",{className:"ficha-section-title",children:"CRM"}),u.jsx("div",{className:"no-data",children:"Notas / recordatorios comerciales del paciente."})]}),u.jsx("div",{className:"ficha-footer"})]})]})]})]})]})}function Eo({title:t,value:e}){return u.jsxs("div",{className:"mini-card",children:[u.jsx("div",{className:"mini-card-title",children:t}),u.jsx("div",{style:{fontWeight:700,fontSize:20,marginTop:6},children:e})]})}function VU({onAdd:t}){const[e,n]=N.useState(""),[r,s]=N.useState(""),[i,o]=N.useState("Pendiente");return u.jsxs("div",{className:"presu-form",children:[u.jsx("input",{className:"form-input",placeholder:"Procedimiento / plan",value:e,onChange:a=>n(a.target.value)}),u.jsx("input",{type:"number",className:"form-input",placeholder:"Costo",value:r,onChange:a=>s(a.target.value)}),u.jsxs("select",{className:"form-input",value:i,onChange:a=>o(a.target.value),children:[u.jsx("option",{children:"Pendiente"}),u.jsx("option",{children:"Aprobado"}),u.jsx("option",{children:"Rechazado"})]}),u.jsx("button",{type:"button",className:"btn blue",onClick:()=>{if(!e)return alert("Ttulo requerido");t({titulo:e,costo:Number(r||0),estado:i}),n(""),s(""),o("Pendiente")},children:"Agregar"})]})}function LU({onAdd:t}){const[e,n]=N.useState("");return u.jsxs("div",{className:"evo-form",children:[u.jsx("textarea",{className:"form-input",rows:2,placeholder:"Escribe la evolucin / remisin",value:e,onChange:r=>n(r.target.value)}),u.jsx("button",{type:"button",className:"btn blue",onClick:()=>{e.trim()&&(t(e.trim()),n(""))},children:"Guardar evolucin"})]})}function MU(){return u.jsxs("div",{style:{padding:"20px"},children:[u.jsx("h2",{children:"Mdulo de Facturacin"}),u.jsx("p",{children:"Aqu se registrarn los pagos, facturas y cobros."})]})}const Er=t=>(Number(t)||0).toLocaleString("es-CO",{maximumFractionDigits:0}),Io=()=>new Date().toISOString().slice(0,10),FU=(t=new Date)=>new Date(t.getFullYear(),t.getMonth(),t.getDate(),0,0,0,0),UU=(t=new Date)=>new Date(t.getFullYear(),t.getMonth(),t.getDate()+1,0,0,0,0),uT=t=>Be.fromDate(t),$U=()=>{const[t,e]=N.useState(null);return N.useEffect(()=>{const n=Iy(dh,r=>e(r||null));return()=>n()},[]),t},Ut=({children:t,align:e})=>u.jsx("th",{className:"oc-th",style:{position:"sticky",top:0,zIndex:1,textAlign:e||"left",background:"var(--oc-surface, #fff)"},children:t}),BU=()=>Math.random().toString(36).slice(2)+Math.random().toString(36).slice(2);function zU(){var He;const t=$U(),e=[{key:"abrir",label:"Abrir caja",icon:""},{key:"abiertas",label:"Cajas abiertas",icon:""},{key:"cerradas",label:"Cajas cerradas",icon:""},{key:"mio",label:"Mi caja (hoy)",icon:""},{key:"simulados",label:"Cierres simulados",icon:""},{key:"bancos",label:"Bancos",icon:""}],[n,r]=N.useState("abiertas"),[s,i]=N.useState(""),[o,a]=N.useState(""),l=N.useRef(null),[d,h]=N.useState(!1),[f,m]=N.useState(""),[v,R]=N.useState([]),[b,A]=N.useState(!0),[I,w]=N.useState([]),[y,j]=N.useState(!0),[V,M]=N.useState(null),[T,_]=N.useState(!0),[S,C]=N.useState(""),[k,D]=N.useState([]),[P,Y]=N.useState(null),[Ye,Lt]=N.useState(""),[en,J]=N.useState("efectivo"),[de,G]=N.useState(!1),[je,Ke]=N.useState("ingreso"),[z,ne]=N.useState(""),[he,Ie]=N.useState(""),[xe,ke]=N.useState(!1),[ye,Xe]=N.useState([]),[be,re]=N.useState([]);N.useEffect(()=>{const F=rt(Ue(_e,"cajas"),Je("estado","==","abierta"),Xt("fechaApertura","desc")),Z=ir(F,ae=>{R(ae.docs.map(Ae=>Oe(Ae.id,Ae.data()))),A(!1),i("")},ae=>{console.error(ae),i((ae==null?void 0:ae.code)==="failed-precondition"?"Falta ndice (estado, fechaApertura) en Firestore.":(ae==null?void 0:ae.code)==="permission-denied"?"Permiso denegado en Firestore (revisa reglas).":"No se pudieron leer las cajas."),A(!1)});return()=>Z()},[]),N.useEffect(()=>{const F=rt(Ue(_e,"cajas"),Je("estado","==","cerrada"),Xt("fechaCierre","desc")),Z=ir(F,ae=>{w(ae.docs.map(Ae=>Oe(Ae.id,Ae.data()))),j(!1)},ae=>{console.error(ae),j(!1)});return()=>Z()},[]),N.useEffect(()=>{if(!t){M(null),_(!1);return}_(!0);const F=rt(Ue(_e,"cajas"),Je("estado","==","abierta"),Je("usuarioId","==",t.uid),Je("fechaApertura",">=",uT(FU())),Je("fechaApertura","<",uT(UU()))),Z=ir(F,ae=>{const Ae=ae.docs[0];M(Ae?Oe(Ae.id,Ae.data()):null),_(!1)},ae=>{console.error(ae),_(!1),(ae==null?void 0:ae.code)==="failed-precondition"&&i("Falta ndice (estado, usuarioId, fechaApertura) en Firestore.")});return()=>Z()},[t]),N.useEffect(()=>{if(!(V!=null&&V.id)){Xe([]),re([]);return}const F=rt(Ue(_e,"movimientos"),Je("cashId","==",V.id),Je("dia","==",Io()),Xt("fecha","desc")),Z=ir(F,vt=>Xe(vt.docs.map(Mt=>({id:Mt.id,...Mt.data()}))),vt=>console.error(vt)),ae=rt(Ue(_e,"payments"),Je("cashId","==",V.id),Je("dia","==",Io()),Xt("fecha","desc")),Ae=ir(ae,vt=>re(vt.docs.map(Mt=>({id:Mt.id,...Mt.data()}))),vt=>console.error(vt));return()=>{Z(),Ae()}},[V==null?void 0:V.id]),N.useEffect(()=>{if(!(S!=null&&S.trim())){D([]);return}const F=rt(Ue(_e,"patients"),Je("q",">=",X(S)),Je("q","<=",X(S)+""),Xt("q","asc")),Z=ir(F,ae=>D(ae.docs.map(Ae=>({id:Ae.id,...Ae.data()}))),ae=>console.error(ae));return()=>Z()},[S]);function Oe(F,Z={}){const ae=ce=>{var Re;return((Re=ce==null?void 0:ce.toDate)==null?void 0:Re.call(ce))||(typeof ce=="string"?new Date(ce):ce||null)},Ae=ae(Z.fechaApertura),vt=ae(Z.fechaCierre),Mt=Number(Z.baseInicial||0),x=Number(Z.baseActual!==void 0?Z.baseActual:Mt),B=Number(Z.saldoInicial||0),ie=Number(Z.saldoActual!==void 0?Z.saldoActual:B),pe=[];return ie<0&&pe.push("Saldo negativo"),x<0&&pe.push("Base negativa"),{id:F,estado:Z.estado||"abierta",usuarioId:Z.usuarioId||"",usuarioNombre:Z.usuarioNombre||"Usuario",nombre:Z.nombre||Z.usuarioNombre||"Caja",fechaApertura:Ae,fechaCierre:vt,baseInicial:Mt,baseActual:x,saldoInicial:B,saldoActual:ie,ia:pe}}const it=async F=>{var Z;if((Z=F==null?void 0:F.preventDefault)==null||Z.call(F),!t){i("Debes iniciar sesin para abrir una caja.");return}h(!0);try{const ae=Number(f||0);await Il(Ue(_e,"cajas"),{estado:"abierta",usuarioId:t.uid,usuarioNombre:t.displayName||t.email||"Usuario",fechaApertura:In(),baseInicial:ae,baseActual:ae,saldoInicial:0,saldoActual:0,dia:Io()}),m(""),r("mio"),i("")}catch(ae){console.error(ae),i("No se pudo abrir la caja.")}finally{h(!1)}},Ge=async F=>{try{await ea(zt(_e,"cajas",F),{estado:"cerrada",fechaCierre:In()}),r("cerradas")}catch(Z){console.error(Z),i("No se pudo cerrar la caja.")}},pt=async F=>{var ae;if((ae=F==null?void 0:F.preventDefault)==null||ae.call(F),!(V!=null&&V.id)){i("Debes abrir tu caja para registrar movimientos.");return}const Z=Number(he||0);if(!(!Z||Z<=0)){ke(!0);try{await Il(Ue(_e,"movimientos"),{cashId:V.id,tipo:je,concepto:z||(je==="ingreso"?"Ingreso":"Egreso"),valor:Z,fecha:In(),dia:Io(),usuarioId:(t==null?void 0:t.uid)||null});const Ae=je==="ingreso"?Z:-Z;await ea(zt(_e,"cajas",V.id),{saldoActual:FI(Ae)}),ne(""),Ie("")}catch(Ae){console.error(Ae),i("No se pudo registrar el movimiento.")}finally{ke(!1)}}},q=async F=>{var ae;if((ae=F==null?void 0:F.preventDefault)==null||ae.call(F),!(V!=null&&V.id))return i("Abre tu caja para cobrar.");const Z=Number(Ye||0);if(!(!Z||Z<=0)){if(!P)return i("Selecciona un paciente.");G(!0);try{const Ae=await Il(Ue(_e,"payments"),{cashId:V.id,patientId:P.id,patientName:P.nombre||P.name||"Paciente",invoiceId:null,valor:Z,medio:en,estado:"aprobado",fecha:In(),dia:Io()});await ea(zt(_e,"cajas",V.id),{saldoActual:FI(Z)}),Lt(""),J("efectivo"),i(`Pago registrado (${Ae.id}).`)}catch(Ae){console.error(Ae),i("No se pudo registrar el pago.")}finally{G(!1)}}},se=async F=>{var ae;if((ae=F==null?void 0:F.preventDefault)==null||ae.call(F),!(V!=null&&V.id))return i("Abre tu caja para cobrar.");const Z=Number(Ye||0);if(!(!Z||Z<=0)){if(!P)return i("Selecciona un paciente.");G(!0);try{const vt=`https://pay.odontocloud/mock/${BU()}`,Mt=await Il(Ue(_e,"payments"),{cashId:V.id,patientId:P.id,patientName:P.nombre||P.name||"Paciente",invoiceId:null,valor:Z,medio:"link",estado:"pending",linkUrl:vt,fecha:In(),dia:Io()});i(`Link de pago generado: ${vt}`),Lt("")}catch(Ae){console.error(Ae),i("No se pudo generar link de pago.")}finally{G(!1)}}},X=F=>(F||"").toString().normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase(),Q=N.useMemo(()=>{const F=X(o);return F?v.filter(Z=>[Z.nombre,Z.usuarioNombre,Er(Z.saldoActual),Er(Z.baseActual)].map(X).some(ae=>ae.includes(F))):v},[o,v]),fe=()=>u.jsxs("div",{className:"card",children:[u.jsx("div",{className:"oc-card-head",style:{marginBottom:8},children:u.jsx("h3",{children:"Abrir caja"})}),u.jsxs("form",{className:"oc-form",onSubmit:it,style:{display:"flex",gap:12,alignItems:"end",flexWrap:"wrap"},children:[u.jsxs("label",{style:{display:"inline-flex",flexDirection:"column",gap:6},children:[u.jsx("span",{children:"Base inicial (COP)"}),u.jsx("input",{type:"number",className:"oc-input",min:"0",step:"1000",value:f,onChange:F=>m(F.target.value),placeholder:"0"})]}),u.jsx("button",{className:"oc-btn",type:"submit",disabled:d,children:d?"Abriendo...":"Abrir caja"})]}),u.jsxs("p",{className:"oc-muted",style:{marginTop:8},children:["Se asociar a tu usuario y quedar visible en ",u.jsx("b",{children:"Mi caja (hoy)"}),"."]})]}),Ce=()=>u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"card",style:{marginBottom:10},children:u.jsxs("div",{className:"oc-card-head",style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[u.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[u.jsx("h3",{style:{margin:0},children:"Cajas Abiertas"}),u.jsx("span",{className:"oc-tag",children:Q.length}),s&&u.jsx("span",{className:"oc-tag oc-tag-danger",children:s})]}),u.jsx("input",{ref:l,className:"oc-input",style:{maxWidth:280},placeholder:"Buscar...",value:o,onChange:F=>a(F.target.value)})]})}),u.jsx("div",{className:"card",children:u.jsx("div",{className:"oc-table-wrap",children:u.jsxs("table",{className:"oc-table",children:[u.jsx("thead",{className:"oc-thead",children:u.jsxs("tr",{className:"oc-tr",children:[u.jsx(Ut,{children:"Caja"}),u.jsx(Ut,{children:"Fecha apertura"}),u.jsx(Ut,{align:"right",children:"Base actual"}),u.jsx(Ut,{align:"right",children:"Saldo inicial"}),u.jsx(Ut,{align:"right",children:"Saldo actual"}),u.jsx(Ut,{children:"Usuario"}),u.jsx(Ut,{children:"Acciones"})]})}),u.jsx("tbody",{className:"oc-tbody",children:b?u.jsx(dT,{cols:7}):Q.length===0?u.jsx("tr",{className:"oc-tr",children:u.jsx("td",{className:"oc-td",colSpan:7,children:u.jsx("span",{className:"oc-muted",children:"Sin cajas abiertas."})})}):Q.map(F=>{var Z;return u.jsxs("tr",{className:"oc-tr",children:[u.jsxs("td",{className:"oc-td",children:[u.jsx("b",{children:F.nombre})," ",(Z=F.ia)!=null&&Z.length?u.jsx("span",{className:"oc-tag oc-tag-danger",title:F.ia.join("  "),children:"IA"}):null]}),u.jsx("td",{className:"oc-td",children:F.fechaApertura?F.fechaApertura.toLocaleString("es-CO"):""}),u.jsxs("td",{className:"oc-td",style:{textAlign:"right"},children:["$",Er(F.baseActual)]}),u.jsxs("td",{className:"oc-td",style:{textAlign:"right"},children:["$",Er(F.saldoInicial)]}),u.jsxs("td",{className:"oc-td",style:{textAlign:"right",color:F.saldoActual<0?"#b91c1c":void 0,fontWeight:600},children:["$",Er(F.saldoActual)]}),u.jsx("td",{className:"oc-td",children:F.usuarioNombre}),u.jsxs("td",{className:"oc-td",style:{whiteSpace:"nowrap"},children:[u.jsx("button",{className:"oc-small-btn",onClick:()=>r("mio"),children:"Ver"})," ",u.jsx("button",{className:"oc-small-btn oc-danger",onClick:()=>Ge(F.id),children:"Cerrar"})]})]},F.id)})})]})})})]}),we=()=>u.jsxs("div",{className:"card",children:[u.jsxs("div",{className:"oc-card-head",style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[u.jsx("h3",{children:"Mi caja (hoy)"}),(V==null?void 0:V.estado)==="abierta"&&u.jsxs("div",{style:{display:"flex",gap:8},children:[u.jsx("span",{className:"oc-tag oc-tag-success",children:"Abierta"}),u.jsx("button",{className:"oc-small-btn oc-danger",onClick:()=>Ge(V.id),children:"Cerrar caja"})]})]}),T?u.jsx("div",{className:"oc-muted",children:"Cargando"}):V?u.jsxs(u.Fragment,{children:[u.jsxs("div",{className:"oc-stats-row",style:{marginBottom:12},children:[u.jsxs("div",{className:"stat-card",children:[u.jsx("span",{className:"stat-label",children:"Base actual"}),u.jsxs("span",{className:"stat-value",children:["$",Er(V.baseActual)]})]}),u.jsxs("div",{className:"stat-card",children:[u.jsx("span",{className:"stat-label",children:"Saldo actual"}),u.jsxs("span",{className:"stat-value",style:{color:V.saldoActual<0?"#b91c1c":void 0},children:["$",Er(V.saldoActual)]})]})]}),u.jsxs("div",{className:"card",style:{marginBottom:12},children:[u.jsx("h4",{style:{marginBottom:8},children:"Cobro rpido"}),u.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr auto",gap:8},children:[u.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:6},children:[u.jsx("label",{className:"oc-muted",children:"Paciente"}),u.jsx("input",{className:"oc-input",placeholder:"Buscar nombre o documento",value:S,onChange:F=>C(F.target.value)}),S&&k.length>0&&u.jsx("div",{className:"oc-dropdown",children:k.slice(0,6).map(F=>u.jsx("button",{className:`oc-menu-item ${(P==null?void 0:P.id)===F.id?"active":""}`,onClick:()=>{Y(F),C(F.nombre||F.name||F.doc||"")},type:"button",children:(F.nombre||F.name||"Paciente")+(F.doc?`  ${F.doc}`:"")},F.id))})]}),u.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:6},children:[u.jsx("label",{className:"oc-muted",children:"Monto (COP)"}),u.jsx("input",{className:"oc-input",type:"number",min:"0",step:"1000",placeholder:"0",value:Ye,onChange:F=>Lt(F.target.value)})]}),u.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:6},children:[u.jsx("label",{className:"oc-muted",children:"Medio"}),u.jsxs("select",{className:"oc-input",value:en,onChange:F=>J(F.target.value),children:[u.jsx("option",{value:"efectivo",children:"Efectivo"}),u.jsx("option",{value:"tarjeta",children:"Tarjeta"}),u.jsx("option",{value:"transferencia",children:"Transferencia"}),u.jsx("option",{value:"link",children:"Link (en lnea)"})]})]}),u.jsx("div",{style:{display:"flex",alignItems:"end",gap:6},children:en==="link"?u.jsx("button",{className:"oc-btn",onClick:se,disabled:de,children:de?"Creando":"Generar link"}):u.jsx("button",{className:"oc-btn",onClick:q,disabled:de,children:de?"Guardando":"Registrar pago"})})]}),u.jsxs("p",{className:"oc-muted",style:{marginTop:8},children:["Para link, el saldo se actualiza cuando el pago pase a ",u.jsx("b",{children:"aprobado"})," (webhook)."]})]}),u.jsxs("div",{className:"card",style:{marginBottom:12},children:[u.jsx("h4",{style:{marginBottom:8},children:"Movimiento manual"}),u.jsxs("form",{onSubmit:pt,style:{display:"grid",gridTemplateColumns:"120px 1fr 180px auto",gap:8},children:[u.jsxs("select",{className:"oc-input",value:je,onChange:F=>Ke(F.target.value),children:[u.jsx("option",{value:"ingreso",children:"Ingreso"}),u.jsx("option",{value:"egreso",children:"Egreso"})]}),u.jsx("input",{className:"oc-input",placeholder:"Concepto (ej. Caja chica, Arriendo, etc.)",value:z,onChange:F=>ne(F.target.value)}),u.jsx("input",{className:"oc-input",type:"number",min:"0",step:"1000",placeholder:"0",value:he,onChange:F=>Ie(F.target.value)}),u.jsx("button",{className:"oc-btn",disabled:xe,children:xe?"Guardando":"Agregar"})]})]}),u.jsxs("div",{className:"card",children:[u.jsx("h4",{style:{marginBottom:8},children:"Movimientos y pagos (hoy)"}),u.jsx("div",{className:"oc-table-wrap",style:{marginBottom:12},children:u.jsxs("table",{className:"oc-table",children:[u.jsx("thead",{className:"oc-thead",children:u.jsxs("tr",{className:"oc-tr",children:[u.jsx(Ut,{children:"Tipo"}),u.jsx(Ut,{children:"Concepto / Paciente"}),u.jsx(Ut,{children:"Medio"}),u.jsx(Ut,{children:"Estado"}),u.jsx(Ut,{align:"right",children:"Valor"}),u.jsx(Ut,{children:"Hora"})]})}),u.jsx("tbody",{className:"oc-tbody",children:ye.length===0&&be.length===0?u.jsx("tr",{className:"oc-tr",children:u.jsx("td",{className:"oc-td",colSpan:6,children:u.jsx("span",{className:"oc-muted",children:"Sin movimientos ni pagos an."})})}):u.jsxs(u.Fragment,{children:[be.map(F=>{var Z,ae;return u.jsxs("tr",{className:"oc-tr",children:[u.jsx("td",{className:"oc-td",children:"Pago"}),u.jsxs("td",{className:"oc-td",children:[F.patientName||"Paciente"," ",F.linkUrl?u.jsx("a",{href:F.linkUrl,target:"_blank",rel:"noreferrer",children:"(link)"}):null]}),u.jsx("td",{className:"oc-td",children:F.medio}),u.jsx("td",{className:"oc-td",children:u.jsx("span",{className:`oc-tag ${F.estado==="aprobado"?"oc-tag-success":F.estado==="pending"?"oc-tag-warning":"oc-tag-danger"}`,children:F.estado})}),u.jsxs("td",{className:"oc-td",style:{textAlign:"right"},children:["$",Er(F.valor)]}),u.jsx("td",{className:"oc-td",children:(ae=(Z=F.fecha)==null?void 0:Z.toDate)!=null&&ae.call(Z)?F.fecha.toDate().toLocaleTimeString("es-CO"):""})]},`pay-${F.id}`)}),ye.map(F=>{var Z,ae;return u.jsxs("tr",{className:"oc-tr",children:[u.jsx("td",{className:"oc-td",children:F.tipo}),u.jsx("td",{className:"oc-td",children:F.concepto}),u.jsx("td",{className:"oc-td",children:""}),u.jsx("td",{className:"oc-td",children:u.jsx("span",{className:"oc-tag",children:(F.tipo==="ingreso","ok")})}),u.jsxs("td",{className:"oc-td",style:{textAlign:"right"},children:["$",Er(F.valor)]}),u.jsx("td",{className:"oc-td",children:(ae=(Z=F.fecha)==null?void 0:Z.toDate)!=null&&ae.call(Z)?F.fecha.toDate().toLocaleTimeString("es-CO"):""})]},`mov-${F.id}`)})]})})]})}),u.jsx("p",{className:"oc-muted",children:"Sugerencia: crea ndice compuesto para `movimientos(cashId, dia, fecha)` y `payments(cashId, dia, fecha)` para rendimiento."})]})]}):u.jsxs("div",{className:"oc-empty",children:[u.jsx("p",{className:"oc-muted",children:"No tienes una caja abierta hoy."}),u.jsx("button",{className:"oc-btn",onClick:()=>r("abrir"),children:"Abrir caja"})]})]}),qe=()=>u.jsxs("div",{className:"card",children:[u.jsx("div",{className:"oc-card-head",style:{marginBottom:8},children:u.jsxs("h3",{children:["Cajas cerradas ",u.jsx("span",{className:"oc-tag",children:I.length})]})}),u.jsx("div",{className:"oc-table-wrap",children:u.jsxs("table",{className:"oc-table",children:[u.jsx("thead",{className:"oc-thead",children:u.jsxs("tr",{className:"oc-tr",children:[u.jsx(Ut,{children:"Caja"}),u.jsx(Ut,{children:"Usuario"}),u.jsx(Ut,{children:"Apertura"}),u.jsx(Ut,{children:"Cierre"}),u.jsx(Ut,{align:"right",children:"Saldo final"})]})}),u.jsx("tbody",{className:"oc-tbody",children:y?u.jsx(dT,{cols:5}):I.length===0?u.jsx("tr",{className:"oc-tr",children:u.jsx("td",{className:"oc-td",colSpan:5,children:u.jsx("span",{className:"oc-muted",children:"Sin cajas cerradas."})})}):I.map(F=>u.jsxs("tr",{className:"oc-tr",children:[u.jsx("td",{className:"oc-td",children:F.nombre}),u.jsx("td",{className:"oc-td",children:F.usuarioNombre}),u.jsx("td",{className:"oc-td",children:F.fechaApertura?F.fechaApertura.toLocaleString("es-CO"):""}),u.jsx("td",{className:"oc-td",children:F.fechaCierre?F.fechaCierre.toLocaleString("es-CO"):""}),u.jsxs("td",{className:"oc-td",style:{textAlign:"right"},children:["$",Er(F.saldoActual)]})]},F.id))})]})})]}),Se=()=>u.jsxs("div",{className:"card",children:[u.jsx("h3",{children:"Cierres simulados"}),u.jsx("p",{className:"oc-muted",children:"El cierre hipottico compara ventas y movimientos detectando errores y descuadres con IA. (Conectar fuente de datos para activarlo)."})]}),Fe=()=>u.jsxs("div",{className:"card",children:[u.jsx("h3",{children:"Bancos"}),u.jsx("p",{className:"oc-muted",children:"Conciliacin de consignaciones/pagos electrnicos contra caja del da. (Conectar pasarela o extractos para habilitar)."})]}),ge=({m:F})=>u.jsxs("button",{type:"button",onClick:()=>r(F.key),className:`oc-menu-item ${n===F.key?"active":""}`,style:{width:"100%",textAlign:"left",padding:"10px 12px",borderRadius:10,border:"1px solid transparent",background:n===F.key?"var(--oc-surface-2, #f3f6ff)":"transparent",fontWeight:600},title:F.label,children:[u.jsx("span",{style:{opacity:.8,marginRight:6},children:F.icon}),F.label]});return u.jsxs("div",{className:"oc-main-content",style:{display:"grid",gridTemplateColumns:"240px 1fr",gap:16},children:[u.jsx("aside",{className:"card",role:"navigation","aria-label":"Men de caja",style:{height:"fit-content",padding:12},children:u.jsx("div",{style:{display:"flex",flexDirection:"column",gap:8},children:e.map(F=>u.jsx(ge,{m:F},F.key))})}),u.jsxs("section",{children:[u.jsx("div",{className:"card",style:{marginBottom:12,padding:12},children:u.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",gap:12},children:[u.jsxs("div",{className:"oc-breadcrumb",children:[u.jsx("span",{children:"Caja"}),u.jsx("span",{children:""}),u.jsx("b",{children:(He=e.find(F=>F.key===n))==null?void 0:He.label})]}),n==="abiertas"&&u.jsx("input",{ref:l,className:"oc-input",placeholder:"Buscar...",value:o,onChange:F=>a(F.target.value),style:{maxWidth:300}})]})}),n==="abrir"&&u.jsx(fe,{}),n==="abiertas"&&u.jsx(Ce,{}),n==="cerradas"&&u.jsx(qe,{}),n==="mio"&&u.jsx(we,{}),n==="simulados"&&u.jsx(Se,{}),n==="bancos"&&u.jsx(Fe,{})]})]})}function dT({cols:t=6,n:e=3}){return u.jsx(u.Fragment,{children:Array.from({length:e}).map((n,r)=>u.jsx("tr",{className:"oc-tr",children:Array.from({length:t}).map((s,i)=>u.jsx("td",{className:"oc-td",children:u.jsx("div",{style:{height:12,width:i===0?160:100+i%3*40,background:"var(--oc-skeleton, #e5e7eb)",borderRadius:6}})},i))},r))})}function qU({items:t=[]}){return u.jsxs("div",{className:"card activity-card",children:[u.jsx("h4",{children:"Actividad reciente"}),u.jsx("ul",{className:"activity-list",children:t.map(e=>u.jsxs("li",{children:[u.jsx("strong",{children:e.title}),u.jsx("div",{className:"time",children:e.time})]},e.id))})]})}function HU({status:t}){return t?u.jsxs("div",{className:"card",children:[u.jsx("h4",{children:"Automatizaciones (N8N)"}),u.jsxs("div",{className:"n8n-line",children:[u.jsx("strong",{children:"Conectado:"})," ",t.connected?"S":"No"]}),u.jsxs("div",{className:"n8n-line",children:[u.jsx("strong",{children:"Flujos activos:"})," ",t.flowsRunning]}),t.lastError&&u.jsxs("div",{className:"n8n-error",children:["Error: ",t.lastError]})]}):null}const Np={es:{nav_home:"Inicio",nav_agenda:"Agenda",nav_patients:"Pacientes",nav_billing:"Facturacin",nav_inventory:"Inventario",nav_odontogram:"Odontograma",nav_reports:"Reportes",nav_cash:"Caja",nav_admin:"Administracin",welcomeTitle:"Bienvenido a OdontoCloud",welcomeSubtitle:"Administra tus pacientes, agenda, inventario y facturacin de manera inteligente y moderna.",clinicLabel:"Clnica",userLabel:"Usuario",roleLabel:"Rol",searchPlaceholder:"Buscar acciones o ir a",stats_patientsToday:"Pacientes totales",stats_appointmentsToday:"Citas hoy",stats_revenueToday:"Facturacin hoy",stats_waiting:"En espera",stats_currency:"COP",n8n_title:"Automatizaciones (n8n)",recent_title:"Actividad reciente",recent_empty:"Sin actividad registrada.",loading:"Cargando...",logout:"Cerrar sesin",module_coming:"Mdulo prximamente.",todays_appts:"Citas de hoy",see_schedule:"Ir a Agenda",no_appts_today:"No hay citas programadas hoy.",at:"a las"},en:{nav_home:"Overview",nav_agenda:"Schedule",nav_patients:"Patients",nav_billing:"Billing",nav_inventory:"Inventory",nav_odontogram:"Odontogram",nav_reports:"Reports",nav_cash:"Cash",nav_admin:"Administration",welcomeTitle:"Welcome to OdontoCloud",welcomeSubtitle:"Manage your patients, schedule, inventory and billing in a smart and modern way.",clinicLabel:"Clinic",userLabel:"User",roleLabel:"Role",searchPlaceholder:"Search actions or go to",stats_patientsToday:"Total patients",stats_appointmentsToday:"Appointments today",stats_revenueToday:"Revenue today",stats_waiting:"In waiting room",stats_currency:"COP",n8n_title:"Automations (n8n)",recent_title:"Recent activity",recent_empty:"No activity yet.",loading:"Loading...",logout:"Log out",module_coming:"Module coming soon.",todays_appts:"Today's appointments",see_schedule:"Open Schedule",no_appts_today:"No appointments today.",at:"at"}},$A=()=>typeof navigator>"u"||(navigator.language||navigator.userLanguage||"es").toLowerCase().startsWith("es")?"es":"en",WU=()=>{try{const t=JSON.parse(localStorage.getItem("odc_session"));return t&&Date.now()-t.timestamp<1e3*60*60*24?t:null}catch{return null}},KU=()=>N.useMemo(()=>{const t=new Date,e=new Date(t.getFullYear(),t.getMonth(),t.getDate(),0,0,0,0),n=new Date(t.getFullYear(),t.getMonth(),t.getDate()+1,0,0,0,0);return{startToday:Be.fromDate(e),endToday:Be.fromDate(n),startTodayJS:e}},[]),GU=t=>`${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,"0")}-${String(t.getDate()).padStart(2,"0")}`,QU=(t,e)=>t.toLocaleTimeString(e==="es"?"es-CO":"en-US",{hour:"2-digit",minute:"2-digit"}),YU=(t,e)=>{try{const[n,r,s]=(t||"").split("-").map(a=>parseInt(a,10)),[i=0,o=0]=(e||"00:00").split(":").map(a=>parseInt(a,10));return new Date(n,(r||1)-1,s||1,i,o,0,0)}catch{return new Date}};function XU({data:t=[]}){const s=Math.max(1,...t.map(d=>Number(d.value)||0)),i=t.length||7,o=10,a=Math.max(16,Math.min(44,(640-o*(i+1))/i)),l=(a+o)*i+o;return u.jsx("div",{style:{width:"100%",overflowX:"auto"},children:u.jsxs("svg",{width:l,height:240,role:"img","aria-label":"Pacientes registrados por da en la ltima semana",children:[[.25,.5,.75,1].map((d,h)=>{const f=18+(1-d)*182;return u.jsx("line",{x1:0,x2:l,y1:f,y2:f,stroke:"#e5e7eb",strokeDasharray:"4 4"},h)}),t.map((d,h)=>{const f=Number(d.value)||0,m=Math.round(f/s*182),v=o+h*(a+o),R=200-m;return u.jsxs("g",{children:[u.jsx("rect",{x:v,y:R,width:a,height:m,rx:"6",ry:"6",fill:f>0?"#0ea5e9":"#cbd5e1",children:u.jsx("title",{children:`${d.label||d.shortLabel||""}  ${f} paciente${f!==1?"s":""}`})}),f>0&&m>14&&u.jsx("text",{x:v+a/2,y:R-6,textAnchor:"middle",fontSize:"11",fill:"#0f172a",children:f}),u.jsx("text",{x:v+a/2,y:214,textAnchor:"middle",fontSize:"11",fill:"#64748b",children:d.shortLabel||""})]},h)})]})})}function JU({onNavigate:t,onAction:e,placeholder:n}){const[r,s]=N.useState(""),[i,o]=N.useState(!1),[a,l]=N.useState(0),d=N.useRef(null),h=N.useMemo(()=>[{group:"Navegacin",label:"Ir a Inicio",keywords:"inicio home overview",run:()=>t==null?void 0:t("Inicio")},{group:"Navegacin",label:"Ir a Agenda",keywords:"agenda calendario schedule",run:()=>t==null?void 0:t("Agenda")},{group:"Navegacin",label:"Ir a Pacientes",keywords:"pacientes",run:()=>t==null?void 0:t("Pacientes")},{group:"Navegacin",label:"Ir a Facturacin",keywords:"facturacion facturas billing",run:()=>t==null?void 0:t("Facturacin")},{group:"Navegacin",label:"Ir a Inventario",keywords:"inventario stock",run:()=>t==null?void 0:t("Inventario")},{group:"Navegacin",label:"Ir a Odontograma",keywords:"odontograma",run:()=>t==null?void 0:t("Odontograma")},{group:"Navegacin",label:"Ir a Reportes",keywords:"reportes informes",run:()=>t==null?void 0:t("Reportes")},{group:"Acciones",label:"Nueva cita",keywords:"nueva cita agendar",run:()=>e==null?void 0:e("new_appointment")},{group:"Acciones",label:"Nuevo paciente",keywords:"nuevo paciente alta",run:()=>e==null?void 0:e("new_patient")},{group:"Acciones",label:"Nueva factura",keywords:"nueva factura",run:()=>e==null?void 0:e("new_invoice")},{group:"Acciones",label:"Exportar agenda",keywords:"exportar agenda",run:()=>e==null?void 0:e("export_agenda")},{group:"Acciones",label:"Ir a hoy (Agenda)",keywords:"hoy today",run:()=>e==null?void 0:e("agenda_today")},{group:"Acciones",label:"Cambiar modo oscuro",keywords:"oscuro dark mode",run:()=>e==null?void 0:e("toggle_dark")},{group:"Acciones",label:"Cerrar sesin",keywords:"logout salir cerrar",run:()=>e==null?void 0:e("logout")},{group:"Ayuda",label:"Ver atajos de teclado",keywords:"atajos ayuda",run:()=>e==null?void 0:e("show_shortcuts")},{group:"Ayuda",label:"Soporte / Contacto",keywords:"soporte ayuda contacto",run:()=>e==null?void 0:e("support")}],[t,e]),f=N.useMemo(()=>{const b=r.toLowerCase().trim();return b?h.filter(A=>A.label.toLowerCase().includes(b)||A.keywords.includes(b)):[]},[r,h]);N.useEffect(()=>{const b=A=>{d.current&&(d.current.contains(A.target)||o(!1))};return document.addEventListener("mousedown",b),()=>document.removeEventListener("mousedown",b)},[]);const m=b=>{var A;(A=b.run)==null||A.call(b),s(""),o(!1)},v=b=>{!i||f.length===0||(b.key==="ArrowDown"&&(b.preventDefault(),l(A=>(A+1)%f.length)),b.key==="ArrowUp"&&(b.preventDefault(),l(A=>(A-1+f.length)%f.length)),b.key==="Enter"&&(b.preventDefault(),f[a]&&m(f[a])),b.key==="Escape"&&o(!1))},R=N.useMemo(()=>{const b=new Map;return f.forEach(A=>{b.has(A.group)||b.set(A.group,[]),b.get(A.group).push(A)}),Array.from(b.entries())},[f]);return u.jsxs("div",{className:"oc-search-wrap",ref:d,children:[u.jsx("input",{className:"oc-search",type:"search",inputMode:"search",placeholder:n,"aria-label":n,value:r,onChange:b=>{s(b.target.value),o(!!b.target.value),l(0)},onFocus:()=>o(!!r),onKeyDown:v}),i&&u.jsx("div",{className:"oc-search-dropdown",role:"listbox","aria-label":"Resultados de comandos",children:R.length===0?u.jsx("div",{className:"oc-search-item empty",children:"Escribe para ver opciones"}):R.map(([b,A])=>u.jsxs("div",{children:[u.jsx("div",{className:"oc-search-group",children:b}),A.map(I=>{const w=f.indexOf(I);return u.jsx("button",{className:`oc-search-item ${w===a?"active":""}`,onMouseEnter:()=>l(w),onClick:()=>m(I),role:"option",children:u.jsx("span",{className:"oc-search-title",children:I.label})},I.label)})]},b))})]})}function ZU({open:t,anchorRect:e,onClose:n,onSoon:r,onNavigatePath:s,onSetFactView:i,dark:o}){const[a,l]=N.useState(null),d=N.useRef(null);if(N.useEffect(()=>{if(!t)return;const Y=Lt=>Lt.key==="Escape"&&(n==null?void 0:n()),Ye=()=>n==null?void 0:n();return window.addEventListener("keydown",Y),window.addEventListener("scroll",Ye,!0),()=>{window.removeEventListener("keydown",Y),window.removeEventListener("scroll",Ye,!0)}},[t,n]),!t)return null;const h=((e==null?void 0:e.bottom)||60)+8,f=Math.max(12,Math.min(((e==null?void 0:e.left)||300)-160,window.innerWidth-920)),m=10,v=f+360+m,R=o?"#0b1220":"#ffffff",b=o?"#e5e7eb":"#0f172a",A=o?"#0f1a32":"#f3f6ff",I=o?"#1f2a44":"#e2e8f0",w=o?"#b6c1d1":"#475569",y={position:"fixed",top:h,left:f,width:880,maxWidth:"calc(100vw - 24px)",background:R,color:b,borderRadius:14,boxShadow:"0 18px 40px rgba(2,6,23,.18)",border:`1px solid ${I}`,zIndex:400,padding:12},j={position:"fixed",top:h,left:v,width:420,maxWidth:"calc(100vw - 24px)",background:R,color:b,borderRadius:14,boxShadow:"0 18px 40px rgba(2,6,23,.18)",border:`1px solid ${I}`,zIndex:410,padding:12},V={display:"flex",flexDirection:"column",gap:6,padding:"8px 10px"},M={height:38,borderRadius:10,padding:"0 12px",display:"flex",alignItems:"center",gap:8,fontSize:".92rem",cursor:"pointer",border:"1px solid transparent",background:"transparent",color:b,fontWeight:500,textAlign:"left"},T=(Y,Ye=!0)=>Object.assign(Y.currentTarget.style,Ye?{background:A,borderColor:I}:{background:"transparent",borderColor:"transparent"}),_=()=>{d.current&&clearTimeout(d.current)},S=()=>{_(),d.current=setTimeout(()=>n==null?void 0:n(),180)},C={position:"fixed",top:h,left:f+360,width:m,height:520,zIndex:405},k=[{label:"Recibo de caja",key:"recibo",path:"facturacion/recibo"},{label:"Saldo a favor",key:"saldo",path:"facturacion/saldo"},{label:"Nota crdito",key:"nc",path:"facturacion/nc"},{label:"Nota dbito",key:"nd",path:"facturacion/nd"},{label:"Liquidaciones",key:"liq",path:"facturacion/liq"},{label:"Traslados",key:"tras",path:"facturacion/tras"},{label:"Pagos",key:"pagos",path:"facturacion/pagos"},{label:"rdenes de compra",key:"oc",path:"facturacion/oc"},{label:"Factura de venta",key:"fv",path:"facturacion/facturas"},{label:"Facturas de compra",key:"fc",path:"facturacion/fc"}],D=[{label:"RIPS anteriores (RS-3374)",key:"rips3374"},{label:"RIPS nuevo (RS-2275)",key:"rips2275"}],P=Y=>{i==null||i(Y.key),s==null||s(Y.path),n==null||n()};return u.jsxs(u.Fragment,{children:[u.jsx("div",{onClick:n,style:{position:"fixed",inset:0,background:"transparent",zIndex:399}}),u.jsx("div",{style:y,onMouseEnter:_,onMouseLeave:S,children:u.jsxs("div",{style:{display:"grid",gridTemplateColumns:"360px 1fr",gap:8,alignItems:"start"},children:[u.jsxs("div",{style:V,children:[u.jsx("button",{type:"button",style:M,onMouseEnter:()=>{_(),l("facturacion")},onFocus:()=>{_(),l("facturacion")},onClick:()=>l(Y=>Y==="facturacion"?null:"facturacion"),onMouseOver:Y=>T(Y,!0),onMouseOut:Y=>T(Y,!1),children:" Facturacin "}),u.jsx("button",{type:"button",style:M,onMouseEnter:()=>{_(),l("rips")},onFocus:()=>{_(),l("rips")},onClick:()=>l(Y=>Y==="rips"?null:"rips"),onMouseOver:Y=>T(Y,!0),onMouseOut:Y=>T(Y,!1),children:" RIPS "}),u.jsx("button",{type:"button",style:M,onClick:()=>s==null?void 0:s("agenda"),onMouseOver:Y=>T(Y,!0),onMouseOut:Y=>T(Y,!1),children:" Gestin de agenda"}),u.jsx("button",{type:"button",style:M,onClick:()=>s==null?void 0:s("inventario"),onMouseOver:Y=>T(Y,!0),onMouseOut:Y=>T(Y,!1),children:" Inventario"}),u.jsx("button",{type:"button",style:M,onClick:()=>r==null?void 0:r(),onMouseOver:Y=>T(Y,!0),onMouseOut:Y=>T(Y,!1),children:" Convenios"}),u.jsx("button",{type:"button",style:M,onClick:()=>r==null?void 0:r(),onMouseOver:Y=>T(Y,!0),onMouseOut:Y=>T(Y,!1),children:" Terceros"}),u.jsx("button",{type:"button",style:M,onClick:()=>r==null?void 0:r(),onMouseOver:Y=>T(Y,!0),onMouseOut:Y=>T(Y,!1),children:" Campaas"}),u.jsx("button",{type:"button",style:M,onClick:()=>r==null?void 0:r(),onMouseOver:Y=>T(Y,!0),onMouseOut:Y=>T(Y,!1),children:" Temperatura y humedad"}),u.jsx("button",{type:"button",style:M,onClick:()=>r==null?void 0:r(),onMouseOver:Y=>T(Y,!0),onMouseOut:Y=>T(Y,!1),children:" Residuos"}),u.jsx("button",{type:"button",style:M,onClick:()=>r==null?void 0:r(),onMouseOver:Y=>T(Y,!0),onMouseOut:Y=>T(Y,!1),children:" Medicamentos y planes"}),u.jsx("button",{type:"button",style:M,onClick:()=>r==null?void 0:r(),onMouseOver:Y=>T(Y,!0),onMouseOut:Y=>T(Y,!1),children:" Esterilizacin"})]}),u.jsx("div",{style:V,children:u.jsxs("div",{style:{fontSize:".85rem",color:w},children:["Accesos rpidos a mdulos de administracin. Pasa el mouse por ",u.jsx("b",{children:"Facturacin"})," o ",u.jsx("b",{children:"RIPS"})," para ver sus acciones."]})})]})}),u.jsx("div",{style:C,onMouseEnter:_,onMouseLeave:S}),a&&u.jsx("div",{style:j,onMouseEnter:_,onMouseLeave:S,children:u.jsx("div",{style:{...V,display:"grid",gridTemplateColumns:"1fr"},children:(a==="facturacion"?k:D).map(Y=>u.jsx("button",{type:"button",style:M,onClick:()=>a==="facturacion"?P(Y):r==null?void 0:r(),onMouseOver:Ye=>T(Ye,!0),onMouseOut:Ye=>T(Ye,!1),children:Y.label},Y.label))})})]})}function e6({t,companyName:e,userName:n,role:r,darkMode:s,weeklySeries:i,weekRangeLabel:o,todaysAppointments:a,todaysLoading:l,metrics:d,metricsLoading:h,n8nState:f,n8nLoading:m,recent:v,recentLoading:R,onGoAgenda:b}){return u.jsxs("div",{className:"oc-main-content",children:[u.jsxs("section",{className:"oc-hero","aria-label":"Resumen general",children:[u.jsxs("div",{className:"oc-hero-text",children:[u.jsx("h1",{children:t("welcomeTitle")}),u.jsx("p",{children:t("welcomeSubtitle")}),u.jsxs("p",{className:"oc-hero-meta",children:[t("clinicLabel"),": ",e,"  ",t("userLabel"),": ",n,"  ",t("roleLabel"),": ",r||""]})]}),u.jsxs("div",{className:"oc-hero-badge","aria-live":"polite",children:[u.jsx("span",{className:"oc-hero-badge-title",children:t("stats_appointmentsToday")}),u.jsx("span",{className:"oc-hero-badge-value",children:h&&l?"":d.citasHoy}),u.jsxs("span",{className:"oc-hero-badge-sub",children:[t("stats_patientsToday"),": ",h?"":d.pacientesHoy]})]})]}),u.jsxs("section",{className:"oc-stats-row","aria-label":"Indicadores del da",children:[u.jsxs("div",{className:"stat-card",children:[u.jsx("span",{className:"stat-label",children:t("stats_patientsToday")}),u.jsx("span",{className:"stat-value",children:d.pacientesHoy})]}),u.jsxs("div",{className:"stat-card",children:[u.jsx("span",{className:"stat-label",children:t("stats_appointmentsToday")}),u.jsx("span",{className:"stat-value",children:d.citasHoy})]}),u.jsxs("div",{className:"stat-card",children:[u.jsx("span",{className:"stat-label",children:t("stats_revenueToday")}),u.jsxs("span",{className:"stat-value",children:[d.facturacionHoy.toLocaleString("es-CO")," ",u.jsx("span",{className:"stat-currency",children:t("stats_currency")})]})]}),u.jsxs("div",{className:"stat-card",children:[u.jsx("span",{className:"stat-label",children:t("stats_waiting")}),u.jsx("span",{className:"stat-value",children:d.enEspera})]})]}),u.jsxs("section",{className:"oc-grid","aria-label":"Contenido principal del dashboard",children:[u.jsx("div",{className:"oc-grid-main",children:u.jsxs("div",{className:"card card-quickcharts",children:[u.jsxs("div",{className:"oc-card-head",style:{display:"flex",justifyContent:"space-between",alignItems:"center",gap:8},children:[u.jsx("h3",{children:"Pacientes registrados  ltimos 7 das"}),u.jsx("span",{className:"oc-muted",style:{marginLeft:8,fontSize:12},children:o})]}),i.length===0||i.every(A=>((A==null?void 0:A.value)||0)===0)?u.jsx("p",{className:"oc-weekly-empty",children:"Sin pacientes registrados en la ltima semana."}):u.jsx(XU,{data:i})]})}),u.jsxs("aside",{className:"oc-grid-side","aria-label":"Panel lateral",children:[u.jsxs("div",{className:"card",children:[u.jsx("h3",{children:t("n8n_title")}),m?u.jsx("span",{className:"oc-muted",children:t("loading")}):u.jsx(HU,{status:f})]}),u.jsxs("div",{className:"card",children:[u.jsxs("div",{className:"oc-card-head",style:{display:"flex",justifyContent:"space-between",alignItems:"center",gap:8},children:[u.jsx("h3",{children:t("todays_appts")}),u.jsx("button",{className:"oc-small-link",type:"button",onClick:b,children:t("see_schedule")})]}),l?u.jsx("span",{className:"oc-muted",children:t("loading")}):a.length===0?u.jsx("p",{className:"oc-muted",children:t("no_appts_today")}):u.jsx("ul",{className:"oc-list",children:a.slice(0,5).map(A=>u.jsxs("li",{className:"oc-list-item",children:[u.jsxs("div",{className:"oc-list-main",children:[u.jsx("b",{children:A.pacienteNombre||"Paciente"})," ",u.jsxs("span",{className:"oc-muted",children:[t("at")," ",QU(A.fecha,$A())]})]}),u.jsx("div",{className:`oc-tag oc-tag-${(A.estado||"programada").toLowerCase().replace(/\s+/g,"-")}`,children:A.estado||"programada"})]},A.id))})]}),u.jsxs("div",{className:"card",children:[u.jsx("h3",{children:"Actividad reciente"}),R?u.jsx("span",{className:"oc-muted",children:t("loading")}):v.length===0?u.jsx("p",{className:"oc-muted",children:t("recent_empty")}):u.jsx(qU,{items:v})]})]})]}),u.jsxs("footer",{className:"oc-footer",children:[" ",new Date().getFullYear()," OdontoCloud | Creado por Ingeniero Juan Madrid"]})]})}function kp(){const t=Ac(),e=Vr(),[n]=N.useState($A()),r=q=>Np[n][q]||q,[s,i]=N.useState("Inicio"),[o,a]=N.useState("recibo"),[l,d]=N.useState(()=>{try{return localStorage.getItem("odontocloud:dark")==="1"}catch{return!1}});N.useEffect(()=>{try{localStorage.setItem("odontocloud:dark",l?"1":"0")}catch{}document.documentElement.classList.toggle("dark",l)},[l]);const[h]=N.useState(()=>WU()),[f]=N.useState((h==null?void 0:h.rol)||""),[m]=N.useState((h==null?void 0:h.email)||""),[v,R]=N.useState("OdontoCloud"),[b,A]=N.useState(m||"Usuario"),[I,w]=N.useState(!0);N.useEffect(()=>{const q=Iy(dh,async se=>{try{if(!se){A(m||"Usuario"),R("OdontoCloud"),w(!1);return}A(se.displayName||se.email||m||"Usuario");const X=zt(_e,"empresas",se.uid),Q=await lh(X);R(Q.exists()&&Q.data().nombre||"OdontoCloud")}catch(X){console.error("Error cargando empresa/usuario:",X)}finally{w(!1)}});return()=>q()},[m]);const[y,j]=N.useState({pacientesHoy:0,citasHoy:0,facturacionHoy:0,enEspera:0}),[V,M]=N.useState(!0),[T,_]=N.useState([]),[S,C]=N.useState([]),[k,D]=N.useState(!0),{startToday:P,endToday:Y,startTodayJS:Ye}=KU(),Lt=N.useMemo(()=>GU(Ye),[Ye]),en=N.useMemo(()=>{const q=new Date,se=new Date(q.getFullYear(),q.getMonth(),q.getDate()-6),X=q,Q=fe=>fe.toLocaleDateString(n==="es"?"es-ES":"en-US",{weekday:"short",day:"2-digit",month:"short"}).replace(".","");return`${Q(se)}  ${Q(X)}`},[n]),J=q=>{var Ce;const se=q.data()||{};let X;if((Ce=se.fecha)!=null&&Ce.toDate){X=se.fecha.toDate();const we=se.horaInicio||se.hora;if(we&&typeof we=="string"){const[qe=0,Se=0]=we.split(":").map(Fe=>parseInt(Fe,10));X.setHours(qe||0,Se||0,0,0)}}else if(typeof se.fecha=="string"){const we=se.horaInicio||se.hora||"00:00";X=YU(se.fecha,we)}else X=new Date;const Q=se.pacienteNombre||se.paciente||"Paciente",fe=se.estado&&String(se.estado)||"programada";return{id:q.id,fecha:X,pacienteId:se.pacienteId||"",pacienteNombre:Q,estado:fe,motivo:se.motivo||""}};N.useEffect(()=>{const q=rt(Ue(_e,"citas"),Je("fecha",">=",P),Je("fecha","<",Y),Xt("fecha","asc")),se=rt(Ue(_e,"citas"),Je("fecha","==",Lt));let X=new Map,Q=!1,fe=!1;const Ce=()=>{const Se=Array.from(X.values()).sort((ge,He)=>ge.fecha.getTime()-He.fecha.getTime()),Fe=Se.filter(ge=>String(ge.estado).toLowerCase().trim()==="en espera").length;C(Se),j(ge=>({...ge,citasHoy:Se.length,enEspera:Fe})),Q&&fe&&D(!1)},we=ir(q,Se=>{Q=!0;const Fe=new Map(X);Se.docs.forEach(ge=>Fe.set(ge.id,J(ge))),X=Fe,Ce()},Se=>{console.error("Realtime citas hoy (TS):",Se),Q=!0,Ce()}),qe=ir(se,Se=>{fe=!0;const Fe=new Map(X);Se.docs.forEach(ge=>Fe.set(ge.id,J(ge))),X=Fe,Ce()},Se=>{console.error("Realtime citas hoy (STR):",Se),fe=!0,Ce()});return()=>{try{we(),qe()}catch{}}},[P,Y,Lt]),N.useEffect(()=>{(async()=>{try{const X=(await jM(Ue(_e,"pacientes"))).data().count||0;let Q=0;try{const fe=rt(Ue(_e,"facturas"),Je("fecha",">=",P),Je("fecha","<",Y));(await Yt(fe)).forEach(we=>{const qe=we.data();typeof qe.monto=="number"&&(Q+=qe.monto)})}catch{Q=0}j(fe=>({...fe,pacientesHoy:X,facturacionHoy:Q}))}catch(se){console.error("Error cargando mtricas:",se),j(X=>({...X,pacientesHoy:0,facturacionHoy:0}))}finally{M(!1)}})()},[P,Y]),N.useEffect(()=>{const q=new Date,se=new Date(q.getFullYear(),q.getMonth(),q.getDate()-6),X=new Date(q.getFullYear(),q.getMonth(),q.getDate()+1),Q=new Map;for(let we=0;we<7;we++){const qe=new Date(q.getFullYear(),q.getMonth(),q.getDate()-(6-we)),Se=qe.toISOString().slice(0,10),Fe=qe.toLocaleDateString(n==="es"?"es-ES":"en-US"),ge=qe.toLocaleDateString(n==="es"?"es-ES":"en-US",{weekday:"short",day:"2-digit"}).replace(".","");Q.set(Se,{label:Fe,shortLabel:ge,value:0})}const fe=rt(Ue(_e,"pacientes"),Je("createdAt",">=",Be.fromDate(se)),Je("createdAt","<",Be.fromDate(X))),Ce=ir(fe,we=>{const qe=new Map(Q);we.docs.forEach(Se=>{var Z;const Fe=Se.data()||{},ge=(Z=Se.data().createdAt)!=null&&Z.toDate?Se.data().createdAt.toDate():Fe.createdAt?new Date(Fe.createdAt):null;if(!ge||isNaN(ge))return;const He=ge.toISOString().slice(0,10);if(!qe.has(He))return;const F=qe.get(He);F.value+=1,qe.set(He,F)}),_(Array.from(qe.values()))},we=>{console.error("Error realtime serie semanal (pacientes):",we),_(Array.from(Q.values()))});return()=>{try{Ce()}catch{}}},[n]);const[de,G]=N.useState([]),[je,Ke]=N.useState(!0);N.useEffect(()=>{(async()=>{try{const se=rt(Ue(_e,"actividad"),Xt("fecha","desc"),Zo(5)),X=await Yt(se);G(X.docs.map(Q=>({id:Q.id,title:Q.data().descripcion||Q.data().titulo||"Actividad",time:Q.data().resumenTiempo||""})))}catch(se){console.error("Error cargando actividad:",se),G([])}finally{Ke(!1)}})()},[]);const[z,ne]=N.useState(null),[he,Ie]=N.useState(!0);N.useEffect(()=>{(async()=>{try{const se=zt(_e,"integraciones","n8n"),X=await lh(se);ne(X.exists()?{connected:!!X.data().connected,flowsRunning:X.data().flowsRunning||0,lastError:X.data().lastError||null}:{connected:!1,flowsRunning:0,lastError:null})}catch(se){console.error("Error cargando estado n8n:",se),ne({connected:!1,flowsRunning:0,lastError:"No se pudo leer el estado desde Firebase."})}finally{Ie(!1)}})()},[]);const xe=async()=>{try{localStorage.removeItem("odc_session")}catch{}try{await Uj(dh)}catch(q){console.error("Error al cerrar sesin:",q)}window.location.href="/"},[ke,ye]=N.useState(!1),[Xe,be]=N.useState(null),re=N.useRef(null);N.useRef(null);const Oe=()=>{var se,X;const q=(X=(se=re.current)==null?void 0:se.getBoundingClientRect)==null?void 0:X.call(se);be(q),ye(!0)};N.useEffect(()=>{const q=e.pathname.toLowerCase(),se=q.includes("/pacientes"),X=q.includes("/caja"),Q=q.includes("/agenda"),fe=q.includes("/facturacion"),Ce=q.includes("/inventario"),we=q.includes("/odontograma"),qe=q.includes("/reportes");i(se?"Pacientes":X?"Caja":Q?"Agenda":Ce?"Inventario":we?"Odontograma":qe?"Reportes":"Inicio"),fe&&(i("Facturacin"),q.includes("/pagos")?a("pagos"):q.includes("/facturas")?a("fv"):q.includes("/recibo")?a("recibo"):q.includes("/saldo")?a("saldo"):q.includes("/nc")?a("nc"):q.includes("/nd")?a("nd"):q.includes("/liq")?a("liq"):q.includes("/tras")?a("tras"):q.includes("/oc")?a("oc"):q.includes("/fc")?a("fc"):a("recibo"))},[e.pathname]);const it=N.useMemo(()=>{const q=e.pathname.split("/").filter(Boolean),se=q.findIndex(X=>X.startsWith("dashboard_"));return se>=0?`/${q.slice(0,se+1).join("/")}`:""},[e.pathname]),Ge=(q="")=>{const se=String(q).replace(/^\/+|\/+$/g,""),X=se?`${it}/${se}`:it||"/",Q=e.pathname.toLowerCase()===X.toLowerCase();t(X,{replace:Q})},pt=()=>{switch(s){case"Agenda":return u.jsx(bU,{});case"Pacientes":return u.jsx(N.Suspense,{fallback:u.jsx("div",{style:{padding:16},children:"Cargando"}),children:u.jsx(OU,{})});case"Facturacin":return u.jsx(CU,{view:o});case"Inventario":return u.jsx(AU,{});case"Odontograma":return u.jsx(RU,{});case"Reportes":return u.jsx(MU,{});case"Caja":return u.jsx(zU,{});case"Inicio":default:return null}};return u.jsxs("div",{className:`oc-shell ${l?"oc-dark":""}`,children:[u.jsx("a",{href:"#oc-main",className:"oc-skip-link",children:"Saltar al contenido"}),u.jsxs("header",{className:"oc-header",role:"banner",children:[u.jsxs("div",{className:"oc-header-left",children:[u.jsx("img",{src:vA,alt:"OdontoCloud",className:"oc-logo"}),u.jsxs("div",{className:"oc-brand-text",children:[u.jsx("span",{className:"oc-brand-main",children:"OdontoCloud"}),u.jsx("span",{className:"oc-brand-sub",children:I?"...":v})]})]}),u.jsxs("nav",{className:"oc-nav",role:"navigation","aria-label":"Navegacin principal",children:[u.jsx(xo,{to:it,end:!0,className:({isActive:q})=>q&&s==="Inicio"?"oc-nav-btn active":"oc-nav-btn",title:r("nav_home"),children:r("nav_home")}),u.jsx(xo,{to:`${it}/agenda`,className:({isActive:q})=>q||s==="Agenda"?"oc-nav-btn active":"oc-nav-btn",title:r("nav_agenda"),children:r("nav_agenda")}),u.jsx(xo,{to:`${it}/pacientes`,className:({isActive:q})=>q||s==="Pacientes"?"oc-nav-btn active":"oc-nav-btn",title:r("nav_patients"),children:r("nav_patients")}),u.jsx(xo,{to:`${it}/caja`,className:({isActive:q})=>q||s==="Caja"?"oc-nav-btn active":"oc-nav-btn",title:r("nav_cash"),children:r("nav_cash")}),u.jsx("button",{type:"button",ref:re,className:"oc-nav-btn",title:r("nav_admin"),"aria-haspopup":"true","aria-expanded":ke,onClick:()=>ke?ye(!1):Oe(),onMouseEnter:()=>Oe(),onFocus:()=>Oe(),children:r("nav_admin")}),u.jsx(xo,{to:`${it}/reportes`,className:({isActive:q})=>q||s==="Reportes"?"oc-nav-btn active":"oc-nav-btn",title:r("nav_reports"),children:r("nav_reports")})]}),u.jsxs("div",{className:"oc-header-right",children:[u.jsx(JU,{placeholder:r("searchPlaceholder"),onNavigate:q=>{q==="Inicio"?Ge(""):q==="Facturacin"?(a("recibo"),Ge("facturacion/recibo")):Ge(q.toLowerCase())},onAction:q=>{switch(q){case"new_appointment":case"agenda_today":case"export_agenda":Ge("agenda");break;case"new_patient":Ge("pacientes");break;case"new_invoice":a("fv"),Ge("facturacion/facturas");break;case"toggle_dark":d(se=>!se);break;case"logout":xe();break;case"show_shortcuts":alert("Atajos: Ctrl/Cmd + K para abrir bsqueda, / para moverse, Enter para ejecutar.");break;case"support":window.open("https://tu-soporte.odc","_blank");break}}}),u.jsx("button",{className:"oc-icon-btn",type:"button",onClick:()=>d(q=>!q),"aria-pressed":l,title:l?"Activar modo claro":"Activar modo oscuro",children:l?"":""}),u.jsx("button",{className:"oc-icon-btn",type:"button",onClick:xe,title:Np[n].logout,children:Np[n].logout})]})]}),u.jsx(ZU,{open:ke,anchorRect:Xe,dark:l,onClose:()=>ye(!1),onSoon:()=>{alert("Prximamente"),ye(!1)},onNavigatePath:q=>{Ge(q),ye(!1)},onSetFactView:q=>a(q)}),u.jsxs("main",{id:"oc-main",className:"oc-main-wrapper",role:"main",children:[s!=="Inicio"&&pt(),s==="Inicio"&&u.jsx(e6,{t:r,companyName:v,userName:b,role:f,darkMode:l,weeklySeries:T,weekRangeLabel:en,todaysAppointments:S,todaysLoading:k,metrics:y,metricsLoading:V,n8nState:z,n8nLoading:he,recent:de,recentLoading:je,onGoAgenda:()=>Ge("agenda")})]})]})}const BA=()=>{try{const t=JSON.parse(localStorage.getItem("odc_session"));return t&&Date.now()-t.timestamp<1e3*60*60*24?t:null}catch{return null}},zA=t=>{const e=(t||"").toLowerCase();return e==="administrador"?"/dashboard_admin":e==="doctor"?"/dashboard_doctor":e==="recepcionista"?"/dashboard_recepcion":"/"};function Dp({allowedRoles:t,children:e}){var s;const n=BA();if(!n)return u.jsx(Od,{to:"/",replace:!0});const r=(s=n.rol)==null?void 0:s.toLowerCase();return t.map(i=>i.toLowerCase()).includes(r)?e:u.jsx(Od,{to:zA(n.rol),replace:!0})}function t6(){const t=BA();return u.jsxs(bN,{children:[u.jsx(To,{path:"/",element:t?u.jsx(Od,{to:zA(t.rol),replace:!0}):u.jsx(n4,{})}),u.jsx(To,{path:"/dashboard_admin/*",element:u.jsx(Dp,{allowedRoles:["administrador"],children:u.jsx(kp,{})})}),u.jsx(To,{path:"/dashboard_doctor/*",element:u.jsx(Dp,{allowedRoles:["doctor"],children:u.jsx(kp,{})})}),u.jsx(To,{path:"/dashboard_recepcion/*",element:u.jsx(Dp,{allowedRoles:["recepcionista"],children:u.jsx(kp,{})})}),u.jsx(To,{path:"*",element:u.jsx(Od,{to:"/",replace:!0})})]})}async function n6(){try{await Lj(dh,jS),await _M(_e),console.log(" Firebase listo con sesin persistente y modo offline.")}catch(t){console.warn(" Firebase offline/persistencia fall:",t.message)}}const r6="modulepreload",s6=function(t){return"/odontocloud-react/"+t},hT={},i6=function(e,n,r){let s=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),a=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));s=Promise.allSettled(n.map(l=>{if(l=s6(l),l in hT)return;hT[l]=!0;const d=l.endsWith(".css"),h=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${h}`))return;const f=document.createElement("link");if(f.rel=d?"stylesheet":r6,d||(f.as="script"),f.crossOrigin="",f.href=l,a&&f.setAttribute("nonce",a),document.head.appendChild(f),d)return new Promise((m,v)=>{f.addEventListener("load",m),f.addEventListener("error",()=>v(new Error(`Unable to preload CSS for ${l}`)))})}))}function i(o){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=o,window.dispatchEvent(a),!a.defaultPrevented)throw o}return s.then(o=>{for(const a of o||[])a.status==="rejected"&&i(a.reason);return e().catch(i)})};function o6(t={}){const{immediate:e=!1,onNeedRefresh:n,onOfflineReady:r,onRegistered:s,onRegisteredSW:i,onRegisterError:o}=t;let a,l;const d=async(f=!0)=>{await l};async function h(){if("serviceWorker"in navigator){if(a=await i6(async()=>{const{Workbox:f}=await import("./workbox-window.prod.es5-vqzQaGvo.js");return{Workbox:f}},[]).then(({Workbox:f})=>new f("/odontocloud-react/sw.js",{scope:"/odontocloud-react/",type:"classic"})).catch(f=>{o==null||o(f)}),!a)return;a.addEventListener("activated",f=>{(f.isUpdate||f.isExternal)&&window.location.reload()}),a.addEventListener("installed",f=>{f.isUpdate||r==null||r()}),a.register({immediate:e}).then(f=>{i?i("/odontocloud-react/sw.js",f):s==null||s(f)}).catch(f=>{o==null||o(f)})}}return l=h(),d}const a6="/odontocloud-react/";n6();o6({immediate:!0});Ax(document.getElementById("root")).render(u.jsx(ST.StrictMode,{children:u.jsx(QN,{basename:a6,children:u.jsx(t6,{})})}));
