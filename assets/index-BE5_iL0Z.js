(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();function cR(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var pT={exports:{}},uh={},mT={exports:{}},De={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var vc=Symbol.for("react.element"),uR=Symbol.for("react.portal"),dR=Symbol.for("react.fragment"),hR=Symbol.for("react.strict_mode"),fR=Symbol.for("react.profiler"),pR=Symbol.for("react.provider"),mR=Symbol.for("react.context"),gR=Symbol.for("react.forward_ref"),yR=Symbol.for("react.suspense"),_R=Symbol.for("react.memo"),vR=Symbol.for("react.lazy"),wv=Symbol.iterator;function wR(t){return t===null||typeof t!="object"?null:(t=wv&&t[wv]||t["@@iterator"],typeof t=="function"?t:null)}var gT={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},yT=Object.assign,_T={};function Ta(t,e,n){this.props=t,this.context=e,this.refs=_T,this.updater=n||gT}Ta.prototype.isReactComponent={};Ta.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Ta.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function vT(){}vT.prototype=Ta.prototype;function cg(t,e,n){this.props=t,this.context=e,this.refs=_T,this.updater=n||gT}var ug=cg.prototype=new vT;ug.constructor=cg;yT(ug,Ta.prototype);ug.isPureReactComponent=!0;var Ev=Array.isArray,wT=Object.prototype.hasOwnProperty,dg={current:null},ET={key:!0,ref:!0,__self:!0,__source:!0};function IT(t,e,n){var r,s={},i=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(i=""+e.key),e)wT.call(e,r)&&!ET.hasOwnProperty(r)&&(s[r]=e[r]);var a=arguments.length-2;if(a===1)s.children=n;else if(1<a){for(var l=Array(a),d=0;d<a;d++)l[d]=arguments[d+2];s.children=l}if(t&&t.defaultProps)for(r in a=t.defaultProps,a)s[r]===void 0&&(s[r]=a[r]);return{$$typeof:vc,type:t,key:i,ref:o,props:s,_owner:dg.current}}function ER(t,e){return{$$typeof:vc,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function hg(t){return typeof t=="object"&&t!==null&&t.$$typeof===vc}function IR(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var Iv=/\/+/g;function kf(t,e){return typeof t=="object"&&t!==null&&t.key!=null?IR(""+t.key):e.toString(36)}function ku(t,e,n,r,s){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case vc:case uR:o=!0}}if(o)return o=t,s=s(o),t=r===""?"."+kf(o,0):r,Ev(s)?(n="",t!=null&&(n=t.replace(Iv,"$&/")+"/"),ku(s,e,n,"",function(d){return d})):s!=null&&(hg(s)&&(s=ER(s,n+(!s.key||o&&o.key===s.key?"":(""+s.key).replace(Iv,"$&/")+"/")+t)),e.push(s)),1;if(o=0,r=r===""?".":r+":",Ev(t))for(var a=0;a<t.length;a++){i=t[a];var l=r+kf(i,a);o+=ku(i,e,n,l,s)}else if(l=wR(t),typeof l=="function")for(t=l.call(t),a=0;!(i=t.next()).done;)i=i.value,l=r+kf(i,a++),o+=ku(i,e,n,l,s);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function eu(t,e,n){if(t==null)return t;var r=[],s=0;return ku(t,r,"","",function(i){return e.call(n,i,s++)}),r}function TR(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var vn={current:null},Nu={transition:null},xR={ReactCurrentDispatcher:vn,ReactCurrentBatchConfig:Nu,ReactCurrentOwner:dg};function TT(){throw Error("act(...) is not supported in production builds of React.")}De.Children={map:eu,forEach:function(t,e,n){eu(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return eu(t,function(){e++}),e},toArray:function(t){return eu(t,function(e){return e})||[]},only:function(t){if(!hg(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};De.Component=Ta;De.Fragment=dR;De.Profiler=fR;De.PureComponent=cg;De.StrictMode=hR;De.Suspense=yR;De.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=xR;De.act=TT;De.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=yT({},t.props),s=t.key,i=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,o=dg.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(l in e)wT.call(e,l)&&!ET.hasOwnProperty(l)&&(r[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)r.children=n;else if(1<l){a=Array(l);for(var d=0;d<l;d++)a[d]=arguments[d+2];r.children=a}return{$$typeof:vc,type:t.type,key:s,ref:i,props:r,_owner:o}};De.createContext=function(t){return t={$$typeof:mR,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:pR,_context:t},t.Consumer=t};De.createElement=IT;De.createFactory=function(t){var e=IT.bind(null,t);return e.type=t,e};De.createRef=function(){return{current:null}};De.forwardRef=function(t){return{$$typeof:gR,render:t}};De.isValidElement=hg;De.lazy=function(t){return{$$typeof:vR,_payload:{_status:-1,_result:t},_init:TR}};De.memo=function(t,e){return{$$typeof:_R,type:t,compare:e===void 0?null:e}};De.startTransition=function(t){var e=Nu.transition;Nu.transition={};try{t()}finally{Nu.transition=e}};De.unstable_act=TT;De.useCallback=function(t,e){return vn.current.useCallback(t,e)};De.useContext=function(t){return vn.current.useContext(t)};De.useDebugValue=function(){};De.useDeferredValue=function(t){return vn.current.useDeferredValue(t)};De.useEffect=function(t,e){return vn.current.useEffect(t,e)};De.useId=function(){return vn.current.useId()};De.useImperativeHandle=function(t,e,n){return vn.current.useImperativeHandle(t,e,n)};De.useInsertionEffect=function(t,e){return vn.current.useInsertionEffect(t,e)};De.useLayoutEffect=function(t,e){return vn.current.useLayoutEffect(t,e)};De.useMemo=function(t,e){return vn.current.useMemo(t,e)};De.useReducer=function(t,e,n){return vn.current.useReducer(t,e,n)};De.useRef=function(t){return vn.current.useRef(t)};De.useState=function(t){return vn.current.useState(t)};De.useSyncExternalStore=function(t,e,n){return vn.current.useSyncExternalStore(t,e,n)};De.useTransition=function(){return vn.current.useTransition()};De.version="18.3.1";mT.exports=De;var k=mT.exports;const xT=cR(k);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var SR=k,bR=Symbol.for("react.element"),CR=Symbol.for("react.fragment"),AR=Object.prototype.hasOwnProperty,RR=SR.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,PR={key:!0,ref:!0,__self:!0,__source:!0};function ST(t,e,n){var r,s={},i=null,o=null;n!==void 0&&(i=""+n),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)AR.call(e,r)&&!PR.hasOwnProperty(r)&&(s[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)s[r]===void 0&&(s[r]=e[r]);return{$$typeof:bR,type:t,key:i,ref:o,props:s,_owner:RR.current}}uh.Fragment=CR;uh.jsx=ST;uh.jsxs=ST;pT.exports=uh;var u=pT.exports,bT={exports:{}},Fn={},CT={exports:{}},AT={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(J,ue){var G=J.length;J.push(ue);e:for(;0<G;){var je=G-1>>>1,Ke=J[je];if(0<s(Ke,ue))J[je]=ue,J[G]=Ke,G=je;else break e}}function n(J){return J.length===0?null:J[0]}function r(J){if(J.length===0)return null;var ue=J[0],G=J.pop();if(G!==ue){J[0]=G;e:for(var je=0,Ke=J.length,B=Ke>>>1;je<B;){var ne=2*(je+1)-1,de=J[ne],Ie=ne+1,xe=J[Ie];if(0>s(de,G))Ie<Ke&&0>s(xe,de)?(J[je]=xe,J[Ie]=G,je=Ie):(J[je]=de,J[ne]=G,je=ne);else if(Ie<Ke&&0>s(xe,G))J[je]=xe,J[Ie]=G,je=Ie;else break e}}return ue}function s(J,ue){var G=J.sortIndex-ue.sortIndex;return G!==0?G:J.id-ue.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var l=[],d=[],h=1,f=null,m=3,v=!1,R=!1,b=!1,A=typeof setTimeout=="function"?setTimeout:null,I=typeof clearTimeout=="function"?clearTimeout:null,w=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function y(J){for(var ue=n(d);ue!==null;){if(ue.callback===null)r(d);else if(ue.startTime<=J)r(d),ue.sortIndex=ue.expirationTime,e(l,ue);else break;ue=n(d)}}function j(J){if(b=!1,y(J),!R)if(n(l)!==null)R=!0,Mt(V);else{var ue=n(d);ue!==null&&Zt(j,ue.startTime-J)}}function V(J,ue){R=!1,b&&(b=!1,I(_),_=-1),v=!0;var G=m;try{for(y(ue),f=n(l);f!==null&&(!(f.expirationTime>ue)||J&&!N());){var je=f.callback;if(typeof je=="function"){f.callback=null,m=f.priorityLevel;var Ke=je(f.expirationTime<=ue);ue=t.unstable_now(),typeof Ke=="function"?f.callback=Ke:f===n(l)&&r(l),y(ue)}else r(l);f=n(l)}if(f!==null)var B=!0;else{var ne=n(d);ne!==null&&Zt(j,ne.startTime-ue),B=!1}return B}finally{f=null,m=G,v=!1}}var M=!1,T=null,_=-1,S=5,C=-1;function N(){return!(t.unstable_now()-C<S)}function D(){if(T!==null){var J=t.unstable_now();C=J;var ue=!0;try{ue=T(!0,J)}finally{ue?P():(M=!1,T=null)}}else M=!1}var P;if(typeof w=="function")P=function(){w(D)};else if(typeof MessageChannel<"u"){var Y=new MessageChannel,Ye=Y.port2;Y.port1.onmessage=D,P=function(){Ye.postMessage(null)}}else P=function(){A(D,0)};function Mt(J){T=J,M||(M=!0,P())}function Zt(J,ue){_=A(function(){J(t.unstable_now())},ue)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(J){J.callback=null},t.unstable_continueExecution=function(){R||v||(R=!0,Mt(V))},t.unstable_forceFrameRate=function(J){0>J||125<J?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):S=0<J?Math.floor(1e3/J):5},t.unstable_getCurrentPriorityLevel=function(){return m},t.unstable_getFirstCallbackNode=function(){return n(l)},t.unstable_next=function(J){switch(m){case 1:case 2:case 3:var ue=3;break;default:ue=m}var G=m;m=ue;try{return J()}finally{m=G}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(J,ue){switch(J){case 1:case 2:case 3:case 4:case 5:break;default:J=3}var G=m;m=J;try{return ue()}finally{m=G}},t.unstable_scheduleCallback=function(J,ue,G){var je=t.unstable_now();switch(typeof G=="object"&&G!==null?(G=G.delay,G=typeof G=="number"&&0<G?je+G:je):G=je,J){case 1:var Ke=-1;break;case 2:Ke=250;break;case 5:Ke=1073741823;break;case 4:Ke=1e4;break;default:Ke=5e3}return Ke=G+Ke,J={id:h++,callback:ue,priorityLevel:J,startTime:G,expirationTime:Ke,sortIndex:-1},G>je?(J.sortIndex=G,e(d,J),n(l)===null&&J===n(d)&&(b?(I(_),_=-1):b=!0,Zt(j,G-je))):(J.sortIndex=Ke,e(l,J),R||v||(R=!0,Mt(V))),J},t.unstable_shouldYield=N,t.unstable_wrapCallback=function(J){var ue=m;return function(){var G=m;m=ue;try{return J.apply(this,arguments)}finally{m=G}}}})(AT);CT.exports=AT;var kR=CT.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var NR=k,Ln=kR;function W(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var RT=new Set,$l={};function to(t,e){na(t,e),na(t+"Capture",e)}function na(t,e){for($l[t]=e,t=0;t<e.length;t++)RT.add(e[t])}var Kr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Dp=Object.prototype.hasOwnProperty,DR=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Tv={},xv={};function jR(t){return Dp.call(xv,t)?!0:Dp.call(Tv,t)?!1:DR.test(t)?xv[t]=!0:(Tv[t]=!0,!1)}function OR(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function VR(t,e,n,r){if(e===null||typeof e>"u"||OR(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function wn(t,e,n,r,s,i,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=o}var Jt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Jt[t]=new wn(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Jt[e]=new wn(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Jt[t]=new wn(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Jt[t]=new wn(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Jt[t]=new wn(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Jt[t]=new wn(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Jt[t]=new wn(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Jt[t]=new wn(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Jt[t]=new wn(t,5,!1,t.toLowerCase(),null,!1,!1)});var fg=/[\-:]([a-z])/g;function pg(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(fg,pg);Jt[e]=new wn(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(fg,pg);Jt[e]=new wn(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(fg,pg);Jt[e]=new wn(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Jt[t]=new wn(t,1,!1,t.toLowerCase(),null,!1,!1)});Jt.xlinkHref=new wn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Jt[t]=new wn(t,1,!1,t.toLowerCase(),null,!0,!0)});function mg(t,e,n,r){var s=Jt.hasOwnProperty(e)?Jt[e]:null;(s!==null?s.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(VR(e,n,s,r)&&(n=null),r||s===null?jR(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):s.mustUseProperty?t[s.propertyName]=n===null?s.type===3?!1:"":n:(e=s.attributeName,r=s.attributeNamespace,n===null?t.removeAttribute(e):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var rs=NR.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,tu=Symbol.for("react.element"),Ro=Symbol.for("react.portal"),Po=Symbol.for("react.fragment"),gg=Symbol.for("react.strict_mode"),jp=Symbol.for("react.profiler"),PT=Symbol.for("react.provider"),kT=Symbol.for("react.context"),yg=Symbol.for("react.forward_ref"),Op=Symbol.for("react.suspense"),Vp=Symbol.for("react.suspense_list"),_g=Symbol.for("react.memo"),ys=Symbol.for("react.lazy"),NT=Symbol.for("react.offscreen"),Sv=Symbol.iterator;function Ka(t){return t===null||typeof t!="object"?null:(t=Sv&&t[Sv]||t["@@iterator"],typeof t=="function"?t:null)}var yt=Object.assign,Nf;function cl(t){if(Nf===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);Nf=e&&e[1]||""}return`
`+Nf+t}var Df=!1;function jf(t,e){if(!t||Df)return"";Df=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(d){var r=d}Reflect.construct(t,[],e)}else{try{e.call()}catch(d){r=d}t.call(e.prototype)}else{try{throw Error()}catch(d){r=d}t()}}catch(d){if(d&&r&&typeof d.stack=="string"){for(var s=d.stack.split(`
`),i=r.stack.split(`
`),o=s.length-1,a=i.length-1;1<=o&&0<=a&&s[o]!==i[a];)a--;for(;1<=o&&0<=a;o--,a--)if(s[o]!==i[a]){if(o!==1||a!==1)do if(o--,a--,0>a||s[o]!==i[a]){var l=`
`+s[o].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=o&&0<=a);break}}}finally{Df=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?cl(t):""}function LR(t){switch(t.tag){case 5:return cl(t.type);case 16:return cl("Lazy");case 13:return cl("Suspense");case 19:return cl("SuspenseList");case 0:case 2:case 15:return t=jf(t.type,!1),t;case 11:return t=jf(t.type.render,!1),t;case 1:return t=jf(t.type,!0),t;default:return""}}function Lp(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Po:return"Fragment";case Ro:return"Portal";case jp:return"Profiler";case gg:return"StrictMode";case Op:return"Suspense";case Vp:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case kT:return(t.displayName||"Context")+".Consumer";case PT:return(t._context.displayName||"Context")+".Provider";case yg:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case _g:return e=t.displayName||null,e!==null?e:Lp(t.type)||"Memo";case ys:e=t._payload,t=t._init;try{return Lp(t(e))}catch{}}return null}function MR(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Lp(e);case 8:return e===gg?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Hs(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function DT(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function FR(t){var e=DT(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,i=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(o){r=""+o,i.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function nu(t){t._valueTracker||(t._valueTracker=FR(t))}function jT(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=DT(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function ad(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Mp(t,e){var n=e.checked;return yt({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function bv(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=Hs(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function OT(t,e){e=e.checked,e!=null&&mg(t,"checked",e,!1)}function Fp(t,e){OT(t,e);var n=Hs(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Up(t,e.type,n):e.hasOwnProperty("defaultValue")&&Up(t,e.type,Hs(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function Cv(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function Up(t,e,n){(e!=="number"||ad(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var ul=Array.isArray;function Bo(t,e,n,r){if(t=t.options,e){e={};for(var s=0;s<n.length;s++)e["$"+n[s]]=!0;for(n=0;n<t.length;n++)s=e.hasOwnProperty("$"+t[n].value),t[n].selected!==s&&(t[n].selected=s),s&&r&&(t[n].defaultSelected=!0)}else{for(n=""+Hs(n),e=null,s=0;s<t.length;s++){if(t[s].value===n){t[s].selected=!0,r&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function $p(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(W(91));return yt({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function Av(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(W(92));if(ul(n)){if(1<n.length)throw Error(W(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Hs(n)}}function VT(t,e){var n=Hs(e.value),r=Hs(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function Rv(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function LT(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Bp(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?LT(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var ru,MT=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,s){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(ru=ru||document.createElement("div"),ru.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=ru.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Bl(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var Il={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},UR=["Webkit","ms","Moz","O"];Object.keys(Il).forEach(function(t){UR.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Il[e]=Il[t]})});function FT(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||Il.hasOwnProperty(t)&&Il[t]?(""+e).trim():e+"px"}function UT(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=FT(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,s):t[n]=s}}var $R=yt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function zp(t,e){if(e){if($R[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(W(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(W(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(W(61))}if(e.style!=null&&typeof e.style!="object")throw Error(W(62))}}function qp(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Hp=null;function vg(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Wp=null,zo=null,qo=null;function Pv(t){if(t=Ic(t)){if(typeof Wp!="function")throw Error(W(280));var e=t.stateNode;e&&(e=mh(e),Wp(t.stateNode,t.type,e))}}function $T(t){zo?qo?qo.push(t):qo=[t]:zo=t}function BT(){if(zo){var t=zo,e=qo;if(qo=zo=null,Pv(t),e)for(t=0;t<e.length;t++)Pv(e[t])}}function zT(t,e){return t(e)}function qT(){}var Of=!1;function HT(t,e,n){if(Of)return t(e,n);Of=!0;try{return zT(t,e,n)}finally{Of=!1,(zo!==null||qo!==null)&&(qT(),BT())}}function zl(t,e){var n=t.stateNode;if(n===null)return null;var r=mh(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(W(231,e,typeof n));return n}var Kp=!1;if(Kr)try{var Ga={};Object.defineProperty(Ga,"passive",{get:function(){Kp=!0}}),window.addEventListener("test",Ga,Ga),window.removeEventListener("test",Ga,Ga)}catch{Kp=!1}function BR(t,e,n,r,s,i,o,a,l){var d=Array.prototype.slice.call(arguments,3);try{e.apply(n,d)}catch(h){this.onError(h)}}var Tl=!1,ld=null,cd=!1,Gp=null,zR={onError:function(t){Tl=!0,ld=t}};function qR(t,e,n,r,s,i,o,a,l){Tl=!1,ld=null,BR.apply(zR,arguments)}function HR(t,e,n,r,s,i,o,a,l){if(qR.apply(this,arguments),Tl){if(Tl){var d=ld;Tl=!1,ld=null}else throw Error(W(198));cd||(cd=!0,Gp=d)}}function no(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function WT(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function kv(t){if(no(t)!==t)throw Error(W(188))}function WR(t){var e=t.alternate;if(!e){if(e=no(t),e===null)throw Error(W(188));return e!==t?null:t}for(var n=t,r=e;;){var s=n.return;if(s===null)break;var i=s.alternate;if(i===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===n)return kv(s),t;if(i===r)return kv(s),e;i=i.sibling}throw Error(W(188))}if(n.return!==r.return)n=s,r=i;else{for(var o=!1,a=s.child;a;){if(a===n){o=!0,n=s,r=i;break}if(a===r){o=!0,r=s,n=i;break}a=a.sibling}if(!o){for(a=i.child;a;){if(a===n){o=!0,n=i,r=s;break}if(a===r){o=!0,r=i,n=s;break}a=a.sibling}if(!o)throw Error(W(189))}}if(n.alternate!==r)throw Error(W(190))}if(n.tag!==3)throw Error(W(188));return n.stateNode.current===n?t:e}function KT(t){return t=WR(t),t!==null?GT(t):null}function GT(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=GT(t);if(e!==null)return e;t=t.sibling}return null}var QT=Ln.unstable_scheduleCallback,Nv=Ln.unstable_cancelCallback,KR=Ln.unstable_shouldYield,GR=Ln.unstable_requestPaint,bt=Ln.unstable_now,QR=Ln.unstable_getCurrentPriorityLevel,wg=Ln.unstable_ImmediatePriority,YT=Ln.unstable_UserBlockingPriority,ud=Ln.unstable_NormalPriority,YR=Ln.unstable_LowPriority,XT=Ln.unstable_IdlePriority,dh=null,Rr=null;function XR(t){if(Rr&&typeof Rr.onCommitFiberRoot=="function")try{Rr.onCommitFiberRoot(dh,t,void 0,(t.current.flags&128)===128)}catch{}}var lr=Math.clz32?Math.clz32:e1,JR=Math.log,ZR=Math.LN2;function e1(t){return t>>>=0,t===0?32:31-(JR(t)/ZR|0)|0}var su=64,iu=4194304;function dl(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function dd(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,s=t.suspendedLanes,i=t.pingedLanes,o=n&268435455;if(o!==0){var a=o&~s;a!==0?r=dl(a):(i&=o,i!==0&&(r=dl(i)))}else o=n&~s,o!==0?r=dl(o):i!==0&&(r=dl(i));if(r===0)return 0;if(e!==0&&e!==r&&!(e&s)&&(s=r&-r,i=e&-e,s>=i||s===16&&(i&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-lr(e),s=1<<n,r|=t[n],e&=~s;return r}function t1(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function n1(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,s=t.expirationTimes,i=t.pendingLanes;0<i;){var o=31-lr(i),a=1<<o,l=s[o];l===-1?(!(a&n)||a&r)&&(s[o]=t1(a,e)):l<=e&&(t.expiredLanes|=a),i&=~a}}function Qp(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function JT(){var t=su;return su<<=1,!(su&4194240)&&(su=64),t}function Vf(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function wc(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-lr(e),t[e]=n}function r1(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var s=31-lr(n),i=1<<s;e[s]=0,r[s]=-1,t[s]=-1,n&=~i}}function Eg(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-lr(n),s=1<<r;s&e|t[r]&e&&(t[r]|=e),n&=~s}}var et=0;function ZT(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var e0,Ig,t0,n0,r0,Yp=!1,ou=[],ks=null,Ns=null,Ds=null,ql=new Map,Hl=new Map,vs=[],s1="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Dv(t,e){switch(t){case"focusin":case"focusout":ks=null;break;case"dragenter":case"dragleave":Ns=null;break;case"mouseover":case"mouseout":Ds=null;break;case"pointerover":case"pointerout":ql.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Hl.delete(e.pointerId)}}function Qa(t,e,n,r,s,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[s]},e!==null&&(e=Ic(e),e!==null&&Ig(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function i1(t,e,n,r,s){switch(e){case"focusin":return ks=Qa(ks,t,e,n,r,s),!0;case"dragenter":return Ns=Qa(Ns,t,e,n,r,s),!0;case"mouseover":return Ds=Qa(Ds,t,e,n,r,s),!0;case"pointerover":var i=s.pointerId;return ql.set(i,Qa(ql.get(i)||null,t,e,n,r,s)),!0;case"gotpointercapture":return i=s.pointerId,Hl.set(i,Qa(Hl.get(i)||null,t,e,n,r,s)),!0}return!1}function s0(t){var e=Ti(t.target);if(e!==null){var n=no(e);if(n!==null){if(e=n.tag,e===13){if(e=WT(n),e!==null){t.blockedOn=e,r0(t.priority,function(){t0(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Du(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=Xp(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);Hp=r,n.target.dispatchEvent(r),Hp=null}else return e=Ic(n),e!==null&&Ig(e),t.blockedOn=n,!1;e.shift()}return!0}function jv(t,e,n){Du(t)&&n.delete(e)}function o1(){Yp=!1,ks!==null&&Du(ks)&&(ks=null),Ns!==null&&Du(Ns)&&(Ns=null),Ds!==null&&Du(Ds)&&(Ds=null),ql.forEach(jv),Hl.forEach(jv)}function Ya(t,e){t.blockedOn===e&&(t.blockedOn=null,Yp||(Yp=!0,Ln.unstable_scheduleCallback(Ln.unstable_NormalPriority,o1)))}function Wl(t){function e(s){return Ya(s,t)}if(0<ou.length){Ya(ou[0],t);for(var n=1;n<ou.length;n++){var r=ou[n];r.blockedOn===t&&(r.blockedOn=null)}}for(ks!==null&&Ya(ks,t),Ns!==null&&Ya(Ns,t),Ds!==null&&Ya(Ds,t),ql.forEach(e),Hl.forEach(e),n=0;n<vs.length;n++)r=vs[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<vs.length&&(n=vs[0],n.blockedOn===null);)s0(n),n.blockedOn===null&&vs.shift()}var Ho=rs.ReactCurrentBatchConfig,hd=!0;function a1(t,e,n,r){var s=et,i=Ho.transition;Ho.transition=null;try{et=1,Tg(t,e,n,r)}finally{et=s,Ho.transition=i}}function l1(t,e,n,r){var s=et,i=Ho.transition;Ho.transition=null;try{et=4,Tg(t,e,n,r)}finally{et=s,Ho.transition=i}}function Tg(t,e,n,r){if(hd){var s=Xp(t,e,n,r);if(s===null)Wf(t,e,r,fd,n),Dv(t,r);else if(i1(s,t,e,n,r))r.stopPropagation();else if(Dv(t,r),e&4&&-1<s1.indexOf(t)){for(;s!==null;){var i=Ic(s);if(i!==null&&e0(i),i=Xp(t,e,n,r),i===null&&Wf(t,e,r,fd,n),i===s)break;s=i}s!==null&&r.stopPropagation()}else Wf(t,e,r,null,n)}}var fd=null;function Xp(t,e,n,r){if(fd=null,t=vg(r),t=Ti(t),t!==null)if(e=no(t),e===null)t=null;else if(n=e.tag,n===13){if(t=WT(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return fd=t,null}function i0(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(QR()){case wg:return 1;case YT:return 4;case ud:case YR:return 16;case XT:return 536870912;default:return 16}default:return 16}}var As=null,xg=null,ju=null;function o0(){if(ju)return ju;var t,e=xg,n=e.length,r,s="value"in As?As.value:As.textContent,i=s.length;for(t=0;t<n&&e[t]===s[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===s[i-r];r++);return ju=s.slice(t,1<r?1-r:void 0)}function Ou(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function au(){return!0}function Ov(){return!1}function Un(t){function e(n,r,s,i,o){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(n=t[a],this[a]=n?n(i):i[a]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?au:Ov,this.isPropagationStopped=Ov,this}return yt(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=au)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=au)},persist:function(){},isPersistent:au}),e}var xa={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Sg=Un(xa),Ec=yt({},xa,{view:0,detail:0}),c1=Un(Ec),Lf,Mf,Xa,hh=yt({},Ec,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:bg,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Xa&&(Xa&&t.type==="mousemove"?(Lf=t.screenX-Xa.screenX,Mf=t.screenY-Xa.screenY):Mf=Lf=0,Xa=t),Lf)},movementY:function(t){return"movementY"in t?t.movementY:Mf}}),Vv=Un(hh),u1=yt({},hh,{dataTransfer:0}),d1=Un(u1),h1=yt({},Ec,{relatedTarget:0}),Ff=Un(h1),f1=yt({},xa,{animationName:0,elapsedTime:0,pseudoElement:0}),p1=Un(f1),m1=yt({},xa,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),g1=Un(m1),y1=yt({},xa,{data:0}),Lv=Un(y1),_1={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},v1={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},w1={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function E1(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=w1[t])?!!e[t]:!1}function bg(){return E1}var I1=yt({},Ec,{key:function(t){if(t.key){var e=_1[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Ou(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?v1[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:bg,charCode:function(t){return t.type==="keypress"?Ou(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Ou(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),T1=Un(I1),x1=yt({},hh,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Mv=Un(x1),S1=yt({},Ec,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:bg}),b1=Un(S1),C1=yt({},xa,{propertyName:0,elapsedTime:0,pseudoElement:0}),A1=Un(C1),R1=yt({},hh,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),P1=Un(R1),k1=[9,13,27,32],Cg=Kr&&"CompositionEvent"in window,xl=null;Kr&&"documentMode"in document&&(xl=document.documentMode);var N1=Kr&&"TextEvent"in window&&!xl,a0=Kr&&(!Cg||xl&&8<xl&&11>=xl),Fv=" ",Uv=!1;function l0(t,e){switch(t){case"keyup":return k1.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function c0(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var ko=!1;function D1(t,e){switch(t){case"compositionend":return c0(e);case"keypress":return e.which!==32?null:(Uv=!0,Fv);case"textInput":return t=e.data,t===Fv&&Uv?null:t;default:return null}}function j1(t,e){if(ko)return t==="compositionend"||!Cg&&l0(t,e)?(t=o0(),ju=xg=As=null,ko=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return a0&&e.locale!=="ko"?null:e.data;default:return null}}var O1={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function $v(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!O1[t.type]:e==="textarea"}function u0(t,e,n,r){$T(r),e=pd(e,"onChange"),0<e.length&&(n=new Sg("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var Sl=null,Kl=null;function V1(t){E0(t,0)}function fh(t){var e=jo(t);if(jT(e))return t}function L1(t,e){if(t==="change")return e}var d0=!1;if(Kr){var Uf;if(Kr){var $f="oninput"in document;if(!$f){var Bv=document.createElement("div");Bv.setAttribute("oninput","return;"),$f=typeof Bv.oninput=="function"}Uf=$f}else Uf=!1;d0=Uf&&(!document.documentMode||9<document.documentMode)}function zv(){Sl&&(Sl.detachEvent("onpropertychange",h0),Kl=Sl=null)}function h0(t){if(t.propertyName==="value"&&fh(Kl)){var e=[];u0(e,Kl,t,vg(t)),HT(V1,e)}}function M1(t,e,n){t==="focusin"?(zv(),Sl=e,Kl=n,Sl.attachEvent("onpropertychange",h0)):t==="focusout"&&zv()}function F1(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return fh(Kl)}function U1(t,e){if(t==="click")return fh(e)}function $1(t,e){if(t==="input"||t==="change")return fh(e)}function B1(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var dr=typeof Object.is=="function"?Object.is:B1;function Gl(t,e){if(dr(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!Dp.call(e,s)||!dr(t[s],e[s]))return!1}return!0}function qv(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Hv(t,e){var n=qv(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=qv(n)}}function f0(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?f0(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function p0(){for(var t=window,e=ad();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=ad(t.document)}return e}function Ag(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function z1(t){var e=p0(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&f0(n.ownerDocument.documentElement,n)){if(r!==null&&Ag(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=n.textContent.length,i=Math.min(r.start,s);r=r.end===void 0?i:Math.min(r.end,s),!t.extend&&i>r&&(s=r,r=i,i=s),s=Hv(n,i);var o=Hv(n,r);s&&o&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),i>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var q1=Kr&&"documentMode"in document&&11>=document.documentMode,No=null,Jp=null,bl=null,Zp=!1;function Wv(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Zp||No==null||No!==ad(r)||(r=No,"selectionStart"in r&&Ag(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),bl&&Gl(bl,r)||(bl=r,r=pd(Jp,"onSelect"),0<r.length&&(e=new Sg("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=No)))}function lu(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Do={animationend:lu("Animation","AnimationEnd"),animationiteration:lu("Animation","AnimationIteration"),animationstart:lu("Animation","AnimationStart"),transitionend:lu("Transition","TransitionEnd")},Bf={},m0={};Kr&&(m0=document.createElement("div").style,"AnimationEvent"in window||(delete Do.animationend.animation,delete Do.animationiteration.animation,delete Do.animationstart.animation),"TransitionEvent"in window||delete Do.transitionend.transition);function ph(t){if(Bf[t])return Bf[t];if(!Do[t])return t;var e=Do[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in m0)return Bf[t]=e[n];return t}var g0=ph("animationend"),y0=ph("animationiteration"),_0=ph("animationstart"),v0=ph("transitionend"),w0=new Map,Kv="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Js(t,e){w0.set(t,e),to(e,[t])}for(var zf=0;zf<Kv.length;zf++){var qf=Kv[zf],H1=qf.toLowerCase(),W1=qf[0].toUpperCase()+qf.slice(1);Js(H1,"on"+W1)}Js(g0,"onAnimationEnd");Js(y0,"onAnimationIteration");Js(_0,"onAnimationStart");Js("dblclick","onDoubleClick");Js("focusin","onFocus");Js("focusout","onBlur");Js(v0,"onTransitionEnd");na("onMouseEnter",["mouseout","mouseover"]);na("onMouseLeave",["mouseout","mouseover"]);na("onPointerEnter",["pointerout","pointerover"]);na("onPointerLeave",["pointerout","pointerover"]);to("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));to("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));to("onBeforeInput",["compositionend","keypress","textInput","paste"]);to("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));to("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));to("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var hl="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),K1=new Set("cancel close invalid load scroll toggle".split(" ").concat(hl));function Gv(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,HR(r,e,void 0,t),t.currentTarget=null}function E0(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],s=r.event;r=r.listeners;e:{var i=void 0;if(e)for(var o=r.length-1;0<=o;o--){var a=r[o],l=a.instance,d=a.currentTarget;if(a=a.listener,l!==i&&s.isPropagationStopped())break e;Gv(s,a,d),i=l}else for(o=0;o<r.length;o++){if(a=r[o],l=a.instance,d=a.currentTarget,a=a.listener,l!==i&&s.isPropagationStopped())break e;Gv(s,a,d),i=l}}}if(cd)throw t=Gp,cd=!1,Gp=null,t}function at(t,e){var n=e[sm];n===void 0&&(n=e[sm]=new Set);var r=t+"__bubble";n.has(r)||(I0(e,t,2,!1),n.add(r))}function Hf(t,e,n){var r=0;e&&(r|=4),I0(n,t,r,e)}var cu="_reactListening"+Math.random().toString(36).slice(2);function Ql(t){if(!t[cu]){t[cu]=!0,RT.forEach(function(n){n!=="selectionchange"&&(K1.has(n)||Hf(n,!1,t),Hf(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[cu]||(e[cu]=!0,Hf("selectionchange",!1,e))}}function I0(t,e,n,r){switch(i0(e)){case 1:var s=a1;break;case 4:s=l1;break;default:s=Tg}n=s.bind(null,e,n,t),s=void 0,!Kp||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),r?s!==void 0?t.addEventListener(e,n,{capture:!0,passive:s}):t.addEventListener(e,n,!0):s!==void 0?t.addEventListener(e,n,{passive:s}):t.addEventListener(e,n,!1)}function Wf(t,e,n,r,s){var i=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var a=r.stateNode.containerInfo;if(a===s||a.nodeType===8&&a.parentNode===s)break;if(o===4)for(o=r.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===s||l.nodeType===8&&l.parentNode===s))return;o=o.return}for(;a!==null;){if(o=Ti(a),o===null)return;if(l=o.tag,l===5||l===6){r=i=o;continue e}a=a.parentNode}}r=r.return}HT(function(){var d=i,h=vg(n),f=[];e:{var m=w0.get(t);if(m!==void 0){var v=Sg,R=t;switch(t){case"keypress":if(Ou(n)===0)break e;case"keydown":case"keyup":v=T1;break;case"focusin":R="focus",v=Ff;break;case"focusout":R="blur",v=Ff;break;case"beforeblur":case"afterblur":v=Ff;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":v=Vv;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":v=d1;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":v=b1;break;case g0:case y0:case _0:v=p1;break;case v0:v=A1;break;case"scroll":v=c1;break;case"wheel":v=P1;break;case"copy":case"cut":case"paste":v=g1;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":v=Mv}var b=(e&4)!==0,A=!b&&t==="scroll",I=b?m!==null?m+"Capture":null:m;b=[];for(var w=d,y;w!==null;){y=w;var j=y.stateNode;if(y.tag===5&&j!==null&&(y=j,I!==null&&(j=zl(w,I),j!=null&&b.push(Yl(w,j,y)))),A)break;w=w.return}0<b.length&&(m=new v(m,R,null,n,h),f.push({event:m,listeners:b}))}}if(!(e&7)){e:{if(m=t==="mouseover"||t==="pointerover",v=t==="mouseout"||t==="pointerout",m&&n!==Hp&&(R=n.relatedTarget||n.fromElement)&&(Ti(R)||R[Gr]))break e;if((v||m)&&(m=h.window===h?h:(m=h.ownerDocument)?m.defaultView||m.parentWindow:window,v?(R=n.relatedTarget||n.toElement,v=d,R=R?Ti(R):null,R!==null&&(A=no(R),R!==A||R.tag!==5&&R.tag!==6)&&(R=null)):(v=null,R=d),v!==R)){if(b=Vv,j="onMouseLeave",I="onMouseEnter",w="mouse",(t==="pointerout"||t==="pointerover")&&(b=Mv,j="onPointerLeave",I="onPointerEnter",w="pointer"),A=v==null?m:jo(v),y=R==null?m:jo(R),m=new b(j,w+"leave",v,n,h),m.target=A,m.relatedTarget=y,j=null,Ti(h)===d&&(b=new b(I,w+"enter",R,n,h),b.target=y,b.relatedTarget=A,j=b),A=j,v&&R)t:{for(b=v,I=R,w=0,y=b;y;y=uo(y))w++;for(y=0,j=I;j;j=uo(j))y++;for(;0<w-y;)b=uo(b),w--;for(;0<y-w;)I=uo(I),y--;for(;w--;){if(b===I||I!==null&&b===I.alternate)break t;b=uo(b),I=uo(I)}b=null}else b=null;v!==null&&Qv(f,m,v,b,!1),R!==null&&A!==null&&Qv(f,A,R,b,!0)}}e:{if(m=d?jo(d):window,v=m.nodeName&&m.nodeName.toLowerCase(),v==="select"||v==="input"&&m.type==="file")var V=L1;else if($v(m))if(d0)V=$1;else{V=F1;var M=M1}else(v=m.nodeName)&&v.toLowerCase()==="input"&&(m.type==="checkbox"||m.type==="radio")&&(V=U1);if(V&&(V=V(t,d))){u0(f,V,n,h);break e}M&&M(t,m,d),t==="focusout"&&(M=m._wrapperState)&&M.controlled&&m.type==="number"&&Up(m,"number",m.value)}switch(M=d?jo(d):window,t){case"focusin":($v(M)||M.contentEditable==="true")&&(No=M,Jp=d,bl=null);break;case"focusout":bl=Jp=No=null;break;case"mousedown":Zp=!0;break;case"contextmenu":case"mouseup":case"dragend":Zp=!1,Wv(f,n,h);break;case"selectionchange":if(q1)break;case"keydown":case"keyup":Wv(f,n,h)}var T;if(Cg)e:{switch(t){case"compositionstart":var _="onCompositionStart";break e;case"compositionend":_="onCompositionEnd";break e;case"compositionupdate":_="onCompositionUpdate";break e}_=void 0}else ko?l0(t,n)&&(_="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(_="onCompositionStart");_&&(a0&&n.locale!=="ko"&&(ko||_!=="onCompositionStart"?_==="onCompositionEnd"&&ko&&(T=o0()):(As=h,xg="value"in As?As.value:As.textContent,ko=!0)),M=pd(d,_),0<M.length&&(_=new Lv(_,t,null,n,h),f.push({event:_,listeners:M}),T?_.data=T:(T=c0(n),T!==null&&(_.data=T)))),(T=N1?D1(t,n):j1(t,n))&&(d=pd(d,"onBeforeInput"),0<d.length&&(h=new Lv("onBeforeInput","beforeinput",null,n,h),f.push({event:h,listeners:d}),h.data=T))}E0(f,e)})}function Yl(t,e,n){return{instance:t,listener:e,currentTarget:n}}function pd(t,e){for(var n=e+"Capture",r=[];t!==null;){var s=t,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=zl(t,n),i!=null&&r.unshift(Yl(t,i,s)),i=zl(t,e),i!=null&&r.push(Yl(t,i,s))),t=t.return}return r}function uo(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function Qv(t,e,n,r,s){for(var i=e._reactName,o=[];n!==null&&n!==r;){var a=n,l=a.alternate,d=a.stateNode;if(l!==null&&l===r)break;a.tag===5&&d!==null&&(a=d,s?(l=zl(n,i),l!=null&&o.unshift(Yl(n,l,a))):s||(l=zl(n,i),l!=null&&o.push(Yl(n,l,a)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var G1=/\r\n?/g,Q1=/\u0000|\uFFFD/g;function Yv(t){return(typeof t=="string"?t:""+t).replace(G1,`
`).replace(Q1,"")}function uu(t,e,n){if(e=Yv(e),Yv(t)!==e&&n)throw Error(W(425))}function md(){}var em=null,tm=null;function nm(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var rm=typeof setTimeout=="function"?setTimeout:void 0,Y1=typeof clearTimeout=="function"?clearTimeout:void 0,Xv=typeof Promise=="function"?Promise:void 0,X1=typeof queueMicrotask=="function"?queueMicrotask:typeof Xv<"u"?function(t){return Xv.resolve(null).then(t).catch(J1)}:rm;function J1(t){setTimeout(function(){throw t})}function Kf(t,e){var n=e,r=0;do{var s=n.nextSibling;if(t.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){t.removeChild(s),Wl(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);Wl(e)}function js(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function Jv(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var Sa=Math.random().toString(36).slice(2),Sr="__reactFiber$"+Sa,Xl="__reactProps$"+Sa,Gr="__reactContainer$"+Sa,sm="__reactEvents$"+Sa,Z1="__reactListeners$"+Sa,eP="__reactHandles$"+Sa;function Ti(t){var e=t[Sr];if(e)return e;for(var n=t.parentNode;n;){if(e=n[Gr]||n[Sr]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=Jv(t);t!==null;){if(n=t[Sr])return n;t=Jv(t)}return e}t=n,n=t.parentNode}return null}function Ic(t){return t=t[Sr]||t[Gr],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function jo(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(W(33))}function mh(t){return t[Xl]||null}var im=[],Oo=-1;function Zs(t){return{current:t}}function lt(t){0>Oo||(t.current=im[Oo],im[Oo]=null,Oo--)}function st(t,e){Oo++,im[Oo]=t.current,t.current=e}var Ws={},dn=Zs(Ws),bn=Zs(!1),Vi=Ws;function ra(t,e){var n=t.type.contextTypes;if(!n)return Ws;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in n)s[i]=e[i];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function Cn(t){return t=t.childContextTypes,t!=null}function gd(){lt(bn),lt(dn)}function Zv(t,e,n){if(dn.current!==Ws)throw Error(W(168));st(dn,e),st(bn,n)}function T0(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in e))throw Error(W(108,MR(t)||"Unknown",s));return yt({},n,r)}function yd(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Ws,Vi=dn.current,st(dn,t),st(bn,bn.current),!0}function ew(t,e,n){var r=t.stateNode;if(!r)throw Error(W(169));n?(t=T0(t,e,Vi),r.__reactInternalMemoizedMergedChildContext=t,lt(bn),lt(dn),st(dn,t)):lt(bn),st(bn,n)}var Fr=null,gh=!1,Gf=!1;function x0(t){Fr===null?Fr=[t]:Fr.push(t)}function tP(t){gh=!0,x0(t)}function ei(){if(!Gf&&Fr!==null){Gf=!0;var t=0,e=et;try{var n=Fr;for(et=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}Fr=null,gh=!1}catch(s){throw Fr!==null&&(Fr=Fr.slice(t+1)),QT(wg,ei),s}finally{et=e,Gf=!1}}return null}var Vo=[],Lo=0,_d=null,vd=0,Bn=[],zn=0,Li=null,Ur=1,$r="";function fi(t,e){Vo[Lo++]=vd,Vo[Lo++]=_d,_d=t,vd=e}function S0(t,e,n){Bn[zn++]=Ur,Bn[zn++]=$r,Bn[zn++]=Li,Li=t;var r=Ur;t=$r;var s=32-lr(r)-1;r&=~(1<<s),n+=1;var i=32-lr(e)+s;if(30<i){var o=s-s%5;i=(r&(1<<o)-1).toString(32),r>>=o,s-=o,Ur=1<<32-lr(e)+s|n<<s|r,$r=i+t}else Ur=1<<i|n<<s|r,$r=t}function Rg(t){t.return!==null&&(fi(t,1),S0(t,1,0))}function Pg(t){for(;t===_d;)_d=Vo[--Lo],Vo[Lo]=null,vd=Vo[--Lo],Vo[Lo]=null;for(;t===Li;)Li=Bn[--zn],Bn[zn]=null,$r=Bn[--zn],Bn[zn]=null,Ur=Bn[--zn],Bn[zn]=null}var On=null,Dn=null,ut=!1,ir=null;function b0(t,e){var n=Wn(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function tw(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,On=t,Dn=js(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,On=t,Dn=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=Li!==null?{id:Ur,overflow:$r}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=Wn(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,On=t,Dn=null,!0):!1;default:return!1}}function om(t){return(t.mode&1)!==0&&(t.flags&128)===0}function am(t){if(ut){var e=Dn;if(e){var n=e;if(!tw(t,e)){if(om(t))throw Error(W(418));e=js(n.nextSibling);var r=On;e&&tw(t,e)?b0(r,n):(t.flags=t.flags&-4097|2,ut=!1,On=t)}}else{if(om(t))throw Error(W(418));t.flags=t.flags&-4097|2,ut=!1,On=t}}}function nw(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;On=t}function du(t){if(t!==On)return!1;if(!ut)return nw(t),ut=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!nm(t.type,t.memoizedProps)),e&&(e=Dn)){if(om(t))throw C0(),Error(W(418));for(;e;)b0(t,e),e=js(e.nextSibling)}if(nw(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(W(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){Dn=js(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}Dn=null}}else Dn=On?js(t.stateNode.nextSibling):null;return!0}function C0(){for(var t=Dn;t;)t=js(t.nextSibling)}function sa(){Dn=On=null,ut=!1}function kg(t){ir===null?ir=[t]:ir.push(t)}var nP=rs.ReactCurrentBatchConfig;function Ja(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(W(309));var r=n.stateNode}if(!r)throw Error(W(147,t));var s=r,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(o){var a=s.refs;o===null?delete a[i]:a[i]=o},e._stringRef=i,e)}if(typeof t!="string")throw Error(W(284));if(!n._owner)throw Error(W(290,t))}return t}function hu(t,e){throw t=Object.prototype.toString.call(e),Error(W(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function rw(t){var e=t._init;return e(t._payload)}function A0(t){function e(I,w){if(t){var y=I.deletions;y===null?(I.deletions=[w],I.flags|=16):y.push(w)}}function n(I,w){if(!t)return null;for(;w!==null;)e(I,w),w=w.sibling;return null}function r(I,w){for(I=new Map;w!==null;)w.key!==null?I.set(w.key,w):I.set(w.index,w),w=w.sibling;return I}function s(I,w){return I=Ms(I,w),I.index=0,I.sibling=null,I}function i(I,w,y){return I.index=y,t?(y=I.alternate,y!==null?(y=y.index,y<w?(I.flags|=2,w):y):(I.flags|=2,w)):(I.flags|=1048576,w)}function o(I){return t&&I.alternate===null&&(I.flags|=2),I}function a(I,w,y,j){return w===null||w.tag!==6?(w=tp(y,I.mode,j),w.return=I,w):(w=s(w,y),w.return=I,w)}function l(I,w,y,j){var V=y.type;return V===Po?h(I,w,y.props.children,j,y.key):w!==null&&(w.elementType===V||typeof V=="object"&&V!==null&&V.$$typeof===ys&&rw(V)===w.type)?(j=s(w,y.props),j.ref=Ja(I,w,y),j.return=I,j):(j=Bu(y.type,y.key,y.props,null,I.mode,j),j.ref=Ja(I,w,y),j.return=I,j)}function d(I,w,y,j){return w===null||w.tag!==4||w.stateNode.containerInfo!==y.containerInfo||w.stateNode.implementation!==y.implementation?(w=np(y,I.mode,j),w.return=I,w):(w=s(w,y.children||[]),w.return=I,w)}function h(I,w,y,j,V){return w===null||w.tag!==7?(w=Ri(y,I.mode,j,V),w.return=I,w):(w=s(w,y),w.return=I,w)}function f(I,w,y){if(typeof w=="string"&&w!==""||typeof w=="number")return w=tp(""+w,I.mode,y),w.return=I,w;if(typeof w=="object"&&w!==null){switch(w.$$typeof){case tu:return y=Bu(w.type,w.key,w.props,null,I.mode,y),y.ref=Ja(I,null,w),y.return=I,y;case Ro:return w=np(w,I.mode,y),w.return=I,w;case ys:var j=w._init;return f(I,j(w._payload),y)}if(ul(w)||Ka(w))return w=Ri(w,I.mode,y,null),w.return=I,w;hu(I,w)}return null}function m(I,w,y,j){var V=w!==null?w.key:null;if(typeof y=="string"&&y!==""||typeof y=="number")return V!==null?null:a(I,w,""+y,j);if(typeof y=="object"&&y!==null){switch(y.$$typeof){case tu:return y.key===V?l(I,w,y,j):null;case Ro:return y.key===V?d(I,w,y,j):null;case ys:return V=y._init,m(I,w,V(y._payload),j)}if(ul(y)||Ka(y))return V!==null?null:h(I,w,y,j,null);hu(I,y)}return null}function v(I,w,y,j,V){if(typeof j=="string"&&j!==""||typeof j=="number")return I=I.get(y)||null,a(w,I,""+j,V);if(typeof j=="object"&&j!==null){switch(j.$$typeof){case tu:return I=I.get(j.key===null?y:j.key)||null,l(w,I,j,V);case Ro:return I=I.get(j.key===null?y:j.key)||null,d(w,I,j,V);case ys:var M=j._init;return v(I,w,y,M(j._payload),V)}if(ul(j)||Ka(j))return I=I.get(y)||null,h(w,I,j,V,null);hu(w,j)}return null}function R(I,w,y,j){for(var V=null,M=null,T=w,_=w=0,S=null;T!==null&&_<y.length;_++){T.index>_?(S=T,T=null):S=T.sibling;var C=m(I,T,y[_],j);if(C===null){T===null&&(T=S);break}t&&T&&C.alternate===null&&e(I,T),w=i(C,w,_),M===null?V=C:M.sibling=C,M=C,T=S}if(_===y.length)return n(I,T),ut&&fi(I,_),V;if(T===null){for(;_<y.length;_++)T=f(I,y[_],j),T!==null&&(w=i(T,w,_),M===null?V=T:M.sibling=T,M=T);return ut&&fi(I,_),V}for(T=r(I,T);_<y.length;_++)S=v(T,I,_,y[_],j),S!==null&&(t&&S.alternate!==null&&T.delete(S.key===null?_:S.key),w=i(S,w,_),M===null?V=S:M.sibling=S,M=S);return t&&T.forEach(function(N){return e(I,N)}),ut&&fi(I,_),V}function b(I,w,y,j){var V=Ka(y);if(typeof V!="function")throw Error(W(150));if(y=V.call(y),y==null)throw Error(W(151));for(var M=V=null,T=w,_=w=0,S=null,C=y.next();T!==null&&!C.done;_++,C=y.next()){T.index>_?(S=T,T=null):S=T.sibling;var N=m(I,T,C.value,j);if(N===null){T===null&&(T=S);break}t&&T&&N.alternate===null&&e(I,T),w=i(N,w,_),M===null?V=N:M.sibling=N,M=N,T=S}if(C.done)return n(I,T),ut&&fi(I,_),V;if(T===null){for(;!C.done;_++,C=y.next())C=f(I,C.value,j),C!==null&&(w=i(C,w,_),M===null?V=C:M.sibling=C,M=C);return ut&&fi(I,_),V}for(T=r(I,T);!C.done;_++,C=y.next())C=v(T,I,_,C.value,j),C!==null&&(t&&C.alternate!==null&&T.delete(C.key===null?_:C.key),w=i(C,w,_),M===null?V=C:M.sibling=C,M=C);return t&&T.forEach(function(D){return e(I,D)}),ut&&fi(I,_),V}function A(I,w,y,j){if(typeof y=="object"&&y!==null&&y.type===Po&&y.key===null&&(y=y.props.children),typeof y=="object"&&y!==null){switch(y.$$typeof){case tu:e:{for(var V=y.key,M=w;M!==null;){if(M.key===V){if(V=y.type,V===Po){if(M.tag===7){n(I,M.sibling),w=s(M,y.props.children),w.return=I,I=w;break e}}else if(M.elementType===V||typeof V=="object"&&V!==null&&V.$$typeof===ys&&rw(V)===M.type){n(I,M.sibling),w=s(M,y.props),w.ref=Ja(I,M,y),w.return=I,I=w;break e}n(I,M);break}else e(I,M);M=M.sibling}y.type===Po?(w=Ri(y.props.children,I.mode,j,y.key),w.return=I,I=w):(j=Bu(y.type,y.key,y.props,null,I.mode,j),j.ref=Ja(I,w,y),j.return=I,I=j)}return o(I);case Ro:e:{for(M=y.key;w!==null;){if(w.key===M)if(w.tag===4&&w.stateNode.containerInfo===y.containerInfo&&w.stateNode.implementation===y.implementation){n(I,w.sibling),w=s(w,y.children||[]),w.return=I,I=w;break e}else{n(I,w);break}else e(I,w);w=w.sibling}w=np(y,I.mode,j),w.return=I,I=w}return o(I);case ys:return M=y._init,A(I,w,M(y._payload),j)}if(ul(y))return R(I,w,y,j);if(Ka(y))return b(I,w,y,j);hu(I,y)}return typeof y=="string"&&y!==""||typeof y=="number"?(y=""+y,w!==null&&w.tag===6?(n(I,w.sibling),w=s(w,y),w.return=I,I=w):(n(I,w),w=tp(y,I.mode,j),w.return=I,I=w),o(I)):n(I,w)}return A}var ia=A0(!0),R0=A0(!1),wd=Zs(null),Ed=null,Mo=null,Ng=null;function Dg(){Ng=Mo=Ed=null}function jg(t){var e=wd.current;lt(wd),t._currentValue=e}function lm(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function Wo(t,e){Ed=t,Ng=Mo=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(xn=!0),t.firstContext=null)}function Yn(t){var e=t._currentValue;if(Ng!==t)if(t={context:t,memoizedValue:e,next:null},Mo===null){if(Ed===null)throw Error(W(308));Mo=t,Ed.dependencies={lanes:0,firstContext:t}}else Mo=Mo.next=t;return e}var xi=null;function Og(t){xi===null?xi=[t]:xi.push(t)}function P0(t,e,n,r){var s=e.interleaved;return s===null?(n.next=n,Og(e)):(n.next=s.next,s.next=n),e.interleaved=n,Qr(t,r)}function Qr(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var _s=!1;function Vg(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function k0(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Hr(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Os(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,qe&2){var s=r.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),r.pending=e,Qr(t,n)}return s=r.interleaved,s===null?(e.next=e,Og(r)):(e.next=s.next,s.next=e),r.interleaved=e,Qr(t,n)}function Vu(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Eg(t,n)}}function sw(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?s=i=o:i=i.next=o,n=n.next}while(n!==null);i===null?s=i=e:i=i.next=e}else s=i=e;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function Id(t,e,n,r){var s=t.updateQueue;_s=!1;var i=s.firstBaseUpdate,o=s.lastBaseUpdate,a=s.shared.pending;if(a!==null){s.shared.pending=null;var l=a,d=l.next;l.next=null,o===null?i=d:o.next=d,o=l;var h=t.alternate;h!==null&&(h=h.updateQueue,a=h.lastBaseUpdate,a!==o&&(a===null?h.firstBaseUpdate=d:a.next=d,h.lastBaseUpdate=l))}if(i!==null){var f=s.baseState;o=0,h=d=l=null,a=i;do{var m=a.lane,v=a.eventTime;if((r&m)===m){h!==null&&(h=h.next={eventTime:v,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var R=t,b=a;switch(m=e,v=n,b.tag){case 1:if(R=b.payload,typeof R=="function"){f=R.call(v,f,m);break e}f=R;break e;case 3:R.flags=R.flags&-65537|128;case 0:if(R=b.payload,m=typeof R=="function"?R.call(v,f,m):R,m==null)break e;f=yt({},f,m);break e;case 2:_s=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,m=s.effects,m===null?s.effects=[a]:m.push(a))}else v={eventTime:v,lane:m,tag:a.tag,payload:a.payload,callback:a.callback,next:null},h===null?(d=h=v,l=f):h=h.next=v,o|=m;if(a=a.next,a===null){if(a=s.shared.pending,a===null)break;m=a,a=m.next,m.next=null,s.lastBaseUpdate=m,s.shared.pending=null}}while(!0);if(h===null&&(l=f),s.baseState=l,s.firstBaseUpdate=d,s.lastBaseUpdate=h,e=s.shared.interleaved,e!==null){s=e;do o|=s.lane,s=s.next;while(s!==e)}else i===null&&(s.shared.lanes=0);Fi|=o,t.lanes=o,t.memoizedState=f}}function iw(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(W(191,s));s.call(r)}}}var Tc={},Pr=Zs(Tc),Jl=Zs(Tc),Zl=Zs(Tc);function Si(t){if(t===Tc)throw Error(W(174));return t}function Lg(t,e){switch(st(Zl,e),st(Jl,t),st(Pr,Tc),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Bp(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Bp(e,t)}lt(Pr),st(Pr,e)}function oa(){lt(Pr),lt(Jl),lt(Zl)}function N0(t){Si(Zl.current);var e=Si(Pr.current),n=Bp(e,t.type);e!==n&&(st(Jl,t),st(Pr,n))}function Mg(t){Jl.current===t&&(lt(Pr),lt(Jl))}var pt=Zs(0);function Td(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Qf=[];function Fg(){for(var t=0;t<Qf.length;t++)Qf[t]._workInProgressVersionPrimary=null;Qf.length=0}var Lu=rs.ReactCurrentDispatcher,Yf=rs.ReactCurrentBatchConfig,Mi=0,gt=null,jt=null,zt=null,xd=!1,Cl=!1,ec=0,rP=0;function tn(){throw Error(W(321))}function Ug(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!dr(t[n],e[n]))return!1;return!0}function $g(t,e,n,r,s,i){if(Mi=i,gt=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Lu.current=t===null||t.memoizedState===null?aP:lP,t=n(r,s),Cl){i=0;do{if(Cl=!1,ec=0,25<=i)throw Error(W(301));i+=1,zt=jt=null,e.updateQueue=null,Lu.current=cP,t=n(r,s)}while(Cl)}if(Lu.current=Sd,e=jt!==null&&jt.next!==null,Mi=0,zt=jt=gt=null,xd=!1,e)throw Error(W(300));return t}function Bg(){var t=ec!==0;return ec=0,t}function Tr(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return zt===null?gt.memoizedState=zt=t:zt=zt.next=t,zt}function Xn(){if(jt===null){var t=gt.alternate;t=t!==null?t.memoizedState:null}else t=jt.next;var e=zt===null?gt.memoizedState:zt.next;if(e!==null)zt=e,jt=t;else{if(t===null)throw Error(W(310));jt=t,t={memoizedState:jt.memoizedState,baseState:jt.baseState,baseQueue:jt.baseQueue,queue:jt.queue,next:null},zt===null?gt.memoizedState=zt=t:zt=zt.next=t}return zt}function tc(t,e){return typeof e=="function"?e(t):e}function Xf(t){var e=Xn(),n=e.queue;if(n===null)throw Error(W(311));n.lastRenderedReducer=t;var r=jt,s=r.baseQueue,i=n.pending;if(i!==null){if(s!==null){var o=s.next;s.next=i.next,i.next=o}r.baseQueue=s=i,n.pending=null}if(s!==null){i=s.next,r=r.baseState;var a=o=null,l=null,d=i;do{var h=d.lane;if((Mi&h)===h)l!==null&&(l=l.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),r=d.hasEagerState?d.eagerState:t(r,d.action);else{var f={lane:h,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};l===null?(a=l=f,o=r):l=l.next=f,gt.lanes|=h,Fi|=h}d=d.next}while(d!==null&&d!==i);l===null?o=r:l.next=a,dr(r,e.memoizedState)||(xn=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=l,n.lastRenderedState=r}if(t=n.interleaved,t!==null){s=t;do i=s.lane,gt.lanes|=i,Fi|=i,s=s.next;while(s!==t)}else s===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function Jf(t){var e=Xn(),n=e.queue;if(n===null)throw Error(W(311));n.lastRenderedReducer=t;var r=n.dispatch,s=n.pending,i=e.memoizedState;if(s!==null){n.pending=null;var o=s=s.next;do i=t(i,o.action),o=o.next;while(o!==s);dr(i,e.memoizedState)||(xn=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),n.lastRenderedState=i}return[i,r]}function D0(){}function j0(t,e){var n=gt,r=Xn(),s=e(),i=!dr(r.memoizedState,s);if(i&&(r.memoizedState=s,xn=!0),r=r.queue,zg(L0.bind(null,n,r,t),[t]),r.getSnapshot!==e||i||zt!==null&&zt.memoizedState.tag&1){if(n.flags|=2048,nc(9,V0.bind(null,n,r,s,e),void 0,null),qt===null)throw Error(W(349));Mi&30||O0(n,e,s)}return s}function O0(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=gt.updateQueue,e===null?(e={lastEffect:null,stores:null},gt.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function V0(t,e,n,r){e.value=n,e.getSnapshot=r,M0(e)&&F0(t)}function L0(t,e,n){return n(function(){M0(e)&&F0(t)})}function M0(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!dr(t,n)}catch{return!0}}function F0(t){var e=Qr(t,1);e!==null&&cr(e,t,1,-1)}function ow(t){var e=Tr();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:tc,lastRenderedState:t},e.queue=t,t=t.dispatch=oP.bind(null,gt,t),[e.memoizedState,t]}function nc(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=gt.updateQueue,e===null?(e={lastEffect:null,stores:null},gt.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function U0(){return Xn().memoizedState}function Mu(t,e,n,r){var s=Tr();gt.flags|=t,s.memoizedState=nc(1|e,n,void 0,r===void 0?null:r)}function yh(t,e,n,r){var s=Xn();r=r===void 0?null:r;var i=void 0;if(jt!==null){var o=jt.memoizedState;if(i=o.destroy,r!==null&&Ug(r,o.deps)){s.memoizedState=nc(e,n,i,r);return}}gt.flags|=t,s.memoizedState=nc(1|e,n,i,r)}function aw(t,e){return Mu(8390656,8,t,e)}function zg(t,e){return yh(2048,8,t,e)}function $0(t,e){return yh(4,2,t,e)}function B0(t,e){return yh(4,4,t,e)}function z0(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function q0(t,e,n){return n=n!=null?n.concat([t]):null,yh(4,4,z0.bind(null,e,t),n)}function qg(){}function H0(t,e){var n=Xn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Ug(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function W0(t,e){var n=Xn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Ug(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function K0(t,e,n){return Mi&21?(dr(n,e)||(n=JT(),gt.lanes|=n,Fi|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,xn=!0),t.memoizedState=n)}function sP(t,e){var n=et;et=n!==0&&4>n?n:4,t(!0);var r=Yf.transition;Yf.transition={};try{t(!1),e()}finally{et=n,Yf.transition=r}}function G0(){return Xn().memoizedState}function iP(t,e,n){var r=Ls(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},Q0(t))Y0(e,n);else if(n=P0(t,e,n,r),n!==null){var s=gn();cr(n,t,r,s),X0(n,e,r)}}function oP(t,e,n){var r=Ls(t),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(Q0(t))Y0(e,s);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var o=e.lastRenderedState,a=i(o,n);if(s.hasEagerState=!0,s.eagerState=a,dr(a,o)){var l=e.interleaved;l===null?(s.next=s,Og(e)):(s.next=l.next,l.next=s),e.interleaved=s;return}}catch{}finally{}n=P0(t,e,s,r),n!==null&&(s=gn(),cr(n,t,r,s),X0(n,e,r))}}function Q0(t){var e=t.alternate;return t===gt||e!==null&&e===gt}function Y0(t,e){Cl=xd=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function X0(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Eg(t,n)}}var Sd={readContext:Yn,useCallback:tn,useContext:tn,useEffect:tn,useImperativeHandle:tn,useInsertionEffect:tn,useLayoutEffect:tn,useMemo:tn,useReducer:tn,useRef:tn,useState:tn,useDebugValue:tn,useDeferredValue:tn,useTransition:tn,useMutableSource:tn,useSyncExternalStore:tn,useId:tn,unstable_isNewReconciler:!1},aP={readContext:Yn,useCallback:function(t,e){return Tr().memoizedState=[t,e===void 0?null:e],t},useContext:Yn,useEffect:aw,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,Mu(4194308,4,z0.bind(null,e,t),n)},useLayoutEffect:function(t,e){return Mu(4194308,4,t,e)},useInsertionEffect:function(t,e){return Mu(4,2,t,e)},useMemo:function(t,e){var n=Tr();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=Tr();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=iP.bind(null,gt,t),[r.memoizedState,t]},useRef:function(t){var e=Tr();return t={current:t},e.memoizedState=t},useState:ow,useDebugValue:qg,useDeferredValue:function(t){return Tr().memoizedState=t},useTransition:function(){var t=ow(!1),e=t[0];return t=sP.bind(null,t[1]),Tr().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=gt,s=Tr();if(ut){if(n===void 0)throw Error(W(407));n=n()}else{if(n=e(),qt===null)throw Error(W(349));Mi&30||O0(r,e,n)}s.memoizedState=n;var i={value:n,getSnapshot:e};return s.queue=i,aw(L0.bind(null,r,i,t),[t]),r.flags|=2048,nc(9,V0.bind(null,r,i,n,e),void 0,null),n},useId:function(){var t=Tr(),e=qt.identifierPrefix;if(ut){var n=$r,r=Ur;n=(r&~(1<<32-lr(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=ec++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=rP++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},lP={readContext:Yn,useCallback:H0,useContext:Yn,useEffect:zg,useImperativeHandle:q0,useInsertionEffect:$0,useLayoutEffect:B0,useMemo:W0,useReducer:Xf,useRef:U0,useState:function(){return Xf(tc)},useDebugValue:qg,useDeferredValue:function(t){var e=Xn();return K0(e,jt.memoizedState,t)},useTransition:function(){var t=Xf(tc)[0],e=Xn().memoizedState;return[t,e]},useMutableSource:D0,useSyncExternalStore:j0,useId:G0,unstable_isNewReconciler:!1},cP={readContext:Yn,useCallback:H0,useContext:Yn,useEffect:zg,useImperativeHandle:q0,useInsertionEffect:$0,useLayoutEffect:B0,useMemo:W0,useReducer:Jf,useRef:U0,useState:function(){return Jf(tc)},useDebugValue:qg,useDeferredValue:function(t){var e=Xn();return jt===null?e.memoizedState=t:K0(e,jt.memoizedState,t)},useTransition:function(){var t=Jf(tc)[0],e=Xn().memoizedState;return[t,e]},useMutableSource:D0,useSyncExternalStore:j0,useId:G0,unstable_isNewReconciler:!1};function nr(t,e){if(t&&t.defaultProps){e=yt({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function cm(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:yt({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var _h={isMounted:function(t){return(t=t._reactInternals)?no(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=gn(),s=Ls(t),i=Hr(r,s);i.payload=e,n!=null&&(i.callback=n),e=Os(t,i,s),e!==null&&(cr(e,t,s,r),Vu(e,t,s))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=gn(),s=Ls(t),i=Hr(r,s);i.tag=1,i.payload=e,n!=null&&(i.callback=n),e=Os(t,i,s),e!==null&&(cr(e,t,s,r),Vu(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=gn(),r=Ls(t),s=Hr(n,r);s.tag=2,e!=null&&(s.callback=e),e=Os(t,s,r),e!==null&&(cr(e,t,r,n),Vu(e,t,r))}};function lw(t,e,n,r,s,i,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,i,o):e.prototype&&e.prototype.isPureReactComponent?!Gl(n,r)||!Gl(s,i):!0}function J0(t,e,n){var r=!1,s=Ws,i=e.contextType;return typeof i=="object"&&i!==null?i=Yn(i):(s=Cn(e)?Vi:dn.current,r=e.contextTypes,i=(r=r!=null)?ra(t,s):Ws),e=new e(n,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=_h,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=i),e}function cw(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&_h.enqueueReplaceState(e,e.state,null)}function um(t,e,n,r){var s=t.stateNode;s.props=n,s.state=t.memoizedState,s.refs={},Vg(t);var i=e.contextType;typeof i=="object"&&i!==null?s.context=Yn(i):(i=Cn(e)?Vi:dn.current,s.context=ra(t,i)),s.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(cm(t,e,i,n),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&_h.enqueueReplaceState(s,s.state,null),Id(t,n,s,r),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function aa(t,e){try{var n="",r=e;do n+=LR(r),r=r.return;while(r);var s=n}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:s,digest:null}}function Zf(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function dm(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var uP=typeof WeakMap=="function"?WeakMap:Map;function Z0(t,e,n){n=Hr(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){Cd||(Cd=!0,Em=r),dm(t,e)},n}function ex(t,e,n){n=Hr(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var s=e.value;n.payload=function(){return r(s)},n.callback=function(){dm(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){dm(t,e),typeof r!="function"&&(Vs===null?Vs=new Set([this]):Vs.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function uw(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new uP;var s=new Set;r.set(e,s)}else s=r.get(e),s===void 0&&(s=new Set,r.set(e,s));s.has(n)||(s.add(n),t=xP.bind(null,t,e,n),e.then(t,t))}function dw(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function hw(t,e,n,r,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=Hr(-1,1),e.tag=2,Os(n,e,1))),n.lanes|=1),t)}var dP=rs.ReactCurrentOwner,xn=!1;function fn(t,e,n,r){e.child=t===null?R0(e,null,n,r):ia(e,t.child,n,r)}function fw(t,e,n,r,s){n=n.render;var i=e.ref;return Wo(e,s),r=$g(t,e,n,r,i,s),n=Bg(),t!==null&&!xn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,Yr(t,e,s)):(ut&&n&&Rg(e),e.flags|=1,fn(t,e,r,s),e.child)}function pw(t,e,n,r,s){if(t===null){var i=n.type;return typeof i=="function"&&!Jg(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=i,tx(t,e,i,r,s)):(t=Bu(n.type,null,r,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&s)){var o=i.memoizedProps;if(n=n.compare,n=n!==null?n:Gl,n(o,r)&&t.ref===e.ref)return Yr(t,e,s)}return e.flags|=1,t=Ms(i,r),t.ref=e.ref,t.return=e,e.child=t}function tx(t,e,n,r,s){if(t!==null){var i=t.memoizedProps;if(Gl(i,r)&&t.ref===e.ref)if(xn=!1,e.pendingProps=r=i,(t.lanes&s)!==0)t.flags&131072&&(xn=!0);else return e.lanes=t.lanes,Yr(t,e,s)}return hm(t,e,n,r,s)}function nx(t,e,n){var r=e.pendingProps,s=r.children,i=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},st(Uo,kn),kn|=n;else{if(!(n&1073741824))return t=i!==null?i.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,st(Uo,kn),kn|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,st(Uo,kn),kn|=r}else i!==null?(r=i.baseLanes|n,e.memoizedState=null):r=n,st(Uo,kn),kn|=r;return fn(t,e,s,n),e.child}function rx(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function hm(t,e,n,r,s){var i=Cn(n)?Vi:dn.current;return i=ra(e,i),Wo(e,s),n=$g(t,e,n,r,i,s),r=Bg(),t!==null&&!xn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,Yr(t,e,s)):(ut&&r&&Rg(e),e.flags|=1,fn(t,e,n,s),e.child)}function mw(t,e,n,r,s){if(Cn(n)){var i=!0;yd(e)}else i=!1;if(Wo(e,s),e.stateNode===null)Fu(t,e),J0(e,n,r),um(e,n,r,s),r=!0;else if(t===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var l=o.context,d=n.contextType;typeof d=="object"&&d!==null?d=Yn(d):(d=Cn(n)?Vi:dn.current,d=ra(e,d));var h=n.getDerivedStateFromProps,f=typeof h=="function"||typeof o.getSnapshotBeforeUpdate=="function";f||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==r||l!==d)&&cw(e,o,r,d),_s=!1;var m=e.memoizedState;o.state=m,Id(e,r,o,s),l=e.memoizedState,a!==r||m!==l||bn.current||_s?(typeof h=="function"&&(cm(e,n,h,r),l=e.memoizedState),(a=_s||lw(e,n,a,r,m,l,d))?(f||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=l),o.props=r,o.state=l,o.context=d,r=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,k0(t,e),a=e.memoizedProps,d=e.type===e.elementType?a:nr(e.type,a),o.props=d,f=e.pendingProps,m=o.context,l=n.contextType,typeof l=="object"&&l!==null?l=Yn(l):(l=Cn(n)?Vi:dn.current,l=ra(e,l));var v=n.getDerivedStateFromProps;(h=typeof v=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==f||m!==l)&&cw(e,o,r,l),_s=!1,m=e.memoizedState,o.state=m,Id(e,r,o,s);var R=e.memoizedState;a!==f||m!==R||bn.current||_s?(typeof v=="function"&&(cm(e,n,v,r),R=e.memoizedState),(d=_s||lw(e,n,d,r,m,R,l)||!1)?(h||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,R,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,R,l)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&m===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&m===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=R),o.props=r,o.state=R,o.context=l,r=d):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&m===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&m===t.memoizedState||(e.flags|=1024),r=!1)}return fm(t,e,n,r,i,s)}function fm(t,e,n,r,s,i){rx(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return s&&ew(e,n,!1),Yr(t,e,i);r=e.stateNode,dP.current=e;var a=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=ia(e,t.child,null,i),e.child=ia(e,null,a,i)):fn(t,e,a,i),e.memoizedState=r.state,s&&ew(e,n,!0),e.child}function sx(t){var e=t.stateNode;e.pendingContext?Zv(t,e.pendingContext,e.pendingContext!==e.context):e.context&&Zv(t,e.context,!1),Lg(t,e.containerInfo)}function gw(t,e,n,r,s){return sa(),kg(s),e.flags|=256,fn(t,e,n,r),e.child}var pm={dehydrated:null,treeContext:null,retryLane:0};function mm(t){return{baseLanes:t,cachePool:null,transitions:null}}function ix(t,e,n){var r=e.pendingProps,s=pt.current,i=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=t!==null&&t.memoizedState===null?!1:(s&2)!==0),a?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),st(pt,s&1),t===null)return am(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,i?(r=e.mode,i=e.child,o={mode:"hidden",children:o},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=Eh(o,r,0,null),t=Ri(t,r,n,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=mm(n),e.memoizedState=pm,t):Hg(e,o));if(s=t.memoizedState,s!==null&&(a=s.dehydrated,a!==null))return hP(t,e,o,r,a,s,n);if(i){i=r.fallback,o=e.mode,s=t.child,a=s.sibling;var l={mode:"hidden",children:r.children};return!(o&1)&&e.child!==s?(r=e.child,r.childLanes=0,r.pendingProps=l,e.deletions=null):(r=Ms(s,l),r.subtreeFlags=s.subtreeFlags&14680064),a!==null?i=Ms(a,i):(i=Ri(i,o,n,null),i.flags|=2),i.return=e,r.return=e,r.sibling=i,e.child=r,r=i,i=e.child,o=t.child.memoizedState,o=o===null?mm(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=t.childLanes&~n,e.memoizedState=pm,r}return i=t.child,t=i.sibling,r=Ms(i,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function Hg(t,e){return e=Eh({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function fu(t,e,n,r){return r!==null&&kg(r),ia(e,t.child,null,n),t=Hg(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function hP(t,e,n,r,s,i,o){if(n)return e.flags&256?(e.flags&=-257,r=Zf(Error(W(422))),fu(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=r.fallback,s=e.mode,r=Eh({mode:"visible",children:r.children},s,0,null),i=Ri(i,s,o,null),i.flags|=2,r.return=e,i.return=e,r.sibling=i,e.child=r,e.mode&1&&ia(e,t.child,null,o),e.child.memoizedState=mm(o),e.memoizedState=pm,i);if(!(e.mode&1))return fu(t,e,o,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var a=r.dgst;return r=a,i=Error(W(419)),r=Zf(i,r,void 0),fu(t,e,o,r)}if(a=(o&t.childLanes)!==0,xn||a){if(r=qt,r!==null){switch(o&-o){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|o)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,Qr(t,s),cr(r,t,s,-1))}return Xg(),r=Zf(Error(W(421))),fu(t,e,o,r)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=SP.bind(null,t),s._reactRetry=e,null):(t=i.treeContext,Dn=js(s.nextSibling),On=e,ut=!0,ir=null,t!==null&&(Bn[zn++]=Ur,Bn[zn++]=$r,Bn[zn++]=Li,Ur=t.id,$r=t.overflow,Li=e),e=Hg(e,r.children),e.flags|=4096,e)}function yw(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),lm(t.return,e,n)}function ep(t,e,n,r,s){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=s)}function ox(t,e,n){var r=e.pendingProps,s=r.revealOrder,i=r.tail;if(fn(t,e,r.children,n),r=pt.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&yw(t,n,e);else if(t.tag===19)yw(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(st(pt,r),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(n=e.child,s=null;n!==null;)t=n.alternate,t!==null&&Td(t)===null&&(s=n),n=n.sibling;n=s,n===null?(s=e.child,e.child=null):(s=n.sibling,n.sibling=null),ep(e,!1,s,n,i);break;case"backwards":for(n=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&Td(t)===null){e.child=s;break}t=s.sibling,s.sibling=n,n=s,s=t}ep(e,!0,n,null,i);break;case"together":ep(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Fu(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Yr(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),Fi|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(W(153));if(e.child!==null){for(t=e.child,n=Ms(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Ms(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function fP(t,e,n){switch(e.tag){case 3:sx(e),sa();break;case 5:N0(e);break;case 1:Cn(e.type)&&yd(e);break;case 4:Lg(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,s=e.memoizedProps.value;st(wd,r._currentValue),r._currentValue=s;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(st(pt,pt.current&1),e.flags|=128,null):n&e.child.childLanes?ix(t,e,n):(st(pt,pt.current&1),t=Yr(t,e,n),t!==null?t.sibling:null);st(pt,pt.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return ox(t,e,n);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),st(pt,pt.current),r)break;return null;case 22:case 23:return e.lanes=0,nx(t,e,n)}return Yr(t,e,n)}var ax,gm,lx,cx;ax=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};gm=function(){};lx=function(t,e,n,r){var s=t.memoizedProps;if(s!==r){t=e.stateNode,Si(Pr.current);var i=null;switch(n){case"input":s=Mp(t,s),r=Mp(t,r),i=[];break;case"select":s=yt({},s,{value:void 0}),r=yt({},r,{value:void 0}),i=[];break;case"textarea":s=$p(t,s),r=$p(t,r),i=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=md)}zp(n,r);var o;n=null;for(d in s)if(!r.hasOwnProperty(d)&&s.hasOwnProperty(d)&&s[d]!=null)if(d==="style"){var a=s[d];for(o in a)a.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&($l.hasOwnProperty(d)?i||(i=[]):(i=i||[]).push(d,null));for(d in r){var l=r[d];if(a=s!=null?s[d]:void 0,r.hasOwnProperty(d)&&l!==a&&(l!=null||a!=null))if(d==="style")if(a){for(o in a)!a.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in l)l.hasOwnProperty(o)&&a[o]!==l[o]&&(n||(n={}),n[o]=l[o])}else n||(i||(i=[]),i.push(d,n)),n=l;else d==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(i=i||[]).push(d,l)):d==="children"?typeof l!="string"&&typeof l!="number"||(i=i||[]).push(d,""+l):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&($l.hasOwnProperty(d)?(l!=null&&d==="onScroll"&&at("scroll",t),i||a===l||(i=[])):(i=i||[]).push(d,l))}n&&(i=i||[]).push("style",n);var d=i;(e.updateQueue=d)&&(e.flags|=4)}};cx=function(t,e,n,r){n!==r&&(e.flags|=4)};function Za(t,e){if(!ut)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function nn(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function pP(t,e,n){var r=e.pendingProps;switch(Pg(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return nn(e),null;case 1:return Cn(e.type)&&gd(),nn(e),null;case 3:return r=e.stateNode,oa(),lt(bn),lt(dn),Fg(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(du(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,ir!==null&&(xm(ir),ir=null))),gm(t,e),nn(e),null;case 5:Mg(e);var s=Si(Zl.current);if(n=e.type,t!==null&&e.stateNode!=null)lx(t,e,n,r,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(W(166));return nn(e),null}if(t=Si(Pr.current),du(e)){r=e.stateNode,n=e.type;var i=e.memoizedProps;switch(r[Sr]=e,r[Xl]=i,t=(e.mode&1)!==0,n){case"dialog":at("cancel",r),at("close",r);break;case"iframe":case"object":case"embed":at("load",r);break;case"video":case"audio":for(s=0;s<hl.length;s++)at(hl[s],r);break;case"source":at("error",r);break;case"img":case"image":case"link":at("error",r),at("load",r);break;case"details":at("toggle",r);break;case"input":bv(r,i),at("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},at("invalid",r);break;case"textarea":Av(r,i),at("invalid",r)}zp(n,i),s=null;for(var o in i)if(i.hasOwnProperty(o)){var a=i[o];o==="children"?typeof a=="string"?r.textContent!==a&&(i.suppressHydrationWarning!==!0&&uu(r.textContent,a,t),s=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(i.suppressHydrationWarning!==!0&&uu(r.textContent,a,t),s=["children",""+a]):$l.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&at("scroll",r)}switch(n){case"input":nu(r),Cv(r,i,!0);break;case"textarea":nu(r),Rv(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=md)}r=s,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=LT(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[Sr]=e,t[Xl]=r,ax(t,e,!1,!1),e.stateNode=t;e:{switch(o=qp(n,r),n){case"dialog":at("cancel",t),at("close",t),s=r;break;case"iframe":case"object":case"embed":at("load",t),s=r;break;case"video":case"audio":for(s=0;s<hl.length;s++)at(hl[s],t);s=r;break;case"source":at("error",t),s=r;break;case"img":case"image":case"link":at("error",t),at("load",t),s=r;break;case"details":at("toggle",t),s=r;break;case"input":bv(t,r),s=Mp(t,r),at("invalid",t);break;case"option":s=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},s=yt({},r,{value:void 0}),at("invalid",t);break;case"textarea":Av(t,r),s=$p(t,r),at("invalid",t);break;default:s=r}zp(n,s),a=s;for(i in a)if(a.hasOwnProperty(i)){var l=a[i];i==="style"?UT(t,l):i==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&MT(t,l)):i==="children"?typeof l=="string"?(n!=="textarea"||l!=="")&&Bl(t,l):typeof l=="number"&&Bl(t,""+l):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&($l.hasOwnProperty(i)?l!=null&&i==="onScroll"&&at("scroll",t):l!=null&&mg(t,i,l,o))}switch(n){case"input":nu(t),Cv(t,r,!1);break;case"textarea":nu(t),Rv(t);break;case"option":r.value!=null&&t.setAttribute("value",""+Hs(r.value));break;case"select":t.multiple=!!r.multiple,i=r.value,i!=null?Bo(t,!!r.multiple,i,!1):r.defaultValue!=null&&Bo(t,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=md)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return nn(e),null;case 6:if(t&&e.stateNode!=null)cx(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(W(166));if(n=Si(Zl.current),Si(Pr.current),du(e)){if(r=e.stateNode,n=e.memoizedProps,r[Sr]=e,(i=r.nodeValue!==n)&&(t=On,t!==null))switch(t.tag){case 3:uu(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&uu(r.nodeValue,n,(t.mode&1)!==0)}i&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Sr]=e,e.stateNode=r}return nn(e),null;case 13:if(lt(pt),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(ut&&Dn!==null&&e.mode&1&&!(e.flags&128))C0(),sa(),e.flags|=98560,i=!1;else if(i=du(e),r!==null&&r.dehydrated!==null){if(t===null){if(!i)throw Error(W(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(W(317));i[Sr]=e}else sa(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;nn(e),i=!1}else ir!==null&&(xm(ir),ir=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||pt.current&1?Ot===0&&(Ot=3):Xg())),e.updateQueue!==null&&(e.flags|=4),nn(e),null);case 4:return oa(),gm(t,e),t===null&&Ql(e.stateNode.containerInfo),nn(e),null;case 10:return jg(e.type._context),nn(e),null;case 17:return Cn(e.type)&&gd(),nn(e),null;case 19:if(lt(pt),i=e.memoizedState,i===null)return nn(e),null;if(r=(e.flags&128)!==0,o=i.rendering,o===null)if(r)Za(i,!1);else{if(Ot!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=Td(t),o!==null){for(e.flags|=128,Za(i,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)i=n,t=r,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,t=o.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return st(pt,pt.current&1|2),e.child}t=t.sibling}i.tail!==null&&bt()>la&&(e.flags|=128,r=!0,Za(i,!1),e.lanes=4194304)}else{if(!r)if(t=Td(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Za(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!ut)return nn(e),null}else 2*bt()-i.renderingStartTime>la&&n!==1073741824&&(e.flags|=128,r=!0,Za(i,!1),e.lanes=4194304);i.isBackwards?(o.sibling=e.child,e.child=o):(n=i.last,n!==null?n.sibling=o:e.child=o,i.last=o)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=bt(),e.sibling=null,n=pt.current,st(pt,r?n&1|2:n&1),e):(nn(e),null);case 22:case 23:return Yg(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?kn&1073741824&&(nn(e),e.subtreeFlags&6&&(e.flags|=8192)):nn(e),null;case 24:return null;case 25:return null}throw Error(W(156,e.tag))}function mP(t,e){switch(Pg(e),e.tag){case 1:return Cn(e.type)&&gd(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return oa(),lt(bn),lt(dn),Fg(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return Mg(e),null;case 13:if(lt(pt),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(W(340));sa()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return lt(pt),null;case 4:return oa(),null;case 10:return jg(e.type._context),null;case 22:case 23:return Yg(),null;case 24:return null;default:return null}}var pu=!1,on=!1,gP=typeof WeakSet=="function"?WeakSet:Set,oe=null;function Fo(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){wt(t,e,r)}else n.current=null}function ym(t,e,n){try{n()}catch(r){wt(t,e,r)}}var _w=!1;function yP(t,e){if(em=hd,t=p0(),Ag(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var o=0,a=-1,l=-1,d=0,h=0,f=t,m=null;t:for(;;){for(var v;f!==n||s!==0&&f.nodeType!==3||(a=o+s),f!==i||r!==0&&f.nodeType!==3||(l=o+r),f.nodeType===3&&(o+=f.nodeValue.length),(v=f.firstChild)!==null;)m=f,f=v;for(;;){if(f===t)break t;if(m===n&&++d===s&&(a=o),m===i&&++h===r&&(l=o),(v=f.nextSibling)!==null)break;f=m,m=f.parentNode}f=v}n=a===-1||l===-1?null:{start:a,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(tm={focusedElem:t,selectionRange:n},hd=!1,oe=e;oe!==null;)if(e=oe,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,oe=t;else for(;oe!==null;){e=oe;try{var R=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(R!==null){var b=R.memoizedProps,A=R.memoizedState,I=e.stateNode,w=I.getSnapshotBeforeUpdate(e.elementType===e.type?b:nr(e.type,b),A);I.__reactInternalSnapshotBeforeUpdate=w}break;case 3:var y=e.stateNode.containerInfo;y.nodeType===1?y.textContent="":y.nodeType===9&&y.documentElement&&y.removeChild(y.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(W(163))}}catch(j){wt(e,e.return,j)}if(t=e.sibling,t!==null){t.return=e.return,oe=t;break}oe=e.return}return R=_w,_w=!1,R}function Al(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&t)===t){var i=s.destroy;s.destroy=void 0,i!==void 0&&ym(e,n,i)}s=s.next}while(s!==r)}}function vh(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function _m(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function ux(t){var e=t.alternate;e!==null&&(t.alternate=null,ux(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Sr],delete e[Xl],delete e[sm],delete e[Z1],delete e[eP])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function dx(t){return t.tag===5||t.tag===3||t.tag===4}function vw(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||dx(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function vm(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=md));else if(r!==4&&(t=t.child,t!==null))for(vm(t,e,n),t=t.sibling;t!==null;)vm(t,e,n),t=t.sibling}function wm(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(wm(t,e,n),t=t.sibling;t!==null;)wm(t,e,n),t=t.sibling}var Ht=null,rr=!1;function hs(t,e,n){for(n=n.child;n!==null;)hx(t,e,n),n=n.sibling}function hx(t,e,n){if(Rr&&typeof Rr.onCommitFiberUnmount=="function")try{Rr.onCommitFiberUnmount(dh,n)}catch{}switch(n.tag){case 5:on||Fo(n,e);case 6:var r=Ht,s=rr;Ht=null,hs(t,e,n),Ht=r,rr=s,Ht!==null&&(rr?(t=Ht,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Ht.removeChild(n.stateNode));break;case 18:Ht!==null&&(rr?(t=Ht,n=n.stateNode,t.nodeType===8?Kf(t.parentNode,n):t.nodeType===1&&Kf(t,n),Wl(t)):Kf(Ht,n.stateNode));break;case 4:r=Ht,s=rr,Ht=n.stateNode.containerInfo,rr=!0,hs(t,e,n),Ht=r,rr=s;break;case 0:case 11:case 14:case 15:if(!on&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var i=s,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&ym(n,e,o),s=s.next}while(s!==r)}hs(t,e,n);break;case 1:if(!on&&(Fo(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(a){wt(n,e,a)}hs(t,e,n);break;case 21:hs(t,e,n);break;case 22:n.mode&1?(on=(r=on)||n.memoizedState!==null,hs(t,e,n),on=r):hs(t,e,n);break;default:hs(t,e,n)}}function ww(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new gP),e.forEach(function(r){var s=bP.bind(null,t,r);n.has(r)||(n.add(r),r.then(s,s))})}}function tr(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var i=t,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:Ht=a.stateNode,rr=!1;break e;case 3:Ht=a.stateNode.containerInfo,rr=!0;break e;case 4:Ht=a.stateNode.containerInfo,rr=!0;break e}a=a.return}if(Ht===null)throw Error(W(160));hx(i,o,s),Ht=null,rr=!1;var l=s.alternate;l!==null&&(l.return=null),s.return=null}catch(d){wt(s,e,d)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)fx(e,t),e=e.sibling}function fx(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(tr(e,t),wr(t),r&4){try{Al(3,t,t.return),vh(3,t)}catch(b){wt(t,t.return,b)}try{Al(5,t,t.return)}catch(b){wt(t,t.return,b)}}break;case 1:tr(e,t),wr(t),r&512&&n!==null&&Fo(n,n.return);break;case 5:if(tr(e,t),wr(t),r&512&&n!==null&&Fo(n,n.return),t.flags&32){var s=t.stateNode;try{Bl(s,"")}catch(b){wt(t,t.return,b)}}if(r&4&&(s=t.stateNode,s!=null)){var i=t.memoizedProps,o=n!==null?n.memoizedProps:i,a=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{a==="input"&&i.type==="radio"&&i.name!=null&&OT(s,i),qp(a,o);var d=qp(a,i);for(o=0;o<l.length;o+=2){var h=l[o],f=l[o+1];h==="style"?UT(s,f):h==="dangerouslySetInnerHTML"?MT(s,f):h==="children"?Bl(s,f):mg(s,h,f,d)}switch(a){case"input":Fp(s,i);break;case"textarea":VT(s,i);break;case"select":var m=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var v=i.value;v!=null?Bo(s,!!i.multiple,v,!1):m!==!!i.multiple&&(i.defaultValue!=null?Bo(s,!!i.multiple,i.defaultValue,!0):Bo(s,!!i.multiple,i.multiple?[]:"",!1))}s[Xl]=i}catch(b){wt(t,t.return,b)}}break;case 6:if(tr(e,t),wr(t),r&4){if(t.stateNode===null)throw Error(W(162));s=t.stateNode,i=t.memoizedProps;try{s.nodeValue=i}catch(b){wt(t,t.return,b)}}break;case 3:if(tr(e,t),wr(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Wl(e.containerInfo)}catch(b){wt(t,t.return,b)}break;case 4:tr(e,t),wr(t);break;case 13:tr(e,t),wr(t),s=t.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(Gg=bt())),r&4&&ww(t);break;case 22:if(h=n!==null&&n.memoizedState!==null,t.mode&1?(on=(d=on)||h,tr(e,t),on=d):tr(e,t),wr(t),r&8192){if(d=t.memoizedState!==null,(t.stateNode.isHidden=d)&&!h&&t.mode&1)for(oe=t,h=t.child;h!==null;){for(f=oe=h;oe!==null;){switch(m=oe,v=m.child,m.tag){case 0:case 11:case 14:case 15:Al(4,m,m.return);break;case 1:Fo(m,m.return);var R=m.stateNode;if(typeof R.componentWillUnmount=="function"){r=m,n=m.return;try{e=r,R.props=e.memoizedProps,R.state=e.memoizedState,R.componentWillUnmount()}catch(b){wt(r,n,b)}}break;case 5:Fo(m,m.return);break;case 22:if(m.memoizedState!==null){Iw(f);continue}}v!==null?(v.return=m,oe=v):Iw(f)}h=h.sibling}e:for(h=null,f=t;;){if(f.tag===5){if(h===null){h=f;try{s=f.stateNode,d?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(a=f.stateNode,l=f.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=FT("display",o))}catch(b){wt(t,t.return,b)}}}else if(f.tag===6){if(h===null)try{f.stateNode.nodeValue=d?"":f.memoizedProps}catch(b){wt(t,t.return,b)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===t)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===t)break e;for(;f.sibling===null;){if(f.return===null||f.return===t)break e;h===f&&(h=null),f=f.return}h===f&&(h=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:tr(e,t),wr(t),r&4&&ww(t);break;case 21:break;default:tr(e,t),wr(t)}}function wr(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(dx(n)){var r=n;break e}n=n.return}throw Error(W(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(Bl(s,""),r.flags&=-33);var i=vw(t);wm(t,i,s);break;case 3:case 4:var o=r.stateNode.containerInfo,a=vw(t);vm(t,a,o);break;default:throw Error(W(161))}}catch(l){wt(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function _P(t,e,n){oe=t,px(t)}function px(t,e,n){for(var r=(t.mode&1)!==0;oe!==null;){var s=oe,i=s.child;if(s.tag===22&&r){var o=s.memoizedState!==null||pu;if(!o){var a=s.alternate,l=a!==null&&a.memoizedState!==null||on;a=pu;var d=on;if(pu=o,(on=l)&&!d)for(oe=s;oe!==null;)o=oe,l=o.child,o.tag===22&&o.memoizedState!==null?Tw(s):l!==null?(l.return=o,oe=l):Tw(s);for(;i!==null;)oe=i,px(i),i=i.sibling;oe=s,pu=a,on=d}Ew(t)}else s.subtreeFlags&8772&&i!==null?(i.return=s,oe=i):Ew(t)}}function Ew(t){for(;oe!==null;){var e=oe;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:on||vh(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!on)if(n===null)r.componentDidMount();else{var s=e.elementType===e.type?n.memoizedProps:nr(e.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&iw(e,i,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}iw(e,o,n)}break;case 5:var a=e.stateNode;if(n===null&&e.flags&4){n=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var d=e.alternate;if(d!==null){var h=d.memoizedState;if(h!==null){var f=h.dehydrated;f!==null&&Wl(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(W(163))}on||e.flags&512&&_m(e)}catch(m){wt(e,e.return,m)}}if(e===t){oe=null;break}if(n=e.sibling,n!==null){n.return=e.return,oe=n;break}oe=e.return}}function Iw(t){for(;oe!==null;){var e=oe;if(e===t){oe=null;break}var n=e.sibling;if(n!==null){n.return=e.return,oe=n;break}oe=e.return}}function Tw(t){for(;oe!==null;){var e=oe;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{vh(4,e)}catch(l){wt(e,n,l)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var s=e.return;try{r.componentDidMount()}catch(l){wt(e,s,l)}}var i=e.return;try{_m(e)}catch(l){wt(e,i,l)}break;case 5:var o=e.return;try{_m(e)}catch(l){wt(e,o,l)}}}catch(l){wt(e,e.return,l)}if(e===t){oe=null;break}var a=e.sibling;if(a!==null){a.return=e.return,oe=a;break}oe=e.return}}var vP=Math.ceil,bd=rs.ReactCurrentDispatcher,Wg=rs.ReactCurrentOwner,Gn=rs.ReactCurrentBatchConfig,qe=0,qt=null,Pt=null,Xt=0,kn=0,Uo=Zs(0),Ot=0,rc=null,Fi=0,wh=0,Kg=0,Rl=null,Tn=null,Gg=0,la=1/0,Mr=null,Cd=!1,Em=null,Vs=null,mu=!1,Rs=null,Ad=0,Pl=0,Im=null,Uu=-1,$u=0;function gn(){return qe&6?bt():Uu!==-1?Uu:Uu=bt()}function Ls(t){return t.mode&1?qe&2&&Xt!==0?Xt&-Xt:nP.transition!==null?($u===0&&($u=JT()),$u):(t=et,t!==0||(t=window.event,t=t===void 0?16:i0(t.type)),t):1}function cr(t,e,n,r){if(50<Pl)throw Pl=0,Im=null,Error(W(185));wc(t,n,r),(!(qe&2)||t!==qt)&&(t===qt&&(!(qe&2)&&(wh|=n),Ot===4&&ws(t,Xt)),An(t,r),n===1&&qe===0&&!(e.mode&1)&&(la=bt()+500,gh&&ei()))}function An(t,e){var n=t.callbackNode;n1(t,e);var r=dd(t,t===qt?Xt:0);if(r===0)n!==null&&Nv(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&Nv(n),e===1)t.tag===0?tP(xw.bind(null,t)):x0(xw.bind(null,t)),X1(function(){!(qe&6)&&ei()}),n=null;else{switch(ZT(r)){case 1:n=wg;break;case 4:n=YT;break;case 16:n=ud;break;case 536870912:n=XT;break;default:n=ud}n=Ix(n,mx.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function mx(t,e){if(Uu=-1,$u=0,qe&6)throw Error(W(327));var n=t.callbackNode;if(Ko()&&t.callbackNode!==n)return null;var r=dd(t,t===qt?Xt:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=Rd(t,r);else{e=r;var s=qe;qe|=2;var i=yx();(qt!==t||Xt!==e)&&(Mr=null,la=bt()+500,Ai(t,e));do try{IP();break}catch(a){gx(t,a)}while(!0);Dg(),bd.current=i,qe=s,Pt!==null?e=0:(qt=null,Xt=0,e=Ot)}if(e!==0){if(e===2&&(s=Qp(t),s!==0&&(r=s,e=Tm(t,s))),e===1)throw n=rc,Ai(t,0),ws(t,r),An(t,bt()),n;if(e===6)ws(t,r);else{if(s=t.current.alternate,!(r&30)&&!wP(s)&&(e=Rd(t,r),e===2&&(i=Qp(t),i!==0&&(r=i,e=Tm(t,i))),e===1))throw n=rc,Ai(t,0),ws(t,r),An(t,bt()),n;switch(t.finishedWork=s,t.finishedLanes=r,e){case 0:case 1:throw Error(W(345));case 2:pi(t,Tn,Mr);break;case 3:if(ws(t,r),(r&130023424)===r&&(e=Gg+500-bt(),10<e)){if(dd(t,0)!==0)break;if(s=t.suspendedLanes,(s&r)!==r){gn(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=rm(pi.bind(null,t,Tn,Mr),e);break}pi(t,Tn,Mr);break;case 4:if(ws(t,r),(r&4194240)===r)break;for(e=t.eventTimes,s=-1;0<r;){var o=31-lr(r);i=1<<o,o=e[o],o>s&&(s=o),r&=~i}if(r=s,r=bt()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*vP(r/1960))-r,10<r){t.timeoutHandle=rm(pi.bind(null,t,Tn,Mr),r);break}pi(t,Tn,Mr);break;case 5:pi(t,Tn,Mr);break;default:throw Error(W(329))}}}return An(t,bt()),t.callbackNode===n?mx.bind(null,t):null}function Tm(t,e){var n=Rl;return t.current.memoizedState.isDehydrated&&(Ai(t,e).flags|=256),t=Rd(t,e),t!==2&&(e=Tn,Tn=n,e!==null&&xm(e)),t}function xm(t){Tn===null?Tn=t:Tn.push.apply(Tn,t)}function wP(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],i=s.getSnapshot;s=s.value;try{if(!dr(i(),s))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function ws(t,e){for(e&=~Kg,e&=~wh,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-lr(e),r=1<<n;t[n]=-1,e&=~r}}function xw(t){if(qe&6)throw Error(W(327));Ko();var e=dd(t,0);if(!(e&1))return An(t,bt()),null;var n=Rd(t,e);if(t.tag!==0&&n===2){var r=Qp(t);r!==0&&(e=r,n=Tm(t,r))}if(n===1)throw n=rc,Ai(t,0),ws(t,e),An(t,bt()),n;if(n===6)throw Error(W(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,pi(t,Tn,Mr),An(t,bt()),null}function Qg(t,e){var n=qe;qe|=1;try{return t(e)}finally{qe=n,qe===0&&(la=bt()+500,gh&&ei())}}function Ui(t){Rs!==null&&Rs.tag===0&&!(qe&6)&&Ko();var e=qe;qe|=1;var n=Gn.transition,r=et;try{if(Gn.transition=null,et=1,t)return t()}finally{et=r,Gn.transition=n,qe=e,!(qe&6)&&ei()}}function Yg(){kn=Uo.current,lt(Uo)}function Ai(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,Y1(n)),Pt!==null)for(n=Pt.return;n!==null;){var r=n;switch(Pg(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&gd();break;case 3:oa(),lt(bn),lt(dn),Fg();break;case 5:Mg(r);break;case 4:oa();break;case 13:lt(pt);break;case 19:lt(pt);break;case 10:jg(r.type._context);break;case 22:case 23:Yg()}n=n.return}if(qt=t,Pt=t=Ms(t.current,null),Xt=kn=e,Ot=0,rc=null,Kg=wh=Fi=0,Tn=Rl=null,xi!==null){for(e=0;e<xi.length;e++)if(n=xi[e],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,i=n.pending;if(i!==null){var o=i.next;i.next=s,r.next=o}n.pending=r}xi=null}return t}function gx(t,e){do{var n=Pt;try{if(Dg(),Lu.current=Sd,xd){for(var r=gt.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}xd=!1}if(Mi=0,zt=jt=gt=null,Cl=!1,ec=0,Wg.current=null,n===null||n.return===null){Ot=1,rc=e,Pt=null;break}e:{var i=t,o=n.return,a=n,l=e;if(e=Xt,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var d=l,h=a,f=h.tag;if(!(h.mode&1)&&(f===0||f===11||f===15)){var m=h.alternate;m?(h.updateQueue=m.updateQueue,h.memoizedState=m.memoizedState,h.lanes=m.lanes):(h.updateQueue=null,h.memoizedState=null)}var v=dw(o);if(v!==null){v.flags&=-257,hw(v,o,a,i,e),v.mode&1&&uw(i,d,e),e=v,l=d;var R=e.updateQueue;if(R===null){var b=new Set;b.add(l),e.updateQueue=b}else R.add(l);break e}else{if(!(e&1)){uw(i,d,e),Xg();break e}l=Error(W(426))}}else if(ut&&a.mode&1){var A=dw(o);if(A!==null){!(A.flags&65536)&&(A.flags|=256),hw(A,o,a,i,e),kg(aa(l,a));break e}}i=l=aa(l,a),Ot!==4&&(Ot=2),Rl===null?Rl=[i]:Rl.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var I=Z0(i,l,e);sw(i,I);break e;case 1:a=l;var w=i.type,y=i.stateNode;if(!(i.flags&128)&&(typeof w.getDerivedStateFromError=="function"||y!==null&&typeof y.componentDidCatch=="function"&&(Vs===null||!Vs.has(y)))){i.flags|=65536,e&=-e,i.lanes|=e;var j=ex(i,a,e);sw(i,j);break e}}i=i.return}while(i!==null)}vx(n)}catch(V){e=V,Pt===n&&n!==null&&(Pt=n=n.return);continue}break}while(!0)}function yx(){var t=bd.current;return bd.current=Sd,t===null?Sd:t}function Xg(){(Ot===0||Ot===3||Ot===2)&&(Ot=4),qt===null||!(Fi&268435455)&&!(wh&268435455)||ws(qt,Xt)}function Rd(t,e){var n=qe;qe|=2;var r=yx();(qt!==t||Xt!==e)&&(Mr=null,Ai(t,e));do try{EP();break}catch(s){gx(t,s)}while(!0);if(Dg(),qe=n,bd.current=r,Pt!==null)throw Error(W(261));return qt=null,Xt=0,Ot}function EP(){for(;Pt!==null;)_x(Pt)}function IP(){for(;Pt!==null&&!KR();)_x(Pt)}function _x(t){var e=Ex(t.alternate,t,kn);t.memoizedProps=t.pendingProps,e===null?vx(t):Pt=e,Wg.current=null}function vx(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=mP(n,e),n!==null){n.flags&=32767,Pt=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Ot=6,Pt=null;return}}else if(n=pP(n,e,kn),n!==null){Pt=n;return}if(e=e.sibling,e!==null){Pt=e;return}Pt=e=t}while(e!==null);Ot===0&&(Ot=5)}function pi(t,e,n){var r=et,s=Gn.transition;try{Gn.transition=null,et=1,TP(t,e,n,r)}finally{Gn.transition=s,et=r}return null}function TP(t,e,n,r){do Ko();while(Rs!==null);if(qe&6)throw Error(W(327));n=t.finishedWork;var s=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(W(177));t.callbackNode=null,t.callbackPriority=0;var i=n.lanes|n.childLanes;if(r1(t,i),t===qt&&(Pt=qt=null,Xt=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||mu||(mu=!0,Ix(ud,function(){return Ko(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=Gn.transition,Gn.transition=null;var o=et;et=1;var a=qe;qe|=4,Wg.current=null,yP(t,n),fx(n,t),z1(tm),hd=!!em,tm=em=null,t.current=n,_P(n),GR(),qe=a,et=o,Gn.transition=i}else t.current=n;if(mu&&(mu=!1,Rs=t,Ad=s),i=t.pendingLanes,i===0&&(Vs=null),XR(n.stateNode),An(t,bt()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)s=e[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(Cd)throw Cd=!1,t=Em,Em=null,t;return Ad&1&&t.tag!==0&&Ko(),i=t.pendingLanes,i&1?t===Im?Pl++:(Pl=0,Im=t):Pl=0,ei(),null}function Ko(){if(Rs!==null){var t=ZT(Ad),e=Gn.transition,n=et;try{if(Gn.transition=null,et=16>t?16:t,Rs===null)var r=!1;else{if(t=Rs,Rs=null,Ad=0,qe&6)throw Error(W(331));var s=qe;for(qe|=4,oe=t.current;oe!==null;){var i=oe,o=i.child;if(oe.flags&16){var a=i.deletions;if(a!==null){for(var l=0;l<a.length;l++){var d=a[l];for(oe=d;oe!==null;){var h=oe;switch(h.tag){case 0:case 11:case 15:Al(8,h,i)}var f=h.child;if(f!==null)f.return=h,oe=f;else for(;oe!==null;){h=oe;var m=h.sibling,v=h.return;if(ux(h),h===d){oe=null;break}if(m!==null){m.return=v,oe=m;break}oe=v}}}var R=i.alternate;if(R!==null){var b=R.child;if(b!==null){R.child=null;do{var A=b.sibling;b.sibling=null,b=A}while(b!==null)}}oe=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,oe=o;else e:for(;oe!==null;){if(i=oe,i.flags&2048)switch(i.tag){case 0:case 11:case 15:Al(9,i,i.return)}var I=i.sibling;if(I!==null){I.return=i.return,oe=I;break e}oe=i.return}}var w=t.current;for(oe=w;oe!==null;){o=oe;var y=o.child;if(o.subtreeFlags&2064&&y!==null)y.return=o,oe=y;else e:for(o=w;oe!==null;){if(a=oe,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:vh(9,a)}}catch(V){wt(a,a.return,V)}if(a===o){oe=null;break e}var j=a.sibling;if(j!==null){j.return=a.return,oe=j;break e}oe=a.return}}if(qe=s,ei(),Rr&&typeof Rr.onPostCommitFiberRoot=="function")try{Rr.onPostCommitFiberRoot(dh,t)}catch{}r=!0}return r}finally{et=n,Gn.transition=e}}return!1}function Sw(t,e,n){e=aa(n,e),e=Z0(t,e,1),t=Os(t,e,1),e=gn(),t!==null&&(wc(t,1,e),An(t,e))}function wt(t,e,n){if(t.tag===3)Sw(t,t,n);else for(;e!==null;){if(e.tag===3){Sw(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Vs===null||!Vs.has(r))){t=aa(n,t),t=ex(e,t,1),e=Os(e,t,1),t=gn(),e!==null&&(wc(e,1,t),An(e,t));break}}e=e.return}}function xP(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=gn(),t.pingedLanes|=t.suspendedLanes&n,qt===t&&(Xt&n)===n&&(Ot===4||Ot===3&&(Xt&130023424)===Xt&&500>bt()-Gg?Ai(t,0):Kg|=n),An(t,e)}function wx(t,e){e===0&&(t.mode&1?(e=iu,iu<<=1,!(iu&130023424)&&(iu=4194304)):e=1);var n=gn();t=Qr(t,e),t!==null&&(wc(t,e,n),An(t,n))}function SP(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),wx(t,n)}function bP(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,s=t.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(W(314))}r!==null&&r.delete(e),wx(t,n)}var Ex;Ex=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||bn.current)xn=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return xn=!1,fP(t,e,n);xn=!!(t.flags&131072)}else xn=!1,ut&&e.flags&1048576&&S0(e,vd,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;Fu(t,e),t=e.pendingProps;var s=ra(e,dn.current);Wo(e,n),s=$g(null,e,r,t,s,n);var i=Bg();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Cn(r)?(i=!0,yd(e)):i=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,Vg(e),s.updater=_h,e.stateNode=s,s._reactInternals=e,um(e,r,t,n),e=fm(null,e,r,!0,i,n)):(e.tag=0,ut&&i&&Rg(e),fn(null,e,s,n),e=e.child),e;case 16:r=e.elementType;e:{switch(Fu(t,e),t=e.pendingProps,s=r._init,r=s(r._payload),e.type=r,s=e.tag=AP(r),t=nr(r,t),s){case 0:e=hm(null,e,r,t,n);break e;case 1:e=mw(null,e,r,t,n);break e;case 11:e=fw(null,e,r,t,n);break e;case 14:e=pw(null,e,r,nr(r.type,t),n);break e}throw Error(W(306,r,""))}return e;case 0:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:nr(r,s),hm(t,e,r,s,n);case 1:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:nr(r,s),mw(t,e,r,s,n);case 3:e:{if(sx(e),t===null)throw Error(W(387));r=e.pendingProps,i=e.memoizedState,s=i.element,k0(t,e),Id(e,r,null,n);var o=e.memoizedState;if(r=o.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){s=aa(Error(W(423)),e),e=gw(t,e,r,n,s);break e}else if(r!==s){s=aa(Error(W(424)),e),e=gw(t,e,r,n,s);break e}else for(Dn=js(e.stateNode.containerInfo.firstChild),On=e,ut=!0,ir=null,n=R0(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(sa(),r===s){e=Yr(t,e,n);break e}fn(t,e,r,n)}e=e.child}return e;case 5:return N0(e),t===null&&am(e),r=e.type,s=e.pendingProps,i=t!==null?t.memoizedProps:null,o=s.children,nm(r,s)?o=null:i!==null&&nm(r,i)&&(e.flags|=32),rx(t,e),fn(t,e,o,n),e.child;case 6:return t===null&&am(e),null;case 13:return ix(t,e,n);case 4:return Lg(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=ia(e,null,r,n):fn(t,e,r,n),e.child;case 11:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:nr(r,s),fw(t,e,r,s,n);case 7:return fn(t,e,e.pendingProps,n),e.child;case 8:return fn(t,e,e.pendingProps.children,n),e.child;case 12:return fn(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,s=e.pendingProps,i=e.memoizedProps,o=s.value,st(wd,r._currentValue),r._currentValue=o,i!==null)if(dr(i.value,o)){if(i.children===s.children&&!bn.current){e=Yr(t,e,n);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var a=i.dependencies;if(a!==null){o=i.child;for(var l=a.firstContext;l!==null;){if(l.context===r){if(i.tag===1){l=Hr(-1,n&-n),l.tag=2;var d=i.updateQueue;if(d!==null){d=d.shared;var h=d.pending;h===null?l.next=l:(l.next=h.next,h.next=l),d.pending=l}}i.lanes|=n,l=i.alternate,l!==null&&(l.lanes|=n),lm(i.return,n,e),a.lanes|=n;break}l=l.next}}else if(i.tag===10)o=i.type===e.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(W(341));o.lanes|=n,a=o.alternate,a!==null&&(a.lanes|=n),lm(o,n,e),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===e){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}fn(t,e,s.children,n),e=e.child}return e;case 9:return s=e.type,r=e.pendingProps.children,Wo(e,n),s=Yn(s),r=r(s),e.flags|=1,fn(t,e,r,n),e.child;case 14:return r=e.type,s=nr(r,e.pendingProps),s=nr(r.type,s),pw(t,e,r,s,n);case 15:return tx(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:nr(r,s),Fu(t,e),e.tag=1,Cn(r)?(t=!0,yd(e)):t=!1,Wo(e,n),J0(e,r,s),um(e,r,s,n),fm(null,e,r,!0,t,n);case 19:return ox(t,e,n);case 22:return nx(t,e,n)}throw Error(W(156,e.tag))};function Ix(t,e){return QT(t,e)}function CP(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Wn(t,e,n,r){return new CP(t,e,n,r)}function Jg(t){return t=t.prototype,!(!t||!t.isReactComponent)}function AP(t){if(typeof t=="function")return Jg(t)?1:0;if(t!=null){if(t=t.$$typeof,t===yg)return 11;if(t===_g)return 14}return 2}function Ms(t,e){var n=t.alternate;return n===null?(n=Wn(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Bu(t,e,n,r,s,i){var o=2;if(r=t,typeof t=="function")Jg(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case Po:return Ri(n.children,s,i,e);case gg:o=8,s|=8;break;case jp:return t=Wn(12,n,e,s|2),t.elementType=jp,t.lanes=i,t;case Op:return t=Wn(13,n,e,s),t.elementType=Op,t.lanes=i,t;case Vp:return t=Wn(19,n,e,s),t.elementType=Vp,t.lanes=i,t;case NT:return Eh(n,s,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case PT:o=10;break e;case kT:o=9;break e;case yg:o=11;break e;case _g:o=14;break e;case ys:o=16,r=null;break e}throw Error(W(130,t==null?t:typeof t,""))}return e=Wn(o,n,e,s),e.elementType=t,e.type=r,e.lanes=i,e}function Ri(t,e,n,r){return t=Wn(7,t,r,e),t.lanes=n,t}function Eh(t,e,n,r){return t=Wn(22,t,r,e),t.elementType=NT,t.lanes=n,t.stateNode={isHidden:!1},t}function tp(t,e,n){return t=Wn(6,t,null,e),t.lanes=n,t}function np(t,e,n){return e=Wn(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function RP(t,e,n,r,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Vf(0),this.expirationTimes=Vf(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Vf(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function Zg(t,e,n,r,s,i,o,a,l){return t=new RP(t,e,n,a,l),e===1?(e=1,i===!0&&(e|=8)):e=0,i=Wn(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Vg(i),t}function PP(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Ro,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function Tx(t){if(!t)return Ws;t=t._reactInternals;e:{if(no(t)!==t||t.tag!==1)throw Error(W(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Cn(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(W(171))}if(t.tag===1){var n=t.type;if(Cn(n))return T0(t,n,e)}return e}function xx(t,e,n,r,s,i,o,a,l){return t=Zg(n,r,!0,t,s,i,o,a,l),t.context=Tx(null),n=t.current,r=gn(),s=Ls(n),i=Hr(r,s),i.callback=e??null,Os(n,i,s),t.current.lanes=s,wc(t,s,r),An(t,r),t}function Ih(t,e,n,r){var s=e.current,i=gn(),o=Ls(s);return n=Tx(n),e.context===null?e.context=n:e.pendingContext=n,e=Hr(i,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=Os(s,e,o),t!==null&&(cr(t,s,o,i),Vu(t,s,o)),o}function Pd(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function bw(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function ey(t,e){bw(t,e),(t=t.alternate)&&bw(t,e)}function kP(){return null}var Sx=typeof reportError=="function"?reportError:function(t){console.error(t)};function ty(t){this._internalRoot=t}Th.prototype.render=ty.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(W(409));Ih(t,e,null,null)};Th.prototype.unmount=ty.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Ui(function(){Ih(null,t,null,null)}),e[Gr]=null}};function Th(t){this._internalRoot=t}Th.prototype.unstable_scheduleHydration=function(t){if(t){var e=n0();t={blockedOn:null,target:t,priority:e};for(var n=0;n<vs.length&&e!==0&&e<vs[n].priority;n++);vs.splice(n,0,t),n===0&&s0(t)}};function ny(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function xh(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function Cw(){}function NP(t,e,n,r,s){if(s){if(typeof r=="function"){var i=r;r=function(){var d=Pd(o);i.call(d)}}var o=xx(e,r,t,0,null,!1,!1,"",Cw);return t._reactRootContainer=o,t[Gr]=o.current,Ql(t.nodeType===8?t.parentNode:t),Ui(),o}for(;s=t.lastChild;)t.removeChild(s);if(typeof r=="function"){var a=r;r=function(){var d=Pd(l);a.call(d)}}var l=Zg(t,0,!1,null,null,!1,!1,"",Cw);return t._reactRootContainer=l,t[Gr]=l.current,Ql(t.nodeType===8?t.parentNode:t),Ui(function(){Ih(e,l,n,r)}),l}function Sh(t,e,n,r,s){var i=n._reactRootContainer;if(i){var o=i;if(typeof s=="function"){var a=s;s=function(){var l=Pd(o);a.call(l)}}Ih(e,o,t,s)}else o=NP(n,e,t,s,r);return Pd(o)}e0=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=dl(e.pendingLanes);n!==0&&(Eg(e,n|1),An(e,bt()),!(qe&6)&&(la=bt()+500,ei()))}break;case 13:Ui(function(){var r=Qr(t,1);if(r!==null){var s=gn();cr(r,t,1,s)}}),ey(t,1)}};Ig=function(t){if(t.tag===13){var e=Qr(t,134217728);if(e!==null){var n=gn();cr(e,t,134217728,n)}ey(t,134217728)}};t0=function(t){if(t.tag===13){var e=Ls(t),n=Qr(t,e);if(n!==null){var r=gn();cr(n,t,e,r)}ey(t,e)}};n0=function(){return et};r0=function(t,e){var n=et;try{return et=t,e()}finally{et=n}};Wp=function(t,e,n){switch(e){case"input":if(Fp(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var s=mh(r);if(!s)throw Error(W(90));jT(r),Fp(r,s)}}}break;case"textarea":VT(t,n);break;case"select":e=n.value,e!=null&&Bo(t,!!n.multiple,e,!1)}};zT=Qg;qT=Ui;var DP={usingClientEntryPoint:!1,Events:[Ic,jo,mh,$T,BT,Qg]},el={findFiberByHostInstance:Ti,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},jP={bundleType:el.bundleType,version:el.version,rendererPackageName:el.rendererPackageName,rendererConfig:el.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:rs.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=KT(t),t===null?null:t.stateNode},findFiberByHostInstance:el.findFiberByHostInstance||kP,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var gu=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!gu.isDisabled&&gu.supportsFiber)try{dh=gu.inject(jP),Rr=gu}catch{}}Fn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=DP;Fn.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!ny(e))throw Error(W(200));return PP(t,e,null,n)};Fn.createRoot=function(t,e){if(!ny(t))throw Error(W(299));var n=!1,r="",s=Sx;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=Zg(t,1,!1,null,null,n,!1,r,s),t[Gr]=e.current,Ql(t.nodeType===8?t.parentNode:t),new ty(e)};Fn.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(W(188)):(t=Object.keys(t).join(","),Error(W(268,t)));return t=KT(e),t=t===null?null:t.stateNode,t};Fn.flushSync=function(t){return Ui(t)};Fn.hydrate=function(t,e,n){if(!xh(e))throw Error(W(200));return Sh(null,t,e,!0,n)};Fn.hydrateRoot=function(t,e,n){if(!ny(t))throw Error(W(405));var r=n!=null&&n.hydratedSources||null,s=!1,i="",o=Sx;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=xx(e,null,t,1,n??null,s,!1,i,o),t[Gr]=e.current,Ql(t),r)for(t=0;t<r.length;t++)n=r[t],s=n._getVersion,s=s(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,s]:e.mutableSourceEagerHydrationData.push(n,s);return new Th(e)};Fn.render=function(t,e,n){if(!xh(e))throw Error(W(200));return Sh(null,t,e,!1,n)};Fn.unmountComponentAtNode=function(t){if(!xh(t))throw Error(W(40));return t._reactRootContainer?(Ui(function(){Sh(null,null,t,!1,function(){t._reactRootContainer=null,t[Gr]=null})}),!0):!1};Fn.unstable_batchedUpdates=Qg;Fn.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!xh(n))throw Error(W(200));if(t==null||t._reactInternals===void 0)throw Error(W(38));return Sh(t,e,n,!1,r)};Fn.version="18.3.1-next-f1338f8080-20240426";function bx(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(bx)}catch(t){console.error(t)}}bx(),bT.exports=Fn;var OP=bT.exports,Cx,Aw=OP;Cx=Aw.createRoot,Aw.hydrateRoot;/**
 * react-router v7.9.6
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var Rw="popstate";function VP(t={}){function e(r,s){let{pathname:i,search:o,hash:a}=r.location;return Sm("",{pathname:i,search:o,hash:a},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function n(r,s){return typeof s=="string"?s:sc(s)}return MP(e,n,null,t)}function dt(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function Jn(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function LP(){return Math.random().toString(36).substring(2,10)}function Pw(t,e){return{usr:t.state,key:t.key,idx:e}}function Sm(t,e,n=null,r){return{pathname:typeof t=="string"?t:t.pathname,search:"",hash:"",...typeof e=="string"?ba(e):e,state:n,key:e&&e.key||r||LP()}}function sc({pathname:t="/",search:e="",hash:n=""}){return e&&e!=="?"&&(t+=e.charAt(0)==="?"?e:"?"+e),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function ba(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substring(n),t=t.substring(0,n));let r=t.indexOf("?");r>=0&&(e.search=t.substring(r),t=t.substring(0,r)),t&&(e.pathname=t)}return e}function MP(t,e,n,r={}){let{window:s=document.defaultView,v5Compat:i=!1}=r,o=s.history,a="POP",l=null,d=h();d==null&&(d=0,o.replaceState({...o.state,idx:d},""));function h(){return(o.state||{idx:null}).idx}function f(){a="POP";let A=h(),I=A==null?null:A-d;d=A,l&&l({action:a,location:b.location,delta:I})}function m(A,I){a="PUSH";let w=Sm(b.location,A,I);d=h()+1;let y=Pw(w,d),j=b.createHref(w);try{o.pushState(y,"",j)}catch(V){if(V instanceof DOMException&&V.name==="DataCloneError")throw V;s.location.assign(j)}i&&l&&l({action:a,location:b.location,delta:1})}function v(A,I){a="REPLACE";let w=Sm(b.location,A,I);d=h();let y=Pw(w,d),j=b.createHref(w);o.replaceState(y,"",j),i&&l&&l({action:a,location:b.location,delta:0})}function R(A){return FP(A)}let b={get action(){return a},get location(){return t(s,o)},listen(A){if(l)throw new Error("A history only accepts one active listener");return s.addEventListener(Rw,f),l=A,()=>{s.removeEventListener(Rw,f),l=null}},createHref(A){return e(s,A)},createURL:R,encodeLocation(A){let I=R(A);return{pathname:I.pathname,search:I.search,hash:I.hash}},push:m,replace:v,go(A){return o.go(A)}};return b}function FP(t,e=!1){let n="http://localhost";typeof window<"u"&&(n=window.location.origin!=="null"?window.location.origin:window.location.href),dt(n,"No window.location.(origin|href) available to create URL");let r=typeof t=="string"?t:sc(t);return r=r.replace(/ $/,"%20"),!e&&r.startsWith("//")&&(r=n+r),new URL(r,n)}function Ax(t,e,n="/"){return UP(t,e,n,!1)}function UP(t,e,n,r){let s=typeof e=="string"?ba(e):e,i=Xr(s.pathname||"/",n);if(i==null)return null;let o=Rx(t);$P(o);let a=null;for(let l=0;a==null&&l<o.length;++l){let d=JP(i);a=YP(o[l],d,r)}return a}function Rx(t,e=[],n=[],r="",s=!1){let i=(o,a,l=s,d)=>{let h={relativePath:d===void 0?o.path||"":d,caseSensitive:o.caseSensitive===!0,childrenIndex:a,route:o};if(h.relativePath.startsWith("/")){if(!h.relativePath.startsWith(r)&&l)return;dt(h.relativePath.startsWith(r),`Absolute route path "${h.relativePath}" nested under path "${r}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),h.relativePath=h.relativePath.slice(r.length)}let f=Wr([r,h.relativePath]),m=n.concat(h);o.children&&o.children.length>0&&(dt(o.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${f}".`),Rx(o.children,e,m,f,l)),!(o.path==null&&!o.index)&&e.push({path:f,score:GP(f,o.index),routesMeta:m})};return t.forEach((o,a)=>{var l;if(o.path===""||!((l=o.path)!=null&&l.includes("?")))i(o,a);else for(let d of Px(o.path))i(o,a,!0,d)}),e}function Px(t){let e=t.split("/");if(e.length===0)return[];let[n,...r]=e,s=n.endsWith("?"),i=n.replace(/\?$/,"");if(r.length===0)return s?[i,""]:[i];let o=Px(r.join("/")),a=[];return a.push(...o.map(l=>l===""?i:[i,l].join("/"))),s&&a.push(...o),a.map(l=>t.startsWith("/")&&l===""?"/":l)}function $P(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:QP(e.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}var BP=/^:[\w-]+$/,zP=3,qP=2,HP=1,WP=10,KP=-2,kw=t=>t==="*";function GP(t,e){let n=t.split("/"),r=n.length;return n.some(kw)&&(r+=KP),e&&(r+=qP),n.filter(s=>!kw(s)).reduce((s,i)=>s+(BP.test(i)?zP:i===""?HP:WP),r)}function QP(t,e){return t.length===e.length&&t.slice(0,-1).every((r,s)=>r===e[s])?t[t.length-1]-e[e.length-1]:0}function YP(t,e,n=!1){let{routesMeta:r}=t,s={},i="/",o=[];for(let a=0;a<r.length;++a){let l=r[a],d=a===r.length-1,h=i==="/"?e:e.slice(i.length)||"/",f=kd({path:l.relativePath,caseSensitive:l.caseSensitive,end:d},h),m=l.route;if(!f&&d&&n&&!r[r.length-1].route.index&&(f=kd({path:l.relativePath,caseSensitive:l.caseSensitive,end:!1},h)),!f)return null;Object.assign(s,f.params),o.push({params:s,pathname:Wr([i,f.pathname]),pathnameBase:rk(Wr([i,f.pathnameBase])),route:m}),f.pathnameBase!=="/"&&(i=Wr([i,f.pathnameBase]))}return o}function kd(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,r]=XP(t.path,t.caseSensitive,t.end),s=e.match(n);if(!s)return null;let i=s[0],o=i.replace(/(.)\/+$/,"$1"),a=s.slice(1);return{params:r.reduce((d,{paramName:h,isOptional:f},m)=>{if(h==="*"){let R=a[m]||"";o=i.slice(0,i.length-R.length).replace(/(.)\/+$/,"$1")}const v=a[m];return f&&!v?d[h]=void 0:d[h]=(v||"").replace(/%2F/g,"/"),d},{}),pathname:i,pathnameBase:o,pattern:t}}function XP(t,e=!1,n=!0){Jn(t==="*"||!t.endsWith("*")||t.endsWith("/*"),`Route path "${t}" will be treated as if it were "${t.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${t.replace(/\*$/,"/*")}".`);let r=[],s="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,a,l)=>(r.push({paramName:a,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return t.endsWith("*")?(r.push({paramName:"*"}),s+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?s+="\\/*$":t!==""&&t!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,e?void 0:"i"),r]}function JP(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Jn(!1,`The URL path "${t}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),t}}function Xr(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,r=t.charAt(n);return r&&r!=="/"?null:t.slice(n)||"/"}var ZP=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,ek=t=>ZP.test(t);function tk(t,e="/"){let{pathname:n,search:r="",hash:s=""}=typeof t=="string"?ba(t):t,i;if(n)if(ek(n))i=n;else{if(n.includes("//")){let o=n;n=n.replace(/\/\/+/g,"/"),Jn(!1,`Pathnames cannot have embedded double slashes - normalizing ${o} -> ${n}`)}n.startsWith("/")?i=Nw(n.substring(1),"/"):i=Nw(n,e)}else i=e;return{pathname:i,search:sk(r),hash:ik(s)}}function Nw(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(s=>{s===".."?n.length>1&&n.pop():s!=="."&&n.push(s)}),n.length>1?n.join("/"):"/"}function rp(t,e,n,r){return`Cannot include a '${t}' character in a manually specified \`to.${e}\` field [${JSON.stringify(r)}].  Please separate it out to the \`to.${n}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function nk(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function ry(t){let e=nk(t);return e.map((n,r)=>r===e.length-1?n.pathname:n.pathnameBase)}function sy(t,e,n,r=!1){let s;typeof t=="string"?s=ba(t):(s={...t},dt(!s.pathname||!s.pathname.includes("?"),rp("?","pathname","search",s)),dt(!s.pathname||!s.pathname.includes("#"),rp("#","pathname","hash",s)),dt(!s.search||!s.search.includes("#"),rp("#","search","hash",s)));let i=t===""||s.pathname==="",o=i?"/":s.pathname,a;if(o==null)a=n;else{let f=e.length-1;if(!r&&o.startsWith("..")){let m=o.split("/");for(;m[0]==="..";)m.shift(),f-=1;s.pathname=m.join("/")}a=f>=0?e[f]:"/"}let l=tk(s,a),d=o&&o!=="/"&&o.endsWith("/"),h=(i||o===".")&&n.endsWith("/");return!l.pathname.endsWith("/")&&(d||h)&&(l.pathname+="/"),l}var Wr=t=>t.join("/").replace(/\/\/+/g,"/"),rk=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),sk=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,ik=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function ok(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var kx=["POST","PUT","PATCH","DELETE"];new Set(kx);var ak=["GET",...kx];new Set(ak);var Ca=k.createContext(null);Ca.displayName="DataRouter";var bh=k.createContext(null);bh.displayName="DataRouterState";k.createContext(!1);var Nx=k.createContext({isTransitioning:!1});Nx.displayName="ViewTransition";var lk=k.createContext(new Map);lk.displayName="Fetchers";var ck=k.createContext(null);ck.displayName="Await";var mr=k.createContext(null);mr.displayName="Navigation";var xc=k.createContext(null);xc.displayName="Location";var Vr=k.createContext({outlet:null,matches:[],isDataRoute:!1});Vr.displayName="Route";var iy=k.createContext(null);iy.displayName="RouteError";function uk(t,{relative:e}={}){dt(Aa(),"useHref() may be used only in the context of a <Router> component.");let{basename:n,navigator:r}=k.useContext(mr),{hash:s,pathname:i,search:o}=bc(t,{relative:e}),a=i;return n!=="/"&&(a=i==="/"?n:Wr([n,i])),r.createHref({pathname:a,search:o,hash:s})}function Aa(){return k.useContext(xc)!=null}function Lr(){return dt(Aa(),"useLocation() may be used only in the context of a <Router> component."),k.useContext(xc).location}var Dx="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function jx(t){k.useContext(mr).static||k.useLayoutEffect(t)}function Sc(){let{isDataRoute:t}=k.useContext(Vr);return t?Tk():dk()}function dk(){dt(Aa(),"useNavigate() may be used only in the context of a <Router> component.");let t=k.useContext(Ca),{basename:e,navigator:n}=k.useContext(mr),{matches:r}=k.useContext(Vr),{pathname:s}=Lr(),i=JSON.stringify(ry(r)),o=k.useRef(!1);return jx(()=>{o.current=!0}),k.useCallback((l,d={})=>{if(Jn(o.current,Dx),!o.current)return;if(typeof l=="number"){n.go(l);return}let h=sy(l,JSON.parse(i),s,d.relative==="path");t==null&&e!=="/"&&(h.pathname=h.pathname==="/"?e:Wr([e,h.pathname])),(d.replace?n.replace:n.push)(h,d.state,d)},[e,n,i,s,t])}k.createContext(null);function bc(t,{relative:e}={}){let{matches:n}=k.useContext(Vr),{pathname:r}=Lr(),s=JSON.stringify(ry(n));return k.useMemo(()=>sy(t,JSON.parse(s),r,e==="path"),[t,s,r,e])}function hk(t,e){return Ox(t,e)}function Ox(t,e,n,r,s){var w;dt(Aa(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:i}=k.useContext(mr),{matches:o}=k.useContext(Vr),a=o[o.length-1],l=a?a.params:{},d=a?a.pathname:"/",h=a?a.pathnameBase:"/",f=a&&a.route;{let y=f&&f.path||"";Vx(d,!f||y.endsWith("*")||y.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${d}" (under <Route path="${y}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${y}"> to <Route path="${y==="/"?"*":`${y}/*`}">.`)}let m=Lr(),v;if(e){let y=typeof e=="string"?ba(e):e;dt(h==="/"||((w=y.pathname)==null?void 0:w.startsWith(h)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${h}" but pathname "${y.pathname}" was given in the \`location\` prop.`),v=y}else v=m;let R=v.pathname||"/",b=R;if(h!=="/"){let y=h.replace(/^\//,"").split("/");b="/"+R.replace(/^\//,"").split("/").slice(y.length).join("/")}let A=Ax(t,{pathname:b});Jn(f||A!=null,`No routes matched location "${v.pathname}${v.search}${v.hash}" `),Jn(A==null||A[A.length-1].route.element!==void 0||A[A.length-1].route.Component!==void 0||A[A.length-1].route.lazy!==void 0,`Matched leaf route at location "${v.pathname}${v.search}${v.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let I=yk(A&&A.map(y=>Object.assign({},y,{params:Object.assign({},l,y.params),pathname:Wr([h,i.encodeLocation?i.encodeLocation(y.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:y.pathname]),pathnameBase:y.pathnameBase==="/"?h:Wr([h,i.encodeLocation?i.encodeLocation(y.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:y.pathnameBase])})),o,n,r,s);return e&&I?k.createElement(xc.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...v},navigationType:"POP"}},I):I}function fk(){let t=Ik(),e=ok(t)?`${t.status} ${t.statusText}`:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,r="rgba(200,200,200, 0.5)",s={padding:"0.5rem",backgroundColor:r},i={padding:"2px 4px",backgroundColor:r},o=null;return console.error("Error handled by React Router default ErrorBoundary:",t),o=k.createElement(k.Fragment,null,k.createElement("p",null," Hey developer "),k.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",k.createElement("code",{style:i},"ErrorBoundary")," or"," ",k.createElement("code",{style:i},"errorElement")," prop on your route.")),k.createElement(k.Fragment,null,k.createElement("h2",null,"Unexpected Application Error!"),k.createElement("h3",{style:{fontStyle:"italic"}},e),n?k.createElement("pre",{style:s},n):null,o)}var pk=k.createElement(fk,null),mk=class extends k.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,e){return e.location!==t.location||e.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:e.error,location:e.location,revalidation:t.revalidation||e.revalidation}}componentDidCatch(t,e){this.props.onError?this.props.onError(t,e):console.error("React Router caught the following error during render",t)}render(){return this.state.error!==void 0?k.createElement(Vr.Provider,{value:this.props.routeContext},k.createElement(iy.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function gk({routeContext:t,match:e,children:n}){let r=k.useContext(Ca);return r&&r.static&&r.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=e.route.id),k.createElement(Vr.Provider,{value:t},n)}function yk(t,e=[],n=null,r=null,s=null){if(t==null){if(!n)return null;if(n.errors)t=n.matches;else if(e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let i=t,o=n==null?void 0:n.errors;if(o!=null){let h=i.findIndex(f=>f.route.id&&(o==null?void 0:o[f.route.id])!==void 0);dt(h>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(o).join(",")}`),i=i.slice(0,Math.min(i.length,h+1))}let a=!1,l=-1;if(n)for(let h=0;h<i.length;h++){let f=i[h];if((f.route.HydrateFallback||f.route.hydrateFallbackElement)&&(l=h),f.route.id){let{loaderData:m,errors:v}=n,R=f.route.loader&&!m.hasOwnProperty(f.route.id)&&(!v||v[f.route.id]===void 0);if(f.route.lazy||R){a=!0,l>=0?i=i.slice(0,l+1):i=[i[0]];break}}}let d=n&&r?(h,f)=>{var m,v;r(h,{location:n.location,params:((v=(m=n.matches)==null?void 0:m[0])==null?void 0:v.params)??{},errorInfo:f})}:void 0;return i.reduceRight((h,f,m)=>{let v,R=!1,b=null,A=null;n&&(v=o&&f.route.id?o[f.route.id]:void 0,b=f.route.errorElement||pk,a&&(l<0&&m===0?(Vx("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),R=!0,A=null):l===m&&(R=!0,A=f.route.hydrateFallbackElement||null)));let I=e.concat(i.slice(0,m+1)),w=()=>{let y;return v?y=b:R?y=A:f.route.Component?y=k.createElement(f.route.Component,null):f.route.element?y=f.route.element:y=h,k.createElement(gk,{match:f,routeContext:{outlet:h,matches:I,isDataRoute:n!=null},children:y})};return n&&(f.route.ErrorBoundary||f.route.errorElement||m===0)?k.createElement(mk,{location:n.location,revalidation:n.revalidation,component:b,error:v,children:w(),routeContext:{outlet:null,matches:I,isDataRoute:!0},onError:d}):w()},null)}function oy(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function _k(t){let e=k.useContext(Ca);return dt(e,oy(t)),e}function vk(t){let e=k.useContext(bh);return dt(e,oy(t)),e}function wk(t){let e=k.useContext(Vr);return dt(e,oy(t)),e}function ay(t){let e=wk(t),n=e.matches[e.matches.length-1];return dt(n.route.id,`${t} can only be used on routes that contain a unique "id"`),n.route.id}function Ek(){return ay("useRouteId")}function Ik(){var r;let t=k.useContext(iy),e=vk("useRouteError"),n=ay("useRouteError");return t!==void 0?t:(r=e.errors)==null?void 0:r[n]}function Tk(){let{router:t}=_k("useNavigate"),e=ay("useNavigate"),n=k.useRef(!1);return jx(()=>{n.current=!0}),k.useCallback(async(s,i={})=>{Jn(n.current,Dx),n.current&&(typeof s=="number"?t.navigate(s):await t.navigate(s,{fromRouteId:e,...i}))},[t,e])}var Dw={};function Vx(t,e,n){!e&&!Dw[t]&&(Dw[t]=!0,Jn(!1,n))}k.memo(xk);function xk({routes:t,future:e,state:n,unstable_onError:r}){return Ox(t,void 0,n,r,e)}function Nd({to:t,replace:e,state:n,relative:r}){dt(Aa(),"<Navigate> may be used only in the context of a <Router> component.");let{static:s}=k.useContext(mr);Jn(!s,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:i}=k.useContext(Vr),{pathname:o}=Lr(),a=Sc(),l=sy(t,ry(i),o,r==="path"),d=JSON.stringify(l);return k.useEffect(()=>{a(JSON.parse(d),{replace:e,state:n,relative:r})},[a,d,r,e,n]),null}function To(t){dt(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function Sk({basename:t="/",children:e=null,location:n,navigationType:r="POP",navigator:s,static:i=!1}){dt(!Aa(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let o=t.replace(/^\/*/,"/"),a=k.useMemo(()=>({basename:o,navigator:s,static:i,future:{}}),[o,s,i]);typeof n=="string"&&(n=ba(n));let{pathname:l="/",search:d="",hash:h="",state:f=null,key:m="default"}=n,v=k.useMemo(()=>{let R=Xr(l,o);return R==null?null:{location:{pathname:R,search:d,hash:h,state:f,key:m},navigationType:r}},[o,l,d,h,f,m,r]);return Jn(v!=null,`<Router basename="${o}"> is not able to match the URL "${l}${d}${h}" because it does not start with the basename, so the <Router> won't render anything.`),v==null?null:k.createElement(mr.Provider,{value:a},k.createElement(xc.Provider,{children:e,value:v}))}function bk({children:t,location:e}){return hk(bm(t),e)}function bm(t,e=[]){let n=[];return k.Children.forEach(t,(r,s)=>{if(!k.isValidElement(r))return;let i=[...e,s];if(r.type===k.Fragment){n.push.apply(n,bm(r.props.children,i));return}dt(r.type===To,`[${typeof r.type=="string"?r.type:r.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),dt(!r.props.index||!r.props.children,"An index route cannot have child routes.");let o={id:r.props.id||i.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,middleware:r.props.middleware,loader:r.props.loader,action:r.props.action,hydrateFallbackElement:r.props.hydrateFallbackElement,HydrateFallback:r.props.HydrateFallback,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.hasErrorBoundary===!0||r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(o.children=bm(r.props.children,i)),n.push(o)}),n}var zu="get",qu="application/x-www-form-urlencoded";function Ch(t){return t!=null&&typeof t.tagName=="string"}function Ck(t){return Ch(t)&&t.tagName.toLowerCase()==="button"}function Ak(t){return Ch(t)&&t.tagName.toLowerCase()==="form"}function Rk(t){return Ch(t)&&t.tagName.toLowerCase()==="input"}function Pk(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function kk(t,e){return t.button===0&&(!e||e==="_self")&&!Pk(t)}var yu=null;function Nk(){if(yu===null)try{new FormData(document.createElement("form"),0),yu=!1}catch{yu=!0}return yu}var Dk=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function sp(t){return t!=null&&!Dk.has(t)?(Jn(!1,`"${t}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${qu}"`),null):t}function jk(t,e){let n,r,s,i,o;if(Ak(t)){let a=t.getAttribute("action");r=a?Xr(a,e):null,n=t.getAttribute("method")||zu,s=sp(t.getAttribute("enctype"))||qu,i=new FormData(t)}else if(Ck(t)||Rk(t)&&(t.type==="submit"||t.type==="image")){let a=t.form;if(a==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let l=t.getAttribute("formaction")||a.getAttribute("action");if(r=l?Xr(l,e):null,n=t.getAttribute("formmethod")||a.getAttribute("method")||zu,s=sp(t.getAttribute("formenctype"))||sp(a.getAttribute("enctype"))||qu,i=new FormData(a,t),!Nk()){let{name:d,type:h,value:f}=t;if(h==="image"){let m=d?`${d}.`:"";i.append(`${m}x`,"0"),i.append(`${m}y`,"0")}else d&&i.append(d,f)}}else{if(Ch(t))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');n=zu,r=null,s=qu,o=t}return i&&s==="text/plain"&&(o=i,i=void 0),{action:r,method:n.toLowerCase(),encType:s,formData:i,body:o}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function ly(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function Ok(t,e,n){let r=typeof t=="string"?new URL(t,typeof window>"u"?"server://singlefetch/":window.location.origin):t;return r.pathname==="/"?r.pathname=`_root.${n}`:e&&Xr(r.pathname,e)==="/"?r.pathname=`${e.replace(/\/$/,"")}/_root.${n}`:r.pathname=`${r.pathname.replace(/\/$/,"")}.${n}`,r}async function Vk(t,e){if(t.id in e)return e[t.id];try{let n=await import(t.module);return e[t.id]=n,n}catch(n){return console.error(`Error loading route module \`${t.module}\`, reloading page...`),console.error(n),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function Lk(t){return t==null?!1:t.href==null?t.rel==="preload"&&typeof t.imageSrcSet=="string"&&typeof t.imageSizes=="string":typeof t.rel=="string"&&typeof t.href=="string"}async function Mk(t,e,n){let r=await Promise.all(t.map(async s=>{let i=e.routes[s.route.id];if(i){let o=await Vk(i,n);return o.links?o.links():[]}return[]}));return Bk(r.flat(1).filter(Lk).filter(s=>s.rel==="stylesheet"||s.rel==="preload").map(s=>s.rel==="stylesheet"?{...s,rel:"prefetch",as:"style"}:{...s,rel:"prefetch"}))}function jw(t,e,n,r,s,i){let o=(l,d)=>n[d]?l.route.id!==n[d].route.id:!0,a=(l,d)=>{var h;return n[d].pathname!==l.pathname||((h=n[d].route.path)==null?void 0:h.endsWith("*"))&&n[d].params["*"]!==l.params["*"]};return i==="assets"?e.filter((l,d)=>o(l,d)||a(l,d)):i==="data"?e.filter((l,d)=>{var f;let h=r.routes[l.route.id];if(!h||!h.hasLoader)return!1;if(o(l,d)||a(l,d))return!0;if(l.route.shouldRevalidate){let m=l.route.shouldRevalidate({currentUrl:new URL(s.pathname+s.search+s.hash,window.origin),currentParams:((f=n[0])==null?void 0:f.params)||{},nextUrl:new URL(t,window.origin),nextParams:l.params,defaultShouldRevalidate:!0});if(typeof m=="boolean")return m}return!0}):[]}function Fk(t,e,{includeHydrateFallback:n}={}){return Uk(t.map(r=>{let s=e.routes[r.route.id];if(!s)return[];let i=[s.module];return s.clientActionModule&&(i=i.concat(s.clientActionModule)),s.clientLoaderModule&&(i=i.concat(s.clientLoaderModule)),n&&s.hydrateFallbackModule&&(i=i.concat(s.hydrateFallbackModule)),s.imports&&(i=i.concat(s.imports)),i}).flat(1))}function Uk(t){return[...new Set(t)]}function $k(t){let e={},n=Object.keys(t).sort();for(let r of n)e[r]=t[r];return e}function Bk(t,e){let n=new Set;return new Set(e),t.reduce((r,s)=>{let i=JSON.stringify($k(s));return n.has(i)||(n.add(i),r.push({key:i,link:s})),r},[])}function Lx(){let t=k.useContext(Ca);return ly(t,"You must render this element inside a <DataRouterContext.Provider> element"),t}function zk(){let t=k.useContext(bh);return ly(t,"You must render this element inside a <DataRouterStateContext.Provider> element"),t}var cy=k.createContext(void 0);cy.displayName="FrameworkContext";function Mx(){let t=k.useContext(cy);return ly(t,"You must render this element inside a <HydratedRouter> element"),t}function qk(t,e){let n=k.useContext(cy),[r,s]=k.useState(!1),[i,o]=k.useState(!1),{onFocus:a,onBlur:l,onMouseEnter:d,onMouseLeave:h,onTouchStart:f}=e,m=k.useRef(null);k.useEffect(()=>{if(t==="render"&&o(!0),t==="viewport"){let b=I=>{I.forEach(w=>{o(w.isIntersecting)})},A=new IntersectionObserver(b,{threshold:.5});return m.current&&A.observe(m.current),()=>{A.disconnect()}}},[t]),k.useEffect(()=>{if(r){let b=setTimeout(()=>{o(!0)},100);return()=>{clearTimeout(b)}}},[r]);let v=()=>{s(!0)},R=()=>{s(!1),o(!1)};return n?t!=="intent"?[i,m,{}]:[i,m,{onFocus:tl(a,v),onBlur:tl(l,R),onMouseEnter:tl(d,v),onMouseLeave:tl(h,R),onTouchStart:tl(f,v)}]:[!1,m,{}]}function tl(t,e){return n=>{t&&t(n),n.defaultPrevented||e(n)}}function Hk({page:t,...e}){let{router:n}=Lx(),r=k.useMemo(()=>Ax(n.routes,t,n.basename),[n.routes,t,n.basename]);return r?k.createElement(Kk,{page:t,matches:r,...e}):null}function Wk(t){let{manifest:e,routeModules:n}=Mx(),[r,s]=k.useState([]);return k.useEffect(()=>{let i=!1;return Mk(t,e,n).then(o=>{i||s(o)}),()=>{i=!0}},[t,e,n]),r}function Kk({page:t,matches:e,...n}){let r=Lr(),{manifest:s,routeModules:i}=Mx(),{basename:o}=Lx(),{loaderData:a,matches:l}=zk(),d=k.useMemo(()=>jw(t,e,l,s,r,"data"),[t,e,l,s,r]),h=k.useMemo(()=>jw(t,e,l,s,r,"assets"),[t,e,l,s,r]),f=k.useMemo(()=>{if(t===r.pathname+r.search+r.hash)return[];let R=new Set,b=!1;if(e.forEach(I=>{var y;let w=s.routes[I.route.id];!w||!w.hasLoader||(!d.some(j=>j.route.id===I.route.id)&&I.route.id in a&&((y=i[I.route.id])!=null&&y.shouldRevalidate)||w.hasClientLoader?b=!0:R.add(I.route.id))}),R.size===0)return[];let A=Ok(t,o,"data");return b&&R.size>0&&A.searchParams.set("_routes",e.filter(I=>R.has(I.route.id)).map(I=>I.route.id).join(",")),[A.pathname+A.search]},[o,a,r,s,d,e,t,i]),m=k.useMemo(()=>Fk(h,s),[h,s]),v=Wk(h);return k.createElement(k.Fragment,null,f.map(R=>k.createElement("link",{key:R,rel:"prefetch",as:"fetch",href:R,...n})),m.map(R=>k.createElement("link",{key:R,rel:"modulepreload",href:R,...n})),v.map(({key:R,link:b})=>k.createElement("link",{key:R,nonce:n.nonce,...b})))}function Gk(...t){return e=>{t.forEach(n=>{typeof n=="function"?n(e):n!=null&&(n.current=e)})}}var Fx=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{Fx&&(window.__reactRouterVersion="7.9.6")}catch{}function Qk({basename:t,children:e,window:n}){let r=k.useRef();r.current==null&&(r.current=VP({window:n,v5Compat:!0}));let s=r.current,[i,o]=k.useState({action:s.action,location:s.location}),a=k.useCallback(l=>{k.startTransition(()=>o(l))},[o]);return k.useLayoutEffect(()=>s.listen(a),[s,a]),k.createElement(Sk,{basename:t,children:e,location:i.location,navigationType:i.action,navigator:s})}var Ux=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,$x=k.forwardRef(function({onClick:e,discover:n="render",prefetch:r="none",relative:s,reloadDocument:i,replace:o,state:a,target:l,to:d,preventScrollReset:h,viewTransition:f,...m},v){let{basename:R}=k.useContext(mr),b=typeof d=="string"&&Ux.test(d),A,I=!1;if(typeof d=="string"&&b&&(A=d,Fx))try{let S=new URL(window.location.href),C=d.startsWith("//")?new URL(S.protocol+d):new URL(d),N=Xr(C.pathname,R);C.origin===S.origin&&N!=null?d=N+C.search+C.hash:I=!0}catch{Jn(!1,`<Link to="${d}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let w=uk(d,{relative:s}),[y,j,V]=qk(r,m),M=Jk(d,{replace:o,state:a,target:l,preventScrollReset:h,relative:s,viewTransition:f});function T(S){e&&e(S),S.defaultPrevented||M(S)}let _=k.createElement("a",{...m,...V,href:A||w,onClick:I||i?e:T,ref:Gk(v,j),target:l,"data-discover":!b&&n==="render"?"true":void 0});return y&&!b?k.createElement(k.Fragment,null,_,k.createElement(Hk,{page:w})):_});$x.displayName="Link";var xo=k.forwardRef(function({"aria-current":e="page",caseSensitive:n=!1,className:r="",end:s=!1,style:i,to:o,viewTransition:a,children:l,...d},h){let f=bc(o,{relative:d.relative}),m=Lr(),v=k.useContext(bh),{navigator:R,basename:b}=k.useContext(mr),A=v!=null&&rN(f)&&a===!0,I=R.encodeLocation?R.encodeLocation(f).pathname:f.pathname,w=m.pathname,y=v&&v.navigation&&v.navigation.location?v.navigation.location.pathname:null;n||(w=w.toLowerCase(),y=y?y.toLowerCase():null,I=I.toLowerCase()),y&&b&&(y=Xr(y,b)||y);const j=I!=="/"&&I.endsWith("/")?I.length-1:I.length;let V=w===I||!s&&w.startsWith(I)&&w.charAt(j)==="/",M=y!=null&&(y===I||!s&&y.startsWith(I)&&y.charAt(I.length)==="/"),T={isActive:V,isPending:M,isTransitioning:A},_=V?e:void 0,S;typeof r=="function"?S=r(T):S=[r,V?"active":null,M?"pending":null,A?"transitioning":null].filter(Boolean).join(" ");let C=typeof i=="function"?i(T):i;return k.createElement($x,{...d,"aria-current":_,className:S,ref:h,style:C,to:o,viewTransition:a},typeof l=="function"?l(T):l)});xo.displayName="NavLink";var Yk=k.forwardRef(({discover:t="render",fetcherKey:e,navigate:n,reloadDocument:r,replace:s,state:i,method:o=zu,action:a,onSubmit:l,relative:d,preventScrollReset:h,viewTransition:f,...m},v)=>{let R=tN(),b=nN(a,{relative:d}),A=o.toLowerCase()==="get"?"get":"post",I=typeof a=="string"&&Ux.test(a),w=y=>{if(l&&l(y),y.defaultPrevented)return;y.preventDefault();let j=y.nativeEvent.submitter,V=(j==null?void 0:j.getAttribute("formmethod"))||o;R(j||y.currentTarget,{fetcherKey:e,method:V,navigate:n,replace:s,state:i,relative:d,preventScrollReset:h,viewTransition:f})};return k.createElement("form",{ref:v,method:A,action:b,onSubmit:r?l:w,...m,"data-discover":!I&&t==="render"?"true":void 0})});Yk.displayName="Form";function Xk(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function Bx(t){let e=k.useContext(Ca);return dt(e,Xk(t)),e}function Jk(t,{target:e,replace:n,state:r,preventScrollReset:s,relative:i,viewTransition:o}={}){let a=Sc(),l=Lr(),d=bc(t,{relative:i});return k.useCallback(h=>{if(kk(h,e)){h.preventDefault();let f=n!==void 0?n:sc(l)===sc(d);a(t,{replace:f,state:r,preventScrollReset:s,relative:i,viewTransition:o})}},[l,a,d,n,r,e,t,s,i,o])}var Zk=0,eN=()=>`__${String(++Zk)}__`;function tN(){let{router:t}=Bx("useSubmit"),{basename:e}=k.useContext(mr),n=Ek();return k.useCallback(async(r,s={})=>{let{action:i,method:o,encType:a,formData:l,body:d}=jk(r,e);if(s.navigate===!1){let h=s.fetcherKey||eN();await t.fetch(h,n,s.action||i,{preventScrollReset:s.preventScrollReset,formData:l,body:d,formMethod:s.method||o,formEncType:s.encType||a,flushSync:s.flushSync})}else await t.navigate(s.action||i,{preventScrollReset:s.preventScrollReset,formData:l,body:d,formMethod:s.method||o,formEncType:s.encType||a,replace:s.replace,state:s.state,fromRouteId:n,flushSync:s.flushSync,viewTransition:s.viewTransition})},[t,e,n])}function nN(t,{relative:e}={}){let{basename:n}=k.useContext(mr),r=k.useContext(Vr);dt(r,"useFormAction must be used inside a RouteContext");let[s]=r.matches.slice(-1),i={...bc(t||".",{relative:e})},o=Lr();if(t==null){i.search=o.search;let a=new URLSearchParams(i.search),l=a.getAll("index");if(l.some(h=>h==="")){a.delete("index"),l.filter(f=>f).forEach(f=>a.append("index",f));let h=a.toString();i.search=h?`?${h}`:""}}return(!t||t===".")&&s.route.index&&(i.search=i.search?i.search.replace(/^\?/,"?index&"):"?index"),n!=="/"&&(i.pathname=i.pathname==="/"?n:Wr([n,i.pathname])),sc(i)}function rN(t,{relative:e}={}){let n=k.useContext(Nx);dt(n!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:r}=Bx("useViewTransitionState"),s=bc(t,{relative:e});if(!n.isTransitioning)return!1;let i=Xr(n.currentLocation.pathname,r)||n.currentLocation.pathname,o=Xr(n.nextLocation.pathname,r)||n.nextLocation.pathname;return kd(s.pathname,o)!=null||kd(s.pathname,i)!=null}const sN=()=>{};var Ow={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zx=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let s=t.charCodeAt(r);s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=s&63|128):(s&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=s&63|128):(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=s&63|128)}return e},iN=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const s=t[n++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=t[n++];e[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=t[n++],o=t[n++],a=t[n++],l=((s&7)<<18|(i&63)<<12|(o&63)<<6|a&63)-65536;e[r++]=String.fromCharCode(55296+(l>>10)),e[r++]=String.fromCharCode(56320+(l&1023))}else{const i=t[n++],o=t[n++];e[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|o&63)}}return e.join("")},qx={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<t.length;s+=3){const i=t[s],o=s+1<t.length,a=o?t[s+1]:0,l=s+2<t.length,d=l?t[s+2]:0,h=i>>2,f=(i&3)<<4|a>>4;let m=(a&15)<<2|d>>6,v=d&63;l||(v=64,o||(m=64)),r.push(n[h],n[f],n[m],n[v])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(zx(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):iN(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<t.length;){const i=n[t.charAt(s++)],a=s<t.length?n[t.charAt(s)]:0;++s;const d=s<t.length?n[t.charAt(s)]:64;++s;const f=s<t.length?n[t.charAt(s)]:64;if(++s,i==null||a==null||d==null||f==null)throw new oN;const m=i<<2|a>>4;if(r.push(m),d!==64){const v=a<<4&240|d>>2;if(r.push(v),f!==64){const R=d<<6&192|f;r.push(R)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class oN extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const aN=function(t){const e=zx(t);return qx.encodeByteArray(e,!0)},Dd=function(t){return aN(t).replace(/\./g,"")},Hx=function(t){try{return qx.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wx(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lN=()=>Wx().__FIREBASE_DEFAULTS__,cN=()=>{if(typeof process>"u"||typeof Ow>"u")return;const t=Ow.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},uN=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&Hx(t[1]);return e&&JSON.parse(e)},Ah=()=>{try{return sN()||lN()||cN()||uN()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},Kx=t=>{var e,n;return(n=(e=Ah())==null?void 0:e.emulatorHosts)==null?void 0:n[t]},Gx=t=>{const e=Kx(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},Qx=()=>{var t;return(t=Ah())==null?void 0:t.config},Yx=t=>{var e;return(e=Ah())==null?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dN{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ti(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function uy(t){return(await fetch(t,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xx(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",s=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o={iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}},...t};return[Dd(JSON.stringify(n)),Dd(JSON.stringify(o)),""].join(".")}const kl={};function hN(){const t={prod:[],emulator:[]};for(const e of Object.keys(kl))kl[e]?t.emulator.push(e):t.prod.push(e);return t}function fN(t){let e=document.getElementById(t),n=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),n=!0),{created:n,element:e}}let Vw=!1;function dy(t,e){if(typeof window>"u"||typeof document>"u"||!ti(window.location.host)||kl[t]===e||kl[t]||Vw)return;kl[t]=e;function n(m){return`__firebase__banner__${m}`}const r="__firebase__banner",i=hN().prod.length>0;function o(){const m=document.getElementById(r);m&&m.remove()}function a(m){m.style.display="flex",m.style.background="#7faaf0",m.style.position="fixed",m.style.bottom="5px",m.style.left="5px",m.style.padding=".5em",m.style.borderRadius="5px",m.style.alignItems="center"}function l(m,v){m.setAttribute("width","24"),m.setAttribute("id",v),m.setAttribute("height","24"),m.setAttribute("viewBox","0 0 24 24"),m.setAttribute("fill","none"),m.style.marginLeft="-6px"}function d(){const m=document.createElement("span");return m.style.cursor="pointer",m.style.marginLeft="16px",m.style.fontSize="24px",m.innerHTML=" &times;",m.onclick=()=>{Vw=!0,o()},m}function h(m,v){m.setAttribute("id",v),m.innerText="Learn more",m.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",m.setAttribute("target","__blank"),m.style.paddingLeft="5px",m.style.textDecoration="underline"}function f(){const m=fN(r),v=n("text"),R=document.getElementById(v)||document.createElement("span"),b=n("learnmore"),A=document.getElementById(b)||document.createElement("a"),I=n("preprendIcon"),w=document.getElementById(I)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(m.created){const y=m.element;a(y),h(A,b);const j=d();l(w,I),y.append(w,R,A,j),document.body.appendChild(y)}i?(R.innerText="Preview backend disconnected.",w.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(w.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,R.innerText="Preview backend running in this workspace."),R.setAttribute("id",v)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",f):f()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vt(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function pN(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Vt())}function Jx(){var e;const t=(e=Ah())==null?void 0:e.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function mN(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function Zx(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function gN(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function yN(){const t=Vt();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function eS(){return!Jx()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function tS(){return!Jx()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function hy(){try{return typeof indexedDB=="object"}catch{return!1}}function nS(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{var i;e(((i=s.error)==null?void 0:i.message)||"")}}catch(n){e(n)}})}function _N(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vN="FirebaseError";class er extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=vN,Object.setPrototypeOf(this,er.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,ro.prototype.create)}}class ro{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},s=`${this.service}/${e}`,i=this.errors[e],o=i?wN(i,r):"Error",a=`${this.serviceName}: ${o} (${s}).`;return new er(s,a,r)}}function wN(t,e){return t.replace(EN,(n,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const EN=/\{\$([^}]+)}/g;function IN(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Jr(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const s of n){if(!r.includes(s))return!1;const i=t[s],o=e[s];if(Lw(i)&&Lw(o)){if(!Jr(i,o))return!1}else if(i!==o)return!1}for(const s of r)if(!n.includes(s))return!1;return!0}function Lw(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cc(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(s=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function fl(t){const e={};return t.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[s,i]=r.split("=");e[decodeURIComponent(s)]=decodeURIComponent(i)}}),e}function pl(t){const e=t.indexOf("?");if(!e)return"";const n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}function TN(t,e){const n=new xN(t,e);return n.subscribe.bind(n)}class xN{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let s;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");SN(e,["next","error","complete"])?s=e:s={next:e,error:n,complete:r},s.next===void 0&&(s.next=ip),s.error===void 0&&(s.error=ip),s.complete===void 0&&(s.complete=ip);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function SN(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function ip(){}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bN=1e3,CN=2,AN=4*60*60*1e3,RN=.5;function Mw(t,e=bN,n=CN){const r=e*Math.pow(n,t),s=Math.round(RN*r*(Math.random()-.5)*2);return Math.min(AN,r+s)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qe(t){return t&&t._delegate?t._delegate:t}class Zn{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mi="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PN{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new dN;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:n});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){const n=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),r=(e==null?void 0:e.optional)??!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(s){if(r)return null;throw s}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(NN(e))try{this.getOrInitializeService({instanceIdentifier:mi})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(n);try{const i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(e=mi){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=mi){return this.instances.has(e)}getOptions(e=mi){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[i,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(i);r===a&&o.resolve(s)}return s}onInit(e,n){const r=this.normalizeInstanceIdentifier(n),s=this.onInitCallbacks.get(r)??new Set;s.add(e),this.onInitCallbacks.set(r,s);const i=this.instances.get(r);return i&&e(i,r),()=>{s.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const s of r)try{s(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:kN(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=mi){return this.component?this.component.multipleInstances?e:mi:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function kN(t){return t===mi?void 0:t}function NN(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DN{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new PN(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Le;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Le||(Le={}));const jN={debug:Le.DEBUG,verbose:Le.VERBOSE,info:Le.INFO,warn:Le.WARN,error:Le.ERROR,silent:Le.SILENT},ON=Le.INFO,VN={[Le.DEBUG]:"log",[Le.VERBOSE]:"log",[Le.INFO]:"info",[Le.WARN]:"warn",[Le.ERROR]:"error"},LN=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),s=VN[e];if(s)console[s](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Rh{constructor(e){this.name=e,this._logLevel=ON,this._logHandler=LN,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Le))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?jN[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Le.DEBUG,...e),this._logHandler(this,Le.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Le.VERBOSE,...e),this._logHandler(this,Le.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Le.INFO,...e),this._logHandler(this,Le.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Le.WARN,...e),this._logHandler(this,Le.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Le.ERROR,...e),this._logHandler(this,Le.ERROR,...e)}}const MN=(t,e)=>e.some(n=>t instanceof n);let Fw,Uw;function FN(){return Fw||(Fw=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function UN(){return Uw||(Uw=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const rS=new WeakMap,Cm=new WeakMap,sS=new WeakMap,op=new WeakMap,fy=new WeakMap;function $N(t){const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("success",i),t.removeEventListener("error",o)},i=()=>{n(Fs(t.result)),s()},o=()=>{r(t.error),s()};t.addEventListener("success",i),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&rS.set(n,t)}).catch(()=>{}),fy.set(e,t),e}function BN(t){if(Cm.has(t))return;const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",o),t.removeEventListener("abort",o)},i=()=>{n(),s()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",i),t.addEventListener("error",o),t.addEventListener("abort",o)});Cm.set(t,e)}let Am={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return Cm.get(t);if(e==="objectStoreNames")return t.objectStoreNames||sS.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Fs(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function zN(t){Am=t(Am)}function qN(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(ap(this),e,...n);return sS.set(r,e.sort?e.sort():[e]),Fs(r)}:UN().includes(t)?function(...e){return t.apply(ap(this),e),Fs(rS.get(this))}:function(...e){return Fs(t.apply(ap(this),e))}}function HN(t){return typeof t=="function"?qN(t):(t instanceof IDBTransaction&&BN(t),MN(t,FN())?new Proxy(t,Am):t)}function Fs(t){if(t instanceof IDBRequest)return $N(t);if(op.has(t))return op.get(t);const e=HN(t);return e!==t&&(op.set(t,e),fy.set(e,t)),e}const ap=t=>fy.get(t);function iS(t,e,{blocked:n,upgrade:r,blocking:s,terminated:i}={}){const o=indexedDB.open(t,e),a=Fs(o);return r&&o.addEventListener("upgradeneeded",l=>{r(Fs(o.result),l.oldVersion,l.newVersion,Fs(o.transaction),l)}),n&&o.addEventListener("blocked",l=>n(l.oldVersion,l.newVersion,l)),a.then(l=>{i&&l.addEventListener("close",()=>i()),s&&l.addEventListener("versionchange",d=>s(d.oldVersion,d.newVersion,d))}).catch(()=>{}),a}const WN=["get","getKey","getAll","getAllKeys","count"],KN=["put","add","delete","clear"],lp=new Map;function $w(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(lp.get(e))return lp.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,s=KN.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(s||WN.includes(n)))return;const i=async function(o,...a){const l=this.transaction(o,s?"readwrite":"readonly");let d=l.store;return r&&(d=d.index(a.shift())),(await Promise.all([d[n](...a),s&&l.done]))[0]};return lp.set(e,i),i}zN(t=>({...t,get:(e,n,r)=>$w(e,n)||t.get(e,n,r),has:(e,n)=>!!$w(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GN{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(QN(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function QN(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Rm="@firebase/app",Bw="0.14.5";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zr=new Rh("@firebase/app"),YN="@firebase/app-compat",XN="@firebase/analytics-compat",JN="@firebase/analytics",ZN="@firebase/app-check-compat",eD="@firebase/app-check",tD="@firebase/auth",nD="@firebase/auth-compat",rD="@firebase/database",sD="@firebase/data-connect",iD="@firebase/database-compat",oD="@firebase/functions",aD="@firebase/functions-compat",lD="@firebase/installations",cD="@firebase/installations-compat",uD="@firebase/messaging",dD="@firebase/messaging-compat",hD="@firebase/performance",fD="@firebase/performance-compat",pD="@firebase/remote-config",mD="@firebase/remote-config-compat",gD="@firebase/storage",yD="@firebase/storage-compat",_D="@firebase/firestore",vD="@firebase/ai",wD="@firebase/firestore-compat",ED="firebase",ID="12.5.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pm="[DEFAULT]",TD={[Rm]:"fire-core",[YN]:"fire-core-compat",[JN]:"fire-analytics",[XN]:"fire-analytics-compat",[eD]:"fire-app-check",[ZN]:"fire-app-check-compat",[tD]:"fire-auth",[nD]:"fire-auth-compat",[rD]:"fire-rtdb",[sD]:"fire-data-connect",[iD]:"fire-rtdb-compat",[oD]:"fire-fn",[aD]:"fire-fn-compat",[lD]:"fire-iid",[cD]:"fire-iid-compat",[uD]:"fire-fcm",[dD]:"fire-fcm-compat",[hD]:"fire-perf",[fD]:"fire-perf-compat",[pD]:"fire-rc",[mD]:"fire-rc-compat",[gD]:"fire-gcs",[yD]:"fire-gcs-compat",[_D]:"fire-fst",[wD]:"fire-fst-compat",[vD]:"fire-vertex","fire-js":"fire-js",[ED]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jd=new Map,xD=new Map,km=new Map;function zw(t,e){try{t.container.addComponent(e)}catch(n){Zr.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function hr(t){const e=t.name;if(km.has(e))return Zr.debug(`There were multiple attempts to register component ${e}.`),!1;km.set(e,t);for(const n of jd.values())zw(n,t);for(const n of xD.values())zw(n,t);return!0}function ni(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function qn(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SD={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Us=new ro("app","Firebase",SD);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bD{constructor(e,n,r){this._isDeleted=!1,this._options={...e},this._config={...n},this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Zn("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Us.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const so=ID;function py(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r={name:Pm,automaticDataCollectionEnabled:!0,...e},s=r.name;if(typeof s!="string"||!s)throw Us.create("bad-app-name",{appName:String(s)});if(n||(n=Qx()),!n)throw Us.create("no-options");const i=jd.get(s);if(i){if(Jr(n,i.options)&&Jr(r,i.config))return i;throw Us.create("duplicate-app",{appName:s})}const o=new DN(s);for(const l of km.values())o.addComponent(l);const a=new bD(n,r,o);return jd.set(s,a),a}function Ph(t=Pm){const e=jd.get(t);if(!e&&t===Pm&&Qx())return py();if(!e)throw Us.create("no-app",{appName:t});return e}function Rn(t,e,n){let r=TD[t]??t;n&&(r+=`-${n}`);const s=r.match(/\s|\//),i=e.match(/\s|\//);if(s||i){const o=[`Unable to register library "${r}" with version "${e}":`];s&&o.push(`library name "${r}" contains illegal characters (whitespace or "/")`),s&&i&&o.push("and"),i&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Zr.warn(o.join(" "));return}hr(new Zn(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CD="firebase-heartbeat-database",AD=1,ic="firebase-heartbeat-store";let cp=null;function oS(){return cp||(cp=iS(CD,AD,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(ic)}catch(n){console.warn(n)}}}}).catch(t=>{throw Us.create("idb-open",{originalErrorMessage:t.message})})),cp}async function RD(t){try{const n=(await oS()).transaction(ic),r=await n.objectStore(ic).get(aS(t));return await n.done,r}catch(e){if(e instanceof er)Zr.warn(e.message);else{const n=Us.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Zr.warn(n.message)}}}async function qw(t,e){try{const r=(await oS()).transaction(ic,"readwrite");await r.objectStore(ic).put(e,aS(t)),await r.done}catch(n){if(n instanceof er)Zr.warn(n.message);else{const r=Us.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});Zr.warn(r.message)}}}function aS(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PD=1024,kD=30;class ND{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new jD(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=Hw();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)==null?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(o=>o.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:s}),this._heartbeatsCache.heartbeats.length>kD){const o=OD(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){Zr.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=Hw(),{heartbeatsToSend:r,unsentEntries:s}=DD(this._heartbeatsCache.heartbeats),i=Dd(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(n){return Zr.warn(n),""}}}function Hw(){return new Date().toISOString().substring(0,10)}function DD(t,e=PD){const n=[];let r=t.slice();for(const s of t){const i=n.find(o=>o.agent===s.agent);if(i){if(i.dates.push(s.date),Ww(n)>e){i.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),Ww(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class jD{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return hy()?nS().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await RD(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return qw(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return qw(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function Ww(t){return Dd(JSON.stringify({version:2,heartbeats:t})).length}function OD(t){if(t.length===0)return-1;let e=0,n=t[0].date;for(let r=1;r<t.length;r++)t[r].date<n&&(n=t[r].date,e=r);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VD(t){hr(new Zn("platform-logger",e=>new GN(e),"PRIVATE")),hr(new Zn("heartbeat",e=>new ND(e),"PRIVATE")),Rn(Rm,Bw,t),Rn(Rm,Bw,"esm2020"),Rn("fire-js","")}VD("");var LD="firebase",MD="12.5.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Rn(LD,MD,"app");function lS(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const FD=lS,cS=new ro("auth","Firebase",lS());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Od=new Rh("@firebase/auth");function UD(t,...e){Od.logLevel<=Le.WARN&&Od.warn(`Auth (${so}): ${t}`,...e)}function Hu(t,...e){Od.logLevel<=Le.ERROR&&Od.error(`Auth (${so}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fr(t,...e){throw my(t,...e)}function kr(t,...e){return my(t,...e)}function uS(t,e,n){const r={...FD(),[e]:n};return new ro("auth","Firebase",r).create(e,{appName:t.name})}function $s(t){return uS(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function my(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return cS.create(t,...e)}function _e(t,e,...n){if(!t)throw my(e,...n)}function Br(t){const e="INTERNAL ASSERTION FAILED: "+t;throw Hu(e),new Error(e)}function es(t,e){t||Br(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nm(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.href)||""}function $D(){return Kw()==="http:"||Kw()==="https:"}function Kw(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function BD(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&($D()||Zx()||"connection"in navigator)?navigator.onLine:!0}function zD(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ac{constructor(e,n){this.shortDelay=e,this.longDelay=n,es(n>e,"Short delay should be less than long delay!"),this.isMobile=pN()||gN()}get(){return BD()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gy(t,e){es(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dS{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Br("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Br("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Br("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qD={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HD=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],WD=new Ac(3e4,6e4);function io(t,e){return t.tenantId&&!e.tenantId?{...e,tenantId:t.tenantId}:e}async function ri(t,e,n,r,s={}){return hS(t,s,async()=>{let i={},o={};r&&(e==="GET"?o=r:i={body:JSON.stringify(r)});const a=Cc({key:t.config.apiKey,...o}).slice(1),l=await t._getAdditionalHeaders();l["Content-Type"]="application/json",t.languageCode&&(l["X-Firebase-Locale"]=t.languageCode);const d={method:e,headers:l,...i};return mN()||(d.referrerPolicy="no-referrer"),t.emulatorConfig&&ti(t.emulatorConfig.host)&&(d.credentials="include"),dS.fetch()(await fS(t,t.config.apiHost,n,a),d)})}async function hS(t,e,n){t._canInitEmulator=!1;const r={...qD,...e};try{const s=new GD(t),i=await Promise.race([n(),s.promise]);s.clearNetworkTimeout();const o=await i.json();if("needConfirmation"in o)throw _u(t,"account-exists-with-different-credential",o);if(i.ok&&!("errorMessage"in o))return o;{const a=i.ok?o.errorMessage:o.error.message,[l,d]=a.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw _u(t,"credential-already-in-use",o);if(l==="EMAIL_EXISTS")throw _u(t,"email-already-in-use",o);if(l==="USER_DISABLED")throw _u(t,"user-disabled",o);const h=r[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(d)throw uS(t,h,d);fr(t,h)}}catch(s){if(s instanceof er)throw s;fr(t,"network-request-failed",{message:String(s)})}}async function kh(t,e,n,r,s={}){const i=await ri(t,e,n,r,s);return"mfaPendingCredential"in i&&fr(t,"multi-factor-auth-required",{_serverResponse:i}),i}async function fS(t,e,n,r){const s=`${e}${n}?${r}`,i=t,o=i.config.emulator?gy(t.config,s):`${t.config.apiScheme}://${s}`;return HD.includes(n)&&(await i._persistenceManagerAvailable,i._getPersistenceType()==="COOKIE")?i._getPersistence()._getFinalTarget(o).toString():o}function KD(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class GD{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(kr(this.auth,"network-request-failed")),WD.get())})}}function _u(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const s=kr(t,e,r);return s.customData._tokenResponse=n,s}function Gw(t){return t!==void 0&&t.enterprise!==void 0}class QD{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const n of this.recaptchaEnforcementState)if(n.provider&&n.provider===e)return KD(n.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function YD(t,e){return ri(t,"GET","/v2/recaptchaConfig",io(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function XD(t,e){return ri(t,"POST","/v1/accounts:delete",e)}async function Vd(t,e){return ri(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nl(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function JD(t,e=!1){const n=Qe(t),r=await n.getIdToken(e),s=yy(r);_e(s&&s.exp&&s.auth_time&&s.iat,n.auth,"internal-error");const i=typeof s.firebase=="object"?s.firebase:void 0,o=i==null?void 0:i.sign_in_provider;return{claims:s,token:r,authTime:Nl(up(s.auth_time)),issuedAtTime:Nl(up(s.iat)),expirationTime:Nl(up(s.exp)),signInProvider:o||null,signInSecondFactor:(i==null?void 0:i.sign_in_second_factor)||null}}function up(t){return Number(t)*1e3}function yy(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return Hu("JWT malformed, contained fewer than 3 sections"),null;try{const s=Hx(n);return s?JSON.parse(s):(Hu("Failed to decode base64 JWT payload"),null)}catch(s){return Hu("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function Qw(t){const e=yy(t);return _e(e,"internal-error"),_e(typeof e.exp<"u","internal-error"),_e(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function oc(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof er&&ZD(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function ZD({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ej{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const r=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dm{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=Nl(this.lastLoginAt),this.creationTime=Nl(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ld(t){var f;const e=t.auth,n=await t.getIdToken(),r=await oc(t,Vd(e,{idToken:n}));_e(r==null?void 0:r.users.length,e,"internal-error");const s=r.users[0];t._notifyReloadListener(s);const i=(f=s.providerUserInfo)!=null&&f.length?pS(s.providerUserInfo):[],o=nj(t.providerData,i),a=t.isAnonymous,l=!(t.email&&s.passwordHash)&&!(o!=null&&o.length),d=a?l:!1,h={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:o,metadata:new Dm(s.createdAt,s.lastLoginAt),isAnonymous:d};Object.assign(t,h)}async function tj(t){const e=Qe(t);await Ld(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function nj(t,e){return[...t.filter(r=>!e.some(s=>s.providerId===r.providerId)),...e]}function pS(t){return t.map(({providerId:e,...n})=>({providerId:e,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function rj(t,e){const n=await hS(t,{},async()=>{const r=Cc({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:i}=t.config,o=await fS(t,s,"/v1/token",`key=${i}`),a=await t._getAdditionalHeaders();a["Content-Type"]="application/x-www-form-urlencoded";const l={method:"POST",headers:a,body:r};return t.emulatorConfig&&ti(t.emulatorConfig.host)&&(l.credentials="include"),dS.fetch()(o,l)});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function sj(t,e){return ri(t,"POST","/v2/accounts:revokeToken",io(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Go{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){_e(e.idToken,"internal-error"),_e(typeof e.idToken<"u","internal-error"),_e(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Qw(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){_e(e.length!==0,"internal-error");const n=Qw(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(_e(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:s,expiresIn:i}=await rj(e,n);this.updateTokensAndExpiration(r,s,Number(i))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:s,expirationTime:i}=n,o=new Go;return r&&(_e(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),s&&(_e(typeof s=="string","internal-error",{appName:e}),o.accessToken=s),i&&(_e(typeof i=="number","internal-error",{appName:e}),o.expirationTime=i),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Go,this.toJSON())}_performRefresh(){return Br("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fs(t,e){_e(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class ar{constructor({uid:e,auth:n,stsTokenManager:r,...s}){this.providerId="firebase",this.proactiveRefresh=new ej(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=n,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new Dm(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const n=await oc(this,this.stsTokenManager.getToken(this.auth,e));return _e(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return JD(this,e)}reload(){return tj(this)}_assign(e){this!==e&&(_e(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>({...n})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new ar({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return n.metadata._copy(this.metadata),n}_onReload(e){_e(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await Ld(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(qn(this.auth.app))return Promise.reject($s(this.auth));const e=await this.getIdToken();return await oc(this,XD(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){const r=n.displayName??void 0,s=n.email??void 0,i=n.phoneNumber??void 0,o=n.photoURL??void 0,a=n.tenantId??void 0,l=n._redirectEventId??void 0,d=n.createdAt??void 0,h=n.lastLoginAt??void 0,{uid:f,emailVerified:m,isAnonymous:v,providerData:R,stsTokenManager:b}=n;_e(f&&b,e,"internal-error");const A=Go.fromJSON(this.name,b);_e(typeof f=="string",e,"internal-error"),fs(r,e.name),fs(s,e.name),_e(typeof m=="boolean",e,"internal-error"),_e(typeof v=="boolean",e,"internal-error"),fs(i,e.name),fs(o,e.name),fs(a,e.name),fs(l,e.name),fs(d,e.name),fs(h,e.name);const I=new ar({uid:f,auth:e,email:s,emailVerified:m,displayName:r,isAnonymous:v,photoURL:o,phoneNumber:i,tenantId:a,stsTokenManager:A,createdAt:d,lastLoginAt:h});return R&&Array.isArray(R)&&(I.providerData=R.map(w=>({...w}))),l&&(I._redirectEventId=l),I}static async _fromIdTokenResponse(e,n,r=!1){const s=new Go;s.updateFromServerResponse(n);const i=new ar({uid:n.localId,auth:e,stsTokenManager:s,isAnonymous:r});return await Ld(i),i}static async _fromGetAccountInfoResponse(e,n,r){const s=n.users[0];_e(s.localId!==void 0,"internal-error");const i=s.providerUserInfo!==void 0?pS(s.providerUserInfo):[],o=!(s.email&&s.passwordHash)&&!(i!=null&&i.length),a=new Go;a.updateFromIdToken(r);const l=new ar({uid:s.localId,auth:e,stsTokenManager:a,isAnonymous:o}),d={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:i,metadata:new Dm(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(i!=null&&i.length)};return Object.assign(l,d),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yw=new Map;function zr(t){es(t instanceof Function,"Expected a class definition");let e=Yw.get(t);return e?(es(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,Yw.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mS{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}mS.type="NONE";const Xw=mS;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wu(t,e,n){return`firebase:${t}:${e}:${n}`}class Qo{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:s,name:i}=this.auth;this.fullUserKey=Wu(this.userKey,s.apiKey,i),this.fullPersistenceKey=Wu("persistence",s.apiKey,i),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const n=await Vd(this.auth,{idToken:e}).catch(()=>{});return n?ar._fromGetAccountInfoResponse(this.auth,n,e):null}return ar._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new Qo(zr(Xw),e,r);const s=(await Promise.all(n.map(async d=>{if(await d._isAvailable())return d}))).filter(d=>d);let i=s[0]||zr(Xw);const o=Wu(r,e.config.apiKey,e.name);let a=null;for(const d of n)try{const h=await d._get(o);if(h){let f;if(typeof h=="string"){const m=await Vd(e,{idToken:h}).catch(()=>{});if(!m)break;f=await ar._fromGetAccountInfoResponse(e,m,h)}else f=ar._fromJSON(e,h);d!==i&&(a=f),i=d;break}}catch{}const l=s.filter(d=>d._shouldAllowMigration);return!i._shouldAllowMigration||!l.length?new Qo(i,e,r):(i=l[0],a&&await i._set(o,a.toJSON()),await Promise.all(n.map(async d=>{if(d!==i)try{await d._remove(o)}catch{}})),new Qo(i,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Jw(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(vS(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(gS(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(ES(e))return"Blackberry";if(IS(e))return"Webos";if(yS(e))return"Safari";if((e.includes("chrome/")||_S(e))&&!e.includes("edge/"))return"Chrome";if(wS(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function gS(t=Vt()){return/firefox\//i.test(t)}function yS(t=Vt()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function _S(t=Vt()){return/crios\//i.test(t)}function vS(t=Vt()){return/iemobile/i.test(t)}function wS(t=Vt()){return/android/i.test(t)}function ES(t=Vt()){return/blackberry/i.test(t)}function IS(t=Vt()){return/webos/i.test(t)}function _y(t=Vt()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function ij(t=Vt()){var e;return _y(t)&&!!((e=window.navigator)!=null&&e.standalone)}function oj(){return yN()&&document.documentMode===10}function TS(t=Vt()){return _y(t)||wS(t)||IS(t)||ES(t)||/windows phone/i.test(t)||vS(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xS(t,e=[]){let n;switch(t){case"Browser":n=Jw(Vt());break;case"Worker":n=`${Jw(Vt())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${so}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aj{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=i=>new Promise((o,a)=>{try{const l=e(i);o(l)}catch(l){a(l)}});r.onAbort=n,this.queue.push(r);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const s of n)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function lj(t,e={}){return ri(t,"GET","/v2/passwordPolicy",io(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cj=6;class uj{constructor(e){var r;const n=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=n.minPasswordLength??cj,n.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=n.maxPasswordLength),n.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=n.containsLowercaseCharacter),n.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=n.containsUppercaseCharacter),n.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=n.containsNumericCharacter),n.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=n.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=((r=e.allowedNonAlphanumericCharacters)==null?void 0:r.join(""))??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const n={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,n),this.validatePasswordCharacterOptions(e,n),n.isValid&&(n.isValid=n.meetsMinPasswordLength??!0),n.isValid&&(n.isValid=n.meetsMaxPasswordLength??!0),n.isValid&&(n.isValid=n.containsLowercaseLetter??!0),n.isValid&&(n.isValid=n.containsUppercaseLetter??!0),n.isValid&&(n.isValid=n.containsNumericCharacter??!0),n.isValid&&(n.isValid=n.containsNonAlphanumericCharacter??!0),n}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),s&&(n.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let s=0;s<e.length;s++)r=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,s,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dj{constructor(e,n,r,s){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Zw(this),this.idTokenSubscription=new Zw(this),this.beforeStateQueue=new aj(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=cS,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion,this._persistenceManagerAvailable=new Promise(i=>this._resolvePersistenceManagerAvailable=i)}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=zr(n)),this._initializationPromise=this.queue(async()=>{var r,s,i;if(!this._deleted&&(this.persistenceManager=await Qo.create(this,e),(r=this._resolvePersistenceManagerAvailable)==null||r.call(this),!this._deleted)){if((s=this._popupRedirectResolver)!=null&&s._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((i=this.currentUser)==null?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await Vd(this,{idToken:e}),r=await ar._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(r)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var i;if(qn(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(a,a))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let r=n,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(i=this.redirectUser)==null?void 0:i._redirectEventId,a=r==null?void 0:r._redirectEventId,l=await this.tryRedirectSignIn(e);(!o||o===a)&&(l!=null&&l.user)&&(r=l.user,s=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(r)}catch(o){r=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return _e(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await Ld(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=zD()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(qn(this.app))return Promise.reject($s(this));const n=e?Qe(e):null;return n&&_e(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&_e(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return qn(this.app)?Promise.reject($s(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return qn(this.app)?Promise.reject($s(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(zr(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await lj(this),n=new uj(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new ro("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),await sj(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)==null?void 0:e.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&zr(e)||this._popupRedirectResolver;_e(n,this,"argument-error"),this.redirectPersistenceManager=await Qo.create(this,[zr(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)==null?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)==null?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=((n=this.currentUser)==null?void 0:n.uid)??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,s){if(this._deleted)return()=>{};const i=typeof n=="function"?n:n.next.bind(n);let o=!1;const a=this._isInitialized?Promise.resolve():this._initializationPromise;if(_e(a,this,"internal-error"),a.then(()=>{o||i(this.currentUser)}),typeof n=="function"){const l=e.addObserver(n,r,s);return()=>{o=!0,l()}}else{const l=e.addObserver(n);return()=>{o=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return _e(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=xS(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var s;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const n=await((s=this.heartbeatServiceProvider.getImmediate({optional:!0}))==null?void 0:s.getHeartbeatsHeader());n&&(e["X-Firebase-Client"]=n);const r=await this._getAppCheckToken();return r&&(e["X-Firebase-AppCheck"]=r),e}async _getAppCheckToken(){var n;if(qn(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await((n=this.appCheckServiceProvider.getImmediate({optional:!0}))==null?void 0:n.getToken());return e!=null&&e.error&&UD(`Error while retrieving App Check token: ${e.error}`),e==null?void 0:e.token}}function Ra(t){return Qe(t)}class Zw{constructor(e){this.auth=e,this.observer=null,this.addObserver=TN(n=>this.observer=n)}get next(){return _e(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Nh={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function hj(t){Nh=t}function SS(t){return Nh.loadJS(t)}function fj(){return Nh.recaptchaEnterpriseScript}function pj(){return Nh.gapiScript}function mj(t){return`__${t}${Math.floor(Math.random()*1e6)}`}class gj{constructor(){this.enterprise=new yj}ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}class yj{ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}const _j="recaptcha-enterprise",bS="NO_RECAPTCHA";class vj{constructor(e){this.type=_j,this.auth=Ra(e)}async verify(e="verify",n=!1){async function r(i){if(!n){if(i.tenantId==null&&i._agentRecaptchaConfig!=null)return i._agentRecaptchaConfig.siteKey;if(i.tenantId!=null&&i._tenantRecaptchaConfigs[i.tenantId]!==void 0)return i._tenantRecaptchaConfigs[i.tenantId].siteKey}return new Promise(async(o,a)=>{YD(i,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(l=>{if(l.recaptchaKey===void 0)a(new Error("recaptcha Enterprise site key undefined"));else{const d=new QD(l);return i.tenantId==null?i._agentRecaptchaConfig=d:i._tenantRecaptchaConfigs[i.tenantId]=d,o(d.siteKey)}}).catch(l=>{a(l)})})}function s(i,o,a){const l=window.grecaptcha;Gw(l)?l.enterprise.ready(()=>{l.enterprise.execute(i,{action:e}).then(d=>{o(d)}).catch(()=>{o(bS)})}):a(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new gj().execute("siteKey",{action:"verify"}):new Promise((i,o)=>{r(this.auth).then(a=>{if(!n&&Gw(window.grecaptcha))s(a,i,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let l=fj();l.length!==0&&(l+=a),SS(l).then(()=>{s(a,i,o)}).catch(d=>{o(d)})}}).catch(a=>{o(a)})})}}async function eE(t,e,n,r=!1,s=!1){const i=new vj(t);let o;if(s)o=bS;else try{o=await i.verify(n)}catch{o=await i.verify(n,!0)}const a={...e};if(n==="mfaSmsEnrollment"||n==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in a){const l=a.phoneEnrollmentInfo.phoneNumber,d=a.phoneEnrollmentInfo.recaptchaToken;Object.assign(a,{phoneEnrollmentInfo:{phoneNumber:l,recaptchaToken:d,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in a){const l=a.phoneSignInInfo.recaptchaToken;Object.assign(a,{phoneSignInInfo:{recaptchaToken:l,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return a}return r?Object.assign(a,{captchaResp:o}):Object.assign(a,{captchaResponse:o}),Object.assign(a,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(a,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),a}async function tE(t,e,n,r,s){var i;if((i=t._getRecaptchaConfig())!=null&&i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const o=await eE(t,e,n,n==="getOobCode");return r(t,o)}else return r(t,e).catch(async o=>{if(o.code==="auth/missing-recaptcha-token"){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const a=await eE(t,e,n,n==="getOobCode");return r(t,a)}else return Promise.reject(o)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wj(t,e){const n=ni(t,"auth");if(n.isInitialized()){const s=n.getImmediate(),i=n.getOptions();if(Jr(i,e??{}))return s;fr(s,"already-initialized")}return n.initialize({options:e})}function Ej(t,e){const n=(e==null?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(zr);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function Ij(t,e,n){const r=Ra(t);_e(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const s=!1,i=CS(e),{host:o,port:a}=Tj(e),l=a===null?"":`:${a}`,d={url:`${i}//${o}${l}/`},h=Object.freeze({host:o,port:a,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:s})});if(!r._canInitEmulator){_e(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),_e(Jr(d,r.config.emulator)&&Jr(h,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=d,r.emulatorConfig=h,r.settings.appVerificationDisabledForTesting=!0,ti(o)?(uy(`${i}//${o}${l}`),dy("Auth",!0)):xj()}function CS(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function Tj(t){const e=CS(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(r);if(s){const i=s[1];return{host:i,port:nE(r.substr(i.length+1))}}else{const[i,o]=r.split(":");return{host:i,port:nE(o)}}}function nE(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function xj(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vy{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return Br("not implemented")}_getIdTokenResponse(e){return Br("not implemented")}_linkToIdToken(e,n){return Br("not implemented")}_getReauthenticationResolver(e){return Br("not implemented")}}async function Sj(t,e){return ri(t,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function bj(t,e){return kh(t,"POST","/v1/accounts:signInWithPassword",io(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Cj(t,e){return kh(t,"POST","/v1/accounts:signInWithEmailLink",io(t,e))}async function Aj(t,e){return kh(t,"POST","/v1/accounts:signInWithEmailLink",io(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ac extends vy{constructor(e,n,r,s=null){super("password",r),this._email=e,this._password=n,this._tenantId=s}static _fromEmailAndPassword(e,n){return new ac(e,n,"password")}static _fromEmailAndCode(e,n,r=null){return new ac(e,n,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;if(n!=null&&n.email&&(n!=null&&n.password)){if(n.signInMethod==="password")return this._fromEmailAndPassword(n.email,n.password);if(n.signInMethod==="emailLink")return this._fromEmailAndCode(n.email,n.password,n.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const n={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return tE(e,n,"signInWithPassword",bj);case"emailLink":return Cj(e,{email:this._email,oobCode:this._password});default:fr(e,"internal-error")}}async _linkToIdToken(e,n){switch(this.signInMethod){case"password":const r={idToken:n,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return tE(e,r,"signUpPassword",Sj);case"emailLink":return Aj(e,{idToken:n,email:this._email,oobCode:this._password});default:fr(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Yo(t,e){return kh(t,"POST","/v1/accounts:signInWithIdp",io(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rj="http://localhost";class $i extends vy{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new $i(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):fr("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:s,...i}=n;if(!r||!s)return null;const o=new $i(r,s);return o.idToken=i.idToken||void 0,o.accessToken=i.accessToken||void 0,o.secret=i.secret,o.nonce=i.nonce,o.pendingToken=i.pendingToken||null,o}_getIdTokenResponse(e){const n=this.buildRequest();return Yo(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,Yo(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,Yo(e,n)}buildRequest(){const e={requestUri:Rj,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=Cc(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pj(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function kj(t){const e=fl(pl(t)).link,n=e?fl(pl(e)).deep_link_id:null,r=fl(pl(t)).deep_link_id;return(r?fl(pl(r)).link:null)||r||n||e||t}class wy{constructor(e){const n=fl(pl(e)),r=n.apiKey??null,s=n.oobCode??null,i=Pj(n.mode??null);_e(r&&s&&i,"argument-error"),this.apiKey=r,this.operation=i,this.code=s,this.continueUrl=n.continueUrl??null,this.languageCode=n.lang??null,this.tenantId=n.tenantId??null}static parseLink(e){const n=kj(e);try{return new wy(n)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pa{constructor(){this.providerId=Pa.PROVIDER_ID}static credential(e,n){return ac._fromEmailAndPassword(e,n)}static credentialWithLink(e,n){const r=wy.parseLink(n);return _e(r,"argument-error"),ac._fromEmailAndCode(e,r.code,r.tenantId)}}Pa.PROVIDER_ID="password";Pa.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Pa.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AS{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rc extends AS{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Es extends Rc{constructor(){super("facebook.com")}static credential(e){return $i._fromParams({providerId:Es.PROVIDER_ID,signInMethod:Es.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Es.credentialFromTaggedObject(e)}static credentialFromError(e){return Es.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Es.credential(e.oauthAccessToken)}catch{return null}}}Es.FACEBOOK_SIGN_IN_METHOD="facebook.com";Es.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Is extends Rc{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return $i._fromParams({providerId:Is.PROVIDER_ID,signInMethod:Is.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return Is.credentialFromTaggedObject(e)}static credentialFromError(e){return Is.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return Is.credential(n,r)}catch{return null}}}Is.GOOGLE_SIGN_IN_METHOD="google.com";Is.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ts extends Rc{constructor(){super("github.com")}static credential(e){return $i._fromParams({providerId:Ts.PROVIDER_ID,signInMethod:Ts.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ts.credentialFromTaggedObject(e)}static credentialFromError(e){return Ts.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ts.credential(e.oauthAccessToken)}catch{return null}}}Ts.GITHUB_SIGN_IN_METHOD="github.com";Ts.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xs extends Rc{constructor(){super("twitter.com")}static credential(e,n){return $i._fromParams({providerId:xs.PROVIDER_ID,signInMethod:xs.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return xs.credentialFromTaggedObject(e)}static credentialFromError(e){return xs.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return xs.credential(n,r)}catch{return null}}}xs.TWITTER_SIGN_IN_METHOD="twitter.com";xs.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ca{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,s=!1){const i=await ar._fromIdTokenResponse(e,r,s),o=rE(r);return new ca({user:i,providerId:o,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const s=rE(r);return new ca({user:e,providerId:s,_tokenResponse:r,operationType:n})}}function rE(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Md extends er{constructor(e,n,r,s){super(n.code,n.message),this.operationType=r,this.user=s,Object.setPrototypeOf(this,Md.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,s){return new Md(e,n,r,s)}}function RS(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?Md._fromErrorAndOperation(t,i,e,r):i})}async function Nj(t,e,n=!1){const r=await oc(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return ca._forOperation(t,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Dj(t,e,n=!1){const{auth:r}=t;if(qn(r.app))return Promise.reject($s(r));const s="reauthenticate";try{const i=await oc(t,RS(r,s,e,t),n);_e(i.idToken,r,"internal-error");const o=yy(i.idToken);_e(o,r,"internal-error");const{sub:a}=o;return _e(t.uid===a,r,"user-mismatch"),ca._forOperation(t,s,i)}catch(i){throw(i==null?void 0:i.code)==="auth/user-not-found"&&fr(r,"user-mismatch"),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function PS(t,e,n=!1){if(qn(t.app))return Promise.reject($s(t));const r="signIn",s=await RS(t,r,e),i=await ca._fromIdTokenResponse(t,r,s);return n||await t._updateCurrentUser(i.user),i}async function jj(t,e){return PS(Ra(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Oj(t){const e=Ra(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}function Vj(t,e,n){return qn(t.app)?Promise.reject($s(t)):jj(Qe(t),Pa.credential(e,n)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&Oj(t),r})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lj(t,e){return Qe(t).setPersistence(e)}function Mj(t,e,n,r){return Qe(t).onIdTokenChanged(e,n,r)}function Fj(t,e,n){return Qe(t).beforeAuthStateChanged(e,n)}function Ey(t,e,n,r){return Qe(t).onAuthStateChanged(e,n,r)}function Uj(t){return Qe(t).signOut()}const Fd="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kS{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(Fd,"1"),this.storage.removeItem(Fd),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $j=1e3,Bj=10;class NS extends kS{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=TS(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),s=this.localCache[n];r!==s&&e(n,s,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((o,a,l)=>{this.notifyListeners(o,l)});return}const r=e.key;n?this.detachListener():this.stopPolling();const s=()=>{const o=this.storage.getItem(r);!n&&this.localCache[r]===o||this.notifyListeners(r,o)},i=this.storage.getItem(r);oj()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,Bj):s()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},$j)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}NS.type="LOCAL";const DS=NS;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jS extends kS{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}jS.type="SESSION";const OS=jS;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zj(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dh{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(s=>s.isListeningto(e));if(n)return n;const r=new Dh(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:s,data:i}=n.data,o=this.handlersMap[s];if(!(o!=null&&o.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:s});const a=Array.from(o).map(async d=>d(n.origin,i)),l=await zj(a);n.ports[0].postMessage({status:"done",eventId:r,eventType:s,response:l})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Dh.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Iy(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qj{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let i,o;return new Promise((a,l)=>{const d=Iy("",20);s.port1.start();const h=setTimeout(()=>{l(new Error("unsupported_event"))},r);o={messageChannel:s,onMessage(f){const m=f;if(m.data.eventId===d)switch(m.data.status){case"ack":clearTimeout(h),i=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),a(m.data.response);break;default:clearTimeout(h),clearTimeout(i),l(new Error("invalid_response"));break}}},this.handlers.add(o),s.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:d,data:n},[s.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nr(){return window}function Hj(t){Nr().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VS(){return typeof Nr().WorkerGlobalScope<"u"&&typeof Nr().importScripts=="function"}async function Wj(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function Kj(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)==null?void 0:t.controller)||null}function Gj(){return VS()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LS="firebaseLocalStorageDb",Qj=1,Ud="firebaseLocalStorage",MS="fbase_key";class Pc{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function jh(t,e){return t.transaction([Ud],e?"readwrite":"readonly").objectStore(Ud)}function Yj(){const t=indexedDB.deleteDatabase(LS);return new Pc(t).toPromise()}function jm(){const t=indexedDB.open(LS,Qj);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(Ud,{keyPath:MS})}catch(s){n(s)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(Ud)?e(r):(r.close(),await Yj(),e(await jm()))})})}async function sE(t,e,n){const r=jh(t,!0).put({[MS]:e,value:n});return new Pc(r).toPromise()}async function Xj(t,e){const n=jh(t,!1).get(e),r=await new Pc(n).toPromise();return r===void 0?null:r.value}function iE(t,e){const n=jh(t,!0).delete(e);return new Pc(n).toPromise()}const Jj=800,Zj=3;class FS{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await jm(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>Zj)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return VS()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Dh._getInstance(Gj()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var n,r;if(this.activeServiceWorker=await Wj(),!this.activeServiceWorker)return;this.sender=new qj(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&(n=e[0])!=null&&n.fulfilled&&(r=e[0])!=null&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||Kj()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await jm();return await sE(e,Fd,"1"),await iE(e,Fd),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>sE(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>Xj(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>iE(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const i=jh(s,!1).getAll();return new Pc(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;if(e.length!==0)for(const{fbase_key:s,value:i}of e)r.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(i)&&(this.notifyListeners(s,i),n.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!r.has(s)&&(this.notifyListeners(s,null),n.push(s));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),Jj)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}FS.type="LOCAL";const e2=FS;new Ac(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function t2(t,e){return e?zr(e):(_e(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ty extends vy{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Yo(e,this._buildIdpRequest())}_linkToIdToken(e,n){return Yo(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return Yo(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function n2(t){return PS(t.auth,new Ty(t),t.bypassAuthState)}function r2(t){const{auth:e,user:n}=t;return _e(n,e,"internal-error"),Dj(n,new Ty(t),t.bypassAuthState)}async function s2(t){const{auth:e,user:n}=t;return _e(n,e,"internal-error"),Nj(n,new Ty(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class US{constructor(e,n,r,s,i=!1){this.auth=e,this.resolver=r,this.user=s,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:s,tenantId:i,error:o,type:a}=e;if(o){this.reject(o);return}const l={auth:this.auth,requestUri:n,sessionId:r,tenantId:i||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(l))}catch(d){this.reject(d)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return n2;case"linkViaPopup":case"linkViaRedirect":return s2;case"reauthViaPopup":case"reauthViaRedirect":return r2;default:fr(this.auth,"internal-error")}}resolve(e){es(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){es(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const i2=new Ac(2e3,1e4);class $o extends US{constructor(e,n,r,s,i){super(e,n,s,i),this.provider=r,this.authWindow=null,this.pollId=null,$o.currentPopupAction&&$o.currentPopupAction.cancel(),$o.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return _e(e,this.auth,"internal-error"),e}async onExecution(){es(this.filter.length===1,"Popup operations only handle one event");const e=Iy();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(kr(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)==null?void 0:e.associatedEvent)||null}cancel(){this.reject(kr(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,$o.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,r;if((r=(n=this.authWindow)==null?void 0:n.window)!=null&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(kr(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,i2.get())};e()}}$o.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const o2="pendingRedirect",Ku=new Map;class a2 extends US{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=Ku.get(this.auth._key());if(!e){try{const r=await l2(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}Ku.set(this.auth._key(),e)}return this.bypassAuthState||Ku.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function l2(t,e){const n=d2(e),r=u2(t);if(!await r._isAvailable())return!1;const s=await r._get(n)==="true";return await r._remove(n),s}function c2(t,e){Ku.set(t._key(),e)}function u2(t){return zr(t._redirectPersistence)}function d2(t){return Wu(o2,t.config.apiKey,t.name)}async function h2(t,e,n=!1){if(qn(t.app))return Promise.reject($s(t));const r=Ra(t),s=t2(r,e),o=await new a2(r,s,n).execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const f2=10*60*1e3;class p2{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!m2(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!$S(e)){const s=((r=e.error.code)==null?void 0:r.split("auth/")[1])||"internal-error";n.onError(kr(this.auth,s))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=f2&&this.cachedEventUids.clear(),this.cachedEventUids.has(oE(e))}saveEventToCache(e){this.cachedEventUids.add(oE(e)),this.lastProcessedEventTime=Date.now()}}function oE(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function $S({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function m2(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return $S(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function g2(t,e={}){return ri(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const y2=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,_2=/^https?/;async function v2(t){if(t.config.emulator)return;const{authorizedDomains:e}=await g2(t);for(const n of e)try{if(w2(n))return}catch{}fr(t,"unauthorized-domain")}function w2(t){const e=Nm(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&o.hostname===r}if(!_2.test(n))return!1;if(y2.test(t))return r===t;const s=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const E2=new Ac(3e4,6e4);function aE(){const t=Nr().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function I2(t){return new Promise((e,n)=>{var s,i,o;function r(){aE(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{aE(),n(kr(t,"network-request-failed"))},timeout:E2.get()})}if((i=(s=Nr().gapi)==null?void 0:s.iframes)!=null&&i.Iframe)e(gapi.iframes.getContext());else if((o=Nr().gapi)!=null&&o.load)r();else{const a=mj("iframefcb");return Nr()[a]=()=>{gapi.load?r():n(kr(t,"network-request-failed"))},SS(`${pj()}?onload=${a}`).catch(l=>n(l))}}).catch(e=>{throw Gu=null,e})}let Gu=null;function T2(t){return Gu=Gu||I2(t),Gu}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const x2=new Ac(5e3,15e3),S2="__/auth/iframe",b2="emulator/auth/iframe",C2={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},A2=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function R2(t){const e=t.config;_e(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?gy(e,b2):`https://${t.config.authDomain}/${S2}`,r={apiKey:e.apiKey,appName:t.name,v:so},s=A2.get(t.config.apiHost);s&&(r.eid=s);const i=t._getFrameworks();return i.length&&(r.fw=i.join(",")),`${n}?${Cc(r).slice(1)}`}async function P2(t){const e=await T2(t),n=Nr().gapi;return _e(n,t,"internal-error"),e.open({where:document.body,url:R2(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:C2,dontclear:!0},r=>new Promise(async(s,i)=>{await r.restyle({setHideOnLeave:!1});const o=kr(t,"network-request-failed"),a=Nr().setTimeout(()=>{i(o)},x2.get());function l(){Nr().clearTimeout(a),s(r)}r.ping(l).then(l,()=>{i(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const k2={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},N2=500,D2=600,j2="_blank",O2="http://localhost";class lE{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function V2(t,e,n,r=N2,s=D2){const i=Math.max((window.screen.availHeight-s)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let a="";const l={...k2,width:r.toString(),height:s.toString(),top:i,left:o},d=Vt().toLowerCase();n&&(a=_S(d)?j2:n),gS(d)&&(e=e||O2,l.scrollbars="yes");const h=Object.entries(l).reduce((m,[v,R])=>`${m}${v}=${R},`,"");if(ij(d)&&a!=="_self")return L2(e||"",a),new lE(null);const f=window.open(e||"",a,h);_e(f,t,"popup-blocked");try{f.focus()}catch{}return new lE(f)}function L2(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const M2="__/auth/handler",F2="emulator/auth/handler",U2=encodeURIComponent("fac");async function cE(t,e,n,r,s,i){_e(t.config.authDomain,t,"auth-domain-config-required"),_e(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:so,eventId:s};if(e instanceof AS){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",IN(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[h,f]of Object.entries({}))o[h]=f}if(e instanceof Rc){const h=e.getScopes().filter(f=>f!=="");h.length>0&&(o.scopes=h.join(","))}t.tenantId&&(o.tid=t.tenantId);const a=o;for(const h of Object.keys(a))a[h]===void 0&&delete a[h];const l=await t._getAppCheckToken(),d=l?`#${U2}=${encodeURIComponent(l)}`:"";return`${$2(t)}?${Cc(a).slice(1)}${d}`}function $2({config:t}){return t.emulator?gy(t,F2):`https://${t.authDomain}/${M2}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dp="webStorageSupport";class B2{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=OS,this._completeRedirectFn=h2,this._overrideRedirectResult=c2}async _openPopup(e,n,r,s){var o;es((o=this.eventManagers[e._key()])==null?void 0:o.manager,"_initialize() not called before _openPopup()");const i=await cE(e,n,r,Nm(),s);return V2(e,i,Iy())}async _openRedirect(e,n,r,s){await this._originValidation(e);const i=await cE(e,n,r,Nm(),s);return Hj(i),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:s,promise:i}=this.eventManagers[n];return s?Promise.resolve(s):(es(i,"If manager is not set, promise should be"),i)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await P2(e),r=new p2(e);return n.register("authEvent",s=>(_e(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:r.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(dp,{type:dp},s=>{var o;const i=(o=s==null?void 0:s[0])==null?void 0:o[dp];i!==void 0&&n(!!i),fr(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=v2(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return TS()||yS()||_y()}}const z2=B2;var uE="@firebase/auth",dE="1.11.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q2{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)==null?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){_e(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function H2(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function W2(t){hr(new Zn("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=r.options;_e(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const l={apiKey:o,authDomain:a,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:xS(t)},d=new dj(r,s,i,l);return Ej(d,n),d},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),hr(new Zn("auth-internal",e=>{const n=Ra(e.getProvider("auth").getImmediate());return(r=>new q2(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),Rn(uE,dE,H2(t)),Rn(uE,dE,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const K2=5*60,G2=Yx("authIdTokenMaxAge")||K2;let hE=null;const Q2=t=>async e=>{const n=e&&await e.getIdTokenResult(),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>G2)return;const s=n==null?void 0:n.token;hE!==s&&(hE=s,await fetch(t,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function BS(t=Ph()){const e=ni(t,"auth");if(e.isInitialized())return e.getImmediate();const n=wj(t,{popupRedirectResolver:z2,persistence:[e2,DS,OS]}),r=Yx("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(r,location.origin);if(location.origin===i.origin){const o=Q2(i.toString());Fj(n,o,()=>o(n.currentUser)),Mj(n,a=>o(a))}}const s=Kx("auth");return s&&Ij(n,`http://${s}`),n}function Y2(){var t;return((t=document.getElementsByTagName("head"))==null?void 0:t[0])??document}hj({loadJS(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=s=>{const i=kr("internal-error");i.customData=s,n(i)},r.type="text/javascript",r.charset="UTF-8",Y2().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});W2("Browser");var fE=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Bs,zS;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(T,_){function S(){}S.prototype=_.prototype,T.F=_.prototype,T.prototype=new S,T.prototype.constructor=T,T.D=function(C,N,D){for(var P=Array(arguments.length-2),Y=2;Y<arguments.length;Y++)P[Y-2]=arguments[Y];return _.prototype[N].apply(C,P)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(r,n),r.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(T,_,S){S||(S=0);const C=Array(16);if(typeof _=="string")for(var N=0;N<16;++N)C[N]=_.charCodeAt(S++)|_.charCodeAt(S++)<<8|_.charCodeAt(S++)<<16|_.charCodeAt(S++)<<24;else for(N=0;N<16;++N)C[N]=_[S++]|_[S++]<<8|_[S++]<<16|_[S++]<<24;_=T.g[0],S=T.g[1],N=T.g[2];let D=T.g[3],P;P=_+(D^S&(N^D))+C[0]+3614090360&4294967295,_=S+(P<<7&4294967295|P>>>25),P=D+(N^_&(S^N))+C[1]+3905402710&4294967295,D=_+(P<<12&4294967295|P>>>20),P=N+(S^D&(_^S))+C[2]+606105819&4294967295,N=D+(P<<17&4294967295|P>>>15),P=S+(_^N&(D^_))+C[3]+3250441966&4294967295,S=N+(P<<22&4294967295|P>>>10),P=_+(D^S&(N^D))+C[4]+4118548399&4294967295,_=S+(P<<7&4294967295|P>>>25),P=D+(N^_&(S^N))+C[5]+1200080426&4294967295,D=_+(P<<12&4294967295|P>>>20),P=N+(S^D&(_^S))+C[6]+2821735955&4294967295,N=D+(P<<17&4294967295|P>>>15),P=S+(_^N&(D^_))+C[7]+4249261313&4294967295,S=N+(P<<22&4294967295|P>>>10),P=_+(D^S&(N^D))+C[8]+1770035416&4294967295,_=S+(P<<7&4294967295|P>>>25),P=D+(N^_&(S^N))+C[9]+2336552879&4294967295,D=_+(P<<12&4294967295|P>>>20),P=N+(S^D&(_^S))+C[10]+4294925233&4294967295,N=D+(P<<17&4294967295|P>>>15),P=S+(_^N&(D^_))+C[11]+2304563134&4294967295,S=N+(P<<22&4294967295|P>>>10),P=_+(D^S&(N^D))+C[12]+1804603682&4294967295,_=S+(P<<7&4294967295|P>>>25),P=D+(N^_&(S^N))+C[13]+4254626195&4294967295,D=_+(P<<12&4294967295|P>>>20),P=N+(S^D&(_^S))+C[14]+2792965006&4294967295,N=D+(P<<17&4294967295|P>>>15),P=S+(_^N&(D^_))+C[15]+1236535329&4294967295,S=N+(P<<22&4294967295|P>>>10),P=_+(N^D&(S^N))+C[1]+4129170786&4294967295,_=S+(P<<5&4294967295|P>>>27),P=D+(S^N&(_^S))+C[6]+3225465664&4294967295,D=_+(P<<9&4294967295|P>>>23),P=N+(_^S&(D^_))+C[11]+643717713&4294967295,N=D+(P<<14&4294967295|P>>>18),P=S+(D^_&(N^D))+C[0]+3921069994&4294967295,S=N+(P<<20&4294967295|P>>>12),P=_+(N^D&(S^N))+C[5]+3593408605&4294967295,_=S+(P<<5&4294967295|P>>>27),P=D+(S^N&(_^S))+C[10]+38016083&4294967295,D=_+(P<<9&4294967295|P>>>23),P=N+(_^S&(D^_))+C[15]+3634488961&4294967295,N=D+(P<<14&4294967295|P>>>18),P=S+(D^_&(N^D))+C[4]+3889429448&4294967295,S=N+(P<<20&4294967295|P>>>12),P=_+(N^D&(S^N))+C[9]+568446438&4294967295,_=S+(P<<5&4294967295|P>>>27),P=D+(S^N&(_^S))+C[14]+3275163606&4294967295,D=_+(P<<9&4294967295|P>>>23),P=N+(_^S&(D^_))+C[3]+4107603335&4294967295,N=D+(P<<14&4294967295|P>>>18),P=S+(D^_&(N^D))+C[8]+1163531501&4294967295,S=N+(P<<20&4294967295|P>>>12),P=_+(N^D&(S^N))+C[13]+2850285829&4294967295,_=S+(P<<5&4294967295|P>>>27),P=D+(S^N&(_^S))+C[2]+4243563512&4294967295,D=_+(P<<9&4294967295|P>>>23),P=N+(_^S&(D^_))+C[7]+1735328473&4294967295,N=D+(P<<14&4294967295|P>>>18),P=S+(D^_&(N^D))+C[12]+2368359562&4294967295,S=N+(P<<20&4294967295|P>>>12),P=_+(S^N^D)+C[5]+4294588738&4294967295,_=S+(P<<4&4294967295|P>>>28),P=D+(_^S^N)+C[8]+2272392833&4294967295,D=_+(P<<11&4294967295|P>>>21),P=N+(D^_^S)+C[11]+1839030562&4294967295,N=D+(P<<16&4294967295|P>>>16),P=S+(N^D^_)+C[14]+4259657740&4294967295,S=N+(P<<23&4294967295|P>>>9),P=_+(S^N^D)+C[1]+2763975236&4294967295,_=S+(P<<4&4294967295|P>>>28),P=D+(_^S^N)+C[4]+1272893353&4294967295,D=_+(P<<11&4294967295|P>>>21),P=N+(D^_^S)+C[7]+4139469664&4294967295,N=D+(P<<16&4294967295|P>>>16),P=S+(N^D^_)+C[10]+3200236656&4294967295,S=N+(P<<23&4294967295|P>>>9),P=_+(S^N^D)+C[13]+681279174&4294967295,_=S+(P<<4&4294967295|P>>>28),P=D+(_^S^N)+C[0]+3936430074&4294967295,D=_+(P<<11&4294967295|P>>>21),P=N+(D^_^S)+C[3]+3572445317&4294967295,N=D+(P<<16&4294967295|P>>>16),P=S+(N^D^_)+C[6]+76029189&4294967295,S=N+(P<<23&4294967295|P>>>9),P=_+(S^N^D)+C[9]+3654602809&4294967295,_=S+(P<<4&4294967295|P>>>28),P=D+(_^S^N)+C[12]+3873151461&4294967295,D=_+(P<<11&4294967295|P>>>21),P=N+(D^_^S)+C[15]+530742520&4294967295,N=D+(P<<16&4294967295|P>>>16),P=S+(N^D^_)+C[2]+3299628645&4294967295,S=N+(P<<23&4294967295|P>>>9),P=_+(N^(S|~D))+C[0]+4096336452&4294967295,_=S+(P<<6&4294967295|P>>>26),P=D+(S^(_|~N))+C[7]+1126891415&4294967295,D=_+(P<<10&4294967295|P>>>22),P=N+(_^(D|~S))+C[14]+2878612391&4294967295,N=D+(P<<15&4294967295|P>>>17),P=S+(D^(N|~_))+C[5]+4237533241&4294967295,S=N+(P<<21&4294967295|P>>>11),P=_+(N^(S|~D))+C[12]+1700485571&4294967295,_=S+(P<<6&4294967295|P>>>26),P=D+(S^(_|~N))+C[3]+2399980690&4294967295,D=_+(P<<10&4294967295|P>>>22),P=N+(_^(D|~S))+C[10]+4293915773&4294967295,N=D+(P<<15&4294967295|P>>>17),P=S+(D^(N|~_))+C[1]+2240044497&4294967295,S=N+(P<<21&4294967295|P>>>11),P=_+(N^(S|~D))+C[8]+1873313359&4294967295,_=S+(P<<6&4294967295|P>>>26),P=D+(S^(_|~N))+C[15]+4264355552&4294967295,D=_+(P<<10&4294967295|P>>>22),P=N+(_^(D|~S))+C[6]+2734768916&4294967295,N=D+(P<<15&4294967295|P>>>17),P=S+(D^(N|~_))+C[13]+1309151649&4294967295,S=N+(P<<21&4294967295|P>>>11),P=_+(N^(S|~D))+C[4]+4149444226&4294967295,_=S+(P<<6&4294967295|P>>>26),P=D+(S^(_|~N))+C[11]+3174756917&4294967295,D=_+(P<<10&4294967295|P>>>22),P=N+(_^(D|~S))+C[2]+718787259&4294967295,N=D+(P<<15&4294967295|P>>>17),P=S+(D^(N|~_))+C[9]+3951481745&4294967295,T.g[0]=T.g[0]+_&4294967295,T.g[1]=T.g[1]+(N+(P<<21&4294967295|P>>>11))&4294967295,T.g[2]=T.g[2]+N&4294967295,T.g[3]=T.g[3]+D&4294967295}r.prototype.v=function(T,_){_===void 0&&(_=T.length);const S=_-this.blockSize,C=this.C;let N=this.h,D=0;for(;D<_;){if(N==0)for(;D<=S;)s(this,T,D),D+=this.blockSize;if(typeof T=="string"){for(;D<_;)if(C[N++]=T.charCodeAt(D++),N==this.blockSize){s(this,C),N=0;break}}else for(;D<_;)if(C[N++]=T[D++],N==this.blockSize){s(this,C),N=0;break}}this.h=N,this.o+=_},r.prototype.A=function(){var T=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);T[0]=128;for(var _=1;_<T.length-8;++_)T[_]=0;_=this.o*8;for(var S=T.length-8;S<T.length;++S)T[S]=_&255,_/=256;for(this.v(T),T=Array(16),_=0,S=0;S<4;++S)for(let C=0;C<32;C+=8)T[_++]=this.g[S]>>>C&255;return T};function i(T,_){var S=a;return Object.prototype.hasOwnProperty.call(S,T)?S[T]:S[T]=_(T)}function o(T,_){this.h=_;const S=[];let C=!0;for(let N=T.length-1;N>=0;N--){const D=T[N]|0;C&&D==_||(S[N]=D,C=!1)}this.g=S}var a={};function l(T){return-128<=T&&T<128?i(T,function(_){return new o([_|0],_<0?-1:0)}):new o([T|0],T<0?-1:0)}function d(T){if(isNaN(T)||!isFinite(T))return f;if(T<0)return A(d(-T));const _=[];let S=1;for(let C=0;T>=S;C++)_[C]=T/S|0,S*=4294967296;return new o(_,0)}function h(T,_){if(T.length==0)throw Error("number format error: empty string");if(_=_||10,_<2||36<_)throw Error("radix out of range: "+_);if(T.charAt(0)=="-")return A(h(T.substring(1),_));if(T.indexOf("-")>=0)throw Error('number format error: interior "-" character');const S=d(Math.pow(_,8));let C=f;for(let D=0;D<T.length;D+=8){var N=Math.min(8,T.length-D);const P=parseInt(T.substring(D,D+N),_);N<8?(N=d(Math.pow(_,N)),C=C.j(N).add(d(P))):(C=C.j(S),C=C.add(d(P)))}return C}var f=l(0),m=l(1),v=l(16777216);t=o.prototype,t.m=function(){if(b(this))return-A(this).m();let T=0,_=1;for(let S=0;S<this.g.length;S++){const C=this.i(S);T+=(C>=0?C:4294967296+C)*_,_*=4294967296}return T},t.toString=function(T){if(T=T||10,T<2||36<T)throw Error("radix out of range: "+T);if(R(this))return"0";if(b(this))return"-"+A(this).toString(T);const _=d(Math.pow(T,6));var S=this;let C="";for(;;){const N=j(S,_).g;S=I(S,N.j(_));let D=((S.g.length>0?S.g[0]:S.h)>>>0).toString(T);if(S=N,R(S))return D+C;for(;D.length<6;)D="0"+D;C=D+C}},t.i=function(T){return T<0?0:T<this.g.length?this.g[T]:this.h};function R(T){if(T.h!=0)return!1;for(let _=0;_<T.g.length;_++)if(T.g[_]!=0)return!1;return!0}function b(T){return T.h==-1}t.l=function(T){return T=I(this,T),b(T)?-1:R(T)?0:1};function A(T){const _=T.g.length,S=[];for(let C=0;C<_;C++)S[C]=~T.g[C];return new o(S,~T.h).add(m)}t.abs=function(){return b(this)?A(this):this},t.add=function(T){const _=Math.max(this.g.length,T.g.length),S=[];let C=0;for(let N=0;N<=_;N++){let D=C+(this.i(N)&65535)+(T.i(N)&65535),P=(D>>>16)+(this.i(N)>>>16)+(T.i(N)>>>16);C=P>>>16,D&=65535,P&=65535,S[N]=P<<16|D}return new o(S,S[S.length-1]&-2147483648?-1:0)};function I(T,_){return T.add(A(_))}t.j=function(T){if(R(this)||R(T))return f;if(b(this))return b(T)?A(this).j(A(T)):A(A(this).j(T));if(b(T))return A(this.j(A(T)));if(this.l(v)<0&&T.l(v)<0)return d(this.m()*T.m());const _=this.g.length+T.g.length,S=[];for(var C=0;C<2*_;C++)S[C]=0;for(C=0;C<this.g.length;C++)for(let N=0;N<T.g.length;N++){const D=this.i(C)>>>16,P=this.i(C)&65535,Y=T.i(N)>>>16,Ye=T.i(N)&65535;S[2*C+2*N]+=P*Ye,w(S,2*C+2*N),S[2*C+2*N+1]+=D*Ye,w(S,2*C+2*N+1),S[2*C+2*N+1]+=P*Y,w(S,2*C+2*N+1),S[2*C+2*N+2]+=D*Y,w(S,2*C+2*N+2)}for(T=0;T<_;T++)S[T]=S[2*T+1]<<16|S[2*T];for(T=_;T<2*_;T++)S[T]=0;return new o(S,0)};function w(T,_){for(;(T[_]&65535)!=T[_];)T[_+1]+=T[_]>>>16,T[_]&=65535,_++}function y(T,_){this.g=T,this.h=_}function j(T,_){if(R(_))throw Error("division by zero");if(R(T))return new y(f,f);if(b(T))return _=j(A(T),_),new y(A(_.g),A(_.h));if(b(_))return _=j(T,A(_)),new y(A(_.g),_.h);if(T.g.length>30){if(b(T)||b(_))throw Error("slowDivide_ only works with positive integers.");for(var S=m,C=_;C.l(T)<=0;)S=V(S),C=V(C);var N=M(S,1),D=M(C,1);for(C=M(C,2),S=M(S,2);!R(C);){var P=D.add(C);P.l(T)<=0&&(N=N.add(S),D=P),C=M(C,1),S=M(S,1)}return _=I(T,N.j(_)),new y(N,_)}for(N=f;T.l(_)>=0;){for(S=Math.max(1,Math.floor(T.m()/_.m())),C=Math.ceil(Math.log(S)/Math.LN2),C=C<=48?1:Math.pow(2,C-48),D=d(S),P=D.j(_);b(P)||P.l(T)>0;)S-=C,D=d(S),P=D.j(_);R(D)&&(D=m),N=N.add(D),T=I(T,P)}return new y(N,T)}t.B=function(T){return j(this,T).h},t.and=function(T){const _=Math.max(this.g.length,T.g.length),S=[];for(let C=0;C<_;C++)S[C]=this.i(C)&T.i(C);return new o(S,this.h&T.h)},t.or=function(T){const _=Math.max(this.g.length,T.g.length),S=[];for(let C=0;C<_;C++)S[C]=this.i(C)|T.i(C);return new o(S,this.h|T.h)},t.xor=function(T){const _=Math.max(this.g.length,T.g.length),S=[];for(let C=0;C<_;C++)S[C]=this.i(C)^T.i(C);return new o(S,this.h^T.h)};function V(T){const _=T.g.length+1,S=[];for(let C=0;C<_;C++)S[C]=T.i(C)<<1|T.i(C-1)>>>31;return new o(S,T.h)}function M(T,_){const S=_>>5;_%=32;const C=T.g.length-S,N=[];for(let D=0;D<C;D++)N[D]=_>0?T.i(D+S)>>>_|T.i(D+S+1)<<32-_:T.i(D+S);return new o(N,T.h)}r.prototype.digest=r.prototype.A,r.prototype.reset=r.prototype.u,r.prototype.update=r.prototype.v,zS=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.B,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=d,o.fromString=h,Bs=o}).apply(typeof fE<"u"?fE:typeof self<"u"?self:typeof window<"u"?window:{});var vu=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var qS,ml,HS,Qu,Om,WS,KS,GS;(function(){var t,e=Object.defineProperty;function n(c){c=[typeof globalThis=="object"&&globalThis,c,typeof window=="object"&&window,typeof self=="object"&&self,typeof vu=="object"&&vu];for(var p=0;p<c.length;++p){var g=c[p];if(g&&g.Math==Math)return g}throw Error("Cannot find global object")}var r=n(this);function s(c,p){if(p)e:{var g=r;c=c.split(".");for(var E=0;E<c.length-1;E++){var L=c[E];if(!(L in g))break e;g=g[L]}c=c[c.length-1],E=g[c],p=p(E),p!=E&&p!=null&&e(g,c,{configurable:!0,writable:!0,value:p})}}s("Symbol.dispose",function(c){return c||Symbol("Symbol.dispose")}),s("Array.prototype.values",function(c){return c||function(){return this[Symbol.iterator]()}}),s("Object.entries",function(c){return c||function(p){var g=[],E;for(E in p)Object.prototype.hasOwnProperty.call(p,E)&&g.push([E,p[E]]);return g}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var i=i||{},o=this||self;function a(c){var p=typeof c;return p=="object"&&c!=null||p=="function"}function l(c,p,g){return c.call.apply(c.bind,arguments)}function d(c,p,g){return d=l,d.apply(null,arguments)}function h(c,p){var g=Array.prototype.slice.call(arguments,1);return function(){var E=g.slice();return E.push.apply(E,arguments),c.apply(this,E)}}function f(c,p){function g(){}g.prototype=p.prototype,c.Z=p.prototype,c.prototype=new g,c.prototype.constructor=c,c.Ob=function(E,L,U){for(var ee=Array(arguments.length-2),Re=2;Re<arguments.length;Re++)ee[Re-2]=arguments[Re];return p.prototype[L].apply(E,ee)}}var m=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?c=>c&&AsyncContext.Snapshot.wrap(c):c=>c;function v(c){const p=c.length;if(p>0){const g=Array(p);for(let E=0;E<p;E++)g[E]=c[E];return g}return[]}function R(c,p){for(let E=1;E<arguments.length;E++){const L=arguments[E];var g=typeof L;if(g=g!="object"?g:L?Array.isArray(L)?"array":g:"null",g=="array"||g=="object"&&typeof L.length=="number"){g=c.length||0;const U=L.length||0;c.length=g+U;for(let ee=0;ee<U;ee++)c[g+ee]=L[ee]}else c.push(L)}}class b{constructor(p,g){this.i=p,this.j=g,this.h=0,this.g=null}get(){let p;return this.h>0?(this.h--,p=this.g,this.g=p.next,p.next=null):p=this.i(),p}}function A(c){o.setTimeout(()=>{throw c},0)}function I(){var c=T;let p=null;return c.g&&(p=c.g,c.g=c.g.next,c.g||(c.h=null),p.next=null),p}class w{constructor(){this.h=this.g=null}add(p,g){const E=y.get();E.set(p,g),this.h?this.h.next=E:this.g=E,this.h=E}}var y=new b(()=>new j,c=>c.reset());class j{constructor(){this.next=this.g=this.h=null}set(p,g){this.h=p,this.g=g,this.next=null}reset(){this.next=this.g=this.h=null}}let V,M=!1,T=new w,_=()=>{const c=Promise.resolve(void 0);V=()=>{c.then(S)}};function S(){for(var c;c=I();){try{c.h.call(c.g)}catch(g){A(g)}var p=y;p.j(c),p.h<100&&(p.h++,c.next=p.g,p.g=c)}M=!1}function C(){this.u=this.u,this.C=this.C}C.prototype.u=!1,C.prototype.dispose=function(){this.u||(this.u=!0,this.N())},C.prototype[Symbol.dispose]=function(){this.dispose()},C.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function N(c,p){this.type=c,this.g=this.target=p,this.defaultPrevented=!1}N.prototype.h=function(){this.defaultPrevented=!0};var D=function(){if(!o.addEventListener||!Object.defineProperty)return!1;var c=!1,p=Object.defineProperty({},"passive",{get:function(){c=!0}});try{const g=()=>{};o.addEventListener("test",g,p),o.removeEventListener("test",g,p)}catch{}return c}();function P(c){return/^[\s\xa0]*$/.test(c)}function Y(c,p){N.call(this,c?c.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,c&&this.init(c,p)}f(Y,N),Y.prototype.init=function(c,p){const g=this.type=c.type,E=c.changedTouches&&c.changedTouches.length?c.changedTouches[0]:null;this.target=c.target||c.srcElement,this.g=p,p=c.relatedTarget,p||(g=="mouseover"?p=c.fromElement:g=="mouseout"&&(p=c.toElement)),this.relatedTarget=p,E?(this.clientX=E.clientX!==void 0?E.clientX:E.pageX,this.clientY=E.clientY!==void 0?E.clientY:E.pageY,this.screenX=E.screenX||0,this.screenY=E.screenY||0):(this.clientX=c.clientX!==void 0?c.clientX:c.pageX,this.clientY=c.clientY!==void 0?c.clientY:c.pageY,this.screenX=c.screenX||0,this.screenY=c.screenY||0),this.button=c.button,this.key=c.key||"",this.ctrlKey=c.ctrlKey,this.altKey=c.altKey,this.shiftKey=c.shiftKey,this.metaKey=c.metaKey,this.pointerId=c.pointerId||0,this.pointerType=c.pointerType,this.state=c.state,this.i=c,c.defaultPrevented&&Y.Z.h.call(this)},Y.prototype.h=function(){Y.Z.h.call(this);const c=this.i;c.preventDefault?c.preventDefault():c.returnValue=!1};var Ye="closure_listenable_"+(Math.random()*1e6|0),Mt=0;function Zt(c,p,g,E,L){this.listener=c,this.proxy=null,this.src=p,this.type=g,this.capture=!!E,this.ha=L,this.key=++Mt,this.da=this.fa=!1}function J(c){c.da=!0,c.listener=null,c.proxy=null,c.src=null,c.ha=null}function ue(c,p,g){for(const E in c)p.call(g,c[E],E,c)}function G(c,p){for(const g in c)p.call(void 0,c[g],g,c)}function je(c){const p={};for(const g in c)p[g]=c[g];return p}const Ke="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function B(c,p){let g,E;for(let L=1;L<arguments.length;L++){E=arguments[L];for(g in E)c[g]=E[g];for(let U=0;U<Ke.length;U++)g=Ke[U],Object.prototype.hasOwnProperty.call(E,g)&&(c[g]=E[g])}}function ne(c){this.src=c,this.g={},this.h=0}ne.prototype.add=function(c,p,g,E,L){const U=c.toString();c=this.g[U],c||(c=this.g[U]=[],this.h++);const ee=Ie(c,p,E,L);return ee>-1?(p=c[ee],g||(p.fa=!1)):(p=new Zt(p,this.src,U,!!E,L),p.fa=g,c.push(p)),p};function de(c,p){const g=p.type;if(g in c.g){var E=c.g[g],L=Array.prototype.indexOf.call(E,p,void 0),U;(U=L>=0)&&Array.prototype.splice.call(E,L,1),U&&(J(p),c.g[g].length==0&&(delete c.g[g],c.h--))}}function Ie(c,p,g,E){for(let L=0;L<c.length;++L){const U=c[L];if(!U.da&&U.listener==p&&U.capture==!!g&&U.ha==E)return L}return-1}var xe="closure_lm_"+(Math.random()*1e6|0),ke={};function ge(c,p,g,E,L){if(Array.isArray(p)){for(let U=0;U<p.length;U++)ge(c,p[U],g,E,L);return null}return g=se(g),c&&c[Ye]?c.J(p,g,a(E)?!!E.capture:!1,L):Xe(c,p,g,!1,E,L)}function Xe(c,p,g,E,L,U){if(!p)throw Error("Invalid event type");const ee=a(L)?!!L.capture:!!L;let Re=ft(c);if(Re||(c[xe]=Re=new ne(c)),g=Re.add(p,g,E,ee,U),g.proxy)return g;if(E=be(),g.proxy=E,E.src=c,E.listener=g,c.addEventListener)D||(L=ee),L===void 0&&(L=!1),c.addEventListener(p.toString(),E,L);else if(c.attachEvent)c.attachEvent(it(p.toString()),E);else if(c.addListener&&c.removeListener)c.addListener(E);else throw Error("addEventListener and attachEvent are unavailable.");return g}function be(){function c(g){return p.call(c.src,c.listener,g)}const p=Ge;return c}function re(c,p,g,E,L){if(Array.isArray(p))for(var U=0;U<p.length;U++)re(c,p[U],g,E,L);else E=a(E)?!!E.capture:!!E,g=se(g),c&&c[Ye]?(c=c.i,U=String(p).toString(),U in c.g&&(p=c.g[U],g=Ie(p,g,E,L),g>-1&&(J(p[g]),Array.prototype.splice.call(p,g,1),p.length==0&&(delete c.g[U],c.h--)))):c&&(c=ft(c))&&(p=c.g[p.toString()],c=-1,p&&(c=Ie(p,g,E,L)),(g=c>-1?p[c]:null)&&Oe(g))}function Oe(c){if(typeof c!="number"&&c&&!c.da){var p=c.src;if(p&&p[Ye])de(p.i,c);else{var g=c.type,E=c.proxy;p.removeEventListener?p.removeEventListener(g,E,c.capture):p.detachEvent?p.detachEvent(it(g),E):p.addListener&&p.removeListener&&p.removeListener(E),(g=ft(p))?(de(g,c),g.h==0&&(g.src=null,p[xe]=null)):J(c)}}}function it(c){return c in ke?ke[c]:ke[c]="on"+c}function Ge(c,p){if(c.da)c=!0;else{p=new Y(p,this);const g=c.listener,E=c.ha||c.src;c.fa&&Oe(c),c=g.call(E,p)}return c}function ft(c){return c=c[xe],c instanceof ne?c:null}var q="__closure_events_fn_"+(Math.random()*1e9>>>0);function se(c){return typeof c=="function"?c:(c[q]||(c[q]=function(p){return c.handleEvent(p)}),c[q])}function X(){C.call(this),this.i=new ne(this),this.M=this,this.G=null}f(X,C),X.prototype[Ye]=!0,X.prototype.removeEventListener=function(c,p,g,E){re(this,c,p,g,E)};function Q(c,p){var g,E=c.G;if(E)for(g=[];E;E=E.G)g.push(E);if(c=c.M,E=p.type||p,typeof p=="string")p=new N(p,c);else if(p instanceof N)p.target=p.target||c;else{var L=p;p=new N(E,c),B(p,L)}L=!0;let U,ee;if(g)for(ee=g.length-1;ee>=0;ee--)U=p.g=g[ee],L=he(U,E,!0,p)&&L;if(U=p.g=c,L=he(U,E,!0,p)&&L,L=he(U,E,!1,p)&&L,g)for(ee=0;ee<g.length;ee++)U=p.g=g[ee],L=he(U,E,!1,p)&&L}X.prototype.N=function(){if(X.Z.N.call(this),this.i){var c=this.i;for(const p in c.g){const g=c.g[p];for(let E=0;E<g.length;E++)J(g[E]);delete c.g[p],c.h--}}this.G=null},X.prototype.J=function(c,p,g,E){return this.i.add(String(c),p,!1,g,E)},X.prototype.K=function(c,p,g,E){return this.i.add(String(c),p,!0,g,E)};function he(c,p,g,E){if(p=c.i.g[String(p)],!p)return!0;p=p.concat();let L=!0;for(let U=0;U<p.length;++U){const ee=p[U];if(ee&&!ee.da&&ee.capture==g){const Re=ee.listener,Dt=ee.ha||ee.src;ee.fa&&de(c.i,ee),L=Re.call(Dt,E)!==!1&&L}}return L&&!E.defaultPrevented}function we(c,p){if(typeof c!="function")if(c&&typeof c.handleEvent=="function")c=d(c.handleEvent,c);else throw Error("Invalid listener argument");return Number(p)>2147483647?-1:o.setTimeout(c,p||0)}function Ne(c){c.g=we(()=>{c.g=null,c.i&&(c.i=!1,Ne(c))},c.l);const p=c.h;c.h=null,c.m.apply(null,p)}class ze extends C{constructor(p,g){super(),this.m=p,this.l=g,this.h=null,this.i=!1,this.g=null}j(p){this.h=arguments,this.g?this.i=!0:Ne(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Se(c){C.call(this),this.h=c,this.g={}}f(Se,C);var Fe=[];function pe(c){ue(c.g,function(p,g){this.g.hasOwnProperty(g)&&Oe(p)},c),c.g={}}Se.prototype.N=function(){Se.Z.N.call(this),pe(this)},Se.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var He=o.JSON.stringify,F=o.JSON.parse,Z=class{stringify(c){return o.JSON.stringify(c,void 0)}parse(c){return o.JSON.parse(c,void 0)}};function ae(){}function Ce(){}var _t={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function x(){N.call(this,"d")}f(x,N);function z(){N.call(this,"c")}f(z,N);var ie={},Ee=null;function me(){return Ee=Ee||new X}ie.Ia="serverreachability";function Ae(c){N.call(this,ie.Ia,c)}f(Ae,N);function Ct(c){const p=me();Q(p,new Ae(p))}ie.STAT_EVENT="statevent";function St(c,p){N.call(this,ie.STAT_EVENT,c),this.stat=p}f(St,N);function Ve(c){const p=me();Q(p,new St(p,c))}ie.Ja="timingevent";function At(c,p){N.call(this,ie.Ja,c),this.size=p}f(At,N);function Ft(c,p){if(typeof c!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){c()},p)}function en(){this.g=!0}en.prototype.ua=function(){this.g=!1};function En(c,p,g,E,L,U){c.info(function(){if(c.g)if(U){var ee="",Re=U.split("&");for(let nt=0;nt<Re.length;nt++){var Dt=Re[nt].split("=");if(Dt.length>1){const Ut=Dt[0];Dt=Dt[1];const vr=Ut.split("_");ee=vr.length>=2&&vr[1]=="type"?ee+(Ut+"="+Dt+"&"):ee+(Ut+"=redacted&")}}}else ee=null;else ee=U;return"XMLHTTP REQ ("+E+") [attempt "+L+"]: "+p+`
`+g+`
`+ee})}function gf(c,p,g,E,L,U,ee){c.info(function(){return"XMLHTTP RESP ("+E+") [ attempt "+L+"]: "+p+`
`+g+`
`+U+" "+ee})}function yr(c,p,g,E){c.info(function(){return"XMLHTTP TEXT ("+p+"): "+qA(c,g)+(E?" "+E:"")})}function zA(c,p){c.info(function(){return"TIMEOUT: "+p})}en.prototype.info=function(){};function qA(c,p){if(!c.g)return p;if(!p)return null;try{const U=JSON.parse(p);if(U){for(c=0;c<U.length;c++)if(Array.isArray(U[c])){var g=U[c];if(!(g.length<2)){var E=g[1];if(Array.isArray(E)&&!(E.length<1)){var L=E[0];if(L!="noop"&&L!="stop"&&L!="close")for(let ee=1;ee<E.length;ee++)E[ee]=""}}}}return He(U)}catch{return p}}var qc={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},O_={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},V_;function yf(){}f(yf,ae),yf.prototype.g=function(){return new XMLHttpRequest},V_=new yf;function Va(c){return encodeURIComponent(String(c))}function HA(c){var p=1;c=c.split(":");const g=[];for(;p>0&&c.length;)g.push(c.shift()),p--;return c.length&&g.push(c.join(":")),g}function os(c,p,g,E){this.j=c,this.i=p,this.l=g,this.S=E||1,this.V=new Se(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new L_}function L_(){this.i=null,this.g="",this.h=!1}var M_={},_f={};function vf(c,p,g){c.M=1,c.A=Wc(_r(p)),c.u=g,c.R=!0,F_(c,null)}function F_(c,p){c.F=Date.now(),Hc(c),c.B=_r(c.A);var g=c.B,E=c.S;Array.isArray(E)||(E=[String(E)]),J_(g.i,"t",E),c.C=0,g=c.j.L,c.h=new L_,c.g=gv(c.j,g?p:null,!c.u),c.P>0&&(c.O=new ze(d(c.Y,c,c.g),c.P)),p=c.V,g=c.g,E=c.ba;var L="readystatechange";Array.isArray(L)||(L&&(Fe[0]=L.toString()),L=Fe);for(let U=0;U<L.length;U++){const ee=ge(g,L[U],E||p.handleEvent,!1,p.h||p);if(!ee)break;p.g[ee.key]=ee}p=c.J?je(c.J):{},c.u?(c.v||(c.v="POST"),p["Content-Type"]="application/x-www-form-urlencoded",c.g.ea(c.B,c.v,c.u,p)):(c.v="GET",c.g.ea(c.B,c.v,null,p)),Ct(),En(c.i,c.v,c.B,c.l,c.S,c.u)}os.prototype.ba=function(c){c=c.target;const p=this.O;p&&cs(c)==3?p.j():this.Y(c)},os.prototype.Y=function(c){try{if(c==this.g)e:{const Re=cs(this.g),Dt=this.g.ya(),nt=this.g.ca();if(!(Re<3)&&(Re!=3||this.g&&(this.h.h||this.g.la()||iv(this.g)))){this.K||Re!=4||Dt==7||(Dt==8||nt<=0?Ct(3):Ct(2)),wf(this);var p=this.g.ca();this.X=p;var g=WA(this);if(this.o=p==200,gf(this.i,this.v,this.B,this.l,this.S,Re,p),this.o){if(this.U&&!this.L){t:{if(this.g){var E,L=this.g;if((E=L.g?L.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!P(E)){var U=E;break t}}U=null}if(c=U)yr(this.i,this.l,c,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,Ef(this,c);else{this.o=!1,this.m=3,Ve(12),ai(this),La(this);break e}}if(this.R){c=!0;let Ut;for(;!this.K&&this.C<g.length;)if(Ut=KA(this,g),Ut==_f){Re==4&&(this.m=4,Ve(14),c=!1),yr(this.i,this.l,null,"[Incomplete Response]");break}else if(Ut==M_){this.m=4,Ve(15),yr(this.i,this.l,g,"[Invalid Chunk]"),c=!1;break}else yr(this.i,this.l,Ut,null),Ef(this,Ut);if(U_(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Re!=4||g.length!=0||this.h.h||(this.m=1,Ve(16),c=!1),this.o=this.o&&c,!c)yr(this.i,this.l,g,"[Invalid Chunked Response]"),ai(this),La(this);else if(g.length>0&&!this.W){this.W=!0;var ee=this.j;ee.g==this&&ee.aa&&!ee.P&&(ee.j.info("Great, no buffering proxy detected. Bytes received: "+g.length),Rf(ee),ee.P=!0,Ve(11))}}else yr(this.i,this.l,g,null),Ef(this,g);Re==4&&ai(this),this.o&&!this.K&&(Re==4?hv(this.j,this):(this.o=!1,Hc(this)))}else aR(this.g),p==400&&g.indexOf("Unknown SID")>0?(this.m=3,Ve(12)):(this.m=0,Ve(13)),ai(this),La(this)}}}catch{}finally{}};function WA(c){if(!U_(c))return c.g.la();const p=iv(c.g);if(p==="")return"";let g="";const E=p.length,L=cs(c.g)==4;if(!c.h.i){if(typeof TextDecoder>"u")return ai(c),La(c),"";c.h.i=new o.TextDecoder}for(let U=0;U<E;U++)c.h.h=!0,g+=c.h.i.decode(p[U],{stream:!(L&&U==E-1)});return p.length=0,c.h.g+=g,c.C=0,c.h.g}function U_(c){return c.g?c.v=="GET"&&c.M!=2&&c.j.Aa:!1}function KA(c,p){var g=c.C,E=p.indexOf(`
`,g);return E==-1?_f:(g=Number(p.substring(g,E)),isNaN(g)?M_:(E+=1,E+g>p.length?_f:(p=p.slice(E,E+g),c.C=E+g,p)))}os.prototype.cancel=function(){this.K=!0,ai(this)};function Hc(c){c.T=Date.now()+c.H,$_(c,c.H)}function $_(c,p){if(c.D!=null)throw Error("WatchDog timer not null");c.D=Ft(d(c.aa,c),p)}function wf(c){c.D&&(o.clearTimeout(c.D),c.D=null)}os.prototype.aa=function(){this.D=null;const c=Date.now();c-this.T>=0?(zA(this.i,this.B),this.M!=2&&(Ct(),Ve(17)),ai(this),this.m=2,La(this)):$_(this,this.T-c)};function La(c){c.j.I==0||c.K||hv(c.j,c)}function ai(c){wf(c);var p=c.O;p&&typeof p.dispose=="function"&&p.dispose(),c.O=null,pe(c.V),c.g&&(p=c.g,c.g=null,p.abort(),p.dispose())}function Ef(c,p){try{var g=c.j;if(g.I!=0&&(g.g==c||If(g.h,c))){if(!c.L&&If(g.h,c)&&g.I==3){try{var E=g.Ba.g.parse(p)}catch{E=null}if(Array.isArray(E)&&E.length==3){var L=E;if(L[0]==0){e:if(!g.v){if(g.g)if(g.g.F+3e3<c.F)Xc(g),Qc(g);else break e;Af(g),Ve(18)}}else g.xa=L[1],0<g.xa-g.K&&L[2]<37500&&g.F&&g.A==0&&!g.C&&(g.C=Ft(d(g.Va,g),6e3));q_(g.h)<=1&&g.ta&&(g.ta=void 0)}else ci(g,11)}else if((c.L||g.g==c)&&Xc(g),!P(p))for(L=g.Ba.g.parse(p),p=0;p<L.length;p++){let nt=L[p];const Ut=nt[0];if(!(Ut<=g.K))if(g.K=Ut,nt=nt[1],g.I==2)if(nt[0]=="c"){g.M=nt[1],g.ba=nt[2];const vr=nt[3];vr!=null&&(g.ka=vr,g.j.info("VER="+g.ka));const ui=nt[4];ui!=null&&(g.za=ui,g.j.info("SVER="+g.za));const us=nt[5];us!=null&&typeof us=="number"&&us>0&&(E=1.5*us,g.O=E,g.j.info("backChannelRequestTimeoutMs_="+E)),E=g;const ds=c.g;if(ds){const Zc=ds.g?ds.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Zc){var U=E.h;U.g||Zc.indexOf("spdy")==-1&&Zc.indexOf("quic")==-1&&Zc.indexOf("h2")==-1||(U.j=U.l,U.g=new Set,U.h&&(Tf(U,U.h),U.h=null))}if(E.G){const Pf=ds.g?ds.g.getResponseHeader("X-HTTP-Session-Id"):null;Pf&&(E.wa=Pf,ot(E.J,E.G,Pf))}}g.I=3,g.l&&g.l.ra(),g.aa&&(g.T=Date.now()-c.F,g.j.info("Handshake RTT: "+g.T+"ms")),E=g;var ee=c;if(E.na=mv(E,E.L?E.ba:null,E.W),ee.L){H_(E.h,ee);var Re=ee,Dt=E.O;Dt&&(Re.H=Dt),Re.D&&(wf(Re),Hc(Re)),E.g=ee}else uv(E);g.i.length>0&&Yc(g)}else nt[0]!="stop"&&nt[0]!="close"||ci(g,7);else g.I==3&&(nt[0]=="stop"||nt[0]=="close"?nt[0]=="stop"?ci(g,7):Cf(g):nt[0]!="noop"&&g.l&&g.l.qa(nt),g.A=0)}}Ct(4)}catch{}}var GA=class{constructor(c,p){this.g=c,this.map=p}};function B_(c){this.l=c||10,o.PerformanceNavigationTiming?(c=o.performance.getEntriesByType("navigation"),c=c.length>0&&(c[0].nextHopProtocol=="hq"||c[0].nextHopProtocol=="h2")):c=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=c?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function z_(c){return c.h?!0:c.g?c.g.size>=c.j:!1}function q_(c){return c.h?1:c.g?c.g.size:0}function If(c,p){return c.h?c.h==p:c.g?c.g.has(p):!1}function Tf(c,p){c.g?c.g.add(p):c.h=p}function H_(c,p){c.h&&c.h==p?c.h=null:c.g&&c.g.has(p)&&c.g.delete(p)}B_.prototype.cancel=function(){if(this.i=W_(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const c of this.g.values())c.cancel();this.g.clear()}};function W_(c){if(c.h!=null)return c.i.concat(c.h.G);if(c.g!=null&&c.g.size!==0){let p=c.i;for(const g of c.g.values())p=p.concat(g.G);return p}return v(c.i)}var K_=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function QA(c,p){if(c){c=c.split("&");for(let g=0;g<c.length;g++){const E=c[g].indexOf("=");let L,U=null;E>=0?(L=c[g].substring(0,E),U=c[g].substring(E+1)):L=c[g],p(L,U?decodeURIComponent(U.replace(/\+/g," ")):"")}}}function as(c){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let p;c instanceof as?(this.l=c.l,Ma(this,c.j),this.o=c.o,this.g=c.g,Fa(this,c.u),this.h=c.h,xf(this,Z_(c.i)),this.m=c.m):c&&(p=String(c).match(K_))?(this.l=!1,Ma(this,p[1]||"",!0),this.o=Ua(p[2]||""),this.g=Ua(p[3]||"",!0),Fa(this,p[4]),this.h=Ua(p[5]||"",!0),xf(this,p[6]||"",!0),this.m=Ua(p[7]||"")):(this.l=!1,this.i=new Ba(null,this.l))}as.prototype.toString=function(){const c=[];var p=this.j;p&&c.push($a(p,G_,!0),":");var g=this.g;return(g||p=="file")&&(c.push("//"),(p=this.o)&&c.push($a(p,G_,!0),"@"),c.push(Va(g).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),g=this.u,g!=null&&c.push(":",String(g))),(g=this.h)&&(this.g&&g.charAt(0)!="/"&&c.push("/"),c.push($a(g,g.charAt(0)=="/"?JA:XA,!0))),(g=this.i.toString())&&c.push("?",g),(g=this.m)&&c.push("#",$a(g,eR)),c.join("")},as.prototype.resolve=function(c){const p=_r(this);let g=!!c.j;g?Ma(p,c.j):g=!!c.o,g?p.o=c.o:g=!!c.g,g?p.g=c.g:g=c.u!=null;var E=c.h;if(g)Fa(p,c.u);else if(g=!!c.h){if(E.charAt(0)!="/")if(this.g&&!this.h)E="/"+E;else{var L=p.h.lastIndexOf("/");L!=-1&&(E=p.h.slice(0,L+1)+E)}if(L=E,L==".."||L==".")E="";else if(L.indexOf("./")!=-1||L.indexOf("/.")!=-1){E=L.lastIndexOf("/",0)==0,L=L.split("/");const U=[];for(let ee=0;ee<L.length;){const Re=L[ee++];Re=="."?E&&ee==L.length&&U.push(""):Re==".."?((U.length>1||U.length==1&&U[0]!="")&&U.pop(),E&&ee==L.length&&U.push("")):(U.push(Re),E=!0)}E=U.join("/")}else E=L}return g?p.h=E:g=c.i.toString()!=="",g?xf(p,Z_(c.i)):g=!!c.m,g&&(p.m=c.m),p};function _r(c){return new as(c)}function Ma(c,p,g){c.j=g?Ua(p,!0):p,c.j&&(c.j=c.j.replace(/:$/,""))}function Fa(c,p){if(p){if(p=Number(p),isNaN(p)||p<0)throw Error("Bad port number "+p);c.u=p}else c.u=null}function xf(c,p,g){p instanceof Ba?(c.i=p,tR(c.i,c.l)):(g||(p=$a(p,ZA)),c.i=new Ba(p,c.l))}function ot(c,p,g){c.i.set(p,g)}function Wc(c){return ot(c,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),c}function Ua(c,p){return c?p?decodeURI(c.replace(/%25/g,"%2525")):decodeURIComponent(c):""}function $a(c,p,g){return typeof c=="string"?(c=encodeURI(c).replace(p,YA),g&&(c=c.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),c):null}function YA(c){return c=c.charCodeAt(0),"%"+(c>>4&15).toString(16)+(c&15).toString(16)}var G_=/[#\/\?@]/g,XA=/[#\?:]/g,JA=/[#\?]/g,ZA=/[#\?@]/g,eR=/#/g;function Ba(c,p){this.h=this.g=null,this.i=c||null,this.j=!!p}function li(c){c.g||(c.g=new Map,c.h=0,c.i&&QA(c.i,function(p,g){c.add(decodeURIComponent(p.replace(/\+/g," ")),g)}))}t=Ba.prototype,t.add=function(c,p){li(this),this.i=null,c=lo(this,c);let g=this.g.get(c);return g||this.g.set(c,g=[]),g.push(p),this.h+=1,this};function Q_(c,p){li(c),p=lo(c,p),c.g.has(p)&&(c.i=null,c.h-=c.g.get(p).length,c.g.delete(p))}function Y_(c,p){return li(c),p=lo(c,p),c.g.has(p)}t.forEach=function(c,p){li(this),this.g.forEach(function(g,E){g.forEach(function(L){c.call(p,L,E,this)},this)},this)};function X_(c,p){li(c);let g=[];if(typeof p=="string")Y_(c,p)&&(g=g.concat(c.g.get(lo(c,p))));else for(c=Array.from(c.g.values()),p=0;p<c.length;p++)g=g.concat(c[p]);return g}t.set=function(c,p){return li(this),this.i=null,c=lo(this,c),Y_(this,c)&&(this.h-=this.g.get(c).length),this.g.set(c,[p]),this.h+=1,this},t.get=function(c,p){return c?(c=X_(this,c),c.length>0?String(c[0]):p):p};function J_(c,p,g){Q_(c,p),g.length>0&&(c.i=null,c.g.set(lo(c,p),v(g)),c.h+=g.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const c=[],p=Array.from(this.g.keys());for(let E=0;E<p.length;E++){var g=p[E];const L=Va(g);g=X_(this,g);for(let U=0;U<g.length;U++){let ee=L;g[U]!==""&&(ee+="="+Va(g[U])),c.push(ee)}}return this.i=c.join("&")};function Z_(c){const p=new Ba;return p.i=c.i,c.g&&(p.g=new Map(c.g),p.h=c.h),p}function lo(c,p){return p=String(p),c.j&&(p=p.toLowerCase()),p}function tR(c,p){p&&!c.j&&(li(c),c.i=null,c.g.forEach(function(g,E){const L=E.toLowerCase();E!=L&&(Q_(this,E),J_(this,L,g))},c)),c.j=p}function nR(c,p){const g=new en;if(o.Image){const E=new Image;E.onload=h(ls,g,"TestLoadImage: loaded",!0,p,E),E.onerror=h(ls,g,"TestLoadImage: error",!1,p,E),E.onabort=h(ls,g,"TestLoadImage: abort",!1,p,E),E.ontimeout=h(ls,g,"TestLoadImage: timeout",!1,p,E),o.setTimeout(function(){E.ontimeout&&E.ontimeout()},1e4),E.src=c}else p(!1)}function rR(c,p){const g=new en,E=new AbortController,L=setTimeout(()=>{E.abort(),ls(g,"TestPingServer: timeout",!1,p)},1e4);fetch(c,{signal:E.signal}).then(U=>{clearTimeout(L),U.ok?ls(g,"TestPingServer: ok",!0,p):ls(g,"TestPingServer: server error",!1,p)}).catch(()=>{clearTimeout(L),ls(g,"TestPingServer: error",!1,p)})}function ls(c,p,g,E,L){try{L&&(L.onload=null,L.onerror=null,L.onabort=null,L.ontimeout=null),E(g)}catch{}}function sR(){this.g=new Z}function Sf(c){this.i=c.Sb||null,this.h=c.ab||!1}f(Sf,ae),Sf.prototype.g=function(){return new Kc(this.i,this.h)};function Kc(c,p){X.call(this),this.H=c,this.o=p,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}f(Kc,X),t=Kc.prototype,t.open=function(c,p){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=c,this.D=p,this.readyState=1,qa(this)},t.send=function(c){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const p={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};c&&(p.body=c),(this.H||o).fetch(new Request(this.D,p)).then(this.Pa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,za(this)),this.readyState=0},t.Pa=function(c){if(this.g&&(this.l=c,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=c.headers,this.readyState=2,qa(this)),this.g&&(this.readyState=3,qa(this),this.g)))if(this.responseType==="arraybuffer")c.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in c){if(this.j=c.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;ev(this)}else c.text().then(this.Oa.bind(this),this.ga.bind(this))};function ev(c){c.j.read().then(c.Ma.bind(c)).catch(c.ga.bind(c))}t.Ma=function(c){if(this.g){if(this.o&&c.value)this.response.push(c.value);else if(!this.o){var p=c.value?c.value:new Uint8Array(0);(p=this.B.decode(p,{stream:!c.done}))&&(this.response=this.responseText+=p)}c.done?za(this):qa(this),this.readyState==3&&ev(this)}},t.Oa=function(c){this.g&&(this.response=this.responseText=c,za(this))},t.Na=function(c){this.g&&(this.response=c,za(this))},t.ga=function(){this.g&&za(this)};function za(c){c.readyState=4,c.l=null,c.j=null,c.B=null,qa(c)}t.setRequestHeader=function(c,p){this.A.append(c,p)},t.getResponseHeader=function(c){return this.h&&this.h.get(c.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const c=[],p=this.h.entries();for(var g=p.next();!g.done;)g=g.value,c.push(g[0]+": "+g[1]),g=p.next();return c.join(`\r
`)};function qa(c){c.onreadystatechange&&c.onreadystatechange.call(c)}Object.defineProperty(Kc.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(c){this.m=c?"include":"same-origin"}});function tv(c){let p="";return ue(c,function(g,E){p+=E,p+=":",p+=g,p+=`\r
`}),p}function bf(c,p,g){e:{for(E in g){var E=!1;break e}E=!0}E||(g=tv(g),typeof c=="string"?g!=null&&Va(g):ot(c,p,g))}function vt(c){X.call(this),this.headers=new Map,this.L=c||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}f(vt,X);var iR=/^https?$/i,oR=["POST","PUT"];t=vt.prototype,t.Fa=function(c){this.H=c},t.ea=function(c,p,g,E){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+c);p=p?p.toUpperCase():"GET",this.D=c,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():V_.g(),this.g.onreadystatechange=m(d(this.Ca,this));try{this.B=!0,this.g.open(p,String(c),!0),this.B=!1}catch(U){nv(this,U);return}if(c=g||"",g=new Map(this.headers),E)if(Object.getPrototypeOf(E)===Object.prototype)for(var L in E)g.set(L,E[L]);else if(typeof E.keys=="function"&&typeof E.get=="function")for(const U of E.keys())g.set(U,E.get(U));else throw Error("Unknown input type for opt_headers: "+String(E));E=Array.from(g.keys()).find(U=>U.toLowerCase()=="content-type"),L=o.FormData&&c instanceof o.FormData,!(Array.prototype.indexOf.call(oR,p,void 0)>=0)||E||L||g.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[U,ee]of g)this.g.setRequestHeader(U,ee);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(c),this.v=!1}catch(U){nv(this,U)}};function nv(c,p){c.h=!1,c.g&&(c.j=!0,c.g.abort(),c.j=!1),c.l=p,c.o=5,rv(c),Gc(c)}function rv(c){c.A||(c.A=!0,Q(c,"complete"),Q(c,"error"))}t.abort=function(c){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=c||7,Q(this,"complete"),Q(this,"abort"),Gc(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Gc(this,!0)),vt.Z.N.call(this)},t.Ca=function(){this.u||(this.B||this.v||this.j?sv(this):this.Xa())},t.Xa=function(){sv(this)};function sv(c){if(c.h&&typeof i<"u"){if(c.v&&cs(c)==4)setTimeout(c.Ca.bind(c),0);else if(Q(c,"readystatechange"),cs(c)==4){c.h=!1;try{const U=c.ca();e:switch(U){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var p=!0;break e;default:p=!1}var g;if(!(g=p)){var E;if(E=U===0){let ee=String(c.D).match(K_)[1]||null;!ee&&o.self&&o.self.location&&(ee=o.self.location.protocol.slice(0,-1)),E=!iR.test(ee?ee.toLowerCase():"")}g=E}if(g)Q(c,"complete"),Q(c,"success");else{c.o=6;try{var L=cs(c)>2?c.g.statusText:""}catch{L=""}c.l=L+" ["+c.ca()+"]",rv(c)}}finally{Gc(c)}}}}function Gc(c,p){if(c.g){c.m&&(clearTimeout(c.m),c.m=null);const g=c.g;c.g=null,p||Q(c,"ready");try{g.onreadystatechange=null}catch{}}}t.isActive=function(){return!!this.g};function cs(c){return c.g?c.g.readyState:0}t.ca=function(){try{return cs(this)>2?this.g.status:-1}catch{return-1}},t.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.La=function(c){if(this.g){var p=this.g.responseText;return c&&p.indexOf(c)==0&&(p=p.substring(c.length)),F(p)}};function iv(c){try{if(!c.g)return null;if("response"in c.g)return c.g.response;switch(c.F){case"":case"text":return c.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in c.g)return c.g.mozResponseArrayBuffer}return null}catch{return null}}function aR(c){const p={};c=(c.g&&cs(c)>=2&&c.g.getAllResponseHeaders()||"").split(`\r
`);for(let E=0;E<c.length;E++){if(P(c[E]))continue;var g=HA(c[E]);const L=g[0];if(g=g[1],typeof g!="string")continue;g=g.trim();const U=p[L]||[];p[L]=U,U.push(g)}G(p,function(E){return E.join(", ")})}t.ya=function(){return this.o},t.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function Ha(c,p,g){return g&&g.internalChannelParams&&g.internalChannelParams[c]||p}function ov(c){this.za=0,this.i=[],this.j=new en,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Ha("failFast",!1,c),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Ha("baseRetryDelayMs",5e3,c),this.Za=Ha("retryDelaySeedMs",1e4,c),this.Ta=Ha("forwardChannelMaxRetries",2,c),this.va=Ha("forwardChannelRequestTimeoutMs",2e4,c),this.ma=c&&c.xmlHttpFactory||void 0,this.Ua=c&&c.Rb||void 0,this.Aa=c&&c.useFetchStreams||!1,this.O=void 0,this.L=c&&c.supportsCrossDomainXhr||!1,this.M="",this.h=new B_(c&&c.concurrentRequestLimit),this.Ba=new sR,this.S=c&&c.fastHandshake||!1,this.R=c&&c.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=c&&c.Pb||!1,c&&c.ua&&this.j.ua(),c&&c.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&c&&c.detectBufferingProxy||!1,this.ia=void 0,c&&c.longPollingTimeout&&c.longPollingTimeout>0&&(this.ia=c.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}t=ov.prototype,t.ka=8,t.I=1,t.connect=function(c,p,g,E){Ve(0),this.W=c,this.H=p||{},g&&E!==void 0&&(this.H.OSID=g,this.H.OAID=E),this.F=this.X,this.J=mv(this,null,this.W),Yc(this)};function Cf(c){if(av(c),c.I==3){var p=c.V++,g=_r(c.J);if(ot(g,"SID",c.M),ot(g,"RID",p),ot(g,"TYPE","terminate"),Wa(c,g),p=new os(c,c.j,p),p.M=2,p.A=Wc(_r(g)),g=!1,o.navigator&&o.navigator.sendBeacon)try{g=o.navigator.sendBeacon(p.A.toString(),"")}catch{}!g&&o.Image&&(new Image().src=p.A,g=!0),g||(p.g=gv(p.j,null),p.g.ea(p.A)),p.F=Date.now(),Hc(p)}pv(c)}function Qc(c){c.g&&(Rf(c),c.g.cancel(),c.g=null)}function av(c){Qc(c),c.v&&(o.clearTimeout(c.v),c.v=null),Xc(c),c.h.cancel(),c.m&&(typeof c.m=="number"&&o.clearTimeout(c.m),c.m=null)}function Yc(c){if(!z_(c.h)&&!c.m){c.m=!0;var p=c.Ea;V||_(),M||(V(),M=!0),T.add(p,c),c.D=0}}function lR(c,p){return q_(c.h)>=c.h.j-(c.m?1:0)?!1:c.m?(c.i=p.G.concat(c.i),!0):c.I==1||c.I==2||c.D>=(c.Sa?0:c.Ta)?!1:(c.m=Ft(d(c.Ea,c,p),fv(c,c.D)),c.D++,!0)}t.Ea=function(c){if(this.m)if(this.m=null,this.I==1){if(!c){this.V=Math.floor(Math.random()*1e5),c=this.V++;const L=new os(this,this.j,c);let U=this.o;if(this.U&&(U?(U=je(U),B(U,this.U)):U=this.U),this.u!==null||this.R||(L.J=U,U=null),this.S)e:{for(var p=0,g=0;g<this.i.length;g++){t:{var E=this.i[g];if("__data__"in E.map&&(E=E.map.__data__,typeof E=="string")){E=E.length;break t}E=void 0}if(E===void 0)break;if(p+=E,p>4096){p=g;break e}if(p===4096||g===this.i.length-1){p=g+1;break e}}p=1e3}else p=1e3;p=cv(this,L,p),g=_r(this.J),ot(g,"RID",c),ot(g,"CVER",22),this.G&&ot(g,"X-HTTP-Session-Id",this.G),Wa(this,g),U&&(this.R?p="headers="+Va(tv(U))+"&"+p:this.u&&bf(g,this.u,U)),Tf(this.h,L),this.Ra&&ot(g,"TYPE","init"),this.S?(ot(g,"$req",p),ot(g,"SID","null"),L.U=!0,vf(L,g,null)):vf(L,g,p),this.I=2}}else this.I==3&&(c?lv(this,c):this.i.length==0||z_(this.h)||lv(this))};function lv(c,p){var g;p?g=p.l:g=c.V++;const E=_r(c.J);ot(E,"SID",c.M),ot(E,"RID",g),ot(E,"AID",c.K),Wa(c,E),c.u&&c.o&&bf(E,c.u,c.o),g=new os(c,c.j,g,c.D+1),c.u===null&&(g.J=c.o),p&&(c.i=p.G.concat(c.i)),p=cv(c,g,1e3),g.H=Math.round(c.va*.5)+Math.round(c.va*.5*Math.random()),Tf(c.h,g),vf(g,E,p)}function Wa(c,p){c.H&&ue(c.H,function(g,E){ot(p,E,g)}),c.l&&ue({},function(g,E){ot(p,E,g)})}function cv(c,p,g){g=Math.min(c.i.length,g);const E=c.l?d(c.l.Ka,c.l,c):null;e:{var L=c.i;let Re=-1;for(;;){const Dt=["count="+g];Re==-1?g>0?(Re=L[0].g,Dt.push("ofs="+Re)):Re=0:Dt.push("ofs="+Re);let nt=!0;for(let Ut=0;Ut<g;Ut++){var U=L[Ut].g;const vr=L[Ut].map;if(U-=Re,U<0)Re=Math.max(0,L[Ut].g-100),nt=!1;else try{U="req"+U+"_"||"";try{var ee=vr instanceof Map?vr:Object.entries(vr);for(const[ui,us]of ee){let ds=us;a(us)&&(ds=He(us)),Dt.push(U+ui+"="+encodeURIComponent(ds))}}catch(ui){throw Dt.push(U+"type="+encodeURIComponent("_badmap")),ui}}catch{E&&E(vr)}}if(nt){ee=Dt.join("&");break e}}ee=void 0}return c=c.i.splice(0,g),p.G=c,ee}function uv(c){if(!c.g&&!c.v){c.Y=1;var p=c.Da;V||_(),M||(V(),M=!0),T.add(p,c),c.A=0}}function Af(c){return c.g||c.v||c.A>=3?!1:(c.Y++,c.v=Ft(d(c.Da,c),fv(c,c.A)),c.A++,!0)}t.Da=function(){if(this.v=null,dv(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var c=4*this.T;this.j.info("BP detection timer enabled: "+c),this.B=Ft(d(this.Wa,this),c)}},t.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,Ve(10),Qc(this),dv(this))};function Rf(c){c.B!=null&&(o.clearTimeout(c.B),c.B=null)}function dv(c){c.g=new os(c,c.j,"rpc",c.Y),c.u===null&&(c.g.J=c.o),c.g.P=0;var p=_r(c.na);ot(p,"RID","rpc"),ot(p,"SID",c.M),ot(p,"AID",c.K),ot(p,"CI",c.F?"0":"1"),!c.F&&c.ia&&ot(p,"TO",c.ia),ot(p,"TYPE","xmlhttp"),Wa(c,p),c.u&&c.o&&bf(p,c.u,c.o),c.O&&(c.g.H=c.O);var g=c.g;c=c.ba,g.M=1,g.A=Wc(_r(p)),g.u=null,g.R=!0,F_(g,c)}t.Va=function(){this.C!=null&&(this.C=null,Qc(this),Af(this),Ve(19))};function Xc(c){c.C!=null&&(o.clearTimeout(c.C),c.C=null)}function hv(c,p){var g=null;if(c.g==p){Xc(c),Rf(c),c.g=null;var E=2}else if(If(c.h,p))g=p.G,H_(c.h,p),E=1;else return;if(c.I!=0){if(p.o)if(E==1){g=p.u?p.u.length:0,p=Date.now()-p.F;var L=c.D;E=me(),Q(E,new At(E,g)),Yc(c)}else uv(c);else if(L=p.m,L==3||L==0&&p.X>0||!(E==1&&lR(c,p)||E==2&&Af(c)))switch(g&&g.length>0&&(p=c.h,p.i=p.i.concat(g)),L){case 1:ci(c,5);break;case 4:ci(c,10);break;case 3:ci(c,6);break;default:ci(c,2)}}}function fv(c,p){let g=c.Qa+Math.floor(Math.random()*c.Za);return c.isActive()||(g*=2),g*p}function ci(c,p){if(c.j.info("Error code "+p),p==2){var g=d(c.bb,c),E=c.Ua;const L=!E;E=new as(E||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||Ma(E,"https"),Wc(E),L?nR(E.toString(),g):rR(E.toString(),g)}else Ve(2);c.I=0,c.l&&c.l.pa(p),pv(c),av(c)}t.bb=function(c){c?(this.j.info("Successfully pinged google.com"),Ve(2)):(this.j.info("Failed to ping google.com"),Ve(1))};function pv(c){if(c.I=0,c.ja=[],c.l){const p=W_(c.h);(p.length!=0||c.i.length!=0)&&(R(c.ja,p),R(c.ja,c.i),c.h.i.length=0,v(c.i),c.i.length=0),c.l.oa()}}function mv(c,p,g){var E=g instanceof as?_r(g):new as(g);if(E.g!="")p&&(E.g=p+"."+E.g),Fa(E,E.u);else{var L=o.location;E=L.protocol,p=p?p+"."+L.hostname:L.hostname,L=+L.port;const U=new as(null);E&&Ma(U,E),p&&(U.g=p),L&&Fa(U,L),g&&(U.h=g),E=U}return g=c.G,p=c.wa,g&&p&&ot(E,g,p),ot(E,"VER",c.ka),Wa(c,E),E}function gv(c,p,g){if(p&&!c.L)throw Error("Can't create secondary domain capable XhrIo object.");return p=c.Aa&&!c.ma?new vt(new Sf({ab:g})):new vt(c.ma),p.Fa(c.L),p}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function yv(){}t=yv.prototype,t.ra=function(){},t.qa=function(){},t.pa=function(){},t.oa=function(){},t.isActive=function(){return!0},t.Ka=function(){};function Jc(){}Jc.prototype.g=function(c,p){return new Pn(c,p)};function Pn(c,p){X.call(this),this.g=new ov(p),this.l=c,this.h=p&&p.messageUrlParams||null,c=p&&p.messageHeaders||null,p&&p.clientProtocolHeaderRequired&&(c?c["X-Client-Protocol"]="webchannel":c={"X-Client-Protocol":"webchannel"}),this.g.o=c,c=p&&p.initMessageHeaders||null,p&&p.messageContentType&&(c?c["X-WebChannel-Content-Type"]=p.messageContentType:c={"X-WebChannel-Content-Type":p.messageContentType}),p&&p.sa&&(c?c["X-WebChannel-Client-Profile"]=p.sa:c={"X-WebChannel-Client-Profile":p.sa}),this.g.U=c,(c=p&&p.Qb)&&!P(c)&&(this.g.u=c),this.A=p&&p.supportsCrossDomainXhr||!1,this.v=p&&p.sendRawJson||!1,(p=p&&p.httpSessionIdParam)&&!P(p)&&(this.g.G=p,c=this.h,c!==null&&p in c&&(c=this.h,p in c&&delete c[p])),this.j=new co(this)}f(Pn,X),Pn.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},Pn.prototype.close=function(){Cf(this.g)},Pn.prototype.o=function(c){var p=this.g;if(typeof c=="string"){var g={};g.__data__=c,c=g}else this.v&&(g={},g.__data__=He(c),c=g);p.i.push(new GA(p.Ya++,c)),p.I==3&&Yc(p)},Pn.prototype.N=function(){this.g.l=null,delete this.j,Cf(this.g),delete this.g,Pn.Z.N.call(this)};function _v(c){x.call(this),c.__headers__&&(this.headers=c.__headers__,this.statusCode=c.__status__,delete c.__headers__,delete c.__status__);var p=c.__sm__;if(p){e:{for(const g in p){c=g;break e}c=void 0}(this.i=c)&&(c=this.i,p=p!==null&&c in p?p[c]:void 0),this.data=p}else this.data=c}f(_v,x);function vv(){z.call(this),this.status=1}f(vv,z);function co(c){this.g=c}f(co,yv),co.prototype.ra=function(){Q(this.g,"a")},co.prototype.qa=function(c){Q(this.g,new _v(c))},co.prototype.pa=function(c){Q(this.g,new vv)},co.prototype.oa=function(){Q(this.g,"b")},Jc.prototype.createWebChannel=Jc.prototype.g,Pn.prototype.send=Pn.prototype.o,Pn.prototype.open=Pn.prototype.m,Pn.prototype.close=Pn.prototype.close,GS=function(){return new Jc},KS=function(){return me()},WS=ie,Om={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},qc.NO_ERROR=0,qc.TIMEOUT=8,qc.HTTP_ERROR=6,Qu=qc,O_.COMPLETE="complete",HS=O_,Ce.EventType=_t,_t.OPEN="a",_t.CLOSE="b",_t.ERROR="c",_t.MESSAGE="d",X.prototype.listen=X.prototype.J,ml=Ce,vt.prototype.listenOnce=vt.prototype.K,vt.prototype.getLastError=vt.prototype.Ha,vt.prototype.getLastErrorCode=vt.prototype.ya,vt.prototype.getStatus=vt.prototype.ca,vt.prototype.getResponseJson=vt.prototype.La,vt.prototype.getResponseText=vt.prototype.la,vt.prototype.send=vt.prototype.ea,vt.prototype.setWithCredentials=vt.prototype.Fa,qS=vt}).apply(typeof vu<"u"?vu:typeof self<"u"?self:typeof window<"u"?window:{});const pE="@firebase/firestore",mE="4.9.2";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wt{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Wt.UNAUTHENTICATED=new Wt(null),Wt.GOOGLE_CREDENTIALS=new Wt("google-credentials-uid"),Wt.FIRST_PARTY=new Wt("first-party-uid"),Wt.MOCK_USER=new Wt("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ka="12.3.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bi=new Rh("@firebase/firestore");function So(){return Bi.logLevel}function H(t,...e){if(Bi.logLevel<=Le.DEBUG){const n=e.map(xy);Bi.debug(`Firestore (${ka}): ${t}`,...n)}}function pn(t,...e){if(Bi.logLevel<=Le.ERROR){const n=e.map(xy);Bi.error(`Firestore (${ka}): ${t}`,...n)}}function zi(t,...e){if(Bi.logLevel<=Le.WARN){const n=e.map(xy);Bi.warn(`Firestore (${ka}): ${t}`,...n)}}function xy(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function le(t,e,n){let r="Unexpected state";typeof e=="string"?r=e:n=e,QS(t,r,n)}function QS(t,e,n){let r=`FIRESTORE (${ka}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(n!==void 0)try{r+=" CONTEXT: "+JSON.stringify(n)}catch{r+=" CONTEXT: "+n}throw pn(r),new Error(r)}function ce(t,e,n,r){let s="Unexpected state";typeof n=="string"?s=n:r=n,t||QS(e,s,r)}function ve(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class K extends er{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ur{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YS{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class X2{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(Wt.UNAUTHENTICATED))}shutdown(){}}class J2{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class Z2{constructor(e){this.t=e,this.currentUser=Wt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){ce(this.o===void 0,42304);let r=this.i;const s=l=>this.i!==r?(r=this.i,n(l)):Promise.resolve();let i=new ur;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new ur,e.enqueueRetryable(()=>s(this.currentUser))};const o=()=>{const l=i;e.enqueueRetryable(async()=>{await l.promise,await s(this.currentUser)})},a=l=>{H("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(l=>a(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?a(l):(H("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new ur)}},0),o()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(H("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(ce(typeof r.accessToken=="string",31837,{l:r}),new YS(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return ce(e===null||typeof e=="string",2055,{h:e}),new Wt(e)}}class eO{constructor(e,n,r){this.P=e,this.T=n,this.I=r,this.type="FirstParty",this.user=Wt.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class tO{constructor(e,n,r){this.P=e,this.T=n,this.I=r}getToken(){return Promise.resolve(new eO(this.P,this.T,this.I))}start(e,n){e.enqueueRetryable(()=>n(Wt.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class gE{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class nO{constructor(e,n){this.V=n,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,qn(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,n){ce(this.o===void 0,3512);const r=i=>{i.error!=null&&H("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.m;return this.m=i.token,H("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>r(i))};const s=i=>{H("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(i=>s(i)),setTimeout(()=>{if(!this.appCheck){const i=this.V.getImmediate({optional:!0});i?s(i):H("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new gE(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(ce(typeof n.token=="string",44558,{tokenResult:n}),this.m=n.token,new gE(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rO(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sy{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const s=rO(40);for(let i=0;i<s.length;++i)r.length<20&&s[i]<n&&(r+=e.charAt(s[i]%62))}return r}}function Te(t,e){return t<e?-1:t>e?1:0}function Vm(t,e){const n=Math.min(t.length,e.length);for(let r=0;r<n;r++){const s=t.charAt(r),i=e.charAt(r);if(s!==i)return hp(s)===hp(i)?Te(s,i):hp(s)?1:-1}return Te(t.length,e.length)}const sO=55296,iO=57343;function hp(t){const e=t.charCodeAt(0);return e>=sO&&e<=iO}function ua(t,e,n){return t.length===e.length&&t.every((r,s)=>n(r,e[s]))}function XS(t){return t+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yE="__name__";class xr{constructor(e,n,r){n===void 0?n=0:n>e.length&&le(637,{offset:n,range:e.length}),r===void 0?r=e.length-n:r>e.length-n&&le(1746,{length:r,range:e.length-n}),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return xr.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof xr?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let s=0;s<r;s++){const i=xr.compareSegments(e.get(s),n.get(s));if(i!==0)return i}return Te(e.length,n.length)}static compareSegments(e,n){const r=xr.isNumericId(e),s=xr.isNumericId(n);return r&&!s?-1:!r&&s?1:r&&s?xr.extractNumericId(e).compare(xr.extractNumericId(n)):Vm(e,n)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Bs.fromString(e.substring(4,e.length-2))}}class We extends xr{construct(e,n,r){return new We(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new K($.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(s=>s.length>0))}return new We(n)}static emptyPath(){return new We([])}}const oO=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class mt extends xr{construct(e,n,r){return new mt(e,n,r)}static isValidIdentifier(e){return oO.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),mt.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===yE}static keyField(){return new mt([yE])}static fromServerFormat(e){const n=[];let r="",s=0;const i=()=>{if(r.length===0)throw new K($.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let o=!1;for(;s<e.length;){const a=e[s];if(a==="\\"){if(s+1===e.length)throw new K($.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[s+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new K($.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=l,s+=2}else a==="`"?(o=!o,s++):a!=="."||o?(r+=a,s++):(i(),s++)}if(i(),o)throw new K($.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new mt(n)}static emptyPath(){return new mt([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class te{constructor(e){this.path=e}static fromPath(e){return new te(We.fromString(e))}static fromName(e){return new te(We.fromString(e).popFirst(5))}static empty(){return new te(We.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&We.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return We.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new te(new We(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function JS(t,e,n){if(!n)throw new K($.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function aO(t,e,n,r){if(e===!0&&r===!0)throw new K($.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function _E(t){if(!te.isDocumentKey(t))throw new K($.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function vE(t){if(te.isDocumentKey(t))throw new K($.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function ZS(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function Oh(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":le(12329,{type:typeof t})}function cn(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new K($.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Oh(t);throw new K($.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}function lO(t,e){if(e<=0)throw new K($.INVALID_ARGUMENT,`Function ${t}() requires a positive number, but it was: ${e}.`)}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kt(t,e){const n={typeString:t};return e&&(n.value=e),n}function kc(t,e){if(!ZS(t))throw new K($.INVALID_ARGUMENT,"JSON must be an object");let n;for(const r in e)if(e[r]){const s=e[r].typeString,i="value"in e[r]?{value:e[r].value}:void 0;if(!(r in t)){n=`JSON missing required field: '${r}'`;break}const o=t[r];if(s&&typeof o!==s){n=`JSON field '${r}' must be a ${s}.`;break}if(i!==void 0&&o!==i.value){n=`Expected '${r}' field to equal '${i.value}'`;break}}if(n)throw new K($.INVALID_ARGUMENT,n);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wE=-62135596800,EE=1e6;class Be{static now(){return Be.fromMillis(Date.now())}static fromDate(e){return Be.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor((e-1e3*n)*EE);return new Be(n,r)}constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new K($.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new K($.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<wE)throw new K($.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new K($.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/EE}_compareTo(e){return this.seconds===e.seconds?Te(this.nanoseconds,e.nanoseconds):Te(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:Be._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(kc(e,Be._jsonSchema))return new Be(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-wE;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}Be._jsonSchemaVersion="firestore/timestamp/1.0",Be._jsonSchema={type:kt("string",Be._jsonSchemaVersion),seconds:kt("number"),nanoseconds:kt("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fe{static fromTimestamp(e){return new fe(e)}static min(){return new fe(new Be(0,0))}static max(){return new fe(new Be(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lc=-1;class $d{constructor(e,n,r,s){this.indexId=e,this.collectionGroup=n,this.fields=r,this.indexState=s}}function Lm(t){return t.fields.find(e=>e.kind===2)}function gi(t){return t.fields.filter(e=>e.kind!==2)}$d.UNKNOWN_ID=-1;class Yu{constructor(e,n){this.fieldPath=e,this.kind=n}}class cc{constructor(e,n){this.sequenceNumber=e,this.offset=n}static empty(){return new cc(0,Mn.min())}}function cO(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,s=fe.fromTimestamp(r===1e9?new Be(n+1,0):new Be(n,r));return new Mn(s,te.empty(),e)}function eb(t){return new Mn(t.readTime,t.key,lc)}class Mn{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new Mn(fe.min(),te.empty(),lc)}static max(){return new Mn(fe.max(),te.empty(),lc)}}function by(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=te.comparator(t.documentKey,e.documentKey),n!==0?n:Te(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tb="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class nb{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function oo(t){if(t.code!==$.FAILED_PRECONDITION||t.message!==tb)throw t;H("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&le(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new O((r,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(r,s)},this.catchCallback=i=>{this.wrapFailure(n,i).next(r,s)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof O?n:O.resolve(n)}catch(n){return O.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):O.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):O.reject(n)}static resolve(e){return new O((n,r)=>{n(e)})}static reject(e){return new O((n,r)=>{r(e)})}static waitFor(e){return new O((n,r)=>{let s=0,i=0,o=!1;e.forEach(a=>{++s,a.next(()=>{++i,o&&i===s&&n()},l=>r(l))}),o=!0,i===s&&n()})}static or(e){let n=O.resolve(!1);for(const r of e)n=n.next(s=>s?O.resolve(s):r());return n}static forEach(e,n){const r=[];return e.forEach((s,i)=>{r.push(n.call(this,s,i))}),this.waitFor(r)}static mapArray(e,n){return new O((r,s)=>{const i=e.length,o=new Array(i);let a=0;for(let l=0;l<i;l++){const d=l;n(e[d]).next(h=>{o[d]=h,++a,a===i&&r(o)},h=>s(h))}})}static doWhile(e,n){return new O((r,s)=>{const i=()=>{e()===!0?n().next(()=>{i()},s):r()};i()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nn="SimpleDb";class Vh{static open(e,n,r,s){try{return new Vh(n,e.transaction(s,r))}catch(i){throw new Dl(n,i)}}constructor(e,n){this.action=e,this.transaction=n,this.aborted=!1,this.S=new ur,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{n.error?this.S.reject(new Dl(e,n.error)):this.S.resolve()},this.transaction.onerror=r=>{const s=Cy(r.target.error);this.S.reject(new Dl(e,s))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(H(Nn,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}C(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const n=this.transaction.objectStore(e);return new dO(n)}}class zs{static delete(e){return H(Nn,"Removing database:",e),_i(Wx().indexedDB.deleteDatabase(e)).toPromise()}static v(){if(!hy())return!1;if(zs.F())return!0;const e=Vt(),n=zs.M(e),r=0<n&&n<10,s=rb(e),i=0<s&&s<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||i)}static F(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)==null?void 0:e.__PRIVATE_USE_MOCK_PERSISTENCE)==="YES"}static O(e,n){return e.store(n)}static M(e){const n=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=n?n[1].split("_").slice(0,2).join("."):"-1";return Number(r)}constructor(e,n,r){this.name=e,this.version=n,this.N=r,this.B=null,zs.M(Vt())===12.2&&pn("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async L(e){return this.db||(H(Nn,"Opening database:",this.name),this.db=await new Promise((n,r)=>{const s=indexedDB.open(this.name,this.version);s.onsuccess=i=>{const o=i.target.result;n(o)},s.onblocked=()=>{r(new Dl(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},s.onerror=i=>{const o=i.target.error;o.name==="VersionError"?r(new K($.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?r(new K($.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):r(new Dl(e,o))},s.onupgradeneeded=i=>{H(Nn,'Database "'+this.name+'" requires upgrade from version:',i.oldVersion);const o=i.target.result;this.N.k(o,s.transaction,i.oldVersion,this.version).next(()=>{H(Nn,"Database upgrade to version "+this.version+" complete")})}})),this.q&&(this.db.onversionchange=n=>this.q(n)),this.db}$(e){this.q=e,this.db&&(this.db.onversionchange=n=>e(n))}async runTransaction(e,n,r,s){const i=n==="readonly";let o=0;for(;;){++o;try{this.db=await this.L(e);const a=Vh.open(this.db,e,i?"readonly":"readwrite",r),l=s(a).next(d=>(a.C(),d)).catch(d=>(a.abort(d),O.reject(d))).toPromise();return l.catch(()=>{}),await a.D,l}catch(a){const l=a,d=l.name!=="FirebaseError"&&o<3;if(H(Nn,"Transaction failed with error:",l.message,"Retrying:",d),this.close(),!d)return Promise.reject(l)}}}close(){this.db&&this.db.close(),this.db=void 0}}function rb(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}class uO{constructor(e){this.U=e,this.K=!1,this.W=null}get isDone(){return this.K}get G(){return this.W}set cursor(e){this.U=e}done(){this.K=!0}j(e){this.W=e}delete(){return _i(this.U.delete())}}class Dl extends K{constructor(e,n){super($.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${n}`),this.name="IndexedDbTransactionError"}}function si(t){return t.name==="IndexedDbTransactionError"}class dO{constructor(e){this.store=e}put(e,n){let r;return n!==void 0?(H(Nn,"PUT",this.store.name,e,n),r=this.store.put(n,e)):(H(Nn,"PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),_i(r)}add(e){return H(Nn,"ADD",this.store.name,e,e),_i(this.store.add(e))}get(e){return _i(this.store.get(e)).next(n=>(n===void 0&&(n=null),H(Nn,"GET",this.store.name,e,n),n))}delete(e){return H(Nn,"DELETE",this.store.name,e),_i(this.store.delete(e))}count(){return H(Nn,"COUNT",this.store.name),_i(this.store.count())}J(e,n){const r=this.options(e,n),s=r.index?this.store.index(r.index):this.store;if(typeof s.getAll=="function"){const i=s.getAll(r.range);return new O((o,a)=>{i.onerror=l=>{a(l.target.error)},i.onsuccess=l=>{o(l.target.result)}})}{const i=this.cursor(r),o=[];return this.H(i,(a,l)=>{o.push(l)}).next(()=>o)}}Y(e,n){const r=this.store.getAll(e,n===null?void 0:n);return new O((s,i)=>{r.onerror=o=>{i(o.target.error)},r.onsuccess=o=>{s(o.target.result)}})}Z(e,n){H(Nn,"DELETE ALL",this.store.name);const r=this.options(e,n);r.X=!1;const s=this.cursor(r);return this.H(s,(i,o,a)=>a.delete())}ee(e,n){let r;n?r=e:(r={},n=e);const s=this.cursor(r);return this.H(s,n)}te(e){const n=this.cursor({});return new O((r,s)=>{n.onerror=i=>{const o=Cy(i.target.error);s(o)},n.onsuccess=i=>{const o=i.target.result;o?e(o.primaryKey,o.value).next(a=>{a?o.continue():r()}):r()}})}H(e,n){const r=[];return new O((s,i)=>{e.onerror=o=>{i(o.target.error)},e.onsuccess=o=>{const a=o.target.result;if(!a)return void s();const l=new uO(a),d=n(a.primaryKey,a.value,l);if(d instanceof O){const h=d.catch(f=>(l.done(),O.reject(f)));r.push(h)}l.isDone?s():l.G===null?a.continue():a.continue(l.G)}}).next(()=>O.waitFor(r))}options(e,n){let r;return e!==void 0&&(typeof e=="string"?r=e:n=e),{index:r,range:n}}cursor(e){let n="next";if(e.reverse&&(n="prev"),e.index){const r=this.store.index(e.index);return e.X?r.openKeyCursor(e.range,n):r.openCursor(e.range,n)}return this.store.openCursor(e.range,n)}}function _i(t){return new O((e,n)=>{t.onsuccess=r=>{const s=r.target.result;e(s)},t.onerror=r=>{const s=Cy(r.target.error);n(s)}})}let IE=!1;function Cy(t){const e=zs.M(Vt());if(e>=12.2&&e<13){const n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){const r=new K("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${n}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return IE||(IE=!0,setTimeout(()=>{throw r},0)),r}}return t}const jl="IndexBackfiller";class hO{constructor(e,n){this.asyncQueue=e,this.ne=n,this.task=null}start(){this.re(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}re(e){H(jl,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{const n=await this.ne.ie();H(jl,`Documents written: ${n}`)}catch(n){si(n)?H(jl,"Ignoring IndexedDB error during index backfill: ",n):await oo(n)}await this.re(6e4)})}}class fO{constructor(e,n){this.localStore=e,this.persistence=n}async ie(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",n=>this.se(n,e))}se(e,n){const r=new Set;let s=n,i=!0;return O.doWhile(()=>i===!0&&s>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(o!==null&&!r.has(o))return H(jl,`Processing collection: ${o}`),this.oe(e,o,s).next(a=>{s-=a,r.add(o)});i=!1})).next(()=>n-s)}oe(e,n,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,n).next(s=>this.localStore.localDocuments.getNextDocuments(e,n,s,r).next(i=>{const o=i.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this._e(s,i)).next(a=>(H(jl,`Updating offset: ${a}`),this.localStore.indexManager.updateCollectionGroup(e,n,a))).next(()=>o.size)}))}_e(e,n){let r=e;return n.changes.forEach((s,i)=>{const o=eb(i);by(o,r)>0&&(r=o)}),new Mn(r.readTime,r.documentKey,Math.max(n.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kn{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ae(r),this.ue=r=>n.writeSequenceNumber(r))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}Kn.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pi=-1;function Lh(t){return t==null}function uc(t){return t===0&&1/t==-1/0}function pO(t){return typeof t=="number"&&Number.isInteger(t)&&!uc(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bd="";function un(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=TE(e)),e=mO(t.get(n),e);return TE(e)}function mO(t,e){let n=e;const r=t.length;for(let s=0;s<r;s++){const i=t.charAt(s);switch(i){case"\0":n+="";break;case Bd:n+="";break;default:n+=i}}return n}function TE(t){return t+Bd+""}function br(t){const e=t.length;if(ce(e>=2,64408,{path:t}),e===2)return ce(t.charAt(0)===Bd&&t.charAt(1)==="",56145,{path:t}),We.emptyPath();const n=e-2,r=[];let s="";for(let i=0;i<e;){const o=t.indexOf(Bd,i);switch((o<0||o>n)&&le(50515,{path:t}),t.charAt(o+1)){case"":const a=t.substring(i,o);let l;s.length===0?l=a:(s+=a,l=s,s=""),r.push(l);break;case"":s+=t.substring(i,o),s+="\0";break;case"":s+=t.substring(i,o+1);break;default:le(61167,{path:t})}i=o+2}return new We(r)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yi="remoteDocuments",Nc="owner",ho="owner",dc="mutationQueues",gO="userId",sr="mutations",xE="batchId",bi="userMutationsIndex",SE=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xu(t,e){return[t,un(e)]}function sb(t,e,n){return[t,un(e),n]}const yO={},da="documentMutations",zd="remoteDocumentsV14",_O=["prefixPath","collectionGroup","readTime","documentId"],Ju="documentKeyIndex",vO=["prefixPath","collectionGroup","documentId"],ib="collectionGroupIndex",wO=["collectionGroup","readTime","prefixPath","documentId"],hc="remoteDocumentGlobal",Mm="remoteDocumentGlobalKey",ha="targets",ob="queryTargetsIndex",EO=["canonicalId","targetId"],fa="targetDocuments",IO=["targetId","path"],Ay="documentTargetsIndex",TO=["path","targetId"],qd="targetGlobalKey",ki="targetGlobal",fc="collectionParents",xO=["collectionId","parent"],pa="clientMetadata",SO="clientId",Mh="bundles",bO="bundleId",Fh="namedQueries",CO="name",Ry="indexConfiguration",AO="indexId",Fm="collectionGroupIndex",RO="collectionGroup",Ol="indexState",PO=["indexId","uid"],ab="sequenceNumberIndex",kO=["uid","sequenceNumber"],Vl="indexEntries",NO=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],lb="documentKeyIndex",DO=["indexId","uid","orderedDocumentKey"],Uh="documentOverlays",jO=["userId","collectionPath","documentId"],Um="collectionPathOverlayIndex",OO=["userId","collectionPath","largestBatchId"],cb="collectionGroupOverlayIndex",VO=["userId","collectionGroup","largestBatchId"],Py="globals",LO="name",ub=[dc,sr,da,yi,ha,Nc,ki,fa,pa,hc,fc,Mh,Fh],MO=[...ub,Uh],db=[dc,sr,da,zd,ha,Nc,ki,fa,pa,hc,fc,Mh,Fh,Uh],hb=db,ky=[...hb,Ry,Ol,Vl],FO=ky,fb=[...ky,Py],UO=fb;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $m extends nb{constructor(e,n){super(),this.le=e,this.currentSequenceNumber=n}}function Lt(t,e){const n=ve(t);return zs.O(n.le,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bE(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function ii(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function $O(t,e){const n=[];for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&n.push(e(t[r],r,t));return n}function pb(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ht{constructor(e,n){this.comparator=e,this.root=n||Kt.EMPTY}insert(e,n){return new ht(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,Kt.BLACK,null,null))}remove(e){return new ht(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Kt.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(e,r.key);if(s===0)return n+r.left.size;s<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new wu(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new wu(this.root,e,this.comparator,!1)}getReverseIterator(){return new wu(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new wu(this.root,e,this.comparator,!0)}}class wu{constructor(e,n,r,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=n?r(e.key,n):1,n&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Kt{constructor(e,n,r,s,i){this.key=e,this.value=n,this.color=r??Kt.RED,this.left=s??Kt.EMPTY,this.right=i??Kt.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,s,i){return new Kt(e??this.key,n??this.value,r??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let s=this;const i=r(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,n,r),null):i===0?s.copy(null,n,null,null,null):s.copy(null,null,null,null,s.right.insert(e,n,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return Kt.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,s=this;if(n(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,n),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),n(e,s.key)===0){if(s.right.isEmpty())return Kt.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,n))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Kt.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Kt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw le(43730,{key:this.key,value:this.value});if(this.right.isRed())throw le(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw le(27949);return e+(this.isRed()?0:1)}}Kt.EMPTY=null,Kt.RED=!0,Kt.BLACK=!1;Kt.EMPTY=new class{constructor(){this.size=0}get key(){throw le(57766)}get value(){throw le(16141)}get color(){throw le(16727)}get left(){throw le(29726)}get right(){throw le(36894)}copy(e,n,r,s,i){return this}insert(e,n,r){return new Kt(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tt{constructor(e){this.comparator=e,this.data=new ht(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,e[1])>=0)return;n(s.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new CE(this.data.getIterator())}getIteratorFrom(e){return new CE(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof tt)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new tt(this.comparator);return n.data=e,n}}class CE{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function fo(t){return t.hasNext()?t.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sn{constructor(e){this.fields=e,e.sort(mt.comparator)}static empty(){return new Sn([])}unionWith(e){let n=new tt(mt.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new Sn(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return ua(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mb extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nt{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(s){try{return atob(s)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new mb("Invalid base64 string: "+i):i}}(e);return new Nt(n)}static fromUint8Array(e){const n=function(s){let i="";for(let o=0;o<s.length;++o)i+=String.fromCharCode(s[o]);return i}(e);return new Nt(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Te(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Nt.EMPTY_BYTE_STRING=new Nt("");const BO=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ts(t){if(ce(!!t,39018),typeof t=="string"){let e=0;const n=BO.exec(t);if(ce(!!n,46558,{timestamp:t}),n[1]){let s=n[1];s=(s+"000000000").substr(0,9),e=Number(s)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:ct(t.seconds),nanos:ct(t.nanos)}}function ct(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function ns(t){return typeof t=="string"?Nt.fromBase64String(t):Nt.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gb="server_timestamp",yb="__type__",_b="__previous_value__",vb="__local_write_time__";function $h(t){var n,r;return((r=(((n=t==null?void 0:t.mapValue)==null?void 0:n.fields)||{})[yb])==null?void 0:r.stringValue)===gb}function Bh(t){const e=t.mapValue.fields[_b];return $h(e)?Bh(e):e}function pc(t){const e=ts(t.mapValue.fields[vb].timestampValue);return new Be(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zO{constructor(e,n,r,s,i,o,a,l,d,h){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=s,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=l,this.useFetchStreams=d,this.isUsingEmulator=h}}const Hd="(default)";class qi{constructor(e,n){this.projectId=e,this.database=n||Hd}static empty(){return new qi("","")}get isDefaultDatabase(){return this.database===Hd}isEqual(e){return e instanceof qi&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ny="__type__",wb="__max__",Ps={mapValue:{fields:{__type__:{stringValue:wb}}}},Dy="__vector__",ma="value",Zu={nullValue:"NULL_VALUE"};function Ks(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?$h(t)?4:Eb(t)?9007199254740991:zh(t)?10:11:le(28295,{value:t})}function Or(t,e){if(t===e)return!0;const n=Ks(t);if(n!==Ks(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return pc(t).isEqual(pc(e));case 3:return function(s,i){if(typeof s.timestampValue=="string"&&typeof i.timestampValue=="string"&&s.timestampValue.length===i.timestampValue.length)return s.timestampValue===i.timestampValue;const o=ts(s.timestampValue),a=ts(i.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(s,i){return ns(s.bytesValue).isEqual(ns(i.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(s,i){return ct(s.geoPointValue.latitude)===ct(i.geoPointValue.latitude)&&ct(s.geoPointValue.longitude)===ct(i.geoPointValue.longitude)}(t,e);case 2:return function(s,i){if("integerValue"in s&&"integerValue"in i)return ct(s.integerValue)===ct(i.integerValue);if("doubleValue"in s&&"doubleValue"in i){const o=ct(s.doubleValue),a=ct(i.doubleValue);return o===a?uc(o)===uc(a):isNaN(o)&&isNaN(a)}return!1}(t,e);case 9:return ua(t.arrayValue.values||[],e.arrayValue.values||[],Or);case 10:case 11:return function(s,i){const o=s.mapValue.fields||{},a=i.mapValue.fields||{};if(bE(o)!==bE(a))return!1;for(const l in o)if(o.hasOwnProperty(l)&&(a[l]===void 0||!Or(o[l],a[l])))return!1;return!0}(t,e);default:return le(52216,{left:t})}}function mc(t,e){return(t.values||[]).find(n=>Or(n,e))!==void 0}function Gs(t,e){if(t===e)return 0;const n=Ks(t),r=Ks(e);if(n!==r)return Te(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return Te(t.booleanValue,e.booleanValue);case 2:return function(i,o){const a=ct(i.integerValue||i.doubleValue),l=ct(o.integerValue||o.doubleValue);return a<l?-1:a>l?1:a===l?0:isNaN(a)?isNaN(l)?0:-1:1}(t,e);case 3:return AE(t.timestampValue,e.timestampValue);case 4:return AE(pc(t),pc(e));case 5:return Vm(t.stringValue,e.stringValue);case 6:return function(i,o){const a=ns(i),l=ns(o);return a.compareTo(l)}(t.bytesValue,e.bytesValue);case 7:return function(i,o){const a=i.split("/"),l=o.split("/");for(let d=0;d<a.length&&d<l.length;d++){const h=Te(a[d],l[d]);if(h!==0)return h}return Te(a.length,l.length)}(t.referenceValue,e.referenceValue);case 8:return function(i,o){const a=Te(ct(i.latitude),ct(o.latitude));return a!==0?a:Te(ct(i.longitude),ct(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return RE(t.arrayValue,e.arrayValue);case 10:return function(i,o){var m,v,R,b;const a=i.fields||{},l=o.fields||{},d=(m=a[ma])==null?void 0:m.arrayValue,h=(v=l[ma])==null?void 0:v.arrayValue,f=Te(((R=d==null?void 0:d.values)==null?void 0:R.length)||0,((b=h==null?void 0:h.values)==null?void 0:b.length)||0);return f!==0?f:RE(d,h)}(t.mapValue,e.mapValue);case 11:return function(i,o){if(i===Ps.mapValue&&o===Ps.mapValue)return 0;if(i===Ps.mapValue)return 1;if(o===Ps.mapValue)return-1;const a=i.fields||{},l=Object.keys(a),d=o.fields||{},h=Object.keys(d);l.sort(),h.sort();for(let f=0;f<l.length&&f<h.length;++f){const m=Vm(l[f],h[f]);if(m!==0)return m;const v=Gs(a[l[f]],d[h[f]]);if(v!==0)return v}return Te(l.length,h.length)}(t.mapValue,e.mapValue);default:throw le(23264,{he:n})}}function AE(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return Te(t,e);const n=ts(t),r=ts(e),s=Te(n.seconds,r.seconds);return s!==0?s:Te(n.nanos,r.nanos)}function RE(t,e){const n=t.values||[],r=e.values||[];for(let s=0;s<n.length&&s<r.length;++s){const i=Gs(n[s],r[s]);if(i)return i}return Te(n.length,r.length)}function ga(t){return Bm(t)}function Bm(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=ts(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return ns(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return te.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",s=!0;for(const i of n.values||[])s?s=!1:r+=",",r+=Bm(i);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let s="{",i=!0;for(const o of r)i?i=!1:s+=",",s+=`${o}:${Bm(n.fields[o])}`;return s+"}"}(t.mapValue):le(61005,{value:t})}function ed(t){switch(Ks(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Bh(t);return e?16+ed(e):16;case 5:return 2*t.stringValue.length;case 6:return ns(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return function(r){return(r.values||[]).reduce((s,i)=>s+ed(i),0)}(t.arrayValue);case 10:case 11:return function(r){let s=0;return ii(r.fields,(i,o)=>{s+=i.length+ed(o)}),s}(t.mapValue);default:throw le(13486,{value:t})}}function Hi(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function zm(t){return!!t&&"integerValue"in t}function gc(t){return!!t&&"arrayValue"in t}function PE(t){return!!t&&"nullValue"in t}function kE(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function td(t){return!!t&&"mapValue"in t}function zh(t){var n,r;return((r=(((n=t==null?void 0:t.mapValue)==null?void 0:n.fields)||{})[Ny])==null?void 0:r.stringValue)===Dy}function Ll(t){if(t.geoPointValue)return{geoPointValue:{...t.geoPointValue}};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:{...t.timestampValue}};if(t.mapValue){const e={mapValue:{fields:{}}};return ii(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=Ll(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=Ll(t.arrayValue.values[n]);return e}return{...t}}function Eb(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===wb}const Ib={mapValue:{fields:{[Ny]:{stringValue:Dy},[ma]:{arrayValue:{}}}}};function qO(t){return"nullValue"in t?Zu:"booleanValue"in t?{booleanValue:!1}:"integerValue"in t||"doubleValue"in t?{doubleValue:NaN}:"timestampValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in t?{stringValue:""}:"bytesValue"in t?{bytesValue:""}:"referenceValue"in t?Hi(qi.empty(),te.empty()):"geoPointValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in t?{arrayValue:{}}:"mapValue"in t?zh(t)?Ib:{mapValue:{}}:le(35942,{value:t})}function HO(t){return"nullValue"in t?{booleanValue:!1}:"booleanValue"in t?{doubleValue:NaN}:"integerValue"in t||"doubleValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in t?{stringValue:""}:"stringValue"in t?{bytesValue:""}:"bytesValue"in t?Hi(qi.empty(),te.empty()):"referenceValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in t?{arrayValue:{}}:"arrayValue"in t?Ib:"mapValue"in t?zh(t)?{mapValue:{}}:Ps:le(61959,{value:t})}function NE(t,e){const n=Gs(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?-1:!t.inclusive&&e.inclusive?1:0}function DE(t,e){const n=Gs(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?1:!t.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class an{constructor(e){this.value=e}static empty(){return new an({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!td(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=Ll(n)}setAll(e){let n=mt.emptyPath(),r={},s=[];e.forEach((o,a)=>{if(!n.isImmediateParentOf(a)){const l=this.getFieldsMap(n);this.applyChanges(l,r,s),r={},s=[],n=a.popLast()}o?r[a.lastSegment()]=Ll(o):s.push(a.lastSegment())});const i=this.getFieldsMap(n);this.applyChanges(i,r,s)}delete(e){const n=this.field(e.popLast());td(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return Or(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let s=n.mapValue.fields[e.get(r)];td(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=s),n=s}return n.mapValue.fields}applyChanges(e,n,r){ii(n,(s,i)=>e[s]=i);for(const s of r)delete e[s]}clone(){return new an(Ll(this.value))}}function Tb(t){const e=[];return ii(t.fields,(n,r)=>{const s=new mt([n]);if(td(r)){const i=Tb(r.mapValue).fields;if(i.length===0)e.push(s);else for(const o of i)e.push(s.child(o))}else e.push(s)}),new Sn(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Et{constructor(e,n,r,s,i,o,a){this.key=e,this.documentType=n,this.version=r,this.readTime=s,this.createTime=i,this.data=o,this.documentState=a}static newInvalidDocument(e){return new Et(e,0,fe.min(),fe.min(),fe.min(),an.empty(),0)}static newFoundDocument(e,n,r,s){return new Et(e,1,n,fe.min(),r,s,0)}static newNoDocument(e,n){return new Et(e,2,n,fe.min(),fe.min(),an.empty(),0)}static newUnknownDocument(e,n){return new Et(e,3,n,fe.min(),fe.min(),an.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(fe.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=an.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=an.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=fe.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Et&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Et(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qs{constructor(e,n){this.position=e,this.inclusive=n}}function jE(t,e,n){let r=0;for(let s=0;s<t.position.length;s++){const i=e[s],o=t.position[s];if(i.field.isKeyField()?r=te.comparator(te.fromName(o.referenceValue),n.key):r=Gs(o,n.data.field(i.field)),i.dir==="desc"&&(r*=-1),r!==0)break}return r}function OE(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!Or(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yc{constructor(e,n="asc"){this.field=e,this.dir=n}}function WO(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xb{}class Me extends xb{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new KO(e,n,r):n==="array-contains"?new YO(e,r):n==="in"?new Pb(e,r):n==="not-in"?new XO(e,r):n==="array-contains-any"?new JO(e,r):new Me(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new GO(e,r):new QO(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&n.nullValue===void 0&&this.matchesComparison(Gs(n,this.value)):n!==null&&Ks(this.value)===Ks(n)&&this.matchesComparison(Gs(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return le(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Ze extends xb{constructor(e,n){super(),this.filters=e,this.op=n,this.Pe=null}static create(e,n){return new Ze(e,n)}matches(e){return ya(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function ya(t){return t.op==="and"}function qm(t){return t.op==="or"}function jy(t){return Sb(t)&&ya(t)}function Sb(t){for(const e of t.filters)if(e instanceof Ze)return!1;return!0}function Hm(t){if(t instanceof Me)return t.field.canonicalString()+t.op.toString()+ga(t.value);if(jy(t))return t.filters.map(e=>Hm(e)).join(",");{const e=t.filters.map(n=>Hm(n)).join(",");return`${t.op}(${e})`}}function bb(t,e){return t instanceof Me?function(r,s){return s instanceof Me&&r.op===s.op&&r.field.isEqual(s.field)&&Or(r.value,s.value)}(t,e):t instanceof Ze?function(r,s){return s instanceof Ze&&r.op===s.op&&r.filters.length===s.filters.length?r.filters.reduce((i,o,a)=>i&&bb(o,s.filters[a]),!0):!1}(t,e):void le(19439)}function Cb(t,e){const n=t.filters.concat(e);return Ze.create(n,t.op)}function Ab(t){return t instanceof Me?function(n){return`${n.field.canonicalString()} ${n.op} ${ga(n.value)}`}(t):t instanceof Ze?function(n){return n.op.toString()+" {"+n.getFilters().map(Ab).join(" ,")+"}"}(t):"Filter"}class KO extends Me{constructor(e,n,r){super(e,n,r),this.key=te.fromName(r.referenceValue)}matches(e){const n=te.comparator(e.key,this.key);return this.matchesComparison(n)}}class GO extends Me{constructor(e,n){super(e,"in",n),this.keys=Rb("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class QO extends Me{constructor(e,n){super(e,"not-in",n),this.keys=Rb("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function Rb(t,e){var n;return(((n=e.arrayValue)==null?void 0:n.values)||[]).map(r=>te.fromName(r.referenceValue))}class YO extends Me{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return gc(n)&&mc(n.arrayValue,this.value)}}class Pb extends Me{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&mc(this.value.arrayValue,n)}}class XO extends Me{constructor(e,n){super(e,"not-in",n)}matches(e){if(mc(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&n.nullValue===void 0&&!mc(this.value.arrayValue,n)}}class JO extends Me{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!gc(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>mc(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZO{constructor(e,n=null,r=[],s=[],i=null,o=null,a=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=s,this.limit=i,this.startAt=o,this.endAt=a,this.Te=null}}function Wm(t,e=null,n=[],r=[],s=null,i=null,o=null){return new ZO(t,e,n,r,s,i,o)}function Wi(t){const e=ve(t);if(e.Te===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>Hm(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(i){return i.field.canonicalString()+i.dir}(r)).join(","),Lh(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>ga(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>ga(r)).join(",")),e.Te=n}return e.Te}function Dc(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!WO(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!bb(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!OE(t.startAt,e.startAt)&&OE(t.endAt,e.endAt)}function Wd(t){return te.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}function Kd(t,e){return t.filters.filter(n=>n instanceof Me&&n.field.isEqual(e))}function VE(t,e,n){let r=Zu,s=!0;for(const i of Kd(t,e)){let o=Zu,a=!0;switch(i.op){case"<":case"<=":o=qO(i.value);break;case"==":case"in":case">=":o=i.value;break;case">":o=i.value,a=!1;break;case"!=":case"not-in":o=Zu}NE({value:r,inclusive:s},{value:o,inclusive:a})<0&&(r=o,s=a)}if(n!==null){for(let i=0;i<t.orderBy.length;++i)if(t.orderBy[i].field.isEqual(e)){const o=n.position[i];NE({value:r,inclusive:s},{value:o,inclusive:n.inclusive})<0&&(r=o,s=n.inclusive);break}}return{value:r,inclusive:s}}function LE(t,e,n){let r=Ps,s=!0;for(const i of Kd(t,e)){let o=Ps,a=!0;switch(i.op){case">=":case">":o=HO(i.value),a=!1;break;case"==":case"in":case"<=":o=i.value;break;case"<":o=i.value,a=!1;break;case"!=":case"not-in":o=Ps}DE({value:r,inclusive:s},{value:o,inclusive:a})>0&&(r=o,s=a)}if(n!==null){for(let i=0;i<t.orderBy.length;++i)if(t.orderBy[i].field.isEqual(e)){const o=n.position[i];DE({value:r,inclusive:s},{value:o,inclusive:n.inclusive})>0&&(r=o,s=n.inclusive);break}}return{value:r,inclusive:s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oi{constructor(e,n=null,r=[],s=[],i=null,o="F",a=null,l=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=s,this.limit=i,this.limitType=o,this.startAt=a,this.endAt=l,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function eV(t,e,n,r,s,i,o,a){return new oi(t,e,n,r,s,i,o,a)}function jc(t){return new oi(t)}function ME(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function Oy(t){return t.collectionGroup!==null}function Xo(t){const e=ve(t);if(e.Ie===null){e.Ie=[];const n=new Set;for(const i of e.explicitOrderBy)e.Ie.push(i),n.add(i.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new tt(mt.comparator);return o.filters.forEach(l=>{l.getFlattenedFilters().forEach(d=>{d.isInequality()&&(a=a.add(d.field))})}),a})(e).forEach(i=>{n.has(i.canonicalString())||i.isKeyField()||e.Ie.push(new yc(i,r))}),n.has(mt.keyField().canonicalString())||e.Ie.push(new yc(mt.keyField(),r))}return e.Ie}function Qn(t){const e=ve(t);return e.Ee||(e.Ee=kb(e,Xo(t))),e.Ee}function tV(t){const e=ve(t);return e.de||(e.de=kb(e,t.explicitOrderBy)),e.de}function kb(t,e){if(t.limitType==="F")return Wm(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(s=>{const i=s.dir==="desc"?"asc":"desc";return new yc(s.field,i)});const n=t.endAt?new Qs(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new Qs(t.startAt.position,t.startAt.inclusive):null;return Wm(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function Km(t,e){const n=t.filters.concat([e]);return new oi(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function Gd(t,e,n){return new oi(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function qh(t,e){return Dc(Qn(t),Qn(e))&&t.limitType===e.limitType}function Nb(t){return`${Wi(Qn(t))}|lt:${t.limitType}`}function bo(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(s=>Ab(s)).join(", ")}]`),Lh(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(s=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(s)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(s=>ga(s)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(s=>ga(s)).join(",")),`Target(${r})`}(Qn(t))}; limitType=${t.limitType})`}function Oc(t,e){return e.isFoundDocument()&&function(r,s){const i=s.key.path;return r.collectionGroup!==null?s.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(i):te.isDocumentKey(r.path)?r.path.isEqual(i):r.path.isImmediateParentOf(i)}(t,e)&&function(r,s){for(const i of Xo(r))if(!i.field.isKeyField()&&s.data.field(i.field)===null)return!1;return!0}(t,e)&&function(r,s){for(const i of r.filters)if(!i.matches(s))return!1;return!0}(t,e)&&function(r,s){return!(r.startAt&&!function(o,a,l){const d=jE(o,a,l);return o.inclusive?d<=0:d<0}(r.startAt,Xo(r),s)||r.endAt&&!function(o,a,l){const d=jE(o,a,l);return o.inclusive?d>=0:d>0}(r.endAt,Xo(r),s))}(t,e)}function nV(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function Db(t){return(e,n)=>{let r=!1;for(const s of Xo(t)){const i=rV(s,e,n);if(i!==0)return i;r=r||s.field.isKeyField()}return 0}}function rV(t,e,n){const r=t.field.isKeyField()?te.comparator(e.key,n.key):function(i,o,a){const l=o.data.field(i),d=a.data.field(i);return l!==null&&d!==null?Gs(l,d):le(42886)}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return le(19790,{direction:t.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ss{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[s,i]of r)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),s=this.inner[r];if(s===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,n]);s.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return r.length===1?delete this.inner[n]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(e){ii(this.inner,(n,r)=>{for(const[s,i]of r)e(s,i)})}isEmpty(){return pb(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sV=new ht(te.comparator);function jn(){return sV}const jb=new ht(te.comparator);function gl(...t){let e=jb;for(const n of t)e=e.insert(n.key,n);return e}function Ob(t){let e=jb;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function Cr(){return Ml()}function Vb(){return Ml()}function Ml(){return new ss(t=>t.toString(),(t,e)=>t.isEqual(e))}const iV=new ht(te.comparator),oV=new tt(te.comparator);function Pe(...t){let e=oV;for(const n of t)e=e.add(n);return e}const aV=new tt(Te);function lV(){return aV}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vy(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:uc(e)?"-0":e}}function Lb(t){return{integerValue:""+t}}function Mb(t,e){return pO(e)?Lb(e):Vy(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hh{constructor(){this._=void 0}}function cV(t,e,n){return t instanceof _a?function(s,i){const o={fields:{[yb]:{stringValue:gb},[vb]:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return i&&$h(i)&&(i=Bh(i)),i&&(o.fields[_b]=i),{mapValue:o}}(n,e):t instanceof Ki?Ub(t,e):t instanceof va?$b(t,e):function(s,i){const o=Fb(s,i),a=FE(o)+FE(s.Ae);return zm(o)&&zm(s.Ae)?Lb(a):Vy(s.serializer,a)}(t,e)}function uV(t,e,n){return t instanceof Ki?Ub(t,e):t instanceof va?$b(t,e):n}function Fb(t,e){return t instanceof wa?function(r){return zm(r)||function(i){return!!i&&"doubleValue"in i}(r)}(e)?e:{integerValue:0}:null}class _a extends Hh{}class Ki extends Hh{constructor(e){super(),this.elements=e}}function Ub(t,e){const n=Bb(e);for(const r of t.elements)n.some(s=>Or(s,r))||n.push(r);return{arrayValue:{values:n}}}class va extends Hh{constructor(e){super(),this.elements=e}}function $b(t,e){let n=Bb(e);for(const r of t.elements)n=n.filter(s=>!Or(s,r));return{arrayValue:{values:n}}}class wa extends Hh{constructor(e,n){super(),this.serializer=e,this.Ae=n}}function FE(t){return ct(t.integerValue||t.doubleValue)}function Bb(t){return gc(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wh{constructor(e,n){this.field=e,this.transform=n}}function dV(t,e){return t.field.isEqual(e.field)&&function(r,s){return r instanceof Ki&&s instanceof Ki||r instanceof va&&s instanceof va?ua(r.elements,s.elements,Or):r instanceof wa&&s instanceof wa?Or(r.Ae,s.Ae):r instanceof _a&&s instanceof _a}(t.transform,e.transform)}class hV{constructor(e,n){this.version=e,this.transformResults=n}}class ln{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new ln}static exists(e){return new ln(void 0,e)}static updateTime(e){return new ln(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function nd(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class Kh{}function zb(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new Gh(t.key,ln.none()):new Na(t.key,t.data,ln.none());{const n=t.data,r=an.empty();let s=new tt(mt.comparator);for(let i of e.fields)if(!s.has(i)){let o=n.field(i);o===null&&i.length>1&&(i=i.popLast(),o=n.field(i)),o===null?r.delete(i):r.set(i,o),s=s.add(i)}return new is(t.key,r,new Sn(s.toArray()),ln.none())}}function fV(t,e,n){t instanceof Na?function(s,i,o){const a=s.value.clone(),l=$E(s.fieldTransforms,i,o.transformResults);a.setAll(l),i.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(t,e,n):t instanceof is?function(s,i,o){if(!nd(s.precondition,i))return void i.convertToUnknownDocument(o.version);const a=$E(s.fieldTransforms,i,o.transformResults),l=i.data;l.setAll(qb(s)),l.setAll(a),i.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(t,e,n):function(s,i,o){i.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,n)}function Fl(t,e,n,r){return t instanceof Na?function(i,o,a,l){if(!nd(i.precondition,o))return a;const d=i.value.clone(),h=BE(i.fieldTransforms,l,o);return d.setAll(h),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),null}(t,e,n,r):t instanceof is?function(i,o,a,l){if(!nd(i.precondition,o))return a;const d=BE(i.fieldTransforms,l,o),h=o.data;return h.setAll(qb(i)),h.setAll(d),o.convertToFoundDocument(o.version,h).setHasLocalMutations(),a===null?null:a.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(f=>f.field))}(t,e,n,r):function(i,o,a){return nd(i.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(t,e,n)}function pV(t,e){let n=null;for(const r of t.fieldTransforms){const s=e.data.field(r.field),i=Fb(r.transform,s||null);i!=null&&(n===null&&(n=an.empty()),n.set(r.field,i))}return n||null}function UE(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,s){return r===void 0&&s===void 0||!(!r||!s)&&ua(r,s,(i,o)=>dV(i,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class Na extends Kh{constructor(e,n,r,s=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class is extends Kh{constructor(e,n,r,s,i=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function qb(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function $E(t,e,n){const r=new Map;ce(t.length===n.length,32656,{Re:n.length,Ve:t.length});for(let s=0;s<n.length;s++){const i=t[s],o=i.transform,a=e.data.field(i.field);r.set(i.field,uV(o,a,n[s]))}return r}function BE(t,e,n){const r=new Map;for(const s of t){const i=s.transform,o=n.data.field(s.field);r.set(s.field,cV(i,o,e))}return r}class Gh extends Kh{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Hb extends Kh{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ly{constructor(e,n,r,s){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&fV(i,e,r[s])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=Fl(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=Fl(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=Vb();return this.mutations.forEach(s=>{const i=e.get(s.key),o=i.overlayedDocument;let a=this.applyToLocalView(o,i.mutatedFields);a=n.has(s.key)?null:a;const l=zb(o,a);l!==null&&r.set(s.key,l),o.isValidDocument()||o.convertToNoDocument(fe.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),Pe())}isEqual(e){return this.batchId===e.batchId&&ua(this.mutations,e.mutations,(n,r)=>UE(n,r))&&ua(this.baseMutations,e.baseMutations,(n,r)=>UE(n,r))}}class My{constructor(e,n,r,s){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=s}static from(e,n,r){ce(e.mutations.length===r.length,58842,{me:e.mutations.length,fe:r.length});let s=function(){return iV}();const i=e.mutations;for(let o=0;o<i.length;o++)s=s.insert(i[o].key,r[o].version);return new My(e,n,r,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fy{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mV{constructor(e,n,r){this.alias=e,this.aggregateType=n,this.fieldPath=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gV{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Rt,Ue;function yV(t){switch(t){case $.OK:return le(64938);case $.CANCELLED:case $.UNKNOWN:case $.DEADLINE_EXCEEDED:case $.RESOURCE_EXHAUSTED:case $.INTERNAL:case $.UNAVAILABLE:case $.UNAUTHENTICATED:return!1;case $.INVALID_ARGUMENT:case $.NOT_FOUND:case $.ALREADY_EXISTS:case $.PERMISSION_DENIED:case $.FAILED_PRECONDITION:case $.ABORTED:case $.OUT_OF_RANGE:case $.UNIMPLEMENTED:case $.DATA_LOSS:return!0;default:return le(15467,{code:t})}}function Wb(t){if(t===void 0)return pn("GRPC error has no .code"),$.UNKNOWN;switch(t){case Rt.OK:return $.OK;case Rt.CANCELLED:return $.CANCELLED;case Rt.UNKNOWN:return $.UNKNOWN;case Rt.DEADLINE_EXCEEDED:return $.DEADLINE_EXCEEDED;case Rt.RESOURCE_EXHAUSTED:return $.RESOURCE_EXHAUSTED;case Rt.INTERNAL:return $.INTERNAL;case Rt.UNAVAILABLE:return $.UNAVAILABLE;case Rt.UNAUTHENTICATED:return $.UNAUTHENTICATED;case Rt.INVALID_ARGUMENT:return $.INVALID_ARGUMENT;case Rt.NOT_FOUND:return $.NOT_FOUND;case Rt.ALREADY_EXISTS:return $.ALREADY_EXISTS;case Rt.PERMISSION_DENIED:return $.PERMISSION_DENIED;case Rt.FAILED_PRECONDITION:return $.FAILED_PRECONDITION;case Rt.ABORTED:return $.ABORTED;case Rt.OUT_OF_RANGE:return $.OUT_OF_RANGE;case Rt.UNIMPLEMENTED:return $.UNIMPLEMENTED;case Rt.DATA_LOSS:return $.DATA_LOSS;default:return le(39323,{code:t})}}(Ue=Rt||(Rt={}))[Ue.OK=0]="OK",Ue[Ue.CANCELLED=1]="CANCELLED",Ue[Ue.UNKNOWN=2]="UNKNOWN",Ue[Ue.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ue[Ue.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ue[Ue.NOT_FOUND=5]="NOT_FOUND",Ue[Ue.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ue[Ue.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ue[Ue.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ue[Ue.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ue[Ue.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ue[Ue.ABORTED=10]="ABORTED",Ue[Ue.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ue[Ue.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ue[Ue.INTERNAL=13]="INTERNAL",Ue[Ue.UNAVAILABLE=14]="UNAVAILABLE",Ue[Ue.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _V(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vV=new Bs([4294967295,4294967295],0);function zE(t){const e=_V().encode(t),n=new zS;return n.update(e),new Uint8Array(n.digest())}function qE(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),s=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new Bs([n,r],0),new Bs([s,i],0)]}class Uy{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new yl(`Invalid padding: ${n}`);if(r<0)throw new yl(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new yl(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new yl(`Invalid padding when bitmap length is 0: ${n}`);this.ge=8*e.length-n,this.pe=Bs.fromNumber(this.ge)}ye(e,n,r){let s=e.add(n.multiply(Bs.fromNumber(r)));return s.compare(vV)===1&&(s=new Bs([s.getBits(0),s.getBits(1)],0)),s.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const n=zE(e),[r,s]=qE(n);for(let i=0;i<this.hashCount;i++){const o=this.ye(r,s,i);if(!this.we(o))return!1}return!0}static create(e,n,r){const s=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),o=new Uy(i,s,n);return r.forEach(a=>o.insert(a)),o}insert(e){if(this.ge===0)return;const n=zE(e),[r,s]=qE(n);for(let i=0;i<this.hashCount;i++){const o=this.ye(r,s,i);this.Se(o)}}Se(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class yl extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qh{constructor(e,n,r,s,i){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const s=new Map;return s.set(e,Vc.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new Qh(fe.min(),s,new ht(Te),jn(),Pe())}}class Vc{constructor(e,n,r,s,i){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new Vc(r,n,Pe(),Pe(),Pe())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rd{constructor(e,n,r,s){this.be=e,this.removedTargetIds=n,this.key=r,this.De=s}}class Kb{constructor(e,n){this.targetId=e,this.Ce=n}}class Gb{constructor(e,n,r=Nt.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=s}}class HE{constructor(){this.ve=0,this.Fe=WE(),this.Me=Nt.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=Pe(),n=Pe(),r=Pe();return this.Fe.forEach((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:n=n.add(s);break;case 1:r=r.add(s);break;default:le(38017,{changeType:i})}}),new Vc(this.Me,this.xe,e,n,r)}qe(){this.Oe=!1,this.Fe=WE()}Qe(e,n){this.Oe=!0,this.Fe=this.Fe.insert(e,n)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,ce(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class wV{constructor(e){this.Ge=e,this.ze=new Map,this.je=jn(),this.Je=Eu(),this.He=Eu(),this.Ye=new ht(Te)}Ze(e){for(const n of e.be)e.De&&e.De.isFoundDocument()?this.Xe(n,e.De):this.et(n,e.key,e.De);for(const n of e.removedTargetIds)this.et(n,e.key,e.De)}tt(e){this.forEachTarget(e,n=>{const r=this.nt(n);switch(e.state){case 0:this.rt(n)&&r.Le(e.resumeToken);break;case 1:r.Ke(),r.Ne||r.qe(),r.Le(e.resumeToken);break;case 2:r.Ke(),r.Ne||this.removeTarget(n);break;case 3:this.rt(n)&&(r.We(),r.Le(e.resumeToken));break;case 4:this.rt(n)&&(this.it(n),r.Le(e.resumeToken));break;default:le(56790,{state:e.state})}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.ze.forEach((r,s)=>{this.rt(s)&&n(s)})}st(e){const n=e.targetId,r=e.Ce.count,s=this.ot(n);if(s){const i=s.target;if(Wd(i))if(r===0){const o=new te(i.path);this.et(n,o,Et.newNoDocument(o,fe.min()))}else ce(r===1,20013,{expectedCount:r});else{const o=this._t(n);if(o!==r){const a=this.ut(e),l=a?this.ct(a,e,o):1;if(l!==0){this.it(n);const d=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(n,d)}}}}}ut(e){const n=e.Ce.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:s=0},hashCount:i=0}=n;let o,a;try{o=ns(r).toUint8Array()}catch(l){if(l instanceof mb)return zi("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{a=new Uy(o,s,i)}catch(l){return zi(l instanceof yl?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return a.ge===0?null:a}ct(e,n,r){return n.Ce.count===r-this.Pt(e,n.targetId)?0:2}Pt(e,n){const r=this.Ge.getRemoteKeysForTarget(n);let s=0;return r.forEach(i=>{const o=this.Ge.ht(),a=`projects/${o.projectId}/databases/${o.database}/documents/${i.path.canonicalString()}`;e.mightContain(a)||(this.et(n,i,null),s++)}),s}Tt(e){const n=new Map;this.ze.forEach((i,o)=>{const a=this.ot(o);if(a){if(i.current&&Wd(a.target)){const l=new te(a.target.path);this.It(l).has(o)||this.Et(o,l)||this.et(o,l,Et.newNoDocument(l,e))}i.Be&&(n.set(o,i.ke()),i.qe())}});let r=Pe();this.He.forEach((i,o)=>{let a=!0;o.forEachWhile(l=>{const d=this.ot(l);return!d||d.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(i))}),this.je.forEach((i,o)=>o.setReadTime(e));const s=new Qh(e,n,this.Ye,this.je,r);return this.je=jn(),this.Je=Eu(),this.He=Eu(),this.Ye=new ht(Te),s}Xe(e,n){if(!this.rt(e))return;const r=this.Et(e,n.key)?2:0;this.nt(e).Qe(n.key,r),this.je=this.je.insert(n.key,n),this.Je=this.Je.insert(n.key,this.It(n.key).add(e)),this.He=this.He.insert(n.key,this.dt(n.key).add(e))}et(e,n,r){if(!this.rt(e))return;const s=this.nt(e);this.Et(e,n)?s.Qe(n,1):s.$e(n),this.He=this.He.insert(n,this.dt(n).delete(e)),this.He=this.He.insert(n,this.dt(n).add(e)),r&&(this.je=this.je.insert(n,r))}removeTarget(e){this.ze.delete(e)}_t(e){const n=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let n=this.ze.get(e);return n||(n=new HE,this.ze.set(e,n)),n}dt(e){let n=this.He.get(e);return n||(n=new tt(Te),this.He=this.He.insert(e,n)),n}It(e){let n=this.Je.get(e);return n||(n=new tt(Te),this.Je=this.Je.insert(e,n)),n}rt(e){const n=this.ot(e)!==null;return n||H("WatchChangeAggregator","Detected inactive target",e),n}ot(e){const n=this.ze.get(e);return n&&n.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new HE),this.Ge.getRemoteKeysForTarget(e).forEach(n=>{this.et(e,n,null)})}Et(e,n){return this.Ge.getRemoteKeysForTarget(e).has(n)}}function Eu(){return new ht(te.comparator)}function WE(){return new ht(te.comparator)}const EV={asc:"ASCENDING",desc:"DESCENDING"},IV={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},TV={and:"AND",or:"OR"};class xV{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function Gm(t,e){return t.useProto3Json||Lh(e)?e:{value:e}}function Ea(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Qb(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function SV(t,e){return Ea(t,e.toTimestamp())}function yn(t){return ce(!!t,49232),fe.fromTimestamp(function(n){const r=ts(n);return new Be(r.seconds,r.nanos)}(t))}function $y(t,e){return Qm(t,e).canonicalString()}function Qm(t,e){const n=function(s){return new We(["projects",s.projectId,"databases",s.database])}(t).child("documents");return e===void 0?n:n.child(e)}function Yb(t){const e=We.fromString(t);return ce(sC(e),10190,{key:e.toString()}),e}function Qd(t,e){return $y(t.databaseId,e.path)}function Ni(t,e){const n=Yb(e);if(n.get(1)!==t.databaseId.projectId)throw new K($.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new K($.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new te(Zb(n))}function Xb(t,e){return $y(t.databaseId,e)}function Jb(t){const e=Yb(t);return e.length===4?We.emptyPath():Zb(e)}function Ym(t){return new We(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function Zb(t){return ce(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function KE(t,e,n){return{name:Qd(t,e),fields:n.value.mapValue.fields}}function bV(t,e,n){const r=Ni(t,e.name),s=yn(e.updateTime),i=e.createTime?yn(e.createTime):fe.min(),o=new an({mapValue:{fields:e.fields}}),a=Et.newFoundDocument(r,s,i,o);return n&&a.setHasCommittedMutations(),n?a.setHasCommittedMutations():a}function CV(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(d){return d==="NO_CHANGE"?0:d==="ADD"?1:d==="REMOVE"?2:d==="CURRENT"?3:d==="RESET"?4:le(39313,{state:d})}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=function(d,h){return d.useProto3Json?(ce(h===void 0||typeof h=="string",58123),Nt.fromBase64String(h||"")):(ce(h===void 0||h instanceof Buffer||h instanceof Uint8Array,16193),Nt.fromUint8Array(h||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(d){const h=d.code===void 0?$.UNKNOWN:Wb(d.code);return new K(h,d.message||"")}(o);n=new Gb(r,s,i,a||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const s=Ni(t,r.document.name),i=yn(r.document.updateTime),o=r.document.createTime?yn(r.document.createTime):fe.min(),a=new an({mapValue:{fields:r.document.fields}}),l=Et.newFoundDocument(s,i,o,a),d=r.targetIds||[],h=r.removedTargetIds||[];n=new rd(d,h,l.key,l)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const s=Ni(t,r.document),i=r.readTime?yn(r.readTime):fe.min(),o=Et.newNoDocument(s,i),a=r.removedTargetIds||[];n=new rd([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const s=Ni(t,r.document),i=r.removedTargetIds||[];n=new rd([],i,s,null)}else{if(!("filter"in e))return le(11601,{Rt:e});{e.filter;const r=e.filter;r.targetId;const{count:s=0,unchangedNames:i}=r,o=new gV(s,i),a=r.targetId;n=new Kb(a,o)}}return n}function Yd(t,e){let n;if(e instanceof Na)n={update:KE(t,e.key,e.value)};else if(e instanceof Gh)n={delete:Qd(t,e.key)};else if(e instanceof is)n={update:KE(t,e.key,e.data),updateMask:jV(e.fieldMask)};else{if(!(e instanceof Hb))return le(16599,{Vt:e.type});n={verify:Qd(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(i,o){const a=o.transform;if(a instanceof _a)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof Ki)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof va)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof wa)return{fieldPath:o.field.canonicalString(),increment:a.Ae};throw le(20930,{transform:o.transform})}(0,r))),e.precondition.isNone||(n.currentDocument=function(s,i){return i.updateTime!==void 0?{updateTime:SV(s,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:le(27497)}(t,e.precondition)),n}function Xm(t,e){const n=e.currentDocument?function(i){return i.updateTime!==void 0?ln.updateTime(yn(i.updateTime)):i.exists!==void 0?ln.exists(i.exists):ln.none()}(e.currentDocument):ln.none(),r=e.updateTransforms?e.updateTransforms.map(s=>function(o,a){let l=null;if("setToServerValue"in a)ce(a.setToServerValue==="REQUEST_TIME",16630,{proto:a}),l=new _a;else if("appendMissingElements"in a){const h=a.appendMissingElements.values||[];l=new Ki(h)}else if("removeAllFromArray"in a){const h=a.removeAllFromArray.values||[];l=new va(h)}else"increment"in a?l=new wa(o,a.increment):le(16584,{proto:a});const d=mt.fromServerFormat(a.fieldPath);return new Wh(d,l)}(t,s)):[];if(e.update){e.update.name;const s=Ni(t,e.update.name),i=new an({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=function(l){const d=l.fieldPaths||[];return new Sn(d.map(h=>mt.fromServerFormat(h)))}(e.updateMask);return new is(s,i,o,n,r)}return new Na(s,i,n,r)}if(e.delete){const s=Ni(t,e.delete);return new Gh(s,n)}if(e.verify){const s=Ni(t,e.verify);return new Hb(s,n)}return le(1463,{proto:e})}function AV(t,e){return t&&t.length>0?(ce(e!==void 0,14353),t.map(n=>function(s,i){let o=s.updateTime?yn(s.updateTime):yn(i);return o.isEqual(fe.min())&&(o=yn(i)),new hV(o,s.transformResults||[])}(n,e))):[]}function eC(t,e){return{documents:[Xb(t,e.path)]}}function By(t,e){const n={structuredQuery:{}},r=e.path;let s;e.collectionGroup!==null?(s=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=Xb(t,s);const i=function(d){if(d.length!==0)return rC(Ze.create(d,"and"))}(e.filters);i&&(n.structuredQuery.where=i);const o=function(d){if(d.length!==0)return d.map(h=>function(m){return{field:Ss(m.field),direction:kV(m.dir)}}(h))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);const a=Gm(t,e.limit);return a!==null&&(n.structuredQuery.limit=a),e.startAt&&(n.structuredQuery.startAt=function(d){return{before:d.inclusive,values:d.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(d){return{before:!d.inclusive,values:d.position}}(e.endAt)),{ft:n,parent:s}}function RV(t,e,n,r){const{ft:s,parent:i}=By(t,e),o={},a=[];let l=0;return n.forEach(d=>{const h="aggregate_"+l++;o[h]=d.alias,d.aggregateType==="count"?a.push({alias:h,count:{}}):d.aggregateType==="avg"?a.push({alias:h,avg:{field:Ss(d.fieldPath)}}):d.aggregateType==="sum"&&a.push({alias:h,sum:{field:Ss(d.fieldPath)}})}),{request:{structuredAggregationQuery:{aggregations:a,structuredQuery:s.structuredQuery},parent:s.parent},gt:o,parent:i}}function tC(t){let e=Jb(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let s=null;if(r>0){ce(r===1,65062);const h=n.from[0];h.allDescendants?s=h.collectionId:e=e.child(h.collectionId)}let i=[];n.where&&(i=function(f){const m=nC(f);return m instanceof Ze&&jy(m)?m.getFilters():[m]}(n.where));let o=[];n.orderBy&&(o=function(f){return f.map(m=>function(R){return new yc(Co(R.field),function(A){switch(A){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(R.direction))}(m))}(n.orderBy));let a=null;n.limit&&(a=function(f){let m;return m=typeof f=="object"?f.value:f,Lh(m)?null:m}(n.limit));let l=null;n.startAt&&(l=function(f){const m=!!f.before,v=f.values||[];return new Qs(v,m)}(n.startAt));let d=null;return n.endAt&&(d=function(f){const m=!f.before,v=f.values||[];return new Qs(v,m)}(n.endAt)),eV(e,s,o,i,a,"F",l,d)}function PV(t,e){const n=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return le(28987,{purpose:s})}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function nC(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=Co(n.unaryFilter.field);return Me.create(r,"==",{doubleValue:NaN});case"IS_NULL":const s=Co(n.unaryFilter.field);return Me.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=Co(n.unaryFilter.field);return Me.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=Co(n.unaryFilter.field);return Me.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return le(61313);default:return le(60726)}}(t):t.fieldFilter!==void 0?function(n){return Me.create(Co(n.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return le(58110);default:return le(50506)}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return Ze.create(n.compositeFilter.filters.map(r=>nC(r)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return le(1026)}}(n.compositeFilter.op))}(t):le(30097,{filter:t})}function kV(t){return EV[t]}function NV(t){return IV[t]}function DV(t){return TV[t]}function Ss(t){return{fieldPath:t.canonicalString()}}function Co(t){return mt.fromServerFormat(t.fieldPath)}function rC(t){return t instanceof Me?function(n){if(n.op==="=="){if(kE(n.value))return{unaryFilter:{field:Ss(n.field),op:"IS_NAN"}};if(PE(n.value))return{unaryFilter:{field:Ss(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(kE(n.value))return{unaryFilter:{field:Ss(n.field),op:"IS_NOT_NAN"}};if(PE(n.value))return{unaryFilter:{field:Ss(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Ss(n.field),op:NV(n.op),value:n.value}}}(t):t instanceof Ze?function(n){const r=n.getFilters().map(s=>rC(s));return r.length===1?r[0]:{compositeFilter:{op:DV(n.op),filters:r}}}(t):le(54877,{filter:t})}function jV(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function sC(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qr{constructor(e,n,r,s,i=fe.min(),o=fe.min(),a=Nt.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=l}withSequenceNumber(e){return new qr(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new qr(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new qr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new qr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iC{constructor(e){this.yt=e}}function OV(t,e){let n;if(e.document)n=bV(t.yt,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=te.fromSegments(e.noDocument.path),s=Qi(e.noDocument.readTime);n=Et.newNoDocument(r,s),e.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!e.unknownDocument)return le(56709);{const r=te.fromSegments(e.unknownDocument.path),s=Qi(e.unknownDocument.version);n=Et.newUnknownDocument(r,s)}}return e.readTime&&n.setReadTime(function(s){const i=new Be(s[0],s[1]);return fe.fromTimestamp(i)}(e.readTime)),n}function GE(t,e){const n=e.key,r={prefixPath:n.getCollectionPath().popLast().toArray(),collectionGroup:n.collectionGroup,documentId:n.path.lastSegment(),readTime:Xd(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=function(i,o){return{name:Qd(i,o.key),fields:o.data.value.mapValue.fields,updateTime:Ea(i,o.version.toTimestamp()),createTime:Ea(i,o.createTime.toTimestamp())}}(t.yt,e);else if(e.isNoDocument())r.noDocument={path:n.path.toArray(),readTime:Gi(e.version)};else{if(!e.isUnknownDocument())return le(57904,{document:e});r.unknownDocument={path:n.path.toArray(),version:Gi(e.version)}}return r}function Xd(t){const e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function Gi(t){const e=t.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function Qi(t){const e=new Be(t.seconds,t.nanoseconds);return fe.fromTimestamp(e)}function vi(t,e){const n=(e.baseMutations||[]).map(i=>Xm(t.yt,i));for(let i=0;i<e.mutations.length-1;++i){const o=e.mutations[i];if(i+1<e.mutations.length&&e.mutations[i+1].transform!==void 0){const a=e.mutations[i+1];o.updateTransforms=a.transform.fieldTransforms,e.mutations.splice(i+1,1),++i}}const r=e.mutations.map(i=>Xm(t.yt,i)),s=Be.fromMillis(e.localWriteTimeMs);return new Ly(e.batchId,s,n,r)}function _l(t){const e=Qi(t.readTime),n=t.lastLimboFreeSnapshotVersion!==void 0?Qi(t.lastLimboFreeSnapshotVersion):fe.min();let r;return r=function(i){return i.documents!==void 0}(t.query)?function(i){const o=i.documents.length;return ce(o===1,1966,{count:o}),Qn(jc(Jb(i.documents[0])))}(t.query):function(i){return Qn(tC(i))}(t.query),new qr(r,t.targetId,"TargetPurposeListen",t.lastListenSequenceNumber,e,n,Nt.fromBase64String(t.resumeToken))}function oC(t,e){const n=Gi(e.snapshotVersion),r=Gi(e.lastLimboFreeSnapshotVersion);let s;s=Wd(e.target)?eC(t.yt,e.target):By(t.yt,e.target).ft;const i=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Wi(e.target),readTime:n,resumeToken:i,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:s}}function aC(t){const e=tC({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?Gd(e,e.limit,"L"):e}function fp(t,e){return new Fy(e.largestBatchId,Xm(t.yt,e.overlayMutation))}function QE(t,e){const n=e.path.lastSegment();return[t,un(e.path.popLast()),n]}function YE(t,e,n,r){return{indexId:t,uid:e,sequenceNumber:n,readTime:Gi(r.readTime),documentKey:un(r.documentKey.path),largestBatchId:r.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VV{getBundleMetadata(e,n){return XE(e).get(n).next(r=>{if(r)return function(i){return{id:i.bundleId,createTime:Qi(i.createTime),version:i.version}}(r)})}saveBundleMetadata(e,n){return XE(e).put(function(s){return{bundleId:s.id,createTime:Gi(yn(s.createTime)),version:s.version}}(n))}getNamedQuery(e,n){return JE(e).get(n).next(r=>{if(r)return function(i){return{name:i.name,query:aC(i.bundledQuery),readTime:Qi(i.readTime)}}(r)})}saveNamedQuery(e,n){return JE(e).put(function(s){return{name:s.name,readTime:Gi(yn(s.readTime)),bundledQuery:s.bundledQuery}}(n))}}function XE(t){return Lt(t,Mh)}function JE(t){return Lt(t,Fh)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yh{constructor(e,n){this.serializer=e,this.userId=n}static wt(e,n){const r=n.uid||"";return new Yh(e,r)}getOverlay(e,n){return nl(e).get(QE(this.userId,n)).next(r=>r?fp(this.serializer,r):null)}getOverlays(e,n){const r=Cr();return O.forEach(n,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,n,r){const s=[];return r.forEach((i,o)=>{const a=new Fy(n,o);s.push(this.St(e,a))}),O.waitFor(s)}removeOverlaysForBatchId(e,n,r){const s=new Set;n.forEach(o=>s.add(un(o.getCollectionPath())));const i=[];return s.forEach(o=>{const a=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,r+1],!1,!0);i.push(nl(e).Z(Um,a))}),O.waitFor(i)}getOverlaysForCollection(e,n,r){const s=Cr(),i=un(n),o=IDBKeyRange.bound([this.userId,i,r],[this.userId,i,Number.POSITIVE_INFINITY],!0);return nl(e).J(Um,o).next(a=>{for(const l of a){const d=fp(this.serializer,l);s.set(d.getKey(),d)}return s})}getOverlaysForCollectionGroup(e,n,r,s){const i=Cr();let o;const a=IDBKeyRange.bound([this.userId,n,r],[this.userId,n,Number.POSITIVE_INFINITY],!0);return nl(e).ee({index:cb,range:a},(l,d,h)=>{const f=fp(this.serializer,d);i.size()<s||f.largestBatchId===o?(i.set(f.getKey(),f),o=f.largestBatchId):h.done()}).next(()=>i)}St(e,n){return nl(e).put(function(s,i,o){const[a,l,d]=QE(i,o.mutation.key);return{userId:i,collectionPath:l,documentId:d,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:Yd(s.yt,o.mutation)}}(this.serializer,this.userId,n))}}function nl(t){return Lt(t,Uh)}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LV{bt(e){return Lt(e,Py)}getSessionToken(e){return this.bt(e).get("sessionToken").next(n=>{const r=n==null?void 0:n.value;return r?Nt.fromUint8Array(r):Nt.EMPTY_BYTE_STRING})}setSessionToken(e,n){return this.bt(e).put({name:"sessionToken",value:n.toUint8Array()})}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wi{constructor(){}Dt(e,n){this.Ct(e,n),n.vt()}Ct(e,n){if("nullValue"in e)this.Ft(n,5);else if("booleanValue"in e)this.Ft(n,10),n.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(n,15),n.Mt(ct(e.integerValue));else if("doubleValue"in e){const r=ct(e.doubleValue);isNaN(r)?this.Ft(n,13):(this.Ft(n,15),uc(r)?n.Mt(0):n.Mt(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Ft(n,20),typeof r=="string"&&(r=ts(r)),n.xt(`${r.seconds||""}`),n.Mt(r.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,n),this.Nt(n);else if("bytesValue"in e)this.Ft(n,30),n.Bt(ns(e.bytesValue)),this.Nt(n);else if("referenceValue"in e)this.Lt(e.referenceValue,n);else if("geoPointValue"in e){const r=e.geoPointValue;this.Ft(n,45),n.Mt(r.latitude||0),n.Mt(r.longitude||0)}else"mapValue"in e?Eb(e)?this.Ft(n,Number.MAX_SAFE_INTEGER):zh(e)?this.kt(e.mapValue,n):(this.qt(e.mapValue,n),this.Nt(n)):"arrayValue"in e?(this.Qt(e.arrayValue,n),this.Nt(n)):le(19022,{$t:e})}Ot(e,n){this.Ft(n,25),this.Ut(e,n)}Ut(e,n){n.xt(e)}qt(e,n){const r=e.fields||{};this.Ft(n,55);for(const s of Object.keys(r))this.Ot(s,n),this.Ct(r[s],n)}kt(e,n){var o,a;const r=e.fields||{};this.Ft(n,53);const s=ma,i=((a=(o=r[s].arrayValue)==null?void 0:o.values)==null?void 0:a.length)||0;this.Ft(n,15),n.Mt(ct(i)),this.Ot(s,n),this.Ct(r[s],n)}Qt(e,n){const r=e.values||[];this.Ft(n,50);for(const s of r)this.Ct(s,n)}Lt(e,n){this.Ft(n,37),te.fromName(e).path.forEach(r=>{this.Ft(n,60),this.Ut(r,n)})}Ft(e,n){e.Mt(n)}Nt(e){e.Mt(2)}}wi.Kt=new wi;/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law | agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES | CONDITIONS OF ANY KIND, either express | implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const po=255;function MV(t){if(t===0)return 8;let e=0;return t>>4||(e+=4,t<<=4),t>>6||(e+=2,t<<=2),t>>7||(e+=1),e}function ZE(t){const e=64-function(r){let s=0;for(let i=0;i<8;++i){const o=MV(255&r[i]);if(s+=o,o!==8)break}return s}(t);return Math.ceil(e/8)}class FV{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Wt(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.Gt(r.value),r=n.next();this.zt()}jt(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.Jt(r.value),r=n.next();this.Ht()}Yt(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.Gt(r);else if(r<2048)this.Gt(960|r>>>6),this.Gt(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Gt(480|r>>>12),this.Gt(128|63&r>>>6),this.Gt(128|63&r);else{const s=n.codePointAt(0);this.Gt(240|s>>>18),this.Gt(128|63&s>>>12),this.Gt(128|63&s>>>6),this.Gt(128|63&s)}}this.zt()}Zt(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.Jt(r);else if(r<2048)this.Jt(960|r>>>6),this.Jt(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Jt(480|r>>>12),this.Jt(128|63&r>>>6),this.Jt(128|63&r);else{const s=n.codePointAt(0);this.Jt(240|s>>>18),this.Jt(128|63&s>>>12),this.Jt(128|63&s>>>6),this.Jt(128|63&s)}}this.Ht()}Xt(e){const n=this.en(e),r=ZE(n);this.tn(1+r),this.buffer[this.position++]=255&r;for(let s=n.length-r;s<n.length;++s)this.buffer[this.position++]=255&n[s]}nn(e){const n=this.en(e),r=ZE(n);this.tn(1+r),this.buffer[this.position++]=~(255&r);for(let s=n.length-r;s<n.length;++s)this.buffer[this.position++]=~(255&n[s])}rn(){this.sn(po),this.sn(255)}_n(){this.an(po),this.an(255)}reset(){this.position=0}seed(e){this.tn(e.length),this.buffer.set(e,this.position),this.position+=e.length}un(){return this.buffer.slice(0,this.position)}en(e){const n=function(i){const o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,i,!1),new Uint8Array(o.buffer)}(e),r=!!(128&n[0]);n[0]^=r?255:128;for(let s=1;s<n.length;++s)n[s]^=r?255:0;return n}Gt(e){const n=255&e;n===0?(this.sn(0),this.sn(255)):n===po?(this.sn(po),this.sn(0)):this.sn(n)}Jt(e){const n=255&e;n===0?(this.an(0),this.an(255)):n===po?(this.an(po),this.an(0)):this.an(e)}zt(){this.sn(0),this.sn(1)}Ht(){this.an(0),this.an(1)}sn(e){this.tn(1),this.buffer[this.position++]=e}an(e){this.tn(1),this.buffer[this.position++]=~e}tn(e){const n=e+this.position;if(n<=this.buffer.length)return;let r=2*this.buffer.length;r<n&&(r=n);const s=new Uint8Array(r);s.set(this.buffer),this.buffer=s}}class UV{constructor(e){this.cn=e}Bt(e){this.cn.Wt(e)}xt(e){this.cn.Yt(e)}Mt(e){this.cn.Xt(e)}vt(){this.cn.rn()}}class $V{constructor(e){this.cn=e}Bt(e){this.cn.jt(e)}xt(e){this.cn.Zt(e)}Mt(e){this.cn.nn(e)}vt(){this.cn._n()}}class rl{constructor(){this.cn=new FV,this.ln=new UV(this.cn),this.hn=new $V(this.cn)}seed(e){this.cn.seed(e)}Pn(e){return e===0?this.ln:this.hn}un(){return this.cn.un()}reset(){this.cn.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ei{constructor(e,n,r,s){this.Tn=e,this.In=n,this.En=r,this.dn=s}An(){const e=this.dn.length,n=e===0||this.dn[e-1]===255?e+1:e,r=new Uint8Array(n);return r.set(this.dn,0),n!==e?r.set([0],this.dn.length):++r[r.length-1],new Ei(this.Tn,this.In,this.En,r)}Rn(e,n,r){return{indexId:this.Tn,uid:e,arrayValue:sd(this.En),directionalValue:sd(this.dn),orderedDocumentKey:sd(n),documentKey:r.path.toArray()}}Vn(e,n,r){const s=this.Rn(e,n,r);return[s.indexId,s.uid,s.arrayValue,s.directionalValue,s.orderedDocumentKey,s.documentKey]}}function ps(t,e){let n=t.Tn-e.Tn;return n!==0?n:(n=eI(t.En,e.En),n!==0?n:(n=eI(t.dn,e.dn),n!==0?n:te.comparator(t.In,e.In)))}function eI(t,e){for(let n=0;n<t.length&&n<e.length;++n){const r=t[n]-e[n];if(r!==0)return r}return t.length-e.length}function sd(t){return tS()?function(n){let r="";for(let s=0;s<n.length;s++)r+=String.fromCharCode(n[s]);return r}(t):t}function tI(t){return typeof t!="string"?t:function(n){const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}(t)}class nI{constructor(e){this.mn=new tt((n,r)=>mt.comparator(n.field,r.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.fn=e.orderBy,this.gn=[];for(const n of e.filters){const r=n;r.isInequality()?this.mn=this.mn.add(r):this.gn.push(r)}}get pn(){return this.mn.size>1}yn(e){if(ce(e.collectionGroup===this.collectionId,49279),this.pn)return!1;const n=Lm(e);if(n!==void 0&&!this.wn(n))return!1;const r=gi(e);let s=new Set,i=0,o=0;for(;i<r.length&&this.wn(r[i]);++i)s=s.add(r[i].fieldPath.canonicalString());if(i===r.length)return!0;if(this.mn.size>0){const a=this.mn.getIterator().getNext();if(!s.has(a.field.canonicalString())){const l=r[i];if(!this.Sn(a,l)||!this.bn(this.fn[o++],l))return!1}++i}for(;i<r.length;++i){const a=r[i];if(o>=this.fn.length||!this.bn(this.fn[o++],a))return!1}return!0}Dn(){if(this.pn)return null;let e=new tt(mt.comparator);const n=[];for(const r of this.gn)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")n.push(new Yu(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),n.push(new Yu(r.field,0))}for(const r of this.fn)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),n.push(new Yu(r.field,r.dir==="asc"?0:1)));return new $d($d.UNKNOWN_ID,this.collectionId,n,cc.empty())}wn(e){for(const n of this.gn)if(this.Sn(n,e))return!0;return!1}Sn(e,n){if(e===void 0||!e.field.isEqual(n.fieldPath))return!1;const r=e.op==="array-contains"||e.op==="array-contains-any";return n.kind===2===r}bn(e,n){return!!e.field.isEqual(n.fieldPath)&&(n.kind===0&&e.dir==="asc"||n.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lC(t){var n,r;if(ce(t instanceof Me||t instanceof Ze,20012),t instanceof Me){if(t instanceof Pb){const s=((r=(n=t.value.arrayValue)==null?void 0:n.values)==null?void 0:r.map(i=>Me.create(t.field,"==",i)))||[];return Ze.create(s,"or")}return t}const e=t.filters.map(s=>lC(s));return Ze.create(e,t.op)}function BV(t){if(t.getFilters().length===0)return[];const e=eg(lC(t));return ce(cC(e),7391),Jm(e)||Zm(e)?[e]:e.getFilters()}function Jm(t){return t instanceof Me}function Zm(t){return t instanceof Ze&&jy(t)}function cC(t){return Jm(t)||Zm(t)||function(n){if(n instanceof Ze&&qm(n)){for(const r of n.getFilters())if(!Jm(r)&&!Zm(r))return!1;return!0}return!1}(t)}function eg(t){if(ce(t instanceof Me||t instanceof Ze,34018),t instanceof Me)return t;if(t.filters.length===1)return eg(t.filters[0]);const e=t.filters.map(r=>eg(r));let n=Ze.create(e,t.op);return n=Jd(n),cC(n)?n:(ce(n instanceof Ze,64498),ce(ya(n),40251),ce(n.filters.length>1,57927),n.filters.reduce((r,s)=>zy(r,s)))}function zy(t,e){let n;return ce(t instanceof Me||t instanceof Ze,38388),ce(e instanceof Me||e instanceof Ze,25473),n=t instanceof Me?e instanceof Me?function(s,i){return Ze.create([s,i],"and")}(t,e):rI(t,e):e instanceof Me?rI(e,t):function(s,i){if(ce(s.filters.length>0&&i.filters.length>0,48005),ya(s)&&ya(i))return Cb(s,i.getFilters());const o=qm(s)?s:i,a=qm(s)?i:s,l=o.filters.map(d=>zy(d,a));return Ze.create(l,"or")}(t,e),Jd(n)}function rI(t,e){if(ya(e))return Cb(e,t.getFilters());{const n=e.filters.map(r=>zy(t,r));return Ze.create(n,"or")}}function Jd(t){if(ce(t instanceof Me||t instanceof Ze,11850),t instanceof Me)return t;const e=t.getFilters();if(e.length===1)return Jd(e[0]);if(Sb(t))return t;const n=e.map(s=>Jd(s)),r=[];return n.forEach(s=>{s instanceof Me?r.push(s):s instanceof Ze&&(s.op===t.op?r.push(...s.filters):r.push(s))}),r.length===1?r[0]:Ze.create(r,t.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zV{constructor(){this.Cn=new qy}addToCollectionParentIndex(e,n){return this.Cn.add(n),O.resolve()}getCollectionParents(e,n){return O.resolve(this.Cn.getEntries(n))}addFieldIndex(e,n){return O.resolve()}deleteFieldIndex(e,n){return O.resolve()}deleteAllFieldIndexes(e){return O.resolve()}createTargetIndexes(e,n){return O.resolve()}getDocumentsMatchingTarget(e,n){return O.resolve(null)}getIndexType(e,n){return O.resolve(0)}getFieldIndexes(e,n){return O.resolve([])}getNextCollectionGroupToUpdate(e){return O.resolve(null)}getMinOffset(e,n){return O.resolve(Mn.min())}getMinOffsetFromCollectionGroup(e,n){return O.resolve(Mn.min())}updateCollectionGroup(e,n,r){return O.resolve()}updateIndexEntries(e,n){return O.resolve()}}class qy{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n]||new tt(We.comparator),i=!s.has(r);return this.index[n]=s.add(r),i}has(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n];return s&&s.has(r)}getEntries(e){return(this.index[e]||new tt(We.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sI="IndexedDbIndexManager",Iu=new Uint8Array(0);class qV{constructor(e,n){this.databaseId=n,this.vn=new qy,this.Fn=new ss(r=>Wi(r),(r,s)=>Dc(r,s)),this.uid=e.uid||""}addToCollectionParentIndex(e,n){if(!this.vn.has(n)){const r=n.lastSegment(),s=n.popLast();e.addOnCommittedListener(()=>{this.vn.add(n)});const i={collectionId:r,parent:un(s)};return iI(e).put(i)}return O.resolve()}getCollectionParents(e,n){const r=[],s=IDBKeyRange.bound([n,""],[XS(n),""],!1,!0);return iI(e).J(s).next(i=>{for(const o of i){if(o.collectionId!==n)break;r.push(br(o.parent))}return r})}addFieldIndex(e,n){const r=sl(e),s=function(a){return{indexId:a.indexId,collectionGroup:a.collectionGroup,fields:a.fields.map(l=>[l.fieldPath.canonicalString(),l.kind])}}(n);delete s.indexId;const i=r.add(s);if(n.indexState){const o=go(e);return i.next(a=>{o.put(YE(a,this.uid,n.indexState.sequenceNumber,n.indexState.offset))})}return i.next()}deleteFieldIndex(e,n){const r=sl(e),s=go(e),i=mo(e);return r.delete(n.indexId).next(()=>s.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0))).next(()=>i.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){const n=sl(e),r=mo(e),s=go(e);return n.Z().next(()=>r.Z()).next(()=>s.Z())}createTargetIndexes(e,n){return O.forEach(this.Mn(n),r=>this.getIndexType(e,r).next(s=>{if(s===0||s===1){const i=new nI(r).Dn();if(i!=null)return this.addFieldIndex(e,i)}}))}getDocumentsMatchingTarget(e,n){const r=mo(e);let s=!0;const i=new Map;return O.forEach(this.Mn(n),o=>this.xn(e,o).next(a=>{s&&(s=!!a),i.set(o,a)})).next(()=>{if(s){let o=Pe();const a=[];return O.forEach(i,(l,d)=>{H(sI,`Using index ${function(y){return`id=${y.indexId}|cg=${y.collectionGroup}|f=${y.fields.map(j=>`${j.fieldPath}:${j.kind}`).join(",")}`}(l)} to execute ${Wi(n)}`);const h=function(y,j){const V=Lm(j);if(V===void 0)return null;for(const M of Kd(y,V.fieldPath))switch(M.op){case"array-contains-any":return M.value.arrayValue.values||[];case"array-contains":return[M.value]}return null}(d,l),f=function(y,j){const V=new Map;for(const M of gi(j))for(const T of Kd(y,M.fieldPath))switch(T.op){case"==":case"in":V.set(M.fieldPath.canonicalString(),T.value);break;case"not-in":case"!=":return V.set(M.fieldPath.canonicalString(),T.value),Array.from(V.values())}return null}(d,l),m=function(y,j){const V=[];let M=!0;for(const T of gi(j)){const _=T.kind===0?VE(y,T.fieldPath,y.startAt):LE(y,T.fieldPath,y.startAt);V.push(_.value),M&&(M=_.inclusive)}return new Qs(V,M)}(d,l),v=function(y,j){const V=[];let M=!0;for(const T of gi(j)){const _=T.kind===0?LE(y,T.fieldPath,y.endAt):VE(y,T.fieldPath,y.endAt);V.push(_.value),M&&(M=_.inclusive)}return new Qs(V,M)}(d,l),R=this.On(l,d,m),b=this.On(l,d,v),A=this.Nn(l,d,f),I=this.Bn(l.indexId,h,R,m.inclusive,b,v.inclusive,A);return O.forEach(I,w=>r.Y(w,n.limit).next(y=>{y.forEach(j=>{const V=te.fromSegments(j.documentKey);o.has(V)||(o=o.add(V),a.push(V))})}))}).next(()=>a)}return O.resolve(null)})}Mn(e){let n=this.Fn.get(e);return n||(e.filters.length===0?n=[e]:n=BV(Ze.create(e.filters,"and")).map(r=>Wm(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.Fn.set(e,n),n)}Bn(e,n,r,s,i,o,a){const l=(n!=null?n.length:1)*Math.max(r.length,i.length),d=l/(n!=null?n.length:1),h=[];for(let f=0;f<l;++f){const m=n?this.Ln(n[f/d]):Iu,v=this.kn(e,m,r[f%d],s),R=this.qn(e,m,i[f%d],o),b=a.map(A=>this.kn(e,m,A,!0));h.push(...this.createRange(v,R,b))}return h}kn(e,n,r,s){const i=new Ei(e,te.empty(),n,r);return s?i:i.An()}qn(e,n,r,s){const i=new Ei(e,te.empty(),n,r);return s?i.An():i}xn(e,n){const r=new nI(n),s=n.collectionGroup!=null?n.collectionGroup:n.path.lastSegment();return this.getFieldIndexes(e,s).next(i=>{let o=null;for(const a of i)r.yn(a)&&(!o||a.fields.length>o.fields.length)&&(o=a);return o})}getIndexType(e,n){let r=2;const s=this.Mn(n);return O.forEach(s,i=>this.xn(e,i).next(o=>{o?r!==0&&o.fields.length<function(l){let d=new tt(mt.comparator),h=!1;for(const f of l.filters)for(const m of f.getFlattenedFilters())m.field.isKeyField()||(m.op==="array-contains"||m.op==="array-contains-any"?h=!0:d=d.add(m.field));for(const f of l.orderBy)f.field.isKeyField()||(d=d.add(f.field));return d.size+(h?1:0)}(i)&&(r=1):r=0})).next(()=>function(o){return o.limit!==null}(n)&&s.length>1&&r===2?1:r)}Qn(e,n){const r=new rl;for(const s of gi(e)){const i=n.data.field(s.fieldPath);if(i==null)return null;const o=r.Pn(s.kind);wi.Kt.Dt(i,o)}return r.un()}Ln(e){const n=new rl;return wi.Kt.Dt(e,n.Pn(0)),n.un()}$n(e,n){const r=new rl;return wi.Kt.Dt(Hi(this.databaseId,n),r.Pn(function(i){const o=gi(i);return o.length===0?0:o[o.length-1].kind}(e))),r.un()}Nn(e,n,r){if(r===null)return[];let s=[];s.push(new rl);let i=0;for(const o of gi(e)){const a=r[i++];for(const l of s)if(this.Un(n,o.fieldPath)&&gc(a))s=this.Kn(s,o,a);else{const d=l.Pn(o.kind);wi.Kt.Dt(a,d)}}return this.Wn(s)}On(e,n,r){return this.Nn(e,n,r.position)}Wn(e){const n=[];for(let r=0;r<e.length;++r)n[r]=e[r].un();return n}Kn(e,n,r){const s=[...e],i=[];for(const o of r.arrayValue.values||[])for(const a of s){const l=new rl;l.seed(a.un()),wi.Kt.Dt(o,l.Pn(n.kind)),i.push(l)}return i}Un(e,n){return!!e.filters.find(r=>r instanceof Me&&r.field.isEqual(n)&&(r.op==="in"||r.op==="not-in"))}getFieldIndexes(e,n){const r=sl(e),s=go(e);return(n?r.J(Fm,IDBKeyRange.bound(n,n)):r.J()).next(i=>{const o=[];return O.forEach(i,a=>s.get([a.indexId,this.uid]).next(l=>{o.push(function(h,f){const m=f?new cc(f.sequenceNumber,new Mn(Qi(f.readTime),new te(br(f.documentKey)),f.largestBatchId)):cc.empty(),v=h.fields.map(([R,b])=>new Yu(mt.fromServerFormat(R),b));return new $d(h.indexId,h.collectionGroup,v,m)}(a,l))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(n=>n.length===0?null:(n.sort((r,s)=>{const i=r.indexState.sequenceNumber-s.indexState.sequenceNumber;return i!==0?i:Te(r.collectionGroup,s.collectionGroup)}),n[0].collectionGroup))}updateCollectionGroup(e,n,r){const s=sl(e),i=go(e);return this.Gn(e).next(o=>s.J(Fm,IDBKeyRange.bound(n,n)).next(a=>O.forEach(a,l=>i.put(YE(l.indexId,this.uid,o,r)))))}updateIndexEntries(e,n){const r=new Map;return O.forEach(n,(s,i)=>{const o=r.get(s.collectionGroup);return(o?O.resolve(o):this.getFieldIndexes(e,s.collectionGroup)).next(a=>(r.set(s.collectionGroup,a),O.forEach(a,l=>this.zn(e,s,l).next(d=>{const h=this.jn(i,l);return d.isEqual(h)?O.resolve():this.Jn(e,i,l,d,h)}))))})}Hn(e,n,r,s){return mo(e).put(s.Rn(this.uid,this.$n(r,n.key),n.key))}Yn(e,n,r,s){return mo(e).delete(s.Vn(this.uid,this.$n(r,n.key),n.key))}zn(e,n,r){const s=mo(e);let i=new tt(ps);return s.ee({index:lb,range:IDBKeyRange.only([r.indexId,this.uid,sd(this.$n(r,n))])},(o,a)=>{i=i.add(new Ei(r.indexId,n,tI(a.arrayValue),tI(a.directionalValue)))}).next(()=>i)}jn(e,n){let r=new tt(ps);const s=this.Qn(n,e);if(s==null)return r;const i=Lm(n);if(i!=null){const o=e.data.field(i.fieldPath);if(gc(o))for(const a of o.arrayValue.values||[])r=r.add(new Ei(n.indexId,e.key,this.Ln(a),s))}else r=r.add(new Ei(n.indexId,e.key,Iu,s));return r}Jn(e,n,r,s,i){H(sI,"Updating index entries for document '%s'",n.key);const o=[];return function(l,d,h,f,m){const v=l.getIterator(),R=d.getIterator();let b=fo(v),A=fo(R);for(;b||A;){let I=!1,w=!1;if(b&&A){const y=h(b,A);y<0?w=!0:y>0&&(I=!0)}else b!=null?w=!0:I=!0;I?(f(A),A=fo(R)):w?(m(b),b=fo(v)):(b=fo(v),A=fo(R))}}(s,i,ps,a=>{o.push(this.Hn(e,n,r,a))},a=>{o.push(this.Yn(e,n,r,a))}),O.waitFor(o)}Gn(e){let n=1;return go(e).ee({index:ab,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,s,i)=>{i.done(),n=s.sequenceNumber+1}).next(()=>n)}createRange(e,n,r){r=r.sort((o,a)=>ps(o,a)).filter((o,a,l)=>!a||ps(o,l[a-1])!==0);const s=[];s.push(e);for(const o of r){const a=ps(o,e),l=ps(o,n);if(a===0)s[0]=e.An();else if(a>0&&l<0)s.push(o),s.push(o.An());else if(l>0)break}s.push(n);const i=[];for(let o=0;o<s.length;o+=2){if(this.Zn(s[o],s[o+1]))return[];const a=s[o].Vn(this.uid,Iu,te.empty()),l=s[o+1].Vn(this.uid,Iu,te.empty());i.push(IDBKeyRange.bound(a,l))}return i}Zn(e,n){return ps(e,n)>0}getMinOffsetFromCollectionGroup(e,n){return this.getFieldIndexes(e,n).next(oI)}getMinOffset(e,n){return O.mapArray(this.Mn(n),r=>this.xn(e,r).next(s=>s||le(44426))).next(oI)}}function iI(t){return Lt(t,fc)}function mo(t){return Lt(t,Vl)}function sl(t){return Lt(t,Ry)}function go(t){return Lt(t,Ol)}function oI(t){ce(t.length!==0,28825);let e=t[0].indexState.offset,n=e.largestBatchId;for(let r=1;r<t.length;r++){const s=t[r].indexState.offset;by(s,e)<0&&(e=s),n<s.largestBatchId&&(n=s.largestBatchId)}return new Mn(e.readTime,e.documentKey,n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aI={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},uC=41943040;class sn{static withCacheSize(e){return new sn(e,sn.DEFAULT_COLLECTION_PERCENTILE,sn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dC(t,e,n){const r=t.store(sr),s=t.store(da),i=[],o=IDBKeyRange.only(n.batchId);let a=0;const l=r.ee({range:o},(h,f,m)=>(a++,m.delete()));i.push(l.next(()=>{ce(a===1,47070,{batchId:n.batchId})}));const d=[];for(const h of n.mutations){const f=sb(e,h.key.path,n.batchId);i.push(s.delete(f)),d.push(h.key)}return O.waitFor(i).next(()=>d)}function Zd(t){if(!t)return 0;let e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw le(14731);e=t.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */sn.DEFAULT_COLLECTION_PERCENTILE=10,sn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,sn.DEFAULT=new sn(uC,sn.DEFAULT_COLLECTION_PERCENTILE,sn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),sn.DISABLED=new sn(-1,0,0);class Xh{constructor(e,n,r,s){this.userId=e,this.serializer=n,this.indexManager=r,this.referenceDelegate=s,this.Xn={}}static wt(e,n,r,s){ce(e.uid!=="",64387);const i=e.isAuthenticated()?e.uid:"";return new Xh(i,n,r,s)}checkEmpty(e){let n=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return ms(e).ee({index:bi,range:r},(s,i,o)=>{n=!1,o.done()}).next(()=>n)}addMutationBatch(e,n,r,s){const i=Ao(e),o=ms(e);return o.add({}).next(a=>{ce(typeof a=="number",49019);const l=new Ly(a,n,r,s),d=function(v,R,b){const A=b.baseMutations.map(w=>Yd(v.yt,w)),I=b.mutations.map(w=>Yd(v.yt,w));return{userId:R,batchId:b.batchId,localWriteTimeMs:b.localWriteTime.toMillis(),baseMutations:A,mutations:I}}(this.serializer,this.userId,l),h=[];let f=new tt((m,v)=>Te(m.canonicalString(),v.canonicalString()));for(const m of s){const v=sb(this.userId,m.key.path,a);f=f.add(m.key.path.popLast()),h.push(o.put(d)),h.push(i.put(v,yO))}return f.forEach(m=>{h.push(this.indexManager.addToCollectionParentIndex(e,m))}),e.addOnCommittedListener(()=>{this.Xn[a]=l.keys()}),O.waitFor(h).next(()=>l)})}lookupMutationBatch(e,n){return ms(e).get(n).next(r=>r?(ce(r.userId===this.userId,48,"Unexpected user for mutation batch",{userId:r.userId,batchId:n}),vi(this.serializer,r)):null)}er(e,n){return this.Xn[n]?O.resolve(this.Xn[n]):this.lookupMutationBatch(e,n).next(r=>{if(r){const s=r.keys();return this.Xn[n]=s,s}return null})}getNextMutationBatchAfterBatchId(e,n){const r=n+1,s=IDBKeyRange.lowerBound([this.userId,r]);let i=null;return ms(e).ee({index:bi,range:s},(o,a,l)=>{a.userId===this.userId&&(ce(a.batchId>=r,47524,{tr:r}),i=vi(this.serializer,a)),l.done()}).next(()=>i)}getHighestUnacknowledgedBatchId(e){const n=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=Pi;return ms(e).ee({index:bi,range:n,reverse:!0},(s,i,o)=>{r=i.batchId,o.done()}).next(()=>r)}getAllMutationBatches(e){const n=IDBKeyRange.bound([this.userId,Pi],[this.userId,Number.POSITIVE_INFINITY]);return ms(e).J(bi,n).next(r=>r.map(s=>vi(this.serializer,s)))}getAllMutationBatchesAffectingDocumentKey(e,n){const r=Xu(this.userId,n.path),s=IDBKeyRange.lowerBound(r),i=[];return Ao(e).ee({range:s},(o,a,l)=>{const[d,h,f]=o,m=br(h);if(d===this.userId&&n.path.isEqual(m))return ms(e).get(f).next(v=>{if(!v)throw le(61480,{nr:o,batchId:f});ce(v.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:v.userId,batchId:f}),i.push(vi(this.serializer,v))});l.done()}).next(()=>i)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new tt(Te);const s=[];return n.forEach(i=>{const o=Xu(this.userId,i.path),a=IDBKeyRange.lowerBound(o),l=Ao(e).ee({range:a},(d,h,f)=>{const[m,v,R]=d,b=br(v);m===this.userId&&i.path.isEqual(b)?r=r.add(R):f.done()});s.push(l)}),O.waitFor(s).next(()=>this.rr(e,r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,s=r.length+1,i=Xu(this.userId,r),o=IDBKeyRange.lowerBound(i);let a=new tt(Te);return Ao(e).ee({range:o},(l,d,h)=>{const[f,m,v]=l,R=br(m);f===this.userId&&r.isPrefixOf(R)?R.length===s&&(a=a.add(v)):h.done()}).next(()=>this.rr(e,a))}rr(e,n){const r=[],s=[];return n.forEach(i=>{s.push(ms(e).get(i).next(o=>{if(o===null)throw le(35274,{batchId:i});ce(o.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:o.userId,batchId:i}),r.push(vi(this.serializer,o))}))}),O.waitFor(s).next(()=>r)}removeMutationBatch(e,n){return dC(e.le,this.userId,n).next(r=>(e.addOnCommittedListener(()=>{this.ir(n.batchId)}),O.forEach(r,s=>this.referenceDelegate.markPotentiallyOrphaned(e,s))))}ir(e){delete this.Xn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(n=>{if(!n)return O.resolve();const r=IDBKeyRange.lowerBound(function(o){return[o]}(this.userId)),s=[];return Ao(e).ee({range:r},(i,o,a)=>{if(i[0]===this.userId){const l=br(i[1]);s.push(l)}else a.done()}).next(()=>{ce(s.length===0,56720,{sr:s.map(i=>i.canonicalString())})})})}containsKey(e,n){return hC(e,this.userId,n)}_r(e){return fC(e).get(this.userId).next(n=>n||{userId:this.userId,lastAcknowledgedBatchId:Pi,lastStreamToken:""})}}function hC(t,e,n){const r=Xu(e,n.path),s=r[1],i=IDBKeyRange.lowerBound(r);let o=!1;return Ao(t).ee({range:i,X:!0},(a,l,d)=>{const[h,f,m]=a;h===e&&f===s&&(o=!0),d.done()}).next(()=>o)}function ms(t){return Lt(t,sr)}function Ao(t){return Lt(t,da)}function fC(t){return Lt(t,dc)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yi{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new Yi(0)}static cr(){return new Yi(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HV{constructor(e,n){this.referenceDelegate=e,this.serializer=n}allocateTargetId(e){return this.lr(e).next(n=>{const r=new Yi(n.highestTargetId);return n.highestTargetId=r.next(),this.hr(e,n).next(()=>n.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.lr(e).next(n=>fe.fromTimestamp(new Be(n.lastRemoteSnapshotVersion.seconds,n.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.lr(e).next(n=>n.highestListenSequenceNumber)}setTargetsMetadata(e,n,r){return this.lr(e).next(s=>(s.highestListenSequenceNumber=n,r&&(s.lastRemoteSnapshotVersion=r.toTimestamp()),n>s.highestListenSequenceNumber&&(s.highestListenSequenceNumber=n),this.hr(e,s)))}addTargetData(e,n){return this.Pr(e,n).next(()=>this.lr(e).next(r=>(r.targetCount+=1,this.Tr(n,r),this.hr(e,r))))}updateTargetData(e,n){return this.Pr(e,n)}removeTargetData(e,n){return this.removeMatchingKeysForTargetId(e,n.targetId).next(()=>yo(e).delete(n.targetId)).next(()=>this.lr(e)).next(r=>(ce(r.targetCount>0,8065),r.targetCount-=1,this.hr(e,r)))}removeTargets(e,n,r){let s=0;const i=[];return yo(e).ee((o,a)=>{const l=_l(a);l.sequenceNumber<=n&&r.get(l.targetId)===null&&(s++,i.push(this.removeTargetData(e,l)))}).next(()=>O.waitFor(i)).next(()=>s)}forEachTarget(e,n){return yo(e).ee((r,s)=>{const i=_l(s);n(i)})}lr(e){return lI(e).get(qd).next(n=>(ce(n!==null,2888),n))}hr(e,n){return lI(e).put(qd,n)}Pr(e,n){return yo(e).put(oC(this.serializer,n))}Tr(e,n){let r=!1;return e.targetId>n.highestTargetId&&(n.highestTargetId=e.targetId,r=!0),e.sequenceNumber>n.highestListenSequenceNumber&&(n.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.lr(e).next(n=>n.targetCount)}getTargetData(e,n){const r=Wi(n),s=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let i=null;return yo(e).ee({range:s,index:ob},(o,a,l)=>{const d=_l(a);Dc(n,d.target)&&(i=d,l.done())}).next(()=>i)}addMatchingKeys(e,n,r){const s=[],i=bs(e);return n.forEach(o=>{const a=un(o.path);s.push(i.put({targetId:r,path:a})),s.push(this.referenceDelegate.addReference(e,r,o))}),O.waitFor(s)}removeMatchingKeys(e,n,r){const s=bs(e);return O.forEach(n,i=>{const o=un(i.path);return O.waitFor([s.delete([r,o]),this.referenceDelegate.removeReference(e,r,i)])})}removeMatchingKeysForTargetId(e,n){const r=bs(e),s=IDBKeyRange.bound([n],[n+1],!1,!0);return r.delete(s)}getMatchingKeysForTargetId(e,n){const r=IDBKeyRange.bound([n],[n+1],!1,!0),s=bs(e);let i=Pe();return s.ee({range:r,X:!0},(o,a,l)=>{const d=br(o[1]),h=new te(d);i=i.add(h)}).next(()=>i)}containsKey(e,n){const r=un(n.path),s=IDBKeyRange.bound([r],[XS(r)],!1,!0);let i=0;return bs(e).ee({index:Ay,X:!0,range:s},([o,a],l,d)=>{o!==0&&(i++,d.done())}).next(()=>i>0)}At(e,n){return yo(e).get(n).next(r=>r?_l(r):null)}}function yo(t){return Lt(t,ha)}function lI(t){return Lt(t,ki)}function bs(t){return Lt(t,fa)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cI="LruGarbageCollector",WV=1048576;function uI([t,e],[n,r]){const s=Te(t,n);return s===0?Te(e,r):s}class KV{constructor(e){this.Ir=e,this.buffer=new tt(uI),this.Er=0}dr(){return++this.Er}Ar(e){const n=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(n);else{const r=this.buffer.last();uI(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}}class pC{constructor(e,n,r){this.garbageCollector=e,this.asyncQueue=n,this.localStore=r,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){H(cI,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){si(n)?H(cI,"Ignoring IndexedDB error during garbage collection: ",n):await oo(n)}await this.Vr(3e5)})}}class GV{constructor(e,n){this.mr=e,this.params=n}calculateTargetCount(e,n){return this.mr.gr(e).next(r=>Math.floor(n/100*r))}nthSequenceNumber(e,n){if(n===0)return O.resolve(Kn.ce);const r=new KV(n);return this.mr.forEachTarget(e,s=>r.Ar(s.sequenceNumber)).next(()=>this.mr.pr(e,s=>r.Ar(s))).next(()=>r.maxValue)}removeTargets(e,n,r){return this.mr.removeTargets(e,n,r)}removeOrphanedDocuments(e,n){return this.mr.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(H("LruGarbageCollector","Garbage collection skipped; disabled"),O.resolve(aI)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(H("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),aI):this.yr(e,n))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,n){let r,s,i,o,a,l,d;const h=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(f=>(f>this.params.maximumSequenceNumbersToCollect?(H("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${f}`),s=this.params.maximumSequenceNumbersToCollect):s=f,o=Date.now(),this.nthSequenceNumber(e,s))).next(f=>(r=f,a=Date.now(),this.removeTargets(e,r,n))).next(f=>(i=f,l=Date.now(),this.removeOrphanedDocuments(e,r))).next(f=>(d=Date.now(),So()<=Le.DEBUG&&H("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-h}ms
	Determined least recently used ${s} in `+(a-o)+`ms
	Removed ${i} targets in `+(l-a)+`ms
	Removed ${f} documents in `+(d-l)+`ms
Total Duration: ${d-h}ms`),O.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:i,documentsRemoved:f})))}}function mC(t,e){return new GV(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QV{constructor(e,n){this.db=e,this.garbageCollector=mC(this,n)}gr(e){const n=this.wr(e);return this.db.getTargetCache().getTargetCount(e).next(r=>n.next(s=>r+s))}wr(e){let n=0;return this.pr(e,r=>{n++}).next(()=>n)}forEachTarget(e,n){return this.db.getTargetCache().forEachTarget(e,n)}pr(e,n){return this.Sr(e,(r,s)=>n(s))}addReference(e,n,r){return Tu(e,r)}removeReference(e,n,r){return Tu(e,r)}removeTargets(e,n,r){return this.db.getTargetCache().removeTargets(e,n,r)}markPotentiallyOrphaned(e,n){return Tu(e,n)}br(e,n){return function(s,i){let o=!1;return fC(s).te(a=>hC(s,a,i).next(l=>(l&&(o=!0),O.resolve(!l)))).next(()=>o)}(e,n)}removeOrphanedDocuments(e,n){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),s=[];let i=0;return this.Sr(e,(o,a)=>{if(a<=n){const l=this.br(e,o).next(d=>{if(!d)return i++,r.getEntry(e,o).next(()=>(r.removeEntry(o,fe.min()),bs(e).delete(function(f){return[0,un(f.path)]}(o))))});s.push(l)}}).next(()=>O.waitFor(s)).next(()=>r.apply(e)).next(()=>i)}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,n){return Tu(e,n)}Sr(e,n){const r=bs(e);let s,i=Kn.ce;return r.ee({index:Ay},([o,a],{path:l,sequenceNumber:d})=>{o===0?(i!==Kn.ce&&n(new te(br(s)),i),i=d,s=l):i=Kn.ce}).next(()=>{i!==Kn.ce&&n(new te(br(s)),i)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function Tu(t,e){return bs(t).put(function(r,s){return{targetId:0,path:un(r.path),sequenceNumber:s}}(e,t.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gC{constructor(){this.changes=new ss(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,Et.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?O.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YV{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,n,r){return di(e).put(r)}removeEntry(e,n,r){return di(e).delete(function(i,o){const a=i.path.toArray();return[a.slice(0,a.length-2),a[a.length-2],Xd(o),a[a.length-1]]}(n,r))}updateMetadata(e,n){return this.getMetadata(e).next(r=>(r.byteSize+=n,this.Dr(e,r)))}getEntry(e,n){let r=Et.newInvalidDocument(n);return di(e).ee({index:Ju,range:IDBKeyRange.only(il(n))},(s,i)=>{r=this.Cr(n,i)}).next(()=>r)}vr(e,n){let r={size:0,document:Et.newInvalidDocument(n)};return di(e).ee({index:Ju,range:IDBKeyRange.only(il(n))},(s,i)=>{r={document:this.Cr(n,i),size:Zd(i)}}).next(()=>r)}getEntries(e,n){let r=jn();return this.Fr(e,n,(s,i)=>{const o=this.Cr(s,i);r=r.insert(s,o)}).next(()=>r)}Mr(e,n){let r=jn(),s=new ht(te.comparator);return this.Fr(e,n,(i,o)=>{const a=this.Cr(i,o);r=r.insert(i,a),s=s.insert(i,Zd(o))}).next(()=>({documents:r,Or:s}))}Fr(e,n,r){if(n.isEmpty())return O.resolve();let s=new tt(fI);n.forEach(l=>s=s.add(l));const i=IDBKeyRange.bound(il(s.first()),il(s.last())),o=s.getIterator();let a=o.getNext();return di(e).ee({index:Ju,range:i},(l,d,h)=>{const f=te.fromSegments([...d.prefixPath,d.collectionGroup,d.documentId]);for(;a&&fI(a,f)<0;)r(a,null),a=o.getNext();a&&a.isEqual(f)&&(r(a,d),a=o.hasNext()?o.getNext():null),a?h.j(il(a)):h.done()}).next(()=>{for(;a;)r(a,null),a=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,n,r,s,i){const o=n.path,a=[o.popLast().toArray(),o.lastSegment(),Xd(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],l=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return di(e).J(IDBKeyRange.bound(a,l,!0)).next(d=>{i==null||i.incrementDocumentReadCount(d.length);let h=jn();for(const f of d){const m=this.Cr(te.fromSegments(f.prefixPath.concat(f.collectionGroup,f.documentId)),f);m.isFoundDocument()&&(Oc(n,m)||s.has(m.key))&&(h=h.insert(m.key,m))}return h})}getAllFromCollectionGroup(e,n,r,s){let i=jn();const o=hI(n,r),a=hI(n,Mn.max());return di(e).ee({index:ib,range:IDBKeyRange.bound(o,a,!0)},(l,d,h)=>{const f=this.Cr(te.fromSegments(d.prefixPath.concat(d.collectionGroup,d.documentId)),d);i=i.insert(f.key,f),i.size===s&&h.done()}).next(()=>i)}newChangeBuffer(e){return new XV(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(n=>n.byteSize)}getMetadata(e){return dI(e).get(Mm).next(n=>(ce(!!n,20021),n))}Dr(e,n){return dI(e).put(Mm,n)}Cr(e,n){if(n){const r=OV(this.serializer,n);if(!(r.isNoDocument()&&r.version.isEqual(fe.min())))return r}return Et.newInvalidDocument(e)}}function yC(t){return new YV(t)}class XV extends gC{constructor(e,n){super(),this.Nr=e,this.trackRemovals=n,this.Br=new ss(r=>r.toString(),(r,s)=>r.isEqual(s))}applyChanges(e){const n=[];let r=0,s=new tt((i,o)=>Te(i.canonicalString(),o.canonicalString()));return this.changes.forEach((i,o)=>{const a=this.Br.get(i);if(n.push(this.Nr.removeEntry(e,i,a.readTime)),o.isValidDocument()){const l=GE(this.Nr.serializer,o);s=s.add(i.path.popLast());const d=Zd(l);r+=d-a.size,n.push(this.Nr.addEntry(e,i,l))}else if(r-=a.size,this.trackRemovals){const l=GE(this.Nr.serializer,o.convertToNoDocument(fe.min()));n.push(this.Nr.addEntry(e,i,l))}}),s.forEach(i=>{n.push(this.Nr.indexManager.addToCollectionParentIndex(e,i))}),n.push(this.Nr.updateMetadata(e,r)),O.waitFor(n)}getFromCache(e,n){return this.Nr.vr(e,n).next(r=>(this.Br.set(n,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,n){return this.Nr.Mr(e,n).next(({documents:r,Or:s})=>(s.forEach((i,o)=>{this.Br.set(i,{size:o,readTime:r.get(i).readTime})}),r))}}function dI(t){return Lt(t,hc)}function di(t){return Lt(t,zd)}function il(t){const e=t.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function hI(t,e){const n=e.documentKey.path.toArray();return[t,Xd(e.readTime),n.slice(0,n.length-2),n.length>0?n[n.length-1]:""]}function fI(t,e){const n=t.path.toArray(),r=e.path.toArray();let s=0;for(let i=0;i<n.length-2&&i<r.length-2;++i)if(s=Te(n[i],r[i]),s)return s;return s=Te(n.length,r.length),s||(s=Te(n[n.length-2],r[r.length-2]),s||Te(n[n.length-1],r[r.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JV{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _C{constructor(e,n,r,s){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=s}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(s=>(r=s,this.remoteDocumentCache.getEntry(e,n))).next(s=>(r!==null&&Fl(r.mutation,s,Sn.empty(),Be.now()),s))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,Pe()).next(()=>r))}getLocalViewOfDocuments(e,n,r=Pe()){const s=Cr();return this.populateOverlays(e,s,n).next(()=>this.computeViews(e,n,s,r).next(i=>{let o=gl();return i.forEach((a,l)=>{o=o.insert(a,l.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){const r=Cr();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,Pe()))}populateOverlays(e,n,r){const s=[];return r.forEach(i=>{n.has(i)||s.push(i)}),this.documentOverlayCache.getOverlays(e,s).next(i=>{i.forEach((o,a)=>{n.set(o,a)})})}computeViews(e,n,r,s){let i=jn();const o=Ml(),a=function(){return Ml()}();return n.forEach((l,d)=>{const h=r.get(d.key);s.has(d.key)&&(h===void 0||h.mutation instanceof is)?i=i.insert(d.key,d):h!==void 0?(o.set(d.key,h.mutation.getFieldMask()),Fl(h.mutation,d,h.mutation.getFieldMask(),Be.now())):o.set(d.key,Sn.empty())}),this.recalculateAndSaveOverlays(e,i).next(l=>(l.forEach((d,h)=>o.set(d,h)),n.forEach((d,h)=>a.set(d,new JV(h,o.get(d)??null))),a))}recalculateAndSaveOverlays(e,n){const r=Ml();let s=new ht((o,a)=>o-a),i=Pe();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(const a of o)a.keys().forEach(l=>{const d=n.get(l);if(d===null)return;let h=r.get(l)||Sn.empty();h=a.applyToLocalView(d,h),r.set(l,h);const f=(s.get(a.batchId)||Pe()).add(l);s=s.insert(a.batchId,f)})}).next(()=>{const o=[],a=s.getReverseIterator();for(;a.hasNext();){const l=a.getNext(),d=l.key,h=l.value,f=Vb();h.forEach(m=>{if(!i.has(m)){const v=zb(n.get(m),r.get(m));v!==null&&f.set(m,v),i=i.add(m)}}),o.push(this.documentOverlayCache.saveOverlays(e,d,f))}return O.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,s){return function(o){return te.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):Oy(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,s):this.getDocumentsMatchingCollectionQuery(e,n,r,s)}getNextDocuments(e,n,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,s).next(i=>{const o=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,s-i.size):O.resolve(Cr());let a=lc,l=i;return o.next(d=>O.forEach(d,(h,f)=>(a<f.largestBatchId&&(a=f.largestBatchId),i.get(h)?O.resolve():this.remoteDocumentCache.getEntry(e,h).next(m=>{l=l.insert(h,m)}))).next(()=>this.populateOverlays(e,d,i)).next(()=>this.computeViews(e,l,d,Pe())).next(h=>({batchId:a,changes:Ob(h)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new te(n)).next(r=>{let s=gl();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s})}getDocumentsMatchingCollectionGroupQuery(e,n,r,s){const i=n.collectionGroup;let o=gl();return this.indexManager.getCollectionParents(e,i).next(a=>O.forEach(a,l=>{const d=function(f,m){return new oi(m,null,f.explicitOrderBy.slice(),f.filters.slice(),f.limit,f.limitType,f.startAt,f.endAt)}(n,l.child(i));return this.getDocumentsMatchingCollectionQuery(e,d,r,s).next(h=>{h.forEach((f,m)=>{o=o.insert(f,m)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,n,r,s){let i;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(o=>(i=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,i,s))).next(o=>{i.forEach((l,d)=>{const h=d.getKey();o.get(h)===null&&(o=o.insert(h,Et.newInvalidDocument(h)))});let a=gl();return o.forEach((l,d)=>{const h=i.get(l);h!==void 0&&Fl(h.mutation,d,Sn.empty(),Be.now()),Oc(n,d)&&(a=a.insert(l,d))}),a})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZV{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,n){return O.resolve(this.Lr.get(n))}saveBundleMetadata(e,n){return this.Lr.set(n.id,function(s){return{id:s.id,version:s.version,createTime:yn(s.createTime)}}(n)),O.resolve()}getNamedQuery(e,n){return O.resolve(this.kr.get(n))}saveNamedQuery(e,n){return this.kr.set(n.name,function(s){return{name:s.name,query:aC(s.bundledQuery),readTime:yn(s.readTime)}}(n)),O.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eL{constructor(){this.overlays=new ht(te.comparator),this.qr=new Map}getOverlay(e,n){return O.resolve(this.overlays.get(n))}getOverlays(e,n){const r=Cr();return O.forEach(n,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((s,i)=>{this.St(e,n,i)}),O.resolve()}removeOverlaysForBatchId(e,n,r){const s=this.qr.get(r);return s!==void 0&&(s.forEach(i=>this.overlays=this.overlays.remove(i)),this.qr.delete(r)),O.resolve()}getOverlaysForCollection(e,n,r){const s=Cr(),i=n.length+1,o=new te(n.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const l=a.getNext().value,d=l.getKey();if(!n.isPrefixOf(d.path))break;d.path.length===i&&l.largestBatchId>r&&s.set(l.getKey(),l)}return O.resolve(s)}getOverlaysForCollectionGroup(e,n,r,s){let i=new ht((d,h)=>d-h);const o=this.overlays.getIterator();for(;o.hasNext();){const d=o.getNext().value;if(d.getKey().getCollectionGroup()===n&&d.largestBatchId>r){let h=i.get(d.largestBatchId);h===null&&(h=Cr(),i=i.insert(d.largestBatchId,h)),h.set(d.getKey(),d)}}const a=Cr(),l=i.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((d,h)=>a.set(d,h)),!(a.size()>=s)););return O.resolve(a)}St(e,n,r){const s=this.overlays.get(r.key);if(s!==null){const o=this.qr.get(s.largestBatchId).delete(r.key);this.qr.set(s.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new Fy(n,r));let i=this.qr.get(n);i===void 0&&(i=Pe(),this.qr.set(n,i)),this.qr.set(n,i.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tL{constructor(){this.sessionToken=Nt.EMPTY_BYTE_STRING}getSessionToken(e){return O.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,O.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hy{constructor(){this.Qr=new tt(Bt.$r),this.Ur=new tt(Bt.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,n){const r=new Bt(e,n);this.Qr=this.Qr.add(r),this.Ur=this.Ur.add(r)}Wr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Gr(new Bt(e,n))}zr(e,n){e.forEach(r=>this.removeReference(r,n))}jr(e){const n=new te(new We([])),r=new Bt(n,e),s=new Bt(n,e+1),i=[];return this.Ur.forEachInRange([r,s],o=>{this.Gr(o),i.push(o.key)}),i}Jr(){this.Qr.forEach(e=>this.Gr(e))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const n=new te(new We([])),r=new Bt(n,e),s=new Bt(n,e+1);let i=Pe();return this.Ur.forEachInRange([r,s],o=>{i=i.add(o.key)}),i}containsKey(e){const n=new Bt(e,0),r=this.Qr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class Bt{constructor(e,n){this.key=e,this.Yr=n}static $r(e,n){return te.comparator(e.key,n.key)||Te(e.Yr,n.Yr)}static Kr(e,n){return Te(e.Yr,n.Yr)||te.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nL{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.tr=1,this.Zr=new tt(Bt.$r)}checkEmpty(e){return O.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,s){const i=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new Ly(i,n,r,s);this.mutationQueue.push(o);for(const a of s)this.Zr=this.Zr.add(new Bt(a.key,i)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return O.resolve(o)}lookupMutationBatch(e,n){return O.resolve(this.Xr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,s=this.ei(r),i=s<0?0:s;return O.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return O.resolve(this.mutationQueue.length===0?Pi:this.tr-1)}getAllMutationBatches(e){return O.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new Bt(n,0),s=new Bt(n,Number.POSITIVE_INFINITY),i=[];return this.Zr.forEachInRange([r,s],o=>{const a=this.Xr(o.Yr);i.push(a)}),O.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new tt(Te);return n.forEach(s=>{const i=new Bt(s,0),o=new Bt(s,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([i,o],a=>{r=r.add(a.Yr)})}),O.resolve(this.ti(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,s=r.length+1;let i=r;te.isDocumentKey(i)||(i=i.child(""));const o=new Bt(new te(i),0);let a=new tt(Te);return this.Zr.forEachWhile(l=>{const d=l.key.path;return!!r.isPrefixOf(d)&&(d.length===s&&(a=a.add(l.Yr)),!0)},o),O.resolve(this.ti(a))}ti(e){const n=[];return e.forEach(r=>{const s=this.Xr(r);s!==null&&n.push(s)}),n}removeMutationBatch(e,n){ce(this.ni(n.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Zr;return O.forEach(n.mutations,s=>{const i=new Bt(s.key,n.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.Zr=r})}ir(e){}containsKey(e,n){const r=new Bt(n,0),s=this.Zr.firstAfterOrEqual(r);return O.resolve(n.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,O.resolve()}ni(e,n){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const n=this.ei(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rL{constructor(e){this.ri=e,this.docs=function(){return new ht(te.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,s=this.docs.get(r),i=s?s.size:0,o=this.ri(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return O.resolve(r?r.document.mutableCopy():Et.newInvalidDocument(n))}getEntries(e,n){let r=jn();return n.forEach(s=>{const i=this.docs.get(s);r=r.insert(s,i?i.document.mutableCopy():Et.newInvalidDocument(s))}),O.resolve(r)}getDocumentsMatchingQuery(e,n,r,s){let i=jn();const o=n.path,a=new te(o.child("__id-9223372036854775808__")),l=this.docs.getIteratorFrom(a);for(;l.hasNext();){const{key:d,value:{document:h}}=l.getNext();if(!o.isPrefixOf(d.path))break;d.path.length>o.length+1||by(eb(h),r)<=0||(s.has(h.key)||Oc(n,h))&&(i=i.insert(h.key,h.mutableCopy()))}return O.resolve(i)}getAllFromCollectionGroup(e,n,r,s){le(9500)}ii(e,n){return O.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new sL(this)}getSize(e){return O.resolve(this.size)}}class sL extends gC{constructor(e){super(),this.Nr=e}applyChanges(e){const n=[];return this.changes.forEach((r,s)=>{s.isValidDocument()?n.push(this.Nr.addEntry(e,s)):this.Nr.removeEntry(r)}),O.waitFor(n)}getFromCache(e,n){return this.Nr.getEntry(e,n)}getAllFromCache(e,n){return this.Nr.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iL{constructor(e){this.persistence=e,this.si=new ss(n=>Wi(n),Dc),this.lastRemoteSnapshotVersion=fe.min(),this.highestTargetId=0,this.oi=0,this._i=new Hy,this.targetCount=0,this.ai=Yi.ur()}forEachTarget(e,n){return this.si.forEach((r,s)=>n(s)),O.resolve()}getLastRemoteSnapshotVersion(e){return O.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return O.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),O.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.oi&&(this.oi=n),O.resolve()}Pr(e){this.si.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.ai=new Yi(n),this.highestTargetId=n),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,n){return this.Pr(n),this.targetCount+=1,O.resolve()}updateTargetData(e,n){return this.Pr(n),O.resolve()}removeTargetData(e,n){return this.si.delete(n.target),this._i.jr(n.targetId),this.targetCount-=1,O.resolve()}removeTargets(e,n,r){let s=0;const i=[];return this.si.forEach((o,a)=>{a.sequenceNumber<=n&&r.get(a.targetId)===null&&(this.si.delete(o),i.push(this.removeMatchingKeysForTargetId(e,a.targetId)),s++)}),O.waitFor(i).next(()=>s)}getTargetCount(e){return O.resolve(this.targetCount)}getTargetData(e,n){const r=this.si.get(n)||null;return O.resolve(r)}addMatchingKeys(e,n,r){return this._i.Wr(n,r),O.resolve()}removeMatchingKeys(e,n,r){this._i.zr(n,r);const s=this.persistence.referenceDelegate,i=[];return s&&n.forEach(o=>{i.push(s.markPotentiallyOrphaned(e,o))}),O.waitFor(i)}removeMatchingKeysForTargetId(e,n){return this._i.jr(n),O.resolve()}getMatchingKeysForTargetId(e,n){const r=this._i.Hr(n);return O.resolve(r)}containsKey(e,n){return O.resolve(this._i.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wy{constructor(e,n){this.ui={},this.overlays={},this.ci=new Kn(0),this.li=!1,this.li=!0,this.hi=new tL,this.referenceDelegate=e(this),this.Pi=new iL(this),this.indexManager=new zV,this.remoteDocumentCache=function(s){return new rL(s)}(r=>this.referenceDelegate.Ti(r)),this.serializer=new iC(n),this.Ii=new ZV(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new eL,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.ui[e.toKey()];return r||(r=new nL(n,this.referenceDelegate),this.ui[e.toKey()]=r),r}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,n,r){H("MemoryPersistence","Starting transaction:",e);const s=new oL(this.ci.next());return this.referenceDelegate.Ei(),r(s).next(i=>this.referenceDelegate.di(s).next(()=>i)).toPromise().then(i=>(s.raiseOnCommittedEvent(),i))}Ai(e,n){return O.or(Object.values(this.ui).map(r=>()=>r.containsKey(e,n)))}}class oL extends nb{constructor(e){super(),this.currentSequenceNumber=e}}class Jh{constructor(e){this.persistence=e,this.Ri=new Hy,this.Vi=null}static mi(e){return new Jh(e)}get fi(){if(this.Vi)return this.Vi;throw le(60996)}addReference(e,n,r){return this.Ri.addReference(r,n),this.fi.delete(r.toString()),O.resolve()}removeReference(e,n,r){return this.Ri.removeReference(r,n),this.fi.add(r.toString()),O.resolve()}markPotentiallyOrphaned(e,n){return this.fi.add(n.toString()),O.resolve()}removeTarget(e,n){this.Ri.jr(n.targetId).forEach(s=>this.fi.add(s.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(s=>{s.forEach(i=>this.fi.add(i.toString()))}).next(()=>r.removeTargetData(e,n))}Ei(){this.Vi=new Set}di(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return O.forEach(this.fi,r=>{const s=te.fromPath(r);return this.gi(e,s).next(i=>{i||n.removeEntry(s,fe.min())})}).next(()=>(this.Vi=null,n.apply(e)))}updateLimboDocument(e,n){return this.gi(e,n).next(r=>{r?this.fi.delete(n.toString()):this.fi.add(n.toString())})}Ti(e){return 0}gi(e,n){return O.or([()=>O.resolve(this.Ri.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Ai(e,n)])}}class eh{constructor(e,n){this.persistence=e,this.pi=new ss(r=>un(r.path),(r,s)=>r.isEqual(s)),this.garbageCollector=mC(this,n)}static mi(e,n){return new eh(e,n)}Ei(){}di(e){return O.resolve()}forEachTarget(e,n){return this.persistence.getTargetCache().forEachTarget(e,n)}gr(e){const n=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next(r=>n.next(s=>r+s))}wr(e){let n=0;return this.pr(e,r=>{n++}).next(()=>n)}pr(e,n){return O.forEach(this.pi,(r,s)=>this.br(e,r,s).next(i=>i?O.resolve():n(s)))}removeTargets(e,n,r){return this.persistence.getTargetCache().removeTargets(e,n,r)}removeOrphanedDocuments(e,n){let r=0;const s=this.persistence.getRemoteDocumentCache(),i=s.newChangeBuffer();return s.ii(e,o=>this.br(e,o,n).next(a=>{a||(r++,i.removeEntry(o,fe.min()))})).next(()=>i.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,n){return this.pi.set(n,e.currentSequenceNumber),O.resolve()}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,n,r){return this.pi.set(r,e.currentSequenceNumber),O.resolve()}removeReference(e,n,r){return this.pi.set(r,e.currentSequenceNumber),O.resolve()}updateLimboDocument(e,n){return this.pi.set(n,e.currentSequenceNumber),O.resolve()}Ti(e){let n=e.key.toString().length;return e.isFoundDocument()&&(n+=ed(e.data.value)),n}br(e,n,r){return O.or([()=>this.persistence.Ai(e,n),()=>this.persistence.getTargetCache().containsKey(e,n),()=>{const s=this.pi.get(n);return O.resolve(s!==void 0&&s>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aL{constructor(e){this.serializer=e}k(e,n,r,s){const i=new Vh("createOrUpgrade",n);r<1&&s>=1&&(function(l){l.createObjectStore(Nc)}(e),function(l){l.createObjectStore(dc,{keyPath:gO}),l.createObjectStore(sr,{keyPath:xE,autoIncrement:!0}).createIndex(bi,SE,{unique:!0}),l.createObjectStore(da)}(e),pI(e),function(l){l.createObjectStore(yi)}(e));let o=O.resolve();return r<3&&s>=3&&(r!==0&&(function(l){l.deleteObjectStore(fa),l.deleteObjectStore(ha),l.deleteObjectStore(ki)}(e),pI(e)),o=o.next(()=>function(l){const d=l.store(ki),h={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:fe.min().toTimestamp(),targetCount:0};return d.put(qd,h)}(i))),r<4&&s>=4&&(r!==0&&(o=o.next(()=>function(l,d){return d.store(sr).J().next(f=>{l.deleteObjectStore(sr),l.createObjectStore(sr,{keyPath:xE,autoIncrement:!0}).createIndex(bi,SE,{unique:!0});const m=d.store(sr),v=f.map(R=>m.put(R));return O.waitFor(v)})}(e,i))),o=o.next(()=>{(function(l){l.createObjectStore(pa,{keyPath:SO})})(e)})),r<5&&s>=5&&(o=o.next(()=>this.yi(i))),r<6&&s>=6&&(o=o.next(()=>(function(l){l.createObjectStore(hc)}(e),this.wi(i)))),r<7&&s>=7&&(o=o.next(()=>this.Si(i))),r<8&&s>=8&&(o=o.next(()=>this.bi(e,i))),r<9&&s>=9&&(o=o.next(()=>{(function(l){l.objectStoreNames.contains("remoteDocumentChanges")&&l.deleteObjectStore("remoteDocumentChanges")})(e)})),r<10&&s>=10&&(o=o.next(()=>this.Di(i))),r<11&&s>=11&&(o=o.next(()=>{(function(l){l.createObjectStore(Mh,{keyPath:bO})})(e),function(l){l.createObjectStore(Fh,{keyPath:CO})}(e)})),r<12&&s>=12&&(o=o.next(()=>{(function(l){const d=l.createObjectStore(Uh,{keyPath:jO});d.createIndex(Um,OO,{unique:!1}),d.createIndex(cb,VO,{unique:!1})})(e)})),r<13&&s>=13&&(o=o.next(()=>function(l){const d=l.createObjectStore(zd,{keyPath:_O});d.createIndex(Ju,vO),d.createIndex(ib,wO)}(e)).next(()=>this.Ci(e,i)).next(()=>e.deleteObjectStore(yi))),r<14&&s>=14&&(o=o.next(()=>this.Fi(e,i))),r<15&&s>=15&&(o=o.next(()=>function(l){l.createObjectStore(Ry,{keyPath:AO,autoIncrement:!0}).createIndex(Fm,RO,{unique:!1}),l.createObjectStore(Ol,{keyPath:PO}).createIndex(ab,kO,{unique:!1}),l.createObjectStore(Vl,{keyPath:NO}).createIndex(lb,DO,{unique:!1})}(e))),r<16&&s>=16&&(o=o.next(()=>{n.objectStore(Ol).clear()}).next(()=>{n.objectStore(Vl).clear()})),r<17&&s>=17&&(o=o.next(()=>{(function(l){l.createObjectStore(Py,{keyPath:LO})})(e)})),r<18&&s>=18&&tS()&&(o=o.next(()=>{n.objectStore(Ol).clear()}).next(()=>{n.objectStore(Vl).clear()})),o}wi(e){let n=0;return e.store(yi).ee((r,s)=>{n+=Zd(s)}).next(()=>{const r={byteSize:n};return e.store(hc).put(Mm,r)})}yi(e){const n=e.store(dc),r=e.store(sr);return n.J().next(s=>O.forEach(s,i=>{const o=IDBKeyRange.bound([i.userId,Pi],[i.userId,i.lastAcknowledgedBatchId]);return r.J(bi,o).next(a=>O.forEach(a,l=>{ce(l.userId===i.userId,18650,"Cannot process batch from unexpected user",{batchId:l.batchId});const d=vi(this.serializer,l);return dC(e,i.userId,d).next(()=>{})}))}))}Si(e){const n=e.store(fa),r=e.store(yi);return e.store(ki).get(qd).next(s=>{const i=[];return r.ee((o,a)=>{const l=new We(o),d=function(f){return[0,un(f)]}(l);i.push(n.get(d).next(h=>h?O.resolve():(f=>n.put({targetId:0,path:un(f),sequenceNumber:s.highestListenSequenceNumber}))(l)))}).next(()=>O.waitFor(i))})}bi(e,n){e.createObjectStore(fc,{keyPath:xO});const r=n.store(fc),s=new qy,i=o=>{if(s.add(o)){const a=o.lastSegment(),l=o.popLast();return r.put({collectionId:a,parent:un(l)})}};return n.store(yi).ee({X:!0},(o,a)=>{const l=new We(o);return i(l.popLast())}).next(()=>n.store(da).ee({X:!0},([o,a,l],d)=>{const h=br(a);return i(h.popLast())}))}Di(e){const n=e.store(ha);return n.ee((r,s)=>{const i=_l(s),o=oC(this.serializer,i);return n.put(o)})}Ci(e,n){const r=n.store(yi),s=[];return r.ee((i,o)=>{const a=n.store(zd),l=function(f){return f.document?new te(We.fromString(f.document.name).popFirst(5)):f.noDocument?te.fromSegments(f.noDocument.path):f.unknownDocument?te.fromSegments(f.unknownDocument.path):le(36783)}(o).path.toArray(),d={prefixPath:l.slice(0,l.length-2),collectionGroup:l[l.length-2],documentId:l[l.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};s.push(a.put(d))}).next(()=>O.waitFor(s))}Fi(e,n){const r=n.store(sr),s=yC(this.serializer),i=new Wy(Jh.mi,this.serializer.yt);return r.J().next(o=>{const a=new Map;return o.forEach(l=>{let d=a.get(l.userId)??Pe();vi(this.serializer,l).keys().forEach(h=>d=d.add(h)),a.set(l.userId,d)}),O.forEach(a,(l,d)=>{const h=new Wt(d),f=Yh.wt(this.serializer,h),m=i.getIndexManager(h),v=Xh.wt(h,this.serializer,m,i.referenceDelegate);return new _C(s,v,f,m).recalculateAndSaveOverlaysForDocumentKeys(new $m(n,Kn.ce),l).next()})})}}function pI(t){t.createObjectStore(fa,{keyPath:IO}).createIndex(Ay,TO,{unique:!0}),t.createObjectStore(ha,{keyPath:"targetId"}).createIndex(ob,EO,{unique:!0}),t.createObjectStore(ki)}const gs="IndexedDbPersistence",pp=18e5,mp=5e3,gp="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",lL="main";class Ky{constructor(e,n,r,s,i,o,a,l,d,h,f=18){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.Mi=i,this.window=o,this.document=a,this.xi=d,this.Oi=h,this.Ni=f,this.ci=null,this.li=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Bi=null,this.inForeground=!1,this.Li=null,this.ki=null,this.qi=Number.NEGATIVE_INFINITY,this.Qi=m=>Promise.resolve(),!Ky.v())throw new K($.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new QV(this,s),this.$i=n+lL,this.serializer=new iC(l),this.Ui=new zs(this.$i,this.Ni,new aL(this.serializer)),this.hi=new LV,this.Pi=new HV(this.referenceDelegate,this.serializer),this.remoteDocumentCache=yC(this.serializer),this.Ii=new VV,this.window&&this.window.localStorage?this.Ki=this.window.localStorage:(this.Ki=null,h===!1&&pn(gs,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Wi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new K($.FAILED_PRECONDITION,gp);return this.Gi(),this.zi(),this.ji(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Pi.getHighestSequenceNumber(e))}).then(e=>{this.ci=new Kn(e,this.xi)}).then(()=>{this.li=!0}).catch(e=>(this.Ui&&this.Ui.close(),Promise.reject(e)))}Ji(e){return this.Qi=async n=>{if(this.started)return e(n)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ui.$(async n=>{n.newVersion===null&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Mi.enqueueAndForget(async()=>{this.started&&await this.Wi()}))}Wi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>xu(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.Hi(e).next(n=>{n||(this.isPrimary=!1,this.Mi.enqueueRetryable(()=>this.Qi(!1)))})}).next(()=>this.Yi(e)).next(n=>this.isPrimary&&!n?this.Zi(e).next(()=>!1):!!n&&this.Xi(e).next(()=>!0))).catch(e=>{if(si(e))return H(gs,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return H(gs,"Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.Mi.enqueueRetryable(()=>this.Qi(e)),this.isPrimary=e})}Hi(e){return ol(e).get(ho).next(n=>O.resolve(this.es(n)))}ts(e){return xu(e).delete(this.clientId)}async ns(){if(this.isPrimary&&!this.rs(this.qi,pp)){this.qi=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",n=>{const r=Lt(n,pa);return r.J().next(s=>{const i=this.ss(s,pp),o=s.filter(a=>i.indexOf(a)===-1);return O.forEach(o,a=>r.delete(a.clientId)).next(()=>o)})}).catch(()=>[]);if(this.Ki)for(const n of e)this.Ki.removeItem(this._s(n.clientId))}}ji(){this.ki=this.Mi.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.Wi().then(()=>this.ns()).then(()=>this.ji()))}es(e){return!!e&&e.ownerId===this.clientId}Yi(e){return this.Oi?O.resolve(!0):ol(e).get(ho).next(n=>{if(n!==null&&this.rs(n.leaseTimestampMs,mp)&&!this.us(n.ownerId)){if(this.es(n)&&this.networkEnabled)return!0;if(!this.es(n)){if(!n.allowTabSynchronization)throw new K($.FAILED_PRECONDITION,gp);return!1}}return!(!this.networkEnabled||!this.inForeground)||xu(e).J().next(r=>this.ss(r,mp).find(s=>{if(this.clientId!==s.clientId){const i=!this.networkEnabled&&s.networkEnabled,o=!this.inForeground&&s.inForeground,a=this.networkEnabled===s.networkEnabled;if(i||o&&a)return!0}return!1})===void 0)}).next(n=>(this.isPrimary!==n&&H(gs,`Client ${n?"is":"is not"} eligible for a primary lease.`),n))}async shutdown(){this.li=!1,this.cs(),this.ki&&(this.ki.cancel(),this.ki=null),this.ls(),this.hs(),await this.Ui.runTransaction("shutdown","readwrite",[Nc,pa],e=>{const n=new $m(e,Kn.ce);return this.Zi(n).next(()=>this.ts(n))}),this.Ui.close(),this.Ps()}ss(e,n){return e.filter(r=>this.rs(r.updateTimeMs,n)&&!this.us(r.clientId))}Ts(){return this.runTransaction("getActiveClients","readonly",e=>xu(e).J().next(n=>this.ss(n,pp).map(r=>r.clientId)))}get started(){return this.li}getGlobalsCache(){return this.hi}getMutationQueue(e,n){return Xh.wt(e,this.serializer,n,this.referenceDelegate)}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new qV(e,this.serializer.yt.databaseId)}getDocumentOverlayCache(e){return Yh.wt(this.serializer,e)}getBundleCache(){return this.Ii}runTransaction(e,n,r){H(gs,"Starting transaction:",e);const s=n==="readonly"?"readonly":"readwrite",i=function(l){return l===18?UO:l===17?fb:l===16?FO:l===15?ky:l===14?hb:l===13?db:l===12?MO:l===11?ub:void le(60245)}(this.Ni);let o;return this.Ui.runTransaction(e,s,i,a=>(o=new $m(a,this.ci?this.ci.next():Kn.ce),n==="readwrite-primary"?this.Hi(o).next(l=>!!l||this.Yi(o)).next(l=>{if(!l)throw pn(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Mi.enqueueRetryable(()=>this.Qi(!1)),new K($.FAILED_PRECONDITION,tb);return r(o)}).next(l=>this.Xi(o).next(()=>l)):this.Is(o).next(()=>r(o)))).then(a=>(o.raiseOnCommittedEvent(),a))}Is(e){return ol(e).get(ho).next(n=>{if(n!==null&&this.rs(n.leaseTimestampMs,mp)&&!this.us(n.ownerId)&&!this.es(n)&&!(this.Oi||this.allowTabSynchronization&&n.allowTabSynchronization))throw new K($.FAILED_PRECONDITION,gp)})}Xi(e){const n={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return ol(e).put(ho,n)}static v(){return zs.v()}Zi(e){const n=ol(e);return n.get(ho).next(r=>this.es(r)?(H(gs,"Releasing primary lease."),n.delete(ho)):O.resolve())}rs(e,n){const r=Date.now();return!(e<r-n)&&(!(e>r)||(pn(`Detected an update time that is in the future: ${e} > ${r}`),!1))}Gi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Li=()=>{this.Mi.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.Wi()))},this.document.addEventListener("visibilitychange",this.Li),this.inForeground=this.document.visibilityState==="visible")}ls(){this.Li&&(this.document.removeEventListener("visibilitychange",this.Li),this.Li=null)}zi(){var e;typeof((e=this.window)==null?void 0:e.addEventListener)=="function"&&(this.Bi=()=>{this.cs();const n=/(?:Version|Mobile)\/1[456]/;eS()&&(navigator.appVersion.match(n)||navigator.userAgent.match(n))&&this.Mi.enterRestrictedMode(!0),this.Mi.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Bi))}hs(){this.Bi&&(this.window.removeEventListener("pagehide",this.Bi),this.Bi=null)}us(e){var n;try{const r=((n=this.Ki)==null?void 0:n.getItem(this._s(e)))!==null;return H(gs,`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return pn(gs,"Failed to get zombied client id.",r),!1}}cs(){if(this.Ki)try{this.Ki.setItem(this._s(this.clientId),String(Date.now()))}catch(e){pn("Failed to set zombie client id.",e)}}Ps(){if(this.Ki)try{this.Ki.removeItem(this._s(this.clientId))}catch{}}_s(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function ol(t){return Lt(t,Nc)}function xu(t){return Lt(t,pa)}function cL(t,e){let n=t.projectId;return t.isDefaultDatabase||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gy{constructor(e,n,r,s){this.targetId=e,this.fromCache=n,this.Es=r,this.ds=s}static As(e,n){let r=Pe(),s=Pe();for(const i of n.docChanges)switch(i.type){case 0:r=r.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new Gy(e,n.fromCache,r,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uL{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vC{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=function(){return eS()?8:rb(Vt())>0?6:4}()}initialize(e,n){this.ps=e,this.indexManager=n,this.Rs=!0}getDocumentsMatchingQuery(e,n,r,s){const i={result:null};return this.ys(e,n).next(o=>{i.result=o}).next(()=>{if(!i.result)return this.ws(e,n,s,r).next(o=>{i.result=o})}).next(()=>{if(i.result)return;const o=new uL;return this.Ss(e,n,o).next(a=>{if(i.result=a,this.Vs)return this.bs(e,n,o,a.size)})}).next(()=>i.result)}bs(e,n,r,s){return r.documentReadCount<this.fs?(So()<=Le.DEBUG&&H("QueryEngine","SDK will not create cache indexes for query:",bo(n),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),O.resolve()):(So()<=Le.DEBUG&&H("QueryEngine","Query:",bo(n),"scans",r.documentReadCount,"local documents and returns",s,"documents as results."),r.documentReadCount>this.gs*s?(So()<=Le.DEBUG&&H("QueryEngine","The SDK decides to create cache indexes for query:",bo(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Qn(n))):O.resolve())}ys(e,n){if(ME(n))return O.resolve(null);let r=Qn(n);return this.indexManager.getIndexType(e,r).next(s=>s===0?null:(n.limit!==null&&s===1&&(n=Gd(n,null,"F"),r=Qn(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(i=>{const o=Pe(...i);return this.ps.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,r).next(l=>{const d=this.Ds(n,a);return this.Cs(n,d,o,l.readTime)?this.ys(e,Gd(n,null,"F")):this.vs(e,d,n,l)}))})))}ws(e,n,r,s){return ME(n)||s.isEqual(fe.min())?O.resolve(null):this.ps.getDocuments(e,r).next(i=>{const o=this.Ds(n,i);return this.Cs(n,o,r,s)?O.resolve(null):(So()<=Le.DEBUG&&H("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),bo(n)),this.vs(e,o,n,cO(s,lc)).next(a=>a))})}Ds(e,n){let r=new tt(Db(e));return n.forEach((s,i)=>{Oc(e,i)&&(r=r.add(i))}),r}Cs(e,n,r,s){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const i=e.limitType==="F"?n.last():n.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}Ss(e,n,r){return So()<=Le.DEBUG&&H("QueryEngine","Using full collection scan to execute query:",bo(n)),this.ps.getDocumentsMatchingQuery(e,n,Mn.min(),r)}vs(e,n,r,s){return this.ps.getDocumentsMatchingQuery(e,r,s).next(i=>(n.forEach(o=>{i=i.insert(o.key,o)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qy="LocalStore",dL=3e8;class hL{constructor(e,n,r,s){this.persistence=e,this.Fs=n,this.serializer=s,this.Ms=new ht(Te),this.xs=new ss(i=>Wi(i),Dc),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(r)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new _C(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.Ms))}}function wC(t,e,n,r){return new hL(t,e,n,r)}async function EC(t,e){const n=ve(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let s;return n.mutationQueue.getAllMutationBatches(r).next(i=>(s=i,n.Bs(e),n.mutationQueue.getAllMutationBatches(r))).next(i=>{const o=[],a=[];let l=Pe();for(const d of s){o.push(d.batchId);for(const h of d.mutations)l=l.add(h.key)}for(const d of i){a.push(d.batchId);for(const h of d.mutations)l=l.add(h.key)}return n.localDocuments.getDocuments(r,l).next(d=>({Ls:d,removedBatchIds:o,addedBatchIds:a}))})})}function fL(t,e){const n=ve(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const s=e.batch.keys(),i=n.Ns.newChangeBuffer({trackRemovals:!0});return function(a,l,d,h){const f=d.batch,m=f.keys();let v=O.resolve();return m.forEach(R=>{v=v.next(()=>h.getEntry(l,R)).next(b=>{const A=d.docVersions.get(R);ce(A!==null,48541),b.version.compareTo(A)<0&&(f.applyToRemoteDocument(b,d),b.isValidDocument()&&(b.setReadTime(d.commitVersion),h.addEntry(b)))})}),v.next(()=>a.mutationQueue.removeMutationBatch(l,f))}(n,r,e,i).next(()=>i.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,s,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let l=Pe();for(let d=0;d<a.mutationResults.length;++d)a.mutationResults[d].transformResults.length>0&&(l=l.add(a.batch.mutations[d].key));return l}(e))).next(()=>n.localDocuments.getDocuments(r,s))})}function IC(t){const e=ve(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Pi.getLastRemoteSnapshotVersion(n))}function pL(t,e){const n=ve(t),r=e.snapshotVersion;let s=n.Ms;return n.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const o=n.Ns.newChangeBuffer({trackRemovals:!0});s=n.Ms;const a=[];e.targetChanges.forEach((h,f)=>{const m=s.get(f);if(!m)return;a.push(n.Pi.removeMatchingKeys(i,h.removedDocuments,f).next(()=>n.Pi.addMatchingKeys(i,h.addedDocuments,f)));let v=m.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(f)!==null?v=v.withResumeToken(Nt.EMPTY_BYTE_STRING,fe.min()).withLastLimboFreeSnapshotVersion(fe.min()):h.resumeToken.approximateByteSize()>0&&(v=v.withResumeToken(h.resumeToken,r)),s=s.insert(f,v),function(b,A,I){return b.resumeToken.approximateByteSize()===0||A.snapshotVersion.toMicroseconds()-b.snapshotVersion.toMicroseconds()>=dL?!0:I.addedDocuments.size+I.modifiedDocuments.size+I.removedDocuments.size>0}(m,v,h)&&a.push(n.Pi.updateTargetData(i,v))});let l=jn(),d=Pe();if(e.documentUpdates.forEach(h=>{e.resolvedLimboDocuments.has(h)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(i,h))}),a.push(mL(i,o,e.documentUpdates).next(h=>{l=h.ks,d=h.qs})),!r.isEqual(fe.min())){const h=n.Pi.getLastRemoteSnapshotVersion(i).next(f=>n.Pi.setTargetsMetadata(i,i.currentSequenceNumber,r));a.push(h)}return O.waitFor(a).next(()=>o.apply(i)).next(()=>n.localDocuments.getLocalViewOfDocuments(i,l,d)).next(()=>l)}).then(i=>(n.Ms=s,i))}function mL(t,e,n){let r=Pe(),s=Pe();return n.forEach(i=>r=r.add(i)),e.getEntries(t,r).next(i=>{let o=jn();return n.forEach((a,l)=>{const d=i.get(a);l.isFoundDocument()!==d.isFoundDocument()&&(s=s.add(a)),l.isNoDocument()&&l.version.isEqual(fe.min())?(e.removeEntry(a,l.readTime),o=o.insert(a,l)):!d.isValidDocument()||l.version.compareTo(d.version)>0||l.version.compareTo(d.version)===0&&d.hasPendingWrites?(e.addEntry(l),o=o.insert(a,l)):H(Qy,"Ignoring outdated watch update for ",a,". Current version:",d.version," Watch version:",l.version)}),{ks:o,qs:s}})}function gL(t,e){const n=ve(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=Pi),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function yL(t,e){const n=ve(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let s;return n.Pi.getTargetData(r,e).next(i=>i?(s=i,O.resolve(s)):n.Pi.allocateTargetId(r).next(o=>(s=new qr(e,o,"TargetPurposeListen",r.currentSequenceNumber),n.Pi.addTargetData(r,s).next(()=>s))))}).then(r=>{const s=n.Ms.get(r.targetId);return(s===null||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(n.Ms=n.Ms.insert(r.targetId,r),n.xs.set(e,r.targetId)),r})}async function tg(t,e,n){const r=ve(t),s=r.Ms.get(e),i=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",i,o=>r.persistence.referenceDelegate.removeTarget(o,s))}catch(o){if(!si(o))throw o;H(Qy,`Failed to update sequence numbers for target ${e}: ${o}`)}r.Ms=r.Ms.remove(e),r.xs.delete(s.target)}function mI(t,e,n){const r=ve(t);let s=fe.min(),i=Pe();return r.persistence.runTransaction("Execute query","readwrite",o=>function(l,d,h){const f=ve(l),m=f.xs.get(h);return m!==void 0?O.resolve(f.Ms.get(m)):f.Pi.getTargetData(d,h)}(r,o,Qn(e)).next(a=>{if(a)return s=a.lastLimboFreeSnapshotVersion,r.Pi.getMatchingKeysForTargetId(o,a.targetId).next(l=>{i=l})}).next(()=>r.Fs.getDocumentsMatchingQuery(o,e,n?s:fe.min(),n?i:Pe())).next(a=>(_L(r,nV(e),a),{documents:a,Qs:i})))}function _L(t,e,n){let r=t.Os.get(e)||fe.min();n.forEach((s,i)=>{i.readTime.compareTo(r)>0&&(r=i.readTime)}),t.Os.set(e,r)}class gI{constructor(){this.activeTargetIds=lV()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class TC{constructor(){this.Mo=new gI,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,n,r){this.xo[e]=n}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new gI,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vL{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yI="ConnectivityMonitor";class _I{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){H(yI,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){H(yI,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Su=null;function ng(){return Su===null?Su=function(){return 268435456+Math.round(2147483648*Math.random())}():Su++,"0x"+Su.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yp="RestConnection",wL={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class EL{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const n=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Uo=n+"://"+e.host,this.Ko=`projects/${r}/databases/${s}`,this.Wo=this.databaseId.database===Hd?`project_id=${r}`:`project_id=${r}&database_id=${s}`}Go(e,n,r,s,i){const o=ng(),a=this.zo(e,n.toUriEncodedString());H(yp,`Sending RPC '${e}' ${o}:`,a,r);const l={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(l,s,i);const{host:d}=new URL(a),h=ti(d);return this.Jo(e,a,l,r,h).then(f=>(H(yp,`Received RPC '${e}' ${o}: `,f),f),f=>{throw zi(yp,`RPC '${e}' ${o} failed with error: `,f,"url: ",a,"request:",r),f})}Ho(e,n,r,s,i,o){return this.Go(e,n,r,s,i)}jo(e,n,r){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+ka}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((s,i)=>e[i]=s),r&&r.headers.forEach((s,i)=>e[i]=s)}zo(e,n){const r=wL[e];return`${this.Uo}/v1/${n}:${r}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IL{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rn="WebChannelConnection";class TL extends EL{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,n,r,s,i){const o=ng();return new Promise((a,l)=>{const d=new qS;d.setWithCredentials(!0),d.listenOnce(HS.COMPLETE,()=>{try{switch(d.getLastErrorCode()){case Qu.NO_ERROR:const f=d.getResponseJson();H(rn,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(f)),a(f);break;case Qu.TIMEOUT:H(rn,`RPC '${e}' ${o} timed out`),l(new K($.DEADLINE_EXCEEDED,"Request time out"));break;case Qu.HTTP_ERROR:const m=d.getStatus();if(H(rn,`RPC '${e}' ${o} failed with status:`,m,"response text:",d.getResponseText()),m>0){let v=d.getResponseJson();Array.isArray(v)&&(v=v[0]);const R=v==null?void 0:v.error;if(R&&R.status&&R.message){const b=function(I){const w=I.toLowerCase().replace(/_/g,"-");return Object.values($).indexOf(w)>=0?w:$.UNKNOWN}(R.status);l(new K(b,R.message))}else l(new K($.UNKNOWN,"Server responded with status "+d.getStatus()))}else l(new K($.UNAVAILABLE,"Connection failed."));break;default:le(9055,{l_:e,streamId:o,h_:d.getLastErrorCode(),P_:d.getLastError()})}}finally{H(rn,`RPC '${e}' ${o} completed.`)}});const h=JSON.stringify(s);H(rn,`RPC '${e}' ${o} sending request:`,s),d.send(n,"POST",h,r,15)})}T_(e,n,r){const s=ng(),i=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=GS(),a=KS(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},d=this.longPollingOptions.timeoutSeconds;d!==void 0&&(l.longPollingTimeout=Math.round(1e3*d)),this.useFetchStreams&&(l.useFetchStreams=!0),this.jo(l.initMessageHeaders,n,r),l.encodeInitMessageHeaders=!0;const h=i.join("");H(rn,`Creating RPC '${e}' stream ${s}: ${h}`,l);const f=o.createWebChannel(h,l);this.I_(f);let m=!1,v=!1;const R=new IL({Yo:A=>{v?H(rn,`Not sending because RPC '${e}' stream ${s} is closed:`,A):(m||(H(rn,`Opening RPC '${e}' stream ${s} transport.`),f.open(),m=!0),H(rn,`RPC '${e}' stream ${s} sending:`,A),f.send(A))},Zo:()=>f.close()}),b=(A,I,w)=>{A.listen(I,y=>{try{w(y)}catch(j){setTimeout(()=>{throw j},0)}})};return b(f,ml.EventType.OPEN,()=>{v||(H(rn,`RPC '${e}' stream ${s} transport opened.`),R.o_())}),b(f,ml.EventType.CLOSE,()=>{v||(v=!0,H(rn,`RPC '${e}' stream ${s} transport closed`),R.a_(),this.E_(f))}),b(f,ml.EventType.ERROR,A=>{v||(v=!0,zi(rn,`RPC '${e}' stream ${s} transport errored. Name:`,A.name,"Message:",A.message),R.a_(new K($.UNAVAILABLE,"The operation could not be completed")))}),b(f,ml.EventType.MESSAGE,A=>{var I;if(!v){const w=A.data[0];ce(!!w,16349);const y=w,j=(y==null?void 0:y.error)||((I=y[0])==null?void 0:I.error);if(j){H(rn,`RPC '${e}' stream ${s} received error:`,j);const V=j.status;let M=function(S){const C=Rt[S];if(C!==void 0)return Wb(C)}(V),T=j.message;M===void 0&&(M=$.INTERNAL,T="Unknown error status: "+V+" with message "+j.message),v=!0,R.a_(new K(M,T)),f.close()}else H(rn,`RPC '${e}' stream ${s} received:`,w),R.u_(w)}}),b(a,WS.STAT_EVENT,A=>{A.stat===Om.PROXY?H(rn,`RPC '${e}' stream ${s} detected buffering proxy`):A.stat===Om.NOPROXY&&H(rn,`RPC '${e}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{R.__()},0),R}terminate(){this.c_.forEach(e=>e.close()),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter(n=>n===e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xL(){return typeof window<"u"?window:null}function id(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zh(t){return new xV(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xC{constructor(e,n,r=1e3,s=1.5,i=6e4){this.Mi=e,this.timerId=n,this.d_=r,this.A_=s,this.R_=i,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const n=Math.floor(this.V_+this.y_()),r=Math.max(0,Date.now()-this.f_),s=Math.max(0,n-r);s>0&&H("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.V_} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,s,()=>(this.f_=Date.now(),e())),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vI="PersistentStream";class SC{constructor(e,n,r,s,i,o,a,l){this.Mi=e,this.S_=r,this.b_=s,this.connection=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=l,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new xC(e,n)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,()=>this.k_()))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,n){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():n&&n.code===$.RESOURCE_EXHAUSTED?(pn(n.toString()),pn("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):n&&n.code===$.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(n)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),n=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,s])=>{this.D_===n&&this.G_(r,s)},r=>{e(()=>{const s=new K($.UNKNOWN,"Fetching auth token failed: "+r.message);return this.z_(s)})})}G_(e,n){const r=this.W_(this.D_);this.stream=this.j_(e,n),this.stream.Xo(()=>{r(()=>this.listener.Xo())}),this.stream.t_(()=>{r(()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.t_()))}),this.stream.r_(s=>{r(()=>this.z_(s))}),this.stream.onMessage(s=>{r(()=>++this.F_==1?this.J_(s):this.onNext(s))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return H(vI,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return n=>{this.Mi.enqueueAndForget(()=>this.D_===e?n():(H(vI,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class SL extends SC{constructor(e,n,r,s,i,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,s,o),this.serializer=i}j_(e,n){return this.connection.T_("Listen",e,n)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const n=CV(this.serializer,e),r=function(i){if(!("targetChange"in i))return fe.min();const o=i.targetChange;return o.targetIds&&o.targetIds.length?fe.min():o.readTime?yn(o.readTime):fe.min()}(e);return this.listener.H_(n,r)}Y_(e){const n={};n.database=Ym(this.serializer),n.addTarget=function(i,o){let a;const l=o.target;if(a=Wd(l)?{documents:eC(i,l)}:{query:By(i,l).ft},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=Qb(i,o.resumeToken);const d=Gm(i,o.expectedCount);d!==null&&(a.expectedCount=d)}else if(o.snapshotVersion.compareTo(fe.min())>0){a.readTime=Ea(i,o.snapshotVersion.toTimestamp());const d=Gm(i,o.expectedCount);d!==null&&(a.expectedCount=d)}return a}(this.serializer,e);const r=PV(this.serializer,e);r&&(n.labels=r),this.q_(n)}Z_(e){const n={};n.database=Ym(this.serializer),n.removeTarget=e,this.q_(n)}}class bL extends SC{constructor(e,n,r,s,i,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,s,o),this.serializer=i}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,n){return this.connection.T_("Write",e,n)}J_(e){return ce(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,ce(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){ce(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const n=AV(e.writeResults,e.commitTime),r=yn(e.commitTime);return this.listener.na(r,n)}ra(){const e={};e.database=Ym(this.serializer),this.q_(e)}ea(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>Yd(this.serializer,r))};this.q_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CL{}class AL extends CL{constructor(e,n,r,s){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=s,this.ia=!1}sa(){if(this.ia)throw new K($.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,n,r,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.connection.Go(e,Qm(n,r),s,i,o)).catch(i=>{throw i.name==="FirebaseError"?(i.code===$.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new K($.UNKNOWN,i.toString())})}Ho(e,n,r,s,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.Ho(e,Qm(n,r),s,o,a,i)).catch(o=>{throw o.name==="FirebaseError"?(o.code===$.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new K($.UNKNOWN,o.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}class RL{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(pn(n),this.aa=!1):H("OnlineStateTracker",n)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xi="RemoteStore";class PL{constructor(e,n,r,s,i){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=i,this.Aa.Oo(o=>{r.enqueueAndForget(async()=>{ao(this)&&(H(Xi,"Restarting streams for network reachability change."),await async function(l){const d=ve(l);d.Ea.add(4),await Lc(d),d.Ra.set("Unknown"),d.Ea.delete(4),await ef(d)}(this))})}),this.Ra=new RL(r,s)}}async function ef(t){if(ao(t))for(const e of t.da)await e(!0)}async function Lc(t){for(const e of t.da)await e(!1)}function bC(t,e){const n=ve(t);n.Ia.has(e.targetId)||(n.Ia.set(e.targetId,e),Zy(n)?Jy(n):Da(n).O_()&&Xy(n,e))}function Yy(t,e){const n=ve(t),r=Da(n);n.Ia.delete(e),r.O_()&&CC(n,e),n.Ia.size===0&&(r.O_()?r.L_():ao(n)&&n.Ra.set("Unknown"))}function Xy(t,e){if(t.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(fe.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}Da(t).Y_(e)}function CC(t,e){t.Va.Ue(e),Da(t).Z_(e)}function Jy(t){t.Va=new wV({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),At:e=>t.Ia.get(e)||null,ht:()=>t.datastore.serializer.databaseId}),Da(t).start(),t.Ra.ua()}function Zy(t){return ao(t)&&!Da(t).x_()&&t.Ia.size>0}function ao(t){return ve(t).Ea.size===0}function AC(t){t.Va=void 0}async function kL(t){t.Ra.set("Online")}async function NL(t){t.Ia.forEach((e,n)=>{Xy(t,e)})}async function DL(t,e){AC(t),Zy(t)?(t.Ra.ha(e),Jy(t)):t.Ra.set("Unknown")}async function jL(t,e,n){if(t.Ra.set("Online"),e instanceof Gb&&e.state===2&&e.cause)try{await async function(s,i){const o=i.cause;for(const a of i.targetIds)s.Ia.has(a)&&(await s.remoteSyncer.rejectListen(a,o),s.Ia.delete(a),s.Va.removeTarget(a))}(t,e)}catch(r){H(Xi,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await th(t,r)}else if(e instanceof rd?t.Va.Ze(e):e instanceof Kb?t.Va.st(e):t.Va.tt(e),!n.isEqual(fe.min()))try{const r=await IC(t.localStore);n.compareTo(r)>=0&&await function(i,o){const a=i.Va.Tt(o);return a.targetChanges.forEach((l,d)=>{if(l.resumeToken.approximateByteSize()>0){const h=i.Ia.get(d);h&&i.Ia.set(d,h.withResumeToken(l.resumeToken,o))}}),a.targetMismatches.forEach((l,d)=>{const h=i.Ia.get(l);if(!h)return;i.Ia.set(l,h.withResumeToken(Nt.EMPTY_BYTE_STRING,h.snapshotVersion)),CC(i,l);const f=new qr(h.target,l,d,h.sequenceNumber);Xy(i,f)}),i.remoteSyncer.applyRemoteEvent(a)}(t,n)}catch(r){H(Xi,"Failed to raise snapshot:",r),await th(t,r)}}async function th(t,e,n){if(!si(e))throw e;t.Ea.add(1),await Lc(t),t.Ra.set("Offline"),n||(n=()=>IC(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{H(Xi,"Retrying IndexedDB access"),await n(),t.Ea.delete(1),await ef(t)})}function RC(t,e){return e().catch(n=>th(t,n,e))}async function Mc(t){const e=ve(t),n=Ys(e);let r=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:Pi;for(;OL(e);)try{const s=await gL(e.localStore,r);if(s===null){e.Ta.length===0&&n.L_();break}r=s.batchId,VL(e,s)}catch(s){await th(e,s)}PC(e)&&kC(e)}function OL(t){return ao(t)&&t.Ta.length<10}function VL(t,e){t.Ta.push(e);const n=Ys(t);n.O_()&&n.X_&&n.ea(e.mutations)}function PC(t){return ao(t)&&!Ys(t).x_()&&t.Ta.length>0}function kC(t){Ys(t).start()}async function LL(t){Ys(t).ra()}async function ML(t){const e=Ys(t);for(const n of t.Ta)e.ea(n.mutations)}async function FL(t,e,n){const r=t.Ta.shift(),s=My.from(r,e,n);await RC(t,()=>t.remoteSyncer.applySuccessfulWrite(s)),await Mc(t)}async function UL(t,e){e&&Ys(t).X_&&await async function(r,s){if(function(o){return yV(o)&&o!==$.ABORTED}(s.code)){const i=r.Ta.shift();Ys(r).B_(),await RC(r,()=>r.remoteSyncer.rejectFailedWrite(i.batchId,s)),await Mc(r)}}(t,e),PC(t)&&kC(t)}async function wI(t,e){const n=ve(t);n.asyncQueue.verifyOperationInProgress(),H(Xi,"RemoteStore received new credentials");const r=ao(n);n.Ea.add(3),await Lc(n),r&&n.Ra.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.Ea.delete(3),await ef(n)}async function $L(t,e){const n=ve(t);e?(n.Ea.delete(2),await ef(n)):e||(n.Ea.add(2),await Lc(n),n.Ra.set("Unknown"))}function Da(t){return t.ma||(t.ma=function(n,r,s){const i=ve(n);return i.sa(),new SL(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Xo:kL.bind(null,t),t_:NL.bind(null,t),r_:DL.bind(null,t),H_:jL.bind(null,t)}),t.da.push(async e=>{e?(t.ma.B_(),Zy(t)?Jy(t):t.Ra.set("Unknown")):(await t.ma.stop(),AC(t))})),t.ma}function Ys(t){return t.fa||(t.fa=function(n,r,s){const i=ve(n);return i.sa(),new bL(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Xo:()=>Promise.resolve(),t_:LL.bind(null,t),r_:UL.bind(null,t),ta:ML.bind(null,t),na:FL.bind(null,t)}),t.da.push(async e=>{e?(t.fa.B_(),await Mc(t)):(await t.fa.stop(),t.Ta.length>0&&(H(Xi,`Stopping write stream with ${t.Ta.length} pending writes`),t.Ta=[]))})),t.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e_{constructor(e,n,r,s,i){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=s,this.removalCallback=i,this.deferred=new ur,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,s,i){const o=Date.now()+r,a=new e_(e,n,o,s,i);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new K($.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function t_(t,e){if(pn("AsyncQueue",`${e}: ${t}`),si(t))return new K($.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jo{static emptySet(e){return new Jo(e.comparator)}constructor(e){this.comparator=e?(n,r)=>e(n,r)||te.comparator(n.key,r.key):(n,r)=>te.comparator(n.key,r.key),this.keyedMap=gl(),this.sortedSet=new ht(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof Jo)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new Jo;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EI{constructor(){this.ga=new ht(te.comparator)}track(e){const n=e.doc.key,r=this.ga.get(n);r?e.type!==0&&r.type===3?this.ga=this.ga.insert(n,e):e.type===3&&r.type!==1?this.ga=this.ga.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.ga=this.ga.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.ga=this.ga.remove(n):e.type===1&&r.type===2?this.ga=this.ga.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):le(63341,{Rt:e,pa:r}):this.ga=this.ga.insert(n,e)}ya(){const e=[];return this.ga.inorderTraversal((n,r)=>{e.push(r)}),e}}class Ia{constructor(e,n,r,s,i,o,a,l,d){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=l,this.hasCachedResults=d}static fromInitialDocuments(e,n,r,s,i){const o=[];return n.forEach(a=>{o.push({type:0,doc:a})}),new Ia(e,n,Jo.emptySet(n),o,r,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&qh(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let s=0;s<n.length;s++)if(n[s].type!==r[s].type||!n[s].doc.isEqual(r[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BL{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some(e=>e.Da())}}class zL{constructor(){this.queries=II(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(n,r){const s=ve(n),i=s.queries;s.queries=II(),i.forEach((o,a)=>{for(const l of a.Sa)l.onError(r)})})(this,new K($.ABORTED,"Firestore shutting down"))}}function II(){return new ss(t=>Nb(t),qh)}async function n_(t,e){const n=ve(t);let r=3;const s=e.query;let i=n.queries.get(s);i?!i.ba()&&e.Da()&&(r=2):(i=new BL,r=e.Da()?0:1);try{switch(r){case 0:i.wa=await n.onListen(s,!0);break;case 1:i.wa=await n.onListen(s,!1);break;case 2:await n.onFirstRemoteStoreListen(s)}}catch(o){const a=t_(o,`Initialization of query '${bo(e.query)}' failed`);return void e.onError(a)}n.queries.set(s,i),i.Sa.push(e),e.va(n.onlineState),i.wa&&e.Fa(i.wa)&&s_(n)}async function r_(t,e){const n=ve(t),r=e.query;let s=3;const i=n.queries.get(r);if(i){const o=i.Sa.indexOf(e);o>=0&&(i.Sa.splice(o,1),i.Sa.length===0?s=e.Da()?0:1:!i.ba()&&e.Da()&&(s=2))}switch(s){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function qL(t,e){const n=ve(t);let r=!1;for(const s of e){const i=s.query,o=n.queries.get(i);if(o){for(const a of o.Sa)a.Fa(s)&&(r=!0);o.wa=s}}r&&s_(n)}function HL(t,e,n){const r=ve(t),s=r.queries.get(e);if(s)for(const i of s.Sa)i.onError(n);r.queries.delete(e)}function s_(t){t.Ca.forEach(e=>{e.next()})}var rg,TI;(TI=rg||(rg={})).Ma="default",TI.Cache="cache";class i_{constructor(e,n,r){this.query=e,this.xa=n,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=r||{}}Fa(e){if(!this.options.includeMetadataChanges){const r=[];for(const s of e.docChanges)s.type!==3&&r.push(s);e=new Ia(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),n=!0):this.La(e,this.onlineState)&&(this.ka(e),n=!0),this.Na=e,n}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let n=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),n=!0),n}La(e,n){if(!e.fromCache||!this.Da())return!0;const r=n!=="Offline";return(!this.options.qa||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const n=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}ka(e){e=Ia.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==rg.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NC{constructor(e){this.key=e}}class DC{constructor(e){this.key=e}}class WL{constructor(e,n){this.query=e,this.Ya=n,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=Pe(),this.mutatedKeys=Pe(),this.eu=Db(e),this.tu=new Jo(this.eu)}get nu(){return this.Ya}ru(e,n){const r=n?n.iu:new EI,s=n?n.tu:this.tu;let i=n?n.mutatedKeys:this.mutatedKeys,o=s,a=!1;const l=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,d=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((h,f)=>{const m=s.get(h),v=Oc(this.query,f)?f:null,R=!!m&&this.mutatedKeys.has(m.key),b=!!v&&(v.hasLocalMutations||this.mutatedKeys.has(v.key)&&v.hasCommittedMutations);let A=!1;m&&v?m.data.isEqual(v.data)?R!==b&&(r.track({type:3,doc:v}),A=!0):this.su(m,v)||(r.track({type:2,doc:v}),A=!0,(l&&this.eu(v,l)>0||d&&this.eu(v,d)<0)&&(a=!0)):!m&&v?(r.track({type:0,doc:v}),A=!0):m&&!v&&(r.track({type:1,doc:m}),A=!0,(l||d)&&(a=!0)),A&&(v?(o=o.add(v),i=b?i.add(h):i.delete(h)):(o=o.delete(h),i=i.delete(h)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const h=this.query.limitType==="F"?o.last():o.first();o=o.delete(h.key),i=i.delete(h.key),r.track({type:1,doc:h})}return{tu:o,iu:r,Cs:a,mutatedKeys:i}}su(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,s){const i=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const o=e.iu.ya();o.sort((h,f)=>function(v,R){const b=A=>{switch(A){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return le(20277,{Rt:A})}};return b(v)-b(R)}(h.type,f.type)||this.eu(h.doc,f.doc)),this.ou(r),s=s??!1;const a=n&&!s?this._u():[],l=this.Xa.size===0&&this.current&&!s?1:0,d=l!==this.Za;return this.Za=l,o.length!==0||d?{snapshot:new Ia(this.query,e.tu,i,o,e.mutatedKeys,l===0,d,!1,!!r&&r.resumeToken.approximateByteSize()>0),au:a}:{au:a}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new EI,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(n=>this.Ya=this.Ya.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Ya=this.Ya.delete(n)),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=Pe(),this.tu.forEach(r=>{this.uu(r.key)&&(this.Xa=this.Xa.add(r.key))});const n=[];return e.forEach(r=>{this.Xa.has(r)||n.push(new DC(r))}),this.Xa.forEach(r=>{e.has(r)||n.push(new NC(r))}),n}cu(e){this.Ya=e.Qs,this.Xa=Pe();const n=this.ru(e.documents);return this.applyChanges(n,!0)}lu(){return Ia.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const o_="SyncEngine";class KL{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class GL{constructor(e){this.key=e,this.hu=!1}}class QL{constructor(e,n,r,s,i,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.Pu={},this.Tu=new ss(a=>Nb(a),qh),this.Iu=new Map,this.Eu=new Set,this.du=new ht(te.comparator),this.Au=new Map,this.Ru=new Hy,this.Vu={},this.mu=new Map,this.fu=Yi.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function YL(t,e,n=!0){const r=FC(t);let s;const i=r.Tu.get(e);return i?(r.sharedClientState.addLocalQueryTarget(i.targetId),s=i.view.lu()):s=await jC(r,e,n,!0),s}async function XL(t,e){const n=FC(t);await jC(n,e,!0,!1)}async function jC(t,e,n,r){const s=await yL(t.localStore,Qn(e)),i=s.targetId,o=t.sharedClientState.addLocalQueryTarget(i,n);let a;return r&&(a=await JL(t,e,i,o==="current",s.resumeToken)),t.isPrimaryClient&&n&&bC(t.remoteStore,s),a}async function JL(t,e,n,r,s){t.pu=(f,m,v)=>async function(b,A,I,w){let y=A.view.ru(I);y.Cs&&(y=await mI(b.localStore,A.query,!1).then(({documents:T})=>A.view.ru(T,y)));const j=w&&w.targetChanges.get(A.targetId),V=w&&w.targetMismatches.get(A.targetId)!=null,M=A.view.applyChanges(y,b.isPrimaryClient,j,V);return SI(b,A.targetId,M.au),M.snapshot}(t,f,m,v);const i=await mI(t.localStore,e,!0),o=new WL(e,i.Qs),a=o.ru(i.documents),l=Vc.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",s),d=o.applyChanges(a,t.isPrimaryClient,l);SI(t,n,d.au);const h=new KL(e,n,o);return t.Tu.set(e,h),t.Iu.has(n)?t.Iu.get(n).push(e):t.Iu.set(n,[e]),d.snapshot}async function ZL(t,e,n){const r=ve(t),s=r.Tu.get(e),i=r.Iu.get(s.targetId);if(i.length>1)return r.Iu.set(s.targetId,i.filter(o=>!qh(o,e))),void r.Tu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(s.targetId),r.sharedClientState.isActiveQueryTarget(s.targetId)||await tg(r.localStore,s.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(s.targetId),n&&Yy(r.remoteStore,s.targetId),sg(r,s.targetId)}).catch(oo)):(sg(r,s.targetId),await tg(r.localStore,s.targetId,!0))}async function eM(t,e){const n=ve(t),r=n.Tu.get(e),s=n.Iu.get(r.targetId);n.isPrimaryClient&&s.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),Yy(n.remoteStore,r.targetId))}async function tM(t,e,n){const r=UC(t);try{const s=await function(o,a){const l=ve(o),d=Be.now(),h=a.reduce((v,R)=>v.add(R.key),Pe());let f,m;return l.persistence.runTransaction("Locally write mutations","readwrite",v=>{let R=jn(),b=Pe();return l.Ns.getEntries(v,h).next(A=>{R=A,R.forEach((I,w)=>{w.isValidDocument()||(b=b.add(I))})}).next(()=>l.localDocuments.getOverlayedDocuments(v,R)).next(A=>{f=A;const I=[];for(const w of a){const y=pV(w,f.get(w.key).overlayedDocument);y!=null&&I.push(new is(w.key,y,Tb(y.value.mapValue),ln.exists(!0)))}return l.mutationQueue.addMutationBatch(v,d,I,a)}).next(A=>{m=A;const I=A.applyToLocalDocumentSet(f,b);return l.documentOverlayCache.saveOverlays(v,A.batchId,I)})}).then(()=>({batchId:m.batchId,changes:Ob(f)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(s.batchId),function(o,a,l){let d=o.Vu[o.currentUser.toKey()];d||(d=new ht(Te)),d=d.insert(a,l),o.Vu[o.currentUser.toKey()]=d}(r,s.batchId,n),await Fc(r,s.changes),await Mc(r.remoteStore)}catch(s){const i=t_(s,"Failed to persist write");n.reject(i)}}async function OC(t,e){const n=ve(t);try{const r=await pL(n.localStore,e);e.targetChanges.forEach((s,i)=>{const o=n.Au.get(i);o&&(ce(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1,22616),s.addedDocuments.size>0?o.hu=!0:s.modifiedDocuments.size>0?ce(o.hu,14607):s.removedDocuments.size>0&&(ce(o.hu,42227),o.hu=!1))}),await Fc(n,r,e)}catch(r){await oo(r)}}function xI(t,e,n){const r=ve(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const s=[];r.Tu.forEach((i,o)=>{const a=o.view.va(e);a.snapshot&&s.push(a.snapshot)}),function(o,a){const l=ve(o);l.onlineState=a;let d=!1;l.queries.forEach((h,f)=>{for(const m of f.Sa)m.va(a)&&(d=!0)}),d&&s_(l)}(r.eventManager,e),s.length&&r.Pu.H_(s),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function nM(t,e,n){const r=ve(t);r.sharedClientState.updateQueryState(e,"rejected",n);const s=r.Au.get(e),i=s&&s.key;if(i){let o=new ht(te.comparator);o=o.insert(i,Et.newNoDocument(i,fe.min()));const a=Pe().add(i),l=new Qh(fe.min(),new Map,new ht(Te),o,a);await OC(r,l),r.du=r.du.remove(i),r.Au.delete(e),a_(r)}else await tg(r.localStore,e,!1).then(()=>sg(r,e,n)).catch(oo)}async function rM(t,e){const n=ve(t),r=e.batch.batchId;try{const s=await fL(n.localStore,e);LC(n,r,null),VC(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await Fc(n,s)}catch(s){await oo(s)}}async function sM(t,e,n){const r=ve(t);try{const s=await function(o,a){const l=ve(o);return l.persistence.runTransaction("Reject batch","readwrite-primary",d=>{let h;return l.mutationQueue.lookupMutationBatch(d,a).next(f=>(ce(f!==null,37113),h=f.keys(),l.mutationQueue.removeMutationBatch(d,f))).next(()=>l.mutationQueue.performConsistencyCheck(d)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(d,h,a)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(d,h)).next(()=>l.localDocuments.getDocuments(d,h))})}(r.localStore,e);LC(r,e,n),VC(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await Fc(r,s)}catch(s){await oo(s)}}function VC(t,e){(t.mu.get(e)||[]).forEach(n=>{n.resolve()}),t.mu.delete(e)}function LC(t,e,n){const r=ve(t);let s=r.Vu[r.currentUser.toKey()];if(s){const i=s.get(e);i&&(n?i.reject(n):i.resolve(),s=s.remove(e)),r.Vu[r.currentUser.toKey()]=s}}function sg(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Iu.get(e))t.Tu.delete(r),n&&t.Pu.yu(r,n);t.Iu.delete(e),t.isPrimaryClient&&t.Ru.jr(e).forEach(r=>{t.Ru.containsKey(r)||MC(t,r)})}function MC(t,e){t.Eu.delete(e.path.canonicalString());const n=t.du.get(e);n!==null&&(Yy(t.remoteStore,n),t.du=t.du.remove(e),t.Au.delete(n),a_(t))}function SI(t,e,n){for(const r of n)r instanceof NC?(t.Ru.addReference(r.key,e),iM(t,r)):r instanceof DC?(H(o_,"Document no longer in limbo: "+r.key),t.Ru.removeReference(r.key,e),t.Ru.containsKey(r.key)||MC(t,r.key)):le(19791,{wu:r})}function iM(t,e){const n=e.key,r=n.path.canonicalString();t.du.get(n)||t.Eu.has(r)||(H(o_,"New document in limbo: "+n),t.Eu.add(r),a_(t))}function a_(t){for(;t.Eu.size>0&&t.du.size<t.maxConcurrentLimboResolutions;){const e=t.Eu.values().next().value;t.Eu.delete(e);const n=new te(We.fromString(e)),r=t.fu.next();t.Au.set(r,new GL(n)),t.du=t.du.insert(n,r),bC(t.remoteStore,new qr(Qn(jc(n.path)),r,"TargetPurposeLimboResolution",Kn.ce))}}async function Fc(t,e,n){const r=ve(t),s=[],i=[],o=[];r.Tu.isEmpty()||(r.Tu.forEach((a,l)=>{o.push(r.pu(l,e,n).then(d=>{var h;if((d||n)&&r.isPrimaryClient){const f=d?!d.fromCache:(h=n==null?void 0:n.targetChanges.get(l.targetId))==null?void 0:h.current;r.sharedClientState.updateQueryState(l.targetId,f?"current":"not-current")}if(d){s.push(d);const f=Gy.As(l.targetId,d);i.push(f)}}))}),await Promise.all(o),r.Pu.H_(s),await async function(l,d){const h=ve(l);try{await h.persistence.runTransaction("notifyLocalViewChanges","readwrite",f=>O.forEach(d,m=>O.forEach(m.Es,v=>h.persistence.referenceDelegate.addReference(f,m.targetId,v)).next(()=>O.forEach(m.ds,v=>h.persistence.referenceDelegate.removeReference(f,m.targetId,v)))))}catch(f){if(!si(f))throw f;H(Qy,"Failed to update sequence numbers: "+f)}for(const f of d){const m=f.targetId;if(!f.fromCache){const v=h.Ms.get(m),R=v.snapshotVersion,b=v.withLastLimboFreeSnapshotVersion(R);h.Ms=h.Ms.insert(m,b)}}}(r.localStore,i))}async function oM(t,e){const n=ve(t);if(!n.currentUser.isEqual(e)){H(o_,"User change. New user:",e.toKey());const r=await EC(n.localStore,e);n.currentUser=e,function(i,o){i.mu.forEach(a=>{a.forEach(l=>{l.reject(new K($.CANCELLED,o))})}),i.mu.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await Fc(n,r.Ls)}}function aM(t,e){const n=ve(t),r=n.Au.get(e);if(r&&r.hu)return Pe().add(r.key);{let s=Pe();const i=n.Iu.get(e);if(!i)return s;for(const o of i){const a=n.Tu.get(o);s=s.unionWith(a.view.nu)}return s}}function FC(t){const e=ve(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=OC.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=aM.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=nM.bind(null,e),e.Pu.H_=qL.bind(null,e.eventManager),e.Pu.yu=HL.bind(null,e.eventManager),e}function UC(t){const e=ve(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=rM.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=sM.bind(null,e),e}class _c{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Zh(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,n){return null}Mu(e,n){return null}vu(e){return wC(this.persistence,new vC,e.initialUser,this.serializer)}Cu(e){return new Wy(Jh.mi,this.serializer)}Du(e){return new TC}async terminate(){var e,n;(e=this.gcScheduler)==null||e.stop(),(n=this.indexBackfillerScheduler)==null||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}_c.provider={build:()=>new _c};class lM extends _c{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,n){ce(this.persistence.referenceDelegate instanceof eh,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new pC(r,e.asyncQueue,n)}Cu(e){const n=this.cacheSizeBytes!==void 0?sn.withCacheSize(this.cacheSizeBytes):sn.DEFAULT;return new Wy(r=>eh.mi(r,n),this.serializer)}}class cM extends _c{constructor(e,n,r){super(),this.xu=e,this.cacheSizeBytes=n,this.forceOwnership=r,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.xu.initialize(this,e),await UC(this.xu.syncEngine),await Mc(this.xu.remoteStore),await this.persistence.Ji(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}vu(e){return wC(this.persistence,new vC,e.initialUser,this.serializer)}Fu(e,n){const r=this.persistence.referenceDelegate.garbageCollector;return new pC(r,e.asyncQueue,n)}Mu(e,n){const r=new fO(n,this.persistence);return new hO(e.asyncQueue,r)}Cu(e){const n=cL(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?sn.withCacheSize(this.cacheSizeBytes):sn.DEFAULT;return new Ky(this.synchronizeTabs,n,e.clientId,r,e.asyncQueue,xL(),id(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Du(e){return new TC}}class nh{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>xI(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=oM.bind(null,this.syncEngine),await $L(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new zL}()}createDatastore(e){const n=Zh(e.databaseInfo.databaseId),r=function(i){return new TL(i)}(e.databaseInfo);return function(i,o,a,l){return new AL(i,o,a,l)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,s,i,o,a){return new PL(r,s,i,o,a)}(this.localStore,this.datastore,e.asyncQueue,n=>xI(this.syncEngine,n,0),function(){return _I.v()?new _I:new vL}())}createSyncEngine(e,n){return function(s,i,o,a,l,d,h){const f=new QL(s,i,o,a,l,d);return h&&(f.gu=!0),f}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(s){const i=ve(s);H(Xi,"RemoteStore shutting down."),i.Ea.add(5),await Lc(i),i.Aa.shutdown(),i.Ra.set("Unknown")}(this.remoteStore),(e=this.datastore)==null||e.terminate(),(n=this.eventManager)==null||n.terminate()}}nh.provider={build:()=>new nh};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l_{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):pn("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xs="FirestoreClient";class uM{constructor(e,n,r,s,i){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=s,this.user=Wt.UNAUTHENTICATED,this.clientId=Sy.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(r,async o=>{H(Xs,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>(H(Xs,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new ur;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=t_(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function _p(t,e){t.asyncQueue.verifyOperationInProgress(),H(Xs,"Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async s=>{r.isEqual(s)||(await EC(e.localStore,s),r=s)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function bI(t,e){t.asyncQueue.verifyOperationInProgress();const n=await dM(t);H(Xs,"Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>wI(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,s)=>wI(e.remoteStore,s)),t._onlineComponents=e}async function dM(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){H(Xs,"Using user provided OfflineComponentProvider");try{await _p(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(s){return s.name==="FirebaseError"?s.code===$.FAILED_PRECONDITION||s.code===$.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(n))throw n;zi("Error using user provided cache. Falling back to memory cache: "+n),await _p(t,new _c)}}else H(Xs,"Using default OfflineComponentProvider"),await _p(t,new lM(void 0));return t._offlineComponents}async function c_(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(H(Xs,"Using user provided OnlineComponentProvider"),await bI(t,t._uninitializedComponentsProvider._online)):(H(Xs,"Using default OnlineComponentProvider"),await bI(t,new nh))),t._onlineComponents}function hM(t){return c_(t).then(e=>e.syncEngine)}function fM(t){return c_(t).then(e=>e.datastore)}async function rh(t){const e=await c_(t),n=e.eventManager;return n.onListen=YL.bind(null,e.syncEngine),n.onUnlisten=ZL.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=XL.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=eM.bind(null,e.syncEngine),n}function pM(t,e,n={}){const r=new ur;return t.asyncQueue.enqueueAndForget(async()=>function(i,o,a,l,d){const h=new l_({next:m=>{h.Nu(),o.enqueueAndForget(()=>r_(i,f));const v=m.docs.has(a);!v&&m.fromCache?d.reject(new K($.UNAVAILABLE,"Failed to get document because the client is offline.")):v&&m.fromCache&&l&&l.source==="server"?d.reject(new K($.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):d.resolve(m)},error:m=>d.reject(m)}),f=new i_(jc(a.path),h,{includeMetadataChanges:!0,qa:!0});return n_(i,f)}(await rh(t),t.asyncQueue,e,n,r)),r.promise}function mM(t,e,n={}){const r=new ur;return t.asyncQueue.enqueueAndForget(async()=>function(i,o,a,l,d){const h=new l_({next:m=>{h.Nu(),o.enqueueAndForget(()=>r_(i,f)),m.fromCache&&l.source==="server"?d.reject(new K($.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):d.resolve(m)},error:m=>d.reject(m)}),f=new i_(a,h,{includeMetadataChanges:!0,qa:!0});return n_(i,f)}(await rh(t),t.asyncQueue,e,n,r)),r.promise}function gM(t,e,n){const r=new ur;return t.asyncQueue.enqueueAndForget(async()=>{try{const s=await fM(t);r.resolve(async function(o,a,l){var b;const d=ve(o),{request:h,gt:f,parent:m}=RV(d.serializer,tV(a),l);d.connection.$o||delete h.parent;const v=(await d.Ho("RunAggregationQuery",d.serializer.databaseId,m,h,1)).filter(A=>!!A.result);ce(v.length===1,64727);const R=(b=v[0].result)==null?void 0:b.aggregateFields;return Object.keys(R).reduce((A,I)=>(A[f[I]]=R[I],A),{})}(s,e,n))}catch(s){r.reject(s)}}),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $C(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CI=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BC="firestore.googleapis.com",AI=!0;class RI{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new K($.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=BC,this.ssl=AI}else this.host=e.host,this.ssl=e.ssl??AI;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=uC;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<WV)throw new K($.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}aO("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=$C(e.experimentalLongPollingOptions??{}),function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new K($.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new K($.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new K($.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,s){return r.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class tf{constructor(e,n,r,s){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new RI({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new K($.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new K($.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new RI(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new X2;switch(r.type){case"firstParty":return new tO(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new K($.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=CI.get(n);r&&(H("ComponentProvider","Removing Datastore"),CI.delete(n),r.terminate())}(this),Promise.resolve()}}function yM(t,e,n,r={}){var d;t=cn(t,tf);const s=ti(e),i=t._getSettings(),o={...i,emulatorOptions:t._getEmulatorOptions()},a=`${e}:${n}`;s&&(uy(`https://${a}`),dy("Firestore",!0)),i.host!==BC&&i.host!==a&&zi("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const l={...i,host:a,ssl:s,emulatorOptions:r};if(!Jr(l,o)&&(t._setSettings(l),r.mockUserToken)){let h,f;if(typeof r.mockUserToken=="string")h=r.mockUserToken,f=Wt.MOCK_USER;else{h=Xx(r.mockUserToken,(d=t._app)==null?void 0:d.options.projectId);const m=r.mockUserToken.sub||r.mockUserToken.user_id;if(!m)throw new K($.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");f=new Wt(m)}t._authCredentials=new J2(new YS(h,f))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gr{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new gr(this.firestore,e,this._query)}}class It{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new qs(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new It(this.firestore,e,this._key)}toJSON(){return{type:It._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,n,r){if(kc(n,It._jsonSchema))return new It(e,r||null,new te(We.fromString(n.referencePath)))}}It._jsonSchemaVersion="firestore/documentReference/1.0",It._jsonSchema={type:kt("string",It._jsonSchemaVersion),referencePath:kt("string")};class qs extends gr{constructor(e,n,r){super(e,n,jc(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new It(this.firestore,null,new te(e))}withConverter(e){return new qs(this.firestore,e,this._path)}}function $e(t,e,...n){if(t=Qe(t),JS("collection","path",e),t instanceof tf){const r=We.fromString(e,...n);return vE(r),new qs(t,null,r)}{if(!(t instanceof It||t instanceof qs))throw new K($.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(We.fromString(e,...n));return vE(r),new qs(t.firestore,null,r)}}function Qt(t,e,...n){if(t=Qe(t),arguments.length===1&&(e=Sy.newId()),JS("doc","path",e),t instanceof tf){const r=We.fromString(e,...n);return _E(r),new It(t,null,new te(r))}{if(!(t instanceof It||t instanceof qs))throw new K($.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(We.fromString(e,...n));return _E(r),new It(t.firestore,t instanceof qs?t.converter:null,new te(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PI="AsyncQueue";class kI{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new xC(this,"async_queue_retry"),this._c=()=>{const r=id();r&&H(PI,"Visibility state changed to "+r.visibilityState),this.M_.w_()},this.ac=e;const n=id();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const n=id();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});const n=new ur;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Xu.push(e),this.lc()))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!si(e))throw e;H(PI,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){const n=this.ac.then(()=>(this.rc=!0,e().catch(r=>{throw this.nc=r,this.rc=!1,pn("INTERNAL UNHANDLED ERROR: ",NI(r)),r}).then(r=>(this.rc=!1,r))));return this.ac=n,n}enqueueAfterDelay(e,n,r){this.uc(),this.oc.indexOf(e)>-1&&(n=0);const s=e_.createAndSchedule(this,e,n,r,i=>this.hc(i));return this.tc.push(s),s}uc(){this.nc&&le(47125,{Pc:NI(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const n of this.tc)if(n.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.tc)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.Tc()})}dc(e){this.oc.push(e)}hc(e){const n=this.tc.indexOf(e);this.tc.splice(n,1)}}function NI(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DI(t){return function(n,r){if(typeof n!="object"||n===null)return!1;const s=n;for(const i of r)if(i in s&&typeof s[i]=="function")return!0;return!1}(t,["next","error","complete"])}class pr extends tf{constructor(e,n,r,s){super(e,n,r,s),this.type="firestore",this._queue=new kI,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new kI(e),this._firestoreClient=void 0,await e}}}function zC(t,e){const n=typeof t=="object"?t:Ph(),r=typeof t=="string"?t:Hd,s=ni(n,"firestore").getImmediate({identifier:r});if(!s._initialized){const i=Gx("firestore");i&&yM(s,...i)}return s}function Uc(t){if(t._terminated)throw new K($.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||qC(t),t._firestoreClient}function qC(t){var r,s,i;const e=t._freezeSettings(),n=function(a,l,d,h){return new zO(a,l,d,h.host,h.ssl,h.experimentalForceLongPolling,h.experimentalAutoDetectLongPolling,$C(h.experimentalLongPollingOptions),h.useFetchStreams,h.isUsingEmulator)}(t._databaseId,((r=t._app)==null?void 0:r.options.appId)||"",t._persistenceKey,e);t._componentsProvider||(s=e.localCache)!=null&&s._offlineComponentProvider&&((i=e.localCache)!=null&&i._onlineComponentProvider)&&(t._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),t._firestoreClient=new uM(t._authCredentials,t._appCheckCredentials,t._queue,n,t._componentsProvider&&function(a){const l=a==null?void 0:a._online.build();return{_offline:a==null?void 0:a._offline.build(l),_online:l}}(t._componentsProvider))}function _M(t,e){zi("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const n=t._freezeSettings();return vM(t,nh.provider,{build:r=>new cM(r,n.cacheSizeBytes,e==null?void 0:e.forceOwnership)}),Promise.resolve()}function vM(t,e,n){if((t=cn(t,pr))._firestoreClient||t._terminated)throw new K($.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(t._componentsProvider||t._getSettings().localCache)throw new K($.FAILED_PRECONDITION,"SDK cache is already specified.");t._componentsProvider={_online:e,_offline:n},qC(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wM{constructor(e="count",n){this._internalFieldPath=n,this.type="AggregateField",this.aggregateType=e}}class EM{constructor(e,n,r){this._userDataWriter=n,this._data=r,this.type="AggregateQuerySnapshot",this.query=e}data(){return this._userDataWriter.convertObjectMap(this._data)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hn{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Hn(Nt.fromBase64String(e))}catch(n){throw new K($.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new Hn(Nt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Hn._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(kc(e,Hn._jsonSchema))return Hn.fromBase64String(e.bytes)}}Hn._jsonSchemaVersion="firestore/bytes/1.0",Hn._jsonSchema={type:kt("string",Hn._jsonSchemaVersion),bytes:kt("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nf{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new K($.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new mt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ja{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dr{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new K($.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new K($.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return Te(this._lat,e._lat)||Te(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Dr._jsonSchemaVersion}}static fromJSON(e){if(kc(e,Dr._jsonSchema))return new Dr(e.latitude,e.longitude)}}Dr._jsonSchemaVersion="firestore/geoPoint/1.0",Dr._jsonSchema={type:kt("string",Dr._jsonSchemaVersion),latitude:kt("number"),longitude:kt("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jr{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,s){if(r.length!==s.length)return!1;for(let i=0;i<r.length;++i)if(r[i]!==s[i])return!1;return!0}(this._values,e._values)}toJSON(){return{type:jr._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(kc(e,jr._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(n=>typeof n=="number"))return new jr(e.vectorValues);throw new K($.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}jr._jsonSchemaVersion="firestore/vectorValue/1.0",jr._jsonSchema={type:kt("string",jr._jsonSchemaVersion),vectorValues:kt("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IM=/^__.*__$/;class TM{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new is(e,this.data,this.fieldMask,n,this.fieldTransforms):new Na(e,this.data,n,this.fieldTransforms)}}class HC{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new is(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function WC(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw le(40011,{Ac:t})}}class rf{constructor(e,n,r,s,i,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=s,i===void 0&&this.Rc(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new rf({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){var s;const n=(s=this.path)==null?void 0:s.child(e),r=this.Vc({path:n,fc:!1});return r.gc(e),r}yc(e){var s;const n=(s=this.path)==null?void 0:s.child(e),r=this.Vc({path:n,fc:!1});return r.Rc(),r}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return sh(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(WC(this.Ac)&&IM.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class xM{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||Zh(e)}Cc(e,n,r,s=!1){return new rf({Ac:e,methodName:n,Dc:r,path:mt.emptyPath(),fc:!1,bc:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function $c(t){const e=t._freezeSettings(),n=Zh(t._databaseId);return new xM(t._databaseId,!!e.ignoreUndefinedProperties,n)}function KC(t,e,n,r,s,i={}){const o=t.Cc(i.merge||i.mergeFields?2:0,e,n,s);f_("Data must be an object, but it was:",o,r);const a=QC(r,o);let l,d;if(i.merge)l=new Sn(o.fieldMask),d=o.fieldTransforms;else if(i.mergeFields){const h=[];for(const f of i.mergeFields){const m=ig(e,f,n);if(!o.contains(m))throw new K($.INVALID_ARGUMENT,`Field '${m}' is specified in your field mask but missing from your input data.`);XC(h,m)||h.push(m)}l=new Sn(h),d=o.fieldTransforms.filter(f=>l.covers(f.field))}else l=null,d=o.fieldTransforms;return new TM(new an(a),l,d)}class sf extends ja{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof sf}}function SM(t,e,n){return new rf({Ac:3,Dc:e.settings.Dc,methodName:t._methodName,fc:n},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class u_ extends ja{_toFieldTransform(e){return new Wh(e.path,new _a)}isEqual(e){return e instanceof u_}}class d_ extends ja{constructor(e,n){super(e),this.vc=n}_toFieldTransform(e){const n=SM(this,e,!0),r=this.vc.map(i=>Oa(i,n)),s=new Ki(r);return new Wh(e.path,s)}isEqual(e){return e instanceof d_&&Jr(this.vc,e.vc)}}class h_ extends ja{constructor(e,n){super(e),this.Fc=n}_toFieldTransform(e){const n=new wa(e.serializer,Mb(e.serializer,this.Fc));return new Wh(e.path,n)}isEqual(e){return e instanceof h_&&this.Fc===e.Fc}}function bM(t,e,n,r){const s=t.Cc(1,e,n);f_("Data must be an object, but it was:",s,r);const i=[],o=an.empty();ii(r,(l,d)=>{const h=p_(e,l,n);d=Qe(d);const f=s.yc(h);if(d instanceof sf)i.push(h);else{const m=Oa(d,f);m!=null&&(i.push(h),o.set(h,m))}});const a=new Sn(i);return new HC(o,a,s.fieldTransforms)}function CM(t,e,n,r,s,i){const o=t.Cc(1,e,n),a=[ig(e,r,n)],l=[s];if(i.length%2!=0)throw new K($.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let m=0;m<i.length;m+=2)a.push(ig(e,i[m])),l.push(i[m+1]);const d=[],h=an.empty();for(let m=a.length-1;m>=0;--m)if(!XC(d,a[m])){const v=a[m];let R=l[m];R=Qe(R);const b=o.yc(v);if(R instanceof sf)d.push(v);else{const A=Oa(R,b);A!=null&&(d.push(v),h.set(v,A))}}const f=new Sn(d);return new HC(h,f,o.fieldTransforms)}function GC(t,e,n,r=!1){return Oa(n,t.Cc(r?4:3,e))}function Oa(t,e){if(YC(t=Qe(t)))return f_("Unsupported field value:",e,t),QC(t,e);if(t instanceof ja)return function(r,s){if(!WC(s.Ac))throw s.Sc(`${r._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Sc(`${r._methodName}() is not currently supported inside arrays`);const i=r._toFieldTransform(s);i&&s.fieldTransforms.push(i)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return function(r,s){const i=[];let o=0;for(const a of r){let l=Oa(a,s.wc(o));l==null&&(l={nullValue:"NULL_VALUE"}),i.push(l),o++}return{arrayValue:{values:i}}}(t,e)}return function(r,s){if((r=Qe(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return Mb(s.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const i=Be.fromDate(r);return{timestampValue:Ea(s.serializer,i)}}if(r instanceof Be){const i=new Be(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Ea(s.serializer,i)}}if(r instanceof Dr)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Hn)return{bytesValue:Qb(s.serializer,r._byteString)};if(r instanceof It){const i=s.databaseId,o=r.firestore._databaseId;if(!o.isEqual(i))throw s.Sc(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:$y(r.firestore._databaseId||s.databaseId,r._key.path)}}if(r instanceof jr)return function(o,a){return{mapValue:{fields:{[Ny]:{stringValue:Dy},[ma]:{arrayValue:{values:o.toArray().map(d=>{if(typeof d!="number")throw a.Sc("VectorValues must only contain numeric values.");return Vy(a.serializer,d)})}}}}}}(r,s);throw s.Sc(`Unsupported field value: ${Oh(r)}`)}(t,e)}function QC(t,e){const n={};return pb(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):ii(t,(r,s)=>{const i=Oa(s,e.mc(r));i!=null&&(n[r]=i)}),{mapValue:{fields:n}}}function YC(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof Be||t instanceof Dr||t instanceof Hn||t instanceof It||t instanceof ja||t instanceof jr)}function f_(t,e,n){if(!YC(n)||!ZS(n)){const r=Oh(n);throw r==="an object"?e.Sc(t+" a custom object"):e.Sc(t+" "+r)}}function ig(t,e,n){if((e=Qe(e))instanceof nf)return e._internalPath;if(typeof e=="string")return p_(t,e);throw sh("Field path arguments must be of type string or ",t,!1,void 0,n)}const AM=new RegExp("[~\\*/\\[\\]]");function p_(t,e,n){if(e.search(AM)>=0)throw sh(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new nf(...e.split("."))._internalPath}catch{throw sh(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function sh(t,e,n,r,s){const i=r&&!r.isEmpty(),o=s!==void 0;let a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let l="";return(i||o)&&(l+=" (found",i&&(l+=` in field ${r}`),o&&(l+=` in document ${s}`),l+=")"),new K($.INVALID_ARGUMENT,a+t+l)}function XC(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class m_{constructor(e,n,r,s,i){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new It(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new RM(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(of("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class RM extends m_{data(){return super.data()}}function of(t,e){return typeof e=="string"?p_(t,e):e instanceof nf?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function JC(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new K($.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class g_{}class Bc extends g_{}function rt(t,e,...n){let r=[];e instanceof g_&&r.push(e),r=r.concat(n),function(i){const o=i.filter(l=>l instanceof y_).length,a=i.filter(l=>l instanceof af).length;if(o>1||o>0&&a>0)throw new K($.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const s of r)t=s._apply(t);return t}class af extends Bc{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new af(e,n,r)}_apply(e){const n=this._parse(e);return eA(e._query,n),new gr(e.firestore,e.converter,Km(e._query,n))}_parse(e){const n=$c(e.firestore);return function(i,o,a,l,d,h,f){let m;if(d.isKeyField()){if(h==="array-contains"||h==="array-contains-any")throw new K($.INVALID_ARGUMENT,`Invalid Query. You can't perform '${h}' queries on documentId().`);if(h==="in"||h==="not-in"){LI(f,h);const R=[];for(const b of f)R.push(VI(l,i,b));m={arrayValue:{values:R}}}else m=VI(l,i,f)}else h!=="in"&&h!=="not-in"&&h!=="array-contains-any"||LI(f,h),m=GC(a,o,f,h==="in"||h==="not-in");return Me.create(d,h,m)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function Je(t,e,n){const r=e,s=of("where",t);return af._create(s,r,n)}class y_ extends g_{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new y_(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:Ze.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(s,i){let o=s;const a=i.getFlattenedFilters();for(const l of a)eA(o,l),o=Km(o,l)}(e._query,n),new gr(e.firestore,e.converter,Km(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class __ extends Bc{constructor(e,n){super(),this._field=e,this._direction=n,this.type="orderBy"}static _create(e,n){return new __(e,n)}_apply(e){const n=function(s,i,o){if(s.startAt!==null)throw new K($.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(s.endAt!==null)throw new K($.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new yc(i,o)}(e._query,this._field,this._direction);return new gr(e.firestore,e.converter,function(s,i){const o=s.explicitOrderBy.concat([i]);return new oi(s.path,s.collectionGroup,o,s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt)}(e._query,n))}}function Yt(t,e="asc"){const n=e,r=of("orderBy",t);return __._create(r,n)}class v_ extends Bc{constructor(e,n,r){super(),this.type=e,this._limit=n,this._limitType=r}static _create(e,n,r){return new v_(e,n,r)}_apply(e){return new gr(e.firestore,e.converter,Gd(e._query,this._limit,this._limitType))}}function Zo(t){return lO("limit",t),v_._create("limit",t,"F")}class lf extends Bc{constructor(e,n,r){super(),this.type=e,this._docOrFields=n,this._inclusive=r}static _create(e,n,r){return new lf(e,n,r)}_apply(e){const n=ZC(e,this.type,this._docOrFields,this._inclusive);return new gr(e.firestore,e.converter,function(s,i){return new oi(s.path,s.collectionGroup,s.explicitOrderBy.slice(),s.filters.slice(),s.limit,s.limitType,i,s.endAt)}(e._query,n))}}function jI(...t){return lf._create("startAt",t,!0)}function PM(...t){return lf._create("startAfter",t,!1)}class w_ extends Bc{constructor(e,n,r){super(),this.type=e,this._docOrFields=n,this._inclusive=r}static _create(e,n,r){return new w_(e,n,r)}_apply(e){const n=ZC(e,this.type,this._docOrFields,this._inclusive);return new gr(e.firestore,e.converter,function(s,i){return new oi(s.path,s.collectionGroup,s.explicitOrderBy.slice(),s.filters.slice(),s.limit,s.limitType,s.startAt,i)}(e._query,n))}}function OI(...t){return w_._create("endAt",t,!0)}function ZC(t,e,n,r){if(n[0]=Qe(n[0]),n[0]instanceof m_)return function(i,o,a,l,d){if(!l)throw new K($.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${a}().`);const h=[];for(const f of Xo(i))if(f.field.isKeyField())h.push(Hi(o,l.key));else{const m=l.data.field(f.field);if($h(m))throw new K($.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+f.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(m===null){const v=f.field.canonicalString();throw new K($.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${v}' (used as the orderBy) does not exist.`)}h.push(m)}return new Qs(h,d)}(t._query,t.firestore._databaseId,e,n[0]._document,r);{const s=$c(t.firestore);return function(o,a,l,d,h,f){const m=o.explicitOrderBy;if(h.length>m.length)throw new K($.INVALID_ARGUMENT,`Too many arguments provided to ${d}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const v=[];for(let R=0;R<h.length;R++){const b=h[R];if(m[R].field.isKeyField()){if(typeof b!="string")throw new K($.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${d}(), but got a ${typeof b}`);if(!Oy(o)&&b.indexOf("/")!==-1)throw new K($.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${d}() must be a plain document ID, but '${b}' contains a slash.`);const A=o.path.child(We.fromString(b));if(!te.isDocumentKey(A))throw new K($.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${d}() must result in a valid document path, but '${A}' is not because it contains an odd number of segments.`);const I=new te(A);v.push(Hi(a,I))}else{const A=GC(l,d,b);v.push(A)}}return new Qs(v,f)}(t._query,t.firestore._databaseId,s,e,n,r)}}function VI(t,e,n){if(typeof(n=Qe(n))=="string"){if(n==="")throw new K($.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Oy(e)&&n.indexOf("/")!==-1)throw new K($.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(We.fromString(n));if(!te.isDocumentKey(r))throw new K($.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Hi(t,new te(r))}if(n instanceof It)return Hi(t,n._key);throw new K($.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Oh(n)}.`)}function LI(t,e){if(!Array.isArray(t)||t.length===0)throw new K($.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function eA(t,e){const n=function(s,i){for(const o of s)for(const a of o.getFlattenedFilters())if(i.indexOf(a.op)>=0)return a.op;return null}(t.filters,function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new K($.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new K($.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class kM{convertValue(e,n="none"){switch(Ks(e)){case 0:return null;case 1:return e.booleanValue;case 2:return ct(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(ns(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw le(62114,{value:e})}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return ii(e,(s,i)=>{r[s]=this.convertValue(i,n)}),r}convertVectorValue(e){var r,s,i;const n=(i=(s=(r=e.fields)==null?void 0:r[ma].arrayValue)==null?void 0:s.values)==null?void 0:i.map(o=>ct(o.doubleValue));return new jr(n)}convertGeoPoint(e){return new Dr(ct(e.latitude),ct(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=Bh(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(pc(e));default:return null}}convertTimestamp(e){const n=ts(e);return new Be(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=We.fromString(e);ce(sC(r),9688,{name:e});const s=new qi(r.get(1),r.get(3)),i=new te(r.popFirst(5));return s.isEqual(n)||pn(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tA(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}function NM(){return new wM("count")}class vl{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Di extends m_{constructor(e,n,r,s,i,o){super(e,n,r,s,o),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new od(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(of("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new K($.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,n={};return n.type=Di._jsonSchemaVersion,n.bundle="",n.bundleSource="DocumentSnapshot",n.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?n:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),n.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),n)}}Di._jsonSchemaVersion="firestore/documentSnapshot/1.0",Di._jsonSchema={type:kt("string",Di._jsonSchemaVersion),bundleSource:kt("string","DocumentSnapshot"),bundleName:kt("string"),bundle:kt("string")};class od extends Di{data(e={}){return super.data(e)}}class ji{constructor(e,n,r,s){this._firestore=e,this._userDataWriter=n,this._snapshot=s,this.metadata=new vl(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new od(this._firestore,this._userDataWriter,r.key,r,new vl(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new K($.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(s,i){if(s._snapshot.oldDocs.isEmpty()){let o=0;return s._snapshot.docChanges.map(a=>{const l=new od(s._firestore,s._userDataWriter,a.doc.key,a.doc,new vl(s._snapshot.mutatedKeys.has(a.doc.key),s._snapshot.fromCache),s.query.converter);return a.doc,{type:"added",doc:l,oldIndex:-1,newIndex:o++}})}{let o=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(a=>i||a.type!==3).map(a=>{const l=new od(s._firestore,s._userDataWriter,a.doc.key,a.doc,new vl(s._snapshot.mutatedKeys.has(a.doc.key),s._snapshot.fromCache),s.query.converter);let d=-1,h=-1;return a.type!==0&&(d=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),h=o.indexOf(a.doc.key)),{type:DM(a.type),doc:l,oldIndex:d,newIndex:h}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new K($.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=ji._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Sy.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const n=[],r=[],s=[];return this.docs.forEach(i=>{i._document!==null&&(n.push(i._document),r.push(this._userDataWriter.convertObjectMap(i._document.data.value.mapValue.fields,"previous")),s.push(i.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function DM(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return le(61501,{type:t})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ih(t){t=cn(t,It);const e=cn(t.firestore,pr);return pM(Uc(e),t._key).then(n=>rA(e,t,n))}ji._jsonSchemaVersion="firestore/querySnapshot/1.0",ji._jsonSchema={type:kt("string",ji._jsonSchemaVersion),bundleSource:kt("string","QuerySnapshot"),bundleName:kt("string"),bundle:kt("string")};class cf extends kM{constructor(e){super(),this.firestore=e}convertBytes(e){return new Hn(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new It(this.firestore,null,n)}}function Gt(t){t=cn(t,gr);const e=cn(t.firestore,pr),n=Uc(e),r=new cf(e);return JC(t._query),mM(n,t._query).then(s=>new ji(e,r,t,s))}function oh(t,e,n){t=cn(t,It);const r=cn(t.firestore,pr),s=tA(t.converter,e,n);return uf(r,[KC($c(r),"setDoc",t._key,s,t.converter!==null,n).toMutation(t._key,ln.none())])}function ea(t,e,n,...r){t=cn(t,It);const s=cn(t.firestore,pr),i=$c(s);let o;return o=typeof(e=Qe(e))=="string"||e instanceof nf?CM(i,"updateDoc",t._key,e,n,r):bM(i,"updateDoc",t._key,e),uf(s,[o.toMutation(t._key,ln.exists(!0))])}function nA(t){return uf(cn(t.firestore,pr),[new Gh(t._key,ln.none())])}function wl(t,e){const n=cn(t.firestore,pr),r=Qt(t),s=tA(t.converter,e);return uf(n,[KC($c(t.firestore),"addDoc",r._key,s,t.converter!==null,{}).toMutation(r._key,ln.exists(!1))]).then(()=>r)}function or(t,...e){var l,d,h;t=Qe(t);let n={includeMetadataChanges:!1,source:"default"},r=0;typeof e[r]!="object"||DI(e[r])||(n=e[r++]);const s={includeMetadataChanges:n.includeMetadataChanges,source:n.source};if(DI(e[r])){const f=e[r];e[r]=(l=f.next)==null?void 0:l.bind(f),e[r+1]=(d=f.error)==null?void 0:d.bind(f),e[r+2]=(h=f.complete)==null?void 0:h.bind(f)}let i,o,a;if(t instanceof It)o=cn(t.firestore,pr),a=jc(t._key.path),i={next:f=>{e[r]&&e[r](rA(o,t,f))},error:e[r+1],complete:e[r+2]};else{const f=cn(t,gr);o=cn(f.firestore,pr),a=f._query;const m=new cf(o);i={next:v=>{e[r]&&e[r](new ji(o,m,f,v))},error:e[r+1],complete:e[r+2]},JC(t._query)}return function(m,v,R,b){const A=new l_(b),I=new i_(v,A,R);return m.asyncQueue.enqueueAndForget(async()=>n_(await rh(m),I)),()=>{A.Nu(),m.asyncQueue.enqueueAndForget(async()=>r_(await rh(m),I))}}(Uc(o),a,s,i)}function uf(t,e){return function(r,s){const i=new ur;return r.asyncQueue.enqueueAndForget(async()=>tM(await hM(r),s,i)),i.promise}(Uc(t),e)}function rA(t,e,n){const r=n.docs.get(e._key),s=new cf(t);return new Di(t,s,e._key,r,new vl(n.hasPendingWrites,n.fromCache),e.converter)}function jM(t){return OM(t,{count:NM()})}function OM(t,e){const n=cn(t.firestore,pr),r=Uc(n),s=$O(e,(i,o)=>new mV(o,i.aggregateType,i._internalFieldPath));return gM(r,t._query,s).then(i=>function(a,l,d){const h=new cf(a);return new EM(l,h,d)}(n,t,i))}function $n(){return new u_("serverTimestamp")}function VM(...t){return new d_("arrayUnion",t)}function MI(t){return new h_("increment",t)}(function(e,n=!0){(function(s){ka=s})(so),hr(new Zn("firestore",(r,{instanceIdentifier:s,options:i})=>{const o=r.getProvider("app").getImmediate(),a=new pr(new Z2(r.getProvider("auth-internal")),new nO(o,r.getProvider("app-check-internal")),function(d,h){if(!Object.prototype.hasOwnProperty.apply(d.options,["projectId"]))throw new K($.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new qi(d.options.projectId,h)}(o,s),o);return i={useFetchStreams:n,...i},a._setSettings(i),a},"PUBLIC").setMultipleInstances(!0)),Rn(pE,mE,e),Rn(pE,mE,"esm2020")})();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sA="firebasestorage.googleapis.com",iA="storageBucket",LM=2*60*1e3,MM=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xt extends er{constructor(e,n,r=0){super(vp(e),`Firebase Storage: ${n} (${vp(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,xt.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return vp(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var Tt;(function(t){t.UNKNOWN="unknown",t.OBJECT_NOT_FOUND="object-not-found",t.BUCKET_NOT_FOUND="bucket-not-found",t.PROJECT_NOT_FOUND="project-not-found",t.QUOTA_EXCEEDED="quota-exceeded",t.UNAUTHENTICATED="unauthenticated",t.UNAUTHORIZED="unauthorized",t.UNAUTHORIZED_APP="unauthorized-app",t.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",t.INVALID_CHECKSUM="invalid-checksum",t.CANCELED="canceled",t.INVALID_EVENT_NAME="invalid-event-name",t.INVALID_URL="invalid-url",t.INVALID_DEFAULT_BUCKET="invalid-default-bucket",t.NO_DEFAULT_BUCKET="no-default-bucket",t.CANNOT_SLICE_BLOB="cannot-slice-blob",t.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",t.NO_DOWNLOAD_URL="no-download-url",t.INVALID_ARGUMENT="invalid-argument",t.INVALID_ARGUMENT_COUNT="invalid-argument-count",t.APP_DELETED="app-deleted",t.INVALID_ROOT_OPERATION="invalid-root-operation",t.INVALID_FORMAT="invalid-format",t.INTERNAL_ERROR="internal-error",t.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(Tt||(Tt={}));function vp(t){return"storage/"+t}function E_(){const t="An unknown error occurred, please check the error payload for server response.";return new xt(Tt.UNKNOWN,t)}function FM(t){return new xt(Tt.OBJECT_NOT_FOUND,"Object '"+t+"' does not exist.")}function UM(t){return new xt(Tt.QUOTA_EXCEEDED,"Quota for bucket '"+t+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function $M(){const t="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new xt(Tt.UNAUTHENTICATED,t)}function BM(){return new xt(Tt.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function zM(t){return new xt(Tt.UNAUTHORIZED,"User does not have permission to access '"+t+"'.")}function qM(){return new xt(Tt.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function HM(){return new xt(Tt.CANCELED,"User canceled the upload/download.")}function WM(t){return new xt(Tt.INVALID_URL,"Invalid URL '"+t+"'.")}function KM(t){return new xt(Tt.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}function GM(){return new xt(Tt.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+iA+"' property when initializing the app?")}function QM(){return new xt(Tt.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function YM(){return new xt(Tt.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function XM(t){return new xt(Tt.UNSUPPORTED_ENVIRONMENT,`${t} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function og(t){return new xt(Tt.INVALID_ARGUMENT,t)}function oA(){return new xt(Tt.APP_DELETED,"The Firebase app was deleted.")}function JM(t){return new xt(Tt.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function Ul(t,e){return new xt(Tt.INVALID_FORMAT,"String does not match format '"+t+"': "+e)}function al(t){throw new xt(Tt.INTERNAL_ERROR,"Internal error: "+t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mn{constructor(e,n){this.bucket=e,this.path_=n}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,n){let r;try{r=mn.makeFromUrl(e,n)}catch{return new mn(e,"")}if(r.path==="")return r;throw KM(e)}static makeFromUrl(e,n){let r=null;const s="([A-Za-z0-9.\\-_]+)";function i(j){j.path.charAt(j.path.length-1)==="/"&&(j.path_=j.path_.slice(0,-1))}const o="(/(.*))?$",a=new RegExp("^gs://"+s+o,"i"),l={bucket:1,path:3};function d(j){j.path_=decodeURIComponent(j.path)}const h="v[A-Za-z0-9_]+",f=n.replace(/[.]/g,"\\."),m="(/([^?#]*).*)?$",v=new RegExp(`^https?://${f}/${h}/b/${s}/o${m}`,"i"),R={bucket:1,path:3},b=n===sA?"(?:storage.googleapis.com|storage.cloud.google.com)":n,A="([^?#]*)",I=new RegExp(`^https?://${b}/${s}/${A}`,"i"),y=[{regex:a,indices:l,postModify:i},{regex:v,indices:R,postModify:d},{regex:I,indices:{bucket:1,path:2},postModify:d}];for(let j=0;j<y.length;j++){const V=y[j],M=V.regex.exec(e);if(M){const T=M[V.indices.bucket];let _=M[V.indices.path];_||(_=""),r=new mn(T,_),V.postModify(r);break}}if(r==null)throw WM(e);return r}}class ZM{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eF(t,e,n){let r=1,s=null,i=null,o=!1,a=0;function l(){return a===2}let d=!1;function h(...A){d||(d=!0,e.apply(null,A))}function f(A){s=setTimeout(()=>{s=null,t(v,l())},A)}function m(){i&&clearTimeout(i)}function v(A,...I){if(d){m();return}if(A){m(),h.call(null,A,...I);return}if(l()||o){m(),h.call(null,A,...I);return}r<64&&(r*=2);let y;a===1?(a=2,y=0):y=(r+Math.random())*1e3,f(y)}let R=!1;function b(A){R||(R=!0,m(),!d&&(s!==null?(A||(a=2),clearTimeout(s),f(0)):A||(a=1)))}return f(0),i=setTimeout(()=>{o=!0,b(!0)},n),b}function tF(t){t(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nF(t){return t!==void 0}function rF(t){return typeof t=="object"&&!Array.isArray(t)}function I_(t){return typeof t=="string"||t instanceof String}function FI(t){return T_()&&t instanceof Blob}function T_(){return typeof Blob<"u"}function ag(t,e,n,r){if(r<e)throw og(`Invalid value for '${t}'. Expected ${e} or greater.`);if(r>n)throw og(`Invalid value for '${t}'. Expected ${n} or less.`)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zc(t,e,n){let r=e;return n==null&&(r=`https://${e}`),`${n}://${r}/v0${t}`}function aA(t){const e=encodeURIComponent;let n="?";for(const r in t)if(t.hasOwnProperty(r)){const s=e(r)+"="+e(t[r]);n=n+s+"&"}return n=n.slice(0,-1),n}var Oi;(function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"})(Oi||(Oi={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sF(t,e){const n=t>=500&&t<600,s=[408,429].indexOf(t)!==-1,i=e.indexOf(t)!==-1;return n||s||i}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iF{constructor(e,n,r,s,i,o,a,l,d,h,f,m=!0,v=!1){this.url_=e,this.method_=n,this.headers_=r,this.body_=s,this.successCodes_=i,this.additionalRetryCodes_=o,this.callback_=a,this.errorCallback_=l,this.timeout_=d,this.progressCallback_=h,this.connectionFactory_=f,this.retry=m,this.isUsingEmulator=v,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((R,b)=>{this.resolve_=R,this.reject_=b,this.start_()})}start_(){const e=(r,s)=>{if(s){r(!1,new bu(!1,null,!0));return}const i=this.connectionFactory_();this.pendingConnection_=i;const o=a=>{const l=a.loaded,d=a.lengthComputable?a.total:-1;this.progressCallback_!==null&&this.progressCallback_(l,d)};this.progressCallback_!==null&&i.addUploadProgressListener(o),i.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&i.removeUploadProgressListener(o),this.pendingConnection_=null;const a=i.getErrorCode()===Oi.NO_ERROR,l=i.getStatus();if(!a||sF(l,this.additionalRetryCodes_)&&this.retry){const h=i.getErrorCode()===Oi.ABORT;r(!1,new bu(!1,null,h));return}const d=this.successCodes_.indexOf(l)!==-1;r(!0,new bu(d,i))})},n=(r,s)=>{const i=this.resolve_,o=this.reject_,a=s.connection;if(s.wasSuccessCode)try{const l=this.callback_(a,a.getResponse());nF(l)?i(l):i()}catch(l){o(l)}else if(a!==null){const l=E_();l.serverResponse=a.getErrorText(),this.errorCallback_?o(this.errorCallback_(a,l)):o(l)}else if(s.canceled){const l=this.appDelete_?oA():HM();o(l)}else{const l=qM();o(l)}};this.canceled_?n(!1,new bu(!1,null,!0)):this.backoffId_=eF(e,n,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&tF(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class bu{constructor(e,n,r){this.wasSuccessCode=e,this.connection=n,this.canceled=!!r}}function oF(t,e){e!==null&&e.length>0&&(t.Authorization="Firebase "+e)}function aF(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function lF(t,e){e&&(t["X-Firebase-GMPID"]=e)}function cF(t,e){e!==null&&(t["X-Firebase-AppCheck"]=e)}function uF(t,e,n,r,s,i,o=!0,a=!1){const l=aA(t.urlParams),d=t.url+l,h=Object.assign({},t.headers);return lF(h,e),oF(h,n),aF(h,i),cF(h,r),new iF(d,t.method,h,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,s,o,a)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dF(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function hF(...t){const e=dF();if(e!==void 0){const n=new e;for(let r=0;r<t.length;r++)n.append(t[r]);return n.getBlob()}else{if(T_())return new Blob(t);throw new xt(Tt.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function fF(t,e,n){return t.webkitSlice?t.webkitSlice(e,n):t.mozSlice?t.mozSlice(e,n):t.slice?t.slice(e,n):null}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pF(t){if(typeof atob>"u")throw XM("base-64");return atob(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ar={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class wp{constructor(e,n){this.data=e,this.contentType=n||null}}function mF(t,e){switch(t){case Ar.RAW:return new wp(lA(e));case Ar.BASE64:case Ar.BASE64URL:return new wp(cA(t,e));case Ar.DATA_URL:return new wp(yF(e),_F(e))}throw E_()}function lA(t){const e=[];for(let n=0;n<t.length;n++){let r=t.charCodeAt(n);if(r<=127)e.push(r);else if(r<=2047)e.push(192|r>>6,128|r&63);else if((r&64512)===55296)if(!(n<t.length-1&&(t.charCodeAt(n+1)&64512)===56320))e.push(239,191,189);else{const i=r,o=t.charCodeAt(++n);r=65536|(i&1023)<<10|o&1023,e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|r&63)}else(r&64512)===56320?e.push(239,191,189):e.push(224|r>>12,128|r>>6&63,128|r&63)}return new Uint8Array(e)}function gF(t){let e;try{e=decodeURIComponent(t)}catch{throw Ul(Ar.DATA_URL,"Malformed data URL.")}return lA(e)}function cA(t,e){switch(t){case Ar.BASE64:{const s=e.indexOf("-")!==-1,i=e.indexOf("_")!==-1;if(s||i)throw Ul(t,"Invalid character '"+(s?"-":"_")+"' found: is it base64url encoded?");break}case Ar.BASE64URL:{const s=e.indexOf("+")!==-1,i=e.indexOf("/")!==-1;if(s||i)throw Ul(t,"Invalid character '"+(s?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let n;try{n=pF(e)}catch(s){throw s.message.includes("polyfill")?s:Ul(t,"Invalid character found")}const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}class uA{constructor(e){this.base64=!1,this.contentType=null;const n=e.match(/^data:([^,]+)?,/);if(n===null)throw Ul(Ar.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const r=n[1]||null;r!=null&&(this.base64=vF(r,";base64"),this.contentType=this.base64?r.substring(0,r.length-7):r),this.rest=e.substring(e.indexOf(",")+1)}}function yF(t){const e=new uA(t);return e.base64?cA(Ar.BASE64,e.rest):gF(e.rest)}function _F(t){return new uA(t).contentType}function vF(t,e){return t.length>=e.length?t.substring(t.length-e.length)===e:!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cs{constructor(e,n){let r=0,s="";FI(e)?(this.data_=e,r=e.size,s=e.type):e instanceof ArrayBuffer?(n?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),r=this.data_.length):e instanceof Uint8Array&&(n?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),r=e.length),this.size_=r,this.type_=s}size(){return this.size_}type(){return this.type_}slice(e,n){if(FI(this.data_)){const r=this.data_,s=fF(r,e,n);return s===null?null:new Cs(s)}else{const r=new Uint8Array(this.data_.buffer,e,n-e);return new Cs(r,!0)}}static getBlob(...e){if(T_()){const n=e.map(r=>r instanceof Cs?r.data_:r);return new Cs(hF.apply(null,n))}else{const n=e.map(o=>I_(o)?mF(Ar.RAW,o).data:o.data_);let r=0;n.forEach(o=>{r+=o.byteLength});const s=new Uint8Array(r);let i=0;return n.forEach(o=>{for(let a=0;a<o.length;a++)s[i++]=o[a]}),new Cs(s,!0)}}uploadData(){return this.data_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function x_(t){let e;try{e=JSON.parse(t)}catch{return null}return rF(e)?e:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wF(t){if(t.length===0)return null;const e=t.lastIndexOf("/");return e===-1?"":t.slice(0,e)}function EF(t,e){const n=e.split("/").filter(r=>r.length>0).join("/");return t.length===0?n:t+"/"+n}function dA(t){const e=t.lastIndexOf("/",t.length-2);return e===-1?t:t.slice(e+1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function IF(t,e){return e}class hn{constructor(e,n,r,s){this.server=e,this.local=n||e,this.writable=!!r,this.xform=s||IF}}let Cu=null;function TF(t){return!I_(t)||t.length<2?t:dA(t)}function hA(){if(Cu)return Cu;const t=[];t.push(new hn("bucket")),t.push(new hn("generation")),t.push(new hn("metageneration")),t.push(new hn("name","fullPath",!0));function e(i,o){return TF(o)}const n=new hn("name");n.xform=e,t.push(n);function r(i,o){return o!==void 0?Number(o):o}const s=new hn("size");return s.xform=r,t.push(s),t.push(new hn("timeCreated")),t.push(new hn("updated")),t.push(new hn("md5Hash",null,!0)),t.push(new hn("cacheControl",null,!0)),t.push(new hn("contentDisposition",null,!0)),t.push(new hn("contentEncoding",null,!0)),t.push(new hn("contentLanguage",null,!0)),t.push(new hn("contentType",null,!0)),t.push(new hn("metadata","customMetadata",!0)),Cu=t,Cu}function xF(t,e){function n(){const r=t.bucket,s=t.fullPath,i=new mn(r,s);return e._makeStorageReference(i)}Object.defineProperty(t,"ref",{get:n})}function SF(t,e,n){const r={};r.type="file";const s=n.length;for(let i=0;i<s;i++){const o=n[i];r[o.local]=o.xform(r,e[o.server])}return xF(r,t),r}function fA(t,e,n){const r=x_(e);return r===null?null:SF(t,r,n)}function bF(t,e,n,r){const s=x_(e);if(s===null||!I_(s.downloadTokens))return null;const i=s.downloadTokens;if(i.length===0)return null;const o=encodeURIComponent;return i.split(",").map(d=>{const h=t.bucket,f=t.fullPath,m="/b/"+o(h)+"/o/"+o(f),v=zc(m,n,r),R=aA({alt:"media",token:d});return v+R})[0]}function CF(t,e){const n={},r=e.length;for(let s=0;s<r;s++){const i=e[s];i.writable&&(n[i.server]=t[i.local])}return JSON.stringify(n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UI="prefixes",$I="items";function AF(t,e,n){const r={prefixes:[],items:[],nextPageToken:n.nextPageToken};if(n[UI])for(const s of n[UI]){const i=s.replace(/\/$/,""),o=t._makeStorageReference(new mn(e,i));r.prefixes.push(o)}if(n[$I])for(const s of n[$I]){const i=t._makeStorageReference(new mn(e,s.name));r.items.push(i)}return r}function RF(t,e,n){const r=x_(n);return r===null?null:AF(t,e,r)}class df{constructor(e,n,r,s){this.url=e,this.method=n,this.handler=r,this.timeout=s,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function S_(t){if(!t)throw E_()}function PF(t,e){function n(r,s){const i=fA(t,s,e);return S_(i!==null),i}return n}function kF(t,e){function n(r,s){const i=RF(t,e,s);return S_(i!==null),i}return n}function NF(t,e){function n(r,s){const i=fA(t,s,e);return S_(i!==null),bF(i,s,t.host,t._protocol)}return n}function b_(t){function e(n,r){let s;return n.getStatus()===401?n.getErrorText().includes("Firebase App Check token is invalid")?s=BM():s=$M():n.getStatus()===402?s=UM(t.bucket):n.getStatus()===403?s=zM(t.path):s=r,s.status=n.getStatus(),s.serverResponse=r.serverResponse,s}return e}function pA(t){const e=b_(t);function n(r,s){let i=e(r,s);return r.getStatus()===404&&(i=FM(t.path)),i.serverResponse=s.serverResponse,i}return n}function DF(t,e,n,r,s){const i={};e.isRoot?i.prefix="":i.prefix=e.path+"/",n.length>0&&(i.delimiter=n),r&&(i.pageToken=r),s&&(i.maxResults=s);const o=e.bucketOnlyServerUrl(),a=zc(o,t.host,t._protocol),l="GET",d=t.maxOperationRetryTime,h=new df(a,l,kF(t,e.bucket),d);return h.urlParams=i,h.errorHandler=b_(e),h}function jF(t,e,n){const r=e.fullServerUrl(),s=zc(r,t.host,t._protocol),i="GET",o=t.maxOperationRetryTime,a=new df(s,i,NF(t,n),o);return a.errorHandler=pA(e),a}function OF(t,e){const n=e.fullServerUrl(),r=zc(n,t.host,t._protocol),s="DELETE",i=t.maxOperationRetryTime;function o(l,d){}const a=new df(r,s,o,i);return a.successCodes=[200,204],a.errorHandler=pA(e),a}function VF(t,e){return t&&t.contentType||e&&e.type()||"application/octet-stream"}function LF(t,e,n){const r=Object.assign({},n);return r.fullPath=t.path,r.size=e.size(),r.contentType||(r.contentType=VF(null,e)),r}function MF(t,e,n,r,s){const i=e.bucketOnlyServerUrl(),o={"X-Goog-Upload-Protocol":"multipart"};function a(){let y="";for(let j=0;j<2;j++)y=y+Math.random().toString().slice(2);return y}const l=a();o["Content-Type"]="multipart/related; boundary="+l;const d=LF(e,r,s),h=CF(d,n),f="--"+l+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+h+`\r
--`+l+`\r
Content-Type: `+d.contentType+`\r
\r
`,m=`\r
--`+l+"--",v=Cs.getBlob(f,r,m);if(v===null)throw QM();const R={name:d.fullPath},b=zc(i,t.host,t._protocol),A="POST",I=t.maxUploadRetryTime,w=new df(b,A,PF(t,n),I);return w.urlParams=R,w.headers=o,w.body=v.uploadData(),w.errorHandler=b_(e),w}class FF{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=Oi.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=Oi.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=Oi.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,n,r,s,i){if(this.sent_)throw al("cannot .send() more than once");if(ti(e)&&r&&(this.xhr_.withCredentials=!0),this.sent_=!0,this.xhr_.open(n,e,!0),i!==void 0)for(const o in i)i.hasOwnProperty(o)&&this.xhr_.setRequestHeader(o,i[o].toString());return s!==void 0?this.xhr_.send(s):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw al("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw al("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw al("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw al("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class UF extends FF{initXhr(){this.xhr_.responseType="text"}}function hf(){return new UF}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ji{constructor(e,n){this._service=e,n instanceof mn?this._location=n:this._location=mn.makeFromUrl(n,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,n){return new Ji(e,n)}get root(){const e=new mn(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return dA(this._location.path)}get storage(){return this._service}get parent(){const e=wF(this._location.path);if(e===null)return null;const n=new mn(this._location.bucket,e);return new Ji(this._service,n)}_throwIfRoot(e){if(this._location.path==="")throw JM(e)}}function $F(t,e,n){t._throwIfRoot("uploadBytes");const r=MF(t.storage,t._location,hA(),new Cs(e,!0),n);return t.storage.makeRequestWithTokens(r,hf).then(s=>({metadata:s,ref:t}))}function BF(t){const e={prefixes:[],items:[]};return mA(t,e).then(()=>e)}async function mA(t,e,n){const s=await zF(t,{pageToken:n});e.prefixes.push(...s.prefixes),e.items.push(...s.items),s.nextPageToken!=null&&await mA(t,e,s.nextPageToken)}function zF(t,e){e!=null&&typeof e.maxResults=="number"&&ag("options.maxResults",1,1e3,e.maxResults);const n=e||{},r=DF(t.storage,t._location,"/",n.pageToken,n.maxResults);return t.storage.makeRequestWithTokens(r,hf)}function qF(t){t._throwIfRoot("getDownloadURL");const e=jF(t.storage,t._location,hA());return t.storage.makeRequestWithTokens(e,hf).then(n=>{if(n===null)throw YM();return n})}function HF(t){t._throwIfRoot("deleteObject");const e=OF(t.storage,t._location);return t.storage.makeRequestWithTokens(e,hf)}function WF(t,e){const n=EF(t._location.path,e),r=new mn(t._location.bucket,n);return new Ji(t.storage,r)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function KF(t){return/^[A-Za-z]+:\/\//.test(t)}function GF(t,e){return new Ji(t,e)}function gA(t,e){if(t instanceof C_){const n=t;if(n._bucket==null)throw GM();const r=new Ji(n,n._bucket);return e!=null?gA(r,e):r}else return e!==void 0?WF(t,e):t}function QF(t,e){if(e&&KF(e)){if(t instanceof C_)return GF(t,e);throw og("To use ref(service, url), the first argument must be a Storage instance.")}else return gA(t,e)}function BI(t,e){const n=e==null?void 0:e[iA];return n==null?null:mn.makeFromBucketSpec(n,t)}function YF(t,e,n,r={}){t.host=`${e}:${n}`;const s=ti(e);s&&(uy(`https://${t.host}/b`),dy("Storage",!0)),t._isUsingEmulator=!0,t._protocol=s?"https":"http";const{mockUserToken:i}=r;i&&(t._overrideAuthToken=typeof i=="string"?i:Xx(i,t.app.options.projectId))}class C_{constructor(e,n,r,s,i,o=!1){this.app=e,this._authProvider=n,this._appCheckProvider=r,this._url=s,this._firebaseVersion=i,this._isUsingEmulator=o,this._bucket=null,this._host=sA,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=LM,this._maxUploadRetryTime=MM,this._requests=new Set,s!=null?this._bucket=mn.makeFromBucketSpec(s,this._host):this._bucket=BI(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=mn.makeFromBucketSpec(this._url,e):this._bucket=BI(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){ag("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){ag("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const n=await e.getToken();if(n!==null)return n.accessToken}return null}async _getAppCheckToken(){if(qn(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Ji(this,e)}_makeRequest(e,n,r,s,i=!0){if(this._deleted)return new ZM(oA());{const o=uF(e,this._appId,r,s,n,this._firebaseVersion,i,this._isUsingEmulator);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}async makeRequestWithTokens(e,n){const[r,s]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,n,r,s).getPromise()}}const zI="@firebase/storage",qI="0.14.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yA="storage";function HI(t,e,n){return t=Qe(t),$F(t,e,n)}function WI(t){return t=Qe(t),BF(t)}function KI(t){return t=Qe(t),qF(t)}function Ep(t){return t=Qe(t),HF(t)}function ll(t,e){return t=Qe(t),QF(t,e)}function Ii(t=Ph(),e){t=Qe(t);const r=ni(t,yA).getImmediate({identifier:e}),s=Gx("storage");return s&&XF(r,...s),r}function XF(t,e,n,r={}){YF(t,e,n,r)}function JF(t,{instanceIdentifier:e}){const n=t.getProvider("app").getImmediate(),r=t.getProvider("auth-internal"),s=t.getProvider("app-check-internal");return new C_(n,r,s,e,so)}function ZF(){hr(new Zn(yA,JF,"PUBLIC").setMultipleInstances(!0)),Rn(zI,qI,""),Rn(zI,qI,"esm2020")}ZF();const e4={apiKey:"AIzaSyC70mGCRrjE8iOap8iTHuid8HEuyadue8Y",authDomain:"odontocloud-d92ac.firebaseapp.com",projectId:"odontocloud-d92ac",storageBucket:"odontocloud-d92ac.firebasestorage.app",messagingSenderId:"267020714981",appId:"1:267020714981:web:a44416ea83aa1d1172650c",measurementId:"G-ZMCC5CFY0C"},A_=py(e4),GI=BS(A_),QI=zC(A_);Ii(A_);const t4="/odontocloud-react/assets/fondo.png",_A="/odontocloud-react/assets/logo.png",YI=(t,e)=>{const n={email:t,rol:e,timestamp:Date.now()};localStorage.setItem("odc_session",JSON.stringify(n))},Ip=()=>{try{const t=JSON.parse(localStorage.getItem("odc_session"));return t&&Date.now()-t.timestamp<1e3*60*60*24?t:null}catch{return null}},n4=()=>{const t=Sc(),[e,n]=k.useState(""),[r,s]=k.useState(""),[i,o]=k.useState(""),[a,l]=k.useState(navigator.onLine);k.useEffect(()=>{const f=()=>l(!0),m=()=>l(!1);return window.addEventListener("online",f),window.addEventListener("offline",m),()=>{window.removeEventListener("online",f),window.removeEventListener("offline",m)}},[]);const d=f=>{const m=(f||"").toLowerCase();m==="administrador"?t("/dashboard_admin",{replace:!0}):m==="doctor"?t("/dashboard_doctor",{replace:!0}):m==="recepcionista"?t("/dashboard_recepcion",{replace:!0}):o("Rol no reconocido. Contacte al administrador.")};k.useEffect(()=>{if(!navigator.onLine){const m=Ip();m!=null&&m.rol?d(m.rol):o("Sin conexin y no hay sesin guardada.");return}const f=Ey(GI,async m=>{if(m){const v=Ip();if(v!=null&&v.rol){d(v.rol);return}try{const R=rt($e(QI,"users"),Je("correo","==",m.email||"")),b=await Gt(R);if(!b.empty){const A=b.docs[0].data().rol||"sin_rol";YI(m.email||"",A),d(A)}}catch{d("administrador")}}});return()=>f()},[]);const h=async f=>{if(f.preventDefault(),o(""),!a){const m=Ip();m!=null&&m.rol?d(m.rol):o("Sin conexin y no hay sesin guardada.");return}try{const v=(await Vj(GI,e,r)).user,R=rt($e(QI,"users"),Je("correo","==",e)),b=await Gt(R);if(b.empty){o("Usuario no encontrado en la base de datos.");return}const I=b.docs[0].data().rol||"sin_rol";YI(e,I),d(I)}catch(m){switch(console.error("Error login:",m),m.code){case"auth/user-not-found":o("Usuario no registrado.");break;case"auth/wrong-password":o("Contrasea incorrecta.");break;case"auth/invalid-email":o("Correo no vlido.");break;case"auth/network-request-failed":o("Sin conexin. Usa la sesin guardada o reconecta.");break;default:o("Error al iniciar sesin.")}}};return u.jsx("div",{className:"login-root",style:{backgroundImage:`url(${t4})`,backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat",backgroundAttachment:"fixed",width:"100vw",height:"100vh",display:"flex",justifyContent:"center",alignItems:"center",overflow:"hidden"},children:u.jsxs("div",{className:"container",children:[u.jsxs("div",{className:"left-panel",children:[u.jsx("img",{src:_A,alt:"OdontoCloud Logo",className:"logo"}),u.jsxs("h2",{children:["Su clnica, ",u.jsx("br",{})," ms conectada."]}),u.jsx("p",{children:"OdontoCloud optimiza cada detalle de su gestin."})]}),u.jsxs("div",{className:"right-panel",children:[u.jsx("h3",{children:"Acceso a la plataforma"}),u.jsxs("form",{onSubmit:h,children:[u.jsx("input",{type:"email",placeholder:"usuario@ejemplo.com",value:e,onChange:f=>n(f.target.value),required:a}),u.jsx("input",{type:"password",placeholder:"Contrasea",value:r,onChange:f=>s(f.target.value),required:a}),u.jsx("button",{type:"submit",children:a?"Iniciar sesin":"Entrar (modo offline)"}),i&&u.jsx("p",{style:{color:"red",marginTop:10},children:i}),!a&&u.jsx("p",{style:{color:"orange",marginTop:10},children:" Modo offline activado"})]})]})]})})},vA="@firebase/installations",R_="0.6.19";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wA=1e4,EA=`w:${R_}`,IA="FIS_v2",r4="https://firebaseinstallations.googleapis.com/v1",s4=60*60*1e3,i4="installations",o4="Installations";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const a4={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},Zi=new ro(i4,o4,a4);function TA(t){return t instanceof er&&t.code.includes("request-failed")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xA({projectId:t}){return`${r4}/projects/${t}/installations`}function SA(t){return{token:t.token,requestStatus:2,expiresIn:c4(t.expiresIn),creationTime:Date.now()}}async function bA(t,e){const r=(await e.json()).error;return Zi.create("request-failed",{requestName:t,serverCode:r.code,serverMessage:r.message,serverStatus:r.status})}function CA({apiKey:t}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t})}function l4(t,{refreshToken:e}){const n=CA(t);return n.append("Authorization",u4(e)),n}async function AA(t){const e=await t();return e.status>=500&&e.status<600?t():e}function c4(t){return Number(t.replace("s","000"))}function u4(t){return`${IA} ${t}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function d4({appConfig:t,heartbeatServiceProvider:e},{fid:n}){const r=xA(t),s=CA(t),i=e.getImmediate({optional:!0});if(i){const d=await i.getHeartbeatsHeader();d&&s.append("x-firebase-client",d)}const o={fid:n,authVersion:IA,appId:t.appId,sdkVersion:EA},a={method:"POST",headers:s,body:JSON.stringify(o)},l=await AA(()=>fetch(r,a));if(l.ok){const d=await l.json();return{fid:d.fid||n,registrationStatus:2,refreshToken:d.refreshToken,authToken:SA(d.authToken)}}else throw await bA("Create Installation",l)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function RA(t){return new Promise(e=>{setTimeout(e,t)})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function h4(t){return btoa(String.fromCharCode(...t)).replace(/\+/g,"-").replace(/\//g,"_")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const f4=/^[cdef][\w-]{21}$/,lg="";function p4(){try{const t=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(t),t[0]=112+t[0]%16;const n=m4(t);return f4.test(n)?n:lg}catch{return lg}}function m4(t){return h4(t).substr(0,22)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ff(t){return`${t.appName}!${t.appId}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PA=new Map;function kA(t,e){const n=ff(t);NA(n,e),g4(n,e)}function NA(t,e){const n=PA.get(t);if(n)for(const r of n)r(e)}function g4(t,e){const n=y4();n&&n.postMessage({key:t,fid:e}),_4()}let Ci=null;function y4(){return!Ci&&"BroadcastChannel"in self&&(Ci=new BroadcastChannel("[Firebase] FID Change"),Ci.onmessage=t=>{NA(t.data.key,t.data.fid)}),Ci}function _4(){PA.size===0&&Ci&&(Ci.close(),Ci=null)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const v4="firebase-installations-database",w4=1,eo="firebase-installations-store";let Tp=null;function P_(){return Tp||(Tp=iS(v4,w4,{upgrade:(t,e)=>{switch(e){case 0:t.createObjectStore(eo)}}})),Tp}async function ah(t,e){const n=ff(t),s=(await P_()).transaction(eo,"readwrite"),i=s.objectStore(eo),o=await i.get(n);return await i.put(e,n),await s.done,(!o||o.fid!==e.fid)&&kA(t,e.fid),e}async function DA(t){const e=ff(t),r=(await P_()).transaction(eo,"readwrite");await r.objectStore(eo).delete(e),await r.done}async function pf(t,e){const n=ff(t),s=(await P_()).transaction(eo,"readwrite"),i=s.objectStore(eo),o=await i.get(n),a=e(o);return a===void 0?await i.delete(n):await i.put(a,n),await s.done,a&&(!o||o.fid!==a.fid)&&kA(t,a.fid),a}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function k_(t){let e;const n=await pf(t.appConfig,r=>{const s=E4(r),i=I4(t,s);return e=i.registrationPromise,i.installationEntry});return n.fid===lg?{installationEntry:await e}:{installationEntry:n,registrationPromise:e}}function E4(t){const e=t||{fid:p4(),registrationStatus:0};return jA(e)}function I4(t,e){if(e.registrationStatus===0){if(!navigator.onLine){const s=Promise.reject(Zi.create("app-offline"));return{installationEntry:e,registrationPromise:s}}const n={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},r=T4(t,n);return{installationEntry:n,registrationPromise:r}}else return e.registrationStatus===1?{installationEntry:e,registrationPromise:x4(t)}:{installationEntry:e}}async function T4(t,e){try{const n=await d4(t,e);return ah(t.appConfig,n)}catch(n){throw TA(n)&&n.customData.serverCode===409?await DA(t.appConfig):await ah(t.appConfig,{fid:e.fid,registrationStatus:0}),n}}async function x4(t){let e=await XI(t.appConfig);for(;e.registrationStatus===1;)await RA(100),e=await XI(t.appConfig);if(e.registrationStatus===0){const{installationEntry:n,registrationPromise:r}=await k_(t);return r||n}return e}function XI(t){return pf(t,e=>{if(!e)throw Zi.create("installation-not-found");return jA(e)})}function jA(t){return S4(t)?{fid:t.fid,registrationStatus:0}:t}function S4(t){return t.registrationStatus===1&&t.registrationTime+wA<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function b4({appConfig:t,heartbeatServiceProvider:e},n){const r=C4(t,n),s=l4(t,n),i=e.getImmediate({optional:!0});if(i){const d=await i.getHeartbeatsHeader();d&&s.append("x-firebase-client",d)}const o={installation:{sdkVersion:EA,appId:t.appId}},a={method:"POST",headers:s,body:JSON.stringify(o)},l=await AA(()=>fetch(r,a));if(l.ok){const d=await l.json();return SA(d)}else throw await bA("Generate Auth Token",l)}function C4(t,{fid:e}){return`${xA(t)}/${e}/authTokens:generate`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function N_(t,e=!1){let n;const r=await pf(t.appConfig,i=>{if(!OA(i))throw Zi.create("not-registered");const o=i.authToken;if(!e&&P4(o))return i;if(o.requestStatus===1)return n=A4(t,e),i;{if(!navigator.onLine)throw Zi.create("app-offline");const a=N4(i);return n=R4(t,a),a}});return n?await n:r.authToken}async function A4(t,e){let n=await JI(t.appConfig);for(;n.authToken.requestStatus===1;)await RA(100),n=await JI(t.appConfig);const r=n.authToken;return r.requestStatus===0?N_(t,e):r}function JI(t){return pf(t,e=>{if(!OA(e))throw Zi.create("not-registered");const n=e.authToken;return D4(n)?{...e,authToken:{requestStatus:0}}:e})}async function R4(t,e){try{const n=await b4(t,e),r={...e,authToken:n};return await ah(t.appConfig,r),n}catch(n){if(TA(n)&&(n.customData.serverCode===401||n.customData.serverCode===404))await DA(t.appConfig);else{const r={...e,authToken:{requestStatus:0}};await ah(t.appConfig,r)}throw n}}function OA(t){return t!==void 0&&t.registrationStatus===2}function P4(t){return t.requestStatus===2&&!k4(t)}function k4(t){const e=Date.now();return e<t.creationTime||t.creationTime+t.expiresIn<e+s4}function N4(t){const e={requestStatus:1,requestTime:Date.now()};return{...t,authToken:e}}function D4(t){return t.requestStatus===1&&t.requestTime+wA<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function j4(t){const e=t,{installationEntry:n,registrationPromise:r}=await k_(e);return r?r.catch(console.error):N_(e).catch(console.error),n.fid}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function O4(t,e=!1){const n=t;return await V4(n),(await N_(n,e)).token}async function V4(t){const{registrationPromise:e}=await k_(t);e&&await e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function L4(t){if(!t||!t.options)throw xp("App Configuration");if(!t.name)throw xp("App Name");const e=["projectId","apiKey","appId"];for(const n of e)if(!t.options[n])throw xp(n);return{appName:t.name,projectId:t.options.projectId,apiKey:t.options.apiKey,appId:t.options.appId}}function xp(t){return Zi.create("missing-app-config-values",{valueName:t})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VA="installations",M4="installations-internal",F4=t=>{const e=t.getProvider("app").getImmediate(),n=L4(e),r=ni(e,"heartbeat");return{app:e,appConfig:n,heartbeatServiceProvider:r,_delete:()=>Promise.resolve()}},U4=t=>{const e=t.getProvider("app").getImmediate(),n=ni(e,VA).getImmediate();return{getId:()=>j4(n),getToken:s=>O4(n,s)}};function $4(){hr(new Zn(VA,F4,"PUBLIC")),hr(new Zn(M4,U4,"PRIVATE"))}$4();Rn(vA,R_);Rn(vA,R_,"esm2020");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lh="analytics",B4="firebase_id",z4="origin",q4=60*1e3,H4="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",D_="https://www.googletagmanager.com/gtag/js";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _n=new Rh("@firebase/analytics");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const W4={"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-initialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."},Vn=new ro("analytics","Analytics",W4);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function K4(t){if(!t.startsWith(D_)){const e=Vn.create("invalid-gtag-resource",{gtagURL:t});return _n.warn(e.message),""}return t}function LA(t){return Promise.all(t.map(e=>e.catch(n=>n)))}function G4(t,e){let n;return window.trustedTypes&&(n=window.trustedTypes.createPolicy(t,e)),n}function Q4(t,e){const n=G4("firebase-js-sdk-policy",{createScriptURL:K4}),r=document.createElement("script"),s=`${D_}?l=${t}&id=${e}`;r.src=n?n==null?void 0:n.createScriptURL(s):s,r.async=!0,document.head.appendChild(r)}function Y4(t){let e=[];return Array.isArray(window[t])?e=window[t]:window[t]=e,e}async function X4(t,e,n,r,s,i){const o=r[s];try{if(o)await e[o];else{const l=(await LA(n)).find(d=>d.measurementId===s);l&&await e[l.appId]}}catch(a){_n.error(a)}t("config",s,i)}async function J4(t,e,n,r,s){try{let i=[];if(s&&s.send_to){let o=s.send_to;Array.isArray(o)||(o=[o]);const a=await LA(n);for(const l of o){const d=a.find(f=>f.measurementId===l),h=d&&e[d.appId];if(h)i.push(h);else{i=[];break}}}i.length===0&&(i=Object.values(e)),await Promise.all(i),t("event",r,s||{})}catch(i){_n.error(i)}}function Z4(t,e,n,r){async function s(i,...o){try{if(i==="event"){const[a,l]=o;await J4(t,e,n,a,l)}else if(i==="config"){const[a,l]=o;await X4(t,e,n,r,a,l)}else if(i==="consent"){const[a,l]=o;t("consent",a,l)}else if(i==="get"){const[a,l,d]=o;t("get",a,l,d)}else if(i==="set"){const[a]=o;t("set",a)}else t(i,...o)}catch(a){_n.error(a)}}return s}function eU(t,e,n,r,s){let i=function(...o){window[r].push(arguments)};return window[s]&&typeof window[s]=="function"&&(i=window[s]),window[s]=Z4(i,t,e,n),{gtagCore:i,wrappedGtag:window[s]}}function tU(t){const e=window.document.getElementsByTagName("script");for(const n of Object.values(e))if(n.src&&n.src.includes(D_)&&n.src.includes(t))return n;return null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nU=30,rU=1e3;class sU{constructor(e={},n=rU){this.throttleMetadata=e,this.intervalMillis=n}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,n){this.throttleMetadata[e]=n}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}}const MA=new sU;function iU(t){return new Headers({Accept:"application/json","x-goog-api-key":t})}async function oU(t){var o;const{appId:e,apiKey:n}=t,r={method:"GET",headers:iU(n)},s=H4.replace("{app-id}",e),i=await fetch(s,r);if(i.status!==200&&i.status!==304){let a="";try{const l=await i.json();(o=l.error)!=null&&o.message&&(a=l.error.message)}catch{}throw Vn.create("config-fetch-failed",{httpStatus:i.status,responseMessage:a})}return i.json()}async function aU(t,e=MA,n){const{appId:r,apiKey:s,measurementId:i}=t.options;if(!r)throw Vn.create("no-app-id");if(!s){if(i)return{measurementId:i,appId:r};throw Vn.create("no-api-key")}const o=e.getThrottleMetadata(r)||{backoffCount:0,throttleEndTimeMillis:Date.now()},a=new uU;return setTimeout(async()=>{a.abort()},q4),FA({appId:r,apiKey:s,measurementId:i},o,a,e)}async function FA(t,{throttleEndTimeMillis:e,backoffCount:n},r,s=MA){var a;const{appId:i,measurementId:o}=t;try{await lU(r,e)}catch(l){if(o)return _n.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${o} provided in the "measurementId" field in the local Firebase config. [${l==null?void 0:l.message}]`),{appId:i,measurementId:o};throw l}try{const l=await oU(t);return s.deleteThrottleMetadata(i),l}catch(l){const d=l;if(!cU(d)){if(s.deleteThrottleMetadata(i),o)return _n.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${o} provided in the "measurementId" field in the local Firebase config. [${d==null?void 0:d.message}]`),{appId:i,measurementId:o};throw l}const h=Number((a=d==null?void 0:d.customData)==null?void 0:a.httpStatus)===503?Mw(n,s.intervalMillis,nU):Mw(n,s.intervalMillis),f={throttleEndTimeMillis:Date.now()+h,backoffCount:n+1};return s.setThrottleMetadata(i,f),_n.debug(`Calling attemptFetch again in ${h} millis`),FA(t,f,r,s)}}function lU(t,e){return new Promise((n,r)=>{const s=Math.max(e-Date.now(),0),i=setTimeout(n,s);t.addEventListener(()=>{clearTimeout(i),r(Vn.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}function cU(t){if(!(t instanceof er)||!t.customData)return!1;const e=Number(t.customData.httpStatus);return e===429||e===500||e===503||e===504}class uU{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach(e=>e())}}async function dU(t,e,n,r,s){if(s&&s.global){t("event",n,r);return}else{const i=await e,o={...r,send_to:i};t("event",n,o)}}async function hU(t,e,n,r){if(r&&r.global){const s={};for(const i of Object.keys(n))s[`user_properties.${i}`]=n[i];return t("set",s),Promise.resolve()}else{const s=await e;t("config",s,{update:!0,user_properties:n})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function fU(){if(hy())try{await nS()}catch(t){return _n.warn(Vn.create("indexeddb-unavailable",{errorInfo:t==null?void 0:t.toString()}).message),!1}else return _n.warn(Vn.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;return!0}async function pU(t,e,n,r,s,i,o){const a=aU(t);a.then(m=>{n[m.measurementId]=m.appId,t.options.measurementId&&m.measurementId!==t.options.measurementId&&_n.warn(`The measurement ID in the local Firebase config (${t.options.measurementId}) does not match the measurement ID fetched from the server (${m.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(m=>_n.error(m)),e.push(a);const l=fU().then(m=>{if(m)return r.getId()}),[d,h]=await Promise.all([a,l]);tU(i)||Q4(i,d.measurementId),s("js",new Date);const f=(o==null?void 0:o.config)??{};return f[z4]="firebase",f.update=!0,h!=null&&(f[B4]=h),s("config",d.measurementId,f),d.measurementId}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mU{constructor(e){this.app=e}_delete(){return delete ta[this.app.options.appId],Promise.resolve()}}let ta={},ZI=[];const eT={};let Sp="dataLayer",gU="gtag",tT,j_,nT=!1;function yU(){const t=[];if(Zx()&&t.push("This is a browser extension environment."),_N()||t.push("Cookies are not available."),t.length>0){const e=t.map((r,s)=>`(${s+1}) ${r}`).join(" "),n=Vn.create("invalid-analytics-context",{errorInfo:e});_n.warn(n.message)}}function _U(t,e,n){yU();const r=t.options.appId;if(!r)throw Vn.create("no-app-id");if(!t.options.apiKey)if(t.options.measurementId)_n.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${t.options.measurementId} provided in the "measurementId" field in the local Firebase config.`);else throw Vn.create("no-api-key");if(ta[r]!=null)throw Vn.create("already-exists",{id:r});if(!nT){Y4(Sp);const{wrappedGtag:i,gtagCore:o}=eU(ta,ZI,eT,Sp,gU);j_=i,tT=o,nT=!0}return ta[r]=pU(t,ZI,eT,e,tT,Sp,n),new mU(t)}function vU(t=Ph()){t=Qe(t);const e=ni(t,lh);return e.isInitialized()?e.getImmediate():wU(t)}function wU(t,e={}){const n=ni(t,lh);if(n.isInitialized()){const s=n.getImmediate();if(Jr(e,n.getOptions()))return s;throw Vn.create("already-initialized")}return n.initialize({options:e})}function EU(t,e,n){t=Qe(t),hU(j_,ta[t.app.options.appId],e,n).catch(r=>_n.error(r))}function IU(t,e,n,r){t=Qe(t),dU(j_,ta[t.app.options.appId],e,n,r).catch(s=>_n.error(s))}const rT="@firebase/analytics",sT="0.10.19";function TU(){hr(new Zn(lh,(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("installations-internal").getImmediate();return _U(r,s,n)},"PUBLIC")),hr(new Zn("analytics-internal",t,"PRIVATE")),Rn(rT,sT),Rn(rT,sT,"esm2020");function t(e){try{const n=e.getProvider(lh).getImmediate();return{logEvent:(r,s,i)=>IU(n,r,s,i),setUserProperties:(r,s)=>EU(n,r,s)}}catch(n){throw Vn.create("interop-component-reg-failed",{reason:n})}}}TU();const xU={apiKey:"AIzaSyC70mGCRrjE8iOap8iTHuid8HEuyadue8Y",authDomain:"odontocloud-d92ac.firebaseapp.com",projectId:"odontocloud-d92ac",storageBucket:"odontocloud-d92ac.firebasestorage.app",messagingSenderId:"267020714981",appId:"1:267020714981:web:a44416ea83aa1d1172650c",measurementId:"G-ZMCC5CFY0C"},mf=py(xU),ch=BS(mf),ye=zC(mf);Ii(mf);vU(mf);const bp="TU EMPRESA S.A.S.",SU="Generado por OdontoCloud",Au=()=>{const t=new Date;return t.setHours(0,0,0,0),t},hi=t=>{const e=new Date(t);return e.setHours(0,0,0,0),e},Cp=t=>{const e=new Date(t);return e.setHours(23,59,59,999),e},Er=(t,e)=>{const n=new Date(t);return n.setDate(n.getDate()+e),n},iT=t=>{const e=new Date(t),n=e.getDay(),r=(n===0?-6:1)-n;return e.setDate(e.getDate()+r),e.setHours(0,0,0,0),e},oT=(t,e)=>t.getFullYear()===e.getFullYear()&&t.getMonth()===e.getMonth()&&t.getDate()===e.getDate();var hT;const In=typeof navigator<"u"&&((hT=navigator.language)!=null&&hT.startsWith("es"))?"es-ES":"en-US",Ap=t=>{const e=t.getFullYear(),n=String(t.getMonth()+1).padStart(2,"0"),r=String(t.getDate()).padStart(2,"0");return`${e}-${n}-${r}`},_o=t=>(t||"").toString().toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/\s+/g," ").trim();function bU(){const[t,e]=k.useState("day"),[n,r]=k.useState(Au()),[s,i]=k.useState(Au()),[o,a]=k.useState(!0),[l,d]=k.useState([]),[h,f]=k.useState(""),[m,v]=k.useState(""),[R,b]=k.useState("");k.useEffect(()=>{a(!0);const B=$e(ye,"citas"),ne=rt(B,Yt("fecha","asc")),de=or(ne,Ie=>{const xe=Ie.docs.map(be=>{const re=be.data(),Oe=re.horaInicio||re.hora||"00:00",[it="0",Ge="0"]=Oe.split(":"),ft=parseInt(it,10)||0,q=parseInt(Ge,10)||0;let se;if(re.fecha&&re.fecha.toDate)se=re.fecha.toDate(),se.setHours(ft,q,0,0);else if(typeof re.fecha=="string"){const[he,we,Ne]=re.fecha.split("-");se=new Date(parseInt(he,10),parseInt(we,10)-1,parseInt(Ne,10),ft,q,0,0)}else re.fecha instanceof Date?(se=new Date(re.fecha),se.setHours(ft,q,0,0)):(se=new Date,se.setHours(ft,q,0,0));const X=re.documentoPaciente||re.docPaciente||re.pacienteDocumento||re.documento||"",Q=re.celularPaciente||re.telefonoPaciente||re.celular||re.telefono||"";return{id:be.id,raw:re,fecha:se,horaInicio:Oe,paciente:re.paciente||re.pacienteNombre||"Sin nombre",doctor:re.doctor||re.doctorNombre||"",sucursal:re.sucursal||"",espacio:re.espacio||re.consultorio||"",comentario:re.comentario||"",estado:re.estado||"En espera",recordatorio:re.recordatorio||"",documento:X,telefono:Q}});let ke,ge;if(t==="day")ke=hi(n),ge=Cp(n);else if(t==="week"){const be=iT(n),re=Er(be,6);ke=hi(be),ge=Cp(re)}else{const be=hi(n),re=Er(be,-30),Oe=Er(be,60);ke=hi(re),ge=Cp(Oe)}const Xe=xe.filter(be=>be.fecha>=ke&&be.fecha<=ge);d(Xe),a(!1)},Ie=>{console.error("Error leyendo citas:",Ie),d([]),a(!1)});return()=>de()},[t,n]);const A=k.useMemo(()=>{const B=new Set;return l.forEach(ne=>ne.sucursal&&B.add(ne.sucursal)),Array.from(B)},[l]),I=k.useMemo(()=>{const B=new Set;return l.forEach(ne=>ne.doctor&&B.add(ne.doctor)),Array.from(B)},[l]),w=k.useMemo(()=>{const B=R.trim().toLowerCase();return l.filter(ne=>{if(h&&ne.sucursal!==h||m&&ne.doctor!==m)return!1;if(!B)return!0;const de=[ne.paciente,ne.doctor,ne.comentario,ne.documento,ne.sucursal,ne.espacio,ne.estado],Ie=ne.raw?JSON.stringify(ne.raw):"";return[...de,Ie].filter(Boolean).some(ke=>String(ke).toLowerCase().includes(B))})},[l,h,m,R]),y=k.useMemo(()=>o?"Ocupacin: cargando...":w.length===0?"Ocupacin: sin citas para el rango seleccionado.":`Ocupacin: ${w.length} cita${w.length!==1?"s":""} en el rango actual.`,[w,o]),j=k.useMemo(()=>{const B=new Date(s.getFullYear(),s.getMonth(),1),ne=(B.getDay()+6)%7,de=new Date(B);de.setDate(de.getDate()-ne);const Ie=[];for(let xe=0;xe<6;xe++){const ke=[];for(let ge=0;ge<7;ge++){const Xe=new Date(de),be=Xe.getMonth()===s.getMonth(),re=oT(Xe,Au()),Oe=oT(Xe,n);ke.push({date:Xe,isCurrentMonth:be,isToday:re,isSelected:Oe}),de.setDate(de.getDate()+1)}Ie.push(ke)}return Ie},[s,n]),V=()=>{const B=new Date(s);B.setMonth(B.getMonth()-1),i(B)},M=()=>{const B=new Date(s);B.setMonth(B.getMonth()+1),i(B)},T=B=>{r(hi(B)),i(hi(B)),e("day")},_=k.useMemo(()=>s.toLocaleDateString(In,{month:"long",year:"numeric"}),[s]),S=k.useMemo(()=>{if(t==="day")return n.toLocaleDateString(In,{weekday:"long",day:"2-digit",month:"long",year:"numeric"});if(t==="week"){const B=iT(n),ne=Er(B,6);return B.toLocaleDateString(In,{day:"2-digit",month:"short"})+" - "+ne.toLocaleDateString(In,{day:"2-digit",month:"short",year:"numeric"})}return"ltimas citas (detalle)"},[t,n]),C=()=>{r(t==="day"?Er(n,-1):t==="week"?Er(n,-7):Er(n,-1))},N=()=>{r(t==="day"?Er(n,1):t==="week"?Er(n,7):Er(n,1))},D=()=>{const B=Au();r(B),i(B),e("day")},P=()=>{var it,Ge,ft;const B=q=>String(q??"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),ne=((it=document.querySelector('meta[name="company-name"]'))==null?void 0:it.getAttribute("content"))||bp,de=((Ge=document.querySelector('meta[name="company-logo"]'))==null?void 0:Ge.getAttribute("content"))||"",Ie="Generado por OdontoCloud",xe=w.length===0?'<tr><td colspan="6" style="padding:8px 6px;color:#6b7280">No hay citas registradas para este rango.</td></tr>':w.map(q=>{const se=q.fecha.toLocaleDateString(In),X=q.fecha.toLocaleTimeString(In,{hour:"2-digit",minute:"2-digit",hour12:!0});return`<tr>
              <td>${B(se)}</td>
              <td>${B(X)}</td>
              <td>${B(q.paciente)}</td>
              <td>${B(q.doctor)}</td>
              <td>${B(q.espacio)}</td>
              <td>${B(q.comentario)}</td>
            </tr>`}).join(""),ge=`<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>Imprimir  ${B(ne)}</title>
  <style>
    @page { size: A4 portrait; margin: 18mm; }
    body { font-family: Segoe UI, Roboto, Arial, sans-serif; color:#0f172a; }
    .hdr { display:flex; align-items:center; gap:12px; border-bottom:2px solid #e5e7eb; padding-bottom:8px; margin-bottom:12px; }
    .brand { font-size:18px; font-weight:700; color:#0a86d8; line-height:1.1; }
    .sub { font-size:12px; color:#6b7280; }
    table { width:100%; border-collapse:collapse; font-size:12px; }
    th { text-align:left; background:#f3f4f6; border-bottom:1px solid #e5e7eb; padding:8px 6px; }
    td { border-bottom:1px solid #f1f5f9; padding:7px 6px; vertical-align:top; }
    .note { margin-top:8px; font-size:10px; color:#9ca3af; }
    tr, .hdr { page-break-inside: avoid; }
  </style>
</head>
<body>
  <div class="hdr">
    ${de?`<img src="${de}" alt="Logo" style="height:36px;object-fit:contain">`:""}
    <div>
      <div class="brand">${B(ne)}</div>
      <div class="sub">Agenda de citas  ${B(S)}</div>
    </div>
  </div>

  <table>
    <thead>
      <tr>
        <th style="width:18%">Fecha</th>
        <th style="width:10%">Hora</th>
        <th style="width:22%">Paciente</th>
        <th style="width:20%">Doctor</th>
        <th style="width:15%">Espacio</th>
        <th>Comentario</th>
      </tr>
    </thead>
    <tbody>${xe}</tbody>
  </table>

  <div class="note">${B(Ie)}. ${B(new Date().toLocaleString(In))}</div>
  <script>
    // Imprimir cuando termine de cargar la pestaa (incluye el logo)
    window.addEventListener('load', function() {
      try { window.focus(); window.print(); } catch (e) {}
    });
  <\/script>
</body>
</html>`,Xe=new Blob([ge],{type:"text/html;charset=utf-8"}),be=URL.createObjectURL(Xe),re=window.open(be,"_blank","noopener,noreferrer,width=900,height=700");if(!re){alert("El navegador bloque la ventana de impresin. Permite pop-ups para este sitio."),URL.revokeObjectURL(be);return}const Oe=()=>{try{URL.revokeObjectURL(be)}catch{}};(ft=re.addEventListener)==null||ft.call(re,"load",Oe),setTimeout(Oe,15e3)},Y=()=>alert("Funcin de confirmar citas se integrar con n8n / correo."),Ye=()=>D(),Mt=()=>{if(w.length===0){alert("No hay citas para exportar.");return}const B=[`Empresa: ${bp}`],ne=["Fecha","Hora","Paciente","Doctor","Espacio","Comentario"],de=w.map(re=>{const Oe=re.fecha.toLocaleDateString(In),it=re.fecha.toLocaleTimeString(In,{hour:"2-digit",minute:"2-digit",hour12:!0});return[Oe,it,re.paciente||"",re.doctor||"",re.espacio||"",(re.comentario||"").replace(/\r?\n/g," ")]}),Ie=[SU],xe=[B,[],ne,...de,[],Ie].map(re=>(re||[]).map(Oe=>`"${String(Oe??"").replace(/"/g,'""')}"`).join(",")).join(`
`),ke=`citas_${bp.toLowerCase().replace(/\s+/g,"_")}_${Ap(hi(n))}`+(t==="week"?"_semana":t==="detail"?"_detalle":"")+".csv",ge=new Blob(["\uFEFF"+xe],{type:"text/csv;charset=utf-8;"}),Xe=URL.createObjectURL(ge),be=document.createElement("a");be.href=Xe,be.download=ke,be.click(),URL.revokeObjectURL(Xe)},Zt=async(B,ne)=>{try{const de=Qt(ye,"citas",B);await ea(de,{estado:ne})}catch(de){console.error("Error actualizando estado:",de),alert("No se pudo actualizar el estado de la cita.")}},J=(B,ne)=>{if(!B){alert("Este paciente no tiene celular registrado.");return}const de=String(B).replace(/\D/g,""),Ie=ne.fecha.toLocaleDateString(In),xe=ne.fecha.toLocaleTimeString(In,{hour:"numeric",minute:"2-digit",hour12:!0}),ke=encodeURIComponent(`Hola ${ne.paciente}, le recordamos su cita odontolgica el ${Ie} a las ${xe}. Por favor confirme su asistencia.`),ge=`https://wa.me/${de}?text=${ke}`;window.open(ge,"_blank")},ue=async B=>{if(window.confirm(`Seguro que deseas eliminar la cita de ${B.paciente} del ${B.fecha.toLocaleDateString(In)}?`))try{const de=Qt(ye,"citas",B.id);await nA(de)}catch(de){console.error("Error eliminando cita:",de),alert(" No se pudo eliminar la cita.")}},G=()=>{const B=document.createElement("div");Object.assign(B.style,{position:"fixed",top:"0",left:"0",width:"100%",height:"100%",background:"rgba(0,0,0,0.55)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:"9999"});const ne=document.createElement("div");Object.assign(ne.style,{background:"#fff",padding:"25px 30px",borderRadius:"14px",width:"520px",maxWidth:"95%",maxHeight:"95%",overflowY:"auto",boxShadow:"0 8px 30px rgba(0,0,0,0.3)",fontFamily:"Segoe UI, Roboto, sans-serif"}),ne.innerHTML=`
      <h2 style="margin-top:0;text-align:center;color:#0a86d8;font-weight:600;"> Nueva Cita</h2>
      <form id="formNuevaCita" style="display:flex;flex-direction:column;gap:12px;margin-top:10px;">
        <label style="font-weight:600;">Paciente existente</label>
        <div style="position:relative;">
          <input type="text" id="buscarPaciente" placeholder="Buscar por nombre, apellido o documento..." autocomplete="off"/>
          <div id="acResultados" style="position:absolute;left:0;right:0;top:calc(100% + 6px);z-index:10000;display:none;background:#fff;border:1px solid #ddd;border-radius:8px;box-shadow:0 8px 22px rgba(0,0,0,.12);max-height:240px;overflow:auto;"></div>
        </div>
        <small style="color:gray;">Si el paciente no existe, marca Registrar nuevo paciente.</small>

        <label style="display:flex;align-items:center;gap:8px;margin-top:5px;">
          <input type="checkbox" id="esNuevoPaciente" />
          <span>Registrar nuevo paciente</span>
        </label>

        <div id="nuevoPacienteCampos" style="display:none;flex-direction:column;gap:8px;margin-top:10px;padding:10px;border-radius:8px;background:#f9f9f9;border:1px solid #ddd;">
          <h4 style="margin:0;text-align:center;color:#0a86d8;">Datos del paciente</h4>
          <div style="display:flex;gap:8px;">
            <input type="text" id="npNombre" placeholder="Nombre" style="flex:1;" />
            <input type="text" id="npApellido" placeholder="Apellido" style="flex:1;" />
          </div>
          <select id="npTipoDocumento">
            <option value="">Tipo de documento</option>
            <option value="CC">Cdula de Ciudadana</option>
            <option value="CE">Cdula de Extranjera</option>
            <option value="TI">Tarjeta de Identidad</option>
            <option value="PA">Pasaporte</option>
            <option value="DI">Documento Internacional</option>
            <option value="OTRO">Otro</option>
          </select>
          <input type="text" id="npDocumento" placeholder="Nmero de documento" />
          <input type="email" id="npCorreo" placeholder="Correo electrnico" />
          <div style="display:flex;gap:5px;">
            <select id="npIndicativo" style="width:40%;">
              <option value="+57"> +57</option>
              <option value="+1"> +1</option>
              <option value="+34"> +34</option>
              <option value="+52"> +52</option>
              <option value="+54"> +54</option>
              <option value="+593"> +593</option>
              <option value="+56"> +56</option>
              <option value="+58"> +58</option>
            </select>
            <input type="tel" id="npCelular" placeholder="Celular (obligatorio)" style="flex:1;" />
          </div>
          <input type="tel" id="npTelefono" placeholder="Telfono fijo (opcional)" />
          <label style="font-weight:500;">Fecha de nacimiento:</label>
          <input type="date" id="npNacimiento" />
          <select id="npSexo">
            <option value="">Sexo</option>
            <option value="Masculino">Masculino</option>
            <option value="Femenino">Femenino</option>
            <option value="Otro">Otro</option>
          </select>
          <textarea id="npComentario" placeholder="Comentario o antecedentes del paciente" rows="2"></textarea>
        </div>

        <hr style="margin:10px 0;border:none;border-top:1px solid #ddd;" />
        <h4 style="margin:0;text-align:center;color:#0a86d8;">Detalles de la cita</h4>
        <input type="text" id="ncDoctor" placeholder="Doctor asignado" required />
        <input type="date" id="ncFecha" required value="${Ap(n)}" />
        <input type="time" id="ncHora" required />
        <input type="text" id="ncEspacio" placeholder="Espacio fsico / Sala" />
        <textarea id="ncComentario" placeholder="Comentario sobre la cita" rows="3"></textarea>

        <div style="display:flex;justify-content:flex-end;gap:10px;margin-top:10px;">
          <button type="button" id="btnCancelarModal" class="btn-cancelar">Cancelar</button>
          <button type="submit" class="btn-guardar">Guardar</button>
        </div>
      </form>
    `;const de=document.createElement("style");de.textContent=`
      .btn-cancelar, .btn-guardar { padding: 8px 14px; border: none; border-radius: 6px; cursor: pointer; font-weight: 600; font-size: 14px; transition: .2s; }
      .btn-cancelar { background: #e0e0e0; color: #333; } .btn-cancelar:hover { background: #d5d5d5; }
      .btn-guardar { background: #0a86d8; color: white; } .btn-guardar:hover { background: #0669ac; }
      input, select, textarea { width: 100%; padding: 8px 10px; border: 1px solid #ccc; border-radius: 6px; font-size: 14px; outline: none; }
      input:focus, select:focus, textarea:focus { border-color: #0a86d8; box-shadow: 0 0 0 2px rgba(10,134,216,.2); }
      .ac-item { padding: 8px 10px; display:flex; gap:8px; align-items:baseline; cursor:pointer; }
      .ac-item:hover, .ac-item.active { background:#f5f7fb; }
      .ac-name { font-weight:600; } .ac-doc { color:#64748b; font-size:12px; } .ac-tel { margin-left:auto; font-size:12px; color:#0f172a; }
      .ac-empty { padding:10px; color:#9aa4b2; font-size:13px; }
    `,document.head.appendChild(de),B.appendChild(ne),document.body.appendChild(B);const Ie=ne.querySelector("#esNuevoPaciente"),xe=ne.querySelector("#nuevoPacienteCampos"),ke=ne.querySelector("#buscarPaciente"),ge=ne.querySelector("#acResultados");Ie.addEventListener("change",()=>{xe.style.display=Ie.checked?"flex":"none",Ie.checked&&(ge.style.display="none")}),ne.querySelector("#btnCancelarModal").addEventListener("click",()=>B.remove());let Xe=null,be=null,re=-1,Oe=[];const it=Q=>{if(Oe=Q||[],re=-1,!Q||Q.length===0){ge.innerHTML='<div class="ac-empty">Sin resultados</div>',ge.style.display="block";return}ge.innerHTML=Q.map((he,we)=>`
            <div class="ac-item" data-index="${we}" data-id="${he.id}">
              <span class="ac-name">${he.nombre}</span>
              <span class="ac-doc"> ${he.documento||"s/doc"}</span>
              <span class="ac-tel">${he.celular||he.telefono||""}</span>
            </div>`).join(""),ge.style.display="block",[...ge.querySelectorAll(".ac-item")].forEach(he=>{he.addEventListener("click",()=>{const we=Number(he.getAttribute("data-index"));Ge(we)})})},Ge=Q=>{const he=Oe[Q];he&&(be=he,ke.value=he.nombre,ge.style.display="none",Ie.checked=!1,xe.style.display="none")},ft=Q=>{Oe.length&&(re=(re+Q+Oe.length)%Oe.length,[...ge.querySelectorAll(".ac-item")].forEach((he,we)=>{we===re?he.classList.add("active"):he.classList.remove("active")}))},q=(Q,he)=>Q.nombreCompleto||Q.paciente||[Q.nombres,Q.apellidos].filter(Boolean).join(" ")||he,se=async Q=>{const he=(Q||"").toString().trim(),we=_o(he);if(!we||we.length<2)return[];if(/^\d{5,}$/.test(he))try{const Ne=rt($e(ye,"pacientes"),Je("documento","==",he)),ze=rt($e(ye,"pacientes"),Je("nroDocumento","==",he)),[Se,Fe]=await Promise.all([Gt(Ne),Gt(ze)]),pe=Se.empty?Fe:Se;if(!pe.empty)return pe.docs.slice(0,10).map(He=>{const F=He.data()||{};return{id:He.id,nombre:q(F,He.id),documento:F.documento||F.nroDocumento||He.id,celular:F.celularPaciente||F.celular||"",telefono:F.telefonoPaciente||F.telefono||""}})}catch{}try{const Ne=rt($e(ye,"pacientes"),Yt("nombre_busqueda"),jI(we),OI(we+""),Zo(10)),ze=await Gt(Ne);if(!ze.empty)return ze.docs.map(Se=>{const Fe=Se.data()||{};return{id:Se.id,nombre:q(Fe,Se.id),documento:Fe.documento||Fe.nroDocumento||Se.id,celular:Fe.celularPaciente||Fe.celular||"",telefono:Fe.telefonoPaciente||Fe.telefono||""}})}catch{}try{const Ne=rt($e(ye,"pacientes"),Yt("creado","desc"),Zo(50));return(await Gt(Ne)).docs.map(pe=>({id:pe.id,...pe.data()||{}})).map(pe=>({id:pe.id,nombre:q(pe,pe.id),documento:pe.documento||pe.nroDocumento||pe.id,celular:pe.celularPaciente||pe.celular||"",telefono:pe.telefonoPaciente||pe.telefono||"",_norm:_o(`${pe.nombreCompleto||pe.paciente||""} ${pe.nombres||""} ${pe.apellidos||""} ${pe.documento||pe.nroDocumento||""}`)})).filter(pe=>pe._norm.includes(we)).slice(0,10).map(({_norm:pe,...He})=>He)}catch{}return[]};ke.addEventListener("input",()=>{be=null;const Q=ke.value;if(clearTimeout(Xe),!Q||Q.trim().length<2){ge.style.display="none";return}Xe=setTimeout(async()=>{const he=await se(Q.trim());it(he)},220)}),ke.addEventListener("keydown",Q=>{ge.style.display==="block"&&(Q.key==="ArrowDown"?(Q.preventDefault(),ft(1)):Q.key==="ArrowUp"?(Q.preventDefault(),ft(-1)):Q.key==="Enter"?re>=0&&(Q.preventDefault(),Ge(re)):Q.key==="Escape"&&(ge.style.display="none"))}),document.addEventListener("click",Q=>{ne.contains(Q.target)&&!ge.contains(Q.target)&&Q.target!==ke&&(ge.style.display="none")},{capture:!0});const X=ne.querySelector("#formNuevaCita");X.addEventListener("submit",async Q=>{Q.preventDefault();const he=Ie.checked,we=(X.querySelector("#buscarPaciente").value||"").trim(),Ne=X.querySelector("#ncDoctor").value.trim(),ze=X.querySelector("#ncFecha").value,Se=X.querySelector("#ncHora").value,Fe=X.querySelector("#ncEspacio").value.trim(),pe=X.querySelector("#ncComentario").value.trim();if(!ze||!Se){alert(" Debes seleccionar fecha y hora para la cita.");return}if(!Ne){alert(" Indica el doctor asignado.");return}try{let He=null,F=null,Z="",ae="",Ce="";if(he){const ie=(X.querySelector("#npNombre").value||"").trim(),Ee=(X.querySelector("#npApellido").value||"").trim();if(Z=`${ie} ${Ee}`.trim(),!Z){alert(" Debes indicar nombre y apellido para el nuevo paciente.");return}const me=(X.querySelector("#npDocumento").value||"").trim(),Ae=(X.querySelector("#npCelular").value||"").trim(),Ct=(X.querySelector("#npTelefono").value||"").trim();if(!Ae&&!Ct){alert(" Debes registrar al menos un telfono (celular o fijo) del paciente o de un acudiente.");return}if(He=me||Z.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/\s+/g,"_"),F=Qt(ye,"pacientes",He),!(await ih(F)).exists()){const Ve=_o(Z);await oh(F,{nombres:ie,apellidos:Ee,nombreCompleto:Z,paciente:Z,nombre_busqueda:Ve,variantes_busqueda:[Ve,_o(ie),_o(Ee)],tipoDocumento:X.querySelector("#npTipoDocumento").value,documento:me,correo:(X.querySelector("#npCorreo").value||"").trim(),indicativo:X.querySelector("#npIndicativo").value,celular:Ae,telefono:Ct,celularPaciente:Ae,telefonoPaciente:Ct,fechaNacimiento:X.querySelector("#npNacimiento").value,sexo:X.querySelector("#npSexo").value,notas:(X.querySelector("#npComentario").value||"").trim(),creado:new Date().toISOString(),activo:!0,citas:[]},{merge:!0})}ae=Ae,Ce=Ct}else if(be)He=be.id,Z=be.nombre,F=Qt(ye,"pacientes",He),ae=be.celular||"",Ce=be.telefono||"";else{if(!we){alert(" Por favor, escribe o selecciona un paciente.");return}const ie=rt($e(ye,"pacientes"),Je("documento","==",we)),Ee=rt($e(ye,"pacientes"),Je("nroDocumento","==",we)),[me,Ae]=await Promise.all([Gt(ie),Gt(Ee)]),Ct=me.empty?Ae:me;if(Ct.empty){let St=null;try{const Ve=_o(we),At=rt($e(ye,"pacientes"),Yt("nombre_busqueda"),jI(Ve),OI(Ve+""),Zo(1)),Ft=await Gt(At);if(!Ft.empty){const en=Ft.docs[0],En=en.data()||{};St={id:en.id,ref:en.ref,nombre:En.nombreCompleto||En.paciente||[En.nombres,En.apellidos].filter(Boolean).join(" "),cel:En.celularPaciente||En.celular||"",tel:En.telefonoPaciente||En.telefono||""}}}catch{}St?(He=St.id,F=St.ref,Z=St.nombre||we,ae=St.cel||"",Ce=St.tel||""):Z=we}else{const St=Ct.docs[0],Ve=St.data()||{};He=St.id,F=St.ref,Z=Ve.nombreCompleto||Ve.paciente||[Ve.nombres,Ve.apellidos].filter(Boolean).join(" ")||we,ae=Ve.celularPaciente||Ve.celular||"",Ce=Ve.telefonoPaciente||Ve.telefono||""}}if(!(ae||Ce||"").trim()){alert(" Este paciente no tiene ningn telfono registrado. Edita sus datos y agrega un nmero antes de guardar la cita.");return}const x={paciente:Z||"Paciente",pacienteId:He||null,doctor:Ne,fecha:ze,horaInicio:Se,espacio:Fe,comentario:pe,estado:"En espera",creado:new Date().toISOString(),celularPaciente:ae||"",telefonoPaciente:Ce||""},z=await wl($e(ye,"citas"),x);F&&await oh(F,{citas:VM(z.id)},{merge:!0}),alert(" Cita registrada correctamente y vinculada al paciente."),B.remove()}catch(He){console.error(" Error al guardar cita:",He),alert(" Error al guardar la cita. Revisa la consola para ms detalles.")}})},je=B=>{var Xe,be;const ne=document.createElement("div");Object.assign(ne.style,{position:"fixed",top:"0",left:"0",width:"100%",height:"100%",background:"rgba(0,0,0,0.55)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:"9999"});const de=document.createElement("div");Object.assign(de.style,{background:"#fff",padding:"25px 30px",borderRadius:"14px",width:"520px",maxWidth:"95%",maxHeight:"95%",overflowY:"auto",boxShadow:"0 8px 30px rgba(0,0,0,0.3)",fontFamily:"Segoe UI, Roboto, sans-serif"});const Ie=(Xe=B.raw)!=null&&Xe.fecha&&typeof B.raw.fecha=="string"?B.raw.fecha:Ap(B.fecha),xe=((be=B.raw)==null?void 0:be.horaInicio)||B.fecha.toTimeString().slice(0,5);de.innerHTML=`
      <h2 style="margin-top:0;text-align:center;color:#0a86d8;font-weight:600;"> Editar Cita</h2>
      <form id="formEditarCita" style="display:flex;flex-direction:column;gap:12px;margin-top:10px;">
        <label>Paciente</label>
        <input type="text" id="editPaciente" value="${B.paciente||""}" />

        <label>Doctor asignado</label>
        <input type="text" id="editDoctor" value="${B.doctor||""}" />

        <div style="display:flex;gap:8px;">
          <div style="flex:1;">
            <label>Fecha</label>
            <input type="date" id="editFecha" value="${Ie}" />
          </div>
          <div style="flex:1;">
            <label>Hora</label>
            <input type="time" id="editHora" value="${xe}" />
          </div>
        </div>

        <label>Espacio fsico / Sala</label>
        <input type="text" id="editEspacio" value="${B.espacio||""}" />

        <label>Estado</label>
        <select id="editEstado" className="estado-select">
          <option value="En espera" ${B.estado==="En espera"?"selected":""}>En espera</option>
          <option value="En sala" ${B.estado==="En sala"?"selected":""}>En sala</option>
          <option value="Atendiendo" ${B.estado==="Atendiendo"?"selected":""}>Atendiendo</option>
          <option value="Finalizada" ${B.estado==="Finalizada"?"selected":""}>Finalizada</option>
          <option value="pendiente" ${B.estado==="pendiente"?"selected":""}>Pendiente</option>
          <option value="No asisti" ${B.estado==="No asisti"?"selected":""}>No asisti</option>
        </select>

        <label>Comentario</label>
        <textarea id="editComentario" rows="3">${B.comentario||""}</textarea>

        <div style="display:flex;justify-content:flex-end;gap:10px;margin-top:10px;">
          <button type="button" id="btnCancelarEdit" className="btn-cancelar">Cancelar</button>
          <button type="submit" className="btn-guardar">Guardar cambios</button>
        </div>
      </form>
    `;const ke=document.createElement("style");ke.textContent=`
      .btn-cancelar, .btn-guardar { padding: 8px 14px; border: none; border-radius: 6px; cursor: pointer; font-weight: 600; font-size: 14px; transition: .2s; }
      .btn-cancelar { background: #e0e0e0; color: #333; } .btn-cancelar:hover { background: #d5d5d5; }
      .btn-guardar { background: #0a86d8; color: white; } .btn-guardar:hover { background: #0669ac; }
      #formEditarCita input, #formEditarCita select, #formEditarCita textarea { width: 100%; padding: 8px 10px; border: 1px solid #ccc; border-radius: 6px; font-size: 14px; outline: none; }
      #formEditarCita input:focus, #formEditarCita select:focus, #formEditarCita textarea:focus { border-color: #0a86d8; box-shadow: 0 0 0 2px rgba(10,134,216,.2); }
    `,document.head.appendChild(ke),ne.appendChild(de),document.body.appendChild(ne),de.querySelector("#btnCancelarEdit").addEventListener("click",()=>ne.remove());const ge=de.querySelector("#formEditarCita");ge.addEventListener("submit",async re=>{re.preventDefault();const Oe=ge.querySelector("#editPaciente").value.trim(),it=ge.querySelector("#editDoctor").value.trim(),Ge=ge.querySelector("#editFecha").value,ft=ge.querySelector("#editHora").value,q=ge.querySelector("#editEspacio").value.trim(),se=ge.querySelector("#editEstado").value,X=ge.querySelector("#editComentario").value.trim();if(!Oe)return alert(" El nombre del paciente es obligatorio.");if(!Ge||!ft)return alert(" Debes indicar fecha y hora.");try{const Q=Qt(ye,"citas",B.id);await ea(Q,{paciente:Oe,doctor:it,fecha:Ge,horaInicio:ft,espacio:q,estado:se,comentario:X}),alert(" Cita actualizada correctamente."),ne.remove()}catch(Q){console.error(" Error al actualizar cita:",Q),alert(" Error al actualizar la cita. Revisa la consola para ms detalles.")}})},Ke=B=>{const ne=B.fecha.toLocaleDateString(In),de=B.fecha.toLocaleTimeString(In,{hour:"numeric",minute:"2-digit",hour12:!0}),Ie=`${ne}  ${de}`;return u.jsxs("tr",{className:"fade-in-row",onClick:()=>je(B),style:{cursor:"pointer"},children:[u.jsx("td",{children:Ie}),u.jsx("td",{children:B.paciente}),u.jsx("td",{children:B.doctor}),u.jsx("td",{children:B.espacio}),u.jsx("td",{children:B.comentario}),u.jsx("td",{onClick:xe=>{xe.stopPropagation()},children:u.jsxs("select",{className:"estado-select",value:B.estado,onChange:xe=>Zt(B.id,xe.target.value),children:[u.jsx("option",{value:"En espera",children:"En espera"}),u.jsx("option",{value:"En sala",children:"En sala"}),u.jsx("option",{value:"Atendiendo",children:"Atendiendo"}),u.jsx("option",{value:"Finalizada",children:"Finalizada"}),u.jsx("option",{value:"pendiente",children:"Pendiente"}),u.jsx("option",{value:"No asisti",children:"No asisti"})]})}),u.jsxs("td",{className:"acciones-cell",onClick:xe=>{xe.stopPropagation()},children:[B.telefono?u.jsx("button",{type:"button",className:"btn-whatsapp",onClick:xe=>{xe.stopPropagation(),J(B.telefono,B)},children:"WhatsApp"}):u.jsx("span",{className:"acciones-texto",children:"Sin celular"}),u.jsx("button",{type:"button",className:"btn-delete",onClick:xe=>{xe.stopPropagation(),ue(B)},children:"Eliminar"}),B.recordatorio&&u.jsx("span",{className:"acciones-texto",children:B.recordatorio})]})]},B.id)};return u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"odc-topbar-green"}),u.jsx("div",{className:"odc-topbar-blue",children:"Agenda"}),u.jsx("section",{className:"odc-agenda-root",children:u.jsxs("div",{className:"odc-agenda-inner",children:[u.jsxs("aside",{className:"odc-left","aria-label":"Panel izquierdo - calendario y filtros",children:[u.jsxs("div",{className:"odc-mini-calendar-card",role:"region","aria-label":"Mini calendario",children:[u.jsxs("div",{className:"mini-cal-header",children:[u.jsx("button",{className:"cal-arrow",id:"miniCalPrev","aria-label":"Mes anterior",onClick:V,children:""}),u.jsx("div",{id:"miniCalMonthYear","aria-live":"polite",children:_}),u.jsx("button",{className:"cal-arrow",id:"miniCalNext","aria-label":"Mes siguiente",onClick:M,children:""})]}),u.jsxs("table",{className:"mini-month-table","aria-hidden":"false",children:[u.jsx("thead",{children:u.jsxs("tr",{children:[u.jsx("th",{children:"Lu"}),u.jsx("th",{children:"Ma"}),u.jsx("th",{children:"Mi"}),u.jsx("th",{children:"Ju"}),u.jsx("th",{children:"Vi"}),u.jsx("th",{children:"Sa"}),u.jsx("th",{children:"Do"})]})}),u.jsx("tbody",{id:"miniCalendar",children:j.map((B,ne)=>u.jsx("tr",{children:B.map((de,Ie)=>u.jsx("td",{className:[de.isCurrentMonth?"":"empty",de.isToday?"today":"",de.isSelected?"selected":""].filter(Boolean).join(" "),onClick:()=>de.isCurrentMonth&&T(de.date),children:de.date.getDate()},Ie))},ne))})]})]}),u.jsxs("div",{className:"odc-filters-card","aria-label":"Filtros de agenda",children:[u.jsx("label",{htmlFor:"filterSucursal",children:"Sucursal"}),u.jsxs("select",{id:"filterSucursal",value:h,onChange:B=>f(B.target.value),children:[u.jsx("option",{value:"",children:" Todas "}),A.map(B=>u.jsx("option",{value:B,children:B},B))]}),u.jsx("label",{htmlFor:"filterDoctor",children:"Doctores"}),u.jsxs("select",{id:"filterDoctor",value:m,onChange:B=>v(B.target.value),children:[u.jsx("option",{value:"",children:" Todos "}),I.map(B=>u.jsx("option",{value:B,children:B},B))]})]})]}),u.jsxs("main",{className:"odc-right","aria-label":"Panel principal - agenda",children:[u.jsxs("div",{className:"odc-header-bar",role:"region","aria-label":"Controles de la agenda",style:{display:"flex",alignItems:"center",justifyContent:"space-between",gap:12},children:[u.jsxs("div",{className:"odc-header-left",style:{display:"flex",alignItems:"center",gap:12,flexWrap:"wrap"},children:[u.jsx("h3",{className:"odc-title",style:{marginRight:8},children:"Agenda"}),u.jsxs("div",{className:"view-buttons",role:"tablist","aria-label":"Vistas",style:{display:"flex",gap:6},children:[u.jsx("button",{className:`btn view ${t==="day"?"active":""}`,"data-view":"day",role:"tab","aria-selected":t==="day",onClick:()=>e("day"),children:"Da"}),u.jsx("button",{className:`btn view ${t==="week"?"active":""}`,"data-view":"week",role:"tab","aria-selected":t==="week",onClick:()=>e("week"),children:"Semana"}),u.jsx("button",{className:`btn view ${t==="detail"?"active":""}`,"data-view":"detail",role:"tab","aria-selected":t==="detail",onClick:()=>e("detail"),children:"Detalle"})]}),u.jsxs("div",{className:"date-nav",style:{display:"flex",alignItems:"center",gap:6,flex:"0 0 auto"},children:[u.jsx("button",{className:"btn icon",id:"btnPrev","aria-label":"Anterior",onClick:C,children:""}),u.jsx("button",{className:"btn icon",id:"btnNext","aria-label":"Siguiente",onClick:N,children:""}),u.jsx("span",{id:"currentDateDisplay",className:"current-date","aria-live":"polite",style:{whiteSpace:"nowrap"},children:S}),u.jsx("button",{id:"btnHoy",className:"btn small",onClick:D,children:"Hoy"})]})]}),u.jsx("div",{className:"odc-header-right",style:{display:"flex",alignItems:"center",gap:8,flexShrink:0},children:u.jsxs("div",{className:"right-actions",style:{display:"flex",alignItems:"center",gap:8},children:[u.jsx("input",{id:"searchCitas",placeholder:"Buscar...",className:"search-input","aria-label":"Buscar citas",value:R,onChange:B=>b(B.target.value)}),u.jsx("button",{id:"btnNuevaCita",className:"btn green","aria-label":"Nueva cita",onClick:G,children:"+ Nueva cita"})]})})]}),u.jsxs("div",{className:"odc-content-card",role:"region","aria-label":"Contenido agenda",children:[u.jsxs("div",{className:"tools-row",children:[u.jsx("div",{className:"tools-left",children:u.jsx("div",{id:"ocupacionInfo",className:"ocupacion-info",children:y})}),u.jsxs("div",{className:"tools-right",children:[u.jsx("button",{id:"btnPrint",className:"btn",title:"Imprimir agenda",onClick:P,children:" Imprimir"}),u.jsx("button",{id:"btnConfirmar",className:"btn blue",title:"Confirmar citas",onClick:Y,children:" Confirmar"}),u.jsx("button",{id:"btnHoyCitas",className:"btn",title:"Ver citas de hoy",onClick:Ye,children:" Hoy"}),u.jsx("button",{id:"btnExportar",className:"btn",title:"Exportar citas a CSV",onClick:Mt,children:" Exportar"})]})]}),u.jsx("div",{className:"table-wrap",role:"region","aria-label":"Lista de citas",children:u.jsxs("table",{className:"appointments-table","aria-live":"polite",children:[u.jsx("thead",{children:u.jsxs("tr",{children:[u.jsx("th",{style:{width:"180px"},children:"Fecha / Hora"}),u.jsx("th",{children:"Paciente"}),u.jsx("th",{children:"Doctor"}),u.jsx("th",{children:"Espacio fsico"}),u.jsx("th",{children:"Comentario"}),u.jsx("th",{style:{width:"120px"},children:"Estado"}),u.jsx("th",{children:"Acciones"})]})}),u.jsx("tbody",{id:"citasTbody",children:o?u.jsx("tr",{children:u.jsx("td",{colSpan:7,className:"no-data",children:"Cargando citas..."})}):w.length===0?u.jsx("tr",{children:u.jsx("td",{colSpan:7,className:"no-data",children:"No hay citas registradas para este rango."})}):w.map(Ke)})]})})]})]})]})})]})}function CU(){return u.jsxs("div",{style:{padding:"20px"},children:[u.jsx("h2",{children:"Mdulo de Facturacin"}),u.jsx("p",{children:"Aqu se registrarn los pagos, facturas y cobros."})]})}function AU(){return u.jsxs("div",{style:{padding:"20px"},children:[u.jsx("h2",{children:"Mdulo de Facturacin"}),u.jsx("p",{children:"Aqu se registrarn los pagos, facturas y cobros."})]})}function RU(){return u.jsxs("div",{style:{padding:"20px"},children:[u.jsx("h2",{children:"Mdulo de Facturacin"}),u.jsx("p",{children:"Aqu se registrarn los pagos, facturas y cobros."})]})}const Ru={caja:"caja",pagos:"facturacion/pagos",facturas:"facturacion/facturas"};var fT;const Pu=typeof navigator<"u"&&((fT=navigator.language)!=null&&fT.startsWith("es"))?"es-ES":"en-US",PU=["Colombia","Argentina","Bolivia","Chile","Costa Rica","Cuba","Ecuador","El Salvador","Espaa","Guatemala","Honduras","Mxico","Nicaragua","Panam","Paraguay","Per","Puerto Rico","Repblica Dominicana","Uruguay","Venezuela","Estados Unidos","Canad"],aT={Colombia:["Bogot","Medelln","Cali","Barranquilla","Cartagena","Ccuta","Bucaramanga","Pereira","Santa Marta","Ibagu"],Mxico:["Ciudad de Mxico","Guadalajara","Monterrey","Puebla","Quertaro","Tijuana","Mrida","Len"],Per:["Lima","Arequipa","Trujillo","Chiclayo","Cusco","Piura"],Chile:["Santiago","Valparaso","Concepcin","La Serena","Antofagasta"],Argentina:["Buenos Aires","Crdoba","Rosario","Mendoza","La Plata"],Espaa:["Madrid","Barcelona","Valencia","Sevilla","Zaragoza","Bilbao"],"Estados Unidos":["Miami","New York","Los ngeles","Houston","Chicago"],Ecuador:["Quito","Guayaquil","Cuenca","Manta"],Venezuela:["Caracas","Maracaibo","Valencia","Barquisimeto","Maracay"]},kU=t=>{if(!t)return"";const[e,n,r]=t.split("-").map(l=>parseInt(l,10)),s=new Date(e,(n||1)-1,r||1),i=new Date;let o=i.getFullYear()-s.getFullYear();const a=i.getMonth()-s.getMonth();return(a<0||a===0&&i.getDate()<s.getDate())&&o--,isNaN(o)?"":String(o)};async function lT(t,{maxW:e=900,maxH:n=900,quality:r=.82}={}){var m;if(!t||!((m=t.type)!=null&&m.startsWith("image/")))return t;const s=await new Promise((v,R)=>{const b=new Image;b.onload=()=>v(b),b.onerror=R,b.src=URL.createObjectURL(t)});let{width:i,height:o}=s;const a=Math.min(e/i,n/o,1);i=Math.round(i*a),o=Math.round(o*a);const l=document.createElement("canvas");l.width=i,l.height=o,l.getContext("2d").drawImage(s,0,0,i,o);const h=await new Promise(v=>l.toBlob(v,"image/jpeg",r)),f=new File([h],(t.name||"foto.jpg").replace(/\.[^.]+$/,".jpg"),{type:"image/jpeg",lastModified:Date.now()});return URL.revokeObjectURL(s.src),f}const El=t=>(t||"").toString().toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/\s+/g," ").trim(),NU=t=>El([t.nombres,t.apellidos,t.nombreCompleto,t.nroDocumento,t.celular,t.email].filter(Boolean).join(" ")),vo={tipoDocumento:"",nroDocumento:"",nroHistoria:"",nombres:"",apellidos:"",nombreCompleto:"",sexo:"",estadoCivil:"",paisNacimiento:"",ciudadNacimiento:"",fechaIngreso:"",fechaNacimiento:"",edad:"",paisDomicilio:"",ciudadDomicilio:"",barrio:"",lugarResidencia:"",estrato:"",zonaResidencial:"",esExtranjero:!1,permitePublicidad:!1,celular:"",telDomicilio:"",telOficina:"",extension:"",email:"",ocupacion:"",nombreResponsable:"",parentesco:"",celularResponsable:"",telefonoResponsable:"",emailResponsable:"",nombreAcompanante:"",telefonoAcompanante:"",convenioBeneficio:"",comoConocio:"",campania:"",remitidoPor:"",asesorComercial:"",tipoVinculacion:"",nombreEps:"",polizaSalud:"",doctor:"",notas:"",rxImagenes:[],historiaClinica:{antecedentes:"",alergias:"",medicamentos:"",motivoConsulta:"",notas:""},odontograma:[],periodontograma:[],presupuestos:[],evoluciones:[],facturacion:{saldoFavor:0,saldoCredito:0},fotoUrl:"",activo:!0},Rp=20,wo=t=>Number(t||0);function DU(t){const[e,n]=k.useState(!1),[r,s]=k.useState([]),[i,o]=k.useState([]),[a,l]=k.useState("");k.useEffect(()=>{let A=!0;return(async()=>{if(!t){s([]),o([]);return}n(!0),l("");try{let w=rt($e(ye,"facturas"),Je("patientId","==",t),Yt("fechaISO","desc"));const V=(await Gt(w)).docs.map(C=>({id:C.id,...C.data()})).map(C=>({...C,total:wo(C.total??C.valor??C.montoTotal),estado:(C.estado||"pendiente").toLowerCase(),fechaISO:C.fechaISO||C.fecha||null}));let M=rt($e(ye,"pagos"),Je("patientId","==",t),Yt("fechaISO","desc"));const S=(await Gt(M)).docs.map(C=>({id:C.id,...C.data()})).map(C=>({...C,monto:wo(C.monto??C.valor??C.total),fechaISO:C.fechaISO||C.fecha||null,medio:C.medio||C.metodo||""}));if(!A)return;s(V),o(S)}catch(w){console.warn("Finanzas: no se pudo leer colecciones. Contino solo con saldos del paciente.",w),A&&l("No se pudieron leer facturas/pagos.")}finally{A&&n(!1)}})(),()=>{A=!1}},[t]);const d=r.reduce((A,I)=>A+wo(I.total),0),h=i.reduce((A,I)=>A+wo(I.monto),0),f=r.filter(A=>["pagada","pagado","paid"].includes((A.estado||"").toLowerCase())),m=r.filter(A=>["pendiente","abierta","open","deuda"].includes((A.estado||"").toLowerCase())),v=f.reduce((A,I)=>A+wo(I.total),0),R=m.reduce((A,I)=>A+wo(I.total),0);return{loading:e,error:a,facturas:r,pagos:i,totalFacturado:d,totalPagado:h,totalFacturasPagadas:v,totalFacturasPendientes:R}}function jU(t){const[e,n]=k.useState(!1),[r,s]=k.useState([]);return k.useEffect(()=>{let i=!0;return(async()=>{if(!t){s([]);return}n(!0);try{const a=rt($e(ye,"citas"),Je("patientId","==",t),Yt("fechaISO","desc"));let d=(await Gt(a)).docs.map(h=>({id:h.id,...h.data()}));if(d.length===0){const h=rt($e(ye,"citas"),Je("pacienteId","==",t),Yt("fechaISO","desc"));d=(await Gt(h)).docs.map(m=>({id:m.id,...m.data()}))}i&&s(d)}catch(a){console.warn("No se pudieron leer citas:",a),i&&s([])}finally{i&&n(!1)}})(),()=>{i=!1}},[t]),{loading:e,citas:r}}function OU(){var Se,Fe,pe,He,F,Z,ae,Ce,_t;const t=Sc(),e=Lr(),n=xT.useMemo(()=>{const x=e.pathname.split("/").filter(Boolean),z=x.findIndex(me=>["pacientes","agenda","caja","facturacion","config","reportes","software"].includes(me)),Ee="/"+x.slice(0,z>=0?z:x.length).join("/");return Ee==="/"?"":Ee},[e.pathname]),r=x=>{const z=String(x||"").replace(/^\//,""),ie=n?`${n}/`:"/";t(`${ie}${z}`)},s=(x,z)=>{const ie=String(x).replace(/^\//,""),Ee=z?new URLSearchParams(z).toString():"";return`${n?`${n}/`:"/"}${ie}${Ee?`?${Ee}`:""}`},[i,o]=k.useState(!0),[a,l]=k.useState([]),[d,h]=k.useState(""),[f,m]=k.useState(null),[v,R]=k.useState(!0),[b,A]=k.useState(!1),[I,w]=k.useState(null),[y,j]=k.useState(null),V=k.useRef(null),[M,T]=k.useState("datos"),[_,S]=k.useState(vo),[C,N]=k.useState(null),[D,P]=k.useState(""),[Y,Ye]=k.useState([]),[Mt,Zt]=k.useState(!1),J=k.useRef(null),ue=k.useMemo(()=>aT[_.paisNacimiento]||[],[_.paisNacimiento]);k.useEffect(()=>((async()=>{o(!0);try{const ie=(await Gt($e(ye,"eps"))).docs.map(me=>{var Ae;return(Ae=me.data())==null?void 0:Ae.nombre}).filter(Boolean),Ee=Array.from(new Map(ie.map(me=>[String(me).toLowerCase(),me])).values()).sort((me,Ae)=>me.localeCompare(Ae,"es"));Ye(Ee),await B(!0)}catch(z){console.error(z),alert("No se pudieron cargar pacientes/EPS.")}finally{o(!1)}})(),()=>{V.current&&(V.current(),V.current=null)}),[]),k.useEffect(()=>{S(x=>({...x,nombreCompleto:`${x.nombres} ${x.apellidos}`.trim()}))},[_.nombres,_.apellidos]),k.useEffect(()=>{S(x=>({...x,nroHistoria:x.nroDocumento}))},[_.nroDocumento]),k.useEffect(()=>{S(x=>({...x,edad:kU(x.fechaNacimiento)}))},[_.fechaNacimiento]),k.useEffect(()=>{const x=new Date,z=x.toLocaleDateString(Pu)+" - "+x.toLocaleTimeString(Pu,{hour:"2-digit",minute:"2-digit",hour12:!0});S(ie=>({...ie,fechaIngreso:z}))},[]);const G=(x,z)=>S(ie=>({...ie,[x]:z})),je=()=>{S(vo);const x=new Date,z=x.toLocaleDateString(Pu)+" - "+x.toLocaleTimeString(Pu,{hour:"2-digit",minute:"2-digit",hour12:!0});S(ie=>({...ie,fechaIngreso:z})),N(null),P(""),w(null)},Ke=async x=>{if(!x){N(null),P("");return}try{const z=await lT(x,{maxW:900,maxH:900,quality:.82});N(z);const ie=new FileReader;ie.onload=Ee=>P(Ee.target.result),ie.readAsDataURL(z)}catch{N(x);const z=new FileReader;z.onload=ie=>P(ie.target.result),z.readAsDataURL(x)}},B=async(x=!1)=>{o(!0);try{let z;x||!f?z=rt($e(ye,"pacientes"),Yt("creado","desc"),Zo(Rp)):z=rt($e(ye,"pacientes"),Yt("creado","desc"),PM(f),Zo(Rp));const ie=await Gt(z),Ee=ie.docs.map(me=>({id:me.id,...me.data()}));l(x?Ee:me=>[...me,...Ee]),m(ie.docs[ie.docs.length-1]||null),R(ie.size===Rp)}catch(z){console.error(z),alert("No se pudo cargar pacientes.")}finally{o(!1)}},ne=async x=>{if(x.preventDefault(),!_.nroDocumento.trim())return alert("El nmero de documento es obligatorio.");if(!_.nombres.trim())return alert("Los nombres son obligatorios.");if(!_.apellidos.trim())return alert("Los apellidos son obligatorios.");if(!_.sexo.trim())return alert("El sexo es obligatorio.");if(!_.fechaNacimiento.trim())return alert("La fecha de nacimiento es obligatoria.");if(!_.celular.trim())return alert("El celular es obligatorio.");if(!_.email.trim())return alert("El correo electrnico es obligatorio.");if(!_.tipoVinculacion.trim())return alert("El tipo de vinculacin es obligatorio.");if(!_.nombreEps.trim())return alert("El nombre de la EPS es obligatorio.");try{const z=_.nroDocumento.trim();if(!I&&(await ih(Qt(ye,"pacientes",z))).exists())return alert("Ya existe un paciente con ese nmero de documento.");const ie=(_.nombreEps||"").trim(),Ee=Y.map(At=>At.toLowerCase()).includes(ie.toLowerCase());if(ie&&!Ee&&window.confirm(`La EPS "${ie}" no existe. Deseas guardarla para futuras selecciones?`)){const Ft=ie.toLowerCase().replace(/\s+/g,"_");await oh(Qt(ye,"eps",Ft),{nombre:ie,nombreLower:ie.toLowerCase(),creado:$n()},{merge:!0})}let me=_.fotoUrl||"",Ae="";if(C)try{const At=Ii(),Ft=(C.name||"foto.jpg").replace(/\s+/g,"_");Ae=`pacientes/${z}/${Date.now()}_${Ft}`;const en=ll(At,Ae),En={contentType:C.type||"image/jpeg",cacheControl:"public, max-age=86400"};await HI(en,C,En),me=await KI(en)}catch(At){console.error("Foto (warning):",At)}const Ct=_.creado||null,St=I&&Ct||$n(),Ve={..._,fotoUrl:me,nombre_busqueda:NU({..._,fotoUrl:me}),nombresLower:El(_.nombres),apellidosLower:El(_.apellidos),documentoLower:El(_.nroDocumento),emailLower:El(_.email),creado:St,createdAt:St,actualizado:$n(),updatedAt:$n(),activo:_.activo??!0,celularPaciente:_.celular,telefonoPaciente:_.telDomicilio||"",documento:_.nroDocumento,paciente:_.nombreCompleto};if(await oh(Qt(ye,"pacientes",z),Ve,{merge:!0}),Ae)try{const At=Ii(),Ft=ll(At,`pacientes/${z}`),en=await WI(Ft),En=Ae,gf=en.items.filter(yr=>yr.fullPath!==En).map(yr=>Ep(yr).catch(()=>null));await Promise.allSettled(gf)}catch(At){console.warn("No se pudo limpiar fotos antiguas:",At)}alert(I?" Paciente actualizado.":" Paciente guardado."),l(At=>{const Ft=At.filter(en=>en.id!==z);return[{id:z,...Ve},...Ft]}),A(!1),w(null),je()}catch(z){console.error("Error guardando paciente:",z),alert(`No se pudo guardar el paciente.

`+((z==null?void 0:z.message)||z))}},de=()=>{je(),A(!0)},Ie=()=>{y&&(S({...vo,...y,fotoUrl:y.fotoUrl||""}),N(null),P(y.fotoUrl||""),w(y.id),Xe(),A(!0))},xe=async x=>{if(window.confirm(`Eliminar al paciente "${x.nombreCompleto}"?`))try{await nA(Qt(ye,"pacientes",x.id)),l(z=>z.filter(ie=>ie.id!==x.id));try{const z=Ii(),ie=ll(z,`pacientes/${x.id}`),me=(await WI(ie)).items.map(Ae=>Ep(Ae).catch(()=>null));await Promise.allSettled(me)}catch(z){console.warn("No se pudo borrar la carpeta de fotos:",z)}}catch(z){console.error(z),alert("No se pudo eliminar.")}},ke=k.useMemo(()=>{const x=d.trim().toLowerCase();return x?a.filter(z=>`${z.nombreCompleto||z.paciente||""} ${z.nroDocumento||""} ${z.celular||z.celularPaciente||""} ${z.email||""}`.toLowerCase().includes(x)):a},[a,d]),ge=x=>{Xe();const z=Qt(ye,"pacientes",x.id),ie=or(z,Ee=>{Ee.exists()?j({id:Ee.id,...be(Ee.data())}):j(null)});V.current=ie,T("datos")},Xe=()=>{V.current&&(V.current(),V.current=null),j(null)},be=x=>({...vo,...x,historiaClinica:{...vo.historiaClinica,...x.historiaClinica||{}},facturacion:{...vo.facturacion,...x.facturacion||{}},rxImagenes:Array.isArray(x.rxImagenes)?x.rxImagenes:[],odontograma:Array.isArray(x.odontograma)?x.odontograma:[],periodontograma:Array.isArray(x.periodontograma)?x.periodontograma:[],presupuestos:Array.isArray(x.presupuestos)?x.presupuestos:[],evoluciones:Array.isArray(x.evoluciones)?x.evoluciones:[]}),re=async x=>{if(y!=null&&y.id)try{await ea(Qt(ye,"pacientes",y.id),{...x,actualizado:$n(),updatedAt:$n()})}catch(z){console.error(z),alert("No se pudo actualizar.")}},Oe=async x=>{var ie;if(!(y!=null&&y.id)||!(x!=null&&x.length))return;const z=Ii();try{Zt(!0);const Ee=[];for(const me of x){let Ae=me;if((ie=me.type)!=null&&ie.startsWith("image/"))try{Ae=await lT(me,{maxW:1600,maxH:1600,quality:.85})}catch{Ae=me}const Ct=(Ae.name||"archivo").replace(/\s+/g,"_"),St=`pacientes/${y.id}/rx/${Date.now()}_${Ct}`,Ve=ll(z,St),At={contentType:Ae.type||"application/octet-stream",cacheControl:"public, max-age=31536000"};await HI(Ve,Ae,At);const Ft=await KI(Ve);Ee.push({url:Ft,name:me.name,type:me.type,size:me.size||0,created:Date.now(),path:St})}await re({rxImagenes:[...y.rxImagenes||[],...Ee]})}catch(Ee){console.error("RX upload error:",Ee);const me=`No se pudo subir el/los archivo(s).
 Verifica que el usuario est autenticado.
 Revisa reglas de Storage para permitir escribir en 'pacientes/{id}/**'.
 Si usas Emulador, confirma que el bucket coincida.

`+((Ee==null?void 0:Ee.message)||"");alert(me)}finally{Zt(!1);try{J.current&&(J.current.value="")}catch{}}},it=async x=>{if(!(y!=null&&y.id))return;const z=y.rxImagenes[x],ie=y.rxImagenes.filter((Ee,me)=>me!==x);await re({rxImagenes:ie});try{if(z!=null&&z.path){const Ee=Ii();await Ep(ll(Ee,z.path))}}catch(Ee){console.warn("No se pudo borrar del Storage:",Ee)}},Ge=(x,z)=>{const ie={...y.historiaClinica||{},[x]:z};re({historiaClinica:ie})},ft=x=>{const z=[...y.presupuestos||[],{id:String(Date.now()),...x}];re({presupuestos:z})},q=x=>{re({presupuestos:(y.presupuestos||[]).filter(z=>z.id!==x)})},se=x=>{const z=[...y.evoluciones||[],{id:String(Date.now()),fechaISO:new Date().toISOString(),nota:x}];re({evoluciones:z})},X=x=>{re({evoluciones:(y.evoluciones||[]).filter(z=>z.id!==x)})},Q=(x,z)=>{const ie=Array.isArray(y[x])?y[x]:[],Ee=ie.find(Ae=>Ae.pieza===z);let me;Ee?me=ie.filter(Ae=>Ae.pieza!==z):me=[...ie,{pieza:z,estado:"marcada"}],re({[x]:me})},he=(y==null?void 0:y.id)||null,we=DU(he),{loading:Ne,citas:ze}=jU(he);return u.jsxs("div",{className:"odc-container",children:[u.jsx("div",{className:"odc-topbar-green"}),u.jsx("div",{className:"odc-topbar-blue",children:u.jsx("div",{className:"odc-top-inner",children:u.jsx("div",{className:"odc-breadcrumbs",children:"Pacientes"})})}),u.jsxs("div",{className:"odc-card",children:[u.jsxs("div",{className:"odc-card-header",children:[u.jsx("h3",{className:"odc-title",children:"Pacientes"}),u.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[u.jsx("input",{className:"search-input",style:{minWidth:280},placeholder:"Buscar por nombre, documento o telfono",value:d,onChange:x=>h(x.target.value)}),u.jsx("button",{type:"button",className:"btn green",onClick:de,children:"+ Nuevo paciente"})]})]}),u.jsx("div",{className:"table-wrap",children:u.jsxs("table",{className:"appointments-table",children:[u.jsx("thead",{children:u.jsxs("tr",{children:[u.jsx("th",{children:"Foto"}),u.jsx("th",{children:"Nombre"}),u.jsx("th",{children:"Documento"}),u.jsx("th",{children:"Celular"}),u.jsx("th",{children:"Correo"}),u.jsx("th",{children:"Estado"})]})}),u.jsx("tbody",{children:i&&a.length===0?u.jsx("tr",{children:u.jsx("td",{className:"no-data",colSpan:6,children:"Cargando"})}):ke.length===0?u.jsx("tr",{children:u.jsx("td",{className:"no-data",colSpan:6,children:"No hay pacientes o no coinciden con la bsqueda."})}):ke.map(x=>u.jsxs("tr",{className:"row-click",onClick:()=>ge(x),children:[u.jsx("td",{onClick:z=>z.stopPropagation(),children:x.fotoUrl?u.jsx("img",{src:x.fotoUrl,alt:"Foto",style:{width:36,height:36,borderRadius:"50%",objectFit:"cover"}}):u.jsx("div",{className:"avatar-fallback",children:(x.nombreCompleto||"P")[0]})}),u.jsx("td",{children:x.nombreCompleto||x.paciente||""}),u.jsx("td",{children:x.nroDocumento||x.documento||""}),u.jsx("td",{children:x.celular||x.celularPaciente||""}),u.jsx("td",{children:x.email||""}),u.jsx("td",{children:u.jsx("span",{className:"pill pill-ok",children:x.activo?"Activo":"Inactivo"})})]},x.id))})]})}),u.jsxs("div",{className:"footer-actions",children:[u.jsx("button",{type:"button",className:"btn",disabled:i||!v,onClick:()=>B(!1),children:v?"Cargar ms":"No hay ms"}),u.jsxs("div",{className:"hint",children:[a.length," registros cargados"]})]})]}),b&&u.jsxs("div",{className:"odc-modal",role:"dialog","aria-modal":"true",children:[u.jsx("div",{className:"odc-modal-backdrop",onClick:()=>A(!1)}),u.jsxs("div",{className:"odc-card",style:{width:1e3,maxWidth:"95%",maxHeight:"92vh",overflowY:"auto"},children:[u.jsxs("div",{className:"odc-card-header",children:[u.jsx("h3",{className:"odc-title",children:I?"Editar paciente":"Nuevo paciente"}),u.jsx("button",{type:"button",className:"btn",onClick:()=>A(!1),children:""})]}),u.jsxs("form",{onSubmit:ne,children:[u.jsx("div",{className:"form-section-title",children:"Foto del paciente"}),u.jsxs("div",{className:"foto-row",children:[u.jsxs("label",{className:"foto-drop",children:[u.jsx("input",{type:"file",accept:"image/*",onChange:x=>{var z;return Ke(((z=x.target.files)==null?void 0:z[0])||null)},style:{display:"none"}}),D?u.jsx("img",{src:D,alt:"Preview",className:"foto-preview"}):u.jsx("div",{className:"foto-empty",children:"Arrastra o haz clic para cargar"})]}),D&&u.jsx("button",{type:"button",className:"btn",onClick:()=>Ke(null),children:"Quitar foto"})]}),u.jsx("div",{className:"form-section-title",children:"Datos de identificacin"}),u.jsxs("div",{className:"form-grid",children:[u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Tipo de documento *"}),u.jsxs("select",{className:"form-input",value:_.tipoDocumento,onChange:x=>G("tipoDocumento",x.target.value),children:[u.jsx("option",{value:"",children:"Seleccione"}),u.jsx("option",{value:"CC",children:"Cdula"}),u.jsx("option",{value:"TI",children:"Tarjeta de identidad"}),u.jsx("option",{value:"PA",children:"Pasaporte"}),u.jsx("option",{value:"OTRO",children:"Otro"})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Nro. de documento *"}),u.jsx("input",{className:"form-input",value:_.nroDocumento,onChange:x=>G("nroDocumento",x.target.value),placeholder:"Nmero de documento",required:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Nmero de Historia"}),u.jsx("input",{className:"form-input",value:_.nroHistoria,readOnly:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Nombres *"}),u.jsx("input",{className:"form-input",value:_.nombres,onChange:x=>G("nombres",x.target.value),required:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Apellidos *"}),u.jsx("input",{className:"form-input",value:_.apellidos,onChange:x=>G("apellidos",x.target.value),required:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Nombre completo"}),u.jsx("input",{className:"form-input",value:_.nombreCompleto,readOnly:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Sexo *"}),u.jsxs("select",{className:"form-input",value:_.sexo,onChange:x=>G("sexo",x.target.value),required:!0,children:[u.jsx("option",{value:"",children:"Seleccione"}),u.jsx("option",{children:"Masculino"}),u.jsx("option",{children:"Femenino"}),u.jsx("option",{children:"Otro"})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Estado civil *"}),u.jsxs("select",{className:"form-input",value:_.estadoCivil,onChange:x=>G("estadoCivil",x.target.value),required:!0,children:[u.jsx("option",{value:"",children:"Seleccione"}),u.jsx("option",{children:"Soltero"}),u.jsx("option",{children:"Casado"}),u.jsx("option",{children:"Unin libre"}),u.jsx("option",{children:"Divorciado"}),u.jsx("option",{children:"Viudo"})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Pas de nacimiento *"}),u.jsx("input",{className:"form-input",list:"listCountries",value:_.paisNacimiento,onChange:x=>G("paisNacimiento",x.target.value),placeholder:"Escribe y elige",required:!0}),u.jsx("datalist",{id:"listCountries",children:PU.map(x=>u.jsx("option",{value:x},x))})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Ciudad de nacimiento"}),u.jsx("input",{className:"form-input",list:"listCitiesBirth",value:_.ciudadNacimiento,onChange:x=>G("ciudadNacimiento",x.target.value),placeholder:"Escribe y elige"}),u.jsx("datalist",{id:"listCitiesBirth",children:ue.map(x=>u.jsx("option",{value:x},x))})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Fecha de ingreso"}),u.jsx("input",{className:"form-input",value:_.fechaIngreso,readOnly:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Fecha de nacimiento *"}),u.jsx("input",{type:"date",className:"form-input",value:_.fechaNacimiento,onChange:x=>G("fechaNacimiento",x.target.value),required:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Edad"}),u.jsx("input",{className:"form-input",value:_.edad,readOnly:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Pas de domicilio *"}),u.jsx("input",{className:"form-input",list:"listCountries",value:_.paisDomicilio,onChange:x=>G("paisDomicilio",x.target.value),required:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Ciudad de domicilio *"}),u.jsx("input",{className:"form-input",list:"listCitiesHome",value:_.ciudadDomicilio,onChange:x=>G("ciudadDomicilio",x.target.value),required:!0}),u.jsx("datalist",{id:"listCitiesHome",children:(aT[_.paisDomicilio]||[]).map(x=>u.jsx("option",{value:x},x))})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Barrio *"}),u.jsx("input",{className:"form-input",value:_.barrio,onChange:x=>G("barrio",x.target.value),required:!0,placeholder:"Barrio"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Lugar de residencia *"}),u.jsx("input",{className:"form-input",value:_.lugarResidencia,onChange:x=>G("lugarResidencia",x.target.value),required:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Estrato"}),u.jsxs("select",{className:"form-input",value:_.estrato,onChange:x=>G("estrato",x.target.value),children:[u.jsx("option",{value:"",children:"Seleccione"}),u.jsx("option",{children:"1"}),u.jsx("option",{children:"2"}),u.jsx("option",{children:"3"}),u.jsx("option",{children:"4"}),u.jsx("option",{children:"5"}),u.jsx("option",{children:"6"})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Zona residencial *"}),u.jsxs("select",{className:"form-input",value:_.zonaResidencial,onChange:x=>G("zonaResidencial",x.target.value),required:!0,children:[u.jsx("option",{value:"",children:"Seleccione"}),u.jsx("option",{children:"Urbana"}),u.jsx("option",{children:"Rural"})]})]}),u.jsxs("div",{className:"checkbox-cell",children:[u.jsx("label",{className:"form-label",children:"Es extranjero?"}),u.jsx("input",{type:"checkbox",checked:_.esExtranjero,onChange:x=>G("esExtranjero",x.target.checked)})]}),u.jsxs("div",{className:"checkbox-cell",children:[u.jsx("label",{className:"form-label",children:"Permite publicidad?"}),u.jsx("input",{type:"checkbox",checked:_.permitePublicidad,onChange:x=>G("permitePublicidad",x.target.checked)})]})]}),u.jsx("div",{className:"form-section-title",children:"Contacto"}),u.jsxs("div",{className:"form-grid",children:[u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Celular *"}),u.jsx("input",{className:"form-input",value:_.celular,onChange:x=>G("celular",x.target.value),required:!0,placeholder:"Celular del paciente"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Telfono de domicilio"}),u.jsx("input",{className:"form-input",value:_.telDomicilio,onChange:x=>G("telDomicilio",x.target.value)})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Telfono de oficina"}),u.jsx("input",{className:"form-input",value:_.telOficina,onChange:x=>G("telOficina",x.target.value)})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Extensin"}),u.jsx("input",{className:"form-input",value:_.extension,onChange:x=>G("extension",x.target.value)})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Correo electrnico *"}),u.jsx("input",{type:"email",className:"form-input",value:_.email,onChange:x=>G("email",x.target.value),required:!0,placeholder:"correo@dominio.com"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Ocupacin *"}),u.jsx("input",{className:"form-input",value:_.ocupacion,onChange:x=>G("ocupacion",x.target.value),required:!0})]})]}),u.jsx("div",{className:"form-section-title",children:"Datos de facturacin"}),u.jsxs("div",{className:"form-grid",children:[u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Responsable"}),u.jsx("input",{className:"form-input",value:_.nombreResponsable,onChange:x=>G("nombreResponsable",x.target.value)})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Parentesco"}),u.jsxs("select",{className:"form-input",value:_.parentesco,onChange:x=>G("parentesco",x.target.value),children:[u.jsx("option",{value:"",children:"Seleccione"}),u.jsx("option",{children:"Padre/Madre"}),u.jsx("option",{children:"Hermano"}),u.jsx("option",{children:"Esposo/a"}),u.jsx("option",{children:"Otro"})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Celular"}),u.jsx("input",{className:"form-input",value:_.celularResponsable,onChange:x=>G("celularResponsable",x.target.value)})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Telfono"}),u.jsx("input",{className:"form-input",value:_.telefonoResponsable,onChange:x=>G("telefonoResponsable",x.target.value)})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Correo electrnico"}),u.jsx("input",{type:"email",className:"form-input",value:_.emailResponsable,onChange:x=>G("emailResponsable",x.target.value)})]})]}),u.jsx("div",{className:"form-section-title",children:"Acompaante"}),u.jsxs("div",{className:"form-grid",children:[u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Nombre"}),u.jsx("input",{className:"form-input",value:_.nombreAcompanante,onChange:x=>G("nombreAcompanante",x.target.value),placeholder:"Nombre acompaante"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Telfono"}),u.jsx("input",{className:"form-input",value:_.telefonoAcompanante,onChange:x=>G("telefonoAcompanante",x.target.value),placeholder:"Telfono acompaante"})]})]}),u.jsx("div",{className:"form-section-title",children:"Mercadeo"}),u.jsxs("div",{className:"form-grid",children:[u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Convenio beneficio"}),u.jsx("input",{className:"form-input",value:_.convenioBeneficio,onChange:x=>G("convenioBeneficio",x.target.value)})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Cmo nos conoci?"}),u.jsxs("select",{className:"form-input",value:_.comoConocio,onChange:x=>G("comoConocio",x.target.value),children:[u.jsx("option",{value:"",children:"Seleccione"}),u.jsx("option",{children:"Redes sociales"}),u.jsx("option",{children:"Publicidad"}),u.jsx("option",{children:"Recomendacin"}),u.jsx("option",{children:"Otro"})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Campaa"}),u.jsx("input",{className:"form-input",value:_.campania,onChange:x=>G("campania",x.target.value)})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Remitido por"}),u.jsx("input",{className:"form-input",value:_.remitidoPor,onChange:x=>G("remitidoPor",x.target.value)})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Asesor comercial"}),u.jsx("input",{className:"form-input",value:_.asesorComercial,onChange:x=>G("asesorComercial",x.target.value)})]})]}),u.jsx("div",{className:"form-section-title",children:"EPS"}),u.jsxs("div",{className:"form-grid",children:[u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Tipo de vinculacin *"}),u.jsxs("select",{className:"form-input",value:_.tipoVinculacion,onChange:x=>G("tipoVinculacion",x.target.value),required:!0,children:[u.jsx("option",{value:"",children:"Seleccione"}),u.jsx("option",{children:"Contributivo"}),u.jsx("option",{children:"Subsidiado"}),u.jsx("option",{children:"Particular"}),u.jsx("option",{children:"Otro"})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Nombre de la EPS *"}),u.jsx("input",{className:"form-input",list:"listEps",value:_.nombreEps,onChange:x=>G("nombreEps",x.target.value),placeholder:"Escribe y selecciona",required:!0}),u.jsx("datalist",{id:"listEps",children:Y.map(x=>u.jsx("option",{value:x},x))})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Pliza de salud"}),u.jsx("input",{className:"form-input",value:_.polizaSalud,onChange:x=>G("polizaSalud",x.target.value)})]})]}),u.jsx("div",{className:"form-section-title",children:"Doctor"}),u.jsx("div",{className:"form-grid",children:u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Doctor"}),u.jsx("input",{className:"form-input",value:_.doctor,onChange:x=>G("doctor",x.target.value),placeholder:"Usuario / Libre"})]})}),u.jsx("div",{className:"form-section-title",children:"Alertas y Notas"}),u.jsx("div",{className:"form-grid",children:u.jsx("textarea",{className:"form-input",rows:3,value:_.notas,onChange:x=>G("notas",x.target.value),placeholder:"Notas del paciente"})}),u.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:8,marginTop:12},children:[I?u.jsx("button",{type:"button",className:"btn",onClick:()=>xe({id:I,nombreCompleto:_.nombreCompleto}),children:"Eliminar"}):u.jsx("div",{}),u.jsxs("div",{style:{display:"flex",gap:8},children:[u.jsx("button",{type:"button",className:"btn",onClick:()=>A(!1),children:"Cancelar"}),u.jsx("button",{type:"submit",className:"btn blue",children:I?"Actualizar":"Guardar paciente"})]})]})]})]})]}),y&&u.jsxs("div",{className:"odc-modal",role:"dialog","aria-modal":"true",children:[u.jsx("div",{className:"odc-modal-backdrop",onClick:Xe}),u.jsxs("div",{className:"odc-card ficha-card",children:[u.jsxs("div",{className:"ficha-header",children:[u.jsxs("div",{className:"ficha-header-left",children:[y.fotoUrl?u.jsx("img",{src:y.fotoUrl,alt:"Foto",className:"ficha-avatar"}):u.jsx("div",{className:"avatar-fallback ficha-avatar-fallback",children:(y.nombreCompleto||"P")[0]}),u.jsxs("div",{children:[u.jsx("div",{className:"ficha-nombre",children:y.nombreCompleto||""}),u.jsxs("div",{className:"ficha-doc",children:[y.tipoDocumento||""," ",y.nroDocumento||""]}),u.jsxs("div",{className:"ficha-badges",children:[u.jsx("span",{className:"ficha-badge blue",children:"En valoracin"}),u.jsx("span",{className:"ficha-badge green",children:"Sin deuda"})]})]})]}),u.jsx("div",{className:"ficha-header-right",children:u.jsxs("div",{className:"ficha-actions",children:[u.jsx("button",{type:"button",className:"btn",onClick:Xe,children:"Cerrar"}),u.jsx("button",{type:"button",className:"btn blue",onClick:Ie,children:"Editar"}),u.jsx("button",{type:"button",className:"btn green",onClick:()=>t(s(Ru.caja,{cobro:1,patientId:y.id})),title:"Ir a Caja para cobrar a este paciente",children:"Cobrar"})]})})]}),u.jsxs("div",{className:"ficha-body",children:[u.jsxs("aside",{className:"ficha-sidebar",children:[u.jsx("div",{className:"ficha-sidebar-title",children:"Informacin general"}),u.jsx("button",{type:"button",className:`ficha-link ${M==="datos"?"active":""}`,onClick:()=>T("datos"),children:"Datos personales"}),u.jsx("button",{type:"button",className:`ficha-link ${M==="marketing"?"active":""}`,onClick:()=>T("marketing"),children:"Marketing"}),u.jsx("button",{type:"button",className:`ficha-link ${M==="eps"?"active":""}`,onClick:()=>T("eps"),children:"EPS"}),u.jsx("button",{type:"button",className:`ficha-link ${M==="prof"?"active":""}`,onClick:()=>T("prof"),children:"Profesionales"}),u.jsx("button",{type:"button",className:`ficha-link ${M==="rx"?"active":""}`,onClick:()=>T("rx"),children:"Rx/Imgenes/Doc"}),u.jsx("button",{type:"button",className:`ficha-link ${M==="citas"?"active":""}`,onClick:()=>T("citas"),children:"Citas"}),u.jsx("button",{type:"button",className:`ficha-link ${M==="crm"?"active":""}`,onClick:()=>T("crm"),children:"CRM"}),u.jsx("div",{className:"ficha-sidebar-title mt",children:"Historia clnica"}),u.jsx("button",{type:"button",className:`ficha-link ${M==="doc"?"active":""}`,onClick:()=>T("doc"),children:"Doc. Clnicos"}),u.jsx("button",{type:"button",className:`ficha-link ${M==="odonto"?"active":""}`,onClick:()=>T("odonto"),children:"Odontogramas"}),u.jsx("button",{type:"button",className:`ficha-link ${M==="perio"?"active":""}`,onClick:()=>T("perio"),children:"Periodontogramas"}),u.jsx("button",{type:"button",className:`ficha-link ${M==="presu"?"active":""}`,onClick:()=>T("presu"),children:"Presupuestos"}),u.jsx("button",{type:"button",className:`ficha-link ${M==="evo"?"active":""}`,onClick:()=>T("evo"),children:"Evoluciones"}),u.jsx("div",{className:"ficha-sidebar-title mt",children:"Facturacin"}),u.jsx("button",{type:"button",className:`ficha-link ${M==="fact"?"active":""}`,onClick:()=>T("fact"),children:"Resumen"}),u.jsxs("div",{className:"ficha-sidebar-actions",style:{display:"grid",gap:8,marginTop:8},children:[u.jsx("button",{type:"button",className:"btn pay",onClick:()=>t(s(Ru.caja,{cobro:1,patientId:y.id})),title:"Cobrar a este paciente",children:"Realizar pago"}),u.jsx("button",{type:"button",className:"btn history",onClick:()=>r(`${Ru.pagos}?patientId=${encodeURIComponent(y.id)}`),title:"Ver histrico de pagos",children:"Histrico de pagos"}),u.jsx("button",{type:"button",className:"btn history",onClick:()=>r(`${Ru.facturas}?patientId=${encodeURIComponent(y.id)}`),title:"Ver histrico de facturacin",children:"Histrico de facturacin"})]})]}),u.jsxs("main",{className:"ficha-content",children:[M==="datos"&&u.jsxs("section",{className:"ficha-section",children:[u.jsx("h4",{className:"ficha-section-title",children:"Datos personales"}),u.jsx("div",{className:"ficha-grid",children:[["Tipo de documento",y.tipoDocumento],["Nro. de documento",y.nroDocumento],["Nmero de Historia",y.nroHistoria],["Fecha de ingreso",y.fechaIngreso],["Nombres",y.nombres],["Apellidos",y.apellidos],["Nombre completo",y.nombreCompleto],["Sexo",y.sexo],["Estado civil",y.estadoCivil],["Pas de nacimiento",y.paisNacimiento],["Ciudad de nacimiento",y.ciudadNacimiento],["Fecha de nacimiento",y.fechaNacimiento],["Edad",y.edad],["Pas de domicilio",y.paisDomicilio],["Ciudad de domicilio",y.ciudadDomicilio],["Barrio",y.barrio],["Lugar de residencia",y.lugarResidencia],["Estrato",y.estrato],["Zona residencial",y.zonaResidencial],["Extranjero",y.esExtranjero?"S":"No"],["Permite publicidad",y.permitePublicidad?"S":"No"],["Celular",y.celular||y.celularPaciente],["Telfono domicilio",y.telDomicilio||y.telefonoPaciente],["Telfono oficina",y.telOficina],["Extensin",y.extension],["Correo electrnico",y.email],["Ocupacin",y.ocupacion],["Responsable",y.nombreResponsable],["Parentesco",y.parentesco],["Cel. responsable",y.celularResponsable],["Tel. responsable",y.telefonoResponsable],["Email responsable",y.emailResponsable],["Acompaante",y.nombreAcompanante],["Tel. acompaante",y.telefonoAcompanante]].map(([x,z])=>u.jsxs("div",{className:"field",children:[u.jsx("label",{children:x}),u.jsx("input",{className:"form-input",value:z||"",readOnly:!0})]},x))})]}),M==="marketing"&&u.jsxs("section",{className:"ficha-section",children:[u.jsx("h4",{className:"ficha-section-title",children:"Marketing"}),u.jsx("div",{className:"ficha-grid",children:[["Convenio beneficio",y.convenioBeneficio],["Cmo nos conoci?",y.comoConocio],["Campaa",y.campania],["Remitido por",y.remitidoPor],["Asesor comercial",y.asesorComercial]].map(([x,z])=>u.jsxs("div",{className:"field",children:[u.jsx("label",{children:x}),u.jsx("input",{className:"form-input",value:z||"",readOnly:!0})]},x))})]}),M==="eps"&&u.jsxs("section",{className:"ficha-section",children:[u.jsx("h4",{className:"ficha-section-title",children:"EPS"}),u.jsx("div",{className:"ficha-grid",children:[["Tipo de vinculacin",y.tipoVinculacion],["Nombre EPS",y.nombreEps],["Pliza de salud",y.polizaSalud]].map(([x,z])=>u.jsxs("div",{className:"field",children:[u.jsx("label",{children:x}),u.jsx("input",{className:"form-input",value:z||"",readOnly:!0})]},x))})]}),M==="prof"&&u.jsxs("section",{className:"ficha-section",children:[u.jsx("h4",{className:"ficha-section-title",children:"Profesionales"}),u.jsx("div",{className:"ficha-grid",children:u.jsxs("div",{className:"field",children:[u.jsx("label",{children:"Doctor"}),u.jsx("input",{className:"form-input",value:y.doctor||"",readOnly:!0})]})})]}),M==="rx"&&u.jsxs("section",{className:"ficha-section",children:[u.jsx("h4",{className:"ficha-section-title",children:"Rx / Imgenes / Documentos"}),u.jsxs("div",{className:"rx-actions",children:[u.jsxs("label",{className:"btn blue",children:["Subir archivos",u.jsx("input",{ref:J,type:"file",multiple:!0,accept:"image/*,.pdf,.doc,.docx,.xls,.xlsx",style:{display:"none"},onChange:x=>Oe([...x.target.files||[]])})]}),Mt&&u.jsx("span",{className:"hint",style:{marginLeft:10},children:"Subiendo"})]}),u.jsxs("div",{className:"rx-grid",children:[(y.rxImagenes||[]).map((x,z)=>{var ie;return u.jsxs("div",{className:"rx-item",children:[(ie=x.type)!=null&&ie.startsWith("image/")?u.jsx("a",{href:x.url,target:"_blank",rel:"noreferrer",children:u.jsx("img",{src:x.url,alt:x.name})}):u.jsx("a",{className:"rx-file",href:x.url,target:"_blank",rel:"noreferrer",children:x.name||"archivo"}),u.jsxs("div",{className:"rx-meta",children:[u.jsx("span",{children:x.name}),u.jsx("button",{type:"button",className:"btn small",onClick:()=>it(z),children:"Eliminar"})]})]},`${x.url}-${z}`)}),(!y.rxImagenes||y.rxImagenes.length===0)&&u.jsx("div",{className:"no-data",children:"Sin archivos an."})]})]}),M==="doc"&&u.jsxs("section",{className:"ficha-section",children:[u.jsx("h4",{className:"ficha-section-title",children:"Doc. Clnicos"}),u.jsxs("div",{className:"ficha-grid",children:[u.jsxs("div",{className:"field",children:[u.jsx("label",{children:"Motivo de consulta"}),u.jsx("textarea",{className:"form-input",rows:3,value:((Se=y.historiaClinica)==null?void 0:Se.motivoConsulta)||"",onChange:x=>Ge("motivoConsulta",x.target.value)})]}),u.jsxs("div",{className:"field",children:[u.jsx("label",{children:"Antecedentes"}),u.jsx("textarea",{className:"form-input",rows:3,value:((Fe=y.historiaClinica)==null?void 0:Fe.antecedentes)||"",onChange:x=>Ge("antecedentes",x.target.value)})]}),u.jsxs("div",{className:"field",children:[u.jsx("label",{children:"Alergias"}),u.jsx("textarea",{className:"form-input",rows:2,value:((pe=y.historiaClinica)==null?void 0:pe.alergias)||"",onChange:x=>Ge("alergias",x.target.value)})]}),u.jsxs("div",{className:"field",children:[u.jsx("label",{children:"Medicamentos"}),u.jsx("textarea",{className:"form-input",rows:2,value:((He=y.historiaClinica)==null?void 0:He.medicamentos)||"",onChange:x=>Ge("medicamentos",x.target.value)})]}),u.jsxs("div",{className:"field",children:[u.jsx("label",{children:"Notas"}),u.jsx("textarea",{className:"form-input",rows:3,value:((F=y.historiaClinica)==null?void 0:F.notas)||"",onChange:x=>Ge("notas",x.target.value)})]})]})]}),M==="odonto"&&u.jsxs("section",{className:"ficha-section",children:[u.jsx("h4",{className:"ficha-section-title",children:"Odontograma (placeholder)"}),u.jsx("div",{className:"odont-grid",children:Array.from({length:32},(x,z)=>z+1).map(x=>{const z=(y.odontograma||[]).some(ie=>ie.pieza===x);return u.jsx("button",{type:"button",className:`tooth ${z?"on":""}`,onClick:()=>Q("odontograma",x),title:`Pieza ${x}`,children:x},x)})})]}),M==="perio"&&u.jsxs("section",{className:"ficha-section",children:[u.jsx("h4",{className:"ficha-section-title",children:"Periodontograma (placeholder)"}),u.jsx("div",{className:"odont-grid",children:Array.from({length:32},(x,z)=>z+1).map(x=>{const z=(y.periodontograma||[]).some(ie=>ie.pieza===x);return u.jsx("button",{type:"button",className:`tooth ${z?"on":""}`,onClick:()=>Q("periodontograma",x),title:`Pieza ${x}`,children:x},x)})})]}),M==="presu"&&u.jsxs("section",{className:"ficha-section",children:[u.jsx("h4",{className:"ficha-section-title",children:"Presupuestos & planes"}),u.jsx(VU,{onAdd:ft}),u.jsxs("div",{className:"presu-list",children:[(y.presupuestos||[]).map(x=>u.jsxs("div",{className:"presu-item",children:[u.jsxs("div",{children:[u.jsx("div",{className:"presu-title",children:x.titulo}),u.jsxs("div",{className:"presu-meta",children:["Costo: $",x.costo||0,"  Estado: ",x.estado||"Pendiente"]})]}),u.jsx("button",{type:"button",className:"btn small",onClick:()=>q(x.id),children:"Eliminar"})]},x.id)),(!y.presupuestos||y.presupuestos.length===0)&&u.jsx("div",{className:"no-data",children:"Sin presupuestos an."})]})]}),M==="evo"&&u.jsxs("section",{className:"ficha-section",children:[u.jsx("h4",{className:"ficha-section-title",children:"Evoluciones & Remisiones"}),u.jsx(LU,{onAdd:se}),u.jsxs("div",{className:"evo-list",children:[(y.evoluciones||[]).map(x=>u.jsxs("div",{className:"evo-item",children:[u.jsx("div",{className:"evo-date",children:new Date(x.fechaISO).toLocaleString()}),u.jsx("div",{className:"evo-note",children:x.nota}),u.jsx("button",{type:"button",className:"btn small",onClick:()=>X(x.id),children:"Eliminar"})]},x.id)),(!y.evoluciones||y.evoluciones.length===0)&&u.jsx("div",{className:"no-data",children:"Sin evoluciones an."})]})]}),M==="fact"&&u.jsxs("section",{className:"ficha-section",children:[u.jsx("h4",{className:"ficha-section-title",children:"Facturacin"}),u.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(220px,1fr))",gap:12},children:[u.jsx(Eo,{title:"Total facturado",value:`$ ${we.totalFacturado.toLocaleString()}`}),u.jsx(Eo,{title:"Total pagado",value:`$ ${we.totalPagado.toLocaleString()}`}),u.jsx(Eo,{title:"Facturas pendientes",value:`$ ${we.totalFacturasPendientes.toLocaleString()}`}),u.jsx(Eo,{title:"Saldo pendiente (facturas - pagos)",value:`$ ${(we.totalFacturado-we.totalPagado).toLocaleString()}`}),u.jsx(Eo,{title:"Saldo a favor",value:`$ ${(((Z=y.facturacion)==null?void 0:Z.saldoFavor)??0).toLocaleString()}`}),u.jsx(Eo,{title:"Saldo crdito",value:`$ ${(((ae=y.facturacion)==null?void 0:ae.saldoCredito)??0).toLocaleString()}`})]}),we.error&&u.jsxs("div",{className:"hint",style:{marginTop:6},children:[" ",we.error]}),u.jsxs("div",{className:"ficha-grid",style:{marginTop:12},children:[u.jsxs("div",{className:"field",children:[u.jsx("label",{children:"Saldo a favor"}),u.jsx("input",{type:"number",className:"form-input",value:((Ce=y.facturacion)==null?void 0:Ce.saldoFavor)??0,onChange:x=>re({facturacion:{...y.facturacion||{},saldoFavor:Number(x.target.value||0)}})})]}),u.jsxs("div",{className:"field",children:[u.jsx("label",{children:"Saldo crdito"}),u.jsx("input",{type:"number",className:"form-input",value:((_t=y.facturacion)==null?void 0:_t.saldoCredito)??0,onChange:x=>re({facturacion:{...y.facturacion||{},saldoCredito:Number(x.target.value||0)}})})]})]})]}),M==="citas"&&u.jsxs("section",{className:"ficha-section",children:[u.jsx("h4",{className:"ficha-section-title",children:"Citas"}),u.jsx("div",{className:"table-wrap",children:u.jsxs("table",{className:"appointments-table",children:[u.jsx("thead",{children:u.jsxs("tr",{children:[u.jsx("th",{children:"Fecha"}),u.jsx("th",{children:"Estado"}),u.jsx("th",{children:"Motivo"}),u.jsx("th",{children:"Profesional / Acciones"})]})}),u.jsx("tbody",{children:Ne?u.jsx("tr",{children:u.jsx("td",{className:"no-data",colSpan:4,children:"Cargando"})}):ze.length===0?u.jsx("tr",{children:u.jsx("td",{className:"no-data",colSpan:4,children:"Sin citas registradas."})}):ze.map(x=>u.jsxs("tr",{children:[u.jsx("td",{children:x.fechaISO?new Date(x.fechaISO).toLocaleString():""}),u.jsx("td",{children:x.estado||""}),u.jsx("td",{children:x.motivo||""}),u.jsx("td",{children:u.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[u.jsx("span",{children:x.profesional||""}),u.jsx("button",{type:"button",className:"btn small",onClick:()=>{const z=x.fechaISO?new Date(x.fechaISO):null,ie=z?z.toISOString().slice(0,10):"";r(`agenda?date=${encodeURIComponent(ie)}&patientId=${encodeURIComponent(y.id)}`)},title:"Abrir en Agenda",children:"Ver en Agenda"})]})})]},x.id))})]})})]}),M==="crm"&&u.jsxs("section",{className:"ficha-section",children:[u.jsx("h4",{className:"ficha-section-title",children:"CRM"}),u.jsx("div",{className:"no-data",children:"Notas / recordatorios comerciales del paciente."})]}),u.jsx("div",{className:"ficha-footer"})]})]})]})]})]})}function Eo({title:t,value:e}){return u.jsxs("div",{className:"mini-card",children:[u.jsx("div",{className:"mini-card-title",children:t}),u.jsx("div",{style:{fontWeight:700,fontSize:20,marginTop:6},children:e})]})}function VU({onAdd:t}){const[e,n]=k.useState(""),[r,s]=k.useState(""),[i,o]=k.useState("Pendiente");return u.jsxs("div",{className:"presu-form",children:[u.jsx("input",{className:"form-input",placeholder:"Procedimiento / plan",value:e,onChange:a=>n(a.target.value)}),u.jsx("input",{type:"number",className:"form-input",placeholder:"Costo",value:r,onChange:a=>s(a.target.value)}),u.jsxs("select",{className:"form-input",value:i,onChange:a=>o(a.target.value),children:[u.jsx("option",{children:"Pendiente"}),u.jsx("option",{children:"Aprobado"}),u.jsx("option",{children:"Rechazado"})]}),u.jsx("button",{type:"button",className:"btn blue",onClick:()=>{if(!e)return alert("Ttulo requerido");t({titulo:e,costo:Number(r||0),estado:i}),n(""),s(""),o("Pendiente")},children:"Agregar"})]})}function LU({onAdd:t}){const[e,n]=k.useState("");return u.jsxs("div",{className:"evo-form",children:[u.jsx("textarea",{className:"form-input",rows:2,placeholder:"Escribe la evolucin / remisin",value:e,onChange:r=>n(r.target.value)}),u.jsx("button",{type:"button",className:"btn blue",onClick:()=>{e.trim()&&(t(e.trim()),n(""))},children:"Guardar evolucin"})]})}function MU(){return u.jsxs("div",{style:{padding:"20px"},children:[u.jsx("h2",{children:"Mdulo de Facturacin"}),u.jsx("p",{children:"Aqu se registrarn los pagos, facturas y cobros."})]})}const Ir=t=>(Number(t)||0).toLocaleString("es-CO",{maximumFractionDigits:0}),Io=()=>new Date().toISOString().slice(0,10),FU=(t=new Date)=>new Date(t.getFullYear(),t.getMonth(),t.getDate(),0,0,0,0),UU=(t=new Date)=>new Date(t.getFullYear(),t.getMonth(),t.getDate()+1,0,0,0,0),cT=t=>Be.fromDate(t),$U=()=>{const[t,e]=k.useState(null);return k.useEffect(()=>{const n=Ey(ch,r=>e(r||null));return()=>n()},[]),t},$t=({children:t,align:e})=>u.jsx("th",{className:"oc-th",style:{position:"sticky",top:0,zIndex:1,textAlign:e||"left",background:"var(--oc-surface, #fff)"},children:t}),BU=()=>Math.random().toString(36).slice(2)+Math.random().toString(36).slice(2);function zU(){var He;const t=$U(),e=[{key:"abrir",label:"Abrir caja",icon:""},{key:"abiertas",label:"Cajas abiertas",icon:""},{key:"cerradas",label:"Cajas cerradas",icon:""},{key:"mio",label:"Mi caja (hoy)",icon:""},{key:"simulados",label:"Cierres simulados",icon:""},{key:"bancos",label:"Bancos",icon:""}],[n,r]=k.useState("abiertas"),[s,i]=k.useState(""),[o,a]=k.useState(""),l=k.useRef(null),[d,h]=k.useState(!1),[f,m]=k.useState(""),[v,R]=k.useState([]),[b,A]=k.useState(!0),[I,w]=k.useState([]),[y,j]=k.useState(!0),[V,M]=k.useState(null),[T,_]=k.useState(!0),[S,C]=k.useState(""),[N,D]=k.useState([]),[P,Y]=k.useState(null),[Ye,Mt]=k.useState(""),[Zt,J]=k.useState("efectivo"),[ue,G]=k.useState(!1),[je,Ke]=k.useState("ingreso"),[B,ne]=k.useState(""),[de,Ie]=k.useState(""),[xe,ke]=k.useState(!1),[ge,Xe]=k.useState([]),[be,re]=k.useState([]);k.useEffect(()=>{const F=rt($e(ye,"cajas"),Je("estado","==","abierta"),Yt("fechaApertura","desc")),Z=or(F,ae=>{R(ae.docs.map(Ce=>Oe(Ce.id,Ce.data()))),A(!1),i("")},ae=>{console.error(ae),i((ae==null?void 0:ae.code)==="failed-precondition"?"Falta ndice (estado, fechaApertura) en Firestore.":(ae==null?void 0:ae.code)==="permission-denied"?"Permiso denegado en Firestore (revisa reglas).":"No se pudieron leer las cajas."),A(!1)});return()=>Z()},[]),k.useEffect(()=>{const F=rt($e(ye,"cajas"),Je("estado","==","cerrada"),Yt("fechaCierre","desc")),Z=or(F,ae=>{w(ae.docs.map(Ce=>Oe(Ce.id,Ce.data()))),j(!1)},ae=>{console.error(ae),j(!1)});return()=>Z()},[]),k.useEffect(()=>{if(!t){M(null),_(!1);return}_(!0);const F=rt($e(ye,"cajas"),Je("estado","==","abierta"),Je("usuarioId","==",t.uid),Je("fechaApertura",">=",cT(FU())),Je("fechaApertura","<",cT(UU()))),Z=or(F,ae=>{const Ce=ae.docs[0];M(Ce?Oe(Ce.id,Ce.data()):null),_(!1)},ae=>{console.error(ae),_(!1),(ae==null?void 0:ae.code)==="failed-precondition"&&i("Falta ndice (estado, usuarioId, fechaApertura) en Firestore.")});return()=>Z()},[t]),k.useEffect(()=>{if(!(V!=null&&V.id)){Xe([]),re([]);return}const F=rt($e(ye,"movimientos"),Je("cashId","==",V.id),Je("dia","==",Io()),Yt("fecha","desc")),Z=or(F,_t=>Xe(_t.docs.map(x=>({id:x.id,...x.data()}))),_t=>console.error(_t)),ae=rt($e(ye,"payments"),Je("cashId","==",V.id),Je("dia","==",Io()),Yt("fecha","desc")),Ce=or(ae,_t=>re(_t.docs.map(x=>({id:x.id,...x.data()}))),_t=>console.error(_t));return()=>{Z(),Ce()}},[V==null?void 0:V.id]),k.useEffect(()=>{if(!(S!=null&&S.trim())){D([]);return}const F=rt($e(ye,"patients"),Je("q",">=",X(S)),Je("q","<=",X(S)+""),Yt("q","asc")),Z=or(F,ae=>D(ae.docs.map(Ce=>({id:Ce.id,...Ce.data()}))),ae=>console.error(ae));return()=>Z()},[S]);function Oe(F,Z={}){const ae=Ae=>{var Ct;return((Ct=Ae==null?void 0:Ae.toDate)==null?void 0:Ct.call(Ae))||(typeof Ae=="string"?new Date(Ae):Ae||null)},Ce=ae(Z.fechaApertura),_t=ae(Z.fechaCierre),x=Number(Z.baseInicial||0),z=Number(Z.baseActual!==void 0?Z.baseActual:x),ie=Number(Z.saldoInicial||0),Ee=Number(Z.saldoActual!==void 0?Z.saldoActual:ie),me=[];return Ee<0&&me.push("Saldo negativo"),z<0&&me.push("Base negativa"),{id:F,estado:Z.estado||"abierta",usuarioId:Z.usuarioId||"",usuarioNombre:Z.usuarioNombre||"Usuario",nombre:Z.nombre||Z.usuarioNombre||"Caja",fechaApertura:Ce,fechaCierre:_t,baseInicial:x,baseActual:z,saldoInicial:ie,saldoActual:Ee,ia:me}}const it=async F=>{var Z;if((Z=F==null?void 0:F.preventDefault)==null||Z.call(F),!t){i("Debes iniciar sesin para abrir una caja.");return}h(!0);try{const ae=Number(f||0);await wl($e(ye,"cajas"),{estado:"abierta",usuarioId:t.uid,usuarioNombre:t.displayName||t.email||"Usuario",fechaApertura:$n(),baseInicial:ae,baseActual:ae,saldoInicial:0,saldoActual:0,dia:Io()}),m(""),r("mio"),i("")}catch(ae){console.error(ae),i("No se pudo abrir la caja.")}finally{h(!1)}},Ge=async F=>{try{await ea(Qt(ye,"cajas",F),{estado:"cerrada",fechaCierre:$n()}),r("cerradas")}catch(Z){console.error(Z),i("No se pudo cerrar la caja.")}},ft=async F=>{var ae;if((ae=F==null?void 0:F.preventDefault)==null||ae.call(F),!(V!=null&&V.id)){i("Debes abrir tu caja para registrar movimientos.");return}const Z=Number(de||0);if(!(!Z||Z<=0)){ke(!0);try{await wl($e(ye,"movimientos"),{cashId:V.id,tipo:je,concepto:B||(je==="ingreso"?"Ingreso":"Egreso"),valor:Z,fecha:$n(),dia:Io(),usuarioId:(t==null?void 0:t.uid)||null});const Ce=je==="ingreso"?Z:-Z;await ea(Qt(ye,"cajas",V.id),{saldoActual:MI(Ce)}),ne(""),Ie("")}catch(Ce){console.error(Ce),i("No se pudo registrar el movimiento.")}finally{ke(!1)}}},q=async F=>{var ae;if((ae=F==null?void 0:F.preventDefault)==null||ae.call(F),!(V!=null&&V.id))return i("Abre tu caja para cobrar.");const Z=Number(Ye||0);if(!(!Z||Z<=0)){if(!P)return i("Selecciona un paciente.");G(!0);try{const Ce=await wl($e(ye,"payments"),{cashId:V.id,patientId:P.id,patientName:P.nombre||P.name||"Paciente",invoiceId:null,valor:Z,medio:Zt,estado:"aprobado",fecha:$n(),dia:Io()});await ea(Qt(ye,"cajas",V.id),{saldoActual:MI(Z)}),Mt(""),J("efectivo"),i(`Pago registrado (${Ce.id}).`)}catch(Ce){console.error(Ce),i("No se pudo registrar el pago.")}finally{G(!1)}}},se=async F=>{var ae;if((ae=F==null?void 0:F.preventDefault)==null||ae.call(F),!(V!=null&&V.id))return i("Abre tu caja para cobrar.");const Z=Number(Ye||0);if(!(!Z||Z<=0)){if(!P)return i("Selecciona un paciente.");G(!0);try{const _t=`https://pay.odontocloud/mock/${BU()}`,x=await wl($e(ye,"payments"),{cashId:V.id,patientId:P.id,patientName:P.nombre||P.name||"Paciente",invoiceId:null,valor:Z,medio:"link",estado:"pending",linkUrl:_t,fecha:$n(),dia:Io()});i(`Link de pago generado: ${_t}`),Mt("")}catch(Ce){console.error(Ce),i("No se pudo generar link de pago.")}finally{G(!1)}}},X=F=>(F||"").toString().normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase(),Q=k.useMemo(()=>{const F=X(o);return F?v.filter(Z=>[Z.nombre,Z.usuarioNombre,Ir(Z.saldoActual),Ir(Z.baseActual)].map(X).some(ae=>ae.includes(F))):v},[o,v]),he=()=>u.jsxs("div",{className:"card",children:[u.jsx("div",{className:"oc-card-head",style:{marginBottom:8},children:u.jsx("h3",{children:"Abrir caja"})}),u.jsxs("form",{className:"oc-form",onSubmit:it,style:{display:"flex",gap:12,alignItems:"end",flexWrap:"wrap"},children:[u.jsxs("label",{style:{display:"inline-flex",flexDirection:"column",gap:6},children:[u.jsx("span",{children:"Base inicial (COP)"}),u.jsx("input",{type:"number",className:"oc-input",min:"0",step:"1000",value:f,onChange:F=>m(F.target.value),placeholder:"0"})]}),u.jsx("button",{className:"oc-btn",type:"submit",disabled:d,children:d?"Abriendo...":"Abrir caja"})]}),u.jsxs("p",{className:"oc-muted",style:{marginTop:8},children:["Se asociar a tu usuario y quedar visible en ",u.jsx("b",{children:"Mi caja (hoy)"}),"."]})]}),we=()=>u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"card",style:{marginBottom:10},children:u.jsxs("div",{className:"oc-card-head",style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[u.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[u.jsx("h3",{style:{margin:0},children:"Cajas Abiertas"}),u.jsx("span",{className:"oc-tag",children:Q.length}),s&&u.jsx("span",{className:"oc-tag oc-tag-danger",children:s})]}),u.jsx("input",{ref:l,className:"oc-input",style:{maxWidth:280},placeholder:"Buscar...",value:o,onChange:F=>a(F.target.value)})]})}),u.jsx("div",{className:"card",children:u.jsx("div",{className:"oc-table-wrap",children:u.jsxs("table",{className:"oc-table",children:[u.jsx("thead",{className:"oc-thead",children:u.jsxs("tr",{className:"oc-tr",children:[u.jsx($t,{children:"Caja"}),u.jsx($t,{children:"Fecha apertura"}),u.jsx($t,{align:"right",children:"Base actual"}),u.jsx($t,{align:"right",children:"Saldo inicial"}),u.jsx($t,{align:"right",children:"Saldo actual"}),u.jsx($t,{children:"Usuario"}),u.jsx($t,{children:"Acciones"})]})}),u.jsx("tbody",{className:"oc-tbody",children:b?u.jsx(uT,{cols:7}):Q.length===0?u.jsx("tr",{className:"oc-tr",children:u.jsx("td",{className:"oc-td",colSpan:7,children:u.jsx("span",{className:"oc-muted",children:"Sin cajas abiertas."})})}):Q.map(F=>{var Z;return u.jsxs("tr",{className:"oc-tr",children:[u.jsxs("td",{className:"oc-td",children:[u.jsx("b",{children:F.nombre})," ",(Z=F.ia)!=null&&Z.length?u.jsx("span",{className:"oc-tag oc-tag-danger",title:F.ia.join("  "),children:"IA"}):null]}),u.jsx("td",{className:"oc-td",children:F.fechaApertura?F.fechaApertura.toLocaleString("es-CO"):""}),u.jsxs("td",{className:"oc-td",style:{textAlign:"right"},children:["$",Ir(F.baseActual)]}),u.jsxs("td",{className:"oc-td",style:{textAlign:"right"},children:["$",Ir(F.saldoInicial)]}),u.jsxs("td",{className:"oc-td",style:{textAlign:"right",color:F.saldoActual<0?"#b91c1c":void 0,fontWeight:600},children:["$",Ir(F.saldoActual)]}),u.jsx("td",{className:"oc-td",children:F.usuarioNombre}),u.jsxs("td",{className:"oc-td",style:{whiteSpace:"nowrap"},children:[u.jsx("button",{className:"oc-small-btn",onClick:()=>r("mio"),children:"Ver"})," ",u.jsx("button",{className:"oc-small-btn oc-danger",onClick:()=>Ge(F.id),children:"Cerrar"})]})]},F.id)})})]})})})]}),Ne=()=>u.jsxs("div",{className:"card",children:[u.jsxs("div",{className:"oc-card-head",style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[u.jsx("h3",{children:"Mi caja (hoy)"}),(V==null?void 0:V.estado)==="abierta"&&u.jsxs("div",{style:{display:"flex",gap:8},children:[u.jsx("span",{className:"oc-tag oc-tag-success",children:"Abierta"}),u.jsx("button",{className:"oc-small-btn oc-danger",onClick:()=>Ge(V.id),children:"Cerrar caja"})]})]}),T?u.jsx("div",{className:"oc-muted",children:"Cargando"}):V?u.jsxs(u.Fragment,{children:[u.jsxs("div",{className:"oc-stats-row",style:{marginBottom:12},children:[u.jsxs("div",{className:"stat-card",children:[u.jsx("span",{className:"stat-label",children:"Base actual"}),u.jsxs("span",{className:"stat-value",children:["$",Ir(V.baseActual)]})]}),u.jsxs("div",{className:"stat-card",children:[u.jsx("span",{className:"stat-label",children:"Saldo actual"}),u.jsxs("span",{className:"stat-value",style:{color:V.saldoActual<0?"#b91c1c":void 0},children:["$",Ir(V.saldoActual)]})]})]}),u.jsxs("div",{className:"card",style:{marginBottom:12},children:[u.jsx("h4",{style:{marginBottom:8},children:"Cobro rpido"}),u.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr auto",gap:8},children:[u.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:6},children:[u.jsx("label",{className:"oc-muted",children:"Paciente"}),u.jsx("input",{className:"oc-input",placeholder:"Buscar nombre o documento",value:S,onChange:F=>C(F.target.value)}),S&&N.length>0&&u.jsx("div",{className:"oc-dropdown",children:N.slice(0,6).map(F=>u.jsx("button",{className:`oc-menu-item ${(P==null?void 0:P.id)===F.id?"active":""}`,onClick:()=>{Y(F),C(F.nombre||F.name||F.doc||"")},type:"button",children:(F.nombre||F.name||"Paciente")+(F.doc?`  ${F.doc}`:"")},F.id))})]}),u.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:6},children:[u.jsx("label",{className:"oc-muted",children:"Monto (COP)"}),u.jsx("input",{className:"oc-input",type:"number",min:"0",step:"1000",placeholder:"0",value:Ye,onChange:F=>Mt(F.target.value)})]}),u.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:6},children:[u.jsx("label",{className:"oc-muted",children:"Medio"}),u.jsxs("select",{className:"oc-input",value:Zt,onChange:F=>J(F.target.value),children:[u.jsx("option",{value:"efectivo",children:"Efectivo"}),u.jsx("option",{value:"tarjeta",children:"Tarjeta"}),u.jsx("option",{value:"transferencia",children:"Transferencia"}),u.jsx("option",{value:"link",children:"Link (en lnea)"})]})]}),u.jsx("div",{style:{display:"flex",alignItems:"end",gap:6},children:Zt==="link"?u.jsx("button",{className:"oc-btn",onClick:se,disabled:ue,children:ue?"Creando":"Generar link"}):u.jsx("button",{className:"oc-btn",onClick:q,disabled:ue,children:ue?"Guardando":"Registrar pago"})})]}),u.jsxs("p",{className:"oc-muted",style:{marginTop:8},children:["Para link, el saldo se actualiza cuando el pago pase a ",u.jsx("b",{children:"aprobado"})," (webhook)."]})]}),u.jsxs("div",{className:"card",style:{marginBottom:12},children:[u.jsx("h4",{style:{marginBottom:8},children:"Movimiento manual"}),u.jsxs("form",{onSubmit:ft,style:{display:"grid",gridTemplateColumns:"120px 1fr 180px auto",gap:8},children:[u.jsxs("select",{className:"oc-input",value:je,onChange:F=>Ke(F.target.value),children:[u.jsx("option",{value:"ingreso",children:"Ingreso"}),u.jsx("option",{value:"egreso",children:"Egreso"})]}),u.jsx("input",{className:"oc-input",placeholder:"Concepto (ej. Caja chica, Arriendo, etc.)",value:B,onChange:F=>ne(F.target.value)}),u.jsx("input",{className:"oc-input",type:"number",min:"0",step:"1000",placeholder:"0",value:de,onChange:F=>Ie(F.target.value)}),u.jsx("button",{className:"oc-btn",disabled:xe,children:xe?"Guardando":"Agregar"})]})]}),u.jsxs("div",{className:"card",children:[u.jsx("h4",{style:{marginBottom:8},children:"Movimientos y pagos (hoy)"}),u.jsx("div",{className:"oc-table-wrap",style:{marginBottom:12},children:u.jsxs("table",{className:"oc-table",children:[u.jsx("thead",{className:"oc-thead",children:u.jsxs("tr",{className:"oc-tr",children:[u.jsx($t,{children:"Tipo"}),u.jsx($t,{children:"Concepto / Paciente"}),u.jsx($t,{children:"Medio"}),u.jsx($t,{children:"Estado"}),u.jsx($t,{align:"right",children:"Valor"}),u.jsx($t,{children:"Hora"})]})}),u.jsx("tbody",{className:"oc-tbody",children:ge.length===0&&be.length===0?u.jsx("tr",{className:"oc-tr",children:u.jsx("td",{className:"oc-td",colSpan:6,children:u.jsx("span",{className:"oc-muted",children:"Sin movimientos ni pagos an."})})}):u.jsxs(u.Fragment,{children:[be.map(F=>{var Z,ae;return u.jsxs("tr",{className:"oc-tr",children:[u.jsx("td",{className:"oc-td",children:"Pago"}),u.jsxs("td",{className:"oc-td",children:[F.patientName||"Paciente"," ",F.linkUrl?u.jsx("a",{href:F.linkUrl,target:"_blank",rel:"noreferrer",children:"(link)"}):null]}),u.jsx("td",{className:"oc-td",children:F.medio}),u.jsx("td",{className:"oc-td",children:u.jsx("span",{className:`oc-tag ${F.estado==="aprobado"?"oc-tag-success":F.estado==="pending"?"oc-tag-warning":"oc-tag-danger"}`,children:F.estado})}),u.jsxs("td",{className:"oc-td",style:{textAlign:"right"},children:["$",Ir(F.valor)]}),u.jsx("td",{className:"oc-td",children:(ae=(Z=F.fecha)==null?void 0:Z.toDate)!=null&&ae.call(Z)?F.fecha.toDate().toLocaleTimeString("es-CO"):""})]},`pay-${F.id}`)}),ge.map(F=>{var Z,ae;return u.jsxs("tr",{className:"oc-tr",children:[u.jsx("td",{className:"oc-td",children:F.tipo}),u.jsx("td",{className:"oc-td",children:F.concepto}),u.jsx("td",{className:"oc-td",children:""}),u.jsx("td",{className:"oc-td",children:u.jsx("span",{className:"oc-tag",children:(F.tipo==="ingreso","ok")})}),u.jsxs("td",{className:"oc-td",style:{textAlign:"right"},children:["$",Ir(F.valor)]}),u.jsx("td",{className:"oc-td",children:(ae=(Z=F.fecha)==null?void 0:Z.toDate)!=null&&ae.call(Z)?F.fecha.toDate().toLocaleTimeString("es-CO"):""})]},`mov-${F.id}`)})]})})]})}),u.jsx("p",{className:"oc-muted",children:"Sugerencia: crea ndice compuesto para `movimientos(cashId, dia, fecha)` y `payments(cashId, dia, fecha)` para rendimiento."})]})]}):u.jsxs("div",{className:"oc-empty",children:[u.jsx("p",{className:"oc-muted",children:"No tienes una caja abierta hoy."}),u.jsx("button",{className:"oc-btn",onClick:()=>r("abrir"),children:"Abrir caja"})]})]}),ze=()=>u.jsxs("div",{className:"card",children:[u.jsx("div",{className:"oc-card-head",style:{marginBottom:8},children:u.jsxs("h3",{children:["Cajas cerradas ",u.jsx("span",{className:"oc-tag",children:I.length})]})}),u.jsx("div",{className:"oc-table-wrap",children:u.jsxs("table",{className:"oc-table",children:[u.jsx("thead",{className:"oc-thead",children:u.jsxs("tr",{className:"oc-tr",children:[u.jsx($t,{children:"Caja"}),u.jsx($t,{children:"Usuario"}),u.jsx($t,{children:"Apertura"}),u.jsx($t,{children:"Cierre"}),u.jsx($t,{align:"right",children:"Saldo final"})]})}),u.jsx("tbody",{className:"oc-tbody",children:y?u.jsx(uT,{cols:5}):I.length===0?u.jsx("tr",{className:"oc-tr",children:u.jsx("td",{className:"oc-td",colSpan:5,children:u.jsx("span",{className:"oc-muted",children:"Sin cajas cerradas."})})}):I.map(F=>u.jsxs("tr",{className:"oc-tr",children:[u.jsx("td",{className:"oc-td",children:F.nombre}),u.jsx("td",{className:"oc-td",children:F.usuarioNombre}),u.jsx("td",{className:"oc-td",children:F.fechaApertura?F.fechaApertura.toLocaleString("es-CO"):""}),u.jsx("td",{className:"oc-td",children:F.fechaCierre?F.fechaCierre.toLocaleString("es-CO"):""}),u.jsxs("td",{className:"oc-td",style:{textAlign:"right"},children:["$",Ir(F.saldoActual)]})]},F.id))})]})})]}),Se=()=>u.jsxs("div",{className:"card",children:[u.jsx("h3",{children:"Cierres simulados"}),u.jsx("p",{className:"oc-muted",children:"El cierre hipottico compara ventas y movimientos detectando errores y descuadres con IA. (Conectar fuente de datos para activarlo)."})]}),Fe=()=>u.jsxs("div",{className:"card",children:[u.jsx("h3",{children:"Bancos"}),u.jsx("p",{className:"oc-muted",children:"Conciliacin de consignaciones/pagos electrnicos contra caja del da. (Conectar pasarela o extractos para habilitar)."})]}),pe=({m:F})=>u.jsxs("button",{type:"button",onClick:()=>r(F.key),className:`oc-menu-item ${n===F.key?"active":""}`,style:{width:"100%",textAlign:"left",padding:"10px 12px",borderRadius:10,border:"1px solid transparent",background:n===F.key?"var(--oc-surface-2, #f3f6ff)":"transparent",fontWeight:600},title:F.label,children:[u.jsx("span",{style:{opacity:.8,marginRight:6},children:F.icon}),F.label]});return u.jsxs("div",{className:"oc-main-content",style:{display:"grid",gridTemplateColumns:"240px 1fr",gap:16},children:[u.jsx("aside",{className:"card",role:"navigation","aria-label":"Men de caja",style:{height:"fit-content",padding:12},children:u.jsx("div",{style:{display:"flex",flexDirection:"column",gap:8},children:e.map(F=>u.jsx(pe,{m:F},F.key))})}),u.jsxs("section",{children:[u.jsx("div",{className:"card",style:{marginBottom:12,padding:12},children:u.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",gap:12},children:[u.jsxs("div",{className:"oc-breadcrumb",children:[u.jsx("span",{children:"Caja"}),u.jsx("span",{children:""}),u.jsx("b",{children:(He=e.find(F=>F.key===n))==null?void 0:He.label})]}),n==="abiertas"&&u.jsx("input",{ref:l,className:"oc-input",placeholder:"Buscar...",value:o,onChange:F=>a(F.target.value),style:{maxWidth:300}})]})}),n==="abrir"&&u.jsx(he,{}),n==="abiertas"&&u.jsx(we,{}),n==="cerradas"&&u.jsx(ze,{}),n==="mio"&&u.jsx(Ne,{}),n==="simulados"&&u.jsx(Se,{}),n==="bancos"&&u.jsx(Fe,{})]})]})}function uT({cols:t=6,n:e=3}){return u.jsx(u.Fragment,{children:Array.from({length:e}).map((n,r)=>u.jsx("tr",{className:"oc-tr",children:Array.from({length:t}).map((s,i)=>u.jsx("td",{className:"oc-td",children:u.jsx("div",{style:{height:12,width:i===0?160:100+i%3*40,background:"var(--oc-skeleton, #e5e7eb)",borderRadius:6}})},i))},r))})}function qU({items:t=[]}){return u.jsxs("div",{className:"card activity-card",children:[u.jsx("h4",{children:"Actividad reciente"}),u.jsx("ul",{className:"activity-list",children:t.map(e=>u.jsxs("li",{children:[u.jsx("strong",{children:e.title}),u.jsx("div",{className:"time",children:e.time})]},e.id))})]})}function HU({status:t}){return t?u.jsxs("div",{className:"card",children:[u.jsx("h4",{children:"Automatizaciones (N8N)"}),u.jsxs("div",{className:"n8n-line",children:[u.jsx("strong",{children:"Conectado:"})," ",t.connected?"S":"No"]}),u.jsxs("div",{className:"n8n-line",children:[u.jsx("strong",{children:"Flujos activos:"})," ",t.flowsRunning]}),t.lastError&&u.jsxs("div",{className:"n8n-error",children:["Error: ",t.lastError]})]}):null}const Pp={es:{nav_home:"Inicio",nav_agenda:"Agenda",nav_patients:"Pacientes",nav_billing:"Facturacin",nav_inventory:"Inventario",nav_odontogram:"Odontograma",nav_reports:"Reportes",nav_cash:"Caja",nav_admin:"Administracin",welcomeTitle:"Bienvenido a OdontoCloud",welcomeSubtitle:"Administra tus pacientes, agenda, inventario y facturacin de manera inteligente y moderna.",clinicLabel:"Clnica",userLabel:"Usuario",roleLabel:"Rol",searchPlaceholder:"Buscar acciones o ir a",stats_patientsToday:"Pacientes totales",stats_appointmentsToday:"Citas hoy",stats_revenueToday:"Facturacin hoy",stats_waiting:"En espera",stats_currency:"COP",n8n_title:"Automatizaciones (n8n)",recent_title:"Actividad reciente",recent_empty:"Sin actividad registrada.",loading:"Cargando...",logout:"Cerrar sesin",module_coming:"Mdulo prximamente.",todays_appts:"Citas de hoy",see_schedule:"Ir a Agenda",no_appts_today:"No hay citas programadas hoy.",at:"a las"},en:{nav_home:"Overview",nav_agenda:"Schedule",nav_patients:"Patients",nav_billing:"Billing",nav_inventory:"Inventory",nav_odontogram:"Odontogram",nav_reports:"Reports",nav_cash:"Cash",nav_admin:"Administration",welcomeTitle:"Welcome to OdontoCloud",welcomeSubtitle:"Manage your patients, schedule, inventory and billing in a smart and modern way.",clinicLabel:"Clinic",userLabel:"User",roleLabel:"Role",searchPlaceholder:"Search actions or go to",stats_patientsToday:"Total patients",stats_appointmentsToday:"Appointments today",stats_revenueToday:"Revenue today",stats_waiting:"In waiting room",stats_currency:"COP",n8n_title:"Automations (n8n)",recent_title:"Recent activity",recent_empty:"No activity yet.",loading:"Loading...",logout:"Log out",module_coming:"Module coming soon.",todays_appts:"Today's appointments",see_schedule:"Open Schedule",no_appts_today:"No appointments today.",at:"at"}},UA=()=>typeof navigator>"u"||(navigator.language||navigator.userLanguage||"es").toLowerCase().startsWith("es")?"es":"en",WU=()=>{try{const t=JSON.parse(localStorage.getItem("odc_session"));return t&&Date.now()-t.timestamp<1e3*60*60*24?t:null}catch{return null}},KU=()=>k.useMemo(()=>{const t=new Date,e=new Date(t.getFullYear(),t.getMonth(),t.getDate(),0,0,0,0),n=new Date(t.getFullYear(),t.getMonth(),t.getDate()+1,0,0,0,0);return{startToday:Be.fromDate(e),endToday:Be.fromDate(n),startTodayJS:e}},[]),GU=t=>`${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,"0")}-${String(t.getDate()).padStart(2,"0")}`,QU=(t,e)=>t.toLocaleTimeString(e==="es"?"es-CO":"en-US",{hour:"2-digit",minute:"2-digit"}),YU=(t,e)=>{try{const[n,r,s]=(t||"").split("-").map(a=>parseInt(a,10)),[i=0,o=0]=(e||"00:00").split(":").map(a=>parseInt(a,10));return new Date(n,(r||1)-1,s||1,i,o,0,0)}catch{return new Date}};function XU({data:t=[]}){const s=Math.max(1,...t.map(d=>Number(d.value)||0)),i=t.length||7,o=10,a=Math.max(16,Math.min(44,(640-o*(i+1))/i)),l=(a+o)*i+o;return u.jsx("div",{style:{width:"100%",overflowX:"auto"},children:u.jsxs("svg",{width:l,height:240,role:"img","aria-label":"Pacientes registrados por da en la ltima semana",children:[[.25,.5,.75,1].map((d,h)=>{const f=18+(1-d)*182;return u.jsx("line",{x1:0,x2:l,y1:f,y2:f,stroke:"#e5e7eb",strokeDasharray:"4 4"},h)}),t.map((d,h)=>{const f=Number(d.value)||0,m=Math.round(f/s*182),v=o+h*(a+o),R=200-m;return u.jsxs("g",{children:[u.jsx("rect",{x:v,y:R,width:a,height:m,rx:"6",ry:"6",fill:f>0?"#0ea5e9":"#cbd5e1",children:u.jsx("title",{children:`${d.label||d.shortLabel||""}  ${f} paciente${f!==1?"s":""}`})}),f>0&&m>14&&u.jsx("text",{x:v+a/2,y:R-6,textAnchor:"middle",fontSize:"11",fill:"#0f172a",children:f}),u.jsx("text",{x:v+a/2,y:214,textAnchor:"middle",fontSize:"11",fill:"#64748b",children:d.shortLabel||""})]},h)})]})})}function JU({onNavigate:t,onAction:e,placeholder:n}){const[r,s]=k.useState(""),[i,o]=k.useState(!1),[a,l]=k.useState(0),d=k.useRef(null),h=k.useMemo(()=>[{group:"Navegacin",label:"Ir a Inicio",keywords:"inicio home overview",run:()=>t==null?void 0:t("Inicio")},{group:"Navegacin",label:"Ir a Agenda",keywords:"agenda calendario schedule",run:()=>t==null?void 0:t("Agenda")},{group:"Navegacin",label:"Ir a Pacientes",keywords:"pacientes",run:()=>t==null?void 0:t("Pacientes")},{group:"Navegacin",label:"Ir a Facturacin",keywords:"facturacion facturas billing",run:()=>t==null?void 0:t("Facturacin")},{group:"Navegacin",label:"Ir a Inventario",keywords:"inventario stock",run:()=>t==null?void 0:t("Inventario")},{group:"Navegacin",label:"Ir a Odontograma",keywords:"odontograma",run:()=>t==null?void 0:t("Odontograma")},{group:"Navegacin",label:"Ir a Reportes",keywords:"reportes informes",run:()=>t==null?void 0:t("Reportes")},{group:"Acciones",label:"Nueva cita",keywords:"nueva cita agendar",run:()=>e==null?void 0:e("new_appointment")},{group:"Acciones",label:"Nuevo paciente",keywords:"nuevo paciente alta",run:()=>e==null?void 0:e("new_patient")},{group:"Acciones",label:"Nueva factura",keywords:"nueva factura",run:()=>e==null?void 0:e("new_invoice")},{group:"Acciones",label:"Exportar agenda",keywords:"exportar agenda",run:()=>e==null?void 0:e("export_agenda")},{group:"Acciones",label:"Ir a hoy (Agenda)",keywords:"hoy today",run:()=>e==null?void 0:e("agenda_today")},{group:"Acciones",label:"Cambiar modo oscuro",keywords:"oscuro dark mode",run:()=>e==null?void 0:e("toggle_dark")},{group:"Acciones",label:"Cerrar sesin",keywords:"logout salir cerrar",run:()=>e==null?void 0:e("logout")},{group:"Ayuda",label:"Ver atajos de teclado",keywords:"atajos ayuda",run:()=>e==null?void 0:e("show_shortcuts")},{group:"Ayuda",label:"Soporte / Contacto",keywords:"soporte ayuda contacto",run:()=>e==null?void 0:e("support")}],[t,e]),f=k.useMemo(()=>{const b=r.toLowerCase().trim();return b?h.filter(A=>A.label.toLowerCase().includes(b)||A.keywords.includes(b)):[]},[r,h]);k.useEffect(()=>{const b=A=>{d.current&&(d.current.contains(A.target)||o(!1))};return document.addEventListener("mousedown",b),()=>document.removeEventListener("mousedown",b)},[]);const m=b=>{var A;(A=b.run)==null||A.call(b),s(""),o(!1)},v=b=>{!i||f.length===0||(b.key==="ArrowDown"&&(b.preventDefault(),l(A=>(A+1)%f.length)),b.key==="ArrowUp"&&(b.preventDefault(),l(A=>(A-1+f.length)%f.length)),b.key==="Enter"&&(b.preventDefault(),f[a]&&m(f[a])),b.key==="Escape"&&o(!1))},R=k.useMemo(()=>{const b=new Map;return f.forEach(A=>{b.has(A.group)||b.set(A.group,[]),b.get(A.group).push(A)}),Array.from(b.entries())},[f]);return u.jsxs("div",{className:"oc-search-wrap",ref:d,children:[u.jsx("input",{className:"oc-search",type:"search",inputMode:"search",placeholder:n,"aria-label":n,value:r,onChange:b=>{s(b.target.value),o(!!b.target.value),l(0)},onFocus:()=>o(!!r),onKeyDown:v}),i&&u.jsx("div",{className:"oc-search-dropdown",role:"listbox","aria-label":"Resultados de comandos",children:R.length===0?u.jsx("div",{className:"oc-search-item empty",children:"Escribe para ver opciones"}):R.map(([b,A])=>u.jsxs("div",{children:[u.jsx("div",{className:"oc-search-group",children:b}),A.map(I=>{const w=f.indexOf(I);return u.jsx("button",{className:`oc-search-item ${w===a?"active":""}`,onMouseEnter:()=>l(w),onClick:()=>m(I),role:"option",children:u.jsx("span",{className:"oc-search-title",children:I.label})},I.label)})]},b))})]})}function ZU({open:t,anchorRect:e,onClose:n,onSoon:r,onNavigatePath:s,onSetFactView:i,dark:o}){const[a,l]=k.useState(null),d=k.useRef(null);if(k.useEffect(()=>{if(!t)return;const Y=Mt=>Mt.key==="Escape"&&(n==null?void 0:n()),Ye=()=>n==null?void 0:n();return window.addEventListener("keydown",Y),window.addEventListener("scroll",Ye,!0),()=>{window.removeEventListener("keydown",Y),window.removeEventListener("scroll",Ye,!0)}},[t,n]),!t)return null;const h=((e==null?void 0:e.bottom)||60)+8,f=Math.max(12,Math.min(((e==null?void 0:e.left)||300)-160,window.innerWidth-920)),m=10,v=f+360+m,R=o?"#0b1220":"#ffffff",b=o?"#e5e7eb":"#0f172a",A=o?"#0f1a32":"#f3f6ff",I=o?"#1f2a44":"#e2e8f0",w=o?"#b6c1d1":"#475569",y={position:"fixed",top:h,left:f,width:880,maxWidth:"calc(100vw - 24px)",background:R,color:b,borderRadius:14,boxShadow:"0 18px 40px rgba(2,6,23,.18)",border:`1px solid ${I}`,zIndex:400,padding:12},j={position:"fixed",top:h,left:v,width:420,maxWidth:"calc(100vw - 24px)",background:R,color:b,borderRadius:14,boxShadow:"0 18px 40px rgba(2,6,23,.18)",border:`1px solid ${I}`,zIndex:410,padding:12},V={display:"flex",flexDirection:"column",gap:6,padding:"8px 10px"},M={height:38,borderRadius:10,padding:"0 12px",display:"flex",alignItems:"center",gap:8,fontSize:".92rem",cursor:"pointer",border:"1px solid transparent",background:"transparent",color:b,fontWeight:500,textAlign:"left"},T=(Y,Ye=!0)=>Object.assign(Y.currentTarget.style,Ye?{background:A,borderColor:I}:{background:"transparent",borderColor:"transparent"}),_=()=>{d.current&&clearTimeout(d.current)},S=()=>{_(),d.current=setTimeout(()=>n==null?void 0:n(),180)},C={position:"fixed",top:h,left:f+360,width:m,height:520,zIndex:405},N=[{label:"Recibo de caja",key:"recibo",path:"facturacion/recibo"},{label:"Saldo a favor",key:"saldo",path:"facturacion/saldo"},{label:"Nota crdito",key:"nc",path:"facturacion/nc"},{label:"Nota dbito",key:"nd",path:"facturacion/nd"},{label:"Liquidaciones",key:"liq",path:"facturacion/liq"},{label:"Traslados",key:"tras",path:"facturacion/tras"},{label:"Pagos",key:"pagos",path:"facturacion/pagos"},{label:"rdenes de compra",key:"oc",path:"facturacion/oc"},{label:"Factura de venta",key:"fv",path:"facturacion/facturas"},{label:"Facturas de compra",key:"fc",path:"facturacion/fc"}],D=[{label:"RIPS anteriores (RS-3374)",key:"rips3374"},{label:"RIPS nuevo (RS-2275)",key:"rips2275"}],P=Y=>{i==null||i(Y.key),s==null||s(Y.path),n==null||n()};return u.jsxs(u.Fragment,{children:[u.jsx("div",{onClick:n,style:{position:"fixed",inset:0,background:"transparent",zIndex:399}}),u.jsx("div",{style:y,onMouseEnter:_,onMouseLeave:S,children:u.jsxs("div",{style:{display:"grid",gridTemplateColumns:"360px 1fr",gap:8,alignItems:"start"},children:[u.jsxs("div",{style:V,children:[u.jsx("button",{type:"button",style:M,onMouseEnter:()=>{_(),l("facturacion")},onFocus:()=>{_(),l("facturacion")},onClick:()=>l(Y=>Y==="facturacion"?null:"facturacion"),onMouseOver:Y=>T(Y,!0),onMouseOut:Y=>T(Y,!1),children:" Facturacin "}),u.jsx("button",{type:"button",style:M,onMouseEnter:()=>{_(),l("rips")},onFocus:()=>{_(),l("rips")},onClick:()=>l(Y=>Y==="rips"?null:"rips"),onMouseOver:Y=>T(Y,!0),onMouseOut:Y=>T(Y,!1),children:" RIPS "}),u.jsx("button",{type:"button",style:M,onClick:()=>s==null?void 0:s("agenda"),onMouseOver:Y=>T(Y,!0),onMouseOut:Y=>T(Y,!1),children:" Gestin de agenda"}),u.jsx("button",{type:"button",style:M,onClick:()=>s==null?void 0:s("inventario"),onMouseOver:Y=>T(Y,!0),onMouseOut:Y=>T(Y,!1),children:" Inventario"}),u.jsx("button",{type:"button",style:M,onClick:()=>r==null?void 0:r(),onMouseOver:Y=>T(Y,!0),onMouseOut:Y=>T(Y,!1),children:" Convenios"}),u.jsx("button",{type:"button",style:M,onClick:()=>r==null?void 0:r(),onMouseOver:Y=>T(Y,!0),onMouseOut:Y=>T(Y,!1),children:" Terceros"}),u.jsx("button",{type:"button",style:M,onClick:()=>r==null?void 0:r(),onMouseOver:Y=>T(Y,!0),onMouseOut:Y=>T(Y,!1),children:" Campaas"}),u.jsx("button",{type:"button",style:M,onClick:()=>r==null?void 0:r(),onMouseOver:Y=>T(Y,!0),onMouseOut:Y=>T(Y,!1),children:" Temperatura y humedad"}),u.jsx("button",{type:"button",style:M,onClick:()=>r==null?void 0:r(),onMouseOver:Y=>T(Y,!0),onMouseOut:Y=>T(Y,!1),children:" Residuos"}),u.jsx("button",{type:"button",style:M,onClick:()=>r==null?void 0:r(),onMouseOver:Y=>T(Y,!0),onMouseOut:Y=>T(Y,!1),children:" Medicamentos y planes"}),u.jsx("button",{type:"button",style:M,onClick:()=>r==null?void 0:r(),onMouseOver:Y=>T(Y,!0),onMouseOut:Y=>T(Y,!1),children:" Esterilizacin"})]}),u.jsx("div",{style:V,children:u.jsxs("div",{style:{fontSize:".85rem",color:w},children:["Accesos rpidos a mdulos de administracin. Pasa el mouse por ",u.jsx("b",{children:"Facturacin"})," o ",u.jsx("b",{children:"RIPS"})," para ver sus acciones."]})})]})}),u.jsx("div",{style:C,onMouseEnter:_,onMouseLeave:S}),a&&u.jsx("div",{style:j,onMouseEnter:_,onMouseLeave:S,children:u.jsx("div",{style:{...V,display:"grid",gridTemplateColumns:"1fr"},children:(a==="facturacion"?N:D).map(Y=>u.jsx("button",{type:"button",style:M,onClick:()=>a==="facturacion"?P(Y):r==null?void 0:r(),onMouseOver:Ye=>T(Ye,!0),onMouseOut:Ye=>T(Ye,!1),children:Y.label},Y.label))})})]})}function e6({t,companyName:e,userName:n,role:r,darkMode:s,weeklySeries:i,weekRangeLabel:o,todaysAppointments:a,todaysLoading:l,metrics:d,metricsLoading:h,n8nState:f,n8nLoading:m,recent:v,recentLoading:R,onGoAgenda:b}){return u.jsxs("div",{className:"oc-main-content",children:[u.jsxs("section",{className:"oc-hero","aria-label":"Resumen general",children:[u.jsxs("div",{className:"oc-hero-text",children:[u.jsx("h1",{children:t("welcomeTitle")}),u.jsx("p",{children:t("welcomeSubtitle")}),u.jsxs("p",{className:"oc-hero-meta",children:[t("clinicLabel"),": ",e,"  ",t("userLabel"),": ",n,"  ",t("roleLabel"),": ",r||""]})]}),u.jsxs("div",{className:"oc-hero-badge","aria-live":"polite",children:[u.jsx("span",{className:"oc-hero-badge-title",children:t("stats_appointmentsToday")}),u.jsx("span",{className:"oc-hero-badge-value",children:h&&l?"":d.citasHoy}),u.jsxs("span",{className:"oc-hero-badge-sub",children:[t("stats_patientsToday"),": ",h?"":d.pacientesHoy]})]})]}),u.jsxs("section",{className:"oc-stats-row","aria-label":"Indicadores del da",children:[u.jsxs("div",{className:"stat-card",children:[u.jsx("span",{className:"stat-label",children:t("stats_patientsToday")}),u.jsx("span",{className:"stat-value",children:d.pacientesHoy})]}),u.jsxs("div",{className:"stat-card",children:[u.jsx("span",{className:"stat-label",children:t("stats_appointmentsToday")}),u.jsx("span",{className:"stat-value",children:d.citasHoy})]}),u.jsxs("div",{className:"stat-card",children:[u.jsx("span",{className:"stat-label",children:t("stats_revenueToday")}),u.jsxs("span",{className:"stat-value",children:[d.facturacionHoy.toLocaleString("es-CO")," ",u.jsx("span",{className:"stat-currency",children:t("stats_currency")})]})]}),u.jsxs("div",{className:"stat-card",children:[u.jsx("span",{className:"stat-label",children:t("stats_waiting")}),u.jsx("span",{className:"stat-value",children:d.enEspera})]})]}),u.jsxs("section",{className:"oc-grid","aria-label":"Contenido principal del dashboard",children:[u.jsx("div",{className:"oc-grid-main",children:u.jsxs("div",{className:"card card-quickcharts",children:[u.jsxs("div",{className:"oc-card-head",style:{display:"flex",justifyContent:"space-between",alignItems:"center",gap:8},children:[u.jsx("h3",{children:"Pacientes registrados  ltimos 7 das"}),u.jsx("span",{className:"oc-muted",style:{marginLeft:8,fontSize:12},children:o})]}),i.length===0||i.every(A=>((A==null?void 0:A.value)||0)===0)?u.jsx("p",{className:"oc-weekly-empty",children:"Sin pacientes registrados en la ltima semana."}):u.jsx(XU,{data:i})]})}),u.jsxs("aside",{className:"oc-grid-side","aria-label":"Panel lateral",children:[u.jsxs("div",{className:"card",children:[u.jsx("h3",{children:t("n8n_title")}),m?u.jsx("span",{className:"oc-muted",children:t("loading")}):u.jsx(HU,{status:f})]}),u.jsxs("div",{className:"card",children:[u.jsxs("div",{className:"oc-card-head",style:{display:"flex",justifyContent:"space-between",alignItems:"center",gap:8},children:[u.jsx("h3",{children:t("todays_appts")}),u.jsx("button",{className:"oc-small-link",type:"button",onClick:b,children:t("see_schedule")})]}),l?u.jsx("span",{className:"oc-muted",children:t("loading")}):a.length===0?u.jsx("p",{className:"oc-muted",children:t("no_appts_today")}):u.jsx("ul",{className:"oc-list",children:a.slice(0,5).map(A=>u.jsxs("li",{className:"oc-list-item",children:[u.jsxs("div",{className:"oc-list-main",children:[u.jsx("b",{children:A.pacienteNombre||"Paciente"})," ",u.jsxs("span",{className:"oc-muted",children:[t("at")," ",QU(A.fecha,UA())]})]}),u.jsx("div",{className:`oc-tag oc-tag-${(A.estado||"programada").toLowerCase().replace(/\s+/g,"-")}`,children:A.estado||"programada"})]},A.id))})]}),u.jsxs("div",{className:"card",children:[u.jsx("h3",{children:"Actividad reciente"}),R?u.jsx("span",{className:"oc-muted",children:t("loading")}):v.length===0?u.jsx("p",{className:"oc-muted",children:t("recent_empty")}):u.jsx(qU,{items:v})]})]})]}),u.jsxs("footer",{className:"oc-footer",children:[" ",new Date().getFullYear()," OdontoCloud | Creado por Ingeniero Juan Madrid"]})]})}function kp(){const t=Sc(),e=Lr(),[n]=k.useState(UA()),r=q=>Pp[n][q]||q,[s,i]=k.useState("Inicio"),[o,a]=k.useState("recibo"),[l,d]=k.useState(()=>{try{return localStorage.getItem("odontocloud:dark")==="1"}catch{return!1}});k.useEffect(()=>{try{localStorage.setItem("odontocloud:dark",l?"1":"0")}catch{}document.documentElement.classList.toggle("dark",l)},[l]);const[h]=k.useState(()=>WU()),[f]=k.useState((h==null?void 0:h.rol)||""),[m]=k.useState((h==null?void 0:h.email)||""),[v,R]=k.useState("OdontoCloud"),[b,A]=k.useState(m||"Usuario"),[I,w]=k.useState(!0);k.useEffect(()=>{const q=Ey(ch,async se=>{try{if(!se){A(m||"Usuario"),R("OdontoCloud"),w(!1);return}A(se.displayName||se.email||m||"Usuario");const X=Qt(ye,"empresas",se.uid),Q=await ih(X);R(Q.exists()&&Q.data().nombre||"OdontoCloud")}catch(X){console.error("Error cargando empresa/usuario:",X)}finally{w(!1)}});return()=>q()},[m]);const[y,j]=k.useState({pacientesHoy:0,citasHoy:0,facturacionHoy:0,enEspera:0}),[V,M]=k.useState(!0),[T,_]=k.useState([]),[S,C]=k.useState([]),[N,D]=k.useState(!0),{startToday:P,endToday:Y,startTodayJS:Ye}=KU(),Mt=k.useMemo(()=>GU(Ye),[Ye]),Zt=k.useMemo(()=>{const q=new Date,se=new Date(q.getFullYear(),q.getMonth(),q.getDate()-6),X=q,Q=he=>he.toLocaleDateString(n==="es"?"es-ES":"en-US",{weekday:"short",day:"2-digit",month:"short"}).replace(".","");return`${Q(se)}  ${Q(X)}`},[n]),J=q=>{var we;const se=q.data()||{};let X;if((we=se.fecha)!=null&&we.toDate){X=se.fecha.toDate();const Ne=se.horaInicio||se.hora;if(Ne&&typeof Ne=="string"){const[ze=0,Se=0]=Ne.split(":").map(Fe=>parseInt(Fe,10));X.setHours(ze||0,Se||0,0,0)}}else if(typeof se.fecha=="string"){const Ne=se.horaInicio||se.hora||"00:00";X=YU(se.fecha,Ne)}else X=new Date;const Q=se.pacienteNombre||se.paciente||"Paciente",he=se.estado&&String(se.estado)||"programada";return{id:q.id,fecha:X,pacienteId:se.pacienteId||"",pacienteNombre:Q,estado:he,motivo:se.motivo||""}};k.useEffect(()=>{const q=rt($e(ye,"citas"),Je("fecha",">=",P),Je("fecha","<",Y),Yt("fecha","asc")),se=rt($e(ye,"citas"),Je("fecha","==",Mt));let X=new Map,Q=!1,he=!1;const we=()=>{const Se=Array.from(X.values()).sort((pe,He)=>pe.fecha.getTime()-He.fecha.getTime()),Fe=Se.filter(pe=>String(pe.estado).toLowerCase().trim()==="en espera").length;C(Se),j(pe=>({...pe,citasHoy:Se.length,enEspera:Fe})),Q&&he&&D(!1)},Ne=or(q,Se=>{Q=!0;const Fe=new Map(X);Se.docs.forEach(pe=>Fe.set(pe.id,J(pe))),X=Fe,we()},Se=>{console.error("Realtime citas hoy (TS):",Se),Q=!0,we()}),ze=or(se,Se=>{he=!0;const Fe=new Map(X);Se.docs.forEach(pe=>Fe.set(pe.id,J(pe))),X=Fe,we()},Se=>{console.error("Realtime citas hoy (STR):",Se),he=!0,we()});return()=>{try{Ne(),ze()}catch{}}},[P,Y,Mt]),k.useEffect(()=>{(async()=>{try{const X=(await jM($e(ye,"pacientes"))).data().count||0;let Q=0;try{const he=rt($e(ye,"facturas"),Je("fecha",">=",P),Je("fecha","<",Y));(await Gt(he)).forEach(Ne=>{const ze=Ne.data();typeof ze.monto=="number"&&(Q+=ze.monto)})}catch{Q=0}j(he=>({...he,pacientesHoy:X,facturacionHoy:Q}))}catch(se){console.error("Error cargando mtricas:",se),j(X=>({...X,pacientesHoy:0,facturacionHoy:0}))}finally{M(!1)}})()},[P,Y]),k.useEffect(()=>{const q=new Date,se=new Date(q.getFullYear(),q.getMonth(),q.getDate()-6),X=new Date(q.getFullYear(),q.getMonth(),q.getDate()+1),Q=new Map;for(let Ne=0;Ne<7;Ne++){const ze=new Date(q.getFullYear(),q.getMonth(),q.getDate()-(6-Ne)),Se=ze.toISOString().slice(0,10),Fe=ze.toLocaleDateString(n==="es"?"es-ES":"en-US"),pe=ze.toLocaleDateString(n==="es"?"es-ES":"en-US",{weekday:"short",day:"2-digit"}).replace(".","");Q.set(Se,{label:Fe,shortLabel:pe,value:0})}const he=rt($e(ye,"pacientes"),Je("createdAt",">=",Be.fromDate(se)),Je("createdAt","<",Be.fromDate(X))),we=or(he,Ne=>{const ze=new Map(Q);Ne.docs.forEach(Se=>{var Z;const Fe=Se.data()||{},pe=(Z=Se.data().createdAt)!=null&&Z.toDate?Se.data().createdAt.toDate():Fe.createdAt?new Date(Fe.createdAt):null;if(!pe||isNaN(pe))return;const He=pe.toISOString().slice(0,10);if(!ze.has(He))return;const F=ze.get(He);F.value+=1,ze.set(He,F)}),_(Array.from(ze.values()))},Ne=>{console.error("Error realtime serie semanal (pacientes):",Ne),_(Array.from(Q.values()))});return()=>{try{we()}catch{}}},[n]);const[ue,G]=k.useState([]),[je,Ke]=k.useState(!0);k.useEffect(()=>{(async()=>{try{const se=rt($e(ye,"actividad"),Yt("fecha","desc"),Zo(5)),X=await Gt(se);G(X.docs.map(Q=>({id:Q.id,title:Q.data().descripcion||Q.data().titulo||"Actividad",time:Q.data().resumenTiempo||""})))}catch(se){console.error("Error cargando actividad:",se),G([])}finally{Ke(!1)}})()},[]);const[B,ne]=k.useState(null),[de,Ie]=k.useState(!0);k.useEffect(()=>{(async()=>{try{const se=Qt(ye,"integraciones","n8n"),X=await ih(se);ne(X.exists()?{connected:!!X.data().connected,flowsRunning:X.data().flowsRunning||0,lastError:X.data().lastError||null}:{connected:!1,flowsRunning:0,lastError:null})}catch(se){console.error("Error cargando estado n8n:",se),ne({connected:!1,flowsRunning:0,lastError:"No se pudo leer el estado desde Firebase."})}finally{Ie(!1)}})()},[]);const xe=async()=>{try{localStorage.removeItem("odc_session")}catch{}try{await Uj(ch)}catch(q){console.error("Error al cerrar sesin:",q)}window.location.href="/"},[ke,ge]=k.useState(!1),[Xe,be]=k.useState(null),re=k.useRef(null);k.useRef(null);const Oe=()=>{var se,X;const q=(X=(se=re.current)==null?void 0:se.getBoundingClientRect)==null?void 0:X.call(se);be(q),ge(!0)};k.useEffect(()=>{const q=e.pathname.toLowerCase(),se=q.includes("/pacientes"),X=q.includes("/caja"),Q=q.includes("/agenda"),he=q.includes("/facturacion"),we=q.includes("/inventario"),Ne=q.includes("/odontograma"),ze=q.includes("/reportes");i(se?"Pacientes":X?"Caja":Q?"Agenda":we?"Inventario":Ne?"Odontograma":ze?"Reportes":"Inicio"),he&&(i("Facturacin"),q.includes("/pagos")?a("pagos"):q.includes("/facturas")?a("fv"):q.includes("/recibo")?a("recibo"):q.includes("/saldo")?a("saldo"):q.includes("/nc")?a("nc"):q.includes("/nd")?a("nd"):q.includes("/liq")?a("liq"):q.includes("/tras")?a("tras"):q.includes("/oc")?a("oc"):q.includes("/fc")?a("fc"):a("recibo"))},[e.pathname]);const it=k.useMemo(()=>{const q=e.pathname.split("/").filter(Boolean),se=q.findIndex(X=>X.startsWith("dashboard_"));return se>=0?`/${q.slice(0,se+1).join("/")}`:""},[e.pathname]),Ge=(q="")=>{const se=String(q).replace(/^\/+|\/+$/g,""),X=se?`${it}/${se}`:it||"/",Q=e.pathname.toLowerCase()===X.toLowerCase();t(X,{replace:Q})},ft=()=>{switch(s){case"Agenda":return u.jsx(bU,{});case"Pacientes":return u.jsx(k.Suspense,{fallback:u.jsx("div",{style:{padding:16},children:"Cargando"}),children:u.jsx(OU,{})});case"Facturacin":return u.jsx(CU,{view:o});case"Inventario":return u.jsx(AU,{});case"Odontograma":return u.jsx(RU,{});case"Reportes":return u.jsx(MU,{});case"Caja":return u.jsx(zU,{});case"Inicio":default:return null}};return u.jsxs("div",{className:`oc-shell ${l?"oc-dark":""}`,children:[u.jsx("a",{href:"#oc-main",className:"oc-skip-link",children:"Saltar al contenido"}),u.jsxs("header",{className:"oc-header",role:"banner",children:[u.jsxs("div",{className:"oc-header-left",children:[u.jsx("img",{src:_A,alt:"OdontoCloud",className:"oc-logo"}),u.jsxs("div",{className:"oc-brand-text",children:[u.jsx("span",{className:"oc-brand-main",children:"OdontoCloud"}),u.jsx("span",{className:"oc-brand-sub",children:I?"...":v})]})]}),u.jsxs("nav",{className:"oc-nav",role:"navigation","aria-label":"Navegacin principal",children:[u.jsx(xo,{to:it,end:!0,className:({isActive:q})=>q&&s==="Inicio"?"oc-nav-btn active":"oc-nav-btn",title:r("nav_home"),children:r("nav_home")}),u.jsx(xo,{to:`${it}/agenda`,className:({isActive:q})=>q||s==="Agenda"?"oc-nav-btn active":"oc-nav-btn",title:r("nav_agenda"),children:r("nav_agenda")}),u.jsx(xo,{to:`${it}/pacientes`,className:({isActive:q})=>q||s==="Pacientes"?"oc-nav-btn active":"oc-nav-btn",title:r("nav_patients"),children:r("nav_patients")}),u.jsx(xo,{to:`${it}/caja`,className:({isActive:q})=>q||s==="Caja"?"oc-nav-btn active":"oc-nav-btn",title:r("nav_cash"),children:r("nav_cash")}),u.jsx("button",{type:"button",ref:re,className:"oc-nav-btn",title:r("nav_admin"),"aria-haspopup":"true","aria-expanded":ke,onClick:()=>ke?ge(!1):Oe(),onMouseEnter:()=>Oe(),onFocus:()=>Oe(),children:r("nav_admin")}),u.jsx(xo,{to:`${it}/reportes`,className:({isActive:q})=>q||s==="Reportes"?"oc-nav-btn active":"oc-nav-btn",title:r("nav_reports"),children:r("nav_reports")})]}),u.jsxs("div",{className:"oc-header-right",children:[u.jsx(JU,{placeholder:r("searchPlaceholder"),onNavigate:q=>{q==="Inicio"?Ge(""):q==="Facturacin"?(a("recibo"),Ge("facturacion/recibo")):Ge(q.toLowerCase())},onAction:q=>{switch(q){case"new_appointment":case"agenda_today":case"export_agenda":Ge("agenda");break;case"new_patient":Ge("pacientes");break;case"new_invoice":a("fv"),Ge("facturacion/facturas");break;case"toggle_dark":d(se=>!se);break;case"logout":xe();break;case"show_shortcuts":alert("Atajos: Ctrl/Cmd + K para abrir bsqueda, / para moverse, Enter para ejecutar.");break;case"support":window.open("https://tu-soporte.odc","_blank");break}}}),u.jsx("button",{className:"oc-icon-btn",type:"button",onClick:()=>d(q=>!q),"aria-pressed":l,title:l?"Activar modo claro":"Activar modo oscuro",children:l?"":""}),u.jsx("button",{className:"oc-icon-btn",type:"button",onClick:xe,title:Pp[n].logout,children:Pp[n].logout})]})]}),u.jsx(ZU,{open:ke,anchorRect:Xe,dark:l,onClose:()=>ge(!1),onSoon:()=>{alert("Prximamente"),ge(!1)},onNavigatePath:q=>{Ge(q),ge(!1)},onSetFactView:q=>a(q)}),u.jsxs("main",{id:"oc-main",className:"oc-main-wrapper",role:"main",children:[s!=="Inicio"&&ft(),s==="Inicio"&&u.jsx(e6,{t:r,companyName:v,userName:b,role:f,darkMode:l,weeklySeries:T,weekRangeLabel:Zt,todaysAppointments:S,todaysLoading:N,metrics:y,metricsLoading:V,n8nState:B,n8nLoading:de,recent:ue,recentLoading:je,onGoAgenda:()=>Ge("agenda")})]})]})}const $A=()=>{try{const t=JSON.parse(localStorage.getItem("odc_session"));return t&&Date.now()-t.timestamp<1e3*60*60*24?t:null}catch{return null}},BA=t=>{const e=(t||"").toLowerCase();return e==="administrador"?"/dashboard_admin":e==="doctor"?"/dashboard_doctor":e==="recepcionista"?"/dashboard_recepcion":"/"};function Np({allowedRoles:t,children:e}){var s;const n=$A();if(!n)return u.jsx(Nd,{to:"/",replace:!0});const r=(s=n.rol)==null?void 0:s.toLowerCase();return t.map(i=>i.toLowerCase()).includes(r)?e:u.jsx(Nd,{to:BA(n.rol),replace:!0})}function t6(){const t=$A();return u.jsxs(bk,{children:[u.jsx(To,{path:"/",element:t?u.jsx(Nd,{to:BA(t.rol),replace:!0}):u.jsx(n4,{})}),u.jsx(To,{path:"/dashboard_admin/*",element:u.jsx(Np,{allowedRoles:["administrador"],children:u.jsx(kp,{})})}),u.jsx(To,{path:"/dashboard_doctor/*",element:u.jsx(Np,{allowedRoles:["doctor"],children:u.jsx(kp,{})})}),u.jsx(To,{path:"/dashboard_recepcion/*",element:u.jsx(Np,{allowedRoles:["recepcionista"],children:u.jsx(kp,{})})}),u.jsx(To,{path:"*",element:u.jsx(Nd,{to:"/",replace:!0})})]})}async function n6(){try{await Lj(ch,DS),await _M(ye),console.log(" Firebase listo con sesin persistente y modo offline.")}catch(t){console.warn(" Firebase offline/persistencia fall:",t.message)}}const r6="modulepreload",s6=function(t){return"/odontocloud-react/"+t},dT={},i6=function(e,n,r){let s=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),a=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));s=Promise.allSettled(n.map(l=>{if(l=s6(l),l in dT)return;dT[l]=!0;const d=l.endsWith(".css"),h=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${h}`))return;const f=document.createElement("link");if(f.rel=d?"stylesheet":r6,d||(f.as="script"),f.crossOrigin="",f.href=l,a&&f.setAttribute("nonce",a),document.head.appendChild(f),d)return new Promise((m,v)=>{f.addEventListener("load",m),f.addEventListener("error",()=>v(new Error(`Unable to preload CSS for ${l}`)))})}))}function i(o){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=o,window.dispatchEvent(a),!a.defaultPrevented)throw o}return s.then(o=>{for(const a of o||[])a.status==="rejected"&&i(a.reason);return e().catch(i)})};function o6(t={}){const{immediate:e=!1,onNeedRefresh:n,onOfflineReady:r,onRegistered:s,onRegisteredSW:i,onRegisterError:o}=t;let a,l;const d=async(f=!0)=>{await l};async function h(){if("serviceWorker"in navigator){if(a=await i6(async()=>{const{Workbox:f}=await import("./workbox-window.prod.es5-vqzQaGvo.js");return{Workbox:f}},[]).then(({Workbox:f})=>new f("/odontocloud-react/sw.js",{scope:"/odontocloud-react/",type:"classic"})).catch(f=>{o==null||o(f)}),!a)return;a.addEventListener("activated",f=>{(f.isUpdate||f.isExternal)&&window.location.reload()}),a.addEventListener("installed",f=>{f.isUpdate||r==null||r()}),a.register({immediate:e}).then(f=>{i?i("/odontocloud-react/sw.js",f):s==null||s(f)}).catch(f=>{o==null||o(f)})}}return l=h(),d}const a6="/odontocloud-react/";n6();o6({immediate:!0});Cx(document.getElementById("root")).render(u.jsx(xT.StrictMode,{children:u.jsx(Qk,{basename:a6,children:u.jsx(t6,{})})}));
