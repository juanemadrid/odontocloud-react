(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();function nR(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var uT={exports:{}},ah={},dT={exports:{}},Re={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var _c=Symbol.for("react.element"),rR=Symbol.for("react.portal"),iR=Symbol.for("react.fragment"),sR=Symbol.for("react.strict_mode"),oR=Symbol.for("react.profiler"),aR=Symbol.for("react.provider"),lR=Symbol.for("react.context"),cR=Symbol.for("react.forward_ref"),uR=Symbol.for("react.suspense"),dR=Symbol.for("react.memo"),hR=Symbol.for("react.lazy"),yv=Symbol.iterator;function fR(t){return t===null||typeof t!="object"?null:(t=yv&&t[yv]||t["@@iterator"],typeof t=="function"?t:null)}var hT={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},fT=Object.assign,pT={};function Ia(t,e,n){this.props=t,this.context=e,this.refs=pT,this.updater=n||hT}Ia.prototype.isReactComponent={};Ia.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Ia.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function mT(){}mT.prototype=Ia.prototype;function og(t,e,n){this.props=t,this.context=e,this.refs=pT,this.updater=n||hT}var ag=og.prototype=new mT;ag.constructor=og;fT(ag,Ia.prototype);ag.isPureReactComponent=!0;var _v=Array.isArray,gT=Object.prototype.hasOwnProperty,lg={current:null},yT={key:!0,ref:!0,__self:!0,__source:!0};function _T(t,e,n){var r,i={},s=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(s=""+e.key),e)gT.call(e,r)&&!yT.hasOwnProperty(r)&&(i[r]=e[r]);var a=arguments.length-2;if(a===1)i.children=n;else if(1<a){for(var l=Array(a),d=0;d<a;d++)l[d]=arguments[d+2];i.children=l}if(t&&t.defaultProps)for(r in a=t.defaultProps,a)i[r]===void 0&&(i[r]=a[r]);return{$$typeof:_c,type:t,key:s,ref:o,props:i,_owner:lg.current}}function pR(t,e){return{$$typeof:_c,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function cg(t){return typeof t=="object"&&t!==null&&t.$$typeof===_c}function mR(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var vv=/\/+/g;function Af(t,e){return typeof t=="object"&&t!==null&&t.key!=null?mR(""+t.key):e.toString(36)}function Ru(t,e,n,r,i){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case _c:case rR:o=!0}}if(o)return o=t,i=i(o),t=r===""?"."+Af(o,0):r,_v(i)?(n="",t!=null&&(n=t.replace(vv,"$&/")+"/"),Ru(i,e,n,"",function(d){return d})):i!=null&&(cg(i)&&(i=pR(i,n+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(vv,"$&/")+"/")+t)),e.push(i)),1;if(o=0,r=r===""?".":r+":",_v(t))for(var a=0;a<t.length;a++){s=t[a];var l=r+Af(s,a);o+=Ru(s,e,n,l,i)}else if(l=fR(t),typeof l=="function")for(t=l.call(t),a=0;!(s=t.next()).done;)s=s.value,l=r+Af(s,a++),o+=Ru(s,e,n,l,i);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function Zc(t,e,n){if(t==null)return t;var r=[],i=0;return Ru(t,r,"","",function(s){return e.call(n,s,i++)}),r}function gR(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var gn={current:null},Pu={transition:null},yR={ReactCurrentDispatcher:gn,ReactCurrentBatchConfig:Pu,ReactCurrentOwner:lg};function vT(){throw Error("act(...) is not supported in production builds of React.")}Re.Children={map:Zc,forEach:function(t,e,n){Zc(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return Zc(t,function(){e++}),e},toArray:function(t){return Zc(t,function(e){return e})||[]},only:function(t){if(!cg(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Re.Component=Ia;Re.Fragment=iR;Re.Profiler=oR;Re.PureComponent=og;Re.StrictMode=sR;Re.Suspense=uR;Re.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=yR;Re.act=vT;Re.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=fT({},t.props),i=t.key,s=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,o=lg.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(l in e)gT.call(e,l)&&!yT.hasOwnProperty(l)&&(r[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)r.children=n;else if(1<l){a=Array(l);for(var d=0;d<l;d++)a[d]=arguments[d+2];r.children=a}return{$$typeof:_c,type:t.type,key:i,ref:s,props:r,_owner:o}};Re.createContext=function(t){return t={$$typeof:lR,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:aR,_context:t},t.Consumer=t};Re.createElement=_T;Re.createFactory=function(t){var e=_T.bind(null,t);return e.type=t,e};Re.createRef=function(){return{current:null}};Re.forwardRef=function(t){return{$$typeof:cR,render:t}};Re.isValidElement=cg;Re.lazy=function(t){return{$$typeof:hR,_payload:{_status:-1,_result:t},_init:gR}};Re.memo=function(t,e){return{$$typeof:dR,type:t,compare:e===void 0?null:e}};Re.startTransition=function(t){var e=Pu.transition;Pu.transition={};try{t()}finally{Pu.transition=e}};Re.unstable_act=vT;Re.useCallback=function(t,e){return gn.current.useCallback(t,e)};Re.useContext=function(t){return gn.current.useContext(t)};Re.useDebugValue=function(){};Re.useDeferredValue=function(t){return gn.current.useDeferredValue(t)};Re.useEffect=function(t,e){return gn.current.useEffect(t,e)};Re.useId=function(){return gn.current.useId()};Re.useImperativeHandle=function(t,e,n){return gn.current.useImperativeHandle(t,e,n)};Re.useInsertionEffect=function(t,e){return gn.current.useInsertionEffect(t,e)};Re.useLayoutEffect=function(t,e){return gn.current.useLayoutEffect(t,e)};Re.useMemo=function(t,e){return gn.current.useMemo(t,e)};Re.useReducer=function(t,e,n){return gn.current.useReducer(t,e,n)};Re.useRef=function(t){return gn.current.useRef(t)};Re.useState=function(t){return gn.current.useState(t)};Re.useSyncExternalStore=function(t,e,n){return gn.current.useSyncExternalStore(t,e,n)};Re.useTransition=function(){return gn.current.useTransition()};Re.version="18.3.1";dT.exports=Re;var N=dT.exports;const _R=nR(N);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var vR=N,wR=Symbol.for("react.element"),ER=Symbol.for("react.fragment"),IR=Object.prototype.hasOwnProperty,TR=vR.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,xR={key:!0,ref:!0,__self:!0,__source:!0};function wT(t,e,n){var r,i={},s=null,o=null;n!==void 0&&(s=""+n),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)IR.call(e,r)&&!xR.hasOwnProperty(r)&&(i[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)i[r]===void 0&&(i[r]=e[r]);return{$$typeof:wR,type:t,key:s,ref:o,props:i,_owner:TR.current}}ah.Fragment=ER;ah.jsx=wT;ah.jsxs=wT;uT.exports=ah;var u=uT.exports,ET={exports:{}},Vn={},IT={exports:{}},TT={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(X,ce){var pe=X.length;X.push(ce);e:for(;0<pe;){var ke=pe-1>>>1,Be=X[ke];if(0<i(Be,ce))X[ke]=ce,X[pe]=Be,pe=ke;else break e}}function n(X){return X.length===0?null:X[0]}function r(X){if(X.length===0)return null;var ce=X[0],pe=X.pop();if(pe!==ce){X[0]=pe;e:for(var ke=0,Be=X.length,$=Be>>>1;ke<$;){var J=2*(ke+1)-1,le=X[J],ue=J+1,Ie=X[ue];if(0>i(le,pe))ue<Be&&0>i(Ie,le)?(X[ke]=Ie,X[ue]=pe,ke=ue):(X[ke]=le,X[J]=pe,ke=J);else if(ue<Be&&0>i(Ie,pe))X[ke]=Ie,X[ue]=pe,ke=ue;else break e}}return ce}function i(X,ce){var pe=X.sortIndex-ce.sortIndex;return pe!==0?pe:X.id-ce.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var l=[],d=[],h=1,f=null,m=3,_=!1,R=!1,C=!1,y=typeof setTimeout=="function"?setTimeout:null,I=typeof clearTimeout=="function"?clearTimeout:null,w=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function E(X){for(var ce=n(d);ce!==null;){if(ce.callback===null)r(d);else if(ce.startTime<=X)r(d),ce.sortIndex=ce.expirationTime,e(l,ce);else break;ce=n(d)}}function O(X){if(C=!1,E(X),!R)if(n(l)!==null)R=!0,Pt(D);else{var ce=n(d);ce!==null&&$t(O,ce.startTime-X)}}function D(X,ce){R=!1,C&&(C=!1,I(v),v=-1),_=!0;var pe=m;try{for(E(ce),f=n(l);f!==null&&(!(f.expirationTime>ce)||X&&!j());){var ke=f.callback;if(typeof ke=="function"){f.callback=null,m=f.priorityLevel;var Be=ke(f.expirationTime<=ce);ce=t.unstable_now(),typeof Be=="function"?f.callback=Be:f===n(l)&&r(l),E(ce)}else r(l);f=n(l)}if(f!==null)var $=!0;else{var J=n(d);J!==null&&$t(O,J.startTime-ce),$=!1}return $}finally{f=null,m=pe,_=!1}}var B=!1,x=null,v=-1,b=5,A=-1;function j(){return!(t.unstable_now()-A<b)}function V(){if(x!==null){var X=t.unstable_now();A=X;var ce=!0;try{ce=x(!0,X)}finally{ce?P():(B=!1,x=null)}}else B=!1}var P;if(typeof w=="function")P=function(){w(V)};else if(typeof MessageChannel<"u"){var q=new MessageChannel,qe=q.port2;q.port1.onmessage=V,P=function(){qe.postMessage(null)}}else P=function(){y(V,0)};function Pt(X){x=X,B||(B=!0,P())}function $t(X,ce){v=y(function(){X(t.unstable_now())},ce)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(X){X.callback=null},t.unstable_continueExecution=function(){R||_||(R=!0,Pt(D))},t.unstable_forceFrameRate=function(X){0>X||125<X?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):b=0<X?Math.floor(1e3/X):5},t.unstable_getCurrentPriorityLevel=function(){return m},t.unstable_getFirstCallbackNode=function(){return n(l)},t.unstable_next=function(X){switch(m){case 1:case 2:case 3:var ce=3;break;default:ce=m}var pe=m;m=ce;try{return X()}finally{m=pe}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(X,ce){switch(X){case 1:case 2:case 3:case 4:case 5:break;default:X=3}var pe=m;m=X;try{return ce()}finally{m=pe}},t.unstable_scheduleCallback=function(X,ce,pe){var ke=t.unstable_now();switch(typeof pe=="object"&&pe!==null?(pe=pe.delay,pe=typeof pe=="number"&&0<pe?ke+pe:ke):pe=ke,X){case 1:var Be=-1;break;case 2:Be=250;break;case 5:Be=1073741823;break;case 4:Be=1e4;break;default:Be=5e3}return Be=pe+Be,X={id:h++,callback:ce,priorityLevel:X,startTime:pe,expirationTime:Be,sortIndex:-1},pe>ke?(X.sortIndex=pe,e(d,X),n(l)===null&&X===n(d)&&(C?(I(v),v=-1):C=!0,$t(O,pe-ke))):(X.sortIndex=Be,e(l,X),R||_||(R=!0,Pt(D))),X},t.unstable_shouldYield=j,t.unstable_wrapCallback=function(X){var ce=m;return function(){var pe=m;m=ce;try{return X.apply(this,arguments)}finally{m=pe}}}})(TT);IT.exports=TT;var SR=IT.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var bR=N,jn=SR;function W(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var xT=new Set,Ul={};function eo(t,e){ta(t,e),ta(t+"Capture",e)}function ta(t,e){for(Ul[t]=e,t=0;t<e.length;t++)xT.add(e[t])}var qr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Rp=Object.prototype.hasOwnProperty,CR=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,wv={},Ev={};function AR(t){return Rp.call(Ev,t)?!0:Rp.call(wv,t)?!1:CR.test(t)?Ev[t]=!0:(wv[t]=!0,!1)}function RR(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function PR(t,e,n,r){if(e===null||typeof e>"u"||RR(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function yn(t,e,n,r,i,s,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=o}var Qt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Qt[t]=new yn(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Qt[e]=new yn(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Qt[t]=new yn(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Qt[t]=new yn(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Qt[t]=new yn(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Qt[t]=new yn(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Qt[t]=new yn(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Qt[t]=new yn(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Qt[t]=new yn(t,5,!1,t.toLowerCase(),null,!1,!1)});var ug=/[\-:]([a-z])/g;function dg(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(ug,dg);Qt[e]=new yn(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(ug,dg);Qt[e]=new yn(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(ug,dg);Qt[e]=new yn(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Qt[t]=new yn(t,1,!1,t.toLowerCase(),null,!1,!1)});Qt.xlinkHref=new yn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Qt[t]=new yn(t,1,!1,t.toLowerCase(),null,!0,!0)});function hg(t,e,n,r){var i=Qt.hasOwnProperty(e)?Qt[e]:null;(i!==null?i.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(PR(e,n,i,r)&&(n=null),r||i===null?AR(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):i.mustUseProperty?t[i.propertyName]=n===null?i.type===3?!1:"":n:(e=i.attributeName,r=i.attributeNamespace,n===null?t.removeAttribute(e):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var ei=bR.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,eu=Symbol.for("react.element"),Ao=Symbol.for("react.portal"),Ro=Symbol.for("react.fragment"),fg=Symbol.for("react.strict_mode"),Pp=Symbol.for("react.profiler"),ST=Symbol.for("react.provider"),bT=Symbol.for("react.context"),pg=Symbol.for("react.forward_ref"),Np=Symbol.for("react.suspense"),kp=Symbol.for("react.suspense_list"),mg=Symbol.for("react.memo"),mi=Symbol.for("react.lazy"),CT=Symbol.for("react.offscreen"),Iv=Symbol.iterator;function Wa(t){return t===null||typeof t!="object"?null:(t=Iv&&t[Iv]||t["@@iterator"],typeof t=="function"?t:null)}var ft=Object.assign,Rf;function ll(t){if(Rf===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);Rf=e&&e[1]||""}return`
`+Rf+t}var Pf=!1;function Nf(t,e){if(!t||Pf)return"";Pf=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(d){var r=d}Reflect.construct(t,[],e)}else{try{e.call()}catch(d){r=d}t.call(e.prototype)}else{try{throw Error()}catch(d){r=d}t()}}catch(d){if(d&&r&&typeof d.stack=="string"){for(var i=d.stack.split(`
`),s=r.stack.split(`
`),o=i.length-1,a=s.length-1;1<=o&&0<=a&&i[o]!==s[a];)a--;for(;1<=o&&0<=a;o--,a--)if(i[o]!==s[a]){if(o!==1||a!==1)do if(o--,a--,0>a||i[o]!==s[a]){var l=`
`+i[o].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=o&&0<=a);break}}}finally{Pf=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?ll(t):""}function NR(t){switch(t.tag){case 5:return ll(t.type);case 16:return ll("Lazy");case 13:return ll("Suspense");case 19:return ll("SuspenseList");case 0:case 2:case 15:return t=Nf(t.type,!1),t;case 11:return t=Nf(t.type.render,!1),t;case 1:return t=Nf(t.type,!0),t;default:return""}}function Dp(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Ro:return"Fragment";case Ao:return"Portal";case Pp:return"Profiler";case fg:return"StrictMode";case Np:return"Suspense";case kp:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case bT:return(t.displayName||"Context")+".Consumer";case ST:return(t._context.displayName||"Context")+".Provider";case pg:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case mg:return e=t.displayName||null,e!==null?e:Dp(t.type)||"Memo";case mi:e=t._payload,t=t._init;try{return Dp(t(e))}catch{}}return null}function kR(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Dp(e);case 8:return e===fg?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function zi(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function AT(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function DR(t){var e=AT(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,s=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(o){r=""+o,s.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function tu(t){t._valueTracker||(t._valueTracker=DR(t))}function RT(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=AT(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function sd(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function jp(t,e){var n=e.checked;return ft({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function Tv(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=zi(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function PT(t,e){e=e.checked,e!=null&&hg(t,"checked",e,!1)}function Op(t,e){PT(t,e);var n=zi(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Vp(t,e.type,n):e.hasOwnProperty("defaultValue")&&Vp(t,e.type,zi(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function xv(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function Vp(t,e,n){(e!=="number"||sd(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var cl=Array.isArray;function Bo(t,e,n,r){if(t=t.options,e){e={};for(var i=0;i<n.length;i++)e["$"+n[i]]=!0;for(n=0;n<t.length;n++)i=e.hasOwnProperty("$"+t[n].value),t[n].selected!==i&&(t[n].selected=i),i&&r&&(t[n].defaultSelected=!0)}else{for(n=""+zi(n),e=null,i=0;i<t.length;i++){if(t[i].value===n){t[i].selected=!0,r&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function Lp(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(W(91));return ft({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function Sv(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(W(92));if(cl(n)){if(1<n.length)throw Error(W(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:zi(n)}}function NT(t,e){var n=zi(e.value),r=zi(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function bv(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function kT(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Mp(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?kT(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var nu,DT=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,i){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(nu=nu||document.createElement("div"),nu.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=nu.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Bl(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var El={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},jR=["Webkit","ms","Moz","O"];Object.keys(El).forEach(function(t){jR.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),El[e]=El[t]})});function jT(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||El.hasOwnProperty(t)&&El[t]?(""+e).trim():e+"px"}function OT(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=jT(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,i):t[n]=i}}var OR=ft({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Fp(t,e){if(e){if(OR[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(W(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(W(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(W(61))}if(e.style!=null&&typeof e.style!="object")throw Error(W(62))}}function Up(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Bp=null;function gg(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var $p=null,$o=null,zo=null;function Cv(t){if(t=Ec(t)){if(typeof $p!="function")throw Error(W(280));var e=t.stateNode;e&&(e=hh(e),$p(t.stateNode,t.type,e))}}function VT(t){$o?zo?zo.push(t):zo=[t]:$o=t}function LT(){if($o){var t=$o,e=zo;if(zo=$o=null,Cv(t),e)for(t=0;t<e.length;t++)Cv(e[t])}}function MT(t,e){return t(e)}function FT(){}var kf=!1;function UT(t,e,n){if(kf)return t(e,n);kf=!0;try{return MT(t,e,n)}finally{kf=!1,($o!==null||zo!==null)&&(FT(),LT())}}function $l(t,e){var n=t.stateNode;if(n===null)return null;var r=hh(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(W(231,e,typeof n));return n}var zp=!1;if(qr)try{var Ka={};Object.defineProperty(Ka,"passive",{get:function(){zp=!0}}),window.addEventListener("test",Ka,Ka),window.removeEventListener("test",Ka,Ka)}catch{zp=!1}function VR(t,e,n,r,i,s,o,a,l){var d=Array.prototype.slice.call(arguments,3);try{e.apply(n,d)}catch(h){this.onError(h)}}var Il=!1,od=null,ad=!1,qp=null,LR={onError:function(t){Il=!0,od=t}};function MR(t,e,n,r,i,s,o,a,l){Il=!1,od=null,VR.apply(LR,arguments)}function FR(t,e,n,r,i,s,o,a,l){if(MR.apply(this,arguments),Il){if(Il){var d=od;Il=!1,od=null}else throw Error(W(198));ad||(ad=!0,qp=d)}}function to(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function BT(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function Av(t){if(to(t)!==t)throw Error(W(188))}function UR(t){var e=t.alternate;if(!e){if(e=to(t),e===null)throw Error(W(188));return e!==t?null:t}for(var n=t,r=e;;){var i=n.return;if(i===null)break;var s=i.alternate;if(s===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===n)return Av(i),t;if(s===r)return Av(i),e;s=s.sibling}throw Error(W(188))}if(n.return!==r.return)n=i,r=s;else{for(var o=!1,a=i.child;a;){if(a===n){o=!0,n=i,r=s;break}if(a===r){o=!0,r=i,n=s;break}a=a.sibling}if(!o){for(a=s.child;a;){if(a===n){o=!0,n=s,r=i;break}if(a===r){o=!0,r=s,n=i;break}a=a.sibling}if(!o)throw Error(W(189))}}if(n.alternate!==r)throw Error(W(190))}if(n.tag!==3)throw Error(W(188));return n.stateNode.current===n?t:e}function $T(t){return t=UR(t),t!==null?zT(t):null}function zT(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=zT(t);if(e!==null)return e;t=t.sibling}return null}var qT=jn.unstable_scheduleCallback,Rv=jn.unstable_cancelCallback,BR=jn.unstable_shouldYield,$R=jn.unstable_requestPaint,It=jn.unstable_now,zR=jn.unstable_getCurrentPriorityLevel,yg=jn.unstable_ImmediatePriority,HT=jn.unstable_UserBlockingPriority,ld=jn.unstable_NormalPriority,qR=jn.unstable_LowPriority,WT=jn.unstable_IdlePriority,lh=null,br=null;function HR(t){if(br&&typeof br.onCommitFiberRoot=="function")try{br.onCommitFiberRoot(lh,t,void 0,(t.current.flags&128)===128)}catch{}}var sr=Math.clz32?Math.clz32:GR,WR=Math.log,KR=Math.LN2;function GR(t){return t>>>=0,t===0?32:31-(WR(t)/KR|0)|0}var ru=64,iu=4194304;function ul(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function cd(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,i=t.suspendedLanes,s=t.pingedLanes,o=n&268435455;if(o!==0){var a=o&~i;a!==0?r=ul(a):(s&=o,s!==0&&(r=ul(s)))}else o=n&~i,o!==0?r=ul(o):s!==0&&(r=ul(s));if(r===0)return 0;if(e!==0&&e!==r&&!(e&i)&&(i=r&-r,s=e&-e,i>=s||i===16&&(s&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-sr(e),i=1<<n,r|=t[n],e&=~i;return r}function QR(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function YR(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,i=t.expirationTimes,s=t.pendingLanes;0<s;){var o=31-sr(s),a=1<<o,l=i[o];l===-1?(!(a&n)||a&r)&&(i[o]=QR(a,e)):l<=e&&(t.expiredLanes|=a),s&=~a}}function Hp(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function KT(){var t=ru;return ru<<=1,!(ru&4194240)&&(ru=64),t}function Df(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function vc(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-sr(e),t[e]=n}function XR(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var i=31-sr(n),s=1<<i;e[i]=0,r[i]=-1,t[i]=-1,n&=~s}}function _g(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-sr(n),i=1<<r;i&e|t[r]&e&&(t[r]|=e),n&=~i}}var We=0;function GT(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var QT,vg,YT,XT,JT,Wp=!1,su=[],Ri=null,Pi=null,Ni=null,zl=new Map,ql=new Map,yi=[],JR="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Pv(t,e){switch(t){case"focusin":case"focusout":Ri=null;break;case"dragenter":case"dragleave":Pi=null;break;case"mouseover":case"mouseout":Ni=null;break;case"pointerover":case"pointerout":zl.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":ql.delete(e.pointerId)}}function Ga(t,e,n,r,i,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:s,targetContainers:[i]},e!==null&&(e=Ec(e),e!==null&&vg(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function ZR(t,e,n,r,i){switch(e){case"focusin":return Ri=Ga(Ri,t,e,n,r,i),!0;case"dragenter":return Pi=Ga(Pi,t,e,n,r,i),!0;case"mouseover":return Ni=Ga(Ni,t,e,n,r,i),!0;case"pointerover":var s=i.pointerId;return zl.set(s,Ga(zl.get(s)||null,t,e,n,r,i)),!0;case"gotpointercapture":return s=i.pointerId,ql.set(s,Ga(ql.get(s)||null,t,e,n,r,i)),!0}return!1}function ZT(t){var e=Is(t.target);if(e!==null){var n=to(e);if(n!==null){if(e=n.tag,e===13){if(e=BT(n),e!==null){t.blockedOn=e,JT(t.priority,function(){YT(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Nu(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=Kp(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);Bp=r,n.target.dispatchEvent(r),Bp=null}else return e=Ec(n),e!==null&&vg(e),t.blockedOn=n,!1;e.shift()}return!0}function Nv(t,e,n){Nu(t)&&n.delete(e)}function eP(){Wp=!1,Ri!==null&&Nu(Ri)&&(Ri=null),Pi!==null&&Nu(Pi)&&(Pi=null),Ni!==null&&Nu(Ni)&&(Ni=null),zl.forEach(Nv),ql.forEach(Nv)}function Qa(t,e){t.blockedOn===e&&(t.blockedOn=null,Wp||(Wp=!0,jn.unstable_scheduleCallback(jn.unstable_NormalPriority,eP)))}function Hl(t){function e(i){return Qa(i,t)}if(0<su.length){Qa(su[0],t);for(var n=1;n<su.length;n++){var r=su[n];r.blockedOn===t&&(r.blockedOn=null)}}for(Ri!==null&&Qa(Ri,t),Pi!==null&&Qa(Pi,t),Ni!==null&&Qa(Ni,t),zl.forEach(e),ql.forEach(e),n=0;n<yi.length;n++)r=yi[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<yi.length&&(n=yi[0],n.blockedOn===null);)ZT(n),n.blockedOn===null&&yi.shift()}var qo=ei.ReactCurrentBatchConfig,ud=!0;function tP(t,e,n,r){var i=We,s=qo.transition;qo.transition=null;try{We=1,wg(t,e,n,r)}finally{We=i,qo.transition=s}}function nP(t,e,n,r){var i=We,s=qo.transition;qo.transition=null;try{We=4,wg(t,e,n,r)}finally{We=i,qo.transition=s}}function wg(t,e,n,r){if(ud){var i=Kp(t,e,n,r);if(i===null)zf(t,e,r,dd,n),Pv(t,r);else if(ZR(i,t,e,n,r))r.stopPropagation();else if(Pv(t,r),e&4&&-1<JR.indexOf(t)){for(;i!==null;){var s=Ec(i);if(s!==null&&QT(s),s=Kp(t,e,n,r),s===null&&zf(t,e,r,dd,n),s===i)break;i=s}i!==null&&r.stopPropagation()}else zf(t,e,r,null,n)}}var dd=null;function Kp(t,e,n,r){if(dd=null,t=gg(r),t=Is(t),t!==null)if(e=to(t),e===null)t=null;else if(n=e.tag,n===13){if(t=BT(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return dd=t,null}function e0(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(zR()){case yg:return 1;case HT:return 4;case ld:case qR:return 16;case WT:return 536870912;default:return 16}default:return 16}}var bi=null,Eg=null,ku=null;function t0(){if(ku)return ku;var t,e=Eg,n=e.length,r,i="value"in bi?bi.value:bi.textContent,s=i.length;for(t=0;t<n&&e[t]===i[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===i[s-r];r++);return ku=i.slice(t,1<r?1-r:void 0)}function Du(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function ou(){return!0}function kv(){return!1}function Ln(t){function e(n,r,i,s,o){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(n=t[a],this[a]=n?n(s):s[a]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?ou:kv,this.isPropagationStopped=kv,this}return ft(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=ou)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=ou)},persist:function(){},isPersistent:ou}),e}var Ta={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ig=Ln(Ta),wc=ft({},Ta,{view:0,detail:0}),rP=Ln(wc),jf,Of,Ya,ch=ft({},wc,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Tg,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Ya&&(Ya&&t.type==="mousemove"?(jf=t.screenX-Ya.screenX,Of=t.screenY-Ya.screenY):Of=jf=0,Ya=t),jf)},movementY:function(t){return"movementY"in t?t.movementY:Of}}),Dv=Ln(ch),iP=ft({},ch,{dataTransfer:0}),sP=Ln(iP),oP=ft({},wc,{relatedTarget:0}),Vf=Ln(oP),aP=ft({},Ta,{animationName:0,elapsedTime:0,pseudoElement:0}),lP=Ln(aP),cP=ft({},Ta,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),uP=Ln(cP),dP=ft({},Ta,{data:0}),jv=Ln(dP),hP={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},fP={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},pP={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function mP(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=pP[t])?!!e[t]:!1}function Tg(){return mP}var gP=ft({},wc,{key:function(t){if(t.key){var e=hP[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Du(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?fP[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Tg,charCode:function(t){return t.type==="keypress"?Du(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Du(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),yP=Ln(gP),_P=ft({},ch,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Ov=Ln(_P),vP=ft({},wc,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Tg}),wP=Ln(vP),EP=ft({},Ta,{propertyName:0,elapsedTime:0,pseudoElement:0}),IP=Ln(EP),TP=ft({},ch,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),xP=Ln(TP),SP=[9,13,27,32],xg=qr&&"CompositionEvent"in window,Tl=null;qr&&"documentMode"in document&&(Tl=document.documentMode);var bP=qr&&"TextEvent"in window&&!Tl,n0=qr&&(!xg||Tl&&8<Tl&&11>=Tl),Vv=" ",Lv=!1;function r0(t,e){switch(t){case"keyup":return SP.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function i0(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Po=!1;function CP(t,e){switch(t){case"compositionend":return i0(e);case"keypress":return e.which!==32?null:(Lv=!0,Vv);case"textInput":return t=e.data,t===Vv&&Lv?null:t;default:return null}}function AP(t,e){if(Po)return t==="compositionend"||!xg&&r0(t,e)?(t=t0(),ku=Eg=bi=null,Po=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return n0&&e.locale!=="ko"?null:e.data;default:return null}}var RP={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Mv(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!RP[t.type]:e==="textarea"}function s0(t,e,n,r){VT(r),e=hd(e,"onChange"),0<e.length&&(n=new Ig("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var xl=null,Wl=null;function PP(t){g0(t,0)}function uh(t){var e=Do(t);if(RT(e))return t}function NP(t,e){if(t==="change")return e}var o0=!1;if(qr){var Lf;if(qr){var Mf="oninput"in document;if(!Mf){var Fv=document.createElement("div");Fv.setAttribute("oninput","return;"),Mf=typeof Fv.oninput=="function"}Lf=Mf}else Lf=!1;o0=Lf&&(!document.documentMode||9<document.documentMode)}function Uv(){xl&&(xl.detachEvent("onpropertychange",a0),Wl=xl=null)}function a0(t){if(t.propertyName==="value"&&uh(Wl)){var e=[];s0(e,Wl,t,gg(t)),UT(PP,e)}}function kP(t,e,n){t==="focusin"?(Uv(),xl=e,Wl=n,xl.attachEvent("onpropertychange",a0)):t==="focusout"&&Uv()}function DP(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return uh(Wl)}function jP(t,e){if(t==="click")return uh(e)}function OP(t,e){if(t==="input"||t==="change")return uh(e)}function VP(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var lr=typeof Object.is=="function"?Object.is:VP;function Kl(t,e){if(lr(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!Rp.call(e,i)||!lr(t[i],e[i]))return!1}return!0}function Bv(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function $v(t,e){var n=Bv(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Bv(n)}}function l0(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?l0(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function c0(){for(var t=window,e=sd();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=sd(t.document)}return e}function Sg(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function LP(t){var e=c0(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&l0(n.ownerDocument.documentElement,n)){if(r!==null&&Sg(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=n.textContent.length,s=Math.min(r.start,i);r=r.end===void 0?s:Math.min(r.end,i),!t.extend&&s>r&&(i=r,r=s,s=i),i=$v(n,s);var o=$v(n,r);i&&o&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),s>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var MP=qr&&"documentMode"in document&&11>=document.documentMode,No=null,Gp=null,Sl=null,Qp=!1;function zv(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Qp||No==null||No!==sd(r)||(r=No,"selectionStart"in r&&Sg(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Sl&&Kl(Sl,r)||(Sl=r,r=hd(Gp,"onSelect"),0<r.length&&(e=new Ig("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=No)))}function au(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var ko={animationend:au("Animation","AnimationEnd"),animationiteration:au("Animation","AnimationIteration"),animationstart:au("Animation","AnimationStart"),transitionend:au("Transition","TransitionEnd")},Ff={},u0={};qr&&(u0=document.createElement("div").style,"AnimationEvent"in window||(delete ko.animationend.animation,delete ko.animationiteration.animation,delete ko.animationstart.animation),"TransitionEvent"in window||delete ko.transitionend.transition);function dh(t){if(Ff[t])return Ff[t];if(!ko[t])return t;var e=ko[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in u0)return Ff[t]=e[n];return t}var d0=dh("animationend"),h0=dh("animationiteration"),f0=dh("animationstart"),p0=dh("transitionend"),m0=new Map,qv="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Yi(t,e){m0.set(t,e),eo(e,[t])}for(var Uf=0;Uf<qv.length;Uf++){var Bf=qv[Uf],FP=Bf.toLowerCase(),UP=Bf[0].toUpperCase()+Bf.slice(1);Yi(FP,"on"+UP)}Yi(d0,"onAnimationEnd");Yi(h0,"onAnimationIteration");Yi(f0,"onAnimationStart");Yi("dblclick","onDoubleClick");Yi("focusin","onFocus");Yi("focusout","onBlur");Yi(p0,"onTransitionEnd");ta("onMouseEnter",["mouseout","mouseover"]);ta("onMouseLeave",["mouseout","mouseover"]);ta("onPointerEnter",["pointerout","pointerover"]);ta("onPointerLeave",["pointerout","pointerover"]);eo("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));eo("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));eo("onBeforeInput",["compositionend","keypress","textInput","paste"]);eo("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));eo("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));eo("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var dl="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),BP=new Set("cancel close invalid load scroll toggle".split(" ").concat(dl));function Hv(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,FR(r,e,void 0,t),t.currentTarget=null}function g0(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],i=r.event;r=r.listeners;e:{var s=void 0;if(e)for(var o=r.length-1;0<=o;o--){var a=r[o],l=a.instance,d=a.currentTarget;if(a=a.listener,l!==s&&i.isPropagationStopped())break e;Hv(i,a,d),s=l}else for(o=0;o<r.length;o++){if(a=r[o],l=a.instance,d=a.currentTarget,a=a.listener,l!==s&&i.isPropagationStopped())break e;Hv(i,a,d),s=l}}}if(ad)throw t=qp,ad=!1,qp=null,t}function it(t,e){var n=e[em];n===void 0&&(n=e[em]=new Set);var r=t+"__bubble";n.has(r)||(y0(e,t,2,!1),n.add(r))}function $f(t,e,n){var r=0;e&&(r|=4),y0(n,t,r,e)}var lu="_reactListening"+Math.random().toString(36).slice(2);function Gl(t){if(!t[lu]){t[lu]=!0,xT.forEach(function(n){n!=="selectionchange"&&(BP.has(n)||$f(n,!1,t),$f(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[lu]||(e[lu]=!0,$f("selectionchange",!1,e))}}function y0(t,e,n,r){switch(e0(e)){case 1:var i=tP;break;case 4:i=nP;break;default:i=wg}n=i.bind(null,e,n,t),i=void 0,!zp||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),r?i!==void 0?t.addEventListener(e,n,{capture:!0,passive:i}):t.addEventListener(e,n,!0):i!==void 0?t.addEventListener(e,n,{passive:i}):t.addEventListener(e,n,!1)}function zf(t,e,n,r,i){var s=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var a=r.stateNode.containerInfo;if(a===i||a.nodeType===8&&a.parentNode===i)break;if(o===4)for(o=r.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===i||l.nodeType===8&&l.parentNode===i))return;o=o.return}for(;a!==null;){if(o=Is(a),o===null)return;if(l=o.tag,l===5||l===6){r=s=o;continue e}a=a.parentNode}}r=r.return}UT(function(){var d=s,h=gg(n),f=[];e:{var m=m0.get(t);if(m!==void 0){var _=Ig,R=t;switch(t){case"keypress":if(Du(n)===0)break e;case"keydown":case"keyup":_=yP;break;case"focusin":R="focus",_=Vf;break;case"focusout":R="blur",_=Vf;break;case"beforeblur":case"afterblur":_=Vf;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":_=Dv;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":_=sP;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":_=wP;break;case d0:case h0:case f0:_=lP;break;case p0:_=IP;break;case"scroll":_=rP;break;case"wheel":_=xP;break;case"copy":case"cut":case"paste":_=uP;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":_=Ov}var C=(e&4)!==0,y=!C&&t==="scroll",I=C?m!==null?m+"Capture":null:m;C=[];for(var w=d,E;w!==null;){E=w;var O=E.stateNode;if(E.tag===5&&O!==null&&(E=O,I!==null&&(O=$l(w,I),O!=null&&C.push(Ql(w,O,E)))),y)break;w=w.return}0<C.length&&(m=new _(m,R,null,n,h),f.push({event:m,listeners:C}))}}if(!(e&7)){e:{if(m=t==="mouseover"||t==="pointerover",_=t==="mouseout"||t==="pointerout",m&&n!==Bp&&(R=n.relatedTarget||n.fromElement)&&(Is(R)||R[Hr]))break e;if((_||m)&&(m=h.window===h?h:(m=h.ownerDocument)?m.defaultView||m.parentWindow:window,_?(R=n.relatedTarget||n.toElement,_=d,R=R?Is(R):null,R!==null&&(y=to(R),R!==y||R.tag!==5&&R.tag!==6)&&(R=null)):(_=null,R=d),_!==R)){if(C=Dv,O="onMouseLeave",I="onMouseEnter",w="mouse",(t==="pointerout"||t==="pointerover")&&(C=Ov,O="onPointerLeave",I="onPointerEnter",w="pointer"),y=_==null?m:Do(_),E=R==null?m:Do(R),m=new C(O,w+"leave",_,n,h),m.target=y,m.relatedTarget=E,O=null,Is(h)===d&&(C=new C(I,w+"enter",R,n,h),C.target=E,C.relatedTarget=y,O=C),y=O,_&&R)t:{for(C=_,I=R,w=0,E=C;E;E=uo(E))w++;for(E=0,O=I;O;O=uo(O))E++;for(;0<w-E;)C=uo(C),w--;for(;0<E-w;)I=uo(I),E--;for(;w--;){if(C===I||I!==null&&C===I.alternate)break t;C=uo(C),I=uo(I)}C=null}else C=null;_!==null&&Wv(f,m,_,C,!1),R!==null&&y!==null&&Wv(f,y,R,C,!0)}}e:{if(m=d?Do(d):window,_=m.nodeName&&m.nodeName.toLowerCase(),_==="select"||_==="input"&&m.type==="file")var D=NP;else if(Mv(m))if(o0)D=OP;else{D=DP;var B=kP}else(_=m.nodeName)&&_.toLowerCase()==="input"&&(m.type==="checkbox"||m.type==="radio")&&(D=jP);if(D&&(D=D(t,d))){s0(f,D,n,h);break e}B&&B(t,m,d),t==="focusout"&&(B=m._wrapperState)&&B.controlled&&m.type==="number"&&Vp(m,"number",m.value)}switch(B=d?Do(d):window,t){case"focusin":(Mv(B)||B.contentEditable==="true")&&(No=B,Gp=d,Sl=null);break;case"focusout":Sl=Gp=No=null;break;case"mousedown":Qp=!0;break;case"contextmenu":case"mouseup":case"dragend":Qp=!1,zv(f,n,h);break;case"selectionchange":if(MP)break;case"keydown":case"keyup":zv(f,n,h)}var x;if(xg)e:{switch(t){case"compositionstart":var v="onCompositionStart";break e;case"compositionend":v="onCompositionEnd";break e;case"compositionupdate":v="onCompositionUpdate";break e}v=void 0}else Po?r0(t,n)&&(v="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(v="onCompositionStart");v&&(n0&&n.locale!=="ko"&&(Po||v!=="onCompositionStart"?v==="onCompositionEnd"&&Po&&(x=t0()):(bi=h,Eg="value"in bi?bi.value:bi.textContent,Po=!0)),B=hd(d,v),0<B.length&&(v=new jv(v,t,null,n,h),f.push({event:v,listeners:B}),x?v.data=x:(x=i0(n),x!==null&&(v.data=x)))),(x=bP?CP(t,n):AP(t,n))&&(d=hd(d,"onBeforeInput"),0<d.length&&(h=new jv("onBeforeInput","beforeinput",null,n,h),f.push({event:h,listeners:d}),h.data=x))}g0(f,e)})}function Ql(t,e,n){return{instance:t,listener:e,currentTarget:n}}function hd(t,e){for(var n=e+"Capture",r=[];t!==null;){var i=t,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=$l(t,n),s!=null&&r.unshift(Ql(t,s,i)),s=$l(t,e),s!=null&&r.push(Ql(t,s,i))),t=t.return}return r}function uo(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function Wv(t,e,n,r,i){for(var s=e._reactName,o=[];n!==null&&n!==r;){var a=n,l=a.alternate,d=a.stateNode;if(l!==null&&l===r)break;a.tag===5&&d!==null&&(a=d,i?(l=$l(n,s),l!=null&&o.unshift(Ql(n,l,a))):i||(l=$l(n,s),l!=null&&o.push(Ql(n,l,a)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var $P=/\r\n?/g,zP=/\u0000|\uFFFD/g;function Kv(t){return(typeof t=="string"?t:""+t).replace($P,`
`).replace(zP,"")}function cu(t,e,n){if(e=Kv(e),Kv(t)!==e&&n)throw Error(W(425))}function fd(){}var Yp=null,Xp=null;function Jp(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Zp=typeof setTimeout=="function"?setTimeout:void 0,qP=typeof clearTimeout=="function"?clearTimeout:void 0,Gv=typeof Promise=="function"?Promise:void 0,HP=typeof queueMicrotask=="function"?queueMicrotask:typeof Gv<"u"?function(t){return Gv.resolve(null).then(t).catch(WP)}:Zp;function WP(t){setTimeout(function(){throw t})}function qf(t,e){var n=e,r=0;do{var i=n.nextSibling;if(t.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){t.removeChild(i),Hl(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);Hl(e)}function ki(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function Qv(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var xa=Math.random().toString(36).slice(2),Ir="__reactFiber$"+xa,Yl="__reactProps$"+xa,Hr="__reactContainer$"+xa,em="__reactEvents$"+xa,KP="__reactListeners$"+xa,GP="__reactHandles$"+xa;function Is(t){var e=t[Ir];if(e)return e;for(var n=t.parentNode;n;){if(e=n[Hr]||n[Ir]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=Qv(t);t!==null;){if(n=t[Ir])return n;t=Qv(t)}return e}t=n,n=t.parentNode}return null}function Ec(t){return t=t[Ir]||t[Hr],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Do(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(W(33))}function hh(t){return t[Yl]||null}var tm=[],jo=-1;function Xi(t){return{current:t}}function st(t){0>jo||(t.current=tm[jo],tm[jo]=null,jo--)}function Ze(t,e){jo++,tm[jo]=t.current,t.current=e}var qi={},ln=Xi(qi),In=Xi(!1),Os=qi;function na(t,e){var n=t.type.contextTypes;if(!n)return qi;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in n)i[s]=e[s];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function Tn(t){return t=t.childContextTypes,t!=null}function pd(){st(In),st(ln)}function Yv(t,e,n){if(ln.current!==qi)throw Error(W(168));Ze(ln,e),Ze(In,n)}function _0(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in e))throw Error(W(108,kR(t)||"Unknown",i));return ft({},n,r)}function md(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||qi,Os=ln.current,Ze(ln,t),Ze(In,In.current),!0}function Xv(t,e,n){var r=t.stateNode;if(!r)throw Error(W(169));n?(t=_0(t,e,Os),r.__reactInternalMemoizedMergedChildContext=t,st(In),st(ln),Ze(ln,t)):st(In),Ze(In,n)}var Vr=null,fh=!1,Hf=!1;function v0(t){Vr===null?Vr=[t]:Vr.push(t)}function QP(t){fh=!0,v0(t)}function Ji(){if(!Hf&&Vr!==null){Hf=!0;var t=0,e=We;try{var n=Vr;for(We=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}Vr=null,fh=!1}catch(i){throw Vr!==null&&(Vr=Vr.slice(t+1)),qT(yg,Ji),i}finally{We=e,Hf=!1}}return null}var Oo=[],Vo=0,gd=null,yd=0,Fn=[],Un=0,Vs=null,Lr=1,Mr="";function hs(t,e){Oo[Vo++]=yd,Oo[Vo++]=gd,gd=t,yd=e}function w0(t,e,n){Fn[Un++]=Lr,Fn[Un++]=Mr,Fn[Un++]=Vs,Vs=t;var r=Lr;t=Mr;var i=32-sr(r)-1;r&=~(1<<i),n+=1;var s=32-sr(e)+i;if(30<s){var o=i-i%5;s=(r&(1<<o)-1).toString(32),r>>=o,i-=o,Lr=1<<32-sr(e)+i|n<<i|r,Mr=s+t}else Lr=1<<s|n<<i|r,Mr=t}function bg(t){t.return!==null&&(hs(t,1),w0(t,1,0))}function Cg(t){for(;t===gd;)gd=Oo[--Vo],Oo[Vo]=null,yd=Oo[--Vo],Oo[Vo]=null;for(;t===Vs;)Vs=Fn[--Un],Fn[Un]=null,Mr=Fn[--Un],Fn[Un]=null,Lr=Fn[--Un],Fn[Un]=null}var kn=null,Pn=null,at=!1,nr=null;function E0(t,e){var n=zn(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function Jv(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,kn=t,Pn=ki(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,kn=t,Pn=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=Vs!==null?{id:Lr,overflow:Mr}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=zn(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,kn=t,Pn=null,!0):!1;default:return!1}}function nm(t){return(t.mode&1)!==0&&(t.flags&128)===0}function rm(t){if(at){var e=Pn;if(e){var n=e;if(!Jv(t,e)){if(nm(t))throw Error(W(418));e=ki(n.nextSibling);var r=kn;e&&Jv(t,e)?E0(r,n):(t.flags=t.flags&-4097|2,at=!1,kn=t)}}else{if(nm(t))throw Error(W(418));t.flags=t.flags&-4097|2,at=!1,kn=t}}}function Zv(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;kn=t}function uu(t){if(t!==kn)return!1;if(!at)return Zv(t),at=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Jp(t.type,t.memoizedProps)),e&&(e=Pn)){if(nm(t))throw I0(),Error(W(418));for(;e;)E0(t,e),e=ki(e.nextSibling)}if(Zv(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(W(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){Pn=ki(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}Pn=null}}else Pn=kn?ki(t.stateNode.nextSibling):null;return!0}function I0(){for(var t=Pn;t;)t=ki(t.nextSibling)}function ra(){Pn=kn=null,at=!1}function Ag(t){nr===null?nr=[t]:nr.push(t)}var YP=ei.ReactCurrentBatchConfig;function Xa(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(W(309));var r=n.stateNode}if(!r)throw Error(W(147,t));var i=r,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(o){var a=i.refs;o===null?delete a[s]:a[s]=o},e._stringRef=s,e)}if(typeof t!="string")throw Error(W(284));if(!n._owner)throw Error(W(290,t))}return t}function du(t,e){throw t=Object.prototype.toString.call(e),Error(W(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function ew(t){var e=t._init;return e(t._payload)}function T0(t){function e(I,w){if(t){var E=I.deletions;E===null?(I.deletions=[w],I.flags|=16):E.push(w)}}function n(I,w){if(!t)return null;for(;w!==null;)e(I,w),w=w.sibling;return null}function r(I,w){for(I=new Map;w!==null;)w.key!==null?I.set(w.key,w):I.set(w.index,w),w=w.sibling;return I}function i(I,w){return I=Vi(I,w),I.index=0,I.sibling=null,I}function s(I,w,E){return I.index=E,t?(E=I.alternate,E!==null?(E=E.index,E<w?(I.flags|=2,w):E):(I.flags|=2,w)):(I.flags|=1048576,w)}function o(I){return t&&I.alternate===null&&(I.flags|=2),I}function a(I,w,E,O){return w===null||w.tag!==6?(w=Jf(E,I.mode,O),w.return=I,w):(w=i(w,E),w.return=I,w)}function l(I,w,E,O){var D=E.type;return D===Ro?h(I,w,E.props.children,O,E.key):w!==null&&(w.elementType===D||typeof D=="object"&&D!==null&&D.$$typeof===mi&&ew(D)===w.type)?(O=i(w,E.props),O.ref=Xa(I,w,E),O.return=I,O):(O=Uu(E.type,E.key,E.props,null,I.mode,O),O.ref=Xa(I,w,E),O.return=I,O)}function d(I,w,E,O){return w===null||w.tag!==4||w.stateNode.containerInfo!==E.containerInfo||w.stateNode.implementation!==E.implementation?(w=Zf(E,I.mode,O),w.return=I,w):(w=i(w,E.children||[]),w.return=I,w)}function h(I,w,E,O,D){return w===null||w.tag!==7?(w=As(E,I.mode,O,D),w.return=I,w):(w=i(w,E),w.return=I,w)}function f(I,w,E){if(typeof w=="string"&&w!==""||typeof w=="number")return w=Jf(""+w,I.mode,E),w.return=I,w;if(typeof w=="object"&&w!==null){switch(w.$$typeof){case eu:return E=Uu(w.type,w.key,w.props,null,I.mode,E),E.ref=Xa(I,null,w),E.return=I,E;case Ao:return w=Zf(w,I.mode,E),w.return=I,w;case mi:var O=w._init;return f(I,O(w._payload),E)}if(cl(w)||Wa(w))return w=As(w,I.mode,E,null),w.return=I,w;du(I,w)}return null}function m(I,w,E,O){var D=w!==null?w.key:null;if(typeof E=="string"&&E!==""||typeof E=="number")return D!==null?null:a(I,w,""+E,O);if(typeof E=="object"&&E!==null){switch(E.$$typeof){case eu:return E.key===D?l(I,w,E,O):null;case Ao:return E.key===D?d(I,w,E,O):null;case mi:return D=E._init,m(I,w,D(E._payload),O)}if(cl(E)||Wa(E))return D!==null?null:h(I,w,E,O,null);du(I,E)}return null}function _(I,w,E,O,D){if(typeof O=="string"&&O!==""||typeof O=="number")return I=I.get(E)||null,a(w,I,""+O,D);if(typeof O=="object"&&O!==null){switch(O.$$typeof){case eu:return I=I.get(O.key===null?E:O.key)||null,l(w,I,O,D);case Ao:return I=I.get(O.key===null?E:O.key)||null,d(w,I,O,D);case mi:var B=O._init;return _(I,w,E,B(O._payload),D)}if(cl(O)||Wa(O))return I=I.get(E)||null,h(w,I,O,D,null);du(w,O)}return null}function R(I,w,E,O){for(var D=null,B=null,x=w,v=w=0,b=null;x!==null&&v<E.length;v++){x.index>v?(b=x,x=null):b=x.sibling;var A=m(I,x,E[v],O);if(A===null){x===null&&(x=b);break}t&&x&&A.alternate===null&&e(I,x),w=s(A,w,v),B===null?D=A:B.sibling=A,B=A,x=b}if(v===E.length)return n(I,x),at&&hs(I,v),D;if(x===null){for(;v<E.length;v++)x=f(I,E[v],O),x!==null&&(w=s(x,w,v),B===null?D=x:B.sibling=x,B=x);return at&&hs(I,v),D}for(x=r(I,x);v<E.length;v++)b=_(x,I,v,E[v],O),b!==null&&(t&&b.alternate!==null&&x.delete(b.key===null?v:b.key),w=s(b,w,v),B===null?D=b:B.sibling=b,B=b);return t&&x.forEach(function(j){return e(I,j)}),at&&hs(I,v),D}function C(I,w,E,O){var D=Wa(E);if(typeof D!="function")throw Error(W(150));if(E=D.call(E),E==null)throw Error(W(151));for(var B=D=null,x=w,v=w=0,b=null,A=E.next();x!==null&&!A.done;v++,A=E.next()){x.index>v?(b=x,x=null):b=x.sibling;var j=m(I,x,A.value,O);if(j===null){x===null&&(x=b);break}t&&x&&j.alternate===null&&e(I,x),w=s(j,w,v),B===null?D=j:B.sibling=j,B=j,x=b}if(A.done)return n(I,x),at&&hs(I,v),D;if(x===null){for(;!A.done;v++,A=E.next())A=f(I,A.value,O),A!==null&&(w=s(A,w,v),B===null?D=A:B.sibling=A,B=A);return at&&hs(I,v),D}for(x=r(I,x);!A.done;v++,A=E.next())A=_(x,I,v,A.value,O),A!==null&&(t&&A.alternate!==null&&x.delete(A.key===null?v:A.key),w=s(A,w,v),B===null?D=A:B.sibling=A,B=A);return t&&x.forEach(function(V){return e(I,V)}),at&&hs(I,v),D}function y(I,w,E,O){if(typeof E=="object"&&E!==null&&E.type===Ro&&E.key===null&&(E=E.props.children),typeof E=="object"&&E!==null){switch(E.$$typeof){case eu:e:{for(var D=E.key,B=w;B!==null;){if(B.key===D){if(D=E.type,D===Ro){if(B.tag===7){n(I,B.sibling),w=i(B,E.props.children),w.return=I,I=w;break e}}else if(B.elementType===D||typeof D=="object"&&D!==null&&D.$$typeof===mi&&ew(D)===B.type){n(I,B.sibling),w=i(B,E.props),w.ref=Xa(I,B,E),w.return=I,I=w;break e}n(I,B);break}else e(I,B);B=B.sibling}E.type===Ro?(w=As(E.props.children,I.mode,O,E.key),w.return=I,I=w):(O=Uu(E.type,E.key,E.props,null,I.mode,O),O.ref=Xa(I,w,E),O.return=I,I=O)}return o(I);case Ao:e:{for(B=E.key;w!==null;){if(w.key===B)if(w.tag===4&&w.stateNode.containerInfo===E.containerInfo&&w.stateNode.implementation===E.implementation){n(I,w.sibling),w=i(w,E.children||[]),w.return=I,I=w;break e}else{n(I,w);break}else e(I,w);w=w.sibling}w=Zf(E,I.mode,O),w.return=I,I=w}return o(I);case mi:return B=E._init,y(I,w,B(E._payload),O)}if(cl(E))return R(I,w,E,O);if(Wa(E))return C(I,w,E,O);du(I,E)}return typeof E=="string"&&E!==""||typeof E=="number"?(E=""+E,w!==null&&w.tag===6?(n(I,w.sibling),w=i(w,E),w.return=I,I=w):(n(I,w),w=Jf(E,I.mode,O),w.return=I,I=w),o(I)):n(I,w)}return y}var ia=T0(!0),x0=T0(!1),_d=Xi(null),vd=null,Lo=null,Rg=null;function Pg(){Rg=Lo=vd=null}function Ng(t){var e=_d.current;st(_d),t._currentValue=e}function im(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function Ho(t,e){vd=t,Rg=Lo=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(wn=!0),t.firstContext=null)}function Kn(t){var e=t._currentValue;if(Rg!==t)if(t={context:t,memoizedValue:e,next:null},Lo===null){if(vd===null)throw Error(W(308));Lo=t,vd.dependencies={lanes:0,firstContext:t}}else Lo=Lo.next=t;return e}var Ts=null;function kg(t){Ts===null?Ts=[t]:Ts.push(t)}function S0(t,e,n,r){var i=e.interleaved;return i===null?(n.next=n,kg(e)):(n.next=i.next,i.next=n),e.interleaved=n,Wr(t,r)}function Wr(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var gi=!1;function Dg(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function b0(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function $r(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Di(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,Fe&2){var i=r.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),r.pending=e,Wr(t,n)}return i=r.interleaved,i===null?(e.next=e,kg(r)):(e.next=i.next,i.next=e),r.interleaved=e,Wr(t,n)}function ju(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,_g(t,n)}}function tw(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,s=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};s===null?i=s=o:s=s.next=o,n=n.next}while(n!==null);s===null?i=s=e:s=s.next=e}else i=s=e;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function wd(t,e,n,r){var i=t.updateQueue;gi=!1;var s=i.firstBaseUpdate,o=i.lastBaseUpdate,a=i.shared.pending;if(a!==null){i.shared.pending=null;var l=a,d=l.next;l.next=null,o===null?s=d:o.next=d,o=l;var h=t.alternate;h!==null&&(h=h.updateQueue,a=h.lastBaseUpdate,a!==o&&(a===null?h.firstBaseUpdate=d:a.next=d,h.lastBaseUpdate=l))}if(s!==null){var f=i.baseState;o=0,h=d=l=null,a=s;do{var m=a.lane,_=a.eventTime;if((r&m)===m){h!==null&&(h=h.next={eventTime:_,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var R=t,C=a;switch(m=e,_=n,C.tag){case 1:if(R=C.payload,typeof R=="function"){f=R.call(_,f,m);break e}f=R;break e;case 3:R.flags=R.flags&-65537|128;case 0:if(R=C.payload,m=typeof R=="function"?R.call(_,f,m):R,m==null)break e;f=ft({},f,m);break e;case 2:gi=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,m=i.effects,m===null?i.effects=[a]:m.push(a))}else _={eventTime:_,lane:m,tag:a.tag,payload:a.payload,callback:a.callback,next:null},h===null?(d=h=_,l=f):h=h.next=_,o|=m;if(a=a.next,a===null){if(a=i.shared.pending,a===null)break;m=a,a=m.next,m.next=null,i.lastBaseUpdate=m,i.shared.pending=null}}while(!0);if(h===null&&(l=f),i.baseState=l,i.firstBaseUpdate=d,i.lastBaseUpdate=h,e=i.shared.interleaved,e!==null){i=e;do o|=i.lane,i=i.next;while(i!==e)}else s===null&&(i.shared.lanes=0);Ms|=o,t.lanes=o,t.memoizedState=f}}function nw(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(W(191,i));i.call(r)}}}var Ic={},Cr=Xi(Ic),Xl=Xi(Ic),Jl=Xi(Ic);function xs(t){if(t===Ic)throw Error(W(174));return t}function jg(t,e){switch(Ze(Jl,e),Ze(Xl,t),Ze(Cr,Ic),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Mp(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Mp(e,t)}st(Cr),Ze(Cr,e)}function sa(){st(Cr),st(Xl),st(Jl)}function C0(t){xs(Jl.current);var e=xs(Cr.current),n=Mp(e,t.type);e!==n&&(Ze(Xl,t),Ze(Cr,n))}function Og(t){Xl.current===t&&(st(Cr),st(Xl))}var ut=Xi(0);function Ed(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Wf=[];function Vg(){for(var t=0;t<Wf.length;t++)Wf[t]._workInProgressVersionPrimary=null;Wf.length=0}var Ou=ei.ReactCurrentDispatcher,Kf=ei.ReactCurrentBatchConfig,Ls=0,ht=null,Dt=null,Ut=null,Id=!1,bl=!1,Zl=0,XP=0;function Yt(){throw Error(W(321))}function Lg(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!lr(t[n],e[n]))return!1;return!0}function Mg(t,e,n,r,i,s){if(Ls=s,ht=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Ou.current=t===null||t.memoizedState===null?t1:n1,t=n(r,i),bl){s=0;do{if(bl=!1,Zl=0,25<=s)throw Error(W(301));s+=1,Ut=Dt=null,e.updateQueue=null,Ou.current=r1,t=n(r,i)}while(bl)}if(Ou.current=Td,e=Dt!==null&&Dt.next!==null,Ls=0,Ut=Dt=ht=null,Id=!1,e)throw Error(W(300));return t}function Fg(){var t=Zl!==0;return Zl=0,t}function wr(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ut===null?ht.memoizedState=Ut=t:Ut=Ut.next=t,Ut}function Gn(){if(Dt===null){var t=ht.alternate;t=t!==null?t.memoizedState:null}else t=Dt.next;var e=Ut===null?ht.memoizedState:Ut.next;if(e!==null)Ut=e,Dt=t;else{if(t===null)throw Error(W(310));Dt=t,t={memoizedState:Dt.memoizedState,baseState:Dt.baseState,baseQueue:Dt.baseQueue,queue:Dt.queue,next:null},Ut===null?ht.memoizedState=Ut=t:Ut=Ut.next=t}return Ut}function ec(t,e){return typeof e=="function"?e(t):e}function Gf(t){var e=Gn(),n=e.queue;if(n===null)throw Error(W(311));n.lastRenderedReducer=t;var r=Dt,i=r.baseQueue,s=n.pending;if(s!==null){if(i!==null){var o=i.next;i.next=s.next,s.next=o}r.baseQueue=i=s,n.pending=null}if(i!==null){s=i.next,r=r.baseState;var a=o=null,l=null,d=s;do{var h=d.lane;if((Ls&h)===h)l!==null&&(l=l.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),r=d.hasEagerState?d.eagerState:t(r,d.action);else{var f={lane:h,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};l===null?(a=l=f,o=r):l=l.next=f,ht.lanes|=h,Ms|=h}d=d.next}while(d!==null&&d!==s);l===null?o=r:l.next=a,lr(r,e.memoizedState)||(wn=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=l,n.lastRenderedState=r}if(t=n.interleaved,t!==null){i=t;do s=i.lane,ht.lanes|=s,Ms|=s,i=i.next;while(i!==t)}else i===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function Qf(t){var e=Gn(),n=e.queue;if(n===null)throw Error(W(311));n.lastRenderedReducer=t;var r=n.dispatch,i=n.pending,s=e.memoizedState;if(i!==null){n.pending=null;var o=i=i.next;do s=t(s,o.action),o=o.next;while(o!==i);lr(s,e.memoizedState)||(wn=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),n.lastRenderedState=s}return[s,r]}function A0(){}function R0(t,e){var n=ht,r=Gn(),i=e(),s=!lr(r.memoizedState,i);if(s&&(r.memoizedState=i,wn=!0),r=r.queue,Ug(k0.bind(null,n,r,t),[t]),r.getSnapshot!==e||s||Ut!==null&&Ut.memoizedState.tag&1){if(n.flags|=2048,tc(9,N0.bind(null,n,r,i,e),void 0,null),Bt===null)throw Error(W(349));Ls&30||P0(n,e,i)}return i}function P0(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=ht.updateQueue,e===null?(e={lastEffect:null,stores:null},ht.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function N0(t,e,n,r){e.value=n,e.getSnapshot=r,D0(e)&&j0(t)}function k0(t,e,n){return n(function(){D0(e)&&j0(t)})}function D0(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!lr(t,n)}catch{return!0}}function j0(t){var e=Wr(t,1);e!==null&&or(e,t,1,-1)}function rw(t){var e=wr();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ec,lastRenderedState:t},e.queue=t,t=t.dispatch=e1.bind(null,ht,t),[e.memoizedState,t]}function tc(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=ht.updateQueue,e===null?(e={lastEffect:null,stores:null},ht.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function O0(){return Gn().memoizedState}function Vu(t,e,n,r){var i=wr();ht.flags|=t,i.memoizedState=tc(1|e,n,void 0,r===void 0?null:r)}function ph(t,e,n,r){var i=Gn();r=r===void 0?null:r;var s=void 0;if(Dt!==null){var o=Dt.memoizedState;if(s=o.destroy,r!==null&&Lg(r,o.deps)){i.memoizedState=tc(e,n,s,r);return}}ht.flags|=t,i.memoizedState=tc(1|e,n,s,r)}function iw(t,e){return Vu(8390656,8,t,e)}function Ug(t,e){return ph(2048,8,t,e)}function V0(t,e){return ph(4,2,t,e)}function L0(t,e){return ph(4,4,t,e)}function M0(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function F0(t,e,n){return n=n!=null?n.concat([t]):null,ph(4,4,M0.bind(null,e,t),n)}function Bg(){}function U0(t,e){var n=Gn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Lg(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function B0(t,e){var n=Gn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Lg(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function $0(t,e,n){return Ls&21?(lr(n,e)||(n=KT(),ht.lanes|=n,Ms|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,wn=!0),t.memoizedState=n)}function JP(t,e){var n=We;We=n!==0&&4>n?n:4,t(!0);var r=Kf.transition;Kf.transition={};try{t(!1),e()}finally{We=n,Kf.transition=r}}function z0(){return Gn().memoizedState}function ZP(t,e,n){var r=Oi(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},q0(t))H0(e,n);else if(n=S0(t,e,n,r),n!==null){var i=fn();or(n,t,r,i),W0(n,e,r)}}function e1(t,e,n){var r=Oi(t),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(q0(t))H0(e,i);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var o=e.lastRenderedState,a=s(o,n);if(i.hasEagerState=!0,i.eagerState=a,lr(a,o)){var l=e.interleaved;l===null?(i.next=i,kg(e)):(i.next=l.next,l.next=i),e.interleaved=i;return}}catch{}finally{}n=S0(t,e,i,r),n!==null&&(i=fn(),or(n,t,r,i),W0(n,e,r))}}function q0(t){var e=t.alternate;return t===ht||e!==null&&e===ht}function H0(t,e){bl=Id=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function W0(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,_g(t,n)}}var Td={readContext:Kn,useCallback:Yt,useContext:Yt,useEffect:Yt,useImperativeHandle:Yt,useInsertionEffect:Yt,useLayoutEffect:Yt,useMemo:Yt,useReducer:Yt,useRef:Yt,useState:Yt,useDebugValue:Yt,useDeferredValue:Yt,useTransition:Yt,useMutableSource:Yt,useSyncExternalStore:Yt,useId:Yt,unstable_isNewReconciler:!1},t1={readContext:Kn,useCallback:function(t,e){return wr().memoizedState=[t,e===void 0?null:e],t},useContext:Kn,useEffect:iw,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,Vu(4194308,4,M0.bind(null,e,t),n)},useLayoutEffect:function(t,e){return Vu(4194308,4,t,e)},useInsertionEffect:function(t,e){return Vu(4,2,t,e)},useMemo:function(t,e){var n=wr();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=wr();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=ZP.bind(null,ht,t),[r.memoizedState,t]},useRef:function(t){var e=wr();return t={current:t},e.memoizedState=t},useState:rw,useDebugValue:Bg,useDeferredValue:function(t){return wr().memoizedState=t},useTransition:function(){var t=rw(!1),e=t[0];return t=JP.bind(null,t[1]),wr().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=ht,i=wr();if(at){if(n===void 0)throw Error(W(407));n=n()}else{if(n=e(),Bt===null)throw Error(W(349));Ls&30||P0(r,e,n)}i.memoizedState=n;var s={value:n,getSnapshot:e};return i.queue=s,iw(k0.bind(null,r,s,t),[t]),r.flags|=2048,tc(9,N0.bind(null,r,s,n,e),void 0,null),n},useId:function(){var t=wr(),e=Bt.identifierPrefix;if(at){var n=Mr,r=Lr;n=(r&~(1<<32-sr(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=Zl++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=XP++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},n1={readContext:Kn,useCallback:U0,useContext:Kn,useEffect:Ug,useImperativeHandle:F0,useInsertionEffect:V0,useLayoutEffect:L0,useMemo:B0,useReducer:Gf,useRef:O0,useState:function(){return Gf(ec)},useDebugValue:Bg,useDeferredValue:function(t){var e=Gn();return $0(e,Dt.memoizedState,t)},useTransition:function(){var t=Gf(ec)[0],e=Gn().memoizedState;return[t,e]},useMutableSource:A0,useSyncExternalStore:R0,useId:z0,unstable_isNewReconciler:!1},r1={readContext:Kn,useCallback:U0,useContext:Kn,useEffect:Ug,useImperativeHandle:F0,useInsertionEffect:V0,useLayoutEffect:L0,useMemo:B0,useReducer:Qf,useRef:O0,useState:function(){return Qf(ec)},useDebugValue:Bg,useDeferredValue:function(t){var e=Gn();return Dt===null?e.memoizedState=t:$0(e,Dt.memoizedState,t)},useTransition:function(){var t=Qf(ec)[0],e=Gn().memoizedState;return[t,e]},useMutableSource:A0,useSyncExternalStore:R0,useId:z0,unstable_isNewReconciler:!1};function Zn(t,e){if(t&&t.defaultProps){e=ft({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function sm(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:ft({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var mh={isMounted:function(t){return(t=t._reactInternals)?to(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=fn(),i=Oi(t),s=$r(r,i);s.payload=e,n!=null&&(s.callback=n),e=Di(t,s,i),e!==null&&(or(e,t,i,r),ju(e,t,i))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=fn(),i=Oi(t),s=$r(r,i);s.tag=1,s.payload=e,n!=null&&(s.callback=n),e=Di(t,s,i),e!==null&&(or(e,t,i,r),ju(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=fn(),r=Oi(t),i=$r(n,r);i.tag=2,e!=null&&(i.callback=e),e=Di(t,i,r),e!==null&&(or(e,t,r,n),ju(e,t,r))}};function sw(t,e,n,r,i,s,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,s,o):e.prototype&&e.prototype.isPureReactComponent?!Kl(n,r)||!Kl(i,s):!0}function K0(t,e,n){var r=!1,i=qi,s=e.contextType;return typeof s=="object"&&s!==null?s=Kn(s):(i=Tn(e)?Os:ln.current,r=e.contextTypes,s=(r=r!=null)?na(t,i):qi),e=new e(n,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=mh,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=s),e}function ow(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&mh.enqueueReplaceState(e,e.state,null)}function om(t,e,n,r){var i=t.stateNode;i.props=n,i.state=t.memoizedState,i.refs={},Dg(t);var s=e.contextType;typeof s=="object"&&s!==null?i.context=Kn(s):(s=Tn(e)?Os:ln.current,i.context=na(t,s)),i.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(sm(t,e,s,n),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&mh.enqueueReplaceState(i,i.state,null),wd(t,n,i,r),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function oa(t,e){try{var n="",r=e;do n+=NR(r),r=r.return;while(r);var i=n}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:i,digest:null}}function Yf(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function am(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var i1=typeof WeakMap=="function"?WeakMap:Map;function G0(t,e,n){n=$r(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){Sd||(Sd=!0,ym=r),am(t,e)},n}function Q0(t,e,n){n=$r(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var i=e.value;n.payload=function(){return r(i)},n.callback=function(){am(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(n.callback=function(){am(t,e),typeof r!="function"&&(ji===null?ji=new Set([this]):ji.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function aw(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new i1;var i=new Set;r.set(e,i)}else i=r.get(e),i===void 0&&(i=new Set,r.set(e,i));i.has(n)||(i.add(n),t=_1.bind(null,t,e,n),e.then(t,t))}function lw(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function cw(t,e,n,r,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=$r(-1,1),e.tag=2,Di(n,e,1))),n.lanes|=1),t)}var s1=ei.ReactCurrentOwner,wn=!1;function un(t,e,n,r){e.child=t===null?x0(e,null,n,r):ia(e,t.child,n,r)}function uw(t,e,n,r,i){n=n.render;var s=e.ref;return Ho(e,i),r=Mg(t,e,n,r,s,i),n=Fg(),t!==null&&!wn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,Kr(t,e,i)):(at&&n&&bg(e),e.flags|=1,un(t,e,r,i),e.child)}function dw(t,e,n,r,i){if(t===null){var s=n.type;return typeof s=="function"&&!Qg(s)&&s.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=s,Y0(t,e,s,r,i)):(t=Uu(n.type,null,r,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&i)){var o=s.memoizedProps;if(n=n.compare,n=n!==null?n:Kl,n(o,r)&&t.ref===e.ref)return Kr(t,e,i)}return e.flags|=1,t=Vi(s,r),t.ref=e.ref,t.return=e,e.child=t}function Y0(t,e,n,r,i){if(t!==null){var s=t.memoizedProps;if(Kl(s,r)&&t.ref===e.ref)if(wn=!1,e.pendingProps=r=s,(t.lanes&i)!==0)t.flags&131072&&(wn=!0);else return e.lanes=t.lanes,Kr(t,e,i)}return lm(t,e,n,r,i)}function X0(t,e,n){var r=e.pendingProps,i=r.children,s=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ze(Fo,An),An|=n;else{if(!(n&1073741824))return t=s!==null?s.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Ze(Fo,An),An|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=s!==null?s.baseLanes:n,Ze(Fo,An),An|=r}else s!==null?(r=s.baseLanes|n,e.memoizedState=null):r=n,Ze(Fo,An),An|=r;return un(t,e,i,n),e.child}function J0(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function lm(t,e,n,r,i){var s=Tn(n)?Os:ln.current;return s=na(e,s),Ho(e,i),n=Mg(t,e,n,r,s,i),r=Fg(),t!==null&&!wn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,Kr(t,e,i)):(at&&r&&bg(e),e.flags|=1,un(t,e,n,i),e.child)}function hw(t,e,n,r,i){if(Tn(n)){var s=!0;md(e)}else s=!1;if(Ho(e,i),e.stateNode===null)Lu(t,e),K0(e,n,r),om(e,n,r,i),r=!0;else if(t===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var l=o.context,d=n.contextType;typeof d=="object"&&d!==null?d=Kn(d):(d=Tn(n)?Os:ln.current,d=na(e,d));var h=n.getDerivedStateFromProps,f=typeof h=="function"||typeof o.getSnapshotBeforeUpdate=="function";f||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==r||l!==d)&&ow(e,o,r,d),gi=!1;var m=e.memoizedState;o.state=m,wd(e,r,o,i),l=e.memoizedState,a!==r||m!==l||In.current||gi?(typeof h=="function"&&(sm(e,n,h,r),l=e.memoizedState),(a=gi||sw(e,n,a,r,m,l,d))?(f||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=l),o.props=r,o.state=l,o.context=d,r=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,b0(t,e),a=e.memoizedProps,d=e.type===e.elementType?a:Zn(e.type,a),o.props=d,f=e.pendingProps,m=o.context,l=n.contextType,typeof l=="object"&&l!==null?l=Kn(l):(l=Tn(n)?Os:ln.current,l=na(e,l));var _=n.getDerivedStateFromProps;(h=typeof _=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==f||m!==l)&&ow(e,o,r,l),gi=!1,m=e.memoizedState,o.state=m,wd(e,r,o,i);var R=e.memoizedState;a!==f||m!==R||In.current||gi?(typeof _=="function"&&(sm(e,n,_,r),R=e.memoizedState),(d=gi||sw(e,n,d,r,m,R,l)||!1)?(h||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,R,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,R,l)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&m===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&m===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=R),o.props=r,o.state=R,o.context=l,r=d):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&m===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&m===t.memoizedState||(e.flags|=1024),r=!1)}return cm(t,e,n,r,s,i)}function cm(t,e,n,r,i,s){J0(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return i&&Xv(e,n,!1),Kr(t,e,s);r=e.stateNode,s1.current=e;var a=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=ia(e,t.child,null,s),e.child=ia(e,null,a,s)):un(t,e,a,s),e.memoizedState=r.state,i&&Xv(e,n,!0),e.child}function Z0(t){var e=t.stateNode;e.pendingContext?Yv(t,e.pendingContext,e.pendingContext!==e.context):e.context&&Yv(t,e.context,!1),jg(t,e.containerInfo)}function fw(t,e,n,r,i){return ra(),Ag(i),e.flags|=256,un(t,e,n,r),e.child}var um={dehydrated:null,treeContext:null,retryLane:0};function dm(t){return{baseLanes:t,cachePool:null,transitions:null}}function ex(t,e,n){var r=e.pendingProps,i=ut.current,s=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=t!==null&&t.memoizedState===null?!1:(i&2)!==0),a?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),Ze(ut,i&1),t===null)return rm(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,s?(r=e.mode,s=e.child,o={mode:"hidden",children:o},!(r&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=_h(o,r,0,null),t=As(t,r,n,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=dm(n),e.memoizedState=um,t):$g(e,o));if(i=t.memoizedState,i!==null&&(a=i.dehydrated,a!==null))return o1(t,e,o,r,a,i,n);if(s){s=r.fallback,o=e.mode,i=t.child,a=i.sibling;var l={mode:"hidden",children:r.children};return!(o&1)&&e.child!==i?(r=e.child,r.childLanes=0,r.pendingProps=l,e.deletions=null):(r=Vi(i,l),r.subtreeFlags=i.subtreeFlags&14680064),a!==null?s=Vi(a,s):(s=As(s,o,n,null),s.flags|=2),s.return=e,r.return=e,r.sibling=s,e.child=r,r=s,s=e.child,o=t.child.memoizedState,o=o===null?dm(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=t.childLanes&~n,e.memoizedState=um,r}return s=t.child,t=s.sibling,r=Vi(s,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function $g(t,e){return e=_h({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function hu(t,e,n,r){return r!==null&&Ag(r),ia(e,t.child,null,n),t=$g(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function o1(t,e,n,r,i,s,o){if(n)return e.flags&256?(e.flags&=-257,r=Yf(Error(W(422))),hu(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=r.fallback,i=e.mode,r=_h({mode:"visible",children:r.children},i,0,null),s=As(s,i,o,null),s.flags|=2,r.return=e,s.return=e,r.sibling=s,e.child=r,e.mode&1&&ia(e,t.child,null,o),e.child.memoizedState=dm(o),e.memoizedState=um,s);if(!(e.mode&1))return hu(t,e,o,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var a=r.dgst;return r=a,s=Error(W(419)),r=Yf(s,r,void 0),hu(t,e,o,r)}if(a=(o&t.childLanes)!==0,wn||a){if(r=Bt,r!==null){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|o)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,Wr(t,i),or(r,t,i,-1))}return Gg(),r=Yf(Error(W(421))),hu(t,e,o,r)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=v1.bind(null,t),i._reactRetry=e,null):(t=s.treeContext,Pn=ki(i.nextSibling),kn=e,at=!0,nr=null,t!==null&&(Fn[Un++]=Lr,Fn[Un++]=Mr,Fn[Un++]=Vs,Lr=t.id,Mr=t.overflow,Vs=e),e=$g(e,r.children),e.flags|=4096,e)}function pw(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),im(t.return,e,n)}function Xf(t,e,n,r,i){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailMode=i)}function tx(t,e,n){var r=e.pendingProps,i=r.revealOrder,s=r.tail;if(un(t,e,r.children,n),r=ut.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&pw(t,n,e);else if(t.tag===19)pw(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(Ze(ut,r),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(n=e.child,i=null;n!==null;)t=n.alternate,t!==null&&Ed(t)===null&&(i=n),n=n.sibling;n=i,n===null?(i=e.child,e.child=null):(i=n.sibling,n.sibling=null),Xf(e,!1,i,n,s);break;case"backwards":for(n=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&Ed(t)===null){e.child=i;break}t=i.sibling,i.sibling=n,n=i,i=t}Xf(e,!0,n,null,s);break;case"together":Xf(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Lu(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Kr(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),Ms|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(W(153));if(e.child!==null){for(t=e.child,n=Vi(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Vi(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function a1(t,e,n){switch(e.tag){case 3:Z0(e),ra();break;case 5:C0(e);break;case 1:Tn(e.type)&&md(e);break;case 4:jg(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;Ze(_d,r._currentValue),r._currentValue=i;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(Ze(ut,ut.current&1),e.flags|=128,null):n&e.child.childLanes?ex(t,e,n):(Ze(ut,ut.current&1),t=Kr(t,e,n),t!==null?t.sibling:null);Ze(ut,ut.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return tx(t,e,n);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),Ze(ut,ut.current),r)break;return null;case 22:case 23:return e.lanes=0,X0(t,e,n)}return Kr(t,e,n)}var nx,hm,rx,ix;nx=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};hm=function(){};rx=function(t,e,n,r){var i=t.memoizedProps;if(i!==r){t=e.stateNode,xs(Cr.current);var s=null;switch(n){case"input":i=jp(t,i),r=jp(t,r),s=[];break;case"select":i=ft({},i,{value:void 0}),r=ft({},r,{value:void 0}),s=[];break;case"textarea":i=Lp(t,i),r=Lp(t,r),s=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=fd)}Fp(n,r);var o;n=null;for(d in i)if(!r.hasOwnProperty(d)&&i.hasOwnProperty(d)&&i[d]!=null)if(d==="style"){var a=i[d];for(o in a)a.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(Ul.hasOwnProperty(d)?s||(s=[]):(s=s||[]).push(d,null));for(d in r){var l=r[d];if(a=i!=null?i[d]:void 0,r.hasOwnProperty(d)&&l!==a&&(l!=null||a!=null))if(d==="style")if(a){for(o in a)!a.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in l)l.hasOwnProperty(o)&&a[o]!==l[o]&&(n||(n={}),n[o]=l[o])}else n||(s||(s=[]),s.push(d,n)),n=l;else d==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(s=s||[]).push(d,l)):d==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(d,""+l):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(Ul.hasOwnProperty(d)?(l!=null&&d==="onScroll"&&it("scroll",t),s||a===l||(s=[])):(s=s||[]).push(d,l))}n&&(s=s||[]).push("style",n);var d=s;(e.updateQueue=d)&&(e.flags|=4)}};ix=function(t,e,n,r){n!==r&&(e.flags|=4)};function Ja(t,e){if(!at)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function Xt(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function l1(t,e,n){var r=e.pendingProps;switch(Cg(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Xt(e),null;case 1:return Tn(e.type)&&pd(),Xt(e),null;case 3:return r=e.stateNode,sa(),st(In),st(ln),Vg(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(uu(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,nr!==null&&(wm(nr),nr=null))),hm(t,e),Xt(e),null;case 5:Og(e);var i=xs(Jl.current);if(n=e.type,t!==null&&e.stateNode!=null)rx(t,e,n,r,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(W(166));return Xt(e),null}if(t=xs(Cr.current),uu(e)){r=e.stateNode,n=e.type;var s=e.memoizedProps;switch(r[Ir]=e,r[Yl]=s,t=(e.mode&1)!==0,n){case"dialog":it("cancel",r),it("close",r);break;case"iframe":case"object":case"embed":it("load",r);break;case"video":case"audio":for(i=0;i<dl.length;i++)it(dl[i],r);break;case"source":it("error",r);break;case"img":case"image":case"link":it("error",r),it("load",r);break;case"details":it("toggle",r);break;case"input":Tv(r,s),it("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},it("invalid",r);break;case"textarea":Sv(r,s),it("invalid",r)}Fp(n,s),i=null;for(var o in s)if(s.hasOwnProperty(o)){var a=s[o];o==="children"?typeof a=="string"?r.textContent!==a&&(s.suppressHydrationWarning!==!0&&cu(r.textContent,a,t),i=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(s.suppressHydrationWarning!==!0&&cu(r.textContent,a,t),i=["children",""+a]):Ul.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&it("scroll",r)}switch(n){case"input":tu(r),xv(r,s,!0);break;case"textarea":tu(r),bv(r);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(r.onclick=fd)}r=i,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=kT(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[Ir]=e,t[Yl]=r,nx(t,e,!1,!1),e.stateNode=t;e:{switch(o=Up(n,r),n){case"dialog":it("cancel",t),it("close",t),i=r;break;case"iframe":case"object":case"embed":it("load",t),i=r;break;case"video":case"audio":for(i=0;i<dl.length;i++)it(dl[i],t);i=r;break;case"source":it("error",t),i=r;break;case"img":case"image":case"link":it("error",t),it("load",t),i=r;break;case"details":it("toggle",t),i=r;break;case"input":Tv(t,r),i=jp(t,r),it("invalid",t);break;case"option":i=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},i=ft({},r,{value:void 0}),it("invalid",t);break;case"textarea":Sv(t,r),i=Lp(t,r),it("invalid",t);break;default:i=r}Fp(n,i),a=i;for(s in a)if(a.hasOwnProperty(s)){var l=a[s];s==="style"?OT(t,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&DT(t,l)):s==="children"?typeof l=="string"?(n!=="textarea"||l!=="")&&Bl(t,l):typeof l=="number"&&Bl(t,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(Ul.hasOwnProperty(s)?l!=null&&s==="onScroll"&&it("scroll",t):l!=null&&hg(t,s,l,o))}switch(n){case"input":tu(t),xv(t,r,!1);break;case"textarea":tu(t),bv(t);break;case"option":r.value!=null&&t.setAttribute("value",""+zi(r.value));break;case"select":t.multiple=!!r.multiple,s=r.value,s!=null?Bo(t,!!r.multiple,s,!1):r.defaultValue!=null&&Bo(t,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=fd)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Xt(e),null;case 6:if(t&&e.stateNode!=null)ix(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(W(166));if(n=xs(Jl.current),xs(Cr.current),uu(e)){if(r=e.stateNode,n=e.memoizedProps,r[Ir]=e,(s=r.nodeValue!==n)&&(t=kn,t!==null))switch(t.tag){case 3:cu(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&cu(r.nodeValue,n,(t.mode&1)!==0)}s&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Ir]=e,e.stateNode=r}return Xt(e),null;case 13:if(st(ut),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(at&&Pn!==null&&e.mode&1&&!(e.flags&128))I0(),ra(),e.flags|=98560,s=!1;else if(s=uu(e),r!==null&&r.dehydrated!==null){if(t===null){if(!s)throw Error(W(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(W(317));s[Ir]=e}else ra(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Xt(e),s=!1}else nr!==null&&(wm(nr),nr=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||ut.current&1?jt===0&&(jt=3):Gg())),e.updateQueue!==null&&(e.flags|=4),Xt(e),null);case 4:return sa(),hm(t,e),t===null&&Gl(e.stateNode.containerInfo),Xt(e),null;case 10:return Ng(e.type._context),Xt(e),null;case 17:return Tn(e.type)&&pd(),Xt(e),null;case 19:if(st(ut),s=e.memoizedState,s===null)return Xt(e),null;if(r=(e.flags&128)!==0,o=s.rendering,o===null)if(r)Ja(s,!1);else{if(jt!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=Ed(t),o!==null){for(e.flags|=128,Ja(s,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)s=n,t=r,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,t=o.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return Ze(ut,ut.current&1|2),e.child}t=t.sibling}s.tail!==null&&It()>aa&&(e.flags|=128,r=!0,Ja(s,!1),e.lanes=4194304)}else{if(!r)if(t=Ed(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Ja(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!at)return Xt(e),null}else 2*It()-s.renderingStartTime>aa&&n!==1073741824&&(e.flags|=128,r=!0,Ja(s,!1),e.lanes=4194304);s.isBackwards?(o.sibling=e.child,e.child=o):(n=s.last,n!==null?n.sibling=o:e.child=o,s.last=o)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=It(),e.sibling=null,n=ut.current,Ze(ut,r?n&1|2:n&1),e):(Xt(e),null);case 22:case 23:return Kg(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?An&1073741824&&(Xt(e),e.subtreeFlags&6&&(e.flags|=8192)):Xt(e),null;case 24:return null;case 25:return null}throw Error(W(156,e.tag))}function c1(t,e){switch(Cg(e),e.tag){case 1:return Tn(e.type)&&pd(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return sa(),st(In),st(ln),Vg(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return Og(e),null;case 13:if(st(ut),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(W(340));ra()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return st(ut),null;case 4:return sa(),null;case 10:return Ng(e.type._context),null;case 22:case 23:return Kg(),null;case 24:return null;default:return null}}var fu=!1,tn=!1,u1=typeof WeakSet=="function"?WeakSet:Set,ie=null;function Mo(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){gt(t,e,r)}else n.current=null}function fm(t,e,n){try{n()}catch(r){gt(t,e,r)}}var mw=!1;function d1(t,e){if(Yp=ud,t=c0(),Sg(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{n.nodeType,s.nodeType}catch{n=null;break e}var o=0,a=-1,l=-1,d=0,h=0,f=t,m=null;t:for(;;){for(var _;f!==n||i!==0&&f.nodeType!==3||(a=o+i),f!==s||r!==0&&f.nodeType!==3||(l=o+r),f.nodeType===3&&(o+=f.nodeValue.length),(_=f.firstChild)!==null;)m=f,f=_;for(;;){if(f===t)break t;if(m===n&&++d===i&&(a=o),m===s&&++h===r&&(l=o),(_=f.nextSibling)!==null)break;f=m,m=f.parentNode}f=_}n=a===-1||l===-1?null:{start:a,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(Xp={focusedElem:t,selectionRange:n},ud=!1,ie=e;ie!==null;)if(e=ie,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,ie=t;else for(;ie!==null;){e=ie;try{var R=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(R!==null){var C=R.memoizedProps,y=R.memoizedState,I=e.stateNode,w=I.getSnapshotBeforeUpdate(e.elementType===e.type?C:Zn(e.type,C),y);I.__reactInternalSnapshotBeforeUpdate=w}break;case 3:var E=e.stateNode.containerInfo;E.nodeType===1?E.textContent="":E.nodeType===9&&E.documentElement&&E.removeChild(E.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(W(163))}}catch(O){gt(e,e.return,O)}if(t=e.sibling,t!==null){t.return=e.return,ie=t;break}ie=e.return}return R=mw,mw=!1,R}function Cl(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&t)===t){var s=i.destroy;i.destroy=void 0,s!==void 0&&fm(e,n,s)}i=i.next}while(i!==r)}}function gh(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function pm(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function sx(t){var e=t.alternate;e!==null&&(t.alternate=null,sx(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Ir],delete e[Yl],delete e[em],delete e[KP],delete e[GP])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function ox(t){return t.tag===5||t.tag===3||t.tag===4}function gw(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||ox(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function mm(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=fd));else if(r!==4&&(t=t.child,t!==null))for(mm(t,e,n),t=t.sibling;t!==null;)mm(t,e,n),t=t.sibling}function gm(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(gm(t,e,n),t=t.sibling;t!==null;)gm(t,e,n),t=t.sibling}var qt=null,er=!1;function ui(t,e,n){for(n=n.child;n!==null;)ax(t,e,n),n=n.sibling}function ax(t,e,n){if(br&&typeof br.onCommitFiberUnmount=="function")try{br.onCommitFiberUnmount(lh,n)}catch{}switch(n.tag){case 5:tn||Mo(n,e);case 6:var r=qt,i=er;qt=null,ui(t,e,n),qt=r,er=i,qt!==null&&(er?(t=qt,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):qt.removeChild(n.stateNode));break;case 18:qt!==null&&(er?(t=qt,n=n.stateNode,t.nodeType===8?qf(t.parentNode,n):t.nodeType===1&&qf(t,n),Hl(t)):qf(qt,n.stateNode));break;case 4:r=qt,i=er,qt=n.stateNode.containerInfo,er=!0,ui(t,e,n),qt=r,er=i;break;case 0:case 11:case 14:case 15:if(!tn&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var s=i,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&fm(n,e,o),i=i.next}while(i!==r)}ui(t,e,n);break;case 1:if(!tn&&(Mo(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(a){gt(n,e,a)}ui(t,e,n);break;case 21:ui(t,e,n);break;case 22:n.mode&1?(tn=(r=tn)||n.memoizedState!==null,ui(t,e,n),tn=r):ui(t,e,n);break;default:ui(t,e,n)}}function yw(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new u1),e.forEach(function(r){var i=w1.bind(null,t,r);n.has(r)||(n.add(r),r.then(i,i))})}}function Jn(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var s=t,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:qt=a.stateNode,er=!1;break e;case 3:qt=a.stateNode.containerInfo,er=!0;break e;case 4:qt=a.stateNode.containerInfo,er=!0;break e}a=a.return}if(qt===null)throw Error(W(160));ax(s,o,i),qt=null,er=!1;var l=i.alternate;l!==null&&(l.return=null),i.return=null}catch(d){gt(i,e,d)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)lx(e,t),e=e.sibling}function lx(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Jn(e,t),yr(t),r&4){try{Cl(3,t,t.return),gh(3,t)}catch(C){gt(t,t.return,C)}try{Cl(5,t,t.return)}catch(C){gt(t,t.return,C)}}break;case 1:Jn(e,t),yr(t),r&512&&n!==null&&Mo(n,n.return);break;case 5:if(Jn(e,t),yr(t),r&512&&n!==null&&Mo(n,n.return),t.flags&32){var i=t.stateNode;try{Bl(i,"")}catch(C){gt(t,t.return,C)}}if(r&4&&(i=t.stateNode,i!=null)){var s=t.memoizedProps,o=n!==null?n.memoizedProps:s,a=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{a==="input"&&s.type==="radio"&&s.name!=null&&PT(i,s),Up(a,o);var d=Up(a,s);for(o=0;o<l.length;o+=2){var h=l[o],f=l[o+1];h==="style"?OT(i,f):h==="dangerouslySetInnerHTML"?DT(i,f):h==="children"?Bl(i,f):hg(i,h,f,d)}switch(a){case"input":Op(i,s);break;case"textarea":NT(i,s);break;case"select":var m=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var _=s.value;_!=null?Bo(i,!!s.multiple,_,!1):m!==!!s.multiple&&(s.defaultValue!=null?Bo(i,!!s.multiple,s.defaultValue,!0):Bo(i,!!s.multiple,s.multiple?[]:"",!1))}i[Yl]=s}catch(C){gt(t,t.return,C)}}break;case 6:if(Jn(e,t),yr(t),r&4){if(t.stateNode===null)throw Error(W(162));i=t.stateNode,s=t.memoizedProps;try{i.nodeValue=s}catch(C){gt(t,t.return,C)}}break;case 3:if(Jn(e,t),yr(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Hl(e.containerInfo)}catch(C){gt(t,t.return,C)}break;case 4:Jn(e,t),yr(t);break;case 13:Jn(e,t),yr(t),i=t.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(Hg=It())),r&4&&yw(t);break;case 22:if(h=n!==null&&n.memoizedState!==null,t.mode&1?(tn=(d=tn)||h,Jn(e,t),tn=d):Jn(e,t),yr(t),r&8192){if(d=t.memoizedState!==null,(t.stateNode.isHidden=d)&&!h&&t.mode&1)for(ie=t,h=t.child;h!==null;){for(f=ie=h;ie!==null;){switch(m=ie,_=m.child,m.tag){case 0:case 11:case 14:case 15:Cl(4,m,m.return);break;case 1:Mo(m,m.return);var R=m.stateNode;if(typeof R.componentWillUnmount=="function"){r=m,n=m.return;try{e=r,R.props=e.memoizedProps,R.state=e.memoizedState,R.componentWillUnmount()}catch(C){gt(r,n,C)}}break;case 5:Mo(m,m.return);break;case 22:if(m.memoizedState!==null){vw(f);continue}}_!==null?(_.return=m,ie=_):vw(f)}h=h.sibling}e:for(h=null,f=t;;){if(f.tag===5){if(h===null){h=f;try{i=f.stateNode,d?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(a=f.stateNode,l=f.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=jT("display",o))}catch(C){gt(t,t.return,C)}}}else if(f.tag===6){if(h===null)try{f.stateNode.nodeValue=d?"":f.memoizedProps}catch(C){gt(t,t.return,C)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===t)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===t)break e;for(;f.sibling===null;){if(f.return===null||f.return===t)break e;h===f&&(h=null),f=f.return}h===f&&(h=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:Jn(e,t),yr(t),r&4&&yw(t);break;case 21:break;default:Jn(e,t),yr(t)}}function yr(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(ox(n)){var r=n;break e}n=n.return}throw Error(W(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(Bl(i,""),r.flags&=-33);var s=gw(t);gm(t,s,i);break;case 3:case 4:var o=r.stateNode.containerInfo,a=gw(t);mm(t,a,o);break;default:throw Error(W(161))}}catch(l){gt(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function h1(t,e,n){ie=t,cx(t)}function cx(t,e,n){for(var r=(t.mode&1)!==0;ie!==null;){var i=ie,s=i.child;if(i.tag===22&&r){var o=i.memoizedState!==null||fu;if(!o){var a=i.alternate,l=a!==null&&a.memoizedState!==null||tn;a=fu;var d=tn;if(fu=o,(tn=l)&&!d)for(ie=i;ie!==null;)o=ie,l=o.child,o.tag===22&&o.memoizedState!==null?ww(i):l!==null?(l.return=o,ie=l):ww(i);for(;s!==null;)ie=s,cx(s),s=s.sibling;ie=i,fu=a,tn=d}_w(t)}else i.subtreeFlags&8772&&s!==null?(s.return=i,ie=s):_w(t)}}function _w(t){for(;ie!==null;){var e=ie;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:tn||gh(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!tn)if(n===null)r.componentDidMount();else{var i=e.elementType===e.type?n.memoizedProps:Zn(e.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&nw(e,s,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}nw(e,o,n)}break;case 5:var a=e.stateNode;if(n===null&&e.flags&4){n=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var d=e.alternate;if(d!==null){var h=d.memoizedState;if(h!==null){var f=h.dehydrated;f!==null&&Hl(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(W(163))}tn||e.flags&512&&pm(e)}catch(m){gt(e,e.return,m)}}if(e===t){ie=null;break}if(n=e.sibling,n!==null){n.return=e.return,ie=n;break}ie=e.return}}function vw(t){for(;ie!==null;){var e=ie;if(e===t){ie=null;break}var n=e.sibling;if(n!==null){n.return=e.return,ie=n;break}ie=e.return}}function ww(t){for(;ie!==null;){var e=ie;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{gh(4,e)}catch(l){gt(e,n,l)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var i=e.return;try{r.componentDidMount()}catch(l){gt(e,i,l)}}var s=e.return;try{pm(e)}catch(l){gt(e,s,l)}break;case 5:var o=e.return;try{pm(e)}catch(l){gt(e,o,l)}}}catch(l){gt(e,e.return,l)}if(e===t){ie=null;break}var a=e.sibling;if(a!==null){a.return=e.return,ie=a;break}ie=e.return}}var f1=Math.ceil,xd=ei.ReactCurrentDispatcher,zg=ei.ReactCurrentOwner,Hn=ei.ReactCurrentBatchConfig,Fe=0,Bt=null,Ct=null,Gt=0,An=0,Fo=Xi(0),jt=0,nc=null,Ms=0,yh=0,qg=0,Al=null,vn=null,Hg=0,aa=1/0,Or=null,Sd=!1,ym=null,ji=null,pu=!1,Ci=null,bd=0,Rl=0,_m=null,Mu=-1,Fu=0;function fn(){return Fe&6?It():Mu!==-1?Mu:Mu=It()}function Oi(t){return t.mode&1?Fe&2&&Gt!==0?Gt&-Gt:YP.transition!==null?(Fu===0&&(Fu=KT()),Fu):(t=We,t!==0||(t=window.event,t=t===void 0?16:e0(t.type)),t):1}function or(t,e,n,r){if(50<Rl)throw Rl=0,_m=null,Error(W(185));vc(t,n,r),(!(Fe&2)||t!==Bt)&&(t===Bt&&(!(Fe&2)&&(yh|=n),jt===4&&_i(t,Gt)),xn(t,r),n===1&&Fe===0&&!(e.mode&1)&&(aa=It()+500,fh&&Ji()))}function xn(t,e){var n=t.callbackNode;YR(t,e);var r=cd(t,t===Bt?Gt:0);if(r===0)n!==null&&Rv(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&Rv(n),e===1)t.tag===0?QP(Ew.bind(null,t)):v0(Ew.bind(null,t)),HP(function(){!(Fe&6)&&Ji()}),n=null;else{switch(GT(r)){case 1:n=yg;break;case 4:n=HT;break;case 16:n=ld;break;case 536870912:n=WT;break;default:n=ld}n=yx(n,ux.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function ux(t,e){if(Mu=-1,Fu=0,Fe&6)throw Error(W(327));var n=t.callbackNode;if(Wo()&&t.callbackNode!==n)return null;var r=cd(t,t===Bt?Gt:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=Cd(t,r);else{e=r;var i=Fe;Fe|=2;var s=hx();(Bt!==t||Gt!==e)&&(Or=null,aa=It()+500,Cs(t,e));do try{g1();break}catch(a){dx(t,a)}while(!0);Pg(),xd.current=s,Fe=i,Ct!==null?e=0:(Bt=null,Gt=0,e=jt)}if(e!==0){if(e===2&&(i=Hp(t),i!==0&&(r=i,e=vm(t,i))),e===1)throw n=nc,Cs(t,0),_i(t,r),xn(t,It()),n;if(e===6)_i(t,r);else{if(i=t.current.alternate,!(r&30)&&!p1(i)&&(e=Cd(t,r),e===2&&(s=Hp(t),s!==0&&(r=s,e=vm(t,s))),e===1))throw n=nc,Cs(t,0),_i(t,r),xn(t,It()),n;switch(t.finishedWork=i,t.finishedLanes=r,e){case 0:case 1:throw Error(W(345));case 2:fs(t,vn,Or);break;case 3:if(_i(t,r),(r&130023424)===r&&(e=Hg+500-It(),10<e)){if(cd(t,0)!==0)break;if(i=t.suspendedLanes,(i&r)!==r){fn(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=Zp(fs.bind(null,t,vn,Or),e);break}fs(t,vn,Or);break;case 4:if(_i(t,r),(r&4194240)===r)break;for(e=t.eventTimes,i=-1;0<r;){var o=31-sr(r);s=1<<o,o=e[o],o>i&&(i=o),r&=~s}if(r=i,r=It()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*f1(r/1960))-r,10<r){t.timeoutHandle=Zp(fs.bind(null,t,vn,Or),r);break}fs(t,vn,Or);break;case 5:fs(t,vn,Or);break;default:throw Error(W(329))}}}return xn(t,It()),t.callbackNode===n?ux.bind(null,t):null}function vm(t,e){var n=Al;return t.current.memoizedState.isDehydrated&&(Cs(t,e).flags|=256),t=Cd(t,e),t!==2&&(e=vn,vn=n,e!==null&&wm(e)),t}function wm(t){vn===null?vn=t:vn.push.apply(vn,t)}function p1(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],s=i.getSnapshot;i=i.value;try{if(!lr(s(),i))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function _i(t,e){for(e&=~qg,e&=~yh,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-sr(e),r=1<<n;t[n]=-1,e&=~r}}function Ew(t){if(Fe&6)throw Error(W(327));Wo();var e=cd(t,0);if(!(e&1))return xn(t,It()),null;var n=Cd(t,e);if(t.tag!==0&&n===2){var r=Hp(t);r!==0&&(e=r,n=vm(t,r))}if(n===1)throw n=nc,Cs(t,0),_i(t,e),xn(t,It()),n;if(n===6)throw Error(W(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,fs(t,vn,Or),xn(t,It()),null}function Wg(t,e){var n=Fe;Fe|=1;try{return t(e)}finally{Fe=n,Fe===0&&(aa=It()+500,fh&&Ji())}}function Fs(t){Ci!==null&&Ci.tag===0&&!(Fe&6)&&Wo();var e=Fe;Fe|=1;var n=Hn.transition,r=We;try{if(Hn.transition=null,We=1,t)return t()}finally{We=r,Hn.transition=n,Fe=e,!(Fe&6)&&Ji()}}function Kg(){An=Fo.current,st(Fo)}function Cs(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,qP(n)),Ct!==null)for(n=Ct.return;n!==null;){var r=n;switch(Cg(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&pd();break;case 3:sa(),st(In),st(ln),Vg();break;case 5:Og(r);break;case 4:sa();break;case 13:st(ut);break;case 19:st(ut);break;case 10:Ng(r.type._context);break;case 22:case 23:Kg()}n=n.return}if(Bt=t,Ct=t=Vi(t.current,null),Gt=An=e,jt=0,nc=null,qg=yh=Ms=0,vn=Al=null,Ts!==null){for(e=0;e<Ts.length;e++)if(n=Ts[e],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,s=n.pending;if(s!==null){var o=s.next;s.next=i,r.next=o}n.pending=r}Ts=null}return t}function dx(t,e){do{var n=Ct;try{if(Pg(),Ou.current=Td,Id){for(var r=ht.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}Id=!1}if(Ls=0,Ut=Dt=ht=null,bl=!1,Zl=0,zg.current=null,n===null||n.return===null){jt=1,nc=e,Ct=null;break}e:{var s=t,o=n.return,a=n,l=e;if(e=Gt,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var d=l,h=a,f=h.tag;if(!(h.mode&1)&&(f===0||f===11||f===15)){var m=h.alternate;m?(h.updateQueue=m.updateQueue,h.memoizedState=m.memoizedState,h.lanes=m.lanes):(h.updateQueue=null,h.memoizedState=null)}var _=lw(o);if(_!==null){_.flags&=-257,cw(_,o,a,s,e),_.mode&1&&aw(s,d,e),e=_,l=d;var R=e.updateQueue;if(R===null){var C=new Set;C.add(l),e.updateQueue=C}else R.add(l);break e}else{if(!(e&1)){aw(s,d,e),Gg();break e}l=Error(W(426))}}else if(at&&a.mode&1){var y=lw(o);if(y!==null){!(y.flags&65536)&&(y.flags|=256),cw(y,o,a,s,e),Ag(oa(l,a));break e}}s=l=oa(l,a),jt!==4&&(jt=2),Al===null?Al=[s]:Al.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var I=G0(s,l,e);tw(s,I);break e;case 1:a=l;var w=s.type,E=s.stateNode;if(!(s.flags&128)&&(typeof w.getDerivedStateFromError=="function"||E!==null&&typeof E.componentDidCatch=="function"&&(ji===null||!ji.has(E)))){s.flags|=65536,e&=-e,s.lanes|=e;var O=Q0(s,a,e);tw(s,O);break e}}s=s.return}while(s!==null)}px(n)}catch(D){e=D,Ct===n&&n!==null&&(Ct=n=n.return);continue}break}while(!0)}function hx(){var t=xd.current;return xd.current=Td,t===null?Td:t}function Gg(){(jt===0||jt===3||jt===2)&&(jt=4),Bt===null||!(Ms&268435455)&&!(yh&268435455)||_i(Bt,Gt)}function Cd(t,e){var n=Fe;Fe|=2;var r=hx();(Bt!==t||Gt!==e)&&(Or=null,Cs(t,e));do try{m1();break}catch(i){dx(t,i)}while(!0);if(Pg(),Fe=n,xd.current=r,Ct!==null)throw Error(W(261));return Bt=null,Gt=0,jt}function m1(){for(;Ct!==null;)fx(Ct)}function g1(){for(;Ct!==null&&!BR();)fx(Ct)}function fx(t){var e=gx(t.alternate,t,An);t.memoizedProps=t.pendingProps,e===null?px(t):Ct=e,zg.current=null}function px(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=c1(n,e),n!==null){n.flags&=32767,Ct=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{jt=6,Ct=null;return}}else if(n=l1(n,e,An),n!==null){Ct=n;return}if(e=e.sibling,e!==null){Ct=e;return}Ct=e=t}while(e!==null);jt===0&&(jt=5)}function fs(t,e,n){var r=We,i=Hn.transition;try{Hn.transition=null,We=1,y1(t,e,n,r)}finally{Hn.transition=i,We=r}return null}function y1(t,e,n,r){do Wo();while(Ci!==null);if(Fe&6)throw Error(W(327));n=t.finishedWork;var i=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(W(177));t.callbackNode=null,t.callbackPriority=0;var s=n.lanes|n.childLanes;if(XR(t,s),t===Bt&&(Ct=Bt=null,Gt=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||pu||(pu=!0,yx(ld,function(){return Wo(),null})),s=(n.flags&15990)!==0,n.subtreeFlags&15990||s){s=Hn.transition,Hn.transition=null;var o=We;We=1;var a=Fe;Fe|=4,zg.current=null,d1(t,n),lx(n,t),LP(Xp),ud=!!Yp,Xp=Yp=null,t.current=n,h1(n),$R(),Fe=a,We=o,Hn.transition=s}else t.current=n;if(pu&&(pu=!1,Ci=t,bd=i),s=t.pendingLanes,s===0&&(ji=null),HR(n.stateNode),xn(t,It()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)i=e[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(Sd)throw Sd=!1,t=ym,ym=null,t;return bd&1&&t.tag!==0&&Wo(),s=t.pendingLanes,s&1?t===_m?Rl++:(Rl=0,_m=t):Rl=0,Ji(),null}function Wo(){if(Ci!==null){var t=GT(bd),e=Hn.transition,n=We;try{if(Hn.transition=null,We=16>t?16:t,Ci===null)var r=!1;else{if(t=Ci,Ci=null,bd=0,Fe&6)throw Error(W(331));var i=Fe;for(Fe|=4,ie=t.current;ie!==null;){var s=ie,o=s.child;if(ie.flags&16){var a=s.deletions;if(a!==null){for(var l=0;l<a.length;l++){var d=a[l];for(ie=d;ie!==null;){var h=ie;switch(h.tag){case 0:case 11:case 15:Cl(8,h,s)}var f=h.child;if(f!==null)f.return=h,ie=f;else for(;ie!==null;){h=ie;var m=h.sibling,_=h.return;if(sx(h),h===d){ie=null;break}if(m!==null){m.return=_,ie=m;break}ie=_}}}var R=s.alternate;if(R!==null){var C=R.child;if(C!==null){R.child=null;do{var y=C.sibling;C.sibling=null,C=y}while(C!==null)}}ie=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,ie=o;else e:for(;ie!==null;){if(s=ie,s.flags&2048)switch(s.tag){case 0:case 11:case 15:Cl(9,s,s.return)}var I=s.sibling;if(I!==null){I.return=s.return,ie=I;break e}ie=s.return}}var w=t.current;for(ie=w;ie!==null;){o=ie;var E=o.child;if(o.subtreeFlags&2064&&E!==null)E.return=o,ie=E;else e:for(o=w;ie!==null;){if(a=ie,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:gh(9,a)}}catch(D){gt(a,a.return,D)}if(a===o){ie=null;break e}var O=a.sibling;if(O!==null){O.return=a.return,ie=O;break e}ie=a.return}}if(Fe=i,Ji(),br&&typeof br.onPostCommitFiberRoot=="function")try{br.onPostCommitFiberRoot(lh,t)}catch{}r=!0}return r}finally{We=n,Hn.transition=e}}return!1}function Iw(t,e,n){e=oa(n,e),e=G0(t,e,1),t=Di(t,e,1),e=fn(),t!==null&&(vc(t,1,e),xn(t,e))}function gt(t,e,n){if(t.tag===3)Iw(t,t,n);else for(;e!==null;){if(e.tag===3){Iw(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(ji===null||!ji.has(r))){t=oa(n,t),t=Q0(e,t,1),e=Di(e,t,1),t=fn(),e!==null&&(vc(e,1,t),xn(e,t));break}}e=e.return}}function _1(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=fn(),t.pingedLanes|=t.suspendedLanes&n,Bt===t&&(Gt&n)===n&&(jt===4||jt===3&&(Gt&130023424)===Gt&&500>It()-Hg?Cs(t,0):qg|=n),xn(t,e)}function mx(t,e){e===0&&(t.mode&1?(e=iu,iu<<=1,!(iu&130023424)&&(iu=4194304)):e=1);var n=fn();t=Wr(t,e),t!==null&&(vc(t,e,n),xn(t,n))}function v1(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),mx(t,n)}function w1(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,i=t.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(W(314))}r!==null&&r.delete(e),mx(t,n)}var gx;gx=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||In.current)wn=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return wn=!1,a1(t,e,n);wn=!!(t.flags&131072)}else wn=!1,at&&e.flags&1048576&&w0(e,yd,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;Lu(t,e),t=e.pendingProps;var i=na(e,ln.current);Ho(e,n),i=Mg(null,e,r,t,i,n);var s=Fg();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Tn(r)?(s=!0,md(e)):s=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,Dg(e),i.updater=mh,e.stateNode=i,i._reactInternals=e,om(e,r,t,n),e=cm(null,e,r,!0,s,n)):(e.tag=0,at&&s&&bg(e),un(null,e,i,n),e=e.child),e;case 16:r=e.elementType;e:{switch(Lu(t,e),t=e.pendingProps,i=r._init,r=i(r._payload),e.type=r,i=e.tag=I1(r),t=Zn(r,t),i){case 0:e=lm(null,e,r,t,n);break e;case 1:e=hw(null,e,r,t,n);break e;case 11:e=uw(null,e,r,t,n);break e;case 14:e=dw(null,e,r,Zn(r.type,t),n);break e}throw Error(W(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Zn(r,i),lm(t,e,r,i,n);case 1:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Zn(r,i),hw(t,e,r,i,n);case 3:e:{if(Z0(e),t===null)throw Error(W(387));r=e.pendingProps,s=e.memoizedState,i=s.element,b0(t,e),wd(e,r,null,n);var o=e.memoizedState;if(r=o.element,s.isDehydrated)if(s={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){i=oa(Error(W(423)),e),e=fw(t,e,r,n,i);break e}else if(r!==i){i=oa(Error(W(424)),e),e=fw(t,e,r,n,i);break e}else for(Pn=ki(e.stateNode.containerInfo.firstChild),kn=e,at=!0,nr=null,n=x0(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(ra(),r===i){e=Kr(t,e,n);break e}un(t,e,r,n)}e=e.child}return e;case 5:return C0(e),t===null&&rm(e),r=e.type,i=e.pendingProps,s=t!==null?t.memoizedProps:null,o=i.children,Jp(r,i)?o=null:s!==null&&Jp(r,s)&&(e.flags|=32),J0(t,e),un(t,e,o,n),e.child;case 6:return t===null&&rm(e),null;case 13:return ex(t,e,n);case 4:return jg(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=ia(e,null,r,n):un(t,e,r,n),e.child;case 11:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Zn(r,i),uw(t,e,r,i,n);case 7:return un(t,e,e.pendingProps,n),e.child;case 8:return un(t,e,e.pendingProps.children,n),e.child;case 12:return un(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,i=e.pendingProps,s=e.memoizedProps,o=i.value,Ze(_d,r._currentValue),r._currentValue=o,s!==null)if(lr(s.value,o)){if(s.children===i.children&&!In.current){e=Kr(t,e,n);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var a=s.dependencies;if(a!==null){o=s.child;for(var l=a.firstContext;l!==null;){if(l.context===r){if(s.tag===1){l=$r(-1,n&-n),l.tag=2;var d=s.updateQueue;if(d!==null){d=d.shared;var h=d.pending;h===null?l.next=l:(l.next=h.next,h.next=l),d.pending=l}}s.lanes|=n,l=s.alternate,l!==null&&(l.lanes|=n),im(s.return,n,e),a.lanes|=n;break}l=l.next}}else if(s.tag===10)o=s.type===e.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(W(341));o.lanes|=n,a=o.alternate,a!==null&&(a.lanes|=n),im(o,n,e),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===e){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}un(t,e,i.children,n),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,Ho(e,n),i=Kn(i),r=r(i),e.flags|=1,un(t,e,r,n),e.child;case 14:return r=e.type,i=Zn(r,e.pendingProps),i=Zn(r.type,i),dw(t,e,r,i,n);case 15:return Y0(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Zn(r,i),Lu(t,e),e.tag=1,Tn(r)?(t=!0,md(e)):t=!1,Ho(e,n),K0(e,r,i),om(e,r,i,n),cm(null,e,r,!0,t,n);case 19:return tx(t,e,n);case 22:return X0(t,e,n)}throw Error(W(156,e.tag))};function yx(t,e){return qT(t,e)}function E1(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function zn(t,e,n,r){return new E1(t,e,n,r)}function Qg(t){return t=t.prototype,!(!t||!t.isReactComponent)}function I1(t){if(typeof t=="function")return Qg(t)?1:0;if(t!=null){if(t=t.$$typeof,t===pg)return 11;if(t===mg)return 14}return 2}function Vi(t,e){var n=t.alternate;return n===null?(n=zn(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Uu(t,e,n,r,i,s){var o=2;if(r=t,typeof t=="function")Qg(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case Ro:return As(n.children,i,s,e);case fg:o=8,i|=8;break;case Pp:return t=zn(12,n,e,i|2),t.elementType=Pp,t.lanes=s,t;case Np:return t=zn(13,n,e,i),t.elementType=Np,t.lanes=s,t;case kp:return t=zn(19,n,e,i),t.elementType=kp,t.lanes=s,t;case CT:return _h(n,i,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case ST:o=10;break e;case bT:o=9;break e;case pg:o=11;break e;case mg:o=14;break e;case mi:o=16,r=null;break e}throw Error(W(130,t==null?t:typeof t,""))}return e=zn(o,n,e,i),e.elementType=t,e.type=r,e.lanes=s,e}function As(t,e,n,r){return t=zn(7,t,r,e),t.lanes=n,t}function _h(t,e,n,r){return t=zn(22,t,r,e),t.elementType=CT,t.lanes=n,t.stateNode={isHidden:!1},t}function Jf(t,e,n){return t=zn(6,t,null,e),t.lanes=n,t}function Zf(t,e,n){return e=zn(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function T1(t,e,n,r,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Df(0),this.expirationTimes=Df(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Df(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function Yg(t,e,n,r,i,s,o,a,l){return t=new T1(t,e,n,a,l),e===1?(e=1,s===!0&&(e|=8)):e=0,s=zn(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Dg(s),t}function x1(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Ao,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function _x(t){if(!t)return qi;t=t._reactInternals;e:{if(to(t)!==t||t.tag!==1)throw Error(W(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Tn(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(W(171))}if(t.tag===1){var n=t.type;if(Tn(n))return _0(t,n,e)}return e}function vx(t,e,n,r,i,s,o,a,l){return t=Yg(n,r,!0,t,i,s,o,a,l),t.context=_x(null),n=t.current,r=fn(),i=Oi(n),s=$r(r,i),s.callback=e??null,Di(n,s,i),t.current.lanes=i,vc(t,i,r),xn(t,r),t}function vh(t,e,n,r){var i=e.current,s=fn(),o=Oi(i);return n=_x(n),e.context===null?e.context=n:e.pendingContext=n,e=$r(s,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=Di(i,e,o),t!==null&&(or(t,i,o,s),ju(t,i,o)),o}function Ad(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function Tw(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function Xg(t,e){Tw(t,e),(t=t.alternate)&&Tw(t,e)}function S1(){return null}var wx=typeof reportError=="function"?reportError:function(t){console.error(t)};function Jg(t){this._internalRoot=t}wh.prototype.render=Jg.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(W(409));vh(t,e,null,null)};wh.prototype.unmount=Jg.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Fs(function(){vh(null,t,null,null)}),e[Hr]=null}};function wh(t){this._internalRoot=t}wh.prototype.unstable_scheduleHydration=function(t){if(t){var e=XT();t={blockedOn:null,target:t,priority:e};for(var n=0;n<yi.length&&e!==0&&e<yi[n].priority;n++);yi.splice(n,0,t),n===0&&ZT(t)}};function Zg(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Eh(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function xw(){}function b1(t,e,n,r,i){if(i){if(typeof r=="function"){var s=r;r=function(){var d=Ad(o);s.call(d)}}var o=vx(e,r,t,0,null,!1,!1,"",xw);return t._reactRootContainer=o,t[Hr]=o.current,Gl(t.nodeType===8?t.parentNode:t),Fs(),o}for(;i=t.lastChild;)t.removeChild(i);if(typeof r=="function"){var a=r;r=function(){var d=Ad(l);a.call(d)}}var l=Yg(t,0,!1,null,null,!1,!1,"",xw);return t._reactRootContainer=l,t[Hr]=l.current,Gl(t.nodeType===8?t.parentNode:t),Fs(function(){vh(e,l,n,r)}),l}function Ih(t,e,n,r,i){var s=n._reactRootContainer;if(s){var o=s;if(typeof i=="function"){var a=i;i=function(){var l=Ad(o);a.call(l)}}vh(e,o,t,i)}else o=b1(n,e,t,i,r);return Ad(o)}QT=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=ul(e.pendingLanes);n!==0&&(_g(e,n|1),xn(e,It()),!(Fe&6)&&(aa=It()+500,Ji()))}break;case 13:Fs(function(){var r=Wr(t,1);if(r!==null){var i=fn();or(r,t,1,i)}}),Xg(t,1)}};vg=function(t){if(t.tag===13){var e=Wr(t,134217728);if(e!==null){var n=fn();or(e,t,134217728,n)}Xg(t,134217728)}};YT=function(t){if(t.tag===13){var e=Oi(t),n=Wr(t,e);if(n!==null){var r=fn();or(n,t,e,r)}Xg(t,e)}};XT=function(){return We};JT=function(t,e){var n=We;try{return We=t,e()}finally{We=n}};$p=function(t,e,n){switch(e){case"input":if(Op(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var i=hh(r);if(!i)throw Error(W(90));RT(r),Op(r,i)}}}break;case"textarea":NT(t,n);break;case"select":e=n.value,e!=null&&Bo(t,!!n.multiple,e,!1)}};MT=Wg;FT=Fs;var C1={usingClientEntryPoint:!1,Events:[Ec,Do,hh,VT,LT,Wg]},Za={findFiberByHostInstance:Is,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},A1={bundleType:Za.bundleType,version:Za.version,rendererPackageName:Za.rendererPackageName,rendererConfig:Za.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ei.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=$T(t),t===null?null:t.stateNode},findFiberByHostInstance:Za.findFiberByHostInstance||S1,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var mu=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!mu.isDisabled&&mu.supportsFiber)try{lh=mu.inject(A1),br=mu}catch{}}Vn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=C1;Vn.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Zg(e))throw Error(W(200));return x1(t,e,null,n)};Vn.createRoot=function(t,e){if(!Zg(t))throw Error(W(299));var n=!1,r="",i=wx;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=Yg(t,1,!1,null,null,n,!1,r,i),t[Hr]=e.current,Gl(t.nodeType===8?t.parentNode:t),new Jg(e)};Vn.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(W(188)):(t=Object.keys(t).join(","),Error(W(268,t)));return t=$T(e),t=t===null?null:t.stateNode,t};Vn.flushSync=function(t){return Fs(t)};Vn.hydrate=function(t,e,n){if(!Eh(e))throw Error(W(200));return Ih(null,t,e,!0,n)};Vn.hydrateRoot=function(t,e,n){if(!Zg(t))throw Error(W(405));var r=n!=null&&n.hydratedSources||null,i=!1,s="",o=wx;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(s=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=vx(e,null,t,1,n??null,i,!1,s,o),t[Hr]=e.current,Gl(t),r)for(t=0;t<r.length;t++)n=r[t],i=n._getVersion,i=i(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,i]:e.mutableSourceEagerHydrationData.push(n,i);return new wh(e)};Vn.render=function(t,e,n){if(!Eh(e))throw Error(W(200));return Ih(null,t,e,!1,n)};Vn.unmountComponentAtNode=function(t){if(!Eh(t))throw Error(W(40));return t._reactRootContainer?(Fs(function(){Ih(null,null,t,!1,function(){t._reactRootContainer=null,t[Hr]=null})}),!0):!1};Vn.unstable_batchedUpdates=Wg;Vn.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!Eh(n))throw Error(W(200));if(t==null||t._reactInternals===void 0)throw Error(W(38));return Ih(t,e,n,!1,r)};Vn.version="18.3.1-next-f1338f8080-20240426";function Ex(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Ex)}catch(t){console.error(t)}}Ex(),ET.exports=Vn;var R1=ET.exports,Ix,Sw=R1;Ix=Sw.createRoot,Sw.hydrateRoot;/**
 * react-router v7.9.6
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var bw="popstate";function P1(t={}){function e(r,i){let{pathname:s,search:o,hash:a}=r.location;return Em("",{pathname:s,search:o,hash:a},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function n(r,i){return typeof i=="string"?i:rc(i)}return k1(e,n,null,t)}function lt(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function Qn(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function N1(){return Math.random().toString(36).substring(2,10)}function Cw(t,e){return{usr:t.state,key:t.key,idx:e}}function Em(t,e,n=null,r){return{pathname:typeof t=="string"?t:t.pathname,search:"",hash:"",...typeof e=="string"?Sa(e):e,state:n,key:e&&e.key||r||N1()}}function rc({pathname:t="/",search:e="",hash:n=""}){return e&&e!=="?"&&(t+=e.charAt(0)==="?"?e:"?"+e),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function Sa(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substring(n),t=t.substring(0,n));let r=t.indexOf("?");r>=0&&(e.search=t.substring(r),t=t.substring(0,r)),t&&(e.pathname=t)}return e}function k1(t,e,n,r={}){let{window:i=document.defaultView,v5Compat:s=!1}=r,o=i.history,a="POP",l=null,d=h();d==null&&(d=0,o.replaceState({...o.state,idx:d},""));function h(){return(o.state||{idx:null}).idx}function f(){a="POP";let y=h(),I=y==null?null:y-d;d=y,l&&l({action:a,location:C.location,delta:I})}function m(y,I){a="PUSH";let w=Em(C.location,y,I);d=h()+1;let E=Cw(w,d),O=C.createHref(w);try{o.pushState(E,"",O)}catch(D){if(D instanceof DOMException&&D.name==="DataCloneError")throw D;i.location.assign(O)}s&&l&&l({action:a,location:C.location,delta:1})}function _(y,I){a="REPLACE";let w=Em(C.location,y,I);d=h();let E=Cw(w,d),O=C.createHref(w);o.replaceState(E,"",O),s&&l&&l({action:a,location:C.location,delta:0})}function R(y){return D1(y)}let C={get action(){return a},get location(){return t(i,o)},listen(y){if(l)throw new Error("A history only accepts one active listener");return i.addEventListener(bw,f),l=y,()=>{i.removeEventListener(bw,f),l=null}},createHref(y){return e(i,y)},createURL:R,encodeLocation(y){let I=R(y);return{pathname:I.pathname,search:I.search,hash:I.hash}},push:m,replace:_,go(y){return o.go(y)}};return C}function D1(t,e=!1){let n="http://localhost";typeof window<"u"&&(n=window.location.origin!=="null"?window.location.origin:window.location.href),lt(n,"No window.location.(origin|href) available to create URL");let r=typeof t=="string"?t:rc(t);return r=r.replace(/ $/,"%20"),!e&&r.startsWith("//")&&(r=n+r),new URL(r,n)}function Tx(t,e,n="/"){return j1(t,e,n,!1)}function j1(t,e,n,r){let i=typeof e=="string"?Sa(e):e,s=Gr(i.pathname||"/",n);if(s==null)return null;let o=xx(t);O1(o);let a=null;for(let l=0;a==null&&l<o.length;++l){let d=W1(s);a=q1(o[l],d,r)}return a}function xx(t,e=[],n=[],r="",i=!1){let s=(o,a,l=i,d)=>{let h={relativePath:d===void 0?o.path||"":d,caseSensitive:o.caseSensitive===!0,childrenIndex:a,route:o};if(h.relativePath.startsWith("/")){if(!h.relativePath.startsWith(r)&&l)return;lt(h.relativePath.startsWith(r),`Absolute route path "${h.relativePath}" nested under path "${r}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),h.relativePath=h.relativePath.slice(r.length)}let f=zr([r,h.relativePath]),m=n.concat(h);o.children&&o.children.length>0&&(lt(o.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${f}".`),xx(o.children,e,m,f,l)),!(o.path==null&&!o.index)&&e.push({path:f,score:$1(f,o.index),routesMeta:m})};return t.forEach((o,a)=>{var l;if(o.path===""||!((l=o.path)!=null&&l.includes("?")))s(o,a);else for(let d of Sx(o.path))s(o,a,!0,d)}),e}function Sx(t){let e=t.split("/");if(e.length===0)return[];let[n,...r]=e,i=n.endsWith("?"),s=n.replace(/\?$/,"");if(r.length===0)return i?[s,""]:[s];let o=Sx(r.join("/")),a=[];return a.push(...o.map(l=>l===""?s:[s,l].join("/"))),i&&a.push(...o),a.map(l=>t.startsWith("/")&&l===""?"/":l)}function O1(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:z1(e.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}var V1=/^:[\w-]+$/,L1=3,M1=2,F1=1,U1=10,B1=-2,Aw=t=>t==="*";function $1(t,e){let n=t.split("/"),r=n.length;return n.some(Aw)&&(r+=B1),e&&(r+=M1),n.filter(i=>!Aw(i)).reduce((i,s)=>i+(V1.test(s)?L1:s===""?F1:U1),r)}function z1(t,e){return t.length===e.length&&t.slice(0,-1).every((r,i)=>r===e[i])?t[t.length-1]-e[e.length-1]:0}function q1(t,e,n=!1){let{routesMeta:r}=t,i={},s="/",o=[];for(let a=0;a<r.length;++a){let l=r[a],d=a===r.length-1,h=s==="/"?e:e.slice(s.length)||"/",f=Rd({path:l.relativePath,caseSensitive:l.caseSensitive,end:d},h),m=l.route;if(!f&&d&&n&&!r[r.length-1].route.index&&(f=Rd({path:l.relativePath,caseSensitive:l.caseSensitive,end:!1},h)),!f)return null;Object.assign(i,f.params),o.push({params:i,pathname:zr([s,f.pathname]),pathnameBase:X1(zr([s,f.pathnameBase])),route:m}),f.pathnameBase!=="/"&&(s=zr([s,f.pathnameBase]))}return o}function Rd(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,r]=H1(t.path,t.caseSensitive,t.end),i=e.match(n);if(!i)return null;let s=i[0],o=s.replace(/(.)\/+$/,"$1"),a=i.slice(1);return{params:r.reduce((d,{paramName:h,isOptional:f},m)=>{if(h==="*"){let R=a[m]||"";o=s.slice(0,s.length-R.length).replace(/(.)\/+$/,"$1")}const _=a[m];return f&&!_?d[h]=void 0:d[h]=(_||"").replace(/%2F/g,"/"),d},{}),pathname:s,pathnameBase:o,pattern:t}}function H1(t,e=!1,n=!0){Qn(t==="*"||!t.endsWith("*")||t.endsWith("/*"),`Route path "${t}" will be treated as if it were "${t.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${t.replace(/\*$/,"/*")}".`);let r=[],i="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,a,l)=>(r.push({paramName:a,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return t.endsWith("*")?(r.push({paramName:"*"}),i+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?i+="\\/*$":t!==""&&t!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,e?void 0:"i"),r]}function W1(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Qn(!1,`The URL path "${t}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),t}}function Gr(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,r=t.charAt(n);return r&&r!=="/"?null:t.slice(n)||"/"}var K1=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,G1=t=>K1.test(t);function Q1(t,e="/"){let{pathname:n,search:r="",hash:i=""}=typeof t=="string"?Sa(t):t,s;if(n)if(G1(n))s=n;else{if(n.includes("//")){let o=n;n=n.replace(/\/\/+/g,"/"),Qn(!1,`Pathnames cannot have embedded double slashes - normalizing ${o} -> ${n}`)}n.startsWith("/")?s=Rw(n.substring(1),"/"):s=Rw(n,e)}else s=e;return{pathname:s,search:J1(r),hash:Z1(i)}}function Rw(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(i=>{i===".."?n.length>1&&n.pop():i!=="."&&n.push(i)}),n.length>1?n.join("/"):"/"}function ep(t,e,n,r){return`Cannot include a '${t}' character in a manually specified \`to.${e}\` field [${JSON.stringify(r)}].  Please separate it out to the \`to.${n}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function Y1(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function ey(t){let e=Y1(t);return e.map((n,r)=>r===e.length-1?n.pathname:n.pathnameBase)}function ty(t,e,n,r=!1){let i;typeof t=="string"?i=Sa(t):(i={...t},lt(!i.pathname||!i.pathname.includes("?"),ep("?","pathname","search",i)),lt(!i.pathname||!i.pathname.includes("#"),ep("#","pathname","hash",i)),lt(!i.search||!i.search.includes("#"),ep("#","search","hash",i)));let s=t===""||i.pathname==="",o=s?"/":i.pathname,a;if(o==null)a=n;else{let f=e.length-1;if(!r&&o.startsWith("..")){let m=o.split("/");for(;m[0]==="..";)m.shift(),f-=1;i.pathname=m.join("/")}a=f>=0?e[f]:"/"}let l=Q1(i,a),d=o&&o!=="/"&&o.endsWith("/"),h=(s||o===".")&&n.endsWith("/");return!l.pathname.endsWith("/")&&(d||h)&&(l.pathname+="/"),l}var zr=t=>t.join("/").replace(/\/\/+/g,"/"),X1=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),J1=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,Z1=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function eN(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var bx=["POST","PUT","PATCH","DELETE"];new Set(bx);var tN=["GET",...bx];new Set(tN);var ba=N.createContext(null);ba.displayName="DataRouter";var Th=N.createContext(null);Th.displayName="DataRouterState";N.createContext(!1);var Cx=N.createContext({isTransitioning:!1});Cx.displayName="ViewTransition";var nN=N.createContext(new Map);nN.displayName="Fetchers";var rN=N.createContext(null);rN.displayName="Await";var hr=N.createContext(null);hr.displayName="Navigation";var Tc=N.createContext(null);Tc.displayName="Location";var Dr=N.createContext({outlet:null,matches:[],isDataRoute:!1});Dr.displayName="Route";var ny=N.createContext(null);ny.displayName="RouteError";function iN(t,{relative:e}={}){lt(Ca(),"useHref() may be used only in the context of a <Router> component.");let{basename:n,navigator:r}=N.useContext(hr),{hash:i,pathname:s,search:o}=xc(t,{relative:e}),a=s;return n!=="/"&&(a=s==="/"?n:zr([n,s])),r.createHref({pathname:a,search:o,hash:i})}function Ca(){return N.useContext(Tc)!=null}function Zi(){return lt(Ca(),"useLocation() may be used only in the context of a <Router> component."),N.useContext(Tc).location}var Ax="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function Rx(t){N.useContext(hr).static||N.useLayoutEffect(t)}function xh(){let{isDataRoute:t}=N.useContext(Dr);return t?yN():sN()}function sN(){lt(Ca(),"useNavigate() may be used only in the context of a <Router> component.");let t=N.useContext(ba),{basename:e,navigator:n}=N.useContext(hr),{matches:r}=N.useContext(Dr),{pathname:i}=Zi(),s=JSON.stringify(ey(r)),o=N.useRef(!1);return Rx(()=>{o.current=!0}),N.useCallback((l,d={})=>{if(Qn(o.current,Ax),!o.current)return;if(typeof l=="number"){n.go(l);return}let h=ty(l,JSON.parse(s),i,d.relative==="path");t==null&&e!=="/"&&(h.pathname=h.pathname==="/"?e:zr([e,h.pathname])),(d.replace?n.replace:n.push)(h,d.state,d)},[e,n,s,i,t])}N.createContext(null);function xc(t,{relative:e}={}){let{matches:n}=N.useContext(Dr),{pathname:r}=Zi(),i=JSON.stringify(ey(n));return N.useMemo(()=>ty(t,JSON.parse(i),r,e==="path"),[t,i,r,e])}function oN(t,e){return Px(t,e)}function Px(t,e,n,r,i){var w;lt(Ca(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:s}=N.useContext(hr),{matches:o}=N.useContext(Dr),a=o[o.length-1],l=a?a.params:{},d=a?a.pathname:"/",h=a?a.pathnameBase:"/",f=a&&a.route;{let E=f&&f.path||"";Nx(d,!f||E.endsWith("*")||E.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${d}" (under <Route path="${E}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${E}"> to <Route path="${E==="/"?"*":`${E}/*`}">.`)}let m=Zi(),_;if(e){let E=typeof e=="string"?Sa(e):e;lt(h==="/"||((w=E.pathname)==null?void 0:w.startsWith(h)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${h}" but pathname "${E.pathname}" was given in the \`location\` prop.`),_=E}else _=m;let R=_.pathname||"/",C=R;if(h!=="/"){let E=h.replace(/^\//,"").split("/");C="/"+R.replace(/^\//,"").split("/").slice(E.length).join("/")}let y=Tx(t,{pathname:C});Qn(f||y!=null,`No routes matched location "${_.pathname}${_.search}${_.hash}" `),Qn(y==null||y[y.length-1].route.element!==void 0||y[y.length-1].route.Component!==void 0||y[y.length-1].route.lazy!==void 0,`Matched leaf route at location "${_.pathname}${_.search}${_.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let I=dN(y&&y.map(E=>Object.assign({},E,{params:Object.assign({},l,E.params),pathname:zr([h,s.encodeLocation?s.encodeLocation(E.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:E.pathname]),pathnameBase:E.pathnameBase==="/"?h:zr([h,s.encodeLocation?s.encodeLocation(E.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:E.pathnameBase])})),o,n,r,i);return e&&I?N.createElement(Tc.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",..._},navigationType:"POP"}},I):I}function aN(){let t=gN(),e=eN(t)?`${t.status} ${t.statusText}`:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,r="rgba(200,200,200, 0.5)",i={padding:"0.5rem",backgroundColor:r},s={padding:"2px 4px",backgroundColor:r},o=null;return console.error("Error handled by React Router default ErrorBoundary:",t),o=N.createElement(N.Fragment,null,N.createElement("p",null," Hey developer "),N.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",N.createElement("code",{style:s},"ErrorBoundary")," or"," ",N.createElement("code",{style:s},"errorElement")," prop on your route.")),N.createElement(N.Fragment,null,N.createElement("h2",null,"Unexpected Application Error!"),N.createElement("h3",{style:{fontStyle:"italic"}},e),n?N.createElement("pre",{style:i},n):null,o)}var lN=N.createElement(aN,null),cN=class extends N.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,e){return e.location!==t.location||e.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:e.error,location:e.location,revalidation:t.revalidation||e.revalidation}}componentDidCatch(t,e){this.props.onError?this.props.onError(t,e):console.error("React Router caught the following error during render",t)}render(){return this.state.error!==void 0?N.createElement(Dr.Provider,{value:this.props.routeContext},N.createElement(ny.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function uN({routeContext:t,match:e,children:n}){let r=N.useContext(ba);return r&&r.static&&r.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=e.route.id),N.createElement(Dr.Provider,{value:t},n)}function dN(t,e=[],n=null,r=null,i=null){if(t==null){if(!n)return null;if(n.errors)t=n.matches;else if(e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let s=t,o=n==null?void 0:n.errors;if(o!=null){let h=s.findIndex(f=>f.route.id&&(o==null?void 0:o[f.route.id])!==void 0);lt(h>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(o).join(",")}`),s=s.slice(0,Math.min(s.length,h+1))}let a=!1,l=-1;if(n)for(let h=0;h<s.length;h++){let f=s[h];if((f.route.HydrateFallback||f.route.hydrateFallbackElement)&&(l=h),f.route.id){let{loaderData:m,errors:_}=n,R=f.route.loader&&!m.hasOwnProperty(f.route.id)&&(!_||_[f.route.id]===void 0);if(f.route.lazy||R){a=!0,l>=0?s=s.slice(0,l+1):s=[s[0]];break}}}let d=n&&r?(h,f)=>{var m,_;r(h,{location:n.location,params:((_=(m=n.matches)==null?void 0:m[0])==null?void 0:_.params)??{},errorInfo:f})}:void 0;return s.reduceRight((h,f,m)=>{let _,R=!1,C=null,y=null;n&&(_=o&&f.route.id?o[f.route.id]:void 0,C=f.route.errorElement||lN,a&&(l<0&&m===0?(Nx("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),R=!0,y=null):l===m&&(R=!0,y=f.route.hydrateFallbackElement||null)));let I=e.concat(s.slice(0,m+1)),w=()=>{let E;return _?E=C:R?E=y:f.route.Component?E=N.createElement(f.route.Component,null):f.route.element?E=f.route.element:E=h,N.createElement(uN,{match:f,routeContext:{outlet:h,matches:I,isDataRoute:n!=null},children:E})};return n&&(f.route.ErrorBoundary||f.route.errorElement||m===0)?N.createElement(cN,{location:n.location,revalidation:n.revalidation,component:C,error:_,children:w(),routeContext:{outlet:null,matches:I,isDataRoute:!0},onError:d}):w()},null)}function ry(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function hN(t){let e=N.useContext(ba);return lt(e,ry(t)),e}function fN(t){let e=N.useContext(Th);return lt(e,ry(t)),e}function pN(t){let e=N.useContext(Dr);return lt(e,ry(t)),e}function iy(t){let e=pN(t),n=e.matches[e.matches.length-1];return lt(n.route.id,`${t} can only be used on routes that contain a unique "id"`),n.route.id}function mN(){return iy("useRouteId")}function gN(){var r;let t=N.useContext(ny),e=fN("useRouteError"),n=iy("useRouteError");return t!==void 0?t:(r=e.errors)==null?void 0:r[n]}function yN(){let{router:t}=hN("useNavigate"),e=iy("useNavigate"),n=N.useRef(!1);return Rx(()=>{n.current=!0}),N.useCallback(async(i,s={})=>{Qn(n.current,Ax),n.current&&(typeof i=="number"?t.navigate(i):await t.navigate(i,{fromRouteId:e,...s}))},[t,e])}var Pw={};function Nx(t,e,n){!e&&!Pw[t]&&(Pw[t]=!0,Qn(!1,n))}N.memo(_N);function _N({routes:t,future:e,state:n,unstable_onError:r}){return Px(t,void 0,n,r,e)}function Im({to:t,replace:e,state:n,relative:r}){lt(Ca(),"<Navigate> may be used only in the context of a <Router> component.");let{static:i}=N.useContext(hr);Qn(!i,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:s}=N.useContext(Dr),{pathname:o}=Zi(),a=xh(),l=ty(t,ey(s),o,r==="path"),d=JSON.stringify(l);return N.useEffect(()=>{a(JSON.parse(d),{replace:e,state:n,relative:r})},[a,d,r,e,n]),null}function To(t){lt(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function vN({basename:t="/",children:e=null,location:n,navigationType:r="POP",navigator:i,static:s=!1}){lt(!Ca(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let o=t.replace(/^\/*/,"/"),a=N.useMemo(()=>({basename:o,navigator:i,static:s,future:{}}),[o,i,s]);typeof n=="string"&&(n=Sa(n));let{pathname:l="/",search:d="",hash:h="",state:f=null,key:m="default"}=n,_=N.useMemo(()=>{let R=Gr(l,o);return R==null?null:{location:{pathname:R,search:d,hash:h,state:f,key:m},navigationType:r}},[o,l,d,h,f,m,r]);return Qn(_!=null,`<Router basename="${o}"> is not able to match the URL "${l}${d}${h}" because it does not start with the basename, so the <Router> won't render anything.`),_==null?null:N.createElement(hr.Provider,{value:a},N.createElement(Tc.Provider,{children:e,value:_}))}function wN({children:t,location:e}){return oN(Tm(t),e)}function Tm(t,e=[]){let n=[];return N.Children.forEach(t,(r,i)=>{if(!N.isValidElement(r))return;let s=[...e,i];if(r.type===N.Fragment){n.push.apply(n,Tm(r.props.children,s));return}lt(r.type===To,`[${typeof r.type=="string"?r.type:r.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),lt(!r.props.index||!r.props.children,"An index route cannot have child routes.");let o={id:r.props.id||s.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,middleware:r.props.middleware,loader:r.props.loader,action:r.props.action,hydrateFallbackElement:r.props.hydrateFallbackElement,HydrateFallback:r.props.HydrateFallback,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.hasErrorBoundary===!0||r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(o.children=Tm(r.props.children,s)),n.push(o)}),n}var Bu="get",$u="application/x-www-form-urlencoded";function Sh(t){return t!=null&&typeof t.tagName=="string"}function EN(t){return Sh(t)&&t.tagName.toLowerCase()==="button"}function IN(t){return Sh(t)&&t.tagName.toLowerCase()==="form"}function TN(t){return Sh(t)&&t.tagName.toLowerCase()==="input"}function xN(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function SN(t,e){return t.button===0&&(!e||e==="_self")&&!xN(t)}var gu=null;function bN(){if(gu===null)try{new FormData(document.createElement("form"),0),gu=!1}catch{gu=!0}return gu}var CN=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function tp(t){return t!=null&&!CN.has(t)?(Qn(!1,`"${t}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${$u}"`),null):t}function AN(t,e){let n,r,i,s,o;if(IN(t)){let a=t.getAttribute("action");r=a?Gr(a,e):null,n=t.getAttribute("method")||Bu,i=tp(t.getAttribute("enctype"))||$u,s=new FormData(t)}else if(EN(t)||TN(t)&&(t.type==="submit"||t.type==="image")){let a=t.form;if(a==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let l=t.getAttribute("formaction")||a.getAttribute("action");if(r=l?Gr(l,e):null,n=t.getAttribute("formmethod")||a.getAttribute("method")||Bu,i=tp(t.getAttribute("formenctype"))||tp(a.getAttribute("enctype"))||$u,s=new FormData(a,t),!bN()){let{name:d,type:h,value:f}=t;if(h==="image"){let m=d?`${d}.`:"";s.append(`${m}x`,"0"),s.append(`${m}y`,"0")}else d&&s.append(d,f)}}else{if(Sh(t))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');n=Bu,r=null,i=$u,o=t}return s&&i==="text/plain"&&(o=s,s=void 0),{action:r,method:n.toLowerCase(),encType:i,formData:s,body:o}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function sy(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function RN(t,e,n){let r=typeof t=="string"?new URL(t,typeof window>"u"?"server://singlefetch/":window.location.origin):t;return r.pathname==="/"?r.pathname=`_root.${n}`:e&&Gr(r.pathname,e)==="/"?r.pathname=`${e.replace(/\/$/,"")}/_root.${n}`:r.pathname=`${r.pathname.replace(/\/$/,"")}.${n}`,r}async function PN(t,e){if(t.id in e)return e[t.id];try{let n=await import(t.module);return e[t.id]=n,n}catch(n){return console.error(`Error loading route module \`${t.module}\`, reloading page...`),console.error(n),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function NN(t){return t==null?!1:t.href==null?t.rel==="preload"&&typeof t.imageSrcSet=="string"&&typeof t.imageSizes=="string":typeof t.rel=="string"&&typeof t.href=="string"}async function kN(t,e,n){let r=await Promise.all(t.map(async i=>{let s=e.routes[i.route.id];if(s){let o=await PN(s,n);return o.links?o.links():[]}return[]}));return VN(r.flat(1).filter(NN).filter(i=>i.rel==="stylesheet"||i.rel==="preload").map(i=>i.rel==="stylesheet"?{...i,rel:"prefetch",as:"style"}:{...i,rel:"prefetch"}))}function Nw(t,e,n,r,i,s){let o=(l,d)=>n[d]?l.route.id!==n[d].route.id:!0,a=(l,d)=>{var h;return n[d].pathname!==l.pathname||((h=n[d].route.path)==null?void 0:h.endsWith("*"))&&n[d].params["*"]!==l.params["*"]};return s==="assets"?e.filter((l,d)=>o(l,d)||a(l,d)):s==="data"?e.filter((l,d)=>{var f;let h=r.routes[l.route.id];if(!h||!h.hasLoader)return!1;if(o(l,d)||a(l,d))return!0;if(l.route.shouldRevalidate){let m=l.route.shouldRevalidate({currentUrl:new URL(i.pathname+i.search+i.hash,window.origin),currentParams:((f=n[0])==null?void 0:f.params)||{},nextUrl:new URL(t,window.origin),nextParams:l.params,defaultShouldRevalidate:!0});if(typeof m=="boolean")return m}return!0}):[]}function DN(t,e,{includeHydrateFallback:n}={}){return jN(t.map(r=>{let i=e.routes[r.route.id];if(!i)return[];let s=[i.module];return i.clientActionModule&&(s=s.concat(i.clientActionModule)),i.clientLoaderModule&&(s=s.concat(i.clientLoaderModule)),n&&i.hydrateFallbackModule&&(s=s.concat(i.hydrateFallbackModule)),i.imports&&(s=s.concat(i.imports)),s}).flat(1))}function jN(t){return[...new Set(t)]}function ON(t){let e={},n=Object.keys(t).sort();for(let r of n)e[r]=t[r];return e}function VN(t,e){let n=new Set;return new Set(e),t.reduce((r,i)=>{let s=JSON.stringify(ON(i));return n.has(s)||(n.add(s),r.push({key:s,link:i})),r},[])}function kx(){let t=N.useContext(ba);return sy(t,"You must render this element inside a <DataRouterContext.Provider> element"),t}function LN(){let t=N.useContext(Th);return sy(t,"You must render this element inside a <DataRouterStateContext.Provider> element"),t}var oy=N.createContext(void 0);oy.displayName="FrameworkContext";function Dx(){let t=N.useContext(oy);return sy(t,"You must render this element inside a <HydratedRouter> element"),t}function MN(t,e){let n=N.useContext(oy),[r,i]=N.useState(!1),[s,o]=N.useState(!1),{onFocus:a,onBlur:l,onMouseEnter:d,onMouseLeave:h,onTouchStart:f}=e,m=N.useRef(null);N.useEffect(()=>{if(t==="render"&&o(!0),t==="viewport"){let C=I=>{I.forEach(w=>{o(w.isIntersecting)})},y=new IntersectionObserver(C,{threshold:.5});return m.current&&y.observe(m.current),()=>{y.disconnect()}}},[t]),N.useEffect(()=>{if(r){let C=setTimeout(()=>{o(!0)},100);return()=>{clearTimeout(C)}}},[r]);let _=()=>{i(!0)},R=()=>{i(!1),o(!1)};return n?t!=="intent"?[s,m,{}]:[s,m,{onFocus:el(a,_),onBlur:el(l,R),onMouseEnter:el(d,_),onMouseLeave:el(h,R),onTouchStart:el(f,_)}]:[!1,m,{}]}function el(t,e){return n=>{t&&t(n),n.defaultPrevented||e(n)}}function FN({page:t,...e}){let{router:n}=kx(),r=N.useMemo(()=>Tx(n.routes,t,n.basename),[n.routes,t,n.basename]);return r?N.createElement(BN,{page:t,matches:r,...e}):null}function UN(t){let{manifest:e,routeModules:n}=Dx(),[r,i]=N.useState([]);return N.useEffect(()=>{let s=!1;return kN(t,e,n).then(o=>{s||i(o)}),()=>{s=!0}},[t,e,n]),r}function BN({page:t,matches:e,...n}){let r=Zi(),{manifest:i,routeModules:s}=Dx(),{basename:o}=kx(),{loaderData:a,matches:l}=LN(),d=N.useMemo(()=>Nw(t,e,l,i,r,"data"),[t,e,l,i,r]),h=N.useMemo(()=>Nw(t,e,l,i,r,"assets"),[t,e,l,i,r]),f=N.useMemo(()=>{if(t===r.pathname+r.search+r.hash)return[];let R=new Set,C=!1;if(e.forEach(I=>{var E;let w=i.routes[I.route.id];!w||!w.hasLoader||(!d.some(O=>O.route.id===I.route.id)&&I.route.id in a&&((E=s[I.route.id])!=null&&E.shouldRevalidate)||w.hasClientLoader?C=!0:R.add(I.route.id))}),R.size===0)return[];let y=RN(t,o,"data");return C&&R.size>0&&y.searchParams.set("_routes",e.filter(I=>R.has(I.route.id)).map(I=>I.route.id).join(",")),[y.pathname+y.search]},[o,a,r,i,d,e,t,s]),m=N.useMemo(()=>DN(h,i),[h,i]),_=UN(h);return N.createElement(N.Fragment,null,f.map(R=>N.createElement("link",{key:R,rel:"prefetch",as:"fetch",href:R,...n})),m.map(R=>N.createElement("link",{key:R,rel:"modulepreload",href:R,...n})),_.map(({key:R,link:C})=>N.createElement("link",{key:R,nonce:n.nonce,...C})))}function $N(...t){return e=>{t.forEach(n=>{typeof n=="function"?n(e):n!=null&&(n.current=e)})}}var jx=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{jx&&(window.__reactRouterVersion="7.9.6")}catch{}function zN({basename:t,children:e,window:n}){let r=N.useRef();r.current==null&&(r.current=P1({window:n,v5Compat:!0}));let i=r.current,[s,o]=N.useState({action:i.action,location:i.location}),a=N.useCallback(l=>{N.startTransition(()=>o(l))},[o]);return N.useLayoutEffect(()=>i.listen(a),[i,a]),N.createElement(vN,{basename:t,children:e,location:s.location,navigationType:s.action,navigator:i})}var Ox=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Vx=N.forwardRef(function({onClick:e,discover:n="render",prefetch:r="none",relative:i,reloadDocument:s,replace:o,state:a,target:l,to:d,preventScrollReset:h,viewTransition:f,...m},_){let{basename:R}=N.useContext(hr),C=typeof d=="string"&&Ox.test(d),y,I=!1;if(typeof d=="string"&&C&&(y=d,jx))try{let b=new URL(window.location.href),A=d.startsWith("//")?new URL(b.protocol+d):new URL(d),j=Gr(A.pathname,R);A.origin===b.origin&&j!=null?d=j+A.search+A.hash:I=!0}catch{Qn(!1,`<Link to="${d}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let w=iN(d,{relative:i}),[E,O,D]=MN(r,m),B=KN(d,{replace:o,state:a,target:l,preventScrollReset:h,relative:i,viewTransition:f});function x(b){e&&e(b),b.defaultPrevented||B(b)}let v=N.createElement("a",{...m,...D,href:y||w,onClick:I||s?e:x,ref:$N(_,O),target:l,"data-discover":!C&&n==="render"?"true":void 0});return E&&!C?N.createElement(N.Fragment,null,v,N.createElement(FN,{page:w})):v});Vx.displayName="Link";var qN=N.forwardRef(function({"aria-current":e="page",caseSensitive:n=!1,className:r="",end:i=!1,style:s,to:o,viewTransition:a,children:l,...d},h){let f=xc(o,{relative:d.relative}),m=Zi(),_=N.useContext(Th),{navigator:R,basename:C}=N.useContext(hr),y=_!=null&&JN(f)&&a===!0,I=R.encodeLocation?R.encodeLocation(f).pathname:f.pathname,w=m.pathname,E=_&&_.navigation&&_.navigation.location?_.navigation.location.pathname:null;n||(w=w.toLowerCase(),E=E?E.toLowerCase():null,I=I.toLowerCase()),E&&C&&(E=Gr(E,C)||E);const O=I!=="/"&&I.endsWith("/")?I.length-1:I.length;let D=w===I||!i&&w.startsWith(I)&&w.charAt(O)==="/",B=E!=null&&(E===I||!i&&E.startsWith(I)&&E.charAt(I.length)==="/"),x={isActive:D,isPending:B,isTransitioning:y},v=D?e:void 0,b;typeof r=="function"?b=r(x):b=[r,D?"active":null,B?"pending":null,y?"transitioning":null].filter(Boolean).join(" ");let A=typeof s=="function"?s(x):s;return N.createElement(Vx,{...d,"aria-current":v,className:b,ref:h,style:A,to:o,viewTransition:a},typeof l=="function"?l(x):l)});qN.displayName="NavLink";var HN=N.forwardRef(({discover:t="render",fetcherKey:e,navigate:n,reloadDocument:r,replace:i,state:s,method:o=Bu,action:a,onSubmit:l,relative:d,preventScrollReset:h,viewTransition:f,...m},_)=>{let R=YN(),C=XN(a,{relative:d}),y=o.toLowerCase()==="get"?"get":"post",I=typeof a=="string"&&Ox.test(a),w=E=>{if(l&&l(E),E.defaultPrevented)return;E.preventDefault();let O=E.nativeEvent.submitter,D=(O==null?void 0:O.getAttribute("formmethod"))||o;R(O||E.currentTarget,{fetcherKey:e,method:D,navigate:n,replace:i,state:s,relative:d,preventScrollReset:h,viewTransition:f})};return N.createElement("form",{ref:_,method:y,action:C,onSubmit:r?l:w,...m,"data-discover":!I&&t==="render"?"true":void 0})});HN.displayName="Form";function WN(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function Lx(t){let e=N.useContext(ba);return lt(e,WN(t)),e}function KN(t,{target:e,replace:n,state:r,preventScrollReset:i,relative:s,viewTransition:o}={}){let a=xh(),l=Zi(),d=xc(t,{relative:s});return N.useCallback(h=>{if(SN(h,e)){h.preventDefault();let f=n!==void 0?n:rc(l)===rc(d);a(t,{replace:f,state:r,preventScrollReset:i,relative:s,viewTransition:o})}},[l,a,d,n,r,e,t,i,s,o])}var GN=0,QN=()=>`__${String(++GN)}__`;function YN(){let{router:t}=Lx("useSubmit"),{basename:e}=N.useContext(hr),n=mN();return N.useCallback(async(r,i={})=>{let{action:s,method:o,encType:a,formData:l,body:d}=AN(r,e);if(i.navigate===!1){let h=i.fetcherKey||QN();await t.fetch(h,n,i.action||s,{preventScrollReset:i.preventScrollReset,formData:l,body:d,formMethod:i.method||o,formEncType:i.encType||a,flushSync:i.flushSync})}else await t.navigate(i.action||s,{preventScrollReset:i.preventScrollReset,formData:l,body:d,formMethod:i.method||o,formEncType:i.encType||a,replace:i.replace,state:i.state,fromRouteId:n,flushSync:i.flushSync,viewTransition:i.viewTransition})},[t,e,n])}function XN(t,{relative:e}={}){let{basename:n}=N.useContext(hr),r=N.useContext(Dr);lt(r,"useFormAction must be used inside a RouteContext");let[i]=r.matches.slice(-1),s={...xc(t||".",{relative:e})},o=Zi();if(t==null){s.search=o.search;let a=new URLSearchParams(s.search),l=a.getAll("index");if(l.some(h=>h==="")){a.delete("index"),l.filter(f=>f).forEach(f=>a.append("index",f));let h=a.toString();s.search=h?`?${h}`:""}}return(!t||t===".")&&i.route.index&&(s.search=s.search?s.search.replace(/^\?/,"?index&"):"?index"),n!=="/"&&(s.pathname=s.pathname==="/"?n:zr([n,s.pathname])),rc(s)}function JN(t,{relative:e}={}){let n=N.useContext(Cx);lt(n!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:r}=Lx("useViewTransitionState"),i=xc(t,{relative:e});if(!n.isTransitioning)return!1;let s=Gr(n.currentLocation.pathname,r)||n.currentLocation.pathname,o=Gr(n.nextLocation.pathname,r)||n.nextLocation.pathname;return Rd(i.pathname,o)!=null||Rd(i.pathname,s)!=null}const ZN=()=>{};var kw={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mx=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let i=t.charCodeAt(r);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=i&63|128):(i&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=i&63|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=i&63|128)}return e},ek=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const i=t[n++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=t[n++];e[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){const s=t[n++],o=t[n++],a=t[n++],l=((i&7)<<18|(s&63)<<12|(o&63)<<6|a&63)-65536;e[r++]=String.fromCharCode(55296+(l>>10)),e[r++]=String.fromCharCode(56320+(l&1023))}else{const s=t[n++],o=t[n++];e[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|o&63)}}return e.join("")},Fx={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<t.length;i+=3){const s=t[i],o=i+1<t.length,a=o?t[i+1]:0,l=i+2<t.length,d=l?t[i+2]:0,h=s>>2,f=(s&3)<<4|a>>4;let m=(a&15)<<2|d>>6,_=d&63;l||(_=64,o||(m=64)),r.push(n[h],n[f],n[m],n[_])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(Mx(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):ek(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<t.length;){const s=n[t.charAt(i++)],a=i<t.length?n[t.charAt(i)]:0;++i;const d=i<t.length?n[t.charAt(i)]:64;++i;const f=i<t.length?n[t.charAt(i)]:64;if(++i,s==null||a==null||d==null||f==null)throw new tk;const m=s<<2|a>>4;if(r.push(m),d!==64){const _=a<<4&240|d>>2;if(r.push(_),f!==64){const R=d<<6&192|f;r.push(R)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class tk extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const nk=function(t){const e=Mx(t);return Fx.encodeByteArray(e,!0)},Pd=function(t){return nk(t).replace(/\./g,"")},Ux=function(t){try{return Fx.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bx(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rk=()=>Bx().__FIREBASE_DEFAULTS__,ik=()=>{if(typeof process>"u"||typeof kw>"u")return;const t=kw.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},sk=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&Ux(t[1]);return e&&JSON.parse(e)},bh=()=>{try{return ZN()||rk()||ik()||sk()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},$x=t=>{var e,n;return(n=(e=bh())==null?void 0:e.emulatorHosts)==null?void 0:n[t]},zx=t=>{const e=$x(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},qx=()=>{var t;return(t=bh())==null?void 0:t.config},Hx=t=>{var e;return(e=bh())==null?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ok{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function es(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function ay(t){return(await fetch(t,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wx(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",i=t.iat||0,s=t.sub||t.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o={iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}},...t};return[Pd(JSON.stringify(n)),Pd(JSON.stringify(o)),""].join(".")}const Pl={};function ak(){const t={prod:[],emulator:[]};for(const e of Object.keys(Pl))Pl[e]?t.emulator.push(e):t.prod.push(e);return t}function lk(t){let e=document.getElementById(t),n=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),n=!0),{created:n,element:e}}let Dw=!1;function ly(t,e){if(typeof window>"u"||typeof document>"u"||!es(window.location.host)||Pl[t]===e||Pl[t]||Dw)return;Pl[t]=e;function n(m){return`__firebase__banner__${m}`}const r="__firebase__banner",s=ak().prod.length>0;function o(){const m=document.getElementById(r);m&&m.remove()}function a(m){m.style.display="flex",m.style.background="#7faaf0",m.style.position="fixed",m.style.bottom="5px",m.style.left="5px",m.style.padding=".5em",m.style.borderRadius="5px",m.style.alignItems="center"}function l(m,_){m.setAttribute("width","24"),m.setAttribute("id",_),m.setAttribute("height","24"),m.setAttribute("viewBox","0 0 24 24"),m.setAttribute("fill","none"),m.style.marginLeft="-6px"}function d(){const m=document.createElement("span");return m.style.cursor="pointer",m.style.marginLeft="16px",m.style.fontSize="24px",m.innerHTML=" &times;",m.onclick=()=>{Dw=!0,o()},m}function h(m,_){m.setAttribute("id",_),m.innerText="Learn more",m.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",m.setAttribute("target","__blank"),m.style.paddingLeft="5px",m.style.textDecoration="underline"}function f(){const m=lk(r),_=n("text"),R=document.getElementById(_)||document.createElement("span"),C=n("learnmore"),y=document.getElementById(C)||document.createElement("a"),I=n("preprendIcon"),w=document.getElementById(I)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(m.created){const E=m.element;a(E),h(y,C);const O=d();l(w,I),E.append(w,R,y,O),document.body.appendChild(E)}s?(R.innerText="Preview backend disconnected.",w.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(w.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,R.innerText="Preview backend running in this workspace."),R.setAttribute("id",_)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",f):f()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ot(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function ck(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Ot())}function Kx(){var e;const t=(e=bh())==null?void 0:e.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function uk(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function Gx(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function dk(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function hk(){const t=Ot();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function Qx(){return!Kx()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Yx(){return!Kx()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function cy(){try{return typeof indexedDB=="object"}catch{return!1}}function Xx(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var s;e(((s=i.error)==null?void 0:s.message)||"")}}catch(n){e(n)}})}function fk(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pk="FirebaseError";class Xn extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=pk,Object.setPrototypeOf(this,Xn.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,no.prototype.create)}}class no{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},i=`${this.service}/${e}`,s=this.errors[e],o=s?mk(s,r):"Error",a=`${this.serviceName}: ${o} (${i}).`;return new Xn(i,a,r)}}function mk(t,e){return t.replace(gk,(n,r)=>{const i=e[r];return i!=null?String(i):`<${r}?>`})}const gk=/\{\$([^}]+)}/g;function yk(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Qr(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const i of n){if(!r.includes(i))return!1;const s=t[i],o=e[i];if(jw(s)&&jw(o)){if(!Qr(s,o))return!1}else if(s!==o)return!1}for(const i of r)if(!n.includes(i))return!1;return!0}function jw(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sc(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function hl(t){const e={};return t.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[i,s]=r.split("=");e[decodeURIComponent(i)]=decodeURIComponent(s)}}),e}function fl(t){const e=t.indexOf("?");if(!e)return"";const n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}function _k(t,e){const n=new vk(t,e);return n.subscribe.bind(n)}class vk{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let i;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");wk(e,["next","error","complete"])?i=e:i={next:e,error:n,complete:r},i.next===void 0&&(i.next=np),i.error===void 0&&(i.error=np),i.complete===void 0&&(i.complete=np);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function wk(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function np(){}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ek=1e3,Ik=2,Tk=4*60*60*1e3,xk=.5;function Ow(t,e=Ek,n=Ik){const r=e*Math.pow(n,t),i=Math.round(xk*r*(Math.random()-.5)*2);return Math.min(Tk,r+i)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ze(t){return t&&t._delegate?t._delegate:t}class Yn{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ps="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sk{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new ok;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:n});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){const n=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),r=(e==null?void 0:e.optional)??!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(i){if(r)return null;throw i}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(Ck(e))try{this.getOrInitializeService({instanceIdentifier:ps})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(n);try{const s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(e=ps){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=ps){return this.instances.has(e)}getOptions(e=ps){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[s,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(s);r===a&&o.resolve(i)}return i}onInit(e,n){const r=this.normalizeInstanceIdentifier(n),i=this.onInitCallbacks.get(r)??new Set;i.add(e),this.onInitCallbacks.set(r,i);const s=this.instances.get(r);return s&&e(s,r),()=>{i.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const i of r)try{i(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:bk(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=ps){return this.component?this.component.multipleInstances?e:ps:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function bk(t){return t===ps?void 0:t}function Ck(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ak{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new Sk(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Pe;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Pe||(Pe={}));const Rk={debug:Pe.DEBUG,verbose:Pe.VERBOSE,info:Pe.INFO,warn:Pe.WARN,error:Pe.ERROR,silent:Pe.SILENT},Pk=Pe.INFO,Nk={[Pe.DEBUG]:"log",[Pe.VERBOSE]:"log",[Pe.INFO]:"info",[Pe.WARN]:"warn",[Pe.ERROR]:"error"},kk=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),i=Nk[e];if(i)console[i](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Ch{constructor(e){this.name=e,this._logLevel=Pk,this._logHandler=kk,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Pe))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?Rk[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Pe.DEBUG,...e),this._logHandler(this,Pe.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Pe.VERBOSE,...e),this._logHandler(this,Pe.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Pe.INFO,...e),this._logHandler(this,Pe.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Pe.WARN,...e),this._logHandler(this,Pe.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Pe.ERROR,...e),this._logHandler(this,Pe.ERROR,...e)}}const Dk=(t,e)=>e.some(n=>t instanceof n);let Vw,Lw;function jk(){return Vw||(Vw=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Ok(){return Lw||(Lw=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Jx=new WeakMap,xm=new WeakMap,Zx=new WeakMap,rp=new WeakMap,uy=new WeakMap;function Vk(t){const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("success",s),t.removeEventListener("error",o)},s=()=>{n(Li(t.result)),i()},o=()=>{r(t.error),i()};t.addEventListener("success",s),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&Jx.set(n,t)}).catch(()=>{}),uy.set(e,t),e}function Lk(t){if(xm.has(t))return;const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("complete",s),t.removeEventListener("error",o),t.removeEventListener("abort",o)},s=()=>{n(),i()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",s),t.addEventListener("error",o),t.addEventListener("abort",o)});xm.set(t,e)}let Sm={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return xm.get(t);if(e==="objectStoreNames")return t.objectStoreNames||Zx.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Li(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function Mk(t){Sm=t(Sm)}function Fk(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(ip(this),e,...n);return Zx.set(r,e.sort?e.sort():[e]),Li(r)}:Ok().includes(t)?function(...e){return t.apply(ip(this),e),Li(Jx.get(this))}:function(...e){return Li(t.apply(ip(this),e))}}function Uk(t){return typeof t=="function"?Fk(t):(t instanceof IDBTransaction&&Lk(t),Dk(t,jk())?new Proxy(t,Sm):t)}function Li(t){if(t instanceof IDBRequest)return Vk(t);if(rp.has(t))return rp.get(t);const e=Uk(t);return e!==t&&(rp.set(t,e),uy.set(e,t)),e}const ip=t=>uy.get(t);function eS(t,e,{blocked:n,upgrade:r,blocking:i,terminated:s}={}){const o=indexedDB.open(t,e),a=Li(o);return r&&o.addEventListener("upgradeneeded",l=>{r(Li(o.result),l.oldVersion,l.newVersion,Li(o.transaction),l)}),n&&o.addEventListener("blocked",l=>n(l.oldVersion,l.newVersion,l)),a.then(l=>{s&&l.addEventListener("close",()=>s()),i&&l.addEventListener("versionchange",d=>i(d.oldVersion,d.newVersion,d))}).catch(()=>{}),a}const Bk=["get","getKey","getAll","getAllKeys","count"],$k=["put","add","delete","clear"],sp=new Map;function Mw(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(sp.get(e))return sp.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,i=$k.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(i||Bk.includes(n)))return;const s=async function(o,...a){const l=this.transaction(o,i?"readwrite":"readonly");let d=l.store;return r&&(d=d.index(a.shift())),(await Promise.all([d[n](...a),i&&l.done]))[0]};return sp.set(e,s),s}Mk(t=>({...t,get:(e,n,r)=>Mw(e,n)||t.get(e,n,r),has:(e,n)=>!!Mw(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zk{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(qk(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function qk(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const bm="@firebase/app",Fw="0.14.5";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yr=new Ch("@firebase/app"),Hk="@firebase/app-compat",Wk="@firebase/analytics-compat",Kk="@firebase/analytics",Gk="@firebase/app-check-compat",Qk="@firebase/app-check",Yk="@firebase/auth",Xk="@firebase/auth-compat",Jk="@firebase/database",Zk="@firebase/data-connect",eD="@firebase/database-compat",tD="@firebase/functions",nD="@firebase/functions-compat",rD="@firebase/installations",iD="@firebase/installations-compat",sD="@firebase/messaging",oD="@firebase/messaging-compat",aD="@firebase/performance",lD="@firebase/performance-compat",cD="@firebase/remote-config",uD="@firebase/remote-config-compat",dD="@firebase/storage",hD="@firebase/storage-compat",fD="@firebase/firestore",pD="@firebase/ai",mD="@firebase/firestore-compat",gD="firebase",yD="12.5.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cm="[DEFAULT]",_D={[bm]:"fire-core",[Hk]:"fire-core-compat",[Kk]:"fire-analytics",[Wk]:"fire-analytics-compat",[Qk]:"fire-app-check",[Gk]:"fire-app-check-compat",[Yk]:"fire-auth",[Xk]:"fire-auth-compat",[Jk]:"fire-rtdb",[Zk]:"fire-data-connect",[eD]:"fire-rtdb-compat",[tD]:"fire-fn",[nD]:"fire-fn-compat",[rD]:"fire-iid",[iD]:"fire-iid-compat",[sD]:"fire-fcm",[oD]:"fire-fcm-compat",[aD]:"fire-perf",[lD]:"fire-perf-compat",[cD]:"fire-rc",[uD]:"fire-rc-compat",[dD]:"fire-gcs",[hD]:"fire-gcs-compat",[fD]:"fire-fst",[mD]:"fire-fst-compat",[pD]:"fire-vertex","fire-js":"fire-js",[gD]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nd=new Map,vD=new Map,Am=new Map;function Uw(t,e){try{t.container.addComponent(e)}catch(n){Yr.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function cr(t){const e=t.name;if(Am.has(e))return Yr.debug(`There were multiple attempts to register component ${e}.`),!1;Am.set(e,t);for(const n of Nd.values())Uw(n,t);for(const n of vD.values())Uw(n,t);return!0}function ts(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function Bn(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wD={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Mi=new no("app","Firebase",wD);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ED{constructor(e,n,r){this._isDeleted=!1,this._options={...e},this._config={...n},this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Yn("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Mi.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ro=yD;function dy(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r={name:Cm,automaticDataCollectionEnabled:!0,...e},i=r.name;if(typeof i!="string"||!i)throw Mi.create("bad-app-name",{appName:String(i)});if(n||(n=qx()),!n)throw Mi.create("no-options");const s=Nd.get(i);if(s){if(Qr(n,s.options)&&Qr(r,s.config))return s;throw Mi.create("duplicate-app",{appName:i})}const o=new Ak(i);for(const l of Am.values())o.addComponent(l);const a=new ED(n,r,o);return Nd.set(i,a),a}function Ah(t=Cm){const e=Nd.get(t);if(!e&&t===Cm&&qx())return dy();if(!e)throw Mi.create("no-app",{appName:t});return e}function Sn(t,e,n){let r=_D[t]??t;n&&(r+=`-${n}`);const i=r.match(/\s|\//),s=e.match(/\s|\//);if(i||s){const o=[`Unable to register library "${r}" with version "${e}":`];i&&o.push(`library name "${r}" contains illegal characters (whitespace or "/")`),i&&s&&o.push("and"),s&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Yr.warn(o.join(" "));return}cr(new Yn(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ID="firebase-heartbeat-database",TD=1,ic="firebase-heartbeat-store";let op=null;function tS(){return op||(op=eS(ID,TD,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(ic)}catch(n){console.warn(n)}}}}).catch(t=>{throw Mi.create("idb-open",{originalErrorMessage:t.message})})),op}async function xD(t){try{const n=(await tS()).transaction(ic),r=await n.objectStore(ic).get(nS(t));return await n.done,r}catch(e){if(e instanceof Xn)Yr.warn(e.message);else{const n=Mi.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Yr.warn(n.message)}}}async function Bw(t,e){try{const r=(await tS()).transaction(ic,"readwrite");await r.objectStore(ic).put(e,nS(t)),await r.done}catch(n){if(n instanceof Xn)Yr.warn(n.message);else{const r=Mi.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});Yr.warn(r.message)}}}function nS(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SD=1024,bD=30;class CD{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new RD(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=$w();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)==null?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(o=>o.date===s))return;if(this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats.length>bD){const o=PD(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){Yr.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=$w(),{heartbeatsToSend:r,unsentEntries:i}=AD(this._heartbeatsCache.heartbeats),s=Pd(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(n){return Yr.warn(n),""}}}function $w(){return new Date().toISOString().substring(0,10)}function AD(t,e=SD){const n=[];let r=t.slice();for(const i of t){const s=n.find(o=>o.agent===i.agent);if(s){if(s.dates.push(i.date),zw(n)>e){s.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),zw(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class RD{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return cy()?Xx().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await xD(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return Bw(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return Bw(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function zw(t){return Pd(JSON.stringify({version:2,heartbeats:t})).length}function PD(t){if(t.length===0)return-1;let e=0,n=t[0].date;for(let r=1;r<t.length;r++)t[r].date<n&&(n=t[r].date,e=r);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ND(t){cr(new Yn("platform-logger",e=>new zk(e),"PRIVATE")),cr(new Yn("heartbeat",e=>new CD(e),"PRIVATE")),Sn(bm,Fw,t),Sn(bm,Fw,"esm2020"),Sn("fire-js","")}ND("");var kD="firebase",DD="12.5.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Sn(kD,DD,"app");function rS(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const jD=rS,iS=new no("auth","Firebase",rS());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kd=new Ch("@firebase/auth");function OD(t,...e){kd.logLevel<=Pe.WARN&&kd.warn(`Auth (${ro}): ${t}`,...e)}function zu(t,...e){kd.logLevel<=Pe.ERROR&&kd.error(`Auth (${ro}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ur(t,...e){throw hy(t,...e)}function Ar(t,...e){return hy(t,...e)}function sS(t,e,n){const r={...jD(),[e]:n};return new no("auth","Firebase",r).create(e,{appName:t.name})}function Fi(t){return sS(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function hy(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return iS.create(t,...e)}function ye(t,e,...n){if(!t)throw hy(e,...n)}function Fr(t){const e="INTERNAL ASSERTION FAILED: "+t;throw zu(e),new Error(e)}function Xr(t,e){t||Fr(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rm(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.href)||""}function VD(){return qw()==="http:"||qw()==="https:"}function qw(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function LD(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(VD()||Gx()||"connection"in navigator)?navigator.onLine:!0}function MD(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bc{constructor(e,n){this.shortDelay=e,this.longDelay=n,Xr(n>e,"Short delay should be less than long delay!"),this.isMobile=ck()||dk()}get(){return LD()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fy(t,e){Xr(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oS{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Fr("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Fr("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Fr("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FD={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UD=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],BD=new bc(3e4,6e4);function io(t,e){return t.tenantId&&!e.tenantId?{...e,tenantId:t.tenantId}:e}async function ns(t,e,n,r,i={}){return aS(t,i,async()=>{let s={},o={};r&&(e==="GET"?o=r:s={body:JSON.stringify(r)});const a=Sc({key:t.config.apiKey,...o}).slice(1),l=await t._getAdditionalHeaders();l["Content-Type"]="application/json",t.languageCode&&(l["X-Firebase-Locale"]=t.languageCode);const d={method:e,headers:l,...s};return uk()||(d.referrerPolicy="no-referrer"),t.emulatorConfig&&es(t.emulatorConfig.host)&&(d.credentials="include"),oS.fetch()(await lS(t,t.config.apiHost,n,a),d)})}async function aS(t,e,n){t._canInitEmulator=!1;const r={...FD,...e};try{const i=new zD(t),s=await Promise.race([n(),i.promise]);i.clearNetworkTimeout();const o=await s.json();if("needConfirmation"in o)throw yu(t,"account-exists-with-different-credential",o);if(s.ok&&!("errorMessage"in o))return o;{const a=s.ok?o.errorMessage:o.error.message,[l,d]=a.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw yu(t,"credential-already-in-use",o);if(l==="EMAIL_EXISTS")throw yu(t,"email-already-in-use",o);if(l==="USER_DISABLED")throw yu(t,"user-disabled",o);const h=r[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(d)throw sS(t,h,d);ur(t,h)}}catch(i){if(i instanceof Xn)throw i;ur(t,"network-request-failed",{message:String(i)})}}async function Rh(t,e,n,r,i={}){const s=await ns(t,e,n,r,i);return"mfaPendingCredential"in s&&ur(t,"multi-factor-auth-required",{_serverResponse:s}),s}async function lS(t,e,n,r){const i=`${e}${n}?${r}`,s=t,o=s.config.emulator?fy(t.config,i):`${t.config.apiScheme}://${i}`;return UD.includes(n)&&(await s._persistenceManagerAvailable,s._getPersistenceType()==="COOKIE")?s._getPersistence()._getFinalTarget(o).toString():o}function $D(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class zD{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(Ar(this.auth,"network-request-failed")),BD.get())})}}function yu(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const i=Ar(t,e,r);return i.customData._tokenResponse=n,i}function Hw(t){return t!==void 0&&t.enterprise!==void 0}class qD{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const n of this.recaptchaEnforcementState)if(n.provider&&n.provider===e)return $D(n.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function HD(t,e){return ns(t,"GET","/v2/recaptchaConfig",io(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function WD(t,e){return ns(t,"POST","/v1/accounts:delete",e)}async function Dd(t,e){return ns(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nl(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function KD(t,e=!1){const n=ze(t),r=await n.getIdToken(e),i=py(r);ye(i&&i.exp&&i.auth_time&&i.iat,n.auth,"internal-error");const s=typeof i.firebase=="object"?i.firebase:void 0,o=s==null?void 0:s.sign_in_provider;return{claims:i,token:r,authTime:Nl(ap(i.auth_time)),issuedAtTime:Nl(ap(i.iat)),expirationTime:Nl(ap(i.exp)),signInProvider:o||null,signInSecondFactor:(s==null?void 0:s.sign_in_second_factor)||null}}function ap(t){return Number(t)*1e3}function py(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return zu("JWT malformed, contained fewer than 3 sections"),null;try{const i=Ux(n);return i?JSON.parse(i):(zu("Failed to decode base64 JWT payload"),null)}catch(i){return zu("Caught error parsing JWT payload as JSON",i==null?void 0:i.toString()),null}}function Ww(t){const e=py(t);return ye(e,"internal-error"),ye(typeof e.exp<"u","internal-error"),ye(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function sc(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof Xn&&GD(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function GD({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QD{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const r=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pm{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=Nl(this.lastLoginAt),this.creationTime=Nl(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function jd(t){var f;const e=t.auth,n=await t.getIdToken(),r=await sc(t,Dd(e,{idToken:n}));ye(r==null?void 0:r.users.length,e,"internal-error");const i=r.users[0];t._notifyReloadListener(i);const s=(f=i.providerUserInfo)!=null&&f.length?cS(i.providerUserInfo):[],o=XD(t.providerData,s),a=t.isAnonymous,l=!(t.email&&i.passwordHash)&&!(o!=null&&o.length),d=a?l:!1,h={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:o,metadata:new Pm(i.createdAt,i.lastLoginAt),isAnonymous:d};Object.assign(t,h)}async function YD(t){const e=ze(t);await jd(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function XD(t,e){return[...t.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function cS(t){return t.map(({providerId:e,...n})=>({providerId:e,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function JD(t,e){const n=await aS(t,{},async()=>{const r=Sc({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=t.config,o=await lS(t,i,"/v1/token",`key=${s}`),a=await t._getAdditionalHeaders();a["Content-Type"]="application/x-www-form-urlencoded";const l={method:"POST",headers:a,body:r};return t.emulatorConfig&&es(t.emulatorConfig.host)&&(l.credentials="include"),oS.fetch()(o,l)});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function ZD(t,e){return ns(t,"POST","/v2/accounts:revokeToken",io(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ko{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){ye(e.idToken,"internal-error"),ye(typeof e.idToken<"u","internal-error"),ye(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Ww(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){ye(e.length!==0,"internal-error");const n=Ww(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(ye(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:i,expiresIn:s}=await JD(e,n);this.updateTokensAndExpiration(r,i,Number(s))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:i,expirationTime:s}=n,o=new Ko;return r&&(ye(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),i&&(ye(typeof i=="string","internal-error",{appName:e}),o.accessToken=i),s&&(ye(typeof s=="number","internal-error",{appName:e}),o.expirationTime=s),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Ko,this.toJSON())}_performRefresh(){return Fr("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function di(t,e){ye(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class ir{constructor({uid:e,auth:n,stsTokenManager:r,...i}){this.providerId="firebase",this.proactiveRefresh=new QD(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=n,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new Pm(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const n=await sc(this,this.stsTokenManager.getToken(this.auth,e));return ye(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return KD(this,e)}reload(){return YD(this)}_assign(e){this!==e&&(ye(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>({...n})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new ir({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return n.metadata._copy(this.metadata),n}_onReload(e){ye(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await jd(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Bn(this.auth.app))return Promise.reject(Fi(this.auth));const e=await this.getIdToken();return await sc(this,WD(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){const r=n.displayName??void 0,i=n.email??void 0,s=n.phoneNumber??void 0,o=n.photoURL??void 0,a=n.tenantId??void 0,l=n._redirectEventId??void 0,d=n.createdAt??void 0,h=n.lastLoginAt??void 0,{uid:f,emailVerified:m,isAnonymous:_,providerData:R,stsTokenManager:C}=n;ye(f&&C,e,"internal-error");const y=Ko.fromJSON(this.name,C);ye(typeof f=="string",e,"internal-error"),di(r,e.name),di(i,e.name),ye(typeof m=="boolean",e,"internal-error"),ye(typeof _=="boolean",e,"internal-error"),di(s,e.name),di(o,e.name),di(a,e.name),di(l,e.name),di(d,e.name),di(h,e.name);const I=new ir({uid:f,auth:e,email:i,emailVerified:m,displayName:r,isAnonymous:_,photoURL:o,phoneNumber:s,tenantId:a,stsTokenManager:y,createdAt:d,lastLoginAt:h});return R&&Array.isArray(R)&&(I.providerData=R.map(w=>({...w}))),l&&(I._redirectEventId=l),I}static async _fromIdTokenResponse(e,n,r=!1){const i=new Ko;i.updateFromServerResponse(n);const s=new ir({uid:n.localId,auth:e,stsTokenManager:i,isAnonymous:r});return await jd(s),s}static async _fromGetAccountInfoResponse(e,n,r){const i=n.users[0];ye(i.localId!==void 0,"internal-error");const s=i.providerUserInfo!==void 0?cS(i.providerUserInfo):[],o=!(i.email&&i.passwordHash)&&!(s!=null&&s.length),a=new Ko;a.updateFromIdToken(r);const l=new ir({uid:i.localId,auth:e,stsTokenManager:a,isAnonymous:o}),d={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new Pm(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!(s!=null&&s.length)};return Object.assign(l,d),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kw=new Map;function Ur(t){Xr(t instanceof Function,"Expected a class definition");let e=Kw.get(t);return e?(Xr(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,Kw.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uS{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}uS.type="NONE";const Gw=uS;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qu(t,e,n){return`firebase:${t}:${e}:${n}`}class Go{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:i,name:s}=this.auth;this.fullUserKey=qu(this.userKey,i.apiKey,s),this.fullPersistenceKey=qu("persistence",i.apiKey,s),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const n=await Dd(this.auth,{idToken:e}).catch(()=>{});return n?ir._fromGetAccountInfoResponse(this.auth,n,e):null}return ir._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new Go(Ur(Gw),e,r);const i=(await Promise.all(n.map(async d=>{if(await d._isAvailable())return d}))).filter(d=>d);let s=i[0]||Ur(Gw);const o=qu(r,e.config.apiKey,e.name);let a=null;for(const d of n)try{const h=await d._get(o);if(h){let f;if(typeof h=="string"){const m=await Dd(e,{idToken:h}).catch(()=>{});if(!m)break;f=await ir._fromGetAccountInfoResponse(e,m,h)}else f=ir._fromJSON(e,h);d!==s&&(a=f),s=d;break}}catch{}const l=i.filter(d=>d._shouldAllowMigration);return!s._shouldAllowMigration||!l.length?new Go(s,e,r):(s=l[0],a&&await s._set(o,a.toJSON()),await Promise.all(n.map(async d=>{if(d!==s)try{await d._remove(o)}catch{}})),new Go(s,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qw(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(pS(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(dS(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(gS(e))return"Blackberry";if(yS(e))return"Webos";if(hS(e))return"Safari";if((e.includes("chrome/")||fS(e))&&!e.includes("edge/"))return"Chrome";if(mS(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function dS(t=Ot()){return/firefox\//i.test(t)}function hS(t=Ot()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function fS(t=Ot()){return/crios\//i.test(t)}function pS(t=Ot()){return/iemobile/i.test(t)}function mS(t=Ot()){return/android/i.test(t)}function gS(t=Ot()){return/blackberry/i.test(t)}function yS(t=Ot()){return/webos/i.test(t)}function my(t=Ot()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function ej(t=Ot()){var e;return my(t)&&!!((e=window.navigator)!=null&&e.standalone)}function tj(){return hk()&&document.documentMode===10}function _S(t=Ot()){return my(t)||mS(t)||yS(t)||gS(t)||/windows phone/i.test(t)||pS(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vS(t,e=[]){let n;switch(t){case"Browser":n=Qw(Ot());break;case"Worker":n=`${Qw(Ot())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${ro}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nj{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=s=>new Promise((o,a)=>{try{const l=e(s);o(l)}catch(l){a(l)}});r.onAbort=n,this.queue.push(r);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const i of n)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function rj(t,e={}){return ns(t,"GET","/v2/passwordPolicy",io(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ij=6;class sj{constructor(e){var r;const n=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=n.minPasswordLength??ij,n.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=n.maxPasswordLength),n.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=n.containsLowercaseCharacter),n.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=n.containsUppercaseCharacter),n.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=n.containsNumericCharacter),n.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=n.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=((r=e.allowedNonAlphanumericCharacters)==null?void 0:r.join(""))??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const n={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,n),this.validatePasswordCharacterOptions(e,n),n.isValid&&(n.isValid=n.meetsMinPasswordLength??!0),n.isValid&&(n.isValid=n.meetsMaxPasswordLength??!0),n.isValid&&(n.isValid=n.containsLowercaseLetter??!0),n.isValid&&(n.isValid=n.containsUppercaseLetter??!0),n.isValid&&(n.isValid=n.containsNumericCharacter??!0),n.isValid&&(n.isValid=n.containsNonAlphanumericCharacter??!0),n}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),i&&(n.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oj{constructor(e,n,r,i){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Yw(this),this.idTokenSubscription=new Yw(this),this.beforeStateQueue=new nj(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=iS,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion,this._persistenceManagerAvailable=new Promise(s=>this._resolvePersistenceManagerAvailable=s)}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=Ur(n)),this._initializationPromise=this.queue(async()=>{var r,i,s;if(!this._deleted&&(this.persistenceManager=await Go.create(this,e),(r=this._resolvePersistenceManagerAvailable)==null||r.call(this),!this._deleted)){if((i=this._popupRedirectResolver)!=null&&i._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((s=this.currentUser)==null?void 0:s.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await Dd(this,{idToken:e}),r=await ir._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(r)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var s;if(Bn(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(a,a))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let r=n,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(s=this.redirectUser)==null?void 0:s._redirectEventId,a=r==null?void 0:r._redirectEventId,l=await this.tryRedirectSignIn(e);(!o||o===a)&&(l!=null&&l.user)&&(r=l.user,i=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(r)}catch(o){r=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return ye(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await jd(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=MD()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Bn(this.app))return Promise.reject(Fi(this));const n=e?ze(e):null;return n&&ye(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&ye(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Bn(this.app)?Promise.reject(Fi(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Bn(this.app)?Promise.reject(Fi(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Ur(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await rj(this),n=new sj(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new no("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),await ZD(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)==null?void 0:e.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&Ur(e)||this._popupRedirectResolver;ye(n,this,"argument-error"),this.redirectPersistenceManager=await Go.create(this,[Ur(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)==null?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)==null?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=((n=this.currentUser)==null?void 0:n.uid)??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,i){if(this._deleted)return()=>{};const s=typeof n=="function"?n:n.next.bind(n);let o=!1;const a=this._isInitialized?Promise.resolve():this._initializationPromise;if(ye(a,this,"internal-error"),a.then(()=>{o||s(this.currentUser)}),typeof n=="function"){const l=e.addObserver(n,r,i);return()=>{o=!0,l()}}else{const l=e.addObserver(n);return()=>{o=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return ye(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=vS(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var i;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const n=await((i=this.heartbeatServiceProvider.getImmediate({optional:!0}))==null?void 0:i.getHeartbeatsHeader());n&&(e["X-Firebase-Client"]=n);const r=await this._getAppCheckToken();return r&&(e["X-Firebase-AppCheck"]=r),e}async _getAppCheckToken(){var n;if(Bn(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await((n=this.appCheckServiceProvider.getImmediate({optional:!0}))==null?void 0:n.getToken());return e!=null&&e.error&&OD(`Error while retrieving App Check token: ${e.error}`),e==null?void 0:e.token}}function Aa(t){return ze(t)}class Yw{constructor(e){this.auth=e,this.observer=null,this.addObserver=_k(n=>this.observer=n)}get next(){return ye(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ph={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function aj(t){Ph=t}function wS(t){return Ph.loadJS(t)}function lj(){return Ph.recaptchaEnterpriseScript}function cj(){return Ph.gapiScript}function uj(t){return`__${t}${Math.floor(Math.random()*1e6)}`}class dj{constructor(){this.enterprise=new hj}ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}class hj{ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}const fj="recaptcha-enterprise",ES="NO_RECAPTCHA";class pj{constructor(e){this.type=fj,this.auth=Aa(e)}async verify(e="verify",n=!1){async function r(s){if(!n){if(s.tenantId==null&&s._agentRecaptchaConfig!=null)return s._agentRecaptchaConfig.siteKey;if(s.tenantId!=null&&s._tenantRecaptchaConfigs[s.tenantId]!==void 0)return s._tenantRecaptchaConfigs[s.tenantId].siteKey}return new Promise(async(o,a)=>{HD(s,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(l=>{if(l.recaptchaKey===void 0)a(new Error("recaptcha Enterprise site key undefined"));else{const d=new qD(l);return s.tenantId==null?s._agentRecaptchaConfig=d:s._tenantRecaptchaConfigs[s.tenantId]=d,o(d.siteKey)}}).catch(l=>{a(l)})})}function i(s,o,a){const l=window.grecaptcha;Hw(l)?l.enterprise.ready(()=>{l.enterprise.execute(s,{action:e}).then(d=>{o(d)}).catch(()=>{o(ES)})}):a(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new dj().execute("siteKey",{action:"verify"}):new Promise((s,o)=>{r(this.auth).then(a=>{if(!n&&Hw(window.grecaptcha))i(a,s,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let l=lj();l.length!==0&&(l+=a),wS(l).then(()=>{i(a,s,o)}).catch(d=>{o(d)})}}).catch(a=>{o(a)})})}}async function Xw(t,e,n,r=!1,i=!1){const s=new pj(t);let o;if(i)o=ES;else try{o=await s.verify(n)}catch{o=await s.verify(n,!0)}const a={...e};if(n==="mfaSmsEnrollment"||n==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in a){const l=a.phoneEnrollmentInfo.phoneNumber,d=a.phoneEnrollmentInfo.recaptchaToken;Object.assign(a,{phoneEnrollmentInfo:{phoneNumber:l,recaptchaToken:d,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in a){const l=a.phoneSignInInfo.recaptchaToken;Object.assign(a,{phoneSignInInfo:{recaptchaToken:l,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return a}return r?Object.assign(a,{captchaResp:o}):Object.assign(a,{captchaResponse:o}),Object.assign(a,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(a,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),a}async function Jw(t,e,n,r,i){var s;if((s=t._getRecaptchaConfig())!=null&&s.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const o=await Xw(t,e,n,n==="getOobCode");return r(t,o)}else return r(t,e).catch(async o=>{if(o.code==="auth/missing-recaptcha-token"){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const a=await Xw(t,e,n,n==="getOobCode");return r(t,a)}else return Promise.reject(o)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mj(t,e){const n=ts(t,"auth");if(n.isInitialized()){const i=n.getImmediate(),s=n.getOptions();if(Qr(s,e??{}))return i;ur(i,"already-initialized")}return n.initialize({options:e})}function gj(t,e){const n=(e==null?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(Ur);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function yj(t,e,n){const r=Aa(t);ye(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const i=!1,s=IS(e),{host:o,port:a}=_j(e),l=a===null?"":`:${a}`,d={url:`${s}//${o}${l}/`},h=Object.freeze({host:o,port:a,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!r._canInitEmulator){ye(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),ye(Qr(d,r.config.emulator)&&Qr(h,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=d,r.emulatorConfig=h,r.settings.appVerificationDisabledForTesting=!0,es(o)?(ay(`${s}//${o}${l}`),ly("Auth",!0)):vj()}function IS(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function _j(t){const e=IS(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const s=i[1];return{host:s,port:Zw(r.substr(s.length+1))}}else{const[s,o]=r.split(":");return{host:s,port:Zw(o)}}}function Zw(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function vj(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gy{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return Fr("not implemented")}_getIdTokenResponse(e){return Fr("not implemented")}_linkToIdToken(e,n){return Fr("not implemented")}_getReauthenticationResolver(e){return Fr("not implemented")}}async function wj(t,e){return ns(t,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ej(t,e){return Rh(t,"POST","/v1/accounts:signInWithPassword",io(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ij(t,e){return Rh(t,"POST","/v1/accounts:signInWithEmailLink",io(t,e))}async function Tj(t,e){return Rh(t,"POST","/v1/accounts:signInWithEmailLink",io(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oc extends gy{constructor(e,n,r,i=null){super("password",r),this._email=e,this._password=n,this._tenantId=i}static _fromEmailAndPassword(e,n){return new oc(e,n,"password")}static _fromEmailAndCode(e,n,r=null){return new oc(e,n,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;if(n!=null&&n.email&&(n!=null&&n.password)){if(n.signInMethod==="password")return this._fromEmailAndPassword(n.email,n.password);if(n.signInMethod==="emailLink")return this._fromEmailAndCode(n.email,n.password,n.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const n={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Jw(e,n,"signInWithPassword",Ej);case"emailLink":return Ij(e,{email:this._email,oobCode:this._password});default:ur(e,"internal-error")}}async _linkToIdToken(e,n){switch(this.signInMethod){case"password":const r={idToken:n,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Jw(e,r,"signUpPassword",wj);case"emailLink":return Tj(e,{idToken:n,email:this._email,oobCode:this._password});default:ur(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Qo(t,e){return Rh(t,"POST","/v1/accounts:signInWithIdp",io(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xj="http://localhost";class Us extends gy{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new Us(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):ur("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i,...s}=n;if(!r||!i)return null;const o=new Us(r,i);return o.idToken=s.idToken||void 0,o.accessToken=s.accessToken||void 0,o.secret=s.secret,o.nonce=s.nonce,o.pendingToken=s.pendingToken||null,o}_getIdTokenResponse(e){const n=this.buildRequest();return Qo(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,Qo(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,Qo(e,n)}buildRequest(){const e={requestUri:xj,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=Sc(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sj(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function bj(t){const e=hl(fl(t)).link,n=e?hl(fl(e)).deep_link_id:null,r=hl(fl(t)).deep_link_id;return(r?hl(fl(r)).link:null)||r||n||e||t}class yy{constructor(e){const n=hl(fl(e)),r=n.apiKey??null,i=n.oobCode??null,s=Sj(n.mode??null);ye(r&&i&&s,"argument-error"),this.apiKey=r,this.operation=s,this.code=i,this.continueUrl=n.continueUrl??null,this.languageCode=n.lang??null,this.tenantId=n.tenantId??null}static parseLink(e){const n=bj(e);try{return new yy(n)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ra{constructor(){this.providerId=Ra.PROVIDER_ID}static credential(e,n){return oc._fromEmailAndPassword(e,n)}static credentialWithLink(e,n){const r=yy.parseLink(n);return ye(r,"argument-error"),oc._fromEmailAndCode(e,r.code,r.tenantId)}}Ra.PROVIDER_ID="password";Ra.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Ra.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TS{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cc extends TS{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vi extends Cc{constructor(){super("facebook.com")}static credential(e){return Us._fromParams({providerId:vi.PROVIDER_ID,signInMethod:vi.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return vi.credentialFromTaggedObject(e)}static credentialFromError(e){return vi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return vi.credential(e.oauthAccessToken)}catch{return null}}}vi.FACEBOOK_SIGN_IN_METHOD="facebook.com";vi.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wi extends Cc{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return Us._fromParams({providerId:wi.PROVIDER_ID,signInMethod:wi.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return wi.credentialFromTaggedObject(e)}static credentialFromError(e){return wi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return wi.credential(n,r)}catch{return null}}}wi.GOOGLE_SIGN_IN_METHOD="google.com";wi.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ei extends Cc{constructor(){super("github.com")}static credential(e){return Us._fromParams({providerId:Ei.PROVIDER_ID,signInMethod:Ei.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ei.credentialFromTaggedObject(e)}static credentialFromError(e){return Ei.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ei.credential(e.oauthAccessToken)}catch{return null}}}Ei.GITHUB_SIGN_IN_METHOD="github.com";Ei.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ii extends Cc{constructor(){super("twitter.com")}static credential(e,n){return Us._fromParams({providerId:Ii.PROVIDER_ID,signInMethod:Ii.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return Ii.credentialFromTaggedObject(e)}static credentialFromError(e){return Ii.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return Ii.credential(n,r)}catch{return null}}}Ii.TWITTER_SIGN_IN_METHOD="twitter.com";Ii.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class la{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,i=!1){const s=await ir._fromIdTokenResponse(e,r,i),o=eE(r);return new la({user:s,providerId:o,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const i=eE(r);return new la({user:e,providerId:i,_tokenResponse:r,operationType:n})}}function eE(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Od extends Xn{constructor(e,n,r,i){super(n.code,n.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,Od.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,i){return new Od(e,n,r,i)}}function xS(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?Od._fromErrorAndOperation(t,s,e,r):s})}async function Cj(t,e,n=!1){const r=await sc(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return la._forOperation(t,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Aj(t,e,n=!1){const{auth:r}=t;if(Bn(r.app))return Promise.reject(Fi(r));const i="reauthenticate";try{const s=await sc(t,xS(r,i,e,t),n);ye(s.idToken,r,"internal-error");const o=py(s.idToken);ye(o,r,"internal-error");const{sub:a}=o;return ye(t.uid===a,r,"user-mismatch"),la._forOperation(t,i,s)}catch(s){throw(s==null?void 0:s.code)==="auth/user-not-found"&&ur(r,"user-mismatch"),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function SS(t,e,n=!1){if(Bn(t.app))return Promise.reject(Fi(t));const r="signIn",i=await xS(t,r,e),s=await la._fromIdTokenResponse(t,r,i);return n||await t._updateCurrentUser(s.user),s}async function Rj(t,e){return SS(Aa(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Pj(t){const e=Aa(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}function Nj(t,e,n){return Bn(t.app)?Promise.reject(Fi(t)):Rj(ze(t),Ra.credential(e,n)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&Pj(t),r})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kj(t,e){return ze(t).setPersistence(e)}function Dj(t,e,n,r){return ze(t).onIdTokenChanged(e,n,r)}function jj(t,e,n){return ze(t).beforeAuthStateChanged(e,n)}function _y(t,e,n,r){return ze(t).onAuthStateChanged(e,n,r)}function Oj(t){return ze(t).signOut()}const Vd="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bS{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(Vd,"1"),this.storage.removeItem(Vd),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vj=1e3,Lj=10;class CS extends bS{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=_S(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),i=this.localCache[n];r!==i&&e(n,i,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((o,a,l)=>{this.notifyListeners(o,l)});return}const r=e.key;n?this.detachListener():this.stopPolling();const i=()=>{const o=this.storage.getItem(r);!n&&this.localCache[r]===o||this.notifyListeners(r,o)},s=this.storage.getItem(r);tj()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,Lj):i()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},Vj)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}CS.type="LOCAL";const AS=CS;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RS extends bS{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}RS.type="SESSION";const PS=RS;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mj(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nh{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(i=>i.isListeningto(e));if(n)return n;const r=new Nh(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:i,data:s}=n.data,o=this.handlersMap[i];if(!(o!=null&&o.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:i});const a=Array.from(o).map(async d=>d(n.origin,s)),l=await Mj(a);n.ports[0].postMessage({status:"done",eventId:r,eventType:i,response:l})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Nh.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vy(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fj{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,o;return new Promise((a,l)=>{const d=vy("",20);i.port1.start();const h=setTimeout(()=>{l(new Error("unsupported_event"))},r);o={messageChannel:i,onMessage(f){const m=f;if(m.data.eventId===d)switch(m.data.status){case"ack":clearTimeout(h),s=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),a(m.data.response);break;default:clearTimeout(h),clearTimeout(s),l(new Error("invalid_response"));break}}},this.handlers.add(o),i.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:d,data:n},[i.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rr(){return window}function Uj(t){Rr().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NS(){return typeof Rr().WorkerGlobalScope<"u"&&typeof Rr().importScripts=="function"}async function Bj(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function $j(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)==null?void 0:t.controller)||null}function zj(){return NS()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kS="firebaseLocalStorageDb",qj=1,Ld="firebaseLocalStorage",DS="fbase_key";class Ac{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function kh(t,e){return t.transaction([Ld],e?"readwrite":"readonly").objectStore(Ld)}function Hj(){const t=indexedDB.deleteDatabase(kS);return new Ac(t).toPromise()}function Nm(){const t=indexedDB.open(kS,qj);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(Ld,{keyPath:DS})}catch(i){n(i)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(Ld)?e(r):(r.close(),await Hj(),e(await Nm()))})})}async function tE(t,e,n){const r=kh(t,!0).put({[DS]:e,value:n});return new Ac(r).toPromise()}async function Wj(t,e){const n=kh(t,!1).get(e),r=await new Ac(n).toPromise();return r===void 0?null:r.value}function nE(t,e){const n=kh(t,!0).delete(e);return new Ac(n).toPromise()}const Kj=800,Gj=3;class jS{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Nm(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>Gj)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return NS()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Nh._getInstance(zj()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var n,r;if(this.activeServiceWorker=await Bj(),!this.activeServiceWorker)return;this.sender=new Fj(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&(n=e[0])!=null&&n.fulfilled&&(r=e[0])!=null&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||$j()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Nm();return await tE(e,Vd,"1"),await nE(e,Vd),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>tE(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>Wj(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>nE(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const s=kh(i,!1).getAll();return new Ac(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;if(e.length!==0)for(const{fbase_key:i,value:s}of e)r.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(s)&&(this.notifyListeners(i,s),n.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!r.has(i)&&(this.notifyListeners(i,null),n.push(i));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),Kj)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}jS.type="LOCAL";const Qj=jS;new bc(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yj(t,e){return e?Ur(e):(ye(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wy extends gy{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Qo(e,this._buildIdpRequest())}_linkToIdToken(e,n){return Qo(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return Qo(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function Xj(t){return SS(t.auth,new wy(t),t.bypassAuthState)}function Jj(t){const{auth:e,user:n}=t;return ye(n,e,"internal-error"),Aj(n,new wy(t),t.bypassAuthState)}async function Zj(t){const{auth:e,user:n}=t;return ye(n,e,"internal-error"),Cj(n,new wy(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OS{constructor(e,n,r,i,s=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:i,tenantId:s,error:o,type:a}=e;if(o){this.reject(o);return}const l={auth:this.auth,requestUri:n,sessionId:r,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(l))}catch(d){this.reject(d)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return Xj;case"linkViaPopup":case"linkViaRedirect":return Zj;case"reauthViaPopup":case"reauthViaRedirect":return Jj;default:ur(this.auth,"internal-error")}}resolve(e){Xr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Xr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const e2=new bc(2e3,1e4);class Uo extends OS{constructor(e,n,r,i,s){super(e,n,i,s),this.provider=r,this.authWindow=null,this.pollId=null,Uo.currentPopupAction&&Uo.currentPopupAction.cancel(),Uo.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return ye(e,this.auth,"internal-error"),e}async onExecution(){Xr(this.filter.length===1,"Popup operations only handle one event");const e=vy();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(Ar(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)==null?void 0:e.associatedEvent)||null}cancel(){this.reject(Ar(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Uo.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,r;if((r=(n=this.authWindow)==null?void 0:n.window)!=null&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Ar(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,e2.get())};e()}}Uo.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const t2="pendingRedirect",Hu=new Map;class n2 extends OS{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=Hu.get(this.auth._key());if(!e){try{const r=await r2(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}Hu.set(this.auth._key(),e)}return this.bypassAuthState||Hu.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function r2(t,e){const n=o2(e),r=s2(t);if(!await r._isAvailable())return!1;const i=await r._get(n)==="true";return await r._remove(n),i}function i2(t,e){Hu.set(t._key(),e)}function s2(t){return Ur(t._redirectPersistence)}function o2(t){return qu(t2,t.config.apiKey,t.name)}async function a2(t,e,n=!1){if(Bn(t.app))return Promise.reject(Fi(t));const r=Aa(t),i=Yj(r,e),o=await new n2(r,i,n).execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const l2=10*60*1e3;class c2{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!u2(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!VS(e)){const i=((r=e.error.code)==null?void 0:r.split("auth/")[1])||"internal-error";n.onError(Ar(this.auth,i))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=l2&&this.cachedEventUids.clear(),this.cachedEventUids.has(rE(e))}saveEventToCache(e){this.cachedEventUids.add(rE(e)),this.lastProcessedEventTime=Date.now()}}function rE(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function VS({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function u2(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return VS(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function d2(t,e={}){return ns(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const h2=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,f2=/^https?/;async function p2(t){if(t.config.emulator)return;const{authorizedDomains:e}=await d2(t);for(const n of e)try{if(m2(n))return}catch{}ur(t,"unauthorized-domain")}function m2(t){const e=Rm(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&o.hostname===r}if(!f2.test(n))return!1;if(h2.test(t))return r===t;const i=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const g2=new bc(3e4,6e4);function iE(){const t=Rr().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function y2(t){return new Promise((e,n)=>{var i,s,o;function r(){iE(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{iE(),n(Ar(t,"network-request-failed"))},timeout:g2.get()})}if((s=(i=Rr().gapi)==null?void 0:i.iframes)!=null&&s.Iframe)e(gapi.iframes.getContext());else if((o=Rr().gapi)!=null&&o.load)r();else{const a=uj("iframefcb");return Rr()[a]=()=>{gapi.load?r():n(Ar(t,"network-request-failed"))},wS(`${cj()}?onload=${a}`).catch(l=>n(l))}}).catch(e=>{throw Wu=null,e})}let Wu=null;function _2(t){return Wu=Wu||y2(t),Wu}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const v2=new bc(5e3,15e3),w2="__/auth/iframe",E2="emulator/auth/iframe",I2={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},T2=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function x2(t){const e=t.config;ye(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?fy(e,E2):`https://${t.config.authDomain}/${w2}`,r={apiKey:e.apiKey,appName:t.name,v:ro},i=T2.get(t.config.apiHost);i&&(r.eid=i);const s=t._getFrameworks();return s.length&&(r.fw=s.join(",")),`${n}?${Sc(r).slice(1)}`}async function S2(t){const e=await _2(t),n=Rr().gapi;return ye(n,t,"internal-error"),e.open({where:document.body,url:x2(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:I2,dontclear:!0},r=>new Promise(async(i,s)=>{await r.restyle({setHideOnLeave:!1});const o=Ar(t,"network-request-failed"),a=Rr().setTimeout(()=>{s(o)},v2.get());function l(){Rr().clearTimeout(a),i(r)}r.ping(l).then(l,()=>{s(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const b2={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},C2=500,A2=600,R2="_blank",P2="http://localhost";class sE{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function N2(t,e,n,r=C2,i=A2){const s=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let a="";const l={...b2,width:r.toString(),height:i.toString(),top:s,left:o},d=Ot().toLowerCase();n&&(a=fS(d)?R2:n),dS(d)&&(e=e||P2,l.scrollbars="yes");const h=Object.entries(l).reduce((m,[_,R])=>`${m}${_}=${R},`,"");if(ej(d)&&a!=="_self")return k2(e||"",a),new sE(null);const f=window.open(e||"",a,h);ye(f,t,"popup-blocked");try{f.focus()}catch{}return new sE(f)}function k2(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const D2="__/auth/handler",j2="emulator/auth/handler",O2=encodeURIComponent("fac");async function oE(t,e,n,r,i,s){ye(t.config.authDomain,t,"auth-domain-config-required"),ye(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:ro,eventId:i};if(e instanceof TS){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",yk(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[h,f]of Object.entries({}))o[h]=f}if(e instanceof Cc){const h=e.getScopes().filter(f=>f!=="");h.length>0&&(o.scopes=h.join(","))}t.tenantId&&(o.tid=t.tenantId);const a=o;for(const h of Object.keys(a))a[h]===void 0&&delete a[h];const l=await t._getAppCheckToken(),d=l?`#${O2}=${encodeURIComponent(l)}`:"";return`${V2(t)}?${Sc(a).slice(1)}${d}`}function V2({config:t}){return t.emulator?fy(t,j2):`https://${t.authDomain}/${D2}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lp="webStorageSupport";class L2{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=PS,this._completeRedirectFn=a2,this._overrideRedirectResult=i2}async _openPopup(e,n,r,i){var o;Xr((o=this.eventManagers[e._key()])==null?void 0:o.manager,"_initialize() not called before _openPopup()");const s=await oE(e,n,r,Rm(),i);return N2(e,s,vy())}async _openRedirect(e,n,r,i){await this._originValidation(e);const s=await oE(e,n,r,Rm(),i);return Uj(s),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:i,promise:s}=this.eventManagers[n];return i?Promise.resolve(i):(Xr(s,"If manager is not set, promise should be"),s)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await S2(e),r=new c2(e);return n.register("authEvent",i=>(ye(i==null?void 0:i.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(lp,{type:lp},i=>{var o;const s=(o=i==null?void 0:i[0])==null?void 0:o[lp];s!==void 0&&n(!!s),ur(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=p2(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return _S()||hS()||my()}}const M2=L2;var aE="@firebase/auth",lE="1.11.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F2{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)==null?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){ye(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function U2(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function B2(t){cr(new Yn("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=r.options;ye(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const l={apiKey:o,authDomain:a,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:vS(t)},d=new oj(r,i,s,l);return gj(d,n),d},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),cr(new Yn("auth-internal",e=>{const n=Aa(e.getProvider("auth").getImmediate());return(r=>new F2(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),Sn(aE,lE,U2(t)),Sn(aE,lE,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $2=5*60,z2=Hx("authIdTokenMaxAge")||$2;let cE=null;const q2=t=>async e=>{const n=e&&await e.getIdTokenResult(),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>z2)return;const i=n==null?void 0:n.token;cE!==i&&(cE=i,await fetch(t,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function LS(t=Ah()){const e=ts(t,"auth");if(e.isInitialized())return e.getImmediate();const n=mj(t,{popupRedirectResolver:M2,persistence:[Qj,AS,PS]}),r=Hx("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const s=new URL(r,location.origin);if(location.origin===s.origin){const o=q2(s.toString());jj(n,o,()=>o(n.currentUser)),Dj(n,a=>o(a))}}const i=$x("auth");return i&&yj(n,`http://${i}`),n}function H2(){var t;return((t=document.getElementsByTagName("head"))==null?void 0:t[0])??document}aj({loadJS(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=i=>{const s=Ar("internal-error");s.customData=i,n(s)},r.type="text/javascript",r.charset="UTF-8",H2().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});B2("Browser");var uE=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Ui,MS;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(x,v){function b(){}b.prototype=v.prototype,x.F=v.prototype,x.prototype=new b,x.prototype.constructor=x,x.D=function(A,j,V){for(var P=Array(arguments.length-2),q=2;q<arguments.length;q++)P[q-2]=arguments[q];return v.prototype[j].apply(A,P)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(r,n),r.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(x,v,b){b||(b=0);const A=Array(16);if(typeof v=="string")for(var j=0;j<16;++j)A[j]=v.charCodeAt(b++)|v.charCodeAt(b++)<<8|v.charCodeAt(b++)<<16|v.charCodeAt(b++)<<24;else for(j=0;j<16;++j)A[j]=v[b++]|v[b++]<<8|v[b++]<<16|v[b++]<<24;v=x.g[0],b=x.g[1],j=x.g[2];let V=x.g[3],P;P=v+(V^b&(j^V))+A[0]+3614090360&4294967295,v=b+(P<<7&4294967295|P>>>25),P=V+(j^v&(b^j))+A[1]+3905402710&4294967295,V=v+(P<<12&4294967295|P>>>20),P=j+(b^V&(v^b))+A[2]+606105819&4294967295,j=V+(P<<17&4294967295|P>>>15),P=b+(v^j&(V^v))+A[3]+3250441966&4294967295,b=j+(P<<22&4294967295|P>>>10),P=v+(V^b&(j^V))+A[4]+4118548399&4294967295,v=b+(P<<7&4294967295|P>>>25),P=V+(j^v&(b^j))+A[5]+1200080426&4294967295,V=v+(P<<12&4294967295|P>>>20),P=j+(b^V&(v^b))+A[6]+2821735955&4294967295,j=V+(P<<17&4294967295|P>>>15),P=b+(v^j&(V^v))+A[7]+4249261313&4294967295,b=j+(P<<22&4294967295|P>>>10),P=v+(V^b&(j^V))+A[8]+1770035416&4294967295,v=b+(P<<7&4294967295|P>>>25),P=V+(j^v&(b^j))+A[9]+2336552879&4294967295,V=v+(P<<12&4294967295|P>>>20),P=j+(b^V&(v^b))+A[10]+4294925233&4294967295,j=V+(P<<17&4294967295|P>>>15),P=b+(v^j&(V^v))+A[11]+2304563134&4294967295,b=j+(P<<22&4294967295|P>>>10),P=v+(V^b&(j^V))+A[12]+1804603682&4294967295,v=b+(P<<7&4294967295|P>>>25),P=V+(j^v&(b^j))+A[13]+4254626195&4294967295,V=v+(P<<12&4294967295|P>>>20),P=j+(b^V&(v^b))+A[14]+2792965006&4294967295,j=V+(P<<17&4294967295|P>>>15),P=b+(v^j&(V^v))+A[15]+1236535329&4294967295,b=j+(P<<22&4294967295|P>>>10),P=v+(j^V&(b^j))+A[1]+4129170786&4294967295,v=b+(P<<5&4294967295|P>>>27),P=V+(b^j&(v^b))+A[6]+3225465664&4294967295,V=v+(P<<9&4294967295|P>>>23),P=j+(v^b&(V^v))+A[11]+643717713&4294967295,j=V+(P<<14&4294967295|P>>>18),P=b+(V^v&(j^V))+A[0]+3921069994&4294967295,b=j+(P<<20&4294967295|P>>>12),P=v+(j^V&(b^j))+A[5]+3593408605&4294967295,v=b+(P<<5&4294967295|P>>>27),P=V+(b^j&(v^b))+A[10]+38016083&4294967295,V=v+(P<<9&4294967295|P>>>23),P=j+(v^b&(V^v))+A[15]+3634488961&4294967295,j=V+(P<<14&4294967295|P>>>18),P=b+(V^v&(j^V))+A[4]+3889429448&4294967295,b=j+(P<<20&4294967295|P>>>12),P=v+(j^V&(b^j))+A[9]+568446438&4294967295,v=b+(P<<5&4294967295|P>>>27),P=V+(b^j&(v^b))+A[14]+3275163606&4294967295,V=v+(P<<9&4294967295|P>>>23),P=j+(v^b&(V^v))+A[3]+4107603335&4294967295,j=V+(P<<14&4294967295|P>>>18),P=b+(V^v&(j^V))+A[8]+1163531501&4294967295,b=j+(P<<20&4294967295|P>>>12),P=v+(j^V&(b^j))+A[13]+2850285829&4294967295,v=b+(P<<5&4294967295|P>>>27),P=V+(b^j&(v^b))+A[2]+4243563512&4294967295,V=v+(P<<9&4294967295|P>>>23),P=j+(v^b&(V^v))+A[7]+1735328473&4294967295,j=V+(P<<14&4294967295|P>>>18),P=b+(V^v&(j^V))+A[12]+2368359562&4294967295,b=j+(P<<20&4294967295|P>>>12),P=v+(b^j^V)+A[5]+4294588738&4294967295,v=b+(P<<4&4294967295|P>>>28),P=V+(v^b^j)+A[8]+2272392833&4294967295,V=v+(P<<11&4294967295|P>>>21),P=j+(V^v^b)+A[11]+1839030562&4294967295,j=V+(P<<16&4294967295|P>>>16),P=b+(j^V^v)+A[14]+4259657740&4294967295,b=j+(P<<23&4294967295|P>>>9),P=v+(b^j^V)+A[1]+2763975236&4294967295,v=b+(P<<4&4294967295|P>>>28),P=V+(v^b^j)+A[4]+1272893353&4294967295,V=v+(P<<11&4294967295|P>>>21),P=j+(V^v^b)+A[7]+4139469664&4294967295,j=V+(P<<16&4294967295|P>>>16),P=b+(j^V^v)+A[10]+3200236656&4294967295,b=j+(P<<23&4294967295|P>>>9),P=v+(b^j^V)+A[13]+681279174&4294967295,v=b+(P<<4&4294967295|P>>>28),P=V+(v^b^j)+A[0]+3936430074&4294967295,V=v+(P<<11&4294967295|P>>>21),P=j+(V^v^b)+A[3]+3572445317&4294967295,j=V+(P<<16&4294967295|P>>>16),P=b+(j^V^v)+A[6]+76029189&4294967295,b=j+(P<<23&4294967295|P>>>9),P=v+(b^j^V)+A[9]+3654602809&4294967295,v=b+(P<<4&4294967295|P>>>28),P=V+(v^b^j)+A[12]+3873151461&4294967295,V=v+(P<<11&4294967295|P>>>21),P=j+(V^v^b)+A[15]+530742520&4294967295,j=V+(P<<16&4294967295|P>>>16),P=b+(j^V^v)+A[2]+3299628645&4294967295,b=j+(P<<23&4294967295|P>>>9),P=v+(j^(b|~V))+A[0]+4096336452&4294967295,v=b+(P<<6&4294967295|P>>>26),P=V+(b^(v|~j))+A[7]+1126891415&4294967295,V=v+(P<<10&4294967295|P>>>22),P=j+(v^(V|~b))+A[14]+2878612391&4294967295,j=V+(P<<15&4294967295|P>>>17),P=b+(V^(j|~v))+A[5]+4237533241&4294967295,b=j+(P<<21&4294967295|P>>>11),P=v+(j^(b|~V))+A[12]+1700485571&4294967295,v=b+(P<<6&4294967295|P>>>26),P=V+(b^(v|~j))+A[3]+2399980690&4294967295,V=v+(P<<10&4294967295|P>>>22),P=j+(v^(V|~b))+A[10]+4293915773&4294967295,j=V+(P<<15&4294967295|P>>>17),P=b+(V^(j|~v))+A[1]+2240044497&4294967295,b=j+(P<<21&4294967295|P>>>11),P=v+(j^(b|~V))+A[8]+1873313359&4294967295,v=b+(P<<6&4294967295|P>>>26),P=V+(b^(v|~j))+A[15]+4264355552&4294967295,V=v+(P<<10&4294967295|P>>>22),P=j+(v^(V|~b))+A[6]+2734768916&4294967295,j=V+(P<<15&4294967295|P>>>17),P=b+(V^(j|~v))+A[13]+1309151649&4294967295,b=j+(P<<21&4294967295|P>>>11),P=v+(j^(b|~V))+A[4]+4149444226&4294967295,v=b+(P<<6&4294967295|P>>>26),P=V+(b^(v|~j))+A[11]+3174756917&4294967295,V=v+(P<<10&4294967295|P>>>22),P=j+(v^(V|~b))+A[2]+718787259&4294967295,j=V+(P<<15&4294967295|P>>>17),P=b+(V^(j|~v))+A[9]+3951481745&4294967295,x.g[0]=x.g[0]+v&4294967295,x.g[1]=x.g[1]+(j+(P<<21&4294967295|P>>>11))&4294967295,x.g[2]=x.g[2]+j&4294967295,x.g[3]=x.g[3]+V&4294967295}r.prototype.v=function(x,v){v===void 0&&(v=x.length);const b=v-this.blockSize,A=this.C;let j=this.h,V=0;for(;V<v;){if(j==0)for(;V<=b;)i(this,x,V),V+=this.blockSize;if(typeof x=="string"){for(;V<v;)if(A[j++]=x.charCodeAt(V++),j==this.blockSize){i(this,A),j=0;break}}else for(;V<v;)if(A[j++]=x[V++],j==this.blockSize){i(this,A),j=0;break}}this.h=j,this.o+=v},r.prototype.A=function(){var x=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);x[0]=128;for(var v=1;v<x.length-8;++v)x[v]=0;v=this.o*8;for(var b=x.length-8;b<x.length;++b)x[b]=v&255,v/=256;for(this.v(x),x=Array(16),v=0,b=0;b<4;++b)for(let A=0;A<32;A+=8)x[v++]=this.g[b]>>>A&255;return x};function s(x,v){var b=a;return Object.prototype.hasOwnProperty.call(b,x)?b[x]:b[x]=v(x)}function o(x,v){this.h=v;const b=[];let A=!0;for(let j=x.length-1;j>=0;j--){const V=x[j]|0;A&&V==v||(b[j]=V,A=!1)}this.g=b}var a={};function l(x){return-128<=x&&x<128?s(x,function(v){return new o([v|0],v<0?-1:0)}):new o([x|0],x<0?-1:0)}function d(x){if(isNaN(x)||!isFinite(x))return f;if(x<0)return y(d(-x));const v=[];let b=1;for(let A=0;x>=b;A++)v[A]=x/b|0,b*=4294967296;return new o(v,0)}function h(x,v){if(x.length==0)throw Error("number format error: empty string");if(v=v||10,v<2||36<v)throw Error("radix out of range: "+v);if(x.charAt(0)=="-")return y(h(x.substring(1),v));if(x.indexOf("-")>=0)throw Error('number format error: interior "-" character');const b=d(Math.pow(v,8));let A=f;for(let V=0;V<x.length;V+=8){var j=Math.min(8,x.length-V);const P=parseInt(x.substring(V,V+j),v);j<8?(j=d(Math.pow(v,j)),A=A.j(j).add(d(P))):(A=A.j(b),A=A.add(d(P)))}return A}var f=l(0),m=l(1),_=l(16777216);t=o.prototype,t.m=function(){if(C(this))return-y(this).m();let x=0,v=1;for(let b=0;b<this.g.length;b++){const A=this.i(b);x+=(A>=0?A:4294967296+A)*v,v*=4294967296}return x},t.toString=function(x){if(x=x||10,x<2||36<x)throw Error("radix out of range: "+x);if(R(this))return"0";if(C(this))return"-"+y(this).toString(x);const v=d(Math.pow(x,6));var b=this;let A="";for(;;){const j=O(b,v).g;b=I(b,j.j(v));let V=((b.g.length>0?b.g[0]:b.h)>>>0).toString(x);if(b=j,R(b))return V+A;for(;V.length<6;)V="0"+V;A=V+A}},t.i=function(x){return x<0?0:x<this.g.length?this.g[x]:this.h};function R(x){if(x.h!=0)return!1;for(let v=0;v<x.g.length;v++)if(x.g[v]!=0)return!1;return!0}function C(x){return x.h==-1}t.l=function(x){return x=I(this,x),C(x)?-1:R(x)?0:1};function y(x){const v=x.g.length,b=[];for(let A=0;A<v;A++)b[A]=~x.g[A];return new o(b,~x.h).add(m)}t.abs=function(){return C(this)?y(this):this},t.add=function(x){const v=Math.max(this.g.length,x.g.length),b=[];let A=0;for(let j=0;j<=v;j++){let V=A+(this.i(j)&65535)+(x.i(j)&65535),P=(V>>>16)+(this.i(j)>>>16)+(x.i(j)>>>16);A=P>>>16,V&=65535,P&=65535,b[j]=P<<16|V}return new o(b,b[b.length-1]&-2147483648?-1:0)};function I(x,v){return x.add(y(v))}t.j=function(x){if(R(this)||R(x))return f;if(C(this))return C(x)?y(this).j(y(x)):y(y(this).j(x));if(C(x))return y(this.j(y(x)));if(this.l(_)<0&&x.l(_)<0)return d(this.m()*x.m());const v=this.g.length+x.g.length,b=[];for(var A=0;A<2*v;A++)b[A]=0;for(A=0;A<this.g.length;A++)for(let j=0;j<x.g.length;j++){const V=this.i(A)>>>16,P=this.i(A)&65535,q=x.i(j)>>>16,qe=x.i(j)&65535;b[2*A+2*j]+=P*qe,w(b,2*A+2*j),b[2*A+2*j+1]+=V*qe,w(b,2*A+2*j+1),b[2*A+2*j+1]+=P*q,w(b,2*A+2*j+1),b[2*A+2*j+2]+=V*q,w(b,2*A+2*j+2)}for(x=0;x<v;x++)b[x]=b[2*x+1]<<16|b[2*x];for(x=v;x<2*v;x++)b[x]=0;return new o(b,0)};function w(x,v){for(;(x[v]&65535)!=x[v];)x[v+1]+=x[v]>>>16,x[v]&=65535,v++}function E(x,v){this.g=x,this.h=v}function O(x,v){if(R(v))throw Error("division by zero");if(R(x))return new E(f,f);if(C(x))return v=O(y(x),v),new E(y(v.g),y(v.h));if(C(v))return v=O(x,y(v)),new E(y(v.g),v.h);if(x.g.length>30){if(C(x)||C(v))throw Error("slowDivide_ only works with positive integers.");for(var b=m,A=v;A.l(x)<=0;)b=D(b),A=D(A);var j=B(b,1),V=B(A,1);for(A=B(A,2),b=B(b,2);!R(A);){var P=V.add(A);P.l(x)<=0&&(j=j.add(b),V=P),A=B(A,1),b=B(b,1)}return v=I(x,j.j(v)),new E(j,v)}for(j=f;x.l(v)>=0;){for(b=Math.max(1,Math.floor(x.m()/v.m())),A=Math.ceil(Math.log(b)/Math.LN2),A=A<=48?1:Math.pow(2,A-48),V=d(b),P=V.j(v);C(P)||P.l(x)>0;)b-=A,V=d(b),P=V.j(v);R(V)&&(V=m),j=j.add(V),x=I(x,P)}return new E(j,x)}t.B=function(x){return O(this,x).h},t.and=function(x){const v=Math.max(this.g.length,x.g.length),b=[];for(let A=0;A<v;A++)b[A]=this.i(A)&x.i(A);return new o(b,this.h&x.h)},t.or=function(x){const v=Math.max(this.g.length,x.g.length),b=[];for(let A=0;A<v;A++)b[A]=this.i(A)|x.i(A);return new o(b,this.h|x.h)},t.xor=function(x){const v=Math.max(this.g.length,x.g.length),b=[];for(let A=0;A<v;A++)b[A]=this.i(A)^x.i(A);return new o(b,this.h^x.h)};function D(x){const v=x.g.length+1,b=[];for(let A=0;A<v;A++)b[A]=x.i(A)<<1|x.i(A-1)>>>31;return new o(b,x.h)}function B(x,v){const b=v>>5;v%=32;const A=x.g.length-b,j=[];for(let V=0;V<A;V++)j[V]=v>0?x.i(V+b)>>>v|x.i(V+b+1)<<32-v:x.i(V+b);return new o(j,x.h)}r.prototype.digest=r.prototype.A,r.prototype.reset=r.prototype.u,r.prototype.update=r.prototype.v,MS=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.B,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=d,o.fromString=h,Ui=o}).apply(typeof uE<"u"?uE:typeof self<"u"?self:typeof window<"u"?window:{});var _u=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var FS,pl,US,Ku,km,BS,$S,zS;(function(){var t,e=Object.defineProperty;function n(c){c=[typeof globalThis=="object"&&globalThis,c,typeof window=="object"&&window,typeof self=="object"&&self,typeof _u=="object"&&_u];for(var p=0;p<c.length;++p){var g=c[p];if(g&&g.Math==Math)return g}throw Error("Cannot find global object")}var r=n(this);function i(c,p){if(p)e:{var g=r;c=c.split(".");for(var T=0;T<c.length-1;T++){var M=c[T];if(!(M in g))break e;g=g[M]}c=c[c.length-1],T=g[c],p=p(T),p!=T&&p!=null&&e(g,c,{configurable:!0,writable:!0,value:p})}}i("Symbol.dispose",function(c){return c||Symbol("Symbol.dispose")}),i("Array.prototype.values",function(c){return c||function(){return this[Symbol.iterator]()}}),i("Object.entries",function(c){return c||function(p){var g=[],T;for(T in p)Object.prototype.hasOwnProperty.call(p,T)&&g.push([T,p[T]]);return g}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var s=s||{},o=this||self;function a(c){var p=typeof c;return p=="object"&&c!=null||p=="function"}function l(c,p,g){return c.call.apply(c.bind,arguments)}function d(c,p,g){return d=l,d.apply(null,arguments)}function h(c,p){var g=Array.prototype.slice.call(arguments,1);return function(){var T=g.slice();return T.push.apply(T,arguments),c.apply(this,T)}}function f(c,p){function g(){}g.prototype=p.prototype,c.Z=p.prototype,c.prototype=new g,c.prototype.constructor=c,c.Ob=function(T,M,F){for(var Y=Array(arguments.length-2),xe=2;xe<arguments.length;xe++)Y[xe-2]=arguments[xe];return p.prototype[M].apply(T,Y)}}var m=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?c=>c&&AsyncContext.Snapshot.wrap(c):c=>c;function _(c){const p=c.length;if(p>0){const g=Array(p);for(let T=0;T<p;T++)g[T]=c[T];return g}return[]}function R(c,p){for(let T=1;T<arguments.length;T++){const M=arguments[T];var g=typeof M;if(g=g!="object"?g:M?Array.isArray(M)?"array":g:"null",g=="array"||g=="object"&&typeof M.length=="number"){g=c.length||0;const F=M.length||0;c.length=g+F;for(let Y=0;Y<F;Y++)c[g+Y]=M[Y]}else c.push(M)}}class C{constructor(p,g){this.i=p,this.j=g,this.h=0,this.g=null}get(){let p;return this.h>0?(this.h--,p=this.g,this.g=p.next,p.next=null):p=this.i(),p}}function y(c){o.setTimeout(()=>{throw c},0)}function I(){var c=x;let p=null;return c.g&&(p=c.g,c.g=c.g.next,c.g||(c.h=null),p.next=null),p}class w{constructor(){this.h=this.g=null}add(p,g){const T=E.get();T.set(p,g),this.h?this.h.next=T:this.g=T,this.h=T}}var E=new C(()=>new O,c=>c.reset());class O{constructor(){this.next=this.g=this.h=null}set(p,g){this.h=p,this.g=g,this.next=null}reset(){this.next=this.g=this.h=null}}let D,B=!1,x=new w,v=()=>{const c=Promise.resolve(void 0);D=()=>{c.then(b)}};function b(){for(var c;c=I();){try{c.h.call(c.g)}catch(g){y(g)}var p=E;p.j(c),p.h<100&&(p.h++,c.next=p.g,p.g=c)}B=!1}function A(){this.u=this.u,this.C=this.C}A.prototype.u=!1,A.prototype.dispose=function(){this.u||(this.u=!0,this.N())},A.prototype[Symbol.dispose]=function(){this.dispose()},A.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function j(c,p){this.type=c,this.g=this.target=p,this.defaultPrevented=!1}j.prototype.h=function(){this.defaultPrevented=!0};var V=function(){if(!o.addEventListener||!Object.defineProperty)return!1;var c=!1,p=Object.defineProperty({},"passive",{get:function(){c=!0}});try{const g=()=>{};o.addEventListener("test",g,p),o.removeEventListener("test",g,p)}catch{}return c}();function P(c){return/^[\s\xa0]*$/.test(c)}function q(c,p){j.call(this,c?c.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,c&&this.init(c,p)}f(q,j),q.prototype.init=function(c,p){const g=this.type=c.type,T=c.changedTouches&&c.changedTouches.length?c.changedTouches[0]:null;this.target=c.target||c.srcElement,this.g=p,p=c.relatedTarget,p||(g=="mouseover"?p=c.fromElement:g=="mouseout"&&(p=c.toElement)),this.relatedTarget=p,T?(this.clientX=T.clientX!==void 0?T.clientX:T.pageX,this.clientY=T.clientY!==void 0?T.clientY:T.pageY,this.screenX=T.screenX||0,this.screenY=T.screenY||0):(this.clientX=c.clientX!==void 0?c.clientX:c.pageX,this.clientY=c.clientY!==void 0?c.clientY:c.pageY,this.screenX=c.screenX||0,this.screenY=c.screenY||0),this.button=c.button,this.key=c.key||"",this.ctrlKey=c.ctrlKey,this.altKey=c.altKey,this.shiftKey=c.shiftKey,this.metaKey=c.metaKey,this.pointerId=c.pointerId||0,this.pointerType=c.pointerType,this.state=c.state,this.i=c,c.defaultPrevented&&q.Z.h.call(this)},q.prototype.h=function(){q.Z.h.call(this);const c=this.i;c.preventDefault?c.preventDefault():c.returnValue=!1};var qe="closure_listenable_"+(Math.random()*1e6|0),Pt=0;function $t(c,p,g,T,M){this.listener=c,this.proxy=null,this.src=p,this.type=g,this.capture=!!T,this.ha=M,this.key=++Pt,this.da=this.fa=!1}function X(c){c.da=!0,c.listener=null,c.proxy=null,c.src=null,c.ha=null}function ce(c,p,g){for(const T in c)p.call(g,c[T],T,c)}function pe(c,p){for(const g in c)p.call(void 0,c[g],g,c)}function ke(c){const p={};for(const g in c)p[g]=c[g];return p}const Be="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function $(c,p){let g,T;for(let M=1;M<arguments.length;M++){T=arguments[M];for(g in T)c[g]=T[g];for(let F=0;F<Be.length;F++)g=Be[F],Object.prototype.hasOwnProperty.call(T,g)&&(c[g]=T[g])}}function J(c){this.src=c,this.g={},this.h=0}J.prototype.add=function(c,p,g,T,M){const F=c.toString();c=this.g[F],c||(c=this.g[F]=[],this.h++);const Y=ue(c,p,T,M);return Y>-1?(p=c[Y],g||(p.fa=!1)):(p=new $t(p,this.src,F,!!T,M),p.fa=g,c.push(p)),p};function le(c,p){const g=p.type;if(g in c.g){var T=c.g[g],M=Array.prototype.indexOf.call(T,p,void 0),F;(F=M>=0)&&Array.prototype.splice.call(T,M,1),F&&(X(p),c.g[g].length==0&&(delete c.g[g],c.h--))}}function ue(c,p,g,T){for(let M=0;M<c.length;++M){const F=c[M];if(!F.da&&F.listener==p&&F.capture==!!g&&F.ha==T)return M}return-1}var Ie="closure_lm_"+(Math.random()*1e6|0),je={};function me(c,p,g,T,M){if(Array.isArray(p)){for(let F=0;F<p.length;F++)me(c,p[F],g,T,M);return null}return g=de(g),c&&c[qe]?c.J(p,g,a(T)?!!T.capture:!1,M):Qe(c,p,g,!1,T,M)}function Qe(c,p,g,T,M,F){if(!p)throw Error("Invalid event type");const Y=a(M)?!!M.capture:!!M;let xe=Q(c);if(xe||(c[Ie]=xe=new J(c)),g=xe.add(p,g,T,Y,F),g.proxy)return g;if(T=we(),g.proxy=T,T.src=c,T.listener=g,c.addEventListener)V||(M=Y),M===void 0&&(M=!1),c.addEventListener(p.toString(),T,M);else if(c.attachEvent)c.attachEvent(Et(p.toString()),T);else if(c.addListener&&c.removeListener)c.addListener(T);else throw Error("addEventListener and attachEvent are unavailable.");return g}function we(){function c(g){return p.call(c.src,c.listener,g)}const p=Tt;return c}function re(c,p,g,T,M){if(Array.isArray(p))for(var F=0;F<p.length;F++)re(c,p[F],g,T,M);else T=a(T)?!!T.capture:!!T,g=de(g),c&&c[qe]?(c=c.i,F=String(p).toString(),F in c.g&&(p=c.g[F],g=ue(p,g,T,M),g>-1&&(X(p[g]),Array.prototype.splice.call(p,g,1),p.length==0&&(delete c.g[F],c.h--)))):c&&(c=Q(c))&&(p=c.g[p.toString()],c=-1,p&&(c=ue(p,g,T,M)),(g=c>-1?p[c]:null)&&Ae(g))}function Ae(c){if(typeof c!="number"&&c&&!c.da){var p=c.src;if(p&&p[qe])le(p.i,c);else{var g=c.type,T=c.proxy;p.removeEventListener?p.removeEventListener(g,T,c.capture):p.detachEvent?p.detachEvent(Et(g),T):p.addListener&&p.removeListener&&p.removeListener(T),(g=Q(p))?(le(g,c),g.h==0&&(g.src=null,p[Ie]=null)):X(c)}}}function Et(c){return c in je?je[c]:je[c]="on"+c}function Tt(c,p){if(c.da)c=!0;else{p=new q(p,this);const g=c.listener,T=c.ha||c.src;c.fa&&Ae(c),c=g.call(T,p)}return c}function Q(c){return c=c[Ie],c instanceof J?c:null}var ne="__closure_events_fn_"+(Math.random()*1e9>>>0);function de(c){return typeof c=="function"?c:(c[ne]||(c[ne]=function(p){return c.handleEvent(p)}),c[ne])}function te(){A.call(this),this.i=new J(this),this.M=this,this.G=null}f(te,A),te.prototype[qe]=!0,te.prototype.removeEventListener=function(c,p,g,T){re(this,c,p,g,T)};function ee(c,p){var g,T=c.G;if(T)for(g=[];T;T=T.G)g.push(T);if(c=c.M,T=p.type||p,typeof p=="string")p=new j(p,c);else if(p instanceof j)p.target=p.target||c;else{var M=p;p=new j(T,c),$(p,M)}M=!0;let F,Y;if(g)for(Y=g.length-1;Y>=0;Y--)F=p.g=g[Y],M=ge(F,T,!0,p)&&M;if(F=p.g=c,M=ge(F,T,!0,p)&&M,M=ge(F,T,!1,p)&&M,g)for(Y=0;Y<g.length;Y++)F=p.g=g[Y],M=ge(F,T,!1,p)&&M}te.prototype.N=function(){if(te.Z.N.call(this),this.i){var c=this.i;for(const p in c.g){const g=c.g[p];for(let T=0;T<g.length;T++)X(g[T]);delete c.g[p],c.h--}}this.G=null},te.prototype.J=function(c,p,g,T){return this.i.add(String(c),p,!1,g,T)},te.prototype.K=function(c,p,g,T){return this.i.add(String(c),p,!0,g,T)};function ge(c,p,g,T){if(p=c.i.g[String(p)],!p)return!0;p=p.concat();let M=!0;for(let F=0;F<p.length;++F){const Y=p[F];if(Y&&!Y.da&&Y.capture==g){const xe=Y.listener,kt=Y.ha||Y.src;Y.fa&&le(c.i,Y),M=xe.call(kt,T)!==!1&&M}}return M&&!T.defaultPrevented}function he(c,p){if(typeof c!="function")if(c&&typeof c.handleEvent=="function")c=d(c.handleEvent,c);else throw Error("Invalid listener argument");return Number(p)>2147483647?-1:o.setTimeout(c,p||0)}function Te(c){c.g=he(()=>{c.g=null,c.i&&(c.i=!1,Te(c))},c.l);const p=c.h;c.h=null,c.m.apply(null,p)}class De extends A{constructor(p,g){super(),this.m=p,this.l=g,this.h=null,this.i=!1,this.g=null}j(p){this.h=arguments,this.g?this.i=!0:Te(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function $e(c){A.call(this),this.h=c,this.g={}}f($e,A);var Xe=[];function Se(c){ce(c.g,function(p,g){this.g.hasOwnProperty(g)&&Ae(p)},c),c.g={}}$e.prototype.N=function(){$e.Z.N.call(this),Se(this)},$e.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var S=o.JSON.stringify,k=o.JSON.parse,z=class{stringify(c){return o.JSON.stringify(c,void 0)}parse(c){return o.JSON.parse(c,void 0)}};function G(){}function oe(){}var Ce={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function xt(){j.call(this,"d")}f(xt,j);function bn(){j.call(this,"c")}f(bn,j);var Nt={},et=null;function pt(){return et=et||new te}Nt.Ia="serverreachability";function tt(c){j.call(this,Nt.Ia,c)}f(tt,j);function St(c){const p=pt();ee(p,new tt(p))}Nt.STAT_EVENT="statevent";function zt(c,p){j.call(this,Nt.STAT_EVENT,c),this.stat=p}f(zt,j);function Oe(c){const p=pt();ee(p,new zt(p,c))}Nt.Ja="timingevent";function $c(c,p){j.call(this,Nt.Ja,c),this.size=p}f($c,j);function ri(c,p){if(typeof c!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){c()},p)}function jr(){this.g=!0}jr.prototype.ua=function(){this.g=!1};function pr(c,p,g,T,M,F){c.info(function(){if(c.g)if(F){var Y="",xe=F.split("&");for(let Ye=0;Ye<xe.length;Ye++){var kt=xe[Ye].split("=");if(kt.length>1){const Lt=kt[0];kt=kt[1];const gr=Lt.split("_");Y=gr.length>=2&&gr[1]=="type"?Y+(Lt+"="+kt+"&"):Y+(Lt+"=redacted&")}}}else Y=null;else Y=F;return"XMLHTTP REQ ("+T+") [attempt "+M+"]: "+p+`
`+g+`
`+Y})}function OA(c,p,g,T,M,F,Y){c.info(function(){return"XMLHTTP RESP ("+T+") [ attempt "+M+"]: "+p+`
`+g+`
`+F+" "+Y})}function ao(c,p,g,T){c.info(function(){return"XMLHTTP TEXT ("+p+"): "+LA(c,g)+(T?" "+T:"")})}function VA(c,p){c.info(function(){return"TIMEOUT: "+p})}jr.prototype.info=function(){};function LA(c,p){if(!c.g)return p;if(!p)return null;try{const F=JSON.parse(p);if(F){for(c=0;c<F.length;c++)if(Array.isArray(F[c])){var g=F[c];if(!(g.length<2)){var T=g[1];if(Array.isArray(T)&&!(T.length<1)){var M=T[0];if(M!="noop"&&M!="stop"&&M!="close")for(let Y=1;Y<T.length;Y++)T[Y]=""}}}}return S(F)}catch{return p}}var zc={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},k_={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},D_;function pf(){}f(pf,G),pf.prototype.g=function(){return new XMLHttpRequest},D_=new pf;function Oa(c){return encodeURIComponent(String(c))}function MA(c){var p=1;c=c.split(":");const g=[];for(;p>0&&c.length;)g.push(c.shift()),p--;return c.length&&g.push(c.join(":")),g}function ii(c,p,g,T){this.j=c,this.i=p,this.l=g,this.S=T||1,this.V=new $e(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new j_}function j_(){this.i=null,this.g="",this.h=!1}var O_={},mf={};function gf(c,p,g){c.M=1,c.A=Hc(mr(p)),c.u=g,c.R=!0,V_(c,null)}function V_(c,p){c.F=Date.now(),qc(c),c.B=mr(c.A);var g=c.B,T=c.S;Array.isArray(T)||(T=[String(T)]),Q_(g.i,"t",T),c.C=0,g=c.j.L,c.h=new j_,c.g=fv(c.j,g?p:null,!c.u),c.P>0&&(c.O=new De(d(c.Y,c,c.g),c.P)),p=c.V,g=c.g,T=c.ba;var M="readystatechange";Array.isArray(M)||(M&&(Xe[0]=M.toString()),M=Xe);for(let F=0;F<M.length;F++){const Y=me(g,M[F],T||p.handleEvent,!1,p.h||p);if(!Y)break;p.g[Y.key]=Y}p=c.J?ke(c.J):{},c.u?(c.v||(c.v="POST"),p["Content-Type"]="application/x-www-form-urlencoded",c.g.ea(c.B,c.v,c.u,p)):(c.v="GET",c.g.ea(c.B,c.v,null,p)),St(),pr(c.i,c.v,c.B,c.l,c.S,c.u)}ii.prototype.ba=function(c){c=c.target;const p=this.O;p&&ai(c)==3?p.j():this.Y(c)},ii.prototype.Y=function(c){try{if(c==this.g)e:{const xe=ai(this.g),kt=this.g.ya(),Ye=this.g.ca();if(!(xe<3)&&(xe!=3||this.g&&(this.h.h||this.g.la()||nv(this.g)))){this.K||xe!=4||kt==7||(kt==8||Ye<=0?St(3):St(2)),yf(this);var p=this.g.ca();this.X=p;var g=FA(this);if(this.o=p==200,OA(this.i,this.v,this.B,this.l,this.S,xe,p),this.o){if(this.U&&!this.L){t:{if(this.g){var T,M=this.g;if((T=M.g?M.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!P(T)){var F=T;break t}}F=null}if(c=F)ao(this.i,this.l,c,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,_f(this,c);else{this.o=!1,this.m=3,Oe(12),os(this),Va(this);break e}}if(this.R){c=!0;let Lt;for(;!this.K&&this.C<g.length;)if(Lt=UA(this,g),Lt==mf){xe==4&&(this.m=4,Oe(14),c=!1),ao(this.i,this.l,null,"[Incomplete Response]");break}else if(Lt==O_){this.m=4,Oe(15),ao(this.i,this.l,g,"[Invalid Chunk]"),c=!1;break}else ao(this.i,this.l,Lt,null),_f(this,Lt);if(L_(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),xe!=4||g.length!=0||this.h.h||(this.m=1,Oe(16),c=!1),this.o=this.o&&c,!c)ao(this.i,this.l,g,"[Invalid Chunked Response]"),os(this),Va(this);else if(g.length>0&&!this.W){this.W=!0;var Y=this.j;Y.g==this&&Y.aa&&!Y.P&&(Y.j.info("Great, no buffering proxy detected. Bytes received: "+g.length),bf(Y),Y.P=!0,Oe(11))}}else ao(this.i,this.l,g,null),_f(this,g);xe==4&&os(this),this.o&&!this.K&&(xe==4?cv(this.j,this):(this.o=!1,qc(this)))}else eR(this.g),p==400&&g.indexOf("Unknown SID")>0?(this.m=3,Oe(12)):(this.m=0,Oe(13)),os(this),Va(this)}}}catch{}finally{}};function FA(c){if(!L_(c))return c.g.la();const p=nv(c.g);if(p==="")return"";let g="";const T=p.length,M=ai(c.g)==4;if(!c.h.i){if(typeof TextDecoder>"u")return os(c),Va(c),"";c.h.i=new o.TextDecoder}for(let F=0;F<T;F++)c.h.h=!0,g+=c.h.i.decode(p[F],{stream:!(M&&F==T-1)});return p.length=0,c.h.g+=g,c.C=0,c.h.g}function L_(c){return c.g?c.v=="GET"&&c.M!=2&&c.j.Aa:!1}function UA(c,p){var g=c.C,T=p.indexOf(`
`,g);return T==-1?mf:(g=Number(p.substring(g,T)),isNaN(g)?O_:(T+=1,T+g>p.length?mf:(p=p.slice(T,T+g),c.C=T+g,p)))}ii.prototype.cancel=function(){this.K=!0,os(this)};function qc(c){c.T=Date.now()+c.H,M_(c,c.H)}function M_(c,p){if(c.D!=null)throw Error("WatchDog timer not null");c.D=ri(d(c.aa,c),p)}function yf(c){c.D&&(o.clearTimeout(c.D),c.D=null)}ii.prototype.aa=function(){this.D=null;const c=Date.now();c-this.T>=0?(VA(this.i,this.B),this.M!=2&&(St(),Oe(17)),os(this),this.m=2,Va(this)):M_(this,this.T-c)};function Va(c){c.j.I==0||c.K||cv(c.j,c)}function os(c){yf(c);var p=c.O;p&&typeof p.dispose=="function"&&p.dispose(),c.O=null,Se(c.V),c.g&&(p=c.g,c.g=null,p.abort(),p.dispose())}function _f(c,p){try{var g=c.j;if(g.I!=0&&(g.g==c||vf(g.h,c))){if(!c.L&&vf(g.h,c)&&g.I==3){try{var T=g.Ba.g.parse(p)}catch{T=null}if(Array.isArray(T)&&T.length==3){var M=T;if(M[0]==0){e:if(!g.v){if(g.g)if(g.g.F+3e3<c.F)Yc(g),Gc(g);else break e;Sf(g),Oe(18)}}else g.xa=M[1],0<g.xa-g.K&&M[2]<37500&&g.F&&g.A==0&&!g.C&&(g.C=ri(d(g.Va,g),6e3));B_(g.h)<=1&&g.ta&&(g.ta=void 0)}else ls(g,11)}else if((c.L||g.g==c)&&Yc(g),!P(p))for(M=g.Ba.g.parse(p),p=0;p<M.length;p++){let Ye=M[p];const Lt=Ye[0];if(!(Lt<=g.K))if(g.K=Lt,Ye=Ye[1],g.I==2)if(Ye[0]=="c"){g.M=Ye[1],g.ba=Ye[2];const gr=Ye[3];gr!=null&&(g.ka=gr,g.j.info("VER="+g.ka));const cs=Ye[4];cs!=null&&(g.za=cs,g.j.info("SVER="+g.za));const li=Ye[5];li!=null&&typeof li=="number"&&li>0&&(T=1.5*li,g.O=T,g.j.info("backChannelRequestTimeoutMs_="+T)),T=g;const ci=c.g;if(ci){const Jc=ci.g?ci.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Jc){var F=T.h;F.g||Jc.indexOf("spdy")==-1&&Jc.indexOf("quic")==-1&&Jc.indexOf("h2")==-1||(F.j=F.l,F.g=new Set,F.h&&(wf(F,F.h),F.h=null))}if(T.G){const Cf=ci.g?ci.g.getResponseHeader("X-HTTP-Session-Id"):null;Cf&&(T.wa=Cf,nt(T.J,T.G,Cf))}}g.I=3,g.l&&g.l.ra(),g.aa&&(g.T=Date.now()-c.F,g.j.info("Handshake RTT: "+g.T+"ms")),T=g;var Y=c;if(T.na=hv(T,T.L?T.ba:null,T.W),Y.L){$_(T.h,Y);var xe=Y,kt=T.O;kt&&(xe.H=kt),xe.D&&(yf(xe),qc(xe)),T.g=Y}else av(T);g.i.length>0&&Qc(g)}else Ye[0]!="stop"&&Ye[0]!="close"||ls(g,7);else g.I==3&&(Ye[0]=="stop"||Ye[0]=="close"?Ye[0]=="stop"?ls(g,7):xf(g):Ye[0]!="noop"&&g.l&&g.l.qa(Ye),g.A=0)}}St(4)}catch{}}var BA=class{constructor(c,p){this.g=c,this.map=p}};function F_(c){this.l=c||10,o.PerformanceNavigationTiming?(c=o.performance.getEntriesByType("navigation"),c=c.length>0&&(c[0].nextHopProtocol=="hq"||c[0].nextHopProtocol=="h2")):c=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=c?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function U_(c){return c.h?!0:c.g?c.g.size>=c.j:!1}function B_(c){return c.h?1:c.g?c.g.size:0}function vf(c,p){return c.h?c.h==p:c.g?c.g.has(p):!1}function wf(c,p){c.g?c.g.add(p):c.h=p}function $_(c,p){c.h&&c.h==p?c.h=null:c.g&&c.g.has(p)&&c.g.delete(p)}F_.prototype.cancel=function(){if(this.i=z_(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const c of this.g.values())c.cancel();this.g.clear()}};function z_(c){if(c.h!=null)return c.i.concat(c.h.G);if(c.g!=null&&c.g.size!==0){let p=c.i;for(const g of c.g.values())p=p.concat(g.G);return p}return _(c.i)}var q_=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function $A(c,p){if(c){c=c.split("&");for(let g=0;g<c.length;g++){const T=c[g].indexOf("=");let M,F=null;T>=0?(M=c[g].substring(0,T),F=c[g].substring(T+1)):M=c[g],p(M,F?decodeURIComponent(F.replace(/\+/g," ")):"")}}}function si(c){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let p;c instanceof si?(this.l=c.l,La(this,c.j),this.o=c.o,this.g=c.g,Ma(this,c.u),this.h=c.h,Ef(this,Y_(c.i)),this.m=c.m):c&&(p=String(c).match(q_))?(this.l=!1,La(this,p[1]||"",!0),this.o=Fa(p[2]||""),this.g=Fa(p[3]||"",!0),Ma(this,p[4]),this.h=Fa(p[5]||"",!0),Ef(this,p[6]||"",!0),this.m=Fa(p[7]||"")):(this.l=!1,this.i=new Ba(null,this.l))}si.prototype.toString=function(){const c=[];var p=this.j;p&&c.push(Ua(p,H_,!0),":");var g=this.g;return(g||p=="file")&&(c.push("//"),(p=this.o)&&c.push(Ua(p,H_,!0),"@"),c.push(Oa(g).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),g=this.u,g!=null&&c.push(":",String(g))),(g=this.h)&&(this.g&&g.charAt(0)!="/"&&c.push("/"),c.push(Ua(g,g.charAt(0)=="/"?HA:qA,!0))),(g=this.i.toString())&&c.push("?",g),(g=this.m)&&c.push("#",Ua(g,KA)),c.join("")},si.prototype.resolve=function(c){const p=mr(this);let g=!!c.j;g?La(p,c.j):g=!!c.o,g?p.o=c.o:g=!!c.g,g?p.g=c.g:g=c.u!=null;var T=c.h;if(g)Ma(p,c.u);else if(g=!!c.h){if(T.charAt(0)!="/")if(this.g&&!this.h)T="/"+T;else{var M=p.h.lastIndexOf("/");M!=-1&&(T=p.h.slice(0,M+1)+T)}if(M=T,M==".."||M==".")T="";else if(M.indexOf("./")!=-1||M.indexOf("/.")!=-1){T=M.lastIndexOf("/",0)==0,M=M.split("/");const F=[];for(let Y=0;Y<M.length;){const xe=M[Y++];xe=="."?T&&Y==M.length&&F.push(""):xe==".."?((F.length>1||F.length==1&&F[0]!="")&&F.pop(),T&&Y==M.length&&F.push("")):(F.push(xe),T=!0)}T=F.join("/")}else T=M}return g?p.h=T:g=c.i.toString()!=="",g?Ef(p,Y_(c.i)):g=!!c.m,g&&(p.m=c.m),p};function mr(c){return new si(c)}function La(c,p,g){c.j=g?Fa(p,!0):p,c.j&&(c.j=c.j.replace(/:$/,""))}function Ma(c,p){if(p){if(p=Number(p),isNaN(p)||p<0)throw Error("Bad port number "+p);c.u=p}else c.u=null}function Ef(c,p,g){p instanceof Ba?(c.i=p,GA(c.i,c.l)):(g||(p=Ua(p,WA)),c.i=new Ba(p,c.l))}function nt(c,p,g){c.i.set(p,g)}function Hc(c){return nt(c,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),c}function Fa(c,p){return c?p?decodeURI(c.replace(/%25/g,"%2525")):decodeURIComponent(c):""}function Ua(c,p,g){return typeof c=="string"?(c=encodeURI(c).replace(p,zA),g&&(c=c.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),c):null}function zA(c){return c=c.charCodeAt(0),"%"+(c>>4&15).toString(16)+(c&15).toString(16)}var H_=/[#\/\?@]/g,qA=/[#\?:]/g,HA=/[#\?]/g,WA=/[#\?@]/g,KA=/#/g;function Ba(c,p){this.h=this.g=null,this.i=c||null,this.j=!!p}function as(c){c.g||(c.g=new Map,c.h=0,c.i&&$A(c.i,function(p,g){c.add(decodeURIComponent(p.replace(/\+/g," ")),g)}))}t=Ba.prototype,t.add=function(c,p){as(this),this.i=null,c=lo(this,c);let g=this.g.get(c);return g||this.g.set(c,g=[]),g.push(p),this.h+=1,this};function W_(c,p){as(c),p=lo(c,p),c.g.has(p)&&(c.i=null,c.h-=c.g.get(p).length,c.g.delete(p))}function K_(c,p){return as(c),p=lo(c,p),c.g.has(p)}t.forEach=function(c,p){as(this),this.g.forEach(function(g,T){g.forEach(function(M){c.call(p,M,T,this)},this)},this)};function G_(c,p){as(c);let g=[];if(typeof p=="string")K_(c,p)&&(g=g.concat(c.g.get(lo(c,p))));else for(c=Array.from(c.g.values()),p=0;p<c.length;p++)g=g.concat(c[p]);return g}t.set=function(c,p){return as(this),this.i=null,c=lo(this,c),K_(this,c)&&(this.h-=this.g.get(c).length),this.g.set(c,[p]),this.h+=1,this},t.get=function(c,p){return c?(c=G_(this,c),c.length>0?String(c[0]):p):p};function Q_(c,p,g){W_(c,p),g.length>0&&(c.i=null,c.g.set(lo(c,p),_(g)),c.h+=g.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const c=[],p=Array.from(this.g.keys());for(let T=0;T<p.length;T++){var g=p[T];const M=Oa(g);g=G_(this,g);for(let F=0;F<g.length;F++){let Y=M;g[F]!==""&&(Y+="="+Oa(g[F])),c.push(Y)}}return this.i=c.join("&")};function Y_(c){const p=new Ba;return p.i=c.i,c.g&&(p.g=new Map(c.g),p.h=c.h),p}function lo(c,p){return p=String(p),c.j&&(p=p.toLowerCase()),p}function GA(c,p){p&&!c.j&&(as(c),c.i=null,c.g.forEach(function(g,T){const M=T.toLowerCase();T!=M&&(W_(this,T),Q_(this,M,g))},c)),c.j=p}function QA(c,p){const g=new jr;if(o.Image){const T=new Image;T.onload=h(oi,g,"TestLoadImage: loaded",!0,p,T),T.onerror=h(oi,g,"TestLoadImage: error",!1,p,T),T.onabort=h(oi,g,"TestLoadImage: abort",!1,p,T),T.ontimeout=h(oi,g,"TestLoadImage: timeout",!1,p,T),o.setTimeout(function(){T.ontimeout&&T.ontimeout()},1e4),T.src=c}else p(!1)}function YA(c,p){const g=new jr,T=new AbortController,M=setTimeout(()=>{T.abort(),oi(g,"TestPingServer: timeout",!1,p)},1e4);fetch(c,{signal:T.signal}).then(F=>{clearTimeout(M),F.ok?oi(g,"TestPingServer: ok",!0,p):oi(g,"TestPingServer: server error",!1,p)}).catch(()=>{clearTimeout(M),oi(g,"TestPingServer: error",!1,p)})}function oi(c,p,g,T,M){try{M&&(M.onload=null,M.onerror=null,M.onabort=null,M.ontimeout=null),T(g)}catch{}}function XA(){this.g=new z}function If(c){this.i=c.Sb||null,this.h=c.ab||!1}f(If,G),If.prototype.g=function(){return new Wc(this.i,this.h)};function Wc(c,p){te.call(this),this.H=c,this.o=p,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}f(Wc,te),t=Wc.prototype,t.open=function(c,p){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=c,this.D=p,this.readyState=1,za(this)},t.send=function(c){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const p={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};c&&(p.body=c),(this.H||o).fetch(new Request(this.D,p)).then(this.Pa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,$a(this)),this.readyState=0},t.Pa=function(c){if(this.g&&(this.l=c,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=c.headers,this.readyState=2,za(this)),this.g&&(this.readyState=3,za(this),this.g)))if(this.responseType==="arraybuffer")c.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in c){if(this.j=c.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;X_(this)}else c.text().then(this.Oa.bind(this),this.ga.bind(this))};function X_(c){c.j.read().then(c.Ma.bind(c)).catch(c.ga.bind(c))}t.Ma=function(c){if(this.g){if(this.o&&c.value)this.response.push(c.value);else if(!this.o){var p=c.value?c.value:new Uint8Array(0);(p=this.B.decode(p,{stream:!c.done}))&&(this.response=this.responseText+=p)}c.done?$a(this):za(this),this.readyState==3&&X_(this)}},t.Oa=function(c){this.g&&(this.response=this.responseText=c,$a(this))},t.Na=function(c){this.g&&(this.response=c,$a(this))},t.ga=function(){this.g&&$a(this)};function $a(c){c.readyState=4,c.l=null,c.j=null,c.B=null,za(c)}t.setRequestHeader=function(c,p){this.A.append(c,p)},t.getResponseHeader=function(c){return this.h&&this.h.get(c.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const c=[],p=this.h.entries();for(var g=p.next();!g.done;)g=g.value,c.push(g[0]+": "+g[1]),g=p.next();return c.join(`\r
`)};function za(c){c.onreadystatechange&&c.onreadystatechange.call(c)}Object.defineProperty(Wc.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(c){this.m=c?"include":"same-origin"}});function J_(c){let p="";return ce(c,function(g,T){p+=T,p+=":",p+=g,p+=`\r
`}),p}function Tf(c,p,g){e:{for(T in g){var T=!1;break e}T=!0}T||(g=J_(g),typeof c=="string"?g!=null&&Oa(g):nt(c,p,g))}function mt(c){te.call(this),this.headers=new Map,this.L=c||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}f(mt,te);var JA=/^https?$/i,ZA=["POST","PUT"];t=mt.prototype,t.Fa=function(c){this.H=c},t.ea=function(c,p,g,T){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+c);p=p?p.toUpperCase():"GET",this.D=c,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():D_.g(),this.g.onreadystatechange=m(d(this.Ca,this));try{this.B=!0,this.g.open(p,String(c),!0),this.B=!1}catch(F){Z_(this,F);return}if(c=g||"",g=new Map(this.headers),T)if(Object.getPrototypeOf(T)===Object.prototype)for(var M in T)g.set(M,T[M]);else if(typeof T.keys=="function"&&typeof T.get=="function")for(const F of T.keys())g.set(F,T.get(F));else throw Error("Unknown input type for opt_headers: "+String(T));T=Array.from(g.keys()).find(F=>F.toLowerCase()=="content-type"),M=o.FormData&&c instanceof o.FormData,!(Array.prototype.indexOf.call(ZA,p,void 0)>=0)||T||M||g.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[F,Y]of g)this.g.setRequestHeader(F,Y);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(c),this.v=!1}catch(F){Z_(this,F)}};function Z_(c,p){c.h=!1,c.g&&(c.j=!0,c.g.abort(),c.j=!1),c.l=p,c.o=5,ev(c),Kc(c)}function ev(c){c.A||(c.A=!0,ee(c,"complete"),ee(c,"error"))}t.abort=function(c){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=c||7,ee(this,"complete"),ee(this,"abort"),Kc(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Kc(this,!0)),mt.Z.N.call(this)},t.Ca=function(){this.u||(this.B||this.v||this.j?tv(this):this.Xa())},t.Xa=function(){tv(this)};function tv(c){if(c.h&&typeof s<"u"){if(c.v&&ai(c)==4)setTimeout(c.Ca.bind(c),0);else if(ee(c,"readystatechange"),ai(c)==4){c.h=!1;try{const F=c.ca();e:switch(F){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var p=!0;break e;default:p=!1}var g;if(!(g=p)){var T;if(T=F===0){let Y=String(c.D).match(q_)[1]||null;!Y&&o.self&&o.self.location&&(Y=o.self.location.protocol.slice(0,-1)),T=!JA.test(Y?Y.toLowerCase():"")}g=T}if(g)ee(c,"complete"),ee(c,"success");else{c.o=6;try{var M=ai(c)>2?c.g.statusText:""}catch{M=""}c.l=M+" ["+c.ca()+"]",ev(c)}}finally{Kc(c)}}}}function Kc(c,p){if(c.g){c.m&&(clearTimeout(c.m),c.m=null);const g=c.g;c.g=null,p||ee(c,"ready");try{g.onreadystatechange=null}catch{}}}t.isActive=function(){return!!this.g};function ai(c){return c.g?c.g.readyState:0}t.ca=function(){try{return ai(this)>2?this.g.status:-1}catch{return-1}},t.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.La=function(c){if(this.g){var p=this.g.responseText;return c&&p.indexOf(c)==0&&(p=p.substring(c.length)),k(p)}};function nv(c){try{if(!c.g)return null;if("response"in c.g)return c.g.response;switch(c.F){case"":case"text":return c.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in c.g)return c.g.mozResponseArrayBuffer}return null}catch{return null}}function eR(c){const p={};c=(c.g&&ai(c)>=2&&c.g.getAllResponseHeaders()||"").split(`\r
`);for(let T=0;T<c.length;T++){if(P(c[T]))continue;var g=MA(c[T]);const M=g[0];if(g=g[1],typeof g!="string")continue;g=g.trim();const F=p[M]||[];p[M]=F,F.push(g)}pe(p,function(T){return T.join(", ")})}t.ya=function(){return this.o},t.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function qa(c,p,g){return g&&g.internalChannelParams&&g.internalChannelParams[c]||p}function rv(c){this.za=0,this.i=[],this.j=new jr,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=qa("failFast",!1,c),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=qa("baseRetryDelayMs",5e3,c),this.Za=qa("retryDelaySeedMs",1e4,c),this.Ta=qa("forwardChannelMaxRetries",2,c),this.va=qa("forwardChannelRequestTimeoutMs",2e4,c),this.ma=c&&c.xmlHttpFactory||void 0,this.Ua=c&&c.Rb||void 0,this.Aa=c&&c.useFetchStreams||!1,this.O=void 0,this.L=c&&c.supportsCrossDomainXhr||!1,this.M="",this.h=new F_(c&&c.concurrentRequestLimit),this.Ba=new XA,this.S=c&&c.fastHandshake||!1,this.R=c&&c.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=c&&c.Pb||!1,c&&c.ua&&this.j.ua(),c&&c.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&c&&c.detectBufferingProxy||!1,this.ia=void 0,c&&c.longPollingTimeout&&c.longPollingTimeout>0&&(this.ia=c.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}t=rv.prototype,t.ka=8,t.I=1,t.connect=function(c,p,g,T){Oe(0),this.W=c,this.H=p||{},g&&T!==void 0&&(this.H.OSID=g,this.H.OAID=T),this.F=this.X,this.J=hv(this,null,this.W),Qc(this)};function xf(c){if(iv(c),c.I==3){var p=c.V++,g=mr(c.J);if(nt(g,"SID",c.M),nt(g,"RID",p),nt(g,"TYPE","terminate"),Ha(c,g),p=new ii(c,c.j,p),p.M=2,p.A=Hc(mr(g)),g=!1,o.navigator&&o.navigator.sendBeacon)try{g=o.navigator.sendBeacon(p.A.toString(),"")}catch{}!g&&o.Image&&(new Image().src=p.A,g=!0),g||(p.g=fv(p.j,null),p.g.ea(p.A)),p.F=Date.now(),qc(p)}dv(c)}function Gc(c){c.g&&(bf(c),c.g.cancel(),c.g=null)}function iv(c){Gc(c),c.v&&(o.clearTimeout(c.v),c.v=null),Yc(c),c.h.cancel(),c.m&&(typeof c.m=="number"&&o.clearTimeout(c.m),c.m=null)}function Qc(c){if(!U_(c.h)&&!c.m){c.m=!0;var p=c.Ea;D||v(),B||(D(),B=!0),x.add(p,c),c.D=0}}function tR(c,p){return B_(c.h)>=c.h.j-(c.m?1:0)?!1:c.m?(c.i=p.G.concat(c.i),!0):c.I==1||c.I==2||c.D>=(c.Sa?0:c.Ta)?!1:(c.m=ri(d(c.Ea,c,p),uv(c,c.D)),c.D++,!0)}t.Ea=function(c){if(this.m)if(this.m=null,this.I==1){if(!c){this.V=Math.floor(Math.random()*1e5),c=this.V++;const M=new ii(this,this.j,c);let F=this.o;if(this.U&&(F?(F=ke(F),$(F,this.U)):F=this.U),this.u!==null||this.R||(M.J=F,F=null),this.S)e:{for(var p=0,g=0;g<this.i.length;g++){t:{var T=this.i[g];if("__data__"in T.map&&(T=T.map.__data__,typeof T=="string")){T=T.length;break t}T=void 0}if(T===void 0)break;if(p+=T,p>4096){p=g;break e}if(p===4096||g===this.i.length-1){p=g+1;break e}}p=1e3}else p=1e3;p=ov(this,M,p),g=mr(this.J),nt(g,"RID",c),nt(g,"CVER",22),this.G&&nt(g,"X-HTTP-Session-Id",this.G),Ha(this,g),F&&(this.R?p="headers="+Oa(J_(F))+"&"+p:this.u&&Tf(g,this.u,F)),wf(this.h,M),this.Ra&&nt(g,"TYPE","init"),this.S?(nt(g,"$req",p),nt(g,"SID","null"),M.U=!0,gf(M,g,null)):gf(M,g,p),this.I=2}}else this.I==3&&(c?sv(this,c):this.i.length==0||U_(this.h)||sv(this))};function sv(c,p){var g;p?g=p.l:g=c.V++;const T=mr(c.J);nt(T,"SID",c.M),nt(T,"RID",g),nt(T,"AID",c.K),Ha(c,T),c.u&&c.o&&Tf(T,c.u,c.o),g=new ii(c,c.j,g,c.D+1),c.u===null&&(g.J=c.o),p&&(c.i=p.G.concat(c.i)),p=ov(c,g,1e3),g.H=Math.round(c.va*.5)+Math.round(c.va*.5*Math.random()),wf(c.h,g),gf(g,T,p)}function Ha(c,p){c.H&&ce(c.H,function(g,T){nt(p,T,g)}),c.l&&ce({},function(g,T){nt(p,T,g)})}function ov(c,p,g){g=Math.min(c.i.length,g);const T=c.l?d(c.l.Ka,c.l,c):null;e:{var M=c.i;let xe=-1;for(;;){const kt=["count="+g];xe==-1?g>0?(xe=M[0].g,kt.push("ofs="+xe)):xe=0:kt.push("ofs="+xe);let Ye=!0;for(let Lt=0;Lt<g;Lt++){var F=M[Lt].g;const gr=M[Lt].map;if(F-=xe,F<0)xe=Math.max(0,M[Lt].g-100),Ye=!1;else try{F="req"+F+"_"||"";try{var Y=gr instanceof Map?gr:Object.entries(gr);for(const[cs,li]of Y){let ci=li;a(li)&&(ci=S(li)),kt.push(F+cs+"="+encodeURIComponent(ci))}}catch(cs){throw kt.push(F+"type="+encodeURIComponent("_badmap")),cs}}catch{T&&T(gr)}}if(Ye){Y=kt.join("&");break e}}Y=void 0}return c=c.i.splice(0,g),p.G=c,Y}function av(c){if(!c.g&&!c.v){c.Y=1;var p=c.Da;D||v(),B||(D(),B=!0),x.add(p,c),c.A=0}}function Sf(c){return c.g||c.v||c.A>=3?!1:(c.Y++,c.v=ri(d(c.Da,c),uv(c,c.A)),c.A++,!0)}t.Da=function(){if(this.v=null,lv(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var c=4*this.T;this.j.info("BP detection timer enabled: "+c),this.B=ri(d(this.Wa,this),c)}},t.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,Oe(10),Gc(this),lv(this))};function bf(c){c.B!=null&&(o.clearTimeout(c.B),c.B=null)}function lv(c){c.g=new ii(c,c.j,"rpc",c.Y),c.u===null&&(c.g.J=c.o),c.g.P=0;var p=mr(c.na);nt(p,"RID","rpc"),nt(p,"SID",c.M),nt(p,"AID",c.K),nt(p,"CI",c.F?"0":"1"),!c.F&&c.ia&&nt(p,"TO",c.ia),nt(p,"TYPE","xmlhttp"),Ha(c,p),c.u&&c.o&&Tf(p,c.u,c.o),c.O&&(c.g.H=c.O);var g=c.g;c=c.ba,g.M=1,g.A=Hc(mr(p)),g.u=null,g.R=!0,V_(g,c)}t.Va=function(){this.C!=null&&(this.C=null,Gc(this),Sf(this),Oe(19))};function Yc(c){c.C!=null&&(o.clearTimeout(c.C),c.C=null)}function cv(c,p){var g=null;if(c.g==p){Yc(c),bf(c),c.g=null;var T=2}else if(vf(c.h,p))g=p.G,$_(c.h,p),T=1;else return;if(c.I!=0){if(p.o)if(T==1){g=p.u?p.u.length:0,p=Date.now()-p.F;var M=c.D;T=pt(),ee(T,new $c(T,g)),Qc(c)}else av(c);else if(M=p.m,M==3||M==0&&p.X>0||!(T==1&&tR(c,p)||T==2&&Sf(c)))switch(g&&g.length>0&&(p=c.h,p.i=p.i.concat(g)),M){case 1:ls(c,5);break;case 4:ls(c,10);break;case 3:ls(c,6);break;default:ls(c,2)}}}function uv(c,p){let g=c.Qa+Math.floor(Math.random()*c.Za);return c.isActive()||(g*=2),g*p}function ls(c,p){if(c.j.info("Error code "+p),p==2){var g=d(c.bb,c),T=c.Ua;const M=!T;T=new si(T||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||La(T,"https"),Hc(T),M?QA(T.toString(),g):YA(T.toString(),g)}else Oe(2);c.I=0,c.l&&c.l.pa(p),dv(c),iv(c)}t.bb=function(c){c?(this.j.info("Successfully pinged google.com"),Oe(2)):(this.j.info("Failed to ping google.com"),Oe(1))};function dv(c){if(c.I=0,c.ja=[],c.l){const p=z_(c.h);(p.length!=0||c.i.length!=0)&&(R(c.ja,p),R(c.ja,c.i),c.h.i.length=0,_(c.i),c.i.length=0),c.l.oa()}}function hv(c,p,g){var T=g instanceof si?mr(g):new si(g);if(T.g!="")p&&(T.g=p+"."+T.g),Ma(T,T.u);else{var M=o.location;T=M.protocol,p=p?p+"."+M.hostname:M.hostname,M=+M.port;const F=new si(null);T&&La(F,T),p&&(F.g=p),M&&Ma(F,M),g&&(F.h=g),T=F}return g=c.G,p=c.wa,g&&p&&nt(T,g,p),nt(T,"VER",c.ka),Ha(c,T),T}function fv(c,p,g){if(p&&!c.L)throw Error("Can't create secondary domain capable XhrIo object.");return p=c.Aa&&!c.ma?new mt(new If({ab:g})):new mt(c.ma),p.Fa(c.L),p}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function pv(){}t=pv.prototype,t.ra=function(){},t.qa=function(){},t.pa=function(){},t.oa=function(){},t.isActive=function(){return!0},t.Ka=function(){};function Xc(){}Xc.prototype.g=function(c,p){return new Cn(c,p)};function Cn(c,p){te.call(this),this.g=new rv(p),this.l=c,this.h=p&&p.messageUrlParams||null,c=p&&p.messageHeaders||null,p&&p.clientProtocolHeaderRequired&&(c?c["X-Client-Protocol"]="webchannel":c={"X-Client-Protocol":"webchannel"}),this.g.o=c,c=p&&p.initMessageHeaders||null,p&&p.messageContentType&&(c?c["X-WebChannel-Content-Type"]=p.messageContentType:c={"X-WebChannel-Content-Type":p.messageContentType}),p&&p.sa&&(c?c["X-WebChannel-Client-Profile"]=p.sa:c={"X-WebChannel-Client-Profile":p.sa}),this.g.U=c,(c=p&&p.Qb)&&!P(c)&&(this.g.u=c),this.A=p&&p.supportsCrossDomainXhr||!1,this.v=p&&p.sendRawJson||!1,(p=p&&p.httpSessionIdParam)&&!P(p)&&(this.g.G=p,c=this.h,c!==null&&p in c&&(c=this.h,p in c&&delete c[p])),this.j=new co(this)}f(Cn,te),Cn.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},Cn.prototype.close=function(){xf(this.g)},Cn.prototype.o=function(c){var p=this.g;if(typeof c=="string"){var g={};g.__data__=c,c=g}else this.v&&(g={},g.__data__=S(c),c=g);p.i.push(new BA(p.Ya++,c)),p.I==3&&Qc(p)},Cn.prototype.N=function(){this.g.l=null,delete this.j,xf(this.g),delete this.g,Cn.Z.N.call(this)};function mv(c){xt.call(this),c.__headers__&&(this.headers=c.__headers__,this.statusCode=c.__status__,delete c.__headers__,delete c.__status__);var p=c.__sm__;if(p){e:{for(const g in p){c=g;break e}c=void 0}(this.i=c)&&(c=this.i,p=p!==null&&c in p?p[c]:void 0),this.data=p}else this.data=c}f(mv,xt);function gv(){bn.call(this),this.status=1}f(gv,bn);function co(c){this.g=c}f(co,pv),co.prototype.ra=function(){ee(this.g,"a")},co.prototype.qa=function(c){ee(this.g,new mv(c))},co.prototype.pa=function(c){ee(this.g,new gv)},co.prototype.oa=function(){ee(this.g,"b")},Xc.prototype.createWebChannel=Xc.prototype.g,Cn.prototype.send=Cn.prototype.o,Cn.prototype.open=Cn.prototype.m,Cn.prototype.close=Cn.prototype.close,zS=function(){return new Xc},$S=function(){return pt()},BS=Nt,km={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},zc.NO_ERROR=0,zc.TIMEOUT=8,zc.HTTP_ERROR=6,Ku=zc,k_.COMPLETE="complete",US=k_,oe.EventType=Ce,Ce.OPEN="a",Ce.CLOSE="b",Ce.ERROR="c",Ce.MESSAGE="d",te.prototype.listen=te.prototype.J,pl=oe,mt.prototype.listenOnce=mt.prototype.K,mt.prototype.getLastError=mt.prototype.Ha,mt.prototype.getLastErrorCode=mt.prototype.ya,mt.prototype.getStatus=mt.prototype.ca,mt.prototype.getResponseJson=mt.prototype.La,mt.prototype.getResponseText=mt.prototype.la,mt.prototype.send=mt.prototype.ea,mt.prototype.setWithCredentials=mt.prototype.Fa,FS=mt}).apply(typeof _u<"u"?_u:typeof self<"u"?self:typeof window<"u"?window:{});const dE="@firebase/firestore",hE="4.9.2";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ht{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Ht.UNAUTHENTICATED=new Ht(null),Ht.GOOGLE_CREDENTIALS=new Ht("google-credentials-uid"),Ht.FIRST_PARTY=new Ht("first-party-uid"),Ht.MOCK_USER=new Ht("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Pa="12.3.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bs=new Ch("@firebase/firestore");function xo(){return Bs.logLevel}function H(t,...e){if(Bs.logLevel<=Pe.DEBUG){const n=e.map(Ey);Bs.debug(`Firestore (${Pa}): ${t}`,...n)}}function dn(t,...e){if(Bs.logLevel<=Pe.ERROR){const n=e.map(Ey);Bs.error(`Firestore (${Pa}): ${t}`,...n)}}function $s(t,...e){if(Bs.logLevel<=Pe.WARN){const n=e.map(Ey);Bs.warn(`Firestore (${Pa}): ${t}`,...n)}}function Ey(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function se(t,e,n){let r="Unexpected state";typeof e=="string"?r=e:n=e,qS(t,r,n)}function qS(t,e,n){let r=`FIRESTORE (${Pa}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(n!==void 0)try{r+=" CONTEXT: "+JSON.stringify(n)}catch{r+=" CONTEXT: "+n}throw dn(r),new Error(r)}function ae(t,e,n,r){let i="Unexpected state";typeof n=="string"?i=n:r=n,t||qS(e,i,r)}function ve(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const U={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class K extends Xn{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ar{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HS{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class W2{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(Ht.UNAUTHENTICATED))}shutdown(){}}class K2{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class G2{constructor(e){this.t=e,this.currentUser=Ht.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){ae(this.o===void 0,42304);let r=this.i;const i=l=>this.i!==r?(r=this.i,n(l)):Promise.resolve();let s=new ar;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new ar,e.enqueueRetryable(()=>i(this.currentUser))};const o=()=>{const l=s;e.enqueueRetryable(async()=>{await l.promise,await i(this.currentUser)})},a=l=>{H("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(l=>a(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?a(l):(H("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new ar)}},0),o()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(H("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(ae(typeof r.accessToken=="string",31837,{l:r}),new HS(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return ae(e===null||typeof e=="string",2055,{h:e}),new Ht(e)}}class Q2{constructor(e,n,r){this.P=e,this.T=n,this.I=r,this.type="FirstParty",this.user=Ht.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class Y2{constructor(e,n,r){this.P=e,this.T=n,this.I=r}getToken(){return Promise.resolve(new Q2(this.P,this.T,this.I))}start(e,n){e.enqueueRetryable(()=>n(Ht.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class fE{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class X2{constructor(e,n){this.V=n,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Bn(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,n){ae(this.o===void 0,3512);const r=s=>{s.error!=null&&H("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const o=s.token!==this.m;return this.m=s.token,H("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};const i=s=>{H("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){const s=this.V.getImmediate({optional:!0});s?i(s):H("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new fE(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(ae(typeof n.token=="string",44558,{tokenResult:n}),this.m=n.token,new fE(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function J2(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Iy{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const i=J2(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<n&&(r+=e.charAt(i[s]%62))}return r}}function Ee(t,e){return t<e?-1:t>e?1:0}function Dm(t,e){const n=Math.min(t.length,e.length);for(let r=0;r<n;r++){const i=t.charAt(r),s=e.charAt(r);if(i!==s)return cp(i)===cp(s)?Ee(i,s):cp(i)?1:-1}return Ee(t.length,e.length)}const Z2=55296,eO=57343;function cp(t){const e=t.charCodeAt(0);return e>=Z2&&e<=eO}function ca(t,e,n){return t.length===e.length&&t.every((r,i)=>n(r,e[i]))}function WS(t){return t+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pE="__name__";class Er{constructor(e,n,r){n===void 0?n=0:n>e.length&&se(637,{offset:n,range:e.length}),r===void 0?r=e.length-n:r>e.length-n&&se(1746,{length:r,range:e.length-n}),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return Er.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof Er?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let i=0;i<r;i++){const s=Er.compareSegments(e.get(i),n.get(i));if(s!==0)return s}return Ee(e.length,n.length)}static compareSegments(e,n){const r=Er.isNumericId(e),i=Er.isNumericId(n);return r&&!i?-1:!r&&i?1:r&&i?Er.extractNumericId(e).compare(Er.extractNumericId(n)):Dm(e,n)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Ui.fromString(e.substring(4,e.length-2))}}class Ue extends Er{construct(e,n,r){return new Ue(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new K(U.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(i=>i.length>0))}return new Ue(n)}static emptyPath(){return new Ue([])}}const tO=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class dt extends Er{construct(e,n,r){return new dt(e,n,r)}static isValidIdentifier(e){return tO.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),dt.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===pE}static keyField(){return new dt([pE])}static fromServerFormat(e){const n=[];let r="",i=0;const s=()=>{if(r.length===0)throw new K(U.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let o=!1;for(;i<e.length;){const a=e[i];if(a==="\\"){if(i+1===e.length)throw new K(U.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[i+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new K(U.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=l,i+=2}else a==="`"?(o=!o,i++):a!=="."||o?(r+=a,i++):(s(),i++)}if(s(),o)throw new K(U.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new dt(n)}static emptyPath(){return new dt([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z{constructor(e){this.path=e}static fromPath(e){return new Z(Ue.fromString(e))}static fromName(e){return new Z(Ue.fromString(e).popFirst(5))}static empty(){return new Z(Ue.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Ue.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return Ue.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Z(new Ue(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function KS(t,e,n){if(!n)throw new K(U.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function nO(t,e,n,r){if(e===!0&&r===!0)throw new K(U.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function mE(t){if(!Z.isDocumentKey(t))throw new K(U.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function gE(t){if(Z.isDocumentKey(t))throw new K(U.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function GS(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function Dh(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":se(12329,{type:typeof t})}function on(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new K(U.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Dh(t);throw new K(U.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}function rO(t,e){if(e<=0)throw new K(U.INVALID_ARGUMENT,`Function ${t}() requires a positive number, but it was: ${e}.`)}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function At(t,e){const n={typeString:t};return e&&(n.value=e),n}function Rc(t,e){if(!GS(t))throw new K(U.INVALID_ARGUMENT,"JSON must be an object");let n;for(const r in e)if(e[r]){const i=e[r].typeString,s="value"in e[r]?{value:e[r].value}:void 0;if(!(r in t)){n=`JSON missing required field: '${r}'`;break}const o=t[r];if(i&&typeof o!==i){n=`JSON field '${r}' must be a ${i}.`;break}if(s!==void 0&&o!==s.value){n=`Expected '${r}' field to equal '${s.value}'`;break}}if(n)throw new K(U.INVALID_ARGUMENT,n);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yE=-62135596800,_E=1e6;class Le{static now(){return Le.fromMillis(Date.now())}static fromDate(e){return Le.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor((e-1e3*n)*_E);return new Le(n,r)}constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new K(U.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new K(U.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<yE)throw new K(U.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new K(U.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/_E}_compareTo(e){return this.seconds===e.seconds?Ee(this.nanoseconds,e.nanoseconds):Ee(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:Le._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Rc(e,Le._jsonSchema))return new Le(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-yE;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}Le._jsonSchemaVersion="firestore/timestamp/1.0",Le._jsonSchema={type:At("string",Le._jsonSchemaVersion),seconds:At("number"),nanoseconds:At("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fe{static fromTimestamp(e){return new fe(e)}static min(){return new fe(new Le(0,0))}static max(){return new fe(new Le(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ac=-1;class Md{constructor(e,n,r,i){this.indexId=e,this.collectionGroup=n,this.fields=r,this.indexState=i}}function jm(t){return t.fields.find(e=>e.kind===2)}function ms(t){return t.fields.filter(e=>e.kind!==2)}Md.UNKNOWN_ID=-1;class Gu{constructor(e,n){this.fieldPath=e,this.kind=n}}class lc{constructor(e,n){this.sequenceNumber=e,this.offset=n}static empty(){return new lc(0,On.min())}}function iO(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,i=fe.fromTimestamp(r===1e9?new Le(n+1,0):new Le(n,r));return new On(i,Z.empty(),e)}function QS(t){return new On(t.readTime,t.key,ac)}class On{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new On(fe.min(),Z.empty(),ac)}static max(){return new On(fe.max(),Z.empty(),ac)}}function Ty(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=Z.comparator(t.documentKey,e.documentKey),n!==0?n:Ee(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YS="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class XS{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function so(t){if(t.code!==U.FAILED_PRECONDITION||t.message!==YS)throw t;H("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&se(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new L((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(n,s).next(r,i)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof L?n:L.resolve(n)}catch(n){return L.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):L.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):L.reject(n)}static resolve(e){return new L((n,r)=>{n(e)})}static reject(e){return new L((n,r)=>{r(e)})}static waitFor(e){return new L((n,r)=>{let i=0,s=0,o=!1;e.forEach(a=>{++i,a.next(()=>{++s,o&&s===i&&n()},l=>r(l))}),o=!0,s===i&&n()})}static or(e){let n=L.resolve(!1);for(const r of e)n=n.next(i=>i?L.resolve(i):r());return n}static forEach(e,n){const r=[];return e.forEach((i,s)=>{r.push(n.call(this,i,s))}),this.waitFor(r)}static mapArray(e,n){return new L((r,i)=>{const s=e.length,o=new Array(s);let a=0;for(let l=0;l<s;l++){const d=l;n(e[d]).next(h=>{o[d]=h,++a,a===s&&r(o)},h=>i(h))}})}static doWhile(e,n){return new L((r,i)=>{const s=()=>{e()===!0?n().next(()=>{s()},i):r()};s()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rn="SimpleDb";class jh{static open(e,n,r,i){try{return new jh(n,e.transaction(i,r))}catch(s){throw new kl(n,s)}}constructor(e,n){this.action=e,this.transaction=n,this.aborted=!1,this.S=new ar,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{n.error?this.S.reject(new kl(e,n.error)):this.S.resolve()},this.transaction.onerror=r=>{const i=xy(r.target.error);this.S.reject(new kl(e,i))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(H(Rn,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}C(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const n=this.transaction.objectStore(e);return new oO(n)}}class Bi{static delete(e){return H(Rn,"Removing database:",e),ys(Bx().indexedDB.deleteDatabase(e)).toPromise()}static v(){if(!cy())return!1;if(Bi.F())return!0;const e=Ot(),n=Bi.M(e),r=0<n&&n<10,i=JS(e),s=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||s)}static F(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)==null?void 0:e.__PRIVATE_USE_MOCK_PERSISTENCE)==="YES"}static O(e,n){return e.store(n)}static M(e){const n=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=n?n[1].split("_").slice(0,2).join("."):"-1";return Number(r)}constructor(e,n,r){this.name=e,this.version=n,this.N=r,this.B=null,Bi.M(Ot())===12.2&&dn("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async L(e){return this.db||(H(Rn,"Opening database:",this.name),this.db=await new Promise((n,r)=>{const i=indexedDB.open(this.name,this.version);i.onsuccess=s=>{const o=s.target.result;n(o)},i.onblocked=()=>{r(new kl(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=s=>{const o=s.target.error;o.name==="VersionError"?r(new K(U.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?r(new K(U.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):r(new kl(e,o))},i.onupgradeneeded=s=>{H(Rn,'Database "'+this.name+'" requires upgrade from version:',s.oldVersion);const o=s.target.result;this.N.k(o,i.transaction,s.oldVersion,this.version).next(()=>{H(Rn,"Database upgrade to version "+this.version+" complete")})}})),this.q&&(this.db.onversionchange=n=>this.q(n)),this.db}$(e){this.q=e,this.db&&(this.db.onversionchange=n=>e(n))}async runTransaction(e,n,r,i){const s=n==="readonly";let o=0;for(;;){++o;try{this.db=await this.L(e);const a=jh.open(this.db,e,s?"readonly":"readwrite",r),l=i(a).next(d=>(a.C(),d)).catch(d=>(a.abort(d),L.reject(d))).toPromise();return l.catch(()=>{}),await a.D,l}catch(a){const l=a,d=l.name!=="FirebaseError"&&o<3;if(H(Rn,"Transaction failed with error:",l.message,"Retrying:",d),this.close(),!d)return Promise.reject(l)}}}close(){this.db&&this.db.close(),this.db=void 0}}function JS(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}class sO{constructor(e){this.U=e,this.K=!1,this.W=null}get isDone(){return this.K}get G(){return this.W}set cursor(e){this.U=e}done(){this.K=!0}j(e){this.W=e}delete(){return ys(this.U.delete())}}class kl extends K{constructor(e,n){super(U.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${n}`),this.name="IndexedDbTransactionError"}}function rs(t){return t.name==="IndexedDbTransactionError"}class oO{constructor(e){this.store=e}put(e,n){let r;return n!==void 0?(H(Rn,"PUT",this.store.name,e,n),r=this.store.put(n,e)):(H(Rn,"PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),ys(r)}add(e){return H(Rn,"ADD",this.store.name,e,e),ys(this.store.add(e))}get(e){return ys(this.store.get(e)).next(n=>(n===void 0&&(n=null),H(Rn,"GET",this.store.name,e,n),n))}delete(e){return H(Rn,"DELETE",this.store.name,e),ys(this.store.delete(e))}count(){return H(Rn,"COUNT",this.store.name),ys(this.store.count())}J(e,n){const r=this.options(e,n),i=r.index?this.store.index(r.index):this.store;if(typeof i.getAll=="function"){const s=i.getAll(r.range);return new L((o,a)=>{s.onerror=l=>{a(l.target.error)},s.onsuccess=l=>{o(l.target.result)}})}{const s=this.cursor(r),o=[];return this.H(s,(a,l)=>{o.push(l)}).next(()=>o)}}Y(e,n){const r=this.store.getAll(e,n===null?void 0:n);return new L((i,s)=>{r.onerror=o=>{s(o.target.error)},r.onsuccess=o=>{i(o.target.result)}})}Z(e,n){H(Rn,"DELETE ALL",this.store.name);const r=this.options(e,n);r.X=!1;const i=this.cursor(r);return this.H(i,(s,o,a)=>a.delete())}ee(e,n){let r;n?r=e:(r={},n=e);const i=this.cursor(r);return this.H(i,n)}te(e){const n=this.cursor({});return new L((r,i)=>{n.onerror=s=>{const o=xy(s.target.error);i(o)},n.onsuccess=s=>{const o=s.target.result;o?e(o.primaryKey,o.value).next(a=>{a?o.continue():r()}):r()}})}H(e,n){const r=[];return new L((i,s)=>{e.onerror=o=>{s(o.target.error)},e.onsuccess=o=>{const a=o.target.result;if(!a)return void i();const l=new sO(a),d=n(a.primaryKey,a.value,l);if(d instanceof L){const h=d.catch(f=>(l.done(),L.reject(f)));r.push(h)}l.isDone?i():l.G===null?a.continue():a.continue(l.G)}}).next(()=>L.waitFor(r))}options(e,n){let r;return e!==void 0&&(typeof e=="string"?r=e:n=e),{index:r,range:n}}cursor(e){let n="next";if(e.reverse&&(n="prev"),e.index){const r=this.store.index(e.index);return e.X?r.openKeyCursor(e.range,n):r.openCursor(e.range,n)}return this.store.openCursor(e.range,n)}}function ys(t){return new L((e,n)=>{t.onsuccess=r=>{const i=r.target.result;e(i)},t.onerror=r=>{const i=xy(r.target.error);n(i)}})}let vE=!1;function xy(t){const e=Bi.M(Ot());if(e>=12.2&&e<13){const n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){const r=new K("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${n}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return vE||(vE=!0,setTimeout(()=>{throw r},0)),r}}return t}const Dl="IndexBackfiller";class aO{constructor(e,n){this.asyncQueue=e,this.ne=n,this.task=null}start(){this.re(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}re(e){H(Dl,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{const n=await this.ne.ie();H(Dl,`Documents written: ${n}`)}catch(n){rs(n)?H(Dl,"Ignoring IndexedDB error during index backfill: ",n):await so(n)}await this.re(6e4)})}}class lO{constructor(e,n){this.localStore=e,this.persistence=n}async ie(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",n=>this.se(n,e))}se(e,n){const r=new Set;let i=n,s=!0;return L.doWhile(()=>s===!0&&i>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(o!==null&&!r.has(o))return H(Dl,`Processing collection: ${o}`),this.oe(e,o,i).next(a=>{i-=a,r.add(o)});s=!1})).next(()=>n-i)}oe(e,n,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,n).next(i=>this.localStore.localDocuments.getNextDocuments(e,n,i,r).next(s=>{const o=s.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this._e(i,s)).next(a=>(H(Dl,`Updating offset: ${a}`),this.localStore.indexManager.updateCollectionGroup(e,n,a))).next(()=>o.size)}))}_e(e,n){let r=e;return n.changes.forEach((i,s)=>{const o=QS(s);Ty(o,r)>0&&(r=o)}),new On(r.readTime,r.documentKey,Math.max(n.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qn{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ae(r),this.ue=r=>n.writeSequenceNumber(r))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}qn.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rs=-1;function Oh(t){return t==null}function cc(t){return t===0&&1/t==-1/0}function cO(t){return typeof t=="number"&&Number.isInteger(t)&&!cc(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fd="";function an(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=wE(e)),e=uO(t.get(n),e);return wE(e)}function uO(t,e){let n=e;const r=t.length;for(let i=0;i<r;i++){const s=t.charAt(i);switch(s){case"\0":n+="";break;case Fd:n+="";break;default:n+=s}}return n}function wE(t){return t+Fd+""}function Tr(t){const e=t.length;if(ae(e>=2,64408,{path:t}),e===2)return ae(t.charAt(0)===Fd&&t.charAt(1)==="",56145,{path:t}),Ue.emptyPath();const n=e-2,r=[];let i="";for(let s=0;s<e;){const o=t.indexOf(Fd,s);switch((o<0||o>n)&&se(50515,{path:t}),t.charAt(o+1)){case"":const a=t.substring(s,o);let l;i.length===0?l=a:(i+=a,l=i,i=""),r.push(l);break;case"":i+=t.substring(s,o),i+="\0";break;case"":i+=t.substring(s,o+1);break;default:se(61167,{path:t})}s=o+2}return new Ue(r)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gs="remoteDocuments",Pc="owner",ho="owner",uc="mutationQueues",dO="userId",tr="mutations",EE="batchId",Ss="userMutationsIndex",IE=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qu(t,e){return[t,an(e)]}function ZS(t,e,n){return[t,an(e),n]}const hO={},ua="documentMutations",Ud="remoteDocumentsV14",fO=["prefixPath","collectionGroup","readTime","documentId"],Yu="documentKeyIndex",pO=["prefixPath","collectionGroup","documentId"],eb="collectionGroupIndex",mO=["collectionGroup","readTime","prefixPath","documentId"],dc="remoteDocumentGlobal",Om="remoteDocumentGlobalKey",da="targets",tb="queryTargetsIndex",gO=["canonicalId","targetId"],ha="targetDocuments",yO=["targetId","path"],Sy="documentTargetsIndex",_O=["path","targetId"],Bd="targetGlobalKey",Ps="targetGlobal",hc="collectionParents",vO=["collectionId","parent"],fa="clientMetadata",wO="clientId",Vh="bundles",EO="bundleId",Lh="namedQueries",IO="name",by="indexConfiguration",TO="indexId",Vm="collectionGroupIndex",xO="collectionGroup",jl="indexState",SO=["indexId","uid"],nb="sequenceNumberIndex",bO=["uid","sequenceNumber"],Ol="indexEntries",CO=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],rb="documentKeyIndex",AO=["indexId","uid","orderedDocumentKey"],Mh="documentOverlays",RO=["userId","collectionPath","documentId"],Lm="collectionPathOverlayIndex",PO=["userId","collectionPath","largestBatchId"],ib="collectionGroupOverlayIndex",NO=["userId","collectionGroup","largestBatchId"],Cy="globals",kO="name",sb=[uc,tr,ua,gs,da,Pc,Ps,ha,fa,dc,hc,Vh,Lh],DO=[...sb,Mh],ob=[uc,tr,ua,Ud,da,Pc,Ps,ha,fa,dc,hc,Vh,Lh,Mh],ab=ob,Ay=[...ab,by,jl,Ol],jO=Ay,lb=[...Ay,Cy],OO=lb;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mm extends XS{constructor(e,n){super(),this.le=e,this.currentSequenceNumber=n}}function Vt(t,e){const n=ve(t);return Bi.O(n.le,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function TE(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function is(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function VO(t,e){const n=[];for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&n.push(e(t[r],r,t));return n}function cb(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ct{constructor(e,n){this.comparator=e,this.root=n||Wt.EMPTY}insert(e,n){return new ct(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,Wt.BLACK,null,null))}remove(e){return new ct(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Wt.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(e,r.key);if(i===0)return n+r.left.size;i<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new vu(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new vu(this.root,e,this.comparator,!1)}getReverseIterator(){return new vu(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new vu(this.root,e,this.comparator,!0)}}class vu{constructor(e,n,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=n?r(e.key,n):1,n&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Wt{constructor(e,n,r,i,s){this.key=e,this.value=n,this.color=r??Wt.RED,this.left=i??Wt.EMPTY,this.right=s??Wt.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,i,s){return new Wt(e??this.key,n??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let i=this;const s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,n,r),null):s===0?i.copy(null,n,null,null,null):i.copy(null,null,null,null,i.right.insert(e,n,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return Wt.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),n(e,i.key)===0){if(i.right.isEmpty())return Wt.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Wt.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Wt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw se(43730,{key:this.key,value:this.value});if(this.right.isRed())throw se(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw se(27949);return e+(this.isRed()?0:1)}}Wt.EMPTY=null,Wt.RED=!0,Wt.BLACK=!1;Wt.EMPTY=new class{constructor(){this.size=0}get key(){throw se(57766)}get value(){throw se(16141)}get color(){throw se(16727)}get left(){throw se(29726)}get right(){throw se(36894)}copy(e,n,r,i,s){return this}insert(e,n,r){return new Wt(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ke{constructor(e){this.comparator=e,this.data=new ct(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;n(i.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new xE(this.data.getIterator())}getIteratorFrom(e){return new xE(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof Ke)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const i=n.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new Ke(this.comparator);return n.data=e,n}}class xE{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function fo(t){return t.hasNext()?t.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class En{constructor(e){this.fields=e,e.sort(dt.comparator)}static empty(){return new En([])}unionWith(e){let n=new Ke(dt.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new En(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return ca(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ub extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rt{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new ub("Invalid base64 string: "+s):s}}(e);return new Rt(n)}static fromUint8Array(e){const n=function(i){let s="";for(let o=0;o<i.length;++o)s+=String.fromCharCode(i[o]);return s}(e);return new Rt(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Ee(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Rt.EMPTY_BYTE_STRING=new Rt("");const LO=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Jr(t){if(ae(!!t,39018),typeof t=="string"){let e=0;const n=LO.exec(t);if(ae(!!n,46558,{timestamp:t}),n[1]){let i=n[1];i=(i+"000000000").substr(0,9),e=Number(i)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:ot(t.seconds),nanos:ot(t.nanos)}}function ot(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Zr(t){return typeof t=="string"?Rt.fromBase64String(t):Rt.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const db="server_timestamp",hb="__type__",fb="__previous_value__",pb="__local_write_time__";function Fh(t){var n,r;return((r=(((n=t==null?void 0:t.mapValue)==null?void 0:n.fields)||{})[hb])==null?void 0:r.stringValue)===db}function Uh(t){const e=t.mapValue.fields[fb];return Fh(e)?Uh(e):e}function fc(t){const e=Jr(t.mapValue.fields[pb].timestampValue);return new Le(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MO{constructor(e,n,r,i,s,o,a,l,d,h){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=l,this.useFetchStreams=d,this.isUsingEmulator=h}}const $d="(default)";class zs{constructor(e,n){this.projectId=e,this.database=n||$d}static empty(){return new zs("","")}get isDefaultDatabase(){return this.database===$d}isEqual(e){return e instanceof zs&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ry="__type__",mb="__max__",Ai={mapValue:{fields:{__type__:{stringValue:mb}}}},Py="__vector__",pa="value",Xu={nullValue:"NULL_VALUE"};function Hi(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Fh(t)?4:gb(t)?9007199254740991:Bh(t)?10:11:se(28295,{value:t})}function kr(t,e){if(t===e)return!0;const n=Hi(t);if(n!==Hi(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return fc(t).isEqual(fc(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const o=Jr(i.timestampValue),a=Jr(s.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(i,s){return Zr(i.bytesValue).isEqual(Zr(s.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(i,s){return ot(i.geoPointValue.latitude)===ot(s.geoPointValue.latitude)&&ot(i.geoPointValue.longitude)===ot(s.geoPointValue.longitude)}(t,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return ot(i.integerValue)===ot(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const o=ot(i.doubleValue),a=ot(s.doubleValue);return o===a?cc(o)===cc(a):isNaN(o)&&isNaN(a)}return!1}(t,e);case 9:return ca(t.arrayValue.values||[],e.arrayValue.values||[],kr);case 10:case 11:return function(i,s){const o=i.mapValue.fields||{},a=s.mapValue.fields||{};if(TE(o)!==TE(a))return!1;for(const l in o)if(o.hasOwnProperty(l)&&(a[l]===void 0||!kr(o[l],a[l])))return!1;return!0}(t,e);default:return se(52216,{left:t})}}function pc(t,e){return(t.values||[]).find(n=>kr(n,e))!==void 0}function Wi(t,e){if(t===e)return 0;const n=Hi(t),r=Hi(e);if(n!==r)return Ee(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return Ee(t.booleanValue,e.booleanValue);case 2:return function(s,o){const a=ot(s.integerValue||s.doubleValue),l=ot(o.integerValue||o.doubleValue);return a<l?-1:a>l?1:a===l?0:isNaN(a)?isNaN(l)?0:-1:1}(t,e);case 3:return SE(t.timestampValue,e.timestampValue);case 4:return SE(fc(t),fc(e));case 5:return Dm(t.stringValue,e.stringValue);case 6:return function(s,o){const a=Zr(s),l=Zr(o);return a.compareTo(l)}(t.bytesValue,e.bytesValue);case 7:return function(s,o){const a=s.split("/"),l=o.split("/");for(let d=0;d<a.length&&d<l.length;d++){const h=Ee(a[d],l[d]);if(h!==0)return h}return Ee(a.length,l.length)}(t.referenceValue,e.referenceValue);case 8:return function(s,o){const a=Ee(ot(s.latitude),ot(o.latitude));return a!==0?a:Ee(ot(s.longitude),ot(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return bE(t.arrayValue,e.arrayValue);case 10:return function(s,o){var m,_,R,C;const a=s.fields||{},l=o.fields||{},d=(m=a[pa])==null?void 0:m.arrayValue,h=(_=l[pa])==null?void 0:_.arrayValue,f=Ee(((R=d==null?void 0:d.values)==null?void 0:R.length)||0,((C=h==null?void 0:h.values)==null?void 0:C.length)||0);return f!==0?f:bE(d,h)}(t.mapValue,e.mapValue);case 11:return function(s,o){if(s===Ai.mapValue&&o===Ai.mapValue)return 0;if(s===Ai.mapValue)return 1;if(o===Ai.mapValue)return-1;const a=s.fields||{},l=Object.keys(a),d=o.fields||{},h=Object.keys(d);l.sort(),h.sort();for(let f=0;f<l.length&&f<h.length;++f){const m=Dm(l[f],h[f]);if(m!==0)return m;const _=Wi(a[l[f]],d[h[f]]);if(_!==0)return _}return Ee(l.length,h.length)}(t.mapValue,e.mapValue);default:throw se(23264,{he:n})}}function SE(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return Ee(t,e);const n=Jr(t),r=Jr(e),i=Ee(n.seconds,r.seconds);return i!==0?i:Ee(n.nanos,r.nanos)}function bE(t,e){const n=t.values||[],r=e.values||[];for(let i=0;i<n.length&&i<r.length;++i){const s=Wi(n[i],r[i]);if(s)return s}return Ee(n.length,r.length)}function ma(t){return Fm(t)}function Fm(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=Jr(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return Zr(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return Z.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",i=!0;for(const s of n.values||[])i?i=!1:r+=",",r+=Fm(s);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let i="{",s=!0;for(const o of r)s?s=!1:i+=",",i+=`${o}:${Fm(n.fields[o])}`;return i+"}"}(t.mapValue):se(61005,{value:t})}function Ju(t){switch(Hi(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Uh(t);return e?16+Ju(e):16;case 5:return 2*t.stringValue.length;case 6:return Zr(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return function(r){return(r.values||[]).reduce((i,s)=>i+Ju(s),0)}(t.arrayValue);case 10:case 11:return function(r){let i=0;return is(r.fields,(s,o)=>{i+=s.length+Ju(o)}),i}(t.mapValue);default:throw se(13486,{value:t})}}function qs(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function Um(t){return!!t&&"integerValue"in t}function mc(t){return!!t&&"arrayValue"in t}function CE(t){return!!t&&"nullValue"in t}function AE(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Zu(t){return!!t&&"mapValue"in t}function Bh(t){var n,r;return((r=(((n=t==null?void 0:t.mapValue)==null?void 0:n.fields)||{})[Ry])==null?void 0:r.stringValue)===Py}function Vl(t){if(t.geoPointValue)return{geoPointValue:{...t.geoPointValue}};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:{...t.timestampValue}};if(t.mapValue){const e={mapValue:{fields:{}}};return is(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=Vl(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=Vl(t.arrayValue.values[n]);return e}return{...t}}function gb(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===mb}const yb={mapValue:{fields:{[Ry]:{stringValue:Py},[pa]:{arrayValue:{}}}}};function FO(t){return"nullValue"in t?Xu:"booleanValue"in t?{booleanValue:!1}:"integerValue"in t||"doubleValue"in t?{doubleValue:NaN}:"timestampValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in t?{stringValue:""}:"bytesValue"in t?{bytesValue:""}:"referenceValue"in t?qs(zs.empty(),Z.empty()):"geoPointValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in t?{arrayValue:{}}:"mapValue"in t?Bh(t)?yb:{mapValue:{}}:se(35942,{value:t})}function UO(t){return"nullValue"in t?{booleanValue:!1}:"booleanValue"in t?{doubleValue:NaN}:"integerValue"in t||"doubleValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in t?{stringValue:""}:"stringValue"in t?{bytesValue:""}:"bytesValue"in t?qs(zs.empty(),Z.empty()):"referenceValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in t?{arrayValue:{}}:"arrayValue"in t?yb:"mapValue"in t?Bh(t)?{mapValue:{}}:Ai:se(61959,{value:t})}function RE(t,e){const n=Wi(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?-1:!t.inclusive&&e.inclusive?1:0}function PE(t,e){const n=Wi(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?1:!t.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nn{constructor(e){this.value=e}static empty(){return new nn({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!Zu(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=Vl(n)}setAll(e){let n=dt.emptyPath(),r={},i=[];e.forEach((o,a)=>{if(!n.isImmediateParentOf(a)){const l=this.getFieldsMap(n);this.applyChanges(l,r,i),r={},i=[],n=a.popLast()}o?r[a.lastSegment()]=Vl(o):i.push(a.lastSegment())});const s=this.getFieldsMap(n);this.applyChanges(s,r,i)}delete(e){const n=this.field(e.popLast());Zu(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return kr(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=n.mapValue.fields[e.get(r)];Zu(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=i),n=i}return n.mapValue.fields}applyChanges(e,n,r){is(n,(i,s)=>e[i]=s);for(const i of r)delete e[i]}clone(){return new nn(Vl(this.value))}}function _b(t){const e=[];return is(t.fields,(n,r)=>{const i=new dt([n]);if(Zu(r)){const s=_b(r.mapValue).fields;if(s.length===0)e.push(i);else for(const o of s)e.push(i.child(o))}else e.push(i)}),new En(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yt{constructor(e,n,r,i,s,o,a){this.key=e,this.documentType=n,this.version=r,this.readTime=i,this.createTime=s,this.data=o,this.documentState=a}static newInvalidDocument(e){return new yt(e,0,fe.min(),fe.min(),fe.min(),nn.empty(),0)}static newFoundDocument(e,n,r,i){return new yt(e,1,n,fe.min(),r,i,0)}static newNoDocument(e,n){return new yt(e,2,n,fe.min(),fe.min(),nn.empty(),0)}static newUnknownDocument(e,n){return new yt(e,3,n,fe.min(),fe.min(),nn.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(fe.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=nn.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=nn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=fe.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof yt&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new yt(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ki{constructor(e,n){this.position=e,this.inclusive=n}}function NE(t,e,n){let r=0;for(let i=0;i<t.position.length;i++){const s=e[i],o=t.position[i];if(s.field.isKeyField()?r=Z.comparator(Z.fromName(o.referenceValue),n.key):r=Wi(o,n.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function kE(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!kr(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gc{constructor(e,n="asc"){this.field=e,this.dir=n}}function BO(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vb{}class Ne extends vb{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new $O(e,n,r):n==="array-contains"?new HO(e,r):n==="in"?new Sb(e,r):n==="not-in"?new WO(e,r):n==="array-contains-any"?new KO(e,r):new Ne(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new zO(e,r):new qO(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&n.nullValue===void 0&&this.matchesComparison(Wi(n,this.value)):n!==null&&Hi(this.value)===Hi(n)&&this.matchesComparison(Wi(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return se(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class He extends vb{constructor(e,n){super(),this.filters=e,this.op=n,this.Pe=null}static create(e,n){return new He(e,n)}matches(e){return ga(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function ga(t){return t.op==="and"}function Bm(t){return t.op==="or"}function Ny(t){return wb(t)&&ga(t)}function wb(t){for(const e of t.filters)if(e instanceof He)return!1;return!0}function $m(t){if(t instanceof Ne)return t.field.canonicalString()+t.op.toString()+ma(t.value);if(Ny(t))return t.filters.map(e=>$m(e)).join(",");{const e=t.filters.map(n=>$m(n)).join(",");return`${t.op}(${e})`}}function Eb(t,e){return t instanceof Ne?function(r,i){return i instanceof Ne&&r.op===i.op&&r.field.isEqual(i.field)&&kr(r.value,i.value)}(t,e):t instanceof He?function(r,i){return i instanceof He&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((s,o,a)=>s&&Eb(o,i.filters[a]),!0):!1}(t,e):void se(19439)}function Ib(t,e){const n=t.filters.concat(e);return He.create(n,t.op)}function Tb(t){return t instanceof Ne?function(n){return`${n.field.canonicalString()} ${n.op} ${ma(n.value)}`}(t):t instanceof He?function(n){return n.op.toString()+" {"+n.getFilters().map(Tb).join(" ,")+"}"}(t):"Filter"}class $O extends Ne{constructor(e,n,r){super(e,n,r),this.key=Z.fromName(r.referenceValue)}matches(e){const n=Z.comparator(e.key,this.key);return this.matchesComparison(n)}}class zO extends Ne{constructor(e,n){super(e,"in",n),this.keys=xb("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class qO extends Ne{constructor(e,n){super(e,"not-in",n),this.keys=xb("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function xb(t,e){var n;return(((n=e.arrayValue)==null?void 0:n.values)||[]).map(r=>Z.fromName(r.referenceValue))}class HO extends Ne{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return mc(n)&&pc(n.arrayValue,this.value)}}class Sb extends Ne{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&pc(this.value.arrayValue,n)}}class WO extends Ne{constructor(e,n){super(e,"not-in",n)}matches(e){if(pc(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&n.nullValue===void 0&&!pc(this.value.arrayValue,n)}}class KO extends Ne{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!mc(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>pc(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GO{constructor(e,n=null,r=[],i=[],s=null,o=null,a=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=o,this.endAt=a,this.Te=null}}function zm(t,e=null,n=[],r=[],i=null,s=null,o=null){return new GO(t,e,n,r,i,s,o)}function Hs(t){const e=ve(t);if(e.Te===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>$m(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),Oh(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>ma(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>ma(r)).join(",")),e.Te=n}return e.Te}function Nc(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!BO(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!Eb(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!kE(t.startAt,e.startAt)&&kE(t.endAt,e.endAt)}function zd(t){return Z.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}function qd(t,e){return t.filters.filter(n=>n instanceof Ne&&n.field.isEqual(e))}function DE(t,e,n){let r=Xu,i=!0;for(const s of qd(t,e)){let o=Xu,a=!0;switch(s.op){case"<":case"<=":o=FO(s.value);break;case"==":case"in":case">=":o=s.value;break;case">":o=s.value,a=!1;break;case"!=":case"not-in":o=Xu}RE({value:r,inclusive:i},{value:o,inclusive:a})<0&&(r=o,i=a)}if(n!==null){for(let s=0;s<t.orderBy.length;++s)if(t.orderBy[s].field.isEqual(e)){const o=n.position[s];RE({value:r,inclusive:i},{value:o,inclusive:n.inclusive})<0&&(r=o,i=n.inclusive);break}}return{value:r,inclusive:i}}function jE(t,e,n){let r=Ai,i=!0;for(const s of qd(t,e)){let o=Ai,a=!0;switch(s.op){case">=":case">":o=UO(s.value),a=!1;break;case"==":case"in":case"<=":o=s.value;break;case"<":o=s.value,a=!1;break;case"!=":case"not-in":o=Ai}PE({value:r,inclusive:i},{value:o,inclusive:a})>0&&(r=o,i=a)}if(n!==null){for(let s=0;s<t.orderBy.length;++s)if(t.orderBy[s].field.isEqual(e)){const o=n.position[s];PE({value:r,inclusive:i},{value:o,inclusive:n.inclusive})>0&&(r=o,i=n.inclusive);break}}return{value:r,inclusive:i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ss{constructor(e,n=null,r=[],i=[],s=null,o="F",a=null,l=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=o,this.startAt=a,this.endAt=l,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function QO(t,e,n,r,i,s,o,a){return new ss(t,e,n,r,i,s,o,a)}function kc(t){return new ss(t)}function OE(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function ky(t){return t.collectionGroup!==null}function Yo(t){const e=ve(t);if(e.Ie===null){e.Ie=[];const n=new Set;for(const s of e.explicitOrderBy)e.Ie.push(s),n.add(s.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new Ke(dt.comparator);return o.filters.forEach(l=>{l.getFlattenedFilters().forEach(d=>{d.isInequality()&&(a=a.add(d.field))})}),a})(e).forEach(s=>{n.has(s.canonicalString())||s.isKeyField()||e.Ie.push(new gc(s,r))}),n.has(dt.keyField().canonicalString())||e.Ie.push(new gc(dt.keyField(),r))}return e.Ie}function Wn(t){const e=ve(t);return e.Ee||(e.Ee=bb(e,Yo(t))),e.Ee}function YO(t){const e=ve(t);return e.de||(e.de=bb(e,t.explicitOrderBy)),e.de}function bb(t,e){if(t.limitType==="F")return zm(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(i=>{const s=i.dir==="desc"?"asc":"desc";return new gc(i.field,s)});const n=t.endAt?new Ki(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new Ki(t.startAt.position,t.startAt.inclusive):null;return zm(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function qm(t,e){const n=t.filters.concat([e]);return new ss(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function Hd(t,e,n){return new ss(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function $h(t,e){return Nc(Wn(t),Wn(e))&&t.limitType===e.limitType}function Cb(t){return`${Hs(Wn(t))}|lt:${t.limitType}`}function So(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(i=>Tb(i)).join(", ")}]`),Oh(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(i=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(i)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(i=>ma(i)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(i=>ma(i)).join(",")),`Target(${r})`}(Wn(t))}; limitType=${t.limitType})`}function Dc(t,e){return e.isFoundDocument()&&function(r,i){const s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):Z.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)}(t,e)&&function(r,i){for(const s of Yo(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(t,e)&&function(r,i){for(const s of r.filters)if(!s.matches(i))return!1;return!0}(t,e)&&function(r,i){return!(r.startAt&&!function(o,a,l){const d=NE(o,a,l);return o.inclusive?d<=0:d<0}(r.startAt,Yo(r),i)||r.endAt&&!function(o,a,l){const d=NE(o,a,l);return o.inclusive?d>=0:d>0}(r.endAt,Yo(r),i))}(t,e)}function XO(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function Ab(t){return(e,n)=>{let r=!1;for(const i of Yo(t)){const s=JO(i,e,n);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function JO(t,e,n){const r=t.field.isKeyField()?Z.comparator(e.key,n.key):function(s,o,a){const l=o.data.field(s),d=a.data.field(s);return l!==null&&d!==null?Wi(l,d):se(42886)}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return se(19790,{direction:t.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ti{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,n]);i.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[n]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){is(this.inner,(n,r)=>{for(const[i,s]of r)e(i,s)})}isEmpty(){return cb(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZO=new ct(Z.comparator);function Nn(){return ZO}const Rb=new ct(Z.comparator);function ml(...t){let e=Rb;for(const n of t)e=e.insert(n.key,n);return e}function Pb(t){let e=Rb;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function xr(){return Ll()}function Nb(){return Ll()}function Ll(){return new ti(t=>t.toString(),(t,e)=>t.isEqual(e))}const eV=new ct(Z.comparator),tV=new Ke(Z.comparator);function be(...t){let e=tV;for(const n of t)e=e.add(n);return e}const nV=new Ke(Ee);function rV(){return nV}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dy(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:cc(e)?"-0":e}}function kb(t){return{integerValue:""+t}}function Db(t,e){return cO(e)?kb(e):Dy(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zh{constructor(){this._=void 0}}function iV(t,e,n){return t instanceof ya?function(i,s){const o={fields:{[hb]:{stringValue:db},[pb]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&Fh(s)&&(s=Uh(s)),s&&(o.fields[fb]=s),{mapValue:o}}(n,e):t instanceof Ws?Ob(t,e):t instanceof _a?Vb(t,e):function(i,s){const o=jb(i,s),a=VE(o)+VE(i.Ae);return Um(o)&&Um(i.Ae)?kb(a):Dy(i.serializer,a)}(t,e)}function sV(t,e,n){return t instanceof Ws?Ob(t,e):t instanceof _a?Vb(t,e):n}function jb(t,e){return t instanceof va?function(r){return Um(r)||function(s){return!!s&&"doubleValue"in s}(r)}(e)?e:{integerValue:0}:null}class ya extends zh{}class Ws extends zh{constructor(e){super(),this.elements=e}}function Ob(t,e){const n=Lb(e);for(const r of t.elements)n.some(i=>kr(i,r))||n.push(r);return{arrayValue:{values:n}}}class _a extends zh{constructor(e){super(),this.elements=e}}function Vb(t,e){let n=Lb(e);for(const r of t.elements)n=n.filter(i=>!kr(i,r));return{arrayValue:{values:n}}}class va extends zh{constructor(e,n){super(),this.serializer=e,this.Ae=n}}function VE(t){return ot(t.integerValue||t.doubleValue)}function Lb(t){return mc(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qh{constructor(e,n){this.field=e,this.transform=n}}function oV(t,e){return t.field.isEqual(e.field)&&function(r,i){return r instanceof Ws&&i instanceof Ws||r instanceof _a&&i instanceof _a?ca(r.elements,i.elements,kr):r instanceof va&&i instanceof va?kr(r.Ae,i.Ae):r instanceof ya&&i instanceof ya}(t.transform,e.transform)}class aV{constructor(e,n){this.version=e,this.transformResults=n}}class sn{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new sn}static exists(e){return new sn(void 0,e)}static updateTime(e){return new sn(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function ed(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class Hh{}function Mb(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new Wh(t.key,sn.none()):new Na(t.key,t.data,sn.none());{const n=t.data,r=nn.empty();let i=new Ke(dt.comparator);for(let s of e.fields)if(!i.has(s)){let o=n.field(s);o===null&&s.length>1&&(s=s.popLast(),o=n.field(s)),o===null?r.delete(s):r.set(s,o),i=i.add(s)}return new ni(t.key,r,new En(i.toArray()),sn.none())}}function lV(t,e,n){t instanceof Na?function(i,s,o){const a=i.value.clone(),l=ME(i.fieldTransforms,s,o.transformResults);a.setAll(l),s.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(t,e,n):t instanceof ni?function(i,s,o){if(!ed(i.precondition,s))return void s.convertToUnknownDocument(o.version);const a=ME(i.fieldTransforms,s,o.transformResults),l=s.data;l.setAll(Fb(i)),l.setAll(a),s.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(t,e,n):function(i,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,n)}function Ml(t,e,n,r){return t instanceof Na?function(s,o,a,l){if(!ed(s.precondition,o))return a;const d=s.value.clone(),h=FE(s.fieldTransforms,l,o);return d.setAll(h),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),null}(t,e,n,r):t instanceof ni?function(s,o,a,l){if(!ed(s.precondition,o))return a;const d=FE(s.fieldTransforms,l,o),h=o.data;return h.setAll(Fb(s)),h.setAll(d),o.convertToFoundDocument(o.version,h).setHasLocalMutations(),a===null?null:a.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(f=>f.field))}(t,e,n,r):function(s,o,a){return ed(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(t,e,n)}function cV(t,e){let n=null;for(const r of t.fieldTransforms){const i=e.data.field(r.field),s=jb(r.transform,i||null);s!=null&&(n===null&&(n=nn.empty()),n.set(r.field,s))}return n||null}function LE(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&ca(r,i,(s,o)=>oV(s,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class Na extends Hh{constructor(e,n,r,i=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class ni extends Hh{constructor(e,n,r,i,s=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function Fb(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function ME(t,e,n){const r=new Map;ae(t.length===n.length,32656,{Re:n.length,Ve:t.length});for(let i=0;i<n.length;i++){const s=t[i],o=s.transform,a=e.data.field(s.field);r.set(s.field,sV(o,a,n[i]))}return r}function FE(t,e,n){const r=new Map;for(const i of t){const s=i.transform,o=n.data.field(i.field);r.set(i.field,iV(s,o,e))}return r}class Wh extends Hh{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Ub extends Hh{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jy{constructor(e,n,r,i){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(e.key)&&lV(s,e,r[i])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=Ml(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=Ml(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=Nb();return this.mutations.forEach(i=>{const s=e.get(i.key),o=s.overlayedDocument;let a=this.applyToLocalView(o,s.mutatedFields);a=n.has(i.key)?null:a;const l=Mb(o,a);l!==null&&r.set(i.key,l),o.isValidDocument()||o.convertToNoDocument(fe.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),be())}isEqual(e){return this.batchId===e.batchId&&ca(this.mutations,e.mutations,(n,r)=>LE(n,r))&&ca(this.baseMutations,e.baseMutations,(n,r)=>LE(n,r))}}class Oy{constructor(e,n,r,i){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=i}static from(e,n,r){ae(e.mutations.length===r.length,58842,{me:e.mutations.length,fe:r.length});let i=function(){return eV}();const s=e.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,r[o].version);return new Oy(e,n,r,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vy{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uV{constructor(e,n,r){this.alias=e,this.aggregateType=n,this.fieldPath=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dV{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var bt,Ve;function hV(t){switch(t){case U.OK:return se(64938);case U.CANCELLED:case U.UNKNOWN:case U.DEADLINE_EXCEEDED:case U.RESOURCE_EXHAUSTED:case U.INTERNAL:case U.UNAVAILABLE:case U.UNAUTHENTICATED:return!1;case U.INVALID_ARGUMENT:case U.NOT_FOUND:case U.ALREADY_EXISTS:case U.PERMISSION_DENIED:case U.FAILED_PRECONDITION:case U.ABORTED:case U.OUT_OF_RANGE:case U.UNIMPLEMENTED:case U.DATA_LOSS:return!0;default:return se(15467,{code:t})}}function Bb(t){if(t===void 0)return dn("GRPC error has no .code"),U.UNKNOWN;switch(t){case bt.OK:return U.OK;case bt.CANCELLED:return U.CANCELLED;case bt.UNKNOWN:return U.UNKNOWN;case bt.DEADLINE_EXCEEDED:return U.DEADLINE_EXCEEDED;case bt.RESOURCE_EXHAUSTED:return U.RESOURCE_EXHAUSTED;case bt.INTERNAL:return U.INTERNAL;case bt.UNAVAILABLE:return U.UNAVAILABLE;case bt.UNAUTHENTICATED:return U.UNAUTHENTICATED;case bt.INVALID_ARGUMENT:return U.INVALID_ARGUMENT;case bt.NOT_FOUND:return U.NOT_FOUND;case bt.ALREADY_EXISTS:return U.ALREADY_EXISTS;case bt.PERMISSION_DENIED:return U.PERMISSION_DENIED;case bt.FAILED_PRECONDITION:return U.FAILED_PRECONDITION;case bt.ABORTED:return U.ABORTED;case bt.OUT_OF_RANGE:return U.OUT_OF_RANGE;case bt.UNIMPLEMENTED:return U.UNIMPLEMENTED;case bt.DATA_LOSS:return U.DATA_LOSS;default:return se(39323,{code:t})}}(Ve=bt||(bt={}))[Ve.OK=0]="OK",Ve[Ve.CANCELLED=1]="CANCELLED",Ve[Ve.UNKNOWN=2]="UNKNOWN",Ve[Ve.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ve[Ve.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ve[Ve.NOT_FOUND=5]="NOT_FOUND",Ve[Ve.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ve[Ve.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ve[Ve.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ve[Ve.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ve[Ve.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ve[Ve.ABORTED=10]="ABORTED",Ve[Ve.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ve[Ve.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ve[Ve.INTERNAL=13]="INTERNAL",Ve[Ve.UNAVAILABLE=14]="UNAVAILABLE",Ve[Ve.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fV(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pV=new Ui([4294967295,4294967295],0);function UE(t){const e=fV().encode(t),n=new MS;return n.update(e),new Uint8Array(n.digest())}function BE(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new Ui([n,r],0),new Ui([i,s],0)]}class Ly{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new gl(`Invalid padding: ${n}`);if(r<0)throw new gl(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new gl(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new gl(`Invalid padding when bitmap length is 0: ${n}`);this.ge=8*e.length-n,this.pe=Ui.fromNumber(this.ge)}ye(e,n,r){let i=e.add(n.multiply(Ui.fromNumber(r)));return i.compare(pV)===1&&(i=new Ui([i.getBits(0),i.getBits(1)],0)),i.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const n=UE(e),[r,i]=BE(n);for(let s=0;s<this.hashCount;s++){const o=this.ye(r,i,s);if(!this.we(o))return!1}return!0}static create(e,n,r){const i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new Ly(s,i,n);return r.forEach(a=>o.insert(a)),o}insert(e){if(this.ge===0)return;const n=UE(e),[r,i]=BE(n);for(let s=0;s<this.hashCount;s++){const o=this.ye(r,i,s);this.Se(o)}}Se(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class gl extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kh{constructor(e,n,r,i,s){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const i=new Map;return i.set(e,jc.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new Kh(fe.min(),i,new ct(Ee),Nn(),be())}}class jc{constructor(e,n,r,i,s){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new jc(r,n,be(),be(),be())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class td{constructor(e,n,r,i){this.be=e,this.removedTargetIds=n,this.key=r,this.De=i}}class $b{constructor(e,n){this.targetId=e,this.Ce=n}}class zb{constructor(e,n,r=Rt.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=i}}class $E{constructor(){this.ve=0,this.Fe=zE(),this.Me=Rt.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=be(),n=be(),r=be();return this.Fe.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:n=n.add(i);break;case 1:r=r.add(i);break;default:se(38017,{changeType:s})}}),new jc(this.Me,this.xe,e,n,r)}qe(){this.Oe=!1,this.Fe=zE()}Qe(e,n){this.Oe=!0,this.Fe=this.Fe.insert(e,n)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,ae(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class mV{constructor(e){this.Ge=e,this.ze=new Map,this.je=Nn(),this.Je=wu(),this.He=wu(),this.Ye=new ct(Ee)}Ze(e){for(const n of e.be)e.De&&e.De.isFoundDocument()?this.Xe(n,e.De):this.et(n,e.key,e.De);for(const n of e.removedTargetIds)this.et(n,e.key,e.De)}tt(e){this.forEachTarget(e,n=>{const r=this.nt(n);switch(e.state){case 0:this.rt(n)&&r.Le(e.resumeToken);break;case 1:r.Ke(),r.Ne||r.qe(),r.Le(e.resumeToken);break;case 2:r.Ke(),r.Ne||this.removeTarget(n);break;case 3:this.rt(n)&&(r.We(),r.Le(e.resumeToken));break;case 4:this.rt(n)&&(this.it(n),r.Le(e.resumeToken));break;default:se(56790,{state:e.state})}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.ze.forEach((r,i)=>{this.rt(i)&&n(i)})}st(e){const n=e.targetId,r=e.Ce.count,i=this.ot(n);if(i){const s=i.target;if(zd(s))if(r===0){const o=new Z(s.path);this.et(n,o,yt.newNoDocument(o,fe.min()))}else ae(r===1,20013,{expectedCount:r});else{const o=this._t(n);if(o!==r){const a=this.ut(e),l=a?this.ct(a,e,o):1;if(l!==0){this.it(n);const d=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(n,d)}}}}}ut(e){const n=e.Ce.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=n;let o,a;try{o=Zr(r).toUint8Array()}catch(l){if(l instanceof ub)return $s("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{a=new Ly(o,i,s)}catch(l){return $s(l instanceof gl?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return a.ge===0?null:a}ct(e,n,r){return n.Ce.count===r-this.Pt(e,n.targetId)?0:2}Pt(e,n){const r=this.Ge.getRemoteKeysForTarget(n);let i=0;return r.forEach(s=>{const o=this.Ge.ht(),a=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(a)||(this.et(n,s,null),i++)}),i}Tt(e){const n=new Map;this.ze.forEach((s,o)=>{const a=this.ot(o);if(a){if(s.current&&zd(a.target)){const l=new Z(a.target.path);this.It(l).has(o)||this.Et(o,l)||this.et(o,l,yt.newNoDocument(l,e))}s.Be&&(n.set(o,s.ke()),s.qe())}});let r=be();this.He.forEach((s,o)=>{let a=!0;o.forEachWhile(l=>{const d=this.ot(l);return!d||d.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(s))}),this.je.forEach((s,o)=>o.setReadTime(e));const i=new Kh(e,n,this.Ye,this.je,r);return this.je=Nn(),this.Je=wu(),this.He=wu(),this.Ye=new ct(Ee),i}Xe(e,n){if(!this.rt(e))return;const r=this.Et(e,n.key)?2:0;this.nt(e).Qe(n.key,r),this.je=this.je.insert(n.key,n),this.Je=this.Je.insert(n.key,this.It(n.key).add(e)),this.He=this.He.insert(n.key,this.dt(n.key).add(e))}et(e,n,r){if(!this.rt(e))return;const i=this.nt(e);this.Et(e,n)?i.Qe(n,1):i.$e(n),this.He=this.He.insert(n,this.dt(n).delete(e)),this.He=this.He.insert(n,this.dt(n).add(e)),r&&(this.je=this.je.insert(n,r))}removeTarget(e){this.ze.delete(e)}_t(e){const n=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let n=this.ze.get(e);return n||(n=new $E,this.ze.set(e,n)),n}dt(e){let n=this.He.get(e);return n||(n=new Ke(Ee),this.He=this.He.insert(e,n)),n}It(e){let n=this.Je.get(e);return n||(n=new Ke(Ee),this.Je=this.Je.insert(e,n)),n}rt(e){const n=this.ot(e)!==null;return n||H("WatchChangeAggregator","Detected inactive target",e),n}ot(e){const n=this.ze.get(e);return n&&n.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new $E),this.Ge.getRemoteKeysForTarget(e).forEach(n=>{this.et(e,n,null)})}Et(e,n){return this.Ge.getRemoteKeysForTarget(e).has(n)}}function wu(){return new ct(Z.comparator)}function zE(){return new ct(Z.comparator)}const gV={asc:"ASCENDING",desc:"DESCENDING"},yV={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},_V={and:"AND",or:"OR"};class vV{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function Hm(t,e){return t.useProto3Json||Oh(e)?e:{value:e}}function wa(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function qb(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function wV(t,e){return wa(t,e.toTimestamp())}function pn(t){return ae(!!t,49232),fe.fromTimestamp(function(n){const r=Jr(n);return new Le(r.seconds,r.nanos)}(t))}function My(t,e){return Wm(t,e).canonicalString()}function Wm(t,e){const n=function(i){return new Ue(["projects",i.projectId,"databases",i.database])}(t).child("documents");return e===void 0?n:n.child(e)}function Hb(t){const e=Ue.fromString(t);return ae(Zb(e),10190,{key:e.toString()}),e}function Wd(t,e){return My(t.databaseId,e.path)}function Ns(t,e){const n=Hb(e);if(n.get(1)!==t.databaseId.projectId)throw new K(U.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new K(U.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new Z(Gb(n))}function Wb(t,e){return My(t.databaseId,e)}function Kb(t){const e=Hb(t);return e.length===4?Ue.emptyPath():Gb(e)}function Km(t){return new Ue(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function Gb(t){return ae(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function qE(t,e,n){return{name:Wd(t,e),fields:n.value.mapValue.fields}}function EV(t,e,n){const r=Ns(t,e.name),i=pn(e.updateTime),s=e.createTime?pn(e.createTime):fe.min(),o=new nn({mapValue:{fields:e.fields}}),a=yt.newFoundDocument(r,i,s,o);return n&&a.setHasCommittedMutations(),n?a.setHasCommittedMutations():a}function IV(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(d){return d==="NO_CHANGE"?0:d==="ADD"?1:d==="REMOVE"?2:d==="CURRENT"?3:d==="RESET"?4:se(39313,{state:d})}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(d,h){return d.useProto3Json?(ae(h===void 0||typeof h=="string",58123),Rt.fromBase64String(h||"")):(ae(h===void 0||h instanceof Buffer||h instanceof Uint8Array,16193),Rt.fromUint8Array(h||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(d){const h=d.code===void 0?U.UNKNOWN:Bb(d.code);return new K(h,d.message||"")}(o);n=new zb(r,i,s,a||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const i=Ns(t,r.document.name),s=pn(r.document.updateTime),o=r.document.createTime?pn(r.document.createTime):fe.min(),a=new nn({mapValue:{fields:r.document.fields}}),l=yt.newFoundDocument(i,s,o,a),d=r.targetIds||[],h=r.removedTargetIds||[];n=new td(d,h,l.key,l)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const i=Ns(t,r.document),s=r.readTime?pn(r.readTime):fe.min(),o=yt.newNoDocument(i,s),a=r.removedTargetIds||[];n=new td([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const i=Ns(t,r.document),s=r.removedTargetIds||[];n=new td([],s,i,null)}else{if(!("filter"in e))return se(11601,{Rt:e});{e.filter;const r=e.filter;r.targetId;const{count:i=0,unchangedNames:s}=r,o=new dV(i,s),a=r.targetId;n=new $b(a,o)}}return n}function Kd(t,e){let n;if(e instanceof Na)n={update:qE(t,e.key,e.value)};else if(e instanceof Wh)n={delete:Wd(t,e.key)};else if(e instanceof ni)n={update:qE(t,e.key,e.data),updateMask:RV(e.fieldMask)};else{if(!(e instanceof Ub))return se(16599,{Vt:e.type});n={verify:Wd(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(s,o){const a=o.transform;if(a instanceof ya)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof Ws)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof _a)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof va)return{fieldPath:o.field.canonicalString(),increment:a.Ae};throw se(20930,{transform:o.transform})}(0,r))),e.precondition.isNone||(n.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:wV(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:se(27497)}(t,e.precondition)),n}function Gm(t,e){const n=e.currentDocument?function(s){return s.updateTime!==void 0?sn.updateTime(pn(s.updateTime)):s.exists!==void 0?sn.exists(s.exists):sn.none()}(e.currentDocument):sn.none(),r=e.updateTransforms?e.updateTransforms.map(i=>function(o,a){let l=null;if("setToServerValue"in a)ae(a.setToServerValue==="REQUEST_TIME",16630,{proto:a}),l=new ya;else if("appendMissingElements"in a){const h=a.appendMissingElements.values||[];l=new Ws(h)}else if("removeAllFromArray"in a){const h=a.removeAllFromArray.values||[];l=new _a(h)}else"increment"in a?l=new va(o,a.increment):se(16584,{proto:a});const d=dt.fromServerFormat(a.fieldPath);return new qh(d,l)}(t,i)):[];if(e.update){e.update.name;const i=Ns(t,e.update.name),s=new nn({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=function(l){const d=l.fieldPaths||[];return new En(d.map(h=>dt.fromServerFormat(h)))}(e.updateMask);return new ni(i,s,o,n,r)}return new Na(i,s,n,r)}if(e.delete){const i=Ns(t,e.delete);return new Wh(i,n)}if(e.verify){const i=Ns(t,e.verify);return new Ub(i,n)}return se(1463,{proto:e})}function TV(t,e){return t&&t.length>0?(ae(e!==void 0,14353),t.map(n=>function(i,s){let o=i.updateTime?pn(i.updateTime):pn(s);return o.isEqual(fe.min())&&(o=pn(s)),new aV(o,i.transformResults||[])}(n,e))):[]}function Qb(t,e){return{documents:[Wb(t,e.path)]}}function Fy(t,e){const n={structuredQuery:{}},r=e.path;let i;e.collectionGroup!==null?(i=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=Wb(t,i);const s=function(d){if(d.length!==0)return Jb(He.create(d,"and"))}(e.filters);s&&(n.structuredQuery.where=s);const o=function(d){if(d.length!==0)return d.map(h=>function(m){return{field:Ti(m.field),direction:bV(m.dir)}}(h))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);const a=Hm(t,e.limit);return a!==null&&(n.structuredQuery.limit=a),e.startAt&&(n.structuredQuery.startAt=function(d){return{before:d.inclusive,values:d.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(d){return{before:!d.inclusive,values:d.position}}(e.endAt)),{ft:n,parent:i}}function xV(t,e,n,r){const{ft:i,parent:s}=Fy(t,e),o={},a=[];let l=0;return n.forEach(d=>{const h="aggregate_"+l++;o[h]=d.alias,d.aggregateType==="count"?a.push({alias:h,count:{}}):d.aggregateType==="avg"?a.push({alias:h,avg:{field:Ti(d.fieldPath)}}):d.aggregateType==="sum"&&a.push({alias:h,sum:{field:Ti(d.fieldPath)}})}),{request:{structuredAggregationQuery:{aggregations:a,structuredQuery:i.structuredQuery},parent:i.parent},gt:o,parent:s}}function Yb(t){let e=Kb(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let i=null;if(r>0){ae(r===1,65062);const h=n.from[0];h.allDescendants?i=h.collectionId:e=e.child(h.collectionId)}let s=[];n.where&&(s=function(f){const m=Xb(f);return m instanceof He&&Ny(m)?m.getFilters():[m]}(n.where));let o=[];n.orderBy&&(o=function(f){return f.map(m=>function(R){return new gc(bo(R.field),function(y){switch(y){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(R.direction))}(m))}(n.orderBy));let a=null;n.limit&&(a=function(f){let m;return m=typeof f=="object"?f.value:f,Oh(m)?null:m}(n.limit));let l=null;n.startAt&&(l=function(f){const m=!!f.before,_=f.values||[];return new Ki(_,m)}(n.startAt));let d=null;return n.endAt&&(d=function(f){const m=!f.before,_=f.values||[];return new Ki(_,m)}(n.endAt)),QO(e,i,o,s,a,"F",l,d)}function SV(t,e){const n=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return se(28987,{purpose:i})}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function Xb(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=bo(n.unaryFilter.field);return Ne.create(r,"==",{doubleValue:NaN});case"IS_NULL":const i=bo(n.unaryFilter.field);return Ne.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=bo(n.unaryFilter.field);return Ne.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=bo(n.unaryFilter.field);return Ne.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return se(61313);default:return se(60726)}}(t):t.fieldFilter!==void 0?function(n){return Ne.create(bo(n.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return se(58110);default:return se(50506)}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return He.create(n.compositeFilter.filters.map(r=>Xb(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return se(1026)}}(n.compositeFilter.op))}(t):se(30097,{filter:t})}function bV(t){return gV[t]}function CV(t){return yV[t]}function AV(t){return _V[t]}function Ti(t){return{fieldPath:t.canonicalString()}}function bo(t){return dt.fromServerFormat(t.fieldPath)}function Jb(t){return t instanceof Ne?function(n){if(n.op==="=="){if(AE(n.value))return{unaryFilter:{field:Ti(n.field),op:"IS_NAN"}};if(CE(n.value))return{unaryFilter:{field:Ti(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(AE(n.value))return{unaryFilter:{field:Ti(n.field),op:"IS_NOT_NAN"}};if(CE(n.value))return{unaryFilter:{field:Ti(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Ti(n.field),op:CV(n.op),value:n.value}}}(t):t instanceof He?function(n){const r=n.getFilters().map(i=>Jb(i));return r.length===1?r[0]:{compositeFilter:{op:AV(n.op),filters:r}}}(t):se(54877,{filter:t})}function RV(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function Zb(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Br{constructor(e,n,r,i,s=fe.min(),o=fe.min(),a=Rt.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=l}withSequenceNumber(e){return new Br(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new Br(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Br(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Br(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eC{constructor(e){this.yt=e}}function PV(t,e){let n;if(e.document)n=EV(t.yt,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=Z.fromSegments(e.noDocument.path),i=Gs(e.noDocument.readTime);n=yt.newNoDocument(r,i),e.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!e.unknownDocument)return se(56709);{const r=Z.fromSegments(e.unknownDocument.path),i=Gs(e.unknownDocument.version);n=yt.newUnknownDocument(r,i)}}return e.readTime&&n.setReadTime(function(i){const s=new Le(i[0],i[1]);return fe.fromTimestamp(s)}(e.readTime)),n}function HE(t,e){const n=e.key,r={prefixPath:n.getCollectionPath().popLast().toArray(),collectionGroup:n.collectionGroup,documentId:n.path.lastSegment(),readTime:Gd(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=function(s,o){return{name:Wd(s,o.key),fields:o.data.value.mapValue.fields,updateTime:wa(s,o.version.toTimestamp()),createTime:wa(s,o.createTime.toTimestamp())}}(t.yt,e);else if(e.isNoDocument())r.noDocument={path:n.path.toArray(),readTime:Ks(e.version)};else{if(!e.isUnknownDocument())return se(57904,{document:e});r.unknownDocument={path:n.path.toArray(),version:Ks(e.version)}}return r}function Gd(t){const e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function Ks(t){const e=t.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function Gs(t){const e=new Le(t.seconds,t.nanoseconds);return fe.fromTimestamp(e)}function _s(t,e){const n=(e.baseMutations||[]).map(s=>Gm(t.yt,s));for(let s=0;s<e.mutations.length-1;++s){const o=e.mutations[s];if(s+1<e.mutations.length&&e.mutations[s+1].transform!==void 0){const a=e.mutations[s+1];o.updateTransforms=a.transform.fieldTransforms,e.mutations.splice(s+1,1),++s}}const r=e.mutations.map(s=>Gm(t.yt,s)),i=Le.fromMillis(e.localWriteTimeMs);return new jy(e.batchId,i,n,r)}function yl(t){const e=Gs(t.readTime),n=t.lastLimboFreeSnapshotVersion!==void 0?Gs(t.lastLimboFreeSnapshotVersion):fe.min();let r;return r=function(s){return s.documents!==void 0}(t.query)?function(s){const o=s.documents.length;return ae(o===1,1966,{count:o}),Wn(kc(Kb(s.documents[0])))}(t.query):function(s){return Wn(Yb(s))}(t.query),new Br(r,t.targetId,"TargetPurposeListen",t.lastListenSequenceNumber,e,n,Rt.fromBase64String(t.resumeToken))}function tC(t,e){const n=Ks(e.snapshotVersion),r=Ks(e.lastLimboFreeSnapshotVersion);let i;i=zd(e.target)?Qb(t.yt,e.target):Fy(t.yt,e.target).ft;const s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Hs(e.target),readTime:n,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function nC(t){const e=Yb({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?Hd(e,e.limit,"L"):e}function up(t,e){return new Vy(e.largestBatchId,Gm(t.yt,e.overlayMutation))}function WE(t,e){const n=e.path.lastSegment();return[t,an(e.path.popLast()),n]}function KE(t,e,n,r){return{indexId:t,uid:e,sequenceNumber:n,readTime:Ks(r.readTime),documentKey:an(r.documentKey.path),largestBatchId:r.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NV{getBundleMetadata(e,n){return GE(e).get(n).next(r=>{if(r)return function(s){return{id:s.bundleId,createTime:Gs(s.createTime),version:s.version}}(r)})}saveBundleMetadata(e,n){return GE(e).put(function(i){return{bundleId:i.id,createTime:Ks(pn(i.createTime)),version:i.version}}(n))}getNamedQuery(e,n){return QE(e).get(n).next(r=>{if(r)return function(s){return{name:s.name,query:nC(s.bundledQuery),readTime:Gs(s.readTime)}}(r)})}saveNamedQuery(e,n){return QE(e).put(function(i){return{name:i.name,readTime:Ks(pn(i.readTime)),bundledQuery:i.bundledQuery}}(n))}}function GE(t){return Vt(t,Vh)}function QE(t){return Vt(t,Lh)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gh{constructor(e,n){this.serializer=e,this.userId=n}static wt(e,n){const r=n.uid||"";return new Gh(e,r)}getOverlay(e,n){return tl(e).get(WE(this.userId,n)).next(r=>r?up(this.serializer,r):null)}getOverlays(e,n){const r=xr();return L.forEach(n,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,n,r){const i=[];return r.forEach((s,o)=>{const a=new Vy(n,o);i.push(this.St(e,a))}),L.waitFor(i)}removeOverlaysForBatchId(e,n,r){const i=new Set;n.forEach(o=>i.add(an(o.getCollectionPath())));const s=[];return i.forEach(o=>{const a=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,r+1],!1,!0);s.push(tl(e).Z(Lm,a))}),L.waitFor(s)}getOverlaysForCollection(e,n,r){const i=xr(),s=an(n),o=IDBKeyRange.bound([this.userId,s,r],[this.userId,s,Number.POSITIVE_INFINITY],!0);return tl(e).J(Lm,o).next(a=>{for(const l of a){const d=up(this.serializer,l);i.set(d.getKey(),d)}return i})}getOverlaysForCollectionGroup(e,n,r,i){const s=xr();let o;const a=IDBKeyRange.bound([this.userId,n,r],[this.userId,n,Number.POSITIVE_INFINITY],!0);return tl(e).ee({index:ib,range:a},(l,d,h)=>{const f=up(this.serializer,d);s.size()<i||f.largestBatchId===o?(s.set(f.getKey(),f),o=f.largestBatchId):h.done()}).next(()=>s)}St(e,n){return tl(e).put(function(i,s,o){const[a,l,d]=WE(s,o.mutation.key);return{userId:s,collectionPath:l,documentId:d,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:Kd(i.yt,o.mutation)}}(this.serializer,this.userId,n))}}function tl(t){return Vt(t,Mh)}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kV{bt(e){return Vt(e,Cy)}getSessionToken(e){return this.bt(e).get("sessionToken").next(n=>{const r=n==null?void 0:n.value;return r?Rt.fromUint8Array(r):Rt.EMPTY_BYTE_STRING})}setSessionToken(e,n){return this.bt(e).put({name:"sessionToken",value:n.toUint8Array()})}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vs{constructor(){}Dt(e,n){this.Ct(e,n),n.vt()}Ct(e,n){if("nullValue"in e)this.Ft(n,5);else if("booleanValue"in e)this.Ft(n,10),n.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(n,15),n.Mt(ot(e.integerValue));else if("doubleValue"in e){const r=ot(e.doubleValue);isNaN(r)?this.Ft(n,13):(this.Ft(n,15),cc(r)?n.Mt(0):n.Mt(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Ft(n,20),typeof r=="string"&&(r=Jr(r)),n.xt(`${r.seconds||""}`),n.Mt(r.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,n),this.Nt(n);else if("bytesValue"in e)this.Ft(n,30),n.Bt(Zr(e.bytesValue)),this.Nt(n);else if("referenceValue"in e)this.Lt(e.referenceValue,n);else if("geoPointValue"in e){const r=e.geoPointValue;this.Ft(n,45),n.Mt(r.latitude||0),n.Mt(r.longitude||0)}else"mapValue"in e?gb(e)?this.Ft(n,Number.MAX_SAFE_INTEGER):Bh(e)?this.kt(e.mapValue,n):(this.qt(e.mapValue,n),this.Nt(n)):"arrayValue"in e?(this.Qt(e.arrayValue,n),this.Nt(n)):se(19022,{$t:e})}Ot(e,n){this.Ft(n,25),this.Ut(e,n)}Ut(e,n){n.xt(e)}qt(e,n){const r=e.fields||{};this.Ft(n,55);for(const i of Object.keys(r))this.Ot(i,n),this.Ct(r[i],n)}kt(e,n){var o,a;const r=e.fields||{};this.Ft(n,53);const i=pa,s=((a=(o=r[i].arrayValue)==null?void 0:o.values)==null?void 0:a.length)||0;this.Ft(n,15),n.Mt(ot(s)),this.Ot(i,n),this.Ct(r[i],n)}Qt(e,n){const r=e.values||[];this.Ft(n,50);for(const i of r)this.Ct(i,n)}Lt(e,n){this.Ft(n,37),Z.fromName(e).path.forEach(r=>{this.Ft(n,60),this.Ut(r,n)})}Ft(e,n){e.Mt(n)}Nt(e){e.Mt(2)}}vs.Kt=new vs;/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law | agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES | CONDITIONS OF ANY KIND, either express | implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const po=255;function DV(t){if(t===0)return 8;let e=0;return t>>4||(e+=4,t<<=4),t>>6||(e+=2,t<<=2),t>>7||(e+=1),e}function YE(t){const e=64-function(r){let i=0;for(let s=0;s<8;++s){const o=DV(255&r[s]);if(i+=o,o!==8)break}return i}(t);return Math.ceil(e/8)}class jV{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Wt(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.Gt(r.value),r=n.next();this.zt()}jt(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.Jt(r.value),r=n.next();this.Ht()}Yt(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.Gt(r);else if(r<2048)this.Gt(960|r>>>6),this.Gt(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Gt(480|r>>>12),this.Gt(128|63&r>>>6),this.Gt(128|63&r);else{const i=n.codePointAt(0);this.Gt(240|i>>>18),this.Gt(128|63&i>>>12),this.Gt(128|63&i>>>6),this.Gt(128|63&i)}}this.zt()}Zt(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.Jt(r);else if(r<2048)this.Jt(960|r>>>6),this.Jt(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Jt(480|r>>>12),this.Jt(128|63&r>>>6),this.Jt(128|63&r);else{const i=n.codePointAt(0);this.Jt(240|i>>>18),this.Jt(128|63&i>>>12),this.Jt(128|63&i>>>6),this.Jt(128|63&i)}}this.Ht()}Xt(e){const n=this.en(e),r=YE(n);this.tn(1+r),this.buffer[this.position++]=255&r;for(let i=n.length-r;i<n.length;++i)this.buffer[this.position++]=255&n[i]}nn(e){const n=this.en(e),r=YE(n);this.tn(1+r),this.buffer[this.position++]=~(255&r);for(let i=n.length-r;i<n.length;++i)this.buffer[this.position++]=~(255&n[i])}rn(){this.sn(po),this.sn(255)}_n(){this.an(po),this.an(255)}reset(){this.position=0}seed(e){this.tn(e.length),this.buffer.set(e,this.position),this.position+=e.length}un(){return this.buffer.slice(0,this.position)}en(e){const n=function(s){const o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,s,!1),new Uint8Array(o.buffer)}(e),r=!!(128&n[0]);n[0]^=r?255:128;for(let i=1;i<n.length;++i)n[i]^=r?255:0;return n}Gt(e){const n=255&e;n===0?(this.sn(0),this.sn(255)):n===po?(this.sn(po),this.sn(0)):this.sn(n)}Jt(e){const n=255&e;n===0?(this.an(0),this.an(255)):n===po?(this.an(po),this.an(0)):this.an(e)}zt(){this.sn(0),this.sn(1)}Ht(){this.an(0),this.an(1)}sn(e){this.tn(1),this.buffer[this.position++]=e}an(e){this.tn(1),this.buffer[this.position++]=~e}tn(e){const n=e+this.position;if(n<=this.buffer.length)return;let r=2*this.buffer.length;r<n&&(r=n);const i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}}class OV{constructor(e){this.cn=e}Bt(e){this.cn.Wt(e)}xt(e){this.cn.Yt(e)}Mt(e){this.cn.Xt(e)}vt(){this.cn.rn()}}class VV{constructor(e){this.cn=e}Bt(e){this.cn.jt(e)}xt(e){this.cn.Zt(e)}Mt(e){this.cn.nn(e)}vt(){this.cn._n()}}class nl{constructor(){this.cn=new jV,this.ln=new OV(this.cn),this.hn=new VV(this.cn)}seed(e){this.cn.seed(e)}Pn(e){return e===0?this.ln:this.hn}un(){return this.cn.un()}reset(){this.cn.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ws{constructor(e,n,r,i){this.Tn=e,this.In=n,this.En=r,this.dn=i}An(){const e=this.dn.length,n=e===0||this.dn[e-1]===255?e+1:e,r=new Uint8Array(n);return r.set(this.dn,0),n!==e?r.set([0],this.dn.length):++r[r.length-1],new ws(this.Tn,this.In,this.En,r)}Rn(e,n,r){return{indexId:this.Tn,uid:e,arrayValue:nd(this.En),directionalValue:nd(this.dn),orderedDocumentKey:nd(n),documentKey:r.path.toArray()}}Vn(e,n,r){const i=this.Rn(e,n,r);return[i.indexId,i.uid,i.arrayValue,i.directionalValue,i.orderedDocumentKey,i.documentKey]}}function hi(t,e){let n=t.Tn-e.Tn;return n!==0?n:(n=XE(t.En,e.En),n!==0?n:(n=XE(t.dn,e.dn),n!==0?n:Z.comparator(t.In,e.In)))}function XE(t,e){for(let n=0;n<t.length&&n<e.length;++n){const r=t[n]-e[n];if(r!==0)return r}return t.length-e.length}function nd(t){return Yx()?function(n){let r="";for(let i=0;i<n.length;i++)r+=String.fromCharCode(n[i]);return r}(t):t}function JE(t){return typeof t!="string"?t:function(n){const r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}(t)}class ZE{constructor(e){this.mn=new Ke((n,r)=>dt.comparator(n.field,r.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.fn=e.orderBy,this.gn=[];for(const n of e.filters){const r=n;r.isInequality()?this.mn=this.mn.add(r):this.gn.push(r)}}get pn(){return this.mn.size>1}yn(e){if(ae(e.collectionGroup===this.collectionId,49279),this.pn)return!1;const n=jm(e);if(n!==void 0&&!this.wn(n))return!1;const r=ms(e);let i=new Set,s=0,o=0;for(;s<r.length&&this.wn(r[s]);++s)i=i.add(r[s].fieldPath.canonicalString());if(s===r.length)return!0;if(this.mn.size>0){const a=this.mn.getIterator().getNext();if(!i.has(a.field.canonicalString())){const l=r[s];if(!this.Sn(a,l)||!this.bn(this.fn[o++],l))return!1}++s}for(;s<r.length;++s){const a=r[s];if(o>=this.fn.length||!this.bn(this.fn[o++],a))return!1}return!0}Dn(){if(this.pn)return null;let e=new Ke(dt.comparator);const n=[];for(const r of this.gn)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")n.push(new Gu(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),n.push(new Gu(r.field,0))}for(const r of this.fn)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),n.push(new Gu(r.field,r.dir==="asc"?0:1)));return new Md(Md.UNKNOWN_ID,this.collectionId,n,lc.empty())}wn(e){for(const n of this.gn)if(this.Sn(n,e))return!0;return!1}Sn(e,n){if(e===void 0||!e.field.isEqual(n.fieldPath))return!1;const r=e.op==="array-contains"||e.op==="array-contains-any";return n.kind===2===r}bn(e,n){return!!e.field.isEqual(n.fieldPath)&&(n.kind===0&&e.dir==="asc"||n.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rC(t){var n,r;if(ae(t instanceof Ne||t instanceof He,20012),t instanceof Ne){if(t instanceof Sb){const i=((r=(n=t.value.arrayValue)==null?void 0:n.values)==null?void 0:r.map(s=>Ne.create(t.field,"==",s)))||[];return He.create(i,"or")}return t}const e=t.filters.map(i=>rC(i));return He.create(e,t.op)}function LV(t){if(t.getFilters().length===0)return[];const e=Xm(rC(t));return ae(iC(e),7391),Qm(e)||Ym(e)?[e]:e.getFilters()}function Qm(t){return t instanceof Ne}function Ym(t){return t instanceof He&&Ny(t)}function iC(t){return Qm(t)||Ym(t)||function(n){if(n instanceof He&&Bm(n)){for(const r of n.getFilters())if(!Qm(r)&&!Ym(r))return!1;return!0}return!1}(t)}function Xm(t){if(ae(t instanceof Ne||t instanceof He,34018),t instanceof Ne)return t;if(t.filters.length===1)return Xm(t.filters[0]);const e=t.filters.map(r=>Xm(r));let n=He.create(e,t.op);return n=Qd(n),iC(n)?n:(ae(n instanceof He,64498),ae(ga(n),40251),ae(n.filters.length>1,57927),n.filters.reduce((r,i)=>Uy(r,i)))}function Uy(t,e){let n;return ae(t instanceof Ne||t instanceof He,38388),ae(e instanceof Ne||e instanceof He,25473),n=t instanceof Ne?e instanceof Ne?function(i,s){return He.create([i,s],"and")}(t,e):eI(t,e):e instanceof Ne?eI(e,t):function(i,s){if(ae(i.filters.length>0&&s.filters.length>0,48005),ga(i)&&ga(s))return Ib(i,s.getFilters());const o=Bm(i)?i:s,a=Bm(i)?s:i,l=o.filters.map(d=>Uy(d,a));return He.create(l,"or")}(t,e),Qd(n)}function eI(t,e){if(ga(e))return Ib(e,t.getFilters());{const n=e.filters.map(r=>Uy(t,r));return He.create(n,"or")}}function Qd(t){if(ae(t instanceof Ne||t instanceof He,11850),t instanceof Ne)return t;const e=t.getFilters();if(e.length===1)return Qd(e[0]);if(wb(t))return t;const n=e.map(i=>Qd(i)),r=[];return n.forEach(i=>{i instanceof Ne?r.push(i):i instanceof He&&(i.op===t.op?r.push(...i.filters):r.push(i))}),r.length===1?r[0]:He.create(r,t.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MV{constructor(){this.Cn=new By}addToCollectionParentIndex(e,n){return this.Cn.add(n),L.resolve()}getCollectionParents(e,n){return L.resolve(this.Cn.getEntries(n))}addFieldIndex(e,n){return L.resolve()}deleteFieldIndex(e,n){return L.resolve()}deleteAllFieldIndexes(e){return L.resolve()}createTargetIndexes(e,n){return L.resolve()}getDocumentsMatchingTarget(e,n){return L.resolve(null)}getIndexType(e,n){return L.resolve(0)}getFieldIndexes(e,n){return L.resolve([])}getNextCollectionGroupToUpdate(e){return L.resolve(null)}getMinOffset(e,n){return L.resolve(On.min())}getMinOffsetFromCollectionGroup(e,n){return L.resolve(On.min())}updateCollectionGroup(e,n,r){return L.resolve()}updateIndexEntries(e,n){return L.resolve()}}class By{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),i=this.index[n]||new Ke(Ue.comparator),s=!i.has(r);return this.index[n]=i.add(r),s}has(e){const n=e.lastSegment(),r=e.popLast(),i=this.index[n];return i&&i.has(r)}getEntries(e){return(this.index[e]||new Ke(Ue.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tI="IndexedDbIndexManager",Eu=new Uint8Array(0);class FV{constructor(e,n){this.databaseId=n,this.vn=new By,this.Fn=new ti(r=>Hs(r),(r,i)=>Nc(r,i)),this.uid=e.uid||""}addToCollectionParentIndex(e,n){if(!this.vn.has(n)){const r=n.lastSegment(),i=n.popLast();e.addOnCommittedListener(()=>{this.vn.add(n)});const s={collectionId:r,parent:an(i)};return nI(e).put(s)}return L.resolve()}getCollectionParents(e,n){const r=[],i=IDBKeyRange.bound([n,""],[WS(n),""],!1,!0);return nI(e).J(i).next(s=>{for(const o of s){if(o.collectionId!==n)break;r.push(Tr(o.parent))}return r})}addFieldIndex(e,n){const r=rl(e),i=function(a){return{indexId:a.indexId,collectionGroup:a.collectionGroup,fields:a.fields.map(l=>[l.fieldPath.canonicalString(),l.kind])}}(n);delete i.indexId;const s=r.add(i);if(n.indexState){const o=go(e);return s.next(a=>{o.put(KE(a,this.uid,n.indexState.sequenceNumber,n.indexState.offset))})}return s.next()}deleteFieldIndex(e,n){const r=rl(e),i=go(e),s=mo(e);return r.delete(n.indexId).next(()=>i.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0))).next(()=>s.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){const n=rl(e),r=mo(e),i=go(e);return n.Z().next(()=>r.Z()).next(()=>i.Z())}createTargetIndexes(e,n){return L.forEach(this.Mn(n),r=>this.getIndexType(e,r).next(i=>{if(i===0||i===1){const s=new ZE(r).Dn();if(s!=null)return this.addFieldIndex(e,s)}}))}getDocumentsMatchingTarget(e,n){const r=mo(e);let i=!0;const s=new Map;return L.forEach(this.Mn(n),o=>this.xn(e,o).next(a=>{i&&(i=!!a),s.set(o,a)})).next(()=>{if(i){let o=be();const a=[];return L.forEach(s,(l,d)=>{H(tI,`Using index ${function(E){return`id=${E.indexId}|cg=${E.collectionGroup}|f=${E.fields.map(O=>`${O.fieldPath}:${O.kind}`).join(",")}`}(l)} to execute ${Hs(n)}`);const h=function(E,O){const D=jm(O);if(D===void 0)return null;for(const B of qd(E,D.fieldPath))switch(B.op){case"array-contains-any":return B.value.arrayValue.values||[];case"array-contains":return[B.value]}return null}(d,l),f=function(E,O){const D=new Map;for(const B of ms(O))for(const x of qd(E,B.fieldPath))switch(x.op){case"==":case"in":D.set(B.fieldPath.canonicalString(),x.value);break;case"not-in":case"!=":return D.set(B.fieldPath.canonicalString(),x.value),Array.from(D.values())}return null}(d,l),m=function(E,O){const D=[];let B=!0;for(const x of ms(O)){const v=x.kind===0?DE(E,x.fieldPath,E.startAt):jE(E,x.fieldPath,E.startAt);D.push(v.value),B&&(B=v.inclusive)}return new Ki(D,B)}(d,l),_=function(E,O){const D=[];let B=!0;for(const x of ms(O)){const v=x.kind===0?jE(E,x.fieldPath,E.endAt):DE(E,x.fieldPath,E.endAt);D.push(v.value),B&&(B=v.inclusive)}return new Ki(D,B)}(d,l),R=this.On(l,d,m),C=this.On(l,d,_),y=this.Nn(l,d,f),I=this.Bn(l.indexId,h,R,m.inclusive,C,_.inclusive,y);return L.forEach(I,w=>r.Y(w,n.limit).next(E=>{E.forEach(O=>{const D=Z.fromSegments(O.documentKey);o.has(D)||(o=o.add(D),a.push(D))})}))}).next(()=>a)}return L.resolve(null)})}Mn(e){let n=this.Fn.get(e);return n||(e.filters.length===0?n=[e]:n=LV(He.create(e.filters,"and")).map(r=>zm(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.Fn.set(e,n),n)}Bn(e,n,r,i,s,o,a){const l=(n!=null?n.length:1)*Math.max(r.length,s.length),d=l/(n!=null?n.length:1),h=[];for(let f=0;f<l;++f){const m=n?this.Ln(n[f/d]):Eu,_=this.kn(e,m,r[f%d],i),R=this.qn(e,m,s[f%d],o),C=a.map(y=>this.kn(e,m,y,!0));h.push(...this.createRange(_,R,C))}return h}kn(e,n,r,i){const s=new ws(e,Z.empty(),n,r);return i?s:s.An()}qn(e,n,r,i){const s=new ws(e,Z.empty(),n,r);return i?s.An():s}xn(e,n){const r=new ZE(n),i=n.collectionGroup!=null?n.collectionGroup:n.path.lastSegment();return this.getFieldIndexes(e,i).next(s=>{let o=null;for(const a of s)r.yn(a)&&(!o||a.fields.length>o.fields.length)&&(o=a);return o})}getIndexType(e,n){let r=2;const i=this.Mn(n);return L.forEach(i,s=>this.xn(e,s).next(o=>{o?r!==0&&o.fields.length<function(l){let d=new Ke(dt.comparator),h=!1;for(const f of l.filters)for(const m of f.getFlattenedFilters())m.field.isKeyField()||(m.op==="array-contains"||m.op==="array-contains-any"?h=!0:d=d.add(m.field));for(const f of l.orderBy)f.field.isKeyField()||(d=d.add(f.field));return d.size+(h?1:0)}(s)&&(r=1):r=0})).next(()=>function(o){return o.limit!==null}(n)&&i.length>1&&r===2?1:r)}Qn(e,n){const r=new nl;for(const i of ms(e)){const s=n.data.field(i.fieldPath);if(s==null)return null;const o=r.Pn(i.kind);vs.Kt.Dt(s,o)}return r.un()}Ln(e){const n=new nl;return vs.Kt.Dt(e,n.Pn(0)),n.un()}$n(e,n){const r=new nl;return vs.Kt.Dt(qs(this.databaseId,n),r.Pn(function(s){const o=ms(s);return o.length===0?0:o[o.length-1].kind}(e))),r.un()}Nn(e,n,r){if(r===null)return[];let i=[];i.push(new nl);let s=0;for(const o of ms(e)){const a=r[s++];for(const l of i)if(this.Un(n,o.fieldPath)&&mc(a))i=this.Kn(i,o,a);else{const d=l.Pn(o.kind);vs.Kt.Dt(a,d)}}return this.Wn(i)}On(e,n,r){return this.Nn(e,n,r.position)}Wn(e){const n=[];for(let r=0;r<e.length;++r)n[r]=e[r].un();return n}Kn(e,n,r){const i=[...e],s=[];for(const o of r.arrayValue.values||[])for(const a of i){const l=new nl;l.seed(a.un()),vs.Kt.Dt(o,l.Pn(n.kind)),s.push(l)}return s}Un(e,n){return!!e.filters.find(r=>r instanceof Ne&&r.field.isEqual(n)&&(r.op==="in"||r.op==="not-in"))}getFieldIndexes(e,n){const r=rl(e),i=go(e);return(n?r.J(Vm,IDBKeyRange.bound(n,n)):r.J()).next(s=>{const o=[];return L.forEach(s,a=>i.get([a.indexId,this.uid]).next(l=>{o.push(function(h,f){const m=f?new lc(f.sequenceNumber,new On(Gs(f.readTime),new Z(Tr(f.documentKey)),f.largestBatchId)):lc.empty(),_=h.fields.map(([R,C])=>new Gu(dt.fromServerFormat(R),C));return new Md(h.indexId,h.collectionGroup,_,m)}(a,l))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(n=>n.length===0?null:(n.sort((r,i)=>{const s=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return s!==0?s:Ee(r.collectionGroup,i.collectionGroup)}),n[0].collectionGroup))}updateCollectionGroup(e,n,r){const i=rl(e),s=go(e);return this.Gn(e).next(o=>i.J(Vm,IDBKeyRange.bound(n,n)).next(a=>L.forEach(a,l=>s.put(KE(l.indexId,this.uid,o,r)))))}updateIndexEntries(e,n){const r=new Map;return L.forEach(n,(i,s)=>{const o=r.get(i.collectionGroup);return(o?L.resolve(o):this.getFieldIndexes(e,i.collectionGroup)).next(a=>(r.set(i.collectionGroup,a),L.forEach(a,l=>this.zn(e,i,l).next(d=>{const h=this.jn(s,l);return d.isEqual(h)?L.resolve():this.Jn(e,s,l,d,h)}))))})}Hn(e,n,r,i){return mo(e).put(i.Rn(this.uid,this.$n(r,n.key),n.key))}Yn(e,n,r,i){return mo(e).delete(i.Vn(this.uid,this.$n(r,n.key),n.key))}zn(e,n,r){const i=mo(e);let s=new Ke(hi);return i.ee({index:rb,range:IDBKeyRange.only([r.indexId,this.uid,nd(this.$n(r,n))])},(o,a)=>{s=s.add(new ws(r.indexId,n,JE(a.arrayValue),JE(a.directionalValue)))}).next(()=>s)}jn(e,n){let r=new Ke(hi);const i=this.Qn(n,e);if(i==null)return r;const s=jm(n);if(s!=null){const o=e.data.field(s.fieldPath);if(mc(o))for(const a of o.arrayValue.values||[])r=r.add(new ws(n.indexId,e.key,this.Ln(a),i))}else r=r.add(new ws(n.indexId,e.key,Eu,i));return r}Jn(e,n,r,i,s){H(tI,"Updating index entries for document '%s'",n.key);const o=[];return function(l,d,h,f,m){const _=l.getIterator(),R=d.getIterator();let C=fo(_),y=fo(R);for(;C||y;){let I=!1,w=!1;if(C&&y){const E=h(C,y);E<0?w=!0:E>0&&(I=!0)}else C!=null?w=!0:I=!0;I?(f(y),y=fo(R)):w?(m(C),C=fo(_)):(C=fo(_),y=fo(R))}}(i,s,hi,a=>{o.push(this.Hn(e,n,r,a))},a=>{o.push(this.Yn(e,n,r,a))}),L.waitFor(o)}Gn(e){let n=1;return go(e).ee({index:nb,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,i,s)=>{s.done(),n=i.sequenceNumber+1}).next(()=>n)}createRange(e,n,r){r=r.sort((o,a)=>hi(o,a)).filter((o,a,l)=>!a||hi(o,l[a-1])!==0);const i=[];i.push(e);for(const o of r){const a=hi(o,e),l=hi(o,n);if(a===0)i[0]=e.An();else if(a>0&&l<0)i.push(o),i.push(o.An());else if(l>0)break}i.push(n);const s=[];for(let o=0;o<i.length;o+=2){if(this.Zn(i[o],i[o+1]))return[];const a=i[o].Vn(this.uid,Eu,Z.empty()),l=i[o+1].Vn(this.uid,Eu,Z.empty());s.push(IDBKeyRange.bound(a,l))}return s}Zn(e,n){return hi(e,n)>0}getMinOffsetFromCollectionGroup(e,n){return this.getFieldIndexes(e,n).next(rI)}getMinOffset(e,n){return L.mapArray(this.Mn(n),r=>this.xn(e,r).next(i=>i||se(44426))).next(rI)}}function nI(t){return Vt(t,hc)}function mo(t){return Vt(t,Ol)}function rl(t){return Vt(t,by)}function go(t){return Vt(t,jl)}function rI(t){ae(t.length!==0,28825);let e=t[0].indexState.offset,n=e.largestBatchId;for(let r=1;r<t.length;r++){const i=t[r].indexState.offset;Ty(i,e)<0&&(e=i),n<i.largestBatchId&&(n=i.largestBatchId)}return new On(e.readTime,e.documentKey,n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iI={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},sC=41943040;class Zt{static withCacheSize(e){return new Zt(e,Zt.DEFAULT_COLLECTION_PERCENTILE,Zt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oC(t,e,n){const r=t.store(tr),i=t.store(ua),s=[],o=IDBKeyRange.only(n.batchId);let a=0;const l=r.ee({range:o},(h,f,m)=>(a++,m.delete()));s.push(l.next(()=>{ae(a===1,47070,{batchId:n.batchId})}));const d=[];for(const h of n.mutations){const f=ZS(e,h.key.path,n.batchId);s.push(i.delete(f)),d.push(h.key)}return L.waitFor(s).next(()=>d)}function Yd(t){if(!t)return 0;let e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw se(14731);e=t.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Zt.DEFAULT_COLLECTION_PERCENTILE=10,Zt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Zt.DEFAULT=new Zt(sC,Zt.DEFAULT_COLLECTION_PERCENTILE,Zt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Zt.DISABLED=new Zt(-1,0,0);class Qh{constructor(e,n,r,i){this.userId=e,this.serializer=n,this.indexManager=r,this.referenceDelegate=i,this.Xn={}}static wt(e,n,r,i){ae(e.uid!=="",64387);const s=e.isAuthenticated()?e.uid:"";return new Qh(s,n,r,i)}checkEmpty(e){let n=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return fi(e).ee({index:Ss,range:r},(i,s,o)=>{n=!1,o.done()}).next(()=>n)}addMutationBatch(e,n,r,i){const s=Co(e),o=fi(e);return o.add({}).next(a=>{ae(typeof a=="number",49019);const l=new jy(a,n,r,i),d=function(_,R,C){const y=C.baseMutations.map(w=>Kd(_.yt,w)),I=C.mutations.map(w=>Kd(_.yt,w));return{userId:R,batchId:C.batchId,localWriteTimeMs:C.localWriteTime.toMillis(),baseMutations:y,mutations:I}}(this.serializer,this.userId,l),h=[];let f=new Ke((m,_)=>Ee(m.canonicalString(),_.canonicalString()));for(const m of i){const _=ZS(this.userId,m.key.path,a);f=f.add(m.key.path.popLast()),h.push(o.put(d)),h.push(s.put(_,hO))}return f.forEach(m=>{h.push(this.indexManager.addToCollectionParentIndex(e,m))}),e.addOnCommittedListener(()=>{this.Xn[a]=l.keys()}),L.waitFor(h).next(()=>l)})}lookupMutationBatch(e,n){return fi(e).get(n).next(r=>r?(ae(r.userId===this.userId,48,"Unexpected user for mutation batch",{userId:r.userId,batchId:n}),_s(this.serializer,r)):null)}er(e,n){return this.Xn[n]?L.resolve(this.Xn[n]):this.lookupMutationBatch(e,n).next(r=>{if(r){const i=r.keys();return this.Xn[n]=i,i}return null})}getNextMutationBatchAfterBatchId(e,n){const r=n+1,i=IDBKeyRange.lowerBound([this.userId,r]);let s=null;return fi(e).ee({index:Ss,range:i},(o,a,l)=>{a.userId===this.userId&&(ae(a.batchId>=r,47524,{tr:r}),s=_s(this.serializer,a)),l.done()}).next(()=>s)}getHighestUnacknowledgedBatchId(e){const n=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=Rs;return fi(e).ee({index:Ss,range:n,reverse:!0},(i,s,o)=>{r=s.batchId,o.done()}).next(()=>r)}getAllMutationBatches(e){const n=IDBKeyRange.bound([this.userId,Rs],[this.userId,Number.POSITIVE_INFINITY]);return fi(e).J(Ss,n).next(r=>r.map(i=>_s(this.serializer,i)))}getAllMutationBatchesAffectingDocumentKey(e,n){const r=Qu(this.userId,n.path),i=IDBKeyRange.lowerBound(r),s=[];return Co(e).ee({range:i},(o,a,l)=>{const[d,h,f]=o,m=Tr(h);if(d===this.userId&&n.path.isEqual(m))return fi(e).get(f).next(_=>{if(!_)throw se(61480,{nr:o,batchId:f});ae(_.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:_.userId,batchId:f}),s.push(_s(this.serializer,_))});l.done()}).next(()=>s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Ke(Ee);const i=[];return n.forEach(s=>{const o=Qu(this.userId,s.path),a=IDBKeyRange.lowerBound(o),l=Co(e).ee({range:a},(d,h,f)=>{const[m,_,R]=d,C=Tr(_);m===this.userId&&s.path.isEqual(C)?r=r.add(R):f.done()});i.push(l)}),L.waitFor(i).next(()=>this.rr(e,r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,i=r.length+1,s=Qu(this.userId,r),o=IDBKeyRange.lowerBound(s);let a=new Ke(Ee);return Co(e).ee({range:o},(l,d,h)=>{const[f,m,_]=l,R=Tr(m);f===this.userId&&r.isPrefixOf(R)?R.length===i&&(a=a.add(_)):h.done()}).next(()=>this.rr(e,a))}rr(e,n){const r=[],i=[];return n.forEach(s=>{i.push(fi(e).get(s).next(o=>{if(o===null)throw se(35274,{batchId:s});ae(o.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:o.userId,batchId:s}),r.push(_s(this.serializer,o))}))}),L.waitFor(i).next(()=>r)}removeMutationBatch(e,n){return oC(e.le,this.userId,n).next(r=>(e.addOnCommittedListener(()=>{this.ir(n.batchId)}),L.forEach(r,i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))}ir(e){delete this.Xn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(n=>{if(!n)return L.resolve();const r=IDBKeyRange.lowerBound(function(o){return[o]}(this.userId)),i=[];return Co(e).ee({range:r},(s,o,a)=>{if(s[0]===this.userId){const l=Tr(s[1]);i.push(l)}else a.done()}).next(()=>{ae(i.length===0,56720,{sr:i.map(s=>s.canonicalString())})})})}containsKey(e,n){return aC(e,this.userId,n)}_r(e){return lC(e).get(this.userId).next(n=>n||{userId:this.userId,lastAcknowledgedBatchId:Rs,lastStreamToken:""})}}function aC(t,e,n){const r=Qu(e,n.path),i=r[1],s=IDBKeyRange.lowerBound(r);let o=!1;return Co(t).ee({range:s,X:!0},(a,l,d)=>{const[h,f,m]=a;h===e&&f===i&&(o=!0),d.done()}).next(()=>o)}function fi(t){return Vt(t,tr)}function Co(t){return Vt(t,ua)}function lC(t){return Vt(t,uc)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qs{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new Qs(0)}static cr(){return new Qs(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UV{constructor(e,n){this.referenceDelegate=e,this.serializer=n}allocateTargetId(e){return this.lr(e).next(n=>{const r=new Qs(n.highestTargetId);return n.highestTargetId=r.next(),this.hr(e,n).next(()=>n.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.lr(e).next(n=>fe.fromTimestamp(new Le(n.lastRemoteSnapshotVersion.seconds,n.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.lr(e).next(n=>n.highestListenSequenceNumber)}setTargetsMetadata(e,n,r){return this.lr(e).next(i=>(i.highestListenSequenceNumber=n,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),n>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=n),this.hr(e,i)))}addTargetData(e,n){return this.Pr(e,n).next(()=>this.lr(e).next(r=>(r.targetCount+=1,this.Tr(n,r),this.hr(e,r))))}updateTargetData(e,n){return this.Pr(e,n)}removeTargetData(e,n){return this.removeMatchingKeysForTargetId(e,n.targetId).next(()=>yo(e).delete(n.targetId)).next(()=>this.lr(e)).next(r=>(ae(r.targetCount>0,8065),r.targetCount-=1,this.hr(e,r)))}removeTargets(e,n,r){let i=0;const s=[];return yo(e).ee((o,a)=>{const l=yl(a);l.sequenceNumber<=n&&r.get(l.targetId)===null&&(i++,s.push(this.removeTargetData(e,l)))}).next(()=>L.waitFor(s)).next(()=>i)}forEachTarget(e,n){return yo(e).ee((r,i)=>{const s=yl(i);n(s)})}lr(e){return sI(e).get(Bd).next(n=>(ae(n!==null,2888),n))}hr(e,n){return sI(e).put(Bd,n)}Pr(e,n){return yo(e).put(tC(this.serializer,n))}Tr(e,n){let r=!1;return e.targetId>n.highestTargetId&&(n.highestTargetId=e.targetId,r=!0),e.sequenceNumber>n.highestListenSequenceNumber&&(n.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.lr(e).next(n=>n.targetCount)}getTargetData(e,n){const r=Hs(n),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let s=null;return yo(e).ee({range:i,index:tb},(o,a,l)=>{const d=yl(a);Nc(n,d.target)&&(s=d,l.done())}).next(()=>s)}addMatchingKeys(e,n,r){const i=[],s=xi(e);return n.forEach(o=>{const a=an(o.path);i.push(s.put({targetId:r,path:a})),i.push(this.referenceDelegate.addReference(e,r,o))}),L.waitFor(i)}removeMatchingKeys(e,n,r){const i=xi(e);return L.forEach(n,s=>{const o=an(s.path);return L.waitFor([i.delete([r,o]),this.referenceDelegate.removeReference(e,r,s)])})}removeMatchingKeysForTargetId(e,n){const r=xi(e),i=IDBKeyRange.bound([n],[n+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,n){const r=IDBKeyRange.bound([n],[n+1],!1,!0),i=xi(e);let s=be();return i.ee({range:r,X:!0},(o,a,l)=>{const d=Tr(o[1]),h=new Z(d);s=s.add(h)}).next(()=>s)}containsKey(e,n){const r=an(n.path),i=IDBKeyRange.bound([r],[WS(r)],!1,!0);let s=0;return xi(e).ee({index:Sy,X:!0,range:i},([o,a],l,d)=>{o!==0&&(s++,d.done())}).next(()=>s>0)}At(e,n){return yo(e).get(n).next(r=>r?yl(r):null)}}function yo(t){return Vt(t,da)}function sI(t){return Vt(t,Ps)}function xi(t){return Vt(t,ha)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oI="LruGarbageCollector",BV=1048576;function aI([t,e],[n,r]){const i=Ee(t,n);return i===0?Ee(e,r):i}class $V{constructor(e){this.Ir=e,this.buffer=new Ke(aI),this.Er=0}dr(){return++this.Er}Ar(e){const n=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(n);else{const r=this.buffer.last();aI(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}}class cC{constructor(e,n,r){this.garbageCollector=e,this.asyncQueue=n,this.localStore=r,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){H(oI,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){rs(n)?H(oI,"Ignoring IndexedDB error during garbage collection: ",n):await so(n)}await this.Vr(3e5)})}}class zV{constructor(e,n){this.mr=e,this.params=n}calculateTargetCount(e,n){return this.mr.gr(e).next(r=>Math.floor(n/100*r))}nthSequenceNumber(e,n){if(n===0)return L.resolve(qn.ce);const r=new $V(n);return this.mr.forEachTarget(e,i=>r.Ar(i.sequenceNumber)).next(()=>this.mr.pr(e,i=>r.Ar(i))).next(()=>r.maxValue)}removeTargets(e,n,r){return this.mr.removeTargets(e,n,r)}removeOrphanedDocuments(e,n){return this.mr.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(H("LruGarbageCollector","Garbage collection skipped; disabled"),L.resolve(iI)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(H("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),iI):this.yr(e,n))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,n){let r,i,s,o,a,l,d;const h=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(f=>(f>this.params.maximumSequenceNumbersToCollect?(H("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${f}`),i=this.params.maximumSequenceNumbersToCollect):i=f,o=Date.now(),this.nthSequenceNumber(e,i))).next(f=>(r=f,a=Date.now(),this.removeTargets(e,r,n))).next(f=>(s=f,l=Date.now(),this.removeOrphanedDocuments(e,r))).next(f=>(d=Date.now(),xo()<=Pe.DEBUG&&H("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-h}ms
	Determined least recently used ${i} in `+(a-o)+`ms
	Removed ${s} targets in `+(l-a)+`ms
	Removed ${f} documents in `+(d-l)+`ms
Total Duration: ${d-h}ms`),L.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:f})))}}function uC(t,e){return new zV(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qV{constructor(e,n){this.db=e,this.garbageCollector=uC(this,n)}gr(e){const n=this.wr(e);return this.db.getTargetCache().getTargetCount(e).next(r=>n.next(i=>r+i))}wr(e){let n=0;return this.pr(e,r=>{n++}).next(()=>n)}forEachTarget(e,n){return this.db.getTargetCache().forEachTarget(e,n)}pr(e,n){return this.Sr(e,(r,i)=>n(i))}addReference(e,n,r){return Iu(e,r)}removeReference(e,n,r){return Iu(e,r)}removeTargets(e,n,r){return this.db.getTargetCache().removeTargets(e,n,r)}markPotentiallyOrphaned(e,n){return Iu(e,n)}br(e,n){return function(i,s){let o=!1;return lC(i).te(a=>aC(i,a,s).next(l=>(l&&(o=!0),L.resolve(!l)))).next(()=>o)}(e,n)}removeOrphanedDocuments(e,n){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[];let s=0;return this.Sr(e,(o,a)=>{if(a<=n){const l=this.br(e,o).next(d=>{if(!d)return s++,r.getEntry(e,o).next(()=>(r.removeEntry(o,fe.min()),xi(e).delete(function(f){return[0,an(f.path)]}(o))))});i.push(l)}}).next(()=>L.waitFor(i)).next(()=>r.apply(e)).next(()=>s)}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,n){return Iu(e,n)}Sr(e,n){const r=xi(e);let i,s=qn.ce;return r.ee({index:Sy},([o,a],{path:l,sequenceNumber:d})=>{o===0?(s!==qn.ce&&n(new Z(Tr(i)),s),s=d,i=l):s=qn.ce}).next(()=>{s!==qn.ce&&n(new Z(Tr(i)),s)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function Iu(t,e){return xi(t).put(function(r,i){return{targetId:0,path:an(r.path),sequenceNumber:i}}(e,t.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dC{constructor(){this.changes=new ti(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,yt.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?L.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HV{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,n,r){return us(e).put(r)}removeEntry(e,n,r){return us(e).delete(function(s,o){const a=s.path.toArray();return[a.slice(0,a.length-2),a[a.length-2],Gd(o),a[a.length-1]]}(n,r))}updateMetadata(e,n){return this.getMetadata(e).next(r=>(r.byteSize+=n,this.Dr(e,r)))}getEntry(e,n){let r=yt.newInvalidDocument(n);return us(e).ee({index:Yu,range:IDBKeyRange.only(il(n))},(i,s)=>{r=this.Cr(n,s)}).next(()=>r)}vr(e,n){let r={size:0,document:yt.newInvalidDocument(n)};return us(e).ee({index:Yu,range:IDBKeyRange.only(il(n))},(i,s)=>{r={document:this.Cr(n,s),size:Yd(s)}}).next(()=>r)}getEntries(e,n){let r=Nn();return this.Fr(e,n,(i,s)=>{const o=this.Cr(i,s);r=r.insert(i,o)}).next(()=>r)}Mr(e,n){let r=Nn(),i=new ct(Z.comparator);return this.Fr(e,n,(s,o)=>{const a=this.Cr(s,o);r=r.insert(s,a),i=i.insert(s,Yd(o))}).next(()=>({documents:r,Or:i}))}Fr(e,n,r){if(n.isEmpty())return L.resolve();let i=new Ke(uI);n.forEach(l=>i=i.add(l));const s=IDBKeyRange.bound(il(i.first()),il(i.last())),o=i.getIterator();let a=o.getNext();return us(e).ee({index:Yu,range:s},(l,d,h)=>{const f=Z.fromSegments([...d.prefixPath,d.collectionGroup,d.documentId]);for(;a&&uI(a,f)<0;)r(a,null),a=o.getNext();a&&a.isEqual(f)&&(r(a,d),a=o.hasNext()?o.getNext():null),a?h.j(il(a)):h.done()}).next(()=>{for(;a;)r(a,null),a=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,n,r,i,s){const o=n.path,a=[o.popLast().toArray(),o.lastSegment(),Gd(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],l=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return us(e).J(IDBKeyRange.bound(a,l,!0)).next(d=>{s==null||s.incrementDocumentReadCount(d.length);let h=Nn();for(const f of d){const m=this.Cr(Z.fromSegments(f.prefixPath.concat(f.collectionGroup,f.documentId)),f);m.isFoundDocument()&&(Dc(n,m)||i.has(m.key))&&(h=h.insert(m.key,m))}return h})}getAllFromCollectionGroup(e,n,r,i){let s=Nn();const o=cI(n,r),a=cI(n,On.max());return us(e).ee({index:eb,range:IDBKeyRange.bound(o,a,!0)},(l,d,h)=>{const f=this.Cr(Z.fromSegments(d.prefixPath.concat(d.collectionGroup,d.documentId)),d);s=s.insert(f.key,f),s.size===i&&h.done()}).next(()=>s)}newChangeBuffer(e){return new WV(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(n=>n.byteSize)}getMetadata(e){return lI(e).get(Om).next(n=>(ae(!!n,20021),n))}Dr(e,n){return lI(e).put(Om,n)}Cr(e,n){if(n){const r=PV(this.serializer,n);if(!(r.isNoDocument()&&r.version.isEqual(fe.min())))return r}return yt.newInvalidDocument(e)}}function hC(t){return new HV(t)}class WV extends dC{constructor(e,n){super(),this.Nr=e,this.trackRemovals=n,this.Br=new ti(r=>r.toString(),(r,i)=>r.isEqual(i))}applyChanges(e){const n=[];let r=0,i=new Ke((s,o)=>Ee(s.canonicalString(),o.canonicalString()));return this.changes.forEach((s,o)=>{const a=this.Br.get(s);if(n.push(this.Nr.removeEntry(e,s,a.readTime)),o.isValidDocument()){const l=HE(this.Nr.serializer,o);i=i.add(s.path.popLast());const d=Yd(l);r+=d-a.size,n.push(this.Nr.addEntry(e,s,l))}else if(r-=a.size,this.trackRemovals){const l=HE(this.Nr.serializer,o.convertToNoDocument(fe.min()));n.push(this.Nr.addEntry(e,s,l))}}),i.forEach(s=>{n.push(this.Nr.indexManager.addToCollectionParentIndex(e,s))}),n.push(this.Nr.updateMetadata(e,r)),L.waitFor(n)}getFromCache(e,n){return this.Nr.vr(e,n).next(r=>(this.Br.set(n,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,n){return this.Nr.Mr(e,n).next(({documents:r,Or:i})=>(i.forEach((s,o)=>{this.Br.set(s,{size:o,readTime:r.get(s).readTime})}),r))}}function lI(t){return Vt(t,dc)}function us(t){return Vt(t,Ud)}function il(t){const e=t.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function cI(t,e){const n=e.documentKey.path.toArray();return[t,Gd(e.readTime),n.slice(0,n.length-2),n.length>0?n[n.length-1]:""]}function uI(t,e){const n=t.path.toArray(),r=e.path.toArray();let i=0;for(let s=0;s<n.length-2&&s<r.length-2;++s)if(i=Ee(n[s],r[s]),i)return i;return i=Ee(n.length,r.length),i||(i=Ee(n[n.length-2],r[r.length-2]),i||Ee(n[n.length-1],r[r.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KV{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fC{constructor(e,n,r,i){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,n))).next(i=>(r!==null&&Ml(r.mutation,i,En.empty(),Le.now()),i))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,be()).next(()=>r))}getLocalViewOfDocuments(e,n,r=be()){const i=xr();return this.populateOverlays(e,i,n).next(()=>this.computeViews(e,n,i,r).next(s=>{let o=ml();return s.forEach((a,l)=>{o=o.insert(a,l.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){const r=xr();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,be()))}populateOverlays(e,n,r){const i=[];return r.forEach(s=>{n.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((o,a)=>{n.set(o,a)})})}computeViews(e,n,r,i){let s=Nn();const o=Ll(),a=function(){return Ll()}();return n.forEach((l,d)=>{const h=r.get(d.key);i.has(d.key)&&(h===void 0||h.mutation instanceof ni)?s=s.insert(d.key,d):h!==void 0?(o.set(d.key,h.mutation.getFieldMask()),Ml(h.mutation,d,h.mutation.getFieldMask(),Le.now())):o.set(d.key,En.empty())}),this.recalculateAndSaveOverlays(e,s).next(l=>(l.forEach((d,h)=>o.set(d,h)),n.forEach((d,h)=>a.set(d,new KV(h,o.get(d)??null))),a))}recalculateAndSaveOverlays(e,n){const r=Ll();let i=new ct((o,a)=>o-a),s=be();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(const a of o)a.keys().forEach(l=>{const d=n.get(l);if(d===null)return;let h=r.get(l)||En.empty();h=a.applyToLocalView(d,h),r.set(l,h);const f=(i.get(a.batchId)||be()).add(l);i=i.insert(a.batchId,f)})}).next(()=>{const o=[],a=i.getReverseIterator();for(;a.hasNext();){const l=a.getNext(),d=l.key,h=l.value,f=Nb();h.forEach(m=>{if(!s.has(m)){const _=Mb(n.get(m),r.get(m));_!==null&&f.set(m,_),s=s.add(m)}}),o.push(this.documentOverlayCache.saveOverlays(e,d,f))}return L.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,i){return function(o){return Z.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):ky(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,i):this.getDocumentsMatchingCollectionQuery(e,n,r,i)}getNextDocuments(e,n,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,i).next(s=>{const o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,i-s.size):L.resolve(xr());let a=ac,l=s;return o.next(d=>L.forEach(d,(h,f)=>(a<f.largestBatchId&&(a=f.largestBatchId),s.get(h)?L.resolve():this.remoteDocumentCache.getEntry(e,h).next(m=>{l=l.insert(h,m)}))).next(()=>this.populateOverlays(e,d,s)).next(()=>this.computeViews(e,l,d,be())).next(h=>({batchId:a,changes:Pb(h)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new Z(n)).next(r=>{let i=ml();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,n,r,i){const s=n.collectionGroup;let o=ml();return this.indexManager.getCollectionParents(e,s).next(a=>L.forEach(a,l=>{const d=function(f,m){return new ss(m,null,f.explicitOrderBy.slice(),f.filters.slice(),f.limit,f.limitType,f.startAt,f.endAt)}(n,l.child(s));return this.getDocumentsMatchingCollectionQuery(e,d,r,i).next(h=>{h.forEach((f,m)=>{o=o.insert(f,m)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,n,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,s,i))).next(o=>{s.forEach((l,d)=>{const h=d.getKey();o.get(h)===null&&(o=o.insert(h,yt.newInvalidDocument(h)))});let a=ml();return o.forEach((l,d)=>{const h=s.get(l);h!==void 0&&Ml(h.mutation,d,En.empty(),Le.now()),Dc(n,d)&&(a=a.insert(l,d))}),a})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GV{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,n){return L.resolve(this.Lr.get(n))}saveBundleMetadata(e,n){return this.Lr.set(n.id,function(i){return{id:i.id,version:i.version,createTime:pn(i.createTime)}}(n)),L.resolve()}getNamedQuery(e,n){return L.resolve(this.kr.get(n))}saveNamedQuery(e,n){return this.kr.set(n.name,function(i){return{name:i.name,query:nC(i.bundledQuery),readTime:pn(i.readTime)}}(n)),L.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QV{constructor(){this.overlays=new ct(Z.comparator),this.qr=new Map}getOverlay(e,n){return L.resolve(this.overlays.get(n))}getOverlays(e,n){const r=xr();return L.forEach(n,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((i,s)=>{this.St(e,n,s)}),L.resolve()}removeOverlaysForBatchId(e,n,r){const i=this.qr.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.qr.delete(r)),L.resolve()}getOverlaysForCollection(e,n,r){const i=xr(),s=n.length+1,o=new Z(n.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const l=a.getNext().value,d=l.getKey();if(!n.isPrefixOf(d.path))break;d.path.length===s&&l.largestBatchId>r&&i.set(l.getKey(),l)}return L.resolve(i)}getOverlaysForCollectionGroup(e,n,r,i){let s=new ct((d,h)=>d-h);const o=this.overlays.getIterator();for(;o.hasNext();){const d=o.getNext().value;if(d.getKey().getCollectionGroup()===n&&d.largestBatchId>r){let h=s.get(d.largestBatchId);h===null&&(h=xr(),s=s.insert(d.largestBatchId,h)),h.set(d.getKey(),d)}}const a=xr(),l=s.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((d,h)=>a.set(d,h)),!(a.size()>=i)););return L.resolve(a)}St(e,n,r){const i=this.overlays.get(r.key);if(i!==null){const o=this.qr.get(i.largestBatchId).delete(r.key);this.qr.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new Vy(n,r));let s=this.qr.get(n);s===void 0&&(s=be(),this.qr.set(n,s)),this.qr.set(n,s.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YV{constructor(){this.sessionToken=Rt.EMPTY_BYTE_STRING}getSessionToken(e){return L.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,L.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $y{constructor(){this.Qr=new Ke(Ft.$r),this.Ur=new Ke(Ft.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,n){const r=new Ft(e,n);this.Qr=this.Qr.add(r),this.Ur=this.Ur.add(r)}Wr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Gr(new Ft(e,n))}zr(e,n){e.forEach(r=>this.removeReference(r,n))}jr(e){const n=new Z(new Ue([])),r=new Ft(n,e),i=new Ft(n,e+1),s=[];return this.Ur.forEachInRange([r,i],o=>{this.Gr(o),s.push(o.key)}),s}Jr(){this.Qr.forEach(e=>this.Gr(e))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const n=new Z(new Ue([])),r=new Ft(n,e),i=new Ft(n,e+1);let s=be();return this.Ur.forEachInRange([r,i],o=>{s=s.add(o.key)}),s}containsKey(e){const n=new Ft(e,0),r=this.Qr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class Ft{constructor(e,n){this.key=e,this.Yr=n}static $r(e,n){return Z.comparator(e.key,n.key)||Ee(e.Yr,n.Yr)}static Kr(e,n){return Ee(e.Yr,n.Yr)||Z.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XV{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.tr=1,this.Zr=new Ke(Ft.$r)}checkEmpty(e){return L.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,i){const s=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new jy(s,n,r,i);this.mutationQueue.push(o);for(const a of i)this.Zr=this.Zr.add(new Ft(a.key,s)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return L.resolve(o)}lookupMutationBatch(e,n){return L.resolve(this.Xr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,i=this.ei(r),s=i<0?0:i;return L.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return L.resolve(this.mutationQueue.length===0?Rs:this.tr-1)}getAllMutationBatches(e){return L.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new Ft(n,0),i=new Ft(n,Number.POSITIVE_INFINITY),s=[];return this.Zr.forEachInRange([r,i],o=>{const a=this.Xr(o.Yr);s.push(a)}),L.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Ke(Ee);return n.forEach(i=>{const s=new Ft(i,0),o=new Ft(i,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([s,o],a=>{r=r.add(a.Yr)})}),L.resolve(this.ti(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,i=r.length+1;let s=r;Z.isDocumentKey(s)||(s=s.child(""));const o=new Ft(new Z(s),0);let a=new Ke(Ee);return this.Zr.forEachWhile(l=>{const d=l.key.path;return!!r.isPrefixOf(d)&&(d.length===i&&(a=a.add(l.Yr)),!0)},o),L.resolve(this.ti(a))}ti(e){const n=[];return e.forEach(r=>{const i=this.Xr(r);i!==null&&n.push(i)}),n}removeMutationBatch(e,n){ae(this.ni(n.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Zr;return L.forEach(n.mutations,i=>{const s=new Ft(i.key,n.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.Zr=r})}ir(e){}containsKey(e,n){const r=new Ft(n,0),i=this.Zr.firstAfterOrEqual(r);return L.resolve(n.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,L.resolve()}ni(e,n){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const n=this.ei(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JV{constructor(e){this.ri=e,this.docs=function(){return new ct(Z.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,i=this.docs.get(r),s=i?i.size:0,o=this.ri(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return L.resolve(r?r.document.mutableCopy():yt.newInvalidDocument(n))}getEntries(e,n){let r=Nn();return n.forEach(i=>{const s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():yt.newInvalidDocument(i))}),L.resolve(r)}getDocumentsMatchingQuery(e,n,r,i){let s=Nn();const o=n.path,a=new Z(o.child("__id-9223372036854775808__")),l=this.docs.getIteratorFrom(a);for(;l.hasNext();){const{key:d,value:{document:h}}=l.getNext();if(!o.isPrefixOf(d.path))break;d.path.length>o.length+1||Ty(QS(h),r)<=0||(i.has(h.key)||Dc(n,h))&&(s=s.insert(h.key,h.mutableCopy()))}return L.resolve(s)}getAllFromCollectionGroup(e,n,r,i){se(9500)}ii(e,n){return L.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new ZV(this)}getSize(e){return L.resolve(this.size)}}class ZV extends dC{constructor(e){super(),this.Nr=e}applyChanges(e){const n=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?n.push(this.Nr.addEntry(e,i)):this.Nr.removeEntry(r)}),L.waitFor(n)}getFromCache(e,n){return this.Nr.getEntry(e,n)}getAllFromCache(e,n){return this.Nr.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eL{constructor(e){this.persistence=e,this.si=new ti(n=>Hs(n),Nc),this.lastRemoteSnapshotVersion=fe.min(),this.highestTargetId=0,this.oi=0,this._i=new $y,this.targetCount=0,this.ai=Qs.ur()}forEachTarget(e,n){return this.si.forEach((r,i)=>n(i)),L.resolve()}getLastRemoteSnapshotVersion(e){return L.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return L.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),L.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.oi&&(this.oi=n),L.resolve()}Pr(e){this.si.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.ai=new Qs(n),this.highestTargetId=n),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,n){return this.Pr(n),this.targetCount+=1,L.resolve()}updateTargetData(e,n){return this.Pr(n),L.resolve()}removeTargetData(e,n){return this.si.delete(n.target),this._i.jr(n.targetId),this.targetCount-=1,L.resolve()}removeTargets(e,n,r){let i=0;const s=[];return this.si.forEach((o,a)=>{a.sequenceNumber<=n&&r.get(a.targetId)===null&&(this.si.delete(o),s.push(this.removeMatchingKeysForTargetId(e,a.targetId)),i++)}),L.waitFor(s).next(()=>i)}getTargetCount(e){return L.resolve(this.targetCount)}getTargetData(e,n){const r=this.si.get(n)||null;return L.resolve(r)}addMatchingKeys(e,n,r){return this._i.Wr(n,r),L.resolve()}removeMatchingKeys(e,n,r){this._i.zr(n,r);const i=this.persistence.referenceDelegate,s=[];return i&&n.forEach(o=>{s.push(i.markPotentiallyOrphaned(e,o))}),L.waitFor(s)}removeMatchingKeysForTargetId(e,n){return this._i.jr(n),L.resolve()}getMatchingKeysForTargetId(e,n){const r=this._i.Hr(n);return L.resolve(r)}containsKey(e,n){return L.resolve(this._i.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zy{constructor(e,n){this.ui={},this.overlays={},this.ci=new qn(0),this.li=!1,this.li=!0,this.hi=new YV,this.referenceDelegate=e(this),this.Pi=new eL(this),this.indexManager=new MV,this.remoteDocumentCache=function(i){return new JV(i)}(r=>this.referenceDelegate.Ti(r)),this.serializer=new eC(n),this.Ii=new GV(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new QV,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.ui[e.toKey()];return r||(r=new XV(n,this.referenceDelegate),this.ui[e.toKey()]=r),r}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,n,r){H("MemoryPersistence","Starting transaction:",e);const i=new tL(this.ci.next());return this.referenceDelegate.Ei(),r(i).next(s=>this.referenceDelegate.di(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Ai(e,n){return L.or(Object.values(this.ui).map(r=>()=>r.containsKey(e,n)))}}class tL extends XS{constructor(e){super(),this.currentSequenceNumber=e}}class Yh{constructor(e){this.persistence=e,this.Ri=new $y,this.Vi=null}static mi(e){return new Yh(e)}get fi(){if(this.Vi)return this.Vi;throw se(60996)}addReference(e,n,r){return this.Ri.addReference(r,n),this.fi.delete(r.toString()),L.resolve()}removeReference(e,n,r){return this.Ri.removeReference(r,n),this.fi.add(r.toString()),L.resolve()}markPotentiallyOrphaned(e,n){return this.fi.add(n.toString()),L.resolve()}removeTarget(e,n){this.Ri.jr(n.targetId).forEach(i=>this.fi.add(i.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(i=>{i.forEach(s=>this.fi.add(s.toString()))}).next(()=>r.removeTargetData(e,n))}Ei(){this.Vi=new Set}di(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return L.forEach(this.fi,r=>{const i=Z.fromPath(r);return this.gi(e,i).next(s=>{s||n.removeEntry(i,fe.min())})}).next(()=>(this.Vi=null,n.apply(e)))}updateLimboDocument(e,n){return this.gi(e,n).next(r=>{r?this.fi.delete(n.toString()):this.fi.add(n.toString())})}Ti(e){return 0}gi(e,n){return L.or([()=>L.resolve(this.Ri.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Ai(e,n)])}}class Xd{constructor(e,n){this.persistence=e,this.pi=new ti(r=>an(r.path),(r,i)=>r.isEqual(i)),this.garbageCollector=uC(this,n)}static mi(e,n){return new Xd(e,n)}Ei(){}di(e){return L.resolve()}forEachTarget(e,n){return this.persistence.getTargetCache().forEachTarget(e,n)}gr(e){const n=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next(r=>n.next(i=>r+i))}wr(e){let n=0;return this.pr(e,r=>{n++}).next(()=>n)}pr(e,n){return L.forEach(this.pi,(r,i)=>this.br(e,r,i).next(s=>s?L.resolve():n(i)))}removeTargets(e,n,r){return this.persistence.getTargetCache().removeTargets(e,n,r)}removeOrphanedDocuments(e,n){let r=0;const i=this.persistence.getRemoteDocumentCache(),s=i.newChangeBuffer();return i.ii(e,o=>this.br(e,o,n).next(a=>{a||(r++,s.removeEntry(o,fe.min()))})).next(()=>s.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,n){return this.pi.set(n,e.currentSequenceNumber),L.resolve()}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,n,r){return this.pi.set(r,e.currentSequenceNumber),L.resolve()}removeReference(e,n,r){return this.pi.set(r,e.currentSequenceNumber),L.resolve()}updateLimboDocument(e,n){return this.pi.set(n,e.currentSequenceNumber),L.resolve()}Ti(e){let n=e.key.toString().length;return e.isFoundDocument()&&(n+=Ju(e.data.value)),n}br(e,n,r){return L.or([()=>this.persistence.Ai(e,n),()=>this.persistence.getTargetCache().containsKey(e,n),()=>{const i=this.pi.get(n);return L.resolve(i!==void 0&&i>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nL{constructor(e){this.serializer=e}k(e,n,r,i){const s=new jh("createOrUpgrade",n);r<1&&i>=1&&(function(l){l.createObjectStore(Pc)}(e),function(l){l.createObjectStore(uc,{keyPath:dO}),l.createObjectStore(tr,{keyPath:EE,autoIncrement:!0}).createIndex(Ss,IE,{unique:!0}),l.createObjectStore(ua)}(e),dI(e),function(l){l.createObjectStore(gs)}(e));let o=L.resolve();return r<3&&i>=3&&(r!==0&&(function(l){l.deleteObjectStore(ha),l.deleteObjectStore(da),l.deleteObjectStore(Ps)}(e),dI(e)),o=o.next(()=>function(l){const d=l.store(Ps),h={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:fe.min().toTimestamp(),targetCount:0};return d.put(Bd,h)}(s))),r<4&&i>=4&&(r!==0&&(o=o.next(()=>function(l,d){return d.store(tr).J().next(f=>{l.deleteObjectStore(tr),l.createObjectStore(tr,{keyPath:EE,autoIncrement:!0}).createIndex(Ss,IE,{unique:!0});const m=d.store(tr),_=f.map(R=>m.put(R));return L.waitFor(_)})}(e,s))),o=o.next(()=>{(function(l){l.createObjectStore(fa,{keyPath:wO})})(e)})),r<5&&i>=5&&(o=o.next(()=>this.yi(s))),r<6&&i>=6&&(o=o.next(()=>(function(l){l.createObjectStore(dc)}(e),this.wi(s)))),r<7&&i>=7&&(o=o.next(()=>this.Si(s))),r<8&&i>=8&&(o=o.next(()=>this.bi(e,s))),r<9&&i>=9&&(o=o.next(()=>{(function(l){l.objectStoreNames.contains("remoteDocumentChanges")&&l.deleteObjectStore("remoteDocumentChanges")})(e)})),r<10&&i>=10&&(o=o.next(()=>this.Di(s))),r<11&&i>=11&&(o=o.next(()=>{(function(l){l.createObjectStore(Vh,{keyPath:EO})})(e),function(l){l.createObjectStore(Lh,{keyPath:IO})}(e)})),r<12&&i>=12&&(o=o.next(()=>{(function(l){const d=l.createObjectStore(Mh,{keyPath:RO});d.createIndex(Lm,PO,{unique:!1}),d.createIndex(ib,NO,{unique:!1})})(e)})),r<13&&i>=13&&(o=o.next(()=>function(l){const d=l.createObjectStore(Ud,{keyPath:fO});d.createIndex(Yu,pO),d.createIndex(eb,mO)}(e)).next(()=>this.Ci(e,s)).next(()=>e.deleteObjectStore(gs))),r<14&&i>=14&&(o=o.next(()=>this.Fi(e,s))),r<15&&i>=15&&(o=o.next(()=>function(l){l.createObjectStore(by,{keyPath:TO,autoIncrement:!0}).createIndex(Vm,xO,{unique:!1}),l.createObjectStore(jl,{keyPath:SO}).createIndex(nb,bO,{unique:!1}),l.createObjectStore(Ol,{keyPath:CO}).createIndex(rb,AO,{unique:!1})}(e))),r<16&&i>=16&&(o=o.next(()=>{n.objectStore(jl).clear()}).next(()=>{n.objectStore(Ol).clear()})),r<17&&i>=17&&(o=o.next(()=>{(function(l){l.createObjectStore(Cy,{keyPath:kO})})(e)})),r<18&&i>=18&&Yx()&&(o=o.next(()=>{n.objectStore(jl).clear()}).next(()=>{n.objectStore(Ol).clear()})),o}wi(e){let n=0;return e.store(gs).ee((r,i)=>{n+=Yd(i)}).next(()=>{const r={byteSize:n};return e.store(dc).put(Om,r)})}yi(e){const n=e.store(uc),r=e.store(tr);return n.J().next(i=>L.forEach(i,s=>{const o=IDBKeyRange.bound([s.userId,Rs],[s.userId,s.lastAcknowledgedBatchId]);return r.J(Ss,o).next(a=>L.forEach(a,l=>{ae(l.userId===s.userId,18650,"Cannot process batch from unexpected user",{batchId:l.batchId});const d=_s(this.serializer,l);return oC(e,s.userId,d).next(()=>{})}))}))}Si(e){const n=e.store(ha),r=e.store(gs);return e.store(Ps).get(Bd).next(i=>{const s=[];return r.ee((o,a)=>{const l=new Ue(o),d=function(f){return[0,an(f)]}(l);s.push(n.get(d).next(h=>h?L.resolve():(f=>n.put({targetId:0,path:an(f),sequenceNumber:i.highestListenSequenceNumber}))(l)))}).next(()=>L.waitFor(s))})}bi(e,n){e.createObjectStore(hc,{keyPath:vO});const r=n.store(hc),i=new By,s=o=>{if(i.add(o)){const a=o.lastSegment(),l=o.popLast();return r.put({collectionId:a,parent:an(l)})}};return n.store(gs).ee({X:!0},(o,a)=>{const l=new Ue(o);return s(l.popLast())}).next(()=>n.store(ua).ee({X:!0},([o,a,l],d)=>{const h=Tr(a);return s(h.popLast())}))}Di(e){const n=e.store(da);return n.ee((r,i)=>{const s=yl(i),o=tC(this.serializer,s);return n.put(o)})}Ci(e,n){const r=n.store(gs),i=[];return r.ee((s,o)=>{const a=n.store(Ud),l=function(f){return f.document?new Z(Ue.fromString(f.document.name).popFirst(5)):f.noDocument?Z.fromSegments(f.noDocument.path):f.unknownDocument?Z.fromSegments(f.unknownDocument.path):se(36783)}(o).path.toArray(),d={prefixPath:l.slice(0,l.length-2),collectionGroup:l[l.length-2],documentId:l[l.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};i.push(a.put(d))}).next(()=>L.waitFor(i))}Fi(e,n){const r=n.store(tr),i=hC(this.serializer),s=new zy(Yh.mi,this.serializer.yt);return r.J().next(o=>{const a=new Map;return o.forEach(l=>{let d=a.get(l.userId)??be();_s(this.serializer,l).keys().forEach(h=>d=d.add(h)),a.set(l.userId,d)}),L.forEach(a,(l,d)=>{const h=new Ht(d),f=Gh.wt(this.serializer,h),m=s.getIndexManager(h),_=Qh.wt(h,this.serializer,m,s.referenceDelegate);return new fC(i,_,f,m).recalculateAndSaveOverlaysForDocumentKeys(new Mm(n,qn.ce),l).next()})})}}function dI(t){t.createObjectStore(ha,{keyPath:yO}).createIndex(Sy,_O,{unique:!0}),t.createObjectStore(da,{keyPath:"targetId"}).createIndex(tb,gO,{unique:!0}),t.createObjectStore(Ps)}const pi="IndexedDbPersistence",dp=18e5,hp=5e3,fp="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",rL="main";class qy{constructor(e,n,r,i,s,o,a,l,d,h,f=18){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.Mi=s,this.window=o,this.document=a,this.xi=d,this.Oi=h,this.Ni=f,this.ci=null,this.li=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Bi=null,this.inForeground=!1,this.Li=null,this.ki=null,this.qi=Number.NEGATIVE_INFINITY,this.Qi=m=>Promise.resolve(),!qy.v())throw new K(U.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new qV(this,i),this.$i=n+rL,this.serializer=new eC(l),this.Ui=new Bi(this.$i,this.Ni,new nL(this.serializer)),this.hi=new kV,this.Pi=new UV(this.referenceDelegate,this.serializer),this.remoteDocumentCache=hC(this.serializer),this.Ii=new NV,this.window&&this.window.localStorage?this.Ki=this.window.localStorage:(this.Ki=null,h===!1&&dn(pi,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Wi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new K(U.FAILED_PRECONDITION,fp);return this.Gi(),this.zi(),this.ji(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Pi.getHighestSequenceNumber(e))}).then(e=>{this.ci=new qn(e,this.xi)}).then(()=>{this.li=!0}).catch(e=>(this.Ui&&this.Ui.close(),Promise.reject(e)))}Ji(e){return this.Qi=async n=>{if(this.started)return e(n)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ui.$(async n=>{n.newVersion===null&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Mi.enqueueAndForget(async()=>{this.started&&await this.Wi()}))}Wi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>Tu(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.Hi(e).next(n=>{n||(this.isPrimary=!1,this.Mi.enqueueRetryable(()=>this.Qi(!1)))})}).next(()=>this.Yi(e)).next(n=>this.isPrimary&&!n?this.Zi(e).next(()=>!1):!!n&&this.Xi(e).next(()=>!0))).catch(e=>{if(rs(e))return H(pi,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return H(pi,"Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.Mi.enqueueRetryable(()=>this.Qi(e)),this.isPrimary=e})}Hi(e){return sl(e).get(ho).next(n=>L.resolve(this.es(n)))}ts(e){return Tu(e).delete(this.clientId)}async ns(){if(this.isPrimary&&!this.rs(this.qi,dp)){this.qi=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",n=>{const r=Vt(n,fa);return r.J().next(i=>{const s=this.ss(i,dp),o=i.filter(a=>s.indexOf(a)===-1);return L.forEach(o,a=>r.delete(a.clientId)).next(()=>o)})}).catch(()=>[]);if(this.Ki)for(const n of e)this.Ki.removeItem(this._s(n.clientId))}}ji(){this.ki=this.Mi.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.Wi().then(()=>this.ns()).then(()=>this.ji()))}es(e){return!!e&&e.ownerId===this.clientId}Yi(e){return this.Oi?L.resolve(!0):sl(e).get(ho).next(n=>{if(n!==null&&this.rs(n.leaseTimestampMs,hp)&&!this.us(n.ownerId)){if(this.es(n)&&this.networkEnabled)return!0;if(!this.es(n)){if(!n.allowTabSynchronization)throw new K(U.FAILED_PRECONDITION,fp);return!1}}return!(!this.networkEnabled||!this.inForeground)||Tu(e).J().next(r=>this.ss(r,hp).find(i=>{if(this.clientId!==i.clientId){const s=!this.networkEnabled&&i.networkEnabled,o=!this.inForeground&&i.inForeground,a=this.networkEnabled===i.networkEnabled;if(s||o&&a)return!0}return!1})===void 0)}).next(n=>(this.isPrimary!==n&&H(pi,`Client ${n?"is":"is not"} eligible for a primary lease.`),n))}async shutdown(){this.li=!1,this.cs(),this.ki&&(this.ki.cancel(),this.ki=null),this.ls(),this.hs(),await this.Ui.runTransaction("shutdown","readwrite",[Pc,fa],e=>{const n=new Mm(e,qn.ce);return this.Zi(n).next(()=>this.ts(n))}),this.Ui.close(),this.Ps()}ss(e,n){return e.filter(r=>this.rs(r.updateTimeMs,n)&&!this.us(r.clientId))}Ts(){return this.runTransaction("getActiveClients","readonly",e=>Tu(e).J().next(n=>this.ss(n,dp).map(r=>r.clientId)))}get started(){return this.li}getGlobalsCache(){return this.hi}getMutationQueue(e,n){return Qh.wt(e,this.serializer,n,this.referenceDelegate)}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new FV(e,this.serializer.yt.databaseId)}getDocumentOverlayCache(e){return Gh.wt(this.serializer,e)}getBundleCache(){return this.Ii}runTransaction(e,n,r){H(pi,"Starting transaction:",e);const i=n==="readonly"?"readonly":"readwrite",s=function(l){return l===18?OO:l===17?lb:l===16?jO:l===15?Ay:l===14?ab:l===13?ob:l===12?DO:l===11?sb:void se(60245)}(this.Ni);let o;return this.Ui.runTransaction(e,i,s,a=>(o=new Mm(a,this.ci?this.ci.next():qn.ce),n==="readwrite-primary"?this.Hi(o).next(l=>!!l||this.Yi(o)).next(l=>{if(!l)throw dn(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Mi.enqueueRetryable(()=>this.Qi(!1)),new K(U.FAILED_PRECONDITION,YS);return r(o)}).next(l=>this.Xi(o).next(()=>l)):this.Is(o).next(()=>r(o)))).then(a=>(o.raiseOnCommittedEvent(),a))}Is(e){return sl(e).get(ho).next(n=>{if(n!==null&&this.rs(n.leaseTimestampMs,hp)&&!this.us(n.ownerId)&&!this.es(n)&&!(this.Oi||this.allowTabSynchronization&&n.allowTabSynchronization))throw new K(U.FAILED_PRECONDITION,fp)})}Xi(e){const n={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return sl(e).put(ho,n)}static v(){return Bi.v()}Zi(e){const n=sl(e);return n.get(ho).next(r=>this.es(r)?(H(pi,"Releasing primary lease."),n.delete(ho)):L.resolve())}rs(e,n){const r=Date.now();return!(e<r-n)&&(!(e>r)||(dn(`Detected an update time that is in the future: ${e} > ${r}`),!1))}Gi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Li=()=>{this.Mi.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.Wi()))},this.document.addEventListener("visibilitychange",this.Li),this.inForeground=this.document.visibilityState==="visible")}ls(){this.Li&&(this.document.removeEventListener("visibilitychange",this.Li),this.Li=null)}zi(){var e;typeof((e=this.window)==null?void 0:e.addEventListener)=="function"&&(this.Bi=()=>{this.cs();const n=/(?:Version|Mobile)\/1[456]/;Qx()&&(navigator.appVersion.match(n)||navigator.userAgent.match(n))&&this.Mi.enterRestrictedMode(!0),this.Mi.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Bi))}hs(){this.Bi&&(this.window.removeEventListener("pagehide",this.Bi),this.Bi=null)}us(e){var n;try{const r=((n=this.Ki)==null?void 0:n.getItem(this._s(e)))!==null;return H(pi,`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return dn(pi,"Failed to get zombied client id.",r),!1}}cs(){if(this.Ki)try{this.Ki.setItem(this._s(this.clientId),String(Date.now()))}catch(e){dn("Failed to set zombie client id.",e)}}Ps(){if(this.Ki)try{this.Ki.removeItem(this._s(this.clientId))}catch{}}_s(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function sl(t){return Vt(t,Pc)}function Tu(t){return Vt(t,fa)}function iL(t,e){let n=t.projectId;return t.isDefaultDatabase||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hy{constructor(e,n,r,i){this.targetId=e,this.fromCache=n,this.Es=r,this.ds=i}static As(e,n){let r=be(),i=be();for(const s of n.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new Hy(e,n.fromCache,r,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sL{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pC{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=function(){return Qx()?8:JS(Ot())>0?6:4}()}initialize(e,n){this.ps=e,this.indexManager=n,this.Rs=!0}getDocumentsMatchingQuery(e,n,r,i){const s={result:null};return this.ys(e,n).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.ws(e,n,i,r).next(o=>{s.result=o})}).next(()=>{if(s.result)return;const o=new sL;return this.Ss(e,n,o).next(a=>{if(s.result=a,this.Vs)return this.bs(e,n,o,a.size)})}).next(()=>s.result)}bs(e,n,r,i){return r.documentReadCount<this.fs?(xo()<=Pe.DEBUG&&H("QueryEngine","SDK will not create cache indexes for query:",So(n),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),L.resolve()):(xo()<=Pe.DEBUG&&H("QueryEngine","Query:",So(n),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.gs*i?(xo()<=Pe.DEBUG&&H("QueryEngine","The SDK decides to create cache indexes for query:",So(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Wn(n))):L.resolve())}ys(e,n){if(OE(n))return L.resolve(null);let r=Wn(n);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(n.limit!==null&&i===1&&(n=Hd(n,null,"F"),r=Wn(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{const o=be(...s);return this.ps.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,r).next(l=>{const d=this.Ds(n,a);return this.Cs(n,d,o,l.readTime)?this.ys(e,Hd(n,null,"F")):this.vs(e,d,n,l)}))})))}ws(e,n,r,i){return OE(n)||i.isEqual(fe.min())?L.resolve(null):this.ps.getDocuments(e,r).next(s=>{const o=this.Ds(n,s);return this.Cs(n,o,r,i)?L.resolve(null):(xo()<=Pe.DEBUG&&H("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),So(n)),this.vs(e,o,n,iO(i,ac)).next(a=>a))})}Ds(e,n){let r=new Ke(Ab(e));return n.forEach((i,s)=>{Dc(e,s)&&(r=r.add(s))}),r}Cs(e,n,r,i){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const s=e.limitType==="F"?n.last():n.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Ss(e,n,r){return xo()<=Pe.DEBUG&&H("QueryEngine","Using full collection scan to execute query:",So(n)),this.ps.getDocumentsMatchingQuery(e,n,On.min(),r)}vs(e,n,r,i){return this.ps.getDocumentsMatchingQuery(e,r,i).next(s=>(n.forEach(o=>{s=s.insert(o.key,o)}),s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wy="LocalStore",oL=3e8;class aL{constructor(e,n,r,i){this.persistence=e,this.Fs=n,this.serializer=i,this.Ms=new ct(Ee),this.xs=new ti(s=>Hs(s),Nc),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(r)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new fC(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.Ms))}}function mC(t,e,n,r){return new aL(t,e,n,r)}async function gC(t,e){const n=ve(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let i;return n.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,n.Bs(e),n.mutationQueue.getAllMutationBatches(r))).next(s=>{const o=[],a=[];let l=be();for(const d of i){o.push(d.batchId);for(const h of d.mutations)l=l.add(h.key)}for(const d of s){a.push(d.batchId);for(const h of d.mutations)l=l.add(h.key)}return n.localDocuments.getDocuments(r,l).next(d=>({Ls:d,removedBatchIds:o,addedBatchIds:a}))})})}function lL(t,e){const n=ve(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const i=e.batch.keys(),s=n.Ns.newChangeBuffer({trackRemovals:!0});return function(a,l,d,h){const f=d.batch,m=f.keys();let _=L.resolve();return m.forEach(R=>{_=_.next(()=>h.getEntry(l,R)).next(C=>{const y=d.docVersions.get(R);ae(y!==null,48541),C.version.compareTo(y)<0&&(f.applyToRemoteDocument(C,d),C.isValidDocument()&&(C.setReadTime(d.commitVersion),h.addEntry(C)))})}),_.next(()=>a.mutationQueue.removeMutationBatch(l,f))}(n,r,e,s).next(()=>s.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let l=be();for(let d=0;d<a.mutationResults.length;++d)a.mutationResults[d].transformResults.length>0&&(l=l.add(a.batch.mutations[d].key));return l}(e))).next(()=>n.localDocuments.getDocuments(r,i))})}function yC(t){const e=ve(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Pi.getLastRemoteSnapshotVersion(n))}function cL(t,e){const n=ve(t),r=e.snapshotVersion;let i=n.Ms;return n.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const o=n.Ns.newChangeBuffer({trackRemovals:!0});i=n.Ms;const a=[];e.targetChanges.forEach((h,f)=>{const m=i.get(f);if(!m)return;a.push(n.Pi.removeMatchingKeys(s,h.removedDocuments,f).next(()=>n.Pi.addMatchingKeys(s,h.addedDocuments,f)));let _=m.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(f)!==null?_=_.withResumeToken(Rt.EMPTY_BYTE_STRING,fe.min()).withLastLimboFreeSnapshotVersion(fe.min()):h.resumeToken.approximateByteSize()>0&&(_=_.withResumeToken(h.resumeToken,r)),i=i.insert(f,_),function(C,y,I){return C.resumeToken.approximateByteSize()===0||y.snapshotVersion.toMicroseconds()-C.snapshotVersion.toMicroseconds()>=oL?!0:I.addedDocuments.size+I.modifiedDocuments.size+I.removedDocuments.size>0}(m,_,h)&&a.push(n.Pi.updateTargetData(s,_))});let l=Nn(),d=be();if(e.documentUpdates.forEach(h=>{e.resolvedLimboDocuments.has(h)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(s,h))}),a.push(uL(s,o,e.documentUpdates).next(h=>{l=h.ks,d=h.qs})),!r.isEqual(fe.min())){const h=n.Pi.getLastRemoteSnapshotVersion(s).next(f=>n.Pi.setTargetsMetadata(s,s.currentSequenceNumber,r));a.push(h)}return L.waitFor(a).next(()=>o.apply(s)).next(()=>n.localDocuments.getLocalViewOfDocuments(s,l,d)).next(()=>l)}).then(s=>(n.Ms=i,s))}function uL(t,e,n){let r=be(),i=be();return n.forEach(s=>r=r.add(s)),e.getEntries(t,r).next(s=>{let o=Nn();return n.forEach((a,l)=>{const d=s.get(a);l.isFoundDocument()!==d.isFoundDocument()&&(i=i.add(a)),l.isNoDocument()&&l.version.isEqual(fe.min())?(e.removeEntry(a,l.readTime),o=o.insert(a,l)):!d.isValidDocument()||l.version.compareTo(d.version)>0||l.version.compareTo(d.version)===0&&d.hasPendingWrites?(e.addEntry(l),o=o.insert(a,l)):H(Wy,"Ignoring outdated watch update for ",a,". Current version:",d.version," Watch version:",l.version)}),{ks:o,qs:i}})}function dL(t,e){const n=ve(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=Rs),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function hL(t,e){const n=ve(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return n.Pi.getTargetData(r,e).next(s=>s?(i=s,L.resolve(i)):n.Pi.allocateTargetId(r).next(o=>(i=new Br(e,o,"TargetPurposeListen",r.currentSequenceNumber),n.Pi.addTargetData(r,i).next(()=>i))))}).then(r=>{const i=n.Ms.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(n.Ms=n.Ms.insert(r.targetId,r),n.xs.set(e,r.targetId)),r})}async function Jm(t,e,n){const r=ve(t),i=r.Ms.get(e),s=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",s,o=>r.persistence.referenceDelegate.removeTarget(o,i))}catch(o){if(!rs(o))throw o;H(Wy,`Failed to update sequence numbers for target ${e}: ${o}`)}r.Ms=r.Ms.remove(e),r.xs.delete(i.target)}function hI(t,e,n){const r=ve(t);let i=fe.min(),s=be();return r.persistence.runTransaction("Execute query","readwrite",o=>function(l,d,h){const f=ve(l),m=f.xs.get(h);return m!==void 0?L.resolve(f.Ms.get(m)):f.Pi.getTargetData(d,h)}(r,o,Wn(e)).next(a=>{if(a)return i=a.lastLimboFreeSnapshotVersion,r.Pi.getMatchingKeysForTargetId(o,a.targetId).next(l=>{s=l})}).next(()=>r.Fs.getDocumentsMatchingQuery(o,e,n?i:fe.min(),n?s:be())).next(a=>(fL(r,XO(e),a),{documents:a,Qs:s})))}function fL(t,e,n){let r=t.Os.get(e)||fe.min();n.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),t.Os.set(e,r)}class fI{constructor(){this.activeTargetIds=rV()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class _C{constructor(){this.Mo=new fI,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,n,r){this.xo[e]=n}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new fI,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pL{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pI="ConnectivityMonitor";class mI{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){H(pI,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){H(pI,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let xu=null;function Zm(){return xu===null?xu=function(){return 268435456+Math.round(2147483648*Math.random())}():xu++,"0x"+xu.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pp="RestConnection",mL={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class gL{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const n=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Uo=n+"://"+e.host,this.Ko=`projects/${r}/databases/${i}`,this.Wo=this.databaseId.database===$d?`project_id=${r}`:`project_id=${r}&database_id=${i}`}Go(e,n,r,i,s){const o=Zm(),a=this.zo(e,n.toUriEncodedString());H(pp,`Sending RPC '${e}' ${o}:`,a,r);const l={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(l,i,s);const{host:d}=new URL(a),h=es(d);return this.Jo(e,a,l,r,h).then(f=>(H(pp,`Received RPC '${e}' ${o}: `,f),f),f=>{throw $s(pp,`RPC '${e}' ${o} failed with error: `,f,"url: ",a,"request:",r),f})}Ho(e,n,r,i,s,o){return this.Go(e,n,r,i,s)}jo(e,n,r){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Pa}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((i,s)=>e[s]=i),r&&r.headers.forEach((i,s)=>e[s]=i)}zo(e,n){const r=mL[e];return`${this.Uo}/v1/${n}:${r}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yL{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jt="WebChannelConnection";class _L extends gL{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,n,r,i,s){const o=Zm();return new Promise((a,l)=>{const d=new FS;d.setWithCredentials(!0),d.listenOnce(US.COMPLETE,()=>{try{switch(d.getLastErrorCode()){case Ku.NO_ERROR:const f=d.getResponseJson();H(Jt,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(f)),a(f);break;case Ku.TIMEOUT:H(Jt,`RPC '${e}' ${o} timed out`),l(new K(U.DEADLINE_EXCEEDED,"Request time out"));break;case Ku.HTTP_ERROR:const m=d.getStatus();if(H(Jt,`RPC '${e}' ${o} failed with status:`,m,"response text:",d.getResponseText()),m>0){let _=d.getResponseJson();Array.isArray(_)&&(_=_[0]);const R=_==null?void 0:_.error;if(R&&R.status&&R.message){const C=function(I){const w=I.toLowerCase().replace(/_/g,"-");return Object.values(U).indexOf(w)>=0?w:U.UNKNOWN}(R.status);l(new K(C,R.message))}else l(new K(U.UNKNOWN,"Server responded with status "+d.getStatus()))}else l(new K(U.UNAVAILABLE,"Connection failed."));break;default:se(9055,{l_:e,streamId:o,h_:d.getLastErrorCode(),P_:d.getLastError()})}}finally{H(Jt,`RPC '${e}' ${o} completed.`)}});const h=JSON.stringify(i);H(Jt,`RPC '${e}' ${o} sending request:`,i),d.send(n,"POST",h,r,15)})}T_(e,n,r){const i=Zm(),s=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=zS(),a=$S(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},d=this.longPollingOptions.timeoutSeconds;d!==void 0&&(l.longPollingTimeout=Math.round(1e3*d)),this.useFetchStreams&&(l.useFetchStreams=!0),this.jo(l.initMessageHeaders,n,r),l.encodeInitMessageHeaders=!0;const h=s.join("");H(Jt,`Creating RPC '${e}' stream ${i}: ${h}`,l);const f=o.createWebChannel(h,l);this.I_(f);let m=!1,_=!1;const R=new yL({Yo:y=>{_?H(Jt,`Not sending because RPC '${e}' stream ${i} is closed:`,y):(m||(H(Jt,`Opening RPC '${e}' stream ${i} transport.`),f.open(),m=!0),H(Jt,`RPC '${e}' stream ${i} sending:`,y),f.send(y))},Zo:()=>f.close()}),C=(y,I,w)=>{y.listen(I,E=>{try{w(E)}catch(O){setTimeout(()=>{throw O},0)}})};return C(f,pl.EventType.OPEN,()=>{_||(H(Jt,`RPC '${e}' stream ${i} transport opened.`),R.o_())}),C(f,pl.EventType.CLOSE,()=>{_||(_=!0,H(Jt,`RPC '${e}' stream ${i} transport closed`),R.a_(),this.E_(f))}),C(f,pl.EventType.ERROR,y=>{_||(_=!0,$s(Jt,`RPC '${e}' stream ${i} transport errored. Name:`,y.name,"Message:",y.message),R.a_(new K(U.UNAVAILABLE,"The operation could not be completed")))}),C(f,pl.EventType.MESSAGE,y=>{var I;if(!_){const w=y.data[0];ae(!!w,16349);const E=w,O=(E==null?void 0:E.error)||((I=E[0])==null?void 0:I.error);if(O){H(Jt,`RPC '${e}' stream ${i} received error:`,O);const D=O.status;let B=function(b){const A=bt[b];if(A!==void 0)return Bb(A)}(D),x=O.message;B===void 0&&(B=U.INTERNAL,x="Unknown error status: "+D+" with message "+O.message),_=!0,R.a_(new K(B,x)),f.close()}else H(Jt,`RPC '${e}' stream ${i} received:`,w),R.u_(w)}}),C(a,BS.STAT_EVENT,y=>{y.stat===km.PROXY?H(Jt,`RPC '${e}' stream ${i} detected buffering proxy`):y.stat===km.NOPROXY&&H(Jt,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{R.__()},0),R}terminate(){this.c_.forEach(e=>e.close()),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter(n=>n===e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vL(){return typeof window<"u"?window:null}function rd(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xh(t){return new vV(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vC{constructor(e,n,r=1e3,i=1.5,s=6e4){this.Mi=e,this.timerId=n,this.d_=r,this.A_=i,this.R_=s,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const n=Math.floor(this.V_+this.y_()),r=Math.max(0,Date.now()-this.f_),i=Math.max(0,n-r);i>0&&H("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.V_} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,i,()=>(this.f_=Date.now(),e())),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gI="PersistentStream";class wC{constructor(e,n,r,i,s,o,a,l){this.Mi=e,this.S_=r,this.b_=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=l,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new vC(e,n)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,()=>this.k_()))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,n){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():n&&n.code===U.RESOURCE_EXHAUSTED?(dn(n.toString()),dn("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):n&&n.code===U.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(n)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),n=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.D_===n&&this.G_(r,i)},r=>{e(()=>{const i=new K(U.UNKNOWN,"Fetching auth token failed: "+r.message);return this.z_(i)})})}G_(e,n){const r=this.W_(this.D_);this.stream=this.j_(e,n),this.stream.Xo(()=>{r(()=>this.listener.Xo())}),this.stream.t_(()=>{r(()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.t_()))}),this.stream.r_(i=>{r(()=>this.z_(i))}),this.stream.onMessage(i=>{r(()=>++this.F_==1?this.J_(i):this.onNext(i))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return H(gI,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return n=>{this.Mi.enqueueAndForget(()=>this.D_===e?n():(H(gI,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class wL extends wC{constructor(e,n,r,i,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s}j_(e,n){return this.connection.T_("Listen",e,n)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const n=IV(this.serializer,e),r=function(s){if(!("targetChange"in s))return fe.min();const o=s.targetChange;return o.targetIds&&o.targetIds.length?fe.min():o.readTime?pn(o.readTime):fe.min()}(e);return this.listener.H_(n,r)}Y_(e){const n={};n.database=Km(this.serializer),n.addTarget=function(s,o){let a;const l=o.target;if(a=zd(l)?{documents:Qb(s,l)}:{query:Fy(s,l).ft},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=qb(s,o.resumeToken);const d=Hm(s,o.expectedCount);d!==null&&(a.expectedCount=d)}else if(o.snapshotVersion.compareTo(fe.min())>0){a.readTime=wa(s,o.snapshotVersion.toTimestamp());const d=Hm(s,o.expectedCount);d!==null&&(a.expectedCount=d)}return a}(this.serializer,e);const r=SV(this.serializer,e);r&&(n.labels=r),this.q_(n)}Z_(e){const n={};n.database=Km(this.serializer),n.removeTarget=e,this.q_(n)}}class EL extends wC{constructor(e,n,r,i,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,n){return this.connection.T_("Write",e,n)}J_(e){return ae(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,ae(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){ae(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const n=TV(e.writeResults,e.commitTime),r=pn(e.commitTime);return this.listener.na(r,n)}ra(){const e={};e.database=Km(this.serializer),this.q_(e)}ea(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>Kd(this.serializer,r))};this.q_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IL{}class TL extends IL{constructor(e,n,r,i){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=i,this.ia=!1}sa(){if(this.ia)throw new K(U.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,n,r,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.Go(e,Wm(n,r),i,s,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===U.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new K(U.UNKNOWN,s.toString())})}Ho(e,n,r,i,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.Ho(e,Wm(n,r),i,o,a,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===U.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new K(U.UNKNOWN,o.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}class xL{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(dn(n),this.aa=!1):H("OnlineStateTracker",n)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ys="RemoteStore";class SL{constructor(e,n,r,i,s){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=s,this.Aa.Oo(o=>{r.enqueueAndForget(async()=>{oo(this)&&(H(Ys,"Restarting streams for network reachability change."),await async function(l){const d=ve(l);d.Ea.add(4),await Oc(d),d.Ra.set("Unknown"),d.Ea.delete(4),await Jh(d)}(this))})}),this.Ra=new xL(r,i)}}async function Jh(t){if(oo(t))for(const e of t.da)await e(!0)}async function Oc(t){for(const e of t.da)await e(!1)}function EC(t,e){const n=ve(t);n.Ia.has(e.targetId)||(n.Ia.set(e.targetId,e),Yy(n)?Qy(n):ka(n).O_()&&Gy(n,e))}function Ky(t,e){const n=ve(t),r=ka(n);n.Ia.delete(e),r.O_()&&IC(n,e),n.Ia.size===0&&(r.O_()?r.L_():oo(n)&&n.Ra.set("Unknown"))}function Gy(t,e){if(t.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(fe.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}ka(t).Y_(e)}function IC(t,e){t.Va.Ue(e),ka(t).Z_(e)}function Qy(t){t.Va=new mV({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),At:e=>t.Ia.get(e)||null,ht:()=>t.datastore.serializer.databaseId}),ka(t).start(),t.Ra.ua()}function Yy(t){return oo(t)&&!ka(t).x_()&&t.Ia.size>0}function oo(t){return ve(t).Ea.size===0}function TC(t){t.Va=void 0}async function bL(t){t.Ra.set("Online")}async function CL(t){t.Ia.forEach((e,n)=>{Gy(t,e)})}async function AL(t,e){TC(t),Yy(t)?(t.Ra.ha(e),Qy(t)):t.Ra.set("Unknown")}async function RL(t,e,n){if(t.Ra.set("Online"),e instanceof zb&&e.state===2&&e.cause)try{await async function(i,s){const o=s.cause;for(const a of s.targetIds)i.Ia.has(a)&&(await i.remoteSyncer.rejectListen(a,o),i.Ia.delete(a),i.Va.removeTarget(a))}(t,e)}catch(r){H(Ys,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await Jd(t,r)}else if(e instanceof td?t.Va.Ze(e):e instanceof $b?t.Va.st(e):t.Va.tt(e),!n.isEqual(fe.min()))try{const r=await yC(t.localStore);n.compareTo(r)>=0&&await function(s,o){const a=s.Va.Tt(o);return a.targetChanges.forEach((l,d)=>{if(l.resumeToken.approximateByteSize()>0){const h=s.Ia.get(d);h&&s.Ia.set(d,h.withResumeToken(l.resumeToken,o))}}),a.targetMismatches.forEach((l,d)=>{const h=s.Ia.get(l);if(!h)return;s.Ia.set(l,h.withResumeToken(Rt.EMPTY_BYTE_STRING,h.snapshotVersion)),IC(s,l);const f=new Br(h.target,l,d,h.sequenceNumber);Gy(s,f)}),s.remoteSyncer.applyRemoteEvent(a)}(t,n)}catch(r){H(Ys,"Failed to raise snapshot:",r),await Jd(t,r)}}async function Jd(t,e,n){if(!rs(e))throw e;t.Ea.add(1),await Oc(t),t.Ra.set("Offline"),n||(n=()=>yC(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{H(Ys,"Retrying IndexedDB access"),await n(),t.Ea.delete(1),await Jh(t)})}function xC(t,e){return e().catch(n=>Jd(t,n,e))}async function Vc(t){const e=ve(t),n=Gi(e);let r=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:Rs;for(;PL(e);)try{const i=await dL(e.localStore,r);if(i===null){e.Ta.length===0&&n.L_();break}r=i.batchId,NL(e,i)}catch(i){await Jd(e,i)}SC(e)&&bC(e)}function PL(t){return oo(t)&&t.Ta.length<10}function NL(t,e){t.Ta.push(e);const n=Gi(t);n.O_()&&n.X_&&n.ea(e.mutations)}function SC(t){return oo(t)&&!Gi(t).x_()&&t.Ta.length>0}function bC(t){Gi(t).start()}async function kL(t){Gi(t).ra()}async function DL(t){const e=Gi(t);for(const n of t.Ta)e.ea(n.mutations)}async function jL(t,e,n){const r=t.Ta.shift(),i=Oy.from(r,e,n);await xC(t,()=>t.remoteSyncer.applySuccessfulWrite(i)),await Vc(t)}async function OL(t,e){e&&Gi(t).X_&&await async function(r,i){if(function(o){return hV(o)&&o!==U.ABORTED}(i.code)){const s=r.Ta.shift();Gi(r).B_(),await xC(r,()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i)),await Vc(r)}}(t,e),SC(t)&&bC(t)}async function yI(t,e){const n=ve(t);n.asyncQueue.verifyOperationInProgress(),H(Ys,"RemoteStore received new credentials");const r=oo(n);n.Ea.add(3),await Oc(n),r&&n.Ra.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.Ea.delete(3),await Jh(n)}async function VL(t,e){const n=ve(t);e?(n.Ea.delete(2),await Jh(n)):e||(n.Ea.add(2),await Oc(n),n.Ra.set("Unknown"))}function ka(t){return t.ma||(t.ma=function(n,r,i){const s=ve(n);return s.sa(),new wL(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Xo:bL.bind(null,t),t_:CL.bind(null,t),r_:AL.bind(null,t),H_:RL.bind(null,t)}),t.da.push(async e=>{e?(t.ma.B_(),Yy(t)?Qy(t):t.Ra.set("Unknown")):(await t.ma.stop(),TC(t))})),t.ma}function Gi(t){return t.fa||(t.fa=function(n,r,i){const s=ve(n);return s.sa(),new EL(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Xo:()=>Promise.resolve(),t_:kL.bind(null,t),r_:OL.bind(null,t),ta:DL.bind(null,t),na:jL.bind(null,t)}),t.da.push(async e=>{e?(t.fa.B_(),await Vc(t)):(await t.fa.stop(),t.Ta.length>0&&(H(Ys,`Stopping write stream with ${t.Ta.length} pending writes`),t.Ta=[]))})),t.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xy{constructor(e,n,r,i,s){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new ar,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,i,s){const o=Date.now()+r,a=new Xy(e,n,o,i,s);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new K(U.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Jy(t,e){if(dn("AsyncQueue",`${e}: ${t}`),rs(t))return new K(U.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xo{static emptySet(e){return new Xo(e.comparator)}constructor(e){this.comparator=e?(n,r)=>e(n,r)||Z.comparator(n.key,r.key):(n,r)=>Z.comparator(n.key,r.key),this.keyedMap=ml(),this.sortedSet=new ct(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof Xo)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const i=n.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new Xo;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _I{constructor(){this.ga=new ct(Z.comparator)}track(e){const n=e.doc.key,r=this.ga.get(n);r?e.type!==0&&r.type===3?this.ga=this.ga.insert(n,e):e.type===3&&r.type!==1?this.ga=this.ga.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.ga=this.ga.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.ga=this.ga.remove(n):e.type===1&&r.type===2?this.ga=this.ga.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):se(63341,{Rt:e,pa:r}):this.ga=this.ga.insert(n,e)}ya(){const e=[];return this.ga.inorderTraversal((n,r)=>{e.push(r)}),e}}class Ea{constructor(e,n,r,i,s,o,a,l,d){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=l,this.hasCachedResults=d}static fromInitialDocuments(e,n,r,i,s){const o=[];return n.forEach(a=>{o.push({type:0,doc:a})}),new Ea(e,n,Xo.emptySet(n),o,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&$h(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let i=0;i<n.length;i++)if(n[i].type!==r[i].type||!n[i].doc.isEqual(r[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LL{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some(e=>e.Da())}}class ML{constructor(){this.queries=vI(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(n,r){const i=ve(n),s=i.queries;i.queries=vI(),s.forEach((o,a)=>{for(const l of a.Sa)l.onError(r)})})(this,new K(U.ABORTED,"Firestore shutting down"))}}function vI(){return new ti(t=>Cb(t),$h)}async function Zy(t,e){const n=ve(t);let r=3;const i=e.query;let s=n.queries.get(i);s?!s.ba()&&e.Da()&&(r=2):(s=new LL,r=e.Da()?0:1);try{switch(r){case 0:s.wa=await n.onListen(i,!0);break;case 1:s.wa=await n.onListen(i,!1);break;case 2:await n.onFirstRemoteStoreListen(i)}}catch(o){const a=Jy(o,`Initialization of query '${So(e.query)}' failed`);return void e.onError(a)}n.queries.set(i,s),s.Sa.push(e),e.va(n.onlineState),s.wa&&e.Fa(s.wa)&&t_(n)}async function e_(t,e){const n=ve(t),r=e.query;let i=3;const s=n.queries.get(r);if(s){const o=s.Sa.indexOf(e);o>=0&&(s.Sa.splice(o,1),s.Sa.length===0?i=e.Da()?0:1:!s.ba()&&e.Da()&&(i=2))}switch(i){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function FL(t,e){const n=ve(t);let r=!1;for(const i of e){const s=i.query,o=n.queries.get(s);if(o){for(const a of o.Sa)a.Fa(i)&&(r=!0);o.wa=i}}r&&t_(n)}function UL(t,e,n){const r=ve(t),i=r.queries.get(e);if(i)for(const s of i.Sa)s.onError(n);r.queries.delete(e)}function t_(t){t.Ca.forEach(e=>{e.next()})}var eg,wI;(wI=eg||(eg={})).Ma="default",wI.Cache="cache";class n_{constructor(e,n,r){this.query=e,this.xa=n,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=r||{}}Fa(e){if(!this.options.includeMetadataChanges){const r=[];for(const i of e.docChanges)i.type!==3&&r.push(i);e=new Ea(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),n=!0):this.La(e,this.onlineState)&&(this.ka(e),n=!0),this.Na=e,n}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let n=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),n=!0),n}La(e,n){if(!e.fromCache||!this.Da())return!0;const r=n!=="Offline";return(!this.options.qa||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const n=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}ka(e){e=Ea.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==eg.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CC{constructor(e){this.key=e}}class AC{constructor(e){this.key=e}}class BL{constructor(e,n){this.query=e,this.Ya=n,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=be(),this.mutatedKeys=be(),this.eu=Ab(e),this.tu=new Xo(this.eu)}get nu(){return this.Ya}ru(e,n){const r=n?n.iu:new _I,i=n?n.tu:this.tu;let s=n?n.mutatedKeys:this.mutatedKeys,o=i,a=!1;const l=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,d=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((h,f)=>{const m=i.get(h),_=Dc(this.query,f)?f:null,R=!!m&&this.mutatedKeys.has(m.key),C=!!_&&(_.hasLocalMutations||this.mutatedKeys.has(_.key)&&_.hasCommittedMutations);let y=!1;m&&_?m.data.isEqual(_.data)?R!==C&&(r.track({type:3,doc:_}),y=!0):this.su(m,_)||(r.track({type:2,doc:_}),y=!0,(l&&this.eu(_,l)>0||d&&this.eu(_,d)<0)&&(a=!0)):!m&&_?(r.track({type:0,doc:_}),y=!0):m&&!_&&(r.track({type:1,doc:m}),y=!0,(l||d)&&(a=!0)),y&&(_?(o=o.add(_),s=C?s.add(h):s.delete(h)):(o=o.delete(h),s=s.delete(h)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const h=this.query.limitType==="F"?o.last():o.first();o=o.delete(h.key),s=s.delete(h.key),r.track({type:1,doc:h})}return{tu:o,iu:r,Cs:a,mutatedKeys:s}}su(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,i){const s=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const o=e.iu.ya();o.sort((h,f)=>function(_,R){const C=y=>{switch(y){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return se(20277,{Rt:y})}};return C(_)-C(R)}(h.type,f.type)||this.eu(h.doc,f.doc)),this.ou(r),i=i??!1;const a=n&&!i?this._u():[],l=this.Xa.size===0&&this.current&&!i?1:0,d=l!==this.Za;return this.Za=l,o.length!==0||d?{snapshot:new Ea(this.query,e.tu,s,o,e.mutatedKeys,l===0,d,!1,!!r&&r.resumeToken.approximateByteSize()>0),au:a}:{au:a}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new _I,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(n=>this.Ya=this.Ya.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Ya=this.Ya.delete(n)),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=be(),this.tu.forEach(r=>{this.uu(r.key)&&(this.Xa=this.Xa.add(r.key))});const n=[];return e.forEach(r=>{this.Xa.has(r)||n.push(new AC(r))}),this.Xa.forEach(r=>{e.has(r)||n.push(new CC(r))}),n}cu(e){this.Ya=e.Qs,this.Xa=be();const n=this.ru(e.documents);return this.applyChanges(n,!0)}lu(){return Ea.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const r_="SyncEngine";class $L{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class zL{constructor(e){this.key=e,this.hu=!1}}class qL{constructor(e,n,r,i,s,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.Pu={},this.Tu=new ti(a=>Cb(a),$h),this.Iu=new Map,this.Eu=new Set,this.du=new ct(Z.comparator),this.Au=new Map,this.Ru=new $y,this.Vu={},this.mu=new Map,this.fu=Qs.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function HL(t,e,n=!0){const r=jC(t);let i;const s=r.Tu.get(e);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.lu()):i=await RC(r,e,n,!0),i}async function WL(t,e){const n=jC(t);await RC(n,e,!0,!1)}async function RC(t,e,n,r){const i=await hL(t.localStore,Wn(e)),s=i.targetId,o=t.sharedClientState.addLocalQueryTarget(s,n);let a;return r&&(a=await KL(t,e,s,o==="current",i.resumeToken)),t.isPrimaryClient&&n&&EC(t.remoteStore,i),a}async function KL(t,e,n,r,i){t.pu=(f,m,_)=>async function(C,y,I,w){let E=y.view.ru(I);E.Cs&&(E=await hI(C.localStore,y.query,!1).then(({documents:x})=>y.view.ru(x,E)));const O=w&&w.targetChanges.get(y.targetId),D=w&&w.targetMismatches.get(y.targetId)!=null,B=y.view.applyChanges(E,C.isPrimaryClient,O,D);return II(C,y.targetId,B.au),B.snapshot}(t,f,m,_);const s=await hI(t.localStore,e,!0),o=new BL(e,s.Qs),a=o.ru(s.documents),l=jc.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",i),d=o.applyChanges(a,t.isPrimaryClient,l);II(t,n,d.au);const h=new $L(e,n,o);return t.Tu.set(e,h),t.Iu.has(n)?t.Iu.get(n).push(e):t.Iu.set(n,[e]),d.snapshot}async function GL(t,e,n){const r=ve(t),i=r.Tu.get(e),s=r.Iu.get(i.targetId);if(s.length>1)return r.Iu.set(i.targetId,s.filter(o=>!$h(o,e))),void r.Tu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await Jm(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),n&&Ky(r.remoteStore,i.targetId),tg(r,i.targetId)}).catch(so)):(tg(r,i.targetId),await Jm(r.localStore,i.targetId,!0))}async function QL(t,e){const n=ve(t),r=n.Tu.get(e),i=n.Iu.get(r.targetId);n.isPrimaryClient&&i.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),Ky(n.remoteStore,r.targetId))}async function YL(t,e,n){const r=OC(t);try{const i=await function(o,a){const l=ve(o),d=Le.now(),h=a.reduce((_,R)=>_.add(R.key),be());let f,m;return l.persistence.runTransaction("Locally write mutations","readwrite",_=>{let R=Nn(),C=be();return l.Ns.getEntries(_,h).next(y=>{R=y,R.forEach((I,w)=>{w.isValidDocument()||(C=C.add(I))})}).next(()=>l.localDocuments.getOverlayedDocuments(_,R)).next(y=>{f=y;const I=[];for(const w of a){const E=cV(w,f.get(w.key).overlayedDocument);E!=null&&I.push(new ni(w.key,E,_b(E.value.mapValue),sn.exists(!0)))}return l.mutationQueue.addMutationBatch(_,d,I,a)}).next(y=>{m=y;const I=y.applyToLocalDocumentSet(f,C);return l.documentOverlayCache.saveOverlays(_,y.batchId,I)})}).then(()=>({batchId:m.batchId,changes:Pb(f)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(o,a,l){let d=o.Vu[o.currentUser.toKey()];d||(d=new ct(Ee)),d=d.insert(a,l),o.Vu[o.currentUser.toKey()]=d}(r,i.batchId,n),await Lc(r,i.changes),await Vc(r.remoteStore)}catch(i){const s=Jy(i,"Failed to persist write");n.reject(s)}}async function PC(t,e){const n=ve(t);try{const r=await cL(n.localStore,e);e.targetChanges.forEach((i,s)=>{const o=n.Au.get(s);o&&(ae(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?o.hu=!0:i.modifiedDocuments.size>0?ae(o.hu,14607):i.removedDocuments.size>0&&(ae(o.hu,42227),o.hu=!1))}),await Lc(n,r,e)}catch(r){await so(r)}}function EI(t,e,n){const r=ve(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const i=[];r.Tu.forEach((s,o)=>{const a=o.view.va(e);a.snapshot&&i.push(a.snapshot)}),function(o,a){const l=ve(o);l.onlineState=a;let d=!1;l.queries.forEach((h,f)=>{for(const m of f.Sa)m.va(a)&&(d=!0)}),d&&t_(l)}(r.eventManager,e),i.length&&r.Pu.H_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function XL(t,e,n){const r=ve(t);r.sharedClientState.updateQueryState(e,"rejected",n);const i=r.Au.get(e),s=i&&i.key;if(s){let o=new ct(Z.comparator);o=o.insert(s,yt.newNoDocument(s,fe.min()));const a=be().add(s),l=new Kh(fe.min(),new Map,new ct(Ee),o,a);await PC(r,l),r.du=r.du.remove(s),r.Au.delete(e),i_(r)}else await Jm(r.localStore,e,!1).then(()=>tg(r,e,n)).catch(so)}async function JL(t,e){const n=ve(t),r=e.batch.batchId;try{const i=await lL(n.localStore,e);kC(n,r,null),NC(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await Lc(n,i)}catch(i){await so(i)}}async function ZL(t,e,n){const r=ve(t);try{const i=await function(o,a){const l=ve(o);return l.persistence.runTransaction("Reject batch","readwrite-primary",d=>{let h;return l.mutationQueue.lookupMutationBatch(d,a).next(f=>(ae(f!==null,37113),h=f.keys(),l.mutationQueue.removeMutationBatch(d,f))).next(()=>l.mutationQueue.performConsistencyCheck(d)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(d,h,a)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(d,h)).next(()=>l.localDocuments.getDocuments(d,h))})}(r.localStore,e);kC(r,e,n),NC(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await Lc(r,i)}catch(i){await so(i)}}function NC(t,e){(t.mu.get(e)||[]).forEach(n=>{n.resolve()}),t.mu.delete(e)}function kC(t,e,n){const r=ve(t);let i=r.Vu[r.currentUser.toKey()];if(i){const s=i.get(e);s&&(n?s.reject(n):s.resolve(),i=i.remove(e)),r.Vu[r.currentUser.toKey()]=i}}function tg(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Iu.get(e))t.Tu.delete(r),n&&t.Pu.yu(r,n);t.Iu.delete(e),t.isPrimaryClient&&t.Ru.jr(e).forEach(r=>{t.Ru.containsKey(r)||DC(t,r)})}function DC(t,e){t.Eu.delete(e.path.canonicalString());const n=t.du.get(e);n!==null&&(Ky(t.remoteStore,n),t.du=t.du.remove(e),t.Au.delete(n),i_(t))}function II(t,e,n){for(const r of n)r instanceof CC?(t.Ru.addReference(r.key,e),eM(t,r)):r instanceof AC?(H(r_,"Document no longer in limbo: "+r.key),t.Ru.removeReference(r.key,e),t.Ru.containsKey(r.key)||DC(t,r.key)):se(19791,{wu:r})}function eM(t,e){const n=e.key,r=n.path.canonicalString();t.du.get(n)||t.Eu.has(r)||(H(r_,"New document in limbo: "+n),t.Eu.add(r),i_(t))}function i_(t){for(;t.Eu.size>0&&t.du.size<t.maxConcurrentLimboResolutions;){const e=t.Eu.values().next().value;t.Eu.delete(e);const n=new Z(Ue.fromString(e)),r=t.fu.next();t.Au.set(r,new zL(n)),t.du=t.du.insert(n,r),EC(t.remoteStore,new Br(Wn(kc(n.path)),r,"TargetPurposeLimboResolution",qn.ce))}}async function Lc(t,e,n){const r=ve(t),i=[],s=[],o=[];r.Tu.isEmpty()||(r.Tu.forEach((a,l)=>{o.push(r.pu(l,e,n).then(d=>{var h;if((d||n)&&r.isPrimaryClient){const f=d?!d.fromCache:(h=n==null?void 0:n.targetChanges.get(l.targetId))==null?void 0:h.current;r.sharedClientState.updateQueryState(l.targetId,f?"current":"not-current")}if(d){i.push(d);const f=Hy.As(l.targetId,d);s.push(f)}}))}),await Promise.all(o),r.Pu.H_(i),await async function(l,d){const h=ve(l);try{await h.persistence.runTransaction("notifyLocalViewChanges","readwrite",f=>L.forEach(d,m=>L.forEach(m.Es,_=>h.persistence.referenceDelegate.addReference(f,m.targetId,_)).next(()=>L.forEach(m.ds,_=>h.persistence.referenceDelegate.removeReference(f,m.targetId,_)))))}catch(f){if(!rs(f))throw f;H(Wy,"Failed to update sequence numbers: "+f)}for(const f of d){const m=f.targetId;if(!f.fromCache){const _=h.Ms.get(m),R=_.snapshotVersion,C=_.withLastLimboFreeSnapshotVersion(R);h.Ms=h.Ms.insert(m,C)}}}(r.localStore,s))}async function tM(t,e){const n=ve(t);if(!n.currentUser.isEqual(e)){H(r_,"User change. New user:",e.toKey());const r=await gC(n.localStore,e);n.currentUser=e,function(s,o){s.mu.forEach(a=>{a.forEach(l=>{l.reject(new K(U.CANCELLED,o))})}),s.mu.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await Lc(n,r.Ls)}}function nM(t,e){const n=ve(t),r=n.Au.get(e);if(r&&r.hu)return be().add(r.key);{let i=be();const s=n.Iu.get(e);if(!s)return i;for(const o of s){const a=n.Tu.get(o);i=i.unionWith(a.view.nu)}return i}}function jC(t){const e=ve(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=PC.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=nM.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=XL.bind(null,e),e.Pu.H_=FL.bind(null,e.eventManager),e.Pu.yu=UL.bind(null,e.eventManager),e}function OC(t){const e=ve(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=JL.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=ZL.bind(null,e),e}class yc{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Xh(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,n){return null}Mu(e,n){return null}vu(e){return mC(this.persistence,new pC,e.initialUser,this.serializer)}Cu(e){return new zy(Yh.mi,this.serializer)}Du(e){return new _C}async terminate(){var e,n;(e=this.gcScheduler)==null||e.stop(),(n=this.indexBackfillerScheduler)==null||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}yc.provider={build:()=>new yc};class rM extends yc{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,n){ae(this.persistence.referenceDelegate instanceof Xd,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new cC(r,e.asyncQueue,n)}Cu(e){const n=this.cacheSizeBytes!==void 0?Zt.withCacheSize(this.cacheSizeBytes):Zt.DEFAULT;return new zy(r=>Xd.mi(r,n),this.serializer)}}class iM extends yc{constructor(e,n,r){super(),this.xu=e,this.cacheSizeBytes=n,this.forceOwnership=r,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.xu.initialize(this,e),await OC(this.xu.syncEngine),await Vc(this.xu.remoteStore),await this.persistence.Ji(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}vu(e){return mC(this.persistence,new pC,e.initialUser,this.serializer)}Fu(e,n){const r=this.persistence.referenceDelegate.garbageCollector;return new cC(r,e.asyncQueue,n)}Mu(e,n){const r=new lO(n,this.persistence);return new aO(e.asyncQueue,r)}Cu(e){const n=iL(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?Zt.withCacheSize(this.cacheSizeBytes):Zt.DEFAULT;return new qy(this.synchronizeTabs,n,e.clientId,r,e.asyncQueue,vL(),rd(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Du(e){return new _C}}class Zd{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>EI(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=tM.bind(null,this.syncEngine),await VL(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new ML}()}createDatastore(e){const n=Xh(e.databaseInfo.databaseId),r=function(s){return new _L(s)}(e.databaseInfo);return function(s,o,a,l){return new TL(s,o,a,l)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,i,s,o,a){return new SL(r,i,s,o,a)}(this.localStore,this.datastore,e.asyncQueue,n=>EI(this.syncEngine,n,0),function(){return mI.v()?new mI:new pL}())}createSyncEngine(e,n){return function(i,s,o,a,l,d,h){const f=new qL(i,s,o,a,l,d);return h&&(f.gu=!0),f}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(i){const s=ve(i);H(Ys,"RemoteStore shutting down."),s.Ea.add(5),await Oc(s),s.Aa.shutdown(),s.Ra.set("Unknown")}(this.remoteStore),(e=this.datastore)==null||e.terminate(),(n=this.eventManager)==null||n.terminate()}}Zd.provider={build:()=>new Zd};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s_{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):dn("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qi="FirestoreClient";class sM{constructor(e,n,r,i,s){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=i,this.user=Ht.UNAUTHENTICATED,this.clientId=Iy.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(r,async o=>{H(Qi,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>(H(Qi,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new ar;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=Jy(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function mp(t,e){t.asyncQueue.verifyOperationInProgress(),H(Qi,"Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async i=>{r.isEqual(i)||(await gC(e.localStore,i),r=i)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function TI(t,e){t.asyncQueue.verifyOperationInProgress();const n=await oM(t);H(Qi,"Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>yI(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,i)=>yI(e.remoteStore,i)),t._onlineComponents=e}async function oM(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){H(Qi,"Using user provided OfflineComponentProvider");try{await mp(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(i){return i.name==="FirebaseError"?i.code===U.FAILED_PRECONDITION||i.code===U.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(n))throw n;$s("Error using user provided cache. Falling back to memory cache: "+n),await mp(t,new yc)}}else H(Qi,"Using default OfflineComponentProvider"),await mp(t,new rM(void 0));return t._offlineComponents}async function o_(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(H(Qi,"Using user provided OnlineComponentProvider"),await TI(t,t._uninitializedComponentsProvider._online)):(H(Qi,"Using default OnlineComponentProvider"),await TI(t,new Zd))),t._onlineComponents}function aM(t){return o_(t).then(e=>e.syncEngine)}function lM(t){return o_(t).then(e=>e.datastore)}async function eh(t){const e=await o_(t),n=e.eventManager;return n.onListen=HL.bind(null,e.syncEngine),n.onUnlisten=GL.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=WL.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=QL.bind(null,e.syncEngine),n}function cM(t,e,n={}){const r=new ar;return t.asyncQueue.enqueueAndForget(async()=>function(s,o,a,l,d){const h=new s_({next:m=>{h.Nu(),o.enqueueAndForget(()=>e_(s,f));const _=m.docs.has(a);!_&&m.fromCache?d.reject(new K(U.UNAVAILABLE,"Failed to get document because the client is offline.")):_&&m.fromCache&&l&&l.source==="server"?d.reject(new K(U.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):d.resolve(m)},error:m=>d.reject(m)}),f=new n_(kc(a.path),h,{includeMetadataChanges:!0,qa:!0});return Zy(s,f)}(await eh(t),t.asyncQueue,e,n,r)),r.promise}function uM(t,e,n={}){const r=new ar;return t.asyncQueue.enqueueAndForget(async()=>function(s,o,a,l,d){const h=new s_({next:m=>{h.Nu(),o.enqueueAndForget(()=>e_(s,f)),m.fromCache&&l.source==="server"?d.reject(new K(U.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):d.resolve(m)},error:m=>d.reject(m)}),f=new n_(a,h,{includeMetadataChanges:!0,qa:!0});return Zy(s,f)}(await eh(t),t.asyncQueue,e,n,r)),r.promise}function dM(t,e,n){const r=new ar;return t.asyncQueue.enqueueAndForget(async()=>{try{const i=await lM(t);r.resolve(async function(o,a,l){var C;const d=ve(o),{request:h,gt:f,parent:m}=xV(d.serializer,YO(a),l);d.connection.$o||delete h.parent;const _=(await d.Ho("RunAggregationQuery",d.serializer.databaseId,m,h,1)).filter(y=>!!y.result);ae(_.length===1,64727);const R=(C=_[0].result)==null?void 0:C.aggregateFields;return Object.keys(R).reduce((y,I)=>(y[f[I]]=R[I],y),{})}(i,e,n))}catch(i){r.reject(i)}}),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VC(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xI=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LC="firestore.googleapis.com",SI=!0;class bI{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new K(U.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=LC,this.ssl=SI}else this.host=e.host,this.ssl=e.ssl??SI;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=sC;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<BV)throw new K(U.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}nO("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=VC(e.experimentalLongPollingOptions??{}),function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new K(U.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new K(U.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new K(U.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Zh{constructor(e,n,r,i){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new bI({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new K(U.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new K(U.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new bI(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new W2;switch(r.type){case"firstParty":return new Y2(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new K(U.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=xI.get(n);r&&(H("ComponentProvider","Removing Datastore"),xI.delete(n),r.terminate())}(this),Promise.resolve()}}function hM(t,e,n,r={}){var d;t=on(t,Zh);const i=es(e),s=t._getSettings(),o={...s,emulatorOptions:t._getEmulatorOptions()},a=`${e}:${n}`;i&&(ay(`https://${a}`),ly("Firestore",!0)),s.host!==LC&&s.host!==a&&$s("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const l={...s,host:a,ssl:i,emulatorOptions:r};if(!Qr(l,o)&&(t._setSettings(l),r.mockUserToken)){let h,f;if(typeof r.mockUserToken=="string")h=r.mockUserToken,f=Ht.MOCK_USER;else{h=Wx(r.mockUserToken,(d=t._app)==null?void 0:d.options.projectId);const m=r.mockUserToken.sub||r.mockUserToken.user_id;if(!m)throw new K(U.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");f=new Ht(m)}t._authCredentials=new K2(new HS(h,f))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fr{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new fr(this.firestore,e,this._query)}}class _t{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new $i(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new _t(this.firestore,e,this._key)}toJSON(){return{type:_t._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,n,r){if(Rc(n,_t._jsonSchema))return new _t(e,r||null,new Z(Ue.fromString(n.referencePath)))}}_t._jsonSchemaVersion="firestore/documentReference/1.0",_t._jsonSchema={type:At("string",_t._jsonSchemaVersion),referencePath:At("string")};class $i extends fr{constructor(e,n,r){super(e,n,kc(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new _t(this.firestore,null,new Z(e))}withConverter(e){return new $i(this.firestore,e,this._path)}}function Me(t,e,...n){if(t=ze(t),KS("collection","path",e),t instanceof Zh){const r=Ue.fromString(e,...n);return gE(r),new $i(t,null,r)}{if(!(t instanceof _t||t instanceof $i))throw new K(U.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(Ue.fromString(e,...n));return gE(r),new $i(t.firestore,null,r)}}function Kt(t,e,...n){if(t=ze(t),arguments.length===1&&(e=Iy.newId()),KS("doc","path",e),t instanceof Zh){const r=Ue.fromString(e,...n);return mE(r),new _t(t,null,new Z(r))}{if(!(t instanceof _t||t instanceof $i))throw new K(U.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(Ue.fromString(e,...n));return mE(r),new _t(t.firestore,t instanceof $i?t.converter:null,new Z(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CI="AsyncQueue";class AI{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new vC(this,"async_queue_retry"),this._c=()=>{const r=rd();r&&H(CI,"Visibility state changed to "+r.visibilityState),this.M_.w_()},this.ac=e;const n=rd();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const n=rd();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});const n=new ar;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Xu.push(e),this.lc()))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!rs(e))throw e;H(CI,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){const n=this.ac.then(()=>(this.rc=!0,e().catch(r=>{throw this.nc=r,this.rc=!1,dn("INTERNAL UNHANDLED ERROR: ",RI(r)),r}).then(r=>(this.rc=!1,r))));return this.ac=n,n}enqueueAfterDelay(e,n,r){this.uc(),this.oc.indexOf(e)>-1&&(n=0);const i=Xy.createAndSchedule(this,e,n,r,s=>this.hc(s));return this.tc.push(i),i}uc(){this.nc&&se(47125,{Pc:RI(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const n of this.tc)if(n.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.tc)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.Tc()})}dc(e){this.oc.push(e)}hc(e){const n=this.tc.indexOf(e);this.tc.splice(n,1)}}function RI(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PI(t){return function(n,r){if(typeof n!="object"||n===null)return!1;const i=n;for(const s of r)if(s in i&&typeof i[s]=="function")return!0;return!1}(t,["next","error","complete"])}class dr extends Zh{constructor(e,n,r,i){super(e,n,r,i),this.type="firestore",this._queue=new AI,this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new AI(e),this._firestoreClient=void 0,await e}}}function MC(t,e){const n=typeof t=="object"?t:Ah(),r=typeof t=="string"?t:$d,i=ts(n,"firestore").getImmediate({identifier:r});if(!i._initialized){const s=zx("firestore");s&&hM(i,...s)}return i}function Mc(t){if(t._terminated)throw new K(U.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||FC(t),t._firestoreClient}function FC(t){var r,i,s;const e=t._freezeSettings(),n=function(a,l,d,h){return new MO(a,l,d,h.host,h.ssl,h.experimentalForceLongPolling,h.experimentalAutoDetectLongPolling,VC(h.experimentalLongPollingOptions),h.useFetchStreams,h.isUsingEmulator)}(t._databaseId,((r=t._app)==null?void 0:r.options.appId)||"",t._persistenceKey,e);t._componentsProvider||(i=e.localCache)!=null&&i._offlineComponentProvider&&((s=e.localCache)!=null&&s._onlineComponentProvider)&&(t._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),t._firestoreClient=new sM(t._authCredentials,t._appCheckCredentials,t._queue,n,t._componentsProvider&&function(a){const l=a==null?void 0:a._online.build();return{_offline:a==null?void 0:a._offline.build(l),_online:l}}(t._componentsProvider))}function fM(t,e){$s("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const n=t._freezeSettings();return pM(t,Zd.provider,{build:r=>new iM(r,n.cacheSizeBytes,e==null?void 0:e.forceOwnership)}),Promise.resolve()}function pM(t,e,n){if((t=on(t,dr))._firestoreClient||t._terminated)throw new K(U.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(t._componentsProvider||t._getSettings().localCache)throw new K(U.FAILED_PRECONDITION,"SDK cache is already specified.");t._componentsProvider={_online:e,_offline:n},FC(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mM{constructor(e="count",n){this._internalFieldPath=n,this.type="AggregateField",this.aggregateType=e}}class gM{constructor(e,n,r){this._userDataWriter=n,this._data=r,this.type="AggregateQuerySnapshot",this.query=e}data(){return this._userDataWriter.convertObjectMap(this._data)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $n{constructor(e){this._byteString=e}static fromBase64String(e){try{return new $n(Rt.fromBase64String(e))}catch(n){throw new K(U.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new $n(Rt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:$n._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Rc(e,$n._jsonSchema))return $n.fromBase64String(e.bytes)}}$n._jsonSchemaVersion="firestore/bytes/1.0",$n._jsonSchema={type:At("string",$n._jsonSchemaVersion),bytes:At("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ef{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new K(U.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new dt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Da{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pr{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new K(U.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new K(U.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return Ee(this._lat,e._lat)||Ee(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Pr._jsonSchemaVersion}}static fromJSON(e){if(Rc(e,Pr._jsonSchema))return new Pr(e.latitude,e.longitude)}}Pr._jsonSchemaVersion="firestore/geoPoint/1.0",Pr._jsonSchema={type:At("string",Pr._jsonSchemaVersion),latitude:At("number"),longitude:At("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nr{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,i){if(r.length!==i.length)return!1;for(let s=0;s<r.length;++s)if(r[s]!==i[s])return!1;return!0}(this._values,e._values)}toJSON(){return{type:Nr._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Rc(e,Nr._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(n=>typeof n=="number"))return new Nr(e.vectorValues);throw new K(U.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Nr._jsonSchemaVersion="firestore/vectorValue/1.0",Nr._jsonSchema={type:At("string",Nr._jsonSchemaVersion),vectorValues:At("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yM=/^__.*__$/;class _M{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new ni(e,this.data,this.fieldMask,n,this.fieldTransforms):new Na(e,this.data,n,this.fieldTransforms)}}class UC{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new ni(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function BC(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw se(40011,{Ac:t})}}class tf{constructor(e,n,r,i,s,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.Rc(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new tf({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){var i;const n=(i=this.path)==null?void 0:i.child(e),r=this.Vc({path:n,fc:!1});return r.gc(e),r}yc(e){var i;const n=(i=this.path)==null?void 0:i.child(e),r=this.Vc({path:n,fc:!1});return r.Rc(),r}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return th(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(BC(this.Ac)&&yM.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class vM{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||Xh(e)}Cc(e,n,r,i=!1){return new tf({Ac:e,methodName:n,Dc:r,path:dt.emptyPath(),fc:!1,bc:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Fc(t){const e=t._freezeSettings(),n=Xh(t._databaseId);return new vM(t._databaseId,!!e.ignoreUndefinedProperties,n)}function $C(t,e,n,r,i,s={}){const o=t.Cc(s.merge||s.mergeFields?2:0,e,n,i);u_("Data must be an object, but it was:",o,r);const a=qC(r,o);let l,d;if(s.merge)l=new En(o.fieldMask),d=o.fieldTransforms;else if(s.mergeFields){const h=[];for(const f of s.mergeFields){const m=ng(e,f,n);if(!o.contains(m))throw new K(U.INVALID_ARGUMENT,`Field '${m}' is specified in your field mask but missing from your input data.`);WC(h,m)||h.push(m)}l=new En(h),d=o.fieldTransforms.filter(f=>l.covers(f.field))}else l=null,d=o.fieldTransforms;return new _M(new nn(a),l,d)}class nf extends Da{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof nf}}function wM(t,e,n){return new tf({Ac:3,Dc:e.settings.Dc,methodName:t._methodName,fc:n},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class a_ extends Da{_toFieldTransform(e){return new qh(e.path,new ya)}isEqual(e){return e instanceof a_}}class l_ extends Da{constructor(e,n){super(e),this.vc=n}_toFieldTransform(e){const n=wM(this,e,!0),r=this.vc.map(s=>ja(s,n)),i=new Ws(r);return new qh(e.path,i)}isEqual(e){return e instanceof l_&&Qr(this.vc,e.vc)}}class c_ extends Da{constructor(e,n){super(e),this.Fc=n}_toFieldTransform(e){const n=new va(e.serializer,Db(e.serializer,this.Fc));return new qh(e.path,n)}isEqual(e){return e instanceof c_&&this.Fc===e.Fc}}function EM(t,e,n,r){const i=t.Cc(1,e,n);u_("Data must be an object, but it was:",i,r);const s=[],o=nn.empty();is(r,(l,d)=>{const h=d_(e,l,n);d=ze(d);const f=i.yc(h);if(d instanceof nf)s.push(h);else{const m=ja(d,f);m!=null&&(s.push(h),o.set(h,m))}});const a=new En(s);return new UC(o,a,i.fieldTransforms)}function IM(t,e,n,r,i,s){const o=t.Cc(1,e,n),a=[ng(e,r,n)],l=[i];if(s.length%2!=0)throw new K(U.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let m=0;m<s.length;m+=2)a.push(ng(e,s[m])),l.push(s[m+1]);const d=[],h=nn.empty();for(let m=a.length-1;m>=0;--m)if(!WC(d,a[m])){const _=a[m];let R=l[m];R=ze(R);const C=o.yc(_);if(R instanceof nf)d.push(_);else{const y=ja(R,C);y!=null&&(d.push(_),h.set(_,y))}}const f=new En(d);return new UC(h,f,o.fieldTransforms)}function zC(t,e,n,r=!1){return ja(n,t.Cc(r?4:3,e))}function ja(t,e){if(HC(t=ze(t)))return u_("Unsupported field value:",e,t),qC(t,e);if(t instanceof Da)return function(r,i){if(!BC(i.Ac))throw i.Sc(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Sc(`${r._methodName}() is not currently supported inside arrays`);const s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return function(r,i){const s=[];let o=0;for(const a of r){let l=ja(a,i.wc(o));l==null&&(l={nullValue:"NULL_VALUE"}),s.push(l),o++}return{arrayValue:{values:s}}}(t,e)}return function(r,i){if((r=ze(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return Db(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const s=Le.fromDate(r);return{timestampValue:wa(i.serializer,s)}}if(r instanceof Le){const s=new Le(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:wa(i.serializer,s)}}if(r instanceof Pr)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof $n)return{bytesValue:qb(i.serializer,r._byteString)};if(r instanceof _t){const s=i.databaseId,o=r.firestore._databaseId;if(!o.isEqual(s))throw i.Sc(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:My(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof Nr)return function(o,a){return{mapValue:{fields:{[Ry]:{stringValue:Py},[pa]:{arrayValue:{values:o.toArray().map(d=>{if(typeof d!="number")throw a.Sc("VectorValues must only contain numeric values.");return Dy(a.serializer,d)})}}}}}}(r,i);throw i.Sc(`Unsupported field value: ${Dh(r)}`)}(t,e)}function qC(t,e){const n={};return cb(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):is(t,(r,i)=>{const s=ja(i,e.mc(r));s!=null&&(n[r]=s)}),{mapValue:{fields:n}}}function HC(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof Le||t instanceof Pr||t instanceof $n||t instanceof _t||t instanceof Da||t instanceof Nr)}function u_(t,e,n){if(!HC(n)||!GS(n)){const r=Dh(n);throw r==="an object"?e.Sc(t+" a custom object"):e.Sc(t+" "+r)}}function ng(t,e,n){if((e=ze(e))instanceof ef)return e._internalPath;if(typeof e=="string")return d_(t,e);throw th("Field path arguments must be of type string or ",t,!1,void 0,n)}const TM=new RegExp("[~\\*/\\[\\]]");function d_(t,e,n){if(e.search(TM)>=0)throw th(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new ef(...e.split("."))._internalPath}catch{throw th(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function th(t,e,n,r,i){const s=r&&!r.isEmpty(),o=i!==void 0;let a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let l="";return(s||o)&&(l+=" (found",s&&(l+=` in field ${r}`),o&&(l+=` in document ${i}`),l+=")"),new K(U.INVALID_ARGUMENT,a+t+l)}function WC(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h_{constructor(e,n,r,i,s){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new _t(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new xM(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(rf("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class xM extends h_{data(){return super.data()}}function rf(t,e){return typeof e=="string"?d_(t,e):e instanceof ef?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function KC(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new K(U.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class f_{}class Uc extends f_{}function Je(t,e,...n){let r=[];e instanceof f_&&r.push(e),r=r.concat(n),function(s){const o=s.filter(l=>l instanceof p_).length,a=s.filter(l=>l instanceof sf).length;if(o>1||o>0&&a>0)throw new K(U.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const i of r)t=i._apply(t);return t}class sf extends Uc{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new sf(e,n,r)}_apply(e){const n=this._parse(e);return QC(e._query,n),new fr(e.firestore,e.converter,qm(e._query,n))}_parse(e){const n=Fc(e.firestore);return function(s,o,a,l,d,h,f){let m;if(d.isKeyField()){if(h==="array-contains"||h==="array-contains-any")throw new K(U.INVALID_ARGUMENT,`Invalid Query. You can't perform '${h}' queries on documentId().`);if(h==="in"||h==="not-in"){jI(f,h);const R=[];for(const C of f)R.push(DI(l,s,C));m={arrayValue:{values:R}}}else m=DI(l,s,f)}else h!=="in"&&h!=="not-in"&&h!=="array-contains-any"||jI(f,h),m=zC(a,o,f,h==="in"||h==="not-in");return Ne.create(d,h,m)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function Ge(t,e,n){const r=e,i=rf("where",t);return sf._create(i,r,n)}class p_ extends f_{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new p_(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:He.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(i,s){let o=i;const a=s.getFlattenedFilters();for(const l of a)QC(o,l),o=qm(o,l)}(e._query,n),new fr(e.firestore,e.converter,qm(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class m_ extends Uc{constructor(e,n){super(),this._field=e,this._direction=n,this.type="orderBy"}static _create(e,n){return new m_(e,n)}_apply(e){const n=function(i,s,o){if(i.startAt!==null)throw new K(U.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new K(U.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new gc(s,o)}(e._query,this._field,this._direction);return new fr(e.firestore,e.converter,function(i,s){const o=i.explicitOrderBy.concat([s]);return new ss(i.path,i.collectionGroup,o,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,n))}}function rn(t,e="asc"){const n=e,r=rf("orderBy",t);return m_._create(r,n)}class g_ extends Uc{constructor(e,n,r){super(),this.type=e,this._limit=n,this._limitType=r}static _create(e,n,r){return new g_(e,n,r)}_apply(e){return new fr(e.firestore,e.converter,Hd(e._query,this._limit,this._limitType))}}function Jo(t){return rO("limit",t),g_._create("limit",t,"F")}class of extends Uc{constructor(e,n,r){super(),this.type=e,this._docOrFields=n,this._inclusive=r}static _create(e,n,r){return new of(e,n,r)}_apply(e){const n=GC(e,this.type,this._docOrFields,this._inclusive);return new fr(e.firestore,e.converter,function(i,s){return new ss(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,s,i.endAt)}(e._query,n))}}function NI(...t){return of._create("startAt",t,!0)}function SM(...t){return of._create("startAfter",t,!1)}class y_ extends Uc{constructor(e,n,r){super(),this.type=e,this._docOrFields=n,this._inclusive=r}static _create(e,n,r){return new y_(e,n,r)}_apply(e){const n=GC(e,this.type,this._docOrFields,this._inclusive);return new fr(e.firestore,e.converter,function(i,s){return new ss(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,i.startAt,s)}(e._query,n))}}function kI(...t){return y_._create("endAt",t,!0)}function GC(t,e,n,r){if(n[0]=ze(n[0]),n[0]instanceof h_)return function(s,o,a,l,d){if(!l)throw new K(U.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${a}().`);const h=[];for(const f of Yo(s))if(f.field.isKeyField())h.push(qs(o,l.key));else{const m=l.data.field(f.field);if(Fh(m))throw new K(U.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+f.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(m===null){const _=f.field.canonicalString();throw new K(U.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${_}' (used as the orderBy) does not exist.`)}h.push(m)}return new Ki(h,d)}(t._query,t.firestore._databaseId,e,n[0]._document,r);{const i=Fc(t.firestore);return function(o,a,l,d,h,f){const m=o.explicitOrderBy;if(h.length>m.length)throw new K(U.INVALID_ARGUMENT,`Too many arguments provided to ${d}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const _=[];for(let R=0;R<h.length;R++){const C=h[R];if(m[R].field.isKeyField()){if(typeof C!="string")throw new K(U.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${d}(), but got a ${typeof C}`);if(!ky(o)&&C.indexOf("/")!==-1)throw new K(U.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${d}() must be a plain document ID, but '${C}' contains a slash.`);const y=o.path.child(Ue.fromString(C));if(!Z.isDocumentKey(y))throw new K(U.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${d}() must result in a valid document path, but '${y}' is not because it contains an odd number of segments.`);const I=new Z(y);_.push(qs(a,I))}else{const y=zC(l,d,C);_.push(y)}}return new Ki(_,f)}(t._query,t.firestore._databaseId,i,e,n,r)}}function DI(t,e,n){if(typeof(n=ze(n))=="string"){if(n==="")throw new K(U.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!ky(e)&&n.indexOf("/")!==-1)throw new K(U.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(Ue.fromString(n));if(!Z.isDocumentKey(r))throw new K(U.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return qs(t,new Z(r))}if(n instanceof _t)return qs(t,n._key);throw new K(U.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Dh(n)}.`)}function jI(t,e){if(!Array.isArray(t)||t.length===0)throw new K(U.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function QC(t,e){const n=function(i,s){for(const o of i)for(const a of o.getFlattenedFilters())if(s.indexOf(a.op)>=0)return a.op;return null}(t.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new K(U.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new K(U.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class bM{convertValue(e,n="none"){switch(Hi(e)){case 0:return null;case 1:return e.booleanValue;case 2:return ot(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(Zr(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw se(62114,{value:e})}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return is(e,(i,s)=>{r[i]=this.convertValue(s,n)}),r}convertVectorValue(e){var r,i,s;const n=(s=(i=(r=e.fields)==null?void 0:r[pa].arrayValue)==null?void 0:i.values)==null?void 0:s.map(o=>ot(o.doubleValue));return new Nr(n)}convertGeoPoint(e){return new Pr(ot(e.latitude),ot(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=Uh(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(fc(e));default:return null}}convertTimestamp(e){const n=Jr(e);return new Le(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=Ue.fromString(e);ae(Zb(r),9688,{name:e});const i=new zs(r.get(1),r.get(3)),s=new Z(r.popFirst(5));return i.isEqual(n)||dn(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function YC(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}function CM(){return new mM("count")}class _l{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class ks extends h_{constructor(e,n,r,i,s,o){super(e,n,r,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new id(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(rf("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new K(U.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,n={};return n.type=ks._jsonSchemaVersion,n.bundle="",n.bundleSource="DocumentSnapshot",n.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?n:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),n.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),n)}}ks._jsonSchemaVersion="firestore/documentSnapshot/1.0",ks._jsonSchema={type:At("string",ks._jsonSchemaVersion),bundleSource:At("string","DocumentSnapshot"),bundleName:At("string"),bundle:At("string")};class id extends ks{data(e={}){return super.data(e)}}class Ds{constructor(e,n,r,i){this._firestore=e,this._userDataWriter=n,this._snapshot=i,this.metadata=new _l(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new id(this._firestore,this._userDataWriter,r.key,r,new _l(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new K(U.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map(a=>{const l=new id(i._firestore,i._userDataWriter,a.doc.key,a.doc,new _l(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);return a.doc,{type:"added",doc:l,oldIndex:-1,newIndex:o++}})}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(a=>s||a.type!==3).map(a=>{const l=new id(i._firestore,i._userDataWriter,a.doc.key,a.doc,new _l(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);let d=-1,h=-1;return a.type!==0&&(d=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),h=o.indexOf(a.doc.key)),{type:AM(a.type),doc:l,oldIndex:d,newIndex:h}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new K(U.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Ds._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Iy.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const n=[],r=[],i=[];return this.docs.forEach(s=>{s._document!==null&&(n.push(s._document),r.push(this._userDataWriter.convertObjectMap(s._document.data.value.mapValue.fields,"previous")),i.push(s.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function AM(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return se(61501,{type:t})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nh(t){t=on(t,_t);const e=on(t.firestore,dr);return cM(Mc(e),t._key).then(n=>JC(e,t,n))}Ds._jsonSchemaVersion="firestore/querySnapshot/1.0",Ds._jsonSchema={type:At("string",Ds._jsonSchemaVersion),bundleSource:At("string","QuerySnapshot"),bundleName:At("string"),bundle:At("string")};class af extends bM{constructor(e){super(),this.firestore=e}convertBytes(e){return new $n(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new _t(this.firestore,null,n)}}function en(t){t=on(t,fr);const e=on(t.firestore,dr),n=Mc(e),r=new af(e);return KC(t._query),uM(n,t._query).then(i=>new Ds(e,r,t,i))}function rh(t,e,n){t=on(t,_t);const r=on(t.firestore,dr),i=YC(t.converter,e,n);return lf(r,[$C(Fc(r),"setDoc",t._key,i,t.converter!==null,n).toMutation(t._key,sn.none())])}function Zo(t,e,n,...r){t=on(t,_t);const i=on(t.firestore,dr),s=Fc(i);let o;return o=typeof(e=ze(e))=="string"||e instanceof ef?IM(s,"updateDoc",t._key,e,n,r):EM(s,"updateDoc",t._key,e),lf(i,[o.toMutation(t._key,sn.exists(!0))])}function XC(t){return lf(on(t.firestore,dr),[new Wh(t._key,sn.none())])}function vl(t,e){const n=on(t.firestore,dr),r=Kt(t),i=YC(t.converter,e);return lf(n,[$C(Fc(t.firestore),"addDoc",r._key,i,t.converter!==null,{}).toMutation(r._key,sn.exists(!1))]).then(()=>r)}function rr(t,...e){var l,d,h;t=ze(t);let n={includeMetadataChanges:!1,source:"default"},r=0;typeof e[r]!="object"||PI(e[r])||(n=e[r++]);const i={includeMetadataChanges:n.includeMetadataChanges,source:n.source};if(PI(e[r])){const f=e[r];e[r]=(l=f.next)==null?void 0:l.bind(f),e[r+1]=(d=f.error)==null?void 0:d.bind(f),e[r+2]=(h=f.complete)==null?void 0:h.bind(f)}let s,o,a;if(t instanceof _t)o=on(t.firestore,dr),a=kc(t._key.path),s={next:f=>{e[r]&&e[r](JC(o,t,f))},error:e[r+1],complete:e[r+2]};else{const f=on(t,fr);o=on(f.firestore,dr),a=f._query;const m=new af(o);s={next:_=>{e[r]&&e[r](new Ds(o,m,f,_))},error:e[r+1],complete:e[r+2]},KC(t._query)}return function(m,_,R,C){const y=new s_(C),I=new n_(_,y,R);return m.asyncQueue.enqueueAndForget(async()=>Zy(await eh(m),I)),()=>{y.Nu(),m.asyncQueue.enqueueAndForget(async()=>e_(await eh(m),I))}}(Mc(o),a,i,s)}function lf(t,e){return function(r,i){const s=new ar;return r.asyncQueue.enqueueAndForget(async()=>YL(await aM(r),i,s)),s.promise}(Mc(t),e)}function JC(t,e,n){const r=n.docs.get(e._key),i=new af(t);return new ks(t,i,e._key,r,new _l(n.hasPendingWrites,n.fromCache),e.converter)}function RM(t){return PM(t,{count:CM()})}function PM(t,e){const n=on(t.firestore,dr),r=Mc(n),i=VO(e,(s,o)=>new uV(o,s.aggregateType,s._internalFieldPath));return dM(r,t._query,i).then(s=>function(a,l,d){const h=new af(a);return new gM(l,h,d)}(n,t,s))}function Mn(){return new a_("serverTimestamp")}function NM(...t){return new l_("arrayUnion",t)}function OI(t){return new c_("increment",t)}(function(e,n=!0){(function(i){Pa=i})(ro),cr(new Yn("firestore",(r,{instanceIdentifier:i,options:s})=>{const o=r.getProvider("app").getImmediate(),a=new dr(new G2(r.getProvider("auth-internal")),new X2(o,r.getProvider("app-check-internal")),function(d,h){if(!Object.prototype.hasOwnProperty.apply(d.options,["projectId"]))throw new K(U.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new zs(d.options.projectId,h)}(o,i),o);return s={useFetchStreams:n,...s},a._setSettings(s),a},"PUBLIC").setMultipleInstances(!0)),Sn(dE,hE,e),Sn(dE,hE,"esm2020")})();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZC="firebasestorage.googleapis.com",eA="storageBucket",kM=2*60*1e3,DM=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wt extends Xn{constructor(e,n,r=0){super(gp(e),`Firebase Storage: ${n} (${gp(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,wt.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return gp(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var vt;(function(t){t.UNKNOWN="unknown",t.OBJECT_NOT_FOUND="object-not-found",t.BUCKET_NOT_FOUND="bucket-not-found",t.PROJECT_NOT_FOUND="project-not-found",t.QUOTA_EXCEEDED="quota-exceeded",t.UNAUTHENTICATED="unauthenticated",t.UNAUTHORIZED="unauthorized",t.UNAUTHORIZED_APP="unauthorized-app",t.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",t.INVALID_CHECKSUM="invalid-checksum",t.CANCELED="canceled",t.INVALID_EVENT_NAME="invalid-event-name",t.INVALID_URL="invalid-url",t.INVALID_DEFAULT_BUCKET="invalid-default-bucket",t.NO_DEFAULT_BUCKET="no-default-bucket",t.CANNOT_SLICE_BLOB="cannot-slice-blob",t.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",t.NO_DOWNLOAD_URL="no-download-url",t.INVALID_ARGUMENT="invalid-argument",t.INVALID_ARGUMENT_COUNT="invalid-argument-count",t.APP_DELETED="app-deleted",t.INVALID_ROOT_OPERATION="invalid-root-operation",t.INVALID_FORMAT="invalid-format",t.INTERNAL_ERROR="internal-error",t.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(vt||(vt={}));function gp(t){return"storage/"+t}function __(){const t="An unknown error occurred, please check the error payload for server response.";return new wt(vt.UNKNOWN,t)}function jM(t){return new wt(vt.OBJECT_NOT_FOUND,"Object '"+t+"' does not exist.")}function OM(t){return new wt(vt.QUOTA_EXCEEDED,"Quota for bucket '"+t+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function VM(){const t="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new wt(vt.UNAUTHENTICATED,t)}function LM(){return new wt(vt.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function MM(t){return new wt(vt.UNAUTHORIZED,"User does not have permission to access '"+t+"'.")}function FM(){return new wt(vt.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function UM(){return new wt(vt.CANCELED,"User canceled the upload/download.")}function BM(t){return new wt(vt.INVALID_URL,"Invalid URL '"+t+"'.")}function $M(t){return new wt(vt.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}function zM(){return new wt(vt.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+eA+"' property when initializing the app?")}function qM(){return new wt(vt.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function HM(){return new wt(vt.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function WM(t){return new wt(vt.UNSUPPORTED_ENVIRONMENT,`${t} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function rg(t){return new wt(vt.INVALID_ARGUMENT,t)}function tA(){return new wt(vt.APP_DELETED,"The Firebase app was deleted.")}function KM(t){return new wt(vt.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function Fl(t,e){return new wt(vt.INVALID_FORMAT,"String does not match format '"+t+"': "+e)}function ol(t){throw new wt(vt.INTERNAL_ERROR,"Internal error: "+t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hn{constructor(e,n){this.bucket=e,this.path_=n}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,n){let r;try{r=hn.makeFromUrl(e,n)}catch{return new hn(e,"")}if(r.path==="")return r;throw $M(e)}static makeFromUrl(e,n){let r=null;const i="([A-Za-z0-9.\\-_]+)";function s(O){O.path.charAt(O.path.length-1)==="/"&&(O.path_=O.path_.slice(0,-1))}const o="(/(.*))?$",a=new RegExp("^gs://"+i+o,"i"),l={bucket:1,path:3};function d(O){O.path_=decodeURIComponent(O.path)}const h="v[A-Za-z0-9_]+",f=n.replace(/[.]/g,"\\."),m="(/([^?#]*).*)?$",_=new RegExp(`^https?://${f}/${h}/b/${i}/o${m}`,"i"),R={bucket:1,path:3},C=n===ZC?"(?:storage.googleapis.com|storage.cloud.google.com)":n,y="([^?#]*)",I=new RegExp(`^https?://${C}/${i}/${y}`,"i"),E=[{regex:a,indices:l,postModify:s},{regex:_,indices:R,postModify:d},{regex:I,indices:{bucket:1,path:2},postModify:d}];for(let O=0;O<E.length;O++){const D=E[O],B=D.regex.exec(e);if(B){const x=B[D.indices.bucket];let v=B[D.indices.path];v||(v=""),r=new hn(x,v),D.postModify(r);break}}if(r==null)throw BM(e);return r}}class GM{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function QM(t,e,n){let r=1,i=null,s=null,o=!1,a=0;function l(){return a===2}let d=!1;function h(...y){d||(d=!0,e.apply(null,y))}function f(y){i=setTimeout(()=>{i=null,t(_,l())},y)}function m(){s&&clearTimeout(s)}function _(y,...I){if(d){m();return}if(y){m(),h.call(null,y,...I);return}if(l()||o){m(),h.call(null,y,...I);return}r<64&&(r*=2);let E;a===1?(a=2,E=0):E=(r+Math.random())*1e3,f(E)}let R=!1;function C(y){R||(R=!0,m(),!d&&(i!==null?(y||(a=2),clearTimeout(i),f(0)):y||(a=1)))}return f(0),s=setTimeout(()=>{o=!0,C(!0)},n),C}function YM(t){t(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function XM(t){return t!==void 0}function JM(t){return typeof t=="object"&&!Array.isArray(t)}function v_(t){return typeof t=="string"||t instanceof String}function VI(t){return w_()&&t instanceof Blob}function w_(){return typeof Blob<"u"}function ig(t,e,n,r){if(r<e)throw rg(`Invalid value for '${t}'. Expected ${e} or greater.`);if(r>n)throw rg(`Invalid value for '${t}'. Expected ${n} or less.`)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bc(t,e,n){let r=e;return n==null&&(r=`https://${e}`),`${n}://${r}/v0${t}`}function nA(t){const e=encodeURIComponent;let n="?";for(const r in t)if(t.hasOwnProperty(r)){const i=e(r)+"="+e(t[r]);n=n+i+"&"}return n=n.slice(0,-1),n}var js;(function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"})(js||(js={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZM(t,e){const n=t>=500&&t<600,i=[408,429].indexOf(t)!==-1,s=e.indexOf(t)!==-1;return n||i||s}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eF{constructor(e,n,r,i,s,o,a,l,d,h,f,m=!0,_=!1){this.url_=e,this.method_=n,this.headers_=r,this.body_=i,this.successCodes_=s,this.additionalRetryCodes_=o,this.callback_=a,this.errorCallback_=l,this.timeout_=d,this.progressCallback_=h,this.connectionFactory_=f,this.retry=m,this.isUsingEmulator=_,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((R,C)=>{this.resolve_=R,this.reject_=C,this.start_()})}start_(){const e=(r,i)=>{if(i){r(!1,new Su(!1,null,!0));return}const s=this.connectionFactory_();this.pendingConnection_=s;const o=a=>{const l=a.loaded,d=a.lengthComputable?a.total:-1;this.progressCallback_!==null&&this.progressCallback_(l,d)};this.progressCallback_!==null&&s.addUploadProgressListener(o),s.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&s.removeUploadProgressListener(o),this.pendingConnection_=null;const a=s.getErrorCode()===js.NO_ERROR,l=s.getStatus();if(!a||ZM(l,this.additionalRetryCodes_)&&this.retry){const h=s.getErrorCode()===js.ABORT;r(!1,new Su(!1,null,h));return}const d=this.successCodes_.indexOf(l)!==-1;r(!0,new Su(d,s))})},n=(r,i)=>{const s=this.resolve_,o=this.reject_,a=i.connection;if(i.wasSuccessCode)try{const l=this.callback_(a,a.getResponse());XM(l)?s(l):s()}catch(l){o(l)}else if(a!==null){const l=__();l.serverResponse=a.getErrorText(),this.errorCallback_?o(this.errorCallback_(a,l)):o(l)}else if(i.canceled){const l=this.appDelete_?tA():UM();o(l)}else{const l=FM();o(l)}};this.canceled_?n(!1,new Su(!1,null,!0)):this.backoffId_=QM(e,n,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&YM(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class Su{constructor(e,n,r){this.wasSuccessCode=e,this.connection=n,this.canceled=!!r}}function tF(t,e){e!==null&&e.length>0&&(t.Authorization="Firebase "+e)}function nF(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function rF(t,e){e&&(t["X-Firebase-GMPID"]=e)}function iF(t,e){e!==null&&(t["X-Firebase-AppCheck"]=e)}function sF(t,e,n,r,i,s,o=!0,a=!1){const l=nA(t.urlParams),d=t.url+l,h=Object.assign({},t.headers);return rF(h,e),tF(h,n),nF(h,s),iF(h,r),new eF(d,t.method,h,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,i,o,a)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oF(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function aF(...t){const e=oF();if(e!==void 0){const n=new e;for(let r=0;r<t.length;r++)n.append(t[r]);return n.getBlob()}else{if(w_())return new Blob(t);throw new wt(vt.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function lF(t,e,n){return t.webkitSlice?t.webkitSlice(e,n):t.mozSlice?t.mozSlice(e,n):t.slice?t.slice(e,n):null}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cF(t){if(typeof atob>"u")throw WM("base-64");return atob(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sr={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class yp{constructor(e,n){this.data=e,this.contentType=n||null}}function uF(t,e){switch(t){case Sr.RAW:return new yp(rA(e));case Sr.BASE64:case Sr.BASE64URL:return new yp(iA(t,e));case Sr.DATA_URL:return new yp(hF(e),fF(e))}throw __()}function rA(t){const e=[];for(let n=0;n<t.length;n++){let r=t.charCodeAt(n);if(r<=127)e.push(r);else if(r<=2047)e.push(192|r>>6,128|r&63);else if((r&64512)===55296)if(!(n<t.length-1&&(t.charCodeAt(n+1)&64512)===56320))e.push(239,191,189);else{const s=r,o=t.charCodeAt(++n);r=65536|(s&1023)<<10|o&1023,e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|r&63)}else(r&64512)===56320?e.push(239,191,189):e.push(224|r>>12,128|r>>6&63,128|r&63)}return new Uint8Array(e)}function dF(t){let e;try{e=decodeURIComponent(t)}catch{throw Fl(Sr.DATA_URL,"Malformed data URL.")}return rA(e)}function iA(t,e){switch(t){case Sr.BASE64:{const i=e.indexOf("-")!==-1,s=e.indexOf("_")!==-1;if(i||s)throw Fl(t,"Invalid character '"+(i?"-":"_")+"' found: is it base64url encoded?");break}case Sr.BASE64URL:{const i=e.indexOf("+")!==-1,s=e.indexOf("/")!==-1;if(i||s)throw Fl(t,"Invalid character '"+(i?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let n;try{n=cF(e)}catch(i){throw i.message.includes("polyfill")?i:Fl(t,"Invalid character found")}const r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}class sA{constructor(e){this.base64=!1,this.contentType=null;const n=e.match(/^data:([^,]+)?,/);if(n===null)throw Fl(Sr.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const r=n[1]||null;r!=null&&(this.base64=pF(r,";base64"),this.contentType=this.base64?r.substring(0,r.length-7):r),this.rest=e.substring(e.indexOf(",")+1)}}function hF(t){const e=new sA(t);return e.base64?iA(Sr.BASE64,e.rest):dF(e.rest)}function fF(t){return new sA(t).contentType}function pF(t,e){return t.length>=e.length?t.substring(t.length-e.length)===e:!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Si{constructor(e,n){let r=0,i="";VI(e)?(this.data_=e,r=e.size,i=e.type):e instanceof ArrayBuffer?(n?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),r=this.data_.length):e instanceof Uint8Array&&(n?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),r=e.length),this.size_=r,this.type_=i}size(){return this.size_}type(){return this.type_}slice(e,n){if(VI(this.data_)){const r=this.data_,i=lF(r,e,n);return i===null?null:new Si(i)}else{const r=new Uint8Array(this.data_.buffer,e,n-e);return new Si(r,!0)}}static getBlob(...e){if(w_()){const n=e.map(r=>r instanceof Si?r.data_:r);return new Si(aF.apply(null,n))}else{const n=e.map(o=>v_(o)?uF(Sr.RAW,o).data:o.data_);let r=0;n.forEach(o=>{r+=o.byteLength});const i=new Uint8Array(r);let s=0;return n.forEach(o=>{for(let a=0;a<o.length;a++)i[s++]=o[a]}),new Si(i,!0)}}uploadData(){return this.data_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function E_(t){let e;try{e=JSON.parse(t)}catch{return null}return JM(e)?e:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mF(t){if(t.length===0)return null;const e=t.lastIndexOf("/");return e===-1?"":t.slice(0,e)}function gF(t,e){const n=e.split("/").filter(r=>r.length>0).join("/");return t.length===0?n:t+"/"+n}function oA(t){const e=t.lastIndexOf("/",t.length-2);return e===-1?t:t.slice(e+1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yF(t,e){return e}class cn{constructor(e,n,r,i){this.server=e,this.local=n||e,this.writable=!!r,this.xform=i||yF}}let bu=null;function _F(t){return!v_(t)||t.length<2?t:oA(t)}function aA(){if(bu)return bu;const t=[];t.push(new cn("bucket")),t.push(new cn("generation")),t.push(new cn("metageneration")),t.push(new cn("name","fullPath",!0));function e(s,o){return _F(o)}const n=new cn("name");n.xform=e,t.push(n);function r(s,o){return o!==void 0?Number(o):o}const i=new cn("size");return i.xform=r,t.push(i),t.push(new cn("timeCreated")),t.push(new cn("updated")),t.push(new cn("md5Hash",null,!0)),t.push(new cn("cacheControl",null,!0)),t.push(new cn("contentDisposition",null,!0)),t.push(new cn("contentEncoding",null,!0)),t.push(new cn("contentLanguage",null,!0)),t.push(new cn("contentType",null,!0)),t.push(new cn("metadata","customMetadata",!0)),bu=t,bu}function vF(t,e){function n(){const r=t.bucket,i=t.fullPath,s=new hn(r,i);return e._makeStorageReference(s)}Object.defineProperty(t,"ref",{get:n})}function wF(t,e,n){const r={};r.type="file";const i=n.length;for(let s=0;s<i;s++){const o=n[s];r[o.local]=o.xform(r,e[o.server])}return vF(r,t),r}function lA(t,e,n){const r=E_(e);return r===null?null:wF(t,r,n)}function EF(t,e,n,r){const i=E_(e);if(i===null||!v_(i.downloadTokens))return null;const s=i.downloadTokens;if(s.length===0)return null;const o=encodeURIComponent;return s.split(",").map(d=>{const h=t.bucket,f=t.fullPath,m="/b/"+o(h)+"/o/"+o(f),_=Bc(m,n,r),R=nA({alt:"media",token:d});return _+R})[0]}function IF(t,e){const n={},r=e.length;for(let i=0;i<r;i++){const s=e[i];s.writable&&(n[s.server]=t[s.local])}return JSON.stringify(n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LI="prefixes",MI="items";function TF(t,e,n){const r={prefixes:[],items:[],nextPageToken:n.nextPageToken};if(n[LI])for(const i of n[LI]){const s=i.replace(/\/$/,""),o=t._makeStorageReference(new hn(e,s));r.prefixes.push(o)}if(n[MI])for(const i of n[MI]){const s=t._makeStorageReference(new hn(e,i.name));r.items.push(s)}return r}function xF(t,e,n){const r=E_(n);return r===null?null:TF(t,e,r)}class cf{constructor(e,n,r,i){this.url=e,this.method=n,this.handler=r,this.timeout=i,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function I_(t){if(!t)throw __()}function SF(t,e){function n(r,i){const s=lA(t,i,e);return I_(s!==null),s}return n}function bF(t,e){function n(r,i){const s=xF(t,e,i);return I_(s!==null),s}return n}function CF(t,e){function n(r,i){const s=lA(t,i,e);return I_(s!==null),EF(s,i,t.host,t._protocol)}return n}function T_(t){function e(n,r){let i;return n.getStatus()===401?n.getErrorText().includes("Firebase App Check token is invalid")?i=LM():i=VM():n.getStatus()===402?i=OM(t.bucket):n.getStatus()===403?i=MM(t.path):i=r,i.status=n.getStatus(),i.serverResponse=r.serverResponse,i}return e}function cA(t){const e=T_(t);function n(r,i){let s=e(r,i);return r.getStatus()===404&&(s=jM(t.path)),s.serverResponse=i.serverResponse,s}return n}function AF(t,e,n,r,i){const s={};e.isRoot?s.prefix="":s.prefix=e.path+"/",n.length>0&&(s.delimiter=n),r&&(s.pageToken=r),i&&(s.maxResults=i);const o=e.bucketOnlyServerUrl(),a=Bc(o,t.host,t._protocol),l="GET",d=t.maxOperationRetryTime,h=new cf(a,l,bF(t,e.bucket),d);return h.urlParams=s,h.errorHandler=T_(e),h}function RF(t,e,n){const r=e.fullServerUrl(),i=Bc(r,t.host,t._protocol),s="GET",o=t.maxOperationRetryTime,a=new cf(i,s,CF(t,n),o);return a.errorHandler=cA(e),a}function PF(t,e){const n=e.fullServerUrl(),r=Bc(n,t.host,t._protocol),i="DELETE",s=t.maxOperationRetryTime;function o(l,d){}const a=new cf(r,i,o,s);return a.successCodes=[200,204],a.errorHandler=cA(e),a}function NF(t,e){return t&&t.contentType||e&&e.type()||"application/octet-stream"}function kF(t,e,n){const r=Object.assign({},n);return r.fullPath=t.path,r.size=e.size(),r.contentType||(r.contentType=NF(null,e)),r}function DF(t,e,n,r,i){const s=e.bucketOnlyServerUrl(),o={"X-Goog-Upload-Protocol":"multipart"};function a(){let E="";for(let O=0;O<2;O++)E=E+Math.random().toString().slice(2);return E}const l=a();o["Content-Type"]="multipart/related; boundary="+l;const d=kF(e,r,i),h=IF(d,n),f="--"+l+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+h+`\r
--`+l+`\r
Content-Type: `+d.contentType+`\r
\r
`,m=`\r
--`+l+"--",_=Si.getBlob(f,r,m);if(_===null)throw qM();const R={name:d.fullPath},C=Bc(s,t.host,t._protocol),y="POST",I=t.maxUploadRetryTime,w=new cf(C,y,SF(t,n),I);return w.urlParams=R,w.headers=o,w.body=_.uploadData(),w.errorHandler=T_(e),w}class jF{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=js.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=js.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=js.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,n,r,i,s){if(this.sent_)throw ol("cannot .send() more than once");if(es(e)&&r&&(this.xhr_.withCredentials=!0),this.sent_=!0,this.xhr_.open(n,e,!0),s!==void 0)for(const o in s)s.hasOwnProperty(o)&&this.xhr_.setRequestHeader(o,s[o].toString());return i!==void 0?this.xhr_.send(i):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw ol("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw ol("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw ol("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw ol("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class OF extends jF{initXhr(){this.xhr_.responseType="text"}}function uf(){return new OF}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xs{constructor(e,n){this._service=e,n instanceof hn?this._location=n:this._location=hn.makeFromUrl(n,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,n){return new Xs(e,n)}get root(){const e=new hn(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return oA(this._location.path)}get storage(){return this._service}get parent(){const e=mF(this._location.path);if(e===null)return null;const n=new hn(this._location.bucket,e);return new Xs(this._service,n)}_throwIfRoot(e){if(this._location.path==="")throw KM(e)}}function VF(t,e,n){t._throwIfRoot("uploadBytes");const r=DF(t.storage,t._location,aA(),new Si(e,!0),n);return t.storage.makeRequestWithTokens(r,uf).then(i=>({metadata:i,ref:t}))}function LF(t){const e={prefixes:[],items:[]};return uA(t,e).then(()=>e)}async function uA(t,e,n){const i=await MF(t,{pageToken:n});e.prefixes.push(...i.prefixes),e.items.push(...i.items),i.nextPageToken!=null&&await uA(t,e,i.nextPageToken)}function MF(t,e){e!=null&&typeof e.maxResults=="number"&&ig("options.maxResults",1,1e3,e.maxResults);const n=e||{},r=AF(t.storage,t._location,"/",n.pageToken,n.maxResults);return t.storage.makeRequestWithTokens(r,uf)}function FF(t){t._throwIfRoot("getDownloadURL");const e=RF(t.storage,t._location,aA());return t.storage.makeRequestWithTokens(e,uf).then(n=>{if(n===null)throw HM();return n})}function UF(t){t._throwIfRoot("deleteObject");const e=PF(t.storage,t._location);return t.storage.makeRequestWithTokens(e,uf)}function BF(t,e){const n=gF(t._location.path,e),r=new hn(t._location.bucket,n);return new Xs(t.storage,r)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $F(t){return/^[A-Za-z]+:\/\//.test(t)}function zF(t,e){return new Xs(t,e)}function dA(t,e){if(t instanceof x_){const n=t;if(n._bucket==null)throw zM();const r=new Xs(n,n._bucket);return e!=null?dA(r,e):r}else return e!==void 0?BF(t,e):t}function qF(t,e){if(e&&$F(e)){if(t instanceof x_)return zF(t,e);throw rg("To use ref(service, url), the first argument must be a Storage instance.")}else return dA(t,e)}function FI(t,e){const n=e==null?void 0:e[eA];return n==null?null:hn.makeFromBucketSpec(n,t)}function HF(t,e,n,r={}){t.host=`${e}:${n}`;const i=es(e);i&&(ay(`https://${t.host}/b`),ly("Storage",!0)),t._isUsingEmulator=!0,t._protocol=i?"https":"http";const{mockUserToken:s}=r;s&&(t._overrideAuthToken=typeof s=="string"?s:Wx(s,t.app.options.projectId))}class x_{constructor(e,n,r,i,s,o=!1){this.app=e,this._authProvider=n,this._appCheckProvider=r,this._url=i,this._firebaseVersion=s,this._isUsingEmulator=o,this._bucket=null,this._host=ZC,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=kM,this._maxUploadRetryTime=DM,this._requests=new Set,i!=null?this._bucket=hn.makeFromBucketSpec(i,this._host):this._bucket=FI(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=hn.makeFromBucketSpec(this._url,e):this._bucket=FI(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){ig("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){ig("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const n=await e.getToken();if(n!==null)return n.accessToken}return null}async _getAppCheckToken(){if(Bn(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Xs(this,e)}_makeRequest(e,n,r,i,s=!0){if(this._deleted)return new GM(tA());{const o=sF(e,this._appId,r,i,n,this._firebaseVersion,s,this._isUsingEmulator);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}async makeRequestWithTokens(e,n){const[r,i]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,n,r,i).getPromise()}}const UI="@firebase/storage",BI="0.14.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hA="storage";function $I(t,e,n){return t=ze(t),VF(t,e,n)}function zI(t){return t=ze(t),LF(t)}function qI(t){return t=ze(t),FF(t)}function _p(t){return t=ze(t),UF(t)}function al(t,e){return t=ze(t),qF(t,e)}function Es(t=Ah(),e){t=ze(t);const r=ts(t,hA).getImmediate({identifier:e}),i=zx("storage");return i&&WF(r,...i),r}function WF(t,e,n,r={}){HF(t,e,n,r)}function KF(t,{instanceIdentifier:e}){const n=t.getProvider("app").getImmediate(),r=t.getProvider("auth-internal"),i=t.getProvider("app-check-internal");return new x_(n,r,i,e,ro)}function GF(){cr(new Yn(hA,KF,"PUBLIC").setMultipleInstances(!0)),Sn(UI,BI,""),Sn(UI,BI,"esm2020")}GF();const QF={apiKey:"AIzaSyC70mGCRrjE8iOap8iTHuid8HEuyadue8Y",authDomain:"odontocloud-d92ac.firebaseapp.com",projectId:"odontocloud-d92ac",storageBucket:"odontocloud-d92ac.firebasestorage.app",messagingSenderId:"267020714981",appId:"1:267020714981:web:a44416ea83aa1d1172650c",measurementId:"G-ZMCC5CFY0C"},S_=dy(QF),HI=LS(S_),WI=MC(S_);Es(S_);const YF="/odontocloud-react/assets/fondo.png",fA="/odontocloud-react/assets/logo.png",KI=(t,e)=>{const n={email:t,rol:e,timestamp:Date.now()};localStorage.setItem("odc_session",JSON.stringify(n))},vp=()=>{try{const t=JSON.parse(localStorage.getItem("odc_session"));return t&&Date.now()-t.timestamp<1e3*60*60*24?t:null}catch{return null}},XF=()=>{const t=xh(),[e,n]=N.useState(""),[r,i]=N.useState(""),[s,o]=N.useState(""),[a,l]=N.useState(navigator.onLine);N.useEffect(()=>{const f=()=>l(!0),m=()=>l(!1);return window.addEventListener("online",f),window.addEventListener("offline",m),()=>{window.removeEventListener("online",f),window.removeEventListener("offline",m)}},[]);const d=f=>{const m=(f||"").toLowerCase();m==="administrador"?t("/dashboard_admin",{replace:!0}):m==="doctor"?t("/dashboard_doctor",{replace:!0}):m==="recepcionista"?t("/dashboard_recepcion",{replace:!0}):o("Rol no reconocido. Contacte al administrador.")};N.useEffect(()=>{if(!navigator.onLine){const m=vp();m!=null&&m.rol?d(m.rol):o("Sin conexin y no hay sesin guardada.");return}const f=_y(HI,async m=>{if(m){const _=vp();if(_!=null&&_.rol){d(_.rol);return}try{const R=Je(Me(WI,"users"),Ge("correo","==",m.email||"")),C=await en(R);if(!C.empty){const y=C.docs[0].data().rol||"sin_rol";KI(m.email||"",y),d(y)}}catch{d("administrador")}}});return()=>f()},[]);const h=async f=>{if(f.preventDefault(),o(""),!a){const m=vp();m!=null&&m.rol?d(m.rol):o("Sin conexin y no hay sesin guardada.");return}try{const _=(await Nj(HI,e,r)).user,R=Je(Me(WI,"users"),Ge("correo","==",e)),C=await en(R);if(C.empty){o("Usuario no encontrado en la base de datos.");return}const I=C.docs[0].data().rol||"sin_rol";KI(e,I),d(I)}catch(m){switch(console.error("Error login:",m),m.code){case"auth/user-not-found":o("Usuario no registrado.");break;case"auth/wrong-password":o("Contrasea incorrecta.");break;case"auth/invalid-email":o("Correo no vlido.");break;case"auth/network-request-failed":o("Sin conexin. Usa la sesin guardada o reconecta.");break;default:o("Error al iniciar sesin.")}}};return u.jsx("div",{className:"login-root",style:{backgroundImage:`url(${YF})`,backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat",backgroundAttachment:"fixed",width:"100vw",height:"100vh",display:"flex",justifyContent:"center",alignItems:"center",overflow:"hidden"},children:u.jsxs("div",{className:"container",children:[u.jsxs("div",{className:"left-panel",children:[u.jsx("img",{src:fA,alt:"OdontoCloud Logo",className:"logo"}),u.jsxs("h2",{children:["Su clnica, ",u.jsx("br",{})," ms conectada."]}),u.jsx("p",{children:"OdontoCloud optimiza cada detalle de su gestin."})]}),u.jsxs("div",{className:"right-panel",children:[u.jsx("h3",{children:"Acceso a la plataforma"}),u.jsxs("form",{onSubmit:h,children:[u.jsx("input",{type:"email",placeholder:"usuario@ejemplo.com",value:e,onChange:f=>n(f.target.value),required:a}),u.jsx("input",{type:"password",placeholder:"Contrasea",value:r,onChange:f=>i(f.target.value),required:a}),u.jsx("button",{type:"submit",children:a?"Iniciar sesin":"Entrar (modo offline)"}),s&&u.jsx("p",{style:{color:"red",marginTop:10},children:s}),!a&&u.jsx("p",{style:{color:"orange",marginTop:10},children:" Modo offline activado"})]})]})]})})},pA="@firebase/installations",b_="0.6.19";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mA=1e4,gA=`w:${b_}`,yA="FIS_v2",JF="https://firebaseinstallations.googleapis.com/v1",ZF=60*60*1e3,e4="installations",t4="Installations";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const n4={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},Js=new no(e4,t4,n4);function _A(t){return t instanceof Xn&&t.code.includes("request-failed")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vA({projectId:t}){return`${JF}/projects/${t}/installations`}function wA(t){return{token:t.token,requestStatus:2,expiresIn:i4(t.expiresIn),creationTime:Date.now()}}async function EA(t,e){const r=(await e.json()).error;return Js.create("request-failed",{requestName:t,serverCode:r.code,serverMessage:r.message,serverStatus:r.status})}function IA({apiKey:t}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t})}function r4(t,{refreshToken:e}){const n=IA(t);return n.append("Authorization",s4(e)),n}async function TA(t){const e=await t();return e.status>=500&&e.status<600?t():e}function i4(t){return Number(t.replace("s","000"))}function s4(t){return`${yA} ${t}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function o4({appConfig:t,heartbeatServiceProvider:e},{fid:n}){const r=vA(t),i=IA(t),s=e.getImmediate({optional:!0});if(s){const d=await s.getHeartbeatsHeader();d&&i.append("x-firebase-client",d)}const o={fid:n,authVersion:yA,appId:t.appId,sdkVersion:gA},a={method:"POST",headers:i,body:JSON.stringify(o)},l=await TA(()=>fetch(r,a));if(l.ok){const d=await l.json();return{fid:d.fid||n,registrationStatus:2,refreshToken:d.refreshToken,authToken:wA(d.authToken)}}else throw await EA("Create Installation",l)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xA(t){return new Promise(e=>{setTimeout(e,t)})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function a4(t){return btoa(String.fromCharCode(...t)).replace(/\+/g,"-").replace(/\//g,"_")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const l4=/^[cdef][\w-]{21}$/,sg="";function c4(){try{const t=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(t),t[0]=112+t[0]%16;const n=u4(t);return l4.test(n)?n:sg}catch{return sg}}function u4(t){return a4(t).substr(0,22)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function df(t){return`${t.appName}!${t.appId}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SA=new Map;function bA(t,e){const n=df(t);CA(n,e),d4(n,e)}function CA(t,e){const n=SA.get(t);if(n)for(const r of n)r(e)}function d4(t,e){const n=h4();n&&n.postMessage({key:t,fid:e}),f4()}let bs=null;function h4(){return!bs&&"BroadcastChannel"in self&&(bs=new BroadcastChannel("[Firebase] FID Change"),bs.onmessage=t=>{CA(t.data.key,t.data.fid)}),bs}function f4(){SA.size===0&&bs&&(bs.close(),bs=null)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const p4="firebase-installations-database",m4=1,Zs="firebase-installations-store";let wp=null;function C_(){return wp||(wp=eS(p4,m4,{upgrade:(t,e)=>{switch(e){case 0:t.createObjectStore(Zs)}}})),wp}async function ih(t,e){const n=df(t),i=(await C_()).transaction(Zs,"readwrite"),s=i.objectStore(Zs),o=await s.get(n);return await s.put(e,n),await i.done,(!o||o.fid!==e.fid)&&bA(t,e.fid),e}async function AA(t){const e=df(t),r=(await C_()).transaction(Zs,"readwrite");await r.objectStore(Zs).delete(e),await r.done}async function hf(t,e){const n=df(t),i=(await C_()).transaction(Zs,"readwrite"),s=i.objectStore(Zs),o=await s.get(n),a=e(o);return a===void 0?await s.delete(n):await s.put(a,n),await i.done,a&&(!o||o.fid!==a.fid)&&bA(t,a.fid),a}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function A_(t){let e;const n=await hf(t.appConfig,r=>{const i=g4(r),s=y4(t,i);return e=s.registrationPromise,s.installationEntry});return n.fid===sg?{installationEntry:await e}:{installationEntry:n,registrationPromise:e}}function g4(t){const e=t||{fid:c4(),registrationStatus:0};return RA(e)}function y4(t,e){if(e.registrationStatus===0){if(!navigator.onLine){const i=Promise.reject(Js.create("app-offline"));return{installationEntry:e,registrationPromise:i}}const n={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},r=_4(t,n);return{installationEntry:n,registrationPromise:r}}else return e.registrationStatus===1?{installationEntry:e,registrationPromise:v4(t)}:{installationEntry:e}}async function _4(t,e){try{const n=await o4(t,e);return ih(t.appConfig,n)}catch(n){throw _A(n)&&n.customData.serverCode===409?await AA(t.appConfig):await ih(t.appConfig,{fid:e.fid,registrationStatus:0}),n}}async function v4(t){let e=await GI(t.appConfig);for(;e.registrationStatus===1;)await xA(100),e=await GI(t.appConfig);if(e.registrationStatus===0){const{installationEntry:n,registrationPromise:r}=await A_(t);return r||n}return e}function GI(t){return hf(t,e=>{if(!e)throw Js.create("installation-not-found");return RA(e)})}function RA(t){return w4(t)?{fid:t.fid,registrationStatus:0}:t}function w4(t){return t.registrationStatus===1&&t.registrationTime+mA<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function E4({appConfig:t,heartbeatServiceProvider:e},n){const r=I4(t,n),i=r4(t,n),s=e.getImmediate({optional:!0});if(s){const d=await s.getHeartbeatsHeader();d&&i.append("x-firebase-client",d)}const o={installation:{sdkVersion:gA,appId:t.appId}},a={method:"POST",headers:i,body:JSON.stringify(o)},l=await TA(()=>fetch(r,a));if(l.ok){const d=await l.json();return wA(d)}else throw await EA("Generate Auth Token",l)}function I4(t,{fid:e}){return`${vA(t)}/${e}/authTokens:generate`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function R_(t,e=!1){let n;const r=await hf(t.appConfig,s=>{if(!PA(s))throw Js.create("not-registered");const o=s.authToken;if(!e&&S4(o))return s;if(o.requestStatus===1)return n=T4(t,e),s;{if(!navigator.onLine)throw Js.create("app-offline");const a=C4(s);return n=x4(t,a),a}});return n?await n:r.authToken}async function T4(t,e){let n=await QI(t.appConfig);for(;n.authToken.requestStatus===1;)await xA(100),n=await QI(t.appConfig);const r=n.authToken;return r.requestStatus===0?R_(t,e):r}function QI(t){return hf(t,e=>{if(!PA(e))throw Js.create("not-registered");const n=e.authToken;return A4(n)?{...e,authToken:{requestStatus:0}}:e})}async function x4(t,e){try{const n=await E4(t,e),r={...e,authToken:n};return await ih(t.appConfig,r),n}catch(n){if(_A(n)&&(n.customData.serverCode===401||n.customData.serverCode===404))await AA(t.appConfig);else{const r={...e,authToken:{requestStatus:0}};await ih(t.appConfig,r)}throw n}}function PA(t){return t!==void 0&&t.registrationStatus===2}function S4(t){return t.requestStatus===2&&!b4(t)}function b4(t){const e=Date.now();return e<t.creationTime||t.creationTime+t.expiresIn<e+ZF}function C4(t){const e={requestStatus:1,requestTime:Date.now()};return{...t,authToken:e}}function A4(t){return t.requestStatus===1&&t.requestTime+mA<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function R4(t){const e=t,{installationEntry:n,registrationPromise:r}=await A_(e);return r?r.catch(console.error):R_(e).catch(console.error),n.fid}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function P4(t,e=!1){const n=t;return await N4(n),(await R_(n,e)).token}async function N4(t){const{registrationPromise:e}=await A_(t);e&&await e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function k4(t){if(!t||!t.options)throw Ep("App Configuration");if(!t.name)throw Ep("App Name");const e=["projectId","apiKey","appId"];for(const n of e)if(!t.options[n])throw Ep(n);return{appName:t.name,projectId:t.options.projectId,apiKey:t.options.apiKey,appId:t.options.appId}}function Ep(t){return Js.create("missing-app-config-values",{valueName:t})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NA="installations",D4="installations-internal",j4=t=>{const e=t.getProvider("app").getImmediate(),n=k4(e),r=ts(e,"heartbeat");return{app:e,appConfig:n,heartbeatServiceProvider:r,_delete:()=>Promise.resolve()}},O4=t=>{const e=t.getProvider("app").getImmediate(),n=ts(e,NA).getImmediate();return{getId:()=>R4(n),getToken:i=>P4(n,i)}};function V4(){cr(new Yn(NA,j4,"PUBLIC")),cr(new Yn(D4,O4,"PRIVATE"))}V4();Sn(pA,b_);Sn(pA,b_,"esm2020");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sh="analytics",L4="firebase_id",M4="origin",F4=60*1e3,U4="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",P_="https://www.googletagmanager.com/gtag/js";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mn=new Ch("@firebase/analytics");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const B4={"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-initialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."},Dn=new no("analytics","Analytics",B4);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $4(t){if(!t.startsWith(P_)){const e=Dn.create("invalid-gtag-resource",{gtagURL:t});return mn.warn(e.message),""}return t}function kA(t){return Promise.all(t.map(e=>e.catch(n=>n)))}function z4(t,e){let n;return window.trustedTypes&&(n=window.trustedTypes.createPolicy(t,e)),n}function q4(t,e){const n=z4("firebase-js-sdk-policy",{createScriptURL:$4}),r=document.createElement("script"),i=`${P_}?l=${t}&id=${e}`;r.src=n?n==null?void 0:n.createScriptURL(i):i,r.async=!0,document.head.appendChild(r)}function H4(t){let e=[];return Array.isArray(window[t])?e=window[t]:window[t]=e,e}async function W4(t,e,n,r,i,s){const o=r[i];try{if(o)await e[o];else{const l=(await kA(n)).find(d=>d.measurementId===i);l&&await e[l.appId]}}catch(a){mn.error(a)}t("config",i,s)}async function K4(t,e,n,r,i){try{let s=[];if(i&&i.send_to){let o=i.send_to;Array.isArray(o)||(o=[o]);const a=await kA(n);for(const l of o){const d=a.find(f=>f.measurementId===l),h=d&&e[d.appId];if(h)s.push(h);else{s=[];break}}}s.length===0&&(s=Object.values(e)),await Promise.all(s),t("event",r,i||{})}catch(s){mn.error(s)}}function G4(t,e,n,r){async function i(s,...o){try{if(s==="event"){const[a,l]=o;await K4(t,e,n,a,l)}else if(s==="config"){const[a,l]=o;await W4(t,e,n,r,a,l)}else if(s==="consent"){const[a,l]=o;t("consent",a,l)}else if(s==="get"){const[a,l,d]=o;t("get",a,l,d)}else if(s==="set"){const[a]=o;t("set",a)}else t(s,...o)}catch(a){mn.error(a)}}return i}function Q4(t,e,n,r,i){let s=function(...o){window[r].push(arguments)};return window[i]&&typeof window[i]=="function"&&(s=window[i]),window[i]=G4(s,t,e,n),{gtagCore:s,wrappedGtag:window[i]}}function Y4(t){const e=window.document.getElementsByTagName("script");for(const n of Object.values(e))if(n.src&&n.src.includes(P_)&&n.src.includes(t))return n;return null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const X4=30,J4=1e3;class Z4{constructor(e={},n=J4){this.throttleMetadata=e,this.intervalMillis=n}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,n){this.throttleMetadata[e]=n}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}}const DA=new Z4;function eU(t){return new Headers({Accept:"application/json","x-goog-api-key":t})}async function tU(t){var o;const{appId:e,apiKey:n}=t,r={method:"GET",headers:eU(n)},i=U4.replace("{app-id}",e),s=await fetch(i,r);if(s.status!==200&&s.status!==304){let a="";try{const l=await s.json();(o=l.error)!=null&&o.message&&(a=l.error.message)}catch{}throw Dn.create("config-fetch-failed",{httpStatus:s.status,responseMessage:a})}return s.json()}async function nU(t,e=DA,n){const{appId:r,apiKey:i,measurementId:s}=t.options;if(!r)throw Dn.create("no-app-id");if(!i){if(s)return{measurementId:s,appId:r};throw Dn.create("no-api-key")}const o=e.getThrottleMetadata(r)||{backoffCount:0,throttleEndTimeMillis:Date.now()},a=new sU;return setTimeout(async()=>{a.abort()},F4),jA({appId:r,apiKey:i,measurementId:s},o,a,e)}async function jA(t,{throttleEndTimeMillis:e,backoffCount:n},r,i=DA){var a;const{appId:s,measurementId:o}=t;try{await rU(r,e)}catch(l){if(o)return mn.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${o} provided in the "measurementId" field in the local Firebase config. [${l==null?void 0:l.message}]`),{appId:s,measurementId:o};throw l}try{const l=await tU(t);return i.deleteThrottleMetadata(s),l}catch(l){const d=l;if(!iU(d)){if(i.deleteThrottleMetadata(s),o)return mn.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${o} provided in the "measurementId" field in the local Firebase config. [${d==null?void 0:d.message}]`),{appId:s,measurementId:o};throw l}const h=Number((a=d==null?void 0:d.customData)==null?void 0:a.httpStatus)===503?Ow(n,i.intervalMillis,X4):Ow(n,i.intervalMillis),f={throttleEndTimeMillis:Date.now()+h,backoffCount:n+1};return i.setThrottleMetadata(s,f),mn.debug(`Calling attemptFetch again in ${h} millis`),jA(t,f,r,i)}}function rU(t,e){return new Promise((n,r)=>{const i=Math.max(e-Date.now(),0),s=setTimeout(n,i);t.addEventListener(()=>{clearTimeout(s),r(Dn.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}function iU(t){if(!(t instanceof Xn)||!t.customData)return!1;const e=Number(t.customData.httpStatus);return e===429||e===500||e===503||e===504}class sU{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach(e=>e())}}async function oU(t,e,n,r,i){if(i&&i.global){t("event",n,r);return}else{const s=await e,o={...r,send_to:s};t("event",n,o)}}async function aU(t,e,n,r){if(r&&r.global){const i={};for(const s of Object.keys(n))i[`user_properties.${s}`]=n[s];return t("set",i),Promise.resolve()}else{const i=await e;t("config",i,{update:!0,user_properties:n})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function lU(){if(cy())try{await Xx()}catch(t){return mn.warn(Dn.create("indexeddb-unavailable",{errorInfo:t==null?void 0:t.toString()}).message),!1}else return mn.warn(Dn.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;return!0}async function cU(t,e,n,r,i,s,o){const a=nU(t);a.then(m=>{n[m.measurementId]=m.appId,t.options.measurementId&&m.measurementId!==t.options.measurementId&&mn.warn(`The measurement ID in the local Firebase config (${t.options.measurementId}) does not match the measurement ID fetched from the server (${m.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(m=>mn.error(m)),e.push(a);const l=lU().then(m=>{if(m)return r.getId()}),[d,h]=await Promise.all([a,l]);Y4(s)||q4(s,d.measurementId),i("js",new Date);const f=(o==null?void 0:o.config)??{};return f[M4]="firebase",f.update=!0,h!=null&&(f[L4]=h),i("config",d.measurementId,f),d.measurementId}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uU{constructor(e){this.app=e}_delete(){return delete ea[this.app.options.appId],Promise.resolve()}}let ea={},YI=[];const XI={};let Ip="dataLayer",dU="gtag",JI,N_,ZI=!1;function hU(){const t=[];if(Gx()&&t.push("This is a browser extension environment."),fk()||t.push("Cookies are not available."),t.length>0){const e=t.map((r,i)=>`(${i+1}) ${r}`).join(" "),n=Dn.create("invalid-analytics-context",{errorInfo:e});mn.warn(n.message)}}function fU(t,e,n){hU();const r=t.options.appId;if(!r)throw Dn.create("no-app-id");if(!t.options.apiKey)if(t.options.measurementId)mn.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${t.options.measurementId} provided in the "measurementId" field in the local Firebase config.`);else throw Dn.create("no-api-key");if(ea[r]!=null)throw Dn.create("already-exists",{id:r});if(!ZI){H4(Ip);const{wrappedGtag:s,gtagCore:o}=Q4(ea,YI,XI,Ip,dU);N_=s,JI=o,ZI=!0}return ea[r]=cU(t,YI,XI,e,JI,Ip,n),new uU(t)}function pU(t=Ah()){t=ze(t);const e=ts(t,sh);return e.isInitialized()?e.getImmediate():mU(t)}function mU(t,e={}){const n=ts(t,sh);if(n.isInitialized()){const i=n.getImmediate();if(Qr(e,n.getOptions()))return i;throw Dn.create("already-initialized")}return n.initialize({options:e})}function gU(t,e,n){t=ze(t),aU(N_,ea[t.app.options.appId],e,n).catch(r=>mn.error(r))}function yU(t,e,n,r){t=ze(t),oU(N_,ea[t.app.options.appId],e,n,r).catch(i=>mn.error(i))}const eT="@firebase/analytics",tT="0.10.19";function _U(){cr(new Yn(sh,(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),i=e.getProvider("installations-internal").getImmediate();return fU(r,i,n)},"PUBLIC")),cr(new Yn("analytics-internal",t,"PRIVATE")),Sn(eT,tT),Sn(eT,tT,"esm2020");function t(e){try{const n=e.getProvider(sh).getImmediate();return{logEvent:(r,i,s)=>yU(n,r,i,s),setUserProperties:(r,i)=>gU(n,r,i)}}catch(n){throw Dn.create("interop-component-reg-failed",{reason:n})}}}_U();const vU={apiKey:"AIzaSyC70mGCRrjE8iOap8iTHuid8HEuyadue8Y",authDomain:"odontocloud-d92ac.firebaseapp.com",projectId:"odontocloud-d92ac",storageBucket:"odontocloud-d92ac.firebasestorage.app",messagingSenderId:"267020714981",appId:"1:267020714981:web:a44416ea83aa1d1172650c",measurementId:"G-ZMCC5CFY0C"},ff=dy(vU),oh=LS(ff),_e=MC(ff);Es(ff);pU(ff);const Tp="TU EMPRESA S.A.S.",wU="Generado por OdontoCloud",Cu=()=>{const t=new Date;return t.setHours(0,0,0,0),t},ds=t=>{const e=new Date(t);return e.setHours(0,0,0,0),e},xp=t=>{const e=new Date(t);return e.setHours(23,59,59,999),e},_r=(t,e)=>{const n=new Date(t);return n.setDate(n.getDate()+e),n},nT=t=>{const e=new Date(t),n=e.getDay(),r=(n===0?-6:1)-n;return e.setDate(e.getDate()+r),e.setHours(0,0,0,0),e},rT=(t,e)=>t.getFullYear()===e.getFullYear()&&t.getMonth()===e.getMonth()&&t.getDate()===e.getDate();var lT;const _n=typeof navigator<"u"&&((lT=navigator.language)!=null&&lT.startsWith("es"))?"es-ES":"en-US",Sp=t=>{const e=t.getFullYear(),n=String(t.getMonth()+1).padStart(2,"0"),r=String(t.getDate()).padStart(2,"0");return`${e}-${n}-${r}`},_o=t=>(t||"").toString().toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/\s+/g," ").trim();function EU(){const[t,e]=N.useState("day"),[n,r]=N.useState(Cu()),[i,s]=N.useState(Cu()),[o,a]=N.useState(!0),[l,d]=N.useState([]),[h,f]=N.useState(""),[m,_]=N.useState(""),[R,C]=N.useState("");N.useEffect(()=>{a(!0);const $=Me(_e,"citas"),J=Je($,rn("fecha","asc")),le=rr(J,ue=>{const Ie=ue.docs.map(we=>{const re=we.data(),Ae=re.horaInicio||re.hora||"00:00",[Et="0",Tt="0"]=Ae.split(":"),Q=parseInt(Et,10)||0,ne=parseInt(Tt,10)||0;let de;if(re.fecha&&re.fecha.toDate)de=re.fecha.toDate(),de.setHours(Q,ne,0,0);else if(typeof re.fecha=="string"){const[ge,he,Te]=re.fecha.split("-");de=new Date(parseInt(ge,10),parseInt(he,10)-1,parseInt(Te,10),Q,ne,0,0)}else re.fecha instanceof Date?(de=new Date(re.fecha),de.setHours(Q,ne,0,0)):(de=new Date,de.setHours(Q,ne,0,0));const te=re.documentoPaciente||re.docPaciente||re.pacienteDocumento||re.documento||"",ee=re.celularPaciente||re.telefonoPaciente||re.celular||re.telefono||"";return{id:we.id,raw:re,fecha:de,horaInicio:Ae,paciente:re.paciente||re.pacienteNombre||"Sin nombre",doctor:re.doctor||re.doctorNombre||"",sucursal:re.sucursal||"",espacio:re.espacio||re.consultorio||"",comentario:re.comentario||"",estado:re.estado||"En espera",recordatorio:re.recordatorio||"",documento:te,telefono:ee}});let je,me;if(t==="day")je=ds(n),me=xp(n);else if(t==="week"){const we=nT(n),re=_r(we,6);je=ds(we),me=xp(re)}else{const we=ds(n),re=_r(we,-30),Ae=_r(we,60);je=ds(re),me=xp(Ae)}const Qe=Ie.filter(we=>we.fecha>=je&&we.fecha<=me);d(Qe),a(!1)},ue=>{console.error("Error leyendo citas:",ue),d([]),a(!1)});return()=>le()},[t,n]);const y=N.useMemo(()=>{const $=new Set;return l.forEach(J=>J.sucursal&&$.add(J.sucursal)),Array.from($)},[l]),I=N.useMemo(()=>{const $=new Set;return l.forEach(J=>J.doctor&&$.add(J.doctor)),Array.from($)},[l]),w=N.useMemo(()=>{const $=R.trim().toLowerCase();return l.filter(J=>{if(h&&J.sucursal!==h||m&&J.doctor!==m)return!1;if(!$)return!0;const le=[J.paciente,J.doctor,J.comentario,J.documento,J.sucursal,J.espacio,J.estado],ue=J.raw?JSON.stringify(J.raw):"";return[...le,ue].filter(Boolean).some(je=>String(je).toLowerCase().includes($))})},[l,h,m,R]),E=N.useMemo(()=>o?"Ocupacin: cargando...":w.length===0?"Ocupacin: sin citas para el rango seleccionado.":`Ocupacin: ${w.length} cita${w.length!==1?"s":""} en el rango actual.`,[w,o]),O=N.useMemo(()=>{const $=new Date(i.getFullYear(),i.getMonth(),1),J=($.getDay()+6)%7,le=new Date($);le.setDate(le.getDate()-J);const ue=[];for(let Ie=0;Ie<6;Ie++){const je=[];for(let me=0;me<7;me++){const Qe=new Date(le),we=Qe.getMonth()===i.getMonth(),re=rT(Qe,Cu()),Ae=rT(Qe,n);je.push({date:Qe,isCurrentMonth:we,isToday:re,isSelected:Ae}),le.setDate(le.getDate()+1)}ue.push(je)}return ue},[i,n]),D=()=>{const $=new Date(i);$.setMonth($.getMonth()-1),s($)},B=()=>{const $=new Date(i);$.setMonth($.getMonth()+1),s($)},x=$=>{r(ds($)),s(ds($)),e("day")},v=N.useMemo(()=>i.toLocaleDateString(_n,{month:"long",year:"numeric"}),[i]),b=N.useMemo(()=>{if(t==="day")return n.toLocaleDateString(_n,{weekday:"long",day:"2-digit",month:"long",year:"numeric"});if(t==="week"){const $=nT(n),J=_r($,6);return $.toLocaleDateString(_n,{day:"2-digit",month:"short"})+" - "+J.toLocaleDateString(_n,{day:"2-digit",month:"short",year:"numeric"})}return"ltimas citas (detalle)"},[t,n]),A=()=>{r(t==="day"?_r(n,-1):t==="week"?_r(n,-7):_r(n,-1))},j=()=>{r(t==="day"?_r(n,1):t==="week"?_r(n,7):_r(n,1))},V=()=>{const $=Cu();r($),s($),e("day")},P=()=>{var Et,Tt,Q;const $=ne=>String(ne??"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),J=((Et=document.querySelector('meta[name="company-name"]'))==null?void 0:Et.getAttribute("content"))||Tp,le=((Tt=document.querySelector('meta[name="company-logo"]'))==null?void 0:Tt.getAttribute("content"))||"",ue="Generado por OdontoCloud",Ie=w.length===0?'<tr><td colspan="6" style="padding:8px 6px;color:#6b7280">No hay citas registradas para este rango.</td></tr>':w.map(ne=>{const de=ne.fecha.toLocaleDateString(_n),te=ne.fecha.toLocaleTimeString(_n,{hour:"2-digit",minute:"2-digit",hour12:!0});return`<tr>
              <td>${$(de)}</td>
              <td>${$(te)}</td>
              <td>${$(ne.paciente)}</td>
              <td>${$(ne.doctor)}</td>
              <td>${$(ne.espacio)}</td>
              <td>${$(ne.comentario)}</td>
            </tr>`}).join(""),me=`<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>Imprimir  ${$(J)}</title>
  <style>
    @page { size: A4 portrait; margin: 18mm; }
    body { font-family: Segoe UI, Roboto, Arial, sans-serif; color:#0f172a; }
    .hdr { display:flex; align-items:center; gap:12px; border-bottom:2px solid #e5e7eb; padding-bottom:8px; margin-bottom:12px; }
    .brand { font-size:18px; font-weight:700; color:#0a86d8; line-height:1.1; }
    .sub { font-size:12px; color:#6b7280; }
    table { width:100%; border-collapse:collapse; font-size:12px; }
    th { text-align:left; background:#f3f4f6; border-bottom:1px solid #e5e7eb; padding:8px 6px; }
    td { border-bottom:1px solid #f1f5f9; padding:7px 6px; vertical-align:top; }
    .note { margin-top:8px; font-size:10px; color:#9ca3af; }
    tr, .hdr { page-break-inside: avoid; }
  </style>
</head>
<body>
  <div class="hdr">
    ${le?`<img src="${le}" alt="Logo" style="height:36px;object-fit:contain">`:""}
    <div>
      <div class="brand">${$(J)}</div>
      <div class="sub">Agenda de citas  ${$(b)}</div>
    </div>
  </div>

  <table>
    <thead>
      <tr>
        <th style="width:18%">Fecha</th>
        <th style="width:10%">Hora</th>
        <th style="width:22%">Paciente</th>
        <th style="width:20%">Doctor</th>
        <th style="width:15%">Espacio</th>
        <th>Comentario</th>
      </tr>
    </thead>
    <tbody>${Ie}</tbody>
  </table>

  <div class="note">${$(ue)}. ${$(new Date().toLocaleString(_n))}</div>
  <script>
    // Imprimir cuando termine de cargar la pestaa (incluye el logo)
    window.addEventListener('load', function() {
      try { window.focus(); window.print(); } catch (e) {}
    });
  <\/script>
</body>
</html>`,Qe=new Blob([me],{type:"text/html;charset=utf-8"}),we=URL.createObjectURL(Qe),re=window.open(we,"_blank","noopener,noreferrer,width=900,height=700");if(!re){alert("El navegador bloque la ventana de impresin. Permite pop-ups para este sitio."),URL.revokeObjectURL(we);return}const Ae=()=>{try{URL.revokeObjectURL(we)}catch{}};(Q=re.addEventListener)==null||Q.call(re,"load",Ae),setTimeout(Ae,15e3)},q=()=>alert("Funcin de confirmar citas se integrar con n8n / correo."),qe=()=>V(),Pt=()=>{if(w.length===0){alert("No hay citas para exportar.");return}const $=[`Empresa: ${Tp}`],J=["Fecha","Hora","Paciente","Doctor","Espacio","Comentario"],le=w.map(re=>{const Ae=re.fecha.toLocaleDateString(_n),Et=re.fecha.toLocaleTimeString(_n,{hour:"2-digit",minute:"2-digit",hour12:!0});return[Ae,Et,re.paciente||"",re.doctor||"",re.espacio||"",(re.comentario||"").replace(/\r?\n/g," ")]}),ue=[wU],Ie=[$,[],J,...le,[],ue].map(re=>(re||[]).map(Ae=>`"${String(Ae??"").replace(/"/g,'""')}"`).join(",")).join(`
`),je=`citas_${Tp.toLowerCase().replace(/\s+/g,"_")}_${Sp(ds(n))}`+(t==="week"?"_semana":t==="detail"?"_detalle":"")+".csv",me=new Blob(["\uFEFF"+Ie],{type:"text/csv;charset=utf-8;"}),Qe=URL.createObjectURL(me),we=document.createElement("a");we.href=Qe,we.download=je,we.click(),URL.revokeObjectURL(Qe)},$t=async($,J)=>{try{const le=Kt(_e,"citas",$);await Zo(le,{estado:J})}catch(le){console.error("Error actualizando estado:",le),alert("No se pudo actualizar el estado de la cita.")}},X=($,J)=>{if(!$){alert("Este paciente no tiene celular registrado.");return}const le=String($).replace(/\D/g,""),ue=J.fecha.toLocaleDateString(_n),Ie=J.fecha.toLocaleTimeString(_n,{hour:"numeric",minute:"2-digit",hour12:!0}),je=encodeURIComponent(`Hola ${J.paciente}, le recordamos su cita odontolgica el ${ue} a las ${Ie}. Por favor confirme su asistencia.`),me=`https://wa.me/${le}?text=${je}`;window.open(me,"_blank")},ce=async $=>{if(window.confirm(`Seguro que deseas eliminar la cita de ${$.paciente} del ${$.fecha.toLocaleDateString(_n)}?`))try{const le=Kt(_e,"citas",$.id);await XC(le)}catch(le){console.error("Error eliminando cita:",le),alert(" No se pudo eliminar la cita.")}},pe=()=>{const $=document.createElement("div");Object.assign($.style,{position:"fixed",top:"0",left:"0",width:"100%",height:"100%",background:"rgba(0,0,0,0.55)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:"9999"});const J=document.createElement("div");Object.assign(J.style,{background:"#fff",padding:"25px 30px",borderRadius:"14px",width:"520px",maxWidth:"95%",maxHeight:"95%",overflowY:"auto",boxShadow:"0 8px 30px rgba(0,0,0,0.3)",fontFamily:"Segoe UI, Roboto, sans-serif"}),J.innerHTML=`
      <h2 style="margin-top:0;text-align:center;color:#0a86d8;font-weight:600;"> Nueva Cita</h2>
      <form id="formNuevaCita" style="display:flex;flex-direction:column;gap:12px;margin-top:10px;">
        <label style="font-weight:600;">Paciente existente</label>
        <div style="position:relative;">
          <input type="text" id="buscarPaciente" placeholder="Buscar por nombre, apellido o documento..." autocomplete="off"/>
          <div id="acResultados" style="position:absolute;left:0;right:0;top:calc(100% + 6px);z-index:10000;display:none;background:#fff;border:1px solid #ddd;border-radius:8px;box-shadow:0 8px 22px rgba(0,0,0,.12);max-height:240px;overflow:auto;"></div>
        </div>
        <small style="color:gray;">Si el paciente no existe, marca Registrar nuevo paciente.</small>

        <label style="display:flex;align-items:center;gap:8px;margin-top:5px;">
          <input type="checkbox" id="esNuevoPaciente" />
          <span>Registrar nuevo paciente</span>
        </label>

        <div id="nuevoPacienteCampos" style="display:none;flex-direction:column;gap:8px;margin-top:10px;padding:10px;border-radius:8px;background:#f9f9f9;border:1px solid #ddd;">
          <h4 style="margin:0;text-align:center;color:#0a86d8;">Datos del paciente</h4>
          <div style="display:flex;gap:8px;">
            <input type="text" id="npNombre" placeholder="Nombre" style="flex:1;" />
            <input type="text" id="npApellido" placeholder="Apellido" style="flex:1;" />
          </div>
          <select id="npTipoDocumento">
            <option value="">Tipo de documento</option>
            <option value="CC">Cdula de Ciudadana</option>
            <option value="CE">Cdula de Extranjera</option>
            <option value="TI">Tarjeta de Identidad</option>
            <option value="PA">Pasaporte</option>
            <option value="DI">Documento Internacional</option>
            <option value="OTRO">Otro</option>
          </select>
          <input type="text" id="npDocumento" placeholder="Nmero de documento" />
          <input type="email" id="npCorreo" placeholder="Correo electrnico" />
          <div style="display:flex;gap:5px;">
            <select id="npIndicativo" style="width:40%;">
              <option value="+57"> +57</option>
              <option value="+1"> +1</option>
              <option value="+34"> +34</option>
              <option value="+52"> +52</option>
              <option value="+54"> +54</option>
              <option value="+593"> +593</option>
              <option value="+56"> +56</option>
              <option value="+58"> +58</option>
            </select>
            <input type="tel" id="npCelular" placeholder="Celular (obligatorio)" style="flex:1;" />
          </div>
          <input type="tel" id="npTelefono" placeholder="Telfono fijo (opcional)" />
          <label style="font-weight:500;">Fecha de nacimiento:</label>
          <input type="date" id="npNacimiento" />
          <select id="npSexo">
            <option value="">Sexo</option>
            <option value="Masculino">Masculino</option>
            <option value="Femenino">Femenino</option>
            <option value="Otro">Otro</option>
          </select>
          <textarea id="npComentario" placeholder="Comentario o antecedentes del paciente" rows="2"></textarea>
        </div>

        <hr style="margin:10px 0;border:none;border-top:1px solid #ddd;" />
        <h4 style="margin:0;text-align:center;color:#0a86d8;">Detalles de la cita</h4>
        <input type="text" id="ncDoctor" placeholder="Doctor asignado" required />
        <input type="date" id="ncFecha" required value="${Sp(n)}" />
        <input type="time" id="ncHora" required />
        <input type="text" id="ncEspacio" placeholder="Espacio fsico / Sala" />
        <textarea id="ncComentario" placeholder="Comentario sobre la cita" rows="3"></textarea>

        <div style="display:flex;justify-content:flex-end;gap:10px;margin-top:10px;">
          <button type="button" id="btnCancelarModal" class="btn-cancelar">Cancelar</button>
          <button type="submit" class="btn-guardar">Guardar</button>
        </div>
      </form>
    `;const le=document.createElement("style");le.textContent=`
      .btn-cancelar, .btn-guardar { padding: 8px 14px; border: none; border-radius: 6px; cursor: pointer; font-weight: 600; font-size: 14px; transition: .2s; }
      .btn-cancelar { background: #e0e0e0; color: #333; } .btn-cancelar:hover { background: #d5d5d5; }
      .btn-guardar { background: #0a86d8; color: white; } .btn-guardar:hover { background: #0669ac; }
      input, select, textarea { width: 100%; padding: 8px 10px; border: 1px solid #ccc; border-radius: 6px; font-size: 14px; outline: none; }
      input:focus, select:focus, textarea:focus { border-color: #0a86d8; box-shadow: 0 0 0 2px rgba(10,134,216,.2); }
      .ac-item { padding: 8px 10px; display:flex; gap:8px; align-items:baseline; cursor:pointer; }
      .ac-item:hover, .ac-item.active { background:#f5f7fb; }
      .ac-name { font-weight:600; } .ac-doc { color:#64748b; font-size:12px; } .ac-tel { margin-left:auto; font-size:12px; color:#0f172a; }
      .ac-empty { padding:10px; color:#9aa4b2; font-size:13px; }
    `,document.head.appendChild(le),$.appendChild(J),document.body.appendChild($);const ue=J.querySelector("#esNuevoPaciente"),Ie=J.querySelector("#nuevoPacienteCampos"),je=J.querySelector("#buscarPaciente"),me=J.querySelector("#acResultados");ue.addEventListener("change",()=>{Ie.style.display=ue.checked?"flex":"none",ue.checked&&(me.style.display="none")}),J.querySelector("#btnCancelarModal").addEventListener("click",()=>$.remove());let Qe=null,we=null,re=-1,Ae=[];const Et=ee=>{if(Ae=ee||[],re=-1,!ee||ee.length===0){me.innerHTML='<div class="ac-empty">Sin resultados</div>',me.style.display="block";return}me.innerHTML=ee.map((ge,he)=>`
            <div class="ac-item" data-index="${he}" data-id="${ge.id}">
              <span class="ac-name">${ge.nombre}</span>
              <span class="ac-doc"> ${ge.documento||"s/doc"}</span>
              <span class="ac-tel">${ge.celular||ge.telefono||""}</span>
            </div>`).join(""),me.style.display="block",[...me.querySelectorAll(".ac-item")].forEach(ge=>{ge.addEventListener("click",()=>{const he=Number(ge.getAttribute("data-index"));Tt(he)})})},Tt=ee=>{const ge=Ae[ee];ge&&(we=ge,je.value=ge.nombre,me.style.display="none",ue.checked=!1,Ie.style.display="none")},Q=ee=>{Ae.length&&(re=(re+ee+Ae.length)%Ae.length,[...me.querySelectorAll(".ac-item")].forEach((ge,he)=>{he===re?ge.classList.add("active"):ge.classList.remove("active")}))},ne=(ee,ge)=>ee.nombreCompleto||ee.paciente||[ee.nombres,ee.apellidos].filter(Boolean).join(" ")||ge,de=async ee=>{const ge=(ee||"").toString().trim(),he=_o(ge);if(!he||he.length<2)return[];if(/^\d{5,}$/.test(ge))try{const Te=Je(Me(_e,"pacientes"),Ge("documento","==",ge)),De=Je(Me(_e,"pacientes"),Ge("nroDocumento","==",ge)),[$e,Xe]=await Promise.all([en(Te),en(De)]),Se=$e.empty?Xe:$e;if(!Se.empty)return Se.docs.slice(0,10).map(S=>{const k=S.data()||{};return{id:S.id,nombre:ne(k,S.id),documento:k.documento||k.nroDocumento||S.id,celular:k.celularPaciente||k.celular||"",telefono:k.telefonoPaciente||k.telefono||""}})}catch{}try{const Te=Je(Me(_e,"pacientes"),rn("nombre_busqueda"),NI(he),kI(he+""),Jo(10)),De=await en(Te);if(!De.empty)return De.docs.map($e=>{const Xe=$e.data()||{};return{id:$e.id,nombre:ne(Xe,$e.id),documento:Xe.documento||Xe.nroDocumento||$e.id,celular:Xe.celularPaciente||Xe.celular||"",telefono:Xe.telefonoPaciente||Xe.telefono||""}})}catch{}try{const Te=Je(Me(_e,"pacientes"),rn("creado","desc"),Jo(50));return(await en(Te)).docs.map(Se=>({id:Se.id,...Se.data()||{}})).map(Se=>({id:Se.id,nombre:ne(Se,Se.id),documento:Se.documento||Se.nroDocumento||Se.id,celular:Se.celularPaciente||Se.celular||"",telefono:Se.telefonoPaciente||Se.telefono||"",_norm:_o(`${Se.nombreCompleto||Se.paciente||""} ${Se.nombres||""} ${Se.apellidos||""} ${Se.documento||Se.nroDocumento||""}`)})).filter(Se=>Se._norm.includes(he)).slice(0,10).map(({_norm:Se,...S})=>S)}catch{}return[]};je.addEventListener("input",()=>{we=null;const ee=je.value;if(clearTimeout(Qe),!ee||ee.trim().length<2){me.style.display="none";return}Qe=setTimeout(async()=>{const ge=await de(ee.trim());Et(ge)},220)}),je.addEventListener("keydown",ee=>{me.style.display==="block"&&(ee.key==="ArrowDown"?(ee.preventDefault(),Q(1)):ee.key==="ArrowUp"?(ee.preventDefault(),Q(-1)):ee.key==="Enter"?re>=0&&(ee.preventDefault(),Tt(re)):ee.key==="Escape"&&(me.style.display="none"))}),document.addEventListener("click",ee=>{J.contains(ee.target)&&!me.contains(ee.target)&&ee.target!==je&&(me.style.display="none")},{capture:!0});const te=J.querySelector("#formNuevaCita");te.addEventListener("submit",async ee=>{ee.preventDefault();const ge=ue.checked,he=(te.querySelector("#buscarPaciente").value||"").trim(),Te=te.querySelector("#ncDoctor").value.trim(),De=te.querySelector("#ncFecha").value,$e=te.querySelector("#ncHora").value,Xe=te.querySelector("#ncEspacio").value.trim(),Se=te.querySelector("#ncComentario").value.trim();if(!De||!$e){alert(" Debes seleccionar fecha y hora para la cita.");return}if(!Te){alert(" Indica el doctor asignado.");return}try{let S=null,k=null,z="",G="",oe="";if(ge){const Nt=(te.querySelector("#npNombre").value||"").trim(),et=(te.querySelector("#npApellido").value||"").trim();if(z=`${Nt} ${et}`.trim(),!z){alert(" Debes indicar nombre y apellido para el nuevo paciente.");return}const pt=(te.querySelector("#npDocumento").value||"").trim(),tt=(te.querySelector("#npCelular").value||"").trim(),St=(te.querySelector("#npTelefono").value||"").trim();if(!tt&&!St){alert(" Debes registrar al menos un telfono (celular o fijo) del paciente o de un acudiente.");return}if(S=pt||z.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/\s+/g,"_"),k=Kt(_e,"pacientes",S),!(await nh(k)).exists()){const Oe=_o(z);await rh(k,{nombres:Nt,apellidos:et,nombreCompleto:z,paciente:z,nombre_busqueda:Oe,variantes_busqueda:[Oe,_o(Nt),_o(et)],tipoDocumento:te.querySelector("#npTipoDocumento").value,documento:pt,correo:(te.querySelector("#npCorreo").value||"").trim(),indicativo:te.querySelector("#npIndicativo").value,celular:tt,telefono:St,celularPaciente:tt,telefonoPaciente:St,fechaNacimiento:te.querySelector("#npNacimiento").value,sexo:te.querySelector("#npSexo").value,notas:(te.querySelector("#npComentario").value||"").trim(),creado:new Date().toISOString(),activo:!0,citas:[]},{merge:!0})}G=tt,oe=St}else if(we)S=we.id,z=we.nombre,k=Kt(_e,"pacientes",S),G=we.celular||"",oe=we.telefono||"";else{if(!he){alert(" Por favor, escribe o selecciona un paciente.");return}const Nt=Je(Me(_e,"pacientes"),Ge("documento","==",he)),et=Je(Me(_e,"pacientes"),Ge("nroDocumento","==",he)),[pt,tt]=await Promise.all([en(Nt),en(et)]),St=pt.empty?tt:pt;if(St.empty){let zt=null;try{const Oe=_o(he),$c=Je(Me(_e,"pacientes"),rn("nombre_busqueda"),NI(Oe),kI(Oe+""),Jo(1)),ri=await en($c);if(!ri.empty){const jr=ri.docs[0],pr=jr.data()||{};zt={id:jr.id,ref:jr.ref,nombre:pr.nombreCompleto||pr.paciente||[pr.nombres,pr.apellidos].filter(Boolean).join(" "),cel:pr.celularPaciente||pr.celular||"",tel:pr.telefonoPaciente||pr.telefono||""}}}catch{}zt?(S=zt.id,k=zt.ref,z=zt.nombre||he,G=zt.cel||"",oe=zt.tel||""):z=he}else{const zt=St.docs[0],Oe=zt.data()||{};S=zt.id,k=zt.ref,z=Oe.nombreCompleto||Oe.paciente||[Oe.nombres,Oe.apellidos].filter(Boolean).join(" ")||he,G=Oe.celularPaciente||Oe.celular||"",oe=Oe.telefonoPaciente||Oe.telefono||""}}if(!(G||oe||"").trim()){alert(" Este paciente no tiene ningn telfono registrado. Edita sus datos y agrega un nmero antes de guardar la cita.");return}const xt={paciente:z||"Paciente",pacienteId:S||null,doctor:Te,fecha:De,horaInicio:$e,espacio:Xe,comentario:Se,estado:"En espera",creado:new Date().toISOString(),celularPaciente:G||"",telefonoPaciente:oe||""},bn=await vl(Me(_e,"citas"),xt);k&&await rh(k,{citas:NM(bn.id)},{merge:!0}),alert(" Cita registrada correctamente y vinculada al paciente."),$.remove()}catch(S){console.error(" Error al guardar cita:",S),alert(" Error al guardar la cita. Revisa la consola para ms detalles.")}})},ke=$=>{var Qe,we;const J=document.createElement("div");Object.assign(J.style,{position:"fixed",top:"0",left:"0",width:"100%",height:"100%",background:"rgba(0,0,0,0.55)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:"9999"});const le=document.createElement("div");Object.assign(le.style,{background:"#fff",padding:"25px 30px",borderRadius:"14px",width:"520px",maxWidth:"95%",maxHeight:"95%",overflowY:"auto",boxShadow:"0 8px 30px rgba(0,0,0,0.3)",fontFamily:"Segoe UI, Roboto, sans-serif"});const ue=(Qe=$.raw)!=null&&Qe.fecha&&typeof $.raw.fecha=="string"?$.raw.fecha:Sp($.fecha),Ie=((we=$.raw)==null?void 0:we.horaInicio)||$.fecha.toTimeString().slice(0,5);le.innerHTML=`
      <h2 style="margin-top:0;text-align:center;color:#0a86d8;font-weight:600;"> Editar Cita</h2>
      <form id="formEditarCita" style="display:flex;flex-direction:column;gap:12px;margin-top:10px;">
        <label>Paciente</label>
        <input type="text" id="editPaciente" value="${$.paciente||""}" />

        <label>Doctor asignado</label>
        <input type="text" id="editDoctor" value="${$.doctor||""}" />

        <div style="display:flex;gap:8px;">
          <div style="flex:1;">
            <label>Fecha</label>
            <input type="date" id="editFecha" value="${ue}" />
          </div>
          <div style="flex:1;">
            <label>Hora</label>
            <input type="time" id="editHora" value="${Ie}" />
          </div>
        </div>

        <label>Espacio fsico / Sala</label>
        <input type="text" id="editEspacio" value="${$.espacio||""}" />

        <label>Estado</label>
        <select id="editEstado" className="estado-select">
          <option value="En espera" ${$.estado==="En espera"?"selected":""}>En espera</option>
          <option value="En sala" ${$.estado==="En sala"?"selected":""}>En sala</option>
          <option value="Atendiendo" ${$.estado==="Atendiendo"?"selected":""}>Atendiendo</option>
          <option value="Finalizada" ${$.estado==="Finalizada"?"selected":""}>Finalizada</option>
          <option value="pendiente" ${$.estado==="pendiente"?"selected":""}>Pendiente</option>
          <option value="No asisti" ${$.estado==="No asisti"?"selected":""}>No asisti</option>
        </select>

        <label>Comentario</label>
        <textarea id="editComentario" rows="3">${$.comentario||""}</textarea>

        <div style="display:flex;justify-content:flex-end;gap:10px;margin-top:10px;">
          <button type="button" id="btnCancelarEdit" className="btn-cancelar">Cancelar</button>
          <button type="submit" className="btn-guardar">Guardar cambios</button>
        </div>
      </form>
    `;const je=document.createElement("style");je.textContent=`
      .btn-cancelar, .btn-guardar { padding: 8px 14px; border: none; border-radius: 6px; cursor: pointer; font-weight: 600; font-size: 14px; transition: .2s; }
      .btn-cancelar { background: #e0e0e0; color: #333; } .btn-cancelar:hover { background: #d5d5d5; }
      .btn-guardar { background: #0a86d8; color: white; } .btn-guardar:hover { background: #0669ac; }
      #formEditarCita input, #formEditarCita select, #formEditarCita textarea { width: 100%; padding: 8px 10px; border: 1px solid #ccc; border-radius: 6px; font-size: 14px; outline: none; }
      #formEditarCita input:focus, #formEditarCita select:focus, #formEditarCita textarea:focus { border-color: #0a86d8; box-shadow: 0 0 0 2px rgba(10,134,216,.2); }
    `,document.head.appendChild(je),J.appendChild(le),document.body.appendChild(J),le.querySelector("#btnCancelarEdit").addEventListener("click",()=>J.remove());const me=le.querySelector("#formEditarCita");me.addEventListener("submit",async re=>{re.preventDefault();const Ae=me.querySelector("#editPaciente").value.trim(),Et=me.querySelector("#editDoctor").value.trim(),Tt=me.querySelector("#editFecha").value,Q=me.querySelector("#editHora").value,ne=me.querySelector("#editEspacio").value.trim(),de=me.querySelector("#editEstado").value,te=me.querySelector("#editComentario").value.trim();if(!Ae)return alert(" El nombre del paciente es obligatorio.");if(!Tt||!Q)return alert(" Debes indicar fecha y hora.");try{const ee=Kt(_e,"citas",$.id);await Zo(ee,{paciente:Ae,doctor:Et,fecha:Tt,horaInicio:Q,espacio:ne,estado:de,comentario:te}),alert(" Cita actualizada correctamente."),J.remove()}catch(ee){console.error(" Error al actualizar cita:",ee),alert(" Error al actualizar la cita. Revisa la consola para ms detalles.")}})},Be=$=>{const J=$.fecha.toLocaleDateString(_n),le=$.fecha.toLocaleTimeString(_n,{hour:"numeric",minute:"2-digit",hour12:!0}),ue=`${J}  ${le}`;return u.jsxs("tr",{className:"fade-in-row",onClick:()=>ke($),style:{cursor:"pointer"},children:[u.jsx("td",{children:ue}),u.jsx("td",{children:$.paciente}),u.jsx("td",{children:$.doctor}),u.jsx("td",{children:$.espacio}),u.jsx("td",{children:$.comentario}),u.jsx("td",{onClick:Ie=>{Ie.stopPropagation()},children:u.jsxs("select",{className:"estado-select",value:$.estado,onChange:Ie=>$t($.id,Ie.target.value),children:[u.jsx("option",{value:"En espera",children:"En espera"}),u.jsx("option",{value:"En sala",children:"En sala"}),u.jsx("option",{value:"Atendiendo",children:"Atendiendo"}),u.jsx("option",{value:"Finalizada",children:"Finalizada"}),u.jsx("option",{value:"pendiente",children:"Pendiente"}),u.jsx("option",{value:"No asisti",children:"No asisti"})]})}),u.jsxs("td",{className:"acciones-cell",onClick:Ie=>{Ie.stopPropagation()},children:[$.telefono?u.jsx("button",{type:"button",className:"btn-whatsapp",onClick:Ie=>{Ie.stopPropagation(),X($.telefono,$)},children:"WhatsApp"}):u.jsx("span",{className:"acciones-texto",children:"Sin celular"}),u.jsx("button",{type:"button",className:"btn-delete",onClick:Ie=>{Ie.stopPropagation(),ce($)},children:"Eliminar"}),$.recordatorio&&u.jsx("span",{className:"acciones-texto",children:$.recordatorio})]})]},$.id)};return u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"odc-topbar-green"}),u.jsx("div",{className:"odc-topbar-blue",children:"Agenda"}),u.jsx("section",{className:"odc-agenda-root",children:u.jsxs("div",{className:"odc-agenda-inner",children:[u.jsxs("aside",{className:"odc-left","aria-label":"Panel izquierdo - calendario y filtros",children:[u.jsxs("div",{className:"odc-mini-calendar-card",role:"region","aria-label":"Mini calendario",children:[u.jsxs("div",{className:"mini-cal-header",children:[u.jsx("button",{className:"cal-arrow",id:"miniCalPrev","aria-label":"Mes anterior",onClick:D,children:""}),u.jsx("div",{id:"miniCalMonthYear","aria-live":"polite",children:v}),u.jsx("button",{className:"cal-arrow",id:"miniCalNext","aria-label":"Mes siguiente",onClick:B,children:""})]}),u.jsxs("table",{className:"mini-month-table","aria-hidden":"false",children:[u.jsx("thead",{children:u.jsxs("tr",{children:[u.jsx("th",{children:"Lu"}),u.jsx("th",{children:"Ma"}),u.jsx("th",{children:"Mi"}),u.jsx("th",{children:"Ju"}),u.jsx("th",{children:"Vi"}),u.jsx("th",{children:"Sa"}),u.jsx("th",{children:"Do"})]})}),u.jsx("tbody",{id:"miniCalendar",children:O.map(($,J)=>u.jsx("tr",{children:$.map((le,ue)=>u.jsx("td",{className:[le.isCurrentMonth?"":"empty",le.isToday?"today":"",le.isSelected?"selected":""].filter(Boolean).join(" "),onClick:()=>le.isCurrentMonth&&x(le.date),children:le.date.getDate()},ue))},J))})]})]}),u.jsxs("div",{className:"odc-filters-card","aria-label":"Filtros de agenda",children:[u.jsx("label",{htmlFor:"filterSucursal",children:"Sucursal"}),u.jsxs("select",{id:"filterSucursal",value:h,onChange:$=>f($.target.value),children:[u.jsx("option",{value:"",children:" Todas "}),y.map($=>u.jsx("option",{value:$,children:$},$))]}),u.jsx("label",{htmlFor:"filterDoctor",children:"Doctores"}),u.jsxs("select",{id:"filterDoctor",value:m,onChange:$=>_($.target.value),children:[u.jsx("option",{value:"",children:" Todos "}),I.map($=>u.jsx("option",{value:$,children:$},$))]})]})]}),u.jsxs("main",{className:"odc-right","aria-label":"Panel principal - agenda",children:[u.jsxs("div",{className:"odc-header-bar",role:"region","aria-label":"Controles de la agenda",style:{display:"flex",alignItems:"center",justifyContent:"space-between",gap:12},children:[u.jsxs("div",{className:"odc-header-left",style:{display:"flex",alignItems:"center",gap:12,flexWrap:"wrap"},children:[u.jsx("h3",{className:"odc-title",style:{marginRight:8},children:"Agenda"}),u.jsxs("div",{className:"view-buttons",role:"tablist","aria-label":"Vistas",style:{display:"flex",gap:6},children:[u.jsx("button",{className:`btn view ${t==="day"?"active":""}`,"data-view":"day",role:"tab","aria-selected":t==="day",onClick:()=>e("day"),children:"Da"}),u.jsx("button",{className:`btn view ${t==="week"?"active":""}`,"data-view":"week",role:"tab","aria-selected":t==="week",onClick:()=>e("week"),children:"Semana"}),u.jsx("button",{className:`btn view ${t==="detail"?"active":""}`,"data-view":"detail",role:"tab","aria-selected":t==="detail",onClick:()=>e("detail"),children:"Detalle"})]}),u.jsxs("div",{className:"date-nav",style:{display:"flex",alignItems:"center",gap:6,flex:"0 0 auto"},children:[u.jsx("button",{className:"btn icon",id:"btnPrev","aria-label":"Anterior",onClick:A,children:""}),u.jsx("button",{className:"btn icon",id:"btnNext","aria-label":"Siguiente",onClick:j,children:""}),u.jsx("span",{id:"currentDateDisplay",className:"current-date","aria-live":"polite",style:{whiteSpace:"nowrap"},children:b}),u.jsx("button",{id:"btnHoy",className:"btn small",onClick:V,children:"Hoy"})]})]}),u.jsx("div",{className:"odc-header-right",style:{display:"flex",alignItems:"center",gap:8,flexShrink:0},children:u.jsxs("div",{className:"right-actions",style:{display:"flex",alignItems:"center",gap:8},children:[u.jsx("input",{id:"searchCitas",placeholder:"Buscar...",className:"search-input","aria-label":"Buscar citas",value:R,onChange:$=>C($.target.value)}),u.jsx("button",{id:"btnNuevaCita",className:"btn green","aria-label":"Nueva cita",onClick:pe,children:"+ Nueva cita"})]})})]}),u.jsxs("div",{className:"odc-content-card",role:"region","aria-label":"Contenido agenda",children:[u.jsxs("div",{className:"tools-row",children:[u.jsx("div",{className:"tools-left",children:u.jsx("div",{id:"ocupacionInfo",className:"ocupacion-info",children:E})}),u.jsxs("div",{className:"tools-right",children:[u.jsx("button",{id:"btnPrint",className:"btn",title:"Imprimir agenda",onClick:P,children:" Imprimir"}),u.jsx("button",{id:"btnConfirmar",className:"btn blue",title:"Confirmar citas",onClick:q,children:" Confirmar"}),u.jsx("button",{id:"btnHoyCitas",className:"btn",title:"Ver citas de hoy",onClick:qe,children:" Hoy"}),u.jsx("button",{id:"btnExportar",className:"btn",title:"Exportar citas a CSV",onClick:Pt,children:" Exportar"})]})]}),u.jsx("div",{className:"table-wrap",role:"region","aria-label":"Lista de citas",children:u.jsxs("table",{className:"appointments-table","aria-live":"polite",children:[u.jsx("thead",{children:u.jsxs("tr",{children:[u.jsx("th",{style:{width:"180px"},children:"Fecha / Hora"}),u.jsx("th",{children:"Paciente"}),u.jsx("th",{children:"Doctor"}),u.jsx("th",{children:"Espacio fsico"}),u.jsx("th",{children:"Comentario"}),u.jsx("th",{style:{width:"120px"},children:"Estado"}),u.jsx("th",{children:"Acciones"})]})}),u.jsx("tbody",{id:"citasTbody",children:o?u.jsx("tr",{children:u.jsx("td",{colSpan:7,className:"no-data",children:"Cargando citas..."})}):w.length===0?u.jsx("tr",{children:u.jsx("td",{colSpan:7,className:"no-data",children:"No hay citas registradas para este rango."})}):w.map(Be)})]})})]})]})]})})]})}function IU(){return u.jsxs("div",{style:{padding:"20px"},children:[u.jsx("h2",{children:"Mdulo de Facturacin"}),u.jsx("p",{children:"Aqu se registrarn los pagos, facturas y cobros."})]})}function TU(){return u.jsxs("div",{style:{padding:"20px"},children:[u.jsx("h2",{children:"Mdulo de Facturacin"}),u.jsx("p",{children:"Aqu se registrarn los pagos, facturas y cobros."})]})}function xU(){return u.jsxs("div",{style:{padding:"20px"},children:[u.jsx("h2",{children:"Mdulo de Facturacin"}),u.jsx("p",{children:"Aqu se registrarn los pagos, facturas y cobros."})]})}var cT;const Au=typeof navigator<"u"&&((cT=navigator.language)!=null&&cT.startsWith("es"))?"es-ES":"en-US",SU=["Colombia","Argentina","Bolivia","Chile","Costa Rica","Cuba","Ecuador","El Salvador","Espaa","Guatemala","Honduras","Mxico","Nicaragua","Panam","Paraguay","Per","Puerto Rico","Repblica Dominicana","Uruguay","Venezuela","Estados Unidos","Canad"],iT={Colombia:["Bogot","Medelln","Cali","Barranquilla","Cartagena","Ccuta","Bucaramanga","Pereira","Santa Marta","Ibagu"],Mxico:["Ciudad de Mxico","Guadalajara","Monterrey","Puebla","Quertaro","Tijuana","Mrida","Len"],Per:["Lima","Arequipa","Trujillo","Chiclayo","Cusco","Piura"],Chile:["Santiago","Valparaso","Concepcin","La Serena","Antofagasta"],Argentina:["Buenos Aires","Crdoba","Rosario","Mendoza","La Plata"],Espaa:["Madrid","Barcelona","Valencia","Sevilla","Zaragoza","Bilbao"],"Estados Unidos":["Miami","New York","Los ngeles","Houston","Chicago"],Ecuador:["Quito","Guayaquil","Cuenca","Manta"],Venezuela:["Caracas","Maracaibo","Valencia","Barquisimeto","Maracay"]},bU=t=>{if(!t)return"";const[e,n,r]=t.split("-").map(l=>parseInt(l,10)),i=new Date(e,(n||1)-1,r||1),s=new Date;let o=s.getFullYear()-i.getFullYear();const a=s.getMonth()-i.getMonth();return(a<0||a===0&&s.getDate()<i.getDate())&&o--,isNaN(o)?"":String(o)};async function CU(t,{maxW:e=900,maxH:n=900,quality:r=.82}={}){var m;if(!t||!((m=t.type)!=null&&m.startsWith("image/")))return t;const i=await new Promise((_,R)=>{const C=new Image;C.onload=()=>_(C),C.onerror=R,C.src=URL.createObjectURL(t)});let{width:s,height:o}=i;const a=Math.min(e/s,n/o,1);s=Math.round(s*a),o=Math.round(o*a);const l=document.createElement("canvas");l.width=s,l.height=o,l.getContext("2d").drawImage(i,0,0,s,o);const h=await new Promise(_=>l.toBlob(_,"image/jpeg",r)),f=new File([h],(t.name||"foto.jpg").replace(/\.[^.]+$/,".jpg"),{type:"image/jpeg",lastModified:Date.now()});return URL.revokeObjectURL(i.src),f}const wl=t=>(t||"").toString().toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/\s+/g," ").trim(),AU=t=>wl([t.nombres,t.apellidos,t.nombreCompleto,t.nroDocumento,t.celular,t.email].filter(Boolean).join(" ")),vo={tipoDocumento:"",nroDocumento:"",nroHistoria:"",nombres:"",apellidos:"",nombreCompleto:"",sexo:"",estadoCivil:"",paisNacimiento:"",ciudadNacimiento:"",fechaIngreso:"",fechaNacimiento:"",edad:"",paisDomicilio:"",ciudadDomicilio:"",barrio:"",lugarResidencia:"",estrato:"",zonaResidencial:"",esExtranjero:!1,permitePublicidad:!1,celular:"",telDomicilio:"",telOficina:"",extension:"",email:"",ocupacion:"",nombreResponsable:"",parentesco:"",celularResponsable:"",telefonoResponsable:"",emailResponsable:"",nombreAcompanante:"",telefonoAcompanante:"",convenioBeneficio:"",comoConocio:"",campania:"",remitidoPor:"",asesorComercial:"",tipoVinculacion:"",nombreEps:"",polizaSalud:"",doctor:"",notas:"",rxImagenes:[],historiaClinica:{antecedentes:"",alergias:"",medicamentos:"",motivoConsulta:"",notas:""},odontograma:[],periodontograma:[],presupuestos:[],evoluciones:[],facturacion:{saldoFavor:0,saldoCredito:0},fotoUrl:"",activo:!0},bp=20,wo=t=>Number(t||0);function RU(t){const[e,n]=N.useState(!1),[r,i]=N.useState([]),[s,o]=N.useState([]),[a,l]=N.useState("");N.useEffect(()=>{let y=!0;return(async()=>{if(!t){i([]),o([]);return}n(!0),l("");try{let w=Je(Me(_e,"facturas"),Ge("patientId","==",t),rn("fechaISO","desc"));const D=(await en(w)).docs.map(A=>({id:A.id,...A.data()})).map(A=>({...A,total:wo(A.total??A.valor??A.montoTotal),estado:(A.estado||"pendiente").toLowerCase(),fechaISO:A.fechaISO||A.fecha||null}));let B=Je(Me(_e,"pagos"),Ge("patientId","==",t),rn("fechaISO","desc"));const b=(await en(B)).docs.map(A=>({id:A.id,...A.data()})).map(A=>({...A,monto:wo(A.monto??A.valor??A.total),fechaISO:A.fechaISO||A.fecha||null,medio:A.medio||A.metodo||""}));if(!y)return;i(D),o(b)}catch(w){console.warn("Finanzas: no se pudo leer colecciones. Contino solo con saldos del paciente.",w),y&&l("No se pudieron leer facturas/pagos.")}finally{y&&n(!1)}})(),()=>{y=!1}},[t]);const d=r.reduce((y,I)=>y+wo(I.total),0),h=s.reduce((y,I)=>y+wo(I.monto),0),f=r.filter(y=>["pagada","pagado","paid"].includes((y.estado||"").toLowerCase())),m=r.filter(y=>["pendiente","abierta","open","deuda"].includes((y.estado||"").toLowerCase())),_=f.reduce((y,I)=>y+wo(I.total),0),R=m.reduce((y,I)=>y+wo(I.total),0);return{loading:e,error:a,facturas:r,pagos:s,totalFacturado:d,totalPagado:h,totalFacturasPagadas:_,totalFacturasPendientes:R}}function PU(t){const[e,n]=N.useState(!1),[r,i]=N.useState([]);return N.useEffect(()=>{let s=!0;return(async()=>{if(!t){i([]);return}n(!0);try{const a=Je(Me(_e,"citas"),Ge("patientId","==",t),rn("fechaISO","desc")),d=(await en(a)).docs.map(h=>({id:h.id,...h.data()}));s&&i(d)}catch(a){console.warn("No se pudieron leer citas:",a),s&&i([])}finally{s&&n(!1)}})(),()=>{s=!1}},[t]),{loading:e,citas:r}}function NU(){var te,ee,ge,he,Te,De,$e,Xe,Se;const t=xh(),e=S=>t(String(S).replace(/^\//,""),{relative:"path"}),[n,r]=N.useState(!0),[i,s]=N.useState([]),[o,a]=N.useState(""),[l,d]=N.useState(null),[h,f]=N.useState(!0),[m,_]=N.useState(!1),[R,C]=N.useState(null),[y,I]=N.useState(null),w=N.useRef(null),[E,O]=N.useState("datos"),[D,B]=N.useState(vo),[x,v]=N.useState(null),[b,A]=N.useState(""),[j,V]=N.useState([]),P=N.useMemo(()=>iT[D.paisNacimiento]||[],[D.paisNacimiento]);N.useEffect(()=>((async()=>{r(!0);try{const z=(await en(Me(_e,"eps"))).docs.map(oe=>{var Ce;return(Ce=oe.data())==null?void 0:Ce.nombre}).filter(Boolean),G=Array.from(new Map(z.map(oe=>[String(oe).toLowerCase(),oe])).values()).sort((oe,Ce)=>oe.localeCompare(Ce,"es"));V(G),await $t(!0)}catch(k){console.error(k),alert("No se pudieron cargar pacientes/EPS.")}finally{r(!1)}})(),()=>{w.current&&(w.current(),w.current=null)}),[]),N.useEffect(()=>{B(S=>({...S,nombreCompleto:`${S.nombres} ${S.apellidos}`.trim()}))},[D.nombres,D.apellidos]),N.useEffect(()=>{B(S=>({...S,nroHistoria:S.nroDocumento}))},[D.nroDocumento]),N.useEffect(()=>{B(S=>({...S,edad:bU(S.fechaNacimiento)}))},[D.fechaNacimiento]),N.useEffect(()=>{const S=new Date,k=S.toLocaleDateString(Au)+" - "+S.toLocaleTimeString(Au,{hour:"2-digit",minute:"2-digit",hour12:!0});B(z=>({...z,fechaIngreso:k}))},[]);const q=(S,k)=>B(z=>({...z,[S]:k})),qe=()=>{B(vo);const S=new Date,k=S.toLocaleDateString(Au)+" - "+S.toLocaleTimeString(Au,{hour:"2-digit",minute:"2-digit",hour12:!0});B(z=>({...z,fechaIngreso:k})),v(null),A(""),C(null)},Pt=async S=>{if(!S){v(null),A("");return}try{const k=await CU(S,{maxW:900,maxH:900,quality:.82});v(k);const z=new FileReader;z.onload=G=>A(G.target.result),z.readAsDataURL(k)}catch{v(S);const k=new FileReader;k.onload=z=>A(z.target.result),k.readAsDataURL(S)}},$t=async(S=!1)=>{r(!0);try{let k;S||!l?k=Je(Me(_e,"pacientes"),rn("creado","desc"),Jo(bp)):k=Je(Me(_e,"pacientes"),rn("creado","desc"),SM(l),Jo(bp));const z=await en(k),G=z.docs.map(oe=>({id:oe.id,...oe.data()}));s(S?G:oe=>[...oe,...G]),d(z.docs[z.docs.length-1]||null),f(z.size===bp)}catch(k){console.error(k),alert("No se pudo cargar pacientes.")}finally{r(!1)}},X=async S=>{if(S.preventDefault(),!D.nroDocumento.trim())return alert("El nmero de documento es obligatorio.");if(!D.nombres.trim())return alert("Los nombres son obligatorios.");if(!D.apellidos.trim())return alert("Los apellidos son obligatorios.");if(!D.sexo.trim())return alert("El sexo es obligatorio.");if(!D.fechaNacimiento.trim())return alert("La fecha de nacimiento es obligatoria.");if(!D.celular.trim())return alert("El celular es obligatorio.");if(!D.email.trim())return alert("El correo electrnico es obligatorio.");if(!D.tipoVinculacion.trim())return alert("El tipo de vinculacin es obligatorio.");if(!D.nombreEps.trim())return alert("El nombre de la EPS es obligatorio.");try{const k=D.nroDocumento.trim();if(!R&&(await nh(Kt(_e,"pacientes",k))).exists())return alert("Ya existe un paciente con ese nmero de documento.");const z=(D.nombreEps||"").trim(),G=j.map(et=>et.toLowerCase()).includes(z.toLowerCase());if(z&&!G&&window.confirm(`La EPS "${z}" no existe. Deseas guardarla para futuras selecciones?`)){const pt=z.toLowerCase().replace(/\s+/g,"_");await rh(Kt(_e,"eps",pt),{nombre:z,nombreLower:z.toLowerCase(),creado:Mn()},{merge:!0})}let oe=D.fotoUrl||"",Ce="";if(x)try{const et=Es(),pt=(x.name||"foto.jpg").replace(/\s+/g,"_");Ce=`pacientes/${k}/${Date.now()}_${pt}`;const tt=al(et,Ce),St={contentType:x.type||"image/jpeg",cacheControl:"public, max-age=86400"};await $I(tt,x,St),oe=await qI(tt)}catch(et){console.error("Foto (warning):",et)}const xt=D.creado||null,bn=R&&xt||Mn(),Nt={...D,fotoUrl:oe,nombre_busqueda:AU({...D,fotoUrl:oe}),nombresLower:wl(D.nombres),apellidosLower:wl(D.apellidos),documentoLower:wl(D.nroDocumento),emailLower:wl(D.email),creado:bn,createdAt:bn,actualizado:Mn(),updatedAt:Mn(),activo:D.activo??!0,celularPaciente:D.celular,telefonoPaciente:D.telDomicilio||"",documento:D.nroDocumento,paciente:D.nombreCompleto};if(await rh(Kt(_e,"pacientes",k),Nt,{merge:!0}),Ce)try{const et=Es(),pt=al(et,`pacientes/${k}`),tt=await zI(pt),St=Ce,zt=tt.items.filter(Oe=>Oe.fullPath!==St).map(Oe=>_p(Oe).catch(()=>null));await Promise.allSettled(zt)}catch(et){console.warn("No se pudo limpiar fotos antiguas:",et)}alert(R?" Paciente actualizado.":" Paciente guardado."),s(et=>{const pt=et.filter(tt=>tt.id!==k);return[{id:k,...Nt},...pt]}),_(!1),C(null),qe()}catch(k){console.error("Error guardando paciente:",k),alert(`No se pudo guardar el paciente.

`+((k==null?void 0:k.message)||k))}},ce=()=>{qe(),_(!0)},pe=()=>{y&&(B({...vo,...y,fotoUrl:y.fotoUrl||""}),v(null),A(y.fotoUrl||""),C(y.id),J(),_(!0))},ke=async S=>{if(window.confirm(`Eliminar al paciente "${S.nombreCompleto}"?`))try{await XC(Kt(_e,"pacientes",S.id)),s(k=>k.filter(z=>z.id!==S.id));try{const k=Es(),z=al(k,`pacientes/${S.id}`),oe=(await zI(z)).items.map(Ce=>_p(Ce).catch(()=>null));await Promise.allSettled(oe)}catch(k){console.warn("No se pudo borrar la carpeta de fotos:",k)}}catch(k){console.error(k),alert("No se pudo eliminar.")}},Be=N.useMemo(()=>{const S=o.trim().toLowerCase();return S?i.filter(k=>`${k.nombreCompleto||k.paciente||""} ${k.nroDocumento||""} ${k.celular||k.celularPaciente||""} ${k.email||""}`.toLowerCase().includes(S)):i},[i,o]),$=S=>{J();const k=Kt(_e,"pacientes",S.id),z=rr(k,G=>{G.exists()?I({id:G.id,...le(G.data())}):I(null)});w.current=z,O("datos")},J=()=>{w.current&&(w.current(),w.current=null),I(null)},le=S=>({...vo,...S,historiaClinica:{...vo.historiaClinica,...S.historiaClinica||{}},facturacion:{...vo.facturacion,...S.facturacion||{}},rxImagenes:Array.isArray(S.rxImagenes)?S.rxImagenes:[],odontograma:Array.isArray(S.odontograma)?S.odontograma:[],periodontograma:Array.isArray(S.periodontograma)?S.periodontograma:[],presupuestos:Array.isArray(S.presupuestos)?S.presupuestos:[],evoluciones:Array.isArray(S.evoluciones)?S.evoluciones:[]}),ue=async S=>{if(y!=null&&y.id)try{await Zo(Kt(_e,"pacientes",y.id),{...S,actualizado:Mn(),updatedAt:Mn()})}catch(k){console.error(k),alert("No se pudo actualizar.")}},Ie=async S=>{if(!(y!=null&&y.id)||!(S!=null&&S.length))return;const k=Es(),z=[];for(const G of S){const oe=(G.name||"archivo").replace(/\s+/g,"_"),Ce=`pacientes/${y.id}/rx/${Date.now()}_${oe}`,xt=al(k,Ce);await $I(xt,G,{contentType:G.type});const bn=await qI(xt);z.push({url:bn,name:G.name,type:G.type,size:G.size||0,created:Date.now(),path:Ce})}await ue({rxImagenes:[...y.rxImagenes||[],...z]})},je=async S=>{if(!(y!=null&&y.id))return;const k=y.rxImagenes[S],z=y.rxImagenes.filter((G,oe)=>oe!==S);await ue({rxImagenes:z});try{if(k!=null&&k.path){const G=Es();await _p(al(G,k.path))}}catch(G){console.warn("No se pudo borrar del Storage:",G)}},me=(S,k)=>{const z={...y.historiaClinica||{},[S]:k};ue({historiaClinica:z})},Qe=S=>{const k=[...y.presupuestos||[],{id:String(Date.now()),...S}];ue({presupuestos:k})},we=S=>{ue({presupuestos:(y.presupuestos||[]).filter(k=>k.id!==S)})},re=S=>{const k=[...y.evoluciones||[],{id:String(Date.now()),fechaISO:new Date().toISOString(),nota:S}];ue({evoluciones:k})},Ae=S=>{ue({evoluciones:(y.evoluciones||[]).filter(k=>k.id!==S)})},Et=(S,k)=>{const z=Array.isArray(y[S])?y[S]:[],G=z.find(Ce=>Ce.pieza===k);let oe;G?oe=z.filter(Ce=>Ce.pieza!==k):oe=[...z,{pieza:k,estado:"marcada"}],ue({[S]:oe})},Tt=(y==null?void 0:y.id)||null,Q=RU(Tt),{loading:ne,citas:de}=PU(Tt);return u.jsxs("div",{className:"odc-container",children:[u.jsx("div",{className:"odc-topbar-green"}),u.jsx("div",{className:"odc-topbar-blue",children:u.jsx("div",{className:"odc-top-inner",children:u.jsx("div",{className:"odc-breadcrumbs",children:"Pacientes"})})}),u.jsxs("div",{className:"odc-card",children:[u.jsxs("div",{className:"odc-card-header",children:[u.jsx("h3",{className:"odc-title",children:"Pacientes"}),u.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[u.jsx("input",{className:"search-input",style:{minWidth:280},placeholder:"Buscar por nombre, documento o telfono",value:o,onChange:S=>a(S.target.value)}),u.jsx("button",{type:"button",className:"btn green",onClick:ce,children:"+ Nuevo paciente"})]})]}),u.jsx("div",{className:"table-wrap",children:u.jsxs("table",{className:"appointments-table",children:[u.jsx("thead",{children:u.jsxs("tr",{children:[u.jsx("th",{children:"Foto"}),u.jsx("th",{children:"Nombre"}),u.jsx("th",{children:"Documento"}),u.jsx("th",{children:"Celular"}),u.jsx("th",{children:"Correo"}),u.jsx("th",{children:"Estado"})]})}),u.jsx("tbody",{children:n&&i.length===0?u.jsx("tr",{children:u.jsx("td",{className:"no-data",colSpan:6,children:"Cargando"})}):Be.length===0?u.jsx("tr",{children:u.jsx("td",{className:"no-data",colSpan:6,children:"No hay pacientes o no coinciden con la bsqueda."})}):Be.map(S=>u.jsxs("tr",{className:"row-click",onClick:()=>$(S),children:[u.jsx("td",{onClick:k=>k.stopPropagation(),children:S.fotoUrl?u.jsx("img",{src:S.fotoUrl,alt:"Foto",style:{width:36,height:36,borderRadius:"50%",objectFit:"cover"}}):u.jsx("div",{className:"avatar-fallback",children:(S.nombreCompleto||"P")[0]})}),u.jsx("td",{children:S.nombreCompleto||S.paciente||""}),u.jsx("td",{children:S.nroDocumento||S.documento||""}),u.jsx("td",{children:S.celular||S.celularPaciente||""}),u.jsx("td",{children:S.email||""}),u.jsx("td",{children:u.jsx("span",{className:"pill pill-ok",children:S.activo?"Activo":"Inactivo"})})]},S.id))})]})}),u.jsxs("div",{className:"footer-actions",children:[u.jsx("button",{type:"button",className:"btn",disabled:n||!h,onClick:()=>$t(!1),children:h?"Cargar ms":"No hay ms"}),u.jsxs("div",{className:"hint",children:[i.length," registros cargados"]})]})]}),m&&u.jsxs("div",{className:"odc-modal",role:"dialog","aria-modal":"true",children:[u.jsx("div",{className:"odc-modal-backdrop",onClick:()=>_(!1)}),u.jsxs("div",{className:"odc-card",style:{width:1e3,maxWidth:"95%",maxHeight:"92vh",overflowY:"auto"},children:[u.jsxs("div",{className:"odc-card-header",children:[u.jsx("h3",{className:"odc-title",children:R?"Editar paciente":"Nuevo paciente"}),u.jsx("button",{type:"button",className:"btn",onClick:()=>_(!1),children:""})]}),u.jsxs("form",{onSubmit:X,children:[u.jsx("div",{className:"form-section-title",children:"Foto del paciente"}),u.jsxs("div",{className:"foto-row",children:[u.jsxs("label",{className:"foto-drop",children:[u.jsx("input",{type:"file",accept:"image/*",onChange:S=>{var k;return Pt(((k=S.target.files)==null?void 0:k[0])||null)},style:{display:"none"}}),b?u.jsx("img",{src:b,alt:"Preview",className:"foto-preview"}):u.jsx("div",{className:"foto-empty",children:"Arrastra o haz clic para cargar"})]}),b&&u.jsx("button",{type:"button",className:"btn",onClick:()=>Pt(null),children:"Quitar foto"})]}),u.jsx("div",{className:"form-section-title",children:"Datos de identificacin"}),u.jsxs("div",{className:"form-grid",children:[u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Tipo de documento *"}),u.jsxs("select",{className:"form-input",value:D.tipoDocumento,onChange:S=>q("tipoDocumento",S.target.value),children:[u.jsx("option",{value:"",children:"Seleccione"}),u.jsx("option",{value:"CC",children:"Cdula"}),u.jsx("option",{value:"TI",children:"Tarjeta de identidad"}),u.jsx("option",{value:"PA",children:"Pasaporte"}),u.jsx("option",{value:"OTRO",children:"Otro"})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Nro. de documento *"}),u.jsx("input",{className:"form-input",value:D.nroDocumento,onChange:S=>q("nroDocumento",S.target.value),placeholder:"Nmero de documento",required:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Nmero de Historia"}),u.jsx("input",{className:"form-input",value:D.nroHistoria,readOnly:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Nombres *"}),u.jsx("input",{className:"form-input",value:D.nombres,onChange:S=>q("nombres",S.target.value),required:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Apellidos *"}),u.jsx("input",{className:"form-input",value:D.apellidos,onChange:S=>q("apellidos",S.target.value),required:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Nombre completo"}),u.jsx("input",{className:"form-input",value:D.nombreCompleto,readOnly:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Sexo *"}),u.jsxs("select",{className:"form-input",value:D.sexo,onChange:S=>q("sexo",S.target.value),required:!0,children:[u.jsx("option",{value:"",children:"Seleccione"}),u.jsx("option",{children:"Masculino"}),u.jsx("option",{children:"Femenino"}),u.jsx("option",{children:"Otro"})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Estado civil *"}),u.jsxs("select",{className:"form-input",value:D.estadoCivil,onChange:S=>q("estadoCivil",S.target.value),required:!0,children:[u.jsx("option",{value:"",children:"Seleccione"}),u.jsx("option",{children:"Soltero"}),u.jsx("option",{children:"Casado"}),u.jsx("option",{children:"Unin libre"}),u.jsx("option",{children:"Divorciado"}),u.jsx("option",{children:"Viudo"})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Pas de nacimiento *"}),u.jsx("input",{className:"form-input",list:"listCountries",value:D.paisNacimiento,onChange:S=>q("paisNacimiento",S.target.value),placeholder:"Escribe y elige",required:!0}),u.jsx("datalist",{id:"listCountries",children:SU.map(S=>u.jsx("option",{value:S},S))})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Ciudad de nacimiento"}),u.jsx("input",{className:"form-input",list:"listCitiesBirth",value:D.ciudadNacimiento,onChange:S=>q("ciudadNacimiento",S.target.value),placeholder:"Escribe y elige"}),u.jsx("datalist",{id:"listCitiesBirth",children:P.map(S=>u.jsx("option",{value:S},S))})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Fecha de ingreso"}),u.jsx("input",{className:"form-input",value:D.fechaIngreso,readOnly:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Fecha de nacimiento *"}),u.jsx("input",{type:"date",className:"form-input",value:D.fechaNacimiento,onChange:S=>q("fechaNacimiento",S.target.value),required:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Edad"}),u.jsx("input",{className:"form-input",value:D.edad,readOnly:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Pas de domicilio *"}),u.jsx("input",{className:"form-input",list:"listCountries",value:D.paisDomicilio,onChange:S=>q("paisDomicilio",S.target.value),required:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Ciudad de domicilio *"}),u.jsx("input",{className:"form-input",list:"listCitiesHome",value:D.ciudadDomicilio,onChange:S=>q("ciudadDomicilio",S.target.value),required:!0}),u.jsx("datalist",{id:"listCitiesHome",children:(iT[D.paisDomicilio]||[]).map(S=>u.jsx("option",{value:S},S))})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Barrio *"}),u.jsx("input",{className:"form-input",value:D.barrio,onChange:S=>q("barrio",S.target.value),required:!0,placeholder:"Barrio"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Lugar de residencia *"}),u.jsx("input",{className:"form-input",value:D.lugarResidencia,onChange:S=>q("lugarResidencia",S.target.value),required:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Estrato"}),u.jsxs("select",{className:"form-input",value:D.estrato,onChange:S=>q("estrato",S.target.value),children:[u.jsx("option",{value:"",children:"Seleccione"}),u.jsx("option",{children:"1"}),u.jsx("option",{children:"2"}),u.jsx("option",{children:"3"}),u.jsx("option",{children:"4"}),u.jsx("option",{children:"5"}),u.jsx("option",{children:"6"})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Zona residencial *"}),u.jsxs("select",{className:"form-input",value:D.zonaResidencial,onChange:S=>q("zonaResidencial",S.target.value),required:!0,children:[u.jsx("option",{value:"",children:"Seleccione"}),u.jsx("option",{children:"Urbana"}),u.jsx("option",{children:"Rural"})]})]}),u.jsxs("div",{className:"checkbox-cell",children:[u.jsx("label",{className:"form-label",children:"Es extranjero?"}),u.jsx("input",{type:"checkbox",checked:D.esExtranjero,onChange:S=>q("esExtranjero",S.target.checked)})]}),u.jsxs("div",{className:"checkbox-cell",children:[u.jsx("label",{className:"form-label",children:"Permite publicidad?"}),u.jsx("input",{type:"checkbox",checked:D.permitePublicidad,onChange:S=>q("permitePublicidad",S.target.checked)})]})]}),u.jsx("div",{className:"form-section-title",children:"Contacto"}),u.jsxs("div",{className:"form-grid",children:[u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Celular *"}),u.jsx("input",{className:"form-input",value:D.celular,onChange:S=>q("celular",S.target.value),required:!0,placeholder:"Celular del paciente"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Telfono de domicilio"}),u.jsx("input",{className:"form-input",value:D.telDomicilio,onChange:S=>q("telDomicilio",S.target.value)})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Telfono de oficina"}),u.jsx("input",{className:"form-input",value:D.telOficina,onChange:S=>q("telOficina",S.target.value)})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Extensin"}),u.jsx("input",{className:"form-input",value:D.extension,onChange:S=>q("extension",S.target.value)})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Correo electrnico *"}),u.jsx("input",{type:"email",className:"form-input",value:D.email,onChange:S=>q("email",S.target.value),required:!0,placeholder:"correo@dominio.com"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Ocupacin *"}),u.jsx("input",{className:"form-input",value:D.ocupacion,onChange:S=>q("ocupacion",S.target.value),required:!0})]})]}),u.jsx("div",{className:"form-section-title",children:"Datos de facturacin"}),u.jsxs("div",{className:"form-grid",children:[u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Responsable"}),u.jsx("input",{className:"form-input",value:D.nombreResponsable,onChange:S=>q("nombreResponsable",S.target.value)})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Parentesco"}),u.jsxs("select",{className:"form-input",value:D.parentesco,onChange:S=>q("parentesco",S.target.value),children:[u.jsx("option",{value:"",children:"Seleccione"}),u.jsx("option",{children:"Padre/Madre"}),u.jsx("option",{children:"Hermano"}),u.jsx("option",{children:"Esposo/a"}),u.jsx("option",{children:"Otro"})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Celular"}),u.jsx("input",{className:"form-input",value:D.celularResponsable,onChange:S=>q("celularResponsable",S.target.value)})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Telfono"}),u.jsx("input",{className:"form-input",value:D.telefonoResponsable,onChange:S=>q("telefonoResponsable",S.target.value)})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Correo electrnico"}),u.jsx("input",{type:"email",className:"form-input",value:D.emailResponsable,onChange:S=>q("emailResponsable",S.target.value)})]})]}),u.jsx("div",{className:"form-section-title",children:"Acompaante"}),u.jsxs("div",{className:"form-grid",children:[u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Nombre"}),u.jsx("input",{className:"form-input",value:D.nombreAcompanante,onChange:S=>q("nombreAcompanante",S.target.value),placeholder:"Nombre acompaante"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Telfono"}),u.jsx("input",{className:"form-input",value:D.telefonoAcompanante,onChange:S=>q("telefonoAcompanante",S.target.value),placeholder:"Telfono acompaante"})]})]}),u.jsx("div",{className:"form-section-title",children:"Mercadeo"}),u.jsxs("div",{className:"form-grid",children:[u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Convenio beneficio"}),u.jsx("input",{className:"form-input",value:D.convenioBeneficio,onChange:S=>q("convenioBeneficio",S.target.value)})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Cmo nos conoci?"}),u.jsxs("select",{className:"form-input",value:D.comoConocio,onChange:S=>q("comoConocio",S.target.value),children:[u.jsx("option",{value:"",children:"Seleccione"}),u.jsx("option",{children:"Redes sociales"}),u.jsx("option",{children:"Publicidad"}),u.jsx("option",{children:"Recomendacin"}),u.jsx("option",{children:"Otro"})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Campaa"}),u.jsx("input",{className:"form-input",value:D.campania,onChange:S=>q("campania",S.target.value)})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Remitido por"}),u.jsx("input",{className:"form-input",value:D.remitidoPor,onChange:S=>q("remitidoPor",S.target.value)})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Asesor comercial"}),u.jsx("input",{className:"form-input",value:D.asesorComercial,onChange:S=>q("asesorComercial",S.target.value)})]})]}),u.jsx("div",{className:"form-section-title",children:"EPS"}),u.jsxs("div",{className:"form-grid",children:[u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Tipo de vinculacin *"}),u.jsxs("select",{className:"form-input",value:D.tipoVinculacion,onChange:S=>q("tipoVinculacion",S.target.value),required:!0,children:[u.jsx("option",{value:"",children:"Seleccione"}),u.jsx("option",{children:"Contributivo"}),u.jsx("option",{children:"Subsidiado"}),u.jsx("option",{children:"Particular"}),u.jsx("option",{children:"Otro"})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Nombre de la EPS *"}),u.jsx("input",{className:"form-input",list:"listEps",value:D.nombreEps,onChange:S=>q("nombreEps",S.target.value),placeholder:"Escribe y selecciona",required:!0}),u.jsx("datalist",{id:"listEps",children:j.map(S=>u.jsx("option",{value:S},S))})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Pliza de salud"}),u.jsx("input",{className:"form-input",value:D.polizaSalud,onChange:S=>q("polizaSalud",S.target.value)})]})]}),u.jsx("div",{className:"form-section-title",children:"Doctor"}),u.jsx("div",{className:"form-grid",children:u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Doctor"}),u.jsx("input",{className:"form-input",value:D.doctor,onChange:S=>q("doctor",S.target.value),placeholder:"Usuario / Libre"})]})}),u.jsx("div",{className:"form-section-title",children:"Alertas y Notas"}),u.jsx("div",{className:"form-grid",children:u.jsx("textarea",{className:"form-input",rows:3,value:D.notas,onChange:S=>q("notas",S.target.value),placeholder:"Notas del paciente"})}),u.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:8,marginTop:12},children:[R?u.jsx("button",{type:"button",className:"btn",onClick:()=>ke({id:R,nombreCompleto:D.nombreCompleto}),children:"Eliminar"}):u.jsx("div",{}),u.jsxs("div",{style:{display:"flex",gap:8},children:[u.jsx("button",{type:"button",className:"btn",onClick:()=>_(!1),children:"Cancelar"}),u.jsx("button",{type:"submit",className:"btn blue",children:R?"Actualizar":"Guardar paciente"})]})]})]})]})]}),y&&u.jsxs("div",{className:"odc-modal",role:"dialog","aria-modal":"true",children:[u.jsx("div",{className:"odc-modal-backdrop",onClick:J}),u.jsxs("div",{className:"odc-card ficha-card",children:[u.jsxs("div",{className:"ficha-header",children:[u.jsxs("div",{className:"ficha-header-left",children:[y.fotoUrl?u.jsx("img",{src:y.fotoUrl,alt:"Foto",className:"ficha-avatar"}):u.jsx("div",{className:"avatar-fallback ficha-avatar-fallback",children:(y.nombreCompleto||"P")[0]}),u.jsxs("div",{children:[u.jsx("div",{className:"ficha-nombre",children:y.nombreCompleto||""}),u.jsxs("div",{className:"ficha-doc",children:[y.tipoDocumento||""," ",y.nroDocumento||""]}),u.jsxs("div",{className:"ficha-badges",children:[u.jsx("span",{className:"ficha-badge blue",children:"En valoracin"}),u.jsx("span",{className:"ficha-badge green",children:"Sin deuda"})]})]})]}),u.jsx("div",{className:"ficha-header-right",children:u.jsxs("div",{className:"ficha-actions",children:[u.jsx("button",{type:"button",className:"btn",onClick:J,children:"Cerrar"}),u.jsx("button",{type:"button",className:"btn blue",onClick:pe,children:"Editar"}),u.jsx("button",{type:"button",className:"btn green",onClick:()=>e(`caja?cobro=1&patientId=${y.id}`),title:"Ir a Caja para cobrar a este paciente",children:"Cobrar"})]})})]}),u.jsxs("div",{className:"ficha-body",children:[u.jsxs("aside",{className:"ficha-sidebar",children:[u.jsx("div",{className:"ficha-sidebar-title",children:"Informacin general"}),u.jsx("button",{type:"button",className:`ficha-link ${E==="datos"?"active":""}`,onClick:()=>O("datos"),children:"Datos personales"}),u.jsx("button",{type:"button",className:`ficha-link ${E==="marketing"?"active":""}`,onClick:()=>O("marketing"),children:"Marketing"}),u.jsx("button",{type:"button",className:`ficha-link ${E==="eps"?"active":""}`,onClick:()=>O("eps"),children:"EPS"}),u.jsx("button",{type:"button",className:`ficha-link ${E==="prof"?"active":""}`,onClick:()=>O("prof"),children:"Profesionales"}),u.jsx("button",{type:"button",className:`ficha-link ${E==="rx"?"active":""}`,onClick:()=>O("rx"),children:"Rx/Imgenes/Doc"}),u.jsx("button",{type:"button",className:`ficha-link ${E==="citas"?"active":""}`,onClick:()=>O("citas"),children:"Citas"}),u.jsx("button",{type:"button",className:`ficha-link ${E==="crm"?"active":""}`,onClick:()=>O("crm"),children:"CRM"}),u.jsx("div",{className:"ficha-sidebar-title mt",children:"Historia clnica"}),u.jsx("button",{type:"button",className:`ficha-link ${E==="doc"?"active":""}`,onClick:()=>O("doc"),children:"Doc. Clnicos"}),u.jsx("button",{type:"button",className:`ficha-link ${E==="odonto"?"active":""}`,onClick:()=>O("odonto"),children:"Odontogramas"}),u.jsx("button",{type:"button",className:`ficha-link ${E==="perio"?"active":""}`,onClick:()=>O("perio"),children:"Periodontogramas"}),u.jsx("button",{type:"button",className:`ficha-link ${E==="presu"?"active":""}`,onClick:()=>O("presu"),children:"Presupuestos"}),u.jsx("button",{type:"button",className:`ficha-link ${E==="evo"?"active":""}`,onClick:()=>O("evo"),children:"Evoluciones"}),u.jsx("div",{className:"ficha-sidebar-title mt",children:"Facturacin"}),u.jsx("button",{type:"button",className:`ficha-link ${E==="fact"?"active":""}`,onClick:()=>O("fact"),children:"Resumen"}),u.jsxs("div",{className:"ficha-sidebar-actions",style:{display:"grid",gap:8,marginTop:8},children:[u.jsx("button",{type:"button",className:"btn pay",onClick:()=>e(`caja?cobro=1&patientId=${y.id}`),title:"Cobrar a este paciente",children:"Realizar pago"}),u.jsx("button",{type:"button",className:"btn history",onClick:()=>e("facturacion/pagos"),title:"Ver histrico de pagos",children:"Histrico de pagos"}),u.jsx("button",{type:"button",className:"btn history",onClick:()=>e("facturacion/facturas"),title:"Ver histrico de facturacin",children:"Histrico de facturacin"})]})]}),u.jsxs("main",{className:"ficha-content",children:[E==="datos"&&u.jsxs("section",{className:"ficha-section",children:[u.jsx("h4",{className:"ficha-section-title",children:"Datos personales"}),u.jsx("div",{className:"ficha-grid",children:[["Tipo de documento",y.tipoDocumento],["Nro. de documento",y.nroDocumento],["Nmero de Historia",y.nroHistoria],["Fecha de ingreso",y.fechaIngreso],["Nombres",y.nombres],["Apellidos",y.apellidos],["Nombre completo",y.nombreCompleto],["Sexo",y.sexo],["Estado civil",y.estadoCivil],["Pas de nacimiento",y.paisNacimiento],["Ciudad de nacimiento",y.ciudadNacimiento],["Fecha de nacimiento",y.fechaNacimiento],["Edad",y.edad],["Pas de domicilio",y.paisDomicilio],["Ciudad de domicilio",y.ciudadDomicilio],["Barrio",y.barrio],["Lugar de residencia",y.lugarResidencia],["Estrato",y.estrato],["Zona residencial",y.zonaResidencial],["Extranjero",y.esExtranjero?"S":"No"],["Permite publicidad",y.permitePublicidad?"S":"No"],["Celular",y.celular||y.celularPaciente],["Telfono domicilio",y.telDomicilio||y.telefonoPaciente],["Telfono oficina",y.telOficina],["Extensin",y.extension],["Correo electrnico",y.email],["Ocupacin",y.ocupacion],["Responsable",y.nombreResponsable],["Parentesco",y.parentesco],["Cel. responsable",y.celularResponsable],["Tel. responsable",y.telefonoResponsable],["Email responsable",y.emailResponsable],["Acompaante",y.nombreAcompanante],["Tel. acompaante",y.telefonoAcompanante]].map(([S,k])=>u.jsxs("div",{className:"field",children:[u.jsx("label",{children:S}),u.jsx("input",{className:"form-input",value:k||"",readOnly:!0})]},S))})]}),E==="marketing"&&u.jsxs("section",{className:"ficha-section",children:[u.jsx("h4",{className:"ficha-section-title",children:"Marketing"}),u.jsx("div",{className:"ficha-grid",children:[["Convenio beneficio",y.convenioBeneficio],["Cmo nos conoci?",y.comoConocio],["Campaa",y.campania],["Remitido por",y.remitidoPor],["Asesor comercial",y.asesorComercial]].map(([S,k])=>u.jsxs("div",{className:"field",children:[u.jsx("label",{children:S}),u.jsx("input",{className:"form-input",value:k||"",readOnly:!0})]},S))})]}),E==="eps"&&u.jsxs("section",{className:"ficha-section",children:[u.jsx("h4",{className:"ficha-section-title",children:"EPS"}),u.jsx("div",{className:"ficha-grid",children:[["Tipo de vinculacin",y.tipoVinculacion],["Nombre EPS",y.nombreEps],["Pliza de salud",y.polizaSalud]].map(([S,k])=>u.jsxs("div",{className:"field",children:[u.jsx("label",{children:S}),u.jsx("input",{className:"form-input",value:k||"",readOnly:!0})]},S))})]}),E==="prof"&&u.jsxs("section",{className:"ficha-section",children:[u.jsx("h4",{className:"ficha-section-title",children:"Profesionales"}),u.jsx("div",{className:"ficha-grid",children:u.jsxs("div",{className:"field",children:[u.jsx("label",{children:"Doctor"}),u.jsx("input",{className:"form-input",value:y.doctor||"",readOnly:!0})]})})]}),E==="rx"&&u.jsxs("section",{className:"ficha-section",children:[u.jsx("h4",{className:"ficha-section-title",children:"Rx / Imgenes / Documentos"}),u.jsx("div",{className:"rx-actions",children:u.jsxs("label",{className:"btn blue",children:["Subir archivos",u.jsx("input",{type:"file",multiple:!0,style:{display:"none"},onChange:S=>Ie([...S.target.files])})]})}),u.jsxs("div",{className:"rx-grid",children:[(y.rxImagenes||[]).map((S,k)=>{var z;return u.jsxs("div",{className:"rx-item",children:[(z=S.type)!=null&&z.startsWith("image/")?u.jsx("a",{href:S.url,target:"_blank",rel:"noreferrer",children:u.jsx("img",{src:S.url,alt:S.name})}):u.jsx("a",{className:"rx-file",href:S.url,target:"_blank",rel:"noreferrer",children:S.name||"archivo"}),u.jsxs("div",{className:"rx-meta",children:[u.jsx("span",{children:S.name}),u.jsx("button",{type:"button",className:"btn small",onClick:()=>je(k),children:"Eliminar"})]})]},k)}),(!y.rxImagenes||y.rxImagenes.length===0)&&u.jsx("div",{className:"no-data",children:"Sin archivos an."})]})]}),E==="doc"&&u.jsxs("section",{className:"ficha-section",children:[u.jsx("h4",{className:"ficha-section-title",children:"Doc. Clnicos"}),u.jsxs("div",{className:"ficha-grid",children:[u.jsxs("div",{className:"field",children:[u.jsx("label",{children:"Motivo de consulta"}),u.jsx("textarea",{className:"form-input",rows:3,value:((te=y.historiaClinica)==null?void 0:te.motivoConsulta)||"",onChange:S=>me("motivoConsulta",S.target.value)})]}),u.jsxs("div",{className:"field",children:[u.jsx("label",{children:"Antecedentes"}),u.jsx("textarea",{className:"form-input",rows:3,value:((ee=y.historiaClinica)==null?void 0:ee.antecedentes)||"",onChange:S=>me("antecedentes",S.target.value)})]}),u.jsxs("div",{className:"field",children:[u.jsx("label",{children:"Alergias"}),u.jsx("textarea",{className:"form-input",rows:2,value:((ge=y.historiaClinica)==null?void 0:ge.alergias)||"",onChange:S=>me("alergias",S.target.value)})]}),u.jsxs("div",{className:"field",children:[u.jsx("label",{children:"Medicamentos"}),u.jsx("textarea",{className:"form-input",rows:2,value:((he=y.historiaClinica)==null?void 0:he.medicamentos)||"",onChange:S=>me("medicamentos",S.target.value)})]}),u.jsxs("div",{className:"field",children:[u.jsx("label",{children:"Notas"}),u.jsx("textarea",{className:"form-input",rows:3,value:((Te=y.historiaClinica)==null?void 0:Te.notas)||"",onChange:S=>me("notas",S.target.value)})]})]})]}),E==="odonto"&&u.jsxs("section",{className:"ficha-section",children:[u.jsx("h4",{className:"ficha-section-title",children:"Odontograma (placeholder)"}),u.jsx("div",{className:"odont-grid",children:Array.from({length:32},(S,k)=>k+1).map(S=>{const k=(y.odontograma||[]).some(z=>z.pieza===S);return u.jsx("button",{type:"button",className:`tooth ${k?"on":""}`,onClick:()=>Et("odontograma",S),title:`Pieza ${S}`,children:S},S)})})]}),E==="perio"&&u.jsxs("section",{className:"ficha-section",children:[u.jsx("h4",{className:"ficha-section-title",children:"Periodontograma (placeholder)"}),u.jsx("div",{className:"odont-grid",children:Array.from({length:32},(S,k)=>k+1).map(S=>{const k=(y.periodontograma||[]).some(z=>z.pieza===S);return u.jsx("button",{type:"button",className:`tooth ${k?"on":""}`,onClick:()=>Et("periodontograma",S),title:`Pieza ${S}`,children:S},S)})})]}),E==="presu"&&u.jsxs("section",{className:"ficha-section",children:[u.jsx("h4",{className:"ficha-section-title",children:"Presupuestos & planes"}),u.jsx(kU,{onAdd:Qe}),u.jsxs("div",{className:"presu-list",children:[(y.presupuestos||[]).map(S=>u.jsxs("div",{className:"presu-item",children:[u.jsxs("div",{children:[u.jsx("div",{className:"presu-title",children:S.titulo}),u.jsxs("div",{className:"presu-meta",children:["Costo: $",S.costo||0,"  Estado: ",S.estado||"Pendiente"]})]}),u.jsx("button",{type:"button",className:"btn small",onClick:()=>we(S.id),children:"Eliminar"})]},S.id)),(!y.presupuestos||y.presupuestos.length===0)&&u.jsx("div",{className:"no-data",children:"Sin presupuestos an."})]})]}),E==="evo"&&u.jsxs("section",{className:"ficha-section",children:[u.jsx("h4",{className:"ficha-section-title",children:"Evoluciones & Remisiones"}),u.jsx(DU,{onAdd:re}),u.jsxs("div",{className:"evo-list",children:[(y.evoluciones||[]).map(S=>u.jsxs("div",{className:"evo-item",children:[u.jsx("div",{className:"evo-date",children:new Date(S.fechaISO).toLocaleString()}),u.jsx("div",{className:"evo-note",children:S.nota}),u.jsx("button",{type:"button",className:"btn small",onClick:()=>Ae(S.id),children:"Eliminar"})]},S.id)),(!y.evoluciones||y.evoluciones.length===0)&&u.jsx("div",{className:"no-data",children:"Sin evoluciones an."})]})]}),E==="fact"&&u.jsxs("section",{className:"ficha-section",children:[u.jsx("h4",{className:"ficha-section-title",children:"Facturacin"}),u.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(220px,1fr))",gap:12},children:[u.jsx(Eo,{title:"Total facturado",value:`$ ${Q.totalFacturado.toLocaleString()}`}),u.jsx(Eo,{title:"Total pagado",value:`$ ${Q.totalPagado.toLocaleString()}`}),u.jsx(Eo,{title:"Facturas pendientes",value:`$ ${Q.totalFacturasPendientes.toLocaleString()}`}),u.jsx(Eo,{title:"Saldo pendiente (facturas - pagos)",value:`$ ${(Q.totalFacturado-Q.totalPagado).toLocaleString()}`}),u.jsx(Eo,{title:"Saldo a favor",value:`$ ${(((De=y.facturacion)==null?void 0:De.saldoFavor)??0).toLocaleString()}`}),u.jsx(Eo,{title:"Saldo crdito",value:`$ ${((($e=y.facturacion)==null?void 0:$e.saldoCredito)??0).toLocaleString()}`})]}),Q.error&&u.jsxs("div",{className:"hint",style:{marginTop:6},children:[" ",Q.error]}),u.jsxs("div",{className:"ficha-grid",style:{marginTop:12},children:[u.jsxs("div",{className:"field",children:[u.jsx("label",{children:"Saldo a favor"}),u.jsx("input",{type:"number",className:"form-input",value:((Xe=y.facturacion)==null?void 0:Xe.saldoFavor)??0,onChange:S=>ue({facturacion:{...y.facturacion||{},saldoFavor:Number(S.target.value||0)}})})]}),u.jsxs("div",{className:"field",children:[u.jsx("label",{children:"Saldo crdito"}),u.jsx("input",{type:"number",className:"form-input",value:((Se=y.facturacion)==null?void 0:Se.saldoCredito)??0,onChange:S=>ue({facturacion:{...y.facturacion||{},saldoCredito:Number(S.target.value||0)}})})]})]}),u.jsxs("div",{style:{marginTop:14,display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:[u.jsxs("div",{className:"mini-card",children:[u.jsx("div",{className:"mini-card-title",children:"ltimas facturas"}),u.jsx("div",{className:"table-wrap",children:u.jsxs("table",{className:"appointments-table",children:[u.jsx("thead",{children:u.jsxs("tr",{children:[u.jsx("th",{children:"Fecha"}),u.jsx("th",{children:"Estado"}),u.jsx("th",{children:"Total"})]})}),u.jsxs("tbody",{children:[Q.facturas.slice(0,8).map(S=>u.jsxs("tr",{children:[u.jsx("td",{children:S.fechaISO?new Date(S.fechaISO).toLocaleString():""}),u.jsx("td",{children:String(S.estado||"").toUpperCase()}),u.jsxs("td",{children:["$",(S.total||0).toLocaleString()]})]},S.id)),Q.facturas.length===0&&u.jsx("tr",{children:u.jsx("td",{className:"no-data",colSpan:3,children:"Sin facturas."})})]})]})})]}),u.jsxs("div",{className:"mini-card",children:[u.jsx("div",{className:"mini-card-title",children:"ltimos pagos"}),u.jsx("div",{className:"table-wrap",children:u.jsxs("table",{className:"appointments-table",children:[u.jsx("thead",{children:u.jsxs("tr",{children:[u.jsx("th",{children:"Fecha"}),u.jsx("th",{children:"Medio"}),u.jsx("th",{children:"Monto"})]})}),u.jsxs("tbody",{children:[Q.pagos.slice(0,8).map(S=>u.jsxs("tr",{children:[u.jsx("td",{children:S.fechaISO?new Date(S.fechaISO).toLocaleString():""}),u.jsx("td",{children:S.medio}),u.jsxs("td",{children:["$",(S.monto||0).toLocaleString()]})]},S.id)),Q.pagos.length===0&&u.jsx("tr",{children:u.jsx("td",{className:"no-data",colSpan:3,children:"Sin pagos."})})]})]})})]})]})]}),E==="citas"&&u.jsxs("section",{className:"ficha-section",children:[u.jsx("h4",{className:"ficha-section-title",children:"Citas"}),u.jsx("div",{className:"table-wrap",children:u.jsxs("table",{className:"appointments-table",children:[u.jsx("thead",{children:u.jsxs("tr",{children:[u.jsx("th",{children:"Fecha"}),u.jsx("th",{children:"Estado"}),u.jsx("th",{children:"Motivo"}),u.jsx("th",{children:"Profesional"})]})}),u.jsx("tbody",{children:ne?u.jsx("tr",{children:u.jsx("td",{className:"no-data",colSpan:4,children:"Cargando"})}):de.length===0?u.jsx("tr",{children:u.jsx("td",{className:"no-data",colSpan:4,children:"Sin citas registradas."})}):de.map(S=>u.jsxs("tr",{children:[u.jsx("td",{children:S.fechaISO?new Date(S.fechaISO).toLocaleString():""}),u.jsx("td",{children:S.estado||""}),u.jsx("td",{children:S.motivo||""}),u.jsx("td",{children:S.profesional||""})]},S.id))})]})})]}),E==="crm"&&u.jsxs("section",{className:"ficha-section",children:[u.jsx("h4",{className:"ficha-section-title",children:"CRM"}),u.jsx("div",{className:"no-data",children:"Notas / recordatorios comerciales del paciente."})]}),u.jsx("div",{className:"ficha-footer"})]})]})]})]})]})}function Eo({title:t,value:e}){return u.jsxs("div",{className:"mini-card",children:[u.jsx("div",{className:"mini-card-title",children:t}),u.jsx("div",{style:{fontWeight:700,fontSize:20,marginTop:6},children:e})]})}function kU({onAdd:t}){const[e,n]=N.useState(""),[r,i]=N.useState(""),[s,o]=N.useState("Pendiente");return u.jsxs("div",{className:"presu-form",children:[u.jsx("input",{className:"form-input",placeholder:"Procedimiento / plan",value:e,onChange:a=>n(a.target.value)}),u.jsx("input",{type:"number",className:"form-input",placeholder:"Costo",value:r,onChange:a=>i(a.target.value)}),u.jsxs("select",{className:"form-input",value:s,onChange:a=>o(a.target.value),children:[u.jsx("option",{children:"Pendiente"}),u.jsx("option",{children:"Aprobado"}),u.jsx("option",{children:"Rechazado"})]}),u.jsx("button",{type:"button",className:"btn blue",onClick:()=>{if(!e)return alert("Ttulo requerido");t({titulo:e,costo:Number(r||0),estado:s}),n(""),i(""),o("Pendiente")},children:"Agregar"})]})}function DU({onAdd:t}){const[e,n]=N.useState("");return u.jsxs("div",{className:"evo-form",children:[u.jsx("textarea",{className:"form-input",rows:2,placeholder:"Escribe la evolucin / remisin",value:e,onChange:r=>n(r.target.value)}),u.jsx("button",{type:"button",className:"btn blue",onClick:()=>{e.trim()&&(t(e.trim()),n(""))},children:"Guardar evolucin"})]})}function jU(){return u.jsxs("div",{style:{padding:"20px"},children:[u.jsx("h2",{children:"Mdulo de Facturacin"}),u.jsx("p",{children:"Aqu se registrarn los pagos, facturas y cobros."})]})}const vr=t=>(Number(t)||0).toLocaleString("es-CO",{maximumFractionDigits:0}),Io=()=>new Date().toISOString().slice(0,10),OU=(t=new Date)=>new Date(t.getFullYear(),t.getMonth(),t.getDate(),0,0,0,0),VU=(t=new Date)=>new Date(t.getFullYear(),t.getMonth(),t.getDate()+1,0,0,0,0),sT=t=>Le.fromDate(t),LU=()=>{const[t,e]=N.useState(null);return N.useEffect(()=>{const n=_y(oh,r=>e(r||null));return()=>n()},[]),t},Mt=({children:t,align:e})=>u.jsx("th",{className:"oc-th",style:{position:"sticky",top:0,zIndex:1,textAlign:e||"left",background:"var(--oc-surface, #fff)"},children:t}),MU=()=>Math.random().toString(36).slice(2)+Math.random().toString(36).slice(2);function FU(){var S;const t=LU(),e=[{key:"abrir",label:"Abrir caja",icon:""},{key:"abiertas",label:"Cajas abiertas",icon:""},{key:"cerradas",label:"Cajas cerradas",icon:""},{key:"mio",label:"Mi caja (hoy)",icon:""},{key:"simulados",label:"Cierres simulados",icon:""},{key:"bancos",label:"Bancos",icon:""}],[n,r]=N.useState("abiertas"),[i,s]=N.useState(""),[o,a]=N.useState(""),l=N.useRef(null),[d,h]=N.useState(!1),[f,m]=N.useState(""),[_,R]=N.useState([]),[C,y]=N.useState(!0),[I,w]=N.useState([]),[E,O]=N.useState(!0),[D,B]=N.useState(null),[x,v]=N.useState(!0),[b,A]=N.useState(""),[j,V]=N.useState([]),[P,q]=N.useState(null),[qe,Pt]=N.useState(""),[$t,X]=N.useState("efectivo"),[ce,pe]=N.useState(!1),[ke,Be]=N.useState("ingreso"),[$,J]=N.useState(""),[le,ue]=N.useState(""),[Ie,je]=N.useState(!1),[me,Qe]=N.useState([]),[we,re]=N.useState([]);N.useEffect(()=>{const k=Je(Me(_e,"cajas"),Ge("estado","==","abierta"),rn("fechaApertura","desc")),z=rr(k,G=>{R(G.docs.map(oe=>Ae(oe.id,oe.data()))),y(!1),s("")},G=>{console.error(G),s((G==null?void 0:G.code)==="failed-precondition"?"Falta ndice (estado, fechaApertura) en Firestore.":(G==null?void 0:G.code)==="permission-denied"?"Permiso denegado en Firestore (revisa reglas).":"No se pudieron leer las cajas."),y(!1)});return()=>z()},[]),N.useEffect(()=>{const k=Je(Me(_e,"cajas"),Ge("estado","==","cerrada"),rn("fechaCierre","desc")),z=rr(k,G=>{w(G.docs.map(oe=>Ae(oe.id,oe.data()))),O(!1)},G=>{console.error(G),O(!1)});return()=>z()},[]),N.useEffect(()=>{if(!t){B(null),v(!1);return}v(!0);const k=Je(Me(_e,"cajas"),Ge("estado","==","abierta"),Ge("usuarioId","==",t.uid),Ge("fechaApertura",">=",sT(OU())),Ge("fechaApertura","<",sT(VU()))),z=rr(k,G=>{const oe=G.docs[0];B(oe?Ae(oe.id,oe.data()):null),v(!1)},G=>{console.error(G),v(!1),(G==null?void 0:G.code)==="failed-precondition"&&s("Falta ndice (estado, usuarioId, fechaApertura) en Firestore.")});return()=>z()},[t]),N.useEffect(()=>{if(!(D!=null&&D.id)){Qe([]),re([]);return}const k=Je(Me(_e,"movimientos"),Ge("cashId","==",D.id),Ge("dia","==",Io()),rn("fecha","desc")),z=rr(k,Ce=>Qe(Ce.docs.map(xt=>({id:xt.id,...xt.data()}))),Ce=>console.error(Ce)),G=Je(Me(_e,"payments"),Ge("cashId","==",D.id),Ge("dia","==",Io()),rn("fecha","desc")),oe=rr(G,Ce=>re(Ce.docs.map(xt=>({id:xt.id,...xt.data()}))),Ce=>console.error(Ce));return()=>{z(),oe()}},[D==null?void 0:D.id]),N.useEffect(()=>{if(!(b!=null&&b.trim())){V([]);return}const k=Je(Me(_e,"patients"),Ge("q",">=",te(b)),Ge("q","<=",te(b)+""),rn("q","asc")),z=rr(k,G=>V(G.docs.map(oe=>({id:oe.id,...oe.data()}))),G=>console.error(G));return()=>z()},[b]);function Ae(k,z={}){const G=tt=>{var St;return((St=tt==null?void 0:tt.toDate)==null?void 0:St.call(tt))||(typeof tt=="string"?new Date(tt):tt||null)},oe=G(z.fechaApertura),Ce=G(z.fechaCierre),xt=Number(z.baseInicial||0),bn=Number(z.baseActual!==void 0?z.baseActual:xt),Nt=Number(z.saldoInicial||0),et=Number(z.saldoActual!==void 0?z.saldoActual:Nt),pt=[];return et<0&&pt.push("Saldo negativo"),bn<0&&pt.push("Base negativa"),{id:k,estado:z.estado||"abierta",usuarioId:z.usuarioId||"",usuarioNombre:z.usuarioNombre||"Usuario",nombre:z.nombre||z.usuarioNombre||"Caja",fechaApertura:oe,fechaCierre:Ce,baseInicial:xt,baseActual:bn,saldoInicial:Nt,saldoActual:et,ia:pt}}const Et=async k=>{var z;if((z=k==null?void 0:k.preventDefault)==null||z.call(k),!t){s("Debes iniciar sesin para abrir una caja.");return}h(!0);try{const G=Number(f||0);await vl(Me(_e,"cajas"),{estado:"abierta",usuarioId:t.uid,usuarioNombre:t.displayName||t.email||"Usuario",fechaApertura:Mn(),baseInicial:G,baseActual:G,saldoInicial:0,saldoActual:0,dia:Io()}),m(""),r("mio"),s("")}catch(G){console.error(G),s("No se pudo abrir la caja.")}finally{h(!1)}},Tt=async k=>{try{await Zo(Kt(_e,"cajas",k),{estado:"cerrada",fechaCierre:Mn()}),r("cerradas")}catch(z){console.error(z),s("No se pudo cerrar la caja.")}},Q=async k=>{var G;if((G=k==null?void 0:k.preventDefault)==null||G.call(k),!(D!=null&&D.id)){s("Debes abrir tu caja para registrar movimientos.");return}const z=Number(le||0);if(!(!z||z<=0)){je(!0);try{await vl(Me(_e,"movimientos"),{cashId:D.id,tipo:ke,concepto:$||(ke==="ingreso"?"Ingreso":"Egreso"),valor:z,fecha:Mn(),dia:Io(),usuarioId:(t==null?void 0:t.uid)||null});const oe=ke==="ingreso"?z:-z;await Zo(Kt(_e,"cajas",D.id),{saldoActual:OI(oe)}),J(""),ue("")}catch(oe){console.error(oe),s("No se pudo registrar el movimiento.")}finally{je(!1)}}},ne=async k=>{var G;if((G=k==null?void 0:k.preventDefault)==null||G.call(k),!(D!=null&&D.id))return s("Abre tu caja para cobrar.");const z=Number(qe||0);if(!(!z||z<=0)){if(!P)return s("Selecciona un paciente.");pe(!0);try{const oe=await vl(Me(_e,"payments"),{cashId:D.id,patientId:P.id,patientName:P.nombre||P.name||"Paciente",invoiceId:null,valor:z,medio:$t,estado:"aprobado",fecha:Mn(),dia:Io()});await Zo(Kt(_e,"cajas",D.id),{saldoActual:OI(z)}),Pt(""),X("efectivo"),s(`Pago registrado (${oe.id}).`)}catch(oe){console.error(oe),s("No se pudo registrar el pago.")}finally{pe(!1)}}},de=async k=>{var G;if((G=k==null?void 0:k.preventDefault)==null||G.call(k),!(D!=null&&D.id))return s("Abre tu caja para cobrar.");const z=Number(qe||0);if(!(!z||z<=0)){if(!P)return s("Selecciona un paciente.");pe(!0);try{const Ce=`https://pay.odontocloud/mock/${MU()}`,xt=await vl(Me(_e,"payments"),{cashId:D.id,patientId:P.id,patientName:P.nombre||P.name||"Paciente",invoiceId:null,valor:z,medio:"link",estado:"pending",linkUrl:Ce,fecha:Mn(),dia:Io()});s(`Link de pago generado: ${Ce}`),Pt("")}catch(oe){console.error(oe),s("No se pudo generar link de pago.")}finally{pe(!1)}}},te=k=>(k||"").toString().normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase(),ee=N.useMemo(()=>{const k=te(o);return k?_.filter(z=>[z.nombre,z.usuarioNombre,vr(z.saldoActual),vr(z.baseActual)].map(te).some(G=>G.includes(k))):_},[o,_]),ge=()=>u.jsxs("div",{className:"card",children:[u.jsx("div",{className:"oc-card-head",style:{marginBottom:8},children:u.jsx("h3",{children:"Abrir caja"})}),u.jsxs("form",{className:"oc-form",onSubmit:Et,style:{display:"flex",gap:12,alignItems:"end",flexWrap:"wrap"},children:[u.jsxs("label",{style:{display:"inline-flex",flexDirection:"column",gap:6},children:[u.jsx("span",{children:"Base inicial (COP)"}),u.jsx("input",{type:"number",className:"oc-input",min:"0",step:"1000",value:f,onChange:k=>m(k.target.value),placeholder:"0"})]}),u.jsx("button",{className:"oc-btn",type:"submit",disabled:d,children:d?"Abriendo...":"Abrir caja"})]}),u.jsxs("p",{className:"oc-muted",style:{marginTop:8},children:["Se asociar a tu usuario y quedar visible en ",u.jsx("b",{children:"Mi caja (hoy)"}),"."]})]}),he=()=>u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"card",style:{marginBottom:10},children:u.jsxs("div",{className:"oc-card-head",style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[u.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[u.jsx("h3",{style:{margin:0},children:"Cajas Abiertas"}),u.jsx("span",{className:"oc-tag",children:ee.length}),i&&u.jsx("span",{className:"oc-tag oc-tag-danger",children:i})]}),u.jsx("input",{ref:l,className:"oc-input",style:{maxWidth:280},placeholder:"Buscar...",value:o,onChange:k=>a(k.target.value)})]})}),u.jsx("div",{className:"card",children:u.jsx("div",{className:"oc-table-wrap",children:u.jsxs("table",{className:"oc-table",children:[u.jsx("thead",{className:"oc-thead",children:u.jsxs("tr",{className:"oc-tr",children:[u.jsx(Mt,{children:"Caja"}),u.jsx(Mt,{children:"Fecha apertura"}),u.jsx(Mt,{align:"right",children:"Base actual"}),u.jsx(Mt,{align:"right",children:"Saldo inicial"}),u.jsx(Mt,{align:"right",children:"Saldo actual"}),u.jsx(Mt,{children:"Usuario"}),u.jsx(Mt,{children:"Acciones"})]})}),u.jsx("tbody",{className:"oc-tbody",children:C?u.jsx(oT,{cols:7}):ee.length===0?u.jsx("tr",{className:"oc-tr",children:u.jsx("td",{className:"oc-td",colSpan:7,children:u.jsx("span",{className:"oc-muted",children:"Sin cajas abiertas."})})}):ee.map(k=>{var z;return u.jsxs("tr",{className:"oc-tr",children:[u.jsxs("td",{className:"oc-td",children:[u.jsx("b",{children:k.nombre})," ",(z=k.ia)!=null&&z.length?u.jsx("span",{className:"oc-tag oc-tag-danger",title:k.ia.join("  "),children:"IA"}):null]}),u.jsx("td",{className:"oc-td",children:k.fechaApertura?k.fechaApertura.toLocaleString("es-CO"):""}),u.jsxs("td",{className:"oc-td",style:{textAlign:"right"},children:["$",vr(k.baseActual)]}),u.jsxs("td",{className:"oc-td",style:{textAlign:"right"},children:["$",vr(k.saldoInicial)]}),u.jsxs("td",{className:"oc-td",style:{textAlign:"right",color:k.saldoActual<0?"#b91c1c":void 0,fontWeight:600},children:["$",vr(k.saldoActual)]}),u.jsx("td",{className:"oc-td",children:k.usuarioNombre}),u.jsxs("td",{className:"oc-td",style:{whiteSpace:"nowrap"},children:[u.jsx("button",{className:"oc-small-btn",onClick:()=>r("mio"),children:"Ver"})," ",u.jsx("button",{className:"oc-small-btn oc-danger",onClick:()=>Tt(k.id),children:"Cerrar"})]})]},k.id)})})]})})})]}),Te=()=>u.jsxs("div",{className:"card",children:[u.jsxs("div",{className:"oc-card-head",style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[u.jsx("h3",{children:"Mi caja (hoy)"}),(D==null?void 0:D.estado)==="abierta"&&u.jsxs("div",{style:{display:"flex",gap:8},children:[u.jsx("span",{className:"oc-tag oc-tag-success",children:"Abierta"}),u.jsx("button",{className:"oc-small-btn oc-danger",onClick:()=>Tt(D.id),children:"Cerrar caja"})]})]}),x?u.jsx("div",{className:"oc-muted",children:"Cargando"}):D?u.jsxs(u.Fragment,{children:[u.jsxs("div",{className:"oc-stats-row",style:{marginBottom:12},children:[u.jsxs("div",{className:"stat-card",children:[u.jsx("span",{className:"stat-label",children:"Base actual"}),u.jsxs("span",{className:"stat-value",children:["$",vr(D.baseActual)]})]}),u.jsxs("div",{className:"stat-card",children:[u.jsx("span",{className:"stat-label",children:"Saldo actual"}),u.jsxs("span",{className:"stat-value",style:{color:D.saldoActual<0?"#b91c1c":void 0},children:["$",vr(D.saldoActual)]})]})]}),u.jsxs("div",{className:"card",style:{marginBottom:12},children:[u.jsx("h4",{style:{marginBottom:8},children:"Cobro rpido"}),u.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr auto",gap:8},children:[u.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:6},children:[u.jsx("label",{className:"oc-muted",children:"Paciente"}),u.jsx("input",{className:"oc-input",placeholder:"Buscar nombre o documento",value:b,onChange:k=>A(k.target.value)}),b&&j.length>0&&u.jsx("div",{className:"oc-dropdown",children:j.slice(0,6).map(k=>u.jsx("button",{className:`oc-menu-item ${(P==null?void 0:P.id)===k.id?"active":""}`,onClick:()=>{q(k),A(k.nombre||k.name||k.doc||"")},type:"button",children:(k.nombre||k.name||"Paciente")+(k.doc?`  ${k.doc}`:"")},k.id))})]}),u.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:6},children:[u.jsx("label",{className:"oc-muted",children:"Monto (COP)"}),u.jsx("input",{className:"oc-input",type:"number",min:"0",step:"1000",placeholder:"0",value:qe,onChange:k=>Pt(k.target.value)})]}),u.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:6},children:[u.jsx("label",{className:"oc-muted",children:"Medio"}),u.jsxs("select",{className:"oc-input",value:$t,onChange:k=>X(k.target.value),children:[u.jsx("option",{value:"efectivo",children:"Efectivo"}),u.jsx("option",{value:"tarjeta",children:"Tarjeta"}),u.jsx("option",{value:"transferencia",children:"Transferencia"}),u.jsx("option",{value:"link",children:"Link (en lnea)"})]})]}),u.jsx("div",{style:{display:"flex",alignItems:"end",gap:6},children:$t==="link"?u.jsx("button",{className:"oc-btn",onClick:de,disabled:ce,children:ce?"Creando":"Generar link"}):u.jsx("button",{className:"oc-btn",onClick:ne,disabled:ce,children:ce?"Guardando":"Registrar pago"})})]}),u.jsxs("p",{className:"oc-muted",style:{marginTop:8},children:["Para link, el saldo se actualiza cuando el pago pase a ",u.jsx("b",{children:"aprobado"})," (webhook)."]})]}),u.jsxs("div",{className:"card",style:{marginBottom:12},children:[u.jsx("h4",{style:{marginBottom:8},children:"Movimiento manual"}),u.jsxs("form",{onSubmit:Q,style:{display:"grid",gridTemplateColumns:"120px 1fr 180px auto",gap:8},children:[u.jsxs("select",{className:"oc-input",value:ke,onChange:k=>Be(k.target.value),children:[u.jsx("option",{value:"ingreso",children:"Ingreso"}),u.jsx("option",{value:"egreso",children:"Egreso"})]}),u.jsx("input",{className:"oc-input",placeholder:"Concepto (ej. Caja chica, Arriendo, etc.)",value:$,onChange:k=>J(k.target.value)}),u.jsx("input",{className:"oc-input",type:"number",min:"0",step:"1000",placeholder:"0",value:le,onChange:k=>ue(k.target.value)}),u.jsx("button",{className:"oc-btn",disabled:Ie,children:Ie?"Guardando":"Agregar"})]})]}),u.jsxs("div",{className:"card",children:[u.jsx("h4",{style:{marginBottom:8},children:"Movimientos y pagos (hoy)"}),u.jsx("div",{className:"oc-table-wrap",style:{marginBottom:12},children:u.jsxs("table",{className:"oc-table",children:[u.jsx("thead",{className:"oc-thead",children:u.jsxs("tr",{className:"oc-tr",children:[u.jsx(Mt,{children:"Tipo"}),u.jsx(Mt,{children:"Concepto / Paciente"}),u.jsx(Mt,{children:"Medio"}),u.jsx(Mt,{children:"Estado"}),u.jsx(Mt,{align:"right",children:"Valor"}),u.jsx(Mt,{children:"Hora"})]})}),u.jsx("tbody",{className:"oc-tbody",children:me.length===0&&we.length===0?u.jsx("tr",{className:"oc-tr",children:u.jsx("td",{className:"oc-td",colSpan:6,children:u.jsx("span",{className:"oc-muted",children:"Sin movimientos ni pagos an."})})}):u.jsxs(u.Fragment,{children:[we.map(k=>{var z,G;return u.jsxs("tr",{className:"oc-tr",children:[u.jsx("td",{className:"oc-td",children:"Pago"}),u.jsxs("td",{className:"oc-td",children:[k.patientName||"Paciente"," ",k.linkUrl?u.jsx("a",{href:k.linkUrl,target:"_blank",rel:"noreferrer",children:"(link)"}):null]}),u.jsx("td",{className:"oc-td",children:k.medio}),u.jsx("td",{className:"oc-td",children:u.jsx("span",{className:`oc-tag ${k.estado==="aprobado"?"oc-tag-success":k.estado==="pending"?"oc-tag-warning":"oc-tag-danger"}`,children:k.estado})}),u.jsxs("td",{className:"oc-td",style:{textAlign:"right"},children:["$",vr(k.valor)]}),u.jsx("td",{className:"oc-td",children:(G=(z=k.fecha)==null?void 0:z.toDate)!=null&&G.call(z)?k.fecha.toDate().toLocaleTimeString("es-CO"):""})]},`pay-${k.id}`)}),me.map(k=>{var z,G;return u.jsxs("tr",{className:"oc-tr",children:[u.jsx("td",{className:"oc-td",children:k.tipo}),u.jsx("td",{className:"oc-td",children:k.concepto}),u.jsx("td",{className:"oc-td",children:""}),u.jsx("td",{className:"oc-td",children:u.jsx("span",{className:"oc-tag",children:(k.tipo==="ingreso","ok")})}),u.jsxs("td",{className:"oc-td",style:{textAlign:"right"},children:["$",vr(k.valor)]}),u.jsx("td",{className:"oc-td",children:(G=(z=k.fecha)==null?void 0:z.toDate)!=null&&G.call(z)?k.fecha.toDate().toLocaleTimeString("es-CO"):""})]},`mov-${k.id}`)})]})})]})}),u.jsx("p",{className:"oc-muted",children:"Sugerencia: crea ndice compuesto para `movimientos(cashId, dia, fecha)` y `payments(cashId, dia, fecha)` para rendimiento."})]})]}):u.jsxs("div",{className:"oc-empty",children:[u.jsx("p",{className:"oc-muted",children:"No tienes una caja abierta hoy."}),u.jsx("button",{className:"oc-btn",onClick:()=>r("abrir"),children:"Abrir caja"})]})]}),De=()=>u.jsxs("div",{className:"card",children:[u.jsx("div",{className:"oc-card-head",style:{marginBottom:8},children:u.jsxs("h3",{children:["Cajas cerradas ",u.jsx("span",{className:"oc-tag",children:I.length})]})}),u.jsx("div",{className:"oc-table-wrap",children:u.jsxs("table",{className:"oc-table",children:[u.jsx("thead",{className:"oc-thead",children:u.jsxs("tr",{className:"oc-tr",children:[u.jsx(Mt,{children:"Caja"}),u.jsx(Mt,{children:"Usuario"}),u.jsx(Mt,{children:"Apertura"}),u.jsx(Mt,{children:"Cierre"}),u.jsx(Mt,{align:"right",children:"Saldo final"})]})}),u.jsx("tbody",{className:"oc-tbody",children:E?u.jsx(oT,{cols:5}):I.length===0?u.jsx("tr",{className:"oc-tr",children:u.jsx("td",{className:"oc-td",colSpan:5,children:u.jsx("span",{className:"oc-muted",children:"Sin cajas cerradas."})})}):I.map(k=>u.jsxs("tr",{className:"oc-tr",children:[u.jsx("td",{className:"oc-td",children:k.nombre}),u.jsx("td",{className:"oc-td",children:k.usuarioNombre}),u.jsx("td",{className:"oc-td",children:k.fechaApertura?k.fechaApertura.toLocaleString("es-CO"):""}),u.jsx("td",{className:"oc-td",children:k.fechaCierre?k.fechaCierre.toLocaleString("es-CO"):""}),u.jsxs("td",{className:"oc-td",style:{textAlign:"right"},children:["$",vr(k.saldoActual)]})]},k.id))})]})})]}),$e=()=>u.jsxs("div",{className:"card",children:[u.jsx("h3",{children:"Cierres simulados"}),u.jsx("p",{className:"oc-muted",children:"El cierre hipottico compara ventas y movimientos detectando errores y descuadres con IA. (Conectar fuente de datos para activarlo)."})]}),Xe=()=>u.jsxs("div",{className:"card",children:[u.jsx("h3",{children:"Bancos"}),u.jsx("p",{className:"oc-muted",children:"Conciliacin de consignaciones/pagos electrnicos contra caja del da. (Conectar pasarela o extractos para habilitar)."})]}),Se=({m:k})=>u.jsxs("button",{type:"button",onClick:()=>r(k.key),className:`oc-menu-item ${n===k.key?"active":""}`,style:{width:"100%",textAlign:"left",padding:"10px 12px",borderRadius:10,border:"1px solid transparent",background:n===k.key?"var(--oc-surface-2, #f3f6ff)":"transparent",fontWeight:600},title:k.label,children:[u.jsx("span",{style:{opacity:.8,marginRight:6},children:k.icon}),k.label]});return u.jsxs("div",{className:"oc-main-content",style:{display:"grid",gridTemplateColumns:"240px 1fr",gap:16},children:[u.jsx("aside",{className:"card",role:"navigation","aria-label":"Men de caja",style:{height:"fit-content",padding:12},children:u.jsx("div",{style:{display:"flex",flexDirection:"column",gap:8},children:e.map(k=>u.jsx(Se,{m:k},k.key))})}),u.jsxs("section",{children:[u.jsx("div",{className:"card",style:{marginBottom:12,padding:12},children:u.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",gap:12},children:[u.jsxs("div",{className:"oc-breadcrumb",children:[u.jsx("span",{children:"Caja"}),u.jsx("span",{children:""}),u.jsx("b",{children:(S=e.find(k=>k.key===n))==null?void 0:S.label})]}),n==="abiertas"&&u.jsx("input",{ref:l,className:"oc-input",placeholder:"Buscar...",value:o,onChange:k=>a(k.target.value),style:{maxWidth:300}})]})}),n==="abrir"&&u.jsx(ge,{}),n==="abiertas"&&u.jsx(he,{}),n==="cerradas"&&u.jsx(De,{}),n==="mio"&&u.jsx(Te,{}),n==="simulados"&&u.jsx($e,{}),n==="bancos"&&u.jsx(Xe,{})]})]})}function oT({cols:t=6,n:e=3}){return u.jsx(u.Fragment,{children:Array.from({length:e}).map((n,r)=>u.jsx("tr",{className:"oc-tr",children:Array.from({length:t}).map((i,s)=>u.jsx("td",{className:"oc-td",children:u.jsx("div",{style:{height:12,width:s===0?160:100+s%3*40,background:"var(--oc-skeleton, #e5e7eb)",borderRadius:6}})},s))},r))})}function UU({items:t=[]}){return u.jsxs("div",{className:"card activity-card",children:[u.jsx("h4",{children:"Actividad reciente"}),u.jsx("ul",{className:"activity-list",children:t.map(e=>u.jsxs("li",{children:[u.jsx("strong",{children:e.title}),u.jsx("div",{className:"time",children:e.time})]},e.id))})]})}function BU({status:t}){return t?u.jsxs("div",{className:"card",children:[u.jsx("h4",{children:"Automatizaciones (N8N)"}),u.jsxs("div",{className:"n8n-line",children:[u.jsx("strong",{children:"Conectado:"})," ",t.connected?"S":"No"]}),u.jsxs("div",{className:"n8n-line",children:[u.jsx("strong",{children:"Flujos activos:"})," ",t.flowsRunning]}),t.lastError&&u.jsxs("div",{className:"n8n-error",children:["Error: ",t.lastError]})]}):null}const rt={es:{nav_home:"Inicio",nav_agenda:"Agenda",nav_patients:"Pacientes",nav_billing:"Facturacin",nav_inventory:"Inventario",nav_odontogram:"Odontograma",nav_reports:"Reportes",nav_cash:"Caja",nav_admin:"Administracin",welcomeTitle:"Bienvenido a OdontoCloud",welcomeSubtitle:"Administra tus pacientes, agenda, inventario y facturacin de manera inteligente y moderna.",clinicLabel:"Clnica",userLabel:"Usuario",roleLabel:"Rol",searchPlaceholder:"Buscar acciones o ir a",stats_patientsToday:"Pacientes totales",stats_appointmentsToday:"Citas hoy",stats_revenueToday:"Facturacin hoy",stats_waiting:"En espera",stats_currency:"COP",n8n_title:"Automatizaciones (n8n)",recent_title:"Actividad reciente",recent_empty:"Sin actividad registrada.",loading:"Cargando...",logout:"Cerrar sesin",module_coming:"Mdulo prximamente.",todays_appts:"Citas de hoy",see_schedule:"Ir a Agenda",no_appts_today:"No hay citas programadas hoy.",at:"a las"},en:{nav_home:"Overview",nav_agenda:"Schedule",nav_patients:"Patients",nav_billing:"Billing",nav_inventory:"Inventory",nav_odontogram:"Odontogram",nav_reports:"Reports",nav_cash:"Cash",nav_admin:"Administration",welcomeTitle:"Welcome to OdontoCloud",welcomeSubtitle:"Manage your patients, schedule, inventory and billing in a smart and modern way.",clinicLabel:"Clinic",userLabel:"User",roleLabel:"Role",searchPlaceholder:"Search actions or go to",stats_patientsToday:"Total patients",stats_appointmentsToday:"Appointments today",stats_revenueToday:"Revenue today",stats_waiting:"In waiting room",stats_currency:"COP",n8n_title:"Automations (n8n)",recent_title:"Recent activity",recent_empty:"No activity yet.",loading:"Loading...",logout:"Log out",module_coming:"Module coming soon.",todays_appts:"Today's appointments",see_schedule:"Open Schedule",no_appts_today:"No appointments today.",at:"at"}},$U=()=>typeof navigator>"u"||(navigator.language||navigator.userLanguage||"es").toLowerCase().startsWith("es")?"es":"en",zU=()=>{try{const t=JSON.parse(localStorage.getItem("odc_session"));return t&&Date.now()-t.timestamp<1e3*60*60*24?t:null}catch{return null}},qU=()=>N.useMemo(()=>{const t=new Date,e=new Date(t.getFullYear(),t.getMonth(),t.getDate(),0,0,0,0),n=new Date(t.getFullYear(),t.getMonth(),t.getDate()+1,0,0,0,0);return{startToday:Le.fromDate(e),endToday:Le.fromDate(n),startTodayJS:e}},[]),HU=t=>`${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,"0")}-${String(t.getDate()).padStart(2,"0")}`,WU=(t,e)=>t.toLocaleTimeString(e==="es"?"es-CO":"en-US",{hour:"2-digit",minute:"2-digit"}),KU=(t,e)=>{try{const[n,r,i]=(t||"").split("-").map(a=>parseInt(a,10)),[s=0,o=0]=(e||"00:00").split(":").map(a=>parseInt(a,10));return new Date(n,(r||1)-1,i||1,s,o,0,0)}catch{return new Date}};function GU({data:t=[]}){const i=Math.max(1,...t.map(d=>Number(d.value)||0)),s=t.length||7,o=10,a=Math.max(16,Math.min(44,(640-o*(s+1))/s)),l=(a+o)*s+o;return u.jsx("div",{style:{width:"100%",overflowX:"auto"},children:u.jsxs("svg",{width:l,height:240,role:"img","aria-label":"Pacientes registrados por da en la ltima semana",children:[[.25,.5,.75,1].map((d,h)=>{const f=18+(1-d)*182;return u.jsx("line",{x1:0,x2:l,y1:f,y2:f,stroke:"#e5e7eb",strokeDasharray:"4 4"},h)}),t.map((d,h)=>{const f=Number(d.value)||0,m=Math.round(f/i*182),_=o+h*(a+o),R=200-m;return u.jsxs("g",{children:[u.jsx("rect",{x:_,y:R,width:a,height:m,rx:"6",ry:"6",fill:f>0?"#0ea5e9":"#cbd5e1",children:u.jsx("title",{children:`${d.label||d.shortLabel||""}  ${f} paciente${f!==1?"s":""}`})}),f>0&&m>14&&u.jsx("text",{x:_+a/2,y:R-6,textAnchor:"middle",fontSize:"11",fill:"#0f172a",children:f}),u.jsx("text",{x:_+a/2,y:214,textAnchor:"middle",fontSize:"11",fill:"#64748b",children:d.shortLabel||""})]},h)})]})})}function QU({onNavigate:t,onAction:e,placeholder:n}){const[r,i]=N.useState(""),[s,o]=N.useState(!1),[a,l]=N.useState(0),d=N.useRef(null),h=N.useMemo(()=>[{group:"Navegacin",label:"Ir a Inicio",keywords:"inicio home overview",run:()=>t==null?void 0:t("Inicio")},{group:"Navegacin",label:"Ir a Agenda",keywords:"agenda calendario schedule",run:()=>t==null?void 0:t("Agenda")},{group:"Navegacin",label:"Ir a Pacientes",keywords:"pacientes",run:()=>t==null?void 0:t("Pacientes")},{group:"Navegacin",label:"Ir a Facturacin",keywords:"facturacion facturas billing",run:()=>t==null?void 0:t("Facturacin")},{group:"Navegacin",label:"Ir a Inventario",keywords:"inventario stock",run:()=>t==null?void 0:t("Inventario")},{group:"Navegacin",label:"Ir a Odontograma",keywords:"odontograma",run:()=>t==null?void 0:t("Odontograma")},{group:"Navegacin",label:"Ir a Reportes",keywords:"reportes informes",run:()=>t==null?void 0:t("Reportes")},{group:"Acciones",label:"Nueva cita",keywords:"nueva cita agendar",run:()=>e==null?void 0:e("new_appointment")},{group:"Acciones",label:"Nuevo paciente",keywords:"nuevo paciente alta",run:()=>e==null?void 0:e("new_patient")},{group:"Acciones",label:"Nueva factura",keywords:"nueva factura",run:()=>e==null?void 0:e("new_invoice")},{group:"Acciones",label:"Exportar agenda",keywords:"exportar agenda",run:()=>e==null?void 0:e("export_agenda")},{group:"Acciones",label:"Ir a hoy (Agenda)",keywords:"hoy today",run:()=>e==null?void 0:e("agenda_today")},{group:"Acciones",label:"Cambiar modo oscuro",keywords:"oscuro dark mode",run:()=>e==null?void 0:e("toggle_dark")},{group:"Acciones",label:"Cerrar sesin",keywords:"logout salir cerrar",run:()=>e==null?void 0:e("logout")},{group:"Ayuda",label:"Ver atajos de teclado",keywords:"atajos ayuda",run:()=>e==null?void 0:e("show_shortcuts")},{group:"Ayuda",label:"Soporte / Contacto",keywords:"soporte ayuda contacto",run:()=>e==null?void 0:e("support")}],[t,e]),f=N.useMemo(()=>{const C=r.toLowerCase().trim();return C?h.filter(y=>y.label.toLowerCase().includes(C)||y.keywords.includes(C)):[]},[r,h]);N.useEffect(()=>{const C=y=>{d.current&&(d.current.contains(y.target)||o(!1))};return document.addEventListener("mousedown",C),()=>document.removeEventListener("mousedown",C)},[]);const m=C=>{var y;(y=C.run)==null||y.call(C),i(""),o(!1)},_=C=>{!s||f.length===0||(C.key==="ArrowDown"&&(C.preventDefault(),l(y=>(y+1)%f.length)),C.key==="ArrowUp"&&(C.preventDefault(),l(y=>(y-1+f.length)%f.length)),C.key==="Enter"&&(C.preventDefault(),f[a]&&m(f[a])),C.key==="Escape"&&o(!1))},R=N.useMemo(()=>{const C=new Map;return f.forEach(y=>{C.has(y.group)||C.set(y.group,[]),C.get(y.group).push(y)}),Array.from(C.entries())},[f]);return u.jsxs("div",{className:"oc-search-wrap",ref:d,children:[u.jsx("input",{className:"oc-search",type:"search",inputMode:"search",placeholder:n,"aria-label":n,value:r,onChange:C=>{i(C.target.value),o(!!C.target.value),l(0)},onFocus:()=>o(!!r),onKeyDown:_}),s&&u.jsx("div",{className:"oc-search-dropdown",role:"listbox","aria-label":"Resultados de comandos",children:R.length===0?u.jsx("div",{className:"oc-search-item empty",children:"Escribe para ver opciones"}):R.map(([C,y])=>u.jsxs("div",{children:[u.jsx("div",{className:"oc-search-group",children:C}),y.map(I=>{const w=f.indexOf(I);return u.jsx("button",{className:`oc-search-item ${w===a?"active":""}`,onMouseEnter:()=>l(w),onClick:()=>m(I),role:"option",children:u.jsx("span",{className:"oc-search-title",children:I.label})},I.label)})]},C))})]})}function YU({open:t,anchorRect:e,onClose:n,onGo:r,onSoon:i,onFact:s,dark:o}){const[a,l]=N.useState(null),d=N.useRef(null);if(N.useEffect(()=>{if(!t)return;const q=Pt=>Pt.key==="Escape"&&(n==null?void 0:n()),qe=()=>n==null?void 0:n();return window.addEventListener("keydown",q),window.addEventListener("scroll",qe,!0),()=>{window.removeEventListener("keydown",q),window.removeEventListener("scroll",qe,!0)}},[t,n]),!t)return null;const h=((e==null?void 0:e.bottom)||60)+8,f=Math.max(12,Math.min(((e==null?void 0:e.left)||300)-160,window.innerWidth-920)),m=10,_=f+360+m,R=o?"#0b1220":"#ffffff",C=o?"#e5e7eb":"#0f172a",y=o?"#0f1a32":"#f3f6ff",I=o?"#1f2a44":"#e2e8f0",w=o?"#b6c1d1":"#475569",E={position:"fixed",top:h,left:f,width:880,maxWidth:"calc(100vw - 24px)",background:R,color:C,borderRadius:14,boxShadow:"0 18px 40px rgba(2,6,23,.18)",border:`1px solid ${I}`,zIndex:400,padding:12},O={position:"fixed",top:h,left:_,width:420,maxWidth:"calc(100vw - 24px)",background:R,color:C,borderRadius:14,boxShadow:"0 18px 40px rgba(2,6,23,.18)",border:`1px solid ${I}`,zIndex:410,padding:12},D={display:"flex",flexDirection:"column",gap:6,padding:"8px 10px"},B={height:38,borderRadius:10,padding:"0 12px",display:"flex",alignItems:"center",gap:8,fontSize:".92rem",cursor:"pointer",border:"1px solid transparent",background:"transparent",color:C,fontWeight:500,textAlign:"left"},x=(q,qe=!0)=>Object.assign(q.currentTarget.style,qe?{background:y,borderColor:I}:{background:"transparent",borderColor:"transparent"}),v=()=>{d.current&&clearTimeout(d.current)},b=()=>{v(),d.current=setTimeout(()=>n==null?void 0:n(),180)},A={position:"fixed",top:h,left:f+360,width:m,height:520,zIndex:405},j=[{label:"Recibo de caja",key:"recibo"},{label:"Saldo a favor",key:"saldo"},{label:"Nota crdito",key:"nc"},{label:"Nota dbito",key:"nd"},{label:"Liquidaciones",key:"liq"},{label:"Traslados",key:"tras"},{label:"Pagos",key:"pagos"},{label:"rdenes de compra",key:"oc"},{label:"Factura de venta",key:"fv"},{label:"Facturas de compra",key:"fc"}],V=[{label:"RIPS anteriores (RS-3374)",key:"rips3374"},{label:"RIPS nuevo (RS-2275)",key:"rips2275"}],P=q=>{s==null||s(q),r==null||r("Facturacin")};return u.jsxs(u.Fragment,{children:[u.jsx("div",{onClick:n,style:{position:"fixed",inset:0,background:"transparent",zIndex:399}}),u.jsx("div",{style:E,onMouseEnter:v,onMouseLeave:b,children:u.jsxs("div",{style:{display:"grid",gridTemplateColumns:"360px 1fr",gap:8,alignItems:"start"},children:[u.jsxs("div",{style:D,children:[u.jsx("button",{type:"button",style:B,onMouseEnter:()=>{v(),l("facturacion")},onFocus:()=>{v(),l("facturacion")},onClick:()=>l(q=>q==="facturacion"?null:"facturacion"),onMouseOver:q=>x(q,!0),onMouseOut:q=>x(q,!1),children:" Facturacin "}),u.jsx("button",{type:"button",style:B,onMouseEnter:()=>{v(),l("rips")},onFocus:()=>{v(),l("rips")},onClick:()=>l(q=>q==="rips"?null:"rips"),onMouseOver:q=>x(q,!0),onMouseOut:q=>x(q,!1),children:" RIPS "}),u.jsx("button",{type:"button",style:B,onClick:()=>i==null?void 0:i(),onMouseOver:q=>x(q,!0),onMouseOut:q=>x(q,!1),children:" Convenios"}),u.jsx("button",{type:"button",style:B,onClick:()=>r==null?void 0:r("Agenda"),onMouseOver:q=>x(q,!0),onMouseOut:q=>x(q,!1),children:" Gestin de agenda"}),u.jsx("button",{type:"button",style:B,onClick:()=>i==null?void 0:i(),onMouseOver:q=>x(q,!0),onMouseOut:q=>x(q,!1),children:" Terceros"}),u.jsx("button",{type:"button",style:B,onClick:()=>i==null?void 0:i(),onMouseOver:q=>x(q,!0),onMouseOut:q=>x(q,!1),children:" Campaas"}),u.jsx("button",{type:"button",style:B,onClick:()=>i==null?void 0:i(),onMouseOver:q=>x(q,!0),onMouseOut:q=>x(q,!1),children:" Temperatura y humedad"}),u.jsx("button",{type:"button",style:B,onClick:()=>i==null?void 0:i(),onMouseOver:q=>x(q,!0),onMouseOut:q=>x(q,!1),children:" Residuos"}),u.jsx("button",{type:"button",style:B,onClick:()=>r==null?void 0:r("Inventario"),onMouseOver:q=>x(q,!0),onMouseOut:q=>x(q,!1),children:" Inventario"}),u.jsx("button",{type:"button",style:B,onClick:()=>i==null?void 0:i(),onMouseOver:q=>x(q,!0),onMouseOut:q=>x(q,!1),children:" Medicamentos y planes"}),u.jsx("button",{type:"button",style:B,onClick:()=>i==null?void 0:i(),onMouseOver:q=>x(q,!0),onMouseOut:q=>x(q,!1),children:" Esterilizacin"})]}),u.jsx("div",{style:D,children:u.jsxs("div",{style:{fontSize:".85rem",color:w},children:["Accesos rpidos a mdulos de administracin. Pasa el mouse por ",u.jsx("b",{children:"Facturacin"})," o ",u.jsx("b",{children:"RIPS"})," para ver sus acciones."]})})]})}),u.jsx("div",{style:A,onMouseEnter:v,onMouseLeave:b}),a&&u.jsx("div",{style:O,onMouseEnter:v,onMouseLeave:b,children:u.jsx("div",{style:{...D,display:"grid",gridTemplateColumns:"1fr"},children:(a==="facturacion"?j:V).map(q=>u.jsx("button",{type:"button",style:B,onClick:()=>a==="facturacion"?P(q.key):i==null?void 0:i(),onMouseOver:qe=>x(qe,!0),onMouseOut:qe=>x(qe,!1),children:q.label},q.label))})})]})}function Cp(){const[t]=N.useState($U()),e=Q=>rt[t][Q]||Q,[n,r]=N.useState("Inicio"),[i,s]=N.useState("recibo"),[o,a]=N.useState(()=>{try{return localStorage.getItem("odontocloud:dark")==="1"}catch{return!1}});N.useEffect(()=>{try{localStorage.setItem("odontocloud:dark",o?"1":"0")}catch{}document.documentElement.classList.toggle("dark",o)},[o]);const[l]=N.useState(()=>zU()),[d]=N.useState((l==null?void 0:l.rol)||""),[h]=N.useState((l==null?void 0:l.email)||""),[f,m]=N.useState("OdontoCloud"),[_,R]=N.useState(h||"Usuario"),[C,y]=N.useState(!0);N.useEffect(()=>{const Q=_y(oh,async ne=>{try{if(!ne){R(h||"Usuario"),m("OdontoCloud"),y(!1);return}R(ne.displayName||ne.email||h||"Usuario");const de=Kt(_e,"empresas",ne.uid),te=await nh(de);m(te.exists()&&te.data().nombre||"OdontoCloud")}catch(de){console.error("Error cargando empresa/usuario:",de)}finally{y(!1)}});return()=>Q()},[h]);const[I,w]=N.useState({pacientesHoy:0,citasHoy:0,facturacionHoy:0,enEspera:0}),[E,O]=N.useState(!0),[D,B]=N.useState([]),[x,v]=N.useState([]),[b,A]=N.useState(!0),{startToday:j,endToday:V,startTodayJS:P}=qU(),q=N.useMemo(()=>HU(P),[P]),qe=N.useMemo(()=>{const Q=new Date,ne=new Date(Q.getFullYear(),Q.getMonth(),Q.getDate()-6),de=Q,te=ee=>ee.toLocaleDateString(t==="es"?"es-ES":"en-US",{weekday:"short",day:"2-digit",month:"short"}).replace(".","");return`${te(ne)}  ${te(de)}`},[t]),Pt=Q=>{var ge;const ne=Q.data()||{};let de;if((ge=ne.fecha)!=null&&ge.toDate){de=ne.fecha.toDate();const he=ne.horaInicio||ne.hora;if(he&&typeof he=="string"){const[Te=0,De=0]=he.split(":").map($e=>parseInt($e,10));de.setHours(Te||0,De||0,0,0)}}else if(typeof ne.fecha=="string"){const he=ne.horaInicio||ne.hora||"00:00";de=KU(ne.fecha,he)}else de=new Date;const te=ne.pacienteNombre||ne.paciente||"Paciente",ee=ne.estado&&String(ne.estado)||"programada";return{id:Q.id,fecha:de,pacienteId:ne.pacienteId||"",pacienteNombre:te,estado:ee,motivo:ne.motivo||""}};N.useEffect(()=>{const Q=Je(Me(_e,"citas"),Ge("fecha",">=",j),Ge("fecha","<",V),rn("fecha","asc")),ne=Je(Me(_e,"citas"),Ge("fecha","==",q));let de=new Map,te=!1,ee=!1;const ge=()=>{const he=Array.from(de.values()).sort((De,$e)=>De.fecha.getTime()-$e.fecha.getTime()),Te=he.filter(De=>String(De.estado).toLowerCase().trim()==="en espera").length;v(he),w(De=>({...De,citasHoy:he.length,enEspera:Te})),te&&ee&&A(!1)};rr(Q,he=>{te=!0;const Te=new Map(de);he.docs.forEach(De=>Te.set(De.id,Pt(De))),de=Te,ge()},he=>{console.error("Realtime citas hoy (TS):",he),te=!0,ge()}),rr(ne,he=>{ee=!0;const Te=new Map(de);he.docs.forEach(De=>Te.set(De.id,Pt(De))),de=Te,ge()},he=>{console.error("Realtime citas hoy (STR):",he),ee=!0,ge()})},[j,V,q]),N.useEffect(()=>{(async()=>{try{const de=(await RM(Me(_e,"pacientes"))).data().count||0;let te=0;try{const ee=Je(Me(_e,"facturas"),Ge("fecha",">=",j),Ge("fecha","<",V));(await en(ee)).forEach(he=>{const Te=he.data();typeof Te.monto=="number"&&(te+=Te.monto)})}catch{te=0}w(ee=>({...ee,pacientesHoy:de,facturacionHoy:te}))}catch(ne){console.error("Error cargando mtricas:",ne),w(de=>({...de,pacientesHoy:0,facturacionHoy:0}))}finally{O(!1)}})()},[j,V]),N.useEffect(()=>{const Q=new Date,ne=new Date(Q.getFullYear(),Q.getMonth(),Q.getDate()-6),de=new Date(Q.getFullYear(),Q.getMonth(),Q.getDate()+1),te=new Map;for(let he=0;he<7;he++){const Te=new Date(Q.getFullYear(),Q.getMonth(),Q.getDate()-(6-he)),De=Te.toISOString().slice(0,10),$e=Te.toLocaleDateString(t==="es"?"es-ES":"en-US"),Xe=Te.toLocaleDateString(t==="es"?"es-ES":"en-US",{weekday:"short",day:"2-digit"}).replace(".","");te.set(De,{label:$e,shortLabel:Xe,value:0})}const ee=Je(Me(_e,"pacientes"),Ge("createdAt",">=",Le.fromDate(ne)),Ge("createdAt","<",Le.fromDate(de))),ge=rr(ee,he=>{const Te=new Map(te);he.docs.forEach(De=>{var k;const $e=De.data()||{},Xe=(k=De.data().createdAt)!=null&&k.toDate?De.data().createdAt.toDate():$e.createdAt?new Date($e.createdAt):null;if(!Xe||isNaN(Xe))return;const Se=Xe.toISOString().slice(0,10);if(!Te.has(Se))return;const S=Te.get(Se);S.value+=1,Te.set(Se,S)}),B(Array.from(Te.values()))},he=>{console.error("Error realtime serie semanal (pacientes):",he),B(Array.from(te.values()))});return()=>{try{ge()}catch{}}},[t]);const[$t,X]=N.useState([]),[ce,pe]=N.useState(!0);N.useEffect(()=>{(async()=>{try{const ne=Je(Me(_e,"actividad"),rn("fecha","desc"),Jo(5)),de=await en(ne);X(de.docs.map(te=>({id:te.id,title:te.data().descripcion||te.data().titulo||"Actividad",time:te.data().resumenTiempo||""})))}catch(ne){console.error("Error cargando actividad:",ne),X([])}finally{pe(!1)}})()},[]);const[ke,Be]=N.useState(null),[$,J]=N.useState(!0);N.useEffect(()=>{(async()=>{try{const ne=Kt(_e,"integraciones","n8n"),de=await nh(ne);Be(de.exists()?{connected:!!de.data().connected,flowsRunning:de.data().flowsRunning||0,lastError:de.data().lastError||null}:{connected:!1,flowsRunning:0,lastError:null})}catch(ne){console.error("Error cargando estado n8n:",ne),Be({connected:!1,flowsRunning:0,lastError:"No se pudo leer el estado desde Firebase."})}finally{J(!1)}})()},[]);const le=async()=>{try{localStorage.removeItem("odc_session")}catch{}try{await Oj(oh)}catch(Q){console.error("Error al cerrar sesin:",Q)}window.location.href="/"},[ue,Ie]=N.useState(!1),[je,me]=N.useState(null),Qe=N.useRef(null),we=N.useRef(null),re=()=>{var ne,de;const Q=(de=(ne=Qe.current)==null?void 0:ne.getBoundingClientRect)==null?void 0:de.call(ne);me(Q),Ie(!0)},Ae=()=>{Ie(!1),we.current&&(clearTimeout(we.current),we.current=null)},Et=()=>{we.current&&(clearTimeout(we.current),we.current=null)},Tt=()=>{switch(n){case"Agenda":return u.jsx(EU,{});case"Pacientes":return u.jsx(NU,{});case"Facturacin":return u.jsx(IU,{view:i});case"Inventario":return u.jsx(TU,{});case"Odontograma":return u.jsx(xU,{});case"Reportes":return u.jsx(jU,{});case"Caja":return u.jsx(FU,{});case"Inicio":default:return null}};return u.jsxs("div",{className:`oc-shell ${o?"oc-dark":""}`,children:[u.jsx("a",{href:"#oc-main",className:"oc-skip-link",children:"Saltar al contenido"}),u.jsxs("header",{className:"oc-header",role:"banner",children:[u.jsxs("div",{className:"oc-header-left",children:[u.jsx("img",{src:fA,alt:"OdontoCloud",className:"oc-logo"}),u.jsxs("div",{className:"oc-brand-text",children:[u.jsx("span",{className:"oc-brand-main",children:"OdontoCloud"}),u.jsx("span",{className:"oc-brand-sub",children:C?"...":f})]})]}),u.jsxs("nav",{className:"oc-nav",role:"navigation","aria-label":"Navegacin principal",children:[u.jsx("button",{type:"button",className:n==="Inicio"?"oc-nav-btn active":"oc-nav-btn","aria-current":n==="Inicio"?"page":void 0,onClick:()=>r("Inicio"),title:e("nav_home"),children:e("nav_home")}),u.jsx("button",{type:"button",className:n==="Agenda"?"oc-nav-btn active":"oc-nav-btn","aria-current":n==="Agenda"?"page":void 0,onClick:()=>r("Agenda"),title:e("nav_agenda"),children:e("nav_agenda")}),u.jsx("button",{type:"button",className:n==="Pacientes"?"oc-nav-btn active":"oc-nav-btn","aria-current":n==="Pacientes"?"page":void 0,onClick:()=>r("Pacientes"),title:e("nav_patients"),children:e("nav_patients")}),u.jsx("button",{type:"button",className:n==="Caja"?"oc-nav-btn active":"oc-nav-btn",onClick:()=>r("Caja"),title:e("nav_cash"),children:e("nav_cash")}),u.jsx("button",{type:"button",ref:Qe,className:"oc-nav-btn",title:e("nav_admin"),"aria-haspopup":"true","aria-expanded":ue,onClick:()=>ue?Ae():re(),onMouseEnter:()=>{Et(),re()},onFocus:()=>{Et(),re()},children:e("nav_admin")}),u.jsx("button",{type:"button",className:n==="Reportes"?"oc-nav-btn active":"oc-nav-btn","aria-current":n==="Reportes"?"page":void 0,onClick:()=>r("Reportes"),title:e("nav_reports"),children:e("nav_reports")})]}),u.jsxs("div",{className:"oc-header-right",children:[u.jsx(QU,{placeholder:e("searchPlaceholder"),onNavigate:Q=>r(Q),onAction:Q=>{switch(Q){case"new_appointment":r("Agenda");break;case"new_patient":r("Pacientes");break;case"new_invoice":r("Facturacin"),s("fv");break;case"export_agenda":r("Agenda");break;case"agenda_today":r("Agenda");break;case"toggle_dark":a(ne=>!ne);break;case"logout":le();break;case"show_shortcuts":alert("Atajos: Ctrl/Cmd + K para abrir bsqueda, / para moverse, Enter para ejecutar.");break;case"support":window.open("https://tu-soporte.odc","_blank");break}}}),u.jsx("button",{className:"oc-icon-btn",type:"button",onClick:()=>a(Q=>!Q),"aria-pressed":o,title:o?"Activar modo claro":"Activar modo oscuro",children:o?"":""}),u.jsx("button",{className:"oc-icon-btn",type:"button",onClick:le,title:rt[t].logout,children:rt[t].logout})]})]}),u.jsx(YU,{open:ue,anchorRect:je,dark:o,onClose:Ae,onGo:Q=>{r(Q),Ae()},onSoon:()=>{alert("Prximamente"),Ae()},onFact:Q=>{s(Q)}}),u.jsxs("main",{id:"oc-main",className:"oc-main-wrapper",role:"main",children:[n!=="Inicio"&&Tt(),n==="Inicio"&&u.jsxs("div",{className:"oc-main-content",children:[u.jsxs("section",{className:"oc-hero","aria-label":"Resumen general",children:[u.jsxs("div",{className:"oc-hero-text",children:[u.jsx("h1",{children:rt[t].welcomeTitle}),u.jsx("p",{children:rt[t].welcomeSubtitle}),u.jsxs("p",{className:"oc-hero-meta",children:[rt[t].clinicLabel,": ",f,"  ",rt[t].userLabel,":"," ",_,"  ",rt[t].roleLabel,": ",d||""]})]}),u.jsxs("div",{className:"oc-hero-badge","aria-live":"polite",children:[u.jsx("span",{className:"oc-hero-badge-title",children:rt[t].stats_appointmentsToday}),u.jsx("span",{className:"oc-hero-badge-value",children:E&&b?"":I.citasHoy}),u.jsxs("span",{className:"oc-hero-badge-sub",children:[rt[t].stats_patientsToday,": ",E?"":I.pacientesHoy]})]})]}),u.jsxs("section",{className:"oc-stats-row","aria-label":"Indicadores del da",children:[u.jsxs("div",{className:"stat-card",children:[u.jsx("span",{className:"stat-label",children:rt[t].stats_patientsToday}),u.jsx("span",{className:"stat-value",children:I.pacientesHoy})]}),u.jsxs("div",{className:"stat-card",children:[u.jsx("span",{className:"stat-label",children:rt[t].stats_appointmentsToday}),u.jsx("span",{className:"stat-value",children:I.citasHoy})]}),u.jsxs("div",{className:"stat-card",children:[u.jsx("span",{className:"stat-label",children:rt[t].stats_revenueToday}),u.jsxs("span",{className:"stat-value",children:[I.facturacionHoy.toLocaleString("es-CO")," ",u.jsx("span",{className:"stat-currency",children:rt[t].stats_currency})]})]}),u.jsxs("div",{className:"stat-card",children:[u.jsx("span",{className:"stat-label",children:rt[t].stats_waiting}),u.jsx("span",{className:"stat-value",children:I.enEspera})]})]}),u.jsxs("section",{className:"oc-grid","aria-label":"Contenido principal del dashboard",children:[u.jsx("div",{className:"oc-grid-main",children:u.jsxs("div",{className:"card card-quickcharts",children:[u.jsxs("div",{className:"oc-card-head",style:{display:"flex",justifyContent:"space-between",alignItems:"center",gap:8},children:[u.jsx("h3",{children:"Pacientes registrados  ltimos 7 das"}),u.jsx("span",{className:"oc-muted",style:{marginLeft:8,fontSize:12},children:qe})]}),D.length===0||D.every(Q=>((Q==null?void 0:Q.value)||0)===0)?u.jsx("p",{className:"oc-weekly-empty",children:"Sin pacientes registrados en la ltima semana."}):u.jsx(GU,{data:D})]})}),u.jsxs("aside",{className:"oc-grid-side","aria-label":"Panel lateral",children:[u.jsxs("div",{className:"card",children:[u.jsx("h3",{children:rt[t].n8n_title}),$?u.jsx("span",{className:"oc-muted",children:rt[t].loading}):u.jsx(BU,{status:ke})]}),u.jsxs("div",{className:"card",children:[u.jsxs("div",{className:"oc-card-head",style:{display:"flex",justifyContent:"space-between",alignItems:"center",gap:8},children:[u.jsx("h3",{children:rt[t].todays_appts}),u.jsx("button",{className:"oc-small-link",type:"button",onClick:()=>r("Agenda"),children:rt[t].see_schedule})]}),b?u.jsx("span",{className:"oc-muted",children:rt[t].loading}):x.length===0?u.jsx("p",{className:"oc-muted",children:rt[t].no_appts_today}):u.jsx("ul",{className:"oc-list",children:x.slice(0,5).map(Q=>u.jsxs("li",{className:"oc-list-item",children:[u.jsxs("div",{className:"oc-list-main",children:[u.jsx("b",{children:Q.pacienteNombre||"Paciente"})," ",u.jsxs("span",{className:"oc-muted",children:[rt[t].at," ",WU(Q.fecha,t)]})]}),u.jsx("div",{className:`oc-tag oc-tag-${(Q.estado||"programada").toLowerCase().replace(/\s+/g,"-")}`,children:Q.estado||"programada"})]},Q.id))})]}),u.jsxs("div",{className:"card",children:[u.jsx("h3",{children:rt[t].recent_title}),ce?u.jsx("span",{className:"oc-muted",children:rt[t].loading}):$t.length===0?u.jsx("p",{className:"oc-muted",children:rt[t].recent_empty}):u.jsx(UU,{items:$t})]})]})]}),u.jsxs("footer",{className:"oc-footer",children:[" ",new Date().getFullYear()," OdontoCloud | Creado por Ingeniero Juan Madrid"]})]})]})]})}const XU=()=>{try{const t=JSON.parse(localStorage.getItem("odc_session"));return t&&Date.now()-t.timestamp<1e3*60*60*24?t:null}catch{return null}};function Ap({allowedRoles:t,children:e}){var i;const n=XU();if(!n)return u.jsx(Im,{to:"/",replace:!0});const r=(i=n.rol)==null?void 0:i.toLowerCase();return t.map(s=>s.toLowerCase()).includes(r)?e:u.jsx(Im,{to:"/",replace:!0})}function JU(){return u.jsxs(wN,{children:[u.jsx(To,{path:"/",element:u.jsx(XF,{})}),u.jsx(To,{path:"/dashboard_admin",element:u.jsx(Ap,{allowedRoles:["administrador"],children:u.jsx(Cp,{})})}),u.jsx(To,{path:"/dashboard_doctor",element:u.jsx(Ap,{allowedRoles:["doctor"],children:u.jsx(Cp,{})})}),u.jsx(To,{path:"/dashboard_recepcion",element:u.jsx(Ap,{allowedRoles:["recepcionista"],children:u.jsx(Cp,{})})}),u.jsx(To,{path:"*",element:u.jsx(Im,{to:"/",replace:!0})})]})}async function ZU(){try{await kj(oh,AS),await fM(_e),console.log(" Firebase listo con sesin persistente y modo offline.")}catch(t){console.warn(" Firebase offline/persistencia fall:",t.message)}}const e6="modulepreload",t6=function(t){return"/odontocloud-react/"+t},aT={},n6=function(e,n,r){let i=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),a=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));i=Promise.allSettled(n.map(l=>{if(l=t6(l),l in aT)return;aT[l]=!0;const d=l.endsWith(".css"),h=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${h}`))return;const f=document.createElement("link");if(f.rel=d?"stylesheet":e6,d||(f.as="script"),f.crossOrigin="",f.href=l,a&&f.setAttribute("nonce",a),document.head.appendChild(f),d)return new Promise((m,_)=>{f.addEventListener("load",m),f.addEventListener("error",()=>_(new Error(`Unable to preload CSS for ${l}`)))})}))}function s(o){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=o,window.dispatchEvent(a),!a.defaultPrevented)throw o}return i.then(o=>{for(const a of o||[])a.status==="rejected"&&s(a.reason);return e().catch(s)})};function r6(t={}){const{immediate:e=!1,onNeedRefresh:n,onOfflineReady:r,onRegistered:i,onRegisteredSW:s,onRegisterError:o}=t;let a,l;const d=async(f=!0)=>{await l};async function h(){if("serviceWorker"in navigator){if(a=await n6(async()=>{const{Workbox:f}=await import("./workbox-window.prod.es5-vqzQaGvo.js");return{Workbox:f}},[]).then(({Workbox:f})=>new f("/odontocloud-react/sw.js",{scope:"/odontocloud-react/",type:"classic"})).catch(f=>{o==null||o(f)}),!a)return;a.addEventListener("activated",f=>{(f.isUpdate||f.isExternal)&&window.location.reload()}),a.addEventListener("installed",f=>{f.isUpdate||r==null||r()}),a.register({immediate:e}).then(f=>{s?s("/odontocloud-react/sw.js",f):i==null||i(f)}).catch(f=>{o==null||o(f)})}}return l=h(),d}const i6="/odontocloud-react/";ZU();r6({immediate:!0});Ix(document.getElementById("root")).render(u.jsx(_R.StrictMode,{children:u.jsx(zN,{basename:i6,children:u.jsx(JU,{})})}));
