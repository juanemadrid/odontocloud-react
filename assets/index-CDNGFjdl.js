(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();function v1(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Ax={exports:{}},Rh={},Rx={exports:{}},Ve={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var $c=Symbol.for("react.element"),_1=Symbol.for("react.portal"),w1=Symbol.for("react.fragment"),E1=Symbol.for("react.strict_mode"),I1=Symbol.for("react.profiler"),x1=Symbol.for("react.provider"),T1=Symbol.for("react.context"),b1=Symbol.for("react.forward_ref"),S1=Symbol.for("react.suspense"),C1=Symbol.for("react.memo"),A1=Symbol.for("react.lazy"),N_=Symbol.iterator;function R1(t){return t===null||typeof t!="object"?null:(t=N_&&t[N_]||t["@@iterator"],typeof t=="function"?t:null)}var Nx={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Px=Object.assign,kx={};function qa(t,e,n){this.props=t,this.context=e,this.refs=kx,this.updater=n||Nx}qa.prototype.isReactComponent={};qa.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};qa.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function Dx(){}Dx.prototype=qa.prototype;function bg(t,e,n){this.props=t,this.context=e,this.refs=kx,this.updater=n||Nx}var Sg=bg.prototype=new Dx;Sg.constructor=bg;Px(Sg,qa.prototype);Sg.isPureReactComponent=!0;var P_=Array.isArray,jx=Object.prototype.hasOwnProperty,Cg={current:null},Ox={key:!0,ref:!0,__self:!0,__source:!0};function Lx(t,e,n){var r,s={},i=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(i=""+e.key),e)jx.call(e,r)&&!Ox.hasOwnProperty(r)&&(s[r]=e[r]);var a=arguments.length-2;if(a===1)s.children=n;else if(1<a){for(var c=Array(a),d=0;d<a;d++)c[d]=arguments[d+2];s.children=c}if(t&&t.defaultProps)for(r in a=t.defaultProps,a)s[r]===void 0&&(s[r]=a[r]);return{$$typeof:$c,type:t,key:i,ref:o,props:s,_owner:Cg.current}}function N1(t,e){return{$$typeof:$c,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function Ag(t){return typeof t=="object"&&t!==null&&t.$$typeof===$c}function P1(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var k_=/\/+/g;function Wf(t,e){return typeof t=="object"&&t!==null&&t.key!=null?P1(""+t.key):e.toString(36)}function Xu(t,e,n,r,s){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case $c:case _1:o=!0}}if(o)return o=t,s=s(o),t=r===""?"."+Wf(o,0):r,P_(s)?(n="",t!=null&&(n=t.replace(k_,"$&/")+"/"),Xu(s,e,n,"",function(d){return d})):s!=null&&(Ag(s)&&(s=N1(s,n+(!s.key||o&&o.key===s.key?"":(""+s.key).replace(k_,"$&/")+"/")+t)),e.push(s)),1;if(o=0,r=r===""?".":r+":",P_(t))for(var a=0;a<t.length;a++){i=t[a];var c=r+Wf(i,a);o+=Xu(i,e,n,c,s)}else if(c=R1(t),typeof c=="function")for(t=c.call(t),a=0;!(i=t.next()).done;)i=i.value,c=r+Wf(i,a++),o+=Xu(i,e,n,c,s);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function Eu(t,e,n){if(t==null)return t;var r=[],s=0;return Xu(t,r,"","",function(i){return e.call(n,i,s++)}),r}function k1(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var En={current:null},Ju={transition:null},D1={ReactCurrentDispatcher:En,ReactCurrentBatchConfig:Ju,ReactCurrentOwner:Cg};function Vx(){throw Error("act(...) is not supported in production builds of React.")}Ve.Children={map:Eu,forEach:function(t,e,n){Eu(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return Eu(t,function(){e++}),e},toArray:function(t){return Eu(t,function(e){return e})||[]},only:function(t){if(!Ag(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Ve.Component=qa;Ve.Fragment=w1;Ve.Profiler=I1;Ve.PureComponent=bg;Ve.StrictMode=E1;Ve.Suspense=S1;Ve.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=D1;Ve.act=Vx;Ve.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=Px({},t.props),s=t.key,i=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,o=Cg.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(c in e)jx.call(e,c)&&!Ox.hasOwnProperty(c)&&(r[c]=e[c]===void 0&&a!==void 0?a[c]:e[c])}var c=arguments.length-2;if(c===1)r.children=n;else if(1<c){a=Array(c);for(var d=0;d<c;d++)a[d]=arguments[d+2];r.children=a}return{$$typeof:$c,type:t.type,key:s,ref:i,props:r,_owner:o}};Ve.createContext=function(t){return t={$$typeof:T1,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:x1,_context:t},t.Consumer=t};Ve.createElement=Lx;Ve.createFactory=function(t){var e=Lx.bind(null,t);return e.type=t,e};Ve.createRef=function(){return{current:null}};Ve.forwardRef=function(t){return{$$typeof:b1,render:t}};Ve.isValidElement=Ag;Ve.lazy=function(t){return{$$typeof:A1,_payload:{_status:-1,_result:t},_init:k1}};Ve.memo=function(t,e){return{$$typeof:C1,type:t,compare:e===void 0?null:e}};Ve.startTransition=function(t){var e=Ju.transition;Ju.transition={};try{t()}finally{Ju.transition=e}};Ve.unstable_act=Vx;Ve.useCallback=function(t,e){return En.current.useCallback(t,e)};Ve.useContext=function(t){return En.current.useContext(t)};Ve.useDebugValue=function(){};Ve.useDeferredValue=function(t){return En.current.useDeferredValue(t)};Ve.useEffect=function(t,e){return En.current.useEffect(t,e)};Ve.useId=function(){return En.current.useId()};Ve.useImperativeHandle=function(t,e,n){return En.current.useImperativeHandle(t,e,n)};Ve.useInsertionEffect=function(t,e){return En.current.useInsertionEffect(t,e)};Ve.useLayoutEffect=function(t,e){return En.current.useLayoutEffect(t,e)};Ve.useMemo=function(t,e){return En.current.useMemo(t,e)};Ve.useReducer=function(t,e,n){return En.current.useReducer(t,e,n)};Ve.useRef=function(t){return En.current.useRef(t)};Ve.useState=function(t){return En.current.useState(t)};Ve.useSyncExternalStore=function(t,e,n){return En.current.useSyncExternalStore(t,e,n)};Ve.useTransition=function(){return En.current.useTransition()};Ve.version="18.3.1";Rx.exports=Ve;var A=Rx.exports;const Mx=v1(A);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var j1=A,O1=Symbol.for("react.element"),L1=Symbol.for("react.fragment"),V1=Object.prototype.hasOwnProperty,M1=j1.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,F1={key:!0,ref:!0,__self:!0,__source:!0};function Fx(t,e,n){var r,s={},i=null,o=null;n!==void 0&&(i=""+n),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)V1.call(e,r)&&!F1.hasOwnProperty(r)&&(s[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)s[r]===void 0&&(s[r]=e[r]);return{$$typeof:O1,type:t,key:i,ref:o,props:s,_owner:M1.current}}Rh.Fragment=L1;Rh.jsx=Fx;Rh.jsxs=Fx;Ax.exports=Rh;var l=Ax.exports,Ux={exports:{}},Gn={},$x={exports:{}},Bx={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(ee,he){var me=ee.length;ee.push(he);e:for(;0<me;){var ke=me-1>>>1,Ye=ee[ke];if(0<s(Ye,he))ee[ke]=he,ee[me]=Ye,me=ke;else break e}}function n(ee){return ee.length===0?null:ee[0]}function r(ee){if(ee.length===0)return null;var he=ee[0],me=ee.pop();if(me!==he){ee[0]=me;e:for(var ke=0,Ye=ee.length,jt=Ye>>>1;ke<jt;){var U=2*(ke+1)-1,ne=ee[U],ce=U+1,Te=ee[ce];if(0>s(ne,me))ce<Ye&&0>s(Te,ne)?(ee[ke]=Te,ee[ce]=me,ke=ce):(ee[ke]=ne,ee[U]=me,ke=U);else if(ce<Ye&&0>s(Te,me))ee[ke]=Te,ee[ce]=me,ke=ce;else break e}}return he}function s(ee,he){var me=ee.sortIndex-he.sortIndex;return me!==0?me:ee.id-he.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var c=[],d=[],h=1,f=null,m=3,_=!1,R=!1,C=!1,N=typeof setTimeout=="function"?setTimeout:null,T=typeof clearTimeout=="function"?clearTimeout:null,y=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function v(ee){for(var he=n(d);he!==null;){if(he.callback===null)r(d);else if(he.startTime<=ee)r(d),he.sortIndex=he.expirationTime,e(c,he);else break;he=n(d)}}function E(ee){if(C=!1,v(ee),!R)if(n(c)!==null)R=!0,$t(O);else{var he=n(d);he!==null&&hn(E,he.startTime-ee)}}function O(ee,he){R=!1,C&&(C=!1,T(I),I=-1),_=!0;var me=m;try{for(v(he),f=n(c);f!==null&&(!(f.expirationTime>he)||ee&&!D());){var ke=f.callback;if(typeof ke=="function"){f.callback=null,m=f.priorityLevel;var Ye=ke(f.expirationTime<=he);he=t.unstable_now(),typeof Ye=="function"?f.callback=Ye:f===n(c)&&r(c),v(he)}else r(c);f=n(c)}if(f!==null)var jt=!0;else{var U=n(d);U!==null&&hn(E,U.startTime-he),jt=!1}return jt}finally{f=null,m=me,_=!1}}var F=!1,x=null,I=-1,w=5,P=-1;function D(){return!(t.unstable_now()-P<w)}function j(){if(x!==null){var ee=t.unstable_now();P=ee;var he=!0;try{he=x(!0,ee)}finally{he?k():(F=!1,x=null)}}else F=!1}var k;if(typeof y=="function")k=function(){y(j)};else if(typeof MessageChannel<"u"){var K=new MessageChannel,Ge=K.port2;K.port1.onmessage=j,k=function(){Ge.postMessage(null)}}else k=function(){N(j,0)};function $t(ee){x=ee,F||(F=!0,k())}function hn(ee,he){I=N(function(){ee(t.unstable_now())},he)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(ee){ee.callback=null},t.unstable_continueExecution=function(){R||_||(R=!0,$t(O))},t.unstable_forceFrameRate=function(ee){0>ee||125<ee?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):w=0<ee?Math.floor(1e3/ee):5},t.unstable_getCurrentPriorityLevel=function(){return m},t.unstable_getFirstCallbackNode=function(){return n(c)},t.unstable_next=function(ee){switch(m){case 1:case 2:case 3:var he=3;break;default:he=m}var me=m;m=he;try{return ee()}finally{m=me}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(ee,he){switch(ee){case 1:case 2:case 3:case 4:case 5:break;default:ee=3}var me=m;m=ee;try{return he()}finally{m=me}},t.unstable_scheduleCallback=function(ee,he,me){var ke=t.unstable_now();switch(typeof me=="object"&&me!==null?(me=me.delay,me=typeof me=="number"&&0<me?ke+me:ke):me=ke,ee){case 1:var Ye=-1;break;case 2:Ye=250;break;case 5:Ye=1073741823;break;case 4:Ye=1e4;break;default:Ye=5e3}return Ye=me+Ye,ee={id:h++,callback:he,priorityLevel:ee,startTime:me,expirationTime:Ye,sortIndex:-1},me>ke?(ee.sortIndex=me,e(d,ee),n(c)===null&&ee===n(d)&&(C?(T(I),I=-1):C=!0,hn(E,me-ke))):(ee.sortIndex=Ye,e(c,ee),R||_||(R=!0,$t(O))),ee},t.unstable_shouldYield=D,t.unstable_wrapCallback=function(ee){var he=m;return function(){var me=m;m=he;try{return ee.apply(this,arguments)}finally{m=me}}}})(Bx);$x.exports=Bx;var U1=$x.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var $1=A,Hn=U1;function G(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var zx=new Set,cc={};function Io(t,e){Ia(t,e),Ia(t+"Capture",e)}function Ia(t,e){for(cc[t]=e,t=0;t<e.length;t++)zx.add(e[t])}var us=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Qp=Object.prototype.hasOwnProperty,B1=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,D_={},j_={};function z1(t){return Qp.call(j_,t)?!0:Qp.call(D_,t)?!1:B1.test(t)?j_[t]=!0:(D_[t]=!0,!1)}function q1(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function H1(t,e,n,r){if(e===null||typeof e>"u"||q1(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function In(t,e,n,r,s,i,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=o}var Zt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Zt[t]=new In(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Zt[e]=new In(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Zt[t]=new In(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Zt[t]=new In(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Zt[t]=new In(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Zt[t]=new In(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Zt[t]=new In(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Zt[t]=new In(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Zt[t]=new In(t,5,!1,t.toLowerCase(),null,!1,!1)});var Rg=/[\-:]([a-z])/g;function Ng(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Rg,Ng);Zt[e]=new In(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Rg,Ng);Zt[e]=new In(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Rg,Ng);Zt[e]=new In(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Zt[t]=new In(t,1,!1,t.toLowerCase(),null,!1,!1)});Zt.xlinkHref=new In("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Zt[t]=new In(t,1,!1,t.toLowerCase(),null,!0,!0)});function Pg(t,e,n,r){var s=Zt.hasOwnProperty(e)?Zt[e]:null;(s!==null?s.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(H1(e,n,s,r)&&(n=null),r||s===null?z1(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):s.mustUseProperty?t[s.propertyName]=n===null?s.type===3?!1:"":n:(e=s.attributeName,r=s.attributeNamespace,n===null?t.removeAttribute(e):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var ws=$1.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Iu=Symbol.for("react.element"),Yo=Symbol.for("react.portal"),Xo=Symbol.for("react.fragment"),kg=Symbol.for("react.strict_mode"),Yp=Symbol.for("react.profiler"),qx=Symbol.for("react.provider"),Hx=Symbol.for("react.context"),Dg=Symbol.for("react.forward_ref"),Xp=Symbol.for("react.suspense"),Jp=Symbol.for("react.suspense_list"),jg=Symbol.for("react.memo"),Ls=Symbol.for("react.lazy"),Wx=Symbol.for("react.offscreen"),O_=Symbol.iterator;function fl(t){return t===null||typeof t!="object"?null:(t=O_&&t[O_]||t["@@iterator"],typeof t=="function"?t:null)}var vt=Object.assign,Gf;function Pl(t){if(Gf===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);Gf=e&&e[1]||""}return`
`+Gf+t}var Kf=!1;function Qf(t,e){if(!t||Kf)return"";Kf=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(d){var r=d}Reflect.construct(t,[],e)}else{try{e.call()}catch(d){r=d}t.call(e.prototype)}else{try{throw Error()}catch(d){r=d}t()}}catch(d){if(d&&r&&typeof d.stack=="string"){for(var s=d.stack.split(`
`),i=r.stack.split(`
`),o=s.length-1,a=i.length-1;1<=o&&0<=a&&s[o]!==i[a];)a--;for(;1<=o&&0<=a;o--,a--)if(s[o]!==i[a]){if(o!==1||a!==1)do if(o--,a--,0>a||s[o]!==i[a]){var c=`
`+s[o].replace(" at new "," at ");return t.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",t.displayName)),c}while(1<=o&&0<=a);break}}}finally{Kf=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Pl(t):""}function W1(t){switch(t.tag){case 5:return Pl(t.type);case 16:return Pl("Lazy");case 13:return Pl("Suspense");case 19:return Pl("SuspenseList");case 0:case 2:case 15:return t=Qf(t.type,!1),t;case 11:return t=Qf(t.type.render,!1),t;case 1:return t=Qf(t.type,!0),t;default:return""}}function Zp(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Xo:return"Fragment";case Yo:return"Portal";case Yp:return"Profiler";case kg:return"StrictMode";case Xp:return"Suspense";case Jp:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case Hx:return(t.displayName||"Context")+".Consumer";case qx:return(t._context.displayName||"Context")+".Provider";case Dg:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case jg:return e=t.displayName||null,e!==null?e:Zp(t.type)||"Memo";case Ls:e=t._payload,t=t._init;try{return Zp(t(e))}catch{}}return null}function G1(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Zp(e);case 8:return e===kg?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function di(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function Gx(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function K1(t){var e=Gx(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,i=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(o){r=""+o,i.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function xu(t){t._valueTracker||(t._valueTracker=K1(t))}function Kx(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=Gx(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function Cd(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function em(t,e){var n=e.checked;return vt({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function L_(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=di(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function Qx(t,e){e=e.checked,e!=null&&Pg(t,"checked",e,!1)}function tm(t,e){Qx(t,e);var n=di(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?nm(t,e.type,n):e.hasOwnProperty("defaultValue")&&nm(t,e.type,di(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function V_(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function nm(t,e,n){(e!=="number"||Cd(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var kl=Array.isArray;function ca(t,e,n,r){if(t=t.options,e){e={};for(var s=0;s<n.length;s++)e["$"+n[s]]=!0;for(n=0;n<t.length;n++)s=e.hasOwnProperty("$"+t[n].value),t[n].selected!==s&&(t[n].selected=s),s&&r&&(t[n].defaultSelected=!0)}else{for(n=""+di(n),e=null,s=0;s<t.length;s++){if(t[s].value===n){t[s].selected=!0,r&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function rm(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(G(91));return vt({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function M_(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(G(92));if(kl(n)){if(1<n.length)throw Error(G(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:di(n)}}function Yx(t,e){var n=di(e.value),r=di(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function F_(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function Xx(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function sm(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?Xx(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Tu,Jx=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,s){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Tu=Tu||document.createElement("div"),Tu.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Tu.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function uc(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var ql={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Q1=["Webkit","ms","Moz","O"];Object.keys(ql).forEach(function(t){Q1.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),ql[e]=ql[t]})});function Zx(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||ql.hasOwnProperty(t)&&ql[t]?(""+e).trim():e+"px"}function eT(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=Zx(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,s):t[n]=s}}var Y1=vt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function im(t,e){if(e){if(Y1[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(G(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(G(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(G(61))}if(e.style!=null&&typeof e.style!="object")throw Error(G(62))}}function om(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var am=null;function Og(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var lm=null,ua=null,da=null;function U_(t){if(t=qc(t)){if(typeof lm!="function")throw Error(G(280));var e=t.stateNode;e&&(e=jh(e),lm(t.stateNode,t.type,e))}}function tT(t){ua?da?da.push(t):da=[t]:ua=t}function nT(){if(ua){var t=ua,e=da;if(da=ua=null,U_(t),e)for(t=0;t<e.length;t++)U_(e[t])}}function rT(t,e){return t(e)}function sT(){}var Yf=!1;function iT(t,e,n){if(Yf)return t(e,n);Yf=!0;try{return rT(t,e,n)}finally{Yf=!1,(ua!==null||da!==null)&&(sT(),nT())}}function dc(t,e){var n=t.stateNode;if(n===null)return null;var r=jh(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(G(231,e,typeof n));return n}var cm=!1;if(us)try{var pl={};Object.defineProperty(pl,"passive",{get:function(){cm=!0}}),window.addEventListener("test",pl,pl),window.removeEventListener("test",pl,pl)}catch{cm=!1}function X1(t,e,n,r,s,i,o,a,c){var d=Array.prototype.slice.call(arguments,3);try{e.apply(n,d)}catch(h){this.onError(h)}}var Hl=!1,Ad=null,Rd=!1,um=null,J1={onError:function(t){Hl=!0,Ad=t}};function Z1(t,e,n,r,s,i,o,a,c){Hl=!1,Ad=null,X1.apply(J1,arguments)}function eR(t,e,n,r,s,i,o,a,c){if(Z1.apply(this,arguments),Hl){if(Hl){var d=Ad;Hl=!1,Ad=null}else throw Error(G(198));Rd||(Rd=!0,um=d)}}function xo(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function oT(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function $_(t){if(xo(t)!==t)throw Error(G(188))}function tR(t){var e=t.alternate;if(!e){if(e=xo(t),e===null)throw Error(G(188));return e!==t?null:t}for(var n=t,r=e;;){var s=n.return;if(s===null)break;var i=s.alternate;if(i===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===n)return $_(s),t;if(i===r)return $_(s),e;i=i.sibling}throw Error(G(188))}if(n.return!==r.return)n=s,r=i;else{for(var o=!1,a=s.child;a;){if(a===n){o=!0,n=s,r=i;break}if(a===r){o=!0,r=s,n=i;break}a=a.sibling}if(!o){for(a=i.child;a;){if(a===n){o=!0,n=i,r=s;break}if(a===r){o=!0,r=i,n=s;break}a=a.sibling}if(!o)throw Error(G(189))}}if(n.alternate!==r)throw Error(G(190))}if(n.tag!==3)throw Error(G(188));return n.stateNode.current===n?t:e}function aT(t){return t=tR(t),t!==null?lT(t):null}function lT(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=lT(t);if(e!==null)return e;t=t.sibling}return null}var cT=Hn.unstable_scheduleCallback,B_=Hn.unstable_cancelCallback,nR=Hn.unstable_shouldYield,rR=Hn.unstable_requestPaint,bt=Hn.unstable_now,sR=Hn.unstable_getCurrentPriorityLevel,Lg=Hn.unstable_ImmediatePriority,uT=Hn.unstable_UserBlockingPriority,Nd=Hn.unstable_NormalPriority,iR=Hn.unstable_LowPriority,dT=Hn.unstable_IdlePriority,Nh=null,qr=null;function oR(t){if(qr&&typeof qr.onCommitFiberRoot=="function")try{qr.onCommitFiberRoot(Nh,t,void 0,(t.current.flags&128)===128)}catch{}}var _r=Math.clz32?Math.clz32:cR,aR=Math.log,lR=Math.LN2;function cR(t){return t>>>=0,t===0?32:31-(aR(t)/lR|0)|0}var bu=64,Su=4194304;function Dl(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Pd(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,s=t.suspendedLanes,i=t.pingedLanes,o=n&268435455;if(o!==0){var a=o&~s;a!==0?r=Dl(a):(i&=o,i!==0&&(r=Dl(i)))}else o=n&~s,o!==0?r=Dl(o):i!==0&&(r=Dl(i));if(r===0)return 0;if(e!==0&&e!==r&&!(e&s)&&(s=r&-r,i=e&-e,s>=i||s===16&&(i&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-_r(e),s=1<<n,r|=t[n],e&=~s;return r}function uR(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function dR(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,s=t.expirationTimes,i=t.pendingLanes;0<i;){var o=31-_r(i),a=1<<o,c=s[o];c===-1?(!(a&n)||a&r)&&(s[o]=uR(a,e)):c<=e&&(t.expiredLanes|=a),i&=~a}}function dm(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function hT(){var t=bu;return bu<<=1,!(bu&4194240)&&(bu=64),t}function Xf(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Bc(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-_r(e),t[e]=n}function hR(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var s=31-_r(n),i=1<<s;e[s]=0,r[s]=-1,t[s]=-1,n&=~i}}function Vg(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-_r(n),s=1<<r;s&e|t[r]&e&&(t[r]|=e),n&=~s}}var Ze=0;function fT(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var pT,Mg,mT,gT,yT,hm=!1,Cu=[],Ys=null,Xs=null,Js=null,hc=new Map,fc=new Map,Ms=[],fR="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function z_(t,e){switch(t){case"focusin":case"focusout":Ys=null;break;case"dragenter":case"dragleave":Xs=null;break;case"mouseover":case"mouseout":Js=null;break;case"pointerover":case"pointerout":hc.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":fc.delete(e.pointerId)}}function ml(t,e,n,r,s,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[s]},e!==null&&(e=qc(e),e!==null&&Mg(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function pR(t,e,n,r,s){switch(e){case"focusin":return Ys=ml(Ys,t,e,n,r,s),!0;case"dragenter":return Xs=ml(Xs,t,e,n,r,s),!0;case"mouseover":return Js=ml(Js,t,e,n,r,s),!0;case"pointerover":var i=s.pointerId;return hc.set(i,ml(hc.get(i)||null,t,e,n,r,s)),!0;case"gotpointercapture":return i=s.pointerId,fc.set(i,ml(fc.get(i)||null,t,e,n,r,s)),!0}return!1}function vT(t){var e=zi(t.target);if(e!==null){var n=xo(e);if(n!==null){if(e=n.tag,e===13){if(e=oT(n),e!==null){t.blockedOn=e,yT(t.priority,function(){mT(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Zu(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=fm(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);am=r,n.target.dispatchEvent(r),am=null}else return e=qc(n),e!==null&&Mg(e),t.blockedOn=n,!1;e.shift()}return!0}function q_(t,e,n){Zu(t)&&n.delete(e)}function mR(){hm=!1,Ys!==null&&Zu(Ys)&&(Ys=null),Xs!==null&&Zu(Xs)&&(Xs=null),Js!==null&&Zu(Js)&&(Js=null),hc.forEach(q_),fc.forEach(q_)}function gl(t,e){t.blockedOn===e&&(t.blockedOn=null,hm||(hm=!0,Hn.unstable_scheduleCallback(Hn.unstable_NormalPriority,mR)))}function pc(t){function e(s){return gl(s,t)}if(0<Cu.length){gl(Cu[0],t);for(var n=1;n<Cu.length;n++){var r=Cu[n];r.blockedOn===t&&(r.blockedOn=null)}}for(Ys!==null&&gl(Ys,t),Xs!==null&&gl(Xs,t),Js!==null&&gl(Js,t),hc.forEach(e),fc.forEach(e),n=0;n<Ms.length;n++)r=Ms[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<Ms.length&&(n=Ms[0],n.blockedOn===null);)vT(n),n.blockedOn===null&&Ms.shift()}var ha=ws.ReactCurrentBatchConfig,kd=!0;function gR(t,e,n,r){var s=Ze,i=ha.transition;ha.transition=null;try{Ze=1,Fg(t,e,n,r)}finally{Ze=s,ha.transition=i}}function yR(t,e,n,r){var s=Ze,i=ha.transition;ha.transition=null;try{Ze=4,Fg(t,e,n,r)}finally{Ze=s,ha.transition=i}}function Fg(t,e,n,r){if(kd){var s=fm(t,e,n,r);if(s===null)ap(t,e,r,Dd,n),z_(t,r);else if(pR(s,t,e,n,r))r.stopPropagation();else if(z_(t,r),e&4&&-1<fR.indexOf(t)){for(;s!==null;){var i=qc(s);if(i!==null&&pT(i),i=fm(t,e,n,r),i===null&&ap(t,e,r,Dd,n),i===s)break;s=i}s!==null&&r.stopPropagation()}else ap(t,e,r,null,n)}}var Dd=null;function fm(t,e,n,r){if(Dd=null,t=Og(r),t=zi(t),t!==null)if(e=xo(t),e===null)t=null;else if(n=e.tag,n===13){if(t=oT(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Dd=t,null}function _T(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(sR()){case Lg:return 1;case uT:return 4;case Nd:case iR:return 16;case dT:return 536870912;default:return 16}default:return 16}}var Gs=null,Ug=null,ed=null;function wT(){if(ed)return ed;var t,e=Ug,n=e.length,r,s="value"in Gs?Gs.value:Gs.textContent,i=s.length;for(t=0;t<n&&e[t]===s[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===s[i-r];r++);return ed=s.slice(t,1<r?1-r:void 0)}function td(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Au(){return!0}function H_(){return!1}function Kn(t){function e(n,r,s,i,o){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(n=t[a],this[a]=n?n(i):i[a]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?Au:H_,this.isPropagationStopped=H_,this}return vt(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Au)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Au)},persist:function(){},isPersistent:Au}),e}var Ha={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},$g=Kn(Ha),zc=vt({},Ha,{view:0,detail:0}),vR=Kn(zc),Jf,Zf,yl,Ph=vt({},zc,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Bg,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==yl&&(yl&&t.type==="mousemove"?(Jf=t.screenX-yl.screenX,Zf=t.screenY-yl.screenY):Zf=Jf=0,yl=t),Jf)},movementY:function(t){return"movementY"in t?t.movementY:Zf}}),W_=Kn(Ph),_R=vt({},Ph,{dataTransfer:0}),wR=Kn(_R),ER=vt({},zc,{relatedTarget:0}),ep=Kn(ER),IR=vt({},Ha,{animationName:0,elapsedTime:0,pseudoElement:0}),xR=Kn(IR),TR=vt({},Ha,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),bR=Kn(TR),SR=vt({},Ha,{data:0}),G_=Kn(SR),CR={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},AR={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},RR={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function NR(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=RR[t])?!!e[t]:!1}function Bg(){return NR}var PR=vt({},zc,{key:function(t){if(t.key){var e=CR[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=td(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?AR[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Bg,charCode:function(t){return t.type==="keypress"?td(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?td(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),kR=Kn(PR),DR=vt({},Ph,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),K_=Kn(DR),jR=vt({},zc,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Bg}),OR=Kn(jR),LR=vt({},Ha,{propertyName:0,elapsedTime:0,pseudoElement:0}),VR=Kn(LR),MR=vt({},Ph,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),FR=Kn(MR),UR=[9,13,27,32],zg=us&&"CompositionEvent"in window,Wl=null;us&&"documentMode"in document&&(Wl=document.documentMode);var $R=us&&"TextEvent"in window&&!Wl,ET=us&&(!zg||Wl&&8<Wl&&11>=Wl),Q_=" ",Y_=!1;function IT(t,e){switch(t){case"keyup":return UR.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function xT(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Jo=!1;function BR(t,e){switch(t){case"compositionend":return xT(e);case"keypress":return e.which!==32?null:(Y_=!0,Q_);case"textInput":return t=e.data,t===Q_&&Y_?null:t;default:return null}}function zR(t,e){if(Jo)return t==="compositionend"||!zg&&IT(t,e)?(t=wT(),ed=Ug=Gs=null,Jo=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return ET&&e.locale!=="ko"?null:e.data;default:return null}}var qR={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function X_(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!qR[t.type]:e==="textarea"}function TT(t,e,n,r){tT(r),e=jd(e,"onChange"),0<e.length&&(n=new $g("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var Gl=null,mc=null;function HR(t){OT(t,0)}function kh(t){var e=ta(t);if(Kx(e))return t}function WR(t,e){if(t==="change")return e}var bT=!1;if(us){var tp;if(us){var np="oninput"in document;if(!np){var J_=document.createElement("div");J_.setAttribute("oninput","return;"),np=typeof J_.oninput=="function"}tp=np}else tp=!1;bT=tp&&(!document.documentMode||9<document.documentMode)}function Z_(){Gl&&(Gl.detachEvent("onpropertychange",ST),mc=Gl=null)}function ST(t){if(t.propertyName==="value"&&kh(mc)){var e=[];TT(e,mc,t,Og(t)),iT(HR,e)}}function GR(t,e,n){t==="focusin"?(Z_(),Gl=e,mc=n,Gl.attachEvent("onpropertychange",ST)):t==="focusout"&&Z_()}function KR(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return kh(mc)}function QR(t,e){if(t==="click")return kh(e)}function YR(t,e){if(t==="input"||t==="change")return kh(e)}function XR(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Ir=typeof Object.is=="function"?Object.is:XR;function gc(t,e){if(Ir(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!Qp.call(e,s)||!Ir(t[s],e[s]))return!1}return!0}function ew(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function tw(t,e){var n=ew(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=ew(n)}}function CT(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?CT(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function AT(){for(var t=window,e=Cd();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=Cd(t.document)}return e}function qg(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function JR(t){var e=AT(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&CT(n.ownerDocument.documentElement,n)){if(r!==null&&qg(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=n.textContent.length,i=Math.min(r.start,s);r=r.end===void 0?i:Math.min(r.end,s),!t.extend&&i>r&&(s=r,r=i,i=s),s=tw(n,i);var o=tw(n,r);s&&o&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),i>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var ZR=us&&"documentMode"in document&&11>=document.documentMode,Zo=null,pm=null,Kl=null,mm=!1;function nw(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;mm||Zo==null||Zo!==Cd(r)||(r=Zo,"selectionStart"in r&&qg(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Kl&&gc(Kl,r)||(Kl=r,r=jd(pm,"onSelect"),0<r.length&&(e=new $g("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=Zo)))}function Ru(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var ea={animationend:Ru("Animation","AnimationEnd"),animationiteration:Ru("Animation","AnimationIteration"),animationstart:Ru("Animation","AnimationStart"),transitionend:Ru("Transition","TransitionEnd")},rp={},RT={};us&&(RT=document.createElement("div").style,"AnimationEvent"in window||(delete ea.animationend.animation,delete ea.animationiteration.animation,delete ea.animationstart.animation),"TransitionEvent"in window||delete ea.transitionend.transition);function Dh(t){if(rp[t])return rp[t];if(!ea[t])return t;var e=ea[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in RT)return rp[t]=e[n];return t}var NT=Dh("animationend"),PT=Dh("animationiteration"),kT=Dh("animationstart"),DT=Dh("transitionend"),jT=new Map,rw="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function vi(t,e){jT.set(t,e),Io(e,[t])}for(var sp=0;sp<rw.length;sp++){var ip=rw[sp],eN=ip.toLowerCase(),tN=ip[0].toUpperCase()+ip.slice(1);vi(eN,"on"+tN)}vi(NT,"onAnimationEnd");vi(PT,"onAnimationIteration");vi(kT,"onAnimationStart");vi("dblclick","onDoubleClick");vi("focusin","onFocus");vi("focusout","onBlur");vi(DT,"onTransitionEnd");Ia("onMouseEnter",["mouseout","mouseover"]);Ia("onMouseLeave",["mouseout","mouseover"]);Ia("onPointerEnter",["pointerout","pointerover"]);Ia("onPointerLeave",["pointerout","pointerover"]);Io("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Io("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Io("onBeforeInput",["compositionend","keypress","textInput","paste"]);Io("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Io("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Io("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var jl="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),nN=new Set("cancel close invalid load scroll toggle".split(" ").concat(jl));function sw(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,eR(r,e,void 0,t),t.currentTarget=null}function OT(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],s=r.event;r=r.listeners;e:{var i=void 0;if(e)for(var o=r.length-1;0<=o;o--){var a=r[o],c=a.instance,d=a.currentTarget;if(a=a.listener,c!==i&&s.isPropagationStopped())break e;sw(s,a,d),i=c}else for(o=0;o<r.length;o++){if(a=r[o],c=a.instance,d=a.currentTarget,a=a.listener,c!==i&&s.isPropagationStopped())break e;sw(s,a,d),i=c}}}if(Rd)throw t=um,Rd=!1,um=null,t}function lt(t,e){var n=e[wm];n===void 0&&(n=e[wm]=new Set);var r=t+"__bubble";n.has(r)||(LT(e,t,2,!1),n.add(r))}function op(t,e,n){var r=0;e&&(r|=4),LT(n,t,r,e)}var Nu="_reactListening"+Math.random().toString(36).slice(2);function yc(t){if(!t[Nu]){t[Nu]=!0,zx.forEach(function(n){n!=="selectionchange"&&(nN.has(n)||op(n,!1,t),op(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Nu]||(e[Nu]=!0,op("selectionchange",!1,e))}}function LT(t,e,n,r){switch(_T(e)){case 1:var s=gR;break;case 4:s=yR;break;default:s=Fg}n=s.bind(null,e,n,t),s=void 0,!cm||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),r?s!==void 0?t.addEventListener(e,n,{capture:!0,passive:s}):t.addEventListener(e,n,!0):s!==void 0?t.addEventListener(e,n,{passive:s}):t.addEventListener(e,n,!1)}function ap(t,e,n,r,s){var i=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var a=r.stateNode.containerInfo;if(a===s||a.nodeType===8&&a.parentNode===s)break;if(o===4)for(o=r.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===s||c.nodeType===8&&c.parentNode===s))return;o=o.return}for(;a!==null;){if(o=zi(a),o===null)return;if(c=o.tag,c===5||c===6){r=i=o;continue e}a=a.parentNode}}r=r.return}iT(function(){var d=i,h=Og(n),f=[];e:{var m=jT.get(t);if(m!==void 0){var _=$g,R=t;switch(t){case"keypress":if(td(n)===0)break e;case"keydown":case"keyup":_=kR;break;case"focusin":R="focus",_=ep;break;case"focusout":R="blur",_=ep;break;case"beforeblur":case"afterblur":_=ep;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":_=W_;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":_=wR;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":_=OR;break;case NT:case PT:case kT:_=xR;break;case DT:_=VR;break;case"scroll":_=vR;break;case"wheel":_=FR;break;case"copy":case"cut":case"paste":_=bR;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":_=K_}var C=(e&4)!==0,N=!C&&t==="scroll",T=C?m!==null?m+"Capture":null:m;C=[];for(var y=d,v;y!==null;){v=y;var E=v.stateNode;if(v.tag===5&&E!==null&&(v=E,T!==null&&(E=dc(y,T),E!=null&&C.push(vc(y,E,v)))),N)break;y=y.return}0<C.length&&(m=new _(m,R,null,n,h),f.push({event:m,listeners:C}))}}if(!(e&7)){e:{if(m=t==="mouseover"||t==="pointerover",_=t==="mouseout"||t==="pointerout",m&&n!==am&&(R=n.relatedTarget||n.fromElement)&&(zi(R)||R[ds]))break e;if((_||m)&&(m=h.window===h?h:(m=h.ownerDocument)?m.defaultView||m.parentWindow:window,_?(R=n.relatedTarget||n.toElement,_=d,R=R?zi(R):null,R!==null&&(N=xo(R),R!==N||R.tag!==5&&R.tag!==6)&&(R=null)):(_=null,R=d),_!==R)){if(C=W_,E="onMouseLeave",T="onMouseEnter",y="mouse",(t==="pointerout"||t==="pointerover")&&(C=K_,E="onPointerLeave",T="onPointerEnter",y="pointer"),N=_==null?m:ta(_),v=R==null?m:ta(R),m=new C(E,y+"leave",_,n,h),m.target=N,m.relatedTarget=v,E=null,zi(h)===d&&(C=new C(T,y+"enter",R,n,h),C.target=v,C.relatedTarget=N,E=C),N=E,_&&R)t:{for(C=_,T=R,y=0,v=C;v;v=ko(v))y++;for(v=0,E=T;E;E=ko(E))v++;for(;0<y-v;)C=ko(C),y--;for(;0<v-y;)T=ko(T),v--;for(;y--;){if(C===T||T!==null&&C===T.alternate)break t;C=ko(C),T=ko(T)}C=null}else C=null;_!==null&&iw(f,m,_,C,!1),R!==null&&N!==null&&iw(f,N,R,C,!0)}}e:{if(m=d?ta(d):window,_=m.nodeName&&m.nodeName.toLowerCase(),_==="select"||_==="input"&&m.type==="file")var O=WR;else if(X_(m))if(bT)O=YR;else{O=KR;var F=GR}else(_=m.nodeName)&&_.toLowerCase()==="input"&&(m.type==="checkbox"||m.type==="radio")&&(O=QR);if(O&&(O=O(t,d))){TT(f,O,n,h);break e}F&&F(t,m,d),t==="focusout"&&(F=m._wrapperState)&&F.controlled&&m.type==="number"&&nm(m,"number",m.value)}switch(F=d?ta(d):window,t){case"focusin":(X_(F)||F.contentEditable==="true")&&(Zo=F,pm=d,Kl=null);break;case"focusout":Kl=pm=Zo=null;break;case"mousedown":mm=!0;break;case"contextmenu":case"mouseup":case"dragend":mm=!1,nw(f,n,h);break;case"selectionchange":if(ZR)break;case"keydown":case"keyup":nw(f,n,h)}var x;if(zg)e:{switch(t){case"compositionstart":var I="onCompositionStart";break e;case"compositionend":I="onCompositionEnd";break e;case"compositionupdate":I="onCompositionUpdate";break e}I=void 0}else Jo?IT(t,n)&&(I="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(I="onCompositionStart");I&&(ET&&n.locale!=="ko"&&(Jo||I!=="onCompositionStart"?I==="onCompositionEnd"&&Jo&&(x=wT()):(Gs=h,Ug="value"in Gs?Gs.value:Gs.textContent,Jo=!0)),F=jd(d,I),0<F.length&&(I=new G_(I,t,null,n,h),f.push({event:I,listeners:F}),x?I.data=x:(x=xT(n),x!==null&&(I.data=x)))),(x=$R?BR(t,n):zR(t,n))&&(d=jd(d,"onBeforeInput"),0<d.length&&(h=new G_("onBeforeInput","beforeinput",null,n,h),f.push({event:h,listeners:d}),h.data=x))}OT(f,e)})}function vc(t,e,n){return{instance:t,listener:e,currentTarget:n}}function jd(t,e){for(var n=e+"Capture",r=[];t!==null;){var s=t,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=dc(t,n),i!=null&&r.unshift(vc(t,i,s)),i=dc(t,e),i!=null&&r.push(vc(t,i,s))),t=t.return}return r}function ko(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function iw(t,e,n,r,s){for(var i=e._reactName,o=[];n!==null&&n!==r;){var a=n,c=a.alternate,d=a.stateNode;if(c!==null&&c===r)break;a.tag===5&&d!==null&&(a=d,s?(c=dc(n,i),c!=null&&o.unshift(vc(n,c,a))):s||(c=dc(n,i),c!=null&&o.push(vc(n,c,a)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var rN=/\r\n?/g,sN=/\u0000|\uFFFD/g;function ow(t){return(typeof t=="string"?t:""+t).replace(rN,`
`).replace(sN,"")}function Pu(t,e,n){if(e=ow(e),ow(t)!==e&&n)throw Error(G(425))}function Od(){}var gm=null,ym=null;function vm(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var _m=typeof setTimeout=="function"?setTimeout:void 0,iN=typeof clearTimeout=="function"?clearTimeout:void 0,aw=typeof Promise=="function"?Promise:void 0,oN=typeof queueMicrotask=="function"?queueMicrotask:typeof aw<"u"?function(t){return aw.resolve(null).then(t).catch(aN)}:_m;function aN(t){setTimeout(function(){throw t})}function lp(t,e){var n=e,r=0;do{var s=n.nextSibling;if(t.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){t.removeChild(s),pc(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);pc(e)}function Zs(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function lw(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var Wa=Math.random().toString(36).slice(2),Fr="__reactFiber$"+Wa,_c="__reactProps$"+Wa,ds="__reactContainer$"+Wa,wm="__reactEvents$"+Wa,lN="__reactListeners$"+Wa,cN="__reactHandles$"+Wa;function zi(t){var e=t[Fr];if(e)return e;for(var n=t.parentNode;n;){if(e=n[ds]||n[Fr]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=lw(t);t!==null;){if(n=t[Fr])return n;t=lw(t)}return e}t=n,n=t.parentNode}return null}function qc(t){return t=t[Fr]||t[ds],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function ta(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(G(33))}function jh(t){return t[_c]||null}var Em=[],na=-1;function _i(t){return{current:t}}function ct(t){0>na||(t.current=Em[na],Em[na]=null,na--)}function ot(t,e){na++,Em[na]=t.current,t.current=e}var hi={},dn=_i(hi),Rn=_i(!1),no=hi;function xa(t,e){var n=t.type.contextTypes;if(!n)return hi;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in n)s[i]=e[i];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function Nn(t){return t=t.childContextTypes,t!=null}function Ld(){ct(Rn),ct(dn)}function cw(t,e,n){if(dn.current!==hi)throw Error(G(168));ot(dn,e),ot(Rn,n)}function VT(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in e))throw Error(G(108,G1(t)||"Unknown",s));return vt({},n,r)}function Vd(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||hi,no=dn.current,ot(dn,t),ot(Rn,Rn.current),!0}function uw(t,e,n){var r=t.stateNode;if(!r)throw Error(G(169));n?(t=VT(t,e,no),r.__reactInternalMemoizedMergedChildContext=t,ct(Rn),ct(dn),ot(dn,t)):ct(Rn),ot(Rn,n)}var ns=null,Oh=!1,cp=!1;function MT(t){ns===null?ns=[t]:ns.push(t)}function uN(t){Oh=!0,MT(t)}function wi(){if(!cp&&ns!==null){cp=!0;var t=0,e=Ze;try{var n=ns;for(Ze=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}ns=null,Oh=!1}catch(s){throw ns!==null&&(ns=ns.slice(t+1)),cT(Lg,wi),s}finally{Ze=e,cp=!1}}return null}var ra=[],sa=0,Md=null,Fd=0,Jn=[],Zn=0,ro=null,rs=1,ss="";function Di(t,e){ra[sa++]=Fd,ra[sa++]=Md,Md=t,Fd=e}function FT(t,e,n){Jn[Zn++]=rs,Jn[Zn++]=ss,Jn[Zn++]=ro,ro=t;var r=rs;t=ss;var s=32-_r(r)-1;r&=~(1<<s),n+=1;var i=32-_r(e)+s;if(30<i){var o=s-s%5;i=(r&(1<<o)-1).toString(32),r>>=o,s-=o,rs=1<<32-_r(e)+s|n<<s|r,ss=i+t}else rs=1<<i|n<<s|r,ss=t}function Hg(t){t.return!==null&&(Di(t,1),FT(t,1,0))}function Wg(t){for(;t===Md;)Md=ra[--sa],ra[sa]=null,Fd=ra[--sa],ra[sa]=null;for(;t===ro;)ro=Jn[--Zn],Jn[Zn]=null,ss=Jn[--Zn],Jn[Zn]=null,rs=Jn[--Zn],Jn[Zn]=null}var zn=null,$n=null,dt=!1,yr=null;function UT(t,e){var n=nr(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function dw(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,zn=t,$n=Zs(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,zn=t,$n=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=ro!==null?{id:rs,overflow:ss}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=nr(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,zn=t,$n=null,!0):!1;default:return!1}}function Im(t){return(t.mode&1)!==0&&(t.flags&128)===0}function xm(t){if(dt){var e=$n;if(e){var n=e;if(!dw(t,e)){if(Im(t))throw Error(G(418));e=Zs(n.nextSibling);var r=zn;e&&dw(t,e)?UT(r,n):(t.flags=t.flags&-4097|2,dt=!1,zn=t)}}else{if(Im(t))throw Error(G(418));t.flags=t.flags&-4097|2,dt=!1,zn=t}}}function hw(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;zn=t}function ku(t){if(t!==zn)return!1;if(!dt)return hw(t),dt=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!vm(t.type,t.memoizedProps)),e&&(e=$n)){if(Im(t))throw $T(),Error(G(418));for(;e;)UT(t,e),e=Zs(e.nextSibling)}if(hw(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(G(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){$n=Zs(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}$n=null}}else $n=zn?Zs(t.stateNode.nextSibling):null;return!0}function $T(){for(var t=$n;t;)t=Zs(t.nextSibling)}function Ta(){$n=zn=null,dt=!1}function Gg(t){yr===null?yr=[t]:yr.push(t)}var dN=ws.ReactCurrentBatchConfig;function vl(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(G(309));var r=n.stateNode}if(!r)throw Error(G(147,t));var s=r,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(o){var a=s.refs;o===null?delete a[i]:a[i]=o},e._stringRef=i,e)}if(typeof t!="string")throw Error(G(284));if(!n._owner)throw Error(G(290,t))}return t}function Du(t,e){throw t=Object.prototype.toString.call(e),Error(G(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function fw(t){var e=t._init;return e(t._payload)}function BT(t){function e(T,y){if(t){var v=T.deletions;v===null?(T.deletions=[y],T.flags|=16):v.push(y)}}function n(T,y){if(!t)return null;for(;y!==null;)e(T,y),y=y.sibling;return null}function r(T,y){for(T=new Map;y!==null;)y.key!==null?T.set(y.key,y):T.set(y.index,y),y=y.sibling;return T}function s(T,y){return T=ri(T,y),T.index=0,T.sibling=null,T}function i(T,y,v){return T.index=v,t?(v=T.alternate,v!==null?(v=v.index,v<y?(T.flags|=2,y):v):(T.flags|=2,y)):(T.flags|=1048576,y)}function o(T){return t&&T.alternate===null&&(T.flags|=2),T}function a(T,y,v,E){return y===null||y.tag!==6?(y=gp(v,T.mode,E),y.return=T,y):(y=s(y,v),y.return=T,y)}function c(T,y,v,E){var O=v.type;return O===Xo?h(T,y,v.props.children,E,v.key):y!==null&&(y.elementType===O||typeof O=="object"&&O!==null&&O.$$typeof===Ls&&fw(O)===y.type)?(E=s(y,v.props),E.ref=vl(T,y,v),E.return=T,E):(E=ld(v.type,v.key,v.props,null,T.mode,E),E.ref=vl(T,y,v),E.return=T,E)}function d(T,y,v,E){return y===null||y.tag!==4||y.stateNode.containerInfo!==v.containerInfo||y.stateNode.implementation!==v.implementation?(y=yp(v,T.mode,E),y.return=T,y):(y=s(y,v.children||[]),y.return=T,y)}function h(T,y,v,E,O){return y===null||y.tag!==7?(y=Qi(v,T.mode,E,O),y.return=T,y):(y=s(y,v),y.return=T,y)}function f(T,y,v){if(typeof y=="string"&&y!==""||typeof y=="number")return y=gp(""+y,T.mode,v),y.return=T,y;if(typeof y=="object"&&y!==null){switch(y.$$typeof){case Iu:return v=ld(y.type,y.key,y.props,null,T.mode,v),v.ref=vl(T,null,y),v.return=T,v;case Yo:return y=yp(y,T.mode,v),y.return=T,y;case Ls:var E=y._init;return f(T,E(y._payload),v)}if(kl(y)||fl(y))return y=Qi(y,T.mode,v,null),y.return=T,y;Du(T,y)}return null}function m(T,y,v,E){var O=y!==null?y.key:null;if(typeof v=="string"&&v!==""||typeof v=="number")return O!==null?null:a(T,y,""+v,E);if(typeof v=="object"&&v!==null){switch(v.$$typeof){case Iu:return v.key===O?c(T,y,v,E):null;case Yo:return v.key===O?d(T,y,v,E):null;case Ls:return O=v._init,m(T,y,O(v._payload),E)}if(kl(v)||fl(v))return O!==null?null:h(T,y,v,E,null);Du(T,v)}return null}function _(T,y,v,E,O){if(typeof E=="string"&&E!==""||typeof E=="number")return T=T.get(v)||null,a(y,T,""+E,O);if(typeof E=="object"&&E!==null){switch(E.$$typeof){case Iu:return T=T.get(E.key===null?v:E.key)||null,c(y,T,E,O);case Yo:return T=T.get(E.key===null?v:E.key)||null,d(y,T,E,O);case Ls:var F=E._init;return _(T,y,v,F(E._payload),O)}if(kl(E)||fl(E))return T=T.get(v)||null,h(y,T,E,O,null);Du(y,E)}return null}function R(T,y,v,E){for(var O=null,F=null,x=y,I=y=0,w=null;x!==null&&I<v.length;I++){x.index>I?(w=x,x=null):w=x.sibling;var P=m(T,x,v[I],E);if(P===null){x===null&&(x=w);break}t&&x&&P.alternate===null&&e(T,x),y=i(P,y,I),F===null?O=P:F.sibling=P,F=P,x=w}if(I===v.length)return n(T,x),dt&&Di(T,I),O;if(x===null){for(;I<v.length;I++)x=f(T,v[I],E),x!==null&&(y=i(x,y,I),F===null?O=x:F.sibling=x,F=x);return dt&&Di(T,I),O}for(x=r(T,x);I<v.length;I++)w=_(x,T,I,v[I],E),w!==null&&(t&&w.alternate!==null&&x.delete(w.key===null?I:w.key),y=i(w,y,I),F===null?O=w:F.sibling=w,F=w);return t&&x.forEach(function(D){return e(T,D)}),dt&&Di(T,I),O}function C(T,y,v,E){var O=fl(v);if(typeof O!="function")throw Error(G(150));if(v=O.call(v),v==null)throw Error(G(151));for(var F=O=null,x=y,I=y=0,w=null,P=v.next();x!==null&&!P.done;I++,P=v.next()){x.index>I?(w=x,x=null):w=x.sibling;var D=m(T,x,P.value,E);if(D===null){x===null&&(x=w);break}t&&x&&D.alternate===null&&e(T,x),y=i(D,y,I),F===null?O=D:F.sibling=D,F=D,x=w}if(P.done)return n(T,x),dt&&Di(T,I),O;if(x===null){for(;!P.done;I++,P=v.next())P=f(T,P.value,E),P!==null&&(y=i(P,y,I),F===null?O=P:F.sibling=P,F=P);return dt&&Di(T,I),O}for(x=r(T,x);!P.done;I++,P=v.next())P=_(x,T,I,P.value,E),P!==null&&(t&&P.alternate!==null&&x.delete(P.key===null?I:P.key),y=i(P,y,I),F===null?O=P:F.sibling=P,F=P);return t&&x.forEach(function(j){return e(T,j)}),dt&&Di(T,I),O}function N(T,y,v,E){if(typeof v=="object"&&v!==null&&v.type===Xo&&v.key===null&&(v=v.props.children),typeof v=="object"&&v!==null){switch(v.$$typeof){case Iu:e:{for(var O=v.key,F=y;F!==null;){if(F.key===O){if(O=v.type,O===Xo){if(F.tag===7){n(T,F.sibling),y=s(F,v.props.children),y.return=T,T=y;break e}}else if(F.elementType===O||typeof O=="object"&&O!==null&&O.$$typeof===Ls&&fw(O)===F.type){n(T,F.sibling),y=s(F,v.props),y.ref=vl(T,F,v),y.return=T,T=y;break e}n(T,F);break}else e(T,F);F=F.sibling}v.type===Xo?(y=Qi(v.props.children,T.mode,E,v.key),y.return=T,T=y):(E=ld(v.type,v.key,v.props,null,T.mode,E),E.ref=vl(T,y,v),E.return=T,T=E)}return o(T);case Yo:e:{for(F=v.key;y!==null;){if(y.key===F)if(y.tag===4&&y.stateNode.containerInfo===v.containerInfo&&y.stateNode.implementation===v.implementation){n(T,y.sibling),y=s(y,v.children||[]),y.return=T,T=y;break e}else{n(T,y);break}else e(T,y);y=y.sibling}y=yp(v,T.mode,E),y.return=T,T=y}return o(T);case Ls:return F=v._init,N(T,y,F(v._payload),E)}if(kl(v))return R(T,y,v,E);if(fl(v))return C(T,y,v,E);Du(T,v)}return typeof v=="string"&&v!==""||typeof v=="number"?(v=""+v,y!==null&&y.tag===6?(n(T,y.sibling),y=s(y,v),y.return=T,T=y):(n(T,y),y=gp(v,T.mode,E),y.return=T,T=y),o(T)):n(T,y)}return N}var ba=BT(!0),zT=BT(!1),Ud=_i(null),$d=null,ia=null,Kg=null;function Qg(){Kg=ia=$d=null}function Yg(t){var e=Ud.current;ct(Ud),t._currentValue=e}function Tm(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function fa(t,e){$d=t,Kg=ia=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Cn=!0),t.firstContext=null)}function or(t){var e=t._currentValue;if(Kg!==t)if(t={context:t,memoizedValue:e,next:null},ia===null){if($d===null)throw Error(G(308));ia=t,$d.dependencies={lanes:0,firstContext:t}}else ia=ia.next=t;return e}var qi=null;function Xg(t){qi===null?qi=[t]:qi.push(t)}function qT(t,e,n,r){var s=e.interleaved;return s===null?(n.next=n,Xg(e)):(n.next=s.next,s.next=n),e.interleaved=n,hs(t,r)}function hs(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Vs=!1;function Jg(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function HT(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function ls(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function ei(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,qe&2){var s=r.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),r.pending=e,hs(t,n)}return s=r.interleaved,s===null?(e.next=e,Xg(r)):(e.next=s.next,s.next=e),r.interleaved=e,hs(t,n)}function nd(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Vg(t,n)}}function pw(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?s=i=o:i=i.next=o,n=n.next}while(n!==null);i===null?s=i=e:i=i.next=e}else s=i=e;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function Bd(t,e,n,r){var s=t.updateQueue;Vs=!1;var i=s.firstBaseUpdate,o=s.lastBaseUpdate,a=s.shared.pending;if(a!==null){s.shared.pending=null;var c=a,d=c.next;c.next=null,o===null?i=d:o.next=d,o=c;var h=t.alternate;h!==null&&(h=h.updateQueue,a=h.lastBaseUpdate,a!==o&&(a===null?h.firstBaseUpdate=d:a.next=d,h.lastBaseUpdate=c))}if(i!==null){var f=s.baseState;o=0,h=d=c=null,a=i;do{var m=a.lane,_=a.eventTime;if((r&m)===m){h!==null&&(h=h.next={eventTime:_,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var R=t,C=a;switch(m=e,_=n,C.tag){case 1:if(R=C.payload,typeof R=="function"){f=R.call(_,f,m);break e}f=R;break e;case 3:R.flags=R.flags&-65537|128;case 0:if(R=C.payload,m=typeof R=="function"?R.call(_,f,m):R,m==null)break e;f=vt({},f,m);break e;case 2:Vs=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,m=s.effects,m===null?s.effects=[a]:m.push(a))}else _={eventTime:_,lane:m,tag:a.tag,payload:a.payload,callback:a.callback,next:null},h===null?(d=h=_,c=f):h=h.next=_,o|=m;if(a=a.next,a===null){if(a=s.shared.pending,a===null)break;m=a,a=m.next,m.next=null,s.lastBaseUpdate=m,s.shared.pending=null}}while(!0);if(h===null&&(c=f),s.baseState=c,s.firstBaseUpdate=d,s.lastBaseUpdate=h,e=s.shared.interleaved,e!==null){s=e;do o|=s.lane,s=s.next;while(s!==e)}else i===null&&(s.shared.lanes=0);io|=o,t.lanes=o,t.memoizedState=f}}function mw(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(G(191,s));s.call(r)}}}var Hc={},Hr=_i(Hc),wc=_i(Hc),Ec=_i(Hc);function Hi(t){if(t===Hc)throw Error(G(174));return t}function Zg(t,e){switch(ot(Ec,e),ot(wc,t),ot(Hr,Hc),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:sm(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=sm(e,t)}ct(Hr),ot(Hr,e)}function Sa(){ct(Hr),ct(wc),ct(Ec)}function WT(t){Hi(Ec.current);var e=Hi(Hr.current),n=sm(e,t.type);e!==n&&(ot(wc,t),ot(Hr,n))}function ey(t){wc.current===t&&(ct(Hr),ct(wc))}var pt=_i(0);function zd(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var up=[];function ty(){for(var t=0;t<up.length;t++)up[t]._workInProgressVersionPrimary=null;up.length=0}var rd=ws.ReactCurrentDispatcher,dp=ws.ReactCurrentBatchConfig,so=0,yt=null,Lt=null,Gt=null,qd=!1,Ql=!1,Ic=0,hN=0;function tn(){throw Error(G(321))}function ny(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!Ir(t[n],e[n]))return!1;return!0}function ry(t,e,n,r,s,i){if(so=i,yt=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,rd.current=t===null||t.memoizedState===null?gN:yN,t=n(r,s),Ql){i=0;do{if(Ql=!1,Ic=0,25<=i)throw Error(G(301));i+=1,Gt=Lt=null,e.updateQueue=null,rd.current=vN,t=n(r,s)}while(Ql)}if(rd.current=Hd,e=Lt!==null&&Lt.next!==null,so=0,Gt=Lt=yt=null,qd=!1,e)throw Error(G(300));return t}function sy(){var t=Ic!==0;return Ic=0,t}function Vr(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Gt===null?yt.memoizedState=Gt=t:Gt=Gt.next=t,Gt}function ar(){if(Lt===null){var t=yt.alternate;t=t!==null?t.memoizedState:null}else t=Lt.next;var e=Gt===null?yt.memoizedState:Gt.next;if(e!==null)Gt=e,Lt=t;else{if(t===null)throw Error(G(310));Lt=t,t={memoizedState:Lt.memoizedState,baseState:Lt.baseState,baseQueue:Lt.baseQueue,queue:Lt.queue,next:null},Gt===null?yt.memoizedState=Gt=t:Gt=Gt.next=t}return Gt}function xc(t,e){return typeof e=="function"?e(t):e}function hp(t){var e=ar(),n=e.queue;if(n===null)throw Error(G(311));n.lastRenderedReducer=t;var r=Lt,s=r.baseQueue,i=n.pending;if(i!==null){if(s!==null){var o=s.next;s.next=i.next,i.next=o}r.baseQueue=s=i,n.pending=null}if(s!==null){i=s.next,r=r.baseState;var a=o=null,c=null,d=i;do{var h=d.lane;if((so&h)===h)c!==null&&(c=c.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),r=d.hasEagerState?d.eagerState:t(r,d.action);else{var f={lane:h,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};c===null?(a=c=f,o=r):c=c.next=f,yt.lanes|=h,io|=h}d=d.next}while(d!==null&&d!==i);c===null?o=r:c.next=a,Ir(r,e.memoizedState)||(Cn=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=c,n.lastRenderedState=r}if(t=n.interleaved,t!==null){s=t;do i=s.lane,yt.lanes|=i,io|=i,s=s.next;while(s!==t)}else s===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function fp(t){var e=ar(),n=e.queue;if(n===null)throw Error(G(311));n.lastRenderedReducer=t;var r=n.dispatch,s=n.pending,i=e.memoizedState;if(s!==null){n.pending=null;var o=s=s.next;do i=t(i,o.action),o=o.next;while(o!==s);Ir(i,e.memoizedState)||(Cn=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),n.lastRenderedState=i}return[i,r]}function GT(){}function KT(t,e){var n=yt,r=ar(),s=e(),i=!Ir(r.memoizedState,s);if(i&&(r.memoizedState=s,Cn=!0),r=r.queue,iy(XT.bind(null,n,r,t),[t]),r.getSnapshot!==e||i||Gt!==null&&Gt.memoizedState.tag&1){if(n.flags|=2048,Tc(9,YT.bind(null,n,r,s,e),void 0,null),Kt===null)throw Error(G(349));so&30||QT(n,e,s)}return s}function QT(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=yt.updateQueue,e===null?(e={lastEffect:null,stores:null},yt.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function YT(t,e,n,r){e.value=n,e.getSnapshot=r,JT(e)&&ZT(t)}function XT(t,e,n){return n(function(){JT(e)&&ZT(t)})}function JT(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!Ir(t,n)}catch{return!0}}function ZT(t){var e=hs(t,1);e!==null&&wr(e,t,1,-1)}function gw(t){var e=Vr();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:xc,lastRenderedState:t},e.queue=t,t=t.dispatch=mN.bind(null,yt,t),[e.memoizedState,t]}function Tc(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=yt.updateQueue,e===null?(e={lastEffect:null,stores:null},yt.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function eb(){return ar().memoizedState}function sd(t,e,n,r){var s=Vr();yt.flags|=t,s.memoizedState=Tc(1|e,n,void 0,r===void 0?null:r)}function Lh(t,e,n,r){var s=ar();r=r===void 0?null:r;var i=void 0;if(Lt!==null){var o=Lt.memoizedState;if(i=o.destroy,r!==null&&ny(r,o.deps)){s.memoizedState=Tc(e,n,i,r);return}}yt.flags|=t,s.memoizedState=Tc(1|e,n,i,r)}function yw(t,e){return sd(8390656,8,t,e)}function iy(t,e){return Lh(2048,8,t,e)}function tb(t,e){return Lh(4,2,t,e)}function nb(t,e){return Lh(4,4,t,e)}function rb(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function sb(t,e,n){return n=n!=null?n.concat([t]):null,Lh(4,4,rb.bind(null,e,t),n)}function oy(){}function ib(t,e){var n=ar();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&ny(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function ob(t,e){var n=ar();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&ny(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function ab(t,e,n){return so&21?(Ir(n,e)||(n=hT(),yt.lanes|=n,io|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Cn=!0),t.memoizedState=n)}function fN(t,e){var n=Ze;Ze=n!==0&&4>n?n:4,t(!0);var r=dp.transition;dp.transition={};try{t(!1),e()}finally{Ze=n,dp.transition=r}}function lb(){return ar().memoizedState}function pN(t,e,n){var r=ni(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},cb(t))ub(e,n);else if(n=qT(t,e,n,r),n!==null){var s=vn();wr(n,t,r,s),db(n,e,r)}}function mN(t,e,n){var r=ni(t),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(cb(t))ub(e,s);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var o=e.lastRenderedState,a=i(o,n);if(s.hasEagerState=!0,s.eagerState=a,Ir(a,o)){var c=e.interleaved;c===null?(s.next=s,Xg(e)):(s.next=c.next,c.next=s),e.interleaved=s;return}}catch{}finally{}n=qT(t,e,s,r),n!==null&&(s=vn(),wr(n,t,r,s),db(n,e,r))}}function cb(t){var e=t.alternate;return t===yt||e!==null&&e===yt}function ub(t,e){Ql=qd=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function db(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Vg(t,n)}}var Hd={readContext:or,useCallback:tn,useContext:tn,useEffect:tn,useImperativeHandle:tn,useInsertionEffect:tn,useLayoutEffect:tn,useMemo:tn,useReducer:tn,useRef:tn,useState:tn,useDebugValue:tn,useDeferredValue:tn,useTransition:tn,useMutableSource:tn,useSyncExternalStore:tn,useId:tn,unstable_isNewReconciler:!1},gN={readContext:or,useCallback:function(t,e){return Vr().memoizedState=[t,e===void 0?null:e],t},useContext:or,useEffect:yw,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,sd(4194308,4,rb.bind(null,e,t),n)},useLayoutEffect:function(t,e){return sd(4194308,4,t,e)},useInsertionEffect:function(t,e){return sd(4,2,t,e)},useMemo:function(t,e){var n=Vr();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=Vr();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=pN.bind(null,yt,t),[r.memoizedState,t]},useRef:function(t){var e=Vr();return t={current:t},e.memoizedState=t},useState:gw,useDebugValue:oy,useDeferredValue:function(t){return Vr().memoizedState=t},useTransition:function(){var t=gw(!1),e=t[0];return t=fN.bind(null,t[1]),Vr().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=yt,s=Vr();if(dt){if(n===void 0)throw Error(G(407));n=n()}else{if(n=e(),Kt===null)throw Error(G(349));so&30||QT(r,e,n)}s.memoizedState=n;var i={value:n,getSnapshot:e};return s.queue=i,yw(XT.bind(null,r,i,t),[t]),r.flags|=2048,Tc(9,YT.bind(null,r,i,n,e),void 0,null),n},useId:function(){var t=Vr(),e=Kt.identifierPrefix;if(dt){var n=ss,r=rs;n=(r&~(1<<32-_r(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=Ic++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=hN++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},yN={readContext:or,useCallback:ib,useContext:or,useEffect:iy,useImperativeHandle:sb,useInsertionEffect:tb,useLayoutEffect:nb,useMemo:ob,useReducer:hp,useRef:eb,useState:function(){return hp(xc)},useDebugValue:oy,useDeferredValue:function(t){var e=ar();return ab(e,Lt.memoizedState,t)},useTransition:function(){var t=hp(xc)[0],e=ar().memoizedState;return[t,e]},useMutableSource:GT,useSyncExternalStore:KT,useId:lb,unstable_isNewReconciler:!1},vN={readContext:or,useCallback:ib,useContext:or,useEffect:iy,useImperativeHandle:sb,useInsertionEffect:tb,useLayoutEffect:nb,useMemo:ob,useReducer:fp,useRef:eb,useState:function(){return fp(xc)},useDebugValue:oy,useDeferredValue:function(t){var e=ar();return Lt===null?e.memoizedState=t:ab(e,Lt.memoizedState,t)},useTransition:function(){var t=fp(xc)[0],e=ar().memoizedState;return[t,e]},useMutableSource:GT,useSyncExternalStore:KT,useId:lb,unstable_isNewReconciler:!1};function pr(t,e){if(t&&t.defaultProps){e=vt({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function bm(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:vt({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var Vh={isMounted:function(t){return(t=t._reactInternals)?xo(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=vn(),s=ni(t),i=ls(r,s);i.payload=e,n!=null&&(i.callback=n),e=ei(t,i,s),e!==null&&(wr(e,t,s,r),nd(e,t,s))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=vn(),s=ni(t),i=ls(r,s);i.tag=1,i.payload=e,n!=null&&(i.callback=n),e=ei(t,i,s),e!==null&&(wr(e,t,s,r),nd(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=vn(),r=ni(t),s=ls(n,r);s.tag=2,e!=null&&(s.callback=e),e=ei(t,s,r),e!==null&&(wr(e,t,r,n),nd(e,t,r))}};function vw(t,e,n,r,s,i,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,i,o):e.prototype&&e.prototype.isPureReactComponent?!gc(n,r)||!gc(s,i):!0}function hb(t,e,n){var r=!1,s=hi,i=e.contextType;return typeof i=="object"&&i!==null?i=or(i):(s=Nn(e)?no:dn.current,r=e.contextTypes,i=(r=r!=null)?xa(t,s):hi),e=new e(n,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Vh,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=i),e}function _w(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&Vh.enqueueReplaceState(e,e.state,null)}function Sm(t,e,n,r){var s=t.stateNode;s.props=n,s.state=t.memoizedState,s.refs={},Jg(t);var i=e.contextType;typeof i=="object"&&i!==null?s.context=or(i):(i=Nn(e)?no:dn.current,s.context=xa(t,i)),s.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(bm(t,e,i,n),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&Vh.enqueueReplaceState(s,s.state,null),Bd(t,n,s,r),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function Ca(t,e){try{var n="",r=e;do n+=W1(r),r=r.return;while(r);var s=n}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:s,digest:null}}function pp(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function Cm(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var _N=typeof WeakMap=="function"?WeakMap:Map;function fb(t,e,n){n=ls(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){Gd||(Gd=!0,Vm=r),Cm(t,e)},n}function pb(t,e,n){n=ls(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var s=e.value;n.payload=function(){return r(s)},n.callback=function(){Cm(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){Cm(t,e),typeof r!="function"&&(ti===null?ti=new Set([this]):ti.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function ww(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new _N;var s=new Set;r.set(e,s)}else s=r.get(e),s===void 0&&(s=new Set,r.set(e,s));s.has(n)||(s.add(n),t=DN.bind(null,t,e,n),e.then(t,t))}function Ew(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function Iw(t,e,n,r,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=ls(-1,1),e.tag=2,ei(n,e,1))),n.lanes|=1),t)}var wN=ws.ReactCurrentOwner,Cn=!1;function pn(t,e,n,r){e.child=t===null?zT(e,null,n,r):ba(e,t.child,n,r)}function xw(t,e,n,r,s){n=n.render;var i=e.ref;return fa(e,s),r=ry(t,e,n,r,i,s),n=sy(),t!==null&&!Cn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,fs(t,e,s)):(dt&&n&&Hg(e),e.flags|=1,pn(t,e,r,s),e.child)}function Tw(t,e,n,r,s){if(t===null){var i=n.type;return typeof i=="function"&&!py(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=i,mb(t,e,i,r,s)):(t=ld(n.type,null,r,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&s)){var o=i.memoizedProps;if(n=n.compare,n=n!==null?n:gc,n(o,r)&&t.ref===e.ref)return fs(t,e,s)}return e.flags|=1,t=ri(i,r),t.ref=e.ref,t.return=e,e.child=t}function mb(t,e,n,r,s){if(t!==null){var i=t.memoizedProps;if(gc(i,r)&&t.ref===e.ref)if(Cn=!1,e.pendingProps=r=i,(t.lanes&s)!==0)t.flags&131072&&(Cn=!0);else return e.lanes=t.lanes,fs(t,e,s)}return Am(t,e,n,r,s)}function gb(t,e,n){var r=e.pendingProps,s=r.children,i=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},ot(aa,Mn),Mn|=n;else{if(!(n&1073741824))return t=i!==null?i.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,ot(aa,Mn),Mn|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,ot(aa,Mn),Mn|=r}else i!==null?(r=i.baseLanes|n,e.memoizedState=null):r=n,ot(aa,Mn),Mn|=r;return pn(t,e,s,n),e.child}function yb(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function Am(t,e,n,r,s){var i=Nn(n)?no:dn.current;return i=xa(e,i),fa(e,s),n=ry(t,e,n,r,i,s),r=sy(),t!==null&&!Cn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,fs(t,e,s)):(dt&&r&&Hg(e),e.flags|=1,pn(t,e,n,s),e.child)}function bw(t,e,n,r,s){if(Nn(n)){var i=!0;Vd(e)}else i=!1;if(fa(e,s),e.stateNode===null)id(t,e),hb(e,n,r),Sm(e,n,r,s),r=!0;else if(t===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var c=o.context,d=n.contextType;typeof d=="object"&&d!==null?d=or(d):(d=Nn(n)?no:dn.current,d=xa(e,d));var h=n.getDerivedStateFromProps,f=typeof h=="function"||typeof o.getSnapshotBeforeUpdate=="function";f||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==r||c!==d)&&_w(e,o,r,d),Vs=!1;var m=e.memoizedState;o.state=m,Bd(e,r,o,s),c=e.memoizedState,a!==r||m!==c||Rn.current||Vs?(typeof h=="function"&&(bm(e,n,h,r),c=e.memoizedState),(a=Vs||vw(e,n,a,r,m,c,d))?(f||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=c),o.props=r,o.state=c,o.context=d,r=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,HT(t,e),a=e.memoizedProps,d=e.type===e.elementType?a:pr(e.type,a),o.props=d,f=e.pendingProps,m=o.context,c=n.contextType,typeof c=="object"&&c!==null?c=or(c):(c=Nn(n)?no:dn.current,c=xa(e,c));var _=n.getDerivedStateFromProps;(h=typeof _=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==f||m!==c)&&_w(e,o,r,c),Vs=!1,m=e.memoizedState,o.state=m,Bd(e,r,o,s);var R=e.memoizedState;a!==f||m!==R||Rn.current||Vs?(typeof _=="function"&&(bm(e,n,_,r),R=e.memoizedState),(d=Vs||vw(e,n,d,r,m,R,c)||!1)?(h||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,R,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,R,c)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&m===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&m===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=R),o.props=r,o.state=R,o.context=c,r=d):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&m===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&m===t.memoizedState||(e.flags|=1024),r=!1)}return Rm(t,e,n,r,i,s)}function Rm(t,e,n,r,s,i){yb(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return s&&uw(e,n,!1),fs(t,e,i);r=e.stateNode,wN.current=e;var a=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=ba(e,t.child,null,i),e.child=ba(e,null,a,i)):pn(t,e,a,i),e.memoizedState=r.state,s&&uw(e,n,!0),e.child}function vb(t){var e=t.stateNode;e.pendingContext?cw(t,e.pendingContext,e.pendingContext!==e.context):e.context&&cw(t,e.context,!1),Zg(t,e.containerInfo)}function Sw(t,e,n,r,s){return Ta(),Gg(s),e.flags|=256,pn(t,e,n,r),e.child}var Nm={dehydrated:null,treeContext:null,retryLane:0};function Pm(t){return{baseLanes:t,cachePool:null,transitions:null}}function _b(t,e,n){var r=e.pendingProps,s=pt.current,i=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=t!==null&&t.memoizedState===null?!1:(s&2)!==0),a?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),ot(pt,s&1),t===null)return xm(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,i?(r=e.mode,i=e.child,o={mode:"hidden",children:o},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=Uh(o,r,0,null),t=Qi(t,r,n,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=Pm(n),e.memoizedState=Nm,t):ay(e,o));if(s=t.memoizedState,s!==null&&(a=s.dehydrated,a!==null))return EN(t,e,o,r,a,s,n);if(i){i=r.fallback,o=e.mode,s=t.child,a=s.sibling;var c={mode:"hidden",children:r.children};return!(o&1)&&e.child!==s?(r=e.child,r.childLanes=0,r.pendingProps=c,e.deletions=null):(r=ri(s,c),r.subtreeFlags=s.subtreeFlags&14680064),a!==null?i=ri(a,i):(i=Qi(i,o,n,null),i.flags|=2),i.return=e,r.return=e,r.sibling=i,e.child=r,r=i,i=e.child,o=t.child.memoizedState,o=o===null?Pm(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=t.childLanes&~n,e.memoizedState=Nm,r}return i=t.child,t=i.sibling,r=ri(i,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function ay(t,e){return e=Uh({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function ju(t,e,n,r){return r!==null&&Gg(r),ba(e,t.child,null,n),t=ay(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function EN(t,e,n,r,s,i,o){if(n)return e.flags&256?(e.flags&=-257,r=pp(Error(G(422))),ju(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=r.fallback,s=e.mode,r=Uh({mode:"visible",children:r.children},s,0,null),i=Qi(i,s,o,null),i.flags|=2,r.return=e,i.return=e,r.sibling=i,e.child=r,e.mode&1&&ba(e,t.child,null,o),e.child.memoizedState=Pm(o),e.memoizedState=Nm,i);if(!(e.mode&1))return ju(t,e,o,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var a=r.dgst;return r=a,i=Error(G(419)),r=pp(i,r,void 0),ju(t,e,o,r)}if(a=(o&t.childLanes)!==0,Cn||a){if(r=Kt,r!==null){switch(o&-o){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|o)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,hs(t,s),wr(r,t,s,-1))}return fy(),r=pp(Error(G(421))),ju(t,e,o,r)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=jN.bind(null,t),s._reactRetry=e,null):(t=i.treeContext,$n=Zs(s.nextSibling),zn=e,dt=!0,yr=null,t!==null&&(Jn[Zn++]=rs,Jn[Zn++]=ss,Jn[Zn++]=ro,rs=t.id,ss=t.overflow,ro=e),e=ay(e,r.children),e.flags|=4096,e)}function Cw(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),Tm(t.return,e,n)}function mp(t,e,n,r,s){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=s)}function wb(t,e,n){var r=e.pendingProps,s=r.revealOrder,i=r.tail;if(pn(t,e,r.children,n),r=pt.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&Cw(t,n,e);else if(t.tag===19)Cw(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(ot(pt,r),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(n=e.child,s=null;n!==null;)t=n.alternate,t!==null&&zd(t)===null&&(s=n),n=n.sibling;n=s,n===null?(s=e.child,e.child=null):(s=n.sibling,n.sibling=null),mp(e,!1,s,n,i);break;case"backwards":for(n=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&zd(t)===null){e.child=s;break}t=s.sibling,s.sibling=n,n=s,s=t}mp(e,!0,n,null,i);break;case"together":mp(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function id(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function fs(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),io|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(G(153));if(e.child!==null){for(t=e.child,n=ri(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=ri(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function IN(t,e,n){switch(e.tag){case 3:vb(e),Ta();break;case 5:WT(e);break;case 1:Nn(e.type)&&Vd(e);break;case 4:Zg(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,s=e.memoizedProps.value;ot(Ud,r._currentValue),r._currentValue=s;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(ot(pt,pt.current&1),e.flags|=128,null):n&e.child.childLanes?_b(t,e,n):(ot(pt,pt.current&1),t=fs(t,e,n),t!==null?t.sibling:null);ot(pt,pt.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return wb(t,e,n);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),ot(pt,pt.current),r)break;return null;case 22:case 23:return e.lanes=0,gb(t,e,n)}return fs(t,e,n)}var Eb,km,Ib,xb;Eb=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};km=function(){};Ib=function(t,e,n,r){var s=t.memoizedProps;if(s!==r){t=e.stateNode,Hi(Hr.current);var i=null;switch(n){case"input":s=em(t,s),r=em(t,r),i=[];break;case"select":s=vt({},s,{value:void 0}),r=vt({},r,{value:void 0}),i=[];break;case"textarea":s=rm(t,s),r=rm(t,r),i=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=Od)}im(n,r);var o;n=null;for(d in s)if(!r.hasOwnProperty(d)&&s.hasOwnProperty(d)&&s[d]!=null)if(d==="style"){var a=s[d];for(o in a)a.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(cc.hasOwnProperty(d)?i||(i=[]):(i=i||[]).push(d,null));for(d in r){var c=r[d];if(a=s!=null?s[d]:void 0,r.hasOwnProperty(d)&&c!==a&&(c!=null||a!=null))if(d==="style")if(a){for(o in a)!a.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in c)c.hasOwnProperty(o)&&a[o]!==c[o]&&(n||(n={}),n[o]=c[o])}else n||(i||(i=[]),i.push(d,n)),n=c;else d==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,a=a?a.__html:void 0,c!=null&&a!==c&&(i=i||[]).push(d,c)):d==="children"?typeof c!="string"&&typeof c!="number"||(i=i||[]).push(d,""+c):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(cc.hasOwnProperty(d)?(c!=null&&d==="onScroll"&&lt("scroll",t),i||a===c||(i=[])):(i=i||[]).push(d,c))}n&&(i=i||[]).push("style",n);var d=i;(e.updateQueue=d)&&(e.flags|=4)}};xb=function(t,e,n,r){n!==r&&(e.flags|=4)};function _l(t,e){if(!dt)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function nn(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function xN(t,e,n){var r=e.pendingProps;switch(Wg(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return nn(e),null;case 1:return Nn(e.type)&&Ld(),nn(e),null;case 3:return r=e.stateNode,Sa(),ct(Rn),ct(dn),ty(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(ku(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,yr!==null&&(Um(yr),yr=null))),km(t,e),nn(e),null;case 5:ey(e);var s=Hi(Ec.current);if(n=e.type,t!==null&&e.stateNode!=null)Ib(t,e,n,r,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(G(166));return nn(e),null}if(t=Hi(Hr.current),ku(e)){r=e.stateNode,n=e.type;var i=e.memoizedProps;switch(r[Fr]=e,r[_c]=i,t=(e.mode&1)!==0,n){case"dialog":lt("cancel",r),lt("close",r);break;case"iframe":case"object":case"embed":lt("load",r);break;case"video":case"audio":for(s=0;s<jl.length;s++)lt(jl[s],r);break;case"source":lt("error",r);break;case"img":case"image":case"link":lt("error",r),lt("load",r);break;case"details":lt("toggle",r);break;case"input":L_(r,i),lt("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},lt("invalid",r);break;case"textarea":M_(r,i),lt("invalid",r)}im(n,i),s=null;for(var o in i)if(i.hasOwnProperty(o)){var a=i[o];o==="children"?typeof a=="string"?r.textContent!==a&&(i.suppressHydrationWarning!==!0&&Pu(r.textContent,a,t),s=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(i.suppressHydrationWarning!==!0&&Pu(r.textContent,a,t),s=["children",""+a]):cc.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&lt("scroll",r)}switch(n){case"input":xu(r),V_(r,i,!0);break;case"textarea":xu(r),F_(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=Od)}r=s,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=Xx(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[Fr]=e,t[_c]=r,Eb(t,e,!1,!1),e.stateNode=t;e:{switch(o=om(n,r),n){case"dialog":lt("cancel",t),lt("close",t),s=r;break;case"iframe":case"object":case"embed":lt("load",t),s=r;break;case"video":case"audio":for(s=0;s<jl.length;s++)lt(jl[s],t);s=r;break;case"source":lt("error",t),s=r;break;case"img":case"image":case"link":lt("error",t),lt("load",t),s=r;break;case"details":lt("toggle",t),s=r;break;case"input":L_(t,r),s=em(t,r),lt("invalid",t);break;case"option":s=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},s=vt({},r,{value:void 0}),lt("invalid",t);break;case"textarea":M_(t,r),s=rm(t,r),lt("invalid",t);break;default:s=r}im(n,s),a=s;for(i in a)if(a.hasOwnProperty(i)){var c=a[i];i==="style"?eT(t,c):i==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&Jx(t,c)):i==="children"?typeof c=="string"?(n!=="textarea"||c!=="")&&uc(t,c):typeof c=="number"&&uc(t,""+c):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(cc.hasOwnProperty(i)?c!=null&&i==="onScroll"&&lt("scroll",t):c!=null&&Pg(t,i,c,o))}switch(n){case"input":xu(t),V_(t,r,!1);break;case"textarea":xu(t),F_(t);break;case"option":r.value!=null&&t.setAttribute("value",""+di(r.value));break;case"select":t.multiple=!!r.multiple,i=r.value,i!=null?ca(t,!!r.multiple,i,!1):r.defaultValue!=null&&ca(t,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=Od)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return nn(e),null;case 6:if(t&&e.stateNode!=null)xb(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(G(166));if(n=Hi(Ec.current),Hi(Hr.current),ku(e)){if(r=e.stateNode,n=e.memoizedProps,r[Fr]=e,(i=r.nodeValue!==n)&&(t=zn,t!==null))switch(t.tag){case 3:Pu(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Pu(r.nodeValue,n,(t.mode&1)!==0)}i&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Fr]=e,e.stateNode=r}return nn(e),null;case 13:if(ct(pt),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(dt&&$n!==null&&e.mode&1&&!(e.flags&128))$T(),Ta(),e.flags|=98560,i=!1;else if(i=ku(e),r!==null&&r.dehydrated!==null){if(t===null){if(!i)throw Error(G(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(G(317));i[Fr]=e}else Ta(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;nn(e),i=!1}else yr!==null&&(Um(yr),yr=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||pt.current&1?Mt===0&&(Mt=3):fy())),e.updateQueue!==null&&(e.flags|=4),nn(e),null);case 4:return Sa(),km(t,e),t===null&&yc(e.stateNode.containerInfo),nn(e),null;case 10:return Yg(e.type._context),nn(e),null;case 17:return Nn(e.type)&&Ld(),nn(e),null;case 19:if(ct(pt),i=e.memoizedState,i===null)return nn(e),null;if(r=(e.flags&128)!==0,o=i.rendering,o===null)if(r)_l(i,!1);else{if(Mt!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=zd(t),o!==null){for(e.flags|=128,_l(i,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)i=n,t=r,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,t=o.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return ot(pt,pt.current&1|2),e.child}t=t.sibling}i.tail!==null&&bt()>Aa&&(e.flags|=128,r=!0,_l(i,!1),e.lanes=4194304)}else{if(!r)if(t=zd(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),_l(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!dt)return nn(e),null}else 2*bt()-i.renderingStartTime>Aa&&n!==1073741824&&(e.flags|=128,r=!0,_l(i,!1),e.lanes=4194304);i.isBackwards?(o.sibling=e.child,e.child=o):(n=i.last,n!==null?n.sibling=o:e.child=o,i.last=o)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=bt(),e.sibling=null,n=pt.current,ot(pt,r?n&1|2:n&1),e):(nn(e),null);case 22:case 23:return hy(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?Mn&1073741824&&(nn(e),e.subtreeFlags&6&&(e.flags|=8192)):nn(e),null;case 24:return null;case 25:return null}throw Error(G(156,e.tag))}function TN(t,e){switch(Wg(e),e.tag){case 1:return Nn(e.type)&&Ld(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Sa(),ct(Rn),ct(dn),ty(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return ey(e),null;case 13:if(ct(pt),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(G(340));Ta()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return ct(pt),null;case 4:return Sa(),null;case 10:return Yg(e.type._context),null;case 22:case 23:return hy(),null;case 24:return null;default:return null}}var Ou=!1,on=!1,bN=typeof WeakSet=="function"?WeakSet:Set,oe=null;function oa(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){wt(t,e,r)}else n.current=null}function Dm(t,e,n){try{n()}catch(r){wt(t,e,r)}}var Aw=!1;function SN(t,e){if(gm=kd,t=AT(),qg(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var o=0,a=-1,c=-1,d=0,h=0,f=t,m=null;t:for(;;){for(var _;f!==n||s!==0&&f.nodeType!==3||(a=o+s),f!==i||r!==0&&f.nodeType!==3||(c=o+r),f.nodeType===3&&(o+=f.nodeValue.length),(_=f.firstChild)!==null;)m=f,f=_;for(;;){if(f===t)break t;if(m===n&&++d===s&&(a=o),m===i&&++h===r&&(c=o),(_=f.nextSibling)!==null)break;f=m,m=f.parentNode}f=_}n=a===-1||c===-1?null:{start:a,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(ym={focusedElem:t,selectionRange:n},kd=!1,oe=e;oe!==null;)if(e=oe,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,oe=t;else for(;oe!==null;){e=oe;try{var R=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(R!==null){var C=R.memoizedProps,N=R.memoizedState,T=e.stateNode,y=T.getSnapshotBeforeUpdate(e.elementType===e.type?C:pr(e.type,C),N);T.__reactInternalSnapshotBeforeUpdate=y}break;case 3:var v=e.stateNode.containerInfo;v.nodeType===1?v.textContent="":v.nodeType===9&&v.documentElement&&v.removeChild(v.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(G(163))}}catch(E){wt(e,e.return,E)}if(t=e.sibling,t!==null){t.return=e.return,oe=t;break}oe=e.return}return R=Aw,Aw=!1,R}function Yl(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&t)===t){var i=s.destroy;s.destroy=void 0,i!==void 0&&Dm(e,n,i)}s=s.next}while(s!==r)}}function Mh(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function jm(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function Tb(t){var e=t.alternate;e!==null&&(t.alternate=null,Tb(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Fr],delete e[_c],delete e[wm],delete e[lN],delete e[cN])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function bb(t){return t.tag===5||t.tag===3||t.tag===4}function Rw(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||bb(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Om(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=Od));else if(r!==4&&(t=t.child,t!==null))for(Om(t,e,n),t=t.sibling;t!==null;)Om(t,e,n),t=t.sibling}function Lm(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(Lm(t,e,n),t=t.sibling;t!==null;)Lm(t,e,n),t=t.sibling}var Qt=null,mr=!1;function Ns(t,e,n){for(n=n.child;n!==null;)Sb(t,e,n),n=n.sibling}function Sb(t,e,n){if(qr&&typeof qr.onCommitFiberUnmount=="function")try{qr.onCommitFiberUnmount(Nh,n)}catch{}switch(n.tag){case 5:on||oa(n,e);case 6:var r=Qt,s=mr;Qt=null,Ns(t,e,n),Qt=r,mr=s,Qt!==null&&(mr?(t=Qt,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Qt.removeChild(n.stateNode));break;case 18:Qt!==null&&(mr?(t=Qt,n=n.stateNode,t.nodeType===8?lp(t.parentNode,n):t.nodeType===1&&lp(t,n),pc(t)):lp(Qt,n.stateNode));break;case 4:r=Qt,s=mr,Qt=n.stateNode.containerInfo,mr=!0,Ns(t,e,n),Qt=r,mr=s;break;case 0:case 11:case 14:case 15:if(!on&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var i=s,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&Dm(n,e,o),s=s.next}while(s!==r)}Ns(t,e,n);break;case 1:if(!on&&(oa(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(a){wt(n,e,a)}Ns(t,e,n);break;case 21:Ns(t,e,n);break;case 22:n.mode&1?(on=(r=on)||n.memoizedState!==null,Ns(t,e,n),on=r):Ns(t,e,n);break;default:Ns(t,e,n)}}function Nw(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new bN),e.forEach(function(r){var s=ON.bind(null,t,r);n.has(r)||(n.add(r),r.then(s,s))})}}function fr(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var i=t,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:Qt=a.stateNode,mr=!1;break e;case 3:Qt=a.stateNode.containerInfo,mr=!0;break e;case 4:Qt=a.stateNode.containerInfo,mr=!0;break e}a=a.return}if(Qt===null)throw Error(G(160));Sb(i,o,s),Qt=null,mr=!1;var c=s.alternate;c!==null&&(c.return=null),s.return=null}catch(d){wt(s,e,d)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)Cb(e,t),e=e.sibling}function Cb(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(fr(e,t),jr(t),r&4){try{Yl(3,t,t.return),Mh(3,t)}catch(C){wt(t,t.return,C)}try{Yl(5,t,t.return)}catch(C){wt(t,t.return,C)}}break;case 1:fr(e,t),jr(t),r&512&&n!==null&&oa(n,n.return);break;case 5:if(fr(e,t),jr(t),r&512&&n!==null&&oa(n,n.return),t.flags&32){var s=t.stateNode;try{uc(s,"")}catch(C){wt(t,t.return,C)}}if(r&4&&(s=t.stateNode,s!=null)){var i=t.memoizedProps,o=n!==null?n.memoizedProps:i,a=t.type,c=t.updateQueue;if(t.updateQueue=null,c!==null)try{a==="input"&&i.type==="radio"&&i.name!=null&&Qx(s,i),om(a,o);var d=om(a,i);for(o=0;o<c.length;o+=2){var h=c[o],f=c[o+1];h==="style"?eT(s,f):h==="dangerouslySetInnerHTML"?Jx(s,f):h==="children"?uc(s,f):Pg(s,h,f,d)}switch(a){case"input":tm(s,i);break;case"textarea":Yx(s,i);break;case"select":var m=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var _=i.value;_!=null?ca(s,!!i.multiple,_,!1):m!==!!i.multiple&&(i.defaultValue!=null?ca(s,!!i.multiple,i.defaultValue,!0):ca(s,!!i.multiple,i.multiple?[]:"",!1))}s[_c]=i}catch(C){wt(t,t.return,C)}}break;case 6:if(fr(e,t),jr(t),r&4){if(t.stateNode===null)throw Error(G(162));s=t.stateNode,i=t.memoizedProps;try{s.nodeValue=i}catch(C){wt(t,t.return,C)}}break;case 3:if(fr(e,t),jr(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{pc(e.containerInfo)}catch(C){wt(t,t.return,C)}break;case 4:fr(e,t),jr(t);break;case 13:fr(e,t),jr(t),s=t.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(uy=bt())),r&4&&Nw(t);break;case 22:if(h=n!==null&&n.memoizedState!==null,t.mode&1?(on=(d=on)||h,fr(e,t),on=d):fr(e,t),jr(t),r&8192){if(d=t.memoizedState!==null,(t.stateNode.isHidden=d)&&!h&&t.mode&1)for(oe=t,h=t.child;h!==null;){for(f=oe=h;oe!==null;){switch(m=oe,_=m.child,m.tag){case 0:case 11:case 14:case 15:Yl(4,m,m.return);break;case 1:oa(m,m.return);var R=m.stateNode;if(typeof R.componentWillUnmount=="function"){r=m,n=m.return;try{e=r,R.props=e.memoizedProps,R.state=e.memoizedState,R.componentWillUnmount()}catch(C){wt(r,n,C)}}break;case 5:oa(m,m.return);break;case 22:if(m.memoizedState!==null){kw(f);continue}}_!==null?(_.return=m,oe=_):kw(f)}h=h.sibling}e:for(h=null,f=t;;){if(f.tag===5){if(h===null){h=f;try{s=f.stateNode,d?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(a=f.stateNode,c=f.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,a.style.display=Zx("display",o))}catch(C){wt(t,t.return,C)}}}else if(f.tag===6){if(h===null)try{f.stateNode.nodeValue=d?"":f.memoizedProps}catch(C){wt(t,t.return,C)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===t)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===t)break e;for(;f.sibling===null;){if(f.return===null||f.return===t)break e;h===f&&(h=null),f=f.return}h===f&&(h=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:fr(e,t),jr(t),r&4&&Nw(t);break;case 21:break;default:fr(e,t),jr(t)}}function jr(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(bb(n)){var r=n;break e}n=n.return}throw Error(G(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(uc(s,""),r.flags&=-33);var i=Rw(t);Lm(t,i,s);break;case 3:case 4:var o=r.stateNode.containerInfo,a=Rw(t);Om(t,a,o);break;default:throw Error(G(161))}}catch(c){wt(t,t.return,c)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function CN(t,e,n){oe=t,Ab(t)}function Ab(t,e,n){for(var r=(t.mode&1)!==0;oe!==null;){var s=oe,i=s.child;if(s.tag===22&&r){var o=s.memoizedState!==null||Ou;if(!o){var a=s.alternate,c=a!==null&&a.memoizedState!==null||on;a=Ou;var d=on;if(Ou=o,(on=c)&&!d)for(oe=s;oe!==null;)o=oe,c=o.child,o.tag===22&&o.memoizedState!==null?Dw(s):c!==null?(c.return=o,oe=c):Dw(s);for(;i!==null;)oe=i,Ab(i),i=i.sibling;oe=s,Ou=a,on=d}Pw(t)}else s.subtreeFlags&8772&&i!==null?(i.return=s,oe=i):Pw(t)}}function Pw(t){for(;oe!==null;){var e=oe;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:on||Mh(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!on)if(n===null)r.componentDidMount();else{var s=e.elementType===e.type?n.memoizedProps:pr(e.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&mw(e,i,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}mw(e,o,n)}break;case 5:var a=e.stateNode;if(n===null&&e.flags&4){n=a;var c=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var d=e.alternate;if(d!==null){var h=d.memoizedState;if(h!==null){var f=h.dehydrated;f!==null&&pc(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(G(163))}on||e.flags&512&&jm(e)}catch(m){wt(e,e.return,m)}}if(e===t){oe=null;break}if(n=e.sibling,n!==null){n.return=e.return,oe=n;break}oe=e.return}}function kw(t){for(;oe!==null;){var e=oe;if(e===t){oe=null;break}var n=e.sibling;if(n!==null){n.return=e.return,oe=n;break}oe=e.return}}function Dw(t){for(;oe!==null;){var e=oe;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{Mh(4,e)}catch(c){wt(e,n,c)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var s=e.return;try{r.componentDidMount()}catch(c){wt(e,s,c)}}var i=e.return;try{jm(e)}catch(c){wt(e,i,c)}break;case 5:var o=e.return;try{jm(e)}catch(c){wt(e,o,c)}}}catch(c){wt(e,e.return,c)}if(e===t){oe=null;break}var a=e.sibling;if(a!==null){a.return=e.return,oe=a;break}oe=e.return}}var AN=Math.ceil,Wd=ws.ReactCurrentDispatcher,ly=ws.ReactCurrentOwner,sr=ws.ReactCurrentBatchConfig,qe=0,Kt=null,Pt=null,Jt=0,Mn=0,aa=_i(0),Mt=0,bc=null,io=0,Fh=0,cy=0,Xl=null,Sn=null,uy=0,Aa=1/0,ts=null,Gd=!1,Vm=null,ti=null,Lu=!1,Ks=null,Kd=0,Jl=0,Mm=null,od=-1,ad=0;function vn(){return qe&6?bt():od!==-1?od:od=bt()}function ni(t){return t.mode&1?qe&2&&Jt!==0?Jt&-Jt:dN.transition!==null?(ad===0&&(ad=hT()),ad):(t=Ze,t!==0||(t=window.event,t=t===void 0?16:_T(t.type)),t):1}function wr(t,e,n,r){if(50<Jl)throw Jl=0,Mm=null,Error(G(185));Bc(t,n,r),(!(qe&2)||t!==Kt)&&(t===Kt&&(!(qe&2)&&(Fh|=n),Mt===4&&Fs(t,Jt)),Pn(t,r),n===1&&qe===0&&!(e.mode&1)&&(Aa=bt()+500,Oh&&wi()))}function Pn(t,e){var n=t.callbackNode;dR(t,e);var r=Pd(t,t===Kt?Jt:0);if(r===0)n!==null&&B_(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&B_(n),e===1)t.tag===0?uN(jw.bind(null,t)):MT(jw.bind(null,t)),oN(function(){!(qe&6)&&wi()}),n=null;else{switch(fT(r)){case 1:n=Lg;break;case 4:n=uT;break;case 16:n=Nd;break;case 536870912:n=dT;break;default:n=Nd}n=Lb(n,Rb.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function Rb(t,e){if(od=-1,ad=0,qe&6)throw Error(G(327));var n=t.callbackNode;if(pa()&&t.callbackNode!==n)return null;var r=Pd(t,t===Kt?Jt:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=Qd(t,r);else{e=r;var s=qe;qe|=2;var i=Pb();(Kt!==t||Jt!==e)&&(ts=null,Aa=bt()+500,Ki(t,e));do try{PN();break}catch(a){Nb(t,a)}while(!0);Qg(),Wd.current=i,qe=s,Pt!==null?e=0:(Kt=null,Jt=0,e=Mt)}if(e!==0){if(e===2&&(s=dm(t),s!==0&&(r=s,e=Fm(t,s))),e===1)throw n=bc,Ki(t,0),Fs(t,r),Pn(t,bt()),n;if(e===6)Fs(t,r);else{if(s=t.current.alternate,!(r&30)&&!RN(s)&&(e=Qd(t,r),e===2&&(i=dm(t),i!==0&&(r=i,e=Fm(t,i))),e===1))throw n=bc,Ki(t,0),Fs(t,r),Pn(t,bt()),n;switch(t.finishedWork=s,t.finishedLanes=r,e){case 0:case 1:throw Error(G(345));case 2:ji(t,Sn,ts);break;case 3:if(Fs(t,r),(r&130023424)===r&&(e=uy+500-bt(),10<e)){if(Pd(t,0)!==0)break;if(s=t.suspendedLanes,(s&r)!==r){vn(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=_m(ji.bind(null,t,Sn,ts),e);break}ji(t,Sn,ts);break;case 4:if(Fs(t,r),(r&4194240)===r)break;for(e=t.eventTimes,s=-1;0<r;){var o=31-_r(r);i=1<<o,o=e[o],o>s&&(s=o),r&=~i}if(r=s,r=bt()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*AN(r/1960))-r,10<r){t.timeoutHandle=_m(ji.bind(null,t,Sn,ts),r);break}ji(t,Sn,ts);break;case 5:ji(t,Sn,ts);break;default:throw Error(G(329))}}}return Pn(t,bt()),t.callbackNode===n?Rb.bind(null,t):null}function Fm(t,e){var n=Xl;return t.current.memoizedState.isDehydrated&&(Ki(t,e).flags|=256),t=Qd(t,e),t!==2&&(e=Sn,Sn=n,e!==null&&Um(e)),t}function Um(t){Sn===null?Sn=t:Sn.push.apply(Sn,t)}function RN(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],i=s.getSnapshot;s=s.value;try{if(!Ir(i(),s))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Fs(t,e){for(e&=~cy,e&=~Fh,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-_r(e),r=1<<n;t[n]=-1,e&=~r}}function jw(t){if(qe&6)throw Error(G(327));pa();var e=Pd(t,0);if(!(e&1))return Pn(t,bt()),null;var n=Qd(t,e);if(t.tag!==0&&n===2){var r=dm(t);r!==0&&(e=r,n=Fm(t,r))}if(n===1)throw n=bc,Ki(t,0),Fs(t,e),Pn(t,bt()),n;if(n===6)throw Error(G(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,ji(t,Sn,ts),Pn(t,bt()),null}function dy(t,e){var n=qe;qe|=1;try{return t(e)}finally{qe=n,qe===0&&(Aa=bt()+500,Oh&&wi())}}function oo(t){Ks!==null&&Ks.tag===0&&!(qe&6)&&pa();var e=qe;qe|=1;var n=sr.transition,r=Ze;try{if(sr.transition=null,Ze=1,t)return t()}finally{Ze=r,sr.transition=n,qe=e,!(qe&6)&&wi()}}function hy(){Mn=aa.current,ct(aa)}function Ki(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,iN(n)),Pt!==null)for(n=Pt.return;n!==null;){var r=n;switch(Wg(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Ld();break;case 3:Sa(),ct(Rn),ct(dn),ty();break;case 5:ey(r);break;case 4:Sa();break;case 13:ct(pt);break;case 19:ct(pt);break;case 10:Yg(r.type._context);break;case 22:case 23:hy()}n=n.return}if(Kt=t,Pt=t=ri(t.current,null),Jt=Mn=e,Mt=0,bc=null,cy=Fh=io=0,Sn=Xl=null,qi!==null){for(e=0;e<qi.length;e++)if(n=qi[e],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,i=n.pending;if(i!==null){var o=i.next;i.next=s,r.next=o}n.pending=r}qi=null}return t}function Nb(t,e){do{var n=Pt;try{if(Qg(),rd.current=Hd,qd){for(var r=yt.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}qd=!1}if(so=0,Gt=Lt=yt=null,Ql=!1,Ic=0,ly.current=null,n===null||n.return===null){Mt=1,bc=e,Pt=null;break}e:{var i=t,o=n.return,a=n,c=e;if(e=Jt,a.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var d=c,h=a,f=h.tag;if(!(h.mode&1)&&(f===0||f===11||f===15)){var m=h.alternate;m?(h.updateQueue=m.updateQueue,h.memoizedState=m.memoizedState,h.lanes=m.lanes):(h.updateQueue=null,h.memoizedState=null)}var _=Ew(o);if(_!==null){_.flags&=-257,Iw(_,o,a,i,e),_.mode&1&&ww(i,d,e),e=_,c=d;var R=e.updateQueue;if(R===null){var C=new Set;C.add(c),e.updateQueue=C}else R.add(c);break e}else{if(!(e&1)){ww(i,d,e),fy();break e}c=Error(G(426))}}else if(dt&&a.mode&1){var N=Ew(o);if(N!==null){!(N.flags&65536)&&(N.flags|=256),Iw(N,o,a,i,e),Gg(Ca(c,a));break e}}i=c=Ca(c,a),Mt!==4&&(Mt=2),Xl===null?Xl=[i]:Xl.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var T=fb(i,c,e);pw(i,T);break e;case 1:a=c;var y=i.type,v=i.stateNode;if(!(i.flags&128)&&(typeof y.getDerivedStateFromError=="function"||v!==null&&typeof v.componentDidCatch=="function"&&(ti===null||!ti.has(v)))){i.flags|=65536,e&=-e,i.lanes|=e;var E=pb(i,a,e);pw(i,E);break e}}i=i.return}while(i!==null)}Db(n)}catch(O){e=O,Pt===n&&n!==null&&(Pt=n=n.return);continue}break}while(!0)}function Pb(){var t=Wd.current;return Wd.current=Hd,t===null?Hd:t}function fy(){(Mt===0||Mt===3||Mt===2)&&(Mt=4),Kt===null||!(io&268435455)&&!(Fh&268435455)||Fs(Kt,Jt)}function Qd(t,e){var n=qe;qe|=2;var r=Pb();(Kt!==t||Jt!==e)&&(ts=null,Ki(t,e));do try{NN();break}catch(s){Nb(t,s)}while(!0);if(Qg(),qe=n,Wd.current=r,Pt!==null)throw Error(G(261));return Kt=null,Jt=0,Mt}function NN(){for(;Pt!==null;)kb(Pt)}function PN(){for(;Pt!==null&&!nR();)kb(Pt)}function kb(t){var e=Ob(t.alternate,t,Mn);t.memoizedProps=t.pendingProps,e===null?Db(t):Pt=e,ly.current=null}function Db(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=TN(n,e),n!==null){n.flags&=32767,Pt=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Mt=6,Pt=null;return}}else if(n=xN(n,e,Mn),n!==null){Pt=n;return}if(e=e.sibling,e!==null){Pt=e;return}Pt=e=t}while(e!==null);Mt===0&&(Mt=5)}function ji(t,e,n){var r=Ze,s=sr.transition;try{sr.transition=null,Ze=1,kN(t,e,n,r)}finally{sr.transition=s,Ze=r}return null}function kN(t,e,n,r){do pa();while(Ks!==null);if(qe&6)throw Error(G(327));n=t.finishedWork;var s=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(G(177));t.callbackNode=null,t.callbackPriority=0;var i=n.lanes|n.childLanes;if(hR(t,i),t===Kt&&(Pt=Kt=null,Jt=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Lu||(Lu=!0,Lb(Nd,function(){return pa(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=sr.transition,sr.transition=null;var o=Ze;Ze=1;var a=qe;qe|=4,ly.current=null,SN(t,n),Cb(n,t),JR(ym),kd=!!gm,ym=gm=null,t.current=n,CN(n),rR(),qe=a,Ze=o,sr.transition=i}else t.current=n;if(Lu&&(Lu=!1,Ks=t,Kd=s),i=t.pendingLanes,i===0&&(ti=null),oR(n.stateNode),Pn(t,bt()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)s=e[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(Gd)throw Gd=!1,t=Vm,Vm=null,t;return Kd&1&&t.tag!==0&&pa(),i=t.pendingLanes,i&1?t===Mm?Jl++:(Jl=0,Mm=t):Jl=0,wi(),null}function pa(){if(Ks!==null){var t=fT(Kd),e=sr.transition,n=Ze;try{if(sr.transition=null,Ze=16>t?16:t,Ks===null)var r=!1;else{if(t=Ks,Ks=null,Kd=0,qe&6)throw Error(G(331));var s=qe;for(qe|=4,oe=t.current;oe!==null;){var i=oe,o=i.child;if(oe.flags&16){var a=i.deletions;if(a!==null){for(var c=0;c<a.length;c++){var d=a[c];for(oe=d;oe!==null;){var h=oe;switch(h.tag){case 0:case 11:case 15:Yl(8,h,i)}var f=h.child;if(f!==null)f.return=h,oe=f;else for(;oe!==null;){h=oe;var m=h.sibling,_=h.return;if(Tb(h),h===d){oe=null;break}if(m!==null){m.return=_,oe=m;break}oe=_}}}var R=i.alternate;if(R!==null){var C=R.child;if(C!==null){R.child=null;do{var N=C.sibling;C.sibling=null,C=N}while(C!==null)}}oe=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,oe=o;else e:for(;oe!==null;){if(i=oe,i.flags&2048)switch(i.tag){case 0:case 11:case 15:Yl(9,i,i.return)}var T=i.sibling;if(T!==null){T.return=i.return,oe=T;break e}oe=i.return}}var y=t.current;for(oe=y;oe!==null;){o=oe;var v=o.child;if(o.subtreeFlags&2064&&v!==null)v.return=o,oe=v;else e:for(o=y;oe!==null;){if(a=oe,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:Mh(9,a)}}catch(O){wt(a,a.return,O)}if(a===o){oe=null;break e}var E=a.sibling;if(E!==null){E.return=a.return,oe=E;break e}oe=a.return}}if(qe=s,wi(),qr&&typeof qr.onPostCommitFiberRoot=="function")try{qr.onPostCommitFiberRoot(Nh,t)}catch{}r=!0}return r}finally{Ze=n,sr.transition=e}}return!1}function Ow(t,e,n){e=Ca(n,e),e=fb(t,e,1),t=ei(t,e,1),e=vn(),t!==null&&(Bc(t,1,e),Pn(t,e))}function wt(t,e,n){if(t.tag===3)Ow(t,t,n);else for(;e!==null;){if(e.tag===3){Ow(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(ti===null||!ti.has(r))){t=Ca(n,t),t=pb(e,t,1),e=ei(e,t,1),t=vn(),e!==null&&(Bc(e,1,t),Pn(e,t));break}}e=e.return}}function DN(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=vn(),t.pingedLanes|=t.suspendedLanes&n,Kt===t&&(Jt&n)===n&&(Mt===4||Mt===3&&(Jt&130023424)===Jt&&500>bt()-uy?Ki(t,0):cy|=n),Pn(t,e)}function jb(t,e){e===0&&(t.mode&1?(e=Su,Su<<=1,!(Su&130023424)&&(Su=4194304)):e=1);var n=vn();t=hs(t,e),t!==null&&(Bc(t,e,n),Pn(t,n))}function jN(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),jb(t,n)}function ON(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,s=t.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(G(314))}r!==null&&r.delete(e),jb(t,n)}var Ob;Ob=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||Rn.current)Cn=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return Cn=!1,IN(t,e,n);Cn=!!(t.flags&131072)}else Cn=!1,dt&&e.flags&1048576&&FT(e,Fd,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;id(t,e),t=e.pendingProps;var s=xa(e,dn.current);fa(e,n),s=ry(null,e,r,t,s,n);var i=sy();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Nn(r)?(i=!0,Vd(e)):i=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,Jg(e),s.updater=Vh,e.stateNode=s,s._reactInternals=e,Sm(e,r,t,n),e=Rm(null,e,r,!0,i,n)):(e.tag=0,dt&&i&&Hg(e),pn(null,e,s,n),e=e.child),e;case 16:r=e.elementType;e:{switch(id(t,e),t=e.pendingProps,s=r._init,r=s(r._payload),e.type=r,s=e.tag=VN(r),t=pr(r,t),s){case 0:e=Am(null,e,r,t,n);break e;case 1:e=bw(null,e,r,t,n);break e;case 11:e=xw(null,e,r,t,n);break e;case 14:e=Tw(null,e,r,pr(r.type,t),n);break e}throw Error(G(306,r,""))}return e;case 0:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:pr(r,s),Am(t,e,r,s,n);case 1:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:pr(r,s),bw(t,e,r,s,n);case 3:e:{if(vb(e),t===null)throw Error(G(387));r=e.pendingProps,i=e.memoizedState,s=i.element,HT(t,e),Bd(e,r,null,n);var o=e.memoizedState;if(r=o.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){s=Ca(Error(G(423)),e),e=Sw(t,e,r,n,s);break e}else if(r!==s){s=Ca(Error(G(424)),e),e=Sw(t,e,r,n,s);break e}else for($n=Zs(e.stateNode.containerInfo.firstChild),zn=e,dt=!0,yr=null,n=zT(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Ta(),r===s){e=fs(t,e,n);break e}pn(t,e,r,n)}e=e.child}return e;case 5:return WT(e),t===null&&xm(e),r=e.type,s=e.pendingProps,i=t!==null?t.memoizedProps:null,o=s.children,vm(r,s)?o=null:i!==null&&vm(r,i)&&(e.flags|=32),yb(t,e),pn(t,e,o,n),e.child;case 6:return t===null&&xm(e),null;case 13:return _b(t,e,n);case 4:return Zg(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=ba(e,null,r,n):pn(t,e,r,n),e.child;case 11:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:pr(r,s),xw(t,e,r,s,n);case 7:return pn(t,e,e.pendingProps,n),e.child;case 8:return pn(t,e,e.pendingProps.children,n),e.child;case 12:return pn(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,s=e.pendingProps,i=e.memoizedProps,o=s.value,ot(Ud,r._currentValue),r._currentValue=o,i!==null)if(Ir(i.value,o)){if(i.children===s.children&&!Rn.current){e=fs(t,e,n);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var a=i.dependencies;if(a!==null){o=i.child;for(var c=a.firstContext;c!==null;){if(c.context===r){if(i.tag===1){c=ls(-1,n&-n),c.tag=2;var d=i.updateQueue;if(d!==null){d=d.shared;var h=d.pending;h===null?c.next=c:(c.next=h.next,h.next=c),d.pending=c}}i.lanes|=n,c=i.alternate,c!==null&&(c.lanes|=n),Tm(i.return,n,e),a.lanes|=n;break}c=c.next}}else if(i.tag===10)o=i.type===e.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(G(341));o.lanes|=n,a=o.alternate,a!==null&&(a.lanes|=n),Tm(o,n,e),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===e){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}pn(t,e,s.children,n),e=e.child}return e;case 9:return s=e.type,r=e.pendingProps.children,fa(e,n),s=or(s),r=r(s),e.flags|=1,pn(t,e,r,n),e.child;case 14:return r=e.type,s=pr(r,e.pendingProps),s=pr(r.type,s),Tw(t,e,r,s,n);case 15:return mb(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:pr(r,s),id(t,e),e.tag=1,Nn(r)?(t=!0,Vd(e)):t=!1,fa(e,n),hb(e,r,s),Sm(e,r,s,n),Rm(null,e,r,!0,t,n);case 19:return wb(t,e,n);case 22:return gb(t,e,n)}throw Error(G(156,e.tag))};function Lb(t,e){return cT(t,e)}function LN(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function nr(t,e,n,r){return new LN(t,e,n,r)}function py(t){return t=t.prototype,!(!t||!t.isReactComponent)}function VN(t){if(typeof t=="function")return py(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Dg)return 11;if(t===jg)return 14}return 2}function ri(t,e){var n=t.alternate;return n===null?(n=nr(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function ld(t,e,n,r,s,i){var o=2;if(r=t,typeof t=="function")py(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case Xo:return Qi(n.children,s,i,e);case kg:o=8,s|=8;break;case Yp:return t=nr(12,n,e,s|2),t.elementType=Yp,t.lanes=i,t;case Xp:return t=nr(13,n,e,s),t.elementType=Xp,t.lanes=i,t;case Jp:return t=nr(19,n,e,s),t.elementType=Jp,t.lanes=i,t;case Wx:return Uh(n,s,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case qx:o=10;break e;case Hx:o=9;break e;case Dg:o=11;break e;case jg:o=14;break e;case Ls:o=16,r=null;break e}throw Error(G(130,t==null?t:typeof t,""))}return e=nr(o,n,e,s),e.elementType=t,e.type=r,e.lanes=i,e}function Qi(t,e,n,r){return t=nr(7,t,r,e),t.lanes=n,t}function Uh(t,e,n,r){return t=nr(22,t,r,e),t.elementType=Wx,t.lanes=n,t.stateNode={isHidden:!1},t}function gp(t,e,n){return t=nr(6,t,null,e),t.lanes=n,t}function yp(t,e,n){return e=nr(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function MN(t,e,n,r,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Xf(0),this.expirationTimes=Xf(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Xf(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function my(t,e,n,r,s,i,o,a,c){return t=new MN(t,e,n,a,c),e===1?(e=1,i===!0&&(e|=8)):e=0,i=nr(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Jg(i),t}function FN(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Yo,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function Vb(t){if(!t)return hi;t=t._reactInternals;e:{if(xo(t)!==t||t.tag!==1)throw Error(G(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Nn(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(G(171))}if(t.tag===1){var n=t.type;if(Nn(n))return VT(t,n,e)}return e}function Mb(t,e,n,r,s,i,o,a,c){return t=my(n,r,!0,t,s,i,o,a,c),t.context=Vb(null),n=t.current,r=vn(),s=ni(n),i=ls(r,s),i.callback=e??null,ei(n,i,s),t.current.lanes=s,Bc(t,s,r),Pn(t,r),t}function $h(t,e,n,r){var s=e.current,i=vn(),o=ni(s);return n=Vb(n),e.context===null?e.context=n:e.pendingContext=n,e=ls(i,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=ei(s,e,o),t!==null&&(wr(t,s,o,i),nd(t,s,o)),o}function Yd(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function Lw(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function gy(t,e){Lw(t,e),(t=t.alternate)&&Lw(t,e)}function UN(){return null}var Fb=typeof reportError=="function"?reportError:function(t){console.error(t)};function yy(t){this._internalRoot=t}Bh.prototype.render=yy.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(G(409));$h(t,e,null,null)};Bh.prototype.unmount=yy.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;oo(function(){$h(null,t,null,null)}),e[ds]=null}};function Bh(t){this._internalRoot=t}Bh.prototype.unstable_scheduleHydration=function(t){if(t){var e=gT();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Ms.length&&e!==0&&e<Ms[n].priority;n++);Ms.splice(n,0,t),n===0&&vT(t)}};function vy(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function zh(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function Vw(){}function $N(t,e,n,r,s){if(s){if(typeof r=="function"){var i=r;r=function(){var d=Yd(o);i.call(d)}}var o=Mb(e,r,t,0,null,!1,!1,"",Vw);return t._reactRootContainer=o,t[ds]=o.current,yc(t.nodeType===8?t.parentNode:t),oo(),o}for(;s=t.lastChild;)t.removeChild(s);if(typeof r=="function"){var a=r;r=function(){var d=Yd(c);a.call(d)}}var c=my(t,0,!1,null,null,!1,!1,"",Vw);return t._reactRootContainer=c,t[ds]=c.current,yc(t.nodeType===8?t.parentNode:t),oo(function(){$h(e,c,n,r)}),c}function qh(t,e,n,r,s){var i=n._reactRootContainer;if(i){var o=i;if(typeof s=="function"){var a=s;s=function(){var c=Yd(o);a.call(c)}}$h(e,o,t,s)}else o=$N(n,e,t,s,r);return Yd(o)}pT=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=Dl(e.pendingLanes);n!==0&&(Vg(e,n|1),Pn(e,bt()),!(qe&6)&&(Aa=bt()+500,wi()))}break;case 13:oo(function(){var r=hs(t,1);if(r!==null){var s=vn();wr(r,t,1,s)}}),gy(t,1)}};Mg=function(t){if(t.tag===13){var e=hs(t,134217728);if(e!==null){var n=vn();wr(e,t,134217728,n)}gy(t,134217728)}};mT=function(t){if(t.tag===13){var e=ni(t),n=hs(t,e);if(n!==null){var r=vn();wr(n,t,e,r)}gy(t,e)}};gT=function(){return Ze};yT=function(t,e){var n=Ze;try{return Ze=t,e()}finally{Ze=n}};lm=function(t,e,n){switch(e){case"input":if(tm(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var s=jh(r);if(!s)throw Error(G(90));Kx(r),tm(r,s)}}}break;case"textarea":Yx(t,n);break;case"select":e=n.value,e!=null&&ca(t,!!n.multiple,e,!1)}};rT=dy;sT=oo;var BN={usingClientEntryPoint:!1,Events:[qc,ta,jh,tT,nT,dy]},wl={findFiberByHostInstance:zi,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},zN={bundleType:wl.bundleType,version:wl.version,rendererPackageName:wl.rendererPackageName,rendererConfig:wl.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ws.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=aT(t),t===null?null:t.stateNode},findFiberByHostInstance:wl.findFiberByHostInstance||UN,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Vu=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Vu.isDisabled&&Vu.supportsFiber)try{Nh=Vu.inject(zN),qr=Vu}catch{}}Gn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=BN;Gn.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!vy(e))throw Error(G(200));return FN(t,e,null,n)};Gn.createRoot=function(t,e){if(!vy(t))throw Error(G(299));var n=!1,r="",s=Fb;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=my(t,1,!1,null,null,n,!1,r,s),t[ds]=e.current,yc(t.nodeType===8?t.parentNode:t),new yy(e)};Gn.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(G(188)):(t=Object.keys(t).join(","),Error(G(268,t)));return t=aT(e),t=t===null?null:t.stateNode,t};Gn.flushSync=function(t){return oo(t)};Gn.hydrate=function(t,e,n){if(!zh(e))throw Error(G(200));return qh(null,t,e,!0,n)};Gn.hydrateRoot=function(t,e,n){if(!vy(t))throw Error(G(405));var r=n!=null&&n.hydratedSources||null,s=!1,i="",o=Fb;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=Mb(e,null,t,1,n??null,s,!1,i,o),t[ds]=e.current,yc(t),r)for(t=0;t<r.length;t++)n=r[t],s=n._getVersion,s=s(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,s]:e.mutableSourceEagerHydrationData.push(n,s);return new Bh(e)};Gn.render=function(t,e,n){if(!zh(e))throw Error(G(200));return qh(null,t,e,!1,n)};Gn.unmountComponentAtNode=function(t){if(!zh(t))throw Error(G(40));return t._reactRootContainer?(oo(function(){qh(null,null,t,!1,function(){t._reactRootContainer=null,t[ds]=null})}),!0):!1};Gn.unstable_batchedUpdates=dy;Gn.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!zh(n))throw Error(G(200));if(t==null||t._reactInternals===void 0)throw Error(G(38));return qh(t,e,n,!1,r)};Gn.version="18.3.1-next-f1338f8080-20240426";function Ub(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Ub)}catch(t){console.error(t)}}Ub(),Ux.exports=Gn;var qN=Ux.exports,$b,Mw=qN;$b=Mw.createRoot,Mw.hydrateRoot;/**
 * react-router v7.9.6
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var Fw="popstate";function HN(t={}){function e(r,s){let{pathname:i,search:o,hash:a}=r.location;return $m("",{pathname:i,search:o,hash:a},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function n(r,s){return typeof s=="string"?s:Sc(s)}return GN(e,n,null,t)}function ht(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function lr(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function WN(){return Math.random().toString(36).substring(2,10)}function Uw(t,e){return{usr:t.state,key:t.key,idx:e}}function $m(t,e,n=null,r){return{pathname:typeof t=="string"?t:t.pathname,search:"",hash:"",...typeof e=="string"?Ga(e):e,state:n,key:e&&e.key||r||WN()}}function Sc({pathname:t="/",search:e="",hash:n=""}){return e&&e!=="?"&&(t+=e.charAt(0)==="?"?e:"?"+e),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function Ga(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substring(n),t=t.substring(0,n));let r=t.indexOf("?");r>=0&&(e.search=t.substring(r),t=t.substring(0,r)),t&&(e.pathname=t)}return e}function GN(t,e,n,r={}){let{window:s=document.defaultView,v5Compat:i=!1}=r,o=s.history,a="POP",c=null,d=h();d==null&&(d=0,o.replaceState({...o.state,idx:d},""));function h(){return(o.state||{idx:null}).idx}function f(){a="POP";let N=h(),T=N==null?null:N-d;d=N,c&&c({action:a,location:C.location,delta:T})}function m(N,T){a="PUSH";let y=$m(C.location,N,T);d=h()+1;let v=Uw(y,d),E=C.createHref(y);try{o.pushState(v,"",E)}catch(O){if(O instanceof DOMException&&O.name==="DataCloneError")throw O;s.location.assign(E)}i&&c&&c({action:a,location:C.location,delta:1})}function _(N,T){a="REPLACE";let y=$m(C.location,N,T);d=h();let v=Uw(y,d),E=C.createHref(y);o.replaceState(v,"",E),i&&c&&c({action:a,location:C.location,delta:0})}function R(N){return KN(N)}let C={get action(){return a},get location(){return t(s,o)},listen(N){if(c)throw new Error("A history only accepts one active listener");return s.addEventListener(Fw,f),c=N,()=>{s.removeEventListener(Fw,f),c=null}},createHref(N){return e(s,N)},createURL:R,encodeLocation(N){let T=R(N);return{pathname:T.pathname,search:T.search,hash:T.hash}},push:m,replace:_,go(N){return o.go(N)}};return C}function KN(t,e=!1){let n="http://localhost";typeof window<"u"&&(n=window.location.origin!=="null"?window.location.origin:window.location.href),ht(n,"No window.location.(origin|href) available to create URL");let r=typeof t=="string"?t:Sc(t);return r=r.replace(/ $/,"%20"),!e&&r.startsWith("//")&&(r=n+r),new URL(r,n)}function Bb(t,e,n="/"){return QN(t,e,n,!1)}function QN(t,e,n,r){let s=typeof e=="string"?Ga(e):e,i=ps(s.pathname||"/",n);if(i==null)return null;let o=zb(t);YN(o);let a=null;for(let c=0;a==null&&c<o.length;++c){let d=aP(i);a=iP(o[c],d,r)}return a}function zb(t,e=[],n=[],r="",s=!1){let i=(o,a,c=s,d)=>{let h={relativePath:d===void 0?o.path||"":d,caseSensitive:o.caseSensitive===!0,childrenIndex:a,route:o};if(h.relativePath.startsWith("/")){if(!h.relativePath.startsWith(r)&&c)return;ht(h.relativePath.startsWith(r),`Absolute route path "${h.relativePath}" nested under path "${r}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),h.relativePath=h.relativePath.slice(r.length)}let f=cs([r,h.relativePath]),m=n.concat(h);o.children&&o.children.length>0&&(ht(o.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${f}".`),zb(o.children,e,m,f,c)),!(o.path==null&&!o.index)&&e.push({path:f,score:rP(f,o.index),routesMeta:m})};return t.forEach((o,a)=>{var c;if(o.path===""||!((c=o.path)!=null&&c.includes("?")))i(o,a);else for(let d of qb(o.path))i(o,a,!0,d)}),e}function qb(t){let e=t.split("/");if(e.length===0)return[];let[n,...r]=e,s=n.endsWith("?"),i=n.replace(/\?$/,"");if(r.length===0)return s?[i,""]:[i];let o=qb(r.join("/")),a=[];return a.push(...o.map(c=>c===""?i:[i,c].join("/"))),s&&a.push(...o),a.map(c=>t.startsWith("/")&&c===""?"/":c)}function YN(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:sP(e.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}var XN=/^:[\w-]+$/,JN=3,ZN=2,eP=1,tP=10,nP=-2,$w=t=>t==="*";function rP(t,e){let n=t.split("/"),r=n.length;return n.some($w)&&(r+=nP),e&&(r+=ZN),n.filter(s=>!$w(s)).reduce((s,i)=>s+(XN.test(i)?JN:i===""?eP:tP),r)}function sP(t,e){return t.length===e.length&&t.slice(0,-1).every((r,s)=>r===e[s])?t[t.length-1]-e[e.length-1]:0}function iP(t,e,n=!1){let{routesMeta:r}=t,s={},i="/",o=[];for(let a=0;a<r.length;++a){let c=r[a],d=a===r.length-1,h=i==="/"?e:e.slice(i.length)||"/",f=Xd({path:c.relativePath,caseSensitive:c.caseSensitive,end:d},h),m=c.route;if(!f&&d&&n&&!r[r.length-1].route.index&&(f=Xd({path:c.relativePath,caseSensitive:c.caseSensitive,end:!1},h)),!f)return null;Object.assign(s,f.params),o.push({params:s,pathname:cs([i,f.pathname]),pathnameBase:hP(cs([i,f.pathnameBase])),route:m}),f.pathnameBase!=="/"&&(i=cs([i,f.pathnameBase]))}return o}function Xd(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,r]=oP(t.path,t.caseSensitive,t.end),s=e.match(n);if(!s)return null;let i=s[0],o=i.replace(/(.)\/+$/,"$1"),a=s.slice(1);return{params:r.reduce((d,{paramName:h,isOptional:f},m)=>{if(h==="*"){let R=a[m]||"";o=i.slice(0,i.length-R.length).replace(/(.)\/+$/,"$1")}const _=a[m];return f&&!_?d[h]=void 0:d[h]=(_||"").replace(/%2F/g,"/"),d},{}),pathname:i,pathnameBase:o,pattern:t}}function oP(t,e=!1,n=!0){lr(t==="*"||!t.endsWith("*")||t.endsWith("/*"),`Route path "${t}" will be treated as if it were "${t.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${t.replace(/\*$/,"/*")}".`);let r=[],s="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,a,c)=>(r.push({paramName:a,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return t.endsWith("*")?(r.push({paramName:"*"}),s+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?s+="\\/*$":t!==""&&t!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,e?void 0:"i"),r]}function aP(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return lr(!1,`The URL path "${t}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),t}}function ps(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,r=t.charAt(n);return r&&r!=="/"?null:t.slice(n)||"/"}var lP=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,cP=t=>lP.test(t);function uP(t,e="/"){let{pathname:n,search:r="",hash:s=""}=typeof t=="string"?Ga(t):t,i;if(n)if(cP(n))i=n;else{if(n.includes("//")){let o=n;n=n.replace(/\/\/+/g,"/"),lr(!1,`Pathnames cannot have embedded double slashes - normalizing ${o} -> ${n}`)}n.startsWith("/")?i=Bw(n.substring(1),"/"):i=Bw(n,e)}else i=e;return{pathname:i,search:fP(r),hash:pP(s)}}function Bw(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(s=>{s===".."?n.length>1&&n.pop():s!=="."&&n.push(s)}),n.length>1?n.join("/"):"/"}function vp(t,e,n,r){return`Cannot include a '${t}' character in a manually specified \`to.${e}\` field [${JSON.stringify(r)}].  Please separate it out to the \`to.${n}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function dP(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function _y(t){let e=dP(t);return e.map((n,r)=>r===e.length-1?n.pathname:n.pathnameBase)}function wy(t,e,n,r=!1){let s;typeof t=="string"?s=Ga(t):(s={...t},ht(!s.pathname||!s.pathname.includes("?"),vp("?","pathname","search",s)),ht(!s.pathname||!s.pathname.includes("#"),vp("#","pathname","hash",s)),ht(!s.search||!s.search.includes("#"),vp("#","search","hash",s)));let i=t===""||s.pathname==="",o=i?"/":s.pathname,a;if(o==null)a=n;else{let f=e.length-1;if(!r&&o.startsWith("..")){let m=o.split("/");for(;m[0]==="..";)m.shift(),f-=1;s.pathname=m.join("/")}a=f>=0?e[f]:"/"}let c=uP(s,a),d=o&&o!=="/"&&o.endsWith("/"),h=(i||o===".")&&n.endsWith("/");return!c.pathname.endsWith("/")&&(d||h)&&(c.pathname+="/"),c}var cs=t=>t.join("/").replace(/\/\/+/g,"/"),hP=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),fP=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,pP=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function mP(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var Hb=["POST","PUT","PATCH","DELETE"];new Set(Hb);var gP=["GET",...Hb];new Set(gP);var Ka=A.createContext(null);Ka.displayName="DataRouter";var Hh=A.createContext(null);Hh.displayName="DataRouterState";A.createContext(!1);var Wb=A.createContext({isTransitioning:!1});Wb.displayName="ViewTransition";var yP=A.createContext(new Map);yP.displayName="Fetchers";var vP=A.createContext(null);vP.displayName="Await";var Sr=A.createContext(null);Sr.displayName="Navigation";var Wc=A.createContext(null);Wc.displayName="Location";var Cr=A.createContext({outlet:null,matches:[],isDataRoute:!1});Cr.displayName="Route";var Ey=A.createContext(null);Ey.displayName="RouteError";function _P(t,{relative:e}={}){ht(Qa(),"useHref() may be used only in the context of a <Router> component.");let{basename:n,navigator:r}=A.useContext(Sr),{hash:s,pathname:i,search:o}=Gc(t,{relative:e}),a=i;return n!=="/"&&(a=i==="/"?n:cs([n,i])),r.createHref({pathname:a,search:o,hash:s})}function Qa(){return A.useContext(Wc)!=null}function Dn(){return ht(Qa(),"useLocation() may be used only in the context of a <Router> component."),A.useContext(Wc).location}var Gb="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function Kb(t){A.useContext(Sr).static||A.useLayoutEffect(t)}function Es(){let{isDataRoute:t}=A.useContext(Cr);return t?DP():wP()}function wP(){ht(Qa(),"useNavigate() may be used only in the context of a <Router> component.");let t=A.useContext(Ka),{basename:e,navigator:n}=A.useContext(Sr),{matches:r}=A.useContext(Cr),{pathname:s}=Dn(),i=JSON.stringify(_y(r)),o=A.useRef(!1);return Kb(()=>{o.current=!0}),A.useCallback((c,d={})=>{if(lr(o.current,Gb),!o.current)return;if(typeof c=="number"){n.go(c);return}let h=wy(c,JSON.parse(i),s,d.relative==="path");t==null&&e!=="/"&&(h.pathname=h.pathname==="/"?e:cs([e,h.pathname])),(d.replace?n.replace:n.push)(h,d.state,d)},[e,n,i,s,t])}A.createContext(null);function EP(){let{matches:t}=A.useContext(Cr),e=t[t.length-1];return e?e.params:{}}function Gc(t,{relative:e}={}){let{matches:n}=A.useContext(Cr),{pathname:r}=Dn(),s=JSON.stringify(_y(n));return A.useMemo(()=>wy(t,JSON.parse(s),r,e==="path"),[t,s,r,e])}function IP(t,e){return Qb(t,e)}function Qb(t,e,n,r,s){var y;ht(Qa(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:i}=A.useContext(Sr),{matches:o}=A.useContext(Cr),a=o[o.length-1],c=a?a.params:{},d=a?a.pathname:"/",h=a?a.pathnameBase:"/",f=a&&a.route;{let v=f&&f.path||"";Yb(d,!f||v.endsWith("*")||v.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${d}" (under <Route path="${v}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${v}"> to <Route path="${v==="/"?"*":`${v}/*`}">.`)}let m=Dn(),_;if(e){let v=typeof e=="string"?Ga(e):e;ht(h==="/"||((y=v.pathname)==null?void 0:y.startsWith(h)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${h}" but pathname "${v.pathname}" was given in the \`location\` prop.`),_=v}else _=m;let R=_.pathname||"/",C=R;if(h!=="/"){let v=h.replace(/^\//,"").split("/");C="/"+R.replace(/^\//,"").split("/").slice(v.length).join("/")}let N=Bb(t,{pathname:C});lr(f||N!=null,`No routes matched location "${_.pathname}${_.search}${_.hash}" `),lr(N==null||N[N.length-1].route.element!==void 0||N[N.length-1].route.Component!==void 0||N[N.length-1].route.lazy!==void 0,`Matched leaf route at location "${_.pathname}${_.search}${_.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let T=CP(N&&N.map(v=>Object.assign({},v,{params:Object.assign({},c,v.params),pathname:cs([h,i.encodeLocation?i.encodeLocation(v.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:v.pathname]),pathnameBase:v.pathnameBase==="/"?h:cs([h,i.encodeLocation?i.encodeLocation(v.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:v.pathnameBase])})),o,n,r,s);return e&&T?A.createElement(Wc.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",..._},navigationType:"POP"}},T):T}function xP(){let t=kP(),e=mP(t)?`${t.status} ${t.statusText}`:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,r="rgba(200,200,200, 0.5)",s={padding:"0.5rem",backgroundColor:r},i={padding:"2px 4px",backgroundColor:r},o=null;return console.error("Error handled by React Router default ErrorBoundary:",t),o=A.createElement(A.Fragment,null,A.createElement("p",null," Hey developer "),A.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",A.createElement("code",{style:i},"ErrorBoundary")," or"," ",A.createElement("code",{style:i},"errorElement")," prop on your route.")),A.createElement(A.Fragment,null,A.createElement("h2",null,"Unexpected Application Error!"),A.createElement("h3",{style:{fontStyle:"italic"}},e),n?A.createElement("pre",{style:s},n):null,o)}var TP=A.createElement(xP,null),bP=class extends A.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,e){return e.location!==t.location||e.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:e.error,location:e.location,revalidation:t.revalidation||e.revalidation}}componentDidCatch(t,e){this.props.onError?this.props.onError(t,e):console.error("React Router caught the following error during render",t)}render(){return this.state.error!==void 0?A.createElement(Cr.Provider,{value:this.props.routeContext},A.createElement(Ey.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function SP({routeContext:t,match:e,children:n}){let r=A.useContext(Ka);return r&&r.static&&r.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=e.route.id),A.createElement(Cr.Provider,{value:t},n)}function CP(t,e=[],n=null,r=null,s=null){if(t==null){if(!n)return null;if(n.errors)t=n.matches;else if(e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let i=t,o=n==null?void 0:n.errors;if(o!=null){let h=i.findIndex(f=>f.route.id&&(o==null?void 0:o[f.route.id])!==void 0);ht(h>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(o).join(",")}`),i=i.slice(0,Math.min(i.length,h+1))}let a=!1,c=-1;if(n)for(let h=0;h<i.length;h++){let f=i[h];if((f.route.HydrateFallback||f.route.hydrateFallbackElement)&&(c=h),f.route.id){let{loaderData:m,errors:_}=n,R=f.route.loader&&!m.hasOwnProperty(f.route.id)&&(!_||_[f.route.id]===void 0);if(f.route.lazy||R){a=!0,c>=0?i=i.slice(0,c+1):i=[i[0]];break}}}let d=n&&r?(h,f)=>{var m,_;r(h,{location:n.location,params:((_=(m=n.matches)==null?void 0:m[0])==null?void 0:_.params)??{},errorInfo:f})}:void 0;return i.reduceRight((h,f,m)=>{let _,R=!1,C=null,N=null;n&&(_=o&&f.route.id?o[f.route.id]:void 0,C=f.route.errorElement||TP,a&&(c<0&&m===0?(Yb("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),R=!0,N=null):c===m&&(R=!0,N=f.route.hydrateFallbackElement||null)));let T=e.concat(i.slice(0,m+1)),y=()=>{let v;return _?v=C:R?v=N:f.route.Component?v=A.createElement(f.route.Component,null):f.route.element?v=f.route.element:v=h,A.createElement(SP,{match:f,routeContext:{outlet:h,matches:T,isDataRoute:n!=null},children:v})};return n&&(f.route.ErrorBoundary||f.route.errorElement||m===0)?A.createElement(bP,{location:n.location,revalidation:n.revalidation,component:C,error:_,children:y(),routeContext:{outlet:null,matches:T,isDataRoute:!0},onError:d}):y()},null)}function Iy(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function AP(t){let e=A.useContext(Ka);return ht(e,Iy(t)),e}function RP(t){let e=A.useContext(Hh);return ht(e,Iy(t)),e}function NP(t){let e=A.useContext(Cr);return ht(e,Iy(t)),e}function xy(t){let e=NP(t),n=e.matches[e.matches.length-1];return ht(n.route.id,`${t} can only be used on routes that contain a unique "id"`),n.route.id}function PP(){return xy("useRouteId")}function kP(){var r;let t=A.useContext(Ey),e=RP("useRouteError"),n=xy("useRouteError");return t!==void 0?t:(r=e.errors)==null?void 0:r[n]}function DP(){let{router:t}=AP("useNavigate"),e=xy("useNavigate"),n=A.useRef(!1);return Kb(()=>{n.current=!0}),A.useCallback(async(s,i={})=>{lr(n.current,Gb),n.current&&(typeof s=="number"?t.navigate(s):await t.navigate(s,{fromRouteId:e,...i}))},[t,e])}var zw={};function Yb(t,e,n){!e&&!zw[t]&&(zw[t]=!0,lr(!1,n))}A.memo(jP);function jP({routes:t,future:e,state:n,unstable_onError:r}){return Qb(t,void 0,n,r,e)}function Jd({to:t,replace:e,state:n,relative:r}){ht(Qa(),"<Navigate> may be used only in the context of a <Router> component.");let{static:s}=A.useContext(Sr);lr(!s,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:i}=A.useContext(Cr),{pathname:o}=Dn(),a=Es(),c=wy(t,_y(i),o,r==="path"),d=JSON.stringify(c);return A.useEffect(()=>{a(JSON.parse(d),{replace:e,state:n,relative:r})},[a,d,r,e,n]),null}function qo(t){ht(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function OP({basename:t="/",children:e=null,location:n,navigationType:r="POP",navigator:s,static:i=!1}){ht(!Qa(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let o=t.replace(/^\/*/,"/"),a=A.useMemo(()=>({basename:o,navigator:s,static:i,future:{}}),[o,s,i]);typeof n=="string"&&(n=Ga(n));let{pathname:c="/",search:d="",hash:h="",state:f=null,key:m="default"}=n,_=A.useMemo(()=>{let R=ps(c,o);return R==null?null:{location:{pathname:R,search:d,hash:h,state:f,key:m},navigationType:r}},[o,c,d,h,f,m,r]);return lr(_!=null,`<Router basename="${o}"> is not able to match the URL "${c}${d}${h}" because it does not start with the basename, so the <Router> won't render anything.`),_==null?null:A.createElement(Sr.Provider,{value:a},A.createElement(Wc.Provider,{children:e,value:_}))}function LP({children:t,location:e}){return IP(Bm(t),e)}function Bm(t,e=[]){let n=[];return A.Children.forEach(t,(r,s)=>{if(!A.isValidElement(r))return;let i=[...e,s];if(r.type===A.Fragment){n.push.apply(n,Bm(r.props.children,i));return}ht(r.type===qo,`[${typeof r.type=="string"?r.type:r.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),ht(!r.props.index||!r.props.children,"An index route cannot have child routes.");let o={id:r.props.id||i.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,middleware:r.props.middleware,loader:r.props.loader,action:r.props.action,hydrateFallbackElement:r.props.hydrateFallbackElement,HydrateFallback:r.props.HydrateFallback,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.hasErrorBoundary===!0||r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(o.children=Bm(r.props.children,i)),n.push(o)}),n}var cd="get",ud="application/x-www-form-urlencoded";function Wh(t){return t!=null&&typeof t.tagName=="string"}function VP(t){return Wh(t)&&t.tagName.toLowerCase()==="button"}function MP(t){return Wh(t)&&t.tagName.toLowerCase()==="form"}function FP(t){return Wh(t)&&t.tagName.toLowerCase()==="input"}function UP(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function $P(t,e){return t.button===0&&(!e||e==="_self")&&!UP(t)}var Mu=null;function BP(){if(Mu===null)try{new FormData(document.createElement("form"),0),Mu=!1}catch{Mu=!0}return Mu}var zP=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function _p(t){return t!=null&&!zP.has(t)?(lr(!1,`"${t}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${ud}"`),null):t}function qP(t,e){let n,r,s,i,o;if(MP(t)){let a=t.getAttribute("action");r=a?ps(a,e):null,n=t.getAttribute("method")||cd,s=_p(t.getAttribute("enctype"))||ud,i=new FormData(t)}else if(VP(t)||FP(t)&&(t.type==="submit"||t.type==="image")){let a=t.form;if(a==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let c=t.getAttribute("formaction")||a.getAttribute("action");if(r=c?ps(c,e):null,n=t.getAttribute("formmethod")||a.getAttribute("method")||cd,s=_p(t.getAttribute("formenctype"))||_p(a.getAttribute("enctype"))||ud,i=new FormData(a,t),!BP()){let{name:d,type:h,value:f}=t;if(h==="image"){let m=d?`${d}.`:"";i.append(`${m}x`,"0"),i.append(`${m}y`,"0")}else d&&i.append(d,f)}}else{if(Wh(t))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');n=cd,r=null,s=ud,o=t}return i&&s==="text/plain"&&(o=i,i=void 0),{action:r,method:n.toLowerCase(),encType:s,formData:i,body:o}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function Ty(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function HP(t,e,n){let r=typeof t=="string"?new URL(t,typeof window>"u"?"server://singlefetch/":window.location.origin):t;return r.pathname==="/"?r.pathname=`_root.${n}`:e&&ps(r.pathname,e)==="/"?r.pathname=`${e.replace(/\/$/,"")}/_root.${n}`:r.pathname=`${r.pathname.replace(/\/$/,"")}.${n}`,r}async function WP(t,e){if(t.id in e)return e[t.id];try{let n=await import(t.module);return e[t.id]=n,n}catch(n){return console.error(`Error loading route module \`${t.module}\`, reloading page...`),console.error(n),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function GP(t){return t==null?!1:t.href==null?t.rel==="preload"&&typeof t.imageSrcSet=="string"&&typeof t.imageSizes=="string":typeof t.rel=="string"&&typeof t.href=="string"}async function KP(t,e,n){let r=await Promise.all(t.map(async s=>{let i=e.routes[s.route.id];if(i){let o=await WP(i,n);return o.links?o.links():[]}return[]}));return JP(r.flat(1).filter(GP).filter(s=>s.rel==="stylesheet"||s.rel==="preload").map(s=>s.rel==="stylesheet"?{...s,rel:"prefetch",as:"style"}:{...s,rel:"prefetch"}))}function qw(t,e,n,r,s,i){let o=(c,d)=>n[d]?c.route.id!==n[d].route.id:!0,a=(c,d)=>{var h;return n[d].pathname!==c.pathname||((h=n[d].route.path)==null?void 0:h.endsWith("*"))&&n[d].params["*"]!==c.params["*"]};return i==="assets"?e.filter((c,d)=>o(c,d)||a(c,d)):i==="data"?e.filter((c,d)=>{var f;let h=r.routes[c.route.id];if(!h||!h.hasLoader)return!1;if(o(c,d)||a(c,d))return!0;if(c.route.shouldRevalidate){let m=c.route.shouldRevalidate({currentUrl:new URL(s.pathname+s.search+s.hash,window.origin),currentParams:((f=n[0])==null?void 0:f.params)||{},nextUrl:new URL(t,window.origin),nextParams:c.params,defaultShouldRevalidate:!0});if(typeof m=="boolean")return m}return!0}):[]}function QP(t,e,{includeHydrateFallback:n}={}){return YP(t.map(r=>{let s=e.routes[r.route.id];if(!s)return[];let i=[s.module];return s.clientActionModule&&(i=i.concat(s.clientActionModule)),s.clientLoaderModule&&(i=i.concat(s.clientLoaderModule)),n&&s.hydrateFallbackModule&&(i=i.concat(s.hydrateFallbackModule)),s.imports&&(i=i.concat(s.imports)),i}).flat(1))}function YP(t){return[...new Set(t)]}function XP(t){let e={},n=Object.keys(t).sort();for(let r of n)e[r]=t[r];return e}function JP(t,e){let n=new Set;return new Set(e),t.reduce((r,s)=>{let i=JSON.stringify(XP(s));return n.has(i)||(n.add(i),r.push({key:i,link:s})),r},[])}function Xb(){let t=A.useContext(Ka);return Ty(t,"You must render this element inside a <DataRouterContext.Provider> element"),t}function ZP(){let t=A.useContext(Hh);return Ty(t,"You must render this element inside a <DataRouterStateContext.Provider> element"),t}var by=A.createContext(void 0);by.displayName="FrameworkContext";function Jb(){let t=A.useContext(by);return Ty(t,"You must render this element inside a <HydratedRouter> element"),t}function ek(t,e){let n=A.useContext(by),[r,s]=A.useState(!1),[i,o]=A.useState(!1),{onFocus:a,onBlur:c,onMouseEnter:d,onMouseLeave:h,onTouchStart:f}=e,m=A.useRef(null);A.useEffect(()=>{if(t==="render"&&o(!0),t==="viewport"){let C=T=>{T.forEach(y=>{o(y.isIntersecting)})},N=new IntersectionObserver(C,{threshold:.5});return m.current&&N.observe(m.current),()=>{N.disconnect()}}},[t]),A.useEffect(()=>{if(r){let C=setTimeout(()=>{o(!0)},100);return()=>{clearTimeout(C)}}},[r]);let _=()=>{s(!0)},R=()=>{s(!1),o(!1)};return n?t!=="intent"?[i,m,{}]:[i,m,{onFocus:El(a,_),onBlur:El(c,R),onMouseEnter:El(d,_),onMouseLeave:El(h,R),onTouchStart:El(f,_)}]:[!1,m,{}]}function El(t,e){return n=>{t&&t(n),n.defaultPrevented||e(n)}}function tk({page:t,...e}){let{router:n}=Xb(),r=A.useMemo(()=>Bb(n.routes,t,n.basename),[n.routes,t,n.basename]);return r?A.createElement(rk,{page:t,matches:r,...e}):null}function nk(t){let{manifest:e,routeModules:n}=Jb(),[r,s]=A.useState([]);return A.useEffect(()=>{let i=!1;return KP(t,e,n).then(o=>{i||s(o)}),()=>{i=!0}},[t,e,n]),r}function rk({page:t,matches:e,...n}){let r=Dn(),{manifest:s,routeModules:i}=Jb(),{basename:o}=Xb(),{loaderData:a,matches:c}=ZP(),d=A.useMemo(()=>qw(t,e,c,s,r,"data"),[t,e,c,s,r]),h=A.useMemo(()=>qw(t,e,c,s,r,"assets"),[t,e,c,s,r]),f=A.useMemo(()=>{if(t===r.pathname+r.search+r.hash)return[];let R=new Set,C=!1;if(e.forEach(T=>{var v;let y=s.routes[T.route.id];!y||!y.hasLoader||(!d.some(E=>E.route.id===T.route.id)&&T.route.id in a&&((v=i[T.route.id])!=null&&v.shouldRevalidate)||y.hasClientLoader?C=!0:R.add(T.route.id))}),R.size===0)return[];let N=HP(t,o,"data");return C&&R.size>0&&N.searchParams.set("_routes",e.filter(T=>R.has(T.route.id)).map(T=>T.route.id).join(",")),[N.pathname+N.search]},[o,a,r,s,d,e,t,i]),m=A.useMemo(()=>QP(h,s),[h,s]),_=nk(h);return A.createElement(A.Fragment,null,f.map(R=>A.createElement("link",{key:R,rel:"prefetch",as:"fetch",href:R,...n})),m.map(R=>A.createElement("link",{key:R,rel:"modulepreload",href:R,...n})),_.map(({key:R,link:C})=>A.createElement("link",{key:R,nonce:n.nonce,...C})))}function sk(...t){return e=>{t.forEach(n=>{typeof n=="function"?n(e):n!=null&&(n.current=e)})}}var Zb=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{Zb&&(window.__reactRouterVersion="7.9.6")}catch{}function ik({basename:t,children:e,window:n}){let r=A.useRef();r.current==null&&(r.current=HN({window:n,v5Compat:!0}));let s=r.current,[i,o]=A.useState({action:s.action,location:s.location}),a=A.useCallback(c=>{A.startTransition(()=>o(c))},[o]);return A.useLayoutEffect(()=>s.listen(a),[s,a]),A.createElement(OP,{basename:t,children:e,location:i.location,navigationType:i.action,navigator:s})}var e0=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,t0=A.forwardRef(function({onClick:e,discover:n="render",prefetch:r="none",relative:s,reloadDocument:i,replace:o,state:a,target:c,to:d,preventScrollReset:h,viewTransition:f,...m},_){let{basename:R}=A.useContext(Sr),C=typeof d=="string"&&e0.test(d),N,T=!1;if(typeof d=="string"&&C&&(N=d,Zb))try{let w=new URL(window.location.href),P=d.startsWith("//")?new URL(w.protocol+d):new URL(d),D=ps(P.pathname,R);P.origin===w.origin&&D!=null?d=D+P.search+P.hash:T=!0}catch{lr(!1,`<Link to="${d}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let y=_P(d,{relative:s}),[v,E,O]=ek(r,m),F=lk(d,{replace:o,state:a,target:c,preventScrollReset:h,relative:s,viewTransition:f});function x(w){e&&e(w),w.defaultPrevented||F(w)}let I=A.createElement("a",{...m,...O,href:N||y,onClick:T||i?e:x,ref:sk(_,E),target:c,"data-discover":!C&&n==="render"?"true":void 0});return v&&!C?A.createElement(A.Fragment,null,I,A.createElement(tk,{page:y})):I});t0.displayName="Link";var Ho=A.forwardRef(function({"aria-current":e="page",caseSensitive:n=!1,className:r="",end:s=!1,style:i,to:o,viewTransition:a,children:c,...d},h){let f=Gc(o,{relative:d.relative}),m=Dn(),_=A.useContext(Hh),{navigator:R,basename:C}=A.useContext(Sr),N=_!=null&&fk(f)&&a===!0,T=R.encodeLocation?R.encodeLocation(f).pathname:f.pathname,y=m.pathname,v=_&&_.navigation&&_.navigation.location?_.navigation.location.pathname:null;n||(y=y.toLowerCase(),v=v?v.toLowerCase():null,T=T.toLowerCase()),v&&C&&(v=ps(v,C)||v);const E=T!=="/"&&T.endsWith("/")?T.length-1:T.length;let O=y===T||!s&&y.startsWith(T)&&y.charAt(E)==="/",F=v!=null&&(v===T||!s&&v.startsWith(T)&&v.charAt(T.length)==="/"),x={isActive:O,isPending:F,isTransitioning:N},I=O?e:void 0,w;typeof r=="function"?w=r(x):w=[r,O?"active":null,F?"pending":null,N?"transitioning":null].filter(Boolean).join(" ");let P=typeof i=="function"?i(x):i;return A.createElement(t0,{...d,"aria-current":I,className:w,ref:h,style:P,to:o,viewTransition:a},typeof c=="function"?c(x):c)});Ho.displayName="NavLink";var ok=A.forwardRef(({discover:t="render",fetcherKey:e,navigate:n,reloadDocument:r,replace:s,state:i,method:o=cd,action:a,onSubmit:c,relative:d,preventScrollReset:h,viewTransition:f,...m},_)=>{let R=dk(),C=hk(a,{relative:d}),N=o.toLowerCase()==="get"?"get":"post",T=typeof a=="string"&&e0.test(a),y=v=>{if(c&&c(v),v.defaultPrevented)return;v.preventDefault();let E=v.nativeEvent.submitter,O=(E==null?void 0:E.getAttribute("formmethod"))||o;R(E||v.currentTarget,{fetcherKey:e,method:O,navigate:n,replace:s,state:i,relative:d,preventScrollReset:h,viewTransition:f})};return A.createElement("form",{ref:_,method:N,action:C,onSubmit:r?c:y,...m,"data-discover":!T&&t==="render"?"true":void 0})});ok.displayName="Form";function ak(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function n0(t){let e=A.useContext(Ka);return ht(e,ak(t)),e}function lk(t,{target:e,replace:n,state:r,preventScrollReset:s,relative:i,viewTransition:o}={}){let a=Es(),c=Dn(),d=Gc(t,{relative:i});return A.useCallback(h=>{if($P(h,e)){h.preventDefault();let f=n!==void 0?n:Sc(c)===Sc(d);a(t,{replace:f,state:r,preventScrollReset:s,relative:i,viewTransition:o})}},[c,a,d,n,r,e,t,s,i,o])}var ck=0,uk=()=>`__${String(++ck)}__`;function dk(){let{router:t}=n0("useSubmit"),{basename:e}=A.useContext(Sr),n=PP();return A.useCallback(async(r,s={})=>{let{action:i,method:o,encType:a,formData:c,body:d}=qP(r,e);if(s.navigate===!1){let h=s.fetcherKey||uk();await t.fetch(h,n,s.action||i,{preventScrollReset:s.preventScrollReset,formData:c,body:d,formMethod:s.method||o,formEncType:s.encType||a,flushSync:s.flushSync})}else await t.navigate(s.action||i,{preventScrollReset:s.preventScrollReset,formData:c,body:d,formMethod:s.method||o,formEncType:s.encType||a,replace:s.replace,state:s.state,fromRouteId:n,flushSync:s.flushSync,viewTransition:s.viewTransition})},[t,e,n])}function hk(t,{relative:e}={}){let{basename:n}=A.useContext(Sr),r=A.useContext(Cr);ht(r,"useFormAction must be used inside a RouteContext");let[s]=r.matches.slice(-1),i={...Gc(t||".",{relative:e})},o=Dn();if(t==null){i.search=o.search;let a=new URLSearchParams(i.search),c=a.getAll("index");if(c.some(h=>h==="")){a.delete("index"),c.filter(f=>f).forEach(f=>a.append("index",f));let h=a.toString();i.search=h?`?${h}`:""}}return(!t||t===".")&&s.route.index&&(i.search=i.search?i.search.replace(/^\?/,"?index&"):"?index"),n!=="/"&&(i.pathname=i.pathname==="/"?n:cs([n,i.pathname])),Sc(i)}function fk(t,{relative:e}={}){let n=A.useContext(Wb);ht(n!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:r}=n0("useViewTransitionState"),s=Gc(t,{relative:e});if(!n.isTransitioning)return!1;let i=ps(n.currentLocation.pathname,r)||n.currentLocation.pathname,o=ps(n.nextLocation.pathname,r)||n.nextLocation.pathname;return Xd(s.pathname,o)!=null||Xd(s.pathname,i)!=null}const pk=()=>{};var Hw={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const r0=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let s=t.charCodeAt(r);s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=s&63|128):(s&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=s&63|128):(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=s&63|128)}return e},mk=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const s=t[n++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=t[n++];e[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=t[n++],o=t[n++],a=t[n++],c=((s&7)<<18|(i&63)<<12|(o&63)<<6|a&63)-65536;e[r++]=String.fromCharCode(55296+(c>>10)),e[r++]=String.fromCharCode(56320+(c&1023))}else{const i=t[n++],o=t[n++];e[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|o&63)}}return e.join("")},s0={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<t.length;s+=3){const i=t[s],o=s+1<t.length,a=o?t[s+1]:0,c=s+2<t.length,d=c?t[s+2]:0,h=i>>2,f=(i&3)<<4|a>>4;let m=(a&15)<<2|d>>6,_=d&63;c||(_=64,o||(m=64)),r.push(n[h],n[f],n[m],n[_])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(r0(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):mk(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<t.length;){const i=n[t.charAt(s++)],a=s<t.length?n[t.charAt(s)]:0;++s;const d=s<t.length?n[t.charAt(s)]:64;++s;const f=s<t.length?n[t.charAt(s)]:64;if(++s,i==null||a==null||d==null||f==null)throw new gk;const m=i<<2|a>>4;if(r.push(m),d!==64){const _=a<<4&240|d>>2;if(r.push(_),f!==64){const R=d<<6&192|f;r.push(R)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class gk extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const yk=function(t){const e=r0(t);return s0.encodeByteArray(e,!0)},Zd=function(t){return yk(t).replace(/\./g,"")},i0=function(t){try{return s0.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function o0(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vk=()=>o0().__FIREBASE_DEFAULTS__,_k=()=>{if(typeof process>"u"||typeof Hw>"u")return;const t=Hw.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},wk=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&i0(t[1]);return e&&JSON.parse(e)},Gh=()=>{try{return pk()||vk()||_k()||wk()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},a0=t=>{var e,n;return(n=(e=Gh())==null?void 0:e.emulatorHosts)==null?void 0:n[t]},l0=t=>{const e=a0(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},c0=()=>{var t;return(t=Gh())==null?void 0:t.config},u0=t=>{var e;return(e=Gh())==null?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ek{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ei(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function Sy(t){return(await fetch(t,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function d0(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",s=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o={iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}},...t};return[Zd(JSON.stringify(n)),Zd(JSON.stringify(o)),""].join(".")}const Zl={};function Ik(){const t={prod:[],emulator:[]};for(const e of Object.keys(Zl))Zl[e]?t.emulator.push(e):t.prod.push(e);return t}function xk(t){let e=document.getElementById(t),n=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),n=!0),{created:n,element:e}}let Ww=!1;function Cy(t,e){if(typeof window>"u"||typeof document>"u"||!Ei(window.location.host)||Zl[t]===e||Zl[t]||Ww)return;Zl[t]=e;function n(m){return`__firebase__banner__${m}`}const r="__firebase__banner",i=Ik().prod.length>0;function o(){const m=document.getElementById(r);m&&m.remove()}function a(m){m.style.display="flex",m.style.background="#7faaf0",m.style.position="fixed",m.style.bottom="5px",m.style.left="5px",m.style.padding=".5em",m.style.borderRadius="5px",m.style.alignItems="center"}function c(m,_){m.setAttribute("width","24"),m.setAttribute("id",_),m.setAttribute("height","24"),m.setAttribute("viewBox","0 0 24 24"),m.setAttribute("fill","none"),m.style.marginLeft="-6px"}function d(){const m=document.createElement("span");return m.style.cursor="pointer",m.style.marginLeft="16px",m.style.fontSize="24px",m.innerHTML=" &times;",m.onclick=()=>{Ww=!0,o()},m}function h(m,_){m.setAttribute("id",_),m.innerText="Learn more",m.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",m.setAttribute("target","__blank"),m.style.paddingLeft="5px",m.style.textDecoration="underline"}function f(){const m=xk(r),_=n("text"),R=document.getElementById(_)||document.createElement("span"),C=n("learnmore"),N=document.getElementById(C)||document.createElement("a"),T=n("preprendIcon"),y=document.getElementById(T)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(m.created){const v=m.element;a(v),h(N,C);const E=d();c(y,T),v.append(y,R,N,E),document.body.appendChild(v)}i?(R.innerText="Preview backend disconnected.",y.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(y.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,R.innerText="Preview backend running in this workspace."),R.setAttribute("id",_)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",f):f()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ft(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function Tk(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Ft())}function h0(){var e;const t=(e=Gh())==null?void 0:e.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function bk(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function f0(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function Sk(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function Ck(){const t=Ft();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function p0(){return!h0()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function m0(){return!h0()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function Ay(){try{return typeof indexedDB=="object"}catch{return!1}}function g0(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{var i;e(((i=s.error)==null?void 0:i.message)||"")}}catch(n){e(n)}})}function Ak(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rk="FirebaseError";class ur extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=Rk,Object.setPrototypeOf(this,ur.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,To.prototype.create)}}class To{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},s=`${this.service}/${e}`,i=this.errors[e],o=i?Nk(i,r):"Error",a=`${this.serviceName}: ${o} (${s}).`;return new ur(s,a,r)}}function Nk(t,e){return t.replace(Pk,(n,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const Pk=/\{\$([^}]+)}/g;function kk(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function ms(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const s of n){if(!r.includes(s))return!1;const i=t[s],o=e[s];if(Gw(i)&&Gw(o)){if(!ms(i,o))return!1}else if(i!==o)return!1}for(const s of r)if(!n.includes(s))return!1;return!0}function Gw(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kc(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(s=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function Ol(t){const e={};return t.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[s,i]=r.split("=");e[decodeURIComponent(s)]=decodeURIComponent(i)}}),e}function Ll(t){const e=t.indexOf("?");if(!e)return"";const n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}function Dk(t,e){const n=new jk(t,e);return n.subscribe.bind(n)}class jk{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let s;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");Ok(e,["next","error","complete"])?s=e:s={next:e,error:n,complete:r},s.next===void 0&&(s.next=wp),s.error===void 0&&(s.error=wp),s.complete===void 0&&(s.complete=wp);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function Ok(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function wp(){}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lk=1e3,Vk=2,Mk=4*60*60*1e3,Fk=.5;function Kw(t,e=Lk,n=Vk){const r=e*Math.pow(n,t),s=Math.round(Fk*r*(Math.random()-.5)*2);return Math.min(Mk,r+s)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qe(t){return t&&t._delegate?t._delegate:t}class cr{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Oi="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uk{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new Ek;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:n});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){const n=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),r=(e==null?void 0:e.optional)??!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(s){if(r)return null;throw s}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(Bk(e))try{this.getOrInitializeService({instanceIdentifier:Oi})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(n);try{const i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(e=Oi){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Oi){return this.instances.has(e)}getOptions(e=Oi){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[i,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(i);r===a&&o.resolve(s)}return s}onInit(e,n){const r=this.normalizeInstanceIdentifier(n),s=this.onInitCallbacks.get(r)??new Set;s.add(e),this.onInitCallbacks.set(r,s);const i=this.instances.get(r);return i&&e(i,r),()=>{s.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const s of r)try{s(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:$k(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Oi){return this.component?this.component.multipleInstances?e:Oi:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function $k(t){return t===Oi?void 0:t}function Bk(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zk{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new Uk(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Fe;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Fe||(Fe={}));const qk={debug:Fe.DEBUG,verbose:Fe.VERBOSE,info:Fe.INFO,warn:Fe.WARN,error:Fe.ERROR,silent:Fe.SILENT},Hk=Fe.INFO,Wk={[Fe.DEBUG]:"log",[Fe.VERBOSE]:"log",[Fe.INFO]:"info",[Fe.WARN]:"warn",[Fe.ERROR]:"error"},Gk=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),s=Wk[e];if(s)console[s](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Kh{constructor(e){this.name=e,this._logLevel=Hk,this._logHandler=Gk,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Fe))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?qk[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Fe.DEBUG,...e),this._logHandler(this,Fe.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Fe.VERBOSE,...e),this._logHandler(this,Fe.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Fe.INFO,...e),this._logHandler(this,Fe.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Fe.WARN,...e),this._logHandler(this,Fe.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Fe.ERROR,...e),this._logHandler(this,Fe.ERROR,...e)}}const Kk=(t,e)=>e.some(n=>t instanceof n);let Qw,Yw;function Qk(){return Qw||(Qw=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Yk(){return Yw||(Yw=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const y0=new WeakMap,zm=new WeakMap,v0=new WeakMap,Ep=new WeakMap,Ry=new WeakMap;function Xk(t){const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("success",i),t.removeEventListener("error",o)},i=()=>{n(si(t.result)),s()},o=()=>{r(t.error),s()};t.addEventListener("success",i),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&y0.set(n,t)}).catch(()=>{}),Ry.set(e,t),e}function Jk(t){if(zm.has(t))return;const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",o),t.removeEventListener("abort",o)},i=()=>{n(),s()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",i),t.addEventListener("error",o),t.addEventListener("abort",o)});zm.set(t,e)}let qm={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return zm.get(t);if(e==="objectStoreNames")return t.objectStoreNames||v0.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return si(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function Zk(t){qm=t(qm)}function eD(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(Ip(this),e,...n);return v0.set(r,e.sort?e.sort():[e]),si(r)}:Yk().includes(t)?function(...e){return t.apply(Ip(this),e),si(y0.get(this))}:function(...e){return si(t.apply(Ip(this),e))}}function tD(t){return typeof t=="function"?eD(t):(t instanceof IDBTransaction&&Jk(t),Kk(t,Qk())?new Proxy(t,qm):t)}function si(t){if(t instanceof IDBRequest)return Xk(t);if(Ep.has(t))return Ep.get(t);const e=tD(t);return e!==t&&(Ep.set(t,e),Ry.set(e,t)),e}const Ip=t=>Ry.get(t);function _0(t,e,{blocked:n,upgrade:r,blocking:s,terminated:i}={}){const o=indexedDB.open(t,e),a=si(o);return r&&o.addEventListener("upgradeneeded",c=>{r(si(o.result),c.oldVersion,c.newVersion,si(o.transaction),c)}),n&&o.addEventListener("blocked",c=>n(c.oldVersion,c.newVersion,c)),a.then(c=>{i&&c.addEventListener("close",()=>i()),s&&c.addEventListener("versionchange",d=>s(d.oldVersion,d.newVersion,d))}).catch(()=>{}),a}const nD=["get","getKey","getAll","getAllKeys","count"],rD=["put","add","delete","clear"],xp=new Map;function Xw(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(xp.get(e))return xp.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,s=rD.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(s||nD.includes(n)))return;const i=async function(o,...a){const c=this.transaction(o,s?"readwrite":"readonly");let d=c.store;return r&&(d=d.index(a.shift())),(await Promise.all([d[n](...a),s&&c.done]))[0]};return xp.set(e,i),i}Zk(t=>({...t,get:(e,n,r)=>Xw(e,n)||t.get(e,n,r),has:(e,n)=>!!Xw(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sD{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(iD(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function iD(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Hm="@firebase/app",Jw="0.14.5";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gs=new Kh("@firebase/app"),oD="@firebase/app-compat",aD="@firebase/analytics-compat",lD="@firebase/analytics",cD="@firebase/app-check-compat",uD="@firebase/app-check",dD="@firebase/auth",hD="@firebase/auth-compat",fD="@firebase/database",pD="@firebase/data-connect",mD="@firebase/database-compat",gD="@firebase/functions",yD="@firebase/functions-compat",vD="@firebase/installations",_D="@firebase/installations-compat",wD="@firebase/messaging",ED="@firebase/messaging-compat",ID="@firebase/performance",xD="@firebase/performance-compat",TD="@firebase/remote-config",bD="@firebase/remote-config-compat",SD="@firebase/storage",CD="@firebase/storage-compat",AD="@firebase/firestore",RD="@firebase/ai",ND="@firebase/firestore-compat",PD="firebase",kD="12.5.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wm="[DEFAULT]",DD={[Hm]:"fire-core",[oD]:"fire-core-compat",[lD]:"fire-analytics",[aD]:"fire-analytics-compat",[uD]:"fire-app-check",[cD]:"fire-app-check-compat",[dD]:"fire-auth",[hD]:"fire-auth-compat",[fD]:"fire-rtdb",[pD]:"fire-data-connect",[mD]:"fire-rtdb-compat",[gD]:"fire-fn",[yD]:"fire-fn-compat",[vD]:"fire-iid",[_D]:"fire-iid-compat",[wD]:"fire-fcm",[ED]:"fire-fcm-compat",[ID]:"fire-perf",[xD]:"fire-perf-compat",[TD]:"fire-rc",[bD]:"fire-rc-compat",[SD]:"fire-gcs",[CD]:"fire-gcs-compat",[AD]:"fire-fst",[ND]:"fire-fst-compat",[RD]:"fire-vertex","fire-js":"fire-js",[PD]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eh=new Map,jD=new Map,Gm=new Map;function Zw(t,e){try{t.container.addComponent(e)}catch(n){gs.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function xr(t){const e=t.name;if(Gm.has(e))return gs.debug(`There were multiple attempts to register component ${e}.`),!1;Gm.set(e,t);for(const n of eh.values())Zw(n,t);for(const n of jD.values())Zw(n,t);return!0}function Ii(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function er(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OD={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},ii=new To("app","Firebase",OD);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LD{constructor(e,n,r){this._isDeleted=!1,this._options={...e},this._config={...n},this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new cr("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw ii.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bo=kD;function Ny(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r={name:Wm,automaticDataCollectionEnabled:!0,...e},s=r.name;if(typeof s!="string"||!s)throw ii.create("bad-app-name",{appName:String(s)});if(n||(n=c0()),!n)throw ii.create("no-options");const i=eh.get(s);if(i){if(ms(n,i.options)&&ms(r,i.config))return i;throw ii.create("duplicate-app",{appName:s})}const o=new zk(s);for(const c of Gm.values())o.addComponent(c);const a=new LD(n,r,o);return eh.set(s,a),a}function Qh(t=Wm){const e=eh.get(t);if(!e&&t===Wm&&c0())return Ny();if(!e)throw ii.create("no-app",{appName:t});return e}function kn(t,e,n){let r=DD[t]??t;n&&(r+=`-${n}`);const s=r.match(/\s|\//),i=e.match(/\s|\//);if(s||i){const o=[`Unable to register library "${r}" with version "${e}":`];s&&o.push(`library name "${r}" contains illegal characters (whitespace or "/")`),s&&i&&o.push("and"),i&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),gs.warn(o.join(" "));return}xr(new cr(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VD="firebase-heartbeat-database",MD=1,Cc="firebase-heartbeat-store";let Tp=null;function w0(){return Tp||(Tp=_0(VD,MD,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Cc)}catch(n){console.warn(n)}}}}).catch(t=>{throw ii.create("idb-open",{originalErrorMessage:t.message})})),Tp}async function FD(t){try{const n=(await w0()).transaction(Cc),r=await n.objectStore(Cc).get(E0(t));return await n.done,r}catch(e){if(e instanceof ur)gs.warn(e.message);else{const n=ii.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});gs.warn(n.message)}}}async function eE(t,e){try{const r=(await w0()).transaction(Cc,"readwrite");await r.objectStore(Cc).put(e,E0(t)),await r.done}catch(n){if(n instanceof ur)gs.warn(n.message);else{const r=ii.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});gs.warn(r.message)}}}function E0(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UD=1024,$D=30;class BD{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new qD(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=tE();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)==null?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(o=>o.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:s}),this._heartbeatsCache.heartbeats.length>$D){const o=HD(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){gs.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=tE(),{heartbeatsToSend:r,unsentEntries:s}=zD(this._heartbeatsCache.heartbeats),i=Zd(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(n){return gs.warn(n),""}}}function tE(){return new Date().toISOString().substring(0,10)}function zD(t,e=UD){const n=[];let r=t.slice();for(const s of t){const i=n.find(o=>o.agent===s.agent);if(i){if(i.dates.push(s.date),nE(n)>e){i.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),nE(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class qD{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Ay()?g0().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await FD(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return eE(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return eE(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function nE(t){return Zd(JSON.stringify({version:2,heartbeats:t})).length}function HD(t){if(t.length===0)return-1;let e=0,n=t[0].date;for(let r=1;r<t.length;r++)t[r].date<n&&(n=t[r].date,e=r);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function WD(t){xr(new cr("platform-logger",e=>new sD(e),"PRIVATE")),xr(new cr("heartbeat",e=>new BD(e),"PRIVATE")),kn(Hm,Jw,t),kn(Hm,Jw,"esm2020"),kn("fire-js","")}WD("");var GD="firebase",KD="12.5.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */kn(GD,KD,"app");function I0(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const QD=I0,x0=new To("auth","Firebase",I0());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const th=new Kh("@firebase/auth");function YD(t,...e){th.logLevel<=Fe.WARN&&th.warn(`Auth (${bo}): ${t}`,...e)}function dd(t,...e){th.logLevel<=Fe.ERROR&&th.error(`Auth (${bo}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tr(t,...e){throw Py(t,...e)}function Wr(t,...e){return Py(t,...e)}function T0(t,e,n){const r={...QD(),[e]:n};return new To("auth","Firebase",r).create(e,{appName:t.name})}function oi(t){return T0(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Py(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return x0.create(t,...e)}function we(t,e,...n){if(!t)throw Py(e,...n)}function is(t){const e="INTERNAL ASSERTION FAILED: "+t;throw dd(e),new Error(e)}function ys(t,e){t||is(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Km(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.href)||""}function XD(){return rE()==="http:"||rE()==="https:"}function rE(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function JD(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(XD()||f0()||"connection"in navigator)?navigator.onLine:!0}function ZD(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qc{constructor(e,n){this.shortDelay=e,this.longDelay=n,ys(n>e,"Short delay should be less than long delay!"),this.isMobile=Tk()||Sk()}get(){return JD()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ky(t,e){ys(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b0{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;is("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;is("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;is("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ej={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tj=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],nj=new Qc(3e4,6e4);function So(t,e){return t.tenantId&&!e.tenantId?{...e,tenantId:t.tenantId}:e}async function xi(t,e,n,r,s={}){return S0(t,s,async()=>{let i={},o={};r&&(e==="GET"?o=r:i={body:JSON.stringify(r)});const a=Kc({key:t.config.apiKey,...o}).slice(1),c=await t._getAdditionalHeaders();c["Content-Type"]="application/json",t.languageCode&&(c["X-Firebase-Locale"]=t.languageCode);const d={method:e,headers:c,...i};return bk()||(d.referrerPolicy="no-referrer"),t.emulatorConfig&&Ei(t.emulatorConfig.host)&&(d.credentials="include"),b0.fetch()(await C0(t,t.config.apiHost,n,a),d)})}async function S0(t,e,n){t._canInitEmulator=!1;const r={...ej,...e};try{const s=new sj(t),i=await Promise.race([n(),s.promise]);s.clearNetworkTimeout();const o=await i.json();if("needConfirmation"in o)throw Fu(t,"account-exists-with-different-credential",o);if(i.ok&&!("errorMessage"in o))return o;{const a=i.ok?o.errorMessage:o.error.message,[c,d]=a.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw Fu(t,"credential-already-in-use",o);if(c==="EMAIL_EXISTS")throw Fu(t,"email-already-in-use",o);if(c==="USER_DISABLED")throw Fu(t,"user-disabled",o);const h=r[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(d)throw T0(t,h,d);Tr(t,h)}}catch(s){if(s instanceof ur)throw s;Tr(t,"network-request-failed",{message:String(s)})}}async function Yh(t,e,n,r,s={}){const i=await xi(t,e,n,r,s);return"mfaPendingCredential"in i&&Tr(t,"multi-factor-auth-required",{_serverResponse:i}),i}async function C0(t,e,n,r){const s=`${e}${n}?${r}`,i=t,o=i.config.emulator?ky(t.config,s):`${t.config.apiScheme}://${s}`;return tj.includes(n)&&(await i._persistenceManagerAvailable,i._getPersistenceType()==="COOKIE")?i._getPersistence()._getFinalTarget(o).toString():o}function rj(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class sj{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(Wr(this.auth,"network-request-failed")),nj.get())})}}function Fu(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const s=Wr(t,e,r);return s.customData._tokenResponse=n,s}function sE(t){return t!==void 0&&t.enterprise!==void 0}class ij{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const n of this.recaptchaEnforcementState)if(n.provider&&n.provider===e)return rj(n.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function oj(t,e){return xi(t,"GET","/v2/recaptchaConfig",So(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function aj(t,e){return xi(t,"POST","/v1/accounts:delete",e)}async function nh(t,e){return xi(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ec(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function lj(t,e=!1){const n=Qe(t),r=await n.getIdToken(e),s=Dy(r);we(s&&s.exp&&s.auth_time&&s.iat,n.auth,"internal-error");const i=typeof s.firebase=="object"?s.firebase:void 0,o=i==null?void 0:i.sign_in_provider;return{claims:s,token:r,authTime:ec(bp(s.auth_time)),issuedAtTime:ec(bp(s.iat)),expirationTime:ec(bp(s.exp)),signInProvider:o||null,signInSecondFactor:(i==null?void 0:i.sign_in_second_factor)||null}}function bp(t){return Number(t)*1e3}function Dy(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return dd("JWT malformed, contained fewer than 3 sections"),null;try{const s=i0(n);return s?JSON.parse(s):(dd("Failed to decode base64 JWT payload"),null)}catch(s){return dd("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function iE(t){const e=Dy(t);return we(e,"internal-error"),we(typeof e.exp<"u","internal-error"),we(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ac(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof ur&&cj(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function cj({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uj{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const r=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qm{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=ec(this.lastLoginAt),this.creationTime=ec(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function rh(t){var f;const e=t.auth,n=await t.getIdToken(),r=await Ac(t,nh(e,{idToken:n}));we(r==null?void 0:r.users.length,e,"internal-error");const s=r.users[0];t._notifyReloadListener(s);const i=(f=s.providerUserInfo)!=null&&f.length?A0(s.providerUserInfo):[],o=hj(t.providerData,i),a=t.isAnonymous,c=!(t.email&&s.passwordHash)&&!(o!=null&&o.length),d=a?c:!1,h={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:o,metadata:new Qm(s.createdAt,s.lastLoginAt),isAnonymous:d};Object.assign(t,h)}async function dj(t){const e=Qe(t);await rh(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function hj(t,e){return[...t.filter(r=>!e.some(s=>s.providerId===r.providerId)),...e]}function A0(t){return t.map(({providerId:e,...n})=>({providerId:e,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function fj(t,e){const n=await S0(t,{},async()=>{const r=Kc({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:i}=t.config,o=await C0(t,s,"/v1/token",`key=${i}`),a=await t._getAdditionalHeaders();a["Content-Type"]="application/x-www-form-urlencoded";const c={method:"POST",headers:a,body:r};return t.emulatorConfig&&Ei(t.emulatorConfig.host)&&(c.credentials="include"),b0.fetch()(o,c)});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function pj(t,e){return xi(t,"POST","/v2/accounts:revokeToken",So(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ma{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){we(e.idToken,"internal-error"),we(typeof e.idToken<"u","internal-error"),we(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):iE(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){we(e.length!==0,"internal-error");const n=iE(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(we(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:s,expiresIn:i}=await fj(e,n);this.updateTokensAndExpiration(r,s,Number(i))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:s,expirationTime:i}=n,o=new ma;return r&&(we(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),s&&(we(typeof s=="string","internal-error",{appName:e}),o.accessToken=s),i&&(we(typeof i=="number","internal-error",{appName:e}),o.expirationTime=i),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new ma,this.toJSON())}_performRefresh(){return is("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ps(t,e){we(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class vr{constructor({uid:e,auth:n,stsTokenManager:r,...s}){this.providerId="firebase",this.proactiveRefresh=new uj(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=n,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new Qm(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const n=await Ac(this,this.stsTokenManager.getToken(this.auth,e));return we(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return lj(this,e)}reload(){return dj(this)}_assign(e){this!==e&&(we(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>({...n})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new vr({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return n.metadata._copy(this.metadata),n}_onReload(e){we(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await rh(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(er(this.auth.app))return Promise.reject(oi(this.auth));const e=await this.getIdToken();return await Ac(this,aj(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){const r=n.displayName??void 0,s=n.email??void 0,i=n.phoneNumber??void 0,o=n.photoURL??void 0,a=n.tenantId??void 0,c=n._redirectEventId??void 0,d=n.createdAt??void 0,h=n.lastLoginAt??void 0,{uid:f,emailVerified:m,isAnonymous:_,providerData:R,stsTokenManager:C}=n;we(f&&C,e,"internal-error");const N=ma.fromJSON(this.name,C);we(typeof f=="string",e,"internal-error"),Ps(r,e.name),Ps(s,e.name),we(typeof m=="boolean",e,"internal-error"),we(typeof _=="boolean",e,"internal-error"),Ps(i,e.name),Ps(o,e.name),Ps(a,e.name),Ps(c,e.name),Ps(d,e.name),Ps(h,e.name);const T=new vr({uid:f,auth:e,email:s,emailVerified:m,displayName:r,isAnonymous:_,photoURL:o,phoneNumber:i,tenantId:a,stsTokenManager:N,createdAt:d,lastLoginAt:h});return R&&Array.isArray(R)&&(T.providerData=R.map(y=>({...y}))),c&&(T._redirectEventId=c),T}static async _fromIdTokenResponse(e,n,r=!1){const s=new ma;s.updateFromServerResponse(n);const i=new vr({uid:n.localId,auth:e,stsTokenManager:s,isAnonymous:r});return await rh(i),i}static async _fromGetAccountInfoResponse(e,n,r){const s=n.users[0];we(s.localId!==void 0,"internal-error");const i=s.providerUserInfo!==void 0?A0(s.providerUserInfo):[],o=!(s.email&&s.passwordHash)&&!(i!=null&&i.length),a=new ma;a.updateFromIdToken(r);const c=new vr({uid:s.localId,auth:e,stsTokenManager:a,isAnonymous:o}),d={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:i,metadata:new Qm(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(i!=null&&i.length)};return Object.assign(c,d),c}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oE=new Map;function os(t){ys(t instanceof Function,"Expected a class definition");let e=oE.get(t);return e?(ys(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,oE.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R0{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}R0.type="NONE";const aE=R0;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hd(t,e,n){return`firebase:${t}:${e}:${n}`}class ga{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:s,name:i}=this.auth;this.fullUserKey=hd(this.userKey,s.apiKey,i),this.fullPersistenceKey=hd("persistence",s.apiKey,i),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const n=await nh(this.auth,{idToken:e}).catch(()=>{});return n?vr._fromGetAccountInfoResponse(this.auth,n,e):null}return vr._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new ga(os(aE),e,r);const s=(await Promise.all(n.map(async d=>{if(await d._isAvailable())return d}))).filter(d=>d);let i=s[0]||os(aE);const o=hd(r,e.config.apiKey,e.name);let a=null;for(const d of n)try{const h=await d._get(o);if(h){let f;if(typeof h=="string"){const m=await nh(e,{idToken:h}).catch(()=>{});if(!m)break;f=await vr._fromGetAccountInfoResponse(e,m,h)}else f=vr._fromJSON(e,h);d!==i&&(a=f),i=d;break}}catch{}const c=s.filter(d=>d._shouldAllowMigration);return!i._shouldAllowMigration||!c.length?new ga(i,e,r):(i=c[0],a&&await i._set(o,a.toJSON()),await Promise.all(n.map(async d=>{if(d!==i)try{await d._remove(o)}catch{}})),new ga(i,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lE(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(D0(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(N0(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(O0(e))return"Blackberry";if(L0(e))return"Webos";if(P0(e))return"Safari";if((e.includes("chrome/")||k0(e))&&!e.includes("edge/"))return"Chrome";if(j0(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function N0(t=Ft()){return/firefox\//i.test(t)}function P0(t=Ft()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function k0(t=Ft()){return/crios\//i.test(t)}function D0(t=Ft()){return/iemobile/i.test(t)}function j0(t=Ft()){return/android/i.test(t)}function O0(t=Ft()){return/blackberry/i.test(t)}function L0(t=Ft()){return/webos/i.test(t)}function jy(t=Ft()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function mj(t=Ft()){var e;return jy(t)&&!!((e=window.navigator)!=null&&e.standalone)}function gj(){return Ck()&&document.documentMode===10}function V0(t=Ft()){return jy(t)||j0(t)||L0(t)||O0(t)||/windows phone/i.test(t)||D0(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function M0(t,e=[]){let n;switch(t){case"Browser":n=lE(Ft());break;case"Worker":n=`${lE(Ft())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${bo}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yj{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=i=>new Promise((o,a)=>{try{const c=e(i);o(c)}catch(c){a(c)}});r.onAbort=n,this.queue.push(r);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const s of n)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function vj(t,e={}){return xi(t,"GET","/v2/passwordPolicy",So(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _j=6;class wj{constructor(e){var r;const n=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=n.minPasswordLength??_j,n.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=n.maxPasswordLength),n.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=n.containsLowercaseCharacter),n.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=n.containsUppercaseCharacter),n.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=n.containsNumericCharacter),n.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=n.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=((r=e.allowedNonAlphanumericCharacters)==null?void 0:r.join(""))??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const n={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,n),this.validatePasswordCharacterOptions(e,n),n.isValid&&(n.isValid=n.meetsMinPasswordLength??!0),n.isValid&&(n.isValid=n.meetsMaxPasswordLength??!0),n.isValid&&(n.isValid=n.containsLowercaseLetter??!0),n.isValid&&(n.isValid=n.containsUppercaseLetter??!0),n.isValid&&(n.isValid=n.containsNumericCharacter??!0),n.isValid&&(n.isValid=n.containsNonAlphanumericCharacter??!0),n}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),s&&(n.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let s=0;s<e.length;s++)r=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,s,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ej{constructor(e,n,r,s){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new cE(this),this.idTokenSubscription=new cE(this),this.beforeStateQueue=new yj(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=x0,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion,this._persistenceManagerAvailable=new Promise(i=>this._resolvePersistenceManagerAvailable=i)}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=os(n)),this._initializationPromise=this.queue(async()=>{var r,s,i;if(!this._deleted&&(this.persistenceManager=await ga.create(this,e),(r=this._resolvePersistenceManagerAvailable)==null||r.call(this),!this._deleted)){if((s=this._popupRedirectResolver)!=null&&s._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((i=this.currentUser)==null?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await nh(this,{idToken:e}),r=await vr._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(r)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var i;if(er(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(a,a))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let r=n,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(i=this.redirectUser)==null?void 0:i._redirectEventId,a=r==null?void 0:r._redirectEventId,c=await this.tryRedirectSignIn(e);(!o||o===a)&&(c!=null&&c.user)&&(r=c.user,s=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(r)}catch(o){r=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return we(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await rh(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=ZD()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(er(this.app))return Promise.reject(oi(this));const n=e?Qe(e):null;return n&&we(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&we(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return er(this.app)?Promise.reject(oi(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return er(this.app)?Promise.reject(oi(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(os(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await vj(this),n=new wj(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new To("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),await pj(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)==null?void 0:e.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&os(e)||this._popupRedirectResolver;we(n,this,"argument-error"),this.redirectPersistenceManager=await ga.create(this,[os(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)==null?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)==null?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=((n=this.currentUser)==null?void 0:n.uid)??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,s){if(this._deleted)return()=>{};const i=typeof n=="function"?n:n.next.bind(n);let o=!1;const a=this._isInitialized?Promise.resolve():this._initializationPromise;if(we(a,this,"internal-error"),a.then(()=>{o||i(this.currentUser)}),typeof n=="function"){const c=e.addObserver(n,r,s);return()=>{o=!0,c()}}else{const c=e.addObserver(n);return()=>{o=!0,c()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return we(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=M0(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var s;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const n=await((s=this.heartbeatServiceProvider.getImmediate({optional:!0}))==null?void 0:s.getHeartbeatsHeader());n&&(e["X-Firebase-Client"]=n);const r=await this._getAppCheckToken();return r&&(e["X-Firebase-AppCheck"]=r),e}async _getAppCheckToken(){var n;if(er(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await((n=this.appCheckServiceProvider.getImmediate({optional:!0}))==null?void 0:n.getToken());return e!=null&&e.error&&YD(`Error while retrieving App Check token: ${e.error}`),e==null?void 0:e.token}}function Ya(t){return Qe(t)}class cE{constructor(e){this.auth=e,this.observer=null,this.addObserver=Dk(n=>this.observer=n)}get next(){return we(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Xh={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function Ij(t){Xh=t}function F0(t){return Xh.loadJS(t)}function xj(){return Xh.recaptchaEnterpriseScript}function Tj(){return Xh.gapiScript}function bj(t){return`__${t}${Math.floor(Math.random()*1e6)}`}class Sj{constructor(){this.enterprise=new Cj}ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}class Cj{ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}const Aj="recaptcha-enterprise",U0="NO_RECAPTCHA";class Rj{constructor(e){this.type=Aj,this.auth=Ya(e)}async verify(e="verify",n=!1){async function r(i){if(!n){if(i.tenantId==null&&i._agentRecaptchaConfig!=null)return i._agentRecaptchaConfig.siteKey;if(i.tenantId!=null&&i._tenantRecaptchaConfigs[i.tenantId]!==void 0)return i._tenantRecaptchaConfigs[i.tenantId].siteKey}return new Promise(async(o,a)=>{oj(i,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(c=>{if(c.recaptchaKey===void 0)a(new Error("recaptcha Enterprise site key undefined"));else{const d=new ij(c);return i.tenantId==null?i._agentRecaptchaConfig=d:i._tenantRecaptchaConfigs[i.tenantId]=d,o(d.siteKey)}}).catch(c=>{a(c)})})}function s(i,o,a){const c=window.grecaptcha;sE(c)?c.enterprise.ready(()=>{c.enterprise.execute(i,{action:e}).then(d=>{o(d)}).catch(()=>{o(U0)})}):a(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new Sj().execute("siteKey",{action:"verify"}):new Promise((i,o)=>{r(this.auth).then(a=>{if(!n&&sE(window.grecaptcha))s(a,i,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let c=xj();c.length!==0&&(c+=a),F0(c).then(()=>{s(a,i,o)}).catch(d=>{o(d)})}}).catch(a=>{o(a)})})}}async function uE(t,e,n,r=!1,s=!1){const i=new Rj(t);let o;if(s)o=U0;else try{o=await i.verify(n)}catch{o=await i.verify(n,!0)}const a={...e};if(n==="mfaSmsEnrollment"||n==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in a){const c=a.phoneEnrollmentInfo.phoneNumber,d=a.phoneEnrollmentInfo.recaptchaToken;Object.assign(a,{phoneEnrollmentInfo:{phoneNumber:c,recaptchaToken:d,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in a){const c=a.phoneSignInInfo.recaptchaToken;Object.assign(a,{phoneSignInInfo:{recaptchaToken:c,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return a}return r?Object.assign(a,{captchaResp:o}):Object.assign(a,{captchaResponse:o}),Object.assign(a,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(a,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),a}async function dE(t,e,n,r,s){var i;if((i=t._getRecaptchaConfig())!=null&&i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const o=await uE(t,e,n,n==="getOobCode");return r(t,o)}else return r(t,e).catch(async o=>{if(o.code==="auth/missing-recaptcha-token"){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const a=await uE(t,e,n,n==="getOobCode");return r(t,a)}else return Promise.reject(o)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nj(t,e){const n=Ii(t,"auth");if(n.isInitialized()){const s=n.getImmediate(),i=n.getOptions();if(ms(i,e??{}))return s;Tr(s,"already-initialized")}return n.initialize({options:e})}function Pj(t,e){const n=(e==null?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(os);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function kj(t,e,n){const r=Ya(t);we(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const s=!1,i=$0(e),{host:o,port:a}=Dj(e),c=a===null?"":`:${a}`,d={url:`${i}//${o}${c}/`},h=Object.freeze({host:o,port:a,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:s})});if(!r._canInitEmulator){we(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),we(ms(d,r.config.emulator)&&ms(h,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=d,r.emulatorConfig=h,r.settings.appVerificationDisabledForTesting=!0,Ei(o)?(Sy(`${i}//${o}${c}`),Cy("Auth",!0)):jj()}function $0(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function Dj(t){const e=$0(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(r);if(s){const i=s[1];return{host:i,port:hE(r.substr(i.length+1))}}else{const[i,o]=r.split(":");return{host:i,port:hE(o)}}}function hE(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function jj(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oy{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return is("not implemented")}_getIdTokenResponse(e){return is("not implemented")}_linkToIdToken(e,n){return is("not implemented")}_getReauthenticationResolver(e){return is("not implemented")}}async function Oj(t,e){return xi(t,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Lj(t,e){return Yh(t,"POST","/v1/accounts:signInWithPassword",So(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Vj(t,e){return Yh(t,"POST","/v1/accounts:signInWithEmailLink",So(t,e))}async function Mj(t,e){return Yh(t,"POST","/v1/accounts:signInWithEmailLink",So(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rc extends Oy{constructor(e,n,r,s=null){super("password",r),this._email=e,this._password=n,this._tenantId=s}static _fromEmailAndPassword(e,n){return new Rc(e,n,"password")}static _fromEmailAndCode(e,n,r=null){return new Rc(e,n,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;if(n!=null&&n.email&&(n!=null&&n.password)){if(n.signInMethod==="password")return this._fromEmailAndPassword(n.email,n.password);if(n.signInMethod==="emailLink")return this._fromEmailAndCode(n.email,n.password,n.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const n={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return dE(e,n,"signInWithPassword",Lj);case"emailLink":return Vj(e,{email:this._email,oobCode:this._password});default:Tr(e,"internal-error")}}async _linkToIdToken(e,n){switch(this.signInMethod){case"password":const r={idToken:n,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return dE(e,r,"signUpPassword",Oj);case"emailLink":return Mj(e,{idToken:n,email:this._email,oobCode:this._password});default:Tr(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ya(t,e){return Yh(t,"POST","/v1/accounts:signInWithIdp",So(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fj="http://localhost";class ao extends Oy{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new ao(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):Tr("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:s,...i}=n;if(!r||!s)return null;const o=new ao(r,s);return o.idToken=i.idToken||void 0,o.accessToken=i.accessToken||void 0,o.secret=i.secret,o.nonce=i.nonce,o.pendingToken=i.pendingToken||null,o}_getIdTokenResponse(e){const n=this.buildRequest();return ya(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,ya(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,ya(e,n)}buildRequest(){const e={requestUri:Fj,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=Kc(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Uj(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function $j(t){const e=Ol(Ll(t)).link,n=e?Ol(Ll(e)).deep_link_id:null,r=Ol(Ll(t)).deep_link_id;return(r?Ol(Ll(r)).link:null)||r||n||e||t}class Ly{constructor(e){const n=Ol(Ll(e)),r=n.apiKey??null,s=n.oobCode??null,i=Uj(n.mode??null);we(r&&s&&i,"argument-error"),this.apiKey=r,this.operation=i,this.code=s,this.continueUrl=n.continueUrl??null,this.languageCode=n.lang??null,this.tenantId=n.tenantId??null}static parseLink(e){const n=$j(e);try{return new Ly(n)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xa{constructor(){this.providerId=Xa.PROVIDER_ID}static credential(e,n){return Rc._fromEmailAndPassword(e,n)}static credentialWithLink(e,n){const r=Ly.parseLink(n);return we(r,"argument-error"),Rc._fromEmailAndCode(e,r.code,r.tenantId)}}Xa.PROVIDER_ID="password";Xa.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Xa.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class B0{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yc extends B0{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Us extends Yc{constructor(){super("facebook.com")}static credential(e){return ao._fromParams({providerId:Us.PROVIDER_ID,signInMethod:Us.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Us.credentialFromTaggedObject(e)}static credentialFromError(e){return Us.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Us.credential(e.oauthAccessToken)}catch{return null}}}Us.FACEBOOK_SIGN_IN_METHOD="facebook.com";Us.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $s extends Yc{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return ao._fromParams({providerId:$s.PROVIDER_ID,signInMethod:$s.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return $s.credentialFromTaggedObject(e)}static credentialFromError(e){return $s.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return $s.credential(n,r)}catch{return null}}}$s.GOOGLE_SIGN_IN_METHOD="google.com";$s.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bs extends Yc{constructor(){super("github.com")}static credential(e){return ao._fromParams({providerId:Bs.PROVIDER_ID,signInMethod:Bs.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Bs.credentialFromTaggedObject(e)}static credentialFromError(e){return Bs.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Bs.credential(e.oauthAccessToken)}catch{return null}}}Bs.GITHUB_SIGN_IN_METHOD="github.com";Bs.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zs extends Yc{constructor(){super("twitter.com")}static credential(e,n){return ao._fromParams({providerId:zs.PROVIDER_ID,signInMethod:zs.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return zs.credentialFromTaggedObject(e)}static credentialFromError(e){return zs.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return zs.credential(n,r)}catch{return null}}}zs.TWITTER_SIGN_IN_METHOD="twitter.com";zs.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ra{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,s=!1){const i=await vr._fromIdTokenResponse(e,r,s),o=fE(r);return new Ra({user:i,providerId:o,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const s=fE(r);return new Ra({user:e,providerId:s,_tokenResponse:r,operationType:n})}}function fE(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sh extends ur{constructor(e,n,r,s){super(n.code,n.message),this.operationType=r,this.user=s,Object.setPrototypeOf(this,sh.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,s){return new sh(e,n,r,s)}}function z0(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?sh._fromErrorAndOperation(t,i,e,r):i})}async function Bj(t,e,n=!1){const r=await Ac(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return Ra._forOperation(t,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function zj(t,e,n=!1){const{auth:r}=t;if(er(r.app))return Promise.reject(oi(r));const s="reauthenticate";try{const i=await Ac(t,z0(r,s,e,t),n);we(i.idToken,r,"internal-error");const o=Dy(i.idToken);we(o,r,"internal-error");const{sub:a}=o;return we(t.uid===a,r,"user-mismatch"),Ra._forOperation(t,s,i)}catch(i){throw(i==null?void 0:i.code)==="auth/user-not-found"&&Tr(r,"user-mismatch"),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function q0(t,e,n=!1){if(er(t.app))return Promise.reject(oi(t));const r="signIn",s=await z0(t,r,e),i=await Ra._fromIdTokenResponse(t,r,s);return n||await t._updateCurrentUser(i.user),i}async function qj(t,e){return q0(Ya(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Hj(t){const e=Ya(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}function Wj(t,e,n){return er(t.app)?Promise.reject(oi(t)):qj(Qe(t),Xa.credential(e,n)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&Hj(t),r})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gj(t,e){return Qe(t).setPersistence(e)}function Kj(t,e,n,r){return Qe(t).onIdTokenChanged(e,n,r)}function Qj(t,e,n){return Qe(t).beforeAuthStateChanged(e,n)}function Vy(t,e,n,r){return Qe(t).onAuthStateChanged(e,n,r)}function Yj(t){return Qe(t).signOut()}const ih="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H0{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(ih,"1"),this.storage.removeItem(ih),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xj=1e3,Jj=10;class W0 extends H0{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=V0(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),s=this.localCache[n];r!==s&&e(n,s,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((o,a,c)=>{this.notifyListeners(o,c)});return}const r=e.key;n?this.detachListener():this.stopPolling();const s=()=>{const o=this.storage.getItem(r);!n&&this.localCache[r]===o||this.notifyListeners(r,o)},i=this.storage.getItem(r);gj()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,Jj):s()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},Xj)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}W0.type="LOCAL";const G0=W0;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K0 extends H0{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}K0.type="SESSION";const Q0=K0;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zj(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jh{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(s=>s.isListeningto(e));if(n)return n;const r=new Jh(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:s,data:i}=n.data,o=this.handlersMap[s];if(!(o!=null&&o.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:s});const a=Array.from(o).map(async d=>d(n.origin,i)),c=await Zj(a);n.ports[0].postMessage({status:"done",eventId:r,eventType:s,response:c})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Jh.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function My(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e2{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let i,o;return new Promise((a,c)=>{const d=My("",20);s.port1.start();const h=setTimeout(()=>{c(new Error("unsupported_event"))},r);o={messageChannel:s,onMessage(f){const m=f;if(m.data.eventId===d)switch(m.data.status){case"ack":clearTimeout(h),i=setTimeout(()=>{c(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),a(m.data.response);break;default:clearTimeout(h),clearTimeout(i),c(new Error("invalid_response"));break}}},this.handlers.add(o),s.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:d,data:n},[s.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gr(){return window}function t2(t){Gr().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Y0(){return typeof Gr().WorkerGlobalScope<"u"&&typeof Gr().importScripts=="function"}async function n2(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function r2(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)==null?void 0:t.controller)||null}function s2(){return Y0()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const X0="firebaseLocalStorageDb",i2=1,oh="firebaseLocalStorage",J0="fbase_key";class Xc{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function Zh(t,e){return t.transaction([oh],e?"readwrite":"readonly").objectStore(oh)}function o2(){const t=indexedDB.deleteDatabase(X0);return new Xc(t).toPromise()}function Ym(){const t=indexedDB.open(X0,i2);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(oh,{keyPath:J0})}catch(s){n(s)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(oh)?e(r):(r.close(),await o2(),e(await Ym()))})})}async function pE(t,e,n){const r=Zh(t,!0).put({[J0]:e,value:n});return new Xc(r).toPromise()}async function a2(t,e){const n=Zh(t,!1).get(e),r=await new Xc(n).toPromise();return r===void 0?null:r.value}function mE(t,e){const n=Zh(t,!0).delete(e);return new Xc(n).toPromise()}const l2=800,c2=3;class Z0{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Ym(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>c2)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Y0()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Jh._getInstance(s2()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var n,r;if(this.activeServiceWorker=await n2(),!this.activeServiceWorker)return;this.sender=new e2(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&(n=e[0])!=null&&n.fulfilled&&(r=e[0])!=null&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||r2()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Ym();return await pE(e,ih,"1"),await mE(e,ih),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>pE(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>a2(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>mE(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const i=Zh(s,!1).getAll();return new Xc(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;if(e.length!==0)for(const{fbase_key:s,value:i}of e)r.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(i)&&(this.notifyListeners(s,i),n.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!r.has(s)&&(this.notifyListeners(s,null),n.push(s));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),l2)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}Z0.type="LOCAL";const u2=Z0;new Qc(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function d2(t,e){return e?os(e):(we(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fy extends Oy{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return ya(e,this._buildIdpRequest())}_linkToIdToken(e,n){return ya(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return ya(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function h2(t){return q0(t.auth,new Fy(t),t.bypassAuthState)}function f2(t){const{auth:e,user:n}=t;return we(n,e,"internal-error"),zj(n,new Fy(t),t.bypassAuthState)}async function p2(t){const{auth:e,user:n}=t;return we(n,e,"internal-error"),Bj(n,new Fy(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eS{constructor(e,n,r,s,i=!1){this.auth=e,this.resolver=r,this.user=s,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:s,tenantId:i,error:o,type:a}=e;if(o){this.reject(o);return}const c={auth:this.auth,requestUri:n,sessionId:r,tenantId:i||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(c))}catch(d){this.reject(d)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return h2;case"linkViaPopup":case"linkViaRedirect":return p2;case"reauthViaPopup":case"reauthViaRedirect":return f2;default:Tr(this.auth,"internal-error")}}resolve(e){ys(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){ys(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const m2=new Qc(2e3,1e4);class la extends eS{constructor(e,n,r,s,i){super(e,n,s,i),this.provider=r,this.authWindow=null,this.pollId=null,la.currentPopupAction&&la.currentPopupAction.cancel(),la.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return we(e,this.auth,"internal-error"),e}async onExecution(){ys(this.filter.length===1,"Popup operations only handle one event");const e=My();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(Wr(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)==null?void 0:e.associatedEvent)||null}cancel(){this.reject(Wr(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,la.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,r;if((r=(n=this.authWindow)==null?void 0:n.window)!=null&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Wr(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,m2.get())};e()}}la.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const g2="pendingRedirect",fd=new Map;class y2 extends eS{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=fd.get(this.auth._key());if(!e){try{const r=await v2(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}fd.set(this.auth._key(),e)}return this.bypassAuthState||fd.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function v2(t,e){const n=E2(e),r=w2(t);if(!await r._isAvailable())return!1;const s=await r._get(n)==="true";return await r._remove(n),s}function _2(t,e){fd.set(t._key(),e)}function w2(t){return os(t._redirectPersistence)}function E2(t){return hd(g2,t.config.apiKey,t.name)}async function I2(t,e,n=!1){if(er(t.app))return Promise.reject(oi(t));const r=Ya(t),s=d2(r,e),o=await new y2(r,s,n).execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const x2=10*60*1e3;class T2{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!b2(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!tS(e)){const s=((r=e.error.code)==null?void 0:r.split("auth/")[1])||"internal-error";n.onError(Wr(this.auth,s))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=x2&&this.cachedEventUids.clear(),this.cachedEventUids.has(gE(e))}saveEventToCache(e){this.cachedEventUids.add(gE(e)),this.lastProcessedEventTime=Date.now()}}function gE(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function tS({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function b2(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return tS(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function S2(t,e={}){return xi(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const C2=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,A2=/^https?/;async function R2(t){if(t.config.emulator)return;const{authorizedDomains:e}=await S2(t);for(const n of e)try{if(N2(n))return}catch{}Tr(t,"unauthorized-domain")}function N2(t){const e=Km(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&o.hostname===r}if(!A2.test(n))return!1;if(C2.test(t))return r===t;const s=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const P2=new Qc(3e4,6e4);function yE(){const t=Gr().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function k2(t){return new Promise((e,n)=>{var s,i,o;function r(){yE(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{yE(),n(Wr(t,"network-request-failed"))},timeout:P2.get()})}if((i=(s=Gr().gapi)==null?void 0:s.iframes)!=null&&i.Iframe)e(gapi.iframes.getContext());else if((o=Gr().gapi)!=null&&o.load)r();else{const a=bj("iframefcb");return Gr()[a]=()=>{gapi.load?r():n(Wr(t,"network-request-failed"))},F0(`${Tj()}?onload=${a}`).catch(c=>n(c))}}).catch(e=>{throw pd=null,e})}let pd=null;function D2(t){return pd=pd||k2(t),pd}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const j2=new Qc(5e3,15e3),O2="__/auth/iframe",L2="emulator/auth/iframe",V2={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},M2=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function F2(t){const e=t.config;we(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?ky(e,L2):`https://${t.config.authDomain}/${O2}`,r={apiKey:e.apiKey,appName:t.name,v:bo},s=M2.get(t.config.apiHost);s&&(r.eid=s);const i=t._getFrameworks();return i.length&&(r.fw=i.join(",")),`${n}?${Kc(r).slice(1)}`}async function U2(t){const e=await D2(t),n=Gr().gapi;return we(n,t,"internal-error"),e.open({where:document.body,url:F2(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:V2,dontclear:!0},r=>new Promise(async(s,i)=>{await r.restyle({setHideOnLeave:!1});const o=Wr(t,"network-request-failed"),a=Gr().setTimeout(()=>{i(o)},j2.get());function c(){Gr().clearTimeout(a),s(r)}r.ping(c).then(c,()=>{i(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $2={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},B2=500,z2=600,q2="_blank",H2="http://localhost";class vE{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function W2(t,e,n,r=B2,s=z2){const i=Math.max((window.screen.availHeight-s)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let a="";const c={...$2,width:r.toString(),height:s.toString(),top:i,left:o},d=Ft().toLowerCase();n&&(a=k0(d)?q2:n),N0(d)&&(e=e||H2,c.scrollbars="yes");const h=Object.entries(c).reduce((m,[_,R])=>`${m}${_}=${R},`,"");if(mj(d)&&a!=="_self")return G2(e||"",a),new vE(null);const f=window.open(e||"",a,h);we(f,t,"popup-blocked");try{f.focus()}catch{}return new vE(f)}function G2(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const K2="__/auth/handler",Q2="emulator/auth/handler",Y2=encodeURIComponent("fac");async function _E(t,e,n,r,s,i){we(t.config.authDomain,t,"auth-domain-config-required"),we(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:bo,eventId:s};if(e instanceof B0){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",kk(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[h,f]of Object.entries({}))o[h]=f}if(e instanceof Yc){const h=e.getScopes().filter(f=>f!=="");h.length>0&&(o.scopes=h.join(","))}t.tenantId&&(o.tid=t.tenantId);const a=o;for(const h of Object.keys(a))a[h]===void 0&&delete a[h];const c=await t._getAppCheckToken(),d=c?`#${Y2}=${encodeURIComponent(c)}`:"";return`${X2(t)}?${Kc(a).slice(1)}${d}`}function X2({config:t}){return t.emulator?ky(t,Q2):`https://${t.authDomain}/${K2}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sp="webStorageSupport";class J2{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Q0,this._completeRedirectFn=I2,this._overrideRedirectResult=_2}async _openPopup(e,n,r,s){var o;ys((o=this.eventManagers[e._key()])==null?void 0:o.manager,"_initialize() not called before _openPopup()");const i=await _E(e,n,r,Km(),s);return W2(e,i,My())}async _openRedirect(e,n,r,s){await this._originValidation(e);const i=await _E(e,n,r,Km(),s);return t2(i),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:s,promise:i}=this.eventManagers[n];return s?Promise.resolve(s):(ys(i,"If manager is not set, promise should be"),i)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await U2(e),r=new T2(e);return n.register("authEvent",s=>(we(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:r.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(Sp,{type:Sp},s=>{var o;const i=(o=s==null?void 0:s[0])==null?void 0:o[Sp];i!==void 0&&n(!!i),Tr(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=R2(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return V0()||P0()||jy()}}const Z2=J2;var wE="@firebase/auth",EE="1.11.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eO{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)==null?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){we(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tO(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function nO(t){xr(new cr("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=r.options;we(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const c={apiKey:o,authDomain:a,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:M0(t)},d=new Ej(r,s,i,c);return Pj(d,n),d},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),xr(new cr("auth-internal",e=>{const n=Ya(e.getProvider("auth").getImmediate());return(r=>new eO(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),kn(wE,EE,tO(t)),kn(wE,EE,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rO=5*60,sO=u0("authIdTokenMaxAge")||rO;let IE=null;const iO=t=>async e=>{const n=e&&await e.getIdTokenResult(),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>sO)return;const s=n==null?void 0:n.token;IE!==s&&(IE=s,await fetch(t,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function nS(t=Qh()){const e=Ii(t,"auth");if(e.isInitialized())return e.getImmediate();const n=Nj(t,{popupRedirectResolver:Z2,persistence:[u2,G0,Q0]}),r=u0("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(r,location.origin);if(location.origin===i.origin){const o=iO(i.toString());Qj(n,o,()=>o(n.currentUser)),Kj(n,a=>o(a))}}const s=a0("auth");return s&&kj(n,`http://${s}`),n}function oO(){var t;return((t=document.getElementsByTagName("head"))==null?void 0:t[0])??document}Ij({loadJS(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=s=>{const i=Wr("internal-error");i.customData=s,n(i)},r.type="text/javascript",r.charset="UTF-8",oO().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});nO("Browser");var xE=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var ai,rS;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(x,I){function w(){}w.prototype=I.prototype,x.F=I.prototype,x.prototype=new w,x.prototype.constructor=x,x.D=function(P,D,j){for(var k=Array(arguments.length-2),K=2;K<arguments.length;K++)k[K-2]=arguments[K];return I.prototype[D].apply(P,k)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(r,n),r.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(x,I,w){w||(w=0);const P=Array(16);if(typeof I=="string")for(var D=0;D<16;++D)P[D]=I.charCodeAt(w++)|I.charCodeAt(w++)<<8|I.charCodeAt(w++)<<16|I.charCodeAt(w++)<<24;else for(D=0;D<16;++D)P[D]=I[w++]|I[w++]<<8|I[w++]<<16|I[w++]<<24;I=x.g[0],w=x.g[1],D=x.g[2];let j=x.g[3],k;k=I+(j^w&(D^j))+P[0]+3614090360&4294967295,I=w+(k<<7&4294967295|k>>>25),k=j+(D^I&(w^D))+P[1]+3905402710&4294967295,j=I+(k<<12&4294967295|k>>>20),k=D+(w^j&(I^w))+P[2]+606105819&4294967295,D=j+(k<<17&4294967295|k>>>15),k=w+(I^D&(j^I))+P[3]+3250441966&4294967295,w=D+(k<<22&4294967295|k>>>10),k=I+(j^w&(D^j))+P[4]+4118548399&4294967295,I=w+(k<<7&4294967295|k>>>25),k=j+(D^I&(w^D))+P[5]+1200080426&4294967295,j=I+(k<<12&4294967295|k>>>20),k=D+(w^j&(I^w))+P[6]+2821735955&4294967295,D=j+(k<<17&4294967295|k>>>15),k=w+(I^D&(j^I))+P[7]+4249261313&4294967295,w=D+(k<<22&4294967295|k>>>10),k=I+(j^w&(D^j))+P[8]+1770035416&4294967295,I=w+(k<<7&4294967295|k>>>25),k=j+(D^I&(w^D))+P[9]+2336552879&4294967295,j=I+(k<<12&4294967295|k>>>20),k=D+(w^j&(I^w))+P[10]+4294925233&4294967295,D=j+(k<<17&4294967295|k>>>15),k=w+(I^D&(j^I))+P[11]+2304563134&4294967295,w=D+(k<<22&4294967295|k>>>10),k=I+(j^w&(D^j))+P[12]+1804603682&4294967295,I=w+(k<<7&4294967295|k>>>25),k=j+(D^I&(w^D))+P[13]+4254626195&4294967295,j=I+(k<<12&4294967295|k>>>20),k=D+(w^j&(I^w))+P[14]+2792965006&4294967295,D=j+(k<<17&4294967295|k>>>15),k=w+(I^D&(j^I))+P[15]+1236535329&4294967295,w=D+(k<<22&4294967295|k>>>10),k=I+(D^j&(w^D))+P[1]+4129170786&4294967295,I=w+(k<<5&4294967295|k>>>27),k=j+(w^D&(I^w))+P[6]+3225465664&4294967295,j=I+(k<<9&4294967295|k>>>23),k=D+(I^w&(j^I))+P[11]+643717713&4294967295,D=j+(k<<14&4294967295|k>>>18),k=w+(j^I&(D^j))+P[0]+3921069994&4294967295,w=D+(k<<20&4294967295|k>>>12),k=I+(D^j&(w^D))+P[5]+3593408605&4294967295,I=w+(k<<5&4294967295|k>>>27),k=j+(w^D&(I^w))+P[10]+38016083&4294967295,j=I+(k<<9&4294967295|k>>>23),k=D+(I^w&(j^I))+P[15]+3634488961&4294967295,D=j+(k<<14&4294967295|k>>>18),k=w+(j^I&(D^j))+P[4]+3889429448&4294967295,w=D+(k<<20&4294967295|k>>>12),k=I+(D^j&(w^D))+P[9]+568446438&4294967295,I=w+(k<<5&4294967295|k>>>27),k=j+(w^D&(I^w))+P[14]+3275163606&4294967295,j=I+(k<<9&4294967295|k>>>23),k=D+(I^w&(j^I))+P[3]+4107603335&4294967295,D=j+(k<<14&4294967295|k>>>18),k=w+(j^I&(D^j))+P[8]+1163531501&4294967295,w=D+(k<<20&4294967295|k>>>12),k=I+(D^j&(w^D))+P[13]+2850285829&4294967295,I=w+(k<<5&4294967295|k>>>27),k=j+(w^D&(I^w))+P[2]+4243563512&4294967295,j=I+(k<<9&4294967295|k>>>23),k=D+(I^w&(j^I))+P[7]+1735328473&4294967295,D=j+(k<<14&4294967295|k>>>18),k=w+(j^I&(D^j))+P[12]+2368359562&4294967295,w=D+(k<<20&4294967295|k>>>12),k=I+(w^D^j)+P[5]+4294588738&4294967295,I=w+(k<<4&4294967295|k>>>28),k=j+(I^w^D)+P[8]+2272392833&4294967295,j=I+(k<<11&4294967295|k>>>21),k=D+(j^I^w)+P[11]+1839030562&4294967295,D=j+(k<<16&4294967295|k>>>16),k=w+(D^j^I)+P[14]+4259657740&4294967295,w=D+(k<<23&4294967295|k>>>9),k=I+(w^D^j)+P[1]+2763975236&4294967295,I=w+(k<<4&4294967295|k>>>28),k=j+(I^w^D)+P[4]+1272893353&4294967295,j=I+(k<<11&4294967295|k>>>21),k=D+(j^I^w)+P[7]+4139469664&4294967295,D=j+(k<<16&4294967295|k>>>16),k=w+(D^j^I)+P[10]+3200236656&4294967295,w=D+(k<<23&4294967295|k>>>9),k=I+(w^D^j)+P[13]+681279174&4294967295,I=w+(k<<4&4294967295|k>>>28),k=j+(I^w^D)+P[0]+3936430074&4294967295,j=I+(k<<11&4294967295|k>>>21),k=D+(j^I^w)+P[3]+3572445317&4294967295,D=j+(k<<16&4294967295|k>>>16),k=w+(D^j^I)+P[6]+76029189&4294967295,w=D+(k<<23&4294967295|k>>>9),k=I+(w^D^j)+P[9]+3654602809&4294967295,I=w+(k<<4&4294967295|k>>>28),k=j+(I^w^D)+P[12]+3873151461&4294967295,j=I+(k<<11&4294967295|k>>>21),k=D+(j^I^w)+P[15]+530742520&4294967295,D=j+(k<<16&4294967295|k>>>16),k=w+(D^j^I)+P[2]+3299628645&4294967295,w=D+(k<<23&4294967295|k>>>9),k=I+(D^(w|~j))+P[0]+4096336452&4294967295,I=w+(k<<6&4294967295|k>>>26),k=j+(w^(I|~D))+P[7]+1126891415&4294967295,j=I+(k<<10&4294967295|k>>>22),k=D+(I^(j|~w))+P[14]+2878612391&4294967295,D=j+(k<<15&4294967295|k>>>17),k=w+(j^(D|~I))+P[5]+4237533241&4294967295,w=D+(k<<21&4294967295|k>>>11),k=I+(D^(w|~j))+P[12]+1700485571&4294967295,I=w+(k<<6&4294967295|k>>>26),k=j+(w^(I|~D))+P[3]+2399980690&4294967295,j=I+(k<<10&4294967295|k>>>22),k=D+(I^(j|~w))+P[10]+4293915773&4294967295,D=j+(k<<15&4294967295|k>>>17),k=w+(j^(D|~I))+P[1]+2240044497&4294967295,w=D+(k<<21&4294967295|k>>>11),k=I+(D^(w|~j))+P[8]+1873313359&4294967295,I=w+(k<<6&4294967295|k>>>26),k=j+(w^(I|~D))+P[15]+4264355552&4294967295,j=I+(k<<10&4294967295|k>>>22),k=D+(I^(j|~w))+P[6]+2734768916&4294967295,D=j+(k<<15&4294967295|k>>>17),k=w+(j^(D|~I))+P[13]+1309151649&4294967295,w=D+(k<<21&4294967295|k>>>11),k=I+(D^(w|~j))+P[4]+4149444226&4294967295,I=w+(k<<6&4294967295|k>>>26),k=j+(w^(I|~D))+P[11]+3174756917&4294967295,j=I+(k<<10&4294967295|k>>>22),k=D+(I^(j|~w))+P[2]+718787259&4294967295,D=j+(k<<15&4294967295|k>>>17),k=w+(j^(D|~I))+P[9]+3951481745&4294967295,x.g[0]=x.g[0]+I&4294967295,x.g[1]=x.g[1]+(D+(k<<21&4294967295|k>>>11))&4294967295,x.g[2]=x.g[2]+D&4294967295,x.g[3]=x.g[3]+j&4294967295}r.prototype.v=function(x,I){I===void 0&&(I=x.length);const w=I-this.blockSize,P=this.C;let D=this.h,j=0;for(;j<I;){if(D==0)for(;j<=w;)s(this,x,j),j+=this.blockSize;if(typeof x=="string"){for(;j<I;)if(P[D++]=x.charCodeAt(j++),D==this.blockSize){s(this,P),D=0;break}}else for(;j<I;)if(P[D++]=x[j++],D==this.blockSize){s(this,P),D=0;break}}this.h=D,this.o+=I},r.prototype.A=function(){var x=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);x[0]=128;for(var I=1;I<x.length-8;++I)x[I]=0;I=this.o*8;for(var w=x.length-8;w<x.length;++w)x[w]=I&255,I/=256;for(this.v(x),x=Array(16),I=0,w=0;w<4;++w)for(let P=0;P<32;P+=8)x[I++]=this.g[w]>>>P&255;return x};function i(x,I){var w=a;return Object.prototype.hasOwnProperty.call(w,x)?w[x]:w[x]=I(x)}function o(x,I){this.h=I;const w=[];let P=!0;for(let D=x.length-1;D>=0;D--){const j=x[D]|0;P&&j==I||(w[D]=j,P=!1)}this.g=w}var a={};function c(x){return-128<=x&&x<128?i(x,function(I){return new o([I|0],I<0?-1:0)}):new o([x|0],x<0?-1:0)}function d(x){if(isNaN(x)||!isFinite(x))return f;if(x<0)return N(d(-x));const I=[];let w=1;for(let P=0;x>=w;P++)I[P]=x/w|0,w*=4294967296;return new o(I,0)}function h(x,I){if(x.length==0)throw Error("number format error: empty string");if(I=I||10,I<2||36<I)throw Error("radix out of range: "+I);if(x.charAt(0)=="-")return N(h(x.substring(1),I));if(x.indexOf("-")>=0)throw Error('number format error: interior "-" character');const w=d(Math.pow(I,8));let P=f;for(let j=0;j<x.length;j+=8){var D=Math.min(8,x.length-j);const k=parseInt(x.substring(j,j+D),I);D<8?(D=d(Math.pow(I,D)),P=P.j(D).add(d(k))):(P=P.j(w),P=P.add(d(k)))}return P}var f=c(0),m=c(1),_=c(16777216);t=o.prototype,t.m=function(){if(C(this))return-N(this).m();let x=0,I=1;for(let w=0;w<this.g.length;w++){const P=this.i(w);x+=(P>=0?P:4294967296+P)*I,I*=4294967296}return x},t.toString=function(x){if(x=x||10,x<2||36<x)throw Error("radix out of range: "+x);if(R(this))return"0";if(C(this))return"-"+N(this).toString(x);const I=d(Math.pow(x,6));var w=this;let P="";for(;;){const D=E(w,I).g;w=T(w,D.j(I));let j=((w.g.length>0?w.g[0]:w.h)>>>0).toString(x);if(w=D,R(w))return j+P;for(;j.length<6;)j="0"+j;P=j+P}},t.i=function(x){return x<0?0:x<this.g.length?this.g[x]:this.h};function R(x){if(x.h!=0)return!1;for(let I=0;I<x.g.length;I++)if(x.g[I]!=0)return!1;return!0}function C(x){return x.h==-1}t.l=function(x){return x=T(this,x),C(x)?-1:R(x)?0:1};function N(x){const I=x.g.length,w=[];for(let P=0;P<I;P++)w[P]=~x.g[P];return new o(w,~x.h).add(m)}t.abs=function(){return C(this)?N(this):this},t.add=function(x){const I=Math.max(this.g.length,x.g.length),w=[];let P=0;for(let D=0;D<=I;D++){let j=P+(this.i(D)&65535)+(x.i(D)&65535),k=(j>>>16)+(this.i(D)>>>16)+(x.i(D)>>>16);P=k>>>16,j&=65535,k&=65535,w[D]=k<<16|j}return new o(w,w[w.length-1]&-2147483648?-1:0)};function T(x,I){return x.add(N(I))}t.j=function(x){if(R(this)||R(x))return f;if(C(this))return C(x)?N(this).j(N(x)):N(N(this).j(x));if(C(x))return N(this.j(N(x)));if(this.l(_)<0&&x.l(_)<0)return d(this.m()*x.m());const I=this.g.length+x.g.length,w=[];for(var P=0;P<2*I;P++)w[P]=0;for(P=0;P<this.g.length;P++)for(let D=0;D<x.g.length;D++){const j=this.i(P)>>>16,k=this.i(P)&65535,K=x.i(D)>>>16,Ge=x.i(D)&65535;w[2*P+2*D]+=k*Ge,y(w,2*P+2*D),w[2*P+2*D+1]+=j*Ge,y(w,2*P+2*D+1),w[2*P+2*D+1]+=k*K,y(w,2*P+2*D+1),w[2*P+2*D+2]+=j*K,y(w,2*P+2*D+2)}for(x=0;x<I;x++)w[x]=w[2*x+1]<<16|w[2*x];for(x=I;x<2*I;x++)w[x]=0;return new o(w,0)};function y(x,I){for(;(x[I]&65535)!=x[I];)x[I+1]+=x[I]>>>16,x[I]&=65535,I++}function v(x,I){this.g=x,this.h=I}function E(x,I){if(R(I))throw Error("division by zero");if(R(x))return new v(f,f);if(C(x))return I=E(N(x),I),new v(N(I.g),N(I.h));if(C(I))return I=E(x,N(I)),new v(N(I.g),I.h);if(x.g.length>30){if(C(x)||C(I))throw Error("slowDivide_ only works with positive integers.");for(var w=m,P=I;P.l(x)<=0;)w=O(w),P=O(P);var D=F(w,1),j=F(P,1);for(P=F(P,2),w=F(w,2);!R(P);){var k=j.add(P);k.l(x)<=0&&(D=D.add(w),j=k),P=F(P,1),w=F(w,1)}return I=T(x,D.j(I)),new v(D,I)}for(D=f;x.l(I)>=0;){for(w=Math.max(1,Math.floor(x.m()/I.m())),P=Math.ceil(Math.log(w)/Math.LN2),P=P<=48?1:Math.pow(2,P-48),j=d(w),k=j.j(I);C(k)||k.l(x)>0;)w-=P,j=d(w),k=j.j(I);R(j)&&(j=m),D=D.add(j),x=T(x,k)}return new v(D,x)}t.B=function(x){return E(this,x).h},t.and=function(x){const I=Math.max(this.g.length,x.g.length),w=[];for(let P=0;P<I;P++)w[P]=this.i(P)&x.i(P);return new o(w,this.h&x.h)},t.or=function(x){const I=Math.max(this.g.length,x.g.length),w=[];for(let P=0;P<I;P++)w[P]=this.i(P)|x.i(P);return new o(w,this.h|x.h)},t.xor=function(x){const I=Math.max(this.g.length,x.g.length),w=[];for(let P=0;P<I;P++)w[P]=this.i(P)^x.i(P);return new o(w,this.h^x.h)};function O(x){const I=x.g.length+1,w=[];for(let P=0;P<I;P++)w[P]=x.i(P)<<1|x.i(P-1)>>>31;return new o(w,x.h)}function F(x,I){const w=I>>5;I%=32;const P=x.g.length-w,D=[];for(let j=0;j<P;j++)D[j]=I>0?x.i(j+w)>>>I|x.i(j+w+1)<<32-I:x.i(j+w);return new o(D,x.h)}r.prototype.digest=r.prototype.A,r.prototype.reset=r.prototype.u,r.prototype.update=r.prototype.v,rS=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.B,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=d,o.fromString=h,ai=o}).apply(typeof xE<"u"?xE:typeof self<"u"?self:typeof window<"u"?window:{});var Uu=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var sS,Vl,iS,md,Xm,oS,aS,lS;(function(){var t,e=Object.defineProperty;function n(u){u=[typeof globalThis=="object"&&globalThis,u,typeof window=="object"&&window,typeof self=="object"&&self,typeof Uu=="object"&&Uu];for(var p=0;p<u.length;++p){var g=u[p];if(g&&g.Math==Math)return g}throw Error("Cannot find global object")}var r=n(this);function s(u,p){if(p)e:{var g=r;u=u.split(".");for(var S=0;S<u.length-1;S++){var V=u[S];if(!(V in g))break e;g=g[V]}u=u[u.length-1],S=g[u],p=p(S),p!=S&&p!=null&&e(g,u,{configurable:!0,writable:!0,value:p})}}s("Symbol.dispose",function(u){return u||Symbol("Symbol.dispose")}),s("Array.prototype.values",function(u){return u||function(){return this[Symbol.iterator]()}}),s("Object.entries",function(u){return u||function(p){var g=[],S;for(S in p)Object.prototype.hasOwnProperty.call(p,S)&&g.push([S,p[S]]);return g}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var i=i||{},o=this||self;function a(u){var p=typeof u;return p=="object"&&u!=null||p=="function"}function c(u,p,g){return u.call.apply(u.bind,arguments)}function d(u,p,g){return d=c,d.apply(null,arguments)}function h(u,p){var g=Array.prototype.slice.call(arguments,1);return function(){var S=g.slice();return S.push.apply(S,arguments),u.apply(this,S)}}function f(u,p){function g(){}g.prototype=p.prototype,u.Z=p.prototype,u.prototype=new g,u.prototype.constructor=u,u.Ob=function(S,V,$){for(var Z=Array(arguments.length-2),Ne=2;Ne<arguments.length;Ne++)Z[Ne-2]=arguments[Ne];return p.prototype[V].apply(S,Z)}}var m=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?u=>u&&AsyncContext.Snapshot.wrap(u):u=>u;function _(u){const p=u.length;if(p>0){const g=Array(p);for(let S=0;S<p;S++)g[S]=u[S];return g}return[]}function R(u,p){for(let S=1;S<arguments.length;S++){const V=arguments[S];var g=typeof V;if(g=g!="object"?g:V?Array.isArray(V)?"array":g:"null",g=="array"||g=="object"&&typeof V.length=="number"){g=u.length||0;const $=V.length||0;u.length=g+$;for(let Z=0;Z<$;Z++)u[g+Z]=V[Z]}else u.push(V)}}class C{constructor(p,g){this.i=p,this.j=g,this.h=0,this.g=null}get(){let p;return this.h>0?(this.h--,p=this.g,this.g=p.next,p.next=null):p=this.i(),p}}function N(u){o.setTimeout(()=>{throw u},0)}function T(){var u=x;let p=null;return u.g&&(p=u.g,u.g=u.g.next,u.g||(u.h=null),p.next=null),p}class y{constructor(){this.h=this.g=null}add(p,g){const S=v.get();S.set(p,g),this.h?this.h.next=S:this.g=S,this.h=S}}var v=new C(()=>new E,u=>u.reset());class E{constructor(){this.next=this.g=this.h=null}set(p,g){this.h=p,this.g=g,this.next=null}reset(){this.next=this.g=this.h=null}}let O,F=!1,x=new y,I=()=>{const u=Promise.resolve(void 0);O=()=>{u.then(w)}};function w(){for(var u;u=T();){try{u.h.call(u.g)}catch(g){N(g)}var p=v;p.j(u),p.h<100&&(p.h++,u.next=p.g,p.g=u)}F=!1}function P(){this.u=this.u,this.C=this.C}P.prototype.u=!1,P.prototype.dispose=function(){this.u||(this.u=!0,this.N())},P.prototype[Symbol.dispose]=function(){this.dispose()},P.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function D(u,p){this.type=u,this.g=this.target=p,this.defaultPrevented=!1}D.prototype.h=function(){this.defaultPrevented=!0};var j=function(){if(!o.addEventListener||!Object.defineProperty)return!1;var u=!1,p=Object.defineProperty({},"passive",{get:function(){u=!0}});try{const g=()=>{};o.addEventListener("test",g,p),o.removeEventListener("test",g,p)}catch{}return u}();function k(u){return/^[\s\xa0]*$/.test(u)}function K(u,p){D.call(this,u?u.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,u&&this.init(u,p)}f(K,D),K.prototype.init=function(u,p){const g=this.type=u.type,S=u.changedTouches&&u.changedTouches.length?u.changedTouches[0]:null;this.target=u.target||u.srcElement,this.g=p,p=u.relatedTarget,p||(g=="mouseover"?p=u.fromElement:g=="mouseout"&&(p=u.toElement)),this.relatedTarget=p,S?(this.clientX=S.clientX!==void 0?S.clientX:S.pageX,this.clientY=S.clientY!==void 0?S.clientY:S.pageY,this.screenX=S.screenX||0,this.screenY=S.screenY||0):(this.clientX=u.clientX!==void 0?u.clientX:u.pageX,this.clientY=u.clientY!==void 0?u.clientY:u.pageY,this.screenX=u.screenX||0,this.screenY=u.screenY||0),this.button=u.button,this.key=u.key||"",this.ctrlKey=u.ctrlKey,this.altKey=u.altKey,this.shiftKey=u.shiftKey,this.metaKey=u.metaKey,this.pointerId=u.pointerId||0,this.pointerType=u.pointerType,this.state=u.state,this.i=u,u.defaultPrevented&&K.Z.h.call(this)},K.prototype.h=function(){K.Z.h.call(this);const u=this.i;u.preventDefault?u.preventDefault():u.returnValue=!1};var Ge="closure_listenable_"+(Math.random()*1e6|0),$t=0;function hn(u,p,g,S,V){this.listener=u,this.proxy=null,this.src=p,this.type=g,this.capture=!!S,this.ha=V,this.key=++$t,this.da=this.fa=!1}function ee(u){u.da=!0,u.listener=null,u.proxy=null,u.src=null,u.ha=null}function he(u,p,g){for(const S in u)p.call(g,u[S],S,u)}function me(u,p){for(const g in u)p.call(void 0,u[g],g,u)}function ke(u){const p={};for(const g in u)p[g]=u[g];return p}const Ye="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function jt(u,p){let g,S;for(let V=1;V<arguments.length;V++){S=arguments[V];for(g in S)u[g]=S[g];for(let $=0;$<Ye.length;$++)g=Ye[$],Object.prototype.hasOwnProperty.call(S,g)&&(u[g]=S[g])}}function U(u){this.src=u,this.g={},this.h=0}U.prototype.add=function(u,p,g,S,V){const $=u.toString();u=this.g[$],u||(u=this.g[$]=[],this.h++);const Z=ce(u,p,S,V);return Z>-1?(p=u[Z],g||(p.fa=!1)):(p=new hn(p,this.src,$,!!S,V),p.fa=g,u.push(p)),p};function ne(u,p){const g=p.type;if(g in u.g){var S=u.g[g],V=Array.prototype.indexOf.call(S,p,void 0),$;($=V>=0)&&Array.prototype.splice.call(S,V,1),$&&(ee(p),u.g[g].length==0&&(delete u.g[g],u.h--))}}function ce(u,p,g,S){for(let V=0;V<u.length;++V){const $=u[V];if(!$.da&&$.listener==p&&$.capture==!!g&&$.ha==S)return V}return-1}var Te="closure_lm_"+(Math.random()*1e6|0),be={};function je(u,p,g,S,V){if(Array.isArray(p)){for(let $=0;$<p.length;$++)je(u,p[$],g,S,V);return null}return g=se(g),u&&u[Ge]?u.J(p,g,a(S)?!!S.capture:!1,V):_e(u,p,g,!1,S,V)}function _e(u,p,g,S,V,$){if(!p)throw Error("Invalid event type");const Z=a(V)?!!V.capture:!!V;let Ne=tt(u);if(Ne||(u[Te]=Ne=new U(u)),g=Ne.add(p,g,S,Z,$),g.proxy)return g;if(S=it(),g.proxy=S,S.src=u,S.listener=g,u.addEventListener)j||(V=Z),V===void 0&&(V=!1),u.addEventListener(p.toString(),S,V);else if(u.attachEvent)u.attachEvent(Oe(p.toString()),S);else if(u.addListener&&u.removeListener)u.addListener(S);else throw Error("addEventListener and attachEvent are unavailable.");return g}function it(){function u(g){return p.call(u.src,u.listener,g)}const p=$e;return u}function Re(u,p,g,S,V){if(Array.isArray(p))for(var $=0;$<p.length;$++)Re(u,p[$],g,S,V);else S=a(S)?!!S.capture:!!S,g=se(g),u&&u[Ge]?(u=u.i,$=String(p).toString(),$ in u.g&&(p=u.g[$],g=ce(p,g,S,V),g>-1&&(ee(p[g]),Array.prototype.splice.call(p,g,1),p.length==0&&(delete u.g[$],u.h--)))):u&&(u=tt(u))&&(p=u.g[p.toString()],u=-1,p&&(u=ce(p,g,S,V)),(g=u>-1?p[u]:null)&&le(g))}function le(u){if(typeof u!="number"&&u&&!u.da){var p=u.src;if(p&&p[Ge])ne(p.i,u);else{var g=u.type,S=u.proxy;p.removeEventListener?p.removeEventListener(g,S,u.capture):p.detachEvent?p.detachEvent(Oe(g),S):p.addListener&&p.removeListener&&p.removeListener(S),(g=tt(p))?(ne(g,u),g.h==0&&(g.src=null,p[Te]=null)):ee(u)}}}function Oe(u){return u in be?be[u]:be[u]="on"+u}function $e(u,p){if(u.da)u=!0;else{p=new K(p,this);const g=u.listener,S=u.ha||u.src;u.fa&&le(u),u=g.call(S,p)}return u}function tt(u){return u=u[Te],u instanceof U?u:null}var H="__closure_events_fn_"+(Math.random()*1e9>>>0);function se(u){return typeof u=="function"?u:(u[H]||(u[H]=function(p){return u.handleEvent(p)}),u[H])}function B(){P.call(this),this.i=new U(this),this.M=this,this.G=null}f(B,P),B.prototype[Ge]=!0,B.prototype.removeEventListener=function(u,p,g,S){Re(this,u,p,g,S)};function re(u,p){var g,S=u.G;if(S)for(g=[];S;S=S.G)g.push(S);if(u=u.M,S=p.type||p,typeof p=="string")p=new D(p,u);else if(p instanceof D)p.target=p.target||u;else{var V=p;p=new D(S,u),jt(p,V)}V=!0;let $,Z;if(g)for(Z=g.length-1;Z>=0;Z--)$=p.g=g[Z],V=ie($,S,!0,p)&&V;if($=p.g=u,V=ie($,S,!0,p)&&V,V=ie($,S,!1,p)&&V,g)for(Z=0;Z<g.length;Z++)$=p.g=g[Z],V=ie($,S,!1,p)&&V}B.prototype.N=function(){if(B.Z.N.call(this),this.i){var u=this.i;for(const p in u.g){const g=u.g[p];for(let S=0;S<g.length;S++)ee(g[S]);delete u.g[p],u.h--}}this.G=null},B.prototype.J=function(u,p,g,S){return this.i.add(String(u),p,!1,g,S)},B.prototype.K=function(u,p,g,S){return this.i.add(String(u),p,!0,g,S)};function ie(u,p,g,S){if(p=u.i.g[String(p)],!p)return!0;p=p.concat();let V=!0;for(let $=0;$<p.length;++$){const Z=p[$];if(Z&&!Z.da&&Z.capture==g){const Ne=Z.listener,Ot=Z.ha||Z.src;Z.fa&&ne(u.i,Z),V=Ne.call(Ot,S)!==!1&&V}}return V&&!S.defaultPrevented}function ye(u,p){if(typeof u!="function")if(u&&typeof u.handleEvent=="function")u=d(u.handleEvent,u);else throw Error("Invalid listener argument");return Number(p)>2147483647?-1:o.setTimeout(u,p||0)}function ve(u){u.g=ye(()=>{u.g=null,u.i&&(u.i=!1,ve(u))},u.l);const p=u.h;u.h=null,u.m.apply(null,p)}class Me extends P{constructor(p,g){super(),this.m=p,this.l=g,this.h=null,this.i=!1,this.g=null}j(p){this.h=arguments,this.g?this.i=!0:ve(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Se(u){P.call(this),this.h=u,this.g={}}f(Se,P);var Le=[];function Ae(u){he(u.g,function(p,g){this.g.hasOwnProperty(g)&&le(p)},u),u.g={}}Se.prototype.N=function(){Se.Z.N.call(this),Ae(this)},Se.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Ie=o.JSON.stringify,M=o.JSON.parse,Y=class{stringify(u){return o.JSON.stringify(u,void 0)}parse(u){return o.JSON.parse(u,void 0)}};function J(){}function Ce(){}var nt={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function St(){D.call(this,"d")}f(St,D);function Rr(){D.call(this,"c")}f(Rr,D);var xn={},jn=null;function en(){return jn=jn||new B}xn.Ia="serverreachability";function Ct(u){D.call(this,xn.Ia,u)}f(Ct,D);function Bt(u){const p=en();re(p,new Ct(p))}xn.STAT_EVENT="statevent";function zt(u,p){D.call(this,xn.STAT_EVENT,u),this.stat=p}f(zt,D);function Ke(u){const p=en();re(p,new zt(p,u))}xn.Ja="timingevent";function At(u,p){D.call(this,xn.Ja,u),this.size=p}f(At,D);function Nr(u,p){if(typeof u!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){u()},p)}function dr(){this.g=!0}dr.prototype.ua=function(){this.g=!1};function Ts(u,p,g,S,V,$){u.info(function(){if(u.g)if($){var Z="",Ne=$.split("&");for(let rt=0;rt<Ne.length;rt++){var Ot=Ne[rt].split("=");if(Ot.length>1){const qt=Ot[0];Ot=Ot[1];const Dr=qt.split("_");Z=Dr.length>=2&&Dr[1]=="type"?Z+(qt+"="+Ot+"&"):Z+(qt+"=redacted&")}}}else Z=null;else Z=$;return"XMLHTTP REQ ("+S+") [attempt "+V+"]: "+p+`
`+g+`
`+Z})}function On(u,p,g,S,V,$,Z){u.info(function(){return"XMLHTTP RESP ("+S+") [ attempt "+V+"]: "+p+`
`+g+`
`+$+" "+Z})}function Xr(u,p,g,S){u.info(function(){return"XMLHTTP TEXT ("+p+"): "+hu(u,g)+(S?" "+S:"")})}function du(u,p){u.info(function(){return"TIMEOUT: "+p})}dr.prototype.info=function(){};function hu(u,p){if(!u.g)return p;if(!p)return null;try{const $=JSON.parse(p);if($){for(u=0;u<$.length;u++)if(Array.isArray($[u])){var g=$[u];if(!(g.length<2)){var S=g[1];if(Array.isArray(S)&&!(S.length<1)){var V=S[0];if(V!="noop"&&V!="stop"&&V!="close")for(let Z=1;Z<S.length;Z++)S[Z]=""}}}}return Ie($)}catch{return p}}var Ci={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},rl={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},b;function q(){}f(q,J),q.prototype.g=function(){return new XMLHttpRequest},b=new q;function X(u){return encodeURIComponent(String(u))}function de(u){var p=1;u=u.split(":");const g=[];for(;p>0&&u.length;)g.push(u.shift()),p--;return u.length&&g.push(u.join(":")),g}function ge(u,p,g,S){this.j=u,this.i=p,this.l=g,this.S=S||1,this.V=new Se(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new We}function We(){this.i=null,this.g="",this.h=!1}var Pr={},Qn={};function Yn(u,p,g){u.M=1,u.A=fu(kr(p)),u.u=g,u.R=!0,Rt(u,null)}function Rt(u,p){u.F=Date.now(),Jr(u),u.B=kr(u.A);var g=u.B,S=u.S;Array.isArray(S)||(S=[String(S)]),l_(g.i,"t",S),u.C=0,g=u.j.L,u.h=new We,u.g=S_(u.j,g?p:null,!u.u),u.P>0&&(u.O=new Me(d(u.Y,u,u.g),u.P)),p=u.V,g=u.g,S=u.ba;var V="readystatechange";Array.isArray(V)||(V&&(Le[0]=V.toString()),V=Le);for(let $=0;$<V.length;$++){const Z=je(g,V[$],S||p.handleEvent,!1,p.h||p);if(!Z)break;p.g[Z.key]=Z}p=u.J?ke(u.J):{},u.u?(u.v||(u.v="POST"),p["Content-Type"]="application/x-www-form-urlencoded",u.g.ea(u.B,u.v,u.u,p)):(u.v="GET",u.g.ea(u.B,u.v,null,p)),Bt(),Ts(u.i,u.v,u.B,u.l,u.S,u.u)}ge.prototype.ba=function(u){u=u.target;const p=this.O;p&&Cs(u)==3?p.j():this.Y(u)},ge.prototype.Y=function(u){try{if(u==this.g)e:{const Ne=Cs(this.g),Ot=this.g.ya(),rt=this.g.ca();if(!(Ne<3)&&(Ne!=3||this.g&&(this.h.h||this.g.la()||m_(this.g)))){this.K||Ne!=4||Ot==7||(Ot==8||rt<=0?Bt(3):Bt(2)),Ro(this);var p=this.g.ca();this.X=p;var g=Tn(this);if(this.o=p==200,On(this.i,this.v,this.B,this.l,this.S,Ne,p),this.o){if(this.U&&!this.L){t:{if(this.g){var S,V=this.g;if((S=V.g?V.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!k(S)){var $=S;break t}}$=null}if(u=$)Xr(this.i,this.l,u,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,Lf(this,u);else{this.o=!1,this.m=3,Ke(12),Ai(this),es(this);break e}}if(this.R){u=!0;let qt;for(;!this.K&&this.C<g.length;)if(qt=hr(this,g),qt==Qn){Ne==4&&(this.m=4,Ke(14),u=!1),Xr(this.i,this.l,null,"[Incomplete Response]");break}else if(qt==Pr){this.m=4,Ke(15),Xr(this.i,this.l,g,"[Invalid Chunk]"),u=!1;break}else Xr(this.i,this.l,qt,null),Lf(this,qt);if(bn(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Ne!=4||g.length!=0||this.h.h||(this.m=1,Ke(16),u=!1),this.o=this.o&&u,!u)Xr(this.i,this.l,g,"[Invalid Chunked Response]"),Ai(this),es(this);else if(g.length>0&&!this.W){this.W=!0;var Z=this.j;Z.g==this&&Z.aa&&!Z.P&&(Z.j.info("Great, no buffering proxy detected. Bytes received: "+g.length),qf(Z),Z.P=!0,Ke(11))}}else Xr(this.i,this.l,g,null),Lf(this,g);Ne==4&&Ai(this),this.o&&!this.K&&(Ne==4?I_(this.j,this):(this.o=!1,Jr(this)))}else g1(this.g),p==400&&g.indexOf("Unknown SID")>0?(this.m=3,Ke(12)):(this.m=0,Ke(13)),Ai(this),es(this)}}}catch{}finally{}};function Tn(u){if(!bn(u))return u.g.la();const p=m_(u.g);if(p==="")return"";let g="";const S=p.length,V=Cs(u.g)==4;if(!u.h.i){if(typeof TextDecoder>"u")return Ai(u),es(u),"";u.h.i=new o.TextDecoder}for(let $=0;$<S;$++)u.h.h=!0,g+=u.h.i.decode(p[$],{stream:!(V&&$==S-1)});return p.length=0,u.h.g+=g,u.C=0,u.h.g}function bn(u){return u.g?u.v=="GET"&&u.M!=2&&u.j.Aa:!1}function hr(u,p){var g=u.C,S=p.indexOf(`
`,g);return S==-1?Qn:(g=Number(p.substring(g,S)),isNaN(g)?Pr:(S+=1,S+g>p.length?Qn:(p=p.slice(S,S+g),u.C=S+g,p)))}ge.prototype.cancel=function(){this.K=!0,Ai(this)};function Jr(u){u.T=Date.now()+u.H,Zr(u,u.H)}function Zr(u,p){if(u.D!=null)throw Error("WatchDog timer not null");u.D=Nr(d(u.aa,u),p)}function Ro(u){u.D&&(o.clearTimeout(u.D),u.D=null)}ge.prototype.aa=function(){this.D=null;const u=Date.now();u-this.T>=0?(du(this.i,this.B),this.M!=2&&(Bt(),Ke(17)),Ai(this),this.m=2,es(this)):Zr(this,this.T-u)};function es(u){u.j.I==0||u.K||I_(u.j,u)}function Ai(u){Ro(u);var p=u.O;p&&typeof p.dispose=="function"&&p.dispose(),u.O=null,Ae(u.V),u.g&&(p=u.g,u.g=null,p.abort(),p.dispose())}function Lf(u,p){try{var g=u.j;if(g.I!=0&&(g.g==u||Vf(g.h,u))){if(!u.L&&Vf(g.h,u)&&g.I==3){try{var S=g.Ba.g.parse(p)}catch{S=null}if(Array.isArray(S)&&S.length==3){var V=S;if(V[0]==0){e:if(!g.v){if(g.g)if(g.g.F+3e3<u.F)vu(g),gu(g);else break e;zf(g),Ke(18)}}else g.xa=V[1],0<g.xa-g.K&&V[2]<37500&&g.F&&g.A==0&&!g.C&&(g.C=Nr(d(g.Va,g),6e3));e_(g.h)<=1&&g.ta&&(g.ta=void 0)}else Ni(g,11)}else if((u.L||g.g==u)&&vu(g),!k(p))for(V=g.Ba.g.parse(p),p=0;p<V.length;p++){let rt=V[p];const qt=rt[0];if(!(qt<=g.K))if(g.K=qt,rt=rt[1],g.I==2)if(rt[0]=="c"){g.M=rt[1],g.ba=rt[2];const Dr=rt[3];Dr!=null&&(g.ka=Dr,g.j.info("VER="+g.ka));const Pi=rt[4];Pi!=null&&(g.za=Pi,g.j.info("SVER="+g.za));const As=rt[5];As!=null&&typeof As=="number"&&As>0&&(S=1.5*As,g.O=S,g.j.info("backChannelRequestTimeoutMs_="+S)),S=g;const Rs=u.g;if(Rs){const wu=Rs.g?Rs.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(wu){var $=S.h;$.g||wu.indexOf("spdy")==-1&&wu.indexOf("quic")==-1&&wu.indexOf("h2")==-1||($.j=$.l,$.g=new Set,$.h&&(Mf($,$.h),$.h=null))}if(S.G){const Hf=Rs.g?Rs.g.getResponseHeader("X-HTTP-Session-Id"):null;Hf&&(S.wa=Hf,at(S.J,S.G,Hf))}}g.I=3,g.l&&g.l.ra(),g.aa&&(g.T=Date.now()-u.F,g.j.info("Handshake RTT: "+g.T+"ms")),S=g;var Z=u;if(S.na=b_(S,S.L?S.ba:null,S.W),Z.L){t_(S.h,Z);var Ne=Z,Ot=S.O;Ot&&(Ne.H=Ot),Ne.D&&(Ro(Ne),Jr(Ne)),S.g=Z}else w_(S);g.i.length>0&&yu(g)}else rt[0]!="stop"&&rt[0]!="close"||Ni(g,7);else g.I==3&&(rt[0]=="stop"||rt[0]=="close"?rt[0]=="stop"?Ni(g,7):Bf(g):rt[0]!="noop"&&g.l&&g.l.qa(rt),g.A=0)}}Bt(4)}catch{}}var r1=class{constructor(u,p){this.g=u,this.map=p}};function Jv(u){this.l=u||10,o.PerformanceNavigationTiming?(u=o.performance.getEntriesByType("navigation"),u=u.length>0&&(u[0].nextHopProtocol=="hq"||u[0].nextHopProtocol=="h2")):u=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=u?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function Zv(u){return u.h?!0:u.g?u.g.size>=u.j:!1}function e_(u){return u.h?1:u.g?u.g.size:0}function Vf(u,p){return u.h?u.h==p:u.g?u.g.has(p):!1}function Mf(u,p){u.g?u.g.add(p):u.h=p}function t_(u,p){u.h&&u.h==p?u.h=null:u.g&&u.g.has(p)&&u.g.delete(p)}Jv.prototype.cancel=function(){if(this.i=n_(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const u of this.g.values())u.cancel();this.g.clear()}};function n_(u){if(u.h!=null)return u.i.concat(u.h.G);if(u.g!=null&&u.g.size!==0){let p=u.i;for(const g of u.g.values())p=p.concat(g.G);return p}return _(u.i)}var r_=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function s1(u,p){if(u){u=u.split("&");for(let g=0;g<u.length;g++){const S=u[g].indexOf("=");let V,$=null;S>=0?(V=u[g].substring(0,S),$=u[g].substring(S+1)):V=u[g],p(V,$?decodeURIComponent($.replace(/\+/g," ")):"")}}}function bs(u){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let p;u instanceof bs?(this.l=u.l,sl(this,u.j),this.o=u.o,this.g=u.g,il(this,u.u),this.h=u.h,Ff(this,c_(u.i)),this.m=u.m):u&&(p=String(u).match(r_))?(this.l=!1,sl(this,p[1]||"",!0),this.o=ol(p[2]||""),this.g=ol(p[3]||"",!0),il(this,p[4]),this.h=ol(p[5]||"",!0),Ff(this,p[6]||"",!0),this.m=ol(p[7]||"")):(this.l=!1,this.i=new ll(null,this.l))}bs.prototype.toString=function(){const u=[];var p=this.j;p&&u.push(al(p,s_,!0),":");var g=this.g;return(g||p=="file")&&(u.push("//"),(p=this.o)&&u.push(al(p,s_,!0),"@"),u.push(X(g).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),g=this.u,g!=null&&u.push(":",String(g))),(g=this.h)&&(this.g&&g.charAt(0)!="/"&&u.push("/"),u.push(al(g,g.charAt(0)=="/"?a1:o1,!0))),(g=this.i.toString())&&u.push("?",g),(g=this.m)&&u.push("#",al(g,c1)),u.join("")},bs.prototype.resolve=function(u){const p=kr(this);let g=!!u.j;g?sl(p,u.j):g=!!u.o,g?p.o=u.o:g=!!u.g,g?p.g=u.g:g=u.u!=null;var S=u.h;if(g)il(p,u.u);else if(g=!!u.h){if(S.charAt(0)!="/")if(this.g&&!this.h)S="/"+S;else{var V=p.h.lastIndexOf("/");V!=-1&&(S=p.h.slice(0,V+1)+S)}if(V=S,V==".."||V==".")S="";else if(V.indexOf("./")!=-1||V.indexOf("/.")!=-1){S=V.lastIndexOf("/",0)==0,V=V.split("/");const $=[];for(let Z=0;Z<V.length;){const Ne=V[Z++];Ne=="."?S&&Z==V.length&&$.push(""):Ne==".."?(($.length>1||$.length==1&&$[0]!="")&&$.pop(),S&&Z==V.length&&$.push("")):($.push(Ne),S=!0)}S=$.join("/")}else S=V}return g?p.h=S:g=u.i.toString()!=="",g?Ff(p,c_(u.i)):g=!!u.m,g&&(p.m=u.m),p};function kr(u){return new bs(u)}function sl(u,p,g){u.j=g?ol(p,!0):p,u.j&&(u.j=u.j.replace(/:$/,""))}function il(u,p){if(p){if(p=Number(p),isNaN(p)||p<0)throw Error("Bad port number "+p);u.u=p}else u.u=null}function Ff(u,p,g){p instanceof ll?(u.i=p,u1(u.i,u.l)):(g||(p=al(p,l1)),u.i=new ll(p,u.l))}function at(u,p,g){u.i.set(p,g)}function fu(u){return at(u,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),u}function ol(u,p){return u?p?decodeURI(u.replace(/%25/g,"%2525")):decodeURIComponent(u):""}function al(u,p,g){return typeof u=="string"?(u=encodeURI(u).replace(p,i1),g&&(u=u.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),u):null}function i1(u){return u=u.charCodeAt(0),"%"+(u>>4&15).toString(16)+(u&15).toString(16)}var s_=/[#\/\?@]/g,o1=/[#\?:]/g,a1=/[#\?]/g,l1=/[#\?@]/g,c1=/#/g;function ll(u,p){this.h=this.g=null,this.i=u||null,this.j=!!p}function Ri(u){u.g||(u.g=new Map,u.h=0,u.i&&s1(u.i,function(p,g){u.add(decodeURIComponent(p.replace(/\+/g," ")),g)}))}t=ll.prototype,t.add=function(u,p){Ri(this),this.i=null,u=No(this,u);let g=this.g.get(u);return g||this.g.set(u,g=[]),g.push(p),this.h+=1,this};function i_(u,p){Ri(u),p=No(u,p),u.g.has(p)&&(u.i=null,u.h-=u.g.get(p).length,u.g.delete(p))}function o_(u,p){return Ri(u),p=No(u,p),u.g.has(p)}t.forEach=function(u,p){Ri(this),this.g.forEach(function(g,S){g.forEach(function(V){u.call(p,V,S,this)},this)},this)};function a_(u,p){Ri(u);let g=[];if(typeof p=="string")o_(u,p)&&(g=g.concat(u.g.get(No(u,p))));else for(u=Array.from(u.g.values()),p=0;p<u.length;p++)g=g.concat(u[p]);return g}t.set=function(u,p){return Ri(this),this.i=null,u=No(this,u),o_(this,u)&&(this.h-=this.g.get(u).length),this.g.set(u,[p]),this.h+=1,this},t.get=function(u,p){return u?(u=a_(this,u),u.length>0?String(u[0]):p):p};function l_(u,p,g){i_(u,p),g.length>0&&(u.i=null,u.g.set(No(u,p),_(g)),u.h+=g.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const u=[],p=Array.from(this.g.keys());for(let S=0;S<p.length;S++){var g=p[S];const V=X(g);g=a_(this,g);for(let $=0;$<g.length;$++){let Z=V;g[$]!==""&&(Z+="="+X(g[$])),u.push(Z)}}return this.i=u.join("&")};function c_(u){const p=new ll;return p.i=u.i,u.g&&(p.g=new Map(u.g),p.h=u.h),p}function No(u,p){return p=String(p),u.j&&(p=p.toLowerCase()),p}function u1(u,p){p&&!u.j&&(Ri(u),u.i=null,u.g.forEach(function(g,S){const V=S.toLowerCase();S!=V&&(i_(this,S),l_(this,V,g))},u)),u.j=p}function d1(u,p){const g=new dr;if(o.Image){const S=new Image;S.onload=h(Ss,g,"TestLoadImage: loaded",!0,p,S),S.onerror=h(Ss,g,"TestLoadImage: error",!1,p,S),S.onabort=h(Ss,g,"TestLoadImage: abort",!1,p,S),S.ontimeout=h(Ss,g,"TestLoadImage: timeout",!1,p,S),o.setTimeout(function(){S.ontimeout&&S.ontimeout()},1e4),S.src=u}else p(!1)}function h1(u,p){const g=new dr,S=new AbortController,V=setTimeout(()=>{S.abort(),Ss(g,"TestPingServer: timeout",!1,p)},1e4);fetch(u,{signal:S.signal}).then($=>{clearTimeout(V),$.ok?Ss(g,"TestPingServer: ok",!0,p):Ss(g,"TestPingServer: server error",!1,p)}).catch(()=>{clearTimeout(V),Ss(g,"TestPingServer: error",!1,p)})}function Ss(u,p,g,S,V){try{V&&(V.onload=null,V.onerror=null,V.onabort=null,V.ontimeout=null),S(g)}catch{}}function f1(){this.g=new Y}function Uf(u){this.i=u.Sb||null,this.h=u.ab||!1}f(Uf,J),Uf.prototype.g=function(){return new pu(this.i,this.h)};function pu(u,p){B.call(this),this.H=u,this.o=p,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}f(pu,B),t=pu.prototype,t.open=function(u,p){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=u,this.D=p,this.readyState=1,ul(this)},t.send=function(u){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const p={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};u&&(p.body=u),(this.H||o).fetch(new Request(this.D,p)).then(this.Pa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,cl(this)),this.readyState=0},t.Pa=function(u){if(this.g&&(this.l=u,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=u.headers,this.readyState=2,ul(this)),this.g&&(this.readyState=3,ul(this),this.g)))if(this.responseType==="arraybuffer")u.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in u){if(this.j=u.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;u_(this)}else u.text().then(this.Oa.bind(this),this.ga.bind(this))};function u_(u){u.j.read().then(u.Ma.bind(u)).catch(u.ga.bind(u))}t.Ma=function(u){if(this.g){if(this.o&&u.value)this.response.push(u.value);else if(!this.o){var p=u.value?u.value:new Uint8Array(0);(p=this.B.decode(p,{stream:!u.done}))&&(this.response=this.responseText+=p)}u.done?cl(this):ul(this),this.readyState==3&&u_(this)}},t.Oa=function(u){this.g&&(this.response=this.responseText=u,cl(this))},t.Na=function(u){this.g&&(this.response=u,cl(this))},t.ga=function(){this.g&&cl(this)};function cl(u){u.readyState=4,u.l=null,u.j=null,u.B=null,ul(u)}t.setRequestHeader=function(u,p){this.A.append(u,p)},t.getResponseHeader=function(u){return this.h&&this.h.get(u.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const u=[],p=this.h.entries();for(var g=p.next();!g.done;)g=g.value,u.push(g[0]+": "+g[1]),g=p.next();return u.join(`\r
`)};function ul(u){u.onreadystatechange&&u.onreadystatechange.call(u)}Object.defineProperty(pu.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(u){this.m=u?"include":"same-origin"}});function d_(u){let p="";return he(u,function(g,S){p+=S,p+=":",p+=g,p+=`\r
`}),p}function $f(u,p,g){e:{for(S in g){var S=!1;break e}S=!0}S||(g=d_(g),typeof u=="string"?g!=null&&X(g):at(u,p,g))}function _t(u){B.call(this),this.headers=new Map,this.L=u||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}f(_t,B);var p1=/^https?$/i,m1=["POST","PUT"];t=_t.prototype,t.Fa=function(u){this.H=u},t.ea=function(u,p,g,S){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+u);p=p?p.toUpperCase():"GET",this.D=u,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():b.g(),this.g.onreadystatechange=m(d(this.Ca,this));try{this.B=!0,this.g.open(p,String(u),!0),this.B=!1}catch($){h_(this,$);return}if(u=g||"",g=new Map(this.headers),S)if(Object.getPrototypeOf(S)===Object.prototype)for(var V in S)g.set(V,S[V]);else if(typeof S.keys=="function"&&typeof S.get=="function")for(const $ of S.keys())g.set($,S.get($));else throw Error("Unknown input type for opt_headers: "+String(S));S=Array.from(g.keys()).find($=>$.toLowerCase()=="content-type"),V=o.FormData&&u instanceof o.FormData,!(Array.prototype.indexOf.call(m1,p,void 0)>=0)||S||V||g.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[$,Z]of g)this.g.setRequestHeader($,Z);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(u),this.v=!1}catch($){h_(this,$)}};function h_(u,p){u.h=!1,u.g&&(u.j=!0,u.g.abort(),u.j=!1),u.l=p,u.o=5,f_(u),mu(u)}function f_(u){u.A||(u.A=!0,re(u,"complete"),re(u,"error"))}t.abort=function(u){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=u||7,re(this,"complete"),re(this,"abort"),mu(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),mu(this,!0)),_t.Z.N.call(this)},t.Ca=function(){this.u||(this.B||this.v||this.j?p_(this):this.Xa())},t.Xa=function(){p_(this)};function p_(u){if(u.h&&typeof i<"u"){if(u.v&&Cs(u)==4)setTimeout(u.Ca.bind(u),0);else if(re(u,"readystatechange"),Cs(u)==4){u.h=!1;try{const $=u.ca();e:switch($){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var p=!0;break e;default:p=!1}var g;if(!(g=p)){var S;if(S=$===0){let Z=String(u.D).match(r_)[1]||null;!Z&&o.self&&o.self.location&&(Z=o.self.location.protocol.slice(0,-1)),S=!p1.test(Z?Z.toLowerCase():"")}g=S}if(g)re(u,"complete"),re(u,"success");else{u.o=6;try{var V=Cs(u)>2?u.g.statusText:""}catch{V=""}u.l=V+" ["+u.ca()+"]",f_(u)}}finally{mu(u)}}}}function mu(u,p){if(u.g){u.m&&(clearTimeout(u.m),u.m=null);const g=u.g;u.g=null,p||re(u,"ready");try{g.onreadystatechange=null}catch{}}}t.isActive=function(){return!!this.g};function Cs(u){return u.g?u.g.readyState:0}t.ca=function(){try{return Cs(this)>2?this.g.status:-1}catch{return-1}},t.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.La=function(u){if(this.g){var p=this.g.responseText;return u&&p.indexOf(u)==0&&(p=p.substring(u.length)),M(p)}};function m_(u){try{if(!u.g)return null;if("response"in u.g)return u.g.response;switch(u.F){case"":case"text":return u.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in u.g)return u.g.mozResponseArrayBuffer}return null}catch{return null}}function g1(u){const p={};u=(u.g&&Cs(u)>=2&&u.g.getAllResponseHeaders()||"").split(`\r
`);for(let S=0;S<u.length;S++){if(k(u[S]))continue;var g=de(u[S]);const V=g[0];if(g=g[1],typeof g!="string")continue;g=g.trim();const $=p[V]||[];p[V]=$,$.push(g)}me(p,function(S){return S.join(", ")})}t.ya=function(){return this.o},t.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function dl(u,p,g){return g&&g.internalChannelParams&&g.internalChannelParams[u]||p}function g_(u){this.za=0,this.i=[],this.j=new dr,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=dl("failFast",!1,u),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=dl("baseRetryDelayMs",5e3,u),this.Za=dl("retryDelaySeedMs",1e4,u),this.Ta=dl("forwardChannelMaxRetries",2,u),this.va=dl("forwardChannelRequestTimeoutMs",2e4,u),this.ma=u&&u.xmlHttpFactory||void 0,this.Ua=u&&u.Rb||void 0,this.Aa=u&&u.useFetchStreams||!1,this.O=void 0,this.L=u&&u.supportsCrossDomainXhr||!1,this.M="",this.h=new Jv(u&&u.concurrentRequestLimit),this.Ba=new f1,this.S=u&&u.fastHandshake||!1,this.R=u&&u.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=u&&u.Pb||!1,u&&u.ua&&this.j.ua(),u&&u.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&u&&u.detectBufferingProxy||!1,this.ia=void 0,u&&u.longPollingTimeout&&u.longPollingTimeout>0&&(this.ia=u.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}t=g_.prototype,t.ka=8,t.I=1,t.connect=function(u,p,g,S){Ke(0),this.W=u,this.H=p||{},g&&S!==void 0&&(this.H.OSID=g,this.H.OAID=S),this.F=this.X,this.J=b_(this,null,this.W),yu(this)};function Bf(u){if(y_(u),u.I==3){var p=u.V++,g=kr(u.J);if(at(g,"SID",u.M),at(g,"RID",p),at(g,"TYPE","terminate"),hl(u,g),p=new ge(u,u.j,p),p.M=2,p.A=fu(kr(g)),g=!1,o.navigator&&o.navigator.sendBeacon)try{g=o.navigator.sendBeacon(p.A.toString(),"")}catch{}!g&&o.Image&&(new Image().src=p.A,g=!0),g||(p.g=S_(p.j,null),p.g.ea(p.A)),p.F=Date.now(),Jr(p)}T_(u)}function gu(u){u.g&&(qf(u),u.g.cancel(),u.g=null)}function y_(u){gu(u),u.v&&(o.clearTimeout(u.v),u.v=null),vu(u),u.h.cancel(),u.m&&(typeof u.m=="number"&&o.clearTimeout(u.m),u.m=null)}function yu(u){if(!Zv(u.h)&&!u.m){u.m=!0;var p=u.Ea;O||I(),F||(O(),F=!0),x.add(p,u),u.D=0}}function y1(u,p){return e_(u.h)>=u.h.j-(u.m?1:0)?!1:u.m?(u.i=p.G.concat(u.i),!0):u.I==1||u.I==2||u.D>=(u.Sa?0:u.Ta)?!1:(u.m=Nr(d(u.Ea,u,p),x_(u,u.D)),u.D++,!0)}t.Ea=function(u){if(this.m)if(this.m=null,this.I==1){if(!u){this.V=Math.floor(Math.random()*1e5),u=this.V++;const V=new ge(this,this.j,u);let $=this.o;if(this.U&&($?($=ke($),jt($,this.U)):$=this.U),this.u!==null||this.R||(V.J=$,$=null),this.S)e:{for(var p=0,g=0;g<this.i.length;g++){t:{var S=this.i[g];if("__data__"in S.map&&(S=S.map.__data__,typeof S=="string")){S=S.length;break t}S=void 0}if(S===void 0)break;if(p+=S,p>4096){p=g;break e}if(p===4096||g===this.i.length-1){p=g+1;break e}}p=1e3}else p=1e3;p=__(this,V,p),g=kr(this.J),at(g,"RID",u),at(g,"CVER",22),this.G&&at(g,"X-HTTP-Session-Id",this.G),hl(this,g),$&&(this.R?p="headers="+X(d_($))+"&"+p:this.u&&$f(g,this.u,$)),Mf(this.h,V),this.Ra&&at(g,"TYPE","init"),this.S?(at(g,"$req",p),at(g,"SID","null"),V.U=!0,Yn(V,g,null)):Yn(V,g,p),this.I=2}}else this.I==3&&(u?v_(this,u):this.i.length==0||Zv(this.h)||v_(this))};function v_(u,p){var g;p?g=p.l:g=u.V++;const S=kr(u.J);at(S,"SID",u.M),at(S,"RID",g),at(S,"AID",u.K),hl(u,S),u.u&&u.o&&$f(S,u.u,u.o),g=new ge(u,u.j,g,u.D+1),u.u===null&&(g.J=u.o),p&&(u.i=p.G.concat(u.i)),p=__(u,g,1e3),g.H=Math.round(u.va*.5)+Math.round(u.va*.5*Math.random()),Mf(u.h,g),Yn(g,S,p)}function hl(u,p){u.H&&he(u.H,function(g,S){at(p,S,g)}),u.l&&he({},function(g,S){at(p,S,g)})}function __(u,p,g){g=Math.min(u.i.length,g);const S=u.l?d(u.l.Ka,u.l,u):null;e:{var V=u.i;let Ne=-1;for(;;){const Ot=["count="+g];Ne==-1?g>0?(Ne=V[0].g,Ot.push("ofs="+Ne)):Ne=0:Ot.push("ofs="+Ne);let rt=!0;for(let qt=0;qt<g;qt++){var $=V[qt].g;const Dr=V[qt].map;if($-=Ne,$<0)Ne=Math.max(0,V[qt].g-100),rt=!1;else try{$="req"+$+"_"||"";try{var Z=Dr instanceof Map?Dr:Object.entries(Dr);for(const[Pi,As]of Z){let Rs=As;a(As)&&(Rs=Ie(As)),Ot.push($+Pi+"="+encodeURIComponent(Rs))}}catch(Pi){throw Ot.push($+"type="+encodeURIComponent("_badmap")),Pi}}catch{S&&S(Dr)}}if(rt){Z=Ot.join("&");break e}}Z=void 0}return u=u.i.splice(0,g),p.G=u,Z}function w_(u){if(!u.g&&!u.v){u.Y=1;var p=u.Da;O||I(),F||(O(),F=!0),x.add(p,u),u.A=0}}function zf(u){return u.g||u.v||u.A>=3?!1:(u.Y++,u.v=Nr(d(u.Da,u),x_(u,u.A)),u.A++,!0)}t.Da=function(){if(this.v=null,E_(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var u=4*this.T;this.j.info("BP detection timer enabled: "+u),this.B=Nr(d(this.Wa,this),u)}},t.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,Ke(10),gu(this),E_(this))};function qf(u){u.B!=null&&(o.clearTimeout(u.B),u.B=null)}function E_(u){u.g=new ge(u,u.j,"rpc",u.Y),u.u===null&&(u.g.J=u.o),u.g.P=0;var p=kr(u.na);at(p,"RID","rpc"),at(p,"SID",u.M),at(p,"AID",u.K),at(p,"CI",u.F?"0":"1"),!u.F&&u.ia&&at(p,"TO",u.ia),at(p,"TYPE","xmlhttp"),hl(u,p),u.u&&u.o&&$f(p,u.u,u.o),u.O&&(u.g.H=u.O);var g=u.g;u=u.ba,g.M=1,g.A=fu(kr(p)),g.u=null,g.R=!0,Rt(g,u)}t.Va=function(){this.C!=null&&(this.C=null,gu(this),zf(this),Ke(19))};function vu(u){u.C!=null&&(o.clearTimeout(u.C),u.C=null)}function I_(u,p){var g=null;if(u.g==p){vu(u),qf(u),u.g=null;var S=2}else if(Vf(u.h,p))g=p.G,t_(u.h,p),S=1;else return;if(u.I!=0){if(p.o)if(S==1){g=p.u?p.u.length:0,p=Date.now()-p.F;var V=u.D;S=en(),re(S,new At(S,g)),yu(u)}else w_(u);else if(V=p.m,V==3||V==0&&p.X>0||!(S==1&&y1(u,p)||S==2&&zf(u)))switch(g&&g.length>0&&(p=u.h,p.i=p.i.concat(g)),V){case 1:Ni(u,5);break;case 4:Ni(u,10);break;case 3:Ni(u,6);break;default:Ni(u,2)}}}function x_(u,p){let g=u.Qa+Math.floor(Math.random()*u.Za);return u.isActive()||(g*=2),g*p}function Ni(u,p){if(u.j.info("Error code "+p),p==2){var g=d(u.bb,u),S=u.Ua;const V=!S;S=new bs(S||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||sl(S,"https"),fu(S),V?d1(S.toString(),g):h1(S.toString(),g)}else Ke(2);u.I=0,u.l&&u.l.pa(p),T_(u),y_(u)}t.bb=function(u){u?(this.j.info("Successfully pinged google.com"),Ke(2)):(this.j.info("Failed to ping google.com"),Ke(1))};function T_(u){if(u.I=0,u.ja=[],u.l){const p=n_(u.h);(p.length!=0||u.i.length!=0)&&(R(u.ja,p),R(u.ja,u.i),u.h.i.length=0,_(u.i),u.i.length=0),u.l.oa()}}function b_(u,p,g){var S=g instanceof bs?kr(g):new bs(g);if(S.g!="")p&&(S.g=p+"."+S.g),il(S,S.u);else{var V=o.location;S=V.protocol,p=p?p+"."+V.hostname:V.hostname,V=+V.port;const $=new bs(null);S&&sl($,S),p&&($.g=p),V&&il($,V),g&&($.h=g),S=$}return g=u.G,p=u.wa,g&&p&&at(S,g,p),at(S,"VER",u.ka),hl(u,S),S}function S_(u,p,g){if(p&&!u.L)throw Error("Can't create secondary domain capable XhrIo object.");return p=u.Aa&&!u.ma?new _t(new Uf({ab:g})):new _t(u.ma),p.Fa(u.L),p}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function C_(){}t=C_.prototype,t.ra=function(){},t.qa=function(){},t.pa=function(){},t.oa=function(){},t.isActive=function(){return!0},t.Ka=function(){};function _u(){}_u.prototype.g=function(u,p){return new Ln(u,p)};function Ln(u,p){B.call(this),this.g=new g_(p),this.l=u,this.h=p&&p.messageUrlParams||null,u=p&&p.messageHeaders||null,p&&p.clientProtocolHeaderRequired&&(u?u["X-Client-Protocol"]="webchannel":u={"X-Client-Protocol":"webchannel"}),this.g.o=u,u=p&&p.initMessageHeaders||null,p&&p.messageContentType&&(u?u["X-WebChannel-Content-Type"]=p.messageContentType:u={"X-WebChannel-Content-Type":p.messageContentType}),p&&p.sa&&(u?u["X-WebChannel-Client-Profile"]=p.sa:u={"X-WebChannel-Client-Profile":p.sa}),this.g.U=u,(u=p&&p.Qb)&&!k(u)&&(this.g.u=u),this.A=p&&p.supportsCrossDomainXhr||!1,this.v=p&&p.sendRawJson||!1,(p=p&&p.httpSessionIdParam)&&!k(p)&&(this.g.G=p,u=this.h,u!==null&&p in u&&(u=this.h,p in u&&delete u[p])),this.j=new Po(this)}f(Ln,B),Ln.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},Ln.prototype.close=function(){Bf(this.g)},Ln.prototype.o=function(u){var p=this.g;if(typeof u=="string"){var g={};g.__data__=u,u=g}else this.v&&(g={},g.__data__=Ie(u),u=g);p.i.push(new r1(p.Ya++,u)),p.I==3&&yu(p)},Ln.prototype.N=function(){this.g.l=null,delete this.j,Bf(this.g),delete this.g,Ln.Z.N.call(this)};function A_(u){St.call(this),u.__headers__&&(this.headers=u.__headers__,this.statusCode=u.__status__,delete u.__headers__,delete u.__status__);var p=u.__sm__;if(p){e:{for(const g in p){u=g;break e}u=void 0}(this.i=u)&&(u=this.i,p=p!==null&&u in p?p[u]:void 0),this.data=p}else this.data=u}f(A_,St);function R_(){Rr.call(this),this.status=1}f(R_,Rr);function Po(u){this.g=u}f(Po,C_),Po.prototype.ra=function(){re(this.g,"a")},Po.prototype.qa=function(u){re(this.g,new A_(u))},Po.prototype.pa=function(u){re(this.g,new R_)},Po.prototype.oa=function(){re(this.g,"b")},_u.prototype.createWebChannel=_u.prototype.g,Ln.prototype.send=Ln.prototype.o,Ln.prototype.open=Ln.prototype.m,Ln.prototype.close=Ln.prototype.close,lS=function(){return new _u},aS=function(){return en()},oS=xn,Xm={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},Ci.NO_ERROR=0,Ci.TIMEOUT=8,Ci.HTTP_ERROR=6,md=Ci,rl.COMPLETE="complete",iS=rl,Ce.EventType=nt,nt.OPEN="a",nt.CLOSE="b",nt.ERROR="c",nt.MESSAGE="d",B.prototype.listen=B.prototype.J,Vl=Ce,_t.prototype.listenOnce=_t.prototype.K,_t.prototype.getLastError=_t.prototype.Ha,_t.prototype.getLastErrorCode=_t.prototype.ya,_t.prototype.getStatus=_t.prototype.ca,_t.prototype.getResponseJson=_t.prototype.La,_t.prototype.getResponseText=_t.prototype.la,_t.prototype.send=_t.prototype.ea,_t.prototype.setWithCredentials=_t.prototype.Fa,sS=_t}).apply(typeof Uu<"u"?Uu:typeof self<"u"?self:typeof window<"u"?window:{});const TE="@firebase/firestore",bE="4.9.2";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yt{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Yt.UNAUTHENTICATED=new Yt(null),Yt.GOOGLE_CREDENTIALS=new Yt("google-credentials-uid"),Yt.FIRST_PARTY=new Yt("first-party-uid"),Yt.MOCK_USER=new Yt("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ja="12.3.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lo=new Kh("@firebase/firestore");function Wo(){return lo.logLevel}function W(t,...e){if(lo.logLevel<=Fe.DEBUG){const n=e.map(Uy);lo.debug(`Firestore (${Ja}): ${t}`,...n)}}function mn(t,...e){if(lo.logLevel<=Fe.ERROR){const n=e.map(Uy);lo.error(`Firestore (${Ja}): ${t}`,...n)}}function co(t,...e){if(lo.logLevel<=Fe.WARN){const n=e.map(Uy);lo.warn(`Firestore (${Ja}): ${t}`,...n)}}function Uy(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ae(t,e,n){let r="Unexpected state";typeof e=="string"?r=e:n=e,cS(t,r,n)}function cS(t,e,n){let r=`FIRESTORE (${Ja}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(n!==void 0)try{r+=" CONTEXT: "+JSON.stringify(n)}catch{r+=" CONTEXT: "+n}throw mn(r),new Error(r)}function fe(t,e,n,r){let s="Unexpected state";typeof n=="string"?s=n:r=n,t||cS(e,s,r)}function Ee(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const z={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Q extends ur{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Er{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uS{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class aO{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(Yt.UNAUTHENTICATED))}shutdown(){}}class lO{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class cO{constructor(e){this.t=e,this.currentUser=Yt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){fe(this.o===void 0,42304);let r=this.i;const s=c=>this.i!==r?(r=this.i,n(c)):Promise.resolve();let i=new Er;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new Er,e.enqueueRetryable(()=>s(this.currentUser))};const o=()=>{const c=i;e.enqueueRetryable(async()=>{await c.promise,await s(this.currentUser)})},a=c=>{W("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(c=>a(c)),setTimeout(()=>{if(!this.auth){const c=this.t.getImmediate({optional:!0});c?a(c):(W("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new Er)}},0),o()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(W("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(fe(typeof r.accessToken=="string",31837,{l:r}),new uS(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return fe(e===null||typeof e=="string",2055,{h:e}),new Yt(e)}}class uO{constructor(e,n,r){this.P=e,this.T=n,this.I=r,this.type="FirstParty",this.user=Yt.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class dO{constructor(e,n,r){this.P=e,this.T=n,this.I=r}getToken(){return Promise.resolve(new uO(this.P,this.T,this.I))}start(e,n){e.enqueueRetryable(()=>n(Yt.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class SE{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class hO{constructor(e,n){this.V=n,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,er(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,n){fe(this.o===void 0,3512);const r=i=>{i.error!=null&&W("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.m;return this.m=i.token,W("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>r(i))};const s=i=>{W("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(i=>s(i)),setTimeout(()=>{if(!this.appCheck){const i=this.V.getImmediate({optional:!0});i?s(i):W("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new SE(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(fe(typeof n.token=="string",44558,{tokenResult:n}),this.m=n.token,new SE(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fO(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $y{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const s=fO(40);for(let i=0;i<s.length;++i)r.length<20&&s[i]<n&&(r+=e.charAt(s[i]%62))}return r}}function xe(t,e){return t<e?-1:t>e?1:0}function Jm(t,e){const n=Math.min(t.length,e.length);for(let r=0;r<n;r++){const s=t.charAt(r),i=e.charAt(r);if(s!==i)return Cp(s)===Cp(i)?xe(s,i):Cp(s)?1:-1}return xe(t.length,e.length)}const pO=55296,mO=57343;function Cp(t){const e=t.charCodeAt(0);return e>=pO&&e<=mO}function Na(t,e,n){return t.length===e.length&&t.every((r,s)=>n(r,e[s]))}function dS(t){return t+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CE="__name__";class Mr{constructor(e,n,r){n===void 0?n=0:n>e.length&&ae(637,{offset:n,range:e.length}),r===void 0?r=e.length-n:r>e.length-n&&ae(1746,{length:r,range:e.length-n}),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return Mr.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof Mr?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let s=0;s<r;s++){const i=Mr.compareSegments(e.get(s),n.get(s));if(i!==0)return i}return xe(e.length,n.length)}static compareSegments(e,n){const r=Mr.isNumericId(e),s=Mr.isNumericId(n);return r&&!s?-1:!r&&s?1:r&&s?Mr.extractNumericId(e).compare(Mr.extractNumericId(n)):Jm(e,n)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return ai.fromString(e.substring(4,e.length-2))}}class He extends Mr{construct(e,n,r){return new He(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new Q(z.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(s=>s.length>0))}return new He(n)}static emptyPath(){return new He([])}}const gO=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class gt extends Mr{construct(e,n,r){return new gt(e,n,r)}static isValidIdentifier(e){return gO.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),gt.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===CE}static keyField(){return new gt([CE])}static fromServerFormat(e){const n=[];let r="",s=0;const i=()=>{if(r.length===0)throw new Q(z.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let o=!1;for(;s<e.length;){const a=e[s];if(a==="\\"){if(s+1===e.length)throw new Q(z.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const c=e[s+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new Q(z.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=c,s+=2}else a==="`"?(o=!o,s++):a!=="."||o?(r+=a,s++):(i(),s++)}if(i(),o)throw new Q(z.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new gt(n)}static emptyPath(){return new gt([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class te{constructor(e){this.path=e}static fromPath(e){return new te(He.fromString(e))}static fromName(e){return new te(He.fromString(e).popFirst(5))}static empty(){return new te(He.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&He.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return He.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new te(new He(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hS(t,e,n){if(!n)throw new Q(z.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function yO(t,e,n,r){if(e===!0&&r===!0)throw new Q(z.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function AE(t){if(!te.isDocumentKey(t))throw new Q(z.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function RE(t){if(te.isDocumentKey(t))throw new Q(z.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function fS(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function ef(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":ae(12329,{type:typeof t})}function cn(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new Q(z.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=ef(t);throw new Q(z.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}function vO(t,e){if(e<=0)throw new Q(z.INVALID_ARGUMENT,`Function ${t}() requires a positive number, but it was: ${e}.`)}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kt(t,e){const n={typeString:t};return e&&(n.value=e),n}function Jc(t,e){if(!fS(t))throw new Q(z.INVALID_ARGUMENT,"JSON must be an object");let n;for(const r in e)if(e[r]){const s=e[r].typeString,i="value"in e[r]?{value:e[r].value}:void 0;if(!(r in t)){n=`JSON missing required field: '${r}'`;break}const o=t[r];if(s&&typeof o!==s){n=`JSON field '${r}' must be a ${s}.`;break}if(i!==void 0&&o!==i.value){n=`Expected '${r}' field to equal '${i.value}'`;break}}if(n)throw new Q(z.INVALID_ARGUMENT,n);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NE=-62135596800,PE=1e6;class ze{static now(){return ze.fromMillis(Date.now())}static fromDate(e){return ze.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor((e-1e3*n)*PE);return new ze(n,r)}constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new Q(z.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new Q(z.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<NE)throw new Q(z.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Q(z.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/PE}_compareTo(e){return this.seconds===e.seconds?xe(this.nanoseconds,e.nanoseconds):xe(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:ze._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Jc(e,ze._jsonSchema))return new ze(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-NE;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}ze._jsonSchemaVersion="firestore/timestamp/1.0",ze._jsonSchema={type:kt("string",ze._jsonSchemaVersion),seconds:kt("number"),nanoseconds:kt("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pe{static fromTimestamp(e){return new pe(e)}static min(){return new pe(new ze(0,0))}static max(){return new pe(new ze(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nc=-1;class ah{constructor(e,n,r,s){this.indexId=e,this.collectionGroup=n,this.fields=r,this.indexState=s}}function Zm(t){return t.fields.find(e=>e.kind===2)}function Li(t){return t.fields.filter(e=>e.kind!==2)}ah.UNKNOWN_ID=-1;class gd{constructor(e,n){this.fieldPath=e,this.kind=n}}class Pc{constructor(e,n){this.sequenceNumber=e,this.offset=n}static empty(){return new Pc(0,Wn.min())}}function _O(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,s=pe.fromTimestamp(r===1e9?new ze(n+1,0):new ze(n,r));return new Wn(s,te.empty(),e)}function pS(t){return new Wn(t.readTime,t.key,Nc)}class Wn{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new Wn(pe.min(),te.empty(),Nc)}static max(){return new Wn(pe.max(),te.empty(),Nc)}}function By(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=te.comparator(t.documentKey,e.documentKey),n!==0?n:xe(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mS="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class gS{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Co(t){if(t.code!==z.FAILED_PRECONDITION||t.message!==mS)throw t;W("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&ae(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new L((r,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(r,s)},this.catchCallback=i=>{this.wrapFailure(n,i).next(r,s)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof L?n:L.resolve(n)}catch(n){return L.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):L.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):L.reject(n)}static resolve(e){return new L((n,r)=>{n(e)})}static reject(e){return new L((n,r)=>{r(e)})}static waitFor(e){return new L((n,r)=>{let s=0,i=0,o=!1;e.forEach(a=>{++s,a.next(()=>{++i,o&&i===s&&n()},c=>r(c))}),o=!0,i===s&&n()})}static or(e){let n=L.resolve(!1);for(const r of e)n=n.next(s=>s?L.resolve(s):r());return n}static forEach(e,n){const r=[];return e.forEach((s,i)=>{r.push(n.call(this,s,i))}),this.waitFor(r)}static mapArray(e,n){return new L((r,s)=>{const i=e.length,o=new Array(i);let a=0;for(let c=0;c<i;c++){const d=c;n(e[d]).next(h=>{o[d]=h,++a,a===i&&r(o)},h=>s(h))}})}static doWhile(e,n){return new L((r,s)=>{const i=()=>{e()===!0?n().next(()=>{i()},s):r()};i()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fn="SimpleDb";class tf{static open(e,n,r,s){try{return new tf(n,e.transaction(s,r))}catch(i){throw new tc(n,i)}}constructor(e,n){this.action=e,this.transaction=n,this.aborted=!1,this.S=new Er,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{n.error?this.S.reject(new tc(e,n.error)):this.S.resolve()},this.transaction.onerror=r=>{const s=zy(r.target.error);this.S.reject(new tc(e,s))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(W(Fn,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}C(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const n=this.transaction.objectStore(e);return new EO(n)}}class li{static delete(e){return W(Fn,"Removing database:",e),Mi(o0().indexedDB.deleteDatabase(e)).toPromise()}static v(){if(!Ay())return!1;if(li.F())return!0;const e=Ft(),n=li.M(e),r=0<n&&n<10,s=yS(e),i=0<s&&s<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||i)}static F(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)==null?void 0:e.__PRIVATE_USE_MOCK_PERSISTENCE)==="YES"}static O(e,n){return e.store(n)}static M(e){const n=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=n?n[1].split("_").slice(0,2).join("."):"-1";return Number(r)}constructor(e,n,r){this.name=e,this.version=n,this.N=r,this.B=null,li.M(Ft())===12.2&&mn("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async L(e){return this.db||(W(Fn,"Opening database:",this.name),this.db=await new Promise((n,r)=>{const s=indexedDB.open(this.name,this.version);s.onsuccess=i=>{const o=i.target.result;n(o)},s.onblocked=()=>{r(new tc(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},s.onerror=i=>{const o=i.target.error;o.name==="VersionError"?r(new Q(z.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?r(new Q(z.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):r(new tc(e,o))},s.onupgradeneeded=i=>{W(Fn,'Database "'+this.name+'" requires upgrade from version:',i.oldVersion);const o=i.target.result;this.N.k(o,s.transaction,i.oldVersion,this.version).next(()=>{W(Fn,"Database upgrade to version "+this.version+" complete")})}})),this.q&&(this.db.onversionchange=n=>this.q(n)),this.db}$(e){this.q=e,this.db&&(this.db.onversionchange=n=>e(n))}async runTransaction(e,n,r,s){const i=n==="readonly";let o=0;for(;;){++o;try{this.db=await this.L(e);const a=tf.open(this.db,e,i?"readonly":"readwrite",r),c=s(a).next(d=>(a.C(),d)).catch(d=>(a.abort(d),L.reject(d))).toPromise();return c.catch(()=>{}),await a.D,c}catch(a){const c=a,d=c.name!=="FirebaseError"&&o<3;if(W(Fn,"Transaction failed with error:",c.message,"Retrying:",d),this.close(),!d)return Promise.reject(c)}}}close(){this.db&&this.db.close(),this.db=void 0}}function yS(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}class wO{constructor(e){this.U=e,this.K=!1,this.W=null}get isDone(){return this.K}get G(){return this.W}set cursor(e){this.U=e}done(){this.K=!0}j(e){this.W=e}delete(){return Mi(this.U.delete())}}class tc extends Q{constructor(e,n){super(z.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${n}`),this.name="IndexedDbTransactionError"}}function Ti(t){return t.name==="IndexedDbTransactionError"}class EO{constructor(e){this.store=e}put(e,n){let r;return n!==void 0?(W(Fn,"PUT",this.store.name,e,n),r=this.store.put(n,e)):(W(Fn,"PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),Mi(r)}add(e){return W(Fn,"ADD",this.store.name,e,e),Mi(this.store.add(e))}get(e){return Mi(this.store.get(e)).next(n=>(n===void 0&&(n=null),W(Fn,"GET",this.store.name,e,n),n))}delete(e){return W(Fn,"DELETE",this.store.name,e),Mi(this.store.delete(e))}count(){return W(Fn,"COUNT",this.store.name),Mi(this.store.count())}J(e,n){const r=this.options(e,n),s=r.index?this.store.index(r.index):this.store;if(typeof s.getAll=="function"){const i=s.getAll(r.range);return new L((o,a)=>{i.onerror=c=>{a(c.target.error)},i.onsuccess=c=>{o(c.target.result)}})}{const i=this.cursor(r),o=[];return this.H(i,(a,c)=>{o.push(c)}).next(()=>o)}}Y(e,n){const r=this.store.getAll(e,n===null?void 0:n);return new L((s,i)=>{r.onerror=o=>{i(o.target.error)},r.onsuccess=o=>{s(o.target.result)}})}Z(e,n){W(Fn,"DELETE ALL",this.store.name);const r=this.options(e,n);r.X=!1;const s=this.cursor(r);return this.H(s,(i,o,a)=>a.delete())}ee(e,n){let r;n?r=e:(r={},n=e);const s=this.cursor(r);return this.H(s,n)}te(e){const n=this.cursor({});return new L((r,s)=>{n.onerror=i=>{const o=zy(i.target.error);s(o)},n.onsuccess=i=>{const o=i.target.result;o?e(o.primaryKey,o.value).next(a=>{a?o.continue():r()}):r()}})}H(e,n){const r=[];return new L((s,i)=>{e.onerror=o=>{i(o.target.error)},e.onsuccess=o=>{const a=o.target.result;if(!a)return void s();const c=new wO(a),d=n(a.primaryKey,a.value,c);if(d instanceof L){const h=d.catch(f=>(c.done(),L.reject(f)));r.push(h)}c.isDone?s():c.G===null?a.continue():a.continue(c.G)}}).next(()=>L.waitFor(r))}options(e,n){let r;return e!==void 0&&(typeof e=="string"?r=e:n=e),{index:r,range:n}}cursor(e){let n="next";if(e.reverse&&(n="prev"),e.index){const r=this.store.index(e.index);return e.X?r.openKeyCursor(e.range,n):r.openCursor(e.range,n)}return this.store.openCursor(e.range,n)}}function Mi(t){return new L((e,n)=>{t.onsuccess=r=>{const s=r.target.result;e(s)},t.onerror=r=>{const s=zy(r.target.error);n(s)}})}let kE=!1;function zy(t){const e=li.M(Ft());if(e>=12.2&&e<13){const n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){const r=new Q("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${n}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return kE||(kE=!0,setTimeout(()=>{throw r},0)),r}}return t}const nc="IndexBackfiller";class IO{constructor(e,n){this.asyncQueue=e,this.ne=n,this.task=null}start(){this.re(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}re(e){W(nc,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{const n=await this.ne.ie();W(nc,`Documents written: ${n}`)}catch(n){Ti(n)?W(nc,"Ignoring IndexedDB error during index backfill: ",n):await Co(n)}await this.re(6e4)})}}class xO{constructor(e,n){this.localStore=e,this.persistence=n}async ie(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",n=>this.se(n,e))}se(e,n){const r=new Set;let s=n,i=!0;return L.doWhile(()=>i===!0&&s>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(o!==null&&!r.has(o))return W(nc,`Processing collection: ${o}`),this.oe(e,o,s).next(a=>{s-=a,r.add(o)});i=!1})).next(()=>n-s)}oe(e,n,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,n).next(s=>this.localStore.localDocuments.getNextDocuments(e,n,s,r).next(i=>{const o=i.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this._e(s,i)).next(a=>(W(nc,`Updating offset: ${a}`),this.localStore.indexManager.updateCollectionGroup(e,n,a))).next(()=>o.size)}))}_e(e,n){let r=e;return n.changes.forEach((s,i)=>{const o=pS(i);By(o,r)>0&&(r=o)}),new Wn(r.readTime,r.documentKey,Math.max(n.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rr{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ae(r),this.ue=r=>n.writeSequenceNumber(r))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}rr.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yi=-1;function nf(t){return t==null}function kc(t){return t===0&&1/t==-1/0}function TO(t){return typeof t=="number"&&Number.isInteger(t)&&!kc(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lh="";function un(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=DE(e)),e=bO(t.get(n),e);return DE(e)}function bO(t,e){let n=e;const r=t.length;for(let s=0;s<r;s++){const i=t.charAt(s);switch(i){case"\0":n+="";break;case lh:n+="";break;default:n+=i}}return n}function DE(t){return t+lh+""}function Ur(t){const e=t.length;if(fe(e>=2,64408,{path:t}),e===2)return fe(t.charAt(0)===lh&&t.charAt(1)==="",56145,{path:t}),He.emptyPath();const n=e-2,r=[];let s="";for(let i=0;i<e;){const o=t.indexOf(lh,i);switch((o<0||o>n)&&ae(50515,{path:t}),t.charAt(o+1)){case"":const a=t.substring(i,o);let c;s.length===0?c=a:(s+=a,c=s,s=""),r.push(c);break;case"":s+=t.substring(i,o),s+="\0";break;case"":s+=t.substring(i,o+1);break;default:ae(61167,{path:t})}i=o+2}return new He(r)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vi="remoteDocuments",Zc="owner",Do="owner",Dc="mutationQueues",SO="userId",gr="mutations",jE="batchId",Wi="userMutationsIndex",OE=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yd(t,e){return[t,un(e)]}function vS(t,e,n){return[t,un(e),n]}const CO={},Pa="documentMutations",ch="remoteDocumentsV14",AO=["prefixPath","collectionGroup","readTime","documentId"],vd="documentKeyIndex",RO=["prefixPath","collectionGroup","documentId"],_S="collectionGroupIndex",NO=["collectionGroup","readTime","prefixPath","documentId"],jc="remoteDocumentGlobal",eg="remoteDocumentGlobalKey",ka="targets",wS="queryTargetsIndex",PO=["canonicalId","targetId"],Da="targetDocuments",kO=["targetId","path"],qy="documentTargetsIndex",DO=["path","targetId"],uh="targetGlobalKey",Xi="targetGlobal",Oc="collectionParents",jO=["collectionId","parent"],ja="clientMetadata",OO="clientId",rf="bundles",LO="bundleId",sf="namedQueries",VO="name",Hy="indexConfiguration",MO="indexId",tg="collectionGroupIndex",FO="collectionGroup",rc="indexState",UO=["indexId","uid"],ES="sequenceNumberIndex",$O=["uid","sequenceNumber"],sc="indexEntries",BO=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],IS="documentKeyIndex",zO=["indexId","uid","orderedDocumentKey"],of="documentOverlays",qO=["userId","collectionPath","documentId"],ng="collectionPathOverlayIndex",HO=["userId","collectionPath","largestBatchId"],xS="collectionGroupOverlayIndex",WO=["userId","collectionGroup","largestBatchId"],Wy="globals",GO="name",TS=[Dc,gr,Pa,Vi,ka,Zc,Xi,Da,ja,jc,Oc,rf,sf],KO=[...TS,of],bS=[Dc,gr,Pa,ch,ka,Zc,Xi,Da,ja,jc,Oc,rf,sf,of],SS=bS,Gy=[...SS,Hy,rc,sc],QO=Gy,CS=[...Gy,Wy],YO=CS;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rg extends gS{constructor(e,n){super(),this.le=e,this.currentSequenceNumber=n}}function Ut(t,e){const n=Ee(t);return li.O(n.le,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function LE(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function bi(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function XO(t,e){const n=[];for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&n.push(e(t[r],r,t));return n}function AS(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ft{constructor(e,n){this.comparator=e,this.root=n||Xt.EMPTY}insert(e,n){return new ft(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,Xt.BLACK,null,null))}remove(e){return new ft(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Xt.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(e,r.key);if(s===0)return n+r.left.size;s<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new $u(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new $u(this.root,e,this.comparator,!1)}getReverseIterator(){return new $u(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new $u(this.root,e,this.comparator,!0)}}class $u{constructor(e,n,r,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=n?r(e.key,n):1,n&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Xt{constructor(e,n,r,s,i){this.key=e,this.value=n,this.color=r??Xt.RED,this.left=s??Xt.EMPTY,this.right=i??Xt.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,s,i){return new Xt(e??this.key,n??this.value,r??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let s=this;const i=r(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,n,r),null):i===0?s.copy(null,n,null,null,null):s.copy(null,null,null,null,s.right.insert(e,n,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return Xt.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,s=this;if(n(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,n),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),n(e,s.key)===0){if(s.right.isEmpty())return Xt.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,n))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Xt.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Xt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw ae(43730,{key:this.key,value:this.value});if(this.right.isRed())throw ae(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw ae(27949);return e+(this.isRed()?0:1)}}Xt.EMPTY=null,Xt.RED=!0,Xt.BLACK=!1;Xt.EMPTY=new class{constructor(){this.size=0}get key(){throw ae(57766)}get value(){throw ae(16141)}get color(){throw ae(16727)}get left(){throw ae(29726)}get right(){throw ae(36894)}copy(e,n,r,s,i){return this}insert(e,n,r){return new Xt(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class et{constructor(e){this.comparator=e,this.data=new ft(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,e[1])>=0)return;n(s.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new VE(this.data.getIterator())}getIteratorFrom(e){return new VE(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof et)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new et(this.comparator);return n.data=e,n}}class VE{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function jo(t){return t.hasNext()?t.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class An{constructor(e){this.fields=e,e.sort(gt.comparator)}static empty(){return new An([])}unionWith(e){let n=new et(gt.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new An(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return Na(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RS extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dt{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(s){try{return atob(s)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new RS("Invalid base64 string: "+i):i}}(e);return new Dt(n)}static fromUint8Array(e){const n=function(s){let i="";for(let o=0;o<s.length;++o)i+=String.fromCharCode(s[o]);return i}(e);return new Dt(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return xe(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Dt.EMPTY_BYTE_STRING=new Dt("");const JO=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function vs(t){if(fe(!!t,39018),typeof t=="string"){let e=0;const n=JO.exec(t);if(fe(!!n,46558,{timestamp:t}),n[1]){let s=n[1];s=(s+"000000000").substr(0,9),e=Number(s)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:ut(t.seconds),nanos:ut(t.nanos)}}function ut(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function _s(t){return typeof t=="string"?Dt.fromBase64String(t):Dt.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NS="server_timestamp",PS="__type__",kS="__previous_value__",DS="__local_write_time__";function af(t){var n,r;return((r=(((n=t==null?void 0:t.mapValue)==null?void 0:n.fields)||{})[PS])==null?void 0:r.stringValue)===NS}function lf(t){const e=t.mapValue.fields[kS];return af(e)?lf(e):e}function Lc(t){const e=vs(t.mapValue.fields[DS].timestampValue);return new ze(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZO{constructor(e,n,r,s,i,o,a,c,d,h){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=s,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=c,this.useFetchStreams=d,this.isUsingEmulator=h}}const dh="(default)";class uo{constructor(e,n){this.projectId=e,this.database=n||dh}static empty(){return new uo("","")}get isDefaultDatabase(){return this.database===dh}isEqual(e){return e instanceof uo&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ky="__type__",jS="__max__",Qs={mapValue:{fields:{__type__:{stringValue:jS}}}},Qy="__vector__",Oa="value",_d={nullValue:"NULL_VALUE"};function fi(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?af(t)?4:OS(t)?9007199254740991:cf(t)?10:11:ae(28295,{value:t})}function Yr(t,e){if(t===e)return!0;const n=fi(t);if(n!==fi(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Lc(t).isEqual(Lc(e));case 3:return function(s,i){if(typeof s.timestampValue=="string"&&typeof i.timestampValue=="string"&&s.timestampValue.length===i.timestampValue.length)return s.timestampValue===i.timestampValue;const o=vs(s.timestampValue),a=vs(i.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(s,i){return _s(s.bytesValue).isEqual(_s(i.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(s,i){return ut(s.geoPointValue.latitude)===ut(i.geoPointValue.latitude)&&ut(s.geoPointValue.longitude)===ut(i.geoPointValue.longitude)}(t,e);case 2:return function(s,i){if("integerValue"in s&&"integerValue"in i)return ut(s.integerValue)===ut(i.integerValue);if("doubleValue"in s&&"doubleValue"in i){const o=ut(s.doubleValue),a=ut(i.doubleValue);return o===a?kc(o)===kc(a):isNaN(o)&&isNaN(a)}return!1}(t,e);case 9:return Na(t.arrayValue.values||[],e.arrayValue.values||[],Yr);case 10:case 11:return function(s,i){const o=s.mapValue.fields||{},a=i.mapValue.fields||{};if(LE(o)!==LE(a))return!1;for(const c in o)if(o.hasOwnProperty(c)&&(a[c]===void 0||!Yr(o[c],a[c])))return!1;return!0}(t,e);default:return ae(52216,{left:t})}}function Vc(t,e){return(t.values||[]).find(n=>Yr(n,e))!==void 0}function pi(t,e){if(t===e)return 0;const n=fi(t),r=fi(e);if(n!==r)return xe(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return xe(t.booleanValue,e.booleanValue);case 2:return function(i,o){const a=ut(i.integerValue||i.doubleValue),c=ut(o.integerValue||o.doubleValue);return a<c?-1:a>c?1:a===c?0:isNaN(a)?isNaN(c)?0:-1:1}(t,e);case 3:return ME(t.timestampValue,e.timestampValue);case 4:return ME(Lc(t),Lc(e));case 5:return Jm(t.stringValue,e.stringValue);case 6:return function(i,o){const a=_s(i),c=_s(o);return a.compareTo(c)}(t.bytesValue,e.bytesValue);case 7:return function(i,o){const a=i.split("/"),c=o.split("/");for(let d=0;d<a.length&&d<c.length;d++){const h=xe(a[d],c[d]);if(h!==0)return h}return xe(a.length,c.length)}(t.referenceValue,e.referenceValue);case 8:return function(i,o){const a=xe(ut(i.latitude),ut(o.latitude));return a!==0?a:xe(ut(i.longitude),ut(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return FE(t.arrayValue,e.arrayValue);case 10:return function(i,o){var m,_,R,C;const a=i.fields||{},c=o.fields||{},d=(m=a[Oa])==null?void 0:m.arrayValue,h=(_=c[Oa])==null?void 0:_.arrayValue,f=xe(((R=d==null?void 0:d.values)==null?void 0:R.length)||0,((C=h==null?void 0:h.values)==null?void 0:C.length)||0);return f!==0?f:FE(d,h)}(t.mapValue,e.mapValue);case 11:return function(i,o){if(i===Qs.mapValue&&o===Qs.mapValue)return 0;if(i===Qs.mapValue)return 1;if(o===Qs.mapValue)return-1;const a=i.fields||{},c=Object.keys(a),d=o.fields||{},h=Object.keys(d);c.sort(),h.sort();for(let f=0;f<c.length&&f<h.length;++f){const m=Jm(c[f],h[f]);if(m!==0)return m;const _=pi(a[c[f]],d[h[f]]);if(_!==0)return _}return xe(c.length,h.length)}(t.mapValue,e.mapValue);default:throw ae(23264,{he:n})}}function ME(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return xe(t,e);const n=vs(t),r=vs(e),s=xe(n.seconds,r.seconds);return s!==0?s:xe(n.nanos,r.nanos)}function FE(t,e){const n=t.values||[],r=e.values||[];for(let s=0;s<n.length&&s<r.length;++s){const i=pi(n[s],r[s]);if(i)return i}return xe(n.length,r.length)}function La(t){return sg(t)}function sg(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=vs(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return _s(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return te.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",s=!0;for(const i of n.values||[])s?s=!1:r+=",",r+=sg(i);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let s="{",i=!0;for(const o of r)i?i=!1:s+=",",s+=`${o}:${sg(n.fields[o])}`;return s+"}"}(t.mapValue):ae(61005,{value:t})}function wd(t){switch(fi(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=lf(t);return e?16+wd(e):16;case 5:return 2*t.stringValue.length;case 6:return _s(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return function(r){return(r.values||[]).reduce((s,i)=>s+wd(i),0)}(t.arrayValue);case 10:case 11:return function(r){let s=0;return bi(r.fields,(i,o)=>{s+=i.length+wd(o)}),s}(t.mapValue);default:throw ae(13486,{value:t})}}function ho(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function ig(t){return!!t&&"integerValue"in t}function Mc(t){return!!t&&"arrayValue"in t}function UE(t){return!!t&&"nullValue"in t}function $E(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Ed(t){return!!t&&"mapValue"in t}function cf(t){var n,r;return((r=(((n=t==null?void 0:t.mapValue)==null?void 0:n.fields)||{})[Ky])==null?void 0:r.stringValue)===Qy}function ic(t){if(t.geoPointValue)return{geoPointValue:{...t.geoPointValue}};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:{...t.timestampValue}};if(t.mapValue){const e={mapValue:{fields:{}}};return bi(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=ic(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=ic(t.arrayValue.values[n]);return e}return{...t}}function OS(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===jS}const LS={mapValue:{fields:{[Ky]:{stringValue:Qy},[Oa]:{arrayValue:{}}}}};function eL(t){return"nullValue"in t?_d:"booleanValue"in t?{booleanValue:!1}:"integerValue"in t||"doubleValue"in t?{doubleValue:NaN}:"timestampValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in t?{stringValue:""}:"bytesValue"in t?{bytesValue:""}:"referenceValue"in t?ho(uo.empty(),te.empty()):"geoPointValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in t?{arrayValue:{}}:"mapValue"in t?cf(t)?LS:{mapValue:{}}:ae(35942,{value:t})}function tL(t){return"nullValue"in t?{booleanValue:!1}:"booleanValue"in t?{doubleValue:NaN}:"integerValue"in t||"doubleValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in t?{stringValue:""}:"stringValue"in t?{bytesValue:""}:"bytesValue"in t?ho(uo.empty(),te.empty()):"referenceValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in t?{arrayValue:{}}:"arrayValue"in t?LS:"mapValue"in t?cf(t)?{mapValue:{}}:Qs:ae(61959,{value:t})}function BE(t,e){const n=pi(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?-1:!t.inclusive&&e.inclusive?1:0}function zE(t,e){const n=pi(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?1:!t.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class an{constructor(e){this.value=e}static empty(){return new an({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!Ed(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=ic(n)}setAll(e){let n=gt.emptyPath(),r={},s=[];e.forEach((o,a)=>{if(!n.isImmediateParentOf(a)){const c=this.getFieldsMap(n);this.applyChanges(c,r,s),r={},s=[],n=a.popLast()}o?r[a.lastSegment()]=ic(o):s.push(a.lastSegment())});const i=this.getFieldsMap(n);this.applyChanges(i,r,s)}delete(e){const n=this.field(e.popLast());Ed(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return Yr(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let s=n.mapValue.fields[e.get(r)];Ed(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=s),n=s}return n.mapValue.fields}applyChanges(e,n,r){bi(n,(s,i)=>e[s]=i);for(const s of r)delete e[s]}clone(){return new an(ic(this.value))}}function VS(t){const e=[];return bi(t.fields,(n,r)=>{const s=new gt([n]);if(Ed(r)){const i=VS(r.mapValue).fields;if(i.length===0)e.push(s);else for(const o of i)e.push(s.child(o))}else e.push(s)}),new An(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Et{constructor(e,n,r,s,i,o,a){this.key=e,this.documentType=n,this.version=r,this.readTime=s,this.createTime=i,this.data=o,this.documentState=a}static newInvalidDocument(e){return new Et(e,0,pe.min(),pe.min(),pe.min(),an.empty(),0)}static newFoundDocument(e,n,r,s){return new Et(e,1,n,pe.min(),r,s,0)}static newNoDocument(e,n){return new Et(e,2,n,pe.min(),pe.min(),an.empty(),0)}static newUnknownDocument(e,n){return new Et(e,3,n,pe.min(),pe.min(),an.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(pe.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=an.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=an.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=pe.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Et&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Et(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mi{constructor(e,n){this.position=e,this.inclusive=n}}function qE(t,e,n){let r=0;for(let s=0;s<t.position.length;s++){const i=e[s],o=t.position[s];if(i.field.isKeyField()?r=te.comparator(te.fromName(o.referenceValue),n.key):r=pi(o,n.data.field(i.field)),i.dir==="desc"&&(r*=-1),r!==0)break}return r}function HE(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!Yr(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fc{constructor(e,n="asc"){this.field=e,this.dir=n}}function nL(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MS{}class Ue extends MS{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new rL(e,n,r):n==="array-contains"?new oL(e,r):n==="in"?new qS(e,r):n==="not-in"?new aL(e,r):n==="array-contains-any"?new lL(e,r):new Ue(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new sL(e,r):new iL(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&n.nullValue===void 0&&this.matchesComparison(pi(n,this.value)):n!==null&&fi(this.value)===fi(n)&&this.matchesComparison(pi(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return ae(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Je extends MS{constructor(e,n){super(),this.filters=e,this.op=n,this.Pe=null}static create(e,n){return new Je(e,n)}matches(e){return Va(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function Va(t){return t.op==="and"}function og(t){return t.op==="or"}function Yy(t){return FS(t)&&Va(t)}function FS(t){for(const e of t.filters)if(e instanceof Je)return!1;return!0}function ag(t){if(t instanceof Ue)return t.field.canonicalString()+t.op.toString()+La(t.value);if(Yy(t))return t.filters.map(e=>ag(e)).join(",");{const e=t.filters.map(n=>ag(n)).join(",");return`${t.op}(${e})`}}function US(t,e){return t instanceof Ue?function(r,s){return s instanceof Ue&&r.op===s.op&&r.field.isEqual(s.field)&&Yr(r.value,s.value)}(t,e):t instanceof Je?function(r,s){return s instanceof Je&&r.op===s.op&&r.filters.length===s.filters.length?r.filters.reduce((i,o,a)=>i&&US(o,s.filters[a]),!0):!1}(t,e):void ae(19439)}function $S(t,e){const n=t.filters.concat(e);return Je.create(n,t.op)}function BS(t){return t instanceof Ue?function(n){return`${n.field.canonicalString()} ${n.op} ${La(n.value)}`}(t):t instanceof Je?function(n){return n.op.toString()+" {"+n.getFilters().map(BS).join(" ,")+"}"}(t):"Filter"}class rL extends Ue{constructor(e,n,r){super(e,n,r),this.key=te.fromName(r.referenceValue)}matches(e){const n=te.comparator(e.key,this.key);return this.matchesComparison(n)}}class sL extends Ue{constructor(e,n){super(e,"in",n),this.keys=zS("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class iL extends Ue{constructor(e,n){super(e,"not-in",n),this.keys=zS("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function zS(t,e){var n;return(((n=e.arrayValue)==null?void 0:n.values)||[]).map(r=>te.fromName(r.referenceValue))}class oL extends Ue{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return Mc(n)&&Vc(n.arrayValue,this.value)}}class qS extends Ue{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&Vc(this.value.arrayValue,n)}}class aL extends Ue{constructor(e,n){super(e,"not-in",n)}matches(e){if(Vc(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&n.nullValue===void 0&&!Vc(this.value.arrayValue,n)}}class lL extends Ue{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!Mc(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>Vc(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cL{constructor(e,n=null,r=[],s=[],i=null,o=null,a=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=s,this.limit=i,this.startAt=o,this.endAt=a,this.Te=null}}function lg(t,e=null,n=[],r=[],s=null,i=null,o=null){return new cL(t,e,n,r,s,i,o)}function fo(t){const e=Ee(t);if(e.Te===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>ag(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(i){return i.field.canonicalString()+i.dir}(r)).join(","),nf(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>La(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>La(r)).join(",")),e.Te=n}return e.Te}function eu(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!nL(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!US(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!HE(t.startAt,e.startAt)&&HE(t.endAt,e.endAt)}function hh(t){return te.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}function fh(t,e){return t.filters.filter(n=>n instanceof Ue&&n.field.isEqual(e))}function WE(t,e,n){let r=_d,s=!0;for(const i of fh(t,e)){let o=_d,a=!0;switch(i.op){case"<":case"<=":o=eL(i.value);break;case"==":case"in":case">=":o=i.value;break;case">":o=i.value,a=!1;break;case"!=":case"not-in":o=_d}BE({value:r,inclusive:s},{value:o,inclusive:a})<0&&(r=o,s=a)}if(n!==null){for(let i=0;i<t.orderBy.length;++i)if(t.orderBy[i].field.isEqual(e)){const o=n.position[i];BE({value:r,inclusive:s},{value:o,inclusive:n.inclusive})<0&&(r=o,s=n.inclusive);break}}return{value:r,inclusive:s}}function GE(t,e,n){let r=Qs,s=!0;for(const i of fh(t,e)){let o=Qs,a=!0;switch(i.op){case">=":case">":o=tL(i.value),a=!1;break;case"==":case"in":case"<=":o=i.value;break;case"<":o=i.value,a=!1;break;case"!=":case"not-in":o=Qs}zE({value:r,inclusive:s},{value:o,inclusive:a})>0&&(r=o,s=a)}if(n!==null){for(let i=0;i<t.orderBy.length;++i)if(t.orderBy[i].field.isEqual(e)){const o=n.position[i];zE({value:r,inclusive:s},{value:o,inclusive:n.inclusive})>0&&(r=o,s=n.inclusive);break}}return{value:r,inclusive:s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Si{constructor(e,n=null,r=[],s=[],i=null,o="F",a=null,c=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=s,this.limit=i,this.limitType=o,this.startAt=a,this.endAt=c,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function uL(t,e,n,r,s,i,o,a){return new Si(t,e,n,r,s,i,o,a)}function tu(t){return new Si(t)}function KE(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function Xy(t){return t.collectionGroup!==null}function va(t){const e=Ee(t);if(e.Ie===null){e.Ie=[];const n=new Set;for(const i of e.explicitOrderBy)e.Ie.push(i),n.add(i.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new et(gt.comparator);return o.filters.forEach(c=>{c.getFlattenedFilters().forEach(d=>{d.isInequality()&&(a=a.add(d.field))})}),a})(e).forEach(i=>{n.has(i.canonicalString())||i.isKeyField()||e.Ie.push(new Fc(i,r))}),n.has(gt.keyField().canonicalString())||e.Ie.push(new Fc(gt.keyField(),r))}return e.Ie}function ir(t){const e=Ee(t);return e.Ee||(e.Ee=HS(e,va(t))),e.Ee}function dL(t){const e=Ee(t);return e.de||(e.de=HS(e,t.explicitOrderBy)),e.de}function HS(t,e){if(t.limitType==="F")return lg(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(s=>{const i=s.dir==="desc"?"asc":"desc";return new Fc(s.field,i)});const n=t.endAt?new mi(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new mi(t.startAt.position,t.startAt.inclusive):null;return lg(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function cg(t,e){const n=t.filters.concat([e]);return new Si(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function ph(t,e,n){return new Si(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function uf(t,e){return eu(ir(t),ir(e))&&t.limitType===e.limitType}function WS(t){return`${fo(ir(t))}|lt:${t.limitType}`}function Go(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(s=>BS(s)).join(", ")}]`),nf(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(s=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(s)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(s=>La(s)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(s=>La(s)).join(",")),`Target(${r})`}(ir(t))}; limitType=${t.limitType})`}function nu(t,e){return e.isFoundDocument()&&function(r,s){const i=s.key.path;return r.collectionGroup!==null?s.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(i):te.isDocumentKey(r.path)?r.path.isEqual(i):r.path.isImmediateParentOf(i)}(t,e)&&function(r,s){for(const i of va(r))if(!i.field.isKeyField()&&s.data.field(i.field)===null)return!1;return!0}(t,e)&&function(r,s){for(const i of r.filters)if(!i.matches(s))return!1;return!0}(t,e)&&function(r,s){return!(r.startAt&&!function(o,a,c){const d=qE(o,a,c);return o.inclusive?d<=0:d<0}(r.startAt,va(r),s)||r.endAt&&!function(o,a,c){const d=qE(o,a,c);return o.inclusive?d>=0:d>0}(r.endAt,va(r),s))}(t,e)}function hL(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function GS(t){return(e,n)=>{let r=!1;for(const s of va(t)){const i=fL(s,e,n);if(i!==0)return i;r=r||s.field.isKeyField()}return 0}}function fL(t,e,n){const r=t.field.isKeyField()?te.comparator(e.key,n.key):function(i,o,a){const c=o.data.field(i),d=a.data.field(i);return c!==null&&d!==null?pi(c,d):ae(42886)}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return ae(19790,{direction:t.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Is{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[s,i]of r)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),s=this.inner[r];if(s===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,n]);s.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return r.length===1?delete this.inner[n]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(e){bi(this.inner,(n,r)=>{for(const[s,i]of r)e(s,i)})}isEmpty(){return AS(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pL=new ft(te.comparator);function Bn(){return pL}const KS=new ft(te.comparator);function Ml(...t){let e=KS;for(const n of t)e=e.insert(n.key,n);return e}function QS(t){let e=KS;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function $r(){return oc()}function YS(){return oc()}function oc(){return new Is(t=>t.toString(),(t,e)=>t.isEqual(e))}const mL=new ft(te.comparator),gL=new et(te.comparator);function De(...t){let e=gL;for(const n of t)e=e.add(n);return e}const yL=new et(xe);function vL(){return yL}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Jy(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:kc(e)?"-0":e}}function XS(t){return{integerValue:""+t}}function JS(t,e){return TO(e)?XS(e):Jy(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class df{constructor(){this._=void 0}}function _L(t,e,n){return t instanceof Ma?function(s,i){const o={fields:{[PS]:{stringValue:NS},[DS]:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return i&&af(i)&&(i=lf(i)),i&&(o.fields[kS]=i),{mapValue:o}}(n,e):t instanceof po?eC(t,e):t instanceof Fa?tC(t,e):function(s,i){const o=ZS(s,i),a=QE(o)+QE(s.Ae);return ig(o)&&ig(s.Ae)?XS(a):Jy(s.serializer,a)}(t,e)}function wL(t,e,n){return t instanceof po?eC(t,e):t instanceof Fa?tC(t,e):n}function ZS(t,e){return t instanceof Ua?function(r){return ig(r)||function(i){return!!i&&"doubleValue"in i}(r)}(e)?e:{integerValue:0}:null}class Ma extends df{}class po extends df{constructor(e){super(),this.elements=e}}function eC(t,e){const n=nC(e);for(const r of t.elements)n.some(s=>Yr(s,r))||n.push(r);return{arrayValue:{values:n}}}class Fa extends df{constructor(e){super(),this.elements=e}}function tC(t,e){let n=nC(e);for(const r of t.elements)n=n.filter(s=>!Yr(s,r));return{arrayValue:{values:n}}}class Ua extends df{constructor(e,n){super(),this.serializer=e,this.Ae=n}}function QE(t){return ut(t.integerValue||t.doubleValue)}function nC(t){return Mc(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hf{constructor(e,n){this.field=e,this.transform=n}}function EL(t,e){return t.field.isEqual(e.field)&&function(r,s){return r instanceof po&&s instanceof po||r instanceof Fa&&s instanceof Fa?Na(r.elements,s.elements,Yr):r instanceof Ua&&s instanceof Ua?Yr(r.Ae,s.Ae):r instanceof Ma&&s instanceof Ma}(t.transform,e.transform)}class IL{constructor(e,n){this.version=e,this.transformResults=n}}class ln{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new ln}static exists(e){return new ln(void 0,e)}static updateTime(e){return new ln(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Id(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class ff{}function rC(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new pf(t.key,ln.none()):new Za(t.key,t.data,ln.none());{const n=t.data,r=an.empty();let s=new et(gt.comparator);for(let i of e.fields)if(!s.has(i)){let o=n.field(i);o===null&&i.length>1&&(i=i.popLast(),o=n.field(i)),o===null?r.delete(i):r.set(i,o),s=s.add(i)}return new xs(t.key,r,new An(s.toArray()),ln.none())}}function xL(t,e,n){t instanceof Za?function(s,i,o){const a=s.value.clone(),c=XE(s.fieldTransforms,i,o.transformResults);a.setAll(c),i.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(t,e,n):t instanceof xs?function(s,i,o){if(!Id(s.precondition,i))return void i.convertToUnknownDocument(o.version);const a=XE(s.fieldTransforms,i,o.transformResults),c=i.data;c.setAll(sC(s)),c.setAll(a),i.convertToFoundDocument(o.version,c).setHasCommittedMutations()}(t,e,n):function(s,i,o){i.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,n)}function ac(t,e,n,r){return t instanceof Za?function(i,o,a,c){if(!Id(i.precondition,o))return a;const d=i.value.clone(),h=JE(i.fieldTransforms,c,o);return d.setAll(h),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),null}(t,e,n,r):t instanceof xs?function(i,o,a,c){if(!Id(i.precondition,o))return a;const d=JE(i.fieldTransforms,c,o),h=o.data;return h.setAll(sC(i)),h.setAll(d),o.convertToFoundDocument(o.version,h).setHasLocalMutations(),a===null?null:a.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(f=>f.field))}(t,e,n,r):function(i,o,a){return Id(i.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(t,e,n)}function TL(t,e){let n=null;for(const r of t.fieldTransforms){const s=e.data.field(r.field),i=ZS(r.transform,s||null);i!=null&&(n===null&&(n=an.empty()),n.set(r.field,i))}return n||null}function YE(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,s){return r===void 0&&s===void 0||!(!r||!s)&&Na(r,s,(i,o)=>EL(i,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class Za extends ff{constructor(e,n,r,s=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class xs extends ff{constructor(e,n,r,s,i=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function sC(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function XE(t,e,n){const r=new Map;fe(t.length===n.length,32656,{Re:n.length,Ve:t.length});for(let s=0;s<n.length;s++){const i=t[s],o=i.transform,a=e.data.field(i.field);r.set(i.field,wL(o,a,n[s]))}return r}function JE(t,e,n){const r=new Map;for(const s of t){const i=s.transform,o=n.data.field(s.field);r.set(s.field,_L(i,o,e))}return r}class pf extends ff{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class iC extends ff{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zy{constructor(e,n,r,s){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&xL(i,e,r[s])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=ac(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=ac(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=YS();return this.mutations.forEach(s=>{const i=e.get(s.key),o=i.overlayedDocument;let a=this.applyToLocalView(o,i.mutatedFields);a=n.has(s.key)?null:a;const c=rC(o,a);c!==null&&r.set(s.key,c),o.isValidDocument()||o.convertToNoDocument(pe.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),De())}isEqual(e){return this.batchId===e.batchId&&Na(this.mutations,e.mutations,(n,r)=>YE(n,r))&&Na(this.baseMutations,e.baseMutations,(n,r)=>YE(n,r))}}class ev{constructor(e,n,r,s){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=s}static from(e,n,r){fe(e.mutations.length===r.length,58842,{me:e.mutations.length,fe:r.length});let s=function(){return mL}();const i=e.mutations;for(let o=0;o<i.length;o++)s=s.insert(i[o].key,r[o].version);return new ev(e,n,r,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tv{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bL{constructor(e,n,r){this.alias=e,this.aggregateType=n,this.fieldPath=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SL{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Nt,Be;function CL(t){switch(t){case z.OK:return ae(64938);case z.CANCELLED:case z.UNKNOWN:case z.DEADLINE_EXCEEDED:case z.RESOURCE_EXHAUSTED:case z.INTERNAL:case z.UNAVAILABLE:case z.UNAUTHENTICATED:return!1;case z.INVALID_ARGUMENT:case z.NOT_FOUND:case z.ALREADY_EXISTS:case z.PERMISSION_DENIED:case z.FAILED_PRECONDITION:case z.ABORTED:case z.OUT_OF_RANGE:case z.UNIMPLEMENTED:case z.DATA_LOSS:return!0;default:return ae(15467,{code:t})}}function oC(t){if(t===void 0)return mn("GRPC error has no .code"),z.UNKNOWN;switch(t){case Nt.OK:return z.OK;case Nt.CANCELLED:return z.CANCELLED;case Nt.UNKNOWN:return z.UNKNOWN;case Nt.DEADLINE_EXCEEDED:return z.DEADLINE_EXCEEDED;case Nt.RESOURCE_EXHAUSTED:return z.RESOURCE_EXHAUSTED;case Nt.INTERNAL:return z.INTERNAL;case Nt.UNAVAILABLE:return z.UNAVAILABLE;case Nt.UNAUTHENTICATED:return z.UNAUTHENTICATED;case Nt.INVALID_ARGUMENT:return z.INVALID_ARGUMENT;case Nt.NOT_FOUND:return z.NOT_FOUND;case Nt.ALREADY_EXISTS:return z.ALREADY_EXISTS;case Nt.PERMISSION_DENIED:return z.PERMISSION_DENIED;case Nt.FAILED_PRECONDITION:return z.FAILED_PRECONDITION;case Nt.ABORTED:return z.ABORTED;case Nt.OUT_OF_RANGE:return z.OUT_OF_RANGE;case Nt.UNIMPLEMENTED:return z.UNIMPLEMENTED;case Nt.DATA_LOSS:return z.DATA_LOSS;default:return ae(39323,{code:t})}}(Be=Nt||(Nt={}))[Be.OK=0]="OK",Be[Be.CANCELLED=1]="CANCELLED",Be[Be.UNKNOWN=2]="UNKNOWN",Be[Be.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Be[Be.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Be[Be.NOT_FOUND=5]="NOT_FOUND",Be[Be.ALREADY_EXISTS=6]="ALREADY_EXISTS",Be[Be.PERMISSION_DENIED=7]="PERMISSION_DENIED",Be[Be.UNAUTHENTICATED=16]="UNAUTHENTICATED",Be[Be.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Be[Be.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Be[Be.ABORTED=10]="ABORTED",Be[Be.OUT_OF_RANGE=11]="OUT_OF_RANGE",Be[Be.UNIMPLEMENTED=12]="UNIMPLEMENTED",Be[Be.INTERNAL=13]="INTERNAL",Be[Be.UNAVAILABLE=14]="UNAVAILABLE",Be[Be.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function AL(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RL=new ai([4294967295,4294967295],0);function ZE(t){const e=AL().encode(t),n=new rS;return n.update(e),new Uint8Array(n.digest())}function eI(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),s=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new ai([n,r],0),new ai([s,i],0)]}class nv{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new Fl(`Invalid padding: ${n}`);if(r<0)throw new Fl(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Fl(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new Fl(`Invalid padding when bitmap length is 0: ${n}`);this.ge=8*e.length-n,this.pe=ai.fromNumber(this.ge)}ye(e,n,r){let s=e.add(n.multiply(ai.fromNumber(r)));return s.compare(RL)===1&&(s=new ai([s.getBits(0),s.getBits(1)],0)),s.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const n=ZE(e),[r,s]=eI(n);for(let i=0;i<this.hashCount;i++){const o=this.ye(r,s,i);if(!this.we(o))return!1}return!0}static create(e,n,r){const s=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),o=new nv(i,s,n);return r.forEach(a=>o.insert(a)),o}insert(e){if(this.ge===0)return;const n=ZE(e),[r,s]=eI(n);for(let i=0;i<this.hashCount;i++){const o=this.ye(r,s,i);this.Se(o)}}Se(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class Fl extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mf{constructor(e,n,r,s,i){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const s=new Map;return s.set(e,ru.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new mf(pe.min(),s,new ft(xe),Bn(),De())}}class ru{constructor(e,n,r,s,i){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new ru(r,n,De(),De(),De())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xd{constructor(e,n,r,s){this.be=e,this.removedTargetIds=n,this.key=r,this.De=s}}class aC{constructor(e,n){this.targetId=e,this.Ce=n}}class lC{constructor(e,n,r=Dt.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=s}}class tI{constructor(){this.ve=0,this.Fe=nI(),this.Me=Dt.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=De(),n=De(),r=De();return this.Fe.forEach((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:n=n.add(s);break;case 1:r=r.add(s);break;default:ae(38017,{changeType:i})}}),new ru(this.Me,this.xe,e,n,r)}qe(){this.Oe=!1,this.Fe=nI()}Qe(e,n){this.Oe=!0,this.Fe=this.Fe.insert(e,n)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,fe(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class NL{constructor(e){this.Ge=e,this.ze=new Map,this.je=Bn(),this.Je=Bu(),this.He=Bu(),this.Ye=new ft(xe)}Ze(e){for(const n of e.be)e.De&&e.De.isFoundDocument()?this.Xe(n,e.De):this.et(n,e.key,e.De);for(const n of e.removedTargetIds)this.et(n,e.key,e.De)}tt(e){this.forEachTarget(e,n=>{const r=this.nt(n);switch(e.state){case 0:this.rt(n)&&r.Le(e.resumeToken);break;case 1:r.Ke(),r.Ne||r.qe(),r.Le(e.resumeToken);break;case 2:r.Ke(),r.Ne||this.removeTarget(n);break;case 3:this.rt(n)&&(r.We(),r.Le(e.resumeToken));break;case 4:this.rt(n)&&(this.it(n),r.Le(e.resumeToken));break;default:ae(56790,{state:e.state})}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.ze.forEach((r,s)=>{this.rt(s)&&n(s)})}st(e){const n=e.targetId,r=e.Ce.count,s=this.ot(n);if(s){const i=s.target;if(hh(i))if(r===0){const o=new te(i.path);this.et(n,o,Et.newNoDocument(o,pe.min()))}else fe(r===1,20013,{expectedCount:r});else{const o=this._t(n);if(o!==r){const a=this.ut(e),c=a?this.ct(a,e,o):1;if(c!==0){this.it(n);const d=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(n,d)}}}}}ut(e){const n=e.Ce.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:s=0},hashCount:i=0}=n;let o,a;try{o=_s(r).toUint8Array()}catch(c){if(c instanceof RS)return co("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{a=new nv(o,s,i)}catch(c){return co(c instanceof Fl?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return a.ge===0?null:a}ct(e,n,r){return n.Ce.count===r-this.Pt(e,n.targetId)?0:2}Pt(e,n){const r=this.Ge.getRemoteKeysForTarget(n);let s=0;return r.forEach(i=>{const o=this.Ge.ht(),a=`projects/${o.projectId}/databases/${o.database}/documents/${i.path.canonicalString()}`;e.mightContain(a)||(this.et(n,i,null),s++)}),s}Tt(e){const n=new Map;this.ze.forEach((i,o)=>{const a=this.ot(o);if(a){if(i.current&&hh(a.target)){const c=new te(a.target.path);this.It(c).has(o)||this.Et(o,c)||this.et(o,c,Et.newNoDocument(c,e))}i.Be&&(n.set(o,i.ke()),i.qe())}});let r=De();this.He.forEach((i,o)=>{let a=!0;o.forEachWhile(c=>{const d=this.ot(c);return!d||d.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(i))}),this.je.forEach((i,o)=>o.setReadTime(e));const s=new mf(e,n,this.Ye,this.je,r);return this.je=Bn(),this.Je=Bu(),this.He=Bu(),this.Ye=new ft(xe),s}Xe(e,n){if(!this.rt(e))return;const r=this.Et(e,n.key)?2:0;this.nt(e).Qe(n.key,r),this.je=this.je.insert(n.key,n),this.Je=this.Je.insert(n.key,this.It(n.key).add(e)),this.He=this.He.insert(n.key,this.dt(n.key).add(e))}et(e,n,r){if(!this.rt(e))return;const s=this.nt(e);this.Et(e,n)?s.Qe(n,1):s.$e(n),this.He=this.He.insert(n,this.dt(n).delete(e)),this.He=this.He.insert(n,this.dt(n).add(e)),r&&(this.je=this.je.insert(n,r))}removeTarget(e){this.ze.delete(e)}_t(e){const n=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let n=this.ze.get(e);return n||(n=new tI,this.ze.set(e,n)),n}dt(e){let n=this.He.get(e);return n||(n=new et(xe),this.He=this.He.insert(e,n)),n}It(e){let n=this.Je.get(e);return n||(n=new et(xe),this.Je=this.Je.insert(e,n)),n}rt(e){const n=this.ot(e)!==null;return n||W("WatchChangeAggregator","Detected inactive target",e),n}ot(e){const n=this.ze.get(e);return n&&n.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new tI),this.Ge.getRemoteKeysForTarget(e).forEach(n=>{this.et(e,n,null)})}Et(e,n){return this.Ge.getRemoteKeysForTarget(e).has(n)}}function Bu(){return new ft(te.comparator)}function nI(){return new ft(te.comparator)}const PL={asc:"ASCENDING",desc:"DESCENDING"},kL={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},DL={and:"AND",or:"OR"};class jL{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function ug(t,e){return t.useProto3Json||nf(e)?e:{value:e}}function $a(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function cC(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function OL(t,e){return $a(t,e.toTimestamp())}function _n(t){return fe(!!t,49232),pe.fromTimestamp(function(n){const r=vs(n);return new ze(r.seconds,r.nanos)}(t))}function rv(t,e){return dg(t,e).canonicalString()}function dg(t,e){const n=function(s){return new He(["projects",s.projectId,"databases",s.database])}(t).child("documents");return e===void 0?n:n.child(e)}function uC(t){const e=He.fromString(t);return fe(vC(e),10190,{key:e.toString()}),e}function mh(t,e){return rv(t.databaseId,e.path)}function Ji(t,e){const n=uC(e);if(n.get(1)!==t.databaseId.projectId)throw new Q(z.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new Q(z.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new te(fC(n))}function dC(t,e){return rv(t.databaseId,e)}function hC(t){const e=uC(t);return e.length===4?He.emptyPath():fC(e)}function hg(t){return new He(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function fC(t){return fe(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function rI(t,e,n){return{name:mh(t,e),fields:n.value.mapValue.fields}}function LL(t,e,n){const r=Ji(t,e.name),s=_n(e.updateTime),i=e.createTime?_n(e.createTime):pe.min(),o=new an({mapValue:{fields:e.fields}}),a=Et.newFoundDocument(r,s,i,o);return n&&a.setHasCommittedMutations(),n?a.setHasCommittedMutations():a}function VL(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(d){return d==="NO_CHANGE"?0:d==="ADD"?1:d==="REMOVE"?2:d==="CURRENT"?3:d==="RESET"?4:ae(39313,{state:d})}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=function(d,h){return d.useProto3Json?(fe(h===void 0||typeof h=="string",58123),Dt.fromBase64String(h||"")):(fe(h===void 0||h instanceof Buffer||h instanceof Uint8Array,16193),Dt.fromUint8Array(h||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(d){const h=d.code===void 0?z.UNKNOWN:oC(d.code);return new Q(h,d.message||"")}(o);n=new lC(r,s,i,a||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const s=Ji(t,r.document.name),i=_n(r.document.updateTime),o=r.document.createTime?_n(r.document.createTime):pe.min(),a=new an({mapValue:{fields:r.document.fields}}),c=Et.newFoundDocument(s,i,o,a),d=r.targetIds||[],h=r.removedTargetIds||[];n=new xd(d,h,c.key,c)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const s=Ji(t,r.document),i=r.readTime?_n(r.readTime):pe.min(),o=Et.newNoDocument(s,i),a=r.removedTargetIds||[];n=new xd([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const s=Ji(t,r.document),i=r.removedTargetIds||[];n=new xd([],i,s,null)}else{if(!("filter"in e))return ae(11601,{Rt:e});{e.filter;const r=e.filter;r.targetId;const{count:s=0,unchangedNames:i}=r,o=new SL(s,i),a=r.targetId;n=new aC(a,o)}}return n}function gh(t,e){let n;if(e instanceof Za)n={update:rI(t,e.key,e.value)};else if(e instanceof pf)n={delete:mh(t,e.key)};else if(e instanceof xs)n={update:rI(t,e.key,e.data),updateMask:qL(e.fieldMask)};else{if(!(e instanceof iC))return ae(16599,{Vt:e.type});n={verify:mh(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(i,o){const a=o.transform;if(a instanceof Ma)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof po)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof Fa)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof Ua)return{fieldPath:o.field.canonicalString(),increment:a.Ae};throw ae(20930,{transform:o.transform})}(0,r))),e.precondition.isNone||(n.currentDocument=function(s,i){return i.updateTime!==void 0?{updateTime:OL(s,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:ae(27497)}(t,e.precondition)),n}function fg(t,e){const n=e.currentDocument?function(i){return i.updateTime!==void 0?ln.updateTime(_n(i.updateTime)):i.exists!==void 0?ln.exists(i.exists):ln.none()}(e.currentDocument):ln.none(),r=e.updateTransforms?e.updateTransforms.map(s=>function(o,a){let c=null;if("setToServerValue"in a)fe(a.setToServerValue==="REQUEST_TIME",16630,{proto:a}),c=new Ma;else if("appendMissingElements"in a){const h=a.appendMissingElements.values||[];c=new po(h)}else if("removeAllFromArray"in a){const h=a.removeAllFromArray.values||[];c=new Fa(h)}else"increment"in a?c=new Ua(o,a.increment):ae(16584,{proto:a});const d=gt.fromServerFormat(a.fieldPath);return new hf(d,c)}(t,s)):[];if(e.update){e.update.name;const s=Ji(t,e.update.name),i=new an({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=function(c){const d=c.fieldPaths||[];return new An(d.map(h=>gt.fromServerFormat(h)))}(e.updateMask);return new xs(s,i,o,n,r)}return new Za(s,i,n,r)}if(e.delete){const s=Ji(t,e.delete);return new pf(s,n)}if(e.verify){const s=Ji(t,e.verify);return new iC(s,n)}return ae(1463,{proto:e})}function ML(t,e){return t&&t.length>0?(fe(e!==void 0,14353),t.map(n=>function(s,i){let o=s.updateTime?_n(s.updateTime):_n(i);return o.isEqual(pe.min())&&(o=_n(i)),new IL(o,s.transformResults||[])}(n,e))):[]}function pC(t,e){return{documents:[dC(t,e.path)]}}function sv(t,e){const n={structuredQuery:{}},r=e.path;let s;e.collectionGroup!==null?(s=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=dC(t,s);const i=function(d){if(d.length!==0)return yC(Je.create(d,"and"))}(e.filters);i&&(n.structuredQuery.where=i);const o=function(d){if(d.length!==0)return d.map(h=>function(m){return{field:qs(m.field),direction:$L(m.dir)}}(h))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);const a=ug(t,e.limit);return a!==null&&(n.structuredQuery.limit=a),e.startAt&&(n.structuredQuery.startAt=function(d){return{before:d.inclusive,values:d.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(d){return{before:!d.inclusive,values:d.position}}(e.endAt)),{ft:n,parent:s}}function FL(t,e,n,r){const{ft:s,parent:i}=sv(t,e),o={},a=[];let c=0;return n.forEach(d=>{const h="aggregate_"+c++;o[h]=d.alias,d.aggregateType==="count"?a.push({alias:h,count:{}}):d.aggregateType==="avg"?a.push({alias:h,avg:{field:qs(d.fieldPath)}}):d.aggregateType==="sum"&&a.push({alias:h,sum:{field:qs(d.fieldPath)}})}),{request:{structuredAggregationQuery:{aggregations:a,structuredQuery:s.structuredQuery},parent:s.parent},gt:o,parent:i}}function mC(t){let e=hC(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let s=null;if(r>0){fe(r===1,65062);const h=n.from[0];h.allDescendants?s=h.collectionId:e=e.child(h.collectionId)}let i=[];n.where&&(i=function(f){const m=gC(f);return m instanceof Je&&Yy(m)?m.getFilters():[m]}(n.where));let o=[];n.orderBy&&(o=function(f){return f.map(m=>function(R){return new Fc(Ko(R.field),function(N){switch(N){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(R.direction))}(m))}(n.orderBy));let a=null;n.limit&&(a=function(f){let m;return m=typeof f=="object"?f.value:f,nf(m)?null:m}(n.limit));let c=null;n.startAt&&(c=function(f){const m=!!f.before,_=f.values||[];return new mi(_,m)}(n.startAt));let d=null;return n.endAt&&(d=function(f){const m=!f.before,_=f.values||[];return new mi(_,m)}(n.endAt)),uL(e,s,o,i,a,"F",c,d)}function UL(t,e){const n=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return ae(28987,{purpose:s})}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function gC(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=Ko(n.unaryFilter.field);return Ue.create(r,"==",{doubleValue:NaN});case"IS_NULL":const s=Ko(n.unaryFilter.field);return Ue.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=Ko(n.unaryFilter.field);return Ue.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=Ko(n.unaryFilter.field);return Ue.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return ae(61313);default:return ae(60726)}}(t):t.fieldFilter!==void 0?function(n){return Ue.create(Ko(n.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return ae(58110);default:return ae(50506)}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return Je.create(n.compositeFilter.filters.map(r=>gC(r)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return ae(1026)}}(n.compositeFilter.op))}(t):ae(30097,{filter:t})}function $L(t){return PL[t]}function BL(t){return kL[t]}function zL(t){return DL[t]}function qs(t){return{fieldPath:t.canonicalString()}}function Ko(t){return gt.fromServerFormat(t.fieldPath)}function yC(t){return t instanceof Ue?function(n){if(n.op==="=="){if($E(n.value))return{unaryFilter:{field:qs(n.field),op:"IS_NAN"}};if(UE(n.value))return{unaryFilter:{field:qs(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if($E(n.value))return{unaryFilter:{field:qs(n.field),op:"IS_NOT_NAN"}};if(UE(n.value))return{unaryFilter:{field:qs(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:qs(n.field),op:BL(n.op),value:n.value}}}(t):t instanceof Je?function(n){const r=n.getFilters().map(s=>yC(s));return r.length===1?r[0]:{compositeFilter:{op:zL(n.op),filters:r}}}(t):ae(54877,{filter:t})}function qL(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function vC(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class as{constructor(e,n,r,s,i=pe.min(),o=pe.min(),a=Dt.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=c}withSequenceNumber(e){return new as(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new as(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new as(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new as(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _C{constructor(e){this.yt=e}}function HL(t,e){let n;if(e.document)n=LL(t.yt,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=te.fromSegments(e.noDocument.path),s=go(e.noDocument.readTime);n=Et.newNoDocument(r,s),e.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!e.unknownDocument)return ae(56709);{const r=te.fromSegments(e.unknownDocument.path),s=go(e.unknownDocument.version);n=Et.newUnknownDocument(r,s)}}return e.readTime&&n.setReadTime(function(s){const i=new ze(s[0],s[1]);return pe.fromTimestamp(i)}(e.readTime)),n}function sI(t,e){const n=e.key,r={prefixPath:n.getCollectionPath().popLast().toArray(),collectionGroup:n.collectionGroup,documentId:n.path.lastSegment(),readTime:yh(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=function(i,o){return{name:mh(i,o.key),fields:o.data.value.mapValue.fields,updateTime:$a(i,o.version.toTimestamp()),createTime:$a(i,o.createTime.toTimestamp())}}(t.yt,e);else if(e.isNoDocument())r.noDocument={path:n.path.toArray(),readTime:mo(e.version)};else{if(!e.isUnknownDocument())return ae(57904,{document:e});r.unknownDocument={path:n.path.toArray(),version:mo(e.version)}}return r}function yh(t){const e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function mo(t){const e=t.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function go(t){const e=new ze(t.seconds,t.nanoseconds);return pe.fromTimestamp(e)}function Fi(t,e){const n=(e.baseMutations||[]).map(i=>fg(t.yt,i));for(let i=0;i<e.mutations.length-1;++i){const o=e.mutations[i];if(i+1<e.mutations.length&&e.mutations[i+1].transform!==void 0){const a=e.mutations[i+1];o.updateTransforms=a.transform.fieldTransforms,e.mutations.splice(i+1,1),++i}}const r=e.mutations.map(i=>fg(t.yt,i)),s=ze.fromMillis(e.localWriteTimeMs);return new Zy(e.batchId,s,n,r)}function Ul(t){const e=go(t.readTime),n=t.lastLimboFreeSnapshotVersion!==void 0?go(t.lastLimboFreeSnapshotVersion):pe.min();let r;return r=function(i){return i.documents!==void 0}(t.query)?function(i){const o=i.documents.length;return fe(o===1,1966,{count:o}),ir(tu(hC(i.documents[0])))}(t.query):function(i){return ir(mC(i))}(t.query),new as(r,t.targetId,"TargetPurposeListen",t.lastListenSequenceNumber,e,n,Dt.fromBase64String(t.resumeToken))}function wC(t,e){const n=mo(e.snapshotVersion),r=mo(e.lastLimboFreeSnapshotVersion);let s;s=hh(e.target)?pC(t.yt,e.target):sv(t.yt,e.target).ft;const i=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:fo(e.target),readTime:n,resumeToken:i,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:s}}function EC(t){const e=mC({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?ph(e,e.limit,"L"):e}function Ap(t,e){return new tv(e.largestBatchId,fg(t.yt,e.overlayMutation))}function iI(t,e){const n=e.path.lastSegment();return[t,un(e.path.popLast()),n]}function oI(t,e,n,r){return{indexId:t,uid:e,sequenceNumber:n,readTime:mo(r.readTime),documentKey:un(r.documentKey.path),largestBatchId:r.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WL{getBundleMetadata(e,n){return aI(e).get(n).next(r=>{if(r)return function(i){return{id:i.bundleId,createTime:go(i.createTime),version:i.version}}(r)})}saveBundleMetadata(e,n){return aI(e).put(function(s){return{bundleId:s.id,createTime:mo(_n(s.createTime)),version:s.version}}(n))}getNamedQuery(e,n){return lI(e).get(n).next(r=>{if(r)return function(i){return{name:i.name,query:EC(i.bundledQuery),readTime:go(i.readTime)}}(r)})}saveNamedQuery(e,n){return lI(e).put(function(s){return{name:s.name,readTime:mo(_n(s.readTime)),bundledQuery:s.bundledQuery}}(n))}}function aI(t){return Ut(t,rf)}function lI(t){return Ut(t,sf)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gf{constructor(e,n){this.serializer=e,this.userId=n}static wt(e,n){const r=n.uid||"";return new gf(e,r)}getOverlay(e,n){return Il(e).get(iI(this.userId,n)).next(r=>r?Ap(this.serializer,r):null)}getOverlays(e,n){const r=$r();return L.forEach(n,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,n,r){const s=[];return r.forEach((i,o)=>{const a=new tv(n,o);s.push(this.St(e,a))}),L.waitFor(s)}removeOverlaysForBatchId(e,n,r){const s=new Set;n.forEach(o=>s.add(un(o.getCollectionPath())));const i=[];return s.forEach(o=>{const a=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,r+1],!1,!0);i.push(Il(e).Z(ng,a))}),L.waitFor(i)}getOverlaysForCollection(e,n,r){const s=$r(),i=un(n),o=IDBKeyRange.bound([this.userId,i,r],[this.userId,i,Number.POSITIVE_INFINITY],!0);return Il(e).J(ng,o).next(a=>{for(const c of a){const d=Ap(this.serializer,c);s.set(d.getKey(),d)}return s})}getOverlaysForCollectionGroup(e,n,r,s){const i=$r();let o;const a=IDBKeyRange.bound([this.userId,n,r],[this.userId,n,Number.POSITIVE_INFINITY],!0);return Il(e).ee({index:xS,range:a},(c,d,h)=>{const f=Ap(this.serializer,d);i.size()<s||f.largestBatchId===o?(i.set(f.getKey(),f),o=f.largestBatchId):h.done()}).next(()=>i)}St(e,n){return Il(e).put(function(s,i,o){const[a,c,d]=iI(i,o.mutation.key);return{userId:i,collectionPath:c,documentId:d,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:gh(s.yt,o.mutation)}}(this.serializer,this.userId,n))}}function Il(t){return Ut(t,of)}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GL{bt(e){return Ut(e,Wy)}getSessionToken(e){return this.bt(e).get("sessionToken").next(n=>{const r=n==null?void 0:n.value;return r?Dt.fromUint8Array(r):Dt.EMPTY_BYTE_STRING})}setSessionToken(e,n){return this.bt(e).put({name:"sessionToken",value:n.toUint8Array()})}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ui{constructor(){}Dt(e,n){this.Ct(e,n),n.vt()}Ct(e,n){if("nullValue"in e)this.Ft(n,5);else if("booleanValue"in e)this.Ft(n,10),n.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(n,15),n.Mt(ut(e.integerValue));else if("doubleValue"in e){const r=ut(e.doubleValue);isNaN(r)?this.Ft(n,13):(this.Ft(n,15),kc(r)?n.Mt(0):n.Mt(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Ft(n,20),typeof r=="string"&&(r=vs(r)),n.xt(`${r.seconds||""}`),n.Mt(r.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,n),this.Nt(n);else if("bytesValue"in e)this.Ft(n,30),n.Bt(_s(e.bytesValue)),this.Nt(n);else if("referenceValue"in e)this.Lt(e.referenceValue,n);else if("geoPointValue"in e){const r=e.geoPointValue;this.Ft(n,45),n.Mt(r.latitude||0),n.Mt(r.longitude||0)}else"mapValue"in e?OS(e)?this.Ft(n,Number.MAX_SAFE_INTEGER):cf(e)?this.kt(e.mapValue,n):(this.qt(e.mapValue,n),this.Nt(n)):"arrayValue"in e?(this.Qt(e.arrayValue,n),this.Nt(n)):ae(19022,{$t:e})}Ot(e,n){this.Ft(n,25),this.Ut(e,n)}Ut(e,n){n.xt(e)}qt(e,n){const r=e.fields||{};this.Ft(n,55);for(const s of Object.keys(r))this.Ot(s,n),this.Ct(r[s],n)}kt(e,n){var o,a;const r=e.fields||{};this.Ft(n,53);const s=Oa,i=((a=(o=r[s].arrayValue)==null?void 0:o.values)==null?void 0:a.length)||0;this.Ft(n,15),n.Mt(ut(i)),this.Ot(s,n),this.Ct(r[s],n)}Qt(e,n){const r=e.values||[];this.Ft(n,50);for(const s of r)this.Ct(s,n)}Lt(e,n){this.Ft(n,37),te.fromName(e).path.forEach(r=>{this.Ft(n,60),this.Ut(r,n)})}Ft(e,n){e.Mt(n)}Nt(e){e.Mt(2)}}Ui.Kt=new Ui;/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law | agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES | CONDITIONS OF ANY KIND, either express | implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Oo=255;function KL(t){if(t===0)return 8;let e=0;return t>>4||(e+=4,t<<=4),t>>6||(e+=2,t<<=2),t>>7||(e+=1),e}function cI(t){const e=64-function(r){let s=0;for(let i=0;i<8;++i){const o=KL(255&r[i]);if(s+=o,o!==8)break}return s}(t);return Math.ceil(e/8)}class QL{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Wt(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.Gt(r.value),r=n.next();this.zt()}jt(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.Jt(r.value),r=n.next();this.Ht()}Yt(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.Gt(r);else if(r<2048)this.Gt(960|r>>>6),this.Gt(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Gt(480|r>>>12),this.Gt(128|63&r>>>6),this.Gt(128|63&r);else{const s=n.codePointAt(0);this.Gt(240|s>>>18),this.Gt(128|63&s>>>12),this.Gt(128|63&s>>>6),this.Gt(128|63&s)}}this.zt()}Zt(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.Jt(r);else if(r<2048)this.Jt(960|r>>>6),this.Jt(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Jt(480|r>>>12),this.Jt(128|63&r>>>6),this.Jt(128|63&r);else{const s=n.codePointAt(0);this.Jt(240|s>>>18),this.Jt(128|63&s>>>12),this.Jt(128|63&s>>>6),this.Jt(128|63&s)}}this.Ht()}Xt(e){const n=this.en(e),r=cI(n);this.tn(1+r),this.buffer[this.position++]=255&r;for(let s=n.length-r;s<n.length;++s)this.buffer[this.position++]=255&n[s]}nn(e){const n=this.en(e),r=cI(n);this.tn(1+r),this.buffer[this.position++]=~(255&r);for(let s=n.length-r;s<n.length;++s)this.buffer[this.position++]=~(255&n[s])}rn(){this.sn(Oo),this.sn(255)}_n(){this.an(Oo),this.an(255)}reset(){this.position=0}seed(e){this.tn(e.length),this.buffer.set(e,this.position),this.position+=e.length}un(){return this.buffer.slice(0,this.position)}en(e){const n=function(i){const o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,i,!1),new Uint8Array(o.buffer)}(e),r=!!(128&n[0]);n[0]^=r?255:128;for(let s=1;s<n.length;++s)n[s]^=r?255:0;return n}Gt(e){const n=255&e;n===0?(this.sn(0),this.sn(255)):n===Oo?(this.sn(Oo),this.sn(0)):this.sn(n)}Jt(e){const n=255&e;n===0?(this.an(0),this.an(255)):n===Oo?(this.an(Oo),this.an(0)):this.an(e)}zt(){this.sn(0),this.sn(1)}Ht(){this.an(0),this.an(1)}sn(e){this.tn(1),this.buffer[this.position++]=e}an(e){this.tn(1),this.buffer[this.position++]=~e}tn(e){const n=e+this.position;if(n<=this.buffer.length)return;let r=2*this.buffer.length;r<n&&(r=n);const s=new Uint8Array(r);s.set(this.buffer),this.buffer=s}}class YL{constructor(e){this.cn=e}Bt(e){this.cn.Wt(e)}xt(e){this.cn.Yt(e)}Mt(e){this.cn.Xt(e)}vt(){this.cn.rn()}}class XL{constructor(e){this.cn=e}Bt(e){this.cn.jt(e)}xt(e){this.cn.Zt(e)}Mt(e){this.cn.nn(e)}vt(){this.cn._n()}}class xl{constructor(){this.cn=new QL,this.ln=new YL(this.cn),this.hn=new XL(this.cn)}seed(e){this.cn.seed(e)}Pn(e){return e===0?this.ln:this.hn}un(){return this.cn.un()}reset(){this.cn.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $i{constructor(e,n,r,s){this.Tn=e,this.In=n,this.En=r,this.dn=s}An(){const e=this.dn.length,n=e===0||this.dn[e-1]===255?e+1:e,r=new Uint8Array(n);return r.set(this.dn,0),n!==e?r.set([0],this.dn.length):++r[r.length-1],new $i(this.Tn,this.In,this.En,r)}Rn(e,n,r){return{indexId:this.Tn,uid:e,arrayValue:Td(this.En),directionalValue:Td(this.dn),orderedDocumentKey:Td(n),documentKey:r.path.toArray()}}Vn(e,n,r){const s=this.Rn(e,n,r);return[s.indexId,s.uid,s.arrayValue,s.directionalValue,s.orderedDocumentKey,s.documentKey]}}function ks(t,e){let n=t.Tn-e.Tn;return n!==0?n:(n=uI(t.En,e.En),n!==0?n:(n=uI(t.dn,e.dn),n!==0?n:te.comparator(t.In,e.In)))}function uI(t,e){for(let n=0;n<t.length&&n<e.length;++n){const r=t[n]-e[n];if(r!==0)return r}return t.length-e.length}function Td(t){return m0()?function(n){let r="";for(let s=0;s<n.length;s++)r+=String.fromCharCode(n[s]);return r}(t):t}function dI(t){return typeof t!="string"?t:function(n){const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}(t)}class hI{constructor(e){this.mn=new et((n,r)=>gt.comparator(n.field,r.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.fn=e.orderBy,this.gn=[];for(const n of e.filters){const r=n;r.isInequality()?this.mn=this.mn.add(r):this.gn.push(r)}}get pn(){return this.mn.size>1}yn(e){if(fe(e.collectionGroup===this.collectionId,49279),this.pn)return!1;const n=Zm(e);if(n!==void 0&&!this.wn(n))return!1;const r=Li(e);let s=new Set,i=0,o=0;for(;i<r.length&&this.wn(r[i]);++i)s=s.add(r[i].fieldPath.canonicalString());if(i===r.length)return!0;if(this.mn.size>0){const a=this.mn.getIterator().getNext();if(!s.has(a.field.canonicalString())){const c=r[i];if(!this.Sn(a,c)||!this.bn(this.fn[o++],c))return!1}++i}for(;i<r.length;++i){const a=r[i];if(o>=this.fn.length||!this.bn(this.fn[o++],a))return!1}return!0}Dn(){if(this.pn)return null;let e=new et(gt.comparator);const n=[];for(const r of this.gn)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")n.push(new gd(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),n.push(new gd(r.field,0))}for(const r of this.fn)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),n.push(new gd(r.field,r.dir==="asc"?0:1)));return new ah(ah.UNKNOWN_ID,this.collectionId,n,Pc.empty())}wn(e){for(const n of this.gn)if(this.Sn(n,e))return!0;return!1}Sn(e,n){if(e===void 0||!e.field.isEqual(n.fieldPath))return!1;const r=e.op==="array-contains"||e.op==="array-contains-any";return n.kind===2===r}bn(e,n){return!!e.field.isEqual(n.fieldPath)&&(n.kind===0&&e.dir==="asc"||n.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function IC(t){var n,r;if(fe(t instanceof Ue||t instanceof Je,20012),t instanceof Ue){if(t instanceof qS){const s=((r=(n=t.value.arrayValue)==null?void 0:n.values)==null?void 0:r.map(i=>Ue.create(t.field,"==",i)))||[];return Je.create(s,"or")}return t}const e=t.filters.map(s=>IC(s));return Je.create(e,t.op)}function JL(t){if(t.getFilters().length===0)return[];const e=gg(IC(t));return fe(xC(e),7391),pg(e)||mg(e)?[e]:e.getFilters()}function pg(t){return t instanceof Ue}function mg(t){return t instanceof Je&&Yy(t)}function xC(t){return pg(t)||mg(t)||function(n){if(n instanceof Je&&og(n)){for(const r of n.getFilters())if(!pg(r)&&!mg(r))return!1;return!0}return!1}(t)}function gg(t){if(fe(t instanceof Ue||t instanceof Je,34018),t instanceof Ue)return t;if(t.filters.length===1)return gg(t.filters[0]);const e=t.filters.map(r=>gg(r));let n=Je.create(e,t.op);return n=vh(n),xC(n)?n:(fe(n instanceof Je,64498),fe(Va(n),40251),fe(n.filters.length>1,57927),n.filters.reduce((r,s)=>iv(r,s)))}function iv(t,e){let n;return fe(t instanceof Ue||t instanceof Je,38388),fe(e instanceof Ue||e instanceof Je,25473),n=t instanceof Ue?e instanceof Ue?function(s,i){return Je.create([s,i],"and")}(t,e):fI(t,e):e instanceof Ue?fI(e,t):function(s,i){if(fe(s.filters.length>0&&i.filters.length>0,48005),Va(s)&&Va(i))return $S(s,i.getFilters());const o=og(s)?s:i,a=og(s)?i:s,c=o.filters.map(d=>iv(d,a));return Je.create(c,"or")}(t,e),vh(n)}function fI(t,e){if(Va(e))return $S(e,t.getFilters());{const n=e.filters.map(r=>iv(t,r));return Je.create(n,"or")}}function vh(t){if(fe(t instanceof Ue||t instanceof Je,11850),t instanceof Ue)return t;const e=t.getFilters();if(e.length===1)return vh(e[0]);if(FS(t))return t;const n=e.map(s=>vh(s)),r=[];return n.forEach(s=>{s instanceof Ue?r.push(s):s instanceof Je&&(s.op===t.op?r.push(...s.filters):r.push(s))}),r.length===1?r[0]:Je.create(r,t.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZL{constructor(){this.Cn=new ov}addToCollectionParentIndex(e,n){return this.Cn.add(n),L.resolve()}getCollectionParents(e,n){return L.resolve(this.Cn.getEntries(n))}addFieldIndex(e,n){return L.resolve()}deleteFieldIndex(e,n){return L.resolve()}deleteAllFieldIndexes(e){return L.resolve()}createTargetIndexes(e,n){return L.resolve()}getDocumentsMatchingTarget(e,n){return L.resolve(null)}getIndexType(e,n){return L.resolve(0)}getFieldIndexes(e,n){return L.resolve([])}getNextCollectionGroupToUpdate(e){return L.resolve(null)}getMinOffset(e,n){return L.resolve(Wn.min())}getMinOffsetFromCollectionGroup(e,n){return L.resolve(Wn.min())}updateCollectionGroup(e,n,r){return L.resolve()}updateIndexEntries(e,n){return L.resolve()}}class ov{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n]||new et(He.comparator),i=!s.has(r);return this.index[n]=s.add(r),i}has(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n];return s&&s.has(r)}getEntries(e){return(this.index[e]||new et(He.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pI="IndexedDbIndexManager",zu=new Uint8Array(0);class eV{constructor(e,n){this.databaseId=n,this.vn=new ov,this.Fn=new Is(r=>fo(r),(r,s)=>eu(r,s)),this.uid=e.uid||""}addToCollectionParentIndex(e,n){if(!this.vn.has(n)){const r=n.lastSegment(),s=n.popLast();e.addOnCommittedListener(()=>{this.vn.add(n)});const i={collectionId:r,parent:un(s)};return mI(e).put(i)}return L.resolve()}getCollectionParents(e,n){const r=[],s=IDBKeyRange.bound([n,""],[dS(n),""],!1,!0);return mI(e).J(s).next(i=>{for(const o of i){if(o.collectionId!==n)break;r.push(Ur(o.parent))}return r})}addFieldIndex(e,n){const r=Tl(e),s=function(a){return{indexId:a.indexId,collectionGroup:a.collectionGroup,fields:a.fields.map(c=>[c.fieldPath.canonicalString(),c.kind])}}(n);delete s.indexId;const i=r.add(s);if(n.indexState){const o=Vo(e);return i.next(a=>{o.put(oI(a,this.uid,n.indexState.sequenceNumber,n.indexState.offset))})}return i.next()}deleteFieldIndex(e,n){const r=Tl(e),s=Vo(e),i=Lo(e);return r.delete(n.indexId).next(()=>s.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0))).next(()=>i.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){const n=Tl(e),r=Lo(e),s=Vo(e);return n.Z().next(()=>r.Z()).next(()=>s.Z())}createTargetIndexes(e,n){return L.forEach(this.Mn(n),r=>this.getIndexType(e,r).next(s=>{if(s===0||s===1){const i=new hI(r).Dn();if(i!=null)return this.addFieldIndex(e,i)}}))}getDocumentsMatchingTarget(e,n){const r=Lo(e);let s=!0;const i=new Map;return L.forEach(this.Mn(n),o=>this.xn(e,o).next(a=>{s&&(s=!!a),i.set(o,a)})).next(()=>{if(s){let o=De();const a=[];return L.forEach(i,(c,d)=>{W(pI,`Using index ${function(v){return`id=${v.indexId}|cg=${v.collectionGroup}|f=${v.fields.map(E=>`${E.fieldPath}:${E.kind}`).join(",")}`}(c)} to execute ${fo(n)}`);const h=function(v,E){const O=Zm(E);if(O===void 0)return null;for(const F of fh(v,O.fieldPath))switch(F.op){case"array-contains-any":return F.value.arrayValue.values||[];case"array-contains":return[F.value]}return null}(d,c),f=function(v,E){const O=new Map;for(const F of Li(E))for(const x of fh(v,F.fieldPath))switch(x.op){case"==":case"in":O.set(F.fieldPath.canonicalString(),x.value);break;case"not-in":case"!=":return O.set(F.fieldPath.canonicalString(),x.value),Array.from(O.values())}return null}(d,c),m=function(v,E){const O=[];let F=!0;for(const x of Li(E)){const I=x.kind===0?WE(v,x.fieldPath,v.startAt):GE(v,x.fieldPath,v.startAt);O.push(I.value),F&&(F=I.inclusive)}return new mi(O,F)}(d,c),_=function(v,E){const O=[];let F=!0;for(const x of Li(E)){const I=x.kind===0?GE(v,x.fieldPath,v.endAt):WE(v,x.fieldPath,v.endAt);O.push(I.value),F&&(F=I.inclusive)}return new mi(O,F)}(d,c),R=this.On(c,d,m),C=this.On(c,d,_),N=this.Nn(c,d,f),T=this.Bn(c.indexId,h,R,m.inclusive,C,_.inclusive,N);return L.forEach(T,y=>r.Y(y,n.limit).next(v=>{v.forEach(E=>{const O=te.fromSegments(E.documentKey);o.has(O)||(o=o.add(O),a.push(O))})}))}).next(()=>a)}return L.resolve(null)})}Mn(e){let n=this.Fn.get(e);return n||(e.filters.length===0?n=[e]:n=JL(Je.create(e.filters,"and")).map(r=>lg(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.Fn.set(e,n),n)}Bn(e,n,r,s,i,o,a){const c=(n!=null?n.length:1)*Math.max(r.length,i.length),d=c/(n!=null?n.length:1),h=[];for(let f=0;f<c;++f){const m=n?this.Ln(n[f/d]):zu,_=this.kn(e,m,r[f%d],s),R=this.qn(e,m,i[f%d],o),C=a.map(N=>this.kn(e,m,N,!0));h.push(...this.createRange(_,R,C))}return h}kn(e,n,r,s){const i=new $i(e,te.empty(),n,r);return s?i:i.An()}qn(e,n,r,s){const i=new $i(e,te.empty(),n,r);return s?i.An():i}xn(e,n){const r=new hI(n),s=n.collectionGroup!=null?n.collectionGroup:n.path.lastSegment();return this.getFieldIndexes(e,s).next(i=>{let o=null;for(const a of i)r.yn(a)&&(!o||a.fields.length>o.fields.length)&&(o=a);return o})}getIndexType(e,n){let r=2;const s=this.Mn(n);return L.forEach(s,i=>this.xn(e,i).next(o=>{o?r!==0&&o.fields.length<function(c){let d=new et(gt.comparator),h=!1;for(const f of c.filters)for(const m of f.getFlattenedFilters())m.field.isKeyField()||(m.op==="array-contains"||m.op==="array-contains-any"?h=!0:d=d.add(m.field));for(const f of c.orderBy)f.field.isKeyField()||(d=d.add(f.field));return d.size+(h?1:0)}(i)&&(r=1):r=0})).next(()=>function(o){return o.limit!==null}(n)&&s.length>1&&r===2?1:r)}Qn(e,n){const r=new xl;for(const s of Li(e)){const i=n.data.field(s.fieldPath);if(i==null)return null;const o=r.Pn(s.kind);Ui.Kt.Dt(i,o)}return r.un()}Ln(e){const n=new xl;return Ui.Kt.Dt(e,n.Pn(0)),n.un()}$n(e,n){const r=new xl;return Ui.Kt.Dt(ho(this.databaseId,n),r.Pn(function(i){const o=Li(i);return o.length===0?0:o[o.length-1].kind}(e))),r.un()}Nn(e,n,r){if(r===null)return[];let s=[];s.push(new xl);let i=0;for(const o of Li(e)){const a=r[i++];for(const c of s)if(this.Un(n,o.fieldPath)&&Mc(a))s=this.Kn(s,o,a);else{const d=c.Pn(o.kind);Ui.Kt.Dt(a,d)}}return this.Wn(s)}On(e,n,r){return this.Nn(e,n,r.position)}Wn(e){const n=[];for(let r=0;r<e.length;++r)n[r]=e[r].un();return n}Kn(e,n,r){const s=[...e],i=[];for(const o of r.arrayValue.values||[])for(const a of s){const c=new xl;c.seed(a.un()),Ui.Kt.Dt(o,c.Pn(n.kind)),i.push(c)}return i}Un(e,n){return!!e.filters.find(r=>r instanceof Ue&&r.field.isEqual(n)&&(r.op==="in"||r.op==="not-in"))}getFieldIndexes(e,n){const r=Tl(e),s=Vo(e);return(n?r.J(tg,IDBKeyRange.bound(n,n)):r.J()).next(i=>{const o=[];return L.forEach(i,a=>s.get([a.indexId,this.uid]).next(c=>{o.push(function(h,f){const m=f?new Pc(f.sequenceNumber,new Wn(go(f.readTime),new te(Ur(f.documentKey)),f.largestBatchId)):Pc.empty(),_=h.fields.map(([R,C])=>new gd(gt.fromServerFormat(R),C));return new ah(h.indexId,h.collectionGroup,_,m)}(a,c))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(n=>n.length===0?null:(n.sort((r,s)=>{const i=r.indexState.sequenceNumber-s.indexState.sequenceNumber;return i!==0?i:xe(r.collectionGroup,s.collectionGroup)}),n[0].collectionGroup))}updateCollectionGroup(e,n,r){const s=Tl(e),i=Vo(e);return this.Gn(e).next(o=>s.J(tg,IDBKeyRange.bound(n,n)).next(a=>L.forEach(a,c=>i.put(oI(c.indexId,this.uid,o,r)))))}updateIndexEntries(e,n){const r=new Map;return L.forEach(n,(s,i)=>{const o=r.get(s.collectionGroup);return(o?L.resolve(o):this.getFieldIndexes(e,s.collectionGroup)).next(a=>(r.set(s.collectionGroup,a),L.forEach(a,c=>this.zn(e,s,c).next(d=>{const h=this.jn(i,c);return d.isEqual(h)?L.resolve():this.Jn(e,i,c,d,h)}))))})}Hn(e,n,r,s){return Lo(e).put(s.Rn(this.uid,this.$n(r,n.key),n.key))}Yn(e,n,r,s){return Lo(e).delete(s.Vn(this.uid,this.$n(r,n.key),n.key))}zn(e,n,r){const s=Lo(e);let i=new et(ks);return s.ee({index:IS,range:IDBKeyRange.only([r.indexId,this.uid,Td(this.$n(r,n))])},(o,a)=>{i=i.add(new $i(r.indexId,n,dI(a.arrayValue),dI(a.directionalValue)))}).next(()=>i)}jn(e,n){let r=new et(ks);const s=this.Qn(n,e);if(s==null)return r;const i=Zm(n);if(i!=null){const o=e.data.field(i.fieldPath);if(Mc(o))for(const a of o.arrayValue.values||[])r=r.add(new $i(n.indexId,e.key,this.Ln(a),s))}else r=r.add(new $i(n.indexId,e.key,zu,s));return r}Jn(e,n,r,s,i){W(pI,"Updating index entries for document '%s'",n.key);const o=[];return function(c,d,h,f,m){const _=c.getIterator(),R=d.getIterator();let C=jo(_),N=jo(R);for(;C||N;){let T=!1,y=!1;if(C&&N){const v=h(C,N);v<0?y=!0:v>0&&(T=!0)}else C!=null?y=!0:T=!0;T?(f(N),N=jo(R)):y?(m(C),C=jo(_)):(C=jo(_),N=jo(R))}}(s,i,ks,a=>{o.push(this.Hn(e,n,r,a))},a=>{o.push(this.Yn(e,n,r,a))}),L.waitFor(o)}Gn(e){let n=1;return Vo(e).ee({index:ES,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,s,i)=>{i.done(),n=s.sequenceNumber+1}).next(()=>n)}createRange(e,n,r){r=r.sort((o,a)=>ks(o,a)).filter((o,a,c)=>!a||ks(o,c[a-1])!==0);const s=[];s.push(e);for(const o of r){const a=ks(o,e),c=ks(o,n);if(a===0)s[0]=e.An();else if(a>0&&c<0)s.push(o),s.push(o.An());else if(c>0)break}s.push(n);const i=[];for(let o=0;o<s.length;o+=2){if(this.Zn(s[o],s[o+1]))return[];const a=s[o].Vn(this.uid,zu,te.empty()),c=s[o+1].Vn(this.uid,zu,te.empty());i.push(IDBKeyRange.bound(a,c))}return i}Zn(e,n){return ks(e,n)>0}getMinOffsetFromCollectionGroup(e,n){return this.getFieldIndexes(e,n).next(gI)}getMinOffset(e,n){return L.mapArray(this.Mn(n),r=>this.xn(e,r).next(s=>s||ae(44426))).next(gI)}}function mI(t){return Ut(t,Oc)}function Lo(t){return Ut(t,sc)}function Tl(t){return Ut(t,Hy)}function Vo(t){return Ut(t,rc)}function gI(t){fe(t.length!==0,28825);let e=t[0].indexState.offset,n=e.largestBatchId;for(let r=1;r<t.length;r++){const s=t[r].indexState.offset;By(s,e)<0&&(e=s),n<s.largestBatchId&&(n=s.largestBatchId)}return new Wn(e.readTime,e.documentKey,n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yI={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},TC=41943040;class sn{static withCacheSize(e){return new sn(e,sn.DEFAULT_COLLECTION_PERCENTILE,sn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bC(t,e,n){const r=t.store(gr),s=t.store(Pa),i=[],o=IDBKeyRange.only(n.batchId);let a=0;const c=r.ee({range:o},(h,f,m)=>(a++,m.delete()));i.push(c.next(()=>{fe(a===1,47070,{batchId:n.batchId})}));const d=[];for(const h of n.mutations){const f=vS(e,h.key.path,n.batchId);i.push(s.delete(f)),d.push(h.key)}return L.waitFor(i).next(()=>d)}function _h(t){if(!t)return 0;let e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw ae(14731);e=t.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */sn.DEFAULT_COLLECTION_PERCENTILE=10,sn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,sn.DEFAULT=new sn(TC,sn.DEFAULT_COLLECTION_PERCENTILE,sn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),sn.DISABLED=new sn(-1,0,0);class yf{constructor(e,n,r,s){this.userId=e,this.serializer=n,this.indexManager=r,this.referenceDelegate=s,this.Xn={}}static wt(e,n,r,s){fe(e.uid!=="",64387);const i=e.isAuthenticated()?e.uid:"";return new yf(i,n,r,s)}checkEmpty(e){let n=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Ds(e).ee({index:Wi,range:r},(s,i,o)=>{n=!1,o.done()}).next(()=>n)}addMutationBatch(e,n,r,s){const i=Qo(e),o=Ds(e);return o.add({}).next(a=>{fe(typeof a=="number",49019);const c=new Zy(a,n,r,s),d=function(_,R,C){const N=C.baseMutations.map(y=>gh(_.yt,y)),T=C.mutations.map(y=>gh(_.yt,y));return{userId:R,batchId:C.batchId,localWriteTimeMs:C.localWriteTime.toMillis(),baseMutations:N,mutations:T}}(this.serializer,this.userId,c),h=[];let f=new et((m,_)=>xe(m.canonicalString(),_.canonicalString()));for(const m of s){const _=vS(this.userId,m.key.path,a);f=f.add(m.key.path.popLast()),h.push(o.put(d)),h.push(i.put(_,CO))}return f.forEach(m=>{h.push(this.indexManager.addToCollectionParentIndex(e,m))}),e.addOnCommittedListener(()=>{this.Xn[a]=c.keys()}),L.waitFor(h).next(()=>c)})}lookupMutationBatch(e,n){return Ds(e).get(n).next(r=>r?(fe(r.userId===this.userId,48,"Unexpected user for mutation batch",{userId:r.userId,batchId:n}),Fi(this.serializer,r)):null)}er(e,n){return this.Xn[n]?L.resolve(this.Xn[n]):this.lookupMutationBatch(e,n).next(r=>{if(r){const s=r.keys();return this.Xn[n]=s,s}return null})}getNextMutationBatchAfterBatchId(e,n){const r=n+1,s=IDBKeyRange.lowerBound([this.userId,r]);let i=null;return Ds(e).ee({index:Wi,range:s},(o,a,c)=>{a.userId===this.userId&&(fe(a.batchId>=r,47524,{tr:r}),i=Fi(this.serializer,a)),c.done()}).next(()=>i)}getHighestUnacknowledgedBatchId(e){const n=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=Yi;return Ds(e).ee({index:Wi,range:n,reverse:!0},(s,i,o)=>{r=i.batchId,o.done()}).next(()=>r)}getAllMutationBatches(e){const n=IDBKeyRange.bound([this.userId,Yi],[this.userId,Number.POSITIVE_INFINITY]);return Ds(e).J(Wi,n).next(r=>r.map(s=>Fi(this.serializer,s)))}getAllMutationBatchesAffectingDocumentKey(e,n){const r=yd(this.userId,n.path),s=IDBKeyRange.lowerBound(r),i=[];return Qo(e).ee({range:s},(o,a,c)=>{const[d,h,f]=o,m=Ur(h);if(d===this.userId&&n.path.isEqual(m))return Ds(e).get(f).next(_=>{if(!_)throw ae(61480,{nr:o,batchId:f});fe(_.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:_.userId,batchId:f}),i.push(Fi(this.serializer,_))});c.done()}).next(()=>i)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new et(xe);const s=[];return n.forEach(i=>{const o=yd(this.userId,i.path),a=IDBKeyRange.lowerBound(o),c=Qo(e).ee({range:a},(d,h,f)=>{const[m,_,R]=d,C=Ur(_);m===this.userId&&i.path.isEqual(C)?r=r.add(R):f.done()});s.push(c)}),L.waitFor(s).next(()=>this.rr(e,r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,s=r.length+1,i=yd(this.userId,r),o=IDBKeyRange.lowerBound(i);let a=new et(xe);return Qo(e).ee({range:o},(c,d,h)=>{const[f,m,_]=c,R=Ur(m);f===this.userId&&r.isPrefixOf(R)?R.length===s&&(a=a.add(_)):h.done()}).next(()=>this.rr(e,a))}rr(e,n){const r=[],s=[];return n.forEach(i=>{s.push(Ds(e).get(i).next(o=>{if(o===null)throw ae(35274,{batchId:i});fe(o.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:o.userId,batchId:i}),r.push(Fi(this.serializer,o))}))}),L.waitFor(s).next(()=>r)}removeMutationBatch(e,n){return bC(e.le,this.userId,n).next(r=>(e.addOnCommittedListener(()=>{this.ir(n.batchId)}),L.forEach(r,s=>this.referenceDelegate.markPotentiallyOrphaned(e,s))))}ir(e){delete this.Xn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(n=>{if(!n)return L.resolve();const r=IDBKeyRange.lowerBound(function(o){return[o]}(this.userId)),s=[];return Qo(e).ee({range:r},(i,o,a)=>{if(i[0]===this.userId){const c=Ur(i[1]);s.push(c)}else a.done()}).next(()=>{fe(s.length===0,56720,{sr:s.map(i=>i.canonicalString())})})})}containsKey(e,n){return SC(e,this.userId,n)}_r(e){return CC(e).get(this.userId).next(n=>n||{userId:this.userId,lastAcknowledgedBatchId:Yi,lastStreamToken:""})}}function SC(t,e,n){const r=yd(e,n.path),s=r[1],i=IDBKeyRange.lowerBound(r);let o=!1;return Qo(t).ee({range:i,X:!0},(a,c,d)=>{const[h,f,m]=a;h===e&&f===s&&(o=!0),d.done()}).next(()=>o)}function Ds(t){return Ut(t,gr)}function Qo(t){return Ut(t,Pa)}function CC(t){return Ut(t,Dc)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yo{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new yo(0)}static cr(){return new yo(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tV{constructor(e,n){this.referenceDelegate=e,this.serializer=n}allocateTargetId(e){return this.lr(e).next(n=>{const r=new yo(n.highestTargetId);return n.highestTargetId=r.next(),this.hr(e,n).next(()=>n.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.lr(e).next(n=>pe.fromTimestamp(new ze(n.lastRemoteSnapshotVersion.seconds,n.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.lr(e).next(n=>n.highestListenSequenceNumber)}setTargetsMetadata(e,n,r){return this.lr(e).next(s=>(s.highestListenSequenceNumber=n,r&&(s.lastRemoteSnapshotVersion=r.toTimestamp()),n>s.highestListenSequenceNumber&&(s.highestListenSequenceNumber=n),this.hr(e,s)))}addTargetData(e,n){return this.Pr(e,n).next(()=>this.lr(e).next(r=>(r.targetCount+=1,this.Tr(n,r),this.hr(e,r))))}updateTargetData(e,n){return this.Pr(e,n)}removeTargetData(e,n){return this.removeMatchingKeysForTargetId(e,n.targetId).next(()=>Mo(e).delete(n.targetId)).next(()=>this.lr(e)).next(r=>(fe(r.targetCount>0,8065),r.targetCount-=1,this.hr(e,r)))}removeTargets(e,n,r){let s=0;const i=[];return Mo(e).ee((o,a)=>{const c=Ul(a);c.sequenceNumber<=n&&r.get(c.targetId)===null&&(s++,i.push(this.removeTargetData(e,c)))}).next(()=>L.waitFor(i)).next(()=>s)}forEachTarget(e,n){return Mo(e).ee((r,s)=>{const i=Ul(s);n(i)})}lr(e){return vI(e).get(uh).next(n=>(fe(n!==null,2888),n))}hr(e,n){return vI(e).put(uh,n)}Pr(e,n){return Mo(e).put(wC(this.serializer,n))}Tr(e,n){let r=!1;return e.targetId>n.highestTargetId&&(n.highestTargetId=e.targetId,r=!0),e.sequenceNumber>n.highestListenSequenceNumber&&(n.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.lr(e).next(n=>n.targetCount)}getTargetData(e,n){const r=fo(n),s=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let i=null;return Mo(e).ee({range:s,index:wS},(o,a,c)=>{const d=Ul(a);eu(n,d.target)&&(i=d,c.done())}).next(()=>i)}addMatchingKeys(e,n,r){const s=[],i=Hs(e);return n.forEach(o=>{const a=un(o.path);s.push(i.put({targetId:r,path:a})),s.push(this.referenceDelegate.addReference(e,r,o))}),L.waitFor(s)}removeMatchingKeys(e,n,r){const s=Hs(e);return L.forEach(n,i=>{const o=un(i.path);return L.waitFor([s.delete([r,o]),this.referenceDelegate.removeReference(e,r,i)])})}removeMatchingKeysForTargetId(e,n){const r=Hs(e),s=IDBKeyRange.bound([n],[n+1],!1,!0);return r.delete(s)}getMatchingKeysForTargetId(e,n){const r=IDBKeyRange.bound([n],[n+1],!1,!0),s=Hs(e);let i=De();return s.ee({range:r,X:!0},(o,a,c)=>{const d=Ur(o[1]),h=new te(d);i=i.add(h)}).next(()=>i)}containsKey(e,n){const r=un(n.path),s=IDBKeyRange.bound([r],[dS(r)],!1,!0);let i=0;return Hs(e).ee({index:qy,X:!0,range:s},([o,a],c,d)=>{o!==0&&(i++,d.done())}).next(()=>i>0)}At(e,n){return Mo(e).get(n).next(r=>r?Ul(r):null)}}function Mo(t){return Ut(t,ka)}function vI(t){return Ut(t,Xi)}function Hs(t){return Ut(t,Da)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _I="LruGarbageCollector",nV=1048576;function wI([t,e],[n,r]){const s=xe(t,n);return s===0?xe(e,r):s}class rV{constructor(e){this.Ir=e,this.buffer=new et(wI),this.Er=0}dr(){return++this.Er}Ar(e){const n=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(n);else{const r=this.buffer.last();wI(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}}class AC{constructor(e,n,r){this.garbageCollector=e,this.asyncQueue=n,this.localStore=r,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){W(_I,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){Ti(n)?W(_I,"Ignoring IndexedDB error during garbage collection: ",n):await Co(n)}await this.Vr(3e5)})}}class sV{constructor(e,n){this.mr=e,this.params=n}calculateTargetCount(e,n){return this.mr.gr(e).next(r=>Math.floor(n/100*r))}nthSequenceNumber(e,n){if(n===0)return L.resolve(rr.ce);const r=new rV(n);return this.mr.forEachTarget(e,s=>r.Ar(s.sequenceNumber)).next(()=>this.mr.pr(e,s=>r.Ar(s))).next(()=>r.maxValue)}removeTargets(e,n,r){return this.mr.removeTargets(e,n,r)}removeOrphanedDocuments(e,n){return this.mr.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(W("LruGarbageCollector","Garbage collection skipped; disabled"),L.resolve(yI)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(W("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),yI):this.yr(e,n))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,n){let r,s,i,o,a,c,d;const h=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(f=>(f>this.params.maximumSequenceNumbersToCollect?(W("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${f}`),s=this.params.maximumSequenceNumbersToCollect):s=f,o=Date.now(),this.nthSequenceNumber(e,s))).next(f=>(r=f,a=Date.now(),this.removeTargets(e,r,n))).next(f=>(i=f,c=Date.now(),this.removeOrphanedDocuments(e,r))).next(f=>(d=Date.now(),Wo()<=Fe.DEBUG&&W("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-h}ms
	Determined least recently used ${s} in `+(a-o)+`ms
	Removed ${i} targets in `+(c-a)+`ms
	Removed ${f} documents in `+(d-c)+`ms
Total Duration: ${d-h}ms`),L.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:i,documentsRemoved:f})))}}function RC(t,e){return new sV(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iV{constructor(e,n){this.db=e,this.garbageCollector=RC(this,n)}gr(e){const n=this.wr(e);return this.db.getTargetCache().getTargetCount(e).next(r=>n.next(s=>r+s))}wr(e){let n=0;return this.pr(e,r=>{n++}).next(()=>n)}forEachTarget(e,n){return this.db.getTargetCache().forEachTarget(e,n)}pr(e,n){return this.Sr(e,(r,s)=>n(s))}addReference(e,n,r){return qu(e,r)}removeReference(e,n,r){return qu(e,r)}removeTargets(e,n,r){return this.db.getTargetCache().removeTargets(e,n,r)}markPotentiallyOrphaned(e,n){return qu(e,n)}br(e,n){return function(s,i){let o=!1;return CC(s).te(a=>SC(s,a,i).next(c=>(c&&(o=!0),L.resolve(!c)))).next(()=>o)}(e,n)}removeOrphanedDocuments(e,n){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),s=[];let i=0;return this.Sr(e,(o,a)=>{if(a<=n){const c=this.br(e,o).next(d=>{if(!d)return i++,r.getEntry(e,o).next(()=>(r.removeEntry(o,pe.min()),Hs(e).delete(function(f){return[0,un(f.path)]}(o))))});s.push(c)}}).next(()=>L.waitFor(s)).next(()=>r.apply(e)).next(()=>i)}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,n){return qu(e,n)}Sr(e,n){const r=Hs(e);let s,i=rr.ce;return r.ee({index:qy},([o,a],{path:c,sequenceNumber:d})=>{o===0?(i!==rr.ce&&n(new te(Ur(s)),i),i=d,s=c):i=rr.ce}).next(()=>{i!==rr.ce&&n(new te(Ur(s)),i)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function qu(t,e){return Hs(t).put(function(r,s){return{targetId:0,path:un(r.path),sequenceNumber:s}}(e,t.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NC{constructor(){this.changes=new Is(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,Et.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?L.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oV{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,n,r){return ki(e).put(r)}removeEntry(e,n,r){return ki(e).delete(function(i,o){const a=i.path.toArray();return[a.slice(0,a.length-2),a[a.length-2],yh(o),a[a.length-1]]}(n,r))}updateMetadata(e,n){return this.getMetadata(e).next(r=>(r.byteSize+=n,this.Dr(e,r)))}getEntry(e,n){let r=Et.newInvalidDocument(n);return ki(e).ee({index:vd,range:IDBKeyRange.only(bl(n))},(s,i)=>{r=this.Cr(n,i)}).next(()=>r)}vr(e,n){let r={size:0,document:Et.newInvalidDocument(n)};return ki(e).ee({index:vd,range:IDBKeyRange.only(bl(n))},(s,i)=>{r={document:this.Cr(n,i),size:_h(i)}}).next(()=>r)}getEntries(e,n){let r=Bn();return this.Fr(e,n,(s,i)=>{const o=this.Cr(s,i);r=r.insert(s,o)}).next(()=>r)}Mr(e,n){let r=Bn(),s=new ft(te.comparator);return this.Fr(e,n,(i,o)=>{const a=this.Cr(i,o);r=r.insert(i,a),s=s.insert(i,_h(o))}).next(()=>({documents:r,Or:s}))}Fr(e,n,r){if(n.isEmpty())return L.resolve();let s=new et(xI);n.forEach(c=>s=s.add(c));const i=IDBKeyRange.bound(bl(s.first()),bl(s.last())),o=s.getIterator();let a=o.getNext();return ki(e).ee({index:vd,range:i},(c,d,h)=>{const f=te.fromSegments([...d.prefixPath,d.collectionGroup,d.documentId]);for(;a&&xI(a,f)<0;)r(a,null),a=o.getNext();a&&a.isEqual(f)&&(r(a,d),a=o.hasNext()?o.getNext():null),a?h.j(bl(a)):h.done()}).next(()=>{for(;a;)r(a,null),a=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,n,r,s,i){const o=n.path,a=[o.popLast().toArray(),o.lastSegment(),yh(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],c=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return ki(e).J(IDBKeyRange.bound(a,c,!0)).next(d=>{i==null||i.incrementDocumentReadCount(d.length);let h=Bn();for(const f of d){const m=this.Cr(te.fromSegments(f.prefixPath.concat(f.collectionGroup,f.documentId)),f);m.isFoundDocument()&&(nu(n,m)||s.has(m.key))&&(h=h.insert(m.key,m))}return h})}getAllFromCollectionGroup(e,n,r,s){let i=Bn();const o=II(n,r),a=II(n,Wn.max());return ki(e).ee({index:_S,range:IDBKeyRange.bound(o,a,!0)},(c,d,h)=>{const f=this.Cr(te.fromSegments(d.prefixPath.concat(d.collectionGroup,d.documentId)),d);i=i.insert(f.key,f),i.size===s&&h.done()}).next(()=>i)}newChangeBuffer(e){return new aV(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(n=>n.byteSize)}getMetadata(e){return EI(e).get(eg).next(n=>(fe(!!n,20021),n))}Dr(e,n){return EI(e).put(eg,n)}Cr(e,n){if(n){const r=HL(this.serializer,n);if(!(r.isNoDocument()&&r.version.isEqual(pe.min())))return r}return Et.newInvalidDocument(e)}}function PC(t){return new oV(t)}class aV extends NC{constructor(e,n){super(),this.Nr=e,this.trackRemovals=n,this.Br=new Is(r=>r.toString(),(r,s)=>r.isEqual(s))}applyChanges(e){const n=[];let r=0,s=new et((i,o)=>xe(i.canonicalString(),o.canonicalString()));return this.changes.forEach((i,o)=>{const a=this.Br.get(i);if(n.push(this.Nr.removeEntry(e,i,a.readTime)),o.isValidDocument()){const c=sI(this.Nr.serializer,o);s=s.add(i.path.popLast());const d=_h(c);r+=d-a.size,n.push(this.Nr.addEntry(e,i,c))}else if(r-=a.size,this.trackRemovals){const c=sI(this.Nr.serializer,o.convertToNoDocument(pe.min()));n.push(this.Nr.addEntry(e,i,c))}}),s.forEach(i=>{n.push(this.Nr.indexManager.addToCollectionParentIndex(e,i))}),n.push(this.Nr.updateMetadata(e,r)),L.waitFor(n)}getFromCache(e,n){return this.Nr.vr(e,n).next(r=>(this.Br.set(n,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,n){return this.Nr.Mr(e,n).next(({documents:r,Or:s})=>(s.forEach((i,o)=>{this.Br.set(i,{size:o,readTime:r.get(i).readTime})}),r))}}function EI(t){return Ut(t,jc)}function ki(t){return Ut(t,ch)}function bl(t){const e=t.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function II(t,e){const n=e.documentKey.path.toArray();return[t,yh(e.readTime),n.slice(0,n.length-2),n.length>0?n[n.length-1]:""]}function xI(t,e){const n=t.path.toArray(),r=e.path.toArray();let s=0;for(let i=0;i<n.length-2&&i<r.length-2;++i)if(s=xe(n[i],r[i]),s)return s;return s=xe(n.length,r.length),s||(s=xe(n[n.length-2],r[r.length-2]),s||xe(n[n.length-1],r[r.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lV{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kC{constructor(e,n,r,s){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=s}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(s=>(r=s,this.remoteDocumentCache.getEntry(e,n))).next(s=>(r!==null&&ac(r.mutation,s,An.empty(),ze.now()),s))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,De()).next(()=>r))}getLocalViewOfDocuments(e,n,r=De()){const s=$r();return this.populateOverlays(e,s,n).next(()=>this.computeViews(e,n,s,r).next(i=>{let o=Ml();return i.forEach((a,c)=>{o=o.insert(a,c.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){const r=$r();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,De()))}populateOverlays(e,n,r){const s=[];return r.forEach(i=>{n.has(i)||s.push(i)}),this.documentOverlayCache.getOverlays(e,s).next(i=>{i.forEach((o,a)=>{n.set(o,a)})})}computeViews(e,n,r,s){let i=Bn();const o=oc(),a=function(){return oc()}();return n.forEach((c,d)=>{const h=r.get(d.key);s.has(d.key)&&(h===void 0||h.mutation instanceof xs)?i=i.insert(d.key,d):h!==void 0?(o.set(d.key,h.mutation.getFieldMask()),ac(h.mutation,d,h.mutation.getFieldMask(),ze.now())):o.set(d.key,An.empty())}),this.recalculateAndSaveOverlays(e,i).next(c=>(c.forEach((d,h)=>o.set(d,h)),n.forEach((d,h)=>a.set(d,new lV(h,o.get(d)??null))),a))}recalculateAndSaveOverlays(e,n){const r=oc();let s=new ft((o,a)=>o-a),i=De();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(const a of o)a.keys().forEach(c=>{const d=n.get(c);if(d===null)return;let h=r.get(c)||An.empty();h=a.applyToLocalView(d,h),r.set(c,h);const f=(s.get(a.batchId)||De()).add(c);s=s.insert(a.batchId,f)})}).next(()=>{const o=[],a=s.getReverseIterator();for(;a.hasNext();){const c=a.getNext(),d=c.key,h=c.value,f=YS();h.forEach(m=>{if(!i.has(m)){const _=rC(n.get(m),r.get(m));_!==null&&f.set(m,_),i=i.add(m)}}),o.push(this.documentOverlayCache.saveOverlays(e,d,f))}return L.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,s){return function(o){return te.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):Xy(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,s):this.getDocumentsMatchingCollectionQuery(e,n,r,s)}getNextDocuments(e,n,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,s).next(i=>{const o=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,s-i.size):L.resolve($r());let a=Nc,c=i;return o.next(d=>L.forEach(d,(h,f)=>(a<f.largestBatchId&&(a=f.largestBatchId),i.get(h)?L.resolve():this.remoteDocumentCache.getEntry(e,h).next(m=>{c=c.insert(h,m)}))).next(()=>this.populateOverlays(e,d,i)).next(()=>this.computeViews(e,c,d,De())).next(h=>({batchId:a,changes:QS(h)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new te(n)).next(r=>{let s=Ml();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s})}getDocumentsMatchingCollectionGroupQuery(e,n,r,s){const i=n.collectionGroup;let o=Ml();return this.indexManager.getCollectionParents(e,i).next(a=>L.forEach(a,c=>{const d=function(f,m){return new Si(m,null,f.explicitOrderBy.slice(),f.filters.slice(),f.limit,f.limitType,f.startAt,f.endAt)}(n,c.child(i));return this.getDocumentsMatchingCollectionQuery(e,d,r,s).next(h=>{h.forEach((f,m)=>{o=o.insert(f,m)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,n,r,s){let i;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(o=>(i=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,i,s))).next(o=>{i.forEach((c,d)=>{const h=d.getKey();o.get(h)===null&&(o=o.insert(h,Et.newInvalidDocument(h)))});let a=Ml();return o.forEach((c,d)=>{const h=i.get(c);h!==void 0&&ac(h.mutation,d,An.empty(),ze.now()),nu(n,d)&&(a=a.insert(c,d))}),a})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cV{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,n){return L.resolve(this.Lr.get(n))}saveBundleMetadata(e,n){return this.Lr.set(n.id,function(s){return{id:s.id,version:s.version,createTime:_n(s.createTime)}}(n)),L.resolve()}getNamedQuery(e,n){return L.resolve(this.kr.get(n))}saveNamedQuery(e,n){return this.kr.set(n.name,function(s){return{name:s.name,query:EC(s.bundledQuery),readTime:_n(s.readTime)}}(n)),L.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uV{constructor(){this.overlays=new ft(te.comparator),this.qr=new Map}getOverlay(e,n){return L.resolve(this.overlays.get(n))}getOverlays(e,n){const r=$r();return L.forEach(n,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((s,i)=>{this.St(e,n,i)}),L.resolve()}removeOverlaysForBatchId(e,n,r){const s=this.qr.get(r);return s!==void 0&&(s.forEach(i=>this.overlays=this.overlays.remove(i)),this.qr.delete(r)),L.resolve()}getOverlaysForCollection(e,n,r){const s=$r(),i=n.length+1,o=new te(n.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const c=a.getNext().value,d=c.getKey();if(!n.isPrefixOf(d.path))break;d.path.length===i&&c.largestBatchId>r&&s.set(c.getKey(),c)}return L.resolve(s)}getOverlaysForCollectionGroup(e,n,r,s){let i=new ft((d,h)=>d-h);const o=this.overlays.getIterator();for(;o.hasNext();){const d=o.getNext().value;if(d.getKey().getCollectionGroup()===n&&d.largestBatchId>r){let h=i.get(d.largestBatchId);h===null&&(h=$r(),i=i.insert(d.largestBatchId,h)),h.set(d.getKey(),d)}}const a=$r(),c=i.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((d,h)=>a.set(d,h)),!(a.size()>=s)););return L.resolve(a)}St(e,n,r){const s=this.overlays.get(r.key);if(s!==null){const o=this.qr.get(s.largestBatchId).delete(r.key);this.qr.set(s.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new tv(n,r));let i=this.qr.get(n);i===void 0&&(i=De(),this.qr.set(n,i)),this.qr.set(n,i.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dV{constructor(){this.sessionToken=Dt.EMPTY_BYTE_STRING}getSessionToken(e){return L.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,L.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class av{constructor(){this.Qr=new et(Wt.$r),this.Ur=new et(Wt.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,n){const r=new Wt(e,n);this.Qr=this.Qr.add(r),this.Ur=this.Ur.add(r)}Wr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Gr(new Wt(e,n))}zr(e,n){e.forEach(r=>this.removeReference(r,n))}jr(e){const n=new te(new He([])),r=new Wt(n,e),s=new Wt(n,e+1),i=[];return this.Ur.forEachInRange([r,s],o=>{this.Gr(o),i.push(o.key)}),i}Jr(){this.Qr.forEach(e=>this.Gr(e))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const n=new te(new He([])),r=new Wt(n,e),s=new Wt(n,e+1);let i=De();return this.Ur.forEachInRange([r,s],o=>{i=i.add(o.key)}),i}containsKey(e){const n=new Wt(e,0),r=this.Qr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class Wt{constructor(e,n){this.key=e,this.Yr=n}static $r(e,n){return te.comparator(e.key,n.key)||xe(e.Yr,n.Yr)}static Kr(e,n){return xe(e.Yr,n.Yr)||te.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hV{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.tr=1,this.Zr=new et(Wt.$r)}checkEmpty(e){return L.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,s){const i=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new Zy(i,n,r,s);this.mutationQueue.push(o);for(const a of s)this.Zr=this.Zr.add(new Wt(a.key,i)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return L.resolve(o)}lookupMutationBatch(e,n){return L.resolve(this.Xr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,s=this.ei(r),i=s<0?0:s;return L.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return L.resolve(this.mutationQueue.length===0?Yi:this.tr-1)}getAllMutationBatches(e){return L.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new Wt(n,0),s=new Wt(n,Number.POSITIVE_INFINITY),i=[];return this.Zr.forEachInRange([r,s],o=>{const a=this.Xr(o.Yr);i.push(a)}),L.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new et(xe);return n.forEach(s=>{const i=new Wt(s,0),o=new Wt(s,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([i,o],a=>{r=r.add(a.Yr)})}),L.resolve(this.ti(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,s=r.length+1;let i=r;te.isDocumentKey(i)||(i=i.child(""));const o=new Wt(new te(i),0);let a=new et(xe);return this.Zr.forEachWhile(c=>{const d=c.key.path;return!!r.isPrefixOf(d)&&(d.length===s&&(a=a.add(c.Yr)),!0)},o),L.resolve(this.ti(a))}ti(e){const n=[];return e.forEach(r=>{const s=this.Xr(r);s!==null&&n.push(s)}),n}removeMutationBatch(e,n){fe(this.ni(n.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Zr;return L.forEach(n.mutations,s=>{const i=new Wt(s.key,n.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.Zr=r})}ir(e){}containsKey(e,n){const r=new Wt(n,0),s=this.Zr.firstAfterOrEqual(r);return L.resolve(n.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,L.resolve()}ni(e,n){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const n=this.ei(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fV{constructor(e){this.ri=e,this.docs=function(){return new ft(te.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,s=this.docs.get(r),i=s?s.size:0,o=this.ri(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return L.resolve(r?r.document.mutableCopy():Et.newInvalidDocument(n))}getEntries(e,n){let r=Bn();return n.forEach(s=>{const i=this.docs.get(s);r=r.insert(s,i?i.document.mutableCopy():Et.newInvalidDocument(s))}),L.resolve(r)}getDocumentsMatchingQuery(e,n,r,s){let i=Bn();const o=n.path,a=new te(o.child("__id-9223372036854775808__")),c=this.docs.getIteratorFrom(a);for(;c.hasNext();){const{key:d,value:{document:h}}=c.getNext();if(!o.isPrefixOf(d.path))break;d.path.length>o.length+1||By(pS(h),r)<=0||(s.has(h.key)||nu(n,h))&&(i=i.insert(h.key,h.mutableCopy()))}return L.resolve(i)}getAllFromCollectionGroup(e,n,r,s){ae(9500)}ii(e,n){return L.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new pV(this)}getSize(e){return L.resolve(this.size)}}class pV extends NC{constructor(e){super(),this.Nr=e}applyChanges(e){const n=[];return this.changes.forEach((r,s)=>{s.isValidDocument()?n.push(this.Nr.addEntry(e,s)):this.Nr.removeEntry(r)}),L.waitFor(n)}getFromCache(e,n){return this.Nr.getEntry(e,n)}getAllFromCache(e,n){return this.Nr.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mV{constructor(e){this.persistence=e,this.si=new Is(n=>fo(n),eu),this.lastRemoteSnapshotVersion=pe.min(),this.highestTargetId=0,this.oi=0,this._i=new av,this.targetCount=0,this.ai=yo.ur()}forEachTarget(e,n){return this.si.forEach((r,s)=>n(s)),L.resolve()}getLastRemoteSnapshotVersion(e){return L.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return L.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),L.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.oi&&(this.oi=n),L.resolve()}Pr(e){this.si.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.ai=new yo(n),this.highestTargetId=n),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,n){return this.Pr(n),this.targetCount+=1,L.resolve()}updateTargetData(e,n){return this.Pr(n),L.resolve()}removeTargetData(e,n){return this.si.delete(n.target),this._i.jr(n.targetId),this.targetCount-=1,L.resolve()}removeTargets(e,n,r){let s=0;const i=[];return this.si.forEach((o,a)=>{a.sequenceNumber<=n&&r.get(a.targetId)===null&&(this.si.delete(o),i.push(this.removeMatchingKeysForTargetId(e,a.targetId)),s++)}),L.waitFor(i).next(()=>s)}getTargetCount(e){return L.resolve(this.targetCount)}getTargetData(e,n){const r=this.si.get(n)||null;return L.resolve(r)}addMatchingKeys(e,n,r){return this._i.Wr(n,r),L.resolve()}removeMatchingKeys(e,n,r){this._i.zr(n,r);const s=this.persistence.referenceDelegate,i=[];return s&&n.forEach(o=>{i.push(s.markPotentiallyOrphaned(e,o))}),L.waitFor(i)}removeMatchingKeysForTargetId(e,n){return this._i.jr(n),L.resolve()}getMatchingKeysForTargetId(e,n){const r=this._i.Hr(n);return L.resolve(r)}containsKey(e,n){return L.resolve(this._i.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lv{constructor(e,n){this.ui={},this.overlays={},this.ci=new rr(0),this.li=!1,this.li=!0,this.hi=new dV,this.referenceDelegate=e(this),this.Pi=new mV(this),this.indexManager=new ZL,this.remoteDocumentCache=function(s){return new fV(s)}(r=>this.referenceDelegate.Ti(r)),this.serializer=new _C(n),this.Ii=new cV(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new uV,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.ui[e.toKey()];return r||(r=new hV(n,this.referenceDelegate),this.ui[e.toKey()]=r),r}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,n,r){W("MemoryPersistence","Starting transaction:",e);const s=new gV(this.ci.next());return this.referenceDelegate.Ei(),r(s).next(i=>this.referenceDelegate.di(s).next(()=>i)).toPromise().then(i=>(s.raiseOnCommittedEvent(),i))}Ai(e,n){return L.or(Object.values(this.ui).map(r=>()=>r.containsKey(e,n)))}}class gV extends gS{constructor(e){super(),this.currentSequenceNumber=e}}class vf{constructor(e){this.persistence=e,this.Ri=new av,this.Vi=null}static mi(e){return new vf(e)}get fi(){if(this.Vi)return this.Vi;throw ae(60996)}addReference(e,n,r){return this.Ri.addReference(r,n),this.fi.delete(r.toString()),L.resolve()}removeReference(e,n,r){return this.Ri.removeReference(r,n),this.fi.add(r.toString()),L.resolve()}markPotentiallyOrphaned(e,n){return this.fi.add(n.toString()),L.resolve()}removeTarget(e,n){this.Ri.jr(n.targetId).forEach(s=>this.fi.add(s.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(s=>{s.forEach(i=>this.fi.add(i.toString()))}).next(()=>r.removeTargetData(e,n))}Ei(){this.Vi=new Set}di(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return L.forEach(this.fi,r=>{const s=te.fromPath(r);return this.gi(e,s).next(i=>{i||n.removeEntry(s,pe.min())})}).next(()=>(this.Vi=null,n.apply(e)))}updateLimboDocument(e,n){return this.gi(e,n).next(r=>{r?this.fi.delete(n.toString()):this.fi.add(n.toString())})}Ti(e){return 0}gi(e,n){return L.or([()=>L.resolve(this.Ri.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Ai(e,n)])}}class wh{constructor(e,n){this.persistence=e,this.pi=new Is(r=>un(r.path),(r,s)=>r.isEqual(s)),this.garbageCollector=RC(this,n)}static mi(e,n){return new wh(e,n)}Ei(){}di(e){return L.resolve()}forEachTarget(e,n){return this.persistence.getTargetCache().forEachTarget(e,n)}gr(e){const n=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next(r=>n.next(s=>r+s))}wr(e){let n=0;return this.pr(e,r=>{n++}).next(()=>n)}pr(e,n){return L.forEach(this.pi,(r,s)=>this.br(e,r,s).next(i=>i?L.resolve():n(s)))}removeTargets(e,n,r){return this.persistence.getTargetCache().removeTargets(e,n,r)}removeOrphanedDocuments(e,n){let r=0;const s=this.persistence.getRemoteDocumentCache(),i=s.newChangeBuffer();return s.ii(e,o=>this.br(e,o,n).next(a=>{a||(r++,i.removeEntry(o,pe.min()))})).next(()=>i.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,n){return this.pi.set(n,e.currentSequenceNumber),L.resolve()}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,n,r){return this.pi.set(r,e.currentSequenceNumber),L.resolve()}removeReference(e,n,r){return this.pi.set(r,e.currentSequenceNumber),L.resolve()}updateLimboDocument(e,n){return this.pi.set(n,e.currentSequenceNumber),L.resolve()}Ti(e){let n=e.key.toString().length;return e.isFoundDocument()&&(n+=wd(e.data.value)),n}br(e,n,r){return L.or([()=>this.persistence.Ai(e,n),()=>this.persistence.getTargetCache().containsKey(e,n),()=>{const s=this.pi.get(n);return L.resolve(s!==void 0&&s>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yV{constructor(e){this.serializer=e}k(e,n,r,s){const i=new tf("createOrUpgrade",n);r<1&&s>=1&&(function(c){c.createObjectStore(Zc)}(e),function(c){c.createObjectStore(Dc,{keyPath:SO}),c.createObjectStore(gr,{keyPath:jE,autoIncrement:!0}).createIndex(Wi,OE,{unique:!0}),c.createObjectStore(Pa)}(e),TI(e),function(c){c.createObjectStore(Vi)}(e));let o=L.resolve();return r<3&&s>=3&&(r!==0&&(function(c){c.deleteObjectStore(Da),c.deleteObjectStore(ka),c.deleteObjectStore(Xi)}(e),TI(e)),o=o.next(()=>function(c){const d=c.store(Xi),h={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:pe.min().toTimestamp(),targetCount:0};return d.put(uh,h)}(i))),r<4&&s>=4&&(r!==0&&(o=o.next(()=>function(c,d){return d.store(gr).J().next(f=>{c.deleteObjectStore(gr),c.createObjectStore(gr,{keyPath:jE,autoIncrement:!0}).createIndex(Wi,OE,{unique:!0});const m=d.store(gr),_=f.map(R=>m.put(R));return L.waitFor(_)})}(e,i))),o=o.next(()=>{(function(c){c.createObjectStore(ja,{keyPath:OO})})(e)})),r<5&&s>=5&&(o=o.next(()=>this.yi(i))),r<6&&s>=6&&(o=o.next(()=>(function(c){c.createObjectStore(jc)}(e),this.wi(i)))),r<7&&s>=7&&(o=o.next(()=>this.Si(i))),r<8&&s>=8&&(o=o.next(()=>this.bi(e,i))),r<9&&s>=9&&(o=o.next(()=>{(function(c){c.objectStoreNames.contains("remoteDocumentChanges")&&c.deleteObjectStore("remoteDocumentChanges")})(e)})),r<10&&s>=10&&(o=o.next(()=>this.Di(i))),r<11&&s>=11&&(o=o.next(()=>{(function(c){c.createObjectStore(rf,{keyPath:LO})})(e),function(c){c.createObjectStore(sf,{keyPath:VO})}(e)})),r<12&&s>=12&&(o=o.next(()=>{(function(c){const d=c.createObjectStore(of,{keyPath:qO});d.createIndex(ng,HO,{unique:!1}),d.createIndex(xS,WO,{unique:!1})})(e)})),r<13&&s>=13&&(o=o.next(()=>function(c){const d=c.createObjectStore(ch,{keyPath:AO});d.createIndex(vd,RO),d.createIndex(_S,NO)}(e)).next(()=>this.Ci(e,i)).next(()=>e.deleteObjectStore(Vi))),r<14&&s>=14&&(o=o.next(()=>this.Fi(e,i))),r<15&&s>=15&&(o=o.next(()=>function(c){c.createObjectStore(Hy,{keyPath:MO,autoIncrement:!0}).createIndex(tg,FO,{unique:!1}),c.createObjectStore(rc,{keyPath:UO}).createIndex(ES,$O,{unique:!1}),c.createObjectStore(sc,{keyPath:BO}).createIndex(IS,zO,{unique:!1})}(e))),r<16&&s>=16&&(o=o.next(()=>{n.objectStore(rc).clear()}).next(()=>{n.objectStore(sc).clear()})),r<17&&s>=17&&(o=o.next(()=>{(function(c){c.createObjectStore(Wy,{keyPath:GO})})(e)})),r<18&&s>=18&&m0()&&(o=o.next(()=>{n.objectStore(rc).clear()}).next(()=>{n.objectStore(sc).clear()})),o}wi(e){let n=0;return e.store(Vi).ee((r,s)=>{n+=_h(s)}).next(()=>{const r={byteSize:n};return e.store(jc).put(eg,r)})}yi(e){const n=e.store(Dc),r=e.store(gr);return n.J().next(s=>L.forEach(s,i=>{const o=IDBKeyRange.bound([i.userId,Yi],[i.userId,i.lastAcknowledgedBatchId]);return r.J(Wi,o).next(a=>L.forEach(a,c=>{fe(c.userId===i.userId,18650,"Cannot process batch from unexpected user",{batchId:c.batchId});const d=Fi(this.serializer,c);return bC(e,i.userId,d).next(()=>{})}))}))}Si(e){const n=e.store(Da),r=e.store(Vi);return e.store(Xi).get(uh).next(s=>{const i=[];return r.ee((o,a)=>{const c=new He(o),d=function(f){return[0,un(f)]}(c);i.push(n.get(d).next(h=>h?L.resolve():(f=>n.put({targetId:0,path:un(f),sequenceNumber:s.highestListenSequenceNumber}))(c)))}).next(()=>L.waitFor(i))})}bi(e,n){e.createObjectStore(Oc,{keyPath:jO});const r=n.store(Oc),s=new ov,i=o=>{if(s.add(o)){const a=o.lastSegment(),c=o.popLast();return r.put({collectionId:a,parent:un(c)})}};return n.store(Vi).ee({X:!0},(o,a)=>{const c=new He(o);return i(c.popLast())}).next(()=>n.store(Pa).ee({X:!0},([o,a,c],d)=>{const h=Ur(a);return i(h.popLast())}))}Di(e){const n=e.store(ka);return n.ee((r,s)=>{const i=Ul(s),o=wC(this.serializer,i);return n.put(o)})}Ci(e,n){const r=n.store(Vi),s=[];return r.ee((i,o)=>{const a=n.store(ch),c=function(f){return f.document?new te(He.fromString(f.document.name).popFirst(5)):f.noDocument?te.fromSegments(f.noDocument.path):f.unknownDocument?te.fromSegments(f.unknownDocument.path):ae(36783)}(o).path.toArray(),d={prefixPath:c.slice(0,c.length-2),collectionGroup:c[c.length-2],documentId:c[c.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};s.push(a.put(d))}).next(()=>L.waitFor(s))}Fi(e,n){const r=n.store(gr),s=PC(this.serializer),i=new lv(vf.mi,this.serializer.yt);return r.J().next(o=>{const a=new Map;return o.forEach(c=>{let d=a.get(c.userId)??De();Fi(this.serializer,c).keys().forEach(h=>d=d.add(h)),a.set(c.userId,d)}),L.forEach(a,(c,d)=>{const h=new Yt(d),f=gf.wt(this.serializer,h),m=i.getIndexManager(h),_=yf.wt(h,this.serializer,m,i.referenceDelegate);return new kC(s,_,f,m).recalculateAndSaveOverlaysForDocumentKeys(new rg(n,rr.ce),c).next()})})}}function TI(t){t.createObjectStore(Da,{keyPath:kO}).createIndex(qy,DO,{unique:!0}),t.createObjectStore(ka,{keyPath:"targetId"}).createIndex(wS,PO,{unique:!0}),t.createObjectStore(Xi)}const js="IndexedDbPersistence",Rp=18e5,Np=5e3,Pp="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",vV="main";class cv{constructor(e,n,r,s,i,o,a,c,d,h,f=18){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.Mi=i,this.window=o,this.document=a,this.xi=d,this.Oi=h,this.Ni=f,this.ci=null,this.li=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Bi=null,this.inForeground=!1,this.Li=null,this.ki=null,this.qi=Number.NEGATIVE_INFINITY,this.Qi=m=>Promise.resolve(),!cv.v())throw new Q(z.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new iV(this,s),this.$i=n+vV,this.serializer=new _C(c),this.Ui=new li(this.$i,this.Ni,new yV(this.serializer)),this.hi=new GL,this.Pi=new tV(this.referenceDelegate,this.serializer),this.remoteDocumentCache=PC(this.serializer),this.Ii=new WL,this.window&&this.window.localStorage?this.Ki=this.window.localStorage:(this.Ki=null,h===!1&&mn(js,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Wi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new Q(z.FAILED_PRECONDITION,Pp);return this.Gi(),this.zi(),this.ji(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Pi.getHighestSequenceNumber(e))}).then(e=>{this.ci=new rr(e,this.xi)}).then(()=>{this.li=!0}).catch(e=>(this.Ui&&this.Ui.close(),Promise.reject(e)))}Ji(e){return this.Qi=async n=>{if(this.started)return e(n)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ui.$(async n=>{n.newVersion===null&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Mi.enqueueAndForget(async()=>{this.started&&await this.Wi()}))}Wi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>Hu(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.Hi(e).next(n=>{n||(this.isPrimary=!1,this.Mi.enqueueRetryable(()=>this.Qi(!1)))})}).next(()=>this.Yi(e)).next(n=>this.isPrimary&&!n?this.Zi(e).next(()=>!1):!!n&&this.Xi(e).next(()=>!0))).catch(e=>{if(Ti(e))return W(js,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return W(js,"Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.Mi.enqueueRetryable(()=>this.Qi(e)),this.isPrimary=e})}Hi(e){return Sl(e).get(Do).next(n=>L.resolve(this.es(n)))}ts(e){return Hu(e).delete(this.clientId)}async ns(){if(this.isPrimary&&!this.rs(this.qi,Rp)){this.qi=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",n=>{const r=Ut(n,ja);return r.J().next(s=>{const i=this.ss(s,Rp),o=s.filter(a=>i.indexOf(a)===-1);return L.forEach(o,a=>r.delete(a.clientId)).next(()=>o)})}).catch(()=>[]);if(this.Ki)for(const n of e)this.Ki.removeItem(this._s(n.clientId))}}ji(){this.ki=this.Mi.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.Wi().then(()=>this.ns()).then(()=>this.ji()))}es(e){return!!e&&e.ownerId===this.clientId}Yi(e){return this.Oi?L.resolve(!0):Sl(e).get(Do).next(n=>{if(n!==null&&this.rs(n.leaseTimestampMs,Np)&&!this.us(n.ownerId)){if(this.es(n)&&this.networkEnabled)return!0;if(!this.es(n)){if(!n.allowTabSynchronization)throw new Q(z.FAILED_PRECONDITION,Pp);return!1}}return!(!this.networkEnabled||!this.inForeground)||Hu(e).J().next(r=>this.ss(r,Np).find(s=>{if(this.clientId!==s.clientId){const i=!this.networkEnabled&&s.networkEnabled,o=!this.inForeground&&s.inForeground,a=this.networkEnabled===s.networkEnabled;if(i||o&&a)return!0}return!1})===void 0)}).next(n=>(this.isPrimary!==n&&W(js,`Client ${n?"is":"is not"} eligible for a primary lease.`),n))}async shutdown(){this.li=!1,this.cs(),this.ki&&(this.ki.cancel(),this.ki=null),this.ls(),this.hs(),await this.Ui.runTransaction("shutdown","readwrite",[Zc,ja],e=>{const n=new rg(e,rr.ce);return this.Zi(n).next(()=>this.ts(n))}),this.Ui.close(),this.Ps()}ss(e,n){return e.filter(r=>this.rs(r.updateTimeMs,n)&&!this.us(r.clientId))}Ts(){return this.runTransaction("getActiveClients","readonly",e=>Hu(e).J().next(n=>this.ss(n,Rp).map(r=>r.clientId)))}get started(){return this.li}getGlobalsCache(){return this.hi}getMutationQueue(e,n){return yf.wt(e,this.serializer,n,this.referenceDelegate)}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new eV(e,this.serializer.yt.databaseId)}getDocumentOverlayCache(e){return gf.wt(this.serializer,e)}getBundleCache(){return this.Ii}runTransaction(e,n,r){W(js,"Starting transaction:",e);const s=n==="readonly"?"readonly":"readwrite",i=function(c){return c===18?YO:c===17?CS:c===16?QO:c===15?Gy:c===14?SS:c===13?bS:c===12?KO:c===11?TS:void ae(60245)}(this.Ni);let o;return this.Ui.runTransaction(e,s,i,a=>(o=new rg(a,this.ci?this.ci.next():rr.ce),n==="readwrite-primary"?this.Hi(o).next(c=>!!c||this.Yi(o)).next(c=>{if(!c)throw mn(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Mi.enqueueRetryable(()=>this.Qi(!1)),new Q(z.FAILED_PRECONDITION,mS);return r(o)}).next(c=>this.Xi(o).next(()=>c)):this.Is(o).next(()=>r(o)))).then(a=>(o.raiseOnCommittedEvent(),a))}Is(e){return Sl(e).get(Do).next(n=>{if(n!==null&&this.rs(n.leaseTimestampMs,Np)&&!this.us(n.ownerId)&&!this.es(n)&&!(this.Oi||this.allowTabSynchronization&&n.allowTabSynchronization))throw new Q(z.FAILED_PRECONDITION,Pp)})}Xi(e){const n={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return Sl(e).put(Do,n)}static v(){return li.v()}Zi(e){const n=Sl(e);return n.get(Do).next(r=>this.es(r)?(W(js,"Releasing primary lease."),n.delete(Do)):L.resolve())}rs(e,n){const r=Date.now();return!(e<r-n)&&(!(e>r)||(mn(`Detected an update time that is in the future: ${e} > ${r}`),!1))}Gi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Li=()=>{this.Mi.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.Wi()))},this.document.addEventListener("visibilitychange",this.Li),this.inForeground=this.document.visibilityState==="visible")}ls(){this.Li&&(this.document.removeEventListener("visibilitychange",this.Li),this.Li=null)}zi(){var e;typeof((e=this.window)==null?void 0:e.addEventListener)=="function"&&(this.Bi=()=>{this.cs();const n=/(?:Version|Mobile)\/1[456]/;p0()&&(navigator.appVersion.match(n)||navigator.userAgent.match(n))&&this.Mi.enterRestrictedMode(!0),this.Mi.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Bi))}hs(){this.Bi&&(this.window.removeEventListener("pagehide",this.Bi),this.Bi=null)}us(e){var n;try{const r=((n=this.Ki)==null?void 0:n.getItem(this._s(e)))!==null;return W(js,`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return mn(js,"Failed to get zombied client id.",r),!1}}cs(){if(this.Ki)try{this.Ki.setItem(this._s(this.clientId),String(Date.now()))}catch(e){mn("Failed to set zombie client id.",e)}}Ps(){if(this.Ki)try{this.Ki.removeItem(this._s(this.clientId))}catch{}}_s(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function Sl(t){return Ut(t,Zc)}function Hu(t){return Ut(t,ja)}function _V(t,e){let n=t.projectId;return t.isDefaultDatabase||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uv{constructor(e,n,r,s){this.targetId=e,this.fromCache=n,this.Es=r,this.ds=s}static As(e,n){let r=De(),s=De();for(const i of n.docChanges)switch(i.type){case 0:r=r.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new uv(e,n.fromCache,r,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wV{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DC{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=function(){return p0()?8:yS(Ft())>0?6:4}()}initialize(e,n){this.ps=e,this.indexManager=n,this.Rs=!0}getDocumentsMatchingQuery(e,n,r,s){const i={result:null};return this.ys(e,n).next(o=>{i.result=o}).next(()=>{if(!i.result)return this.ws(e,n,s,r).next(o=>{i.result=o})}).next(()=>{if(i.result)return;const o=new wV;return this.Ss(e,n,o).next(a=>{if(i.result=a,this.Vs)return this.bs(e,n,o,a.size)})}).next(()=>i.result)}bs(e,n,r,s){return r.documentReadCount<this.fs?(Wo()<=Fe.DEBUG&&W("QueryEngine","SDK will not create cache indexes for query:",Go(n),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),L.resolve()):(Wo()<=Fe.DEBUG&&W("QueryEngine","Query:",Go(n),"scans",r.documentReadCount,"local documents and returns",s,"documents as results."),r.documentReadCount>this.gs*s?(Wo()<=Fe.DEBUG&&W("QueryEngine","The SDK decides to create cache indexes for query:",Go(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,ir(n))):L.resolve())}ys(e,n){if(KE(n))return L.resolve(null);let r=ir(n);return this.indexManager.getIndexType(e,r).next(s=>s===0?null:(n.limit!==null&&s===1&&(n=ph(n,null,"F"),r=ir(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(i=>{const o=De(...i);return this.ps.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,r).next(c=>{const d=this.Ds(n,a);return this.Cs(n,d,o,c.readTime)?this.ys(e,ph(n,null,"F")):this.vs(e,d,n,c)}))})))}ws(e,n,r,s){return KE(n)||s.isEqual(pe.min())?L.resolve(null):this.ps.getDocuments(e,r).next(i=>{const o=this.Ds(n,i);return this.Cs(n,o,r,s)?L.resolve(null):(Wo()<=Fe.DEBUG&&W("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),Go(n)),this.vs(e,o,n,_O(s,Nc)).next(a=>a))})}Ds(e,n){let r=new et(GS(e));return n.forEach((s,i)=>{nu(e,i)&&(r=r.add(i))}),r}Cs(e,n,r,s){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const i=e.limitType==="F"?n.last():n.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}Ss(e,n,r){return Wo()<=Fe.DEBUG&&W("QueryEngine","Using full collection scan to execute query:",Go(n)),this.ps.getDocumentsMatchingQuery(e,n,Wn.min(),r)}vs(e,n,r,s){return this.ps.getDocumentsMatchingQuery(e,r,s).next(i=>(n.forEach(o=>{i=i.insert(o.key,o)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dv="LocalStore",EV=3e8;class IV{constructor(e,n,r,s){this.persistence=e,this.Fs=n,this.serializer=s,this.Ms=new ft(xe),this.xs=new Is(i=>fo(i),eu),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(r)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new kC(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.Ms))}}function jC(t,e,n,r){return new IV(t,e,n,r)}async function OC(t,e){const n=Ee(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let s;return n.mutationQueue.getAllMutationBatches(r).next(i=>(s=i,n.Bs(e),n.mutationQueue.getAllMutationBatches(r))).next(i=>{const o=[],a=[];let c=De();for(const d of s){o.push(d.batchId);for(const h of d.mutations)c=c.add(h.key)}for(const d of i){a.push(d.batchId);for(const h of d.mutations)c=c.add(h.key)}return n.localDocuments.getDocuments(r,c).next(d=>({Ls:d,removedBatchIds:o,addedBatchIds:a}))})})}function xV(t,e){const n=Ee(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const s=e.batch.keys(),i=n.Ns.newChangeBuffer({trackRemovals:!0});return function(a,c,d,h){const f=d.batch,m=f.keys();let _=L.resolve();return m.forEach(R=>{_=_.next(()=>h.getEntry(c,R)).next(C=>{const N=d.docVersions.get(R);fe(N!==null,48541),C.version.compareTo(N)<0&&(f.applyToRemoteDocument(C,d),C.isValidDocument()&&(C.setReadTime(d.commitVersion),h.addEntry(C)))})}),_.next(()=>a.mutationQueue.removeMutationBatch(c,f))}(n,r,e,i).next(()=>i.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,s,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let c=De();for(let d=0;d<a.mutationResults.length;++d)a.mutationResults[d].transformResults.length>0&&(c=c.add(a.batch.mutations[d].key));return c}(e))).next(()=>n.localDocuments.getDocuments(r,s))})}function LC(t){const e=Ee(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Pi.getLastRemoteSnapshotVersion(n))}function TV(t,e){const n=Ee(t),r=e.snapshotVersion;let s=n.Ms;return n.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const o=n.Ns.newChangeBuffer({trackRemovals:!0});s=n.Ms;const a=[];e.targetChanges.forEach((h,f)=>{const m=s.get(f);if(!m)return;a.push(n.Pi.removeMatchingKeys(i,h.removedDocuments,f).next(()=>n.Pi.addMatchingKeys(i,h.addedDocuments,f)));let _=m.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(f)!==null?_=_.withResumeToken(Dt.EMPTY_BYTE_STRING,pe.min()).withLastLimboFreeSnapshotVersion(pe.min()):h.resumeToken.approximateByteSize()>0&&(_=_.withResumeToken(h.resumeToken,r)),s=s.insert(f,_),function(C,N,T){return C.resumeToken.approximateByteSize()===0||N.snapshotVersion.toMicroseconds()-C.snapshotVersion.toMicroseconds()>=EV?!0:T.addedDocuments.size+T.modifiedDocuments.size+T.removedDocuments.size>0}(m,_,h)&&a.push(n.Pi.updateTargetData(i,_))});let c=Bn(),d=De();if(e.documentUpdates.forEach(h=>{e.resolvedLimboDocuments.has(h)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(i,h))}),a.push(bV(i,o,e.documentUpdates).next(h=>{c=h.ks,d=h.qs})),!r.isEqual(pe.min())){const h=n.Pi.getLastRemoteSnapshotVersion(i).next(f=>n.Pi.setTargetsMetadata(i,i.currentSequenceNumber,r));a.push(h)}return L.waitFor(a).next(()=>o.apply(i)).next(()=>n.localDocuments.getLocalViewOfDocuments(i,c,d)).next(()=>c)}).then(i=>(n.Ms=s,i))}function bV(t,e,n){let r=De(),s=De();return n.forEach(i=>r=r.add(i)),e.getEntries(t,r).next(i=>{let o=Bn();return n.forEach((a,c)=>{const d=i.get(a);c.isFoundDocument()!==d.isFoundDocument()&&(s=s.add(a)),c.isNoDocument()&&c.version.isEqual(pe.min())?(e.removeEntry(a,c.readTime),o=o.insert(a,c)):!d.isValidDocument()||c.version.compareTo(d.version)>0||c.version.compareTo(d.version)===0&&d.hasPendingWrites?(e.addEntry(c),o=o.insert(a,c)):W(dv,"Ignoring outdated watch update for ",a,". Current version:",d.version," Watch version:",c.version)}),{ks:o,qs:s}})}function SV(t,e){const n=Ee(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=Yi),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function CV(t,e){const n=Ee(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let s;return n.Pi.getTargetData(r,e).next(i=>i?(s=i,L.resolve(s)):n.Pi.allocateTargetId(r).next(o=>(s=new as(e,o,"TargetPurposeListen",r.currentSequenceNumber),n.Pi.addTargetData(r,s).next(()=>s))))}).then(r=>{const s=n.Ms.get(r.targetId);return(s===null||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(n.Ms=n.Ms.insert(r.targetId,r),n.xs.set(e,r.targetId)),r})}async function yg(t,e,n){const r=Ee(t),s=r.Ms.get(e),i=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",i,o=>r.persistence.referenceDelegate.removeTarget(o,s))}catch(o){if(!Ti(o))throw o;W(dv,`Failed to update sequence numbers for target ${e}: ${o}`)}r.Ms=r.Ms.remove(e),r.xs.delete(s.target)}function bI(t,e,n){const r=Ee(t);let s=pe.min(),i=De();return r.persistence.runTransaction("Execute query","readwrite",o=>function(c,d,h){const f=Ee(c),m=f.xs.get(h);return m!==void 0?L.resolve(f.Ms.get(m)):f.Pi.getTargetData(d,h)}(r,o,ir(e)).next(a=>{if(a)return s=a.lastLimboFreeSnapshotVersion,r.Pi.getMatchingKeysForTargetId(o,a.targetId).next(c=>{i=c})}).next(()=>r.Fs.getDocumentsMatchingQuery(o,e,n?s:pe.min(),n?i:De())).next(a=>(AV(r,hL(e),a),{documents:a,Qs:i})))}function AV(t,e,n){let r=t.Os.get(e)||pe.min();n.forEach((s,i)=>{i.readTime.compareTo(r)>0&&(r=i.readTime)}),t.Os.set(e,r)}class SI{constructor(){this.activeTargetIds=vL()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class VC{constructor(){this.Mo=new SI,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,n,r){this.xo[e]=n}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new SI,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RV{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CI="ConnectivityMonitor";class AI{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){W(CI,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){W(CI,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Wu=null;function vg(){return Wu===null?Wu=function(){return 268435456+Math.round(2147483648*Math.random())}():Wu++,"0x"+Wu.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kp="RestConnection",NV={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class PV{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const n=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Uo=n+"://"+e.host,this.Ko=`projects/${r}/databases/${s}`,this.Wo=this.databaseId.database===dh?`project_id=${r}`:`project_id=${r}&database_id=${s}`}Go(e,n,r,s,i){const o=vg(),a=this.zo(e,n.toUriEncodedString());W(kp,`Sending RPC '${e}' ${o}:`,a,r);const c={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(c,s,i);const{host:d}=new URL(a),h=Ei(d);return this.Jo(e,a,c,r,h).then(f=>(W(kp,`Received RPC '${e}' ${o}: `,f),f),f=>{throw co(kp,`RPC '${e}' ${o} failed with error: `,f,"url: ",a,"request:",r),f})}Ho(e,n,r,s,i,o){return this.Go(e,n,r,s,i)}jo(e,n,r){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Ja}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((s,i)=>e[i]=s),r&&r.headers.forEach((s,i)=>e[i]=s)}zo(e,n){const r=NV[e];return`${this.Uo}/v1/${n}:${r}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kV{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rn="WebChannelConnection";class DV extends PV{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,n,r,s,i){const o=vg();return new Promise((a,c)=>{const d=new sS;d.setWithCredentials(!0),d.listenOnce(iS.COMPLETE,()=>{try{switch(d.getLastErrorCode()){case md.NO_ERROR:const f=d.getResponseJson();W(rn,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(f)),a(f);break;case md.TIMEOUT:W(rn,`RPC '${e}' ${o} timed out`),c(new Q(z.DEADLINE_EXCEEDED,"Request time out"));break;case md.HTTP_ERROR:const m=d.getStatus();if(W(rn,`RPC '${e}' ${o} failed with status:`,m,"response text:",d.getResponseText()),m>0){let _=d.getResponseJson();Array.isArray(_)&&(_=_[0]);const R=_==null?void 0:_.error;if(R&&R.status&&R.message){const C=function(T){const y=T.toLowerCase().replace(/_/g,"-");return Object.values(z).indexOf(y)>=0?y:z.UNKNOWN}(R.status);c(new Q(C,R.message))}else c(new Q(z.UNKNOWN,"Server responded with status "+d.getStatus()))}else c(new Q(z.UNAVAILABLE,"Connection failed."));break;default:ae(9055,{l_:e,streamId:o,h_:d.getLastErrorCode(),P_:d.getLastError()})}}finally{W(rn,`RPC '${e}' ${o} completed.`)}});const h=JSON.stringify(s);W(rn,`RPC '${e}' ${o} sending request:`,s),d.send(n,"POST",h,r,15)})}T_(e,n,r){const s=vg(),i=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=lS(),a=aS(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},d=this.longPollingOptions.timeoutSeconds;d!==void 0&&(c.longPollingTimeout=Math.round(1e3*d)),this.useFetchStreams&&(c.useFetchStreams=!0),this.jo(c.initMessageHeaders,n,r),c.encodeInitMessageHeaders=!0;const h=i.join("");W(rn,`Creating RPC '${e}' stream ${s}: ${h}`,c);const f=o.createWebChannel(h,c);this.I_(f);let m=!1,_=!1;const R=new kV({Yo:N=>{_?W(rn,`Not sending because RPC '${e}' stream ${s} is closed:`,N):(m||(W(rn,`Opening RPC '${e}' stream ${s} transport.`),f.open(),m=!0),W(rn,`RPC '${e}' stream ${s} sending:`,N),f.send(N))},Zo:()=>f.close()}),C=(N,T,y)=>{N.listen(T,v=>{try{y(v)}catch(E){setTimeout(()=>{throw E},0)}})};return C(f,Vl.EventType.OPEN,()=>{_||(W(rn,`RPC '${e}' stream ${s} transport opened.`),R.o_())}),C(f,Vl.EventType.CLOSE,()=>{_||(_=!0,W(rn,`RPC '${e}' stream ${s} transport closed`),R.a_(),this.E_(f))}),C(f,Vl.EventType.ERROR,N=>{_||(_=!0,co(rn,`RPC '${e}' stream ${s} transport errored. Name:`,N.name,"Message:",N.message),R.a_(new Q(z.UNAVAILABLE,"The operation could not be completed")))}),C(f,Vl.EventType.MESSAGE,N=>{var T;if(!_){const y=N.data[0];fe(!!y,16349);const v=y,E=(v==null?void 0:v.error)||((T=v[0])==null?void 0:T.error);if(E){W(rn,`RPC '${e}' stream ${s} received error:`,E);const O=E.status;let F=function(w){const P=Nt[w];if(P!==void 0)return oC(P)}(O),x=E.message;F===void 0&&(F=z.INTERNAL,x="Unknown error status: "+O+" with message "+E.message),_=!0,R.a_(new Q(F,x)),f.close()}else W(rn,`RPC '${e}' stream ${s} received:`,y),R.u_(y)}}),C(a,oS.STAT_EVENT,N=>{N.stat===Xm.PROXY?W(rn,`RPC '${e}' stream ${s} detected buffering proxy`):N.stat===Xm.NOPROXY&&W(rn,`RPC '${e}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{R.__()},0),R}terminate(){this.c_.forEach(e=>e.close()),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter(n=>n===e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jV(){return typeof window<"u"?window:null}function bd(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _f(t){return new jL(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MC{constructor(e,n,r=1e3,s=1.5,i=6e4){this.Mi=e,this.timerId=n,this.d_=r,this.A_=s,this.R_=i,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const n=Math.floor(this.V_+this.y_()),r=Math.max(0,Date.now()-this.f_),s=Math.max(0,n-r);s>0&&W("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.V_} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,s,()=>(this.f_=Date.now(),e())),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RI="PersistentStream";class FC{constructor(e,n,r,s,i,o,a,c){this.Mi=e,this.S_=r,this.b_=s,this.connection=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=c,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new MC(e,n)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,()=>this.k_()))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,n){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():n&&n.code===z.RESOURCE_EXHAUSTED?(mn(n.toString()),mn("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):n&&n.code===z.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(n)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),n=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,s])=>{this.D_===n&&this.G_(r,s)},r=>{e(()=>{const s=new Q(z.UNKNOWN,"Fetching auth token failed: "+r.message);return this.z_(s)})})}G_(e,n){const r=this.W_(this.D_);this.stream=this.j_(e,n),this.stream.Xo(()=>{r(()=>this.listener.Xo())}),this.stream.t_(()=>{r(()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.t_()))}),this.stream.r_(s=>{r(()=>this.z_(s))}),this.stream.onMessage(s=>{r(()=>++this.F_==1?this.J_(s):this.onNext(s))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return W(RI,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return n=>{this.Mi.enqueueAndForget(()=>this.D_===e?n():(W(RI,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class OV extends FC{constructor(e,n,r,s,i,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,s,o),this.serializer=i}j_(e,n){return this.connection.T_("Listen",e,n)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const n=VL(this.serializer,e),r=function(i){if(!("targetChange"in i))return pe.min();const o=i.targetChange;return o.targetIds&&o.targetIds.length?pe.min():o.readTime?_n(o.readTime):pe.min()}(e);return this.listener.H_(n,r)}Y_(e){const n={};n.database=hg(this.serializer),n.addTarget=function(i,o){let a;const c=o.target;if(a=hh(c)?{documents:pC(i,c)}:{query:sv(i,c).ft},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=cC(i,o.resumeToken);const d=ug(i,o.expectedCount);d!==null&&(a.expectedCount=d)}else if(o.snapshotVersion.compareTo(pe.min())>0){a.readTime=$a(i,o.snapshotVersion.toTimestamp());const d=ug(i,o.expectedCount);d!==null&&(a.expectedCount=d)}return a}(this.serializer,e);const r=UL(this.serializer,e);r&&(n.labels=r),this.q_(n)}Z_(e){const n={};n.database=hg(this.serializer),n.removeTarget=e,this.q_(n)}}class LV extends FC{constructor(e,n,r,s,i,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,s,o),this.serializer=i}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,n){return this.connection.T_("Write",e,n)}J_(e){return fe(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,fe(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){fe(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const n=ML(e.writeResults,e.commitTime),r=_n(e.commitTime);return this.listener.na(r,n)}ra(){const e={};e.database=hg(this.serializer),this.q_(e)}ea(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>gh(this.serializer,r))};this.q_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VV{}class MV extends VV{constructor(e,n,r,s){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=s,this.ia=!1}sa(){if(this.ia)throw new Q(z.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,n,r,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.connection.Go(e,dg(n,r),s,i,o)).catch(i=>{throw i.name==="FirebaseError"?(i.code===z.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new Q(z.UNKNOWN,i.toString())})}Ho(e,n,r,s,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.Ho(e,dg(n,r),s,o,a,i)).catch(o=>{throw o.name==="FirebaseError"?(o.code===z.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new Q(z.UNKNOWN,o.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}class FV{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(mn(n),this.aa=!1):W("OnlineStateTracker",n)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vo="RemoteStore";class UV{constructor(e,n,r,s,i){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=i,this.Aa.Oo(o=>{r.enqueueAndForget(async()=>{Ao(this)&&(W(vo,"Restarting streams for network reachability change."),await async function(c){const d=Ee(c);d.Ea.add(4),await su(d),d.Ra.set("Unknown"),d.Ea.delete(4),await wf(d)}(this))})}),this.Ra=new FV(r,s)}}async function wf(t){if(Ao(t))for(const e of t.da)await e(!0)}async function su(t){for(const e of t.da)await e(!1)}function UC(t,e){const n=Ee(t);n.Ia.has(e.targetId)||(n.Ia.set(e.targetId,e),mv(n)?pv(n):el(n).O_()&&fv(n,e))}function hv(t,e){const n=Ee(t),r=el(n);n.Ia.delete(e),r.O_()&&$C(n,e),n.Ia.size===0&&(r.O_()?r.L_():Ao(n)&&n.Ra.set("Unknown"))}function fv(t,e){if(t.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(pe.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}el(t).Y_(e)}function $C(t,e){t.Va.Ue(e),el(t).Z_(e)}function pv(t){t.Va=new NL({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),At:e=>t.Ia.get(e)||null,ht:()=>t.datastore.serializer.databaseId}),el(t).start(),t.Ra.ua()}function mv(t){return Ao(t)&&!el(t).x_()&&t.Ia.size>0}function Ao(t){return Ee(t).Ea.size===0}function BC(t){t.Va=void 0}async function $V(t){t.Ra.set("Online")}async function BV(t){t.Ia.forEach((e,n)=>{fv(t,e)})}async function zV(t,e){BC(t),mv(t)?(t.Ra.ha(e),pv(t)):t.Ra.set("Unknown")}async function qV(t,e,n){if(t.Ra.set("Online"),e instanceof lC&&e.state===2&&e.cause)try{await async function(s,i){const o=i.cause;for(const a of i.targetIds)s.Ia.has(a)&&(await s.remoteSyncer.rejectListen(a,o),s.Ia.delete(a),s.Va.removeTarget(a))}(t,e)}catch(r){W(vo,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await Eh(t,r)}else if(e instanceof xd?t.Va.Ze(e):e instanceof aC?t.Va.st(e):t.Va.tt(e),!n.isEqual(pe.min()))try{const r=await LC(t.localStore);n.compareTo(r)>=0&&await function(i,o){const a=i.Va.Tt(o);return a.targetChanges.forEach((c,d)=>{if(c.resumeToken.approximateByteSize()>0){const h=i.Ia.get(d);h&&i.Ia.set(d,h.withResumeToken(c.resumeToken,o))}}),a.targetMismatches.forEach((c,d)=>{const h=i.Ia.get(c);if(!h)return;i.Ia.set(c,h.withResumeToken(Dt.EMPTY_BYTE_STRING,h.snapshotVersion)),$C(i,c);const f=new as(h.target,c,d,h.sequenceNumber);fv(i,f)}),i.remoteSyncer.applyRemoteEvent(a)}(t,n)}catch(r){W(vo,"Failed to raise snapshot:",r),await Eh(t,r)}}async function Eh(t,e,n){if(!Ti(e))throw e;t.Ea.add(1),await su(t),t.Ra.set("Offline"),n||(n=()=>LC(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{W(vo,"Retrying IndexedDB access"),await n(),t.Ea.delete(1),await wf(t)})}function zC(t,e){return e().catch(n=>Eh(t,n,e))}async function iu(t){const e=Ee(t),n=gi(e);let r=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:Yi;for(;HV(e);)try{const s=await SV(e.localStore,r);if(s===null){e.Ta.length===0&&n.L_();break}r=s.batchId,WV(e,s)}catch(s){await Eh(e,s)}qC(e)&&HC(e)}function HV(t){return Ao(t)&&t.Ta.length<10}function WV(t,e){t.Ta.push(e);const n=gi(t);n.O_()&&n.X_&&n.ea(e.mutations)}function qC(t){return Ao(t)&&!gi(t).x_()&&t.Ta.length>0}function HC(t){gi(t).start()}async function GV(t){gi(t).ra()}async function KV(t){const e=gi(t);for(const n of t.Ta)e.ea(n.mutations)}async function QV(t,e,n){const r=t.Ta.shift(),s=ev.from(r,e,n);await zC(t,()=>t.remoteSyncer.applySuccessfulWrite(s)),await iu(t)}async function YV(t,e){e&&gi(t).X_&&await async function(r,s){if(function(o){return CL(o)&&o!==z.ABORTED}(s.code)){const i=r.Ta.shift();gi(r).B_(),await zC(r,()=>r.remoteSyncer.rejectFailedWrite(i.batchId,s)),await iu(r)}}(t,e),qC(t)&&HC(t)}async function NI(t,e){const n=Ee(t);n.asyncQueue.verifyOperationInProgress(),W(vo,"RemoteStore received new credentials");const r=Ao(n);n.Ea.add(3),await su(n),r&&n.Ra.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.Ea.delete(3),await wf(n)}async function XV(t,e){const n=Ee(t);e?(n.Ea.delete(2),await wf(n)):e||(n.Ea.add(2),await su(n),n.Ra.set("Unknown"))}function el(t){return t.ma||(t.ma=function(n,r,s){const i=Ee(n);return i.sa(),new OV(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Xo:$V.bind(null,t),t_:BV.bind(null,t),r_:zV.bind(null,t),H_:qV.bind(null,t)}),t.da.push(async e=>{e?(t.ma.B_(),mv(t)?pv(t):t.Ra.set("Unknown")):(await t.ma.stop(),BC(t))})),t.ma}function gi(t){return t.fa||(t.fa=function(n,r,s){const i=Ee(n);return i.sa(),new LV(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Xo:()=>Promise.resolve(),t_:GV.bind(null,t),r_:YV.bind(null,t),ta:KV.bind(null,t),na:QV.bind(null,t)}),t.da.push(async e=>{e?(t.fa.B_(),await iu(t)):(await t.fa.stop(),t.Ta.length>0&&(W(vo,`Stopping write stream with ${t.Ta.length} pending writes`),t.Ta=[]))})),t.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gv{constructor(e,n,r,s,i){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=s,this.removalCallback=i,this.deferred=new Er,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,s,i){const o=Date.now()+r,a=new gv(e,n,o,s,i);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Q(z.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function yv(t,e){if(mn("AsyncQueue",`${e}: ${t}`),Ti(t))return new Q(z.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _a{static emptySet(e){return new _a(e.comparator)}constructor(e){this.comparator=e?(n,r)=>e(n,r)||te.comparator(n.key,r.key):(n,r)=>te.comparator(n.key,r.key),this.keyedMap=Ml(),this.sortedSet=new ft(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof _a)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new _a;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PI{constructor(){this.ga=new ft(te.comparator)}track(e){const n=e.doc.key,r=this.ga.get(n);r?e.type!==0&&r.type===3?this.ga=this.ga.insert(n,e):e.type===3&&r.type!==1?this.ga=this.ga.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.ga=this.ga.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.ga=this.ga.remove(n):e.type===1&&r.type===2?this.ga=this.ga.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):ae(63341,{Rt:e,pa:r}):this.ga=this.ga.insert(n,e)}ya(){const e=[];return this.ga.inorderTraversal((n,r)=>{e.push(r)}),e}}class Ba{constructor(e,n,r,s,i,o,a,c,d){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=c,this.hasCachedResults=d}static fromInitialDocuments(e,n,r,s,i){const o=[];return n.forEach(a=>{o.push({type:0,doc:a})}),new Ba(e,n,_a.emptySet(n),o,r,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&uf(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let s=0;s<n.length;s++)if(n[s].type!==r[s].type||!n[s].doc.isEqual(r[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JV{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some(e=>e.Da())}}class ZV{constructor(){this.queries=kI(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(n,r){const s=Ee(n),i=s.queries;s.queries=kI(),i.forEach((o,a)=>{for(const c of a.Sa)c.onError(r)})})(this,new Q(z.ABORTED,"Firestore shutting down"))}}function kI(){return new Is(t=>WS(t),uf)}async function vv(t,e){const n=Ee(t);let r=3;const s=e.query;let i=n.queries.get(s);i?!i.ba()&&e.Da()&&(r=2):(i=new JV,r=e.Da()?0:1);try{switch(r){case 0:i.wa=await n.onListen(s,!0);break;case 1:i.wa=await n.onListen(s,!1);break;case 2:await n.onFirstRemoteStoreListen(s)}}catch(o){const a=yv(o,`Initialization of query '${Go(e.query)}' failed`);return void e.onError(a)}n.queries.set(s,i),i.Sa.push(e),e.va(n.onlineState),i.wa&&e.Fa(i.wa)&&wv(n)}async function _v(t,e){const n=Ee(t),r=e.query;let s=3;const i=n.queries.get(r);if(i){const o=i.Sa.indexOf(e);o>=0&&(i.Sa.splice(o,1),i.Sa.length===0?s=e.Da()?0:1:!i.ba()&&e.Da()&&(s=2))}switch(s){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function eM(t,e){const n=Ee(t);let r=!1;for(const s of e){const i=s.query,o=n.queries.get(i);if(o){for(const a of o.Sa)a.Fa(s)&&(r=!0);o.wa=s}}r&&wv(n)}function tM(t,e,n){const r=Ee(t),s=r.queries.get(e);if(s)for(const i of s.Sa)i.onError(n);r.queries.delete(e)}function wv(t){t.Ca.forEach(e=>{e.next()})}var _g,DI;(DI=_g||(_g={})).Ma="default",DI.Cache="cache";class Ev{constructor(e,n,r){this.query=e,this.xa=n,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=r||{}}Fa(e){if(!this.options.includeMetadataChanges){const r=[];for(const s of e.docChanges)s.type!==3&&r.push(s);e=new Ba(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),n=!0):this.La(e,this.onlineState)&&(this.ka(e),n=!0),this.Na=e,n}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let n=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),n=!0),n}La(e,n){if(!e.fromCache||!this.Da())return!0;const r=n!=="Offline";return(!this.options.qa||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const n=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}ka(e){e=Ba.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==_g.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WC{constructor(e){this.key=e}}class GC{constructor(e){this.key=e}}class nM{constructor(e,n){this.query=e,this.Ya=n,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=De(),this.mutatedKeys=De(),this.eu=GS(e),this.tu=new _a(this.eu)}get nu(){return this.Ya}ru(e,n){const r=n?n.iu:new PI,s=n?n.tu:this.tu;let i=n?n.mutatedKeys:this.mutatedKeys,o=s,a=!1;const c=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,d=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((h,f)=>{const m=s.get(h),_=nu(this.query,f)?f:null,R=!!m&&this.mutatedKeys.has(m.key),C=!!_&&(_.hasLocalMutations||this.mutatedKeys.has(_.key)&&_.hasCommittedMutations);let N=!1;m&&_?m.data.isEqual(_.data)?R!==C&&(r.track({type:3,doc:_}),N=!0):this.su(m,_)||(r.track({type:2,doc:_}),N=!0,(c&&this.eu(_,c)>0||d&&this.eu(_,d)<0)&&(a=!0)):!m&&_?(r.track({type:0,doc:_}),N=!0):m&&!_&&(r.track({type:1,doc:m}),N=!0,(c||d)&&(a=!0)),N&&(_?(o=o.add(_),i=C?i.add(h):i.delete(h)):(o=o.delete(h),i=i.delete(h)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const h=this.query.limitType==="F"?o.last():o.first();o=o.delete(h.key),i=i.delete(h.key),r.track({type:1,doc:h})}return{tu:o,iu:r,Cs:a,mutatedKeys:i}}su(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,s){const i=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const o=e.iu.ya();o.sort((h,f)=>function(_,R){const C=N=>{switch(N){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return ae(20277,{Rt:N})}};return C(_)-C(R)}(h.type,f.type)||this.eu(h.doc,f.doc)),this.ou(r),s=s??!1;const a=n&&!s?this._u():[],c=this.Xa.size===0&&this.current&&!s?1:0,d=c!==this.Za;return this.Za=c,o.length!==0||d?{snapshot:new Ba(this.query,e.tu,i,o,e.mutatedKeys,c===0,d,!1,!!r&&r.resumeToken.approximateByteSize()>0),au:a}:{au:a}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new PI,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(n=>this.Ya=this.Ya.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Ya=this.Ya.delete(n)),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=De(),this.tu.forEach(r=>{this.uu(r.key)&&(this.Xa=this.Xa.add(r.key))});const n=[];return e.forEach(r=>{this.Xa.has(r)||n.push(new GC(r))}),this.Xa.forEach(r=>{e.has(r)||n.push(new WC(r))}),n}cu(e){this.Ya=e.Qs,this.Xa=De();const n=this.ru(e.documents);return this.applyChanges(n,!0)}lu(){return Ba.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const Iv="SyncEngine";class rM{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class sM{constructor(e){this.key=e,this.hu=!1}}class iM{constructor(e,n,r,s,i,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.Pu={},this.Tu=new Is(a=>WS(a),uf),this.Iu=new Map,this.Eu=new Set,this.du=new ft(te.comparator),this.Au=new Map,this.Ru=new av,this.Vu={},this.mu=new Map,this.fu=yo.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function oM(t,e,n=!0){const r=ZC(t);let s;const i=r.Tu.get(e);return i?(r.sharedClientState.addLocalQueryTarget(i.targetId),s=i.view.lu()):s=await KC(r,e,n,!0),s}async function aM(t,e){const n=ZC(t);await KC(n,e,!0,!1)}async function KC(t,e,n,r){const s=await CV(t.localStore,ir(e)),i=s.targetId,o=t.sharedClientState.addLocalQueryTarget(i,n);let a;return r&&(a=await lM(t,e,i,o==="current",s.resumeToken)),t.isPrimaryClient&&n&&UC(t.remoteStore,s),a}async function lM(t,e,n,r,s){t.pu=(f,m,_)=>async function(C,N,T,y){let v=N.view.ru(T);v.Cs&&(v=await bI(C.localStore,N.query,!1).then(({documents:x})=>N.view.ru(x,v)));const E=y&&y.targetChanges.get(N.targetId),O=y&&y.targetMismatches.get(N.targetId)!=null,F=N.view.applyChanges(v,C.isPrimaryClient,E,O);return OI(C,N.targetId,F.au),F.snapshot}(t,f,m,_);const i=await bI(t.localStore,e,!0),o=new nM(e,i.Qs),a=o.ru(i.documents),c=ru.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",s),d=o.applyChanges(a,t.isPrimaryClient,c);OI(t,n,d.au);const h=new rM(e,n,o);return t.Tu.set(e,h),t.Iu.has(n)?t.Iu.get(n).push(e):t.Iu.set(n,[e]),d.snapshot}async function cM(t,e,n){const r=Ee(t),s=r.Tu.get(e),i=r.Iu.get(s.targetId);if(i.length>1)return r.Iu.set(s.targetId,i.filter(o=>!uf(o,e))),void r.Tu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(s.targetId),r.sharedClientState.isActiveQueryTarget(s.targetId)||await yg(r.localStore,s.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(s.targetId),n&&hv(r.remoteStore,s.targetId),wg(r,s.targetId)}).catch(Co)):(wg(r,s.targetId),await yg(r.localStore,s.targetId,!0))}async function uM(t,e){const n=Ee(t),r=n.Tu.get(e),s=n.Iu.get(r.targetId);n.isPrimaryClient&&s.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),hv(n.remoteStore,r.targetId))}async function dM(t,e,n){const r=eA(t);try{const s=await function(o,a){const c=Ee(o),d=ze.now(),h=a.reduce((_,R)=>_.add(R.key),De());let f,m;return c.persistence.runTransaction("Locally write mutations","readwrite",_=>{let R=Bn(),C=De();return c.Ns.getEntries(_,h).next(N=>{R=N,R.forEach((T,y)=>{y.isValidDocument()||(C=C.add(T))})}).next(()=>c.localDocuments.getOverlayedDocuments(_,R)).next(N=>{f=N;const T=[];for(const y of a){const v=TL(y,f.get(y.key).overlayedDocument);v!=null&&T.push(new xs(y.key,v,VS(v.value.mapValue),ln.exists(!0)))}return c.mutationQueue.addMutationBatch(_,d,T,a)}).next(N=>{m=N;const T=N.applyToLocalDocumentSet(f,C);return c.documentOverlayCache.saveOverlays(_,N.batchId,T)})}).then(()=>({batchId:m.batchId,changes:QS(f)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(s.batchId),function(o,a,c){let d=o.Vu[o.currentUser.toKey()];d||(d=new ft(xe)),d=d.insert(a,c),o.Vu[o.currentUser.toKey()]=d}(r,s.batchId,n),await ou(r,s.changes),await iu(r.remoteStore)}catch(s){const i=yv(s,"Failed to persist write");n.reject(i)}}async function QC(t,e){const n=Ee(t);try{const r=await TV(n.localStore,e);e.targetChanges.forEach((s,i)=>{const o=n.Au.get(i);o&&(fe(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1,22616),s.addedDocuments.size>0?o.hu=!0:s.modifiedDocuments.size>0?fe(o.hu,14607):s.removedDocuments.size>0&&(fe(o.hu,42227),o.hu=!1))}),await ou(n,r,e)}catch(r){await Co(r)}}function jI(t,e,n){const r=Ee(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const s=[];r.Tu.forEach((i,o)=>{const a=o.view.va(e);a.snapshot&&s.push(a.snapshot)}),function(o,a){const c=Ee(o);c.onlineState=a;let d=!1;c.queries.forEach((h,f)=>{for(const m of f.Sa)m.va(a)&&(d=!0)}),d&&wv(c)}(r.eventManager,e),s.length&&r.Pu.H_(s),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function hM(t,e,n){const r=Ee(t);r.sharedClientState.updateQueryState(e,"rejected",n);const s=r.Au.get(e),i=s&&s.key;if(i){let o=new ft(te.comparator);o=o.insert(i,Et.newNoDocument(i,pe.min()));const a=De().add(i),c=new mf(pe.min(),new Map,new ft(xe),o,a);await QC(r,c),r.du=r.du.remove(i),r.Au.delete(e),xv(r)}else await yg(r.localStore,e,!1).then(()=>wg(r,e,n)).catch(Co)}async function fM(t,e){const n=Ee(t),r=e.batch.batchId;try{const s=await xV(n.localStore,e);XC(n,r,null),YC(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await ou(n,s)}catch(s){await Co(s)}}async function pM(t,e,n){const r=Ee(t);try{const s=await function(o,a){const c=Ee(o);return c.persistence.runTransaction("Reject batch","readwrite-primary",d=>{let h;return c.mutationQueue.lookupMutationBatch(d,a).next(f=>(fe(f!==null,37113),h=f.keys(),c.mutationQueue.removeMutationBatch(d,f))).next(()=>c.mutationQueue.performConsistencyCheck(d)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(d,h,a)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(d,h)).next(()=>c.localDocuments.getDocuments(d,h))})}(r.localStore,e);XC(r,e,n),YC(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await ou(r,s)}catch(s){await Co(s)}}function YC(t,e){(t.mu.get(e)||[]).forEach(n=>{n.resolve()}),t.mu.delete(e)}function XC(t,e,n){const r=Ee(t);let s=r.Vu[r.currentUser.toKey()];if(s){const i=s.get(e);i&&(n?i.reject(n):i.resolve(),s=s.remove(e)),r.Vu[r.currentUser.toKey()]=s}}function wg(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Iu.get(e))t.Tu.delete(r),n&&t.Pu.yu(r,n);t.Iu.delete(e),t.isPrimaryClient&&t.Ru.jr(e).forEach(r=>{t.Ru.containsKey(r)||JC(t,r)})}function JC(t,e){t.Eu.delete(e.path.canonicalString());const n=t.du.get(e);n!==null&&(hv(t.remoteStore,n),t.du=t.du.remove(e),t.Au.delete(n),xv(t))}function OI(t,e,n){for(const r of n)r instanceof WC?(t.Ru.addReference(r.key,e),mM(t,r)):r instanceof GC?(W(Iv,"Document no longer in limbo: "+r.key),t.Ru.removeReference(r.key,e),t.Ru.containsKey(r.key)||JC(t,r.key)):ae(19791,{wu:r})}function mM(t,e){const n=e.key,r=n.path.canonicalString();t.du.get(n)||t.Eu.has(r)||(W(Iv,"New document in limbo: "+n),t.Eu.add(r),xv(t))}function xv(t){for(;t.Eu.size>0&&t.du.size<t.maxConcurrentLimboResolutions;){const e=t.Eu.values().next().value;t.Eu.delete(e);const n=new te(He.fromString(e)),r=t.fu.next();t.Au.set(r,new sM(n)),t.du=t.du.insert(n,r),UC(t.remoteStore,new as(ir(tu(n.path)),r,"TargetPurposeLimboResolution",rr.ce))}}async function ou(t,e,n){const r=Ee(t),s=[],i=[],o=[];r.Tu.isEmpty()||(r.Tu.forEach((a,c)=>{o.push(r.pu(c,e,n).then(d=>{var h;if((d||n)&&r.isPrimaryClient){const f=d?!d.fromCache:(h=n==null?void 0:n.targetChanges.get(c.targetId))==null?void 0:h.current;r.sharedClientState.updateQueryState(c.targetId,f?"current":"not-current")}if(d){s.push(d);const f=uv.As(c.targetId,d);i.push(f)}}))}),await Promise.all(o),r.Pu.H_(s),await async function(c,d){const h=Ee(c);try{await h.persistence.runTransaction("notifyLocalViewChanges","readwrite",f=>L.forEach(d,m=>L.forEach(m.Es,_=>h.persistence.referenceDelegate.addReference(f,m.targetId,_)).next(()=>L.forEach(m.ds,_=>h.persistence.referenceDelegate.removeReference(f,m.targetId,_)))))}catch(f){if(!Ti(f))throw f;W(dv,"Failed to update sequence numbers: "+f)}for(const f of d){const m=f.targetId;if(!f.fromCache){const _=h.Ms.get(m),R=_.snapshotVersion,C=_.withLastLimboFreeSnapshotVersion(R);h.Ms=h.Ms.insert(m,C)}}}(r.localStore,i))}async function gM(t,e){const n=Ee(t);if(!n.currentUser.isEqual(e)){W(Iv,"User change. New user:",e.toKey());const r=await OC(n.localStore,e);n.currentUser=e,function(i,o){i.mu.forEach(a=>{a.forEach(c=>{c.reject(new Q(z.CANCELLED,o))})}),i.mu.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await ou(n,r.Ls)}}function yM(t,e){const n=Ee(t),r=n.Au.get(e);if(r&&r.hu)return De().add(r.key);{let s=De();const i=n.Iu.get(e);if(!i)return s;for(const o of i){const a=n.Tu.get(o);s=s.unionWith(a.view.nu)}return s}}function ZC(t){const e=Ee(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=QC.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=yM.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=hM.bind(null,e),e.Pu.H_=eM.bind(null,e.eventManager),e.Pu.yu=tM.bind(null,e.eventManager),e}function eA(t){const e=Ee(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=fM.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=pM.bind(null,e),e}class Uc{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=_f(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,n){return null}Mu(e,n){return null}vu(e){return jC(this.persistence,new DC,e.initialUser,this.serializer)}Cu(e){return new lv(vf.mi,this.serializer)}Du(e){return new VC}async terminate(){var e,n;(e=this.gcScheduler)==null||e.stop(),(n=this.indexBackfillerScheduler)==null||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Uc.provider={build:()=>new Uc};class vM extends Uc{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,n){fe(this.persistence.referenceDelegate instanceof wh,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new AC(r,e.asyncQueue,n)}Cu(e){const n=this.cacheSizeBytes!==void 0?sn.withCacheSize(this.cacheSizeBytes):sn.DEFAULT;return new lv(r=>wh.mi(r,n),this.serializer)}}class _M extends Uc{constructor(e,n,r){super(),this.xu=e,this.cacheSizeBytes=n,this.forceOwnership=r,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.xu.initialize(this,e),await eA(this.xu.syncEngine),await iu(this.xu.remoteStore),await this.persistence.Ji(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}vu(e){return jC(this.persistence,new DC,e.initialUser,this.serializer)}Fu(e,n){const r=this.persistence.referenceDelegate.garbageCollector;return new AC(r,e.asyncQueue,n)}Mu(e,n){const r=new xO(n,this.persistence);return new IO(e.asyncQueue,r)}Cu(e){const n=_V(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?sn.withCacheSize(this.cacheSizeBytes):sn.DEFAULT;return new cv(this.synchronizeTabs,n,e.clientId,r,e.asyncQueue,jV(),bd(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Du(e){return new VC}}class Ih{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>jI(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=gM.bind(null,this.syncEngine),await XV(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new ZV}()}createDatastore(e){const n=_f(e.databaseInfo.databaseId),r=function(i){return new DV(i)}(e.databaseInfo);return function(i,o,a,c){return new MV(i,o,a,c)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,s,i,o,a){return new UV(r,s,i,o,a)}(this.localStore,this.datastore,e.asyncQueue,n=>jI(this.syncEngine,n,0),function(){return AI.v()?new AI:new RV}())}createSyncEngine(e,n){return function(s,i,o,a,c,d,h){const f=new iM(s,i,o,a,c,d);return h&&(f.gu=!0),f}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(s){const i=Ee(s);W(vo,"RemoteStore shutting down."),i.Ea.add(5),await su(i),i.Aa.shutdown(),i.Ra.set("Unknown")}(this.remoteStore),(e=this.datastore)==null||e.terminate(),(n=this.eventManager)==null||n.terminate()}}Ih.provider={build:()=>new Ih};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tv{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):mn("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yi="FirestoreClient";class wM{constructor(e,n,r,s,i){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=s,this.user=Yt.UNAUTHENTICATED,this.clientId=$y.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(r,async o=>{W(yi,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>(W(yi,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Er;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=yv(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function Dp(t,e){t.asyncQueue.verifyOperationInProgress(),W(yi,"Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async s=>{r.isEqual(s)||(await OC(e.localStore,s),r=s)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function LI(t,e){t.asyncQueue.verifyOperationInProgress();const n=await EM(t);W(yi,"Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>NI(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,s)=>NI(e.remoteStore,s)),t._onlineComponents=e}async function EM(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){W(yi,"Using user provided OfflineComponentProvider");try{await Dp(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(s){return s.name==="FirebaseError"?s.code===z.FAILED_PRECONDITION||s.code===z.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(n))throw n;co("Error using user provided cache. Falling back to memory cache: "+n),await Dp(t,new Uc)}}else W(yi,"Using default OfflineComponentProvider"),await Dp(t,new vM(void 0));return t._offlineComponents}async function bv(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(W(yi,"Using user provided OnlineComponentProvider"),await LI(t,t._uninitializedComponentsProvider._online)):(W(yi,"Using default OnlineComponentProvider"),await LI(t,new Ih))),t._onlineComponents}function IM(t){return bv(t).then(e=>e.syncEngine)}function xM(t){return bv(t).then(e=>e.datastore)}async function xh(t){const e=await bv(t),n=e.eventManager;return n.onListen=oM.bind(null,e.syncEngine),n.onUnlisten=cM.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=aM.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=uM.bind(null,e.syncEngine),n}function TM(t,e,n={}){const r=new Er;return t.asyncQueue.enqueueAndForget(async()=>function(i,o,a,c,d){const h=new Tv({next:m=>{h.Nu(),o.enqueueAndForget(()=>_v(i,f));const _=m.docs.has(a);!_&&m.fromCache?d.reject(new Q(z.UNAVAILABLE,"Failed to get document because the client is offline.")):_&&m.fromCache&&c&&c.source==="server"?d.reject(new Q(z.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):d.resolve(m)},error:m=>d.reject(m)}),f=new Ev(tu(a.path),h,{includeMetadataChanges:!0,qa:!0});return vv(i,f)}(await xh(t),t.asyncQueue,e,n,r)),r.promise}function bM(t,e,n={}){const r=new Er;return t.asyncQueue.enqueueAndForget(async()=>function(i,o,a,c,d){const h=new Tv({next:m=>{h.Nu(),o.enqueueAndForget(()=>_v(i,f)),m.fromCache&&c.source==="server"?d.reject(new Q(z.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):d.resolve(m)},error:m=>d.reject(m)}),f=new Ev(a,h,{includeMetadataChanges:!0,qa:!0});return vv(i,f)}(await xh(t),t.asyncQueue,e,n,r)),r.promise}function SM(t,e,n){const r=new Er;return t.asyncQueue.enqueueAndForget(async()=>{try{const s=await xM(t);r.resolve(async function(o,a,c){var C;const d=Ee(o),{request:h,gt:f,parent:m}=FL(d.serializer,dL(a),c);d.connection.$o||delete h.parent;const _=(await d.Ho("RunAggregationQuery",d.serializer.databaseId,m,h,1)).filter(N=>!!N.result);fe(_.length===1,64727);const R=(C=_[0].result)==null?void 0:C.aggregateFields;return Object.keys(R).reduce((N,T)=>(N[f[T]]=R[T],N),{})}(s,e,n))}catch(s){r.reject(s)}}),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tA(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VI=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nA="firestore.googleapis.com",MI=!0;class FI{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new Q(z.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=nA,this.ssl=MI}else this.host=e.host,this.ssl=e.ssl??MI;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=TC;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<nV)throw new Q(z.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}yO("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=tA(e.experimentalLongPollingOptions??{}),function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new Q(z.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new Q(z.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new Q(z.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,s){return r.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Ef{constructor(e,n,r,s){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new FI({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Q(z.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Q(z.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new FI(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new aO;switch(r.type){case"firstParty":return new dO(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new Q(z.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=VI.get(n);r&&(W("ComponentProvider","Removing Datastore"),VI.delete(n),r.terminate())}(this),Promise.resolve()}}function CM(t,e,n,r={}){var d;t=cn(t,Ef);const s=Ei(e),i=t._getSettings(),o={...i,emulatorOptions:t._getEmulatorOptions()},a=`${e}:${n}`;s&&(Sy(`https://${a}`),Cy("Firestore",!0)),i.host!==nA&&i.host!==a&&co("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const c={...i,host:a,ssl:s,emulatorOptions:r};if(!ms(c,o)&&(t._setSettings(c),r.mockUserToken)){let h,f;if(typeof r.mockUserToken=="string")h=r.mockUserToken,f=Yt.MOCK_USER;else{h=d0(r.mockUserToken,(d=t._app)==null?void 0:d.options.projectId);const m=r.mockUserToken.sub||r.mockUserToken.user_id;if(!m)throw new Q(z.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");f=new Yt(m)}t._authCredentials=new lO(new uS(h,f))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ar{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new Ar(this.firestore,e,this._query)}}class It{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new ci(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new It(this.firestore,e,this._key)}toJSON(){return{type:It._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,n,r){if(Jc(n,It._jsonSchema))return new It(e,r||null,new te(He.fromString(n.referencePath)))}}It._jsonSchemaVersion="firestore/documentReference/1.0",It._jsonSchema={type:kt("string",It._jsonSchemaVersion),referencePath:kt("string")};class ci extends Ar{constructor(e,n,r){super(e,n,tu(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new It(this.firestore,null,new te(e))}withConverter(e){return new ci(this.firestore,e,this._path)}}function Pe(t,e,...n){if(t=Qe(t),hS("collection","path",e),t instanceof Ef){const r=He.fromString(e,...n);return RE(r),new ci(t,null,r)}{if(!(t instanceof It||t instanceof ci))throw new Q(z.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(He.fromString(e,...n));return RE(r),new ci(t.firestore,null,r)}}function mt(t,e,...n){if(t=Qe(t),arguments.length===1&&(e=$y.newId()),hS("doc","path",e),t instanceof Ef){const r=He.fromString(e,...n);return AE(r),new It(t,null,new te(r))}{if(!(t instanceof It||t instanceof ci))throw new Q(z.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(He.fromString(e,...n));return AE(r),new It(t.firestore,t instanceof ci?t.converter:null,new te(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UI="AsyncQueue";class $I{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new MC(this,"async_queue_retry"),this._c=()=>{const r=bd();r&&W(UI,"Visibility state changed to "+r.visibilityState),this.M_.w_()},this.ac=e;const n=bd();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const n=bd();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});const n=new Er;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Xu.push(e),this.lc()))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!Ti(e))throw e;W(UI,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){const n=this.ac.then(()=>(this.rc=!0,e().catch(r=>{throw this.nc=r,this.rc=!1,mn("INTERNAL UNHANDLED ERROR: ",BI(r)),r}).then(r=>(this.rc=!1,r))));return this.ac=n,n}enqueueAfterDelay(e,n,r){this.uc(),this.oc.indexOf(e)>-1&&(n=0);const s=gv.createAndSchedule(this,e,n,r,i=>this.hc(i));return this.tc.push(s),s}uc(){this.nc&&ae(47125,{Pc:BI(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const n of this.tc)if(n.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.tc)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.Tc()})}dc(e){this.oc.push(e)}hc(e){const n=this.tc.indexOf(e);this.tc.splice(n,1)}}function BI(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zI(t){return function(n,r){if(typeof n!="object"||n===null)return!1;const s=n;for(const i of r)if(i in s&&typeof s[i]=="function")return!0;return!1}(t,["next","error","complete"])}class br extends Ef{constructor(e,n,r,s){super(e,n,r,s),this.type="firestore",this._queue=new $I,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new $I(e),this._firestoreClient=void 0,await e}}}function rA(t,e){const n=typeof t=="object"?t:Qh(),r=typeof t=="string"?t:dh,s=Ii(n,"firestore").getImmediate({identifier:r});if(!s._initialized){const i=l0("firestore");i&&CM(s,...i)}return s}function au(t){if(t._terminated)throw new Q(z.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||sA(t),t._firestoreClient}function sA(t){var r,s,i;const e=t._freezeSettings(),n=function(a,c,d,h){return new ZO(a,c,d,h.host,h.ssl,h.experimentalForceLongPolling,h.experimentalAutoDetectLongPolling,tA(h.experimentalLongPollingOptions),h.useFetchStreams,h.isUsingEmulator)}(t._databaseId,((r=t._app)==null?void 0:r.options.appId)||"",t._persistenceKey,e);t._componentsProvider||(s=e.localCache)!=null&&s._offlineComponentProvider&&((i=e.localCache)!=null&&i._onlineComponentProvider)&&(t._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),t._firestoreClient=new wM(t._authCredentials,t._appCheckCredentials,t._queue,n,t._componentsProvider&&function(a){const c=a==null?void 0:a._online.build();return{_offline:a==null?void 0:a._offline.build(c),_online:c}}(t._componentsProvider))}function AM(t,e){co("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const n=t._freezeSettings();return RM(t,Ih.provider,{build:r=>new _M(r,n.cacheSizeBytes,e==null?void 0:e.forceOwnership)}),Promise.resolve()}function RM(t,e,n){if((t=cn(t,br))._firestoreClient||t._terminated)throw new Q(z.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(t._componentsProvider||t._getSettings().localCache)throw new Q(z.FAILED_PRECONDITION,"SDK cache is already specified.");t._componentsProvider={_online:e,_offline:n},sA(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NM{constructor(e="count",n){this._internalFieldPath=n,this.type="AggregateField",this.aggregateType=e}}class PM{constructor(e,n,r){this._userDataWriter=n,this._data=r,this.type="AggregateQuerySnapshot",this.query=e}data(){return this._userDataWriter.convertObjectMap(this._data)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tr{constructor(e){this._byteString=e}static fromBase64String(e){try{return new tr(Dt.fromBase64String(e))}catch(n){throw new Q(z.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new tr(Dt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:tr._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Jc(e,tr._jsonSchema))return tr.fromBase64String(e.bytes)}}tr._jsonSchemaVersion="firestore/bytes/1.0",tr._jsonSchema={type:kt("string",tr._jsonSchemaVersion),bytes:kt("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class If{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new Q(z.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new gt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tl{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kr{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new Q(z.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new Q(z.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return xe(this._lat,e._lat)||xe(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Kr._jsonSchemaVersion}}static fromJSON(e){if(Jc(e,Kr._jsonSchema))return new Kr(e.latitude,e.longitude)}}Kr._jsonSchemaVersion="firestore/geoPoint/1.0",Kr._jsonSchema={type:kt("string",Kr._jsonSchemaVersion),latitude:kt("number"),longitude:kt("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qr{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,s){if(r.length!==s.length)return!1;for(let i=0;i<r.length;++i)if(r[i]!==s[i])return!1;return!0}(this._values,e._values)}toJSON(){return{type:Qr._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Jc(e,Qr._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(n=>typeof n=="number"))return new Qr(e.vectorValues);throw new Q(z.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Qr._jsonSchemaVersion="firestore/vectorValue/1.0",Qr._jsonSchema={type:kt("string",Qr._jsonSchemaVersion),vectorValues:kt("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kM=/^__.*__$/;class DM{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new xs(e,this.data,this.fieldMask,n,this.fieldTransforms):new Za(e,this.data,n,this.fieldTransforms)}}class iA{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new xs(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function oA(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw ae(40011,{Ac:t})}}class xf{constructor(e,n,r,s,i,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=s,i===void 0&&this.Rc(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new xf({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){var s;const n=(s=this.path)==null?void 0:s.child(e),r=this.Vc({path:n,fc:!1});return r.gc(e),r}yc(e){var s;const n=(s=this.path)==null?void 0:s.child(e),r=this.Vc({path:n,fc:!1});return r.Rc(),r}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return Th(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(oA(this.Ac)&&kM.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class jM{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||_f(e)}Cc(e,n,r,s=!1){return new xf({Ac:e,methodName:n,Dc:r,path:gt.emptyPath(),fc:!1,bc:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function lu(t){const e=t._freezeSettings(),n=_f(t._databaseId);return new jM(t._databaseId,!!e.ignoreUndefinedProperties,n)}function aA(t,e,n,r,s,i={}){const o=t.Cc(i.merge||i.mergeFields?2:0,e,n,s);Rv("Data must be an object, but it was:",o,r);const a=cA(r,o);let c,d;if(i.merge)c=new An(o.fieldMask),d=o.fieldTransforms;else if(i.mergeFields){const h=[];for(const f of i.mergeFields){const m=Eg(e,f,n);if(!o.contains(m))throw new Q(z.INVALID_ARGUMENT,`Field '${m}' is specified in your field mask but missing from your input data.`);dA(h,m)||h.push(m)}c=new An(h),d=o.fieldTransforms.filter(f=>c.covers(f.field))}else c=null,d=o.fieldTransforms;return new DM(new an(a),c,d)}class Tf extends tl{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Tf}}function OM(t,e,n){return new xf({Ac:3,Dc:e.settings.Dc,methodName:t._methodName,fc:n},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class Sv extends tl{_toFieldTransform(e){return new hf(e.path,new Ma)}isEqual(e){return e instanceof Sv}}class Cv extends tl{constructor(e,n){super(e),this.vc=n}_toFieldTransform(e){const n=OM(this,e,!0),r=this.vc.map(i=>nl(i,n)),s=new po(r);return new hf(e.path,s)}isEqual(e){return e instanceof Cv&&ms(this.vc,e.vc)}}class Av extends tl{constructor(e,n){super(e),this.Fc=n}_toFieldTransform(e){const n=new Ua(e.serializer,JS(e.serializer,this.Fc));return new hf(e.path,n)}isEqual(e){return e instanceof Av&&this.Fc===e.Fc}}function LM(t,e,n,r){const s=t.Cc(1,e,n);Rv("Data must be an object, but it was:",s,r);const i=[],o=an.empty();bi(r,(c,d)=>{const h=Nv(e,c,n);d=Qe(d);const f=s.yc(h);if(d instanceof Tf)i.push(h);else{const m=nl(d,f);m!=null&&(i.push(h),o.set(h,m))}});const a=new An(i);return new iA(o,a,s.fieldTransforms)}function VM(t,e,n,r,s,i){const o=t.Cc(1,e,n),a=[Eg(e,r,n)],c=[s];if(i.length%2!=0)throw new Q(z.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let m=0;m<i.length;m+=2)a.push(Eg(e,i[m])),c.push(i[m+1]);const d=[],h=an.empty();for(let m=a.length-1;m>=0;--m)if(!dA(d,a[m])){const _=a[m];let R=c[m];R=Qe(R);const C=o.yc(_);if(R instanceof Tf)d.push(_);else{const N=nl(R,C);N!=null&&(d.push(_),h.set(_,N))}}const f=new An(d);return new iA(h,f,o.fieldTransforms)}function lA(t,e,n,r=!1){return nl(n,t.Cc(r?4:3,e))}function nl(t,e){if(uA(t=Qe(t)))return Rv("Unsupported field value:",e,t),cA(t,e);if(t instanceof tl)return function(r,s){if(!oA(s.Ac))throw s.Sc(`${r._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Sc(`${r._methodName}() is not currently supported inside arrays`);const i=r._toFieldTransform(s);i&&s.fieldTransforms.push(i)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return function(r,s){const i=[];let o=0;for(const a of r){let c=nl(a,s.wc(o));c==null&&(c={nullValue:"NULL_VALUE"}),i.push(c),o++}return{arrayValue:{values:i}}}(t,e)}return function(r,s){if((r=Qe(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return JS(s.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const i=ze.fromDate(r);return{timestampValue:$a(s.serializer,i)}}if(r instanceof ze){const i=new ze(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:$a(s.serializer,i)}}if(r instanceof Kr)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof tr)return{bytesValue:cC(s.serializer,r._byteString)};if(r instanceof It){const i=s.databaseId,o=r.firestore._databaseId;if(!o.isEqual(i))throw s.Sc(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:rv(r.firestore._databaseId||s.databaseId,r._key.path)}}if(r instanceof Qr)return function(o,a){return{mapValue:{fields:{[Ky]:{stringValue:Qy},[Oa]:{arrayValue:{values:o.toArray().map(d=>{if(typeof d!="number")throw a.Sc("VectorValues must only contain numeric values.");return Jy(a.serializer,d)})}}}}}}(r,s);throw s.Sc(`Unsupported field value: ${ef(r)}`)}(t,e)}function cA(t,e){const n={};return AS(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):bi(t,(r,s)=>{const i=nl(s,e.mc(r));i!=null&&(n[r]=i)}),{mapValue:{fields:n}}}function uA(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof ze||t instanceof Kr||t instanceof tr||t instanceof It||t instanceof tl||t instanceof Qr)}function Rv(t,e,n){if(!uA(n)||!fS(n)){const r=ef(n);throw r==="an object"?e.Sc(t+" a custom object"):e.Sc(t+" "+r)}}function Eg(t,e,n){if((e=Qe(e))instanceof If)return e._internalPath;if(typeof e=="string")return Nv(t,e);throw Th("Field path arguments must be of type string or ",t,!1,void 0,n)}const MM=new RegExp("[~\\*/\\[\\]]");function Nv(t,e,n){if(e.search(MM)>=0)throw Th(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new If(...e.split("."))._internalPath}catch{throw Th(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function Th(t,e,n,r,s){const i=r&&!r.isEmpty(),o=s!==void 0;let a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(i||o)&&(c+=" (found",i&&(c+=` in field ${r}`),o&&(c+=` in document ${s}`),c+=")"),new Q(z.INVALID_ARGUMENT,a+t+c)}function dA(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pv{constructor(e,n,r,s,i){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new It(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new FM(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(bf("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class FM extends Pv{data(){return super.data()}}function bf(t,e){return typeof e=="string"?Nv(t,e):e instanceof If?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hA(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new Q(z.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class kv{}class cu extends kv{}function st(t,e,...n){let r=[];e instanceof kv&&r.push(e),r=r.concat(n),function(i){const o=i.filter(c=>c instanceof Dv).length,a=i.filter(c=>c instanceof Sf).length;if(o>1||o>0&&a>0)throw new Q(z.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const s of r)t=s._apply(t);return t}class Sf extends cu{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new Sf(e,n,r)}_apply(e){const n=this._parse(e);return pA(e._query,n),new Ar(e.firestore,e.converter,cg(e._query,n))}_parse(e){const n=lu(e.firestore);return function(i,o,a,c,d,h,f){let m;if(d.isKeyField()){if(h==="array-contains"||h==="array-contains-any")throw new Q(z.INVALID_ARGUMENT,`Invalid Query. You can't perform '${h}' queries on documentId().`);if(h==="in"||h==="not-in"){GI(f,h);const R=[];for(const C of f)R.push(WI(c,i,C));m={arrayValue:{values:R}}}else m=WI(c,i,f)}else h!=="in"&&h!=="not-in"&&h!=="array-contains-any"||GI(f,h),m=lA(a,o,f,h==="in"||h==="not-in");return Ue.create(d,h,m)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function Xe(t,e,n){const r=e,s=bf("where",t);return Sf._create(s,r,n)}class Dv extends kv{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new Dv(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:Je.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(s,i){let o=s;const a=i.getFlattenedFilters();for(const c of a)pA(o,c),o=cg(o,c)}(e._query,n),new Ar(e.firestore,e.converter,cg(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class jv extends cu{constructor(e,n){super(),this._field=e,this._direction=n,this.type="orderBy"}static _create(e,n){return new jv(e,n)}_apply(e){const n=function(s,i,o){if(s.startAt!==null)throw new Q(z.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(s.endAt!==null)throw new Q(z.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Fc(i,o)}(e._query,this._field,this._direction);return new Ar(e.firestore,e.converter,function(s,i){const o=s.explicitOrderBy.concat([i]);return new Si(s.path,s.collectionGroup,o,s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt)}(e._query,n))}}function gn(t,e="asc"){const n=e,r=bf("orderBy",t);return jv._create(r,n)}class Ov extends cu{constructor(e,n,r){super(),this.type=e,this._limit=n,this._limitType=r}static _create(e,n,r){return new Ov(e,n,r)}_apply(e){return new Ar(e.firestore,e.converter,ph(e._query,this._limit,this._limitType))}}function wa(t){return vO("limit",t),Ov._create("limit",t,"F")}class Cf extends cu{constructor(e,n,r){super(),this.type=e,this._docOrFields=n,this._inclusive=r}static _create(e,n,r){return new Cf(e,n,r)}_apply(e){const n=fA(e,this.type,this._docOrFields,this._inclusive);return new Ar(e.firestore,e.converter,function(s,i){return new Si(s.path,s.collectionGroup,s.explicitOrderBy.slice(),s.filters.slice(),s.limit,s.limitType,i,s.endAt)}(e._query,n))}}function qI(...t){return Cf._create("startAt",t,!0)}function UM(...t){return Cf._create("startAfter",t,!1)}class Lv extends cu{constructor(e,n,r){super(),this.type=e,this._docOrFields=n,this._inclusive=r}static _create(e,n,r){return new Lv(e,n,r)}_apply(e){const n=fA(e,this.type,this._docOrFields,this._inclusive);return new Ar(e.firestore,e.converter,function(s,i){return new Si(s.path,s.collectionGroup,s.explicitOrderBy.slice(),s.filters.slice(),s.limit,s.limitType,s.startAt,i)}(e._query,n))}}function HI(...t){return Lv._create("endAt",t,!0)}function fA(t,e,n,r){if(n[0]=Qe(n[0]),n[0]instanceof Pv)return function(i,o,a,c,d){if(!c)throw new Q(z.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${a}().`);const h=[];for(const f of va(i))if(f.field.isKeyField())h.push(ho(o,c.key));else{const m=c.data.field(f.field);if(af(m))throw new Q(z.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+f.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(m===null){const _=f.field.canonicalString();throw new Q(z.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${_}' (used as the orderBy) does not exist.`)}h.push(m)}return new mi(h,d)}(t._query,t.firestore._databaseId,e,n[0]._document,r);{const s=lu(t.firestore);return function(o,a,c,d,h,f){const m=o.explicitOrderBy;if(h.length>m.length)throw new Q(z.INVALID_ARGUMENT,`Too many arguments provided to ${d}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const _=[];for(let R=0;R<h.length;R++){const C=h[R];if(m[R].field.isKeyField()){if(typeof C!="string")throw new Q(z.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${d}(), but got a ${typeof C}`);if(!Xy(o)&&C.indexOf("/")!==-1)throw new Q(z.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${d}() must be a plain document ID, but '${C}' contains a slash.`);const N=o.path.child(He.fromString(C));if(!te.isDocumentKey(N))throw new Q(z.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${d}() must result in a valid document path, but '${N}' is not because it contains an odd number of segments.`);const T=new te(N);_.push(ho(a,T))}else{const N=lA(c,d,C);_.push(N)}}return new mi(_,f)}(t._query,t.firestore._databaseId,s,e,n,r)}}function WI(t,e,n){if(typeof(n=Qe(n))=="string"){if(n==="")throw new Q(z.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Xy(e)&&n.indexOf("/")!==-1)throw new Q(z.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(He.fromString(n));if(!te.isDocumentKey(r))throw new Q(z.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return ho(t,new te(r))}if(n instanceof It)return ho(t,n._key);throw new Q(z.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${ef(n)}.`)}function GI(t,e){if(!Array.isArray(t)||t.length===0)throw new Q(z.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function pA(t,e){const n=function(s,i){for(const o of s)for(const a of o.getFlattenedFilters())if(i.indexOf(a.op)>=0)return a.op;return null}(t.filters,function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new Q(z.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new Q(z.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class $M{convertValue(e,n="none"){switch(fi(e)){case 0:return null;case 1:return e.booleanValue;case 2:return ut(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(_s(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw ae(62114,{value:e})}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return bi(e,(s,i)=>{r[s]=this.convertValue(i,n)}),r}convertVectorValue(e){var r,s,i;const n=(i=(s=(r=e.fields)==null?void 0:r[Oa].arrayValue)==null?void 0:s.values)==null?void 0:i.map(o=>ut(o.doubleValue));return new Qr(n)}convertGeoPoint(e){return new Kr(ut(e.latitude),ut(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=lf(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(Lc(e));default:return null}}convertTimestamp(e){const n=vs(e);return new ze(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=He.fromString(e);fe(vC(r),9688,{name:e});const s=new uo(r.get(1),r.get(3)),i=new te(r.popFirst(5));return s.isEqual(n)||mn(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mA(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}function BM(){return new NM("count")}class $l{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Zi extends Pv{constructor(e,n,r,s,i,o){super(e,n,r,s,o),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new Sd(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(bf("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Q(z.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,n={};return n.type=Zi._jsonSchemaVersion,n.bundle="",n.bundleSource="DocumentSnapshot",n.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?n:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),n.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),n)}}Zi._jsonSchemaVersion="firestore/documentSnapshot/1.0",Zi._jsonSchema={type:kt("string",Zi._jsonSchemaVersion),bundleSource:kt("string","DocumentSnapshot"),bundleName:kt("string"),bundle:kt("string")};class Sd extends Zi{data(e={}){return super.data(e)}}class eo{constructor(e,n,r,s){this._firestore=e,this._userDataWriter=n,this._snapshot=s,this.metadata=new $l(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new Sd(this._firestore,this._userDataWriter,r.key,r,new $l(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new Q(z.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(s,i){if(s._snapshot.oldDocs.isEmpty()){let o=0;return s._snapshot.docChanges.map(a=>{const c=new Sd(s._firestore,s._userDataWriter,a.doc.key,a.doc,new $l(s._snapshot.mutatedKeys.has(a.doc.key),s._snapshot.fromCache),s.query.converter);return a.doc,{type:"added",doc:c,oldIndex:-1,newIndex:o++}})}{let o=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(a=>i||a.type!==3).map(a=>{const c=new Sd(s._firestore,s._userDataWriter,a.doc.key,a.doc,new $l(s._snapshot.mutatedKeys.has(a.doc.key),s._snapshot.fromCache),s.query.converter);let d=-1,h=-1;return a.type!==0&&(d=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),h=o.indexOf(a.doc.key)),{type:zM(a.type),doc:c,oldIndex:d,newIndex:h}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Q(z.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=eo._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=$y.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const n=[],r=[],s=[];return this.docs.forEach(i=>{i._document!==null&&(n.push(i._document),r.push(this._userDataWriter.convertObjectMap(i._document.data.value.mapValue.fields,"previous")),s.push(i.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function zM(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return ae(61501,{type:t})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function za(t){t=cn(t,It);const e=cn(t.firestore,br);return TM(au(e),t._key).then(n=>gA(e,t,n))}eo._jsonSchemaVersion="firestore/querySnapshot/1.0",eo._jsonSchema={type:kt("string",eo._jsonSchemaVersion),bundleSource:kt("string","QuerySnapshot"),bundleName:kt("string"),bundle:kt("string")};class Af extends $M{constructor(e){super(),this.firestore=e}convertBytes(e){return new tr(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new It(this.firestore,null,n)}}function Vt(t){t=cn(t,Ar);const e=cn(t.firestore,br),n=au(e),r=new Af(e);return hA(t._query),bM(n,t._query).then(s=>new eo(e,r,t,s))}function bh(t,e,n){t=cn(t,It);const r=cn(t.firestore,br),s=mA(t.converter,e,n);return Nf(r,[aA(lu(r),"setDoc",t._key,s,t.converter!==null,n).toMutation(t._key,ln.none())])}function ui(t,e,n,...r){t=cn(t,It);const s=cn(t.firestore,br),i=lu(s);let o;return o=typeof(e=Qe(e))=="string"||e instanceof If?VM(i,"updateDoc",t._key,e,n,r):LM(i,"updateDoc",t._key,e),Nf(s,[o.toMutation(t._key,ln.exists(!0))])}function Rf(t){return Nf(cn(t.firestore,br),[new pf(t._key,ln.none())])}function Br(t,e){const n=cn(t.firestore,br),r=mt(t),s=mA(t.converter,e);return Nf(n,[aA(lu(t.firestore),"addDoc",r._key,s,t.converter!==null,{}).toMutation(r._key,ln.exists(!1))]).then(()=>r)}function Un(t,...e){var c,d,h;t=Qe(t);let n={includeMetadataChanges:!1,source:"default"},r=0;typeof e[r]!="object"||zI(e[r])||(n=e[r++]);const s={includeMetadataChanges:n.includeMetadataChanges,source:n.source};if(zI(e[r])){const f=e[r];e[r]=(c=f.next)==null?void 0:c.bind(f),e[r+1]=(d=f.error)==null?void 0:d.bind(f),e[r+2]=(h=f.complete)==null?void 0:h.bind(f)}let i,o,a;if(t instanceof It)o=cn(t.firestore,br),a=tu(t._key.path),i={next:f=>{e[r]&&e[r](gA(o,t,f))},error:e[r+1],complete:e[r+2]};else{const f=cn(t,Ar);o=cn(f.firestore,br),a=f._query;const m=new Af(o);i={next:_=>{e[r]&&e[r](new eo(o,m,f,_))},error:e[r+1],complete:e[r+2]},hA(t._query)}return function(m,_,R,C){const N=new Tv(C),T=new Ev(_,N,R);return m.asyncQueue.enqueueAndForget(async()=>vv(await xh(m),T)),()=>{N.Nu(),m.asyncQueue.enqueueAndForget(async()=>_v(await xh(m),T))}}(au(o),a,s,i)}function Nf(t,e){return function(r,s){const i=new Er;return r.asyncQueue.enqueueAndForget(async()=>dM(await IM(r),s,i)),i.promise}(au(t),e)}function gA(t,e,n){const r=n.docs.get(e._key),s=new Af(t);return new Zi(t,s,e._key,r,new $l(n.hasPendingWrites,n.fromCache),e.converter)}function qM(t){return HM(t,{count:BM()})}function HM(t,e){const n=cn(t.firestore,br),r=au(n),s=XO(e,(i,o)=>new bL(o,i.aggregateType,i._internalFieldPath));return SM(r,t._query,s).then(i=>function(a,c,d){const h=new Af(a);return new PM(c,h,d)}(n,t,i))}function Xn(){return new Sv("serverTimestamp")}function WM(...t){return new Cv("arrayUnion",t)}function KI(t){return new Av("increment",t)}(function(e,n=!0){(function(s){Ja=s})(bo),xr(new cr("firestore",(r,{instanceIdentifier:s,options:i})=>{const o=r.getProvider("app").getImmediate(),a=new br(new cO(r.getProvider("auth-internal")),new hO(o,r.getProvider("app-check-internal")),function(d,h){if(!Object.prototype.hasOwnProperty.apply(d.options,["projectId"]))throw new Q(z.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new uo(d.options.projectId,h)}(o,s),o);return i={useFetchStreams:n,...i},a._setSettings(i),a},"PUBLIC").setMultipleInstances(!0)),kn(TE,bE,e),kn(TE,bE,"esm2020")})();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yA="firebasestorage.googleapis.com",vA="storageBucket",GM=2*60*1e3,KM=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tt extends ur{constructor(e,n,r=0){super(jp(e),`Firebase Storage: ${n} (${jp(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Tt.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return jp(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var xt;(function(t){t.UNKNOWN="unknown",t.OBJECT_NOT_FOUND="object-not-found",t.BUCKET_NOT_FOUND="bucket-not-found",t.PROJECT_NOT_FOUND="project-not-found",t.QUOTA_EXCEEDED="quota-exceeded",t.UNAUTHENTICATED="unauthenticated",t.UNAUTHORIZED="unauthorized",t.UNAUTHORIZED_APP="unauthorized-app",t.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",t.INVALID_CHECKSUM="invalid-checksum",t.CANCELED="canceled",t.INVALID_EVENT_NAME="invalid-event-name",t.INVALID_URL="invalid-url",t.INVALID_DEFAULT_BUCKET="invalid-default-bucket",t.NO_DEFAULT_BUCKET="no-default-bucket",t.CANNOT_SLICE_BLOB="cannot-slice-blob",t.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",t.NO_DOWNLOAD_URL="no-download-url",t.INVALID_ARGUMENT="invalid-argument",t.INVALID_ARGUMENT_COUNT="invalid-argument-count",t.APP_DELETED="app-deleted",t.INVALID_ROOT_OPERATION="invalid-root-operation",t.INVALID_FORMAT="invalid-format",t.INTERNAL_ERROR="internal-error",t.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(xt||(xt={}));function jp(t){return"storage/"+t}function Vv(){const t="An unknown error occurred, please check the error payload for server response.";return new Tt(xt.UNKNOWN,t)}function QM(t){return new Tt(xt.OBJECT_NOT_FOUND,"Object '"+t+"' does not exist.")}function YM(t){return new Tt(xt.QUOTA_EXCEEDED,"Quota for bucket '"+t+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function XM(){const t="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new Tt(xt.UNAUTHENTICATED,t)}function JM(){return new Tt(xt.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function ZM(t){return new Tt(xt.UNAUTHORIZED,"User does not have permission to access '"+t+"'.")}function eF(){return new Tt(xt.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function tF(){return new Tt(xt.CANCELED,"User canceled the upload/download.")}function nF(t){return new Tt(xt.INVALID_URL,"Invalid URL '"+t+"'.")}function rF(t){return new Tt(xt.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}function sF(){return new Tt(xt.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+vA+"' property when initializing the app?")}function iF(){return new Tt(xt.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function oF(){return new Tt(xt.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function aF(t){return new Tt(xt.UNSUPPORTED_ENVIRONMENT,`${t} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function Ig(t){return new Tt(xt.INVALID_ARGUMENT,t)}function _A(){return new Tt(xt.APP_DELETED,"The Firebase app was deleted.")}function lF(t){return new Tt(xt.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function lc(t,e){return new Tt(xt.INVALID_FORMAT,"String does not match format '"+t+"': "+e)}function Cl(t){throw new Tt(xt.INTERNAL_ERROR,"Internal error: "+t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yn{constructor(e,n){this.bucket=e,this.path_=n}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,n){let r;try{r=yn.makeFromUrl(e,n)}catch{return new yn(e,"")}if(r.path==="")return r;throw rF(e)}static makeFromUrl(e,n){let r=null;const s="([A-Za-z0-9.\\-_]+)";function i(E){E.path.charAt(E.path.length-1)==="/"&&(E.path_=E.path_.slice(0,-1))}const o="(/(.*))?$",a=new RegExp("^gs://"+s+o,"i"),c={bucket:1,path:3};function d(E){E.path_=decodeURIComponent(E.path)}const h="v[A-Za-z0-9_]+",f=n.replace(/[.]/g,"\\."),m="(/([^?#]*).*)?$",_=new RegExp(`^https?://${f}/${h}/b/${s}/o${m}`,"i"),R={bucket:1,path:3},C=n===yA?"(?:storage.googleapis.com|storage.cloud.google.com)":n,N="([^?#]*)",T=new RegExp(`^https?://${C}/${s}/${N}`,"i"),v=[{regex:a,indices:c,postModify:i},{regex:_,indices:R,postModify:d},{regex:T,indices:{bucket:1,path:2},postModify:d}];for(let E=0;E<v.length;E++){const O=v[E],F=O.regex.exec(e);if(F){const x=F[O.indices.bucket];let I=F[O.indices.path];I||(I=""),r=new yn(x,I),O.postModify(r);break}}if(r==null)throw nF(e);return r}}class cF{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uF(t,e,n){let r=1,s=null,i=null,o=!1,a=0;function c(){return a===2}let d=!1;function h(...N){d||(d=!0,e.apply(null,N))}function f(N){s=setTimeout(()=>{s=null,t(_,c())},N)}function m(){i&&clearTimeout(i)}function _(N,...T){if(d){m();return}if(N){m(),h.call(null,N,...T);return}if(c()||o){m(),h.call(null,N,...T);return}r<64&&(r*=2);let v;a===1?(a=2,v=0):v=(r+Math.random())*1e3,f(v)}let R=!1;function C(N){R||(R=!0,m(),!d&&(s!==null?(N||(a=2),clearTimeout(s),f(0)):N||(a=1)))}return f(0),i=setTimeout(()=>{o=!0,C(!0)},n),C}function dF(t){t(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hF(t){return t!==void 0}function fF(t){return typeof t=="object"&&!Array.isArray(t)}function Mv(t){return typeof t=="string"||t instanceof String}function QI(t){return Fv()&&t instanceof Blob}function Fv(){return typeof Blob<"u"}function xg(t,e,n,r){if(r<e)throw Ig(`Invalid value for '${t}'. Expected ${e} or greater.`);if(r>n)throw Ig(`Invalid value for '${t}'. Expected ${n} or less.`)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uu(t,e,n){let r=e;return n==null&&(r=`https://${e}`),`${n}://${r}/v0${t}`}function wA(t){const e=encodeURIComponent;let n="?";for(const r in t)if(t.hasOwnProperty(r)){const s=e(r)+"="+e(t[r]);n=n+s+"&"}return n=n.slice(0,-1),n}var to;(function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"})(to||(to={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pF(t,e){const n=t>=500&&t<600,s=[408,429].indexOf(t)!==-1,i=e.indexOf(t)!==-1;return n||s||i}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mF{constructor(e,n,r,s,i,o,a,c,d,h,f,m=!0,_=!1){this.url_=e,this.method_=n,this.headers_=r,this.body_=s,this.successCodes_=i,this.additionalRetryCodes_=o,this.callback_=a,this.errorCallback_=c,this.timeout_=d,this.progressCallback_=h,this.connectionFactory_=f,this.retry=m,this.isUsingEmulator=_,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((R,C)=>{this.resolve_=R,this.reject_=C,this.start_()})}start_(){const e=(r,s)=>{if(s){r(!1,new Gu(!1,null,!0));return}const i=this.connectionFactory_();this.pendingConnection_=i;const o=a=>{const c=a.loaded,d=a.lengthComputable?a.total:-1;this.progressCallback_!==null&&this.progressCallback_(c,d)};this.progressCallback_!==null&&i.addUploadProgressListener(o),i.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&i.removeUploadProgressListener(o),this.pendingConnection_=null;const a=i.getErrorCode()===to.NO_ERROR,c=i.getStatus();if(!a||pF(c,this.additionalRetryCodes_)&&this.retry){const h=i.getErrorCode()===to.ABORT;r(!1,new Gu(!1,null,h));return}const d=this.successCodes_.indexOf(c)!==-1;r(!0,new Gu(d,i))})},n=(r,s)=>{const i=this.resolve_,o=this.reject_,a=s.connection;if(s.wasSuccessCode)try{const c=this.callback_(a,a.getResponse());hF(c)?i(c):i()}catch(c){o(c)}else if(a!==null){const c=Vv();c.serverResponse=a.getErrorText(),this.errorCallback_?o(this.errorCallback_(a,c)):o(c)}else if(s.canceled){const c=this.appDelete_?_A():tF();o(c)}else{const c=eF();o(c)}};this.canceled_?n(!1,new Gu(!1,null,!0)):this.backoffId_=uF(e,n,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&dF(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class Gu{constructor(e,n,r){this.wasSuccessCode=e,this.connection=n,this.canceled=!!r}}function gF(t,e){e!==null&&e.length>0&&(t.Authorization="Firebase "+e)}function yF(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function vF(t,e){e&&(t["X-Firebase-GMPID"]=e)}function _F(t,e){e!==null&&(t["X-Firebase-AppCheck"]=e)}function wF(t,e,n,r,s,i,o=!0,a=!1){const c=wA(t.urlParams),d=t.url+c,h=Object.assign({},t.headers);return vF(h,e),gF(h,n),yF(h,i),_F(h,r),new mF(d,t.method,h,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,s,o,a)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function EF(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function IF(...t){const e=EF();if(e!==void 0){const n=new e;for(let r=0;r<t.length;r++)n.append(t[r]);return n.getBlob()}else{if(Fv())return new Blob(t);throw new Tt(xt.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function xF(t,e,n){return t.webkitSlice?t.webkitSlice(e,n):t.mozSlice?t.mozSlice(e,n):t.slice?t.slice(e,n):null}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function TF(t){if(typeof atob>"u")throw aF("base-64");return atob(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zr={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class Op{constructor(e,n){this.data=e,this.contentType=n||null}}function bF(t,e){switch(t){case zr.RAW:return new Op(EA(e));case zr.BASE64:case zr.BASE64URL:return new Op(IA(t,e));case zr.DATA_URL:return new Op(CF(e),AF(e))}throw Vv()}function EA(t){const e=[];for(let n=0;n<t.length;n++){let r=t.charCodeAt(n);if(r<=127)e.push(r);else if(r<=2047)e.push(192|r>>6,128|r&63);else if((r&64512)===55296)if(!(n<t.length-1&&(t.charCodeAt(n+1)&64512)===56320))e.push(239,191,189);else{const i=r,o=t.charCodeAt(++n);r=65536|(i&1023)<<10|o&1023,e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|r&63)}else(r&64512)===56320?e.push(239,191,189):e.push(224|r>>12,128|r>>6&63,128|r&63)}return new Uint8Array(e)}function SF(t){let e;try{e=decodeURIComponent(t)}catch{throw lc(zr.DATA_URL,"Malformed data URL.")}return EA(e)}function IA(t,e){switch(t){case zr.BASE64:{const s=e.indexOf("-")!==-1,i=e.indexOf("_")!==-1;if(s||i)throw lc(t,"Invalid character '"+(s?"-":"_")+"' found: is it base64url encoded?");break}case zr.BASE64URL:{const s=e.indexOf("+")!==-1,i=e.indexOf("/")!==-1;if(s||i)throw lc(t,"Invalid character '"+(s?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let n;try{n=TF(e)}catch(s){throw s.message.includes("polyfill")?s:lc(t,"Invalid character found")}const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}class xA{constructor(e){this.base64=!1,this.contentType=null;const n=e.match(/^data:([^,]+)?,/);if(n===null)throw lc(zr.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const r=n[1]||null;r!=null&&(this.base64=RF(r,";base64"),this.contentType=this.base64?r.substring(0,r.length-7):r),this.rest=e.substring(e.indexOf(",")+1)}}function CF(t){const e=new xA(t);return e.base64?IA(zr.BASE64,e.rest):SF(e.rest)}function AF(t){return new xA(t).contentType}function RF(t,e){return t.length>=e.length?t.substring(t.length-e.length)===e:!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ws{constructor(e,n){let r=0,s="";QI(e)?(this.data_=e,r=e.size,s=e.type):e instanceof ArrayBuffer?(n?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),r=this.data_.length):e instanceof Uint8Array&&(n?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),r=e.length),this.size_=r,this.type_=s}size(){return this.size_}type(){return this.type_}slice(e,n){if(QI(this.data_)){const r=this.data_,s=xF(r,e,n);return s===null?null:new Ws(s)}else{const r=new Uint8Array(this.data_.buffer,e,n-e);return new Ws(r,!0)}}static getBlob(...e){if(Fv()){const n=e.map(r=>r instanceof Ws?r.data_:r);return new Ws(IF.apply(null,n))}else{const n=e.map(o=>Mv(o)?bF(zr.RAW,o).data:o.data_);let r=0;n.forEach(o=>{r+=o.byteLength});const s=new Uint8Array(r);let i=0;return n.forEach(o=>{for(let a=0;a<o.length;a++)s[i++]=o[a]}),new Ws(s,!0)}}uploadData(){return this.data_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Uv(t){let e;try{e=JSON.parse(t)}catch{return null}return fF(e)?e:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NF(t){if(t.length===0)return null;const e=t.lastIndexOf("/");return e===-1?"":t.slice(0,e)}function PF(t,e){const n=e.split("/").filter(r=>r.length>0).join("/");return t.length===0?n:t+"/"+n}function TA(t){const e=t.lastIndexOf("/",t.length-2);return e===-1?t:t.slice(e+1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kF(t,e){return e}class fn{constructor(e,n,r,s){this.server=e,this.local=n||e,this.writable=!!r,this.xform=s||kF}}let Ku=null;function DF(t){return!Mv(t)||t.length<2?t:TA(t)}function bA(){if(Ku)return Ku;const t=[];t.push(new fn("bucket")),t.push(new fn("generation")),t.push(new fn("metageneration")),t.push(new fn("name","fullPath",!0));function e(i,o){return DF(o)}const n=new fn("name");n.xform=e,t.push(n);function r(i,o){return o!==void 0?Number(o):o}const s=new fn("size");return s.xform=r,t.push(s),t.push(new fn("timeCreated")),t.push(new fn("updated")),t.push(new fn("md5Hash",null,!0)),t.push(new fn("cacheControl",null,!0)),t.push(new fn("contentDisposition",null,!0)),t.push(new fn("contentEncoding",null,!0)),t.push(new fn("contentLanguage",null,!0)),t.push(new fn("contentType",null,!0)),t.push(new fn("metadata","customMetadata",!0)),Ku=t,Ku}function jF(t,e){function n(){const r=t.bucket,s=t.fullPath,i=new yn(r,s);return e._makeStorageReference(i)}Object.defineProperty(t,"ref",{get:n})}function OF(t,e,n){const r={};r.type="file";const s=n.length;for(let i=0;i<s;i++){const o=n[i];r[o.local]=o.xform(r,e[o.server])}return jF(r,t),r}function SA(t,e,n){const r=Uv(e);return r===null?null:OF(t,r,n)}function LF(t,e,n,r){const s=Uv(e);if(s===null||!Mv(s.downloadTokens))return null;const i=s.downloadTokens;if(i.length===0)return null;const o=encodeURIComponent;return i.split(",").map(d=>{const h=t.bucket,f=t.fullPath,m="/b/"+o(h)+"/o/"+o(f),_=uu(m,n,r),R=wA({alt:"media",token:d});return _+R})[0]}function VF(t,e){const n={},r=e.length;for(let s=0;s<r;s++){const i=e[s];i.writable&&(n[i.server]=t[i.local])}return JSON.stringify(n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YI="prefixes",XI="items";function MF(t,e,n){const r={prefixes:[],items:[],nextPageToken:n.nextPageToken};if(n[YI])for(const s of n[YI]){const i=s.replace(/\/$/,""),o=t._makeStorageReference(new yn(e,i));r.prefixes.push(o)}if(n[XI])for(const s of n[XI]){const i=t._makeStorageReference(new yn(e,s.name));r.items.push(i)}return r}function FF(t,e,n){const r=Uv(n);return r===null?null:MF(t,e,r)}class Pf{constructor(e,n,r,s){this.url=e,this.method=n,this.handler=r,this.timeout=s,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $v(t){if(!t)throw Vv()}function UF(t,e){function n(r,s){const i=SA(t,s,e);return $v(i!==null),i}return n}function $F(t,e){function n(r,s){const i=FF(t,e,s);return $v(i!==null),i}return n}function BF(t,e){function n(r,s){const i=SA(t,s,e);return $v(i!==null),LF(i,s,t.host,t._protocol)}return n}function Bv(t){function e(n,r){let s;return n.getStatus()===401?n.getErrorText().includes("Firebase App Check token is invalid")?s=JM():s=XM():n.getStatus()===402?s=YM(t.bucket):n.getStatus()===403?s=ZM(t.path):s=r,s.status=n.getStatus(),s.serverResponse=r.serverResponse,s}return e}function CA(t){const e=Bv(t);function n(r,s){let i=e(r,s);return r.getStatus()===404&&(i=QM(t.path)),i.serverResponse=s.serverResponse,i}return n}function zF(t,e,n,r,s){const i={};e.isRoot?i.prefix="":i.prefix=e.path+"/",n.length>0&&(i.delimiter=n),r&&(i.pageToken=r),s&&(i.maxResults=s);const o=e.bucketOnlyServerUrl(),a=uu(o,t.host,t._protocol),c="GET",d=t.maxOperationRetryTime,h=new Pf(a,c,$F(t,e.bucket),d);return h.urlParams=i,h.errorHandler=Bv(e),h}function qF(t,e,n){const r=e.fullServerUrl(),s=uu(r,t.host,t._protocol),i="GET",o=t.maxOperationRetryTime,a=new Pf(s,i,BF(t,n),o);return a.errorHandler=CA(e),a}function HF(t,e){const n=e.fullServerUrl(),r=uu(n,t.host,t._protocol),s="DELETE",i=t.maxOperationRetryTime;function o(c,d){}const a=new Pf(r,s,o,i);return a.successCodes=[200,204],a.errorHandler=CA(e),a}function WF(t,e){return t&&t.contentType||e&&e.type()||"application/octet-stream"}function GF(t,e,n){const r=Object.assign({},n);return r.fullPath=t.path,r.size=e.size(),r.contentType||(r.contentType=WF(null,e)),r}function KF(t,e,n,r,s){const i=e.bucketOnlyServerUrl(),o={"X-Goog-Upload-Protocol":"multipart"};function a(){let v="";for(let E=0;E<2;E++)v=v+Math.random().toString().slice(2);return v}const c=a();o["Content-Type"]="multipart/related; boundary="+c;const d=GF(e,r,s),h=VF(d,n),f="--"+c+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+h+`\r
--`+c+`\r
Content-Type: `+d.contentType+`\r
\r
`,m=`\r
--`+c+"--",_=Ws.getBlob(f,r,m);if(_===null)throw iF();const R={name:d.fullPath},C=uu(i,t.host,t._protocol),N="POST",T=t.maxUploadRetryTime,y=new Pf(C,N,UF(t,n),T);return y.urlParams=R,y.headers=o,y.body=_.uploadData(),y.errorHandler=Bv(e),y}class QF{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=to.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=to.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=to.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,n,r,s,i){if(this.sent_)throw Cl("cannot .send() more than once");if(Ei(e)&&r&&(this.xhr_.withCredentials=!0),this.sent_=!0,this.xhr_.open(n,e,!0),i!==void 0)for(const o in i)i.hasOwnProperty(o)&&this.xhr_.setRequestHeader(o,i[o].toString());return s!==void 0?this.xhr_.send(s):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw Cl("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw Cl("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw Cl("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw Cl("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class YF extends QF{initXhr(){this.xhr_.responseType="text"}}function kf(){return new YF}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _o{constructor(e,n){this._service=e,n instanceof yn?this._location=n:this._location=yn.makeFromUrl(n,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,n){return new _o(e,n)}get root(){const e=new yn(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return TA(this._location.path)}get storage(){return this._service}get parent(){const e=NF(this._location.path);if(e===null)return null;const n=new yn(this._location.bucket,e);return new _o(this._service,n)}_throwIfRoot(e){if(this._location.path==="")throw lF(e)}}function XF(t,e,n){t._throwIfRoot("uploadBytes");const r=KF(t.storage,t._location,bA(),new Ws(e,!0),n);return t.storage.makeRequestWithTokens(r,kf).then(s=>({metadata:s,ref:t}))}function JF(t){const e={prefixes:[],items:[]};return AA(t,e).then(()=>e)}async function AA(t,e,n){const s=await ZF(t,{pageToken:n});e.prefixes.push(...s.prefixes),e.items.push(...s.items),s.nextPageToken!=null&&await AA(t,e,s.nextPageToken)}function ZF(t,e){e!=null&&typeof e.maxResults=="number"&&xg("options.maxResults",1,1e3,e.maxResults);const n=e||{},r=zF(t.storage,t._location,"/",n.pageToken,n.maxResults);return t.storage.makeRequestWithTokens(r,kf)}function e4(t){t._throwIfRoot("getDownloadURL");const e=qF(t.storage,t._location,bA());return t.storage.makeRequestWithTokens(e,kf).then(n=>{if(n===null)throw oF();return n})}function t4(t){t._throwIfRoot("deleteObject");const e=HF(t.storage,t._location);return t.storage.makeRequestWithTokens(e,kf)}function n4(t,e){const n=PF(t._location.path,e),r=new yn(t._location.bucket,n);return new _o(t.storage,r)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function r4(t){return/^[A-Za-z]+:\/\//.test(t)}function s4(t,e){return new _o(t,e)}function RA(t,e){if(t instanceof zv){const n=t;if(n._bucket==null)throw sF();const r=new _o(n,n._bucket);return e!=null?RA(r,e):r}else return e!==void 0?n4(t,e):t}function i4(t,e){if(e&&r4(e)){if(t instanceof zv)return s4(t,e);throw Ig("To use ref(service, url), the first argument must be a Storage instance.")}else return RA(t,e)}function JI(t,e){const n=e==null?void 0:e[vA];return n==null?null:yn.makeFromBucketSpec(n,t)}function o4(t,e,n,r={}){t.host=`${e}:${n}`;const s=Ei(e);s&&(Sy(`https://${t.host}/b`),Cy("Storage",!0)),t._isUsingEmulator=!0,t._protocol=s?"https":"http";const{mockUserToken:i}=r;i&&(t._overrideAuthToken=typeof i=="string"?i:d0(i,t.app.options.projectId))}class zv{constructor(e,n,r,s,i,o=!1){this.app=e,this._authProvider=n,this._appCheckProvider=r,this._url=s,this._firebaseVersion=i,this._isUsingEmulator=o,this._bucket=null,this._host=yA,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=GM,this._maxUploadRetryTime=KM,this._requests=new Set,s!=null?this._bucket=yn.makeFromBucketSpec(s,this._host):this._bucket=JI(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=yn.makeFromBucketSpec(this._url,e):this._bucket=JI(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){xg("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){xg("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const n=await e.getToken();if(n!==null)return n.accessToken}return null}async _getAppCheckToken(){if(er(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new _o(this,e)}_makeRequest(e,n,r,s,i=!0){if(this._deleted)return new cF(_A());{const o=wF(e,this._appId,r,s,n,this._firebaseVersion,i,this._isUsingEmulator);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}async makeRequestWithTokens(e,n){const[r,s]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,n,r,s).getPromise()}}const ZI="@firebase/storage",ex="0.14.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NA="storage";function tx(t,e,n){return t=Qe(t),XF(t,e,n)}function nx(t){return t=Qe(t),JF(t)}function rx(t){return t=Qe(t),e4(t)}function Lp(t){return t=Qe(t),t4(t)}function Al(t,e){return t=Qe(t),i4(t,e)}function Bi(t=Qh(),e){t=Qe(t);const r=Ii(t,NA).getImmediate({identifier:e}),s=l0("storage");return s&&a4(r,...s),r}function a4(t,e,n,r={}){o4(t,e,n,r)}function l4(t,{instanceIdentifier:e}){const n=t.getProvider("app").getImmediate(),r=t.getProvider("auth-internal"),s=t.getProvider("app-check-internal");return new zv(n,r,s,e,bo)}function c4(){xr(new cr(NA,l4,"PUBLIC").setMultipleInstances(!0)),kn(ZI,ex,""),kn(ZI,ex,"esm2020")}c4();const u4={apiKey:"AIzaSyC70mGCRrjE8iOap8iTHuid8HEuyadue8Y",authDomain:"odontocloud-d92ac.firebaseapp.com",projectId:"odontocloud-d92ac",storageBucket:"odontocloud-d92ac.firebasestorage.app",messagingSenderId:"267020714981",appId:"1:267020714981:web:a44416ea83aa1d1172650c",measurementId:"G-ZMCC5CFY0C"},qv=Ny(u4),sx=nS(qv),ix=rA(qv);Bi(qv);const d4="/odontocloud-react/assets/fondo.png",PA="/odontocloud-react/assets/logo.png",ox=(t,e)=>{const n={email:t,rol:e,timestamp:Date.now()};localStorage.setItem("odc_session",JSON.stringify(n))},Vp=()=>{try{const t=JSON.parse(localStorage.getItem("odc_session"));return t&&Date.now()-t.timestamp<1e3*60*60*24?t:null}catch{return null}},h4=()=>{const t=Es(),[e,n]=A.useState(""),[r,s]=A.useState(""),[i,o]=A.useState(""),[a,c]=A.useState(navigator.onLine);A.useEffect(()=>{const f=()=>c(!0),m=()=>c(!1);return window.addEventListener("online",f),window.addEventListener("offline",m),()=>{window.removeEventListener("online",f),window.removeEventListener("offline",m)}},[]);const d=f=>{const m=(f||"").toLowerCase();m==="administrador"?t("/dashboard_admin",{replace:!0}):m==="doctor"?t("/dashboard_doctor",{replace:!0}):m==="recepcionista"?t("/dashboard_recepcion",{replace:!0}):o("Rol no reconocido. Contacte al administrador.")};A.useEffect(()=>{if(!navigator.onLine){const m=Vp();m!=null&&m.rol?d(m.rol):o("Sin conexin y no hay sesin guardada.");return}const f=Vy(sx,async m=>{if(m){const _=Vp();if(_!=null&&_.rol){d(_.rol);return}try{const R=st(Pe(ix,"users"),Xe("correo","==",m.email||"")),C=await Vt(R);if(!C.empty){const N=C.docs[0].data().rol||"sin_rol";ox(m.email||"",N),d(N)}}catch{d("administrador")}}});return()=>f()},[]);const h=async f=>{if(f.preventDefault(),o(""),!a){const m=Vp();m!=null&&m.rol?d(m.rol):o("Sin conexin y no hay sesin guardada.");return}try{const _=(await Wj(sx,e,r)).user,R=st(Pe(ix,"users"),Xe("correo","==",e)),C=await Vt(R);if(C.empty){o("Usuario no encontrado en la base de datos.");return}const T=C.docs[0].data().rol||"sin_rol";ox(e,T),d(T)}catch(m){switch(console.error("Error login:",m),m.code){case"auth/user-not-found":o("Usuario no registrado.");break;case"auth/wrong-password":o("Contrasea incorrecta.");break;case"auth/invalid-email":o("Correo no vlido.");break;case"auth/network-request-failed":o("Sin conexin. Usa la sesin guardada o reconecta.");break;default:o("Error al iniciar sesin.")}}};return l.jsx("div",{className:"login-root",style:{backgroundImage:`url(${d4})`,backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat",backgroundAttachment:"fixed",width:"100vw",height:"100vh",display:"flex",justifyContent:"center",alignItems:"center",overflow:"hidden"},children:l.jsxs("div",{className:"container",children:[l.jsxs("div",{className:"left-panel",children:[l.jsx("img",{src:PA,alt:"OdontoCloud Logo",className:"logo"}),l.jsxs("h2",{children:["Su clnica, ",l.jsx("br",{})," ms conectada."]}),l.jsx("p",{children:"OdontoCloud optimiza cada detalle de su gestin."})]}),l.jsxs("div",{className:"right-panel",children:[l.jsx("h3",{children:"Acceso a la plataforma"}),l.jsxs("form",{onSubmit:h,children:[l.jsx("input",{type:"email",placeholder:"usuario@ejemplo.com",value:e,onChange:f=>n(f.target.value),required:a}),l.jsx("input",{type:"password",placeholder:"Contrasea",value:r,onChange:f=>s(f.target.value),required:a}),l.jsx("button",{type:"submit",children:a?"Iniciar sesin":"Entrar (modo offline)"}),i&&l.jsx("p",{style:{color:"red",marginTop:10},children:i}),!a&&l.jsx("p",{style:{color:"orange",marginTop:10},children:" Modo offline activado"})]})]})]})})},kA="@firebase/installations",Hv="0.6.19";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DA=1e4,jA=`w:${Hv}`,OA="FIS_v2",f4="https://firebaseinstallations.googleapis.com/v1",p4=60*60*1e3,m4="installations",g4="Installations";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const y4={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},wo=new To(m4,g4,y4);function LA(t){return t instanceof ur&&t.code.includes("request-failed")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VA({projectId:t}){return`${f4}/projects/${t}/installations`}function MA(t){return{token:t.token,requestStatus:2,expiresIn:_4(t.expiresIn),creationTime:Date.now()}}async function FA(t,e){const r=(await e.json()).error;return wo.create("request-failed",{requestName:t,serverCode:r.code,serverMessage:r.message,serverStatus:r.status})}function UA({apiKey:t}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t})}function v4(t,{refreshToken:e}){const n=UA(t);return n.append("Authorization",w4(e)),n}async function $A(t){const e=await t();return e.status>=500&&e.status<600?t():e}function _4(t){return Number(t.replace("s","000"))}function w4(t){return`${OA} ${t}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function E4({appConfig:t,heartbeatServiceProvider:e},{fid:n}){const r=VA(t),s=UA(t),i=e.getImmediate({optional:!0});if(i){const d=await i.getHeartbeatsHeader();d&&s.append("x-firebase-client",d)}const o={fid:n,authVersion:OA,appId:t.appId,sdkVersion:jA},a={method:"POST",headers:s,body:JSON.stringify(o)},c=await $A(()=>fetch(r,a));if(c.ok){const d=await c.json();return{fid:d.fid||n,registrationStatus:2,refreshToken:d.refreshToken,authToken:MA(d.authToken)}}else throw await FA("Create Installation",c)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function BA(t){return new Promise(e=>{setTimeout(e,t)})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function I4(t){return btoa(String.fromCharCode(...t)).replace(/\+/g,"-").replace(/\//g,"_")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const x4=/^[cdef][\w-]{21}$/,Tg="";function T4(){try{const t=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(t),t[0]=112+t[0]%16;const n=b4(t);return x4.test(n)?n:Tg}catch{return Tg}}function b4(t){return I4(t).substr(0,22)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Df(t){return`${t.appName}!${t.appId}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zA=new Map;function qA(t,e){const n=Df(t);HA(n,e),S4(n,e)}function HA(t,e){const n=zA.get(t);if(n)for(const r of n)r(e)}function S4(t,e){const n=C4();n&&n.postMessage({key:t,fid:e}),A4()}let Gi=null;function C4(){return!Gi&&"BroadcastChannel"in self&&(Gi=new BroadcastChannel("[Firebase] FID Change"),Gi.onmessage=t=>{HA(t.data.key,t.data.fid)}),Gi}function A4(){zA.size===0&&Gi&&(Gi.close(),Gi=null)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const R4="firebase-installations-database",N4=1,Eo="firebase-installations-store";let Mp=null;function Wv(){return Mp||(Mp=_0(R4,N4,{upgrade:(t,e)=>{switch(e){case 0:t.createObjectStore(Eo)}}})),Mp}async function Sh(t,e){const n=Df(t),s=(await Wv()).transaction(Eo,"readwrite"),i=s.objectStore(Eo),o=await i.get(n);return await i.put(e,n),await s.done,(!o||o.fid!==e.fid)&&qA(t,e.fid),e}async function WA(t){const e=Df(t),r=(await Wv()).transaction(Eo,"readwrite");await r.objectStore(Eo).delete(e),await r.done}async function jf(t,e){const n=Df(t),s=(await Wv()).transaction(Eo,"readwrite"),i=s.objectStore(Eo),o=await i.get(n),a=e(o);return a===void 0?await i.delete(n):await i.put(a,n),await s.done,a&&(!o||o.fid!==a.fid)&&qA(t,a.fid),a}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Gv(t){let e;const n=await jf(t.appConfig,r=>{const s=P4(r),i=k4(t,s);return e=i.registrationPromise,i.installationEntry});return n.fid===Tg?{installationEntry:await e}:{installationEntry:n,registrationPromise:e}}function P4(t){const e=t||{fid:T4(),registrationStatus:0};return GA(e)}function k4(t,e){if(e.registrationStatus===0){if(!navigator.onLine){const s=Promise.reject(wo.create("app-offline"));return{installationEntry:e,registrationPromise:s}}const n={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},r=D4(t,n);return{installationEntry:n,registrationPromise:r}}else return e.registrationStatus===1?{installationEntry:e,registrationPromise:j4(t)}:{installationEntry:e}}async function D4(t,e){try{const n=await E4(t,e);return Sh(t.appConfig,n)}catch(n){throw LA(n)&&n.customData.serverCode===409?await WA(t.appConfig):await Sh(t.appConfig,{fid:e.fid,registrationStatus:0}),n}}async function j4(t){let e=await ax(t.appConfig);for(;e.registrationStatus===1;)await BA(100),e=await ax(t.appConfig);if(e.registrationStatus===0){const{installationEntry:n,registrationPromise:r}=await Gv(t);return r||n}return e}function ax(t){return jf(t,e=>{if(!e)throw wo.create("installation-not-found");return GA(e)})}function GA(t){return O4(t)?{fid:t.fid,registrationStatus:0}:t}function O4(t){return t.registrationStatus===1&&t.registrationTime+DA<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function L4({appConfig:t,heartbeatServiceProvider:e},n){const r=V4(t,n),s=v4(t,n),i=e.getImmediate({optional:!0});if(i){const d=await i.getHeartbeatsHeader();d&&s.append("x-firebase-client",d)}const o={installation:{sdkVersion:jA,appId:t.appId}},a={method:"POST",headers:s,body:JSON.stringify(o)},c=await $A(()=>fetch(r,a));if(c.ok){const d=await c.json();return MA(d)}else throw await FA("Generate Auth Token",c)}function V4(t,{fid:e}){return`${VA(t)}/${e}/authTokens:generate`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Kv(t,e=!1){let n;const r=await jf(t.appConfig,i=>{if(!KA(i))throw wo.create("not-registered");const o=i.authToken;if(!e&&U4(o))return i;if(o.requestStatus===1)return n=M4(t,e),i;{if(!navigator.onLine)throw wo.create("app-offline");const a=B4(i);return n=F4(t,a),a}});return n?await n:r.authToken}async function M4(t,e){let n=await lx(t.appConfig);for(;n.authToken.requestStatus===1;)await BA(100),n=await lx(t.appConfig);const r=n.authToken;return r.requestStatus===0?Kv(t,e):r}function lx(t){return jf(t,e=>{if(!KA(e))throw wo.create("not-registered");const n=e.authToken;return z4(n)?{...e,authToken:{requestStatus:0}}:e})}async function F4(t,e){try{const n=await L4(t,e),r={...e,authToken:n};return await Sh(t.appConfig,r),n}catch(n){if(LA(n)&&(n.customData.serverCode===401||n.customData.serverCode===404))await WA(t.appConfig);else{const r={...e,authToken:{requestStatus:0}};await Sh(t.appConfig,r)}throw n}}function KA(t){return t!==void 0&&t.registrationStatus===2}function U4(t){return t.requestStatus===2&&!$4(t)}function $4(t){const e=Date.now();return e<t.creationTime||t.creationTime+t.expiresIn<e+p4}function B4(t){const e={requestStatus:1,requestTime:Date.now()};return{...t,authToken:e}}function z4(t){return t.requestStatus===1&&t.requestTime+DA<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function q4(t){const e=t,{installationEntry:n,registrationPromise:r}=await Gv(e);return r?r.catch(console.error):Kv(e).catch(console.error),n.fid}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function H4(t,e=!1){const n=t;return await W4(n),(await Kv(n,e)).token}async function W4(t){const{registrationPromise:e}=await Gv(t);e&&await e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function G4(t){if(!t||!t.options)throw Fp("App Configuration");if(!t.name)throw Fp("App Name");const e=["projectId","apiKey","appId"];for(const n of e)if(!t.options[n])throw Fp(n);return{appName:t.name,projectId:t.options.projectId,apiKey:t.options.apiKey,appId:t.options.appId}}function Fp(t){return wo.create("missing-app-config-values",{valueName:t})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QA="installations",K4="installations-internal",Q4=t=>{const e=t.getProvider("app").getImmediate(),n=G4(e),r=Ii(e,"heartbeat");return{app:e,appConfig:n,heartbeatServiceProvider:r,_delete:()=>Promise.resolve()}},Y4=t=>{const e=t.getProvider("app").getImmediate(),n=Ii(e,QA).getImmediate();return{getId:()=>q4(n),getToken:s=>H4(n,s)}};function X4(){xr(new cr(QA,Q4,"PUBLIC")),xr(new cr(K4,Y4,"PRIVATE"))}X4();kn(kA,Hv);kn(kA,Hv,"esm2020");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ch="analytics",J4="firebase_id",Z4="origin",eU=60*1e3,tU="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",Qv="https://www.googletagmanager.com/gtag/js";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wn=new Kh("@firebase/analytics");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nU={"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-initialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."},qn=new To("analytics","Analytics",nU);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rU(t){if(!t.startsWith(Qv)){const e=qn.create("invalid-gtag-resource",{gtagURL:t});return wn.warn(e.message),""}return t}function YA(t){return Promise.all(t.map(e=>e.catch(n=>n)))}function sU(t,e){let n;return window.trustedTypes&&(n=window.trustedTypes.createPolicy(t,e)),n}function iU(t,e){const n=sU("firebase-js-sdk-policy",{createScriptURL:rU}),r=document.createElement("script"),s=`${Qv}?l=${t}&id=${e}`;r.src=n?n==null?void 0:n.createScriptURL(s):s,r.async=!0,document.head.appendChild(r)}function oU(t){let e=[];return Array.isArray(window[t])?e=window[t]:window[t]=e,e}async function aU(t,e,n,r,s,i){const o=r[s];try{if(o)await e[o];else{const c=(await YA(n)).find(d=>d.measurementId===s);c&&await e[c.appId]}}catch(a){wn.error(a)}t("config",s,i)}async function lU(t,e,n,r,s){try{let i=[];if(s&&s.send_to){let o=s.send_to;Array.isArray(o)||(o=[o]);const a=await YA(n);for(const c of o){const d=a.find(f=>f.measurementId===c),h=d&&e[d.appId];if(h)i.push(h);else{i=[];break}}}i.length===0&&(i=Object.values(e)),await Promise.all(i),t("event",r,s||{})}catch(i){wn.error(i)}}function cU(t,e,n,r){async function s(i,...o){try{if(i==="event"){const[a,c]=o;await lU(t,e,n,a,c)}else if(i==="config"){const[a,c]=o;await aU(t,e,n,r,a,c)}else if(i==="consent"){const[a,c]=o;t("consent",a,c)}else if(i==="get"){const[a,c,d]=o;t("get",a,c,d)}else if(i==="set"){const[a]=o;t("set",a)}else t(i,...o)}catch(a){wn.error(a)}}return s}function uU(t,e,n,r,s){let i=function(...o){window[r].push(arguments)};return window[s]&&typeof window[s]=="function"&&(i=window[s]),window[s]=cU(i,t,e,n),{gtagCore:i,wrappedGtag:window[s]}}function dU(t){const e=window.document.getElementsByTagName("script");for(const n of Object.values(e))if(n.src&&n.src.includes(Qv)&&n.src.includes(t))return n;return null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hU=30,fU=1e3;class pU{constructor(e={},n=fU){this.throttleMetadata=e,this.intervalMillis=n}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,n){this.throttleMetadata[e]=n}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}}const XA=new pU;function mU(t){return new Headers({Accept:"application/json","x-goog-api-key":t})}async function gU(t){var o;const{appId:e,apiKey:n}=t,r={method:"GET",headers:mU(n)},s=tU.replace("{app-id}",e),i=await fetch(s,r);if(i.status!==200&&i.status!==304){let a="";try{const c=await i.json();(o=c.error)!=null&&o.message&&(a=c.error.message)}catch{}throw qn.create("config-fetch-failed",{httpStatus:i.status,responseMessage:a})}return i.json()}async function yU(t,e=XA,n){const{appId:r,apiKey:s,measurementId:i}=t.options;if(!r)throw qn.create("no-app-id");if(!s){if(i)return{measurementId:i,appId:r};throw qn.create("no-api-key")}const o=e.getThrottleMetadata(r)||{backoffCount:0,throttleEndTimeMillis:Date.now()},a=new wU;return setTimeout(async()=>{a.abort()},eU),JA({appId:r,apiKey:s,measurementId:i},o,a,e)}async function JA(t,{throttleEndTimeMillis:e,backoffCount:n},r,s=XA){var a;const{appId:i,measurementId:o}=t;try{await vU(r,e)}catch(c){if(o)return wn.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${o} provided in the "measurementId" field in the local Firebase config. [${c==null?void 0:c.message}]`),{appId:i,measurementId:o};throw c}try{const c=await gU(t);return s.deleteThrottleMetadata(i),c}catch(c){const d=c;if(!_U(d)){if(s.deleteThrottleMetadata(i),o)return wn.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${o} provided in the "measurementId" field in the local Firebase config. [${d==null?void 0:d.message}]`),{appId:i,measurementId:o};throw c}const h=Number((a=d==null?void 0:d.customData)==null?void 0:a.httpStatus)===503?Kw(n,s.intervalMillis,hU):Kw(n,s.intervalMillis),f={throttleEndTimeMillis:Date.now()+h,backoffCount:n+1};return s.setThrottleMetadata(i,f),wn.debug(`Calling attemptFetch again in ${h} millis`),JA(t,f,r,s)}}function vU(t,e){return new Promise((n,r)=>{const s=Math.max(e-Date.now(),0),i=setTimeout(n,s);t.addEventListener(()=>{clearTimeout(i),r(qn.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}function _U(t){if(!(t instanceof ur)||!t.customData)return!1;const e=Number(t.customData.httpStatus);return e===429||e===500||e===503||e===504}class wU{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach(e=>e())}}async function EU(t,e,n,r,s){if(s&&s.global){t("event",n,r);return}else{const i=await e,o={...r,send_to:i};t("event",n,o)}}async function IU(t,e,n,r){if(r&&r.global){const s={};for(const i of Object.keys(n))s[`user_properties.${i}`]=n[i];return t("set",s),Promise.resolve()}else{const s=await e;t("config",s,{update:!0,user_properties:n})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function xU(){if(Ay())try{await g0()}catch(t){return wn.warn(qn.create("indexeddb-unavailable",{errorInfo:t==null?void 0:t.toString()}).message),!1}else return wn.warn(qn.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;return!0}async function TU(t,e,n,r,s,i,o){const a=yU(t);a.then(m=>{n[m.measurementId]=m.appId,t.options.measurementId&&m.measurementId!==t.options.measurementId&&wn.warn(`The measurement ID in the local Firebase config (${t.options.measurementId}) does not match the measurement ID fetched from the server (${m.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(m=>wn.error(m)),e.push(a);const c=xU().then(m=>{if(m)return r.getId()}),[d,h]=await Promise.all([a,c]);dU(i)||iU(i,d.measurementId),s("js",new Date);const f=(o==null?void 0:o.config)??{};return f[Z4]="firebase",f.update=!0,h!=null&&(f[J4]=h),s("config",d.measurementId,f),d.measurementId}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bU{constructor(e){this.app=e}_delete(){return delete Ea[this.app.options.appId],Promise.resolve()}}let Ea={},cx=[];const ux={};let Up="dataLayer",SU="gtag",dx,Yv,hx=!1;function CU(){const t=[];if(f0()&&t.push("This is a browser extension environment."),Ak()||t.push("Cookies are not available."),t.length>0){const e=t.map((r,s)=>`(${s+1}) ${r}`).join(" "),n=qn.create("invalid-analytics-context",{errorInfo:e});wn.warn(n.message)}}function AU(t,e,n){CU();const r=t.options.appId;if(!r)throw qn.create("no-app-id");if(!t.options.apiKey)if(t.options.measurementId)wn.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${t.options.measurementId} provided in the "measurementId" field in the local Firebase config.`);else throw qn.create("no-api-key");if(Ea[r]!=null)throw qn.create("already-exists",{id:r});if(!hx){oU(Up);const{wrappedGtag:i,gtagCore:o}=uU(Ea,cx,ux,Up,SU);Yv=i,dx=o,hx=!0}return Ea[r]=TU(t,cx,ux,e,dx,Up,n),new bU(t)}function RU(t=Qh()){t=Qe(t);const e=Ii(t,Ch);return e.isInitialized()?e.getImmediate():NU(t)}function NU(t,e={}){const n=Ii(t,Ch);if(n.isInitialized()){const s=n.getImmediate();if(ms(e,n.getOptions()))return s;throw qn.create("already-initialized")}return n.initialize({options:e})}function PU(t,e,n){t=Qe(t),IU(Yv,Ea[t.app.options.appId],e,n).catch(r=>wn.error(r))}function kU(t,e,n,r){t=Qe(t),EU(Yv,Ea[t.app.options.appId],e,n,r).catch(s=>wn.error(s))}const fx="@firebase/analytics",px="0.10.19";function DU(){xr(new cr(Ch,(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("installations-internal").getImmediate();return AU(r,s,n)},"PUBLIC")),xr(new cr("analytics-internal",t,"PRIVATE")),kn(fx,px),kn(fx,px,"esm2020");function t(e){try{const n=e.getProvider(Ch).getImmediate();return{logEvent:(r,s,i)=>kU(n,r,s,i),setUserProperties:(r,s)=>PU(n,r,s)}}catch(n){throw qn.create("interop-component-reg-failed",{reason:n})}}}DU();const jU={apiKey:"AIzaSyC70mGCRrjE8iOap8iTHuid8HEuyadue8Y",authDomain:"odontocloud-d92ac.firebaseapp.com",projectId:"odontocloud-d92ac",storageBucket:"odontocloud-d92ac.firebasestorage.app",messagingSenderId:"267020714981",appId:"1:267020714981:web:a44416ea83aa1d1172650c",measurementId:"G-ZMCC5CFY0C"},Of=Ny(jU),Ah=nS(Of),ue=rA(Of);Bi(Of);RU(Of);const Xv=(t,e="")=>{try{return localStorage.getItem(t)??e}catch{return e}},mx=()=>{var t;return((t=document.querySelector('meta[name="company-name"]'))==null?void 0:t.getAttribute("content"))||Xv("empresa_nombre","OdontoCloud")},OU=()=>{var t;return((t=document.querySelector('meta[name="company-logo"]'))==null?void 0:t.getAttribute("content"))||Xv("empresa_logo_url","")},gx=()=>{var t;return((t=document.querySelector('meta[name="software-footer"]'))==null?void 0:t.getAttribute("content"))||Xv("software_footer_text","Generado por OdontoCloud")},Qu=()=>{const t=new Date;return t.setHours(0,0,0,0),t},Os=t=>{const e=new Date(t);return e.setHours(0,0,0,0),e},$p=t=>{const e=new Date(t);return e.setHours(23,59,59,999),e},Or=(t,e)=>{const n=new Date(t);return n.setDate(n.getDate()+e),n},yx=t=>{const e=new Date(t),n=e.getDay(),r=(n===0?-6:1)-n;return e.setDate(e.getDate()+r),e.setHours(0,0,0,0),e},vx=(t,e)=>t.getFullYear()===e.getFullYear()&&t.getMonth()===e.getMonth()&&t.getDate()===e.getDate();var Sx;const Vn=typeof navigator<"u"&&((Sx=navigator.language)!=null&&Sx.startsWith("es"))?"es-ES":"en-US",Bp=t=>{const e=t.getFullYear(),n=String(t.getMonth()+1).padStart(2,"0"),r=String(t.getDate()).padStart(2,"0");return`${e}-${n}-${r}`},Fo=t=>(t||"").toString().toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/\s+/g," ").trim(),LU=t=>{try{const e=new URLSearchParams(t||""),n=e.get("date")||e.get("day")||e.get("d")||e.get("fecha")||e.get("selectedDate")||(typeof sessionStorage<"u"?sessionStorage.getItem("agenda.targetDate"):""),r=String(n||"").slice(0,10);if(!/^\d{4}-\d{2}-\d{2}$/.test(r))return null;const[s,i,o]=r.split("-").map(c=>parseInt(c,10));return new Date(s,(i||1)-1,o||1,0,0,0,0)}catch{return null}};function VU(){const t=Dn(),[e,n]=A.useState("day"),[r,s]=A.useState(Qu()),[i,o]=A.useState(Qu()),[a,c]=A.useState(!0),[d,h]=A.useState([]),[f,m]=A.useState(""),[_,R]=A.useState(""),[C,N]=A.useState("");A.useEffect(()=>{const U=LU(t.search);if(U){const ne=Os(U);s(ne),o(ne),n("day");try{sessionStorage.removeItem("agenda.targetDate")}catch{}}},[t.search]),A.useEffect(()=>{c(!0);const U=Pe(ue,"citas"),ne=st(U,gn("fecha","asc")),ce=Un(ne,Te=>{const be=Te.docs.map(Re=>{const le=Re.data(),Oe=le.horaInicio||le.hora||"00:00",[$e="0",tt="0"]=Oe.split(":"),H=parseInt($e,10)||0,se=parseInt(tt,10)||0;let B;if(le.fecha&&le.fecha.toDate)B=le.fecha.toDate(),B.setHours(H,se,0,0);else if(typeof le.fecha=="string"){const[ye,ve,Me]=le.fecha.split("-");B=new Date(parseInt(ye,10),parseInt(ve,10)-1,parseInt(Me,10),H,se,0,0)}else le.fecha instanceof Date?(B=new Date(le.fecha),B.setHours(H,se,0,0)):(B=new Date,B.setHours(H,se,0,0));const re=le.documentoPaciente||le.docPaciente||le.pacienteDocumento||le.documento||"",ie=le.celularPaciente||le.telefonoPaciente||le.celular||le.telefono||"";return{id:Re.id,raw:le,fecha:B,horaInicio:Oe,paciente:le.paciente||le.pacienteNombre||"Sin nombre",doctor:le.doctor||le.doctorNombre||"",sucursal:le.sucursal||"",espacio:le.espacio||le.consultorio||"",comentario:le.comentario||"",estado:le.estado||"En espera",recordatorio:le.recordatorio||"",documento:re,telefono:ie}});let je,_e;if(e==="day")je=Os(r),_e=$p(r);else if(e==="week"){const Re=yx(r),le=Or(Re,6);je=Os(Re),_e=$p(le)}else{const Re=Os(r),le=Or(Re,-30),Oe=Or(Re,60);je=Os(le),_e=$p(Oe)}const it=be.filter(Re=>Re.fecha>=je&&Re.fecha<=_e);h(it),c(!1)},Te=>{console.error("Error leyendo citas:",Te),h([]),c(!1)});return()=>ce()},[e,r]);const T=A.useMemo(()=>{const U=new Set;return d.forEach(ne=>ne.sucursal&&U.add(ne.sucursal)),Array.from(U)},[d]),y=A.useMemo(()=>{const U=new Set;return d.forEach(ne=>ne.doctor&&U.add(ne.doctor)),Array.from(U)},[d]),v=A.useMemo(()=>{const U=C.trim().toLowerCase();return d.filter(ne=>{if(f&&ne.sucursal!==f||_&&ne.doctor!==_)return!1;if(!U)return!0;const ce=[ne.paciente,ne.doctor,ne.comentario,ne.documento,ne.sucursal,ne.espacio,ne.estado],Te=ne.raw?JSON.stringify(ne.raw):"";return[...ce,Te].filter(Boolean).some(je=>String(je).toLowerCase().includes(U))})},[d,f,_,C]),E=A.useMemo(()=>a?"Ocupacin: cargando...":v.length===0?"Ocupacin: sin citas para el rango seleccionado.":`Ocupacin: ${v.length} cita${v.length!==1?"s":""} en el rango actual.`,[v,a]),O=A.useMemo(()=>{const U=new Date(i.getFullYear(),i.getMonth(),1),ne=(U.getDay()+6)%7,ce=new Date(U);ce.setDate(ce.getDate()-ne);const Te=[];for(let be=0;be<6;be++){const je=[];for(let _e=0;_e<7;_e++){const it=new Date(ce),Re=it.getMonth()===i.getMonth(),le=vx(it,Qu()),Oe=vx(it,r);je.push({date:it,isCurrentMonth:Re,isToday:le,isSelected:Oe}),ce.setDate(ce.getDate()+1)}Te.push(je)}return Te},[i,r]),F=()=>{const U=new Date(i);U.setMonth(U.getMonth()-1),o(U)},x=()=>{const U=new Date(i);U.setMonth(U.getMonth()+1),o(U)},I=U=>{s(Os(U)),o(Os(U)),n("day")},w=A.useMemo(()=>i.toLocaleDateString(Vn,{month:"long",year:"numeric"}),[i]),P=A.useMemo(()=>{if(e==="day")return r.toLocaleDateString(Vn,{weekday:"long",day:"2-digit",month:"long",year:"numeric"});if(e==="week"){const U=yx(r),ne=Or(U,6);return U.toLocaleDateString(Vn,{day:"2-digit",month:"short"})+" - "+ne.toLocaleDateString(Vn,{day:"2-digit",month:"short",year:"numeric"})}return"ltimas citas (detalle)"},[e,r]),D=()=>{s(e==="day"?Or(r,-1):e==="week"?Or(r,-7):Or(r,-1))},j=()=>{s(e==="day"?Or(r,1):e==="week"?Or(r,7):Or(r,1))},k=()=>{const U=Qu();s(U),o(U),n("day")},K=()=>{var se;const U=B=>String(B??"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),ne=mx(),ce=OU(),Te=gx(),be=f||"",je=_||"",_e=new Date;_e.setHours(0,0,0,0);const it=v.length===0?'<tr class="empty"><td colspan="10">No hay citas registradas para este rango.</td></tr>':v.map((B,re)=>{var Ae,Ie,M,Y,J,Ce;const ie=B.fecha.toLocaleTimeString(Vn,{hour:"2-digit",minute:"2-digit",hour12:!0}),ye=B.documento||((Ae=B.raw)==null?void 0:Ae.documento)||((Ie=B.raw)==null?void 0:Ie.nroDocumento)||"",ve=((M=B.raw)==null?void 0:M.celularPaciente)||((Y=B.raw)==null?void 0:Y.celular)||"",Me=((J=B.raw)==null?void 0:J.telefonoPaciente)||((Ce=B.raw)==null?void 0:Ce.telefono)||"",Se=new Date(B.fecha.getFullYear(),B.fecha.getMonth(),B.fecha.getDate());let Le="Futura";return Se.getTime()===_e.getTime()?Le="Hoy":Se.getTime()<_e.getTime()&&(Le="Pasada"),`<tr class="${re%2?"zebra":""}">
              <td class="mono">${U(ie)}</td>
              <td>${U(B.paciente)}</td>
              <td class="mono">${U(ye)}</td>
              <td class="mono">${U(ve)}</td>
              <td class="mono">${U(Me)}</td>
              <td>${U(B.doctor)}</td>
              <td>${U(B.espacio)}</td>
              <td>${U(B.comentario)}</td>
              <td class="status">${U(B.estado)}</td>
              <td class="actual">${U(Le)}</td>
            </tr>`}).join(""),le=`<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>Agenda  ${U(ne)}</title>
  <style>
    @page { size: A4 portrait; margin: 14mm 16mm; }
    * { box-sizing: border-box; }
    html, body { -webkit-print-color-adjust: exact; print-color-adjust: exact; }
    body { font-family: "Segoe UI", Roboto, Arial, sans-serif; color:#0f172a; line-height:1.35; }

    /* Cabecera */
    .hdr {
      display:flex; flex-direction:column; align-items:center; text-align:center;
      margin-bottom:14px;
    }
    .logo {
      max-height:120px; width:auto; max-width:100%; object-fit:contain;
      filter: drop-shadow(0 1px 0 rgba(0,0,0,.04));
    }
    .brand {
      margin-top:4px; font-weight:800; letter-spacing:.5px; text-transform:uppercase;
      font-size:26px; color:#0a86d8;
    }
    .sub { margin-top:2px; font-size:12px; color:#64748b; }

    /* Tarjeta info Sede/Doctor */
    .info-card {
      width:100%; display:flex; justify-content:center; margin:8px 0 16px;
    }
    .info {
      width:70%; border:1px solid #e5e7eb; border-radius:10px; overflow:hidden; border-collapse:separate;
      font-size:12px;
    }
    .info-row { display:flex; border-top:1px solid #e5e7eb; }
    .info-row:first-child { border-top:0; }
    .label {
      width:22%; padding:8px 10px; background:#f8fafc; font-weight:600; color:#334155; border-right:1px solid #e5e7eb;
    }
    .value { flex:1; padding:8px 10px; }

    /* Tabla principal */
    table { width:100%; border-collapse:separate; border-spacing:0; font-size:12px; }
    thead th {
      background:#0f172a; color:#ffffff; text-align:center; font-weight:700;
      padding:9px 8px; position:relative;
    }
    thead th + th { box-shadow: inset 1px 0 0 rgba(255,255,255,.08); }
    tbody td {
      padding:8px 8px; vertical-align:top; border-bottom:1px solid #e5e7eb;
    }
    tbody tr.zebra td { background:#fafafa; }
    tbody tr.empty td {
      padding:16px; color:#6b7280; text-align:center; background:#fafafa;
      border:1px dashed #e5e7eb; border-radius:8px;
    }
    td.mono { font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, "Liberation Mono", monospace; }
    td.status { white-space:nowrap; }
    td.actual { font-weight:600; }
    /* Bordes exteriores suaves */
    .tbl-wrap { border:1px solid #e5e7eb; border-radius:10px; overflow:hidden; }

    /* Notas pie */
    .note { margin-top:10px; font-size:10px; color:#6b7280; }

    /* Evitar cortes feos */
    tr, .hdr, .info-card { page-break-inside: avoid; }
  </style>
</head>
<body>
  <div class="hdr">
    ${ce?`<img src="${ce}" alt="Logo" class="logo">`:""}
    <div class="brand">${U(ne)}</div>
    <div class="sub">Agenda de citas  ${U(P)}</div>
  </div>

  <div class="info-card">
    <div class="info">
      <div class="info-row"><div class="label">Sede</div><div class="value">${U(be)}</div></div>
      <div class="info-row"><div class="label">Doctor</div><div class="value">${U(je)}</div></div>
    </div>
  </div>

  <div class="tbl-wrap">
    <table>
      <thead>
        <tr>
          <th style="width:9%">Hora</th>
          <th style="width:17%">Nombre paciente</th>
          <th style="width:12%">Documento</th>
          <th style="width:12%">Celular</th>
          <th style="width:12%">Telfono</th>
          <th style="width:10%">Doctor</th>
          <th style="width:11%">Espacio</th>
          <th>Comentario</th>
          <th style="width:9%">Estado</th>
          <th style="width:9%">Actualidad</th>
        </tr>
      </thead>
      <tbody>${it}</tbody>
    </table>
  </div>

  <div class="note">
    ${U(Te)}  ${U(new Date().toLocaleString(Vn))}
  </div>

  <script>
    window.addEventListener('load', function() {
      try { window.focus(); window.print(); } catch (e) {}
    });
  <\/script>
</body>
</html>`,Oe=new Blob([le],{type:"text/html;charset=utf-8"}),$e=URL.createObjectURL(Oe),tt=window.open($e,"_blank","noopener,noreferrer,width=900,height=700");if(!tt){alert("El navegador bloque la ventana de impresin. Permite pop-ups para este sitio."),URL.revokeObjectURL($e);return}const H=()=>{try{URL.revokeObjectURL($e)}catch{}};(se=tt.addEventListener)==null||se.call(tt,"load",H),setTimeout(H,15e3)},Ge=()=>alert("Funcin de confirmar citas se integrar con n8n / correo."),$t=()=>k(),hn=()=>{if(v.length===0){alert("No hay citas para exportar.");return}const U=mx(),ne=gx(),ce=[`Empresa: ${U}`],Te=["Fecha","Hora","Paciente","Doctor","Espacio","Comentario"],be=v.map($e=>{const tt=$e.fecha.toLocaleDateString(Vn),H=$e.fecha.toLocaleTimeString(Vn,{hour:"2-digit",minute:"2-digit",hour12:!0});return[tt,H,$e.paciente||"",$e.doctor||"",$e.espacio||"",($e.comentario||"").replace(/\r?\n/g," ")]}),je=[ne],_e=[ce,[],Te,...be,[],je].map($e=>($e||[]).map(tt=>`"${String(tt??"").replace(/"/g,'""')}"`).join(",")).join(`
`),it=`citas_${U.toLowerCase().replace(/\s+/g,"_")}_${Bp(Os(r))}`+(e==="week"?"_semana":e==="detail"?"_detalle":"")+".csv",Re=new Blob(["\uFEFF"+_e],{type:"text/csv;charset=utf-8;"}),le=URL.createObjectURL(Re),Oe=document.createElement("a");Oe.href=le,Oe.download=it,Oe.click(),URL.revokeObjectURL(le)},ee=async(U,ne)=>{try{const ce=mt(ue,"citas",U);await ui(ce,{estado:ne})}catch(ce){console.error("Error actualizando estado:",ce),alert("No se pudo actualizar el estado de la cita.")}},he=(U,ne)=>{if(!U){alert("Este paciente no tiene celular registrado.");return}const ce=String(U).replace(/\D/g,""),Te=ne.fecha.toLocaleDateString(Vn),be=ne.fecha.toLocaleTimeString(Vn,{hour:"numeric",minute:"2-digit",hour12:!0}),je=encodeURIComponent(`Hola ${ne.paciente}, le recordamos su cita odontolgica el ${Te} a las ${be}. Por favor confirme su asistencia.`),_e=`https://wa.me/${ce}?text=${je}`;window.open(_e,"_blank")},me=async U=>{if(window.confirm(`Seguro que deseas eliminar la cita de ${U.paciente} del ${U.fecha.toLocaleDateString(Vn)}?`))try{const ce=mt(ue,"citas",U.id);await Rf(ce)}catch(ce){console.error("Error eliminando cita:",ce),alert(" No se pudo eliminar la cita.")}},ke=()=>{const U=document.createElement("div");Object.assign(U.style,{position:"fixed",top:"0",left:"0",width:"100%",height:"100%",background:"rgba(0,0,0,0.55)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:"9999"});const ne=document.createElement("div");Object.assign(ne.style,{background:"#fff",padding:"25px 30px",borderRadius:"14px",width:"520px",maxWidth:"95%",maxHeight:"95%",overflowY:"auto",boxShadow:"0 8px 30px rgba(0,0,0,0.3)",fontFamily:"Segoe UI, Roboto, sans-serif"}),ne.innerHTML=`
      <h2 style="margin-top:0;text-align:center;color:#0a86d8;font-weight:600;"> Nueva Cita</h2>
      <form id="formNuevaCita" style="display:flex;flex-direction:column;gap:12px;margin-top:10px;">
        <label style="font-weight:600;">Paciente existente</label>
        <div style="position:relative;">
          <input type="text" id="buscarPaciente" placeholder="Buscar por nombre, apellido o documento..." autocomplete="off"/>
          <div id="acResultados" style="position:absolute;left:0;right:0;top:calc(100% + 6px);z-index:10000;display:none;background:#fff;border:1px solid #ddd;border-radius:8px;box-shadow:0 8px 22px rgba(0,0,0,.12);max-height:240px;overflow:auto;"></div>
        </div>
        <small style="color:gray;">Si el paciente no existe, marca Registrar nuevo paciente.</small>

        <label style="display:flex;align-items:center;gap:8px;margin-top:5px;">
          <input type="checkbox" id="esNuevoPaciente" />
          <span>Registrar nuevo paciente</span>
        </label>

        <div id="nuevoPacienteCampos" style="display:none;flex-direction:column;gap:8px;margin-top:10px;padding:10px;border-radius:8px;background:#f9f9f9;border:1px solid #ddd;">
          <h4 style="margin:0;text-align:center;color:#0a86d8;">Datos del paciente</h4>
          <div style="display:flex;gap:8px;">
            <input type="text" id="npNombre" placeholder="Nombre" style="flex:1;" />
            <input type="text" id="npApellido" placeholder="Apellido" style="flex:1;" />
          </div>
          <select id="npTipoDocumento">
            <option value="">Tipo de documento</option>
            <option value="CC">Cdula de Ciudadana</option>
            <option value="CE">Cdula de Extranjera</option>
            <option value="TI">Tarjeta de Identidad</option>
            <option value="PA">Pasaporte</option>
            <option value="DI">Documento Internacional</option>
            <option value="OTRO">Otro</option>
          </select>
          <input type="text" id="npDocumento" placeholder="Nmero de documento" />
          <input type="email" id="npCorreo" placeholder="Correo electrnico" />
          <div style="display:flex;gap:5px;">
            <select id="npIndicativo" style="width:40%;">
              <option value="+57"> +57</option>
              <option value="+1"> +1</option>
              <option value="+34"> +34</option>
              <option value="+52"> +52</option>
              <option value="+54"> +54</option>
              <option value="+593"> +593</option>
              <option value="+56"> +56</option>
              <option value="+58"> +58</option>
            </select>
            <input type="tel" id="npCelular" placeholder="Celular (obligatorio)" style="flex:1;" />
          </div>
          <input type="tel" id="npTelefono" placeholder="Telfono fijo (opcional)" />
          <label style="font-weight:500;">Fecha de nacimiento:</label>
          <input type="date" id="npNacimiento" />
          <select id="npSexo">
            <option value="">Sexo</option>
            <option value="Masculino">Masculino</option>
            <option value="Femenino">Femenino</option>
            <option value="Otro">Otro</option>
          </select>
          <textarea id="npComentario" placeholder="Comentario o antecedentes del paciente" rows="2"></textarea>
        </div>

        <hr style="margin:10px 0;border:none;border-top:1px solid #ddd;" />
        <h4 style="margin:0;text-align:center;color:#0a86d8;">Detalles de la cita</h4>
        <input type="text" id="ncDoctor" placeholder="Doctor asignado" required />
        <input type="date" id="ncFecha" required value="${Bp(r)}" />
        <input type="time" id="ncHora" required />
        <input type="text" id="ncEspacio" placeholder="Espacio fsico / Sala" />
        <textarea id="ncComentario" placeholder="Comentario sobre la cita" rows="3"></textarea>

        <div style="display:flex;justify-content:flex-end;gap:10px;margin-top:10px;">
          <button type="button" id="btnCancelarModal" class="btn-cancelar">Cancelar</button>
          <button type="submit" class="btn-guardar">Guardar</button>
        </div>
      </form>
    `;const ce=document.createElement("style");ce.textContent=`
      .btn-cancelar, .btn-guardar { padding: 8px 14px; border: none; border-radius: 6px; cursor: pointer; font-weight: 600; font-size: 14px; transition: .2s; }
      .btn-cancelar { background: #e0e0e0; color: #333; } .btn-cancelar:hover { background: #d5d5d5; }
      .btn-guardar { background: #0a86d8; color: white; } .btn-guardar:hover { background: #0669ac; }
      input, select, textarea { width: 100%; padding: 8px 10px; border: 1px solid #ccc; border-radius: 6px; font-size: 14px; outline: none; }
      input:focus, select:focus, textarea:focus { border-color: #0a86d8; box-shadow: 0 0 0 2px rgba(10,134,216,.2); }
      .ac-item { padding: 8px 10px; display:flex; gap:8px; align-items:baseline; cursor:pointer; }
      .ac-item:hover, .ac-item.active { background:#f5f7fb; }
      .ac-name { font-weight:600; } .ac-doc { color:#64748b; font-size:12px; } .ac-tel { margin-left:auto; font-size:12px; color:#0f172a; }
      .ac-empty { padding:10px; color:#9aa4b2; font-size:13px; }
    `,document.head.appendChild(ce),U.appendChild(ne),document.body.appendChild(U);const Te=ne.querySelector("#esNuevoPaciente"),be=ne.querySelector("#nuevoPacienteCampos"),je=ne.querySelector("#buscarPaciente"),_e=ne.querySelector("#acResultados");Te.addEventListener("change",()=>{be.style.display=Te.checked?"flex":"none",Te.checked&&(_e.style.display="none")}),ne.querySelector("#btnCancelarModal").addEventListener("click",()=>U.remove());let it=null,Re=null,le=-1,Oe=[];const $e=ie=>{if(Oe=ie||[],le=-1,!ie||ie.length===0){_e.innerHTML='<div class="ac-empty">Sin resultados</div>',_e.style.display="block";return}_e.innerHTML=ie.map((ye,ve)=>`
            <div class="ac-item" data-index="${ve}" data-id="${ye.id}">
              <span class="ac-name">${ye.nombre}</span>
              <span class="ac-doc"> ${ye.documento||"s/doc"}</span>
              <span class="ac-tel">${ye.celular||ye.telefono||""}</span>
            </div>`).join(""),_e.style.display="block",[..._e.querySelectorAll(".ac-item")].forEach(ye=>{ye.addEventListener("click",()=>{const ve=Number(ye.getAttribute("data-index"));tt(ve)})})},tt=ie=>{const ye=Oe[ie];ye&&(Re=ye,je.value=ye.nombre,_e.style.display="none",Te.checked=!1,be.style.display="none")},H=ie=>{Oe.length&&(le=(le+ie+Oe.length)%Oe.length,[..._e.querySelectorAll(".ac-item")].forEach((ye,ve)=>{ve===le?ye.classList.add("active"):ye.classList.remove("active")}))},se=(ie,ye)=>ie.nombreCompleto||ie.paciente||[ie.nombres,ie.apellidos].filter(Boolean).join(" ")||ye,B=async ie=>{const ye=(ie||"").toString().trim(),ve=Fo(ye);if(!ve||ve.length<2)return[];if(/^\d{5,}$/.test(ye))try{const Me=st(Pe(ue,"pacientes"),Xe("documento","==",ye)),Se=st(Pe(ue,"pacientes"),Xe("nroDocumento","==",ye)),[Le,Ae]=await Promise.all([Vt(Me),Vt(Se)]),Ie=Le.empty?Ae:Le;if(!Ie.empty)return Ie.docs.slice(0,10).map(M=>{const Y=M.data()||{};return{id:M.id,nombre:se(Y,M.id),documento:Y.documento||Y.nroDocumento||M.id,celular:Y.celularPaciente||Y.celular||"",telefono:Y.telefonoPaciente||Y.telefono||""}})}catch{}try{const Me=st(Pe(ue,"pacientes"),gn("nombre_busqueda"),qI(ve),HI(ve+""),wa(10)),Se=await Vt(Me);if(!Se.empty)return Se.docs.map(Le=>{const Ae=Le.data()||{};return{id:Le.id,nombre:se(Ae,Le.id),documento:Ae.documento||Ae.nroDocumento||Le.id,celular:Ae.celularPaciente||Ae.celular||"",telefono:Ae.telefonoPaciente||Ae.telefono||""}})}catch{}try{const Me=st(Pe(ue,"pacientes"),gn("creado","desc"),wa(50));return(await Vt(Me)).docs.map(Ie=>({id:Ie.id,...Ie.data()||{}})).map(Ie=>({id:Ie.id,nombre:se(Ie,Ie.id),documento:Ie.documento||Ie.nroDocumento||Ie.id,celular:Ie.celularPaciente||Ie.celular||"",telefono:Ie.telefonoPaciente||Ie.telefono||"",_norm:Fo(`${Ie.nombreCompleto||Ie.paciente||""} ${Ie.nombres||""} ${Ie.apellidos||""} ${Ie.documento||Ie.nroDocumento||""}`)})).filter(Ie=>Ie._norm.includes(ve)).slice(0,10).map(({_norm:Ie,...M})=>M)}catch{}return[]};je.addEventListener("input",()=>{Re=null;const ie=je.value;if(clearTimeout(it),!ie||ie.trim().length<2){_e.style.display="none";return}it=setTimeout(async()=>{const ye=await B(ie.trim());$e(ye)},220)}),je.addEventListener("keydown",ie=>{_e.style.display==="block"&&(ie.key==="ArrowDown"?(ie.preventDefault(),H(1)):ie.key==="ArrowUp"?(ie.preventDefault(),H(-1)):ie.key==="Enter"?le>=0&&(ie.preventDefault(),tt(le)):ie.key==="Escape"&&(_e.style.display="none"))}),document.addEventListener("click",ie=>{ne.contains(ie.target)&&!_e.contains(ie.target)&&ie.target!==je&&(_e.style.display="none")},{capture:!0});const re=ne.querySelector("#formNuevaCita");re.addEventListener("submit",async ie=>{ie.preventDefault();const ye=Te.checked,ve=(re.querySelector("#buscarPaciente").value||"").trim(),Me=re.querySelector("#ncDoctor").value.trim(),Se=re.querySelector("#ncFecha").value,Le=re.querySelector("#ncHora").value,Ae=re.querySelector("#ncEspacio").value.trim(),Ie=re.querySelector("#ncComentario").value.trim();if(!Se||!Le){alert(" Debes seleccionar fecha y hora para la cita.");return}if(!Me){alert(" Indica el doctor asignado.");return}try{let M=null,Y=null,J="",Ce="",nt="";if(ye){const jn=(re.querySelector("#npNombre").value||"").trim(),en=(re.querySelector("#npApellido").value||"").trim();if(J=`${jn} ${en}`.trim(),!J){alert(" Debes indicar nombre y apellido para el nuevo paciente.");return}const Ct=(re.querySelector("#npDocumento").value||"").trim(),Bt=(re.querySelector("#npCelular").value||"").trim(),zt=(re.querySelector("#npTelefono").value||"").trim();if(!Bt&&!zt){alert(" Debes registrar al menos un telfono (celular o fijo) del paciente o de un acudiente.");return}if(M=Ct||J.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/\s+/g,"_"),Y=mt(ue,"pacientes",M),!(await za(Y)).exists()){const At=Fo(J);await bh(Y,{nombres:jn,apellidos:en,nombreCompleto:J,paciente:J,nombre_busqueda:At,variantes_busqueda:[At,Fo(jn),Fo(en)],tipoDocumento:re.querySelector("#npTipoDocumento").value,documento:Ct,correo:(re.querySelector("#npCorreo").value||"").trim(),indicativo:re.querySelector("#npIndicativo").value,celular:Bt,telefono:zt,celularPaciente:Bt,telefonoPaciente:zt,fechaNacimiento:re.querySelector("#npNacimiento").value,sexo:re.querySelector("#npSexo").value,notas:(re.querySelector("#npComentario").value||"").trim(),creado:new Date().toISOString(),activo:!0,citas:[]},{merge:!0})}Ce=Bt,nt=zt}else if(Re)M=Re.id,J=Re.nombre,Y=mt(ue,"pacientes",M),Ce=Re.celular||"",nt=Re.telefono||"";else{if(!ve){alert(" Por favor, escribe o selecciona un paciente.");return}const jn=st(Pe(ue,"pacientes"),Xe("documento","==",ve)),en=st(Pe(ue,"pacientes"),Xe("nroDocumento","==",ve)),[Ct,Bt]=await Promise.all([Vt(jn),Vt(en)]),zt=Ct.empty?Bt:Ct;if(zt.empty){let Ke=null;try{const At=Fo(ve),Nr=st(Pe(ue,"pacientes"),gn("nombre_busqueda"),qI(At),HI(At+""),wa(1)),dr=await Vt(Nr);if(!dr.empty){const Ts=dr.docs[0],On=Ts.data()||{};Ke={id:Ts.id,ref:Ts.ref,nombre:On.nombreCompleto||On.paciente||[On.nombres,On.apellidos].filter(Boolean).join(" "),cel:On.celularPaciente||On.celular||"",tel:On.telefonoPaciente||On.telefono||""}}}catch{}Ke?(M=Ke.id,Y=Ke.ref,J=Ke.nombre||ve,Ce=Ke.cel||"",nt=Ke.tel||""):J=ve}else{const Ke=zt.docs[0],At=Ke.data()||{};M=Ke.id,Y=Ke.ref,J=At.nombreCompleto||At.paciente||[At.nombres,At.apellidos].filter(Boolean).join(" ")||ve,Ce=At.celularPaciente||At.celular||"",nt=At.telefonoPaciente||At.telefono||""}}if(!(Ce||nt||"").trim()){alert(" Este paciente no tiene ningn telfono registrado. Edita sus datos y agrega un nmero antes de guardar la cita.");return}const Rr={paciente:J||"Paciente",pacienteId:M||null,doctor:Me,fecha:Se,horaInicio:Le,espacio:Ae,comentario:Ie,estado:"En espera",creado:new Date().toISOString(),celularPaciente:Ce||"",telefonoPaciente:nt||""},xn=await Br(Pe(ue,"citas"),Rr);Y&&await bh(Y,{citas:WM(xn.id)},{merge:!0}),alert(" Cita registrada correctamente y vinculada al paciente."),U.remove()}catch(M){console.error(" Error al guardar cita:",M),alert(" Error al guardar la cita. Revisa la consola para ms detalles.")}})},Ye=U=>{var it,Re;const ne=document.createElement("div");Object.assign(ne.style,{position:"fixed",top:"0",left:"0",width:"100%",height:"100%",background:"rgba(0,0,0,0.55)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:"9999"});const ce=document.createElement("div");Object.assign(ce.style,{background:"#fff",padding:"25px 30px",borderRadius:"14px",width:"520px",maxWidth:"95%",maxHeight:"95%",overflowY:"auto",boxShadow:"0 8px 30px rgba(0,0,0,0.3)",fontFamily:"Segoe UI, Roboto, sans-serif"});const Te=(it=U.raw)!=null&&it.fecha&&typeof U.raw.fecha=="string"?U.raw.fecha:Bp(U.fecha),be=((Re=U.raw)==null?void 0:Re.horaInicio)||U.fecha.toTimeString().slice(0,5);ce.innerHTML=`
      <h2 style="margin-top:0;text-align:center;color:#0a86d8;font-weight:600;"> Editar Cita</h2>
      <form id="formEditarCita" style="display:flex;flex-direction:column;gap:12px;margin-top:10px;">
        <label>Paciente</label>
        <input type="text" id="editPaciente" value="${U.paciente||""}" />

        <label>Doctor asignado</label>
        <input type="text" id="editDoctor" value="${U.doctor||""}" />

        <div style="display:flex;gap:8px;">
          <div style="flex:1;">
            <label>Fecha</label>
            <input type="date" id="editFecha" value="${Te}" />
          </div>
          <div style="flex:1;">
            <label>Hora</label>
            <input type="time" id="editHora" value="${be}" />
          </div>
        </div>

        <label>Espacio fsico / Sala</label>
        <input type="text" id="editEspacio" value="${U.espacio||""}" />

        <label>Estado</label>
        <select id="editEstado" class="estado-select">
          <option value="En espera" ${U.estado==="En espera"?"selected":""}>En espera</option>
          <option value="En sala" ${U.estado==="En sala"?"selected":""}>En sala</option>
          <option value="Atendiendo" ${U.estado==="Atendiendo"?"selected":""}>Atendiendo</option>
          <option value="Finalizada" ${U.estado==="Finalizada"?"selected":""}>Finalizada</option>
          <option value="pendiente" ${U.estado==="pendiente"?"selected":""}>Pendiente</option>
          <option value="No asisti" ${U.estado==="No asisti"?"selected":""}>No asisti</option>
        </select>

        <label>Comentario</label>
        <textarea id="editComentario" rows="3">${U.comentario||""}</textarea>

        <div style="display:flex;justify-content:flex-end;gap:10px;margin-top:10px;">
          <button type="button" id="btnCancelarEdit" class="btn-cancelar">Cancelar</button>
          <button type="submit" class="btn-guardar">Guardar cambios</button>
        </div>
      </form>
    `;const je=document.createElement("style");je.textContent=`
      .btn-cancelar, .btn-guardar { padding: 8px 14px; border: none; border-radius: 6px; cursor: pointer; font-weight: 600; font-size: 14px; transition: .2s; }
      .btn-cancelar { background: #e0e0e0; color: #333; } .btn-cancelar:hover { background: #d5d5d5; }
      .btn-guardar { background: #0a86d8; color: white; } .btn-guardar:hover { background: #0669ac; }
      #formEditarCita input, #formEditarCita select, #formEditarCita textarea { width: 100%; padding: 8px 10px; border: 1px solid #ccc; border-radius: 6px; font-size: 14px; outline: none; }
      #formEditarCita input:focus, #formEditarCita select:focus, #formEditarCita textarea:focus { border-color: #0a86d8; box-shadow: 0 0 0 2px rgba(10,134,216,.2); }
    `,document.head.appendChild(je),ne.appendChild(ce),document.body.appendChild(ne),ce.querySelector("#btnCancelarEdit").addEventListener("click",()=>ne.remove());const _e=ce.querySelector("#formEditarCita");_e.addEventListener("submit",async le=>{le.preventDefault();const Oe=_e.querySelector("#editPaciente").value.trim(),$e=_e.querySelector("#editDoctor").value.trim(),tt=_e.querySelector("#editFecha").value,H=_e.querySelector("#editHora").value,se=_e.querySelector("#editEspacio").value.trim(),B=_e.querySelector("#editEstado").value,re=_e.querySelector("#editComentario").value.trim();if(!Oe)return alert(" El nombre del paciente es obligatorio.");if(!tt||!H)return alert(" Debes indicar fecha y hora.");try{const ie=mt(ue,"citas",U.id);await ui(ie,{paciente:Oe,doctor:$e,fecha:tt,horaInicio:H,espacio:se,estado:B,comentario:re}),alert(" Cita actualizada correctamente."),ne.remove()}catch(ie){console.error(" Error al actualizar cita:",ie),alert(" Error al actualizar la cita. Revisa la consola para ms detalles.")}})},jt=U=>{const ne=U.fecha.toLocaleDateString(Vn),ce=U.fecha.toLocaleTimeString(Vn,{hour:"numeric",minute:"2-digit",hour12:!0}),Te=`${ne}  ${ce}`;return l.jsxs("tr",{className:"fade-in-row",onClick:()=>Ye(U),style:{cursor:"pointer"},children:[l.jsx("td",{children:Te}),l.jsx("td",{children:U.paciente}),l.jsx("td",{children:U.doctor}),l.jsx("td",{children:U.espacio}),l.jsx("td",{children:U.comentario}),l.jsx("td",{onClick:be=>{be.stopPropagation()},children:l.jsxs("select",{className:"estado-select",value:U.estado,onChange:be=>ee(U.id,be.target.value),children:[l.jsx("option",{value:"En espera",children:"En espera"}),l.jsx("option",{value:"En sala",children:"En sala"}),l.jsx("option",{value:"Atendiendo",children:"Atendiendo"}),l.jsx("option",{value:"Finalizada",children:"Finalizada"}),l.jsx("option",{value:"pendiente",children:"Pendiente"}),l.jsx("option",{value:"No asisti",children:"No asisti"})]})}),l.jsxs("td",{className:"acciones-cell",onClick:be=>{be.stopPropagation()},children:[U.telefono?l.jsx("button",{type:"button",className:"btn-whatsapp",onClick:be=>{be.stopPropagation(),he(U.telefono,U)},children:"WhatsApp"}):l.jsx("span",{className:"acciones-texto",children:"Sin celular"}),l.jsx("button",{type:"button",className:"btn-delete",onClick:be=>{be.stopPropagation(),me(U)},children:"Eliminar"}),U.recordatorio&&l.jsx("span",{className:"acciones-texto",children:U.recordatorio})]})]},U.id)};return l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"odc-topbar-green"}),l.jsx("div",{className:"odc-topbar-blue",children:"Agenda"}),l.jsx("section",{className:"odc-agenda-root",children:l.jsxs("div",{className:"odc-agenda-inner",children:[l.jsxs("aside",{className:"odc-left","aria-label":"Panel izquierdo - calendario y filtros",children:[l.jsxs("div",{className:"odc-mini-calendar-card",role:"region","aria-label":"Mini calendario",children:[l.jsxs("div",{className:"mini-cal-header",children:[l.jsx("button",{className:"cal-arrow",id:"miniCalPrev","aria-label":"Mes anterior",onClick:F,children:""}),l.jsx("div",{id:"miniCalMonthYear","aria-live":"polite",children:w}),l.jsx("button",{className:"cal-arrow",id:"miniCalNext","aria-label":"Mes siguiente",onClick:x,children:""})]}),l.jsxs("table",{className:"mini-month-table","aria-hidden":"false",children:[l.jsx("thead",{children:l.jsxs("tr",{children:[l.jsx("th",{children:"Lu"}),l.jsx("th",{children:"Ma"}),l.jsx("th",{children:"Mi"}),l.jsx("th",{children:"Ju"}),l.jsx("th",{children:"Vi"}),l.jsx("th",{children:"Sa"}),l.jsx("th",{children:"Do"})]})}),l.jsx("tbody",{id:"miniCalendar",children:O.map((U,ne)=>l.jsx("tr",{children:U.map((ce,Te)=>l.jsx("td",{className:[ce.isCurrentMonth?"":"empty",ce.isToday?"today":"",ce.isSelected?"selected":""].filter(Boolean).join(" "),onClick:()=>ce.isCurrentMonth&&I(ce.date),children:ce.date.getDate()},Te))},ne))})]})]}),l.jsxs("div",{className:"odc-filters-card","aria-label":"Filtros de agenda",children:[l.jsx("label",{htmlFor:"filterSucursal",children:"Sucursal"}),l.jsxs("select",{id:"filterSucursal",value:f,onChange:U=>m(U.target.value),children:[l.jsx("option",{value:"",children:" Todas "}),T.map(U=>l.jsx("option",{value:U,children:U},U))]}),l.jsx("label",{htmlFor:"filterDoctor",children:"Doctores"}),l.jsxs("select",{id:"filterDoctor",value:_,onChange:U=>R(U.target.value),children:[l.jsx("option",{value:"",children:" Todos "}),y.map(U=>l.jsx("option",{value:U,children:U},U))]})]})]}),l.jsxs("main",{className:"odc-right","aria-label":"Panel principal - agenda",children:[l.jsxs("div",{className:"odc-header-bar",role:"region","aria-label":"Controles de la agenda",style:{display:"flex",alignItems:"center",justifyContent:"space-between",gap:12},children:[l.jsxs("div",{className:"odc-header-left",style:{display:"flex",alignItems:"center",gap:12,flexWrap:"wrap"},children:[l.jsx("h3",{className:"odc-title",style:{marginRight:8},children:"Agenda"}),l.jsxs("div",{className:"view-buttons",role:"tablist","aria-label":"Vistas",style:{display:"flex",gap:6},children:[l.jsx("button",{className:`btn view ${e==="day"?"active":""}`,"data-view":"day",role:"tab","aria-selected":e==="day",onClick:()=>n("day"),children:"Da"}),l.jsx("button",{className:`btn view ${e==="week"?"active":""}`,"data-view":"week",role:"tab","aria-selected":e==="week",onClick:()=>n("week"),children:"Semana"}),l.jsx("button",{className:`btn view ${e==="detail"?"active":""}`,"data-view":"detail",role:"tab","aria-selected":e==="detail",onClick:()=>n("detail"),children:"Detalle"})]}),l.jsxs("div",{className:"date-nav",style:{display:"flex",alignItems:"center",gap:6,flex:"0 0 auto"},children:[l.jsx("button",{className:"btn icon",id:"btnPrev","aria-label":"Anterior",onClick:D,children:""}),l.jsx("button",{className:"btn icon",id:"btnNext","aria-label":"Siguiente",onClick:j,children:""}),l.jsx("span",{id:"currentDateDisplay",className:"current-date","aria-live":"polite",style:{whiteSpace:"nowrap"},children:P}),l.jsx("button",{id:"btnHoy",className:"btn small",onClick:k,children:"Hoy"})]})]}),l.jsx("div",{className:"odc-header-right",style:{display:"flex",alignItems:"center",gap:8,flexShrink:0},children:l.jsxs("div",{className:"right-actions",style:{display:"flex",alignItems:"center",gap:8},children:[l.jsx("input",{id:"searchCitas",placeholder:"Buscar...",className:"search-input","aria-label":"Buscar citas",value:C,onChange:U=>N(U.target.value)}),l.jsx("button",{id:"btnNuevaCita",className:"btn green","aria-label":"Nueva cita",onClick:ke,children:"+ Nueva cita"})]})})]}),l.jsxs("div",{className:"odc-content-card",role:"region","aria-label":"Contenido agenda",children:[l.jsxs("div",{className:"tools-row",children:[l.jsx("div",{className:"tools-left",children:l.jsx("div",{id:"ocupacionInfo",className:"ocupacion-info",children:E})}),l.jsxs("div",{className:"tools-right",children:[l.jsx("button",{id:"btnPrint",className:"btn",title:"Imprimir agenda",onClick:K,children:" Imprimir"}),l.jsx("button",{id:"btnConfirmar",className:"btn blue",title:"Confirmar citas",onClick:Ge,children:" Confirmar"}),l.jsx("button",{id:"btnHoyCitas",className:"btn",title:"Ver citas de hoy",onClick:$t,children:" Hoy"}),l.jsx("button",{id:"btnExportar",className:"btn",title:"Exportar citas a CSV",onClick:hn,children:" Exportar"})]})]}),l.jsx("div",{className:"table-wrap",role:"region","aria-label":"Lista de citas",children:l.jsxs("table",{className:"appointments-table","aria-live":"polite",children:[l.jsx("thead",{children:l.jsxs("tr",{children:[l.jsx("th",{style:{width:"180px"},children:"Fecha / Hora"}),l.jsx("th",{children:"Paciente"}),l.jsx("th",{children:"Doctor"}),l.jsx("th",{children:"Espacio fsico"}),l.jsx("th",{children:"Comentario"}),l.jsx("th",{style:{width:"120px"},children:"Estado"}),l.jsx("th",{children:"Acciones"})]})}),l.jsx("tbody",{id:"citasTbody",children:a?l.jsx("tr",{children:l.jsx("td",{colSpan:7,className:"no-data",children:"Cargando citas..."})}):v.length===0?l.jsx("tr",{children:l.jsx("td",{colSpan:7,className:"no-data",children:"No hay citas registradas para este rango."})}):v.map(jt)})]})})]})]})]})})]})}function MU(){return l.jsxs("div",{style:{padding:"20px"},children:[l.jsx("h2",{children:"Mdulo de Facturacin"}),l.jsx("p",{children:"Aqu se registrarn los pagos, facturas y cobros."})]})}function FU(){return l.jsxs("div",{style:{padding:"20px"},children:[l.jsx("h2",{children:"Mdulo de Facturacin"}),l.jsx("p",{children:"Aqu se registrarn los pagos, facturas y cobros."})]})}function UU(){return l.jsxs("div",{style:{padding:"20px"},children:[l.jsx("h2",{children:"Mdulo de Facturacin"}),l.jsx("p",{children:"Aqu se registrarn los pagos, facturas y cobros."})]})}const Yu={caja:"caja",pagos:"facturacion/pagos",facturas:"facturacion/facturas"};var Cx;const Bl=typeof navigator<"u"&&((Cx=navigator.language)!=null&&Cx.startsWith("es"))?"es-ES":"en-US",$U=["Colombia","Argentina","Bolivia","Chile","Costa Rica","Cuba","Ecuador","El Salvador","Espaa","Guatemala","Honduras","Mxico","Nicaragua","Panam","Paraguay","Per","Puerto Rico","Repblica Dominicana","Uruguay","Venezuela","Estados Unidos","Canad"],zp={Colombia:["Bogot","Medelln","Cali","Barranquilla","Cartagena","Ccuta","Bucaramanga","Pereira","Santa Marta","Ibagu"],Mxico:["Ciudad de Mxico","Guadalajara","Monterrey","Puebla","Quertaro","Tijuana","Mrida","Len"],Per:["Lima","Arequipa","Trujillo","Chiclayo","Cusco","Piura"],Chile:["Santiago","Valparaso","Concepcin","La Serena","Antofagasta"],Argentina:["Buenos Aires","Crdoba","Rosario","Mendoza","La Plata"],Espaa:["Madrid","Barcelona","Valencia","Sevilla","Zaragoza","Bilbao"],"Estados Unidos":["Miami","New York","Los ngeles","Houston","Chicago"],Ecuador:["Quito","Guayaquil","Cuenca","Manta"],Venezuela:["Caracas","Maracaibo","Valencia","Barquisimeto","Maracay"]},BU=t=>{if(!t)return"";const[e,n,r]=t.split("-").map(c=>parseInt(c,10)),s=new Date(e,(n||1)-1,r||1),i=new Date;let o=i.getFullYear()-s.getFullYear();const a=i.getMonth()-s.getMonth();return(a<0||a===0&&i.getDate()<s.getDate())&&o--,isNaN(o)?"":String(o)};async function _x(t,{maxW:e=900,maxH:n=900,quality:r=.82}={}){var m;if(!t||!((m=t.type)!=null&&m.startsWith("image/")))return t;const s=await new Promise((_,R)=>{const C=new Image;C.onload=()=>_(C),C.onerror=R,C.src=URL.createObjectURL(t)});let{width:i,height:o}=s;const a=Math.min(e/i,n/o,1);i=Math.round(i*a),o=Math.round(o*a);const c=document.createElement("canvas");c.width=i,c.height=o,c.getContext("2d").drawImage(s,0,0,i,o);const h=await new Promise(_=>c.toBlob(_,"image/jpeg",r)),f=new File([h],(t.name||"foto.jpg").replace(/\.[^.]+$/,".jpg"),{type:"image/jpeg",lastModified:Date.now()});return URL.revokeObjectURL(s.src),f}const zl=t=>(t||"").toString().toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/\s+/g," ").trim(),zU=t=>zl([t.nombres,t.apellidos,t.nombreCompleto,t.nroDocumento,t.celular,t.email].filter(Boolean).join(" ")),qU=t=>{if(!t)return"";const e=new Date(t),n=e.getFullYear(),r=String(e.getMonth()+1).padStart(2,"0"),s=String(e.getDate()).padStart(2,"0"),i=String(e.getHours()).padStart(2,"0"),o=String(e.getMinutes()).padStart(2,"0");return`${n}-${r}-${s}T${i}:${o}`},HU=t=>{try{return new Date(t).toLocaleString(Bl,{dateStyle:"medium",timeStyle:"short"})}catch{return""}},Uo={tipoDocumento:"",nroDocumento:"",nroHistoria:"",nombres:"",apellidos:"",nombreCompleto:"",sexo:"",estadoCivil:"",paisNacimiento:"",ciudadNacimiento:"",fechaIngreso:"",fechaNacimiento:"",edad:"",paisDomicilio:"",ciudadDomicilio:"",barrio:"",lugarResidencia:"",estrato:"",zonaResidencial:"",esExtranjero:!1,permitePublicidad:!1,celular:"",telDomicilio:"",telOficina:"",extension:"",email:"",ocupacion:"",nombreResponsable:"",parentesco:"",celularResponsable:"",telefonoResponsable:"",emailResponsable:"",nombreAcompanante:"",telefonoAcompanante:"",convenioBeneficio:"",comoConocio:"",campania:"",remitidoPor:"",asesorComercial:"",tipoVinculacion:"",nombreEps:"",polizaSalud:"",doctor:"",notas:"",rxImagenes:[],historiaClinica:{antecedentes:"",alergias:"",medicamentos:"",motivoConsulta:"",notas:""},odontograma:[],periodontograma:[],presupuestos:[],evoluciones:[],facturacion:{saldoFavor:0,saldoCredito:0},fotoUrl:"",activo:!0},qp=20,$o=t=>Number(t||0);function WU(t){const[e,n]=A.useState(!1),[r,s]=A.useState([]),[i,o]=A.useState([]),[a,c]=A.useState("");A.useEffect(()=>{let N=!0;return(async()=>{if(!t){s([]),o([]);return}n(!0),c("");try{let y=st(Pe(ue,"facturas"),Xe("patientId","==",t),gn("fechaISO","desc"));const O=(await Vt(y)).docs.map(P=>({id:P.id,...P.data()})).map(P=>({...P,total:$o(P.total??P.valor??P.montoTotal),estado:(P.estado||"pendiente").toLowerCase(),fechaISO:P.fechaISO||P.fecha||null}));let F=st(Pe(ue,"pagos"),Xe("patientId","==",t),gn("fechaISO","desc"));const w=(await Vt(F)).docs.map(P=>({id:P.id,...P.data()})).map(P=>({...P,monto:$o(P.monto??P.valor??P.total),fechaISO:P.fechaISO||P.fecha||null,medio:P.medio||P.metodo||""}));if(!N)return;s(O),o(w)}catch(y){console.warn("Finanzas: no se pudo leer colecciones. Contino solo con saldos del paciente.",y),N&&c("No se pudieron leer facturas/pagos.")}finally{N&&n(!1)}})(),()=>{N=!1}},[t]);const d=r.reduce((N,T)=>N+$o(T.total),0),h=i.reduce((N,T)=>N+$o(T.monto),0),f=r.filter(N=>["pagada","pagado","paid"].includes((N.estado||"").toLowerCase())),m=r.filter(N=>["pendiente","abierta","open","deuda"].includes((N.estado||"").toLowerCase())),_=f.reduce((N,T)=>N+$o(T.total),0),R=m.reduce((N,T)=>N+$o(T.total),0);return{loading:e,error:a,facturas:r,pagos:i,totalFacturado:d,totalPagado:h,totalFacturasPendientes:R,totalFacturasPagadas:_}}function GU(t){const[e,n]=A.useState(!1),[r,s]=A.useState([]);return A.useEffect(()=>{if(!t){s([]);return}n(!0);const i=Pe(ue,"citas"),o=_=>{const R=_.data()||{},C=typeof R.fecha=="string"?R.fecha:"",N=(R.horaInicio||R.hora||"00:00").slice(0,5);let T=null;if(C){const[y,v,E]=C.split("-").map(I=>parseInt(I,10)),[O,F]=N.split(":").map(I=>parseInt(I,10)||0);T=new Date(y,(v||1)-1,E||1,O,F,0,0).toISOString()}return{id:_.id,...R,fechaISO:T,motivo:R.motivo||R.comentario||"",profesional:R.doctor||R.doctorNombre||"",fechaYYYYMMDD:C}};let a=new Map;const c=()=>{const _=Array.from(a.values());_.sort((R,C)=>{const N=R.fechaISO||"",T=C.fechaISO||"";if(N<T)return 1;if(N>T)return-1;const y=R.creado||"",v=C.creado||"";return y<v?1:y>v?-1:0}),s(_),n(!1)},d=st(i,Xe("pacienteId","==",t)),h=st(i,Xe("patientId","==",t)),f=Un(d,_=>{_.docChanges().forEach(R=>{R.type==="removed"?a.delete(R.doc.id):a.set(R.doc.id,o(R.doc))}),c()},()=>n(!1)),m=Un(h,_=>{_.docChanges().forEach(R=>{R.type==="removed"?a.delete(R.doc.id):a.set(R.doc.id,o(R.doc))}),c()},()=>n(!1));return()=>{try{f()}catch{}try{m()}catch{}}},[t]),{loading:e,citas:r}}function KU(){var Nr,dr,Ts,On,Xr,du,hu,Ci,rl;const t=Es(),e=Dn(),n=Mx.useMemo(()=>{const b=e.pathname.split("/").filter(Boolean),q=b.findIndex(ge=>["pacientes","agenda","caja","facturacion","config","reportes","software"].includes(ge)),de="/"+b.slice(0,q>=0?q:b.length).join("/");return de==="/"?"":de},[e.pathname]),r=b=>{const q=String(b||"").replace(/^\//,""),X=n?`${n}/`:"/";t(`${X}${q}`)},s=(b,q)=>{const X=String(b).replace(/^\//,""),de=q?new URLSearchParams(q).toString():"";return`${n?`${n}/`:"/"}${X}${de?`?${de}`:""}`},i=(b,q)=>{const X=String(b||"").slice(0,10);if(!X)return r("agenda");try{sessionStorage.setItem("agenda.targetDate",X)}catch{}const de=new URLSearchParams({date:X,day:X,d:X,fecha:X,selectedDate:X,ts:String(new Date(X+"T00:00:00").getTime()),patientId:q||""}).toString();r(`agenda?${de}`)},[o,a]=A.useState(!0),[c,d]=A.useState([]),[h,f]=A.useState(""),[m,_]=A.useState(null),[R,C]=A.useState(!0),[N,T]=A.useState(!1),[y,v]=A.useState(null),[E,O]=A.useState(null),F=A.useRef(null),[x,I]=A.useState("datos"),[w,P]=A.useState(Uo),[D,j]=A.useState(null),[k,K]=A.useState(""),[Ge,$t]=A.useState([]),[hn,ee]=A.useState(!1),he=A.useRef(null),me="comfy",[ke,Ye]=A.useState(""),jt=A.useMemo(()=>{switch(me){case"comfy":return{thumbW:220,thumbH:165,colMin:240};case"cozy":return{thumbW:160,thumbH:120,colMin:180};default:return{thumbW:120,thumbH:90,colMin:140}}},[me]),U=b=>{var X,de;if((de=(X=b==null?void 0:b.type)==null?void 0:X.startsWith)!=null&&de.call(X,"image/"))return!0;const q=((b==null?void 0:b.name)||(b==null?void 0:b.title)||"").toLowerCase();return/\.(png|jpe?g|gif|bmp|webp|tiff?)$/.test(q)},ne=A.useMemo(()=>{const b=ke.trim().toLowerCase(),q=Array.isArray(E==null?void 0:E.rxImagenes)?E.rxImagenes:[];let X=q;return b?X=q.filter(de=>`${de.name||""} ${de.title||""} ${de.desc||""}`.toLowerCase().includes(b)):X=q.slice(),X.sort((de,ge)=>{const We=de.uploadedAtMS??de.created??0;return(ge.uploadedAtMS??ge.created??0)-We}),X},[E==null?void 0:E.rxImagenes,ke]),ce=async(b,q)=>{if(!(E!=null&&E.id))return;const X=Array.isArray(E.rxImagenes)?[...E.rxImagenes]:[];X[b]={...X[b]||{},...q},await J({rxImagenes:X})},Te=()=>{const b=new Date,q=b.getFullYear(),X=String(b.getMonth()+1).padStart(2,"0"),de=String(b.getDate()).padStart(2,"0");return`${q}-${X}-${de}`},[be,je]=A.useState(Te()),[_e,it]=A.useState(""),[Re,le]=A.useState(""),[Oe,$e]=A.useState(""),[tt,H]=A.useState("");A.useEffect(()=>{le((E==null?void 0:E.doctor)||"")},[E==null?void 0:E.doctor,E==null?void 0:E.id]);const se=async()=>{if(!(E!=null&&E.id))return alert("Paciente no cargado.");if(!be)return alert("Selecciona la fecha.");if(!_e)return alert("Selecciona la hora.");if(!Re.trim())return alert("Indica el doctor.");const b=E.nombreCompleto||E.paciente||"Paciente",q=E.celular||E.celularPaciente||"",X=E.telDomicilio||E.telefonoPaciente||"";if(!q&&!X)return alert("Este paciente no tiene telfono registrado (celular o fijo). Agrega uno antes de crear la cita.");try{const de={paciente:b,pacienteId:E.id,doctor:Re.trim(),fecha:be,horaInicio:_e,espacio:Oe||"",comentario:tt||"",estado:"En espera",creado:new Date().toISOString(),celularPaciente:q,telefonoPaciente:X};await Br(Pe(ue,"citas"),de),it(""),$e(""),H(""),alert(" Cita creada. Ya aparece en la lista y en Agenda.")}catch(de){console.error("Error creando cita:",de),alert("No se pudo crear la cita.")}};A.useMemo(()=>zp[w.paisNacimiento]||[],[w.paisNacimiento]),A.useEffect(()=>((async()=>{a(!0);try{const X=(await Vt(Pe(ue,"eps"))).docs.map(ge=>{var We;return(We=ge.data())==null?void 0:We.nombre}).filter(Boolean),de=Array.from(new Map(X.map(ge=>[String(ge).toLowerCase(),ge])).values()).sort((ge,We)=>ge.localeCompare(We,"es"));$t(de),await ye(!0)}catch(q){console.error(q),alert("No se pudieron cargar pacientes/EPS.")}finally{a(!1)}})(),()=>{F.current&&(F.current(),F.current=null)}),[]),A.useEffect(()=>{P(b=>({...b,nombreCompleto:`${b.nombres} ${b.apellidos}`.trim()}))},[w.nombres,w.apellidos]),A.useEffect(()=>{P(b=>({...b,nroHistoria:b.nroDocumento}))},[w.nroDocumento]),A.useEffect(()=>{P(b=>({...b,edad:BU(b.fechaNacimiento)}))},[w.fechaNacimiento]),A.useEffect(()=>{const b=new Date,q=b.toLocaleDateString(Bl)+" - "+b.toLocaleTimeString(Bl,{hour:"2-digit",minute:"2-digit",hour12:!0});P(X=>({...X,fechaIngreso:q}))},[]);const B=(b,q)=>P(X=>({...X,[b]:q})),re=()=>{P(Uo);const b=new Date,q=b.toLocaleDateString(Bl)+" - "+b.toLocaleTimeString(Bl,{hour:"2-digit",minute:"2-digit",hour12:!0});P(X=>({...X,fechaIngreso:q})),j(null),K(""),v(null)},ie=async b=>{if(!b){j(null),K("");return}try{const q=await _x(b,{maxW:900,maxH:900,quality:.82});j(q);const X=new FileReader;X.onload=de=>K(de.target.result),X.readAsDataURL(q)}catch{j(b);const q=new FileReader;q.onload=X=>K(X.target.result),q.readAsDataURL(b)}},ye=async(b=!1)=>{a(!0);try{let q;b||!m?q=st(Pe(ue,"pacientes"),gn("creado","desc"),wa(qp)):q=st(Pe(ue,"pacientes"),gn("creado","desc"),UM(m),wa(qp));const X=await Vt(q),de=X.docs.map(ge=>({id:ge.id,...ge.data()}));d(b?de:ge=>[...ge,...de]),_(X.docs[X.docs.length-1]||null),C(X.size===qp)}catch(q){console.error(q),alert("No se pudo cargar pacientes.")}finally{a(!1)}},ve=async b=>{if(b.preventDefault(),!w.nroDocumento.trim())return alert("El nmero de documento es obligatorio.");if(!w.nombres.trim())return alert("Los nombres son obligatorios.");if(!w.apellidos.trim())return alert("Los apellidos son obligatorios.");if(!w.sexo.trim())return alert("El sexo es obligatorio.");if(!w.fechaNacimiento.trim())return alert("La fecha de nacimiento es obligatoria.");if(!w.celular.trim())return alert("El celular es obligatorio.");if(!w.email.trim())return alert("El correo electrnico es obligatorio.");if(!w.tipoVinculacion.trim())return alert("El tipo de vinculacin es obligatorio.");if(!w.nombreEps.trim())return alert("El nombre de la EPS es obligatorio.");try{const q=w.nroDocumento.trim();if(!y&&(await za(mt(ue,"pacientes",q))).exists())return alert("Ya existe un paciente con ese nmero de documento.");const X=(w.nombreEps||"").trim(),de=Ge.map(Rt=>Rt.toLowerCase()).includes(X.toLowerCase());if(X&&!de&&window.confirm(`La EPS "${X}" no existe. Deseas guardarla para futuras selecciones?`)){const Tn=X.toLowerCase().replace(/\s+/g,"_");await bh(mt(ue,"eps",Tn),{nombre:X,nombreLower:X.toLowerCase(),creado:Xn()},{merge:!0})}let ge=w.fotoUrl||"",We="";if(D)try{const Rt=Bi(),Tn=(D.name||"foto.jpg").replace(/\s+/g,"_");We=`pacientes/${q}/${Date.now()}_${Tn}`;const bn=Al(Rt,We),hr={contentType:D.type||"image/jpeg",cacheControl:"public, max-age=86400"};await tx(bn,D,hr),ge=await rx(bn)}catch(Rt){console.error("Foto (warning):",Rt)}const Pr=w.creado||null,Qn=y&&Pr||Xn(),Yn={...w,fotoUrl:ge,nombre_busqueda:zU({...w,fotoUrl:ge}),nombresLower:zl(w.nombres),apellidosLower:zl(w.apellidos),documentoLower:zl(w.nroDocumento),emailLower:zl(w.email),creado:Qn,createdAt:Qn,actualizado:Xn(),updatedAt:Xn(),activo:w.activo??!0,celularPaciente:w.celular,telefonoPaciente:w.telDomicilio||"",documento:w.nroDocumento,paciente:w.nombreCompleto};if(await bh(mt(ue,"pacientes",q),Yn,{merge:!0}),We)try{const Rt=Bi(),Tn=Al(Rt,`pacientes/${q}`),bn=await nx(Tn),hr=We,Jr=bn.items.filter(Zr=>Zr.fullPath!==hr).map(Zr=>Lp(Zr).catch(()=>null));await Promise.allSettled(Jr)}catch(Rt){console.warn("No se pudo limpiar fotos antiguas:",Rt)}alert(y?" Paciente actualizado.":" Paciente guardado."),d(Rt=>{const Tn=Rt.filter(bn=>bn.id!==q);return[{id:q,...Yn},...Tn]}),T(!1),v(null),re()}catch(q){console.error("Error guardando paciente:",q),alert(`No se pudo guardar el paciente.

`+((q==null?void 0:q.message)||q))}},Me=()=>{re(),T(!0)},Se=()=>{E&&(P({...Uo,...E,fotoUrl:E.fotoUrl||""}),j(null),K(E.fotoUrl||""),v(E.id),M(),T(!0))},Le=async b=>{if(window.confirm(`Eliminar al paciente "${b.nombreCompleto}"?`))try{await Rf(mt(ue,"pacientes",b.id)),d(q=>q.filter(X=>X.id!==b.id));try{const q=Bi(),X=Al(q,`pacientes/${b.id}`),ge=(await nx(X)).items.map(We=>Lp(We).catch(()=>null));await Promise.allSettled(ge)}catch(q){console.warn("No se pudo borrar la carpeta de fotos:",q)}}catch(q){console.error(q),alert("No se pudo eliminar.")}},Ae=A.useMemo(()=>{const b=h.trim().toLowerCase();return b?c.filter(q=>`${q.nombreCompleto||q.paciente||""} ${q.nroDocumento||""} ${q.celular||q.celularPaciente||""} ${q.email||""}`.toLowerCase().includes(b)):c},[c,h]),Ie=b=>{M();const q=mt(ue,"pacientes",b.id),X=Un(q,de=>{de.exists()?O({id:de.id,...Y(de.data())}):O(null)});F.current=X,I("datos")},M=()=>{F.current&&(F.current(),F.current=null),O(null)},Y=b=>({...Uo,...b,historiaClinica:{...Uo.historiaClinica,...b.historiaClinica||{}},facturacion:{...Uo.facturacion,...b.facturacion||{}},rxImagenes:Array.isArray(b.rxImagenes)?b.rxImagenes:[],odontograma:Array.isArray(b.odontograma)?b.odontograma:[],periodontograma:Array.isArray(b.periodontograma)?b.periodontograma:[],presupuestos:Array.isArray(b.presupuestos)?b.presupuestos:[],evoluciones:Array.isArray(b.evoluciones)?b.evoluciones:[]}),J=async b=>{if(E!=null&&E.id)try{await ui(mt(ue,"pacientes",E.id),{...b,actualizado:Xn(),updatedAt:Xn()})}catch(q){console.error(q),alert("No se pudo actualizar.")}},Ce=async b=>{var X;if(!(E!=null&&E.id)||!(b!=null&&b.length))return;const q=Bi();try{ee(!0);const de=[];for(const ge of b){let We=ge;if((X=ge.type)!=null&&X.startsWith("image/"))try{We=await _x(ge,{maxW:1600,maxH:1600,quality:.85})}catch{We=ge}const Pr=(We.name||"archivo").replace(/\s+/g,"_"),Qn=`pacientes/${E.id}/rx/${Date.now()}_${Pr}`,Yn=Al(q,Qn),Rt={contentType:We.type||"application/octet-stream",cacheControl:"public, max-age=31536000"};await tx(Yn,We,Rt);const Tn=await rx(Yn),bn=new Date().toISOString(),hr=Date.now();de.push({url:Tn,name:ge.name,title:ge.name.replace(/\.[^.]+$/,""),desc:"",type:ge.type,size:ge.size||0,created:hr,uploadedAtMS:hr,uploadedAtISO:bn,path:Qn})}await J({rxImagenes:[...E.rxImagenes||[],...de]})}catch(de){console.error("RX upload error:",de);const ge=`No se pudo subir el/los archivo(s).
 Verifica que el usuario est autenticado.
 Revisa reglas de Storage para permitir escribir en 'pacientes/{id}/**'.
 Si usas Emulador, confirma que el bucket coincida.

`+((de==null?void 0:de.message)||"");alert(ge)}finally{ee(!1);try{he.current&&(he.current.value="")}catch{}}},nt=async b=>{if(!(E!=null&&E.id))return;const q=E.rxImagenes[b],X=E.rxImagenes.filter((de,ge)=>ge!==b);await J({rxImagenes:X});try{if(q!=null&&q.path){const de=Bi();await Lp(Al(de,q.path))}}catch(de){console.warn("No se pudo borrar del Storage:",de)}},St=(b,q)=>{const X={...E.historiaClinica||{},[b]:q};J({historiaClinica:X})},Rr=b=>{const q=[...E.presupuestos||[],{id:String(Date.now()),...b}];J({presupuestos:q})},xn=b=>{J({presupuestos:(E.presupuestos||[]).filter(q=>q.id!==b)})},jn=b=>{const q=[...E.evoluciones||[],{id:String(Date.now()),fechaISO:new Date().toISOString(),nota:b}];J({evoluciones:q})},en=b=>{J({evoluciones:(E.evoluciones||[]).filter(q=>q.id!==b)})},Ct=(b,q)=>{const X=Array.isArray(E[b])?E[b]:[],de=X.find(We=>We.pieza===q);let ge;de?ge=X.filter(We=>We.pieza!==q):ge=[...X,{pieza:q,estado:"marcada"}],J({[b]:ge})},Bt=(E==null?void 0:E.id)||null,zt=WU(Bt),{loading:Ke,citas:At}=GU(Bt);return l.jsxs("div",{className:"odc-container",children:[l.jsx("div",{className:"odc-topbar-green"}),l.jsx("div",{className:"odc-topbar-blue",children:l.jsx("div",{className:"odc-top-inner",children:l.jsx("div",{className:"odc-breadcrumbs",children:"Pacientes"})})}),l.jsxs("div",{className:"odc-card",children:[l.jsxs("div",{className:"odc-card-header",children:[l.jsx("h3",{className:"odc-title",children:"Pacientes"}),l.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[l.jsx("input",{className:"search-input",style:{minWidth:280},placeholder:"Buscar por nombre, documento o telfono",value:h,onChange:b=>f(b.target.value)}),l.jsx("button",{type:"button",className:"btn green",onClick:Me,children:"+ Nuevo paciente"})]})]}),l.jsx("div",{className:"table-wrap",children:l.jsxs("table",{className:"appointments-table",children:[l.jsx("thead",{children:l.jsxs("tr",{children:[l.jsx("th",{children:"Foto"}),l.jsx("th",{children:"Nombre"}),l.jsx("th",{children:"Documento"}),l.jsx("th",{children:"Celular"}),l.jsx("th",{children:"Correo"}),l.jsx("th",{children:"Estado"})]})}),l.jsx("tbody",{children:o&&c.length===0?l.jsx("tr",{children:l.jsx("td",{className:"no-data",colSpan:6,children:"Cargando"})}):Ae.length===0?l.jsx("tr",{children:l.jsx("td",{className:"no-data",colSpan:6,children:"No hay pacientes o no coinciden con la bsqueda."})}):Ae.map(b=>l.jsxs("tr",{className:"row-click",onClick:()=>Ie(b),children:[l.jsx("td",{onClick:q=>q.stopPropagation(),children:b.fotoUrl?l.jsx("img",{src:b.fotoUrl,alt:"Foto",style:{width:36,height:36,borderRadius:"50%",objectFit:"cover"}}):l.jsx("div",{className:"avatar-fallback",children:(b.nombreCompleto||"P")[0]})}),l.jsx("td",{children:b.nombreCompleto||b.paciente||""}),l.jsx("td",{children:b.nroDocumento||b.documento||""}),l.jsx("td",{children:b.celular||b.celularPaciente||""}),l.jsx("td",{children:b.email||""}),l.jsx("td",{children:l.jsx("span",{className:"pill pill-ok",children:b.activo?"Activo":"Inactivo"})})]},b.id))})]})}),l.jsxs("div",{className:"footer-actions",children:[l.jsx("button",{type:"button",className:"btn",disabled:o||!R,onClick:()=>ye(!1),children:R?"Cargar ms":"No hay ms"}),l.jsxs("div",{className:"hint",children:[c.length," registros cargados"]})]})]}),N&&l.jsxs("div",{className:"odc-modal",role:"dialog","aria-modal":"true",children:[l.jsx("div",{className:"odc-modal-backdrop",onClick:()=>T(!1)}),l.jsxs("div",{className:"odc-card",style:{width:1e3,maxWidth:"95%",maxHeight:"92vh",overflowY:"auto"},children:[l.jsxs("div",{className:"odc-card-header",children:[l.jsx("h3",{className:"odc-title",children:y?"Editar paciente":"Nuevo paciente"}),l.jsx("button",{type:"button",className:"btn",onClick:()=>T(!1),children:""})]}),l.jsxs("form",{onSubmit:ve,children:[l.jsx("div",{className:"form-section-title",children:"Foto del paciente"}),l.jsxs("div",{className:"foto-row",children:[l.jsxs("label",{className:"foto-drop",children:[l.jsx("input",{type:"file",accept:"image/*",onChange:b=>{var q;return ie(((q=b.target.files)==null?void 0:q[0])||null)},style:{display:"none"}}),k?l.jsx("img",{src:k,alt:"Preview",className:"foto-preview"}):l.jsx("div",{className:"foto-empty",children:"Arrastra o haz clic para cargar"})]}),k&&l.jsx("button",{type:"button",className:"btn",onClick:()=>ie(null),children:"Quitar foto"})]}),l.jsx("div",{className:"form-section-title",children:"Datos de identificacin"}),l.jsxs("div",{className:"form-grid",children:[l.jsxs("div",{children:[l.jsx("label",{className:"form-label",children:"Tipo de documento *"}),l.jsxs("select",{className:"form-input",value:w.tipoDocumento,onChange:b=>B("tipoDocumento",b.target.value),children:[l.jsx("option",{value:"",children:"Seleccione"}),l.jsx("option",{value:"CC",children:"Cdula"}),l.jsx("option",{value:"TI",children:"Tarjeta de identidad"}),l.jsx("option",{value:"PA",children:"Pasaporte"}),l.jsx("option",{value:"OTRO",children:"Otro"})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"form-label",children:"Nro. de documento *"}),l.jsx("input",{className:"form-input",value:w.nroDocumento,onChange:b=>B("nroDocumento",b.target.value),placeholder:"Nmero de documento",required:!0})]}),l.jsxs("div",{children:[l.jsx("label",{className:"form-label",children:"Nmero de Historia"}),l.jsx("input",{className:"form-input",value:w.nroHistoria,readOnly:!0})]}),l.jsxs("div",{children:[l.jsx("label",{className:"form-label",children:"Nombres *"}),l.jsx("input",{className:"form-input",value:w.nombres,onChange:b=>B("nombres",b.target.value),required:!0})]}),l.jsxs("div",{children:[l.jsx("label",{className:"form-label",children:"Apellidos *"}),l.jsx("input",{className:"form-input",value:w.apellidos,onChange:b=>B("apellidos",b.target.value),required:!0})]}),l.jsxs("div",{children:[l.jsx("label",{className:"form-label",children:"Nombre completo"}),l.jsx("input",{className:"form-input",value:w.nombreCompleto,readOnly:!0})]}),l.jsxs("div",{children:[l.jsx("label",{className:"form-label",children:"Sexo *"}),l.jsxs("select",{className:"form-input",value:w.sexo,onChange:b=>B("sexo",b.target.value),required:!0,children:[l.jsx("option",{value:"",children:"Seleccione"}),l.jsx("option",{children:"Masculino"}),l.jsx("option",{children:"Femenino"}),l.jsx("option",{children:"Otro"})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"form-label",children:"Estado civil *"}),l.jsxs("select",{className:"form-input",value:w.estadoCivil,onChange:b=>B("estadoCivil",b.target.value),required:!0,children:[l.jsx("option",{value:"",children:"Seleccione"}),l.jsx("option",{children:"Soltero"}),l.jsx("option",{children:"Casado"}),l.jsx("option",{children:"Unin libre"}),l.jsx("option",{children:"Divorciado"}),l.jsx("option",{children:"Viudo"})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"form-label",children:"Pas de nacimiento *"}),l.jsx("input",{className:"form-input",list:"listCountries",value:w.paisNacimiento,onChange:b=>B("paisNacimiento",b.target.value),placeholder:"Escribe y elige",required:!0}),l.jsx("datalist",{id:"listCountries",children:$U.map(b=>l.jsx("option",{value:b},b))})]}),l.jsxs("div",{children:[l.jsx("label",{className:"form-label",children:"Ciudad de nacimiento"}),l.jsx("input",{className:"form-input",list:"listCitiesBirth",value:w.ciudadNacimiento,onChange:b=>B("ciudadNacimiento",b.target.value),placeholder:"Escribe y elige"}),l.jsx("datalist",{id:"listCitiesBirth",children:(zp[w.paisNacimiento]||[]).map(b=>l.jsx("option",{value:b},b))})]}),l.jsxs("div",{children:[l.jsx("label",{className:"form-label",children:"Fecha de ingreso"}),l.jsx("input",{className:"form-input",value:w.fechaIngreso,readOnly:!0})]}),l.jsxs("div",{children:[l.jsx("label",{className:"form-label",children:"Fecha de nacimiento *"}),l.jsx("input",{type:"date",className:"form-input",value:w.fechaNacimiento,onChange:b=>B("fechaNacimiento",b.target.value),required:!0})]}),l.jsxs("div",{children:[l.jsx("label",{className:"form-label",children:"Edad"}),l.jsx("input",{className:"form-input",value:w.edad,readOnly:!0})]}),l.jsxs("div",{children:[l.jsx("label",{className:"form-label",children:"Pas de domicilio *"}),l.jsx("input",{className:"form-input",list:"listCountries",value:w.paisDomicilio,onChange:b=>B("paisDomicilio",b.target.value),required:!0})]}),l.jsxs("div",{children:[l.jsx("label",{className:"form-label",children:"Ciudad de domicilio *"}),l.jsx("input",{className:"form-input",list:"listCitiesHome",value:w.ciudadDomicilio,onChange:b=>B("ciudadDomicilio",b.target.value),required:!0}),l.jsx("datalist",{id:"listCitiesHome",children:(zp[w.paisDomicilio]||[]).map(b=>l.jsx("option",{value:b},b))})]}),l.jsxs("div",{children:[l.jsx("label",{className:"form-label",children:"Barrio *"}),l.jsx("input",{className:"form-input",value:w.barrio,onChange:b=>B("barrio",b.target.value),required:!0,placeholder:"Barrio"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"form-label",children:"Lugar de residencia *"}),l.jsx("input",{className:"form-input",value:w.lugarResidencia,onChange:b=>B("lugarResidencia",b.target.value),required:!0})]}),l.jsxs("div",{children:[l.jsx("label",{className:"form-label",children:"Estrato"}),l.jsxs("select",{className:"form-input",value:w.estrato,onChange:b=>B("estrato",b.target.value),children:[l.jsx("option",{value:"",children:"Seleccione"}),l.jsx("option",{children:"1"}),l.jsx("option",{children:"2"}),l.jsx("option",{children:"3"}),l.jsx("option",{children:"4"}),l.jsx("option",{children:"5"}),l.jsx("option",{children:"6"})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"form-label",children:"Zona residencial *"}),l.jsxs("select",{className:"form-input",value:w.zonaResidencial,onChange:b=>B("zonaResidencial",b.target.value),required:!0,children:[l.jsx("option",{value:"",children:"Seleccione"}),l.jsx("option",{children:"Urbana"}),l.jsx("option",{children:"Rural"})]})]}),l.jsxs("div",{className:"checkbox-cell",children:[l.jsx("label",{className:"form-label",children:"Es extranjero?"}),l.jsx("input",{type:"checkbox",checked:w.esExtranjero,onChange:b=>B("esExtranjero",b.target.checked)})]}),l.jsxs("div",{className:"checkbox-cell",children:[l.jsx("label",{className:"form-label",children:"Permite publicidad?"}),l.jsx("input",{type:"checkbox",checked:w.permitePublicidad,onChange:b=>B("permitePublicidad",b.target.checked)})]})]}),l.jsx("div",{className:"form-section-title",children:"Contacto"}),l.jsxs("div",{className:"form-grid",children:[l.jsxs("div",{children:[l.jsx("label",{className:"form-label",children:"Celular *"}),l.jsx("input",{className:"form-input",value:w.celular,onChange:b=>B("celular",b.target.value),required:!0,placeholder:"Celular del paciente"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"form-label",children:"Telfono de domicilio"}),l.jsx("input",{className:"form-input",value:w.telDomicilio,onChange:b=>B("telDomicilio",b.target.value)})]}),l.jsxs("div",{children:[l.jsx("label",{className:"form-label",children:"Telfono de oficina"}),l.jsx("input",{className:"form-input",value:w.telOficina,onChange:b=>B("telOficina",b.target.value)})]}),l.jsxs("div",{children:[l.jsx("label",{className:"form-label",children:"Extensin"}),l.jsx("input",{className:"form-input",value:w.extension,onChange:b=>B("extension",b.target.value)})]}),l.jsxs("div",{children:[l.jsx("label",{className:"form-label",children:"Correo electrnico *"}),l.jsx("input",{type:"email",className:"form-input",value:w.email,onChange:b=>B("email",b.target.value),required:!0,placeholder:"correo@dominio.com"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"form-label",children:"Ocupacin *"}),l.jsx("input",{className:"form-input",value:w.ocupacion,onChange:b=>B("ocupacion",b.target.value),required:!0})]})]}),l.jsx("div",{className:"form-section-title",children:"Datos de facturacin"}),l.jsxs("div",{className:"form-grid",children:[l.jsxs("div",{children:[l.jsx("label",{className:"form-label",children:"Responsable"}),l.jsx("input",{className:"form-input",value:w.nombreResponsable,onChange:b=>B("nombreResponsable",b.target.value)})]}),l.jsxs("div",{children:[l.jsx("label",{className:"form-label",children:"Parentesco"}),l.jsxs("select",{className:"form-input",value:w.parentesco,onChange:b=>B("parentesco",b.target.value),children:[l.jsx("option",{value:"",children:"Seleccione"}),l.jsx("option",{children:"Padre/Madre"}),l.jsx("option",{children:"Hermano"}),l.jsx("option",{children:"Esposo/a"}),l.jsx("option",{children:"Otro"})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"form-label",children:"Celular"}),l.jsx("input",{className:"form-input",value:w.celularResponsable,onChange:b=>B("celularResponsable",b.target.value)})]}),l.jsxs("div",{children:[l.jsx("label",{className:"form-label",children:"Telfono"}),l.jsx("input",{className:"form-input",value:w.telefonoResponsable,onChange:b=>B("telefonoResponsable",b.target.value)})]}),l.jsxs("div",{children:[l.jsx("label",{className:"form-label",children:"Correo electrnico"}),l.jsx("input",{type:"email",className:"form-input",value:w.emailResponsable,onChange:b=>B("emailResponsable",b.target.value)})]})]}),l.jsx("div",{className:"form-section-title",children:"Acompaante"}),l.jsxs("div",{className:"form-grid",children:[l.jsxs("div",{children:[l.jsx("label",{className:"form-label",children:"Nombre"}),l.jsx("input",{className:"form-input",value:w.nombreAcompanante,onChange:b=>B("nombreAcompanante",b.target.value),placeholder:"Nombre acompaante"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"form-label",children:"Telfono"}),l.jsx("input",{className:"form-input",value:w.telefonoAcompanante,onChange:b=>B("telefonoAcompanante",b.target.value),placeholder:"Telfono acompaante"})]})]}),l.jsx("div",{className:"form-section-title",children:"Mercadeo"}),l.jsxs("div",{className:"form-grid",children:[l.jsxs("div",{children:[l.jsx("label",{className:"form-label",children:"Convenio beneficio"}),l.jsx("input",{className:"form-input",value:w.convenioBeneficio,onChange:b=>B("convenioBeneficio",b.target.value)})]}),l.jsxs("div",{children:[l.jsx("label",{className:"form-label",children:"Cmo nos conoci?"}),l.jsxs("select",{className:"form-input",value:w.comoConocio,onChange:b=>B("comoConocio",b.target.value),children:[l.jsx("option",{value:"",children:"Seleccione"}),l.jsx("option",{children:"Redes sociales"}),l.jsx("option",{children:"Publicidad"}),l.jsx("option",{children:"Recomendacin"}),l.jsx("option",{children:"Otro"})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"form-label",children:"Campaa"}),l.jsx("input",{className:"form-input",value:w.campania,onChange:b=>B("campania",b.target.value)})]}),l.jsxs("div",{children:[l.jsx("label",{className:"form-label",children:"Remitido por"}),l.jsx("input",{className:"form-input",value:w.remitidoPor,onChange:b=>B("remitidoPor",b.target.value)})]}),l.jsxs("div",{children:[l.jsx("label",{className:"form-label",children:"Asesor comercial"}),l.jsx("input",{className:"form-input",value:w.asesorComercial,onChange:b=>B("asesorComercial",b.target.value)})]})]}),l.jsx("div",{className:"form-section-title",children:"EPS"}),l.jsxs("div",{className:"form-grid",children:[l.jsxs("div",{children:[l.jsx("label",{className:"form-label",children:"Tipo de vinculacin *"}),l.jsxs("select",{className:"form-input",value:w.tipoVinculacion,onChange:b=>B("tipoVinculacion",b.target.value),required:!0,children:[l.jsx("option",{value:"",children:"Seleccione"}),l.jsx("option",{children:"Contributivo"}),l.jsx("option",{children:"Subsidiado"}),l.jsx("option",{children:"Particular"}),l.jsx("option",{children:"Otro"})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"form-label",children:"Nombre de la EPS *"}),l.jsx("input",{className:"form-input",list:"listEps",value:w.nombreEps,onChange:b=>B("nombreEps",b.target.value),placeholder:"Escribe y selecciona",required:!0}),l.jsx("datalist",{id:"listEps",children:Ge.map(b=>l.jsx("option",{value:b},b))})]}),l.jsxs("div",{children:[l.jsx("label",{className:"form-label",children:"Pliza de salud"}),l.jsx("input",{className:"form-input",value:w.polizaSalud,onChange:b=>B("polizaSalud",b.target.value)})]})]}),l.jsx("div",{className:"form-section-title",children:"Doctor"}),l.jsx("div",{className:"form-grid",children:l.jsxs("div",{children:[l.jsx("label",{className:"form-label",children:"Doctor"}),l.jsx("input",{className:"form-input",value:w.doctor,onChange:b=>B("doctor",b.target.value),placeholder:"Usuario / Libre"})]})}),l.jsx("div",{className:"form-section-title",children:"Alertas y Notas"}),l.jsx("div",{className:"form-grid",children:l.jsx("textarea",{className:"form-input",rows:3,value:w.notas,onChange:b=>B("notas",b.target.value),placeholder:"Notas del paciente"})}),l.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:8,marginTop:12},children:[y?l.jsx("button",{type:"button",className:"btn",onClick:()=>Le({id:y,nombreCompleto:w.nombreCompleto}),children:"Eliminar"}):l.jsx("div",{}),l.jsxs("div",{style:{display:"flex",gap:8},children:[l.jsx("button",{type:"button",className:"btn",onClick:()=>T(!1),children:"Cancelar"}),l.jsx("button",{type:"submit",className:"btn blue",children:y?"Actualizar":"Guardar paciente"})]})]})]})]})]}),E&&l.jsxs("div",{className:"odc-modal",role:"dialog","aria-modal":"true",children:[l.jsx("div",{className:"odc-modal-backdrop",onClick:M}),l.jsxs("div",{className:"odc-card ficha-card",children:[l.jsxs("div",{className:"ficha-header",children:[l.jsxs("div",{className:"ficha-header-left",children:[E.fotoUrl?l.jsx("img",{src:E.fotoUrl,alt:"Foto",className:"ficha-avatar"}):l.jsx("div",{className:"avatar-fallback ficha-avatar-fallback",children:(E.nombreCompleto||"P")[0]}),l.jsxs("div",{children:[l.jsx("div",{className:"ficha-nombre",children:E.nombreCompleto||""}),l.jsxs("div",{className:"ficha-doc",children:[E.tipoDocumento||""," ",E.nroDocumento||""]}),l.jsxs("div",{className:"ficha-badges",children:[l.jsx("span",{className:"ficha-badge blue",children:"En valoracin"}),l.jsx("span",{className:"ficha-badge green",children:"Sin deuda"})]})]})]}),l.jsx("div",{className:"ficha-header-right",children:l.jsxs("div",{className:"ficha-actions",children:[l.jsx("button",{type:"button",className:"btn",onClick:M,children:"Cerrar"}),l.jsx("button",{type:"button",className:"btn blue",onClick:Se,children:"Editar"}),l.jsx("button",{type:"button",className:"btn green",onClick:()=>t(s(Yu.caja,{cobro:1,patientId:E.id})),title:"Ir a Caja para cobrar a este paciente",children:"Cobrar"})]})})]}),l.jsxs("div",{className:"ficha-body",children:[l.jsxs("aside",{className:"ficha-sidebar",children:[l.jsx("div",{className:"ficha-sidebar-title",children:"Informacin general"}),l.jsx("button",{type:"button",className:`ficha-link ${x==="datos"?"active":""}`,onClick:()=>I("datos"),children:"Datos personales"}),l.jsx("button",{type:"button",className:`ficha-link ${x==="marketing"?"active":""}`,onClick:()=>I("marketing"),children:"Marketing"}),l.jsx("button",{type:"button",className:`ficha-link ${x==="eps"?"active":""}`,onClick:()=>I("eps"),children:"EPS"}),l.jsx("button",{type:"button",className:`ficha-link ${x==="prof"?"active":""}`,onClick:()=>I("prof"),children:"Profesionales"}),l.jsx("button",{type:"button",className:`ficha-link ${x==="rx"?"active":""}`,onClick:()=>I("rx"),children:"Rx/Imgenes/Doc"}),l.jsx("button",{type:"button",className:`ficha-link ${x==="citas"?"active":""}`,onClick:()=>I("citas"),children:"Citas"}),l.jsx("button",{type:"button",className:`ficha-link ${x==="crm"?"active":""}`,onClick:()=>I("crm"),children:"CRM"}),l.jsx("div",{className:"ficha-sidebar-title mt",children:"Historia clnica"}),l.jsx("button",{type:"button",className:`ficha-link ${x==="doc"?"active":""}`,onClick:()=>I("doc"),children:"Doc. Clnicos"}),l.jsx("button",{type:"button",className:`ficha-link ${x==="odonto"?"active":""}`,onClick:()=>I("odonto"),children:"Odontogramas"}),l.jsx("button",{type:"button",className:`ficha-link ${x==="perio"?"active":""}`,onClick:()=>I("perio"),children:"Periodontogramas"}),l.jsx("button",{type:"button",className:`ficha-link ${x==="presu"?"active":""}`,onClick:()=>I("presu"),children:"Presupuestos"}),l.jsx("button",{type:"button",className:`ficha-link ${x==="evo"?"active":""}`,onClick:()=>I("evo"),children:"Evoluciones"}),l.jsx("div",{className:"ficha-sidebar-title mt",children:"Facturacin"}),l.jsx("button",{type:"button",className:`ficha-link ${x==="fact"?"active":""}`,onClick:()=>I("fact"),children:"Resumen"}),l.jsxs("div",{className:"ficha-sidebar-actions",style:{display:"grid",gap:8,marginTop:8},children:[l.jsx("button",{type:"button",className:"btn pay",onClick:()=>t(s(Yu.caja,{cobro:1,patientId:E.id})),title:"Cobrar a este paciente",children:"Realizar pago"}),l.jsx("button",{type:"button",className:"btn history",onClick:()=>r(`${Yu.pagos}?patientId=${encodeURIComponent(E.id)}`),title:"Ver histrico de pagos",children:"Histrico de pagos"}),l.jsx("button",{type:"button",className:"btn history",onClick:()=>r(`${Yu.facturas}?patientId=${encodeURIComponent(E.id)}`),title:"Ver histrico de facturacin",children:"Histrico de facturacin"})]})]}),l.jsxs("main",{className:"ficha-content",children:[x==="datos"&&l.jsxs("section",{className:"ficha-section",children:[l.jsx("h4",{className:"ficha-section-title",children:"Datos personales"}),l.jsx("div",{className:"ficha-grid",children:[["Tipo de documento",E.tipoDocumento],["Nro. de documento",E.nroDocumento],["Nmero de Historia",E.nroHistoria],["Fecha de ingreso",E.fechaIngreso],["Nombres",E.nombres],["Apellidos",E.apellidos],["Nombre completo",E.nombreCompleto],["Sexo",E.sexo],["Estado civil",E.estadoCivil],["Pas de nacimiento",E.paisNacimiento],["Ciudad de nacimiento",E.ciudadNacimiento],["Fecha de nacimiento",E.fechaNacimiento],["Edad",E.edad],["Pas de domicilio",E.paisDomicilio],["Ciudad de domicilio",E.ciudadDomicilio],["Barrio",E.barrio],["Lugar de residencia",E.lugarResidencia],["Estrato",E.estrato],["Zona residencial",E.zonaResidencial],["Extranjero",E.esExtranjero?"S":"No"],["Permite publicidad",E.permitePublicidad?"S":"No"],["Celular",E.celular||E.celularPaciente],["Telfono domicilio",E.telDomicilio||E.telefonoPaciente],["Telfono oficina",E.telOficina],["Extensin",E.extension],["Correo electrnico",E.email],["Ocupacin",E.ocupacion],["Responsable",E.nombreResponsable],["Parentesco",E.parentesco],["Cel. responsable",E.celularResponsable],["Tel. responsable",E.telefonoResponsable],["Email responsable",E.emailResponsable],["Acompaante",E.nombreAcompanante],["Tel. acompaante",E.telefonoAcompanante]].map(([b,q])=>l.jsxs("div",{className:"field",children:[l.jsx("label",{children:b}),l.jsx("input",{className:"form-input",value:q||"",readOnly:!0})]},b))})]}),x==="marketing"&&l.jsxs("section",{className:"ficha-section",children:[l.jsx("h4",{className:"ficha-section-title",children:"Marketing"}),l.jsx("div",{className:"ficha-grid",children:[["Convenio beneficio",E.convenioBeneficio],["Cmo nos conoci?",E.comoConocio],["Campaa",E.campania],["Remitido por",E.remitidoPor],["Asesor comercial",E.asesorComercial]].map(([b,q])=>l.jsxs("div",{className:"field",children:[l.jsx("label",{children:b}),l.jsx("input",{className:"form-input",value:q||"",readOnly:!0})]},b))})]}),x==="eps"&&l.jsxs("section",{className:"ficha-section",children:[l.jsx("h4",{className:"ficha-section-title",children:"EPS"}),l.jsx("div",{className:"ficha-grid",children:[["Tipo de vinculacin",E.tipoVinculacion],["Nombre EPS",E.nombreEps],["Pliza de salud",E.polizaSalud]].map(([b,q])=>l.jsxs("div",{className:"field",children:[l.jsx("label",{children:b}),l.jsx("input",{className:"form-input",value:q||"",readOnly:!0})]},b))})]}),x==="prof"&&l.jsxs("section",{className:"ficha-section",children:[l.jsx("h4",{className:"ficha-section-title",children:"Profesionales"}),l.jsx("div",{className:"ficha-grid",children:l.jsxs("div",{className:"field",children:[l.jsx("label",{children:"Doctor"}),l.jsx("input",{className:"form-input",value:E.doctor||"",readOnly:!0})]})})]}),x==="rx"&&l.jsxs("section",{className:"ficha-section",children:[l.jsx("h4",{className:"ficha-section-title",children:"Rx / Imgenes / Documentos"}),l.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",flexWrap:"wrap"},children:[l.jsxs("label",{className:"btn blue",children:["Subir archivos",l.jsx("input",{ref:he,type:"file",multiple:!0,accept:"image/*,.pdf,.doc,.docx,.xls,.xlsx",style:{display:"none"},onChange:b=>Ce([...b.target.files||[]])})]}),hn&&l.jsx("span",{className:"hint",children:"Subiendo"}),l.jsx("div",{style:{marginLeft:"auto",display:"flex",gap:8,alignItems:"center"},children:l.jsx("input",{className:"form-input",style:{width:200},placeholder:"Buscar en Rx",value:ke,onChange:b=>Ye(b.target.value),title:"Filtra por nombre, ttulo o descripcin"})})]}),l.jsxs("div",{className:"hint",style:{marginTop:6},children:[ne.length," elemento(s)",ke?"  filtrado(s)":"","."]}),l.jsxs("div",{className:"rx-grid",style:{display:"grid",gap:10,marginTop:12,gridTemplateColumns:`repeat(auto-fill, minmax(${jt.colMin}px, 1fr))`,alignItems:"start"},children:[ne.length===0&&l.jsx("div",{className:"no-data",style:{gridColumn:"1 / -1"},children:ke?"Sin coincidencias.":"Sin archivos an."}),ne.map((b,q)=>{var Pr,Qn;const X=U(b),de=b.title||b.name||`archivo-${q}`,ge=((Pr=(b.name||"").split(".").pop())==null?void 0:Pr.toUpperCase())||((Qn=(b.type||"").split("/").pop())==null?void 0:Qn.toUpperCase())||"",We=b.uploadedAtISO||(b.created?new Date(b.created).toISOString():null);return l.jsxs("div",{className:"rx-item mini-card",style:{padding:8,display:"grid",gap:8},title:de,children:[l.jsx("a",{href:b.url,target:"_blank",rel:"noreferrer",style:{width:"100%",height:jt.thumbH,borderRadius:8,overflow:"hidden",border:"1px solid #e5e7eb",display:"grid",placeItems:"center",background:"#fafafa"},children:X?l.jsx("img",{src:b.url,alt:de,style:{width:jt.thumbW,height:jt.thumbH,objectFit:"contain",display:"block"},loading:"lazy"}):l.jsxs("div",{style:{textAlign:"center",padding:10},children:[l.jsx("div",{style:{fontSize:24,fontWeight:700},children:ge||"DOC"}),l.jsx("div",{style:{fontSize:12,opacity:.7},children:"Ver / descargar"})]})}),l.jsx("div",{style:{fontWeight:600,fontSize:13,lineHeight:1.2},children:de.length>40?de.slice(0,37)+"":de}),l.jsxs("details",{children:[l.jsx("summary",{style:{cursor:"pointer",fontSize:12,color:"#2563eb"},children:"Editar nombre y descripcin"}),l.jsxs("div",{style:{display:"grid",gap:6,marginTop:6},children:[l.jsx("label",{className:"form-label",style:{marginTop:4},children:"Nombre para mostrar"}),l.jsx("input",{id:`rx-title-${q}`,className:"form-input",defaultValue:b.title||b.name||"",placeholder:"Ej. Rx aleta derecha 2025-11-29"}),l.jsx("label",{className:"form-label",children:"Descripcin"}),l.jsx("textarea",{id:`rx-desc-${q}`,className:"form-input",rows:2,defaultValue:b.desc||"",placeholder:"Observaciones, regin, tcnica, etc."}),l.jsx("label",{className:"form-label",children:"Fecha de subida"}),l.jsx("input",{id:`rx-date-${q}`,type:"datetime-local",className:"form-input",defaultValue:qU(We)}),l.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",justifyContent:"space-between"},children:[l.jsx("button",{type:"button",className:"btn blue",onClick:()=>{var Jr,Zr,Ro;const Yn=((Jr=document.getElementById(`rx-title-${q}`))==null?void 0:Jr.value)||"",Rt=((Zr=document.getElementById(`rx-desc-${q}`))==null?void 0:Zr.value)||"",Tn=((Ro=document.getElementById(`rx-date-${q}`))==null?void 0:Ro.value)||"";let bn=We,hr=b.uploadedAtMS||b.created||null;if(Tn){const es=new Date(Tn);isNaN(es.getTime())||(bn=es.toISOString(),hr=es.getTime())}ce(q,{title:Yn,name:Yn||b.name,desc:Rt,uploadedAtISO:bn,uploadedAtMS:hr})},children:"Guardar"}),l.jsx("button",{type:"button",className:"btn",onClick:()=>nt(q),children:"Eliminar"})]}),l.jsxs("div",{className:"hint",style:{fontSize:11},children:["Tipo: ",b.type||"","  Tamao: ",(b.size||0).toLocaleString()," bytes",We?`  Subido: ${HU(We)}`:""]})]})]})]},`${b.url}-${q}`)})]})]}),x==="doc"&&l.jsxs("section",{className:"ficha-section",children:[l.jsx("h4",{className:"ficha-section-title",children:"Doc. Clnicos"}),l.jsxs("div",{className:"ficha-grid",children:[l.jsxs("div",{className:"field",children:[l.jsx("label",{children:"Motivo de consulta"}),l.jsx("textarea",{className:"form-input",rows:3,value:((Nr=E.historiaClinica)==null?void 0:Nr.motivoConsulta)||"",onChange:b=>St("motivoConsulta",b.target.value)})]}),l.jsxs("div",{className:"field",children:[l.jsx("label",{children:"Antecedentes"}),l.jsx("textarea",{className:"form-input",rows:3,value:((dr=E.historiaClinica)==null?void 0:dr.antecedentes)||"",onChange:b=>St("antecedentes",b.target.value)})]}),l.jsxs("div",{className:"field",children:[l.jsx("label",{children:"Alergias"}),l.jsx("textarea",{className:"form-input",rows:2,value:((Ts=E.historiaClinica)==null?void 0:Ts.alergias)||"",onChange:b=>St("alergias",b.target.value)})]}),l.jsxs("div",{className:"field",children:[l.jsx("label",{children:"Medicamentos"}),l.jsx("textarea",{className:"form-input",rows:2,value:((On=E.historiaClinica)==null?void 0:On.medicamentos)||"",onChange:b=>St("medicamentos",b.target.value)})]}),l.jsxs("div",{className:"field",children:[l.jsx("label",{children:"Notas"}),l.jsx("textarea",{className:"form-input",rows:3,value:((Xr=E.historiaClinica)==null?void 0:Xr.notas)||"",onChange:b=>St("notas",b.target.value)})]})]})]}),x==="odonto"&&l.jsxs("section",{className:"ficha-section",children:[l.jsx("h4",{className:"ficha-section-title",children:"Odontograma (placeholder)"}),l.jsx("div",{className:"odont-grid",children:Array.from({length:32},(b,q)=>q+1).map(b=>{const q=(E.odontograma||[]).some(X=>X.pieza===b);return l.jsx("button",{type:"button",className:`tooth ${q?"on":""}`,onClick:()=>Ct("odontograma",b),title:`Pieza ${b}`,children:b},b)})})]}),x==="perio"&&l.jsxs("section",{className:"ficha-section",children:[l.jsx("h4",{className:"ficha-section-title",children:"Periodontograma (placeholder)"}),l.jsx("div",{className:"odont-grid",children:Array.from({length:32},(b,q)=>q+1).map(b=>{const q=(E.periodontograma||[]).some(X=>X.pieza===b);return l.jsx("button",{type:"button",className:`tooth ${q?"on":""}`,onClick:()=>Ct("periodontograma",b),title:`Pieza ${b}`,children:b},b)})})]}),x==="presu"&&l.jsxs("section",{className:"ficha-section",children:[l.jsx("h4",{className:"ficha-section-title",children:"Presupuestos & planes"}),l.jsx(QU,{onAdd:Rr}),l.jsxs("div",{className:"presu-list",children:[(E.presupuestos||[]).map(b=>l.jsxs("div",{className:"presu-item",children:[l.jsxs("div",{children:[l.jsx("div",{className:"presu-title",children:b.titulo}),l.jsxs("div",{className:"presu-meta",children:["Costo: $",b.costo||0,"  Estado: ",b.estado||"Pendiente"]})]}),l.jsx("button",{type:"button",className:"btn small",onClick:()=>xn(b.id),children:"Eliminar"})]},b.id)),(!E.presupuestos||E.presupuestos.length===0)&&l.jsx("div",{className:"no-data",children:"Sin presupuestos an."})]})]}),x==="evo"&&l.jsxs("section",{className:"ficha-section",children:[l.jsx("h4",{className:"ficha-section-title",children:"Evoluciones & Remisiones"}),l.jsx(YU,{onAdd:jn}),l.jsxs("div",{className:"evo-list",children:[(E.evoluciones||[]).map(b=>l.jsxs("div",{className:"evo-item",children:[l.jsx("div",{className:"evo-date",children:new Date(b.fechaISO).toLocaleString()}),l.jsx("div",{className:"evo-note",children:b.nota}),l.jsx("button",{type:"button",className:"btn small",onClick:()=>en(b.id),children:"Eliminar"})]},b.id)),(!E.evoluciones||E.evoluciones.length===0)&&l.jsx("div",{className:"no-data",children:"Sin evoluciones an."})]})]}),x==="fact"&&l.jsxs("section",{className:"ficha-section",children:[l.jsx("h4",{className:"ficha-section-title",children:"Facturacin"}),l.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(220px,1fr))",gap:12},children:[l.jsx(Bo,{title:"Total facturado",value:`$ ${zt.totalFacturado.toLocaleString()}`}),l.jsx(Bo,{title:"Total pagado",value:`$ ${zt.totalPagado.toLocaleString()}`}),l.jsx(Bo,{title:"Facturas pendientes",value:`$ ${zt.totalFacturasPendientes.toLocaleString()}`}),l.jsx(Bo,{title:"Saldo pendiente (facturas - pagos)",value:`$ ${(zt.totalFacturado-zt.totalPagado).toLocaleString()}`}),l.jsx(Bo,{title:"Saldo a favor",value:`$ ${(((du=E.facturacion)==null?void 0:du.saldoFavor)??0).toLocaleString()}`}),l.jsx(Bo,{title:"Saldo crdito",value:`$ ${(((hu=E.facturacion)==null?void 0:hu.saldoCredito)??0).toLocaleString()}`})]}),zt.error&&l.jsxs("div",{className:"hint",style:{marginTop:6},children:[" ",zt.error]}),l.jsxs("div",{className:"ficha-grid",style:{marginTop:12},children:[l.jsxs("div",{className:"field",children:[l.jsx("label",{children:"Saldo a favor"}),l.jsx("input",{type:"number",className:"form-input",value:((Ci=E.facturacion)==null?void 0:Ci.saldoFavor)??0,onChange:b=>J({facturacion:{...E.facturacion||{},saldoFavor:Number(b.target.value||0)}})})]}),l.jsxs("div",{className:"field",children:[l.jsx("label",{children:"Saldo crdito"}),l.jsx("input",{type:"number",className:"form-input",value:((rl=E.facturacion)==null?void 0:rl.saldoCredito)??0,onChange:b=>J({facturacion:{...E.facturacion||{},saldoCredito:Number(b.target.value||0)}})})]})]})]}),x==="citas"&&l.jsxs("section",{className:"ficha-section",children:[l.jsx("h4",{className:"ficha-section-title",children:"Citas"}),l.jsxs("div",{className:"mini-card",style:{marginBottom:12},children:[l.jsx("div",{className:"mini-card-title",children:"Crear cita para este paciente"}),l.jsxs("div",{className:"ficha-grid",style:{marginTop:8},children:[l.jsxs("div",{className:"field",children:[l.jsx("label",{children:"Fecha"}),l.jsx("input",{type:"date",className:"form-input",value:be,onChange:b=>je(b.target.value)})]}),l.jsxs("div",{className:"field",children:[l.jsx("label",{children:"Hora"}),l.jsx("input",{type:"time",className:"form-input",value:_e,onChange:b=>it(b.target.value)})]}),l.jsxs("div",{className:"field",children:[l.jsx("label",{children:"Doctor"}),l.jsx("input",{className:"form-input",value:Re,onChange:b=>le(b.target.value),placeholder:"Doctor asignado"})]}),l.jsxs("div",{className:"field",children:[l.jsx("label",{children:"Espacio / Sala"}),l.jsx("input",{className:"form-input",value:Oe,onChange:b=>$e(b.target.value),placeholder:"Consultorio / Silla"})]}),l.jsxs("div",{className:"field",style:{gridColumn:"1 / -1"},children:[l.jsx("label",{children:"Comentario"}),l.jsx("textarea",{className:"form-input",rows:2,value:tt,onChange:b=>H(b.target.value),placeholder:"Motivo / notas de la cita"})]})]}),l.jsxs("div",{style:{display:"flex",gap:8,justifyContent:"flex-end"},children:[l.jsx("button",{type:"button",className:"btn blue",onClick:se,children:"Guardar cita"}),be&&l.jsx("button",{type:"button",className:"btn",onClick:()=>i(be,E.id),children:"Ver ese da en Agenda"})]})]}),l.jsx("div",{className:"table-wrap",children:l.jsxs("table",{className:"appointments-table",children:[l.jsx("thead",{children:l.jsxs("tr",{children:[l.jsx("th",{children:"Fecha"}),l.jsx("th",{children:"Estado"}),l.jsx("th",{children:"Motivo"}),l.jsx("th",{children:"Profesional / Acciones"})]})}),l.jsx("tbody",{children:Ke?l.jsx("tr",{children:l.jsx("td",{className:"no-data",colSpan:4,children:"Cargando"})}):At.length===0?l.jsx("tr",{children:l.jsx("td",{className:"no-data",colSpan:4,children:"Sin citas registradas."})}):At.map(b=>l.jsxs("tr",{children:[l.jsx("td",{children:b.fechaISO?new Date(b.fechaISO).toLocaleString():b.fechaYYYYMMDD||""}),l.jsx("td",{children:b.estado||""}),l.jsx("td",{children:b.motivo||""}),l.jsx("td",{children:l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[l.jsx("span",{children:b.profesional||""}),l.jsx("button",{type:"button",className:"btn small",onClick:()=>{const q=b.fechaYYYYMMDD||b.fecha||(b.fechaISO?new Date(b.fechaISO).toISOString().slice(0,10):"");i(q,E.id)},title:"Abrir en Agenda",children:"Ver en Agenda"})]})})]},b.id))})]})})]}),x==="crm"&&l.jsxs("section",{className:"ficha-section",children:[l.jsx("h4",{className:"ficha-section-title",children:"CRM"}),l.jsx("div",{className:"no-data",children:"Notas / recordatorios comerciales del paciente."})]}),l.jsx("div",{className:"ficha-footer"})]})]})]})]})]})}function Bo({title:t,value:e}){return l.jsxs("div",{className:"mini-card",children:[l.jsx("div",{className:"mini-card-title",children:t}),l.jsx("div",{style:{fontWeight:700,fontSize:20,marginTop:6},children:e})]})}function QU({onAdd:t}){const[e,n]=A.useState(""),[r,s]=A.useState(""),[i,o]=A.useState("Pendiente");return l.jsxs("div",{className:"presu-form",children:[l.jsx("input",{className:"form-input",placeholder:"Procedimiento / plan",value:e,onChange:a=>n(a.target.value)}),l.jsx("input",{type:"number",className:"form-input",placeholder:"Costo",value:r,onChange:a=>s(a.target.value)}),l.jsxs("select",{className:"form-input",value:i,onChange:a=>o(a.target.value),children:[l.jsx("option",{children:"Pendiente"}),l.jsx("option",{children:"Aprobado"}),l.jsx("option",{children:"Rechazado"})]}),l.jsx("button",{type:"button",className:"btn blue",onClick:()=>{if(!e)return alert("Ttulo requerido");t({titulo:e,costo:Number(r||0),estado:i}),n(""),s(""),o("Pendiente")},children:"Agregar"})]})}function YU({onAdd:t}){const[e,n]=A.useState("");return l.jsxs("div",{className:"evo-form",children:[l.jsx("textarea",{className:"form-input",rows:2,placeholder:"Escribe la evolucin / remisin",value:e,onChange:r=>n(r.target.value)}),l.jsx("button",{type:"button",className:"btn blue",onClick:()=>{e.trim()&&(t(e.trim()),n(""))},children:"Guardar evolucin"})]})}function XU(){return l.jsxs("div",{style:{padding:"20px"},children:[l.jsx("h2",{children:"Mdulo de Facturacin"}),l.jsx("p",{children:"Aqu se registrarn los pagos, facturas y cobros."})]})}function JU({basePath:t="",className:e=""}){const n=Es(),r=()=>{const s=String(t||"").replace(/\/+$/g,"");n(`${s}/config/datos-basicos`,{replace:!1})};return l.jsx("button",{type:"button",className:`oc-icon-btn ${e}`,title:"Configuracin","aria-label":"Abrir configuracin",onClick:r,children:""})}function ZU(t,e){let n=document.querySelector(`meta[name="${t}"]`);n||(n=document.createElement("meta"),n.setAttribute("name",t),document.head.appendChild(n)),n.setAttribute("content",e)}function e6(){const[t,e]=A.useState({nombre:"",marca:"",pais:"Colombia",ciudad:"",tipoDocumento:"NIT",numeroDocumento:"",tipoPersona:"",telefono:"",celular:"",direccion:"",sitioWeb:"",urlAgendamiento:"",regimen:"",responsabilidadTributaria:"",correo:"",moneda:"Pesos colombianos (COP)",zonaHoraria:"Hora de Colombia",cuentaContable:"",esIPS:!1,usuarioSispro:"",tipoDocSispro:"Cdula de Ciudadana",passwordSispro:"",codigoPrestador:""});A.useEffect(()=>{var s;try{const i=localStorage.getItem("empresa_datos_basicos");if(i){const o=JSON.parse(i);e(a=>({...a,...o}))}else{const o=(s=document.querySelector('meta[name="company-name"]'))==null?void 0:s.getAttribute("content");o&&e(a=>({...a,nombre:o}))}}catch{}},[]);const n=s=>{const{name:i,type:o,value:a,checked:c}=s.target;e(d=>({...d,[i]:o==="checkbox"?c:a}))},r=async s=>{s.preventDefault();try{localStorage.setItem("empresa_datos_basicos",JSON.stringify(t)),localStorage.setItem("empresa_nombre",t.nombre||"OdontoCloud"),ZU("company-name",t.nombre||"OdontoCloud")}catch{}console.log("Guardar Empresa  Datos bsicos:",t),alert("Datos bsicos guardados.")};return l.jsxs("div",{className:"oc-main-content",children:[l.jsx("div",{className:"oc-section-title",children:l.jsx("h2",{children:"Configuracin  Datos bsicos"})}),l.jsxs("div",{className:"emp-card",children:[l.jsx("div",{className:"emp-title",children:"Datos bsicos"}),l.jsxs("form",{className:"emp-form",onSubmit:r,children:[l.jsxs("div",{className:"oc-form-grid",children:[l.jsxs("div",{className:"oc-field",children:[l.jsx("label",{className:"emp-label",children:"Nombre *"}),l.jsx("input",{name:"nombre",className:"emp-input",autoComplete:"organization",required:!0,value:t.nombre,onChange:n})]}),l.jsxs("div",{className:"oc-field",children:[l.jsx("label",{className:"emp-label",children:"Marca"}),l.jsx("input",{name:"marca",className:"emp-input",value:t.marca,onChange:n})]}),l.jsxs("div",{className:"oc-field",children:[l.jsx("label",{className:"emp-label",children:"Pas"}),l.jsxs("select",{name:"pais",className:"emp-select",value:t.pais,onChange:n,children:[l.jsx("option",{children:"Colombia"}),l.jsx("option",{children:"Mxico"}),l.jsx("option",{children:"Per"}),l.jsx("option",{children:"Chile"}),l.jsx("option",{children:"Argentina"}),l.jsx("option",{children:"Espaa"})]})]}),l.jsxs("div",{className:"oc-field",children:[l.jsx("label",{className:"emp-label",children:"Ciudad"}),l.jsx("input",{name:"ciudad",className:"emp-input",value:t.ciudad,onChange:n})]}),l.jsxs("div",{className:"oc-field",children:[l.jsx("label",{className:"emp-label",children:"Tipo documento *"}),l.jsxs("select",{name:"tipoDocumento",className:"emp-select",required:!0,value:t.tipoDocumento,onChange:n,children:[l.jsx("option",{children:"NIT"}),l.jsx("option",{children:"CC"}),l.jsx("option",{children:"CE"}),l.jsx("option",{children:"PA"})]})]}),l.jsxs("div",{className:"oc-field",children:[l.jsx("label",{className:"emp-label",children:"Nmero de documento *"}),l.jsx("input",{name:"numeroDocumento",className:"emp-input",required:!0,value:t.numeroDocumento,onChange:n})]}),l.jsxs("div",{className:"oc-field",children:[l.jsx("label",{className:"emp-label",children:"Tipo de persona"}),l.jsxs("select",{name:"tipoPersona",className:"emp-select",value:t.tipoPersona,onChange:n,children:[l.jsx("option",{value:"",children:"Seleccione"}),l.jsx("option",{children:"Natural"}),l.jsx("option",{children:"Jurdica"})]})]}),l.jsxs("div",{className:"oc-field",children:[l.jsx("label",{className:"emp-label",children:"Telfono fijo"}),l.jsx("input",{name:"telefono",className:"emp-input",inputMode:"tel",autoComplete:"tel",value:t.telefono,onChange:n})]}),l.jsxs("div",{className:"oc-field",children:[l.jsx("label",{className:"emp-label",children:"Celular"}),l.jsx("input",{name:"celular",className:"emp-input",inputMode:"tel",autoComplete:"tel",value:t.celular,onChange:n})]}),l.jsxs("div",{className:"oc-field oc-col-2",children:[l.jsx("label",{className:"emp-label",children:"Direccin"}),l.jsx("input",{name:"direccion",className:"emp-input",autoComplete:"street-address",value:t.direccion,onChange:n})]}),l.jsxs("div",{className:"oc-field oc-col-2",children:[l.jsx("label",{className:"emp-label",children:"Sitio web"}),l.jsx("input",{name:"sitioWeb",className:"emp-input",inputMode:"url",placeholder:"https://",value:t.sitioWeb,onChange:n})]}),l.jsxs("div",{className:"oc-field oc-col-2",children:[l.jsx("label",{className:"emp-label",children:"Agendamiento (URL)"}),l.jsx("input",{name:"urlAgendamiento",className:"emp-input",inputMode:"url",placeholder:"https://",value:t.urlAgendamiento,onChange:n})]}),l.jsxs("div",{className:"oc-field",children:[l.jsx("label",{className:"emp-label",children:"Rgimen legal"}),l.jsxs("select",{name:"regimen",className:"emp-select",value:t.regimen,onChange:n,children:[l.jsx("option",{value:"",children:"Seleccione"}),l.jsx("option",{children:"Comn"}),l.jsx("option",{children:"Simplificado"})]})]}),l.jsxs("div",{className:"oc-field",children:[l.jsx("label",{className:"emp-label",children:"Responsabilidad tributaria"}),l.jsxs("select",{name:"responsabilidadTributaria",className:"emp-select",value:t.responsabilidadTributaria,onChange:n,children:[l.jsx("option",{value:"",children:"Seleccione"}),l.jsx("option",{children:"No aplica"}),l.jsx("option",{children:"Autorretenedor"})]})]}),l.jsxs("div",{className:"oc-field oc-col-2",children:[l.jsx("label",{className:"emp-label",children:"Correo electrnico"}),l.jsx("input",{name:"correo",className:"emp-input",type:"email",autoComplete:"email",value:t.correo,onChange:n})]}),l.jsxs("div",{className:"oc-field",children:[l.jsx("label",{className:"emp-label",children:"Moneda"}),l.jsxs("select",{name:"moneda",className:"emp-select",value:t.moneda,onChange:n,children:[l.jsx("option",{children:"Pesos colombianos (COP)"}),l.jsx("option",{children:"Dlares (USD)"}),l.jsx("option",{children:"Euros (EUR)"})]})]}),l.jsxs("div",{className:"oc-field",children:[l.jsx("label",{className:"emp-label",children:"Zona horaria"}),l.jsxs("select",{name:"zonaHoraria",className:"emp-select",value:t.zonaHoraria,onChange:n,children:[l.jsx("option",{children:"Hora de Colombia"}),l.jsx("option",{children:"America/Bogota"}),l.jsx("option",{children:"UTC-5"})]})]}),l.jsxs("div",{className:"oc-field oc-col-2",children:[l.jsx("label",{className:"emp-label",children:"Cuenta contable"}),l.jsx("input",{name:"cuentaContable",className:"emp-input",value:t.cuentaContable,onChange:n})]}),l.jsxs("div",{className:"oc-field",children:[l.jsx("label",{className:"emp-label",children:"Es una institucin prestadora de salud (IPS)?"}),l.jsxs("div",{className:"emp-inline",children:[l.jsx("input",{id:"esIPS",type:"checkbox",name:"esIPS",checked:t.esIPS,onChange:n}),l.jsx("label",{htmlFor:"esIPS",children:"S"})]})]}),l.jsxs("div",{className:"oc-field",children:[l.jsx("label",{className:"emp-label",children:"Usuario SISPRO"}),l.jsx("input",{name:"usuarioSispro",className:"emp-input",value:t.usuarioSispro,onChange:n})]}),l.jsxs("div",{className:"oc-field",children:[l.jsx("label",{className:"emp-label",children:"Tipo documento SISPRO"}),l.jsxs("select",{name:"tipoDocSispro",className:"emp-select",value:t.tipoDocSispro,onChange:n,children:[l.jsx("option",{children:"Cdula de Ciudadana"}),l.jsx("option",{children:"Cdula de Extranjera"}),l.jsx("option",{children:"NIT"})]})]}),l.jsxs("div",{className:"oc-field",children:[l.jsx("label",{className:"emp-label",children:"Contrasea SISPRO"}),l.jsx("input",{name:"passwordSispro",className:"emp-input",type:"password",value:t.passwordSispro,onChange:n})]}),l.jsxs("div",{className:"oc-field",children:[l.jsx("label",{className:"emp-label",children:"Cdigo de prestador"}),l.jsx("input",{name:"codigoPrestador",className:"emp-input",value:t.codigoPrestador,onChange:n})]})]}),l.jsx("div",{className:"oc-form-actions",children:l.jsx("button",{type:"submit",className:"oc-btn primary",children:"Guardar"})})]})]})]})}const Hp="empresa_logo_url";function wx(t,e){let n=document.querySelector(`meta[name="${t}"]`);n||(n=document.createElement("meta"),n.setAttribute("name",t),document.head.appendChild(n)),n.setAttribute("content",e)}function t6(){const[t,e]=A.useState(()=>{try{return localStorage.getItem(Hp)||""}catch{return""}}),[n,r]=A.useState(null),[s,i]=A.useState(!1),o=A.useRef(null),a=A.useCallback(C=>{const N=C==null?void 0:C[0];if(!N)return;if(!N.type.startsWith("image/")){alert("Por favor selecciona una imagen (PNG/JPG/SVG/WebP).");return}r(N);const T=new FileReader;T.onload=y=>{var v;return e(String(((v=y.target)==null?void 0:v.result)||""))},T.readAsDataURL(N)},[]),c=C=>a(C.target.files),d=C=>{C.preventDefault(),C.stopPropagation(),i(!1),a(C.dataTransfer.files)},h=C=>{C.preventDefault(),i(!0)},f=()=>i(!1),m=()=>{var C;return(C=o.current)==null?void 0:C.click()},_=()=>{r(null),e("")},R=async()=>{try{t?(localStorage.setItem(Hp,t),wx("company-logo",t)):(localStorage.removeItem(Hp),wx("company-logo","")),alert("Logo guardado.")}catch(C){console.error(C),alert("No se pudo guardar localmente.")}};return l.jsxs("div",{className:"oc-main-content",children:[l.jsx("div",{className:"oc-section-title",children:l.jsx("h2",{children:"Configuracin  Logo empresa"})}),l.jsxs("div",{className:"emp-card",children:[l.jsx("div",{className:"emp-title",children:"Logo"}),l.jsxs("div",{className:"logo-wrap",children:[l.jsxs("div",{className:"logo-current",children:[l.jsx("div",{className:"emp-label",children:"Logo actual"}),l.jsx("div",{className:"logo-preview","aria-live":"polite",children:t?l.jsx("img",{src:t,alt:"Logo actual de la empresa"}):l.jsx("div",{className:"logo-empty",children:"Sin logo"})}),l.jsx("div",{className:"logo-actions",children:l.jsx("button",{type:"button",className:"oc-btn danger",onClick:_,disabled:!t,children:"Eliminar"})})]}),l.jsxs("div",{className:"logo-uploader",children:[l.jsx("div",{className:"emp-label",children:"Cargar foto"}),l.jsxs("div",{className:`logo-drop ${s?"over":""}`,onDragOver:h,onDragLeave:f,onDrop:d,onClick:m,role:"button",tabIndex:0,onKeyDown:C=>(C.key==="Enter"||C.key===" ")&&m(),"aria-label":"Arrastra o haz click para cargar la imagen del logo",children:[l.jsx("input",{ref:o,type:"file",accept:"image/*",onChange:c,style:{display:"none"}}),l.jsxs("div",{className:"logo-drop-hint",children:["Arrastra o click para cargar la foto.",l.jsx("div",{className:"logo-subhint",children:"Solo archivos de imagen"})]})]}),n&&l.jsxs("div",{className:"logo-file-name",children:["Archivo seleccionado: ",l.jsx("b",{children:n.name})]})]})]}),l.jsx("div",{className:"oc-form-actions",children:l.jsx("button",{type:"button",className:"oc-btn primary",onClick:R,children:"Guardar"})})]})]})}const n6="modulepreload",r6=function(t){return"/odontocloud-react/"+t},Ex={},ZA=function(e,n,r){let s=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),a=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));s=Promise.allSettled(n.map(c=>{if(c=r6(c),c in Ex)return;Ex[c]=!0;const d=c.endsWith(".css"),h=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${h}`))return;const f=document.createElement("link");if(f.rel=d?"stylesheet":n6,d||(f.as="script"),f.crossOrigin="",f.href=c,a&&f.setAttribute("nonce",a),document.head.appendChild(f),d)return new Promise((m,_)=>{f.addEventListener("load",m),f.addEventListener("error",()=>_(new Error(`Unable to preload CSS for ${c}`)))})}))}function i(o){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=o,window.dispatchEvent(a),!a.defaultPrevented)throw o}return s.then(o=>{for(const a of o||[])a.status==="rejected"&&i(a.reason);return e().catch(i)})};function s6(t=""){const e=t.split("/").filter(Boolean),n=e.findIndex(r=>r.startsWith("dashboard_"));return n>=0?`/${e.slice(0,n+1).join("/")}`:""}const i6=(t,e)=>t.toLowerCase().endsWith(e.toLowerCase());async function o6(t="OdontoCloud-PriceList"){const e=["Categora","Cdigo","Nombre","Permite desc","Precio","Genera RIPS","Es consulta","Ver en la agenda","Nombre en la agenda","Tiempo","Identificador","Ver en agenda","Cuenta contable"];try{const n=await ZA(()=>import("https://cdn.sheetjs.com/xlsx-0.20.3/package/xlsx.mjs"),[]),r=[e],s=n.utils.aoa_to_sheet(r),i=n.utils.book_new();n.utils.book_append_sheet(i,s,"Lista de precios");const o=n.utils.aoa_to_sheet([["Formato"]]);n.utils.book_append_sheet(i,o,"Formatos");const a=n.utils.aoa_to_sheet([["Identificador","Descripcin"]]);n.utils.book_append_sheet(i,a,"Identificadores de tipo de cita");const c=n.write(i,{bookType:"xlsx",type:"array"}),d=new Blob([c],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),h=URL.createObjectURL(d),f=document.createElement("a");f.href=h,f.download=`${t}.xlsx`,f.click(),URL.revokeObjectURL(h)}catch(n){console.warn("No se pudo cargar XLSX, exportando CSV.",n);const r=[e.join(",")].join(`
`),s=new Blob([r],{type:"text/csv;charset=utf-8;"}),i=URL.createObjectURL(s),o=document.createElement("a");o.href=i,o.download=`${t}.csv`,o.click(),URL.revokeObjectURL(i)}}function a6({tipo:t="clinicos",onCancel:e,onSaved:n}){const[r,s]=A.useState(""),[i,o]=A.useState(!1),a=async()=>{if(!r.trim()){alert("Por favor, escribe el nombre de la lista.");return}o(!0);try{const c=new Date().toLocaleString("es-CO",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"});await Br(Pe(ue,"listas_precios"),{nombre:r.trim(),tipo:t,creado:c,actualizado:c,enUso:!0}),n==null||n()}catch(c){console.error("Error creando lista:",c),alert("No se pudo crear la lista. Revisa consola.")}finally{o(!1)}};return l.jsxs("div",{className:"card",style:{position:"relative"},children:[l.jsx("button",{type:"button",title:"Exportar",className:"ghost-chip",style:{position:"absolute",right:16,top:16,height:34,padding:"0 12px",borderRadius:999,border:"1px solid #e5e7eb",background:"#eff6ff",fontWeight:600,cursor:"pointer",opacity:.9},onClick:()=>o6("OdontoCloud-PriceList"),children:"Exportar"}),l.jsxs("div",{className:"lp-formbox",style:{border:"1px solid #e5e7eb",borderRadius:10,padding:16,background:"#fff",maxWidth:720},children:[l.jsx("label",{htmlFor:"nombreLista",style:{display:"block",fontWeight:700,marginBottom:8},children:"Nombre *"}),l.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[l.jsx("input",{id:"nombreLista",type:"text",value:r,onChange:c=>s(c.target.value),placeholder:"Nombre de la lista",style:{flex:1,height:38,padding:"0 10px",borderRadius:8,border:`1px solid ${r?"#cbd5e1":"#fca5a5"}`,outline:"none"}}),l.jsx("button",{type:"button",title:"Sugerir nombre",className:"round-tip",onClick:()=>s("Lista de precios "+new Date().toLocaleDateString("es-CO")),style:{height:38,width:38,borderRadius:999,border:"1px solid #e5e7eb",background:"#f9fafb",cursor:"pointer",fontWeight:700},children:""})]}),l.jsxs("div",{style:{marginTop:16,display:"flex",gap:8},children:[l.jsx("button",{type:"button",onClick:a,disabled:i,className:"save-btn",style:{height:36,padding:"0 14px",borderRadius:8,border:0,background:"#22c55e",color:"#fff",fontWeight:700,cursor:"pointer"},children:i?"Guardando...":"Guardar"}),l.jsx("button",{type:"button",onClick:e,className:"neutral-btn",style:{height:36,padding:"0 14px",borderRadius:8,border:"1px solid #e5e7eb",background:"#fff",fontWeight:600,cursor:"pointer"},children:"Cancelar"})]})]})]})}function l6(){const{pathname:t}=Dn(),e=Es(),r=`${A.useMemo(()=>s6(t),[t])}/config/lista-de-precios`,s=i6(t,"/config/lista-de-precios/nuevo"),[i,o]=A.useState("clinicos"),[a,c]=A.useState([]),[d,h]=A.useState(!0),[f,m]=A.useState(0);A.useEffect(()=>{const y="lp-inline-styles-2";if(!document.getElementById(y)){const v=`
        .oc-main-content.lp { padding: 16px 20px !important; }
        .oc-section-title { margin-bottom: 16px !important; }
        .oc-section-title h2 { margin: 0 !important; font-weight: 800 !important; font-size: 20px !important; color: #0f172a !important; }
        .lp .card { background:#fff !important; border:1px solid #e5e7eb !important; border-radius:10px !important; padding:16px !important; box-shadow: 0 2px 8px rgba(0,0,0,.04) !important; }
        .lp .lp-formbox { width:100% !important; max-width: 900px !important; }
        .lp .card .lp-formbox input[type="text"] { width: 100% !important; }
        .lp .table-responsive { width:100% !important; overflow-x:auto !important; }
        .lp .table-responsive table { width:100% !important; border-collapse: collapse !important; }
        .lp .table-responsive th, .lp .table-responsive td { white-space: nowrap !important; }
        .lp .tabs-btn { padding: 8px 14px !important; border-radius: 8px !important; border: 1px solid #cbd5e1 !important; font-weight: 600 !important; cursor: pointer !important; }
        @media (max-width: 640px){ .oc-main-content.lp { padding: 12px !important; } .oc-section-title h2 { font-size: 18px !important; } }
      `,E=document.createElement("style");E.id=y,E.appendChild(document.createTextNode(v)),document.head.appendChild(E)}},[]),A.useEffect(()=>{const y="lp-solid-btns";if(document.getElementById(y))return;const v=`
      .lp .tabs-btn{appearance:none!important;-webkit-appearance:none!important;border:1px solid #cbd5e1!important;font-weight:600!important;cursor:pointer!important}
      .lp .tabs-btn{background:#f8fafc!important;color:#1e293b!important}
      .lp .tabs-btn.active{background:#2563eb!important;color:#fff!important;border-color:#1d4ed8!important}

      .lp .save-btn{appearance:none!important;-webkit-appearance:none!important;border:none!important;background:#22c55e!important;color:#fff!important}
      .lp .neutral-btn{appearance:none!important;-webkit-appearance:none!important;border:1px solid #e5e7eb!important;background:#fff!important;color:#111827!important}

      .lp .btn-blue{appearance:none!important;-webkit-appearance:none!important;border:none!important;background:#3b82f6!important;color:#fff!important}
      .lp .btn-sky{appearance:none!important;-webkit-appearance:none!important;border:none!important;background:#06b6d4!important;color:#fff!important}
      .lp .btn-red{appearance:none!important;-webkit-appearance:none!important;border:none!important;background:#ef4444!important;color:#fff!important}

      .lp .round-tip{appearance:none!important;-webkit-appearance:none!important;background:#f9fafb!important;border:1px solid #e5e7eb!important;color:#111827!important}
      .lp .ghost-chip{appearance:none!important;-webkit-appearance:none!important;background:#eff6ff!important;border:1px solid #e5e7eb!important;color:#0f172a!important;opacity:1!important}
    `,E=document.createElement("style");E.id=y,E.appendChild(document.createTextNode(v)),document.head.appendChild(E)},[]),A.useEffect(()=>{(async()=>{h(!0);try{const v=Pe(ue,"listas_precios"),O=(await Vt(v)).docs.map(F=>({id:F.id,nombre:F.data().nombre||"Sin nombre",creado:F.data().creado||"",actualizado:F.data().actualizado||"",enUso:F.data().enUso??!0}));c(O)}catch(v){console.error("Error cargando listas:",v)}finally{h(!1)}})()},[f]);const _=y=>e(`${r}/editar/${y}`),R=async y=>{try{const v=mt(ue,"listas_precios",y),E=await za(v);if(!E.exists())return alert("No se encontr la lista para duplicar.");const O=E.data(),F=new Date().toLocaleString("es-CO");await Br(Pe(ue,"listas_precios"),{...O,nombre:`${O.nombre||"Lista"} (copia)`,creado:F,actualizado:F}),m(x=>x+1)}catch(v){console.error(v),alert("No se pudo duplicar la lista.")}},C=async y=>{if(confirm("Eliminar esta lista de precios?"))try{await Rf(mt(ue,"listas_precios",y)),c(v=>v.filter(E=>E.id!==y))}catch(v){console.error(v),alert("No se pudo eliminar.")}},N=()=>e(`${r}/nuevo`),T=()=>e(r);return l.jsxs("div",{className:"oc-main-content lp",children:[l.jsx("div",{className:"oc-section-title",children:l.jsxs("h2",{children:["Configuracin  ",s?"Nueva lista de precios":"Lista de precios"]})}),s?l.jsx(a6,{tipo:i,onCancel:T,onSaved:()=>{m(y=>y+1),T()}}):l.jsxs("div",{className:"card",children:[l.jsxs("div",{style:{display:"flex",gap:8,marginBottom:16,flexWrap:"wrap"},children:[[{key:"clinicos",label:"Lista de precios clnicos"},{key:"productos",label:"Lista de precios productos"},{key:"servicios",label:"Lista de precios servicios"}].map(y=>l.jsx("button",{className:`tabs-btn ${i===y.key?"active":""}`,onClick:()=>o(y.key),style:{background:i===y.key?"#2563eb":"#f8fafc",color:i===y.key?"#fff":"#1e293b"},children:y.label},y.key)),l.jsx("button",{className:"tabs-btn active",style:{marginLeft:"auto",background:"#65a30d",color:"#fff",border:"none",borderRadius:8,padding:"8px 14px",cursor:"pointer",fontWeight:600},onClick:N,children:"+ Nuevo listado de precios"})]}),l.jsx("div",{className:"table-responsive",children:l.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:".9rem"},children:[l.jsx("thead",{children:l.jsxs("tr",{style:{background:"#f1f5f9"},children:[l.jsx("th",{style:Rl,children:"Nombre"}),l.jsx("th",{style:Rl,children:"Fecha de creacin"}),l.jsx("th",{style:Rl,children:"Fecha de actualizacin"}),l.jsx("th",{style:Rl,children:"En uso"}),l.jsx("th",{style:Rl,children:"Acciones"})]})}),l.jsx("tbody",{children:d?l.jsx("tr",{children:l.jsx("td",{colSpan:5,style:{textAlign:"center",padding:20},children:"Cargando"})}):a.length===0?l.jsx("tr",{children:l.jsx("td",{colSpan:5,style:{textAlign:"center",padding:20},children:"No hay listas registradas."})}):a.map(y=>l.jsxs("tr",{style:{borderBottom:"1px solid #e2e8f0"},children:[l.jsx("td",{style:Nl,children:y.nombre}),l.jsx("td",{style:Nl,children:y.creado}),l.jsx("td",{style:Nl,children:y.actualizado}),l.jsx("td",{style:Nl,children:l.jsx("span",{style:{color:y.enUso?"#15803d":"#dc2626",fontWeight:600},children:y.enUso?"En uso":"Inactivo"})}),l.jsxs("td",{style:Nl,children:[l.jsx("button",{className:"btn-blue",style:c6,title:"Editar",onClick:()=>_(y.id),children:""}),l.jsx("button",{className:"btn-sky",style:u6,title:"Duplicar",onClick:()=>R(y.id),children:""}),l.jsx("button",{className:"btn-red",style:d6,title:"Eliminar",onClick:()=>C(y.id),children:""})]})]},y.id))})]})})]})]})}const Rl={padding:"10px 12px",textAlign:"left",borderBottom:"1px solid #e2e8f0",color:"#475569",fontWeight:700},Nl={padding:"10px 12px",color:"#0f172a"},c6={background:"#3b82f6",border:"none",color:"#fff",padding:"4px 8px",borderRadius:6,marginRight:6,cursor:"pointer"},u6={background:"#06b6d4",border:"none",color:"#fff",padding:"4px 8px",borderRadius:6,marginRight:6,cursor:"pointer"},d6={background:"#ef4444",border:"none",color:"#fff",padding:"4px 8px",borderRadius:6,cursor:"pointer"};function h6(t=""){const e=t.split("/").filter(Boolean),n=e.findIndex(r=>r.startsWith("dashboard_"));return n>=0?`/${e.slice(0,n+1).join("/")}`:""}function f6(){A.useEffect(()=>{const t="lp-edit-inline";if(document.getElementById(t))return;const e=`
      .oc-main-content.lp { padding:16px 20px }
      .oc-section-title { margin-bottom:16px }
      .oc-section-title h2 { margin:0; font-weight:800; font-size:20px; color:#0f172a }
      .card { background:#fff; border:1px solid #e5e7eb; border-radius:10px; padding:16px; box-shadow:0 2px 8px rgba(0,0,0,.04) }
      .toolbar { display:flex; gap:8px; align-items:center; }
      .chip { height:34px; padding:0 12px; border-radius:999px; border:1px solid #e5e7eb; cursor:pointer; font-weight:600 }
      .chip.blue { background:#eff6ff }
      .chip.green { background:#65a30d; color:#fff; border:none }
      .name-row { display:flex; align-items:center; gap:8px; }
      .text-inp { height:38px; padding:0 10px; border-radius:8px; border:1px solid #cbd5e1; outline:none; width:280px }
      .table-responsive { width:100%; overflow-x:auto }
      table { width:100%; border-collapse:collapse; font-size:.9rem }
      thead tr { background:#f1f5f9 }
      th, td { padding:10px 12px; white-space:nowrap }
      th { text-align:left; border-bottom:1px solid #e2e8f0; color:#475569; font-weight:700 }
      tr + tr { border-top:1px solid #e2e8f0 }
      .btn { padding:4px 8px; border:none; border-radius:6px; color:#fff; cursor:pointer; margin-right:6px }
      .btn.blue { background:#3b82f6 }
      .btn.sky { background:#06b6d4 }
      .btn.green { background:#22c55e }
      .btn.orange { background:#f59e0b }
      .btn.red { background:#ef4444 }
      .status-pill { padding:2px 8px; border-radius:999px; font-weight:600 }
      .status-on { background:#dcfce7; color:#166534 }
      .status-off{ background:#fee2e2; color:#991b1b }
      @media (max-width:640px){ .text-inp{ width:100% } }
    `,n=document.createElement("style");n.id=t,n.appendChild(document.createTextNode(e)),document.head.appendChild(n)},[])}function p6(){f6();const{id:t}=EP(),{pathname:e}=Dn(),n=Es(),s=`${A.useMemo(()=>h6(e),[e])}/config/lista-de-precios`,[i,o]=A.useState(""),[a,c]=A.useState(!1),[d,h]=A.useState([]),[f,m]=A.useState(!0);A.useEffect(()=>{async function y(){m(!0);try{const v=mt(ue,"listas_precios",t),E=await za(v);E.exists()?o(E.data().nombre||""):(console.warn("[LP editar] El documento NO existe:",t),o(""))}catch(v){console.error("[LP editar] Error getDoc listas_precios/"+t,v.code,v.message),o("")}try{const v=Pe(ue,"listas_precios",t,"categorias"),O=(await Vt(v)).docs.map(F=>({id:F.id,...F.data(),activa:F.data().activa??!0}));O.sort((F,x)=>(F.nombre||"").localeCompare(x.nombre||"")),h(O)}catch(v){console.warn("[LP editar] No se pudieron leer categoras (seguimos con vaco)",v.code,v.message),h([])}finally{m(!1)}}y()},[t]);async function _(){try{c(!0),await ui(mt(ue,"listas_precios",t),{nombre:(i||"").trim(),actualizado:new Date().toLocaleString("es-CO")})}catch(y){console.error(y),alert("No se pudo actualizar el nombre.")}finally{c(!1)}}async function R(){const y=prompt("Nombre de la categora:");if(y)try{const v=Pe(ue,"listas_precios",t,"categorias");await Br(v,{nombre:y.trim(),comentario:"",activa:!0,creado:new Date().toLocaleString("es-CO")});const E=await Vt(v);h(E.docs.map(O=>({id:O.id,...O.data(),activa:O.data().activa??!0})))}catch(v){console.error(v),alert("No se pudo agregar la categora.")}}async function C(y){try{await ui(mt(ue,"listas_precios",t,"categorias",y.id),{activa:!y.activa}),h(v=>v.map(E=>E.id===y.id?{...E,activa:!E.activa}:E))}catch(v){console.error(v),alert("No se pudo cambiar el estado.")}}async function N(y){try{const v=Pe(ue,"listas_precios",t,"categorias");await Br(v,{...y,nombre:`${y.nombre||"Categora"} (copia)`,creado:new Date().toLocaleString("es-CO")});const E=await Vt(v);h(E.docs.map(O=>({id:O.id,...O.data(),activa:O.data().activa??!0})))}catch(v){console.error(v),alert("No se pudo duplicar.")}}async function T(y){if(confirm(`Eliminar categora "${y.nombre}"?`))try{await Rf(mt(ue,"listas_precios",t,"categorias",y.id)),h(v=>v.filter(E=>E.id!==y.id))}catch(v){console.error(v),alert("No se pudo eliminar.")}}return l.jsxs("div",{className:"oc-main-content lp",children:[l.jsx("div",{className:"oc-section-title",children:l.jsx("h2",{children:"Configuracin  Edicin Lista de precios"})}),l.jsxs("div",{className:"card",children:[l.jsxs("div",{className:"toolbar",style:{justifyContent:"space-between",marginBottom:12},children:[l.jsxs("div",{className:"name-row",children:[l.jsx("label",{style:{fontWeight:700},children:"Nombre*"}),l.jsx("input",{className:"text-inp",value:i,placeholder:"Principal",onChange:y=>o(y.target.value)}),l.jsx("button",{className:"btn green",onClick:_,disabled:a,title:"Guardar nombre",children:a?"Guardando":"Guardar"})]}),l.jsxs("div",{style:{display:"flex",gap:8},children:[l.jsx("button",{className:"chip blue",title:"Exportar",onClick:()=>alert("Exportar"),children:"Exportar"}),l.jsx("button",{className:"chip",title:"Opciones",onClick:()=>alert("Opciones"),children:""}),l.jsx("button",{className:"chip green",onClick:R,children:"+ Agregar categora"})]})]}),l.jsx("div",{className:"table-responsive",children:l.jsxs("table",{children:[l.jsx("thead",{children:l.jsxs("tr",{children:[l.jsx("th",{style:{width:40}}),l.jsx("th",{children:"Categora"}),l.jsx("th",{children:"Comentario"}),l.jsx("th",{style:{width:140},children:"Estado"}),l.jsx("th",{style:{width:220,textAlign:"right"},children:"Acciones"})]})}),l.jsx("tbody",{children:f?l.jsx("tr",{children:l.jsx("td",{colSpan:5,style:{textAlign:"center",padding:20},children:"Cargando"})}):d.length===0?l.jsx("tr",{children:l.jsx("td",{colSpan:5,style:{textAlign:"center",padding:20},children:"Sin categoras."})}):d.map(y=>l.jsxs("tr",{children:[l.jsx("td",{children:""}),l.jsx("td",{style:{fontWeight:700},children:y.nombre||"Categora"}),l.jsx("td",{style:{color:"#475569"},children:y.comentario||""}),l.jsx("td",{children:l.jsx("span",{className:`status-pill ${y.activa?"status-on":"status-off"}`,children:y.activa?"Conectado":"Desconectado"})}),l.jsxs("td",{style:{textAlign:"right"},children:[l.jsx("button",{className:"btn green",title:"Agregar tem",onClick:()=>alert("Agregar tem"),children:""}),l.jsx("button",{className:"btn orange",title:"Descuento %",onClick:()=>alert("Descuento"),children:"%"}),l.jsx("button",{className:"btn sky",title:"Duplicar",onClick:()=>N(y),children:""}),l.jsx("button",{className:"btn red",title:"Eliminar",onClick:()=>T(y),children:"B"}),l.jsx("button",{className:"btn blue",title:y.activa?"Desactivar":"Activar",onClick:()=>C(y),style:{marginLeft:6},children:y.activa?"":""})]})]},y.id))})]})}),l.jsx("div",{style:{marginTop:16},children:l.jsx("button",{className:"chip",onClick:()=>n(s),children:" Volver"})})]})]})}const m6={"datos-basicos":e6,logo:t6,"lista-de-precios":l6};function g6(t=""){const e=t.toLowerCase().indexOf("/config/");return e===-1?[]:t.slice(e+8).split("/").filter(Boolean)}function y6(t=""){const e=t.split("/").filter(Boolean),n=e.findIndex(r=>r.startsWith("dashboard_"));return n>=0?`/${e.slice(0,n+1).join("/")}`:""}function v6({current:t,onNav:e}){const n=[{slug:"datos-basicos",label:"Datos bsicos"},{slug:"logo",label:"Logo"},{slug:"lista-de-precios",label:"Lista de precios"},{slug:"consecutivos",label:"Consecutivos",soon:!0},{slug:"sucursales",label:"Sucursales",soon:!0},{slug:"metodos-de-pago",label:"Mtodos de pago",soon:!0},{slug:"especialidades",label:"Especialidades",soon:!0},{slug:"usuarios",label:"Usuarios",soon:!0},{slug:"condiciones-de-pago",label:"Condiciones de pago",soon:!0},{slug:"plantillas-doc-clinicos",label:"Plantillas Doc. Clnicos",soon:!0},{slug:"impuestos",label:"Impuestos",soon:!0}];return l.jsxs("aside",{style:{width:300,flex:"0 0 300px",background:"#fff",border:"1px solid #e5e7eb",borderRadius:12,padding:12,position:"sticky",top:12,alignSelf:"flex-start",maxHeight:"calc(100vh - 24px)",overflow:"auto"},"aria-label":"Informacin general",children:[l.jsx("h4",{style:{margin:"4px 0 10px",color:"#64748b"},children:"Informacin general"}),l.jsx("div",{style:{display:"flex",flexDirection:"column",gap:8},children:n.map(r=>{const s=r.slug===t;return l.jsxs("button",{type:"button",onClick:()=>!r.soon&&e(r.slug),title:r.soon?"Prximamente":r.label,style:{textAlign:"left",padding:"10px 12px",borderRadius:10,border:"1px solid "+(s?"#60a5fa":"#e5e7eb"),background:s?"#eff6ff":"#f9fafb",fontWeight:600,cursor:r.soon?"not-allowed":"pointer",color:r.soon?"#94a3b8":"#0f172a"},children:[r.label," ",r.soon?"  prximamente":""]},r.slug)})})]})}function Ix(){return l.jsxs("div",{className:"card",style:{background:"#fff",border:"1px solid #e5e7eb",borderRadius:12,padding:16},children:[l.jsx("h3",{style:{marginTop:0},children:"Configuracin"}),l.jsxs("p",{className:"oc-muted",style:{margin:0},children:["Selecciona una seccin del men de la izquierda para empezar (por ejemplo, ",l.jsx("b",{children:"Datos bsicos"}),")."]})]})}function _6(){const{pathname:t}=Dn(),e=Es(),n=g6(t),r=n[0]||"",s=n[1]||"",i=y6(t),a=r==="lista-de-precios"&&s==="editar"?p6:m6[r],c=d=>e(`${i}/config/${d}`);return A.useEffect(()=>{r||e(`${i}/config/datos-basicos`,{replace:!0})},[r,i,e]),l.jsxs("div",{style:{display:"grid",gridTemplateColumns:"300px 1fr",gap:16,background:"#f8fafc",padding:16,borderRadius:12},children:[l.jsx(v6,{current:r,onNav:c}),l.jsx("div",{style:{minWidth:0,background:"#fff",border:"1px solid #e5e7eb",borderRadius:12,padding:16},children:r?a?l.jsx(a,{}):l.jsx(Ix,{}):l.jsx(Ix,{})})]})}const Lr=t=>(Number(t)||0).toLocaleString("es-CO",{maximumFractionDigits:0}),zo=()=>new Date().toISOString().slice(0,10),w6=(t=new Date)=>new Date(t.getFullYear(),t.getMonth(),t.getDate(),0,0,0,0),E6=(t=new Date)=>new Date(t.getFullYear(),t.getMonth(),t.getDate()+1,0,0,0,0),xx=t=>ze.fromDate(t),I6=()=>{const[t,e]=A.useState(null);return A.useEffect(()=>{const n=Vy(Ah,r=>e(r||null));return()=>n()},[]),t},Ht=({children:t,align:e})=>l.jsx("th",{className:"oc-th",style:{position:"sticky",top:0,zIndex:1,textAlign:e||"left",background:"var(--oc-surface, #fff)"},children:t}),x6=()=>Math.random().toString(36).slice(2)+Math.random().toString(36).slice(2);function T6(){var Ie;const t=I6(),e=[{key:"abrir",label:"Abrir caja",icon:""},{key:"abiertas",label:"Cajas abiertas",icon:""},{key:"cerradas",label:"Cajas cerradas",icon:""},{key:"mio",label:"Mi caja (hoy)",icon:""},{key:"simulados",label:"Cierres simulados",icon:""},{key:"bancos",label:"Bancos",icon:""}],[n,r]=A.useState("abiertas"),[s,i]=A.useState(""),[o,a]=A.useState(""),c=A.useRef(null),[d,h]=A.useState(!1),[f,m]=A.useState(""),[_,R]=A.useState([]),[C,N]=A.useState(!0),[T,y]=A.useState([]),[v,E]=A.useState(!0),[O,F]=A.useState(null),[x,I]=A.useState(!0),[w,P]=A.useState(""),[D,j]=A.useState([]),[k,K]=A.useState(null),[Ge,$t]=A.useState(""),[hn,ee]=A.useState("efectivo"),[he,me]=A.useState(!1),[ke,Ye]=A.useState("ingreso"),[jt,U]=A.useState(""),[ne,ce]=A.useState(""),[Te,be]=A.useState(!1),[je,_e]=A.useState([]),[it,Re]=A.useState([]);A.useEffect(()=>{const M=st(Pe(ue,"cajas"),Xe("estado","==","abierta"),gn("fechaApertura","desc")),Y=Un(M,J=>{R(J.docs.map(Ce=>le(Ce.id,Ce.data()))),N(!1),i("")},J=>{console.error(J),i((J==null?void 0:J.code)==="failed-precondition"?"Falta ndice (estado, fechaApertura) en Firestore.":(J==null?void 0:J.code)==="permission-denied"?"Permiso denegado en Firestore (revisa reglas).":"No se pudieron leer las cajas."),N(!1)});return()=>Y()},[]),A.useEffect(()=>{const M=st(Pe(ue,"cajas"),Xe("estado","==","cerrada"),gn("fechaCierre","desc")),Y=Un(M,J=>{y(J.docs.map(Ce=>le(Ce.id,Ce.data()))),E(!1)},J=>{console.error(J),E(!1)});return()=>Y()},[]),A.useEffect(()=>{if(!t){F(null),I(!1);return}I(!0);const M=st(Pe(ue,"cajas"),Xe("estado","==","abierta"),Xe("usuarioId","==",t.uid),Xe("fechaApertura",">=",xx(w6())),Xe("fechaApertura","<",xx(E6()))),Y=Un(M,J=>{const Ce=J.docs[0];F(Ce?le(Ce.id,Ce.data()):null),I(!1)},J=>{console.error(J),I(!1),(J==null?void 0:J.code)==="failed-precondition"&&i("Falta ndice (estado, usuarioId, fechaApertura) en Firestore.")});return()=>Y()},[t]),A.useEffect(()=>{if(!(O!=null&&O.id)){_e([]),Re([]);return}const M=st(Pe(ue,"movimientos"),Xe("cashId","==",O.id),Xe("dia","==",zo()),gn("fecha","desc")),Y=Un(M,nt=>_e(nt.docs.map(St=>({id:St.id,...St.data()}))),nt=>console.error(nt)),J=st(Pe(ue,"payments"),Xe("cashId","==",O.id),Xe("dia","==",zo()),gn("fecha","desc")),Ce=Un(J,nt=>Re(nt.docs.map(St=>({id:St.id,...St.data()}))),nt=>console.error(nt));return()=>{Y(),Ce()}},[O==null?void 0:O.id]),A.useEffect(()=>{if(!(w!=null&&w.trim())){j([]);return}const M=st(Pe(ue,"patients"),Xe("q",">=",B(w)),Xe("q","<=",B(w)+""),gn("q","asc")),Y=Un(M,J=>j(J.docs.map(Ce=>({id:Ce.id,...Ce.data()}))),J=>console.error(J));return()=>Y()},[w]);function le(M,Y={}){const J=Ct=>{var Bt;return((Bt=Ct==null?void 0:Ct.toDate)==null?void 0:Bt.call(Ct))||(typeof Ct=="string"?new Date(Ct):Ct||null)},Ce=J(Y.fechaApertura),nt=J(Y.fechaCierre),St=Number(Y.baseInicial||0),Rr=Number(Y.baseActual!==void 0?Y.baseActual:St),xn=Number(Y.saldoInicial||0),jn=Number(Y.saldoActual!==void 0?Y.saldoActual:xn),en=[];return jn<0&&en.push("Saldo negativo"),Rr<0&&en.push("Base negativa"),{id:M,estado:Y.estado||"abierta",usuarioId:Y.usuarioId||"",usuarioNombre:Y.usuarioNombre||"Usuario",nombre:Y.nombre||Y.usuarioNombre||"Caja",fechaApertura:Ce,fechaCierre:nt,baseInicial:St,baseActual:Rr,saldoInicial:xn,saldoActual:jn,ia:en}}const Oe=async M=>{var Y;if((Y=M==null?void 0:M.preventDefault)==null||Y.call(M),!t){i("Debes iniciar sesin para abrir una caja.");return}h(!0);try{const J=Number(f||0);await Br(Pe(ue,"cajas"),{estado:"abierta",usuarioId:t.uid,usuarioNombre:t.displayName||t.email||"Usuario",fechaApertura:Xn(),baseInicial:J,baseActual:J,saldoInicial:0,saldoActual:0,dia:zo()}),m(""),r("mio"),i("")}catch(J){console.error(J),i("No se pudo abrir la caja.")}finally{h(!1)}},$e=async M=>{try{await ui(mt(ue,"cajas",M),{estado:"cerrada",fechaCierre:Xn()}),r("cerradas")}catch(Y){console.error(Y),i("No se pudo cerrar la caja.")}},tt=async M=>{var J;if((J=M==null?void 0:M.preventDefault)==null||J.call(M),!(O!=null&&O.id)){i("Debes abrir tu caja para registrar movimientos.");return}const Y=Number(ne||0);if(!(!Y||Y<=0)){be(!0);try{await Br(Pe(ue,"movimientos"),{cashId:O.id,tipo:ke,concepto:jt||(ke==="ingreso"?"Ingreso":"Egreso"),valor:Y,fecha:Xn(),dia:zo(),usuarioId:(t==null?void 0:t.uid)||null});const Ce=ke==="ingreso"?Y:-Y;await ui(mt(ue,"cajas",O.id),{saldoActual:KI(Ce)}),U(""),ce("")}catch(Ce){console.error(Ce),i("No se pudo registrar el movimiento.")}finally{be(!1)}}},H=async M=>{var J;if((J=M==null?void 0:M.preventDefault)==null||J.call(M),!(O!=null&&O.id))return i("Abre tu caja para cobrar.");const Y=Number(Ge||0);if(!(!Y||Y<=0)){if(!k)return i("Selecciona un paciente.");me(!0);try{const Ce=await Br(Pe(ue,"payments"),{cashId:O.id,patientId:k.id,patientName:k.nombre||k.name||"Paciente",invoiceId:null,valor:Y,medio:hn,estado:"aprobado",fecha:Xn(),dia:zo()});await ui(mt(ue,"cajas",O.id),{saldoActual:KI(Y)}),$t(""),ee("efectivo"),i(`Pago registrado (${Ce.id}).`)}catch(Ce){console.error(Ce),i("No se pudo registrar el pago.")}finally{me(!1)}}},se=async M=>{var J;if((J=M==null?void 0:M.preventDefault)==null||J.call(M),!(O!=null&&O.id))return i("Abre tu caja para cobrar.");const Y=Number(Ge||0);if(!(!Y||Y<=0)){if(!k)return i("Selecciona un paciente.");me(!0);try{const nt=`https://pay.odontocloud/mock/${x6()}`,St=await Br(Pe(ue,"payments"),{cashId:O.id,patientId:k.id,patientName:k.nombre||k.name||"Paciente",invoiceId:null,valor:Y,medio:"link",estado:"pending",linkUrl:nt,fecha:Xn(),dia:zo()});i(`Link de pago generado: ${nt}`),$t("")}catch(Ce){console.error(Ce),i("No se pudo generar link de pago.")}finally{me(!1)}}},B=M=>(M||"").toString().normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase(),re=A.useMemo(()=>{const M=B(o);return M?_.filter(Y=>[Y.nombre,Y.usuarioNombre,Lr(Y.saldoActual),Lr(Y.baseActual)].map(B).some(J=>J.includes(M))):_},[o,_]),ie=()=>l.jsxs("div",{className:"card",children:[l.jsx("div",{className:"oc-card-head",style:{marginBottom:8},children:l.jsx("h3",{children:"Abrir caja"})}),l.jsxs("form",{className:"oc-form",onSubmit:Oe,style:{display:"flex",gap:12,alignItems:"end",flexWrap:"wrap"},children:[l.jsxs("label",{style:{display:"inline-flex",flexDirection:"column",gap:6},children:[l.jsx("span",{children:"Base inicial (COP)"}),l.jsx("input",{type:"number",className:"oc-input",min:"0",step:"1000",value:f,onChange:M=>m(M.target.value),placeholder:"0"})]}),l.jsx("button",{className:"oc-btn",type:"submit",disabled:d,children:d?"Abriendo...":"Abrir caja"})]}),l.jsxs("p",{className:"oc-muted",style:{marginTop:8},children:["Se asociar a tu usuario y quedar visible en ",l.jsx("b",{children:"Mi caja (hoy)"}),"."]})]}),ye=()=>l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"card",style:{marginBottom:10},children:l.jsxs("div",{className:"oc-card-head",style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[l.jsx("h3",{style:{margin:0},children:"Cajas Abiertas"}),l.jsx("span",{className:"oc-tag",children:re.length}),s&&l.jsx("span",{className:"oc-tag oc-tag-danger",children:s})]}),l.jsx("input",{ref:c,className:"oc-input",style:{maxWidth:280},placeholder:"Buscar...",value:o,onChange:M=>a(M.target.value)})]})}),l.jsx("div",{className:"card",children:l.jsx("div",{className:"oc-table-wrap",children:l.jsxs("table",{className:"oc-table",children:[l.jsx("thead",{className:"oc-thead",children:l.jsxs("tr",{className:"oc-tr",children:[l.jsx(Ht,{children:"Caja"}),l.jsx(Ht,{children:"Fecha apertura"}),l.jsx(Ht,{align:"right",children:"Base actual"}),l.jsx(Ht,{align:"right",children:"Saldo inicial"}),l.jsx(Ht,{align:"right",children:"Saldo actual"}),l.jsx(Ht,{children:"Usuario"}),l.jsx(Ht,{children:"Acciones"})]})}),l.jsx("tbody",{className:"oc-tbody",children:C?l.jsx(Tx,{cols:7}):re.length===0?l.jsx("tr",{className:"oc-tr",children:l.jsx("td",{className:"oc-td",colSpan:7,children:l.jsx("span",{className:"oc-muted",children:"Sin cajas abiertas."})})}):re.map(M=>{var Y;return l.jsxs("tr",{className:"oc-tr",children:[l.jsxs("td",{className:"oc-td",children:[l.jsx("b",{children:M.nombre})," ",(Y=M.ia)!=null&&Y.length?l.jsx("span",{className:"oc-tag oc-tag-danger",title:M.ia.join("  "),children:"IA"}):null]}),l.jsx("td",{className:"oc-td",children:M.fechaApertura?M.fechaApertura.toLocaleString("es-CO"):""}),l.jsxs("td",{className:"oc-td",style:{textAlign:"right"},children:["$",Lr(M.baseActual)]}),l.jsxs("td",{className:"oc-td",style:{textAlign:"right"},children:["$",Lr(M.saldoInicial)]}),l.jsxs("td",{className:"oc-td",style:{textAlign:"right",color:M.saldoActual<0?"#b91c1c":void 0,fontWeight:600},children:["$",Lr(M.saldoActual)]}),l.jsx("td",{className:"oc-td",children:M.usuarioNombre}),l.jsxs("td",{className:"oc-td",style:{whiteSpace:"nowrap"},children:[l.jsx("button",{className:"oc-small-btn",onClick:()=>r("mio"),children:"Ver"})," ",l.jsx("button",{className:"oc-small-btn oc-danger",onClick:()=>$e(M.id),children:"Cerrar"})]})]},M.id)})})]})})})]}),ve=()=>l.jsxs("div",{className:"card",children:[l.jsxs("div",{className:"oc-card-head",style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[l.jsx("h3",{children:"Mi caja (hoy)"}),(O==null?void 0:O.estado)==="abierta"&&l.jsxs("div",{style:{display:"flex",gap:8},children:[l.jsx("span",{className:"oc-tag oc-tag-success",children:"Abierta"}),l.jsx("button",{className:"oc-small-btn oc-danger",onClick:()=>$e(O.id),children:"Cerrar caja"})]})]}),x?l.jsx("div",{className:"oc-muted",children:"Cargando"}):O?l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"oc-stats-row",style:{marginBottom:12},children:[l.jsxs("div",{className:"stat-card",children:[l.jsx("span",{className:"stat-label",children:"Base actual"}),l.jsxs("span",{className:"stat-value",children:["$",Lr(O.baseActual)]})]}),l.jsxs("div",{className:"stat-card",children:[l.jsx("span",{className:"stat-label",children:"Saldo actual"}),l.jsxs("span",{className:"stat-value",style:{color:O.saldoActual<0?"#b91c1c":void 0},children:["$",Lr(O.saldoActual)]})]})]}),l.jsxs("div",{className:"card",style:{marginBottom:12},children:[l.jsx("h4",{style:{marginBottom:8},children:"Cobro rpido"}),l.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr auto",gap:8},children:[l.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:6},children:[l.jsx("label",{className:"oc-muted",children:"Paciente"}),l.jsx("input",{className:"oc-input",placeholder:"Buscar nombre o documento",value:w,onChange:M=>P(M.target.value)}),w&&D.length>0&&l.jsx("div",{className:"oc-dropdown",children:D.slice(0,6).map(M=>l.jsx("button",{className:`oc-menu-item ${(k==null?void 0:k.id)===M.id?"active":""}`,onClick:()=>{K(M),P(M.nombre||M.name||M.doc||"")},type:"button",children:(M.nombre||M.name||"Paciente")+(M.doc?`  ${M.doc}`:"")},M.id))})]}),l.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:6},children:[l.jsx("label",{className:"oc-muted",children:"Monto (COP)"}),l.jsx("input",{className:"oc-input",type:"number",min:"0",step:"1000",placeholder:"0",value:Ge,onChange:M=>$t(M.target.value)})]}),l.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:6},children:[l.jsx("label",{className:"oc-muted",children:"Medio"}),l.jsxs("select",{className:"oc-input",value:hn,onChange:M=>ee(M.target.value),children:[l.jsx("option",{value:"efectivo",children:"Efectivo"}),l.jsx("option",{value:"tarjeta",children:"Tarjeta"}),l.jsx("option",{value:"transferencia",children:"Transferencia"}),l.jsx("option",{value:"link",children:"Link (en lnea)"})]})]}),l.jsx("div",{style:{display:"flex",alignItems:"end",gap:6},children:hn==="link"?l.jsx("button",{className:"oc-btn",onClick:se,disabled:he,children:he?"Creando":"Generar link"}):l.jsx("button",{className:"oc-btn",onClick:H,disabled:he,children:he?"Guardando":"Registrar pago"})})]}),l.jsxs("p",{className:"oc-muted",style:{marginTop:8},children:["Para link, el saldo se actualiza cuando el pago pase a ",l.jsx("b",{children:"aprobado"})," (webhook)."]})]}),l.jsxs("div",{className:"card",style:{marginBottom:12},children:[l.jsx("h4",{style:{marginBottom:8},children:"Movimiento manual"}),l.jsxs("form",{onSubmit:tt,style:{display:"grid",gridTemplateColumns:"120px 1fr 180px auto",gap:8},children:[l.jsxs("select",{className:"oc-input",value:ke,onChange:M=>Ye(M.target.value),children:[l.jsx("option",{value:"ingreso",children:"Ingreso"}),l.jsx("option",{value:"egreso",children:"Egreso"})]}),l.jsx("input",{className:"oc-input",placeholder:"Concepto (ej. Caja chica, Arriendo, etc.)",value:jt,onChange:M=>U(M.target.value)}),l.jsx("input",{className:"oc-input",type:"number",min:"0",step:"1000",placeholder:"0",value:ne,onChange:M=>ce(M.target.value)}),l.jsx("button",{className:"oc-btn",disabled:Te,children:Te?"Guardando":"Agregar"})]})]}),l.jsxs("div",{className:"card",children:[l.jsx("h4",{style:{marginBottom:8},children:"Movimientos y pagos (hoy)"}),l.jsx("div",{className:"oc-table-wrap",style:{marginBottom:12},children:l.jsxs("table",{className:"oc-table",children:[l.jsx("thead",{className:"oc-thead",children:l.jsxs("tr",{className:"oc-tr",children:[l.jsx(Ht,{children:"Tipo"}),l.jsx(Ht,{children:"Concepto / Paciente"}),l.jsx(Ht,{children:"Medio"}),l.jsx(Ht,{children:"Estado"}),l.jsx(Ht,{align:"right",children:"Valor"}),l.jsx(Ht,{children:"Hora"})]})}),l.jsx("tbody",{className:"oc-tbody",children:je.length===0&&it.length===0?l.jsx("tr",{className:"oc-tr",children:l.jsx("td",{className:"oc-td",colSpan:6,children:l.jsx("span",{className:"oc-muted",children:"Sin movimientos ni pagos an."})})}):l.jsxs(l.Fragment,{children:[it.map(M=>{var Y,J;return l.jsxs("tr",{className:"oc-tr",children:[l.jsx("td",{className:"oc-td",children:"Pago"}),l.jsxs("td",{className:"oc-td",children:[M.patientName||"Paciente"," ",M.linkUrl?l.jsx("a",{href:M.linkUrl,target:"_blank",rel:"noreferrer",children:"(link)"}):null]}),l.jsx("td",{className:"oc-td",children:M.medio}),l.jsx("td",{className:"oc-td",children:l.jsx("span",{className:`oc-tag ${M.estado==="aprobado"?"oc-tag-success":M.estado==="pending"?"oc-tag-warning":"oc-tag-danger"}`,children:M.estado})}),l.jsxs("td",{className:"oc-td",style:{textAlign:"right"},children:["$",Lr(M.valor)]}),l.jsx("td",{className:"oc-td",children:(J=(Y=M.fecha)==null?void 0:Y.toDate)!=null&&J.call(Y)?M.fecha.toDate().toLocaleTimeString("es-CO"):""})]},`pay-${M.id}`)}),je.map(M=>{var Y,J;return l.jsxs("tr",{className:"oc-tr",children:[l.jsx("td",{className:"oc-td",children:M.tipo}),l.jsx("td",{className:"oc-td",children:M.concepto}),l.jsx("td",{className:"oc-td",children:""}),l.jsx("td",{className:"oc-td",children:l.jsx("span",{className:"oc-tag",children:(M.tipo==="ingreso","ok")})}),l.jsxs("td",{className:"oc-td",style:{textAlign:"right"},children:["$",Lr(M.valor)]}),l.jsx("td",{className:"oc-td",children:(J=(Y=M.fecha)==null?void 0:Y.toDate)!=null&&J.call(Y)?M.fecha.toDate().toLocaleTimeString("es-CO"):""})]},`mov-${M.id}`)})]})})]})}),l.jsx("p",{className:"oc-muted",children:"Sugerencia: crea ndice compuesto para `movimientos(cashId, dia, fecha)` y `payments(cashId, dia, fecha)` para rendimiento."})]})]}):l.jsxs("div",{className:"oc-empty",children:[l.jsx("p",{className:"oc-muted",children:"No tienes una caja abierta hoy."}),l.jsx("button",{className:"oc-btn",onClick:()=>r("abrir"),children:"Abrir caja"})]})]}),Me=()=>l.jsxs("div",{className:"card",children:[l.jsx("div",{className:"oc-card-head",style:{marginBottom:8},children:l.jsxs("h3",{children:["Cajas cerradas ",l.jsx("span",{className:"oc-tag",children:T.length})]})}),l.jsx("div",{className:"oc-table-wrap",children:l.jsxs("table",{className:"oc-table",children:[l.jsx("thead",{className:"oc-thead",children:l.jsxs("tr",{className:"oc-tr",children:[l.jsx(Ht,{children:"Caja"}),l.jsx(Ht,{children:"Usuario"}),l.jsx(Ht,{children:"Apertura"}),l.jsx(Ht,{children:"Cierre"}),l.jsx(Ht,{align:"right",children:"Saldo final"})]})}),l.jsx("tbody",{className:"oc-tbody",children:v?l.jsx(Tx,{cols:5}):T.length===0?l.jsx("tr",{className:"oc-tr",children:l.jsx("td",{className:"oc-td",colSpan:5,children:l.jsx("span",{className:"oc-muted",children:"Sin cajas cerradas."})})}):T.map(M=>l.jsxs("tr",{className:"oc-tr",children:[l.jsx("td",{className:"oc-td",children:M.nombre}),l.jsx("td",{className:"oc-td",children:M.usuarioNombre}),l.jsx("td",{className:"oc-td",children:M.fechaApertura?M.fechaApertura.toLocaleString("es-CO"):""}),l.jsx("td",{className:"oc-td",children:M.fechaCierre?M.fechaCierre.toLocaleString("es-CO"):""}),l.jsxs("td",{className:"oc-td",style:{textAlign:"right"},children:["$",Lr(M.saldoActual)]})]},M.id))})]})})]}),Se=()=>l.jsxs("div",{className:"card",children:[l.jsx("h3",{children:"Cierres simulados"}),l.jsx("p",{className:"oc-muted",children:"El cierre hipottico compara ventas y movimientos detectando errores y descuadres con IA. (Conectar fuente de datos para activarlo)."})]}),Le=()=>l.jsxs("div",{className:"card",children:[l.jsx("h3",{children:"Bancos"}),l.jsx("p",{className:"oc-muted",children:"Conciliacin de consignaciones/pagos electrnicos contra caja del da. (Conectar pasarela o extractos para habilitar)."})]}),Ae=({m:M})=>l.jsxs("button",{type:"button",onClick:()=>r(M.key),className:`oc-menu-item ${n===M.key?"active":""}`,style:{width:"100%",textAlign:"left",padding:"10px 12px",borderRadius:10,border:"1px solid transparent",background:n===M.key?"var(--oc-surface-2, #f3f6ff)":"transparent",fontWeight:600},title:M.label,children:[l.jsx("span",{style:{opacity:.8,marginRight:6},children:M.icon}),M.label]});return l.jsxs("div",{className:"oc-main-content",style:{display:"grid",gridTemplateColumns:"240px 1fr",gap:16},children:[l.jsx("aside",{className:"card",role:"navigation","aria-label":"Men de caja",style:{height:"fit-content",padding:12},children:l.jsx("div",{style:{display:"flex",flexDirection:"column",gap:8},children:e.map(M=>l.jsx(Ae,{m:M},M.key))})}),l.jsxs("section",{children:[l.jsx("div",{className:"card",style:{marginBottom:12,padding:12},children:l.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",gap:12},children:[l.jsxs("div",{className:"oc-breadcrumb",children:[l.jsx("span",{children:"Caja"}),l.jsx("span",{children:""}),l.jsx("b",{children:(Ie=e.find(M=>M.key===n))==null?void 0:Ie.label})]}),n==="abiertas"&&l.jsx("input",{ref:c,className:"oc-input",placeholder:"Buscar...",value:o,onChange:M=>a(M.target.value),style:{maxWidth:300}})]})}),n==="abrir"&&l.jsx(ie,{}),n==="abiertas"&&l.jsx(ye,{}),n==="cerradas"&&l.jsx(Me,{}),n==="mio"&&l.jsx(ve,{}),n==="simulados"&&l.jsx(Se,{}),n==="bancos"&&l.jsx(Le,{})]})]})}function Tx({cols:t=6,n:e=3}){return l.jsx(l.Fragment,{children:Array.from({length:e}).map((n,r)=>l.jsx("tr",{className:"oc-tr",children:Array.from({length:t}).map((s,i)=>l.jsx("td",{className:"oc-td",children:l.jsx("div",{style:{height:12,width:i===0?160:100+i%3*40,background:"var(--oc-skeleton, #e5e7eb)",borderRadius:6}})},i))},r))})}function b6({items:t=[]}){return l.jsxs("div",{className:"card activity-card",children:[l.jsx("h4",{children:"Actividad reciente"}),l.jsx("ul",{className:"activity-list",children:t.map(e=>l.jsxs("li",{children:[l.jsx("strong",{children:e.title}),l.jsx("div",{className:"time",children:e.time})]},e.id))})]})}function S6({status:t}){return t?l.jsxs("div",{className:"card",children:[l.jsx("h4",{children:"Automatizaciones (N8N)"}),l.jsxs("div",{className:"n8n-line",children:[l.jsx("strong",{children:"Conectado:"})," ",t.connected?"S":"No"]}),l.jsxs("div",{className:"n8n-line",children:[l.jsx("strong",{children:"Flujos activos:"})," ",t.flowsRunning]}),t.lastError&&l.jsxs("div",{className:"n8n-error",children:["Error: ",t.lastError]})]}):null}const Wp={es:{nav_home:"Inicio",nav_agenda:"Agenda",nav_patients:"Pacientes",nav_billing:"Facturacin",nav_inventory:"Inventario",nav_odontogram:"Odontograma",nav_reports:"Reportes",nav_cash:"Caja",nav_admin:"Administracin",welcomeTitle:"Bienvenido a OdontoCloud",welcomeSubtitle:"Administra tus pacientes, agenda, inventario y facturacin de manera inteligente y moderna.",clinicLabel:"Clnica",userLabel:"Usuario",roleLabel:"Rol",searchPlaceholder:"Buscar acciones o ir a",stats_patientsToday:"Pacientes totales",stats_appointmentsToday:"Citas hoy",stats_revenueToday:"Facturacin hoy",stats_waiting:"En espera",stats_currency:"COP",n8n_title:"Automatizaciones (n8n)",recent_title:"Actividad reciente",recent_empty:"Sin actividad registrada.",loading:"Cargando...",logout:"Cerrar sesin",module_coming:"Mdulo prximamente.",todays_appts:"Citas de hoy",see_schedule:"Ir a Agenda",no_appts_today:"No hay citas programadas hoy.",at:"a las"},en:{nav_home:"Overview",nav_agenda:"Schedule",nav_patients:"Patients",nav_billing:"Billing",nav_inventory:"Inventory",nav_odontogram:"Odontogram",nav_reports:"Reports",nav_cash:"Cash",nav_admin:"Administration",welcomeTitle:"Welcome to OdontoCloud",welcomeSubtitle:"Manage your patients, schedule, inventory and billing in a smart and modern way.",clinicLabel:"Clinic",userLabel:"User",roleLabel:"Role",searchPlaceholder:"Search actions or go to",stats_patientsToday:"Total patients",stats_appointmentsToday:"Appointments today",stats_revenueToday:"Revenue today",stats_waiting:"In waiting room",stats_currency:"COP",n8n_title:"Automations (n8n)",recent_title:"Recent activity",recent_empty:"No activity yet.",loading:"Loading...",logout:"Log out",module_coming:"Module coming soon.",todays_appts:"Today's appointments",see_schedule:"Open Schedule",no_appts_today:"No appointments today.",at:"at"}},e1=()=>typeof navigator>"u"||(navigator.language||navigator.userLanguage||"es").toLowerCase().startsWith("es")?"es":"en",C6=()=>{try{const t=JSON.parse(localStorage.getItem("odc_session"));return t&&Date.now()-t.timestamp<1e3*60*60*24?t:null}catch{return null}},A6=()=>A.useMemo(()=>{const t=new Date,e=new Date(t.getFullYear(),t.getMonth(),t.getDate(),0,0,0,0),n=new Date(t.getFullYear(),t.getMonth(),t.getDate()+1,0,0,0,0);return{startToday:ze.fromDate(e),endToday:ze.fromDate(n),startTodayJS:e}},[]),R6=t=>`${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,"0")}-${String(t.getDate()).padStart(2,"0")}`,N6=(t,e)=>t.toLocaleTimeString(e==="es"?"es-CO":"en-US",{hour:"2-digit",minute:"2-digit"}),P6=(t,e)=>{try{const[n,r,s]=(t||"").split("-").map(a=>parseInt(a,10)),[i=0,o=0]=(e||"00:00").split(":").map(a=>parseInt(a,10));return new Date(n,(r||1)-1,s||1,i,o,0,0)}catch{return new Date}};function k6({data:t=[]}){const s=Math.max(1,...t.map(d=>Number(d.value)||0)),i=t.length||7,o=10,a=Math.max(16,Math.min(44,(640-o*(i+1))/i)),c=(a+o)*i+o;return l.jsx("div",{style:{width:"100%",overflowX:"auto"},children:l.jsxs("svg",{width:c,height:240,role:"img","aria-label":"Pacientes registrados por da en la ltima semana",children:[[.25,.5,.75,1].map((d,h)=>{const f=18+(1-d)*182;return l.jsx("line",{x1:0,x2:c,y1:f,y2:f,stroke:"#e5e7eb",strokeDasharray:"4 4"},h)}),t.map((d,h)=>{const f=Number(d.value)||0,m=Math.round(f/s*182),_=o+h*(a+o),R=200-m;return l.jsxs("g",{children:[l.jsx("rect",{x:_,y:R,width:a,height:m,rx:"6",ry:"6",fill:f>0?"#0ea5e9":"#cbd5e1",children:l.jsx("title",{children:`${d.label||d.shortLabel||""}  ${f} paciente${f!==1?"s":""}`})}),f>0&&m>14&&l.jsx("text",{x:_+a/2,y:R-6,textAnchor:"middle",fontSize:"11",fill:"#0f172a",children:f}),l.jsx("text",{x:_+a/2,y:214,textAnchor:"middle",fontSize:"11",fill:"#64748b",children:d.shortLabel||""})]},h)})]})})}function D6({onNavigate:t,onAction:e,placeholder:n}){const[r,s]=A.useState(""),[i,o]=A.useState(!1),[a,c]=A.useState(0),d=A.useRef(null),h=A.useMemo(()=>[{group:"Navegacin",label:"Ir a Inicio",keywords:"inicio home overview",run:()=>t==null?void 0:t("Inicio")},{group:"Navegacin",label:"Ir a Agenda",keywords:"agenda calendario schedule",run:()=>t==null?void 0:t("Agenda")},{group:"Navegacin",label:"Ir a Pacientes",keywords:"pacientes",run:()=>t==null?void 0:t("Pacientes")},{group:"Navegacin",label:"Ir a Facturacin",keywords:"facturacion facturas billing",run:()=>t==null?void 0:t("Facturacin")},{group:"Navegacin",label:"Ir a Inventario",keywords:"inventario stock",run:()=>t==null?void 0:t("Inventario")},{group:"Navegacin",label:"Ir a Odontograma",keywords:"odontograma",run:()=>t==null?void 0:t("Odontograma")},{group:"Navegacin",label:"Ir a Reportes",keywords:"reportes informes",run:()=>t==null?void 0:t("Reportes")},{group:"Acciones",label:"Nueva cita",keywords:"nueva cita agendar",run:()=>e==null?void 0:e("new_appointment")},{group:"Acciones",label:"Nuevo paciente",keywords:"nuevo paciente alta",run:()=>e==null?void 0:e("new_patient")},{group:"Acciones",label:"Nueva factura",keywords:"nueva factura",run:()=>e==null?void 0:e("new_invoice")},{group:"Acciones",label:"Exportar agenda",keywords:"exportar agenda",run:()=>e==null?void 0:e("export_agenda")},{group:"Acciones",label:"Ir a hoy (Agenda)",keywords:"hoy today",run:()=>e==null?void 0:e("agenda_today")},{group:"Acciones",label:"Cambiar modo oscuro",keywords:"oscuro dark mode",run:()=>e==null?void 0:e("toggle_dark")},{group:"Acciones",label:"Cerrar sesin",keywords:"logout salir cerrar",run:()=>e==null?void 0:e("logout")},{group:"Ayuda",label:"Ver atajos de teclado",keywords:"atajos ayuda",run:()=>e==null?void 0:e("show_shortcuts")},{group:"Ayuda",label:"Soporte / Contacto",keywords:"soporte ayuda contacto",run:()=>e==null?void 0:e("support")}],[t,e]),f=A.useMemo(()=>{const C=r.toLowerCase().trim();return C?h.filter(N=>N.label.toLowerCase().includes(C)||N.keywords.includes(C)):[]},[r,h]);A.useEffect(()=>{const C=N=>{d.current&&(d.current.contains(N.target)||o(!1))};return document.addEventListener("mousedown",C),()=>document.removeEventListener("mousedown",C)},[]);const m=C=>{var N;(N=C.run)==null||N.call(C),s(""),o(!1)},_=C=>{!i||f.length===0||(C.key==="ArrowDown"&&(C.preventDefault(),c(N=>(N+1)%f.length)),C.key==="ArrowUp"&&(C.preventDefault(),c(N=>(N-1+f.length)%f.length)),C.key==="Enter"&&(C.preventDefault(),f[a]&&m(f[a])),C.key==="Escape"&&o(!1))},R=A.useMemo(()=>{const C=new Map;return f.forEach(N=>{C.has(N.group)||C.set(N.group,[]),C.get(N.group).push(N)}),Array.from(C.entries())},[f]);return l.jsxs("div",{className:"oc-search-wrap",ref:d,children:[l.jsx("input",{className:"oc-search",type:"search",inputMode:"search",placeholder:n,"aria-label":n,value:r,onChange:C=>{s(C.target.value),o(!!C.target.value),c(0)},onFocus:()=>o(!!r),onKeyDown:_}),i&&l.jsx("div",{className:"oc-search-dropdown",role:"listbox","aria-label":"Resultados de comandos",children:R.length===0?l.jsx("div",{className:"oc-search-item empty",children:"Escribe para ver opciones"}):R.map(([C,N])=>l.jsxs("div",{children:[l.jsx("div",{className:"oc-search-group",children:C}),N.map(T=>{const y=f.indexOf(T);return l.jsx("button",{className:`oc-search-item ${y===a?"active":""}`,onMouseEnter:()=>c(y),onClick:()=>m(T),role:"option",children:l.jsx("span",{className:"oc-search-title",children:T.label})},T.label)})]},C))})]})}function j6({open:t,anchorRect:e,onClose:n,onSoon:r,onNavigatePath:s,onSetFactView:i,dark:o}){const[a,c]=A.useState(null),d=A.useRef(null);if(A.useEffect(()=>{if(!t)return;const K=$t=>$t.key==="Escape"&&(n==null?void 0:n()),Ge=()=>n==null?void 0:n();return window.addEventListener("keydown",K),window.addEventListener("scroll",Ge,!0),()=>{window.removeEventListener("keydown",K),window.removeEventListener("scroll",Ge,!0)}},[t,n]),!t)return null;const h=((e==null?void 0:e.bottom)||60)+8,f=Math.max(12,Math.min(((e==null?void 0:e.left)||300)-160,window.innerWidth-920)),m=10,_=f+360+m,R=o?"#0b1220":"#ffffff",C=o?"#e5e7eb":"#0f172a",N=o?"#0f1a32":"#f3f6ff",T=o?"#1f2a44":"#e2e8f0",y=o?"#b6c1d1":"#475569",v={position:"fixed",top:h,left:f,width:880,maxWidth:"calc(100vw - 24px)",background:R,color:C,borderRadius:14,boxShadow:"0 18px 40px rgba(2,6,23,.18)",border:`1px solid ${T}`,zIndex:400,padding:12},E={position:"fixed",top:h,left:_,width:420,maxWidth:"calc(100vw - 24px)",background:R,color:C,borderRadius:14,boxShadow:"0 18px 40px rgba(2,6,23,.18)",border:`1px solid ${T}`,zIndex:410,padding:12},O={display:"flex",flexDirection:"column",gap:6,padding:"8px 10px"},F={height:38,borderRadius:10,padding:"0 12px",display:"flex",alignItems:"center",gap:8,fontSize:".92rem",cursor:"pointer",border:"1px solid transparent",background:"transparent",color:C,fontWeight:500,textAlign:"left"},x=(K,Ge=!0)=>Object.assign(K.currentTarget.style,Ge?{background:N,borderColor:T}:{background:"transparent",borderColor:"transparent"}),I=()=>{d.current&&clearTimeout(d.current)},w=()=>{I(),d.current=setTimeout(()=>n==null?void 0:n(),180)},P={position:"fixed",top:h,left:f+360,width:m,height:520,zIndex:405},D=[{label:"Recibo de caja",key:"recibo",path:"facturacion/recibo"},{label:"Saldo a favor",key:"saldo",path:"facturacion/saldo"},{label:"Nota crdito",key:"nc",path:"facturacion/nc"},{label:"Nota dbito",key:"nd",path:"facturacion/nd"},{label:"Liquidaciones",key:"liq",path:"facturacion/liq"},{label:"Traslados",key:"tras",path:"facturacion/tras"},{label:"Pagos",key:"pagos",path:"facturacion/pagos"},{label:"rdenes de compra",key:"oc",path:"facturacion/oc"},{label:"Factura de venta",key:"fv",path:"facturacion/facturas"},{label:"Facturas de compra",key:"fc",path:"facturacion/fc"}],j=[{label:"RIPS anteriores (RS-3374)",key:"rips3374"},{label:"RIPS nuevo (RS-2275)",key:"rips2275"}],k=K=>{i==null||i(K.key),s==null||s(K.path),n==null||n()};return l.jsxs(l.Fragment,{children:[l.jsx("div",{onClick:n,style:{position:"fixed",inset:0,background:"transparent",zIndex:399}}),l.jsx("div",{style:v,onMouseEnter:I,onMouseLeave:w,children:l.jsxs("div",{style:{display:"grid",gridTemplateColumns:"360px 1fr",gap:8,alignItems:"start"},children:[l.jsxs("div",{style:O,children:[l.jsx("button",{type:"button",style:F,onMouseEnter:()=>{I(),c("facturacion")},onFocus:()=>{I(),c("facturacion")},onClick:()=>c(K=>K==="facturacion"?null:"facturacion"),onMouseOver:K=>x(K,!0),onMouseOut:K=>x(K,!1),children:" Facturacin "}),l.jsx("button",{type:"button",style:F,onMouseEnter:()=>{I(),c("rips")},onFocus:()=>{I(),c("rips")},onClick:()=>c(K=>K==="rips"?null:"rips"),onMouseOver:K=>x(K,!0),onMouseOut:K=>x(K,!1),children:" RIPS "}),l.jsx("button",{type:"button",style:F,onClick:()=>s==null?void 0:s("agenda"),onMouseOver:K=>x(K,!0),onMouseOut:K=>x(K,!1),children:" Gestin de agenda"}),l.jsx("button",{type:"button",style:F,onClick:()=>s==null?void 0:s("inventario"),onMouseOver:K=>x(K,!0),onMouseOut:K=>x(K,!1),children:" Inventario"}),l.jsx("button",{type:"button",style:F,onClick:()=>r==null?void 0:r(),onMouseOver:K=>x(K,!0),onMouseOut:K=>x(K,!1),children:" Convenios"}),l.jsx("button",{type:"button",style:F,onClick:()=>r==null?void 0:r(),onMouseOver:K=>x(K,!0),onMouseOut:K=>x(K,!1),children:" Terceros"}),l.jsx("button",{type:"button",style:F,onClick:()=>r==null?void 0:r(),onMouseOver:K=>x(K,!0),onMouseOut:K=>x(K,!1),children:" Campaas"}),l.jsx("button",{type:"button",style:F,onClick:()=>r==null?void 0:r(),onMouseOver:K=>x(K,!0),onMouseOut:K=>x(K,!1),children:" Temperatura y humedad"}),l.jsx("button",{type:"button",style:F,onClick:()=>r==null?void 0:r(),onMouseOver:K=>x(K,!0),onMouseOut:K=>x(K,!1),children:" Residuos"}),l.jsx("button",{type:"button",style:F,onClick:()=>r==null?void 0:r(),onMouseOver:K=>x(K,!0),onMouseOut:K=>x(K,!1),children:" Medicamentos y planes"}),l.jsx("button",{type:"button",style:F,onClick:()=>r==null?void 0:r(),onMouseOver:K=>x(K,!0),onMouseOut:K=>x(K,!1),children:" Esterilizacin"})]}),l.jsx("div",{style:O,children:l.jsxs("div",{style:{fontSize:".85rem",color:y},children:["Accesos rpidos a mdulos de administracin. Pasa el mouse por ",l.jsx("b",{children:"Facturacin"})," o ",l.jsx("b",{children:"RIPS"})," para ver sus acciones."]})})]})}),l.jsx("div",{style:P,onMouseEnter:I,onMouseLeave:w}),a&&l.jsx("div",{style:E,onMouseEnter:I,onMouseLeave:w,children:l.jsx("div",{style:{...O,display:"grid",gridTemplateColumns:"1fr"},children:(a==="facturacion"?D:j).map(K=>l.jsx("button",{type:"button",style:F,onClick:()=>a==="facturacion"?k(K):r==null?void 0:r(),onMouseOver:Ge=>x(Ge,!0),onMouseOut:Ge=>x(Ge,!1),children:K.label},K.label))})})]})}function O6({t,companyName:e,userName:n,role:r,darkMode:s,weeklySeries:i,weekRangeLabel:o,todaysAppointments:a,todaysLoading:c,metrics:d,metricsLoading:h,n8nState:f,n8nLoading:m,recent:_,recentLoading:R,onGoAgenda:C}){return l.jsxs("div",{className:"oc-main-content",children:[l.jsxs("section",{className:"oc-hero","aria-label":"Resumen general",children:[l.jsxs("div",{className:"oc-hero-text",children:[l.jsx("h1",{children:t("welcomeTitle")}),l.jsx("p",{children:t("welcomeSubtitle")}),l.jsxs("p",{className:"oc-hero-meta",children:[t("clinicLabel"),": ",e,"  ",t("userLabel"),": ",n,"  ",t("roleLabel"),": ",r||""]})]}),l.jsxs("div",{className:"oc-hero-badge","aria-live":"polite",children:[l.jsx("span",{className:"oc-hero-badge-title",children:t("stats_appointmentsToday")}),l.jsx("span",{className:"oc-hero-badge-value",children:h&&c?"":d.citasHoy}),l.jsxs("span",{className:"oc-hero-badge-sub",children:[t("stats_patientsToday"),": ",h?"":d.pacientesHoy]})]})]}),l.jsxs("section",{className:"oc-stats-row","aria-label":"Indicadores del da",children:[l.jsxs("div",{className:"stat-card",children:[l.jsx("span",{className:"stat-label",children:t("stats_patientsToday")}),l.jsx("span",{className:"stat-value",children:d.pacientesHoy})]}),l.jsxs("div",{className:"stat-card",children:[l.jsx("span",{className:"stat-label",children:t("stats_appointmentsToday")}),l.jsx("span",{className:"stat-value",children:d.citasHoy})]}),l.jsxs("div",{className:"stat-card",children:[l.jsx("span",{className:"stat-label",children:t("stats_revenueToday")}),l.jsxs("span",{className:"stat-value",children:[d.facturacionHoy.toLocaleString("es-CO")," ",l.jsx("span",{className:"stat-currency",children:t("stats_currency")})]})]}),l.jsxs("div",{className:"stat-card",children:[l.jsx("span",{className:"stat-label",children:t("stats_waiting")}),l.jsx("span",{className:"stat-value",children:d.enEspera})]})]}),l.jsxs("section",{className:"oc-grid","aria-label":"Contenido principal del dashboard",children:[l.jsx("div",{className:"oc-grid-main",children:l.jsxs("div",{className:"card card-quickcharts",children:[l.jsxs("div",{className:"oc-card-head",style:{display:"flex",justifyContent:"space-between",alignItems:"center",gap:8},children:[l.jsx("h3",{children:"Pacientes registrados  ltimos 7 das"}),l.jsx("span",{className:"oc-muted",style:{marginLeft:8,fontSize:12},children:o})]}),i.length===0||i.every(N=>((N==null?void 0:N.value)||0)===0)?l.jsx("p",{className:"oc-weekly-empty",children:"Sin pacientes registrados en la ltima semana."}):l.jsx(k6,{data:i})]})}),l.jsxs("aside",{className:"oc-grid-side","aria-label":"Panel lateral",children:[l.jsxs("div",{className:"card",children:[l.jsx("h3",{children:t("n8n_title")}),m?l.jsx("span",{className:"oc-muted",children:t("loading")}):l.jsx(S6,{status:f})]}),l.jsxs("div",{className:"card",children:[l.jsxs("div",{className:"oc-card-head",style:{display:"flex",justifyContent:"space-between",alignItems:"center",gap:8},children:[l.jsx("h3",{children:t("todays_appts")}),l.jsx("button",{className:"oc-small-link",type:"button",onClick:C,children:t("see_schedule")})]}),c?l.jsx("span",{className:"oc-muted",children:t("loading")}):a.length===0?l.jsx("p",{className:"oc-muted",children:t("no_appts_today")}):l.jsx("ul",{className:"oc-list",children:a.slice(0,5).map(N=>l.jsxs("li",{className:"oc-list-item",children:[l.jsxs("div",{className:"oc-list-main",children:[l.jsx("b",{children:N.pacienteNombre||"Paciente"})," ",l.jsxs("span",{className:"oc-muted",children:[t("at")," ",N6(N.fecha,e1())]})]}),l.jsx("div",{className:`oc-tag oc-tag-${(N.estado||"programada").toLowerCase().replace(/\s+/g,"-")}`,children:N.estado||"programada"})]},N.id))})]}),l.jsxs("div",{className:"card",children:[l.jsx("h3",{children:"Actividad reciente"}),R?l.jsx("span",{className:"oc-muted",children:t("loading")}):_.length===0?l.jsx("p",{className:"oc-muted",children:t("recent_empty")}):l.jsx(b6,{items:_})]})]})]}),l.jsxs("footer",{className:"oc-footer",children:[" ",new Date().getFullYear()," OdontoCloud | Creado por Ingeniero Juan Madrid"]})]})}function Gp(){const t=Es(),e=Dn(),[n]=A.useState(e1()),r=H=>Wp[n][H]||H,[s,i]=A.useState("Inicio"),[o,a]=A.useState("recibo"),[c,d]=A.useState(()=>{try{return localStorage.getItem("odontocloud:dark")==="1"}catch{return!1}});A.useEffect(()=>{try{localStorage.setItem("odontocloud:dark",c?"1":"0")}catch{}document.documentElement.classList.toggle("dark",c)},[c]);const[h]=A.useState(()=>C6()),[f]=A.useState((h==null?void 0:h.rol)||""),[m]=A.useState((h==null?void 0:h.email)||""),[_,R]=A.useState("OdontoCloud"),[C,N]=A.useState(m||"Usuario"),[T,y]=A.useState(!0);A.useEffect(()=>{const H=Vy(Ah,async se=>{try{if(!se){N(m||"Usuario"),R("OdontoCloud"),y(!1);return}N(se.displayName||se.email||m||"Usuario");const B=mt(ue,"empresas",se.uid),re=await za(B);R(re.exists()&&re.data().nombre||"OdontoCloud")}catch(B){console.error("Error cargando empresa/usuario:",B)}finally{y(!1)}});return()=>H()},[m]);const[v,E]=A.useState({pacientesHoy:0,citasHoy:0,facturacionHoy:0,enEspera:0}),[O,F]=A.useState(!0),[x,I]=A.useState([]),[w,P]=A.useState([]),[D,j]=A.useState(!0),{startToday:k,endToday:K,startTodayJS:Ge}=A6(),$t=A.useMemo(()=>R6(Ge),[Ge]),hn=A.useMemo(()=>{const H=new Date,se=new Date(H.getFullYear(),H.getMonth(),H.getDate()-6),B=H,re=ie=>ie.toLocaleDateString(n==="es"?"es-ES":"en-US",{weekday:"short",day:"2-digit",month:"short"}).replace(".","");return`${re(se)}  ${re(B)}`},[n]),ee=H=>{var ye;const se=H.data()||{};let B;if((ye=se.fecha)!=null&&ye.toDate){B=se.fecha.toDate();const ve=se.horaInicio||se.hora;if(ve&&typeof ve=="string"){const[Me=0,Se=0]=ve.split(":").map(Le=>parseInt(Le,10));B.setHours(Me||0,Se||0,0,0)}}else if(typeof se.fecha=="string"){const ve=se.horaInicio||se.hora||"00:00";B=P6(se.fecha,ve)}else B=new Date;const re=se.pacienteNombre||se.paciente||"Paciente",ie=se.estado&&String(se.estado)||"programada";return{id:H.id,fecha:B,pacienteId:se.pacienteId||"",pacienteNombre:re,estado:ie,motivo:se.motivo||""}};A.useEffect(()=>{const H=st(Pe(ue,"citas"),Xe("fecha",">=",k),Xe("fecha","<",K),gn("fecha","asc")),se=st(Pe(ue,"citas"),Xe("fecha","==",$t));let B=new Map,re=!1,ie=!1;const ye=()=>{const Se=Array.from(B.values()).sort((Ae,Ie)=>Ae.fecha.getTime()-Ie.fecha.getTime()),Le=Se.filter(Ae=>String(Ae.estado).toLowerCase().trim()==="en espera").length;P(Se),E(Ae=>({...Ae,citasHoy:Se.length,enEspera:Le})),re&&ie&&j(!1)},ve=Un(H,Se=>{re=!0;const Le=new Map(B);Se.docs.forEach(Ae=>Le.set(Ae.id,ee(Ae))),B=Le,ye()},Se=>{console.error("Realtime citas hoy (TS):",Se),re=!0,ye()}),Me=Un(se,Se=>{ie=!0;const Le=new Map(B);Se.docs.forEach(Ae=>Le.set(Ae.id,ee(Ae))),B=Le,ye()},Se=>{console.error("Realtime citas hoy (STR):",Se),ie=!0,ye()});return()=>{try{ve(),Me()}catch{}}},[k,K,$t]),A.useEffect(()=>{(async()=>{try{const B=(await qM(Pe(ue,"pacientes"))).data().count||0;let re=0;try{const ie=st(Pe(ue,"facturas"),Xe("fecha",">=",k),Xe("fecha","<",K));(await Vt(ie)).forEach(ve=>{const Me=ve.data();typeof Me.monto=="number"&&(re+=Me.monto)})}catch{re=0}E(ie=>({...ie,pacientesHoy:B,facturacionHoy:re}))}catch(se){console.error("Error cargando mtricas:",se),E(B=>({...B,pacientesHoy:0,facturacionHoy:0}))}finally{F(!1)}})()},[k,K]),A.useEffect(()=>{const H=new Date,se=new Date(H.getFullYear(),H.getMonth(),H.getDate()-6),B=new Date(H.getFullYear(),H.getMonth(),H.getDate()+1),re=new Map;for(let ve=0;ve<7;ve++){const Me=new Date(H.getFullYear(),H.getMonth(),H.getDate()-(6-ve)),Se=Me.toISOString().slice(0,10),Le=Me.toLocaleDateString(n==="es"?"es-ES":"en-US"),Ae=Me.toLocaleDateString(n==="es"?"es-ES":"en-US",{weekday:"short",day:"2-digit"}).replace(".","");re.set(Se,{label:Le,shortLabel:Ae,value:0})}const ie=st(Pe(ue,"pacientes"),Xe("createdAt",">=",ze.fromDate(se)),Xe("createdAt","<",ze.fromDate(B))),ye=Un(ie,ve=>{const Me=new Map(re);ve.docs.forEach(Se=>{var Y;const Le=Se.data()||{},Ae=(Y=Se.data().createdAt)!=null&&Y.toDate?Se.data().createdAt.toDate():Le.createdAt?new Date(Le.createdAt):null;if(!Ae||isNaN(Ae))return;const Ie=Ae.toISOString().slice(0,10);if(!Me.has(Ie))return;const M=Me.get(Ie);M.value+=1,Me.set(Ie,M)}),I(Array.from(Me.values()))},ve=>{console.error("Error realtime serie semanal (pacientes):",ve),I(Array.from(re.values()))});return()=>{try{ye()}catch{}}},[n]);const[he,me]=A.useState([]),[ke,Ye]=A.useState(!0);A.useEffect(()=>{(async()=>{try{const se=st(Pe(ue,"actividad"),gn("fecha","desc"),wa(5)),B=await Vt(se);me(B.docs.map(re=>({id:re.id,title:re.data().descripcion||re.data().titulo||"Actividad",time:re.data().resumenTiempo||""})))}catch(se){console.error("Error cargando actividad:",se),me([])}finally{Ye(!1)}})()},[]);const[jt,U]=A.useState(null),[ne,ce]=A.useState(!0);A.useEffect(()=>{(async()=>{try{const se=mt(ue,"integraciones","n8n"),B=await za(se);U(B.exists()?{connected:!!B.data().connected,flowsRunning:B.data().flowsRunning||0,lastError:B.data().lastError||null}:{connected:!1,flowsRunning:0,lastError:null})}catch(se){console.error("Error cargando estado n8n:",se),U({connected:!1,flowsRunning:0,lastError:"No se pudo leer el estado desde Firebase."})}finally{ce(!1)}})()},[]);const Te=async()=>{try{localStorage.removeItem("odc_session")}catch{}try{await Yj(Ah)}catch(H){console.error("Error al cerrar sesin:",H)}window.location.href="/"},[be,je]=A.useState(!1),[_e,it]=A.useState(null),Re=A.useRef(null);A.useRef(null);const le=()=>{var se,B;const H=(B=(se=Re.current)==null?void 0:se.getBoundingClientRect)==null?void 0:B.call(se);it(H),je(!0)};A.useEffect(()=>{const H=e.pathname.toLowerCase(),se=H.includes("/pacientes"),B=H.includes("/caja"),re=H.includes("/agenda"),ie=H.includes("/facturacion"),ye=H.includes("/inventario"),ve=H.includes("/odontograma"),Me=H.includes("/reportes"),Se=H.includes("/config");i(se?"Pacientes":B?"Caja":re?"Agenda":ye?"Inventario":ve?"Odontograma":Me?"Reportes":Se?"Config":"Inicio"),ie&&(i("Facturacin"),H.includes("/pagos")?a("pagos"):H.includes("/facturas")?a("fv"):H.includes("/recibo")?a("recibo"):H.includes("/saldo")?a("saldo"):H.includes("/nc")?a("nc"):H.includes("/nd")?a("nd"):H.includes("/liq")?a("liq"):H.includes("/tras")?a("tras"):H.includes("/oc")?a("oc"):H.includes("/fc")?a("fc"):a("recibo"))},[e.pathname]);const Oe=A.useMemo(()=>{const H=e.pathname.split("/").filter(Boolean),se=H.findIndex(B=>B.startsWith("dashboard_"));return se>=0?`/${H.slice(0,se+1).join("/")}`:""},[e.pathname]),$e=(H="")=>{const se=String(H).replace(/^\/+|\/+$/g,""),B=se?`${Oe}/${se}`:Oe||"/",re=e.pathname.toLowerCase()===B.toLowerCase();t(B,{replace:re})},tt=()=>{switch(s){case"Agenda":return l.jsx(VU,{});case"Pacientes":return l.jsx(A.Suspense,{fallback:l.jsx("div",{style:{padding:16},children:"Cargando"}),children:l.jsx(KU,{})});case"Facturacin":return l.jsx(MU,{view:o});case"Inventario":return l.jsx(FU,{});case"Odontograma":return l.jsx(UU,{});case"Reportes":return l.jsx(XU,{});case"Caja":return l.jsx(T6,{});case"Config":case"Config":return l.jsx(_6,{});case"Inicio":default:return null}};return l.jsxs("div",{className:`oc-shell ${c?"oc-dark":""}`,children:[l.jsx("a",{href:"#oc-main",className:"oc-skip-link",children:"Saltar al contenido"}),l.jsxs("header",{className:"oc-header",role:"banner",children:[l.jsxs("div",{className:"oc-header-left",children:[l.jsx("img",{src:PA,alt:"OdontoCloud",className:"oc-logo"}),l.jsxs("div",{className:"oc-brand-text",children:[l.jsx("span",{className:"oc-brand-main",children:"OdontoCloud"}),l.jsx("span",{className:"oc-brand-sub",children:T?"...":_})]})]}),l.jsxs("nav",{className:"oc-nav",role:"navigation","aria-label":"Navegacin principal",children:[l.jsx(Ho,{to:Oe,end:!0,className:({isActive:H})=>H&&s==="Inicio"?"oc-nav-btn active":"oc-nav-btn",title:r("nav_home"),children:r("nav_home")}),l.jsx(Ho,{to:`${Oe}/agenda`,className:({isActive:H})=>H||s==="Agenda"?"oc-nav-btn active":"oc-nav-btn",title:r("nav_agenda"),children:r("nav_agenda")}),l.jsx(Ho,{to:`${Oe}/pacientes`,className:({isActive:H})=>H||s==="Pacientes"?"oc-nav-btn active":"oc-nav-btn",title:r("nav_patients"),children:r("nav_patients")}),l.jsx(Ho,{to:`${Oe}/caja`,className:({isActive:H})=>H||s==="Caja"?"oc-nav-btn active":"oc-nav-btn",title:r("nav_cash"),children:r("nav_cash")}),l.jsx("button",{type:"button",ref:Re,className:"oc-nav-btn",title:r("nav_admin"),"aria-haspopup":"true","aria-expanded":be,onClick:()=>be?je(!1):le(),onMouseEnter:()=>le(),onFocus:()=>le(),children:r("nav_admin")}),l.jsx(Ho,{to:`${Oe}/reportes`,className:({isActive:H})=>H||s==="Reportes"?"oc-nav-btn active":"oc-nav-btn",title:r("nav_reports"),children:r("nav_reports")})]}),l.jsxs("div",{className:"oc-header-right",children:[l.jsx(D6,{placeholder:r("searchPlaceholder"),onNavigate:H=>{H==="Inicio"?$e(""):H==="Facturacin"?(a("recibo"),$e("facturacion/recibo")):$e(H.toLowerCase())},onAction:H=>{switch(H){case"new_appointment":case"agenda_today":case"export_agenda":$e("agenda");break;case"new_patient":$e("pacientes");break;case"new_invoice":a("fv"),$e("facturacion/facturas");break;case"toggle_dark":d(se=>!se);break;case"logout":Te();break;case"show_shortcuts":alert("Atajos: Ctrl/Cmd + K para abrir bsqueda, / para moverse, Enter para ejecutar.");break;case"support":window.open("https://tu-soporte.odc","_blank");break}}}),l.jsx(JU,{basePath:Oe,className:"ml-2"}),l.jsx("button",{className:"oc-icon-btn",type:"button",onClick:()=>d(H=>!H),"aria-pressed":c,title:c?"Activar modo claro":"Activar modo oscuro",children:c?"":""}),l.jsx("button",{className:"oc-icon-btn",type:"button",onClick:Te,title:Wp[n].logout,children:Wp[n].logout})]})]}),l.jsx(j6,{open:be,anchorRect:_e,dark:c,onClose:()=>je(!1),onSoon:()=>{alert("Prximamente"),je(!1)},onNavigatePath:H=>{$e(H),je(!1)},onSetFactView:H=>a(H)}),l.jsxs("main",{id:"oc-main",className:"oc-main-wrapper",role:"main",children:[s!=="Inicio"&&tt(),s==="Inicio"&&l.jsx(O6,{t:r,companyName:_,userName:C,role:f,darkMode:c,weeklySeries:x,weekRangeLabel:hn,todaysAppointments:w,todaysLoading:D,metrics:v,metricsLoading:O,n8nState:jt,n8nLoading:ne,recent:he,recentLoading:ke,onGoAgenda:()=>$e("agenda")})]})]})}const t1=()=>{try{const t=JSON.parse(localStorage.getItem("odc_session"));return t&&Date.now()-t.timestamp<1e3*60*60*24?t:null}catch{return null}},n1=t=>{const e=(t||"").toLowerCase();return e==="administrador"?"/dashboard_admin":e==="doctor"?"/dashboard_doctor":e==="recepcionista"?"/dashboard_recepcion":"/"};function Kp({allowedRoles:t,children:e}){var s;const n=t1();if(!n)return l.jsx(Jd,{to:"/",replace:!0});const r=(s=n.rol)==null?void 0:s.toLowerCase();return t.map(i=>i.toLowerCase()).includes(r)?e:l.jsx(Jd,{to:n1(n.rol),replace:!0})}function L6(){const t=t1();return l.jsxs(LP,{children:[l.jsx(qo,{path:"/",element:t?l.jsx(Jd,{to:n1(t.rol),replace:!0}):l.jsx(h4,{})}),l.jsx(qo,{path:"/dashboard_admin/*",element:l.jsx(Kp,{allowedRoles:["administrador"],children:l.jsx(Gp,{})})}),l.jsx(qo,{path:"/dashboard_doctor/*",element:l.jsx(Kp,{allowedRoles:["doctor"],children:l.jsx(Gp,{})})}),l.jsx(qo,{path:"/dashboard_recepcion/*",element:l.jsx(Kp,{allowedRoles:["recepcionista"],children:l.jsx(Gp,{})})}),l.jsx(qo,{path:"*",element:l.jsx(Jd,{to:"/",replace:!0})})]})}async function V6(){try{await Gj(Ah,G0),await AM(ue),console.log(" Firebase listo con sesin persistente y modo offline.")}catch(t){console.warn(" Firebase offline/persistencia fall:",t.message)}}function M6(t={}){const{immediate:e=!1,onNeedRefresh:n,onOfflineReady:r,onRegistered:s,onRegisteredSW:i,onRegisterError:o}=t;let a,c;const d=async(f=!0)=>{await c};async function h(){if("serviceWorker"in navigator){if(a=await ZA(async()=>{const{Workbox:f}=await import("./workbox-window.prod.es5-vqzQaGvo.js");return{Workbox:f}},[]).then(({Workbox:f})=>new f("/odontocloud-react/sw.js",{scope:"/odontocloud-react/",type:"classic"})).catch(f=>{o==null||o(f)}),!a)return;a.addEventListener("activated",f=>{(f.isUpdate||f.isExternal)&&window.location.reload()}),a.addEventListener("installed",f=>{f.isUpdate||r==null||r()}),a.register({immediate:e}).then(f=>{i?i("/odontocloud-react/sw.js",f):s==null||s(f)}).catch(f=>{o==null||o(f)})}}return c=h(),d}const F6="empresa_logo_url",bx="empresa_nombre",U6=A.createContext(null);function $6({children:t}){const[e,n]=A.useState(""),[r,s]=A.useState("OdontoCloud"),[i,o]=A.useState(!0);A.useEffect(()=>{var f;let d="";try{d=localStorage.getItem(F6)||""}catch{}d||(d="/assets/logo.png"),n(d);let h="OdontoCloud";try{h=localStorage.getItem(bx)||((f=document.querySelector('meta[name="company-name"]'))==null?void 0:f.getAttribute("content"))||"OdontoCloud"}catch{}s(h),o(!1)},[]);const c={logoUrl:e,clinicName:r,loading:i,setLogoUrl:n,setClinicName:d=>{const h=d||"OdontoCloud";try{localStorage.setItem(bx,h)}catch{}let f=document.querySelector('meta[name="company-name"]');f||(f=document.createElement("meta"),f.setAttribute("name","company-name"),document.head.appendChild(f)),f.setAttribute("content",h),s(h)}};return l.jsx(U6.Provider,{value:c,children:t})}const B6="/odontocloud-react/";V6();M6({immediate:!0});$b(document.getElementById("root")).render(l.jsx(Mx.StrictMode,{children:l.jsx($6,{children:l.jsx(ik,{basename:B6,children:l.jsx(L6,{})})})}));
