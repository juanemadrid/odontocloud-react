(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();function Yb(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var iT={exports:{}},rh={},sT={exports:{}},Ae={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hc=Symbol.for("react.element"),Xb=Symbol.for("react.portal"),Jb=Symbol.for("react.fragment"),Zb=Symbol.for("react.strict_mode"),eR=Symbol.for("react.profiler"),tR=Symbol.for("react.provider"),nR=Symbol.for("react.context"),rR=Symbol.for("react.forward_ref"),iR=Symbol.for("react.suspense"),sR=Symbol.for("react.memo"),oR=Symbol.for("react.lazy"),hv=Symbol.iterator;function aR(t){return t===null||typeof t!="object"?null:(t=hv&&t[hv]||t["@@iterator"],typeof t=="function"?t:null)}var oT={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},aT=Object.assign,lT={};function ga(t,e,n){this.props=t,this.context=e,this.refs=lT,this.updater=n||oT}ga.prototype.isReactComponent={};ga.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};ga.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function cT(){}cT.prototype=ga.prototype;function eg(t,e,n){this.props=t,this.context=e,this.refs=lT,this.updater=n||oT}var tg=eg.prototype=new cT;tg.constructor=eg;aT(tg,ga.prototype);tg.isPureReactComponent=!0;var fv=Array.isArray,uT=Object.prototype.hasOwnProperty,ng={current:null},dT={key:!0,ref:!0,__self:!0,__source:!0};function hT(t,e,n){var r,i={},s=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(s=""+e.key),e)uT.call(e,r)&&!dT.hasOwnProperty(r)&&(i[r]=e[r]);var a=arguments.length-2;if(a===1)i.children=n;else if(1<a){for(var l=Array(a),u=0;u<a;u++)l[u]=arguments[u+2];i.children=l}if(t&&t.defaultProps)for(r in a=t.defaultProps,a)i[r]===void 0&&(i[r]=a[r]);return{$$typeof:hc,type:t,key:s,ref:o,props:i,_owner:ng.current}}function lR(t,e){return{$$typeof:hc,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function rg(t){return typeof t=="object"&&t!==null&&t.$$typeof===hc}function cR(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var pv=/\/+/g;function If(t,e){return typeof t=="object"&&t!==null&&t.key!=null?cR(""+t.key):e.toString(36)}function xu(t,e,n,r,i){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case hc:case Xb:o=!0}}if(o)return o=t,i=i(o),t=r===""?"."+If(o,0):r,fv(i)?(n="",t!=null&&(n=t.replace(pv,"$&/")+"/"),xu(i,e,n,"",function(u){return u})):i!=null&&(rg(i)&&(i=lR(i,n+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(pv,"$&/")+"/")+t)),e.push(i)),1;if(o=0,r=r===""?".":r+":",fv(t))for(var a=0;a<t.length;a++){s=t[a];var l=r+If(s,a);o+=xu(s,e,n,l,i)}else if(l=aR(t),typeof l=="function")for(t=l.call(t),a=0;!(s=t.next()).done;)s=s.value,l=r+If(s,a++),o+=xu(s,e,n,l,i);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function Gc(t,e,n){if(t==null)return t;var r=[],i=0;return xu(t,r,"","",function(s){return e.call(n,s,i++)}),r}function uR(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var rn={current:null},Su={transition:null},dR={ReactCurrentDispatcher:rn,ReactCurrentBatchConfig:Su,ReactCurrentOwner:ng};function fT(){throw Error("act(...) is not supported in production builds of React.")}Ae.Children={map:Gc,forEach:function(t,e,n){Gc(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return Gc(t,function(){e++}),e},toArray:function(t){return Gc(t,function(e){return e})||[]},only:function(t){if(!rg(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Ae.Component=ga;Ae.Fragment=Jb;Ae.Profiler=eR;Ae.PureComponent=eg;Ae.StrictMode=Zb;Ae.Suspense=iR;Ae.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=dR;Ae.act=fT;Ae.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=aT({},t.props),i=t.key,s=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,o=ng.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(l in e)uT.call(e,l)&&!dT.hasOwnProperty(l)&&(r[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)r.children=n;else if(1<l){a=Array(l);for(var u=0;u<l;u++)a[u]=arguments[u+2];r.children=a}return{$$typeof:hc,type:t.type,key:i,ref:s,props:r,_owner:o}};Ae.createContext=function(t){return t={$$typeof:nR,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:tR,_context:t},t.Consumer=t};Ae.createElement=hT;Ae.createFactory=function(t){var e=hT.bind(null,t);return e.type=t,e};Ae.createRef=function(){return{current:null}};Ae.forwardRef=function(t){return{$$typeof:rR,render:t}};Ae.isValidElement=rg;Ae.lazy=function(t){return{$$typeof:oR,_payload:{_status:-1,_result:t},_init:uR}};Ae.memo=function(t,e){return{$$typeof:sR,type:t,compare:e===void 0?null:e}};Ae.startTransition=function(t){var e=Su.transition;Su.transition={};try{t()}finally{Su.transition=e}};Ae.unstable_act=fT;Ae.useCallback=function(t,e){return rn.current.useCallback(t,e)};Ae.useContext=function(t){return rn.current.useContext(t)};Ae.useDebugValue=function(){};Ae.useDeferredValue=function(t){return rn.current.useDeferredValue(t)};Ae.useEffect=function(t,e){return rn.current.useEffect(t,e)};Ae.useId=function(){return rn.current.useId()};Ae.useImperativeHandle=function(t,e,n){return rn.current.useImperativeHandle(t,e,n)};Ae.useInsertionEffect=function(t,e){return rn.current.useInsertionEffect(t,e)};Ae.useLayoutEffect=function(t,e){return rn.current.useLayoutEffect(t,e)};Ae.useMemo=function(t,e){return rn.current.useMemo(t,e)};Ae.useReducer=function(t,e,n){return rn.current.useReducer(t,e,n)};Ae.useRef=function(t){return rn.current.useRef(t)};Ae.useState=function(t){return rn.current.useState(t)};Ae.useSyncExternalStore=function(t,e,n){return rn.current.useSyncExternalStore(t,e,n)};Ae.useTransition=function(){return rn.current.useTransition()};Ae.version="18.3.1";sT.exports=Ae;var k=sT.exports;const hR=Yb(k);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var fR=k,pR=Symbol.for("react.element"),mR=Symbol.for("react.fragment"),gR=Object.prototype.hasOwnProperty,yR=fR.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,_R={key:!0,ref:!0,__self:!0,__source:!0};function pT(t,e,n){var r,i={},s=null,o=null;n!==void 0&&(s=""+n),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)gR.call(e,r)&&!_R.hasOwnProperty(r)&&(i[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)i[r]===void 0&&(i[r]=e[r]);return{$$typeof:pR,type:t,key:s,ref:o,props:i,_owner:yR.current}}rh.Fragment=mR;rh.jsx=pT;rh.jsxs=pT;iT.exports=rh;var d=iT.exports,mT={exports:{}},bn={},gT={exports:{}},yT={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(J,ce){var he=J.length;J.push(ce);e:for(;0<he;){var De=he-1>>>1,H=J[De];if(0<i(H,ce))J[De]=ce,J[he]=H,he=De;else break e}}function n(J){return J.length===0?null:J[0]}function r(J){if(J.length===0)return null;var ce=J[0],he=J.pop();if(he!==ce){J[0]=he;e:for(var De=0,H=J.length,L=H>>>1;De<L;){var z=2*(De+1)-1,re=J[z],ye=z+1,pe=J[ye];if(0>i(re,he))ye<H&&0>i(pe,re)?(J[De]=pe,J[ye]=he,De=ye):(J[De]=re,J[z]=he,De=z);else if(ye<H&&0>i(pe,he))J[De]=pe,J[ye]=he,De=ye;else break e}}return ce}function i(J,ce){var he=J.sortIndex-ce.sortIndex;return he!==0?he:J.id-ce.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var l=[],u=[],h=1,f=null,m=3,E=!1,_=!1,A=!1,P=typeof setTimeout=="function"?setTimeout:null,v=typeof clearTimeout=="function"?clearTimeout:null,w=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function y(J){for(var ce=n(u);ce!==null;){if(ce.callback===null)r(u);else if(ce.startTime<=J)r(u),ce.sortIndex=ce.expirationTime,e(l,ce);else break;ce=n(u)}}function V(J){if(A=!1,y(J),!_)if(n(l)!==null)_=!0,jt(U);else{var ce=n(u);ce!==null&&on(V,ce.startTime-J)}}function U(J,ce){_=!1,A&&(A=!1,v(I),I=-1),E=!0;var he=m;try{for(y(ce),f=n(l);f!==null&&(!(f.expirationTime>ce)||J&&!N());){var De=f.callback;if(typeof De=="function"){f.callback=null,m=f.priorityLevel;var H=De(f.expirationTime<=ce);ce=t.unstable_now(),typeof H=="function"?f.callback=H:f===n(l)&&r(l),y(ce)}else r(l);f=n(l)}if(f!==null)var L=!0;else{var z=n(u);z!==null&&on(V,z.startTime-ce),L=!1}return L}finally{f=null,m=he,E=!1}}var $=!1,S=null,I=-1,C=5,R=-1;function N(){return!(t.unstable_now()-R<C)}function D(){if(S!==null){var J=t.unstable_now();R=J;var ce=!0;try{ce=S(!0,J)}finally{ce?b():($=!1,S=null)}}else $=!1}var b;if(typeof w=="function")b=function(){w(D)};else if(typeof MessageChannel<"u"){var Q=new MessageChannel,Be=Q.port2;Q.port1.onmessage=D,b=function(){Be.postMessage(null)}}else b=function(){P(D,0)};function jt(J){S=J,$||($=!0,b())}function on(J,ce){I=P(function(){J(t.unstable_now())},ce)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(J){J.callback=null},t.unstable_continueExecution=function(){_||E||(_=!0,jt(U))},t.unstable_forceFrameRate=function(J){0>J||125<J?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):C=0<J?Math.floor(1e3/J):5},t.unstable_getCurrentPriorityLevel=function(){return m},t.unstable_getFirstCallbackNode=function(){return n(l)},t.unstable_next=function(J){switch(m){case 1:case 2:case 3:var ce=3;break;default:ce=m}var he=m;m=ce;try{return J()}finally{m=he}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(J,ce){switch(J){case 1:case 2:case 3:case 4:case 5:break;default:J=3}var he=m;m=J;try{return ce()}finally{m=he}},t.unstable_scheduleCallback=function(J,ce,he){var De=t.unstable_now();switch(typeof he=="object"&&he!==null?(he=he.delay,he=typeof he=="number"&&0<he?De+he:De):he=De,J){case 1:var H=-1;break;case 2:H=250;break;case 5:H=1073741823;break;case 4:H=1e4;break;default:H=5e3}return H=he+H,J={id:h++,callback:ce,priorityLevel:J,startTime:he,expirationTime:H,sortIndex:-1},he>De?(J.sortIndex=he,e(u,J),n(l)===null&&J===n(u)&&(A?(v(I),I=-1):A=!0,on(V,he-De))):(J.sortIndex=H,e(l,J),_||E||(_=!0,jt(U))),J},t.unstable_shouldYield=N,t.unstable_wrapCallback=function(J){var ce=m;return function(){var he=m;m=ce;try{return J.apply(this,arguments)}finally{m=he}}}})(yT);gT.exports=yT;var vR=gT.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var wR=k,An=vR;function K(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var _T=new Set,Dl={};function Zs(t,e){Yo(t,e),Yo(t+"Capture",e)}function Yo(t,e){for(Dl[t]=e,t=0;t<e.length;t++)_T.add(e[t])}var Fr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Tp=Object.prototype.hasOwnProperty,ER=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,mv={},gv={};function IR(t){return Tp.call(gv,t)?!0:Tp.call(mv,t)?!1:ER.test(t)?gv[t]=!0:(mv[t]=!0,!1)}function TR(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function xR(t,e,n,r){if(e===null||typeof e>"u"||TR(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function sn(t,e,n,r,i,s,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=o}var Ot={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Ot[t]=new sn(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Ot[e]=new sn(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Ot[t]=new sn(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Ot[t]=new sn(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Ot[t]=new sn(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Ot[t]=new sn(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Ot[t]=new sn(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Ot[t]=new sn(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Ot[t]=new sn(t,5,!1,t.toLowerCase(),null,!1,!1)});var ig=/[\-:]([a-z])/g;function sg(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(ig,sg);Ot[e]=new sn(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(ig,sg);Ot[e]=new sn(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(ig,sg);Ot[e]=new sn(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Ot[t]=new sn(t,1,!1,t.toLowerCase(),null,!1,!1)});Ot.xlinkHref=new sn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Ot[t]=new sn(t,1,!1,t.toLowerCase(),null,!0,!0)});function og(t,e,n,r){var i=Ot.hasOwnProperty(e)?Ot[e]:null;(i!==null?i.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(xR(e,n,i,r)&&(n=null),r||i===null?IR(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):i.mustUseProperty?t[i.propertyName]=n===null?i.type===3?!1:"":n:(e=i.attributeName,r=i.attributeNamespace,n===null?t.removeAttribute(e):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var Qr=wR.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Qc=Symbol.for("react.element"),xo=Symbol.for("react.portal"),So=Symbol.for("react.fragment"),ag=Symbol.for("react.strict_mode"),xp=Symbol.for("react.profiler"),vT=Symbol.for("react.provider"),wT=Symbol.for("react.context"),lg=Symbol.for("react.forward_ref"),Sp=Symbol.for("react.suspense"),Ap=Symbol.for("react.suspense_list"),cg=Symbol.for("react.memo"),fi=Symbol.for("react.lazy"),ET=Symbol.for("react.offscreen"),yv=Symbol.iterator;function Ua(t){return t===null||typeof t!="object"?null:(t=yv&&t[yv]||t["@@iterator"],typeof t=="function"?t:null)}var st=Object.assign,Tf;function nl(t){if(Tf===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);Tf=e&&e[1]||""}return`
`+Tf+t}var xf=!1;function Sf(t,e){if(!t||xf)return"";xf=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var r=u}Reflect.construct(t,[],e)}else{try{e.call()}catch(u){r=u}t.call(e.prototype)}else{try{throw Error()}catch(u){r=u}t()}}catch(u){if(u&&r&&typeof u.stack=="string"){for(var i=u.stack.split(`
`),s=r.stack.split(`
`),o=i.length-1,a=s.length-1;1<=o&&0<=a&&i[o]!==s[a];)a--;for(;1<=o&&0<=a;o--,a--)if(i[o]!==s[a]){if(o!==1||a!==1)do if(o--,a--,0>a||i[o]!==s[a]){var l=`
`+i[o].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=o&&0<=a);break}}}finally{xf=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?nl(t):""}function SR(t){switch(t.tag){case 5:return nl(t.type);case 16:return nl("Lazy");case 13:return nl("Suspense");case 19:return nl("SuspenseList");case 0:case 2:case 15:return t=Sf(t.type,!1),t;case 11:return t=Sf(t.type.render,!1),t;case 1:return t=Sf(t.type,!0),t;default:return""}}function Cp(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case So:return"Fragment";case xo:return"Portal";case xp:return"Profiler";case ag:return"StrictMode";case Sp:return"Suspense";case Ap:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case wT:return(t.displayName||"Context")+".Consumer";case vT:return(t._context.displayName||"Context")+".Provider";case lg:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case cg:return e=t.displayName||null,e!==null?e:Cp(t.type)||"Memo";case fi:e=t._payload,t=t._init;try{return Cp(t(e))}catch{}}return null}function AR(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Cp(e);case 8:return e===ag?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function $i(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function IT(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function CR(t){var e=IT(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,s=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(o){r=""+o,s.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Yc(t){t._valueTracker||(t._valueTracker=CR(t))}function TT(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=IT(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function ed(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function bp(t,e){var n=e.checked;return st({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function _v(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=$i(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function xT(t,e){e=e.checked,e!=null&&og(t,"checked",e,!1)}function Rp(t,e){xT(t,e);var n=$i(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Pp(t,e.type,n):e.hasOwnProperty("defaultValue")&&Pp(t,e.type,$i(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function vv(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function Pp(t,e,n){(e!=="number"||ed(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var rl=Array.isArray;function Lo(t,e,n,r){if(t=t.options,e){e={};for(var i=0;i<n.length;i++)e["$"+n[i]]=!0;for(n=0;n<t.length;n++)i=e.hasOwnProperty("$"+t[n].value),t[n].selected!==i&&(t[n].selected=i),i&&r&&(t[n].defaultSelected=!0)}else{for(n=""+$i(n),e=null,i=0;i<t.length;i++){if(t[i].value===n){t[i].selected=!0,r&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function kp(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(K(91));return st({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function wv(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(K(92));if(rl(n)){if(1<n.length)throw Error(K(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:$i(n)}}function ST(t,e){var n=$i(e.value),r=$i(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function Ev(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function AT(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Np(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?AT(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Xc,CT=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,i){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Xc=Xc||document.createElement("div"),Xc.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Xc.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Vl(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var pl={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},bR=["Webkit","ms","Moz","O"];Object.keys(pl).forEach(function(t){bR.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),pl[e]=pl[t]})});function bT(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||pl.hasOwnProperty(t)&&pl[t]?(""+e).trim():e+"px"}function RT(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=bT(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,i):t[n]=i}}var RR=st({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Dp(t,e){if(e){if(RR[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(K(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(K(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(K(61))}if(e.style!=null&&typeof e.style!="object")throw Error(K(62))}}function Vp(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Op=null;function ug(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var jp=null,Mo=null,Fo=null;function Iv(t){if(t=mc(t)){if(typeof jp!="function")throw Error(K(280));var e=t.stateNode;e&&(e=lh(e),jp(t.stateNode,t.type,e))}}function PT(t){Mo?Fo?Fo.push(t):Fo=[t]:Mo=t}function kT(){if(Mo){var t=Mo,e=Fo;if(Fo=Mo=null,Iv(t),e)for(t=0;t<e.length;t++)Iv(e[t])}}function NT(t,e){return t(e)}function DT(){}var Af=!1;function VT(t,e,n){if(Af)return t(e,n);Af=!0;try{return NT(t,e,n)}finally{Af=!1,(Mo!==null||Fo!==null)&&(DT(),kT())}}function Ol(t,e){var n=t.stateNode;if(n===null)return null;var r=lh(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(K(231,e,typeof n));return n}var Lp=!1;if(Fr)try{var Ba={};Object.defineProperty(Ba,"passive",{get:function(){Lp=!0}}),window.addEventListener("test",Ba,Ba),window.removeEventListener("test",Ba,Ba)}catch{Lp=!1}function PR(t,e,n,r,i,s,o,a,l){var u=Array.prototype.slice.call(arguments,3);try{e.apply(n,u)}catch(h){this.onError(h)}}var ml=!1,td=null,nd=!1,Mp=null,kR={onError:function(t){ml=!0,td=t}};function NR(t,e,n,r,i,s,o,a,l){ml=!1,td=null,PR.apply(kR,arguments)}function DR(t,e,n,r,i,s,o,a,l){if(NR.apply(this,arguments),ml){if(ml){var u=td;ml=!1,td=null}else throw Error(K(198));nd||(nd=!0,Mp=u)}}function eo(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function OT(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function Tv(t){if(eo(t)!==t)throw Error(K(188))}function VR(t){var e=t.alternate;if(!e){if(e=eo(t),e===null)throw Error(K(188));return e!==t?null:t}for(var n=t,r=e;;){var i=n.return;if(i===null)break;var s=i.alternate;if(s===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===n)return Tv(i),t;if(s===r)return Tv(i),e;s=s.sibling}throw Error(K(188))}if(n.return!==r.return)n=i,r=s;else{for(var o=!1,a=i.child;a;){if(a===n){o=!0,n=i,r=s;break}if(a===r){o=!0,r=i,n=s;break}a=a.sibling}if(!o){for(a=s.child;a;){if(a===n){o=!0,n=s,r=i;break}if(a===r){o=!0,r=s,n=i;break}a=a.sibling}if(!o)throw Error(K(189))}}if(n.alternate!==r)throw Error(K(190))}if(n.tag!==3)throw Error(K(188));return n.stateNode.current===n?t:e}function jT(t){return t=VR(t),t!==null?LT(t):null}function LT(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=LT(t);if(e!==null)return e;t=t.sibling}return null}var MT=An.unstable_scheduleCallback,xv=An.unstable_cancelCallback,OR=An.unstable_shouldYield,jR=An.unstable_requestPaint,ft=An.unstable_now,LR=An.unstable_getCurrentPriorityLevel,dg=An.unstable_ImmediatePriority,FT=An.unstable_UserBlockingPriority,rd=An.unstable_NormalPriority,MR=An.unstable_LowPriority,UT=An.unstable_IdlePriority,ih=null,_r=null;function FR(t){if(_r&&typeof _r.onCommitFiberRoot=="function")try{_r.onCommitFiberRoot(ih,t,void 0,(t.current.flags&128)===128)}catch{}}var Yn=Math.clz32?Math.clz32:$R,UR=Math.log,BR=Math.LN2;function $R(t){return t>>>=0,t===0?32:31-(UR(t)/BR|0)|0}var Jc=64,Zc=4194304;function il(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function id(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,i=t.suspendedLanes,s=t.pingedLanes,o=n&268435455;if(o!==0){var a=o&~i;a!==0?r=il(a):(s&=o,s!==0&&(r=il(s)))}else o=n&~i,o!==0?r=il(o):s!==0&&(r=il(s));if(r===0)return 0;if(e!==0&&e!==r&&!(e&i)&&(i=r&-r,s=e&-e,i>=s||i===16&&(s&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-Yn(e),i=1<<n,r|=t[n],e&=~i;return r}function zR(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function qR(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,i=t.expirationTimes,s=t.pendingLanes;0<s;){var o=31-Yn(s),a=1<<o,l=i[o];l===-1?(!(a&n)||a&r)&&(i[o]=zR(a,e)):l<=e&&(t.expiredLanes|=a),s&=~a}}function Fp(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function BT(){var t=Jc;return Jc<<=1,!(Jc&4194240)&&(Jc=64),t}function Cf(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function fc(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Yn(e),t[e]=n}function HR(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var i=31-Yn(n),s=1<<i;e[i]=0,r[i]=-1,t[i]=-1,n&=~s}}function hg(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-Yn(n),i=1<<r;i&e|t[r]&e&&(t[r]|=e),n&=~i}}var Fe=0;function $T(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var zT,fg,qT,HT,WT,Up=!1,eu=[],Ci=null,bi=null,Ri=null,jl=new Map,Ll=new Map,mi=[],WR="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Sv(t,e){switch(t){case"focusin":case"focusout":Ci=null;break;case"dragenter":case"dragleave":bi=null;break;case"mouseover":case"mouseout":Ri=null;break;case"pointerover":case"pointerout":jl.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ll.delete(e.pointerId)}}function $a(t,e,n,r,i,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:s,targetContainers:[i]},e!==null&&(e=mc(e),e!==null&&fg(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function KR(t,e,n,r,i){switch(e){case"focusin":return Ci=$a(Ci,t,e,n,r,i),!0;case"dragenter":return bi=$a(bi,t,e,n,r,i),!0;case"mouseover":return Ri=$a(Ri,t,e,n,r,i),!0;case"pointerover":var s=i.pointerId;return jl.set(s,$a(jl.get(s)||null,t,e,n,r,i)),!0;case"gotpointercapture":return s=i.pointerId,Ll.set(s,$a(Ll.get(s)||null,t,e,n,r,i)),!0}return!1}function KT(t){var e=Es(t.target);if(e!==null){var n=eo(e);if(n!==null){if(e=n.tag,e===13){if(e=OT(n),e!==null){t.blockedOn=e,WT(t.priority,function(){qT(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Au(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=Bp(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);Op=r,n.target.dispatchEvent(r),Op=null}else return e=mc(n),e!==null&&fg(e),t.blockedOn=n,!1;e.shift()}return!0}function Av(t,e,n){Au(t)&&n.delete(e)}function GR(){Up=!1,Ci!==null&&Au(Ci)&&(Ci=null),bi!==null&&Au(bi)&&(bi=null),Ri!==null&&Au(Ri)&&(Ri=null),jl.forEach(Av),Ll.forEach(Av)}function za(t,e){t.blockedOn===e&&(t.blockedOn=null,Up||(Up=!0,An.unstable_scheduleCallback(An.unstable_NormalPriority,GR)))}function Ml(t){function e(i){return za(i,t)}if(0<eu.length){za(eu[0],t);for(var n=1;n<eu.length;n++){var r=eu[n];r.blockedOn===t&&(r.blockedOn=null)}}for(Ci!==null&&za(Ci,t),bi!==null&&za(bi,t),Ri!==null&&za(Ri,t),jl.forEach(e),Ll.forEach(e),n=0;n<mi.length;n++)r=mi[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<mi.length&&(n=mi[0],n.blockedOn===null);)KT(n),n.blockedOn===null&&mi.shift()}var Uo=Qr.ReactCurrentBatchConfig,sd=!0;function QR(t,e,n,r){var i=Fe,s=Uo.transition;Uo.transition=null;try{Fe=1,pg(t,e,n,r)}finally{Fe=i,Uo.transition=s}}function YR(t,e,n,r){var i=Fe,s=Uo.transition;Uo.transition=null;try{Fe=4,pg(t,e,n,r)}finally{Fe=i,Uo.transition=s}}function pg(t,e,n,r){if(sd){var i=Bp(t,e,n,r);if(i===null)Lf(t,e,r,od,n),Sv(t,r);else if(KR(i,t,e,n,r))r.stopPropagation();else if(Sv(t,r),e&4&&-1<WR.indexOf(t)){for(;i!==null;){var s=mc(i);if(s!==null&&zT(s),s=Bp(t,e,n,r),s===null&&Lf(t,e,r,od,n),s===i)break;i=s}i!==null&&r.stopPropagation()}else Lf(t,e,r,null,n)}}var od=null;function Bp(t,e,n,r){if(od=null,t=ug(r),t=Es(t),t!==null)if(e=eo(t),e===null)t=null;else if(n=e.tag,n===13){if(t=OT(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return od=t,null}function GT(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(LR()){case dg:return 1;case FT:return 4;case rd:case MR:return 16;case UT:return 536870912;default:return 16}default:return 16}}var xi=null,mg=null,Cu=null;function QT(){if(Cu)return Cu;var t,e=mg,n=e.length,r,i="value"in xi?xi.value:xi.textContent,s=i.length;for(t=0;t<n&&e[t]===i[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===i[s-r];r++);return Cu=i.slice(t,1<r?1-r:void 0)}function bu(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function tu(){return!0}function Cv(){return!1}function Rn(t){function e(n,r,i,s,o){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(n=t[a],this[a]=n?n(s):s[a]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?tu:Cv,this.isPropagationStopped=Cv,this}return st(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=tu)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=tu)},persist:function(){},isPersistent:tu}),e}var ya={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},gg=Rn(ya),pc=st({},ya,{view:0,detail:0}),XR=Rn(pc),bf,Rf,qa,sh=st({},pc,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:yg,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==qa&&(qa&&t.type==="mousemove"?(bf=t.screenX-qa.screenX,Rf=t.screenY-qa.screenY):Rf=bf=0,qa=t),bf)},movementY:function(t){return"movementY"in t?t.movementY:Rf}}),bv=Rn(sh),JR=st({},sh,{dataTransfer:0}),ZR=Rn(JR),e1=st({},pc,{relatedTarget:0}),Pf=Rn(e1),t1=st({},ya,{animationName:0,elapsedTime:0,pseudoElement:0}),n1=Rn(t1),r1=st({},ya,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),i1=Rn(r1),s1=st({},ya,{data:0}),Rv=Rn(s1),o1={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},a1={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},l1={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function c1(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=l1[t])?!!e[t]:!1}function yg(){return c1}var u1=st({},pc,{key:function(t){if(t.key){var e=o1[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=bu(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?a1[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:yg,charCode:function(t){return t.type==="keypress"?bu(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?bu(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),d1=Rn(u1),h1=st({},sh,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Pv=Rn(h1),f1=st({},pc,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:yg}),p1=Rn(f1),m1=st({},ya,{propertyName:0,elapsedTime:0,pseudoElement:0}),g1=Rn(m1),y1=st({},sh,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),_1=Rn(y1),v1=[9,13,27,32],_g=Fr&&"CompositionEvent"in window,gl=null;Fr&&"documentMode"in document&&(gl=document.documentMode);var w1=Fr&&"TextEvent"in window&&!gl,YT=Fr&&(!_g||gl&&8<gl&&11>=gl),kv=" ",Nv=!1;function XT(t,e){switch(t){case"keyup":return v1.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function JT(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Ao=!1;function E1(t,e){switch(t){case"compositionend":return JT(e);case"keypress":return e.which!==32?null:(Nv=!0,kv);case"textInput":return t=e.data,t===kv&&Nv?null:t;default:return null}}function I1(t,e){if(Ao)return t==="compositionend"||!_g&&XT(t,e)?(t=QT(),Cu=mg=xi=null,Ao=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return YT&&e.locale!=="ko"?null:e.data;default:return null}}var T1={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Dv(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!T1[t.type]:e==="textarea"}function ZT(t,e,n,r){PT(r),e=ad(e,"onChange"),0<e.length&&(n=new gg("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var yl=null,Fl=null;function x1(t){u0(t,0)}function oh(t){var e=Ro(t);if(TT(e))return t}function S1(t,e){if(t==="change")return e}var e0=!1;if(Fr){var kf;if(Fr){var Nf="oninput"in document;if(!Nf){var Vv=document.createElement("div");Vv.setAttribute("oninput","return;"),Nf=typeof Vv.oninput=="function"}kf=Nf}else kf=!1;e0=kf&&(!document.documentMode||9<document.documentMode)}function Ov(){yl&&(yl.detachEvent("onpropertychange",t0),Fl=yl=null)}function t0(t){if(t.propertyName==="value"&&oh(Fl)){var e=[];ZT(e,Fl,t,ug(t)),VT(x1,e)}}function A1(t,e,n){t==="focusin"?(Ov(),yl=e,Fl=n,yl.attachEvent("onpropertychange",t0)):t==="focusout"&&Ov()}function C1(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return oh(Fl)}function b1(t,e){if(t==="click")return oh(e)}function R1(t,e){if(t==="input"||t==="change")return oh(e)}function P1(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Zn=typeof Object.is=="function"?Object.is:P1;function Ul(t,e){if(Zn(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!Tp.call(e,i)||!Zn(t[i],e[i]))return!1}return!0}function jv(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Lv(t,e){var n=jv(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=jv(n)}}function n0(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?n0(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function r0(){for(var t=window,e=ed();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=ed(t.document)}return e}function vg(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function k1(t){var e=r0(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&n0(n.ownerDocument.documentElement,n)){if(r!==null&&vg(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=n.textContent.length,s=Math.min(r.start,i);r=r.end===void 0?s:Math.min(r.end,i),!t.extend&&s>r&&(i=r,r=s,s=i),i=Lv(n,s);var o=Lv(n,r);i&&o&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),s>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var N1=Fr&&"documentMode"in document&&11>=document.documentMode,Co=null,$p=null,_l=null,zp=!1;function Mv(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;zp||Co==null||Co!==ed(r)||(r=Co,"selectionStart"in r&&vg(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),_l&&Ul(_l,r)||(_l=r,r=ad($p,"onSelect"),0<r.length&&(e=new gg("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=Co)))}function nu(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var bo={animationend:nu("Animation","AnimationEnd"),animationiteration:nu("Animation","AnimationIteration"),animationstart:nu("Animation","AnimationStart"),transitionend:nu("Transition","TransitionEnd")},Df={},i0={};Fr&&(i0=document.createElement("div").style,"AnimationEvent"in window||(delete bo.animationend.animation,delete bo.animationiteration.animation,delete bo.animationstart.animation),"TransitionEvent"in window||delete bo.transitionend.transition);function ah(t){if(Df[t])return Df[t];if(!bo[t])return t;var e=bo[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in i0)return Df[t]=e[n];return t}var s0=ah("animationend"),o0=ah("animationiteration"),a0=ah("animationstart"),l0=ah("transitionend"),c0=new Map,Fv="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Qi(t,e){c0.set(t,e),Zs(e,[t])}for(var Vf=0;Vf<Fv.length;Vf++){var Of=Fv[Vf],D1=Of.toLowerCase(),V1=Of[0].toUpperCase()+Of.slice(1);Qi(D1,"on"+V1)}Qi(s0,"onAnimationEnd");Qi(o0,"onAnimationIteration");Qi(a0,"onAnimationStart");Qi("dblclick","onDoubleClick");Qi("focusin","onFocus");Qi("focusout","onBlur");Qi(l0,"onTransitionEnd");Yo("onMouseEnter",["mouseout","mouseover"]);Yo("onMouseLeave",["mouseout","mouseover"]);Yo("onPointerEnter",["pointerout","pointerover"]);Yo("onPointerLeave",["pointerout","pointerover"]);Zs("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Zs("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Zs("onBeforeInput",["compositionend","keypress","textInput","paste"]);Zs("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Zs("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Zs("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var sl="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),O1=new Set("cancel close invalid load scroll toggle".split(" ").concat(sl));function Uv(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,DR(r,e,void 0,t),t.currentTarget=null}function u0(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],i=r.event;r=r.listeners;e:{var s=void 0;if(e)for(var o=r.length-1;0<=o;o--){var a=r[o],l=a.instance,u=a.currentTarget;if(a=a.listener,l!==s&&i.isPropagationStopped())break e;Uv(i,a,u),s=l}else for(o=0;o<r.length;o++){if(a=r[o],l=a.instance,u=a.currentTarget,a=a.listener,l!==s&&i.isPropagationStopped())break e;Uv(i,a,u),s=l}}}if(nd)throw t=Mp,nd=!1,Mp=null,t}function Qe(t,e){var n=e[Gp];n===void 0&&(n=e[Gp]=new Set);var r=t+"__bubble";n.has(r)||(d0(e,t,2,!1),n.add(r))}function jf(t,e,n){var r=0;e&&(r|=4),d0(n,t,r,e)}var ru="_reactListening"+Math.random().toString(36).slice(2);function Bl(t){if(!t[ru]){t[ru]=!0,_T.forEach(function(n){n!=="selectionchange"&&(O1.has(n)||jf(n,!1,t),jf(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[ru]||(e[ru]=!0,jf("selectionchange",!1,e))}}function d0(t,e,n,r){switch(GT(e)){case 1:var i=QR;break;case 4:i=YR;break;default:i=pg}n=i.bind(null,e,n,t),i=void 0,!Lp||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),r?i!==void 0?t.addEventListener(e,n,{capture:!0,passive:i}):t.addEventListener(e,n,!0):i!==void 0?t.addEventListener(e,n,{passive:i}):t.addEventListener(e,n,!1)}function Lf(t,e,n,r,i){var s=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var a=r.stateNode.containerInfo;if(a===i||a.nodeType===8&&a.parentNode===i)break;if(o===4)for(o=r.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===i||l.nodeType===8&&l.parentNode===i))return;o=o.return}for(;a!==null;){if(o=Es(a),o===null)return;if(l=o.tag,l===5||l===6){r=s=o;continue e}a=a.parentNode}}r=r.return}VT(function(){var u=s,h=ug(n),f=[];e:{var m=c0.get(t);if(m!==void 0){var E=gg,_=t;switch(t){case"keypress":if(bu(n)===0)break e;case"keydown":case"keyup":E=d1;break;case"focusin":_="focus",E=Pf;break;case"focusout":_="blur",E=Pf;break;case"beforeblur":case"afterblur":E=Pf;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":E=bv;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":E=ZR;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":E=p1;break;case s0:case o0:case a0:E=n1;break;case l0:E=g1;break;case"scroll":E=XR;break;case"wheel":E=_1;break;case"copy":case"cut":case"paste":E=i1;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":E=Pv}var A=(e&4)!==0,P=!A&&t==="scroll",v=A?m!==null?m+"Capture":null:m;A=[];for(var w=u,y;w!==null;){y=w;var V=y.stateNode;if(y.tag===5&&V!==null&&(y=V,v!==null&&(V=Ol(w,v),V!=null&&A.push($l(w,V,y)))),P)break;w=w.return}0<A.length&&(m=new E(m,_,null,n,h),f.push({event:m,listeners:A}))}}if(!(e&7)){e:{if(m=t==="mouseover"||t==="pointerover",E=t==="mouseout"||t==="pointerout",m&&n!==Op&&(_=n.relatedTarget||n.fromElement)&&(Es(_)||_[Ur]))break e;if((E||m)&&(m=h.window===h?h:(m=h.ownerDocument)?m.defaultView||m.parentWindow:window,E?(_=n.relatedTarget||n.toElement,E=u,_=_?Es(_):null,_!==null&&(P=eo(_),_!==P||_.tag!==5&&_.tag!==6)&&(_=null)):(E=null,_=u),E!==_)){if(A=bv,V="onMouseLeave",v="onMouseEnter",w="mouse",(t==="pointerout"||t==="pointerover")&&(A=Pv,V="onPointerLeave",v="onPointerEnter",w="pointer"),P=E==null?m:Ro(E),y=_==null?m:Ro(_),m=new A(V,w+"leave",E,n,h),m.target=P,m.relatedTarget=y,V=null,Es(h)===u&&(A=new A(v,w+"enter",_,n,h),A.target=y,A.relatedTarget=P,V=A),P=V,E&&_)t:{for(A=E,v=_,w=0,y=A;y;y=co(y))w++;for(y=0,V=v;V;V=co(V))y++;for(;0<w-y;)A=co(A),w--;for(;0<y-w;)v=co(v),y--;for(;w--;){if(A===v||v!==null&&A===v.alternate)break t;A=co(A),v=co(v)}A=null}else A=null;E!==null&&Bv(f,m,E,A,!1),_!==null&&P!==null&&Bv(f,P,_,A,!0)}}e:{if(m=u?Ro(u):window,E=m.nodeName&&m.nodeName.toLowerCase(),E==="select"||E==="input"&&m.type==="file")var U=S1;else if(Dv(m))if(e0)U=R1;else{U=C1;var $=A1}else(E=m.nodeName)&&E.toLowerCase()==="input"&&(m.type==="checkbox"||m.type==="radio")&&(U=b1);if(U&&(U=U(t,u))){ZT(f,U,n,h);break e}$&&$(t,m,u),t==="focusout"&&($=m._wrapperState)&&$.controlled&&m.type==="number"&&Pp(m,"number",m.value)}switch($=u?Ro(u):window,t){case"focusin":(Dv($)||$.contentEditable==="true")&&(Co=$,$p=u,_l=null);break;case"focusout":_l=$p=Co=null;break;case"mousedown":zp=!0;break;case"contextmenu":case"mouseup":case"dragend":zp=!1,Mv(f,n,h);break;case"selectionchange":if(N1)break;case"keydown":case"keyup":Mv(f,n,h)}var S;if(_g)e:{switch(t){case"compositionstart":var I="onCompositionStart";break e;case"compositionend":I="onCompositionEnd";break e;case"compositionupdate":I="onCompositionUpdate";break e}I=void 0}else Ao?XT(t,n)&&(I="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(I="onCompositionStart");I&&(YT&&n.locale!=="ko"&&(Ao||I!=="onCompositionStart"?I==="onCompositionEnd"&&Ao&&(S=QT()):(xi=h,mg="value"in xi?xi.value:xi.textContent,Ao=!0)),$=ad(u,I),0<$.length&&(I=new Rv(I,t,null,n,h),f.push({event:I,listeners:$}),S?I.data=S:(S=JT(n),S!==null&&(I.data=S)))),(S=w1?E1(t,n):I1(t,n))&&(u=ad(u,"onBeforeInput"),0<u.length&&(h=new Rv("onBeforeInput","beforeinput",null,n,h),f.push({event:h,listeners:u}),h.data=S))}u0(f,e)})}function $l(t,e,n){return{instance:t,listener:e,currentTarget:n}}function ad(t,e){for(var n=e+"Capture",r=[];t!==null;){var i=t,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=Ol(t,n),s!=null&&r.unshift($l(t,s,i)),s=Ol(t,e),s!=null&&r.push($l(t,s,i))),t=t.return}return r}function co(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function Bv(t,e,n,r,i){for(var s=e._reactName,o=[];n!==null&&n!==r;){var a=n,l=a.alternate,u=a.stateNode;if(l!==null&&l===r)break;a.tag===5&&u!==null&&(a=u,i?(l=Ol(n,s),l!=null&&o.unshift($l(n,l,a))):i||(l=Ol(n,s),l!=null&&o.push($l(n,l,a)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var j1=/\r\n?/g,L1=/\u0000|\uFFFD/g;function $v(t){return(typeof t=="string"?t:""+t).replace(j1,`
`).replace(L1,"")}function iu(t,e,n){if(e=$v(e),$v(t)!==e&&n)throw Error(K(425))}function ld(){}var qp=null,Hp=null;function Wp(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Kp=typeof setTimeout=="function"?setTimeout:void 0,M1=typeof clearTimeout=="function"?clearTimeout:void 0,zv=typeof Promise=="function"?Promise:void 0,F1=typeof queueMicrotask=="function"?queueMicrotask:typeof zv<"u"?function(t){return zv.resolve(null).then(t).catch(U1)}:Kp;function U1(t){setTimeout(function(){throw t})}function Mf(t,e){var n=e,r=0;do{var i=n.nextSibling;if(t.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){t.removeChild(i),Ml(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);Ml(e)}function Pi(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function qv(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var _a=Math.random().toString(36).slice(2),fr="__reactFiber$"+_a,zl="__reactProps$"+_a,Ur="__reactContainer$"+_a,Gp="__reactEvents$"+_a,B1="__reactListeners$"+_a,$1="__reactHandles$"+_a;function Es(t){var e=t[fr];if(e)return e;for(var n=t.parentNode;n;){if(e=n[Ur]||n[fr]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=qv(t);t!==null;){if(n=t[fr])return n;t=qv(t)}return e}t=n,n=t.parentNode}return null}function mc(t){return t=t[fr]||t[Ur],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Ro(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(K(33))}function lh(t){return t[zl]||null}var Qp=[],Po=-1;function Yi(t){return{current:t}}function Ye(t){0>Po||(t.current=Qp[Po],Qp[Po]=null,Po--)}function We(t,e){Po++,Qp[Po]=t.current,t.current=e}var zi={},Kt=Yi(zi),dn=Yi(!1),Vs=zi;function Xo(t,e){var n=t.type.contextTypes;if(!n)return zi;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in n)i[s]=e[s];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function hn(t){return t=t.childContextTypes,t!=null}function cd(){Ye(dn),Ye(Kt)}function Hv(t,e,n){if(Kt.current!==zi)throw Error(K(168));We(Kt,e),We(dn,n)}function h0(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in e))throw Error(K(108,AR(t)||"Unknown",i));return st({},n,r)}function ud(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||zi,Vs=Kt.current,We(Kt,t),We(dn,dn.current),!0}function Wv(t,e,n){var r=t.stateNode;if(!r)throw Error(K(169));n?(t=h0(t,e,Vs),r.__reactInternalMemoizedMergedChildContext=t,Ye(dn),Ye(Kt),We(Kt,t)):Ye(dn),We(dn,n)}var kr=null,ch=!1,Ff=!1;function f0(t){kr===null?kr=[t]:kr.push(t)}function z1(t){ch=!0,f0(t)}function Xi(){if(!Ff&&kr!==null){Ff=!0;var t=0,e=Fe;try{var n=kr;for(Fe=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}kr=null,ch=!1}catch(i){throw kr!==null&&(kr=kr.slice(t+1)),MT(dg,Xi),i}finally{Fe=e,Ff=!1}}return null}var ko=[],No=0,dd=null,hd=0,kn=[],Nn=0,Os=null,Nr=1,Dr="";function ds(t,e){ko[No++]=hd,ko[No++]=dd,dd=t,hd=e}function p0(t,e,n){kn[Nn++]=Nr,kn[Nn++]=Dr,kn[Nn++]=Os,Os=t;var r=Nr;t=Dr;var i=32-Yn(r)-1;r&=~(1<<i),n+=1;var s=32-Yn(e)+i;if(30<s){var o=i-i%5;s=(r&(1<<o)-1).toString(32),r>>=o,i-=o,Nr=1<<32-Yn(e)+i|n<<i|r,Dr=s+t}else Nr=1<<s|n<<i|r,Dr=t}function wg(t){t.return!==null&&(ds(t,1),p0(t,1,0))}function Eg(t){for(;t===dd;)dd=ko[--No],ko[No]=null,hd=ko[--No],ko[No]=null;for(;t===Os;)Os=kn[--Nn],kn[Nn]=null,Dr=kn[--Nn],kn[Nn]=null,Nr=kn[--Nn],kn[Nn]=null}var xn=null,In=null,Ze=!1,Gn=null;function m0(t,e){var n=On(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function Kv(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,xn=t,In=Pi(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,xn=t,In=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=Os!==null?{id:Nr,overflow:Dr}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=On(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,xn=t,In=null,!0):!1;default:return!1}}function Yp(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Xp(t){if(Ze){var e=In;if(e){var n=e;if(!Kv(t,e)){if(Yp(t))throw Error(K(418));e=Pi(n.nextSibling);var r=xn;e&&Kv(t,e)?m0(r,n):(t.flags=t.flags&-4097|2,Ze=!1,xn=t)}}else{if(Yp(t))throw Error(K(418));t.flags=t.flags&-4097|2,Ze=!1,xn=t}}}function Gv(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;xn=t}function su(t){if(t!==xn)return!1;if(!Ze)return Gv(t),Ze=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Wp(t.type,t.memoizedProps)),e&&(e=In)){if(Yp(t))throw g0(),Error(K(418));for(;e;)m0(t,e),e=Pi(e.nextSibling)}if(Gv(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(K(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){In=Pi(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}In=null}}else In=xn?Pi(t.stateNode.nextSibling):null;return!0}function g0(){for(var t=In;t;)t=Pi(t.nextSibling)}function Jo(){In=xn=null,Ze=!1}function Ig(t){Gn===null?Gn=[t]:Gn.push(t)}var q1=Qr.ReactCurrentBatchConfig;function Ha(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(K(309));var r=n.stateNode}if(!r)throw Error(K(147,t));var i=r,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(o){var a=i.refs;o===null?delete a[s]:a[s]=o},e._stringRef=s,e)}if(typeof t!="string")throw Error(K(284));if(!n._owner)throw Error(K(290,t))}return t}function ou(t,e){throw t=Object.prototype.toString.call(e),Error(K(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function Qv(t){var e=t._init;return e(t._payload)}function y0(t){function e(v,w){if(t){var y=v.deletions;y===null?(v.deletions=[w],v.flags|=16):y.push(w)}}function n(v,w){if(!t)return null;for(;w!==null;)e(v,w),w=w.sibling;return null}function r(v,w){for(v=new Map;w!==null;)w.key!==null?v.set(w.key,w):v.set(w.index,w),w=w.sibling;return v}function i(v,w){return v=Vi(v,w),v.index=0,v.sibling=null,v}function s(v,w,y){return v.index=y,t?(y=v.alternate,y!==null?(y=y.index,y<w?(v.flags|=2,w):y):(v.flags|=2,w)):(v.flags|=1048576,w)}function o(v){return t&&v.alternate===null&&(v.flags|=2),v}function a(v,w,y,V){return w===null||w.tag!==6?(w=Wf(y,v.mode,V),w.return=v,w):(w=i(w,y),w.return=v,w)}function l(v,w,y,V){var U=y.type;return U===So?h(v,w,y.props.children,V,y.key):w!==null&&(w.elementType===U||typeof U=="object"&&U!==null&&U.$$typeof===fi&&Qv(U)===w.type)?(V=i(w,y.props),V.ref=Ha(v,w,y),V.return=v,V):(V=Ou(y.type,y.key,y.props,null,v.mode,V),V.ref=Ha(v,w,y),V.return=v,V)}function u(v,w,y,V){return w===null||w.tag!==4||w.stateNode.containerInfo!==y.containerInfo||w.stateNode.implementation!==y.implementation?(w=Kf(y,v.mode,V),w.return=v,w):(w=i(w,y.children||[]),w.return=v,w)}function h(v,w,y,V,U){return w===null||w.tag!==7?(w=Cs(y,v.mode,V,U),w.return=v,w):(w=i(w,y),w.return=v,w)}function f(v,w,y){if(typeof w=="string"&&w!==""||typeof w=="number")return w=Wf(""+w,v.mode,y),w.return=v,w;if(typeof w=="object"&&w!==null){switch(w.$$typeof){case Qc:return y=Ou(w.type,w.key,w.props,null,v.mode,y),y.ref=Ha(v,null,w),y.return=v,y;case xo:return w=Kf(w,v.mode,y),w.return=v,w;case fi:var V=w._init;return f(v,V(w._payload),y)}if(rl(w)||Ua(w))return w=Cs(w,v.mode,y,null),w.return=v,w;ou(v,w)}return null}function m(v,w,y,V){var U=w!==null?w.key:null;if(typeof y=="string"&&y!==""||typeof y=="number")return U!==null?null:a(v,w,""+y,V);if(typeof y=="object"&&y!==null){switch(y.$$typeof){case Qc:return y.key===U?l(v,w,y,V):null;case xo:return y.key===U?u(v,w,y,V):null;case fi:return U=y._init,m(v,w,U(y._payload),V)}if(rl(y)||Ua(y))return U!==null?null:h(v,w,y,V,null);ou(v,y)}return null}function E(v,w,y,V,U){if(typeof V=="string"&&V!==""||typeof V=="number")return v=v.get(y)||null,a(w,v,""+V,U);if(typeof V=="object"&&V!==null){switch(V.$$typeof){case Qc:return v=v.get(V.key===null?y:V.key)||null,l(w,v,V,U);case xo:return v=v.get(V.key===null?y:V.key)||null,u(w,v,V,U);case fi:var $=V._init;return E(v,w,y,$(V._payload),U)}if(rl(V)||Ua(V))return v=v.get(y)||null,h(w,v,V,U,null);ou(w,V)}return null}function _(v,w,y,V){for(var U=null,$=null,S=w,I=w=0,C=null;S!==null&&I<y.length;I++){S.index>I?(C=S,S=null):C=S.sibling;var R=m(v,S,y[I],V);if(R===null){S===null&&(S=C);break}t&&S&&R.alternate===null&&e(v,S),w=s(R,w,I),$===null?U=R:$.sibling=R,$=R,S=C}if(I===y.length)return n(v,S),Ze&&ds(v,I),U;if(S===null){for(;I<y.length;I++)S=f(v,y[I],V),S!==null&&(w=s(S,w,I),$===null?U=S:$.sibling=S,$=S);return Ze&&ds(v,I),U}for(S=r(v,S);I<y.length;I++)C=E(S,v,I,y[I],V),C!==null&&(t&&C.alternate!==null&&S.delete(C.key===null?I:C.key),w=s(C,w,I),$===null?U=C:$.sibling=C,$=C);return t&&S.forEach(function(N){return e(v,N)}),Ze&&ds(v,I),U}function A(v,w,y,V){var U=Ua(y);if(typeof U!="function")throw Error(K(150));if(y=U.call(y),y==null)throw Error(K(151));for(var $=U=null,S=w,I=w=0,C=null,R=y.next();S!==null&&!R.done;I++,R=y.next()){S.index>I?(C=S,S=null):C=S.sibling;var N=m(v,S,R.value,V);if(N===null){S===null&&(S=C);break}t&&S&&N.alternate===null&&e(v,S),w=s(N,w,I),$===null?U=N:$.sibling=N,$=N,S=C}if(R.done)return n(v,S),Ze&&ds(v,I),U;if(S===null){for(;!R.done;I++,R=y.next())R=f(v,R.value,V),R!==null&&(w=s(R,w,I),$===null?U=R:$.sibling=R,$=R);return Ze&&ds(v,I),U}for(S=r(v,S);!R.done;I++,R=y.next())R=E(S,v,I,R.value,V),R!==null&&(t&&R.alternate!==null&&S.delete(R.key===null?I:R.key),w=s(R,w,I),$===null?U=R:$.sibling=R,$=R);return t&&S.forEach(function(D){return e(v,D)}),Ze&&ds(v,I),U}function P(v,w,y,V){if(typeof y=="object"&&y!==null&&y.type===So&&y.key===null&&(y=y.props.children),typeof y=="object"&&y!==null){switch(y.$$typeof){case Qc:e:{for(var U=y.key,$=w;$!==null;){if($.key===U){if(U=y.type,U===So){if($.tag===7){n(v,$.sibling),w=i($,y.props.children),w.return=v,v=w;break e}}else if($.elementType===U||typeof U=="object"&&U!==null&&U.$$typeof===fi&&Qv(U)===$.type){n(v,$.sibling),w=i($,y.props),w.ref=Ha(v,$,y),w.return=v,v=w;break e}n(v,$);break}else e(v,$);$=$.sibling}y.type===So?(w=Cs(y.props.children,v.mode,V,y.key),w.return=v,v=w):(V=Ou(y.type,y.key,y.props,null,v.mode,V),V.ref=Ha(v,w,y),V.return=v,v=V)}return o(v);case xo:e:{for($=y.key;w!==null;){if(w.key===$)if(w.tag===4&&w.stateNode.containerInfo===y.containerInfo&&w.stateNode.implementation===y.implementation){n(v,w.sibling),w=i(w,y.children||[]),w.return=v,v=w;break e}else{n(v,w);break}else e(v,w);w=w.sibling}w=Kf(y,v.mode,V),w.return=v,v=w}return o(v);case fi:return $=y._init,P(v,w,$(y._payload),V)}if(rl(y))return _(v,w,y,V);if(Ua(y))return A(v,w,y,V);ou(v,y)}return typeof y=="string"&&y!==""||typeof y=="number"?(y=""+y,w!==null&&w.tag===6?(n(v,w.sibling),w=i(w,y),w.return=v,v=w):(n(v,w),w=Wf(y,v.mode,V),w.return=v,v=w),o(v)):n(v,w)}return P}var Zo=y0(!0),_0=y0(!1),fd=Yi(null),pd=null,Do=null,Tg=null;function xg(){Tg=Do=pd=null}function Sg(t){var e=fd.current;Ye(fd),t._currentValue=e}function Jp(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function Bo(t,e){pd=t,Tg=Do=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(cn=!0),t.firstContext=null)}function Fn(t){var e=t._currentValue;if(Tg!==t)if(t={context:t,memoizedValue:e,next:null},Do===null){if(pd===null)throw Error(K(308));Do=t,pd.dependencies={lanes:0,firstContext:t}}else Do=Do.next=t;return e}var Is=null;function Ag(t){Is===null?Is=[t]:Is.push(t)}function v0(t,e,n,r){var i=e.interleaved;return i===null?(n.next=n,Ag(e)):(n.next=i.next,i.next=n),e.interleaved=n,Br(t,r)}function Br(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var pi=!1;function Cg(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function w0(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Lr(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function ki(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,Ve&2){var i=r.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),r.pending=e,Br(t,n)}return i=r.interleaved,i===null?(e.next=e,Ag(r)):(e.next=i.next,i.next=e),r.interleaved=e,Br(t,n)}function Ru(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,hg(t,n)}}function Yv(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,s=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};s===null?i=s=o:s=s.next=o,n=n.next}while(n!==null);s===null?i=s=e:s=s.next=e}else i=s=e;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function md(t,e,n,r){var i=t.updateQueue;pi=!1;var s=i.firstBaseUpdate,o=i.lastBaseUpdate,a=i.shared.pending;if(a!==null){i.shared.pending=null;var l=a,u=l.next;l.next=null,o===null?s=u:o.next=u,o=l;var h=t.alternate;h!==null&&(h=h.updateQueue,a=h.lastBaseUpdate,a!==o&&(a===null?h.firstBaseUpdate=u:a.next=u,h.lastBaseUpdate=l))}if(s!==null){var f=i.baseState;o=0,h=u=l=null,a=s;do{var m=a.lane,E=a.eventTime;if((r&m)===m){h!==null&&(h=h.next={eventTime:E,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var _=t,A=a;switch(m=e,E=n,A.tag){case 1:if(_=A.payload,typeof _=="function"){f=_.call(E,f,m);break e}f=_;break e;case 3:_.flags=_.flags&-65537|128;case 0:if(_=A.payload,m=typeof _=="function"?_.call(E,f,m):_,m==null)break e;f=st({},f,m);break e;case 2:pi=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,m=i.effects,m===null?i.effects=[a]:m.push(a))}else E={eventTime:E,lane:m,tag:a.tag,payload:a.payload,callback:a.callback,next:null},h===null?(u=h=E,l=f):h=h.next=E,o|=m;if(a=a.next,a===null){if(a=i.shared.pending,a===null)break;m=a,a=m.next,m.next=null,i.lastBaseUpdate=m,i.shared.pending=null}}while(!0);if(h===null&&(l=f),i.baseState=l,i.firstBaseUpdate=u,i.lastBaseUpdate=h,e=i.shared.interleaved,e!==null){i=e;do o|=i.lane,i=i.next;while(i!==e)}else s===null&&(i.shared.lanes=0);Ls|=o,t.lanes=o,t.memoizedState=f}}function Xv(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(K(191,i));i.call(r)}}}var gc={},vr=Yi(gc),ql=Yi(gc),Hl=Yi(gc);function Ts(t){if(t===gc)throw Error(K(174));return t}function bg(t,e){switch(We(Hl,e),We(ql,t),We(vr,gc),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Np(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Np(e,t)}Ye(vr),We(vr,e)}function ea(){Ye(vr),Ye(ql),Ye(Hl)}function E0(t){Ts(Hl.current);var e=Ts(vr.current),n=Np(e,t.type);e!==n&&(We(ql,t),We(vr,n))}function Rg(t){ql.current===t&&(Ye(vr),Ye(ql))}var nt=Yi(0);function gd(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Uf=[];function Pg(){for(var t=0;t<Uf.length;t++)Uf[t]._workInProgressVersionPrimary=null;Uf.length=0}var Pu=Qr.ReactCurrentDispatcher,Bf=Qr.ReactCurrentBatchConfig,js=0,it=null,Et=null,bt=null,yd=!1,vl=!1,Wl=0,H1=0;function Mt(){throw Error(K(321))}function kg(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!Zn(t[n],e[n]))return!1;return!0}function Ng(t,e,n,r,i,s){if(js=s,it=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Pu.current=t===null||t.memoizedState===null?Q1:Y1,t=n(r,i),vl){s=0;do{if(vl=!1,Wl=0,25<=s)throw Error(K(301));s+=1,bt=Et=null,e.updateQueue=null,Pu.current=X1,t=n(r,i)}while(vl)}if(Pu.current=_d,e=Et!==null&&Et.next!==null,js=0,bt=Et=it=null,yd=!1,e)throw Error(K(300));return t}function Dg(){var t=Wl!==0;return Wl=0,t}function dr(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return bt===null?it.memoizedState=bt=t:bt=bt.next=t,bt}function Un(){if(Et===null){var t=it.alternate;t=t!==null?t.memoizedState:null}else t=Et.next;var e=bt===null?it.memoizedState:bt.next;if(e!==null)bt=e,Et=t;else{if(t===null)throw Error(K(310));Et=t,t={memoizedState:Et.memoizedState,baseState:Et.baseState,baseQueue:Et.baseQueue,queue:Et.queue,next:null},bt===null?it.memoizedState=bt=t:bt=bt.next=t}return bt}function Kl(t,e){return typeof e=="function"?e(t):e}function $f(t){var e=Un(),n=e.queue;if(n===null)throw Error(K(311));n.lastRenderedReducer=t;var r=Et,i=r.baseQueue,s=n.pending;if(s!==null){if(i!==null){var o=i.next;i.next=s.next,s.next=o}r.baseQueue=i=s,n.pending=null}if(i!==null){s=i.next,r=r.baseState;var a=o=null,l=null,u=s;do{var h=u.lane;if((js&h)===h)l!==null&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:t(r,u.action);else{var f={lane:h,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};l===null?(a=l=f,o=r):l=l.next=f,it.lanes|=h,Ls|=h}u=u.next}while(u!==null&&u!==s);l===null?o=r:l.next=a,Zn(r,e.memoizedState)||(cn=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=l,n.lastRenderedState=r}if(t=n.interleaved,t!==null){i=t;do s=i.lane,it.lanes|=s,Ls|=s,i=i.next;while(i!==t)}else i===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function zf(t){var e=Un(),n=e.queue;if(n===null)throw Error(K(311));n.lastRenderedReducer=t;var r=n.dispatch,i=n.pending,s=e.memoizedState;if(i!==null){n.pending=null;var o=i=i.next;do s=t(s,o.action),o=o.next;while(o!==i);Zn(s,e.memoizedState)||(cn=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),n.lastRenderedState=s}return[s,r]}function I0(){}function T0(t,e){var n=it,r=Un(),i=e(),s=!Zn(r.memoizedState,i);if(s&&(r.memoizedState=i,cn=!0),r=r.queue,Vg(A0.bind(null,n,r,t),[t]),r.getSnapshot!==e||s||bt!==null&&bt.memoizedState.tag&1){if(n.flags|=2048,Gl(9,S0.bind(null,n,r,i,e),void 0,null),Rt===null)throw Error(K(349));js&30||x0(n,e,i)}return i}function x0(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=it.updateQueue,e===null?(e={lastEffect:null,stores:null},it.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function S0(t,e,n,r){e.value=n,e.getSnapshot=r,C0(e)&&b0(t)}function A0(t,e,n){return n(function(){C0(e)&&b0(t)})}function C0(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!Zn(t,n)}catch{return!0}}function b0(t){var e=Br(t,1);e!==null&&Xn(e,t,1,-1)}function Jv(t){var e=dr();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Kl,lastRenderedState:t},e.queue=t,t=t.dispatch=G1.bind(null,it,t),[e.memoizedState,t]}function Gl(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=it.updateQueue,e===null?(e={lastEffect:null,stores:null},it.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function R0(){return Un().memoizedState}function ku(t,e,n,r){var i=dr();it.flags|=t,i.memoizedState=Gl(1|e,n,void 0,r===void 0?null:r)}function uh(t,e,n,r){var i=Un();r=r===void 0?null:r;var s=void 0;if(Et!==null){var o=Et.memoizedState;if(s=o.destroy,r!==null&&kg(r,o.deps)){i.memoizedState=Gl(e,n,s,r);return}}it.flags|=t,i.memoizedState=Gl(1|e,n,s,r)}function Zv(t,e){return ku(8390656,8,t,e)}function Vg(t,e){return uh(2048,8,t,e)}function P0(t,e){return uh(4,2,t,e)}function k0(t,e){return uh(4,4,t,e)}function N0(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function D0(t,e,n){return n=n!=null?n.concat([t]):null,uh(4,4,N0.bind(null,e,t),n)}function Og(){}function V0(t,e){var n=Un();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&kg(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function O0(t,e){var n=Un();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&kg(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function j0(t,e,n){return js&21?(Zn(n,e)||(n=BT(),it.lanes|=n,Ls|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,cn=!0),t.memoizedState=n)}function W1(t,e){var n=Fe;Fe=n!==0&&4>n?n:4,t(!0);var r=Bf.transition;Bf.transition={};try{t(!1),e()}finally{Fe=n,Bf.transition=r}}function L0(){return Un().memoizedState}function K1(t,e,n){var r=Di(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},M0(t))F0(e,n);else if(n=v0(t,e,n,r),n!==null){var i=en();Xn(n,t,r,i),U0(n,e,r)}}function G1(t,e,n){var r=Di(t),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(M0(t))F0(e,i);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var o=e.lastRenderedState,a=s(o,n);if(i.hasEagerState=!0,i.eagerState=a,Zn(a,o)){var l=e.interleaved;l===null?(i.next=i,Ag(e)):(i.next=l.next,l.next=i),e.interleaved=i;return}}catch{}finally{}n=v0(t,e,i,r),n!==null&&(i=en(),Xn(n,t,r,i),U0(n,e,r))}}function M0(t){var e=t.alternate;return t===it||e!==null&&e===it}function F0(t,e){vl=yd=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function U0(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,hg(t,n)}}var _d={readContext:Fn,useCallback:Mt,useContext:Mt,useEffect:Mt,useImperativeHandle:Mt,useInsertionEffect:Mt,useLayoutEffect:Mt,useMemo:Mt,useReducer:Mt,useRef:Mt,useState:Mt,useDebugValue:Mt,useDeferredValue:Mt,useTransition:Mt,useMutableSource:Mt,useSyncExternalStore:Mt,useId:Mt,unstable_isNewReconciler:!1},Q1={readContext:Fn,useCallback:function(t,e){return dr().memoizedState=[t,e===void 0?null:e],t},useContext:Fn,useEffect:Zv,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,ku(4194308,4,N0.bind(null,e,t),n)},useLayoutEffect:function(t,e){return ku(4194308,4,t,e)},useInsertionEffect:function(t,e){return ku(4,2,t,e)},useMemo:function(t,e){var n=dr();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=dr();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=K1.bind(null,it,t),[r.memoizedState,t]},useRef:function(t){var e=dr();return t={current:t},e.memoizedState=t},useState:Jv,useDebugValue:Og,useDeferredValue:function(t){return dr().memoizedState=t},useTransition:function(){var t=Jv(!1),e=t[0];return t=W1.bind(null,t[1]),dr().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=it,i=dr();if(Ze){if(n===void 0)throw Error(K(407));n=n()}else{if(n=e(),Rt===null)throw Error(K(349));js&30||x0(r,e,n)}i.memoizedState=n;var s={value:n,getSnapshot:e};return i.queue=s,Zv(A0.bind(null,r,s,t),[t]),r.flags|=2048,Gl(9,S0.bind(null,r,s,n,e),void 0,null),n},useId:function(){var t=dr(),e=Rt.identifierPrefix;if(Ze){var n=Dr,r=Nr;n=(r&~(1<<32-Yn(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=Wl++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=H1++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},Y1={readContext:Fn,useCallback:V0,useContext:Fn,useEffect:Vg,useImperativeHandle:D0,useInsertionEffect:P0,useLayoutEffect:k0,useMemo:O0,useReducer:$f,useRef:R0,useState:function(){return $f(Kl)},useDebugValue:Og,useDeferredValue:function(t){var e=Un();return j0(e,Et.memoizedState,t)},useTransition:function(){var t=$f(Kl)[0],e=Un().memoizedState;return[t,e]},useMutableSource:I0,useSyncExternalStore:T0,useId:L0,unstable_isNewReconciler:!1},X1={readContext:Fn,useCallback:V0,useContext:Fn,useEffect:Vg,useImperativeHandle:D0,useInsertionEffect:P0,useLayoutEffect:k0,useMemo:O0,useReducer:zf,useRef:R0,useState:function(){return zf(Kl)},useDebugValue:Og,useDeferredValue:function(t){var e=Un();return Et===null?e.memoizedState=t:j0(e,Et.memoizedState,t)},useTransition:function(){var t=zf(Kl)[0],e=Un().memoizedState;return[t,e]},useMutableSource:I0,useSyncExternalStore:T0,useId:L0,unstable_isNewReconciler:!1};function Hn(t,e){if(t&&t.defaultProps){e=st({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function Zp(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:st({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var dh={isMounted:function(t){return(t=t._reactInternals)?eo(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=en(),i=Di(t),s=Lr(r,i);s.payload=e,n!=null&&(s.callback=n),e=ki(t,s,i),e!==null&&(Xn(e,t,i,r),Ru(e,t,i))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=en(),i=Di(t),s=Lr(r,i);s.tag=1,s.payload=e,n!=null&&(s.callback=n),e=ki(t,s,i),e!==null&&(Xn(e,t,i,r),Ru(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=en(),r=Di(t),i=Lr(n,r);i.tag=2,e!=null&&(i.callback=e),e=ki(t,i,r),e!==null&&(Xn(e,t,r,n),Ru(e,t,r))}};function ew(t,e,n,r,i,s,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,s,o):e.prototype&&e.prototype.isPureReactComponent?!Ul(n,r)||!Ul(i,s):!0}function B0(t,e,n){var r=!1,i=zi,s=e.contextType;return typeof s=="object"&&s!==null?s=Fn(s):(i=hn(e)?Vs:Kt.current,r=e.contextTypes,s=(r=r!=null)?Xo(t,i):zi),e=new e(n,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=dh,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=s),e}function tw(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&dh.enqueueReplaceState(e,e.state,null)}function em(t,e,n,r){var i=t.stateNode;i.props=n,i.state=t.memoizedState,i.refs={},Cg(t);var s=e.contextType;typeof s=="object"&&s!==null?i.context=Fn(s):(s=hn(e)?Vs:Kt.current,i.context=Xo(t,s)),i.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(Zp(t,e,s,n),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&dh.enqueueReplaceState(i,i.state,null),md(t,n,i,r),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function ta(t,e){try{var n="",r=e;do n+=SR(r),r=r.return;while(r);var i=n}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:i,digest:null}}function qf(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function tm(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var J1=typeof WeakMap=="function"?WeakMap:Map;function $0(t,e,n){n=Lr(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){wd||(wd=!0,dm=r),tm(t,e)},n}function z0(t,e,n){n=Lr(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var i=e.value;n.payload=function(){return r(i)},n.callback=function(){tm(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(n.callback=function(){tm(t,e),typeof r!="function"&&(Ni===null?Ni=new Set([this]):Ni.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function nw(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new J1;var i=new Set;r.set(e,i)}else i=r.get(e),i===void 0&&(i=new Set,r.set(e,i));i.has(n)||(i.add(n),t=hP.bind(null,t,e,n),e.then(t,t))}function rw(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function iw(t,e,n,r,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=Lr(-1,1),e.tag=2,ki(n,e,1))),n.lanes|=1),t)}var Z1=Qr.ReactCurrentOwner,cn=!1;function Yt(t,e,n,r){e.child=t===null?_0(e,null,n,r):Zo(e,t.child,n,r)}function sw(t,e,n,r,i){n=n.render;var s=e.ref;return Bo(e,i),r=Ng(t,e,n,r,s,i),n=Dg(),t!==null&&!cn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,$r(t,e,i)):(Ze&&n&&wg(e),e.flags|=1,Yt(t,e,r,i),e.child)}function ow(t,e,n,r,i){if(t===null){var s=n.type;return typeof s=="function"&&!zg(s)&&s.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=s,q0(t,e,s,r,i)):(t=Ou(n.type,null,r,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&i)){var o=s.memoizedProps;if(n=n.compare,n=n!==null?n:Ul,n(o,r)&&t.ref===e.ref)return $r(t,e,i)}return e.flags|=1,t=Vi(s,r),t.ref=e.ref,t.return=e,e.child=t}function q0(t,e,n,r,i){if(t!==null){var s=t.memoizedProps;if(Ul(s,r)&&t.ref===e.ref)if(cn=!1,e.pendingProps=r=s,(t.lanes&i)!==0)t.flags&131072&&(cn=!0);else return e.lanes=t.lanes,$r(t,e,i)}return nm(t,e,n,r,i)}function H0(t,e,n){var r=e.pendingProps,i=r.children,s=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},We(Oo,vn),vn|=n;else{if(!(n&1073741824))return t=s!==null?s.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,We(Oo,vn),vn|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=s!==null?s.baseLanes:n,We(Oo,vn),vn|=r}else s!==null?(r=s.baseLanes|n,e.memoizedState=null):r=n,We(Oo,vn),vn|=r;return Yt(t,e,i,n),e.child}function W0(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function nm(t,e,n,r,i){var s=hn(n)?Vs:Kt.current;return s=Xo(e,s),Bo(e,i),n=Ng(t,e,n,r,s,i),r=Dg(),t!==null&&!cn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,$r(t,e,i)):(Ze&&r&&wg(e),e.flags|=1,Yt(t,e,n,i),e.child)}function aw(t,e,n,r,i){if(hn(n)){var s=!0;ud(e)}else s=!1;if(Bo(e,i),e.stateNode===null)Nu(t,e),B0(e,n,r),em(e,n,r,i),r=!0;else if(t===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var l=o.context,u=n.contextType;typeof u=="object"&&u!==null?u=Fn(u):(u=hn(n)?Vs:Kt.current,u=Xo(e,u));var h=n.getDerivedStateFromProps,f=typeof h=="function"||typeof o.getSnapshotBeforeUpdate=="function";f||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==r||l!==u)&&tw(e,o,r,u),pi=!1;var m=e.memoizedState;o.state=m,md(e,r,o,i),l=e.memoizedState,a!==r||m!==l||dn.current||pi?(typeof h=="function"&&(Zp(e,n,h,r),l=e.memoizedState),(a=pi||ew(e,n,a,r,m,l,u))?(f||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=l),o.props=r,o.state=l,o.context=u,r=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,w0(t,e),a=e.memoizedProps,u=e.type===e.elementType?a:Hn(e.type,a),o.props=u,f=e.pendingProps,m=o.context,l=n.contextType,typeof l=="object"&&l!==null?l=Fn(l):(l=hn(n)?Vs:Kt.current,l=Xo(e,l));var E=n.getDerivedStateFromProps;(h=typeof E=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==f||m!==l)&&tw(e,o,r,l),pi=!1,m=e.memoizedState,o.state=m,md(e,r,o,i);var _=e.memoizedState;a!==f||m!==_||dn.current||pi?(typeof E=="function"&&(Zp(e,n,E,r),_=e.memoizedState),(u=pi||ew(e,n,u,r,m,_,l)||!1)?(h||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,_,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,_,l)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&m===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&m===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=_),o.props=r,o.state=_,o.context=l,r=u):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&m===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&m===t.memoizedState||(e.flags|=1024),r=!1)}return rm(t,e,n,r,s,i)}function rm(t,e,n,r,i,s){W0(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return i&&Wv(e,n,!1),$r(t,e,s);r=e.stateNode,Z1.current=e;var a=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=Zo(e,t.child,null,s),e.child=Zo(e,null,a,s)):Yt(t,e,a,s),e.memoizedState=r.state,i&&Wv(e,n,!0),e.child}function K0(t){var e=t.stateNode;e.pendingContext?Hv(t,e.pendingContext,e.pendingContext!==e.context):e.context&&Hv(t,e.context,!1),bg(t,e.containerInfo)}function lw(t,e,n,r,i){return Jo(),Ig(i),e.flags|=256,Yt(t,e,n,r),e.child}var im={dehydrated:null,treeContext:null,retryLane:0};function sm(t){return{baseLanes:t,cachePool:null,transitions:null}}function G0(t,e,n){var r=e.pendingProps,i=nt.current,s=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=t!==null&&t.memoizedState===null?!1:(i&2)!==0),a?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),We(nt,i&1),t===null)return Xp(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,s?(r=e.mode,s=e.child,o={mode:"hidden",children:o},!(r&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=ph(o,r,0,null),t=Cs(t,r,n,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=sm(n),e.memoizedState=im,t):jg(e,o));if(i=t.memoizedState,i!==null&&(a=i.dehydrated,a!==null))return eP(t,e,o,r,a,i,n);if(s){s=r.fallback,o=e.mode,i=t.child,a=i.sibling;var l={mode:"hidden",children:r.children};return!(o&1)&&e.child!==i?(r=e.child,r.childLanes=0,r.pendingProps=l,e.deletions=null):(r=Vi(i,l),r.subtreeFlags=i.subtreeFlags&14680064),a!==null?s=Vi(a,s):(s=Cs(s,o,n,null),s.flags|=2),s.return=e,r.return=e,r.sibling=s,e.child=r,r=s,s=e.child,o=t.child.memoizedState,o=o===null?sm(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=t.childLanes&~n,e.memoizedState=im,r}return s=t.child,t=s.sibling,r=Vi(s,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function jg(t,e){return e=ph({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function au(t,e,n,r){return r!==null&&Ig(r),Zo(e,t.child,null,n),t=jg(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function eP(t,e,n,r,i,s,o){if(n)return e.flags&256?(e.flags&=-257,r=qf(Error(K(422))),au(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=r.fallback,i=e.mode,r=ph({mode:"visible",children:r.children},i,0,null),s=Cs(s,i,o,null),s.flags|=2,r.return=e,s.return=e,r.sibling=s,e.child=r,e.mode&1&&Zo(e,t.child,null,o),e.child.memoizedState=sm(o),e.memoizedState=im,s);if(!(e.mode&1))return au(t,e,o,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var a=r.dgst;return r=a,s=Error(K(419)),r=qf(s,r,void 0),au(t,e,o,r)}if(a=(o&t.childLanes)!==0,cn||a){if(r=Rt,r!==null){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|o)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,Br(t,i),Xn(r,t,i,-1))}return $g(),r=qf(Error(K(421))),au(t,e,o,r)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=fP.bind(null,t),i._reactRetry=e,null):(t=s.treeContext,In=Pi(i.nextSibling),xn=e,Ze=!0,Gn=null,t!==null&&(kn[Nn++]=Nr,kn[Nn++]=Dr,kn[Nn++]=Os,Nr=t.id,Dr=t.overflow,Os=e),e=jg(e,r.children),e.flags|=4096,e)}function cw(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),Jp(t.return,e,n)}function Hf(t,e,n,r,i){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailMode=i)}function Q0(t,e,n){var r=e.pendingProps,i=r.revealOrder,s=r.tail;if(Yt(t,e,r.children,n),r=nt.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&cw(t,n,e);else if(t.tag===19)cw(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(We(nt,r),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(n=e.child,i=null;n!==null;)t=n.alternate,t!==null&&gd(t)===null&&(i=n),n=n.sibling;n=i,n===null?(i=e.child,e.child=null):(i=n.sibling,n.sibling=null),Hf(e,!1,i,n,s);break;case"backwards":for(n=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&gd(t)===null){e.child=i;break}t=i.sibling,i.sibling=n,n=i,i=t}Hf(e,!0,n,null,s);break;case"together":Hf(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Nu(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function $r(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),Ls|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(K(153));if(e.child!==null){for(t=e.child,n=Vi(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Vi(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function tP(t,e,n){switch(e.tag){case 3:K0(e),Jo();break;case 5:E0(e);break;case 1:hn(e.type)&&ud(e);break;case 4:bg(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;We(fd,r._currentValue),r._currentValue=i;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(We(nt,nt.current&1),e.flags|=128,null):n&e.child.childLanes?G0(t,e,n):(We(nt,nt.current&1),t=$r(t,e,n),t!==null?t.sibling:null);We(nt,nt.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return Q0(t,e,n);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),We(nt,nt.current),r)break;return null;case 22:case 23:return e.lanes=0,H0(t,e,n)}return $r(t,e,n)}var Y0,om,X0,J0;Y0=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};om=function(){};X0=function(t,e,n,r){var i=t.memoizedProps;if(i!==r){t=e.stateNode,Ts(vr.current);var s=null;switch(n){case"input":i=bp(t,i),r=bp(t,r),s=[];break;case"select":i=st({},i,{value:void 0}),r=st({},r,{value:void 0}),s=[];break;case"textarea":i=kp(t,i),r=kp(t,r),s=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=ld)}Dp(n,r);var o;n=null;for(u in i)if(!r.hasOwnProperty(u)&&i.hasOwnProperty(u)&&i[u]!=null)if(u==="style"){var a=i[u];for(o in a)a.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(Dl.hasOwnProperty(u)?s||(s=[]):(s=s||[]).push(u,null));for(u in r){var l=r[u];if(a=i!=null?i[u]:void 0,r.hasOwnProperty(u)&&l!==a&&(l!=null||a!=null))if(u==="style")if(a){for(o in a)!a.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in l)l.hasOwnProperty(o)&&a[o]!==l[o]&&(n||(n={}),n[o]=l[o])}else n||(s||(s=[]),s.push(u,n)),n=l;else u==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(s=s||[]).push(u,l)):u==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(u,""+l):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(Dl.hasOwnProperty(u)?(l!=null&&u==="onScroll"&&Qe("scroll",t),s||a===l||(s=[])):(s=s||[]).push(u,l))}n&&(s=s||[]).push("style",n);var u=s;(e.updateQueue=u)&&(e.flags|=4)}};J0=function(t,e,n,r){n!==r&&(e.flags|=4)};function Wa(t,e){if(!Ze)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function Ft(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function nP(t,e,n){var r=e.pendingProps;switch(Eg(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ft(e),null;case 1:return hn(e.type)&&cd(),Ft(e),null;case 3:return r=e.stateNode,ea(),Ye(dn),Ye(Kt),Pg(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(su(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Gn!==null&&(pm(Gn),Gn=null))),om(t,e),Ft(e),null;case 5:Rg(e);var i=Ts(Hl.current);if(n=e.type,t!==null&&e.stateNode!=null)X0(t,e,n,r,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(K(166));return Ft(e),null}if(t=Ts(vr.current),su(e)){r=e.stateNode,n=e.type;var s=e.memoizedProps;switch(r[fr]=e,r[zl]=s,t=(e.mode&1)!==0,n){case"dialog":Qe("cancel",r),Qe("close",r);break;case"iframe":case"object":case"embed":Qe("load",r);break;case"video":case"audio":for(i=0;i<sl.length;i++)Qe(sl[i],r);break;case"source":Qe("error",r);break;case"img":case"image":case"link":Qe("error",r),Qe("load",r);break;case"details":Qe("toggle",r);break;case"input":_v(r,s),Qe("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},Qe("invalid",r);break;case"textarea":wv(r,s),Qe("invalid",r)}Dp(n,s),i=null;for(var o in s)if(s.hasOwnProperty(o)){var a=s[o];o==="children"?typeof a=="string"?r.textContent!==a&&(s.suppressHydrationWarning!==!0&&iu(r.textContent,a,t),i=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(s.suppressHydrationWarning!==!0&&iu(r.textContent,a,t),i=["children",""+a]):Dl.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&Qe("scroll",r)}switch(n){case"input":Yc(r),vv(r,s,!0);break;case"textarea":Yc(r),Ev(r);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(r.onclick=ld)}r=i,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=AT(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[fr]=e,t[zl]=r,Y0(t,e,!1,!1),e.stateNode=t;e:{switch(o=Vp(n,r),n){case"dialog":Qe("cancel",t),Qe("close",t),i=r;break;case"iframe":case"object":case"embed":Qe("load",t),i=r;break;case"video":case"audio":for(i=0;i<sl.length;i++)Qe(sl[i],t);i=r;break;case"source":Qe("error",t),i=r;break;case"img":case"image":case"link":Qe("error",t),Qe("load",t),i=r;break;case"details":Qe("toggle",t),i=r;break;case"input":_v(t,r),i=bp(t,r),Qe("invalid",t);break;case"option":i=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},i=st({},r,{value:void 0}),Qe("invalid",t);break;case"textarea":wv(t,r),i=kp(t,r),Qe("invalid",t);break;default:i=r}Dp(n,i),a=i;for(s in a)if(a.hasOwnProperty(s)){var l=a[s];s==="style"?RT(t,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&CT(t,l)):s==="children"?typeof l=="string"?(n!=="textarea"||l!=="")&&Vl(t,l):typeof l=="number"&&Vl(t,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(Dl.hasOwnProperty(s)?l!=null&&s==="onScroll"&&Qe("scroll",t):l!=null&&og(t,s,l,o))}switch(n){case"input":Yc(t),vv(t,r,!1);break;case"textarea":Yc(t),Ev(t);break;case"option":r.value!=null&&t.setAttribute("value",""+$i(r.value));break;case"select":t.multiple=!!r.multiple,s=r.value,s!=null?Lo(t,!!r.multiple,s,!1):r.defaultValue!=null&&Lo(t,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=ld)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Ft(e),null;case 6:if(t&&e.stateNode!=null)J0(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(K(166));if(n=Ts(Hl.current),Ts(vr.current),su(e)){if(r=e.stateNode,n=e.memoizedProps,r[fr]=e,(s=r.nodeValue!==n)&&(t=xn,t!==null))switch(t.tag){case 3:iu(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&iu(r.nodeValue,n,(t.mode&1)!==0)}s&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[fr]=e,e.stateNode=r}return Ft(e),null;case 13:if(Ye(nt),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Ze&&In!==null&&e.mode&1&&!(e.flags&128))g0(),Jo(),e.flags|=98560,s=!1;else if(s=su(e),r!==null&&r.dehydrated!==null){if(t===null){if(!s)throw Error(K(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(K(317));s[fr]=e}else Jo(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Ft(e),s=!1}else Gn!==null&&(pm(Gn),Gn=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||nt.current&1?Tt===0&&(Tt=3):$g())),e.updateQueue!==null&&(e.flags|=4),Ft(e),null);case 4:return ea(),om(t,e),t===null&&Bl(e.stateNode.containerInfo),Ft(e),null;case 10:return Sg(e.type._context),Ft(e),null;case 17:return hn(e.type)&&cd(),Ft(e),null;case 19:if(Ye(nt),s=e.memoizedState,s===null)return Ft(e),null;if(r=(e.flags&128)!==0,o=s.rendering,o===null)if(r)Wa(s,!1);else{if(Tt!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=gd(t),o!==null){for(e.flags|=128,Wa(s,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)s=n,t=r,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,t=o.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return We(nt,nt.current&1|2),e.child}t=t.sibling}s.tail!==null&&ft()>na&&(e.flags|=128,r=!0,Wa(s,!1),e.lanes=4194304)}else{if(!r)if(t=gd(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Wa(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!Ze)return Ft(e),null}else 2*ft()-s.renderingStartTime>na&&n!==1073741824&&(e.flags|=128,r=!0,Wa(s,!1),e.lanes=4194304);s.isBackwards?(o.sibling=e.child,e.child=o):(n=s.last,n!==null?n.sibling=o:e.child=o,s.last=o)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=ft(),e.sibling=null,n=nt.current,We(nt,r?n&1|2:n&1),e):(Ft(e),null);case 22:case 23:return Bg(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?vn&1073741824&&(Ft(e),e.subtreeFlags&6&&(e.flags|=8192)):Ft(e),null;case 24:return null;case 25:return null}throw Error(K(156,e.tag))}function rP(t,e){switch(Eg(e),e.tag){case 1:return hn(e.type)&&cd(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return ea(),Ye(dn),Ye(Kt),Pg(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return Rg(e),null;case 13:if(Ye(nt),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(K(340));Jo()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Ye(nt),null;case 4:return ea(),null;case 10:return Sg(e.type._context),null;case 22:case 23:return Bg(),null;case 24:return null;default:return null}}var lu=!1,$t=!1,iP=typeof WeakSet=="function"?WeakSet:Set,ie=null;function Vo(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){at(t,e,r)}else n.current=null}function am(t,e,n){try{n()}catch(r){at(t,e,r)}}var uw=!1;function sP(t,e){if(qp=sd,t=r0(),vg(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{n.nodeType,s.nodeType}catch{n=null;break e}var o=0,a=-1,l=-1,u=0,h=0,f=t,m=null;t:for(;;){for(var E;f!==n||i!==0&&f.nodeType!==3||(a=o+i),f!==s||r!==0&&f.nodeType!==3||(l=o+r),f.nodeType===3&&(o+=f.nodeValue.length),(E=f.firstChild)!==null;)m=f,f=E;for(;;){if(f===t)break t;if(m===n&&++u===i&&(a=o),m===s&&++h===r&&(l=o),(E=f.nextSibling)!==null)break;f=m,m=f.parentNode}f=E}n=a===-1||l===-1?null:{start:a,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(Hp={focusedElem:t,selectionRange:n},sd=!1,ie=e;ie!==null;)if(e=ie,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,ie=t;else for(;ie!==null;){e=ie;try{var _=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(_!==null){var A=_.memoizedProps,P=_.memoizedState,v=e.stateNode,w=v.getSnapshotBeforeUpdate(e.elementType===e.type?A:Hn(e.type,A),P);v.__reactInternalSnapshotBeforeUpdate=w}break;case 3:var y=e.stateNode.containerInfo;y.nodeType===1?y.textContent="":y.nodeType===9&&y.documentElement&&y.removeChild(y.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(K(163))}}catch(V){at(e,e.return,V)}if(t=e.sibling,t!==null){t.return=e.return,ie=t;break}ie=e.return}return _=uw,uw=!1,_}function wl(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&t)===t){var s=i.destroy;i.destroy=void 0,s!==void 0&&am(e,n,s)}i=i.next}while(i!==r)}}function hh(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function lm(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function Z0(t){var e=t.alternate;e!==null&&(t.alternate=null,Z0(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[fr],delete e[zl],delete e[Gp],delete e[B1],delete e[$1])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function ex(t){return t.tag===5||t.tag===3||t.tag===4}function dw(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||ex(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function cm(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=ld));else if(r!==4&&(t=t.child,t!==null))for(cm(t,e,n),t=t.sibling;t!==null;)cm(t,e,n),t=t.sibling}function um(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(um(t,e,n),t=t.sibling;t!==null;)um(t,e,n),t=t.sibling}var kt=null,Wn=!1;function ai(t,e,n){for(n=n.child;n!==null;)tx(t,e,n),n=n.sibling}function tx(t,e,n){if(_r&&typeof _r.onCommitFiberUnmount=="function")try{_r.onCommitFiberUnmount(ih,n)}catch{}switch(n.tag){case 5:$t||Vo(n,e);case 6:var r=kt,i=Wn;kt=null,ai(t,e,n),kt=r,Wn=i,kt!==null&&(Wn?(t=kt,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):kt.removeChild(n.stateNode));break;case 18:kt!==null&&(Wn?(t=kt,n=n.stateNode,t.nodeType===8?Mf(t.parentNode,n):t.nodeType===1&&Mf(t,n),Ml(t)):Mf(kt,n.stateNode));break;case 4:r=kt,i=Wn,kt=n.stateNode.containerInfo,Wn=!0,ai(t,e,n),kt=r,Wn=i;break;case 0:case 11:case 14:case 15:if(!$t&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var s=i,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&am(n,e,o),i=i.next}while(i!==r)}ai(t,e,n);break;case 1:if(!$t&&(Vo(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(a){at(n,e,a)}ai(t,e,n);break;case 21:ai(t,e,n);break;case 22:n.mode&1?($t=(r=$t)||n.memoizedState!==null,ai(t,e,n),$t=r):ai(t,e,n);break;default:ai(t,e,n)}}function hw(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new iP),e.forEach(function(r){var i=pP.bind(null,t,r);n.has(r)||(n.add(r),r.then(i,i))})}}function qn(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var s=t,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:kt=a.stateNode,Wn=!1;break e;case 3:kt=a.stateNode.containerInfo,Wn=!0;break e;case 4:kt=a.stateNode.containerInfo,Wn=!0;break e}a=a.return}if(kt===null)throw Error(K(160));tx(s,o,i),kt=null,Wn=!1;var l=i.alternate;l!==null&&(l.return=null),i.return=null}catch(u){at(i,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)nx(e,t),e=e.sibling}function nx(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(qn(e,t),cr(t),r&4){try{wl(3,t,t.return),hh(3,t)}catch(A){at(t,t.return,A)}try{wl(5,t,t.return)}catch(A){at(t,t.return,A)}}break;case 1:qn(e,t),cr(t),r&512&&n!==null&&Vo(n,n.return);break;case 5:if(qn(e,t),cr(t),r&512&&n!==null&&Vo(n,n.return),t.flags&32){var i=t.stateNode;try{Vl(i,"")}catch(A){at(t,t.return,A)}}if(r&4&&(i=t.stateNode,i!=null)){var s=t.memoizedProps,o=n!==null?n.memoizedProps:s,a=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{a==="input"&&s.type==="radio"&&s.name!=null&&xT(i,s),Vp(a,o);var u=Vp(a,s);for(o=0;o<l.length;o+=2){var h=l[o],f=l[o+1];h==="style"?RT(i,f):h==="dangerouslySetInnerHTML"?CT(i,f):h==="children"?Vl(i,f):og(i,h,f,u)}switch(a){case"input":Rp(i,s);break;case"textarea":ST(i,s);break;case"select":var m=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var E=s.value;E!=null?Lo(i,!!s.multiple,E,!1):m!==!!s.multiple&&(s.defaultValue!=null?Lo(i,!!s.multiple,s.defaultValue,!0):Lo(i,!!s.multiple,s.multiple?[]:"",!1))}i[zl]=s}catch(A){at(t,t.return,A)}}break;case 6:if(qn(e,t),cr(t),r&4){if(t.stateNode===null)throw Error(K(162));i=t.stateNode,s=t.memoizedProps;try{i.nodeValue=s}catch(A){at(t,t.return,A)}}break;case 3:if(qn(e,t),cr(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Ml(e.containerInfo)}catch(A){at(t,t.return,A)}break;case 4:qn(e,t),cr(t);break;case 13:qn(e,t),cr(t),i=t.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(Fg=ft())),r&4&&hw(t);break;case 22:if(h=n!==null&&n.memoizedState!==null,t.mode&1?($t=(u=$t)||h,qn(e,t),$t=u):qn(e,t),cr(t),r&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!h&&t.mode&1)for(ie=t,h=t.child;h!==null;){for(f=ie=h;ie!==null;){switch(m=ie,E=m.child,m.tag){case 0:case 11:case 14:case 15:wl(4,m,m.return);break;case 1:Vo(m,m.return);var _=m.stateNode;if(typeof _.componentWillUnmount=="function"){r=m,n=m.return;try{e=r,_.props=e.memoizedProps,_.state=e.memoizedState,_.componentWillUnmount()}catch(A){at(r,n,A)}}break;case 5:Vo(m,m.return);break;case 22:if(m.memoizedState!==null){pw(f);continue}}E!==null?(E.return=m,ie=E):pw(f)}h=h.sibling}e:for(h=null,f=t;;){if(f.tag===5){if(h===null){h=f;try{i=f.stateNode,u?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(a=f.stateNode,l=f.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=bT("display",o))}catch(A){at(t,t.return,A)}}}else if(f.tag===6){if(h===null)try{f.stateNode.nodeValue=u?"":f.memoizedProps}catch(A){at(t,t.return,A)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===t)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===t)break e;for(;f.sibling===null;){if(f.return===null||f.return===t)break e;h===f&&(h=null),f=f.return}h===f&&(h=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:qn(e,t),cr(t),r&4&&hw(t);break;case 21:break;default:qn(e,t),cr(t)}}function cr(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(ex(n)){var r=n;break e}n=n.return}throw Error(K(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(Vl(i,""),r.flags&=-33);var s=dw(t);um(t,s,i);break;case 3:case 4:var o=r.stateNode.containerInfo,a=dw(t);cm(t,a,o);break;default:throw Error(K(161))}}catch(l){at(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function oP(t,e,n){ie=t,rx(t)}function rx(t,e,n){for(var r=(t.mode&1)!==0;ie!==null;){var i=ie,s=i.child;if(i.tag===22&&r){var o=i.memoizedState!==null||lu;if(!o){var a=i.alternate,l=a!==null&&a.memoizedState!==null||$t;a=lu;var u=$t;if(lu=o,($t=l)&&!u)for(ie=i;ie!==null;)o=ie,l=o.child,o.tag===22&&o.memoizedState!==null?mw(i):l!==null?(l.return=o,ie=l):mw(i);for(;s!==null;)ie=s,rx(s),s=s.sibling;ie=i,lu=a,$t=u}fw(t)}else i.subtreeFlags&8772&&s!==null?(s.return=i,ie=s):fw(t)}}function fw(t){for(;ie!==null;){var e=ie;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:$t||hh(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!$t)if(n===null)r.componentDidMount();else{var i=e.elementType===e.type?n.memoizedProps:Hn(e.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&Xv(e,s,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}Xv(e,o,n)}break;case 5:var a=e.stateNode;if(n===null&&e.flags&4){n=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var h=u.memoizedState;if(h!==null){var f=h.dehydrated;f!==null&&Ml(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(K(163))}$t||e.flags&512&&lm(e)}catch(m){at(e,e.return,m)}}if(e===t){ie=null;break}if(n=e.sibling,n!==null){n.return=e.return,ie=n;break}ie=e.return}}function pw(t){for(;ie!==null;){var e=ie;if(e===t){ie=null;break}var n=e.sibling;if(n!==null){n.return=e.return,ie=n;break}ie=e.return}}function mw(t){for(;ie!==null;){var e=ie;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{hh(4,e)}catch(l){at(e,n,l)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var i=e.return;try{r.componentDidMount()}catch(l){at(e,i,l)}}var s=e.return;try{lm(e)}catch(l){at(e,s,l)}break;case 5:var o=e.return;try{lm(e)}catch(l){at(e,o,l)}}}catch(l){at(e,e.return,l)}if(e===t){ie=null;break}var a=e.sibling;if(a!==null){a.return=e.return,ie=a;break}ie=e.return}}var aP=Math.ceil,vd=Qr.ReactCurrentDispatcher,Lg=Qr.ReactCurrentOwner,Ln=Qr.ReactCurrentBatchConfig,Ve=0,Rt=null,gt=null,Vt=0,vn=0,Oo=Yi(0),Tt=0,Ql=null,Ls=0,fh=0,Mg=0,El=null,ln=null,Fg=0,na=1/0,Rr=null,wd=!1,dm=null,Ni=null,cu=!1,Si=null,Ed=0,Il=0,hm=null,Du=-1,Vu=0;function en(){return Ve&6?ft():Du!==-1?Du:Du=ft()}function Di(t){return t.mode&1?Ve&2&&Vt!==0?Vt&-Vt:q1.transition!==null?(Vu===0&&(Vu=BT()),Vu):(t=Fe,t!==0||(t=window.event,t=t===void 0?16:GT(t.type)),t):1}function Xn(t,e,n,r){if(50<Il)throw Il=0,hm=null,Error(K(185));fc(t,n,r),(!(Ve&2)||t!==Rt)&&(t===Rt&&(!(Ve&2)&&(fh|=n),Tt===4&&gi(t,Vt)),fn(t,r),n===1&&Ve===0&&!(e.mode&1)&&(na=ft()+500,ch&&Xi()))}function fn(t,e){var n=t.callbackNode;qR(t,e);var r=id(t,t===Rt?Vt:0);if(r===0)n!==null&&xv(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&xv(n),e===1)t.tag===0?z1(gw.bind(null,t)):f0(gw.bind(null,t)),F1(function(){!(Ve&6)&&Xi()}),n=null;else{switch($T(r)){case 1:n=dg;break;case 4:n=FT;break;case 16:n=rd;break;case 536870912:n=UT;break;default:n=rd}n=dx(n,ix.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function ix(t,e){if(Du=-1,Vu=0,Ve&6)throw Error(K(327));var n=t.callbackNode;if($o()&&t.callbackNode!==n)return null;var r=id(t,t===Rt?Vt:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=Id(t,r);else{e=r;var i=Ve;Ve|=2;var s=ox();(Rt!==t||Vt!==e)&&(Rr=null,na=ft()+500,As(t,e));do try{uP();break}catch(a){sx(t,a)}while(!0);xg(),vd.current=s,Ve=i,gt!==null?e=0:(Rt=null,Vt=0,e=Tt)}if(e!==0){if(e===2&&(i=Fp(t),i!==0&&(r=i,e=fm(t,i))),e===1)throw n=Ql,As(t,0),gi(t,r),fn(t,ft()),n;if(e===6)gi(t,r);else{if(i=t.current.alternate,!(r&30)&&!lP(i)&&(e=Id(t,r),e===2&&(s=Fp(t),s!==0&&(r=s,e=fm(t,s))),e===1))throw n=Ql,As(t,0),gi(t,r),fn(t,ft()),n;switch(t.finishedWork=i,t.finishedLanes=r,e){case 0:case 1:throw Error(K(345));case 2:hs(t,ln,Rr);break;case 3:if(gi(t,r),(r&130023424)===r&&(e=Fg+500-ft(),10<e)){if(id(t,0)!==0)break;if(i=t.suspendedLanes,(i&r)!==r){en(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=Kp(hs.bind(null,t,ln,Rr),e);break}hs(t,ln,Rr);break;case 4:if(gi(t,r),(r&4194240)===r)break;for(e=t.eventTimes,i=-1;0<r;){var o=31-Yn(r);s=1<<o,o=e[o],o>i&&(i=o),r&=~s}if(r=i,r=ft()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*aP(r/1960))-r,10<r){t.timeoutHandle=Kp(hs.bind(null,t,ln,Rr),r);break}hs(t,ln,Rr);break;case 5:hs(t,ln,Rr);break;default:throw Error(K(329))}}}return fn(t,ft()),t.callbackNode===n?ix.bind(null,t):null}function fm(t,e){var n=El;return t.current.memoizedState.isDehydrated&&(As(t,e).flags|=256),t=Id(t,e),t!==2&&(e=ln,ln=n,e!==null&&pm(e)),t}function pm(t){ln===null?ln=t:ln.push.apply(ln,t)}function lP(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],s=i.getSnapshot;i=i.value;try{if(!Zn(s(),i))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function gi(t,e){for(e&=~Mg,e&=~fh,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-Yn(e),r=1<<n;t[n]=-1,e&=~r}}function gw(t){if(Ve&6)throw Error(K(327));$o();var e=id(t,0);if(!(e&1))return fn(t,ft()),null;var n=Id(t,e);if(t.tag!==0&&n===2){var r=Fp(t);r!==0&&(e=r,n=fm(t,r))}if(n===1)throw n=Ql,As(t,0),gi(t,e),fn(t,ft()),n;if(n===6)throw Error(K(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,hs(t,ln,Rr),fn(t,ft()),null}function Ug(t,e){var n=Ve;Ve|=1;try{return t(e)}finally{Ve=n,Ve===0&&(na=ft()+500,ch&&Xi())}}function Ms(t){Si!==null&&Si.tag===0&&!(Ve&6)&&$o();var e=Ve;Ve|=1;var n=Ln.transition,r=Fe;try{if(Ln.transition=null,Fe=1,t)return t()}finally{Fe=r,Ln.transition=n,Ve=e,!(Ve&6)&&Xi()}}function Bg(){vn=Oo.current,Ye(Oo)}function As(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,M1(n)),gt!==null)for(n=gt.return;n!==null;){var r=n;switch(Eg(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&cd();break;case 3:ea(),Ye(dn),Ye(Kt),Pg();break;case 5:Rg(r);break;case 4:ea();break;case 13:Ye(nt);break;case 19:Ye(nt);break;case 10:Sg(r.type._context);break;case 22:case 23:Bg()}n=n.return}if(Rt=t,gt=t=Vi(t.current,null),Vt=vn=e,Tt=0,Ql=null,Mg=fh=Ls=0,ln=El=null,Is!==null){for(e=0;e<Is.length;e++)if(n=Is[e],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,s=n.pending;if(s!==null){var o=s.next;s.next=i,r.next=o}n.pending=r}Is=null}return t}function sx(t,e){do{var n=gt;try{if(xg(),Pu.current=_d,yd){for(var r=it.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}yd=!1}if(js=0,bt=Et=it=null,vl=!1,Wl=0,Lg.current=null,n===null||n.return===null){Tt=1,Ql=e,gt=null;break}e:{var s=t,o=n.return,a=n,l=e;if(e=Vt,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var u=l,h=a,f=h.tag;if(!(h.mode&1)&&(f===0||f===11||f===15)){var m=h.alternate;m?(h.updateQueue=m.updateQueue,h.memoizedState=m.memoizedState,h.lanes=m.lanes):(h.updateQueue=null,h.memoizedState=null)}var E=rw(o);if(E!==null){E.flags&=-257,iw(E,o,a,s,e),E.mode&1&&nw(s,u,e),e=E,l=u;var _=e.updateQueue;if(_===null){var A=new Set;A.add(l),e.updateQueue=A}else _.add(l);break e}else{if(!(e&1)){nw(s,u,e),$g();break e}l=Error(K(426))}}else if(Ze&&a.mode&1){var P=rw(o);if(P!==null){!(P.flags&65536)&&(P.flags|=256),iw(P,o,a,s,e),Ig(ta(l,a));break e}}s=l=ta(l,a),Tt!==4&&(Tt=2),El===null?El=[s]:El.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var v=$0(s,l,e);Yv(s,v);break e;case 1:a=l;var w=s.type,y=s.stateNode;if(!(s.flags&128)&&(typeof w.getDerivedStateFromError=="function"||y!==null&&typeof y.componentDidCatch=="function"&&(Ni===null||!Ni.has(y)))){s.flags|=65536,e&=-e,s.lanes|=e;var V=z0(s,a,e);Yv(s,V);break e}}s=s.return}while(s!==null)}lx(n)}catch(U){e=U,gt===n&&n!==null&&(gt=n=n.return);continue}break}while(!0)}function ox(){var t=vd.current;return vd.current=_d,t===null?_d:t}function $g(){(Tt===0||Tt===3||Tt===2)&&(Tt=4),Rt===null||!(Ls&268435455)&&!(fh&268435455)||gi(Rt,Vt)}function Id(t,e){var n=Ve;Ve|=2;var r=ox();(Rt!==t||Vt!==e)&&(Rr=null,As(t,e));do try{cP();break}catch(i){sx(t,i)}while(!0);if(xg(),Ve=n,vd.current=r,gt!==null)throw Error(K(261));return Rt=null,Vt=0,Tt}function cP(){for(;gt!==null;)ax(gt)}function uP(){for(;gt!==null&&!OR();)ax(gt)}function ax(t){var e=ux(t.alternate,t,vn);t.memoizedProps=t.pendingProps,e===null?lx(t):gt=e,Lg.current=null}function lx(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=rP(n,e),n!==null){n.flags&=32767,gt=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Tt=6,gt=null;return}}else if(n=nP(n,e,vn),n!==null){gt=n;return}if(e=e.sibling,e!==null){gt=e;return}gt=e=t}while(e!==null);Tt===0&&(Tt=5)}function hs(t,e,n){var r=Fe,i=Ln.transition;try{Ln.transition=null,Fe=1,dP(t,e,n,r)}finally{Ln.transition=i,Fe=r}return null}function dP(t,e,n,r){do $o();while(Si!==null);if(Ve&6)throw Error(K(327));n=t.finishedWork;var i=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(K(177));t.callbackNode=null,t.callbackPriority=0;var s=n.lanes|n.childLanes;if(HR(t,s),t===Rt&&(gt=Rt=null,Vt=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||cu||(cu=!0,dx(rd,function(){return $o(),null})),s=(n.flags&15990)!==0,n.subtreeFlags&15990||s){s=Ln.transition,Ln.transition=null;var o=Fe;Fe=1;var a=Ve;Ve|=4,Lg.current=null,sP(t,n),nx(n,t),k1(Hp),sd=!!qp,Hp=qp=null,t.current=n,oP(n),jR(),Ve=a,Fe=o,Ln.transition=s}else t.current=n;if(cu&&(cu=!1,Si=t,Ed=i),s=t.pendingLanes,s===0&&(Ni=null),FR(n.stateNode),fn(t,ft()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)i=e[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(wd)throw wd=!1,t=dm,dm=null,t;return Ed&1&&t.tag!==0&&$o(),s=t.pendingLanes,s&1?t===hm?Il++:(Il=0,hm=t):Il=0,Xi(),null}function $o(){if(Si!==null){var t=$T(Ed),e=Ln.transition,n=Fe;try{if(Ln.transition=null,Fe=16>t?16:t,Si===null)var r=!1;else{if(t=Si,Si=null,Ed=0,Ve&6)throw Error(K(331));var i=Ve;for(Ve|=4,ie=t.current;ie!==null;){var s=ie,o=s.child;if(ie.flags&16){var a=s.deletions;if(a!==null){for(var l=0;l<a.length;l++){var u=a[l];for(ie=u;ie!==null;){var h=ie;switch(h.tag){case 0:case 11:case 15:wl(8,h,s)}var f=h.child;if(f!==null)f.return=h,ie=f;else for(;ie!==null;){h=ie;var m=h.sibling,E=h.return;if(Z0(h),h===u){ie=null;break}if(m!==null){m.return=E,ie=m;break}ie=E}}}var _=s.alternate;if(_!==null){var A=_.child;if(A!==null){_.child=null;do{var P=A.sibling;A.sibling=null,A=P}while(A!==null)}}ie=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,ie=o;else e:for(;ie!==null;){if(s=ie,s.flags&2048)switch(s.tag){case 0:case 11:case 15:wl(9,s,s.return)}var v=s.sibling;if(v!==null){v.return=s.return,ie=v;break e}ie=s.return}}var w=t.current;for(ie=w;ie!==null;){o=ie;var y=o.child;if(o.subtreeFlags&2064&&y!==null)y.return=o,ie=y;else e:for(o=w;ie!==null;){if(a=ie,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:hh(9,a)}}catch(U){at(a,a.return,U)}if(a===o){ie=null;break e}var V=a.sibling;if(V!==null){V.return=a.return,ie=V;break e}ie=a.return}}if(Ve=i,Xi(),_r&&typeof _r.onPostCommitFiberRoot=="function")try{_r.onPostCommitFiberRoot(ih,t)}catch{}r=!0}return r}finally{Fe=n,Ln.transition=e}}return!1}function yw(t,e,n){e=ta(n,e),e=$0(t,e,1),t=ki(t,e,1),e=en(),t!==null&&(fc(t,1,e),fn(t,e))}function at(t,e,n){if(t.tag===3)yw(t,t,n);else for(;e!==null;){if(e.tag===3){yw(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Ni===null||!Ni.has(r))){t=ta(n,t),t=z0(e,t,1),e=ki(e,t,1),t=en(),e!==null&&(fc(e,1,t),fn(e,t));break}}e=e.return}}function hP(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=en(),t.pingedLanes|=t.suspendedLanes&n,Rt===t&&(Vt&n)===n&&(Tt===4||Tt===3&&(Vt&130023424)===Vt&&500>ft()-Fg?As(t,0):Mg|=n),fn(t,e)}function cx(t,e){e===0&&(t.mode&1?(e=Zc,Zc<<=1,!(Zc&130023424)&&(Zc=4194304)):e=1);var n=en();t=Br(t,e),t!==null&&(fc(t,e,n),fn(t,n))}function fP(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),cx(t,n)}function pP(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,i=t.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(K(314))}r!==null&&r.delete(e),cx(t,n)}var ux;ux=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||dn.current)cn=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return cn=!1,tP(t,e,n);cn=!!(t.flags&131072)}else cn=!1,Ze&&e.flags&1048576&&p0(e,hd,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;Nu(t,e),t=e.pendingProps;var i=Xo(e,Kt.current);Bo(e,n),i=Ng(null,e,r,t,i,n);var s=Dg();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,hn(r)?(s=!0,ud(e)):s=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,Cg(e),i.updater=dh,e.stateNode=i,i._reactInternals=e,em(e,r,t,n),e=rm(null,e,r,!0,s,n)):(e.tag=0,Ze&&s&&wg(e),Yt(null,e,i,n),e=e.child),e;case 16:r=e.elementType;e:{switch(Nu(t,e),t=e.pendingProps,i=r._init,r=i(r._payload),e.type=r,i=e.tag=gP(r),t=Hn(r,t),i){case 0:e=nm(null,e,r,t,n);break e;case 1:e=aw(null,e,r,t,n);break e;case 11:e=sw(null,e,r,t,n);break e;case 14:e=ow(null,e,r,Hn(r.type,t),n);break e}throw Error(K(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Hn(r,i),nm(t,e,r,i,n);case 1:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Hn(r,i),aw(t,e,r,i,n);case 3:e:{if(K0(e),t===null)throw Error(K(387));r=e.pendingProps,s=e.memoizedState,i=s.element,w0(t,e),md(e,r,null,n);var o=e.memoizedState;if(r=o.element,s.isDehydrated)if(s={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){i=ta(Error(K(423)),e),e=lw(t,e,r,n,i);break e}else if(r!==i){i=ta(Error(K(424)),e),e=lw(t,e,r,n,i);break e}else for(In=Pi(e.stateNode.containerInfo.firstChild),xn=e,Ze=!0,Gn=null,n=_0(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Jo(),r===i){e=$r(t,e,n);break e}Yt(t,e,r,n)}e=e.child}return e;case 5:return E0(e),t===null&&Xp(e),r=e.type,i=e.pendingProps,s=t!==null?t.memoizedProps:null,o=i.children,Wp(r,i)?o=null:s!==null&&Wp(r,s)&&(e.flags|=32),W0(t,e),Yt(t,e,o,n),e.child;case 6:return t===null&&Xp(e),null;case 13:return G0(t,e,n);case 4:return bg(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=Zo(e,null,r,n):Yt(t,e,r,n),e.child;case 11:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Hn(r,i),sw(t,e,r,i,n);case 7:return Yt(t,e,e.pendingProps,n),e.child;case 8:return Yt(t,e,e.pendingProps.children,n),e.child;case 12:return Yt(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,i=e.pendingProps,s=e.memoizedProps,o=i.value,We(fd,r._currentValue),r._currentValue=o,s!==null)if(Zn(s.value,o)){if(s.children===i.children&&!dn.current){e=$r(t,e,n);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var a=s.dependencies;if(a!==null){o=s.child;for(var l=a.firstContext;l!==null;){if(l.context===r){if(s.tag===1){l=Lr(-1,n&-n),l.tag=2;var u=s.updateQueue;if(u!==null){u=u.shared;var h=u.pending;h===null?l.next=l:(l.next=h.next,h.next=l),u.pending=l}}s.lanes|=n,l=s.alternate,l!==null&&(l.lanes|=n),Jp(s.return,n,e),a.lanes|=n;break}l=l.next}}else if(s.tag===10)o=s.type===e.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(K(341));o.lanes|=n,a=o.alternate,a!==null&&(a.lanes|=n),Jp(o,n,e),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===e){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}Yt(t,e,i.children,n),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,Bo(e,n),i=Fn(i),r=r(i),e.flags|=1,Yt(t,e,r,n),e.child;case 14:return r=e.type,i=Hn(r,e.pendingProps),i=Hn(r.type,i),ow(t,e,r,i,n);case 15:return q0(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Hn(r,i),Nu(t,e),e.tag=1,hn(r)?(t=!0,ud(e)):t=!1,Bo(e,n),B0(e,r,i),em(e,r,i,n),rm(null,e,r,!0,t,n);case 19:return Q0(t,e,n);case 22:return H0(t,e,n)}throw Error(K(156,e.tag))};function dx(t,e){return MT(t,e)}function mP(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function On(t,e,n,r){return new mP(t,e,n,r)}function zg(t){return t=t.prototype,!(!t||!t.isReactComponent)}function gP(t){if(typeof t=="function")return zg(t)?1:0;if(t!=null){if(t=t.$$typeof,t===lg)return 11;if(t===cg)return 14}return 2}function Vi(t,e){var n=t.alternate;return n===null?(n=On(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Ou(t,e,n,r,i,s){var o=2;if(r=t,typeof t=="function")zg(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case So:return Cs(n.children,i,s,e);case ag:o=8,i|=8;break;case xp:return t=On(12,n,e,i|2),t.elementType=xp,t.lanes=s,t;case Sp:return t=On(13,n,e,i),t.elementType=Sp,t.lanes=s,t;case Ap:return t=On(19,n,e,i),t.elementType=Ap,t.lanes=s,t;case ET:return ph(n,i,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case vT:o=10;break e;case wT:o=9;break e;case lg:o=11;break e;case cg:o=14;break e;case fi:o=16,r=null;break e}throw Error(K(130,t==null?t:typeof t,""))}return e=On(o,n,e,i),e.elementType=t,e.type=r,e.lanes=s,e}function Cs(t,e,n,r){return t=On(7,t,r,e),t.lanes=n,t}function ph(t,e,n,r){return t=On(22,t,r,e),t.elementType=ET,t.lanes=n,t.stateNode={isHidden:!1},t}function Wf(t,e,n){return t=On(6,t,null,e),t.lanes=n,t}function Kf(t,e,n){return e=On(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function yP(t,e,n,r,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Cf(0),this.expirationTimes=Cf(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Cf(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function qg(t,e,n,r,i,s,o,a,l){return t=new yP(t,e,n,a,l),e===1?(e=1,s===!0&&(e|=8)):e=0,s=On(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Cg(s),t}function _P(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:xo,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function hx(t){if(!t)return zi;t=t._reactInternals;e:{if(eo(t)!==t||t.tag!==1)throw Error(K(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(hn(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(K(171))}if(t.tag===1){var n=t.type;if(hn(n))return h0(t,n,e)}return e}function fx(t,e,n,r,i,s,o,a,l){return t=qg(n,r,!0,t,i,s,o,a,l),t.context=hx(null),n=t.current,r=en(),i=Di(n),s=Lr(r,i),s.callback=e??null,ki(n,s,i),t.current.lanes=i,fc(t,i,r),fn(t,r),t}function mh(t,e,n,r){var i=e.current,s=en(),o=Di(i);return n=hx(n),e.context===null?e.context=n:e.pendingContext=n,e=Lr(s,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=ki(i,e,o),t!==null&&(Xn(t,i,o,s),Ru(t,i,o)),o}function Td(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function _w(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function Hg(t,e){_w(t,e),(t=t.alternate)&&_w(t,e)}function vP(){return null}var px=typeof reportError=="function"?reportError:function(t){console.error(t)};function Wg(t){this._internalRoot=t}gh.prototype.render=Wg.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(K(409));mh(t,e,null,null)};gh.prototype.unmount=Wg.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Ms(function(){mh(null,t,null,null)}),e[Ur]=null}};function gh(t){this._internalRoot=t}gh.prototype.unstable_scheduleHydration=function(t){if(t){var e=HT();t={blockedOn:null,target:t,priority:e};for(var n=0;n<mi.length&&e!==0&&e<mi[n].priority;n++);mi.splice(n,0,t),n===0&&KT(t)}};function Kg(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function yh(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function vw(){}function wP(t,e,n,r,i){if(i){if(typeof r=="function"){var s=r;r=function(){var u=Td(o);s.call(u)}}var o=fx(e,r,t,0,null,!1,!1,"",vw);return t._reactRootContainer=o,t[Ur]=o.current,Bl(t.nodeType===8?t.parentNode:t),Ms(),o}for(;i=t.lastChild;)t.removeChild(i);if(typeof r=="function"){var a=r;r=function(){var u=Td(l);a.call(u)}}var l=qg(t,0,!1,null,null,!1,!1,"",vw);return t._reactRootContainer=l,t[Ur]=l.current,Bl(t.nodeType===8?t.parentNode:t),Ms(function(){mh(e,l,n,r)}),l}function _h(t,e,n,r,i){var s=n._reactRootContainer;if(s){var o=s;if(typeof i=="function"){var a=i;i=function(){var l=Td(o);a.call(l)}}mh(e,o,t,i)}else o=wP(n,e,t,i,r);return Td(o)}zT=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=il(e.pendingLanes);n!==0&&(hg(e,n|1),fn(e,ft()),!(Ve&6)&&(na=ft()+500,Xi()))}break;case 13:Ms(function(){var r=Br(t,1);if(r!==null){var i=en();Xn(r,t,1,i)}}),Hg(t,1)}};fg=function(t){if(t.tag===13){var e=Br(t,134217728);if(e!==null){var n=en();Xn(e,t,134217728,n)}Hg(t,134217728)}};qT=function(t){if(t.tag===13){var e=Di(t),n=Br(t,e);if(n!==null){var r=en();Xn(n,t,e,r)}Hg(t,e)}};HT=function(){return Fe};WT=function(t,e){var n=Fe;try{return Fe=t,e()}finally{Fe=n}};jp=function(t,e,n){switch(e){case"input":if(Rp(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var i=lh(r);if(!i)throw Error(K(90));TT(r),Rp(r,i)}}}break;case"textarea":ST(t,n);break;case"select":e=n.value,e!=null&&Lo(t,!!n.multiple,e,!1)}};NT=Ug;DT=Ms;var EP={usingClientEntryPoint:!1,Events:[mc,Ro,lh,PT,kT,Ug]},Ka={findFiberByHostInstance:Es,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},IP={bundleType:Ka.bundleType,version:Ka.version,rendererPackageName:Ka.rendererPackageName,rendererConfig:Ka.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Qr.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=jT(t),t===null?null:t.stateNode},findFiberByHostInstance:Ka.findFiberByHostInstance||vP,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var uu=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!uu.isDisabled&&uu.supportsFiber)try{ih=uu.inject(IP),_r=uu}catch{}}bn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=EP;bn.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Kg(e))throw Error(K(200));return _P(t,e,null,n)};bn.createRoot=function(t,e){if(!Kg(t))throw Error(K(299));var n=!1,r="",i=px;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=qg(t,1,!1,null,null,n,!1,r,i),t[Ur]=e.current,Bl(t.nodeType===8?t.parentNode:t),new Wg(e)};bn.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(K(188)):(t=Object.keys(t).join(","),Error(K(268,t)));return t=jT(e),t=t===null?null:t.stateNode,t};bn.flushSync=function(t){return Ms(t)};bn.hydrate=function(t,e,n){if(!yh(e))throw Error(K(200));return _h(null,t,e,!0,n)};bn.hydrateRoot=function(t,e,n){if(!Kg(t))throw Error(K(405));var r=n!=null&&n.hydratedSources||null,i=!1,s="",o=px;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(s=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=fx(e,null,t,1,n??null,i,!1,s,o),t[Ur]=e.current,Bl(t),r)for(t=0;t<r.length;t++)n=r[t],i=n._getVersion,i=i(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,i]:e.mutableSourceEagerHydrationData.push(n,i);return new gh(e)};bn.render=function(t,e,n){if(!yh(e))throw Error(K(200));return _h(null,t,e,!1,n)};bn.unmountComponentAtNode=function(t){if(!yh(t))throw Error(K(40));return t._reactRootContainer?(Ms(function(){_h(null,null,t,!1,function(){t._reactRootContainer=null,t[Ur]=null})}),!0):!1};bn.unstable_batchedUpdates=Ug;bn.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!yh(n))throw Error(K(200));if(t==null||t._reactInternals===void 0)throw Error(K(38));return _h(t,e,n,!1,r)};bn.version="18.3.1-next-f1338f8080-20240426";function mx(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(mx)}catch(t){console.error(t)}}mx(),mT.exports=bn;var TP=mT.exports,gx,ww=TP;gx=ww.createRoot,ww.hydrateRoot;/**
 * react-router v7.9.6
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var Ew="popstate";function xP(t={}){function e(r,i){let{pathname:s,search:o,hash:a}=r.location;return mm("",{pathname:s,search:o,hash:a},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function n(r,i){return typeof i=="string"?i:Yl(i)}return AP(e,n,null,t)}function et(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function Bn(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function SP(){return Math.random().toString(36).substring(2,10)}function Iw(t,e){return{usr:t.state,key:t.key,idx:e}}function mm(t,e,n=null,r){return{pathname:typeof t=="string"?t:t.pathname,search:"",hash:"",...typeof e=="string"?va(e):e,state:n,key:e&&e.key||r||SP()}}function Yl({pathname:t="/",search:e="",hash:n=""}){return e&&e!=="?"&&(t+=e.charAt(0)==="?"?e:"?"+e),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function va(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substring(n),t=t.substring(0,n));let r=t.indexOf("?");r>=0&&(e.search=t.substring(r),t=t.substring(0,r)),t&&(e.pathname=t)}return e}function AP(t,e,n,r={}){let{window:i=document.defaultView,v5Compat:s=!1}=r,o=i.history,a="POP",l=null,u=h();u==null&&(u=0,o.replaceState({...o.state,idx:u},""));function h(){return(o.state||{idx:null}).idx}function f(){a="POP";let P=h(),v=P==null?null:P-u;u=P,l&&l({action:a,location:A.location,delta:v})}function m(P,v){a="PUSH";let w=mm(A.location,P,v);u=h()+1;let y=Iw(w,u),V=A.createHref(w);try{o.pushState(y,"",V)}catch(U){if(U instanceof DOMException&&U.name==="DataCloneError")throw U;i.location.assign(V)}s&&l&&l({action:a,location:A.location,delta:1})}function E(P,v){a="REPLACE";let w=mm(A.location,P,v);u=h();let y=Iw(w,u),V=A.createHref(w);o.replaceState(y,"",V),s&&l&&l({action:a,location:A.location,delta:0})}function _(P){return CP(P)}let A={get action(){return a},get location(){return t(i,o)},listen(P){if(l)throw new Error("A history only accepts one active listener");return i.addEventListener(Ew,f),l=P,()=>{i.removeEventListener(Ew,f),l=null}},createHref(P){return e(i,P)},createURL:_,encodeLocation(P){let v=_(P);return{pathname:v.pathname,search:v.search,hash:v.hash}},push:m,replace:E,go(P){return o.go(P)}};return A}function CP(t,e=!1){let n="http://localhost";typeof window<"u"&&(n=window.location.origin!=="null"?window.location.origin:window.location.href),et(n,"No window.location.(origin|href) available to create URL");let r=typeof t=="string"?t:Yl(t);return r=r.replace(/ $/,"%20"),!e&&r.startsWith("//")&&(r=n+r),new URL(r,n)}function yx(t,e,n="/"){return bP(t,e,n,!1)}function bP(t,e,n,r){let i=typeof e=="string"?va(e):e,s=zr(i.pathname||"/",n);if(s==null)return null;let o=_x(t);RP(o);let a=null;for(let l=0;a==null&&l<o.length;++l){let u=UP(s);a=MP(o[l],u,r)}return a}function _x(t,e=[],n=[],r="",i=!1){let s=(o,a,l=i,u)=>{let h={relativePath:u===void 0?o.path||"":u,caseSensitive:o.caseSensitive===!0,childrenIndex:a,route:o};if(h.relativePath.startsWith("/")){if(!h.relativePath.startsWith(r)&&l)return;et(h.relativePath.startsWith(r),`Absolute route path "${h.relativePath}" nested under path "${r}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),h.relativePath=h.relativePath.slice(r.length)}let f=Mr([r,h.relativePath]),m=n.concat(h);o.children&&o.children.length>0&&(et(o.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${f}".`),_x(o.children,e,m,f,l)),!(o.path==null&&!o.index)&&e.push({path:f,score:jP(f,o.index),routesMeta:m})};return t.forEach((o,a)=>{var l;if(o.path===""||!((l=o.path)!=null&&l.includes("?")))s(o,a);else for(let u of vx(o.path))s(o,a,!0,u)}),e}function vx(t){let e=t.split("/");if(e.length===0)return[];let[n,...r]=e,i=n.endsWith("?"),s=n.replace(/\?$/,"");if(r.length===0)return i?[s,""]:[s];let o=vx(r.join("/")),a=[];return a.push(...o.map(l=>l===""?s:[s,l].join("/"))),i&&a.push(...o),a.map(l=>t.startsWith("/")&&l===""?"/":l)}function RP(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:LP(e.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}var PP=/^:[\w-]+$/,kP=3,NP=2,DP=1,VP=10,OP=-2,Tw=t=>t==="*";function jP(t,e){let n=t.split("/"),r=n.length;return n.some(Tw)&&(r+=OP),e&&(r+=NP),n.filter(i=>!Tw(i)).reduce((i,s)=>i+(PP.test(s)?kP:s===""?DP:VP),r)}function LP(t,e){return t.length===e.length&&t.slice(0,-1).every((r,i)=>r===e[i])?t[t.length-1]-e[e.length-1]:0}function MP(t,e,n=!1){let{routesMeta:r}=t,i={},s="/",o=[];for(let a=0;a<r.length;++a){let l=r[a],u=a===r.length-1,h=s==="/"?e:e.slice(s.length)||"/",f=xd({path:l.relativePath,caseSensitive:l.caseSensitive,end:u},h),m=l.route;if(!f&&u&&n&&!r[r.length-1].route.index&&(f=xd({path:l.relativePath,caseSensitive:l.caseSensitive,end:!1},h)),!f)return null;Object.assign(i,f.params),o.push({params:i,pathname:Mr([s,f.pathname]),pathnameBase:HP(Mr([s,f.pathnameBase])),route:m}),f.pathnameBase!=="/"&&(s=Mr([s,f.pathnameBase]))}return o}function xd(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,r]=FP(t.path,t.caseSensitive,t.end),i=e.match(n);if(!i)return null;let s=i[0],o=s.replace(/(.)\/+$/,"$1"),a=i.slice(1);return{params:r.reduce((u,{paramName:h,isOptional:f},m)=>{if(h==="*"){let _=a[m]||"";o=s.slice(0,s.length-_.length).replace(/(.)\/+$/,"$1")}const E=a[m];return f&&!E?u[h]=void 0:u[h]=(E||"").replace(/%2F/g,"/"),u},{}),pathname:s,pathnameBase:o,pattern:t}}function FP(t,e=!1,n=!0){Bn(t==="*"||!t.endsWith("*")||t.endsWith("/*"),`Route path "${t}" will be treated as if it were "${t.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${t.replace(/\*$/,"/*")}".`);let r=[],i="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,a,l)=>(r.push({paramName:a,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return t.endsWith("*")?(r.push({paramName:"*"}),i+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?i+="\\/*$":t!==""&&t!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,e?void 0:"i"),r]}function UP(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Bn(!1,`The URL path "${t}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),t}}function zr(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,r=t.charAt(n);return r&&r!=="/"?null:t.slice(n)||"/"}var BP=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,$P=t=>BP.test(t);function zP(t,e="/"){let{pathname:n,search:r="",hash:i=""}=typeof t=="string"?va(t):t,s;if(n)if($P(n))s=n;else{if(n.includes("//")){let o=n;n=n.replace(/\/\/+/g,"/"),Bn(!1,`Pathnames cannot have embedded double slashes - normalizing ${o} -> ${n}`)}n.startsWith("/")?s=xw(n.substring(1),"/"):s=xw(n,e)}else s=e;return{pathname:s,search:WP(r),hash:KP(i)}}function xw(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(i=>{i===".."?n.length>1&&n.pop():i!=="."&&n.push(i)}),n.length>1?n.join("/"):"/"}function Gf(t,e,n,r){return`Cannot include a '${t}' character in a manually specified \`to.${e}\` field [${JSON.stringify(r)}].  Please separate it out to the \`to.${n}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function qP(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function Gg(t){let e=qP(t);return e.map((n,r)=>r===e.length-1?n.pathname:n.pathnameBase)}function Qg(t,e,n,r=!1){let i;typeof t=="string"?i=va(t):(i={...t},et(!i.pathname||!i.pathname.includes("?"),Gf("?","pathname","search",i)),et(!i.pathname||!i.pathname.includes("#"),Gf("#","pathname","hash",i)),et(!i.search||!i.search.includes("#"),Gf("#","search","hash",i)));let s=t===""||i.pathname==="",o=s?"/":i.pathname,a;if(o==null)a=n;else{let f=e.length-1;if(!r&&o.startsWith("..")){let m=o.split("/");for(;m[0]==="..";)m.shift(),f-=1;i.pathname=m.join("/")}a=f>=0?e[f]:"/"}let l=zP(i,a),u=o&&o!=="/"&&o.endsWith("/"),h=(s||o===".")&&n.endsWith("/");return!l.pathname.endsWith("/")&&(u||h)&&(l.pathname+="/"),l}var Mr=t=>t.join("/").replace(/\/\/+/g,"/"),HP=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),WP=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,KP=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function GP(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var wx=["POST","PUT","PATCH","DELETE"];new Set(wx);var QP=["GET",...wx];new Set(QP);var wa=k.createContext(null);wa.displayName="DataRouter";var vh=k.createContext(null);vh.displayName="DataRouterState";k.createContext(!1);var Ex=k.createContext({isTransitioning:!1});Ex.displayName="ViewTransition";var YP=k.createContext(new Map);YP.displayName="Fetchers";var XP=k.createContext(null);XP.displayName="Await";var rr=k.createContext(null);rr.displayName="Navigation";var yc=k.createContext(null);yc.displayName="Location";var Sr=k.createContext({outlet:null,matches:[],isDataRoute:!1});Sr.displayName="Route";var Yg=k.createContext(null);Yg.displayName="RouteError";function JP(t,{relative:e}={}){et(Ea(),"useHref() may be used only in the context of a <Router> component.");let{basename:n,navigator:r}=k.useContext(rr),{hash:i,pathname:s,search:o}=_c(t,{relative:e}),a=s;return n!=="/"&&(a=s==="/"?n:Mr([n,s])),r.createHref({pathname:a,search:o,hash:i})}function Ea(){return k.useContext(yc)!=null}function Ji(){return et(Ea(),"useLocation() may be used only in the context of a <Router> component."),k.useContext(yc).location}var Ix="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function Tx(t){k.useContext(rr).static||k.useLayoutEffect(t)}function Xg(){let{isDataRoute:t}=k.useContext(Sr);return t?dk():ZP()}function ZP(){et(Ea(),"useNavigate() may be used only in the context of a <Router> component.");let t=k.useContext(wa),{basename:e,navigator:n}=k.useContext(rr),{matches:r}=k.useContext(Sr),{pathname:i}=Ji(),s=JSON.stringify(Gg(r)),o=k.useRef(!1);return Tx(()=>{o.current=!0}),k.useCallback((l,u={})=>{if(Bn(o.current,Ix),!o.current)return;if(typeof l=="number"){n.go(l);return}let h=Qg(l,JSON.parse(s),i,u.relative==="path");t==null&&e!=="/"&&(h.pathname=h.pathname==="/"?e:Mr([e,h.pathname])),(u.replace?n.replace:n.push)(h,u.state,u)},[e,n,s,i,t])}k.createContext(null);function _c(t,{relative:e}={}){let{matches:n}=k.useContext(Sr),{pathname:r}=Ji(),i=JSON.stringify(Gg(n));return k.useMemo(()=>Qg(t,JSON.parse(i),r,e==="path"),[t,i,r,e])}function ek(t,e){return xx(t,e)}function xx(t,e,n,r,i){var w;et(Ea(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:s}=k.useContext(rr),{matches:o}=k.useContext(Sr),a=o[o.length-1],l=a?a.params:{},u=a?a.pathname:"/",h=a?a.pathnameBase:"/",f=a&&a.route;{let y=f&&f.path||"";Sx(u,!f||y.endsWith("*")||y.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${u}" (under <Route path="${y}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${y}"> to <Route path="${y==="/"?"*":`${y}/*`}">.`)}let m=Ji(),E;if(e){let y=typeof e=="string"?va(e):e;et(h==="/"||((w=y.pathname)==null?void 0:w.startsWith(h)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${h}" but pathname "${y.pathname}" was given in the \`location\` prop.`),E=y}else E=m;let _=E.pathname||"/",A=_;if(h!=="/"){let y=h.replace(/^\//,"").split("/");A="/"+_.replace(/^\//,"").split("/").slice(y.length).join("/")}let P=yx(t,{pathname:A});Bn(f||P!=null,`No routes matched location "${E.pathname}${E.search}${E.hash}" `),Bn(P==null||P[P.length-1].route.element!==void 0||P[P.length-1].route.Component!==void 0||P[P.length-1].route.lazy!==void 0,`Matched leaf route at location "${E.pathname}${E.search}${E.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let v=sk(P&&P.map(y=>Object.assign({},y,{params:Object.assign({},l,y.params),pathname:Mr([h,s.encodeLocation?s.encodeLocation(y.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:y.pathname]),pathnameBase:y.pathnameBase==="/"?h:Mr([h,s.encodeLocation?s.encodeLocation(y.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:y.pathnameBase])})),o,n,r,i);return e&&v?k.createElement(yc.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...E},navigationType:"POP"}},v):v}function tk(){let t=uk(),e=GP(t)?`${t.status} ${t.statusText}`:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,r="rgba(200,200,200, 0.5)",i={padding:"0.5rem",backgroundColor:r},s={padding:"2px 4px",backgroundColor:r},o=null;return console.error("Error handled by React Router default ErrorBoundary:",t),o=k.createElement(k.Fragment,null,k.createElement("p",null," Hey developer "),k.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",k.createElement("code",{style:s},"ErrorBoundary")," or"," ",k.createElement("code",{style:s},"errorElement")," prop on your route.")),k.createElement(k.Fragment,null,k.createElement("h2",null,"Unexpected Application Error!"),k.createElement("h3",{style:{fontStyle:"italic"}},e),n?k.createElement("pre",{style:i},n):null,o)}var nk=k.createElement(tk,null),rk=class extends k.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,e){return e.location!==t.location||e.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:e.error,location:e.location,revalidation:t.revalidation||e.revalidation}}componentDidCatch(t,e){this.props.onError?this.props.onError(t,e):console.error("React Router caught the following error during render",t)}render(){return this.state.error!==void 0?k.createElement(Sr.Provider,{value:this.props.routeContext},k.createElement(Yg.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function ik({routeContext:t,match:e,children:n}){let r=k.useContext(wa);return r&&r.static&&r.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=e.route.id),k.createElement(Sr.Provider,{value:t},n)}function sk(t,e=[],n=null,r=null,i=null){if(t==null){if(!n)return null;if(n.errors)t=n.matches;else if(e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let s=t,o=n==null?void 0:n.errors;if(o!=null){let h=s.findIndex(f=>f.route.id&&(o==null?void 0:o[f.route.id])!==void 0);et(h>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(o).join(",")}`),s=s.slice(0,Math.min(s.length,h+1))}let a=!1,l=-1;if(n)for(let h=0;h<s.length;h++){let f=s[h];if((f.route.HydrateFallback||f.route.hydrateFallbackElement)&&(l=h),f.route.id){let{loaderData:m,errors:E}=n,_=f.route.loader&&!m.hasOwnProperty(f.route.id)&&(!E||E[f.route.id]===void 0);if(f.route.lazy||_){a=!0,l>=0?s=s.slice(0,l+1):s=[s[0]];break}}}let u=n&&r?(h,f)=>{var m,E;r(h,{location:n.location,params:((E=(m=n.matches)==null?void 0:m[0])==null?void 0:E.params)??{},errorInfo:f})}:void 0;return s.reduceRight((h,f,m)=>{let E,_=!1,A=null,P=null;n&&(E=o&&f.route.id?o[f.route.id]:void 0,A=f.route.errorElement||nk,a&&(l<0&&m===0?(Sx("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),_=!0,P=null):l===m&&(_=!0,P=f.route.hydrateFallbackElement||null)));let v=e.concat(s.slice(0,m+1)),w=()=>{let y;return E?y=A:_?y=P:f.route.Component?y=k.createElement(f.route.Component,null):f.route.element?y=f.route.element:y=h,k.createElement(ik,{match:f,routeContext:{outlet:h,matches:v,isDataRoute:n!=null},children:y})};return n&&(f.route.ErrorBoundary||f.route.errorElement||m===0)?k.createElement(rk,{location:n.location,revalidation:n.revalidation,component:A,error:E,children:w(),routeContext:{outlet:null,matches:v,isDataRoute:!0},onError:u}):w()},null)}function Jg(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function ok(t){let e=k.useContext(wa);return et(e,Jg(t)),e}function ak(t){let e=k.useContext(vh);return et(e,Jg(t)),e}function lk(t){let e=k.useContext(Sr);return et(e,Jg(t)),e}function Zg(t){let e=lk(t),n=e.matches[e.matches.length-1];return et(n.route.id,`${t} can only be used on routes that contain a unique "id"`),n.route.id}function ck(){return Zg("useRouteId")}function uk(){var r;let t=k.useContext(Yg),e=ak("useRouteError"),n=Zg("useRouteError");return t!==void 0?t:(r=e.errors)==null?void 0:r[n]}function dk(){let{router:t}=ok("useNavigate"),e=Zg("useNavigate"),n=k.useRef(!1);return Tx(()=>{n.current=!0}),k.useCallback(async(i,s={})=>{Bn(n.current,Ix),n.current&&(typeof i=="number"?t.navigate(i):await t.navigate(i,{fromRouteId:e,...s}))},[t,e])}var Sw={};function Sx(t,e,n){!e&&!Sw[t]&&(Sw[t]=!0,Bn(!1,n))}k.memo(hk);function hk({routes:t,future:e,state:n,unstable_onError:r}){return xx(t,void 0,n,r,e)}function gm({to:t,replace:e,state:n,relative:r}){et(Ea(),"<Navigate> may be used only in the context of a <Router> component.");let{static:i}=k.useContext(rr);Bn(!i,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:s}=k.useContext(Sr),{pathname:o}=Ji(),a=Xg(),l=Qg(t,Gg(s),o,r==="path"),u=JSON.stringify(l);return k.useEffect(()=>{a(JSON.parse(u),{replace:e,state:n,relative:r})},[a,u,r,e,n]),null}function vo(t){et(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function fk({basename:t="/",children:e=null,location:n,navigationType:r="POP",navigator:i,static:s=!1}){et(!Ea(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let o=t.replace(/^\/*/,"/"),a=k.useMemo(()=>({basename:o,navigator:i,static:s,future:{}}),[o,i,s]);typeof n=="string"&&(n=va(n));let{pathname:l="/",search:u="",hash:h="",state:f=null,key:m="default"}=n,E=k.useMemo(()=>{let _=zr(l,o);return _==null?null:{location:{pathname:_,search:u,hash:h,state:f,key:m},navigationType:r}},[o,l,u,h,f,m,r]);return Bn(E!=null,`<Router basename="${o}"> is not able to match the URL "${l}${u}${h}" because it does not start with the basename, so the <Router> won't render anything.`),E==null?null:k.createElement(rr.Provider,{value:a},k.createElement(yc.Provider,{children:e,value:E}))}function pk({children:t,location:e}){return ek(ym(t),e)}function ym(t,e=[]){let n=[];return k.Children.forEach(t,(r,i)=>{if(!k.isValidElement(r))return;let s=[...e,i];if(r.type===k.Fragment){n.push.apply(n,ym(r.props.children,s));return}et(r.type===vo,`[${typeof r.type=="string"?r.type:r.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),et(!r.props.index||!r.props.children,"An index route cannot have child routes.");let o={id:r.props.id||s.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,middleware:r.props.middleware,loader:r.props.loader,action:r.props.action,hydrateFallbackElement:r.props.hydrateFallbackElement,HydrateFallback:r.props.HydrateFallback,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.hasErrorBoundary===!0||r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(o.children=ym(r.props.children,s)),n.push(o)}),n}var ju="get",Lu="application/x-www-form-urlencoded";function wh(t){return t!=null&&typeof t.tagName=="string"}function mk(t){return wh(t)&&t.tagName.toLowerCase()==="button"}function gk(t){return wh(t)&&t.tagName.toLowerCase()==="form"}function yk(t){return wh(t)&&t.tagName.toLowerCase()==="input"}function _k(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function vk(t,e){return t.button===0&&(!e||e==="_self")&&!_k(t)}var du=null;function wk(){if(du===null)try{new FormData(document.createElement("form"),0),du=!1}catch{du=!0}return du}var Ek=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Qf(t){return t!=null&&!Ek.has(t)?(Bn(!1,`"${t}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Lu}"`),null):t}function Ik(t,e){let n,r,i,s,o;if(gk(t)){let a=t.getAttribute("action");r=a?zr(a,e):null,n=t.getAttribute("method")||ju,i=Qf(t.getAttribute("enctype"))||Lu,s=new FormData(t)}else if(mk(t)||yk(t)&&(t.type==="submit"||t.type==="image")){let a=t.form;if(a==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let l=t.getAttribute("formaction")||a.getAttribute("action");if(r=l?zr(l,e):null,n=t.getAttribute("formmethod")||a.getAttribute("method")||ju,i=Qf(t.getAttribute("formenctype"))||Qf(a.getAttribute("enctype"))||Lu,s=new FormData(a,t),!wk()){let{name:u,type:h,value:f}=t;if(h==="image"){let m=u?`${u}.`:"";s.append(`${m}x`,"0"),s.append(`${m}y`,"0")}else u&&s.append(u,f)}}else{if(wh(t))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');n=ju,r=null,i=Lu,o=t}return s&&i==="text/plain"&&(o=s,s=void 0),{action:r,method:n.toLowerCase(),encType:i,formData:s,body:o}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function ey(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function Tk(t,e,n){let r=typeof t=="string"?new URL(t,typeof window>"u"?"server://singlefetch/":window.location.origin):t;return r.pathname==="/"?r.pathname=`_root.${n}`:e&&zr(r.pathname,e)==="/"?r.pathname=`${e.replace(/\/$/,"")}/_root.${n}`:r.pathname=`${r.pathname.replace(/\/$/,"")}.${n}`,r}async function xk(t,e){if(t.id in e)return e[t.id];try{let n=await import(t.module);return e[t.id]=n,n}catch(n){return console.error(`Error loading route module \`${t.module}\`, reloading page...`),console.error(n),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function Sk(t){return t==null?!1:t.href==null?t.rel==="preload"&&typeof t.imageSrcSet=="string"&&typeof t.imageSizes=="string":typeof t.rel=="string"&&typeof t.href=="string"}async function Ak(t,e,n){let r=await Promise.all(t.map(async i=>{let s=e.routes[i.route.id];if(s){let o=await xk(s,n);return o.links?o.links():[]}return[]}));return Pk(r.flat(1).filter(Sk).filter(i=>i.rel==="stylesheet"||i.rel==="preload").map(i=>i.rel==="stylesheet"?{...i,rel:"prefetch",as:"style"}:{...i,rel:"prefetch"}))}function Aw(t,e,n,r,i,s){let o=(l,u)=>n[u]?l.route.id!==n[u].route.id:!0,a=(l,u)=>{var h;return n[u].pathname!==l.pathname||((h=n[u].route.path)==null?void 0:h.endsWith("*"))&&n[u].params["*"]!==l.params["*"]};return s==="assets"?e.filter((l,u)=>o(l,u)||a(l,u)):s==="data"?e.filter((l,u)=>{var f;let h=r.routes[l.route.id];if(!h||!h.hasLoader)return!1;if(o(l,u)||a(l,u))return!0;if(l.route.shouldRevalidate){let m=l.route.shouldRevalidate({currentUrl:new URL(i.pathname+i.search+i.hash,window.origin),currentParams:((f=n[0])==null?void 0:f.params)||{},nextUrl:new URL(t,window.origin),nextParams:l.params,defaultShouldRevalidate:!0});if(typeof m=="boolean")return m}return!0}):[]}function Ck(t,e,{includeHydrateFallback:n}={}){return bk(t.map(r=>{let i=e.routes[r.route.id];if(!i)return[];let s=[i.module];return i.clientActionModule&&(s=s.concat(i.clientActionModule)),i.clientLoaderModule&&(s=s.concat(i.clientLoaderModule)),n&&i.hydrateFallbackModule&&(s=s.concat(i.hydrateFallbackModule)),i.imports&&(s=s.concat(i.imports)),s}).flat(1))}function bk(t){return[...new Set(t)]}function Rk(t){let e={},n=Object.keys(t).sort();for(let r of n)e[r]=t[r];return e}function Pk(t,e){let n=new Set;return new Set(e),t.reduce((r,i)=>{let s=JSON.stringify(Rk(i));return n.has(s)||(n.add(s),r.push({key:s,link:i})),r},[])}function Ax(){let t=k.useContext(wa);return ey(t,"You must render this element inside a <DataRouterContext.Provider> element"),t}function kk(){let t=k.useContext(vh);return ey(t,"You must render this element inside a <DataRouterStateContext.Provider> element"),t}var ty=k.createContext(void 0);ty.displayName="FrameworkContext";function Cx(){let t=k.useContext(ty);return ey(t,"You must render this element inside a <HydratedRouter> element"),t}function Nk(t,e){let n=k.useContext(ty),[r,i]=k.useState(!1),[s,o]=k.useState(!1),{onFocus:a,onBlur:l,onMouseEnter:u,onMouseLeave:h,onTouchStart:f}=e,m=k.useRef(null);k.useEffect(()=>{if(t==="render"&&o(!0),t==="viewport"){let A=v=>{v.forEach(w=>{o(w.isIntersecting)})},P=new IntersectionObserver(A,{threshold:.5});return m.current&&P.observe(m.current),()=>{P.disconnect()}}},[t]),k.useEffect(()=>{if(r){let A=setTimeout(()=>{o(!0)},100);return()=>{clearTimeout(A)}}},[r]);let E=()=>{i(!0)},_=()=>{i(!1),o(!1)};return n?t!=="intent"?[s,m,{}]:[s,m,{onFocus:Ga(a,E),onBlur:Ga(l,_),onMouseEnter:Ga(u,E),onMouseLeave:Ga(h,_),onTouchStart:Ga(f,E)}]:[!1,m,{}]}function Ga(t,e){return n=>{t&&t(n),n.defaultPrevented||e(n)}}function Dk({page:t,...e}){let{router:n}=Ax(),r=k.useMemo(()=>yx(n.routes,t,n.basename),[n.routes,t,n.basename]);return r?k.createElement(Ok,{page:t,matches:r,...e}):null}function Vk(t){let{manifest:e,routeModules:n}=Cx(),[r,i]=k.useState([]);return k.useEffect(()=>{let s=!1;return Ak(t,e,n).then(o=>{s||i(o)}),()=>{s=!0}},[t,e,n]),r}function Ok({page:t,matches:e,...n}){let r=Ji(),{manifest:i,routeModules:s}=Cx(),{basename:o}=Ax(),{loaderData:a,matches:l}=kk(),u=k.useMemo(()=>Aw(t,e,l,i,r,"data"),[t,e,l,i,r]),h=k.useMemo(()=>Aw(t,e,l,i,r,"assets"),[t,e,l,i,r]),f=k.useMemo(()=>{if(t===r.pathname+r.search+r.hash)return[];let _=new Set,A=!1;if(e.forEach(v=>{var y;let w=i.routes[v.route.id];!w||!w.hasLoader||(!u.some(V=>V.route.id===v.route.id)&&v.route.id in a&&((y=s[v.route.id])!=null&&y.shouldRevalidate)||w.hasClientLoader?A=!0:_.add(v.route.id))}),_.size===0)return[];let P=Tk(t,o,"data");return A&&_.size>0&&P.searchParams.set("_routes",e.filter(v=>_.has(v.route.id)).map(v=>v.route.id).join(",")),[P.pathname+P.search]},[o,a,r,i,u,e,t,s]),m=k.useMemo(()=>Ck(h,i),[h,i]),E=Vk(h);return k.createElement(k.Fragment,null,f.map(_=>k.createElement("link",{key:_,rel:"prefetch",as:"fetch",href:_,...n})),m.map(_=>k.createElement("link",{key:_,rel:"modulepreload",href:_,...n})),E.map(({key:_,link:A})=>k.createElement("link",{key:_,nonce:n.nonce,...A})))}function jk(...t){return e=>{t.forEach(n=>{typeof n=="function"?n(e):n!=null&&(n.current=e)})}}var bx=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{bx&&(window.__reactRouterVersion="7.9.6")}catch{}function Lk({basename:t,children:e,window:n}){let r=k.useRef();r.current==null&&(r.current=xP({window:n,v5Compat:!0}));let i=r.current,[s,o]=k.useState({action:i.action,location:i.location}),a=k.useCallback(l=>{k.startTransition(()=>o(l))},[o]);return k.useLayoutEffect(()=>i.listen(a),[i,a]),k.createElement(fk,{basename:t,children:e,location:s.location,navigationType:s.action,navigator:i})}var Rx=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Px=k.forwardRef(function({onClick:e,discover:n="render",prefetch:r="none",relative:i,reloadDocument:s,replace:o,state:a,target:l,to:u,preventScrollReset:h,viewTransition:f,...m},E){let{basename:_}=k.useContext(rr),A=typeof u=="string"&&Rx.test(u),P,v=!1;if(typeof u=="string"&&A&&(P=u,bx))try{let C=new URL(window.location.href),R=u.startsWith("//")?new URL(C.protocol+u):new URL(u),N=zr(R.pathname,_);R.origin===C.origin&&N!=null?u=N+R.search+R.hash:v=!0}catch{Bn(!1,`<Link to="${u}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let w=JP(u,{relative:i}),[y,V,U]=Nk(r,m),$=Bk(u,{replace:o,state:a,target:l,preventScrollReset:h,relative:i,viewTransition:f});function S(C){e&&e(C),C.defaultPrevented||$(C)}let I=k.createElement("a",{...m,...U,href:P||w,onClick:v||s?e:S,ref:jk(E,V),target:l,"data-discover":!A&&n==="render"?"true":void 0});return y&&!A?k.createElement(k.Fragment,null,I,k.createElement(Dk,{page:w})):I});Px.displayName="Link";var Mk=k.forwardRef(function({"aria-current":e="page",caseSensitive:n=!1,className:r="",end:i=!1,style:s,to:o,viewTransition:a,children:l,...u},h){let f=_c(o,{relative:u.relative}),m=Ji(),E=k.useContext(vh),{navigator:_,basename:A}=k.useContext(rr),P=E!=null&&Wk(f)&&a===!0,v=_.encodeLocation?_.encodeLocation(f).pathname:f.pathname,w=m.pathname,y=E&&E.navigation&&E.navigation.location?E.navigation.location.pathname:null;n||(w=w.toLowerCase(),y=y?y.toLowerCase():null,v=v.toLowerCase()),y&&A&&(y=zr(y,A)||y);const V=v!=="/"&&v.endsWith("/")?v.length-1:v.length;let U=w===v||!i&&w.startsWith(v)&&w.charAt(V)==="/",$=y!=null&&(y===v||!i&&y.startsWith(v)&&y.charAt(v.length)==="/"),S={isActive:U,isPending:$,isTransitioning:P},I=U?e:void 0,C;typeof r=="function"?C=r(S):C=[r,U?"active":null,$?"pending":null,P?"transitioning":null].filter(Boolean).join(" ");let R=typeof s=="function"?s(S):s;return k.createElement(Px,{...u,"aria-current":I,className:C,ref:h,style:R,to:o,viewTransition:a},typeof l=="function"?l(S):l)});Mk.displayName="NavLink";var Fk=k.forwardRef(({discover:t="render",fetcherKey:e,navigate:n,reloadDocument:r,replace:i,state:s,method:o=ju,action:a,onSubmit:l,relative:u,preventScrollReset:h,viewTransition:f,...m},E)=>{let _=qk(),A=Hk(a,{relative:u}),P=o.toLowerCase()==="get"?"get":"post",v=typeof a=="string"&&Rx.test(a),w=y=>{if(l&&l(y),y.defaultPrevented)return;y.preventDefault();let V=y.nativeEvent.submitter,U=(V==null?void 0:V.getAttribute("formmethod"))||o;_(V||y.currentTarget,{fetcherKey:e,method:U,navigate:n,replace:i,state:s,relative:u,preventScrollReset:h,viewTransition:f})};return k.createElement("form",{ref:E,method:P,action:A,onSubmit:r?l:w,...m,"data-discover":!v&&t==="render"?"true":void 0})});Fk.displayName="Form";function Uk(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function kx(t){let e=k.useContext(wa);return et(e,Uk(t)),e}function Bk(t,{target:e,replace:n,state:r,preventScrollReset:i,relative:s,viewTransition:o}={}){let a=Xg(),l=Ji(),u=_c(t,{relative:s});return k.useCallback(h=>{if(vk(h,e)){h.preventDefault();let f=n!==void 0?n:Yl(l)===Yl(u);a(t,{replace:f,state:r,preventScrollReset:i,relative:s,viewTransition:o})}},[l,a,u,n,r,e,t,i,s,o])}var $k=0,zk=()=>`__${String(++$k)}__`;function qk(){let{router:t}=kx("useSubmit"),{basename:e}=k.useContext(rr),n=ck();return k.useCallback(async(r,i={})=>{let{action:s,method:o,encType:a,formData:l,body:u}=Ik(r,e);if(i.navigate===!1){let h=i.fetcherKey||zk();await t.fetch(h,n,i.action||s,{preventScrollReset:i.preventScrollReset,formData:l,body:u,formMethod:i.method||o,formEncType:i.encType||a,flushSync:i.flushSync})}else await t.navigate(i.action||s,{preventScrollReset:i.preventScrollReset,formData:l,body:u,formMethod:i.method||o,formEncType:i.encType||a,replace:i.replace,state:i.state,fromRouteId:n,flushSync:i.flushSync,viewTransition:i.viewTransition})},[t,e,n])}function Hk(t,{relative:e}={}){let{basename:n}=k.useContext(rr),r=k.useContext(Sr);et(r,"useFormAction must be used inside a RouteContext");let[i]=r.matches.slice(-1),s={..._c(t||".",{relative:e})},o=Ji();if(t==null){s.search=o.search;let a=new URLSearchParams(s.search),l=a.getAll("index");if(l.some(h=>h==="")){a.delete("index"),l.filter(f=>f).forEach(f=>a.append("index",f));let h=a.toString();s.search=h?`?${h}`:""}}return(!t||t===".")&&i.route.index&&(s.search=s.search?s.search.replace(/^\?/,"?index&"):"?index"),n!=="/"&&(s.pathname=s.pathname==="/"?n:Mr([n,s.pathname])),Yl(s)}function Wk(t,{relative:e}={}){let n=k.useContext(Ex);et(n!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:r}=kx("useViewTransitionState"),i=_c(t,{relative:e});if(!n.isTransitioning)return!1;let s=zr(n.currentLocation.pathname,r)||n.currentLocation.pathname,o=zr(n.nextLocation.pathname,r)||n.nextLocation.pathname;return xd(i.pathname,o)!=null||xd(i.pathname,s)!=null}const Kk=()=>{};var Cw={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nx=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let i=t.charCodeAt(r);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=i&63|128):(i&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=i&63|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=i&63|128)}return e},Gk=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const i=t[n++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=t[n++];e[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){const s=t[n++],o=t[n++],a=t[n++],l=((i&7)<<18|(s&63)<<12|(o&63)<<6|a&63)-65536;e[r++]=String.fromCharCode(55296+(l>>10)),e[r++]=String.fromCharCode(56320+(l&1023))}else{const s=t[n++],o=t[n++];e[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|o&63)}}return e.join("")},Dx={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<t.length;i+=3){const s=t[i],o=i+1<t.length,a=o?t[i+1]:0,l=i+2<t.length,u=l?t[i+2]:0,h=s>>2,f=(s&3)<<4|a>>4;let m=(a&15)<<2|u>>6,E=u&63;l||(E=64,o||(m=64)),r.push(n[h],n[f],n[m],n[E])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(Nx(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):Gk(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<t.length;){const s=n[t.charAt(i++)],a=i<t.length?n[t.charAt(i)]:0;++i;const u=i<t.length?n[t.charAt(i)]:64;++i;const f=i<t.length?n[t.charAt(i)]:64;if(++i,s==null||a==null||u==null||f==null)throw new Qk;const m=s<<2|a>>4;if(r.push(m),u!==64){const E=a<<4&240|u>>2;if(r.push(E),f!==64){const _=u<<6&192|f;r.push(_)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class Qk extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const Yk=function(t){const e=Nx(t);return Dx.encodeByteArray(e,!0)},Sd=function(t){return Yk(t).replace(/\./g,"")},Vx=function(t){try{return Dx.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ox(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xk=()=>Ox().__FIREBASE_DEFAULTS__,Jk=()=>{if(typeof process>"u"||typeof Cw>"u")return;const t=Cw.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},Zk=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&Vx(t[1]);return e&&JSON.parse(e)},Eh=()=>{try{return Kk()||Xk()||Jk()||Zk()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},jx=t=>{var e,n;return(n=(e=Eh())==null?void 0:e.emulatorHosts)==null?void 0:n[t]},Lx=t=>{const e=jx(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},Mx=()=>{var t;return(t=Eh())==null?void 0:t.config},Fx=t=>{var e;return(e=Eh())==null?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eN{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zi(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function ny(t){return(await fetch(t,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ux(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",i=t.iat||0,s=t.sub||t.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o={iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}},...t};return[Sd(JSON.stringify(n)),Sd(JSON.stringify(o)),""].join(".")}const Tl={};function tN(){const t={prod:[],emulator:[]};for(const e of Object.keys(Tl))Tl[e]?t.emulator.push(e):t.prod.push(e);return t}function nN(t){let e=document.getElementById(t),n=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),n=!0),{created:n,element:e}}let bw=!1;function ry(t,e){if(typeof window>"u"||typeof document>"u"||!Zi(window.location.host)||Tl[t]===e||Tl[t]||bw)return;Tl[t]=e;function n(m){return`__firebase__banner__${m}`}const r="__firebase__banner",s=tN().prod.length>0;function o(){const m=document.getElementById(r);m&&m.remove()}function a(m){m.style.display="flex",m.style.background="#7faaf0",m.style.position="fixed",m.style.bottom="5px",m.style.left="5px",m.style.padding=".5em",m.style.borderRadius="5px",m.style.alignItems="center"}function l(m,E){m.setAttribute("width","24"),m.setAttribute("id",E),m.setAttribute("height","24"),m.setAttribute("viewBox","0 0 24 24"),m.setAttribute("fill","none"),m.style.marginLeft="-6px"}function u(){const m=document.createElement("span");return m.style.cursor="pointer",m.style.marginLeft="16px",m.style.fontSize="24px",m.innerHTML=" &times;",m.onclick=()=>{bw=!0,o()},m}function h(m,E){m.setAttribute("id",E),m.innerText="Learn more",m.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",m.setAttribute("target","__blank"),m.style.paddingLeft="5px",m.style.textDecoration="underline"}function f(){const m=nN(r),E=n("text"),_=document.getElementById(E)||document.createElement("span"),A=n("learnmore"),P=document.getElementById(A)||document.createElement("a"),v=n("preprendIcon"),w=document.getElementById(v)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(m.created){const y=m.element;a(y),h(P,A);const V=u();l(w,v),y.append(w,_,P,V),document.body.appendChild(y)}s?(_.innerText="Preview backend disconnected.",w.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(w.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,_.innerText="Preview backend running in this workspace."),_.setAttribute("id",E)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",f):f()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xt(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function rN(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(xt())}function Bx(){var e;const t=(e=Eh())==null?void 0:e.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function iN(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function $x(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function sN(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function oN(){const t=xt();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function zx(){return!Bx()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function qx(){return!Bx()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function iy(){try{return typeof indexedDB=="object"}catch{return!1}}function Hx(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var s;e(((s=i.error)==null?void 0:s.message)||"")}}catch(n){e(n)}})}function aN(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lN="FirebaseError";class zn extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=lN,Object.setPrototypeOf(this,zn.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,to.prototype.create)}}class to{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},i=`${this.service}/${e}`,s=this.errors[e],o=s?cN(s,r):"Error",a=`${this.serviceName}: ${o} (${i}).`;return new zn(i,a,r)}}function cN(t,e){return t.replace(uN,(n,r)=>{const i=e[r];return i!=null?String(i):`<${r}?>`})}const uN=/\{\$([^}]+)}/g;function dN(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function qr(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const i of n){if(!r.includes(i))return!1;const s=t[i],o=e[i];if(Rw(s)&&Rw(o)){if(!qr(s,o))return!1}else if(s!==o)return!1}for(const i of r)if(!n.includes(i))return!1;return!0}function Rw(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vc(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function ol(t){const e={};return t.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[i,s]=r.split("=");e[decodeURIComponent(i)]=decodeURIComponent(s)}}),e}function al(t){const e=t.indexOf("?");if(!e)return"";const n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}function hN(t,e){const n=new fN(t,e);return n.subscribe.bind(n)}class fN{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let i;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");pN(e,["next","error","complete"])?i=e:i={next:e,error:n,complete:r},i.next===void 0&&(i.next=Yf),i.error===void 0&&(i.error=Yf),i.complete===void 0&&(i.complete=Yf);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function pN(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function Yf(){}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mN=1e3,gN=2,yN=4*60*60*1e3,_N=.5;function Pw(t,e=mN,n=gN){const r=e*Math.pow(n,t),i=Math.round(_N*r*(Math.random()-.5)*2);return Math.min(yN,r+i)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Le(t){return t&&t._delegate?t._delegate:t}class $n{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fs="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vN{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new eN;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:n});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){const n=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),r=(e==null?void 0:e.optional)??!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(i){if(r)return null;throw i}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(EN(e))try{this.getOrInitializeService({instanceIdentifier:fs})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(n);try{const s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(e=fs){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=fs){return this.instances.has(e)}getOptions(e=fs){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[s,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(s);r===a&&o.resolve(i)}return i}onInit(e,n){const r=this.normalizeInstanceIdentifier(n),i=this.onInitCallbacks.get(r)??new Set;i.add(e),this.onInitCallbacks.set(r,i);const s=this.instances.get(r);return s&&e(s,r),()=>{i.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const i of r)try{i(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:wN(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=fs){return this.component?this.component.multipleInstances?e:fs:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function wN(t){return t===fs?void 0:t}function EN(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IN{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new vN(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ce;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Ce||(Ce={}));const TN={debug:Ce.DEBUG,verbose:Ce.VERBOSE,info:Ce.INFO,warn:Ce.WARN,error:Ce.ERROR,silent:Ce.SILENT},xN=Ce.INFO,SN={[Ce.DEBUG]:"log",[Ce.VERBOSE]:"log",[Ce.INFO]:"info",[Ce.WARN]:"warn",[Ce.ERROR]:"error"},AN=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),i=SN[e];if(i)console[i](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Ih{constructor(e){this.name=e,this._logLevel=xN,this._logHandler=AN,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Ce))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?TN[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Ce.DEBUG,...e),this._logHandler(this,Ce.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Ce.VERBOSE,...e),this._logHandler(this,Ce.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Ce.INFO,...e),this._logHandler(this,Ce.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Ce.WARN,...e),this._logHandler(this,Ce.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Ce.ERROR,...e),this._logHandler(this,Ce.ERROR,...e)}}const CN=(t,e)=>e.some(n=>t instanceof n);let kw,Nw;function bN(){return kw||(kw=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function RN(){return Nw||(Nw=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Wx=new WeakMap,_m=new WeakMap,Kx=new WeakMap,Xf=new WeakMap,sy=new WeakMap;function PN(t){const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("success",s),t.removeEventListener("error",o)},s=()=>{n(Oi(t.result)),i()},o=()=>{r(t.error),i()};t.addEventListener("success",s),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&Wx.set(n,t)}).catch(()=>{}),sy.set(e,t),e}function kN(t){if(_m.has(t))return;const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("complete",s),t.removeEventListener("error",o),t.removeEventListener("abort",o)},s=()=>{n(),i()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",s),t.addEventListener("error",o),t.addEventListener("abort",o)});_m.set(t,e)}let vm={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return _m.get(t);if(e==="objectStoreNames")return t.objectStoreNames||Kx.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Oi(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function NN(t){vm=t(vm)}function DN(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(Jf(this),e,...n);return Kx.set(r,e.sort?e.sort():[e]),Oi(r)}:RN().includes(t)?function(...e){return t.apply(Jf(this),e),Oi(Wx.get(this))}:function(...e){return Oi(t.apply(Jf(this),e))}}function VN(t){return typeof t=="function"?DN(t):(t instanceof IDBTransaction&&kN(t),CN(t,bN())?new Proxy(t,vm):t)}function Oi(t){if(t instanceof IDBRequest)return PN(t);if(Xf.has(t))return Xf.get(t);const e=VN(t);return e!==t&&(Xf.set(t,e),sy.set(e,t)),e}const Jf=t=>sy.get(t);function Gx(t,e,{blocked:n,upgrade:r,blocking:i,terminated:s}={}){const o=indexedDB.open(t,e),a=Oi(o);return r&&o.addEventListener("upgradeneeded",l=>{r(Oi(o.result),l.oldVersion,l.newVersion,Oi(o.transaction),l)}),n&&o.addEventListener("blocked",l=>n(l.oldVersion,l.newVersion,l)),a.then(l=>{s&&l.addEventListener("close",()=>s()),i&&l.addEventListener("versionchange",u=>i(u.oldVersion,u.newVersion,u))}).catch(()=>{}),a}const ON=["get","getKey","getAll","getAllKeys","count"],jN=["put","add","delete","clear"],Zf=new Map;function Dw(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Zf.get(e))return Zf.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,i=jN.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(i||ON.includes(n)))return;const s=async function(o,...a){const l=this.transaction(o,i?"readwrite":"readonly");let u=l.store;return r&&(u=u.index(a.shift())),(await Promise.all([u[n](...a),i&&l.done]))[0]};return Zf.set(e,s),s}NN(t=>({...t,get:(e,n,r)=>Dw(e,n)||t.get(e,n,r),has:(e,n)=>!!Dw(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LN{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(MN(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function MN(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const wm="@firebase/app",Vw="0.14.5";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hr=new Ih("@firebase/app"),FN="@firebase/app-compat",UN="@firebase/analytics-compat",BN="@firebase/analytics",$N="@firebase/app-check-compat",zN="@firebase/app-check",qN="@firebase/auth",HN="@firebase/auth-compat",WN="@firebase/database",KN="@firebase/data-connect",GN="@firebase/database-compat",QN="@firebase/functions",YN="@firebase/functions-compat",XN="@firebase/installations",JN="@firebase/installations-compat",ZN="@firebase/messaging",eD="@firebase/messaging-compat",tD="@firebase/performance",nD="@firebase/performance-compat",rD="@firebase/remote-config",iD="@firebase/remote-config-compat",sD="@firebase/storage",oD="@firebase/storage-compat",aD="@firebase/firestore",lD="@firebase/ai",cD="@firebase/firestore-compat",uD="firebase",dD="12.5.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Em="[DEFAULT]",hD={[wm]:"fire-core",[FN]:"fire-core-compat",[BN]:"fire-analytics",[UN]:"fire-analytics-compat",[zN]:"fire-app-check",[$N]:"fire-app-check-compat",[qN]:"fire-auth",[HN]:"fire-auth-compat",[WN]:"fire-rtdb",[KN]:"fire-data-connect",[GN]:"fire-rtdb-compat",[QN]:"fire-fn",[YN]:"fire-fn-compat",[XN]:"fire-iid",[JN]:"fire-iid-compat",[ZN]:"fire-fcm",[eD]:"fire-fcm-compat",[tD]:"fire-perf",[nD]:"fire-perf-compat",[rD]:"fire-rc",[iD]:"fire-rc-compat",[sD]:"fire-gcs",[oD]:"fire-gcs-compat",[aD]:"fire-fst",[cD]:"fire-fst-compat",[lD]:"fire-vertex","fire-js":"fire-js",[uD]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ad=new Map,fD=new Map,Im=new Map;function Ow(t,e){try{t.container.addComponent(e)}catch(n){Hr.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function er(t){const e=t.name;if(Im.has(e))return Hr.debug(`There were multiple attempts to register component ${e}.`),!1;Im.set(e,t);for(const n of Ad.values())Ow(n,t);for(const n of fD.values())Ow(n,t);return!0}function es(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function Dn(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pD={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},ji=new to("app","Firebase",pD);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mD{constructor(e,n,r){this._isDeleted=!1,this._options={...e},this._config={...n},this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new $n("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw ji.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const no=dD;function oy(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r={name:Em,automaticDataCollectionEnabled:!0,...e},i=r.name;if(typeof i!="string"||!i)throw ji.create("bad-app-name",{appName:String(i)});if(n||(n=Mx()),!n)throw ji.create("no-options");const s=Ad.get(i);if(s){if(qr(n,s.options)&&qr(r,s.config))return s;throw ji.create("duplicate-app",{appName:i})}const o=new IN(i);for(const l of Im.values())o.addComponent(l);const a=new mD(n,r,o);return Ad.set(i,a),a}function Th(t=Em){const e=Ad.get(t);if(!e&&t===Em&&Mx())return oy();if(!e)throw ji.create("no-app",{appName:t});return e}function pn(t,e,n){let r=hD[t]??t;n&&(r+=`-${n}`);const i=r.match(/\s|\//),s=e.match(/\s|\//);if(i||s){const o=[`Unable to register library "${r}" with version "${e}":`];i&&o.push(`library name "${r}" contains illegal characters (whitespace or "/")`),i&&s&&o.push("and"),s&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Hr.warn(o.join(" "));return}er(new $n(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gD="firebase-heartbeat-database",yD=1,Xl="firebase-heartbeat-store";let ep=null;function Qx(){return ep||(ep=Gx(gD,yD,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Xl)}catch(n){console.warn(n)}}}}).catch(t=>{throw ji.create("idb-open",{originalErrorMessage:t.message})})),ep}async function _D(t){try{const n=(await Qx()).transaction(Xl),r=await n.objectStore(Xl).get(Yx(t));return await n.done,r}catch(e){if(e instanceof zn)Hr.warn(e.message);else{const n=ji.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Hr.warn(n.message)}}}async function jw(t,e){try{const r=(await Qx()).transaction(Xl,"readwrite");await r.objectStore(Xl).put(e,Yx(t)),await r.done}catch(n){if(n instanceof zn)Hr.warn(n.message);else{const r=ji.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});Hr.warn(r.message)}}}function Yx(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vD=1024,wD=30;class ED{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new TD(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=Lw();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)==null?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(o=>o.date===s))return;if(this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats.length>wD){const o=xD(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){Hr.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=Lw(),{heartbeatsToSend:r,unsentEntries:i}=ID(this._heartbeatsCache.heartbeats),s=Sd(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(n){return Hr.warn(n),""}}}function Lw(){return new Date().toISOString().substring(0,10)}function ID(t,e=vD){const n=[];let r=t.slice();for(const i of t){const s=n.find(o=>o.agent===i.agent);if(s){if(s.dates.push(i.date),Mw(n)>e){s.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),Mw(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class TD{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return iy()?Hx().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await _D(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return jw(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return jw(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function Mw(t){return Sd(JSON.stringify({version:2,heartbeats:t})).length}function xD(t){if(t.length===0)return-1;let e=0,n=t[0].date;for(let r=1;r<t.length;r++)t[r].date<n&&(n=t[r].date,e=r);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function SD(t){er(new $n("platform-logger",e=>new LN(e),"PRIVATE")),er(new $n("heartbeat",e=>new ED(e),"PRIVATE")),pn(wm,Vw,t),pn(wm,Vw,"esm2020"),pn("fire-js","")}SD("");var AD="firebase",CD="12.5.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */pn(AD,CD,"app");function Xx(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const bD=Xx,Jx=new to("auth","Firebase",Xx());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cd=new Ih("@firebase/auth");function RD(t,...e){Cd.logLevel<=Ce.WARN&&Cd.warn(`Auth (${no}): ${t}`,...e)}function Mu(t,...e){Cd.logLevel<=Ce.ERROR&&Cd.error(`Auth (${no}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tr(t,...e){throw ay(t,...e)}function wr(t,...e){return ay(t,...e)}function Zx(t,e,n){const r={...bD(),[e]:n};return new to("auth","Firebase",r).create(e,{appName:t.name})}function Li(t){return Zx(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function ay(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return Jx.create(t,...e)}function fe(t,e,...n){if(!t)throw ay(e,...n)}function Vr(t){const e="INTERNAL ASSERTION FAILED: "+t;throw Mu(e),new Error(e)}function Wr(t,e){t||Vr(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tm(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.href)||""}function PD(){return Fw()==="http:"||Fw()==="https:"}function Fw(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kD(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(PD()||$x()||"connection"in navigator)?navigator.onLine:!0}function ND(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wc{constructor(e,n){this.shortDelay=e,this.longDelay=n,Wr(n>e,"Short delay should be less than long delay!"),this.isMobile=rN()||sN()}get(){return kD()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ly(t,e){Wr(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eS{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Vr("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Vr("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Vr("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DD={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VD=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],OD=new wc(3e4,6e4);function ro(t,e){return t.tenantId&&!e.tenantId?{...e,tenantId:t.tenantId}:e}async function ts(t,e,n,r,i={}){return tS(t,i,async()=>{let s={},o={};r&&(e==="GET"?o=r:s={body:JSON.stringify(r)});const a=vc({key:t.config.apiKey,...o}).slice(1),l=await t._getAdditionalHeaders();l["Content-Type"]="application/json",t.languageCode&&(l["X-Firebase-Locale"]=t.languageCode);const u={method:e,headers:l,...s};return iN()||(u.referrerPolicy="no-referrer"),t.emulatorConfig&&Zi(t.emulatorConfig.host)&&(u.credentials="include"),eS.fetch()(await nS(t,t.config.apiHost,n,a),u)})}async function tS(t,e,n){t._canInitEmulator=!1;const r={...DD,...e};try{const i=new LD(t),s=await Promise.race([n(),i.promise]);i.clearNetworkTimeout();const o=await s.json();if("needConfirmation"in o)throw hu(t,"account-exists-with-different-credential",o);if(s.ok&&!("errorMessage"in o))return o;{const a=s.ok?o.errorMessage:o.error.message,[l,u]=a.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw hu(t,"credential-already-in-use",o);if(l==="EMAIL_EXISTS")throw hu(t,"email-already-in-use",o);if(l==="USER_DISABLED")throw hu(t,"user-disabled",o);const h=r[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(u)throw Zx(t,h,u);tr(t,h)}}catch(i){if(i instanceof zn)throw i;tr(t,"network-request-failed",{message:String(i)})}}async function xh(t,e,n,r,i={}){const s=await ts(t,e,n,r,i);return"mfaPendingCredential"in s&&tr(t,"multi-factor-auth-required",{_serverResponse:s}),s}async function nS(t,e,n,r){const i=`${e}${n}?${r}`,s=t,o=s.config.emulator?ly(t.config,i):`${t.config.apiScheme}://${i}`;return VD.includes(n)&&(await s._persistenceManagerAvailable,s._getPersistenceType()==="COOKIE")?s._getPersistence()._getFinalTarget(o).toString():o}function jD(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class LD{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(wr(this.auth,"network-request-failed")),OD.get())})}}function hu(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const i=wr(t,e,r);return i.customData._tokenResponse=n,i}function Uw(t){return t!==void 0&&t.enterprise!==void 0}class MD{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const n of this.recaptchaEnforcementState)if(n.provider&&n.provider===e)return jD(n.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function FD(t,e){return ts(t,"GET","/v2/recaptchaConfig",ro(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function UD(t,e){return ts(t,"POST","/v1/accounts:delete",e)}async function bd(t,e){return ts(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xl(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function BD(t,e=!1){const n=Le(t),r=await n.getIdToken(e),i=cy(r);fe(i&&i.exp&&i.auth_time&&i.iat,n.auth,"internal-error");const s=typeof i.firebase=="object"?i.firebase:void 0,o=s==null?void 0:s.sign_in_provider;return{claims:i,token:r,authTime:xl(tp(i.auth_time)),issuedAtTime:xl(tp(i.iat)),expirationTime:xl(tp(i.exp)),signInProvider:o||null,signInSecondFactor:(s==null?void 0:s.sign_in_second_factor)||null}}function tp(t){return Number(t)*1e3}function cy(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return Mu("JWT malformed, contained fewer than 3 sections"),null;try{const i=Vx(n);return i?JSON.parse(i):(Mu("Failed to decode base64 JWT payload"),null)}catch(i){return Mu("Caught error parsing JWT payload as JSON",i==null?void 0:i.toString()),null}}function Bw(t){const e=cy(t);return fe(e,"internal-error"),fe(typeof e.exp<"u","internal-error"),fe(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Jl(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof zn&&$D(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function $D({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zD{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const r=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xm{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=xl(this.lastLoginAt),this.creationTime=xl(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Rd(t){var f;const e=t.auth,n=await t.getIdToken(),r=await Jl(t,bd(e,{idToken:n}));fe(r==null?void 0:r.users.length,e,"internal-error");const i=r.users[0];t._notifyReloadListener(i);const s=(f=i.providerUserInfo)!=null&&f.length?rS(i.providerUserInfo):[],o=HD(t.providerData,s),a=t.isAnonymous,l=!(t.email&&i.passwordHash)&&!(o!=null&&o.length),u=a?l:!1,h={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:o,metadata:new xm(i.createdAt,i.lastLoginAt),isAnonymous:u};Object.assign(t,h)}async function qD(t){const e=Le(t);await Rd(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function HD(t,e){return[...t.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function rS(t){return t.map(({providerId:e,...n})=>({providerId:e,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function WD(t,e){const n=await tS(t,{},async()=>{const r=vc({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=t.config,o=await nS(t,i,"/v1/token",`key=${s}`),a=await t._getAdditionalHeaders();a["Content-Type"]="application/x-www-form-urlencoded";const l={method:"POST",headers:a,body:r};return t.emulatorConfig&&Zi(t.emulatorConfig.host)&&(l.credentials="include"),eS.fetch()(o,l)});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function KD(t,e){return ts(t,"POST","/v2/accounts:revokeToken",ro(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zo{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){fe(e.idToken,"internal-error"),fe(typeof e.idToken<"u","internal-error"),fe(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Bw(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){fe(e.length!==0,"internal-error");const n=Bw(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(fe(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:i,expiresIn:s}=await WD(e,n);this.updateTokensAndExpiration(r,i,Number(s))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:i,expirationTime:s}=n,o=new zo;return r&&(fe(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),i&&(fe(typeof i=="string","internal-error",{appName:e}),o.accessToken=i),s&&(fe(typeof s=="number","internal-error",{appName:e}),o.expirationTime=s),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new zo,this.toJSON())}_performRefresh(){return Vr("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function li(t,e){fe(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class Qn{constructor({uid:e,auth:n,stsTokenManager:r,...i}){this.providerId="firebase",this.proactiveRefresh=new zD(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=n,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new xm(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const n=await Jl(this,this.stsTokenManager.getToken(this.auth,e));return fe(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return BD(this,e)}reload(){return qD(this)}_assign(e){this!==e&&(fe(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>({...n})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new Qn({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return n.metadata._copy(this.metadata),n}_onReload(e){fe(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await Rd(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Dn(this.auth.app))return Promise.reject(Li(this.auth));const e=await this.getIdToken();return await Jl(this,UD(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){const r=n.displayName??void 0,i=n.email??void 0,s=n.phoneNumber??void 0,o=n.photoURL??void 0,a=n.tenantId??void 0,l=n._redirectEventId??void 0,u=n.createdAt??void 0,h=n.lastLoginAt??void 0,{uid:f,emailVerified:m,isAnonymous:E,providerData:_,stsTokenManager:A}=n;fe(f&&A,e,"internal-error");const P=zo.fromJSON(this.name,A);fe(typeof f=="string",e,"internal-error"),li(r,e.name),li(i,e.name),fe(typeof m=="boolean",e,"internal-error"),fe(typeof E=="boolean",e,"internal-error"),li(s,e.name),li(o,e.name),li(a,e.name),li(l,e.name),li(u,e.name),li(h,e.name);const v=new Qn({uid:f,auth:e,email:i,emailVerified:m,displayName:r,isAnonymous:E,photoURL:o,phoneNumber:s,tenantId:a,stsTokenManager:P,createdAt:u,lastLoginAt:h});return _&&Array.isArray(_)&&(v.providerData=_.map(w=>({...w}))),l&&(v._redirectEventId=l),v}static async _fromIdTokenResponse(e,n,r=!1){const i=new zo;i.updateFromServerResponse(n);const s=new Qn({uid:n.localId,auth:e,stsTokenManager:i,isAnonymous:r});return await Rd(s),s}static async _fromGetAccountInfoResponse(e,n,r){const i=n.users[0];fe(i.localId!==void 0,"internal-error");const s=i.providerUserInfo!==void 0?rS(i.providerUserInfo):[],o=!(i.email&&i.passwordHash)&&!(s!=null&&s.length),a=new zo;a.updateFromIdToken(r);const l=new Qn({uid:i.localId,auth:e,stsTokenManager:a,isAnonymous:o}),u={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new xm(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!(s!=null&&s.length)};return Object.assign(l,u),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $w=new Map;function Or(t){Wr(t instanceof Function,"Expected a class definition");let e=$w.get(t);return e?(Wr(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,$w.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iS{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}iS.type="NONE";const zw=iS;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fu(t,e,n){return`firebase:${t}:${e}:${n}`}class qo{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:i,name:s}=this.auth;this.fullUserKey=Fu(this.userKey,i.apiKey,s),this.fullPersistenceKey=Fu("persistence",i.apiKey,s),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const n=await bd(this.auth,{idToken:e}).catch(()=>{});return n?Qn._fromGetAccountInfoResponse(this.auth,n,e):null}return Qn._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new qo(Or(zw),e,r);const i=(await Promise.all(n.map(async u=>{if(await u._isAvailable())return u}))).filter(u=>u);let s=i[0]||Or(zw);const o=Fu(r,e.config.apiKey,e.name);let a=null;for(const u of n)try{const h=await u._get(o);if(h){let f;if(typeof h=="string"){const m=await bd(e,{idToken:h}).catch(()=>{});if(!m)break;f=await Qn._fromGetAccountInfoResponse(e,m,h)}else f=Qn._fromJSON(e,h);u!==s&&(a=f),s=u;break}}catch{}const l=i.filter(u=>u._shouldAllowMigration);return!s._shouldAllowMigration||!l.length?new qo(s,e,r):(s=l[0],a&&await s._set(o,a.toJSON()),await Promise.all(n.map(async u=>{if(u!==s)try{await u._remove(o)}catch{}})),new qo(s,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qw(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(lS(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(sS(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(uS(e))return"Blackberry";if(dS(e))return"Webos";if(oS(e))return"Safari";if((e.includes("chrome/")||aS(e))&&!e.includes("edge/"))return"Chrome";if(cS(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function sS(t=xt()){return/firefox\//i.test(t)}function oS(t=xt()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function aS(t=xt()){return/crios\//i.test(t)}function lS(t=xt()){return/iemobile/i.test(t)}function cS(t=xt()){return/android/i.test(t)}function uS(t=xt()){return/blackberry/i.test(t)}function dS(t=xt()){return/webos/i.test(t)}function uy(t=xt()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function GD(t=xt()){var e;return uy(t)&&!!((e=window.navigator)!=null&&e.standalone)}function QD(){return oN()&&document.documentMode===10}function hS(t=xt()){return uy(t)||cS(t)||dS(t)||uS(t)||/windows phone/i.test(t)||lS(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fS(t,e=[]){let n;switch(t){case"Browser":n=qw(xt());break;case"Worker":n=`${qw(xt())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${no}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YD{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=s=>new Promise((o,a)=>{try{const l=e(s);o(l)}catch(l){a(l)}});r.onAbort=n,this.queue.push(r);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const i of n)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function XD(t,e={}){return ts(t,"GET","/v2/passwordPolicy",ro(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JD=6;class ZD{constructor(e){var r;const n=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=n.minPasswordLength??JD,n.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=n.maxPasswordLength),n.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=n.containsLowercaseCharacter),n.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=n.containsUppercaseCharacter),n.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=n.containsNumericCharacter),n.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=n.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=((r=e.allowedNonAlphanumericCharacters)==null?void 0:r.join(""))??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const n={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,n),this.validatePasswordCharacterOptions(e,n),n.isValid&&(n.isValid=n.meetsMinPasswordLength??!0),n.isValid&&(n.isValid=n.meetsMaxPasswordLength??!0),n.isValid&&(n.isValid=n.containsLowercaseLetter??!0),n.isValid&&(n.isValid=n.containsUppercaseLetter??!0),n.isValid&&(n.isValid=n.containsNumericCharacter??!0),n.isValid&&(n.isValid=n.containsNonAlphanumericCharacter??!0),n}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),i&&(n.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e2{constructor(e,n,r,i){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Hw(this),this.idTokenSubscription=new Hw(this),this.beforeStateQueue=new YD(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Jx,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion,this._persistenceManagerAvailable=new Promise(s=>this._resolvePersistenceManagerAvailable=s)}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=Or(n)),this._initializationPromise=this.queue(async()=>{var r,i,s;if(!this._deleted&&(this.persistenceManager=await qo.create(this,e),(r=this._resolvePersistenceManagerAvailable)==null||r.call(this),!this._deleted)){if((i=this._popupRedirectResolver)!=null&&i._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((s=this.currentUser)==null?void 0:s.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await bd(this,{idToken:e}),r=await Qn._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(r)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var s;if(Dn(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(a,a))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let r=n,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(s=this.redirectUser)==null?void 0:s._redirectEventId,a=r==null?void 0:r._redirectEventId,l=await this.tryRedirectSignIn(e);(!o||o===a)&&(l!=null&&l.user)&&(r=l.user,i=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(r)}catch(o){r=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return fe(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await Rd(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=ND()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Dn(this.app))return Promise.reject(Li(this));const n=e?Le(e):null;return n&&fe(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&fe(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Dn(this.app)?Promise.reject(Li(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Dn(this.app)?Promise.reject(Li(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Or(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await XD(this),n=new ZD(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new to("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),await KD(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)==null?void 0:e.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&Or(e)||this._popupRedirectResolver;fe(n,this,"argument-error"),this.redirectPersistenceManager=await qo.create(this,[Or(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)==null?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)==null?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=((n=this.currentUser)==null?void 0:n.uid)??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,i){if(this._deleted)return()=>{};const s=typeof n=="function"?n:n.next.bind(n);let o=!1;const a=this._isInitialized?Promise.resolve():this._initializationPromise;if(fe(a,this,"internal-error"),a.then(()=>{o||s(this.currentUser)}),typeof n=="function"){const l=e.addObserver(n,r,i);return()=>{o=!0,l()}}else{const l=e.addObserver(n);return()=>{o=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return fe(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=fS(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var i;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const n=await((i=this.heartbeatServiceProvider.getImmediate({optional:!0}))==null?void 0:i.getHeartbeatsHeader());n&&(e["X-Firebase-Client"]=n);const r=await this._getAppCheckToken();return r&&(e["X-Firebase-AppCheck"]=r),e}async _getAppCheckToken(){var n;if(Dn(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await((n=this.appCheckServiceProvider.getImmediate({optional:!0}))==null?void 0:n.getToken());return e!=null&&e.error&&RD(`Error while retrieving App Check token: ${e.error}`),e==null?void 0:e.token}}function Ia(t){return Le(t)}class Hw{constructor(e){this.auth=e,this.observer=null,this.addObserver=hN(n=>this.observer=n)}get next(){return fe(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Sh={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function t2(t){Sh=t}function pS(t){return Sh.loadJS(t)}function n2(){return Sh.recaptchaEnterpriseScript}function r2(){return Sh.gapiScript}function i2(t){return`__${t}${Math.floor(Math.random()*1e6)}`}class s2{constructor(){this.enterprise=new o2}ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}class o2{ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}const a2="recaptcha-enterprise",mS="NO_RECAPTCHA";class l2{constructor(e){this.type=a2,this.auth=Ia(e)}async verify(e="verify",n=!1){async function r(s){if(!n){if(s.tenantId==null&&s._agentRecaptchaConfig!=null)return s._agentRecaptchaConfig.siteKey;if(s.tenantId!=null&&s._tenantRecaptchaConfigs[s.tenantId]!==void 0)return s._tenantRecaptchaConfigs[s.tenantId].siteKey}return new Promise(async(o,a)=>{FD(s,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(l=>{if(l.recaptchaKey===void 0)a(new Error("recaptcha Enterprise site key undefined"));else{const u=new MD(l);return s.tenantId==null?s._agentRecaptchaConfig=u:s._tenantRecaptchaConfigs[s.tenantId]=u,o(u.siteKey)}}).catch(l=>{a(l)})})}function i(s,o,a){const l=window.grecaptcha;Uw(l)?l.enterprise.ready(()=>{l.enterprise.execute(s,{action:e}).then(u=>{o(u)}).catch(()=>{o(mS)})}):a(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new s2().execute("siteKey",{action:"verify"}):new Promise((s,o)=>{r(this.auth).then(a=>{if(!n&&Uw(window.grecaptcha))i(a,s,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let l=n2();l.length!==0&&(l+=a),pS(l).then(()=>{i(a,s,o)}).catch(u=>{o(u)})}}).catch(a=>{o(a)})})}}async function Ww(t,e,n,r=!1,i=!1){const s=new l2(t);let o;if(i)o=mS;else try{o=await s.verify(n)}catch{o=await s.verify(n,!0)}const a={...e};if(n==="mfaSmsEnrollment"||n==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in a){const l=a.phoneEnrollmentInfo.phoneNumber,u=a.phoneEnrollmentInfo.recaptchaToken;Object.assign(a,{phoneEnrollmentInfo:{phoneNumber:l,recaptchaToken:u,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in a){const l=a.phoneSignInInfo.recaptchaToken;Object.assign(a,{phoneSignInInfo:{recaptchaToken:l,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return a}return r?Object.assign(a,{captchaResp:o}):Object.assign(a,{captchaResponse:o}),Object.assign(a,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(a,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),a}async function Kw(t,e,n,r,i){var s;if((s=t._getRecaptchaConfig())!=null&&s.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const o=await Ww(t,e,n,n==="getOobCode");return r(t,o)}else return r(t,e).catch(async o=>{if(o.code==="auth/missing-recaptcha-token"){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const a=await Ww(t,e,n,n==="getOobCode");return r(t,a)}else return Promise.reject(o)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function c2(t,e){const n=es(t,"auth");if(n.isInitialized()){const i=n.getImmediate(),s=n.getOptions();if(qr(s,e??{}))return i;tr(i,"already-initialized")}return n.initialize({options:e})}function u2(t,e){const n=(e==null?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(Or);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function d2(t,e,n){const r=Ia(t);fe(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const i=!1,s=gS(e),{host:o,port:a}=h2(e),l=a===null?"":`:${a}`,u={url:`${s}//${o}${l}/`},h=Object.freeze({host:o,port:a,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!r._canInitEmulator){fe(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),fe(qr(u,r.config.emulator)&&qr(h,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=u,r.emulatorConfig=h,r.settings.appVerificationDisabledForTesting=!0,Zi(o)?(ny(`${s}//${o}${l}`),ry("Auth",!0)):f2()}function gS(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function h2(t){const e=gS(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const s=i[1];return{host:s,port:Gw(r.substr(s.length+1))}}else{const[s,o]=r.split(":");return{host:s,port:Gw(o)}}}function Gw(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function f2(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dy{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return Vr("not implemented")}_getIdTokenResponse(e){return Vr("not implemented")}_linkToIdToken(e,n){return Vr("not implemented")}_getReauthenticationResolver(e){return Vr("not implemented")}}async function p2(t,e){return ts(t,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function m2(t,e){return xh(t,"POST","/v1/accounts:signInWithPassword",ro(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function g2(t,e){return xh(t,"POST","/v1/accounts:signInWithEmailLink",ro(t,e))}async function y2(t,e){return xh(t,"POST","/v1/accounts:signInWithEmailLink",ro(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zl extends dy{constructor(e,n,r,i=null){super("password",r),this._email=e,this._password=n,this._tenantId=i}static _fromEmailAndPassword(e,n){return new Zl(e,n,"password")}static _fromEmailAndCode(e,n,r=null){return new Zl(e,n,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;if(n!=null&&n.email&&(n!=null&&n.password)){if(n.signInMethod==="password")return this._fromEmailAndPassword(n.email,n.password);if(n.signInMethod==="emailLink")return this._fromEmailAndCode(n.email,n.password,n.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const n={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Kw(e,n,"signInWithPassword",m2);case"emailLink":return g2(e,{email:this._email,oobCode:this._password});default:tr(e,"internal-error")}}async _linkToIdToken(e,n){switch(this.signInMethod){case"password":const r={idToken:n,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Kw(e,r,"signUpPassword",p2);case"emailLink":return y2(e,{idToken:n,email:this._email,oobCode:this._password});default:tr(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ho(t,e){return xh(t,"POST","/v1/accounts:signInWithIdp",ro(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _2="http://localhost";class Fs extends dy{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new Fs(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):tr("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i,...s}=n;if(!r||!i)return null;const o=new Fs(r,i);return o.idToken=s.idToken||void 0,o.accessToken=s.accessToken||void 0,o.secret=s.secret,o.nonce=s.nonce,o.pendingToken=s.pendingToken||null,o}_getIdTokenResponse(e){const n=this.buildRequest();return Ho(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,Ho(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,Ho(e,n)}buildRequest(){const e={requestUri:_2,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=vc(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function v2(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function w2(t){const e=ol(al(t)).link,n=e?ol(al(e)).deep_link_id:null,r=ol(al(t)).deep_link_id;return(r?ol(al(r)).link:null)||r||n||e||t}class hy{constructor(e){const n=ol(al(e)),r=n.apiKey??null,i=n.oobCode??null,s=v2(n.mode??null);fe(r&&i&&s,"argument-error"),this.apiKey=r,this.operation=s,this.code=i,this.continueUrl=n.continueUrl??null,this.languageCode=n.lang??null,this.tenantId=n.tenantId??null}static parseLink(e){const n=w2(e);try{return new hy(n)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ta{constructor(){this.providerId=Ta.PROVIDER_ID}static credential(e,n){return Zl._fromEmailAndPassword(e,n)}static credentialWithLink(e,n){const r=hy.parseLink(n);return fe(r,"argument-error"),Zl._fromEmailAndCode(e,r.code,r.tenantId)}}Ta.PROVIDER_ID="password";Ta.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Ta.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yS{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ec extends yS{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yi extends Ec{constructor(){super("facebook.com")}static credential(e){return Fs._fromParams({providerId:yi.PROVIDER_ID,signInMethod:yi.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return yi.credentialFromTaggedObject(e)}static credentialFromError(e){return yi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return yi.credential(e.oauthAccessToken)}catch{return null}}}yi.FACEBOOK_SIGN_IN_METHOD="facebook.com";yi.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _i extends Ec{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return Fs._fromParams({providerId:_i.PROVIDER_ID,signInMethod:_i.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return _i.credentialFromTaggedObject(e)}static credentialFromError(e){return _i.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return _i.credential(n,r)}catch{return null}}}_i.GOOGLE_SIGN_IN_METHOD="google.com";_i.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vi extends Ec{constructor(){super("github.com")}static credential(e){return Fs._fromParams({providerId:vi.PROVIDER_ID,signInMethod:vi.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return vi.credentialFromTaggedObject(e)}static credentialFromError(e){return vi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return vi.credential(e.oauthAccessToken)}catch{return null}}}vi.GITHUB_SIGN_IN_METHOD="github.com";vi.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wi extends Ec{constructor(){super("twitter.com")}static credential(e,n){return Fs._fromParams({providerId:wi.PROVIDER_ID,signInMethod:wi.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return wi.credentialFromTaggedObject(e)}static credentialFromError(e){return wi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return wi.credential(n,r)}catch{return null}}}wi.TWITTER_SIGN_IN_METHOD="twitter.com";wi.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ra{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,i=!1){const s=await Qn._fromIdTokenResponse(e,r,i),o=Qw(r);return new ra({user:s,providerId:o,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const i=Qw(r);return new ra({user:e,providerId:i,_tokenResponse:r,operationType:n})}}function Qw(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pd extends zn{constructor(e,n,r,i){super(n.code,n.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,Pd.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,i){return new Pd(e,n,r,i)}}function _S(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?Pd._fromErrorAndOperation(t,s,e,r):s})}async function E2(t,e,n=!1){const r=await Jl(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return ra._forOperation(t,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function I2(t,e,n=!1){const{auth:r}=t;if(Dn(r.app))return Promise.reject(Li(r));const i="reauthenticate";try{const s=await Jl(t,_S(r,i,e,t),n);fe(s.idToken,r,"internal-error");const o=cy(s.idToken);fe(o,r,"internal-error");const{sub:a}=o;return fe(t.uid===a,r,"user-mismatch"),ra._forOperation(t,i,s)}catch(s){throw(s==null?void 0:s.code)==="auth/user-not-found"&&tr(r,"user-mismatch"),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function vS(t,e,n=!1){if(Dn(t.app))return Promise.reject(Li(t));const r="signIn",i=await _S(t,r,e),s=await ra._fromIdTokenResponse(t,r,i);return n||await t._updateCurrentUser(s.user),s}async function T2(t,e){return vS(Ia(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function x2(t){const e=Ia(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}function S2(t,e,n){return Dn(t.app)?Promise.reject(Li(t)):T2(Le(t),Ta.credential(e,n)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&x2(t),r})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function A2(t,e){return Le(t).setPersistence(e)}function C2(t,e,n,r){return Le(t).onIdTokenChanged(e,n,r)}function b2(t,e,n){return Le(t).beforeAuthStateChanged(e,n)}function fy(t,e,n,r){return Le(t).onAuthStateChanged(e,n,r)}function R2(t){return Le(t).signOut()}const kd="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wS{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(kd,"1"),this.storage.removeItem(kd),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const P2=1e3,k2=10;class ES extends wS{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=hS(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),i=this.localCache[n];r!==i&&e(n,i,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((o,a,l)=>{this.notifyListeners(o,l)});return}const r=e.key;n?this.detachListener():this.stopPolling();const i=()=>{const o=this.storage.getItem(r);!n&&this.localCache[r]===o||this.notifyListeners(r,o)},s=this.storage.getItem(r);QD()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,k2):i()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},P2)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}ES.type="LOCAL";const IS=ES;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TS extends wS{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}TS.type="SESSION";const xS=TS;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function N2(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ah{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(i=>i.isListeningto(e));if(n)return n;const r=new Ah(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:i,data:s}=n.data,o=this.handlersMap[i];if(!(o!=null&&o.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:i});const a=Array.from(o).map(async u=>u(n.origin,s)),l=await N2(a);n.ports[0].postMessage({status:"done",eventId:r,eventType:i,response:l})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Ah.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function py(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class D2{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,o;return new Promise((a,l)=>{const u=py("",20);i.port1.start();const h=setTimeout(()=>{l(new Error("unsupported_event"))},r);o={messageChannel:i,onMessage(f){const m=f;if(m.data.eventId===u)switch(m.data.status){case"ack":clearTimeout(h),s=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),a(m.data.response);break;default:clearTimeout(h),clearTimeout(s),l(new Error("invalid_response"));break}}},this.handlers.add(o),i.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:u,data:n},[i.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Er(){return window}function V2(t){Er().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function SS(){return typeof Er().WorkerGlobalScope<"u"&&typeof Er().importScripts=="function"}async function O2(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function j2(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)==null?void 0:t.controller)||null}function L2(){return SS()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AS="firebaseLocalStorageDb",M2=1,Nd="firebaseLocalStorage",CS="fbase_key";class Ic{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function Ch(t,e){return t.transaction([Nd],e?"readwrite":"readonly").objectStore(Nd)}function F2(){const t=indexedDB.deleteDatabase(AS);return new Ic(t).toPromise()}function Sm(){const t=indexedDB.open(AS,M2);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(Nd,{keyPath:CS})}catch(i){n(i)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(Nd)?e(r):(r.close(),await F2(),e(await Sm()))})})}async function Yw(t,e,n){const r=Ch(t,!0).put({[CS]:e,value:n});return new Ic(r).toPromise()}async function U2(t,e){const n=Ch(t,!1).get(e),r=await new Ic(n).toPromise();return r===void 0?null:r.value}function Xw(t,e){const n=Ch(t,!0).delete(e);return new Ic(n).toPromise()}const B2=800,$2=3;class bS{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Sm(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>$2)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return SS()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Ah._getInstance(L2()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var n,r;if(this.activeServiceWorker=await O2(),!this.activeServiceWorker)return;this.sender=new D2(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&(n=e[0])!=null&&n.fulfilled&&(r=e[0])!=null&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||j2()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Sm();return await Yw(e,kd,"1"),await Xw(e,kd),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>Yw(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>U2(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>Xw(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const s=Ch(i,!1).getAll();return new Ic(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;if(e.length!==0)for(const{fbase_key:i,value:s}of e)r.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(s)&&(this.notifyListeners(i,s),n.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!r.has(i)&&(this.notifyListeners(i,null),n.push(i));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),B2)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}bS.type="LOCAL";const z2=bS;new wc(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function q2(t,e){return e?Or(e):(fe(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class my extends dy{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Ho(e,this._buildIdpRequest())}_linkToIdToken(e,n){return Ho(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return Ho(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function H2(t){return vS(t.auth,new my(t),t.bypassAuthState)}function W2(t){const{auth:e,user:n}=t;return fe(n,e,"internal-error"),I2(n,new my(t),t.bypassAuthState)}async function K2(t){const{auth:e,user:n}=t;return fe(n,e,"internal-error"),E2(n,new my(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RS{constructor(e,n,r,i,s=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:i,tenantId:s,error:o,type:a}=e;if(o){this.reject(o);return}const l={auth:this.auth,requestUri:n,sessionId:r,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(l))}catch(u){this.reject(u)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return H2;case"linkViaPopup":case"linkViaRedirect":return K2;case"reauthViaPopup":case"reauthViaRedirect":return W2;default:tr(this.auth,"internal-error")}}resolve(e){Wr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Wr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const G2=new wc(2e3,1e4);class jo extends RS{constructor(e,n,r,i,s){super(e,n,i,s),this.provider=r,this.authWindow=null,this.pollId=null,jo.currentPopupAction&&jo.currentPopupAction.cancel(),jo.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return fe(e,this.auth,"internal-error"),e}async onExecution(){Wr(this.filter.length===1,"Popup operations only handle one event");const e=py();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(wr(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)==null?void 0:e.associatedEvent)||null}cancel(){this.reject(wr(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,jo.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,r;if((r=(n=this.authWindow)==null?void 0:n.window)!=null&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(wr(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,G2.get())};e()}}jo.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Q2="pendingRedirect",Uu=new Map;class Y2 extends RS{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=Uu.get(this.auth._key());if(!e){try{const r=await X2(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}Uu.set(this.auth._key(),e)}return this.bypassAuthState||Uu.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function X2(t,e){const n=eV(e),r=Z2(t);if(!await r._isAvailable())return!1;const i=await r._get(n)==="true";return await r._remove(n),i}function J2(t,e){Uu.set(t._key(),e)}function Z2(t){return Or(t._redirectPersistence)}function eV(t){return Fu(Q2,t.config.apiKey,t.name)}async function tV(t,e,n=!1){if(Dn(t.app))return Promise.reject(Li(t));const r=Ia(t),i=q2(r,e),o=await new Y2(r,i,n).execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nV=10*60*1e3;class rV{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!iV(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!PS(e)){const i=((r=e.error.code)==null?void 0:r.split("auth/")[1])||"internal-error";n.onError(wr(this.auth,i))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=nV&&this.cachedEventUids.clear(),this.cachedEventUids.has(Jw(e))}saveEventToCache(e){this.cachedEventUids.add(Jw(e)),this.lastProcessedEventTime=Date.now()}}function Jw(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function PS({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function iV(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return PS(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function sV(t,e={}){return ts(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oV=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,aV=/^https?/;async function lV(t){if(t.config.emulator)return;const{authorizedDomains:e}=await sV(t);for(const n of e)try{if(cV(n))return}catch{}tr(t,"unauthorized-domain")}function cV(t){const e=Tm(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&o.hostname===r}if(!aV.test(n))return!1;if(oV.test(t))return r===t;const i=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uV=new wc(3e4,6e4);function Zw(){const t=Er().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function dV(t){return new Promise((e,n)=>{var i,s,o;function r(){Zw(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{Zw(),n(wr(t,"network-request-failed"))},timeout:uV.get()})}if((s=(i=Er().gapi)==null?void 0:i.iframes)!=null&&s.Iframe)e(gapi.iframes.getContext());else if((o=Er().gapi)!=null&&o.load)r();else{const a=i2("iframefcb");return Er()[a]=()=>{gapi.load?r():n(wr(t,"network-request-failed"))},pS(`${r2()}?onload=${a}`).catch(l=>n(l))}}).catch(e=>{throw Bu=null,e})}let Bu=null;function hV(t){return Bu=Bu||dV(t),Bu}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fV=new wc(5e3,15e3),pV="__/auth/iframe",mV="emulator/auth/iframe",gV={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},yV=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function _V(t){const e=t.config;fe(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?ly(e,mV):`https://${t.config.authDomain}/${pV}`,r={apiKey:e.apiKey,appName:t.name,v:no},i=yV.get(t.config.apiHost);i&&(r.eid=i);const s=t._getFrameworks();return s.length&&(r.fw=s.join(",")),`${n}?${vc(r).slice(1)}`}async function vV(t){const e=await hV(t),n=Er().gapi;return fe(n,t,"internal-error"),e.open({where:document.body,url:_V(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:gV,dontclear:!0},r=>new Promise(async(i,s)=>{await r.restyle({setHideOnLeave:!1});const o=wr(t,"network-request-failed"),a=Er().setTimeout(()=>{s(o)},fV.get());function l(){Er().clearTimeout(a),i(r)}r.ping(l).then(l,()=>{s(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wV={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},EV=500,IV=600,TV="_blank",xV="http://localhost";class eE{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function SV(t,e,n,r=EV,i=IV){const s=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let a="";const l={...wV,width:r.toString(),height:i.toString(),top:s,left:o},u=xt().toLowerCase();n&&(a=aS(u)?TV:n),sS(u)&&(e=e||xV,l.scrollbars="yes");const h=Object.entries(l).reduce((m,[E,_])=>`${m}${E}=${_},`,"");if(GD(u)&&a!=="_self")return AV(e||"",a),new eE(null);const f=window.open(e||"",a,h);fe(f,t,"popup-blocked");try{f.focus()}catch{}return new eE(f)}function AV(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CV="__/auth/handler",bV="emulator/auth/handler",RV=encodeURIComponent("fac");async function tE(t,e,n,r,i,s){fe(t.config.authDomain,t,"auth-domain-config-required"),fe(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:no,eventId:i};if(e instanceof yS){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",dN(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[h,f]of Object.entries({}))o[h]=f}if(e instanceof Ec){const h=e.getScopes().filter(f=>f!=="");h.length>0&&(o.scopes=h.join(","))}t.tenantId&&(o.tid=t.tenantId);const a=o;for(const h of Object.keys(a))a[h]===void 0&&delete a[h];const l=await t._getAppCheckToken(),u=l?`#${RV}=${encodeURIComponent(l)}`:"";return`${PV(t)}?${vc(a).slice(1)}${u}`}function PV({config:t}){return t.emulator?ly(t,bV):`https://${t.authDomain}/${CV}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const np="webStorageSupport";class kV{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=xS,this._completeRedirectFn=tV,this._overrideRedirectResult=J2}async _openPopup(e,n,r,i){var o;Wr((o=this.eventManagers[e._key()])==null?void 0:o.manager,"_initialize() not called before _openPopup()");const s=await tE(e,n,r,Tm(),i);return SV(e,s,py())}async _openRedirect(e,n,r,i){await this._originValidation(e);const s=await tE(e,n,r,Tm(),i);return V2(s),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:i,promise:s}=this.eventManagers[n];return i?Promise.resolve(i):(Wr(s,"If manager is not set, promise should be"),s)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await vV(e),r=new rV(e);return n.register("authEvent",i=>(fe(i==null?void 0:i.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(np,{type:np},i=>{var o;const s=(o=i==null?void 0:i[0])==null?void 0:o[np];s!==void 0&&n(!!s),tr(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=lV(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return hS()||oS()||uy()}}const NV=kV;var nE="@firebase/auth",rE="1.11.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DV{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)==null?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){fe(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VV(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function OV(t){er(new $n("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=r.options;fe(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const l={apiKey:o,authDomain:a,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:fS(t)},u=new e2(r,i,s,l);return u2(u,n),u},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),er(new $n("auth-internal",e=>{const n=Ia(e.getProvider("auth").getImmediate());return(r=>new DV(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),pn(nE,rE,VV(t)),pn(nE,rE,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jV=5*60,LV=Fx("authIdTokenMaxAge")||jV;let iE=null;const MV=t=>async e=>{const n=e&&await e.getIdTokenResult(),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>LV)return;const i=n==null?void 0:n.token;iE!==i&&(iE=i,await fetch(t,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function kS(t=Th()){const e=es(t,"auth");if(e.isInitialized())return e.getImmediate();const n=c2(t,{popupRedirectResolver:NV,persistence:[z2,IS,xS]}),r=Fx("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const s=new URL(r,location.origin);if(location.origin===s.origin){const o=MV(s.toString());b2(n,o,()=>o(n.currentUser)),C2(n,a=>o(a))}}const i=jx("auth");return i&&d2(n,`http://${i}`),n}function FV(){var t;return((t=document.getElementsByTagName("head"))==null?void 0:t[0])??document}t2({loadJS(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=i=>{const s=wr("internal-error");s.customData=i,n(s)},r.type="text/javascript",r.charset="UTF-8",FV().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});OV("Browser");var sE=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Mi,NS;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(S,I){function C(){}C.prototype=I.prototype,S.F=I.prototype,S.prototype=new C,S.prototype.constructor=S,S.D=function(R,N,D){for(var b=Array(arguments.length-2),Q=2;Q<arguments.length;Q++)b[Q-2]=arguments[Q];return I.prototype[N].apply(R,b)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(r,n),r.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(S,I,C){C||(C=0);const R=Array(16);if(typeof I=="string")for(var N=0;N<16;++N)R[N]=I.charCodeAt(C++)|I.charCodeAt(C++)<<8|I.charCodeAt(C++)<<16|I.charCodeAt(C++)<<24;else for(N=0;N<16;++N)R[N]=I[C++]|I[C++]<<8|I[C++]<<16|I[C++]<<24;I=S.g[0],C=S.g[1],N=S.g[2];let D=S.g[3],b;b=I+(D^C&(N^D))+R[0]+3614090360&4294967295,I=C+(b<<7&4294967295|b>>>25),b=D+(N^I&(C^N))+R[1]+3905402710&4294967295,D=I+(b<<12&4294967295|b>>>20),b=N+(C^D&(I^C))+R[2]+606105819&4294967295,N=D+(b<<17&4294967295|b>>>15),b=C+(I^N&(D^I))+R[3]+3250441966&4294967295,C=N+(b<<22&4294967295|b>>>10),b=I+(D^C&(N^D))+R[4]+4118548399&4294967295,I=C+(b<<7&4294967295|b>>>25),b=D+(N^I&(C^N))+R[5]+1200080426&4294967295,D=I+(b<<12&4294967295|b>>>20),b=N+(C^D&(I^C))+R[6]+2821735955&4294967295,N=D+(b<<17&4294967295|b>>>15),b=C+(I^N&(D^I))+R[7]+4249261313&4294967295,C=N+(b<<22&4294967295|b>>>10),b=I+(D^C&(N^D))+R[8]+1770035416&4294967295,I=C+(b<<7&4294967295|b>>>25),b=D+(N^I&(C^N))+R[9]+2336552879&4294967295,D=I+(b<<12&4294967295|b>>>20),b=N+(C^D&(I^C))+R[10]+4294925233&4294967295,N=D+(b<<17&4294967295|b>>>15),b=C+(I^N&(D^I))+R[11]+2304563134&4294967295,C=N+(b<<22&4294967295|b>>>10),b=I+(D^C&(N^D))+R[12]+1804603682&4294967295,I=C+(b<<7&4294967295|b>>>25),b=D+(N^I&(C^N))+R[13]+4254626195&4294967295,D=I+(b<<12&4294967295|b>>>20),b=N+(C^D&(I^C))+R[14]+2792965006&4294967295,N=D+(b<<17&4294967295|b>>>15),b=C+(I^N&(D^I))+R[15]+1236535329&4294967295,C=N+(b<<22&4294967295|b>>>10),b=I+(N^D&(C^N))+R[1]+4129170786&4294967295,I=C+(b<<5&4294967295|b>>>27),b=D+(C^N&(I^C))+R[6]+3225465664&4294967295,D=I+(b<<9&4294967295|b>>>23),b=N+(I^C&(D^I))+R[11]+643717713&4294967295,N=D+(b<<14&4294967295|b>>>18),b=C+(D^I&(N^D))+R[0]+3921069994&4294967295,C=N+(b<<20&4294967295|b>>>12),b=I+(N^D&(C^N))+R[5]+3593408605&4294967295,I=C+(b<<5&4294967295|b>>>27),b=D+(C^N&(I^C))+R[10]+38016083&4294967295,D=I+(b<<9&4294967295|b>>>23),b=N+(I^C&(D^I))+R[15]+3634488961&4294967295,N=D+(b<<14&4294967295|b>>>18),b=C+(D^I&(N^D))+R[4]+3889429448&4294967295,C=N+(b<<20&4294967295|b>>>12),b=I+(N^D&(C^N))+R[9]+568446438&4294967295,I=C+(b<<5&4294967295|b>>>27),b=D+(C^N&(I^C))+R[14]+3275163606&4294967295,D=I+(b<<9&4294967295|b>>>23),b=N+(I^C&(D^I))+R[3]+4107603335&4294967295,N=D+(b<<14&4294967295|b>>>18),b=C+(D^I&(N^D))+R[8]+1163531501&4294967295,C=N+(b<<20&4294967295|b>>>12),b=I+(N^D&(C^N))+R[13]+2850285829&4294967295,I=C+(b<<5&4294967295|b>>>27),b=D+(C^N&(I^C))+R[2]+4243563512&4294967295,D=I+(b<<9&4294967295|b>>>23),b=N+(I^C&(D^I))+R[7]+1735328473&4294967295,N=D+(b<<14&4294967295|b>>>18),b=C+(D^I&(N^D))+R[12]+2368359562&4294967295,C=N+(b<<20&4294967295|b>>>12),b=I+(C^N^D)+R[5]+4294588738&4294967295,I=C+(b<<4&4294967295|b>>>28),b=D+(I^C^N)+R[8]+2272392833&4294967295,D=I+(b<<11&4294967295|b>>>21),b=N+(D^I^C)+R[11]+1839030562&4294967295,N=D+(b<<16&4294967295|b>>>16),b=C+(N^D^I)+R[14]+4259657740&4294967295,C=N+(b<<23&4294967295|b>>>9),b=I+(C^N^D)+R[1]+2763975236&4294967295,I=C+(b<<4&4294967295|b>>>28),b=D+(I^C^N)+R[4]+1272893353&4294967295,D=I+(b<<11&4294967295|b>>>21),b=N+(D^I^C)+R[7]+4139469664&4294967295,N=D+(b<<16&4294967295|b>>>16),b=C+(N^D^I)+R[10]+3200236656&4294967295,C=N+(b<<23&4294967295|b>>>9),b=I+(C^N^D)+R[13]+681279174&4294967295,I=C+(b<<4&4294967295|b>>>28),b=D+(I^C^N)+R[0]+3936430074&4294967295,D=I+(b<<11&4294967295|b>>>21),b=N+(D^I^C)+R[3]+3572445317&4294967295,N=D+(b<<16&4294967295|b>>>16),b=C+(N^D^I)+R[6]+76029189&4294967295,C=N+(b<<23&4294967295|b>>>9),b=I+(C^N^D)+R[9]+3654602809&4294967295,I=C+(b<<4&4294967295|b>>>28),b=D+(I^C^N)+R[12]+3873151461&4294967295,D=I+(b<<11&4294967295|b>>>21),b=N+(D^I^C)+R[15]+530742520&4294967295,N=D+(b<<16&4294967295|b>>>16),b=C+(N^D^I)+R[2]+3299628645&4294967295,C=N+(b<<23&4294967295|b>>>9),b=I+(N^(C|~D))+R[0]+4096336452&4294967295,I=C+(b<<6&4294967295|b>>>26),b=D+(C^(I|~N))+R[7]+1126891415&4294967295,D=I+(b<<10&4294967295|b>>>22),b=N+(I^(D|~C))+R[14]+2878612391&4294967295,N=D+(b<<15&4294967295|b>>>17),b=C+(D^(N|~I))+R[5]+4237533241&4294967295,C=N+(b<<21&4294967295|b>>>11),b=I+(N^(C|~D))+R[12]+1700485571&4294967295,I=C+(b<<6&4294967295|b>>>26),b=D+(C^(I|~N))+R[3]+2399980690&4294967295,D=I+(b<<10&4294967295|b>>>22),b=N+(I^(D|~C))+R[10]+4293915773&4294967295,N=D+(b<<15&4294967295|b>>>17),b=C+(D^(N|~I))+R[1]+2240044497&4294967295,C=N+(b<<21&4294967295|b>>>11),b=I+(N^(C|~D))+R[8]+1873313359&4294967295,I=C+(b<<6&4294967295|b>>>26),b=D+(C^(I|~N))+R[15]+4264355552&4294967295,D=I+(b<<10&4294967295|b>>>22),b=N+(I^(D|~C))+R[6]+2734768916&4294967295,N=D+(b<<15&4294967295|b>>>17),b=C+(D^(N|~I))+R[13]+1309151649&4294967295,C=N+(b<<21&4294967295|b>>>11),b=I+(N^(C|~D))+R[4]+4149444226&4294967295,I=C+(b<<6&4294967295|b>>>26),b=D+(C^(I|~N))+R[11]+3174756917&4294967295,D=I+(b<<10&4294967295|b>>>22),b=N+(I^(D|~C))+R[2]+718787259&4294967295,N=D+(b<<15&4294967295|b>>>17),b=C+(D^(N|~I))+R[9]+3951481745&4294967295,S.g[0]=S.g[0]+I&4294967295,S.g[1]=S.g[1]+(N+(b<<21&4294967295|b>>>11))&4294967295,S.g[2]=S.g[2]+N&4294967295,S.g[3]=S.g[3]+D&4294967295}r.prototype.v=function(S,I){I===void 0&&(I=S.length);const C=I-this.blockSize,R=this.C;let N=this.h,D=0;for(;D<I;){if(N==0)for(;D<=C;)i(this,S,D),D+=this.blockSize;if(typeof S=="string"){for(;D<I;)if(R[N++]=S.charCodeAt(D++),N==this.blockSize){i(this,R),N=0;break}}else for(;D<I;)if(R[N++]=S[D++],N==this.blockSize){i(this,R),N=0;break}}this.h=N,this.o+=I},r.prototype.A=function(){var S=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);S[0]=128;for(var I=1;I<S.length-8;++I)S[I]=0;I=this.o*8;for(var C=S.length-8;C<S.length;++C)S[C]=I&255,I/=256;for(this.v(S),S=Array(16),I=0,C=0;C<4;++C)for(let R=0;R<32;R+=8)S[I++]=this.g[C]>>>R&255;return S};function s(S,I){var C=a;return Object.prototype.hasOwnProperty.call(C,S)?C[S]:C[S]=I(S)}function o(S,I){this.h=I;const C=[];let R=!0;for(let N=S.length-1;N>=0;N--){const D=S[N]|0;R&&D==I||(C[N]=D,R=!1)}this.g=C}var a={};function l(S){return-128<=S&&S<128?s(S,function(I){return new o([I|0],I<0?-1:0)}):new o([S|0],S<0?-1:0)}function u(S){if(isNaN(S)||!isFinite(S))return f;if(S<0)return P(u(-S));const I=[];let C=1;for(let R=0;S>=C;R++)I[R]=S/C|0,C*=4294967296;return new o(I,0)}function h(S,I){if(S.length==0)throw Error("number format error: empty string");if(I=I||10,I<2||36<I)throw Error("radix out of range: "+I);if(S.charAt(0)=="-")return P(h(S.substring(1),I));if(S.indexOf("-")>=0)throw Error('number format error: interior "-" character');const C=u(Math.pow(I,8));let R=f;for(let D=0;D<S.length;D+=8){var N=Math.min(8,S.length-D);const b=parseInt(S.substring(D,D+N),I);N<8?(N=u(Math.pow(I,N)),R=R.j(N).add(u(b))):(R=R.j(C),R=R.add(u(b)))}return R}var f=l(0),m=l(1),E=l(16777216);t=o.prototype,t.m=function(){if(A(this))return-P(this).m();let S=0,I=1;for(let C=0;C<this.g.length;C++){const R=this.i(C);S+=(R>=0?R:4294967296+R)*I,I*=4294967296}return S},t.toString=function(S){if(S=S||10,S<2||36<S)throw Error("radix out of range: "+S);if(_(this))return"0";if(A(this))return"-"+P(this).toString(S);const I=u(Math.pow(S,6));var C=this;let R="";for(;;){const N=V(C,I).g;C=v(C,N.j(I));let D=((C.g.length>0?C.g[0]:C.h)>>>0).toString(S);if(C=N,_(C))return D+R;for(;D.length<6;)D="0"+D;R=D+R}},t.i=function(S){return S<0?0:S<this.g.length?this.g[S]:this.h};function _(S){if(S.h!=0)return!1;for(let I=0;I<S.g.length;I++)if(S.g[I]!=0)return!1;return!0}function A(S){return S.h==-1}t.l=function(S){return S=v(this,S),A(S)?-1:_(S)?0:1};function P(S){const I=S.g.length,C=[];for(let R=0;R<I;R++)C[R]=~S.g[R];return new o(C,~S.h).add(m)}t.abs=function(){return A(this)?P(this):this},t.add=function(S){const I=Math.max(this.g.length,S.g.length),C=[];let R=0;for(let N=0;N<=I;N++){let D=R+(this.i(N)&65535)+(S.i(N)&65535),b=(D>>>16)+(this.i(N)>>>16)+(S.i(N)>>>16);R=b>>>16,D&=65535,b&=65535,C[N]=b<<16|D}return new o(C,C[C.length-1]&-2147483648?-1:0)};function v(S,I){return S.add(P(I))}t.j=function(S){if(_(this)||_(S))return f;if(A(this))return A(S)?P(this).j(P(S)):P(P(this).j(S));if(A(S))return P(this.j(P(S)));if(this.l(E)<0&&S.l(E)<0)return u(this.m()*S.m());const I=this.g.length+S.g.length,C=[];for(var R=0;R<2*I;R++)C[R]=0;for(R=0;R<this.g.length;R++)for(let N=0;N<S.g.length;N++){const D=this.i(R)>>>16,b=this.i(R)&65535,Q=S.i(N)>>>16,Be=S.i(N)&65535;C[2*R+2*N]+=b*Be,w(C,2*R+2*N),C[2*R+2*N+1]+=D*Be,w(C,2*R+2*N+1),C[2*R+2*N+1]+=b*Q,w(C,2*R+2*N+1),C[2*R+2*N+2]+=D*Q,w(C,2*R+2*N+2)}for(S=0;S<I;S++)C[S]=C[2*S+1]<<16|C[2*S];for(S=I;S<2*I;S++)C[S]=0;return new o(C,0)};function w(S,I){for(;(S[I]&65535)!=S[I];)S[I+1]+=S[I]>>>16,S[I]&=65535,I++}function y(S,I){this.g=S,this.h=I}function V(S,I){if(_(I))throw Error("division by zero");if(_(S))return new y(f,f);if(A(S))return I=V(P(S),I),new y(P(I.g),P(I.h));if(A(I))return I=V(S,P(I)),new y(P(I.g),I.h);if(S.g.length>30){if(A(S)||A(I))throw Error("slowDivide_ only works with positive integers.");for(var C=m,R=I;R.l(S)<=0;)C=U(C),R=U(R);var N=$(C,1),D=$(R,1);for(R=$(R,2),C=$(C,2);!_(R);){var b=D.add(R);b.l(S)<=0&&(N=N.add(C),D=b),R=$(R,1),C=$(C,1)}return I=v(S,N.j(I)),new y(N,I)}for(N=f;S.l(I)>=0;){for(C=Math.max(1,Math.floor(S.m()/I.m())),R=Math.ceil(Math.log(C)/Math.LN2),R=R<=48?1:Math.pow(2,R-48),D=u(C),b=D.j(I);A(b)||b.l(S)>0;)C-=R,D=u(C),b=D.j(I);_(D)&&(D=m),N=N.add(D),S=v(S,b)}return new y(N,S)}t.B=function(S){return V(this,S).h},t.and=function(S){const I=Math.max(this.g.length,S.g.length),C=[];for(let R=0;R<I;R++)C[R]=this.i(R)&S.i(R);return new o(C,this.h&S.h)},t.or=function(S){const I=Math.max(this.g.length,S.g.length),C=[];for(let R=0;R<I;R++)C[R]=this.i(R)|S.i(R);return new o(C,this.h|S.h)},t.xor=function(S){const I=Math.max(this.g.length,S.g.length),C=[];for(let R=0;R<I;R++)C[R]=this.i(R)^S.i(R);return new o(C,this.h^S.h)};function U(S){const I=S.g.length+1,C=[];for(let R=0;R<I;R++)C[R]=S.i(R)<<1|S.i(R-1)>>>31;return new o(C,S.h)}function $(S,I){const C=I>>5;I%=32;const R=S.g.length-C,N=[];for(let D=0;D<R;D++)N[D]=I>0?S.i(D+C)>>>I|S.i(D+C+1)<<32-I:S.i(D+C);return new o(N,S.h)}r.prototype.digest=r.prototype.A,r.prototype.reset=r.prototype.u,r.prototype.update=r.prototype.v,NS=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.B,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=u,o.fromString=h,Mi=o}).apply(typeof sE<"u"?sE:typeof self<"u"?self:typeof window<"u"?window:{});var fu=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var DS,ll,VS,$u,Am,OS,jS,LS;(function(){var t,e=Object.defineProperty;function n(c){c=[typeof globalThis=="object"&&globalThis,c,typeof window=="object"&&window,typeof self=="object"&&self,typeof fu=="object"&&fu];for(var p=0;p<c.length;++p){var g=c[p];if(g&&g.Math==Math)return g}throw Error("Cannot find global object")}var r=n(this);function i(c,p){if(p)e:{var g=r;c=c.split(".");for(var x=0;x<c.length-1;x++){var j=c[x];if(!(j in g))break e;g=g[j]}c=c[c.length-1],x=g[c],p=p(x),p!=x&&p!=null&&e(g,c,{configurable:!0,writable:!0,value:p})}}i("Symbol.dispose",function(c){return c||Symbol("Symbol.dispose")}),i("Array.prototype.values",function(c){return c||function(){return this[Symbol.iterator]()}}),i("Object.entries",function(c){return c||function(p){var g=[],x;for(x in p)Object.prototype.hasOwnProperty.call(p,x)&&g.push([x,p[x]]);return g}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var s=s||{},o=this||self;function a(c){var p=typeof c;return p=="object"&&c!=null||p=="function"}function l(c,p,g){return c.call.apply(c.bind,arguments)}function u(c,p,g){return u=l,u.apply(null,arguments)}function h(c,p){var g=Array.prototype.slice.call(arguments,1);return function(){var x=g.slice();return x.push.apply(x,arguments),c.apply(this,x)}}function f(c,p){function g(){}g.prototype=p.prototype,c.Z=p.prototype,c.prototype=new g,c.prototype.constructor=c,c.Ob=function(x,j,F){for(var Y=Array(arguments.length-2),Ee=2;Ee<arguments.length;Ee++)Y[Ee-2]=arguments[Ee];return p.prototype[j].apply(x,Y)}}var m=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?c=>c&&AsyncContext.Snapshot.wrap(c):c=>c;function E(c){const p=c.length;if(p>0){const g=Array(p);for(let x=0;x<p;x++)g[x]=c[x];return g}return[]}function _(c,p){for(let x=1;x<arguments.length;x++){const j=arguments[x];var g=typeof j;if(g=g!="object"?g:j?Array.isArray(j)?"array":g:"null",g=="array"||g=="object"&&typeof j.length=="number"){g=c.length||0;const F=j.length||0;c.length=g+F;for(let Y=0;Y<F;Y++)c[g+Y]=j[Y]}else c.push(j)}}class A{constructor(p,g){this.i=p,this.j=g,this.h=0,this.g=null}get(){let p;return this.h>0?(this.h--,p=this.g,this.g=p.next,p.next=null):p=this.i(),p}}function P(c){o.setTimeout(()=>{throw c},0)}function v(){var c=S;let p=null;return c.g&&(p=c.g,c.g=c.g.next,c.g||(c.h=null),p.next=null),p}class w{constructor(){this.h=this.g=null}add(p,g){const x=y.get();x.set(p,g),this.h?this.h.next=x:this.g=x,this.h=x}}var y=new A(()=>new V,c=>c.reset());class V{constructor(){this.next=this.g=this.h=null}set(p,g){this.h=p,this.g=g,this.next=null}reset(){this.next=this.g=this.h=null}}let U,$=!1,S=new w,I=()=>{const c=Promise.resolve(void 0);U=()=>{c.then(C)}};function C(){for(var c;c=v();){try{c.h.call(c.g)}catch(g){P(g)}var p=y;p.j(c),p.h<100&&(p.h++,c.next=p.g,p.g=c)}$=!1}function R(){this.u=this.u,this.C=this.C}R.prototype.u=!1,R.prototype.dispose=function(){this.u||(this.u=!0,this.N())},R.prototype[Symbol.dispose]=function(){this.dispose()},R.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function N(c,p){this.type=c,this.g=this.target=p,this.defaultPrevented=!1}N.prototype.h=function(){this.defaultPrevented=!0};var D=function(){if(!o.addEventListener||!Object.defineProperty)return!1;var c=!1,p=Object.defineProperty({},"passive",{get:function(){c=!0}});try{const g=()=>{};o.addEventListener("test",g,p),o.removeEventListener("test",g,p)}catch{}return c}();function b(c){return/^[\s\xa0]*$/.test(c)}function Q(c,p){N.call(this,c?c.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,c&&this.init(c,p)}f(Q,N),Q.prototype.init=function(c,p){const g=this.type=c.type,x=c.changedTouches&&c.changedTouches.length?c.changedTouches[0]:null;this.target=c.target||c.srcElement,this.g=p,p=c.relatedTarget,p||(g=="mouseover"?p=c.fromElement:g=="mouseout"&&(p=c.toElement)),this.relatedTarget=p,x?(this.clientX=x.clientX!==void 0?x.clientX:x.pageX,this.clientY=x.clientY!==void 0?x.clientY:x.pageY,this.screenX=x.screenX||0,this.screenY=x.screenY||0):(this.clientX=c.clientX!==void 0?c.clientX:c.pageX,this.clientY=c.clientY!==void 0?c.clientY:c.pageY,this.screenX=c.screenX||0,this.screenY=c.screenY||0),this.button=c.button,this.key=c.key||"",this.ctrlKey=c.ctrlKey,this.altKey=c.altKey,this.shiftKey=c.shiftKey,this.metaKey=c.metaKey,this.pointerId=c.pointerId||0,this.pointerType=c.pointerType,this.state=c.state,this.i=c,c.defaultPrevented&&Q.Z.h.call(this)},Q.prototype.h=function(){Q.Z.h.call(this);const c=this.i;c.preventDefault?c.preventDefault():c.returnValue=!1};var Be="closure_listenable_"+(Math.random()*1e6|0),jt=0;function on(c,p,g,x,j){this.listener=c,this.proxy=null,this.src=p,this.type=g,this.capture=!!x,this.ha=j,this.key=++jt,this.da=this.fa=!1}function J(c){c.da=!0,c.listener=null,c.proxy=null,c.src=null,c.ha=null}function ce(c,p,g){for(const x in c)p.call(g,c[x],x,c)}function he(c,p){for(const g in c)p.call(void 0,c[g],g,c)}function De(c){const p={};for(const g in c)p[g]=c[g];return p}const H="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function L(c,p){let g,x;for(let j=1;j<arguments.length;j++){x=arguments[j];for(g in x)c[g]=x[g];for(let F=0;F<H.length;F++)g=H[F],Object.prototype.hasOwnProperty.call(x,g)&&(c[g]=x[g])}}function z(c){this.src=c,this.g={},this.h=0}z.prototype.add=function(c,p,g,x,j){const F=c.toString();c=this.g[F],c||(c=this.g[F]=[],this.h++);const Y=ye(c,p,x,j);return Y>-1?(p=c[Y],g||(p.fa=!1)):(p=new on(p,this.src,F,!!x,j),p.fa=g,c.push(p)),p};function re(c,p){const g=p.type;if(g in c.g){var x=c.g[g],j=Array.prototype.indexOf.call(x,p,void 0),F;(F=j>=0)&&Array.prototype.splice.call(x,j,1),F&&(J(p),c.g[g].length==0&&(delete c.g[g],c.h--))}}function ye(c,p,g,x){for(let j=0;j<c.length;++j){const F=c[j];if(!F.da&&F.listener==p&&F.capture==!!g&&F.ha==x)return j}return-1}var pe="closure_lm_"+(Math.random()*1e6|0),Pe={};function _e(c,p,g,x,j){if(Array.isArray(p)){for(let F=0;F<p.length;F++)_e(c,p[F],g,x,j);return null}return g=ue(g),c&&c[Be]?c.J(p,g,a(x)?!!x.capture:!1,j):$e(c,p,g,!1,x,j)}function $e(c,p,g,x,j,F){if(!p)throw Error("Invalid event type");const Y=a(j)?!!j.capture:!!j;let Ee=ee(c);if(Ee||(c[pe]=Ee=new z(c)),g=Ee.add(p,g,x,Y,F),g.proxy)return g;if(x=me(),g.proxy=x,x.src=c,x.listener=g,c.addEventListener)D||(j=Y),j===void 0&&(j=!1),c.addEventListener(p.toString(),x,j);else if(c.attachEvent)c.attachEvent(vt(p.toString()),x);else if(c.addListener&&c.removeListener)c.addListener(x);else throw Error("addEventListener and attachEvent are unavailable.");return g}function me(){function c(g){return p.call(c.src,c.listener,g)}const p=Pt;return c}function Z(c,p,g,x,j){if(Array.isArray(p))for(var F=0;F<p.length;F++)Z(c,p[F],g,x,j);else x=a(x)?!!x.capture:!!x,g=ue(g),c&&c[Be]?(c=c.i,F=String(p).toString(),F in c.g&&(p=c.g[F],g=ye(p,g,x,j),g>-1&&(J(p[g]),Array.prototype.splice.call(p,g,1),p.length==0&&(delete c.g[F],c.h--)))):c&&(c=ee(c))&&(p=c.g[p.toString()],c=-1,p&&(c=ye(p,g,x,j)),(g=c>-1?p[c]:null)&&xe(g))}function xe(c){if(typeof c!="number"&&c&&!c.da){var p=c.src;if(p&&p[Be])re(p.i,c);else{var g=c.type,x=c.proxy;p.removeEventListener?p.removeEventListener(g,x,c.capture):p.detachEvent?p.detachEvent(vt(g),x):p.addListener&&p.removeListener&&p.removeListener(x),(g=ee(p))?(re(g,c),g.h==0&&(g.src=null,p[pe]=null)):J(c)}}}function vt(c){return c in Pe?Pe[c]:Pe[c]="on"+c}function Pt(c,p){if(c.da)c=!0;else{p=new Q(p,this);const g=c.listener,x=c.ha||c.src;c.fa&&xe(c),c=g.call(x,p)}return c}function ee(c){return c=c[pe],c instanceof z?c:null}var te="__closure_events_fn_"+(Math.random()*1e9>>>0);function ue(c){return typeof c=="function"?c:(c[te]||(c[te]=function(p){return c.handleEvent(p)}),c[te])}function ne(){R.call(this),this.i=new z(this),this.M=this,this.G=null}f(ne,R),ne.prototype[Be]=!0,ne.prototype.removeEventListener=function(c,p,g,x){Z(this,c,p,g,x)};function T(c,p){var g,x=c.G;if(x)for(g=[];x;x=x.G)g.push(x);if(c=c.M,x=p.type||p,typeof p=="string")p=new N(p,c);else if(p instanceof N)p.target=p.target||c;else{var j=p;p=new N(x,c),L(p,j)}j=!0;let F,Y;if(g)for(Y=g.length-1;Y>=0;Y--)F=p.g=g[Y],j=M(F,x,!0,p)&&j;if(F=p.g=c,j=M(F,x,!0,p)&&j,j=M(F,x,!1,p)&&j,g)for(Y=0;Y<g.length;Y++)F=p.g=g[Y],j=M(F,x,!1,p)&&j}ne.prototype.N=function(){if(ne.Z.N.call(this),this.i){var c=this.i;for(const p in c.g){const g=c.g[p];for(let x=0;x<g.length;x++)J(g[x]);delete c.g[p],c.h--}}this.G=null},ne.prototype.J=function(c,p,g,x){return this.i.add(String(c),p,!1,g,x)},ne.prototype.K=function(c,p,g,x){return this.i.add(String(c),p,!0,g,x)};function M(c,p,g,x){if(p=c.i.g[String(p)],!p)return!0;p=p.concat();let j=!0;for(let F=0;F<p.length;++F){const Y=p[F];if(Y&&!Y.da&&Y.capture==g){const Ee=Y.listener,wt=Y.ha||Y.src;Y.fa&&re(c.i,Y),j=Ee.call(wt,x)!==!1&&j}}return j&&!x.defaultPrevented}function q(c,p){if(typeof c!="function")if(c&&typeof c.handleEvent=="function")c=u(c.handleEvent,c);else throw Error("Invalid listener argument");return Number(p)>2147483647?-1:o.setTimeout(c,p||0)}function oe(c){c.g=q(()=>{c.g=null,c.i&&(c.i=!1,oe(c))},c.l);const p=c.h;c.h=null,c.m.apply(null,p)}class le extends R{constructor(p,g){super(),this.m=p,this.l=g,this.h=null,this.i=!1,this.g=null}j(p){this.h=arguments,this.g?this.i=!0:oe(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function ve(c){R.call(this),this.h=c,this.g={}}f(ve,R);var qe=[];function Ie(c){ce(c.g,function(p,g){this.g.hasOwnProperty(g)&&xe(p)},c),c.g={}}ve.prototype.N=function(){ve.Z.N.call(this),Ie(this)},ve.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var He=o.JSON.stringify,Re=o.JSON.parse,ht=class{stringify(c){return o.JSON.stringify(c,void 0)}parse(c){return o.JSON.parse(c,void 0)}};function Lt(){}function mn(){}var Jr={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function Ar(){N.call(this,"d")}f(Ar,N);function ba(){N.call(this,"c")}f(ba,N);var gn={},Zr=null;function sr(){return Zr=Zr||new ne}gn.Ia="serverreachability";function Cr(c){N.call(this,gn.Ia,c)}f(Cr,N);function yn(c){const p=sr();T(p,new Cr(p))}gn.STAT_EVENT="statevent";function Gt(c,p){N.call(this,gn.STAT_EVENT,c),this.stat=p}f(Gt,N);function je(c){const p=sr();T(p,new Gt(p,c))}gn.Ja="timingevent";function Lc(c,p){N.call(this,gn.Ja,c),this.size=p}f(Lc,N);function ei(c,p){if(typeof c!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){c()},p)}function br(){this.g=!0}br.prototype.ua=function(){this.g=!1};function or(c,p,g,x,j,F){c.info(function(){if(c.g)if(F){var Y="",Ee=F.split("&");for(let ze=0;ze<Ee.length;ze++){var wt=Ee[ze].split("=");if(wt.length>1){const At=wt[0];wt=wt[1];const lr=At.split("_");Y=lr.length>=2&&lr[1]=="type"?Y+(At+"="+wt+"&"):Y+(At+"=redacted&")}}}else Y=null;else Y=F;return"XMLHTTP REQ ("+x+") [attempt "+j+"]: "+p+`
`+g+`
`+Y})}function Rb(c,p,g,x,j,F,Y){c.info(function(){return"XMLHTTP RESP ("+x+") [ attempt "+j+"]: "+p+`
`+g+`
`+F+" "+Y})}function oo(c,p,g,x){c.info(function(){return"XMLHTTP TEXT ("+p+"): "+kb(c,g)+(x?" "+x:"")})}function Pb(c,p){c.info(function(){return"TIMEOUT: "+p})}br.prototype.info=function(){};function kb(c,p){if(!c.g)return p;if(!p)return null;try{const F=JSON.parse(p);if(F){for(c=0;c<F.length;c++)if(Array.isArray(F[c])){var g=F[c];if(!(g.length<2)){var x=g[1];if(Array.isArray(x)&&!(x.length<1)){var j=x[0];if(j!="noop"&&j!="stop"&&j!="close")for(let Y=1;Y<x.length;Y++)x[Y]=""}}}}return He(F)}catch{return p}}var Mc={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},C_={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},b_;function lf(){}f(lf,Lt),lf.prototype.g=function(){return new XMLHttpRequest},b_=new lf;function Ra(c){return encodeURIComponent(String(c))}function Nb(c){var p=1;c=c.split(":");const g=[];for(;p>0&&c.length;)g.push(c.shift()),p--;return c.length&&g.push(c.join(":")),g}function ti(c,p,g,x){this.j=c,this.i=p,this.l=g,this.S=x||1,this.V=new ve(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new R_}function R_(){this.i=null,this.g="",this.h=!1}var P_={},cf={};function uf(c,p,g){c.M=1,c.A=Uc(ar(p)),c.u=g,c.R=!0,k_(c,null)}function k_(c,p){c.F=Date.now(),Fc(c),c.B=ar(c.A);var g=c.B,x=c.S;Array.isArray(x)||(x=[String(x)]),q_(g.i,"t",x),c.C=0,g=c.j.L,c.h=new R_,c.g=lv(c.j,g?p:null,!c.u),c.P>0&&(c.O=new le(u(c.Y,c,c.g),c.P)),p=c.V,g=c.g,x=c.ba;var j="readystatechange";Array.isArray(j)||(j&&(qe[0]=j.toString()),j=qe);for(let F=0;F<j.length;F++){const Y=_e(g,j[F],x||p.handleEvent,!1,p.h||p);if(!Y)break;p.g[Y.key]=Y}p=c.J?De(c.J):{},c.u?(c.v||(c.v="POST"),p["Content-Type"]="application/x-www-form-urlencoded",c.g.ea(c.B,c.v,c.u,p)):(c.v="GET",c.g.ea(c.B,c.v,null,p)),yn(),or(c.i,c.v,c.B,c.l,c.S,c.u)}ti.prototype.ba=function(c){c=c.target;const p=this.O;p&&ii(c)==3?p.j():this.Y(c)},ti.prototype.Y=function(c){try{if(c==this.g)e:{const Ee=ii(this.g),wt=this.g.ya(),ze=this.g.ca();if(!(Ee<3)&&(Ee!=3||this.g&&(this.h.h||this.g.la()||X_(this.g)))){this.K||Ee!=4||wt==7||(wt==8||ze<=0?yn(3):yn(2)),df(this);var p=this.g.ca();this.X=p;var g=Db(this);if(this.o=p==200,Rb(this.i,this.v,this.B,this.l,this.S,Ee,p),this.o){if(this.U&&!this.L){t:{if(this.g){var x,j=this.g;if((x=j.g?j.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!b(x)){var F=x;break t}}F=null}if(c=F)oo(this.i,this.l,c,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,hf(this,c);else{this.o=!1,this.m=3,je(12),ss(this),Pa(this);break e}}if(this.R){c=!0;let At;for(;!this.K&&this.C<g.length;)if(At=Vb(this,g),At==cf){Ee==4&&(this.m=4,je(14),c=!1),oo(this.i,this.l,null,"[Incomplete Response]");break}else if(At==P_){this.m=4,je(15),oo(this.i,this.l,g,"[Invalid Chunk]"),c=!1;break}else oo(this.i,this.l,At,null),hf(this,At);if(N_(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Ee!=4||g.length!=0||this.h.h||(this.m=1,je(16),c=!1),this.o=this.o&&c,!c)oo(this.i,this.l,g,"[Invalid Chunked Response]"),ss(this),Pa(this);else if(g.length>0&&!this.W){this.W=!0;var Y=this.j;Y.g==this&&Y.aa&&!Y.P&&(Y.j.info("Great, no buffering proxy detected. Bytes received: "+g.length),wf(Y),Y.P=!0,je(11))}}else oo(this.i,this.l,g,null),hf(this,g);Ee==4&&ss(this),this.o&&!this.K&&(Ee==4?iv(this.j,this):(this.o=!1,Fc(this)))}else Gb(this.g),p==400&&g.indexOf("Unknown SID")>0?(this.m=3,je(12)):(this.m=0,je(13)),ss(this),Pa(this)}}}catch{}finally{}};function Db(c){if(!N_(c))return c.g.la();const p=X_(c.g);if(p==="")return"";let g="";const x=p.length,j=ii(c.g)==4;if(!c.h.i){if(typeof TextDecoder>"u")return ss(c),Pa(c),"";c.h.i=new o.TextDecoder}for(let F=0;F<x;F++)c.h.h=!0,g+=c.h.i.decode(p[F],{stream:!(j&&F==x-1)});return p.length=0,c.h.g+=g,c.C=0,c.h.g}function N_(c){return c.g?c.v=="GET"&&c.M!=2&&c.j.Aa:!1}function Vb(c,p){var g=c.C,x=p.indexOf(`
`,g);return x==-1?cf:(g=Number(p.substring(g,x)),isNaN(g)?P_:(x+=1,x+g>p.length?cf:(p=p.slice(x,x+g),c.C=x+g,p)))}ti.prototype.cancel=function(){this.K=!0,ss(this)};function Fc(c){c.T=Date.now()+c.H,D_(c,c.H)}function D_(c,p){if(c.D!=null)throw Error("WatchDog timer not null");c.D=ei(u(c.aa,c),p)}function df(c){c.D&&(o.clearTimeout(c.D),c.D=null)}ti.prototype.aa=function(){this.D=null;const c=Date.now();c-this.T>=0?(Pb(this.i,this.B),this.M!=2&&(yn(),je(17)),ss(this),this.m=2,Pa(this)):D_(this,this.T-c)};function Pa(c){c.j.I==0||c.K||iv(c.j,c)}function ss(c){df(c);var p=c.O;p&&typeof p.dispose=="function"&&p.dispose(),c.O=null,Ie(c.V),c.g&&(p=c.g,c.g=null,p.abort(),p.dispose())}function hf(c,p){try{var g=c.j;if(g.I!=0&&(g.g==c||ff(g.h,c))){if(!c.L&&ff(g.h,c)&&g.I==3){try{var x=g.Ba.g.parse(p)}catch{x=null}if(Array.isArray(x)&&x.length==3){var j=x;if(j[0]==0){e:if(!g.v){if(g.g)if(g.g.F+3e3<c.F)Hc(g),zc(g);else break e;vf(g),je(18)}}else g.xa=j[1],0<g.xa-g.K&&j[2]<37500&&g.F&&g.A==0&&!g.C&&(g.C=ei(u(g.Va,g),6e3));j_(g.h)<=1&&g.ta&&(g.ta=void 0)}else as(g,11)}else if((c.L||g.g==c)&&Hc(g),!b(p))for(j=g.Ba.g.parse(p),p=0;p<j.length;p++){let ze=j[p];const At=ze[0];if(!(At<=g.K))if(g.K=At,ze=ze[1],g.I==2)if(ze[0]=="c"){g.M=ze[1],g.ba=ze[2];const lr=ze[3];lr!=null&&(g.ka=lr,g.j.info("VER="+g.ka));const ls=ze[4];ls!=null&&(g.za=ls,g.j.info("SVER="+g.za));const si=ze[5];si!=null&&typeof si=="number"&&si>0&&(x=1.5*si,g.O=x,g.j.info("backChannelRequestTimeoutMs_="+x)),x=g;const oi=c.g;if(oi){const Kc=oi.g?oi.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Kc){var F=x.h;F.g||Kc.indexOf("spdy")==-1&&Kc.indexOf("quic")==-1&&Kc.indexOf("h2")==-1||(F.j=F.l,F.g=new Set,F.h&&(pf(F,F.h),F.h=null))}if(x.G){const Ef=oi.g?oi.g.getResponseHeader("X-HTTP-Session-Id"):null;Ef&&(x.wa=Ef,Ke(x.J,x.G,Ef))}}g.I=3,g.l&&g.l.ra(),g.aa&&(g.T=Date.now()-c.F,g.j.info("Handshake RTT: "+g.T+"ms")),x=g;var Y=c;if(x.na=av(x,x.L?x.ba:null,x.W),Y.L){L_(x.h,Y);var Ee=Y,wt=x.O;wt&&(Ee.H=wt),Ee.D&&(df(Ee),Fc(Ee)),x.g=Y}else nv(x);g.i.length>0&&qc(g)}else ze[0]!="stop"&&ze[0]!="close"||as(g,7);else g.I==3&&(ze[0]=="stop"||ze[0]=="close"?ze[0]=="stop"?as(g,7):_f(g):ze[0]!="noop"&&g.l&&g.l.qa(ze),g.A=0)}}yn(4)}catch{}}var Ob=class{constructor(c,p){this.g=c,this.map=p}};function V_(c){this.l=c||10,o.PerformanceNavigationTiming?(c=o.performance.getEntriesByType("navigation"),c=c.length>0&&(c[0].nextHopProtocol=="hq"||c[0].nextHopProtocol=="h2")):c=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=c?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function O_(c){return c.h?!0:c.g?c.g.size>=c.j:!1}function j_(c){return c.h?1:c.g?c.g.size:0}function ff(c,p){return c.h?c.h==p:c.g?c.g.has(p):!1}function pf(c,p){c.g?c.g.add(p):c.h=p}function L_(c,p){c.h&&c.h==p?c.h=null:c.g&&c.g.has(p)&&c.g.delete(p)}V_.prototype.cancel=function(){if(this.i=M_(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const c of this.g.values())c.cancel();this.g.clear()}};function M_(c){if(c.h!=null)return c.i.concat(c.h.G);if(c.g!=null&&c.g.size!==0){let p=c.i;for(const g of c.g.values())p=p.concat(g.G);return p}return E(c.i)}var F_=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function jb(c,p){if(c){c=c.split("&");for(let g=0;g<c.length;g++){const x=c[g].indexOf("=");let j,F=null;x>=0?(j=c[g].substring(0,x),F=c[g].substring(x+1)):j=c[g],p(j,F?decodeURIComponent(F.replace(/\+/g," ")):"")}}}function ni(c){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let p;c instanceof ni?(this.l=c.l,ka(this,c.j),this.o=c.o,this.g=c.g,Na(this,c.u),this.h=c.h,mf(this,H_(c.i)),this.m=c.m):c&&(p=String(c).match(F_))?(this.l=!1,ka(this,p[1]||"",!0),this.o=Da(p[2]||""),this.g=Da(p[3]||"",!0),Na(this,p[4]),this.h=Da(p[5]||"",!0),mf(this,p[6]||"",!0),this.m=Da(p[7]||"")):(this.l=!1,this.i=new Oa(null,this.l))}ni.prototype.toString=function(){const c=[];var p=this.j;p&&c.push(Va(p,U_,!0),":");var g=this.g;return(g||p=="file")&&(c.push("//"),(p=this.o)&&c.push(Va(p,U_,!0),"@"),c.push(Ra(g).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),g=this.u,g!=null&&c.push(":",String(g))),(g=this.h)&&(this.g&&g.charAt(0)!="/"&&c.push("/"),c.push(Va(g,g.charAt(0)=="/"?Fb:Mb,!0))),(g=this.i.toString())&&c.push("?",g),(g=this.m)&&c.push("#",Va(g,Bb)),c.join("")},ni.prototype.resolve=function(c){const p=ar(this);let g=!!c.j;g?ka(p,c.j):g=!!c.o,g?p.o=c.o:g=!!c.g,g?p.g=c.g:g=c.u!=null;var x=c.h;if(g)Na(p,c.u);else if(g=!!c.h){if(x.charAt(0)!="/")if(this.g&&!this.h)x="/"+x;else{var j=p.h.lastIndexOf("/");j!=-1&&(x=p.h.slice(0,j+1)+x)}if(j=x,j==".."||j==".")x="";else if(j.indexOf("./")!=-1||j.indexOf("/.")!=-1){x=j.lastIndexOf("/",0)==0,j=j.split("/");const F=[];for(let Y=0;Y<j.length;){const Ee=j[Y++];Ee=="."?x&&Y==j.length&&F.push(""):Ee==".."?((F.length>1||F.length==1&&F[0]!="")&&F.pop(),x&&Y==j.length&&F.push("")):(F.push(Ee),x=!0)}x=F.join("/")}else x=j}return g?p.h=x:g=c.i.toString()!=="",g?mf(p,H_(c.i)):g=!!c.m,g&&(p.m=c.m),p};function ar(c){return new ni(c)}function ka(c,p,g){c.j=g?Da(p,!0):p,c.j&&(c.j=c.j.replace(/:$/,""))}function Na(c,p){if(p){if(p=Number(p),isNaN(p)||p<0)throw Error("Bad port number "+p);c.u=p}else c.u=null}function mf(c,p,g){p instanceof Oa?(c.i=p,$b(c.i,c.l)):(g||(p=Va(p,Ub)),c.i=new Oa(p,c.l))}function Ke(c,p,g){c.i.set(p,g)}function Uc(c){return Ke(c,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),c}function Da(c,p){return c?p?decodeURI(c.replace(/%25/g,"%2525")):decodeURIComponent(c):""}function Va(c,p,g){return typeof c=="string"?(c=encodeURI(c).replace(p,Lb),g&&(c=c.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),c):null}function Lb(c){return c=c.charCodeAt(0),"%"+(c>>4&15).toString(16)+(c&15).toString(16)}var U_=/[#\/\?@]/g,Mb=/[#\?:]/g,Fb=/[#\?]/g,Ub=/[#\?@]/g,Bb=/#/g;function Oa(c,p){this.h=this.g=null,this.i=c||null,this.j=!!p}function os(c){c.g||(c.g=new Map,c.h=0,c.i&&jb(c.i,function(p,g){c.add(decodeURIComponent(p.replace(/\+/g," ")),g)}))}t=Oa.prototype,t.add=function(c,p){os(this),this.i=null,c=ao(this,c);let g=this.g.get(c);return g||this.g.set(c,g=[]),g.push(p),this.h+=1,this};function B_(c,p){os(c),p=ao(c,p),c.g.has(p)&&(c.i=null,c.h-=c.g.get(p).length,c.g.delete(p))}function $_(c,p){return os(c),p=ao(c,p),c.g.has(p)}t.forEach=function(c,p){os(this),this.g.forEach(function(g,x){g.forEach(function(j){c.call(p,j,x,this)},this)},this)};function z_(c,p){os(c);let g=[];if(typeof p=="string")$_(c,p)&&(g=g.concat(c.g.get(ao(c,p))));else for(c=Array.from(c.g.values()),p=0;p<c.length;p++)g=g.concat(c[p]);return g}t.set=function(c,p){return os(this),this.i=null,c=ao(this,c),$_(this,c)&&(this.h-=this.g.get(c).length),this.g.set(c,[p]),this.h+=1,this},t.get=function(c,p){return c?(c=z_(this,c),c.length>0?String(c[0]):p):p};function q_(c,p,g){B_(c,p),g.length>0&&(c.i=null,c.g.set(ao(c,p),E(g)),c.h+=g.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const c=[],p=Array.from(this.g.keys());for(let x=0;x<p.length;x++){var g=p[x];const j=Ra(g);g=z_(this,g);for(let F=0;F<g.length;F++){let Y=j;g[F]!==""&&(Y+="="+Ra(g[F])),c.push(Y)}}return this.i=c.join("&")};function H_(c){const p=new Oa;return p.i=c.i,c.g&&(p.g=new Map(c.g),p.h=c.h),p}function ao(c,p){return p=String(p),c.j&&(p=p.toLowerCase()),p}function $b(c,p){p&&!c.j&&(os(c),c.i=null,c.g.forEach(function(g,x){const j=x.toLowerCase();x!=j&&(B_(this,x),q_(this,j,g))},c)),c.j=p}function zb(c,p){const g=new br;if(o.Image){const x=new Image;x.onload=h(ri,g,"TestLoadImage: loaded",!0,p,x),x.onerror=h(ri,g,"TestLoadImage: error",!1,p,x),x.onabort=h(ri,g,"TestLoadImage: abort",!1,p,x),x.ontimeout=h(ri,g,"TestLoadImage: timeout",!1,p,x),o.setTimeout(function(){x.ontimeout&&x.ontimeout()},1e4),x.src=c}else p(!1)}function qb(c,p){const g=new br,x=new AbortController,j=setTimeout(()=>{x.abort(),ri(g,"TestPingServer: timeout",!1,p)},1e4);fetch(c,{signal:x.signal}).then(F=>{clearTimeout(j),F.ok?ri(g,"TestPingServer: ok",!0,p):ri(g,"TestPingServer: server error",!1,p)}).catch(()=>{clearTimeout(j),ri(g,"TestPingServer: error",!1,p)})}function ri(c,p,g,x,j){try{j&&(j.onload=null,j.onerror=null,j.onabort=null,j.ontimeout=null),x(g)}catch{}}function Hb(){this.g=new ht}function gf(c){this.i=c.Sb||null,this.h=c.ab||!1}f(gf,Lt),gf.prototype.g=function(){return new Bc(this.i,this.h)};function Bc(c,p){ne.call(this),this.H=c,this.o=p,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}f(Bc,ne),t=Bc.prototype,t.open=function(c,p){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=c,this.D=p,this.readyState=1,La(this)},t.send=function(c){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const p={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};c&&(p.body=c),(this.H||o).fetch(new Request(this.D,p)).then(this.Pa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,ja(this)),this.readyState=0},t.Pa=function(c){if(this.g&&(this.l=c,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=c.headers,this.readyState=2,La(this)),this.g&&(this.readyState=3,La(this),this.g)))if(this.responseType==="arraybuffer")c.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in c){if(this.j=c.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;W_(this)}else c.text().then(this.Oa.bind(this),this.ga.bind(this))};function W_(c){c.j.read().then(c.Ma.bind(c)).catch(c.ga.bind(c))}t.Ma=function(c){if(this.g){if(this.o&&c.value)this.response.push(c.value);else if(!this.o){var p=c.value?c.value:new Uint8Array(0);(p=this.B.decode(p,{stream:!c.done}))&&(this.response=this.responseText+=p)}c.done?ja(this):La(this),this.readyState==3&&W_(this)}},t.Oa=function(c){this.g&&(this.response=this.responseText=c,ja(this))},t.Na=function(c){this.g&&(this.response=c,ja(this))},t.ga=function(){this.g&&ja(this)};function ja(c){c.readyState=4,c.l=null,c.j=null,c.B=null,La(c)}t.setRequestHeader=function(c,p){this.A.append(c,p)},t.getResponseHeader=function(c){return this.h&&this.h.get(c.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const c=[],p=this.h.entries();for(var g=p.next();!g.done;)g=g.value,c.push(g[0]+": "+g[1]),g=p.next();return c.join(`\r
`)};function La(c){c.onreadystatechange&&c.onreadystatechange.call(c)}Object.defineProperty(Bc.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(c){this.m=c?"include":"same-origin"}});function K_(c){let p="";return ce(c,function(g,x){p+=x,p+=":",p+=g,p+=`\r
`}),p}function yf(c,p,g){e:{for(x in g){var x=!1;break e}x=!0}x||(g=K_(g),typeof c=="string"?g!=null&&Ra(g):Ke(c,p,g))}function ot(c){ne.call(this),this.headers=new Map,this.L=c||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}f(ot,ne);var Wb=/^https?$/i,Kb=["POST","PUT"];t=ot.prototype,t.Fa=function(c){this.H=c},t.ea=function(c,p,g,x){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+c);p=p?p.toUpperCase():"GET",this.D=c,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():b_.g(),this.g.onreadystatechange=m(u(this.Ca,this));try{this.B=!0,this.g.open(p,String(c),!0),this.B=!1}catch(F){G_(this,F);return}if(c=g||"",g=new Map(this.headers),x)if(Object.getPrototypeOf(x)===Object.prototype)for(var j in x)g.set(j,x[j]);else if(typeof x.keys=="function"&&typeof x.get=="function")for(const F of x.keys())g.set(F,x.get(F));else throw Error("Unknown input type for opt_headers: "+String(x));x=Array.from(g.keys()).find(F=>F.toLowerCase()=="content-type"),j=o.FormData&&c instanceof o.FormData,!(Array.prototype.indexOf.call(Kb,p,void 0)>=0)||x||j||g.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[F,Y]of g)this.g.setRequestHeader(F,Y);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(c),this.v=!1}catch(F){G_(this,F)}};function G_(c,p){c.h=!1,c.g&&(c.j=!0,c.g.abort(),c.j=!1),c.l=p,c.o=5,Q_(c),$c(c)}function Q_(c){c.A||(c.A=!0,T(c,"complete"),T(c,"error"))}t.abort=function(c){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=c||7,T(this,"complete"),T(this,"abort"),$c(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),$c(this,!0)),ot.Z.N.call(this)},t.Ca=function(){this.u||(this.B||this.v||this.j?Y_(this):this.Xa())},t.Xa=function(){Y_(this)};function Y_(c){if(c.h&&typeof s<"u"){if(c.v&&ii(c)==4)setTimeout(c.Ca.bind(c),0);else if(T(c,"readystatechange"),ii(c)==4){c.h=!1;try{const F=c.ca();e:switch(F){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var p=!0;break e;default:p=!1}var g;if(!(g=p)){var x;if(x=F===0){let Y=String(c.D).match(F_)[1]||null;!Y&&o.self&&o.self.location&&(Y=o.self.location.protocol.slice(0,-1)),x=!Wb.test(Y?Y.toLowerCase():"")}g=x}if(g)T(c,"complete"),T(c,"success");else{c.o=6;try{var j=ii(c)>2?c.g.statusText:""}catch{j=""}c.l=j+" ["+c.ca()+"]",Q_(c)}}finally{$c(c)}}}}function $c(c,p){if(c.g){c.m&&(clearTimeout(c.m),c.m=null);const g=c.g;c.g=null,p||T(c,"ready");try{g.onreadystatechange=null}catch{}}}t.isActive=function(){return!!this.g};function ii(c){return c.g?c.g.readyState:0}t.ca=function(){try{return ii(this)>2?this.g.status:-1}catch{return-1}},t.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.La=function(c){if(this.g){var p=this.g.responseText;return c&&p.indexOf(c)==0&&(p=p.substring(c.length)),Re(p)}};function X_(c){try{if(!c.g)return null;if("response"in c.g)return c.g.response;switch(c.F){case"":case"text":return c.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in c.g)return c.g.mozResponseArrayBuffer}return null}catch{return null}}function Gb(c){const p={};c=(c.g&&ii(c)>=2&&c.g.getAllResponseHeaders()||"").split(`\r
`);for(let x=0;x<c.length;x++){if(b(c[x]))continue;var g=Nb(c[x]);const j=g[0];if(g=g[1],typeof g!="string")continue;g=g.trim();const F=p[j]||[];p[j]=F,F.push(g)}he(p,function(x){return x.join(", ")})}t.ya=function(){return this.o},t.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function Ma(c,p,g){return g&&g.internalChannelParams&&g.internalChannelParams[c]||p}function J_(c){this.za=0,this.i=[],this.j=new br,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Ma("failFast",!1,c),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Ma("baseRetryDelayMs",5e3,c),this.Za=Ma("retryDelaySeedMs",1e4,c),this.Ta=Ma("forwardChannelMaxRetries",2,c),this.va=Ma("forwardChannelRequestTimeoutMs",2e4,c),this.ma=c&&c.xmlHttpFactory||void 0,this.Ua=c&&c.Rb||void 0,this.Aa=c&&c.useFetchStreams||!1,this.O=void 0,this.L=c&&c.supportsCrossDomainXhr||!1,this.M="",this.h=new V_(c&&c.concurrentRequestLimit),this.Ba=new Hb,this.S=c&&c.fastHandshake||!1,this.R=c&&c.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=c&&c.Pb||!1,c&&c.ua&&this.j.ua(),c&&c.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&c&&c.detectBufferingProxy||!1,this.ia=void 0,c&&c.longPollingTimeout&&c.longPollingTimeout>0&&(this.ia=c.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}t=J_.prototype,t.ka=8,t.I=1,t.connect=function(c,p,g,x){je(0),this.W=c,this.H=p||{},g&&x!==void 0&&(this.H.OSID=g,this.H.OAID=x),this.F=this.X,this.J=av(this,null,this.W),qc(this)};function _f(c){if(Z_(c),c.I==3){var p=c.V++,g=ar(c.J);if(Ke(g,"SID",c.M),Ke(g,"RID",p),Ke(g,"TYPE","terminate"),Fa(c,g),p=new ti(c,c.j,p),p.M=2,p.A=Uc(ar(g)),g=!1,o.navigator&&o.navigator.sendBeacon)try{g=o.navigator.sendBeacon(p.A.toString(),"")}catch{}!g&&o.Image&&(new Image().src=p.A,g=!0),g||(p.g=lv(p.j,null),p.g.ea(p.A)),p.F=Date.now(),Fc(p)}ov(c)}function zc(c){c.g&&(wf(c),c.g.cancel(),c.g=null)}function Z_(c){zc(c),c.v&&(o.clearTimeout(c.v),c.v=null),Hc(c),c.h.cancel(),c.m&&(typeof c.m=="number"&&o.clearTimeout(c.m),c.m=null)}function qc(c){if(!O_(c.h)&&!c.m){c.m=!0;var p=c.Ea;U||I(),$||(U(),$=!0),S.add(p,c),c.D=0}}function Qb(c,p){return j_(c.h)>=c.h.j-(c.m?1:0)?!1:c.m?(c.i=p.G.concat(c.i),!0):c.I==1||c.I==2||c.D>=(c.Sa?0:c.Ta)?!1:(c.m=ei(u(c.Ea,c,p),sv(c,c.D)),c.D++,!0)}t.Ea=function(c){if(this.m)if(this.m=null,this.I==1){if(!c){this.V=Math.floor(Math.random()*1e5),c=this.V++;const j=new ti(this,this.j,c);let F=this.o;if(this.U&&(F?(F=De(F),L(F,this.U)):F=this.U),this.u!==null||this.R||(j.J=F,F=null),this.S)e:{for(var p=0,g=0;g<this.i.length;g++){t:{var x=this.i[g];if("__data__"in x.map&&(x=x.map.__data__,typeof x=="string")){x=x.length;break t}x=void 0}if(x===void 0)break;if(p+=x,p>4096){p=g;break e}if(p===4096||g===this.i.length-1){p=g+1;break e}}p=1e3}else p=1e3;p=tv(this,j,p),g=ar(this.J),Ke(g,"RID",c),Ke(g,"CVER",22),this.G&&Ke(g,"X-HTTP-Session-Id",this.G),Fa(this,g),F&&(this.R?p="headers="+Ra(K_(F))+"&"+p:this.u&&yf(g,this.u,F)),pf(this.h,j),this.Ra&&Ke(g,"TYPE","init"),this.S?(Ke(g,"$req",p),Ke(g,"SID","null"),j.U=!0,uf(j,g,null)):uf(j,g,p),this.I=2}}else this.I==3&&(c?ev(this,c):this.i.length==0||O_(this.h)||ev(this))};function ev(c,p){var g;p?g=p.l:g=c.V++;const x=ar(c.J);Ke(x,"SID",c.M),Ke(x,"RID",g),Ke(x,"AID",c.K),Fa(c,x),c.u&&c.o&&yf(x,c.u,c.o),g=new ti(c,c.j,g,c.D+1),c.u===null&&(g.J=c.o),p&&(c.i=p.G.concat(c.i)),p=tv(c,g,1e3),g.H=Math.round(c.va*.5)+Math.round(c.va*.5*Math.random()),pf(c.h,g),uf(g,x,p)}function Fa(c,p){c.H&&ce(c.H,function(g,x){Ke(p,x,g)}),c.l&&ce({},function(g,x){Ke(p,x,g)})}function tv(c,p,g){g=Math.min(c.i.length,g);const x=c.l?u(c.l.Ka,c.l,c):null;e:{var j=c.i;let Ee=-1;for(;;){const wt=["count="+g];Ee==-1?g>0?(Ee=j[0].g,wt.push("ofs="+Ee)):Ee=0:wt.push("ofs="+Ee);let ze=!0;for(let At=0;At<g;At++){var F=j[At].g;const lr=j[At].map;if(F-=Ee,F<0)Ee=Math.max(0,j[At].g-100),ze=!1;else try{F="req"+F+"_"||"";try{var Y=lr instanceof Map?lr:Object.entries(lr);for(const[ls,si]of Y){let oi=si;a(si)&&(oi=He(si)),wt.push(F+ls+"="+encodeURIComponent(oi))}}catch(ls){throw wt.push(F+"type="+encodeURIComponent("_badmap")),ls}}catch{x&&x(lr)}}if(ze){Y=wt.join("&");break e}}Y=void 0}return c=c.i.splice(0,g),p.G=c,Y}function nv(c){if(!c.g&&!c.v){c.Y=1;var p=c.Da;U||I(),$||(U(),$=!0),S.add(p,c),c.A=0}}function vf(c){return c.g||c.v||c.A>=3?!1:(c.Y++,c.v=ei(u(c.Da,c),sv(c,c.A)),c.A++,!0)}t.Da=function(){if(this.v=null,rv(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var c=4*this.T;this.j.info("BP detection timer enabled: "+c),this.B=ei(u(this.Wa,this),c)}},t.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,je(10),zc(this),rv(this))};function wf(c){c.B!=null&&(o.clearTimeout(c.B),c.B=null)}function rv(c){c.g=new ti(c,c.j,"rpc",c.Y),c.u===null&&(c.g.J=c.o),c.g.P=0;var p=ar(c.na);Ke(p,"RID","rpc"),Ke(p,"SID",c.M),Ke(p,"AID",c.K),Ke(p,"CI",c.F?"0":"1"),!c.F&&c.ia&&Ke(p,"TO",c.ia),Ke(p,"TYPE","xmlhttp"),Fa(c,p),c.u&&c.o&&yf(p,c.u,c.o),c.O&&(c.g.H=c.O);var g=c.g;c=c.ba,g.M=1,g.A=Uc(ar(p)),g.u=null,g.R=!0,k_(g,c)}t.Va=function(){this.C!=null&&(this.C=null,zc(this),vf(this),je(19))};function Hc(c){c.C!=null&&(o.clearTimeout(c.C),c.C=null)}function iv(c,p){var g=null;if(c.g==p){Hc(c),wf(c),c.g=null;var x=2}else if(ff(c.h,p))g=p.G,L_(c.h,p),x=1;else return;if(c.I!=0){if(p.o)if(x==1){g=p.u?p.u.length:0,p=Date.now()-p.F;var j=c.D;x=sr(),T(x,new Lc(x,g)),qc(c)}else nv(c);else if(j=p.m,j==3||j==0&&p.X>0||!(x==1&&Qb(c,p)||x==2&&vf(c)))switch(g&&g.length>0&&(p=c.h,p.i=p.i.concat(g)),j){case 1:as(c,5);break;case 4:as(c,10);break;case 3:as(c,6);break;default:as(c,2)}}}function sv(c,p){let g=c.Qa+Math.floor(Math.random()*c.Za);return c.isActive()||(g*=2),g*p}function as(c,p){if(c.j.info("Error code "+p),p==2){var g=u(c.bb,c),x=c.Ua;const j=!x;x=new ni(x||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||ka(x,"https"),Uc(x),j?zb(x.toString(),g):qb(x.toString(),g)}else je(2);c.I=0,c.l&&c.l.pa(p),ov(c),Z_(c)}t.bb=function(c){c?(this.j.info("Successfully pinged google.com"),je(2)):(this.j.info("Failed to ping google.com"),je(1))};function ov(c){if(c.I=0,c.ja=[],c.l){const p=M_(c.h);(p.length!=0||c.i.length!=0)&&(_(c.ja,p),_(c.ja,c.i),c.h.i.length=0,E(c.i),c.i.length=0),c.l.oa()}}function av(c,p,g){var x=g instanceof ni?ar(g):new ni(g);if(x.g!="")p&&(x.g=p+"."+x.g),Na(x,x.u);else{var j=o.location;x=j.protocol,p=p?p+"."+j.hostname:j.hostname,j=+j.port;const F=new ni(null);x&&ka(F,x),p&&(F.g=p),j&&Na(F,j),g&&(F.h=g),x=F}return g=c.G,p=c.wa,g&&p&&Ke(x,g,p),Ke(x,"VER",c.ka),Fa(c,x),x}function lv(c,p,g){if(p&&!c.L)throw Error("Can't create secondary domain capable XhrIo object.");return p=c.Aa&&!c.ma?new ot(new gf({ab:g})):new ot(c.ma),p.Fa(c.L),p}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function cv(){}t=cv.prototype,t.ra=function(){},t.qa=function(){},t.pa=function(){},t.oa=function(){},t.isActive=function(){return!0},t.Ka=function(){};function Wc(){}Wc.prototype.g=function(c,p){return new _n(c,p)};function _n(c,p){ne.call(this),this.g=new J_(p),this.l=c,this.h=p&&p.messageUrlParams||null,c=p&&p.messageHeaders||null,p&&p.clientProtocolHeaderRequired&&(c?c["X-Client-Protocol"]="webchannel":c={"X-Client-Protocol":"webchannel"}),this.g.o=c,c=p&&p.initMessageHeaders||null,p&&p.messageContentType&&(c?c["X-WebChannel-Content-Type"]=p.messageContentType:c={"X-WebChannel-Content-Type":p.messageContentType}),p&&p.sa&&(c?c["X-WebChannel-Client-Profile"]=p.sa:c={"X-WebChannel-Client-Profile":p.sa}),this.g.U=c,(c=p&&p.Qb)&&!b(c)&&(this.g.u=c),this.A=p&&p.supportsCrossDomainXhr||!1,this.v=p&&p.sendRawJson||!1,(p=p&&p.httpSessionIdParam)&&!b(p)&&(this.g.G=p,c=this.h,c!==null&&p in c&&(c=this.h,p in c&&delete c[p])),this.j=new lo(this)}f(_n,ne),_n.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},_n.prototype.close=function(){_f(this.g)},_n.prototype.o=function(c){var p=this.g;if(typeof c=="string"){var g={};g.__data__=c,c=g}else this.v&&(g={},g.__data__=He(c),c=g);p.i.push(new Ob(p.Ya++,c)),p.I==3&&qc(p)},_n.prototype.N=function(){this.g.l=null,delete this.j,_f(this.g),delete this.g,_n.Z.N.call(this)};function uv(c){Ar.call(this),c.__headers__&&(this.headers=c.__headers__,this.statusCode=c.__status__,delete c.__headers__,delete c.__status__);var p=c.__sm__;if(p){e:{for(const g in p){c=g;break e}c=void 0}(this.i=c)&&(c=this.i,p=p!==null&&c in p?p[c]:void 0),this.data=p}else this.data=c}f(uv,Ar);function dv(){ba.call(this),this.status=1}f(dv,ba);function lo(c){this.g=c}f(lo,cv),lo.prototype.ra=function(){T(this.g,"a")},lo.prototype.qa=function(c){T(this.g,new uv(c))},lo.prototype.pa=function(c){T(this.g,new dv)},lo.prototype.oa=function(){T(this.g,"b")},Wc.prototype.createWebChannel=Wc.prototype.g,_n.prototype.send=_n.prototype.o,_n.prototype.open=_n.prototype.m,_n.prototype.close=_n.prototype.close,LS=function(){return new Wc},jS=function(){return sr()},OS=gn,Am={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},Mc.NO_ERROR=0,Mc.TIMEOUT=8,Mc.HTTP_ERROR=6,$u=Mc,C_.COMPLETE="complete",VS=C_,mn.EventType=Jr,Jr.OPEN="a",Jr.CLOSE="b",Jr.ERROR="c",Jr.MESSAGE="d",ne.prototype.listen=ne.prototype.J,ll=mn,ot.prototype.listenOnce=ot.prototype.K,ot.prototype.getLastError=ot.prototype.Ha,ot.prototype.getLastErrorCode=ot.prototype.ya,ot.prototype.getStatus=ot.prototype.ca,ot.prototype.getResponseJson=ot.prototype.La,ot.prototype.getResponseText=ot.prototype.la,ot.prototype.send=ot.prototype.ea,ot.prototype.setWithCredentials=ot.prototype.Fa,DS=ot}).apply(typeof fu<"u"?fu:typeof self<"u"?self:typeof window<"u"?window:{});const oE="@firebase/firestore",aE="4.9.2";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nt{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Nt.UNAUTHENTICATED=new Nt(null),Nt.GOOGLE_CREDENTIALS=new Nt("google-credentials-uid"),Nt.FIRST_PARTY=new Nt("first-party-uid"),Nt.MOCK_USER=new Nt("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let xa="12.3.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Us=new Ih("@firebase/firestore");function wo(){return Us.logLevel}function W(t,...e){if(Us.logLevel<=Ce.DEBUG){const n=e.map(gy);Us.debug(`Firestore (${xa}): ${t}`,...n)}}function Jt(t,...e){if(Us.logLevel<=Ce.ERROR){const n=e.map(gy);Us.error(`Firestore (${xa}): ${t}`,...n)}}function Bs(t,...e){if(Us.logLevel<=Ce.WARN){const n=e.map(gy);Us.warn(`Firestore (${xa}): ${t}`,...n)}}function gy(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function se(t,e,n){let r="Unexpected state";typeof e=="string"?r=e:n=e,MS(t,r,n)}function MS(t,e,n){let r=`FIRESTORE (${xa}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(n!==void 0)try{r+=" CONTEXT: "+JSON.stringify(n)}catch{r+=" CONTEXT: "+n}throw Jt(r),new Error(r)}function ae(t,e,n,r){let i="Unexpected state";typeof n=="string"?i=n:r=n,t||MS(e,i,r)}function ge(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const B={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class G extends zn{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jn{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FS{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class UV{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(Nt.UNAUTHENTICATED))}shutdown(){}}class BV{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class $V{constructor(e){this.t=e,this.currentUser=Nt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){ae(this.o===void 0,42304);let r=this.i;const i=l=>this.i!==r?(r=this.i,n(l)):Promise.resolve();let s=new Jn;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new Jn,e.enqueueRetryable(()=>i(this.currentUser))};const o=()=>{const l=s;e.enqueueRetryable(async()=>{await l.promise,await i(this.currentUser)})},a=l=>{W("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(l=>a(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?a(l):(W("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new Jn)}},0),o()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(W("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(ae(typeof r.accessToken=="string",31837,{l:r}),new FS(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return ae(e===null||typeof e=="string",2055,{h:e}),new Nt(e)}}class zV{constructor(e,n,r){this.P=e,this.T=n,this.I=r,this.type="FirstParty",this.user=Nt.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class qV{constructor(e,n,r){this.P=e,this.T=n,this.I=r}getToken(){return Promise.resolve(new zV(this.P,this.T,this.I))}start(e,n){e.enqueueRetryable(()=>n(Nt.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class lE{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class HV{constructor(e,n){this.V=n,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Dn(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,n){ae(this.o===void 0,3512);const r=s=>{s.error!=null&&W("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const o=s.token!==this.m;return this.m=s.token,W("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};const i=s=>{W("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){const s=this.V.getImmediate({optional:!0});s?i(s):W("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new lE(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(ae(typeof n.token=="string",44558,{tokenResult:n}),this.m=n.token,new lE(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function WV(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yy{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const i=WV(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<n&&(r+=e.charAt(i[s]%62))}return r}}function we(t,e){return t<e?-1:t>e?1:0}function Cm(t,e){const n=Math.min(t.length,e.length);for(let r=0;r<n;r++){const i=t.charAt(r),s=e.charAt(r);if(i!==s)return rp(i)===rp(s)?we(i,s):rp(i)?1:-1}return we(t.length,e.length)}const KV=55296,GV=57343;function rp(t){const e=t.charCodeAt(0);return e>=KV&&e<=GV}function ia(t,e,n){return t.length===e.length&&t.every((r,i)=>n(r,e[i]))}function US(t){return t+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cE="__name__";class hr{constructor(e,n,r){n===void 0?n=0:n>e.length&&se(637,{offset:n,range:e.length}),r===void 0?r=e.length-n:r>e.length-n&&se(1746,{length:r,range:e.length-n}),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return hr.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof hr?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let i=0;i<r;i++){const s=hr.compareSegments(e.get(i),n.get(i));if(s!==0)return s}return we(e.length,n.length)}static compareSegments(e,n){const r=hr.isNumericId(e),i=hr.isNumericId(n);return r&&!i?-1:!r&&i?1:r&&i?hr.extractNumericId(e).compare(hr.extractNumericId(n)):Cm(e,n)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Mi.fromString(e.substring(4,e.length-2))}}class Oe extends hr{construct(e,n,r){return new Oe(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new G(B.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(i=>i.length>0))}return new Oe(n)}static emptyPath(){return new Oe([])}}const QV=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class rt extends hr{construct(e,n,r){return new rt(e,n,r)}static isValidIdentifier(e){return QV.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),rt.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===cE}static keyField(){return new rt([cE])}static fromServerFormat(e){const n=[];let r="",i=0;const s=()=>{if(r.length===0)throw new G(B.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let o=!1;for(;i<e.length;){const a=e[i];if(a==="\\"){if(i+1===e.length)throw new G(B.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[i+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new G(B.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=l,i+=2}else a==="`"?(o=!o,i++):a!=="."||o?(r+=a,i++):(s(),i++)}if(s(),o)throw new G(B.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new rt(n)}static emptyPath(){return new rt([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X{constructor(e){this.path=e}static fromPath(e){return new X(Oe.fromString(e))}static fromName(e){return new X(Oe.fromString(e).popFirst(5))}static empty(){return new X(Oe.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Oe.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return Oe.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new X(new Oe(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function BS(t,e,n){if(!n)throw new G(B.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function YV(t,e,n,r){if(e===!0&&r===!0)throw new G(B.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function uE(t){if(!X.isDocumentKey(t))throw new G(B.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function dE(t){if(X.isDocumentKey(t))throw new G(B.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function $S(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function bh(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":se(12329,{type:typeof t})}function Ht(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new G(B.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=bh(t);throw new G(B.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}function XV(t,e){if(e<=0)throw new G(B.INVALID_ARGUMENT,`Function ${t}() requires a positive number, but it was: ${e}.`)}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yt(t,e){const n={typeString:t};return e&&(n.value=e),n}function Tc(t,e){if(!$S(t))throw new G(B.INVALID_ARGUMENT,"JSON must be an object");let n;for(const r in e)if(e[r]){const i=e[r].typeString,s="value"in e[r]?{value:e[r].value}:void 0;if(!(r in t)){n=`JSON missing required field: '${r}'`;break}const o=t[r];if(i&&typeof o!==i){n=`JSON field '${r}' must be a ${i}.`;break}if(s!==void 0&&o!==s.value){n=`Expected '${r}' field to equal '${s.value}'`;break}}if(n)throw new G(B.INVALID_ARGUMENT,n);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hE=-62135596800,fE=1e6;class Ne{static now(){return Ne.fromMillis(Date.now())}static fromDate(e){return Ne.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor((e-1e3*n)*fE);return new Ne(n,r)}constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new G(B.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new G(B.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<hE)throw new G(B.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new G(B.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/fE}_compareTo(e){return this.seconds===e.seconds?we(this.nanoseconds,e.nanoseconds):we(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:Ne._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Tc(e,Ne._jsonSchema))return new Ne(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-hE;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}Ne._jsonSchemaVersion="firestore/timestamp/1.0",Ne._jsonSchema={type:yt("string",Ne._jsonSchemaVersion),seconds:yt("number"),nanoseconds:yt("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class de{static fromTimestamp(e){return new de(e)}static min(){return new de(new Ne(0,0))}static max(){return new de(new Ne(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ec=-1;class Dd{constructor(e,n,r,i){this.indexId=e,this.collectionGroup=n,this.fields=r,this.indexState=i}}function bm(t){return t.fields.find(e=>e.kind===2)}function ps(t){return t.fields.filter(e=>e.kind!==2)}Dd.UNKNOWN_ID=-1;class zu{constructor(e,n){this.fieldPath=e,this.kind=n}}class tc{constructor(e,n){this.sequenceNumber=e,this.offset=n}static empty(){return new tc(0,Cn.min())}}function JV(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,i=de.fromTimestamp(r===1e9?new Ne(n+1,0):new Ne(n,r));return new Cn(i,X.empty(),e)}function zS(t){return new Cn(t.readTime,t.key,ec)}class Cn{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new Cn(de.min(),X.empty(),ec)}static max(){return new Cn(de.max(),X.empty(),ec)}}function _y(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=X.comparator(t.documentKey,e.documentKey),n!==0?n:we(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qS="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class HS{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function io(t){if(t.code!==B.FAILED_PRECONDITION||t.message!==qS)throw t;W("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&se(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new O((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(n,s).next(r,i)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof O?n:O.resolve(n)}catch(n){return O.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):O.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):O.reject(n)}static resolve(e){return new O((n,r)=>{n(e)})}static reject(e){return new O((n,r)=>{r(e)})}static waitFor(e){return new O((n,r)=>{let i=0,s=0,o=!1;e.forEach(a=>{++i,a.next(()=>{++s,o&&s===i&&n()},l=>r(l))}),o=!0,s===i&&n()})}static or(e){let n=O.resolve(!1);for(const r of e)n=n.next(i=>i?O.resolve(i):r());return n}static forEach(e,n){const r=[];return e.forEach((i,s)=>{r.push(n.call(this,i,s))}),this.waitFor(r)}static mapArray(e,n){return new O((r,i)=>{const s=e.length,o=new Array(s);let a=0;for(let l=0;l<s;l++){const u=l;n(e[u]).next(h=>{o[u]=h,++a,a===s&&r(o)},h=>i(h))}})}static doWhile(e,n){return new O((r,i)=>{const s=()=>{e()===!0?n().next(()=>{s()},i):r()};s()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wn="SimpleDb";class Rh{static open(e,n,r,i){try{return new Rh(n,e.transaction(i,r))}catch(s){throw new Sl(n,s)}}constructor(e,n){this.action=e,this.transaction=n,this.aborted=!1,this.S=new Jn,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{n.error?this.S.reject(new Sl(e,n.error)):this.S.resolve()},this.transaction.onerror=r=>{const i=vy(r.target.error);this.S.reject(new Sl(e,i))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(W(wn,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}C(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const n=this.transaction.objectStore(e);return new eO(n)}}class Fi{static delete(e){return W(wn,"Removing database:",e),gs(Ox().indexedDB.deleteDatabase(e)).toPromise()}static v(){if(!iy())return!1;if(Fi.F())return!0;const e=xt(),n=Fi.M(e),r=0<n&&n<10,i=WS(e),s=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||s)}static F(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)==null?void 0:e.__PRIVATE_USE_MOCK_PERSISTENCE)==="YES"}static O(e,n){return e.store(n)}static M(e){const n=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=n?n[1].split("_").slice(0,2).join("."):"-1";return Number(r)}constructor(e,n,r){this.name=e,this.version=n,this.N=r,this.B=null,Fi.M(xt())===12.2&&Jt("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async L(e){return this.db||(W(wn,"Opening database:",this.name),this.db=await new Promise((n,r)=>{const i=indexedDB.open(this.name,this.version);i.onsuccess=s=>{const o=s.target.result;n(o)},i.onblocked=()=>{r(new Sl(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=s=>{const o=s.target.error;o.name==="VersionError"?r(new G(B.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?r(new G(B.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):r(new Sl(e,o))},i.onupgradeneeded=s=>{W(wn,'Database "'+this.name+'" requires upgrade from version:',s.oldVersion);const o=s.target.result;this.N.k(o,i.transaction,s.oldVersion,this.version).next(()=>{W(wn,"Database upgrade to version "+this.version+" complete")})}})),this.q&&(this.db.onversionchange=n=>this.q(n)),this.db}$(e){this.q=e,this.db&&(this.db.onversionchange=n=>e(n))}async runTransaction(e,n,r,i){const s=n==="readonly";let o=0;for(;;){++o;try{this.db=await this.L(e);const a=Rh.open(this.db,e,s?"readonly":"readwrite",r),l=i(a).next(u=>(a.C(),u)).catch(u=>(a.abort(u),O.reject(u))).toPromise();return l.catch(()=>{}),await a.D,l}catch(a){const l=a,u=l.name!=="FirebaseError"&&o<3;if(W(wn,"Transaction failed with error:",l.message,"Retrying:",u),this.close(),!u)return Promise.reject(l)}}}close(){this.db&&this.db.close(),this.db=void 0}}function WS(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}class ZV{constructor(e){this.U=e,this.K=!1,this.W=null}get isDone(){return this.K}get G(){return this.W}set cursor(e){this.U=e}done(){this.K=!0}j(e){this.W=e}delete(){return gs(this.U.delete())}}class Sl extends G{constructor(e,n){super(B.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${n}`),this.name="IndexedDbTransactionError"}}function ns(t){return t.name==="IndexedDbTransactionError"}class eO{constructor(e){this.store=e}put(e,n){let r;return n!==void 0?(W(wn,"PUT",this.store.name,e,n),r=this.store.put(n,e)):(W(wn,"PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),gs(r)}add(e){return W(wn,"ADD",this.store.name,e,e),gs(this.store.add(e))}get(e){return gs(this.store.get(e)).next(n=>(n===void 0&&(n=null),W(wn,"GET",this.store.name,e,n),n))}delete(e){return W(wn,"DELETE",this.store.name,e),gs(this.store.delete(e))}count(){return W(wn,"COUNT",this.store.name),gs(this.store.count())}J(e,n){const r=this.options(e,n),i=r.index?this.store.index(r.index):this.store;if(typeof i.getAll=="function"){const s=i.getAll(r.range);return new O((o,a)=>{s.onerror=l=>{a(l.target.error)},s.onsuccess=l=>{o(l.target.result)}})}{const s=this.cursor(r),o=[];return this.H(s,(a,l)=>{o.push(l)}).next(()=>o)}}Y(e,n){const r=this.store.getAll(e,n===null?void 0:n);return new O((i,s)=>{r.onerror=o=>{s(o.target.error)},r.onsuccess=o=>{i(o.target.result)}})}Z(e,n){W(wn,"DELETE ALL",this.store.name);const r=this.options(e,n);r.X=!1;const i=this.cursor(r);return this.H(i,(s,o,a)=>a.delete())}ee(e,n){let r;n?r=e:(r={},n=e);const i=this.cursor(r);return this.H(i,n)}te(e){const n=this.cursor({});return new O((r,i)=>{n.onerror=s=>{const o=vy(s.target.error);i(o)},n.onsuccess=s=>{const o=s.target.result;o?e(o.primaryKey,o.value).next(a=>{a?o.continue():r()}):r()}})}H(e,n){const r=[];return new O((i,s)=>{e.onerror=o=>{s(o.target.error)},e.onsuccess=o=>{const a=o.target.result;if(!a)return void i();const l=new ZV(a),u=n(a.primaryKey,a.value,l);if(u instanceof O){const h=u.catch(f=>(l.done(),O.reject(f)));r.push(h)}l.isDone?i():l.G===null?a.continue():a.continue(l.G)}}).next(()=>O.waitFor(r))}options(e,n){let r;return e!==void 0&&(typeof e=="string"?r=e:n=e),{index:r,range:n}}cursor(e){let n="next";if(e.reverse&&(n="prev"),e.index){const r=this.store.index(e.index);return e.X?r.openKeyCursor(e.range,n):r.openCursor(e.range,n)}return this.store.openCursor(e.range,n)}}function gs(t){return new O((e,n)=>{t.onsuccess=r=>{const i=r.target.result;e(i)},t.onerror=r=>{const i=vy(r.target.error);n(i)}})}let pE=!1;function vy(t){const e=Fi.M(xt());if(e>=12.2&&e<13){const n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){const r=new G("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${n}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return pE||(pE=!0,setTimeout(()=>{throw r},0)),r}}return t}const Al="IndexBackfiller";class tO{constructor(e,n){this.asyncQueue=e,this.ne=n,this.task=null}start(){this.re(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}re(e){W(Al,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{const n=await this.ne.ie();W(Al,`Documents written: ${n}`)}catch(n){ns(n)?W(Al,"Ignoring IndexedDB error during index backfill: ",n):await io(n)}await this.re(6e4)})}}class nO{constructor(e,n){this.localStore=e,this.persistence=n}async ie(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",n=>this.se(n,e))}se(e,n){const r=new Set;let i=n,s=!0;return O.doWhile(()=>s===!0&&i>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(o!==null&&!r.has(o))return W(Al,`Processing collection: ${o}`),this.oe(e,o,i).next(a=>{i-=a,r.add(o)});s=!1})).next(()=>n-i)}oe(e,n,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,n).next(i=>this.localStore.localDocuments.getNextDocuments(e,n,i,r).next(s=>{const o=s.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this._e(i,s)).next(a=>(W(Al,`Updating offset: ${a}`),this.localStore.indexManager.updateCollectionGroup(e,n,a))).next(()=>o.size)}))}_e(e,n){let r=e;return n.changes.forEach((i,s)=>{const o=zS(s);_y(o,r)>0&&(r=o)}),new Cn(r.readTime,r.documentKey,Math.max(n.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jn{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ae(r),this.ue=r=>n.writeSequenceNumber(r))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}jn.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bs=-1;function Ph(t){return t==null}function nc(t){return t===0&&1/t==-1/0}function rO(t){return typeof t=="number"&&Number.isInteger(t)&&!nc(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vd="";function Wt(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=mE(e)),e=iO(t.get(n),e);return mE(e)}function iO(t,e){let n=e;const r=t.length;for(let i=0;i<r;i++){const s=t.charAt(i);switch(s){case"\0":n+="";break;case Vd:n+="";break;default:n+=s}}return n}function mE(t){return t+Vd+""}function pr(t){const e=t.length;if(ae(e>=2,64408,{path:t}),e===2)return ae(t.charAt(0)===Vd&&t.charAt(1)==="",56145,{path:t}),Oe.emptyPath();const n=e-2,r=[];let i="";for(let s=0;s<e;){const o=t.indexOf(Vd,s);switch((o<0||o>n)&&se(50515,{path:t}),t.charAt(o+1)){case"":const a=t.substring(s,o);let l;i.length===0?l=a:(i+=a,l=i,i=""),r.push(l);break;case"":i+=t.substring(s,o),i+="\0";break;case"":i+=t.substring(s,o+1);break;default:se(61167,{path:t})}s=o+2}return new Oe(r)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ms="remoteDocuments",xc="owner",uo="owner",rc="mutationQueues",sO="userId",Kn="mutations",gE="batchId",xs="userMutationsIndex",yE=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qu(t,e){return[t,Wt(e)]}function KS(t,e,n){return[t,Wt(e),n]}const oO={},sa="documentMutations",Od="remoteDocumentsV14",aO=["prefixPath","collectionGroup","readTime","documentId"],Hu="documentKeyIndex",lO=["prefixPath","collectionGroup","documentId"],GS="collectionGroupIndex",cO=["collectionGroup","readTime","prefixPath","documentId"],ic="remoteDocumentGlobal",Rm="remoteDocumentGlobalKey",oa="targets",QS="queryTargetsIndex",uO=["canonicalId","targetId"],aa="targetDocuments",dO=["targetId","path"],wy="documentTargetsIndex",hO=["path","targetId"],jd="targetGlobalKey",Rs="targetGlobal",sc="collectionParents",fO=["collectionId","parent"],la="clientMetadata",pO="clientId",kh="bundles",mO="bundleId",Nh="namedQueries",gO="name",Ey="indexConfiguration",yO="indexId",Pm="collectionGroupIndex",_O="collectionGroup",Cl="indexState",vO=["indexId","uid"],YS="sequenceNumberIndex",wO=["uid","sequenceNumber"],bl="indexEntries",EO=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],XS="documentKeyIndex",IO=["indexId","uid","orderedDocumentKey"],Dh="documentOverlays",TO=["userId","collectionPath","documentId"],km="collectionPathOverlayIndex",xO=["userId","collectionPath","largestBatchId"],JS="collectionGroupOverlayIndex",SO=["userId","collectionGroup","largestBatchId"],Iy="globals",AO="name",ZS=[rc,Kn,sa,ms,oa,xc,Rs,aa,la,ic,sc,kh,Nh],CO=[...ZS,Dh],eA=[rc,Kn,sa,Od,oa,xc,Rs,aa,la,ic,sc,kh,Nh,Dh],tA=eA,Ty=[...tA,Ey,Cl,bl],bO=Ty,nA=[...Ty,Iy],RO=nA;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nm extends HS{constructor(e,n){super(),this.le=e,this.currentSequenceNumber=n}}function St(t,e){const n=ge(t);return Fi.O(n.le,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _E(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function rs(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function PO(t,e){const n=[];for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&n.push(e(t[r],r,t));return n}function rA(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tt{constructor(e,n){this.comparator=e,this.root=n||Dt.EMPTY}insert(e,n){return new tt(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,Dt.BLACK,null,null))}remove(e){return new tt(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Dt.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(e,r.key);if(i===0)return n+r.left.size;i<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new pu(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new pu(this.root,e,this.comparator,!1)}getReverseIterator(){return new pu(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new pu(this.root,e,this.comparator,!0)}}class pu{constructor(e,n,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=n?r(e.key,n):1,n&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Dt{constructor(e,n,r,i,s){this.key=e,this.value=n,this.color=r??Dt.RED,this.left=i??Dt.EMPTY,this.right=s??Dt.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,i,s){return new Dt(e??this.key,n??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let i=this;const s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,n,r),null):s===0?i.copy(null,n,null,null,null):i.copy(null,null,null,null,i.right.insert(e,n,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return Dt.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),n(e,i.key)===0){if(i.right.isEmpty())return Dt.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Dt.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Dt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw se(43730,{key:this.key,value:this.value});if(this.right.isRed())throw se(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw se(27949);return e+(this.isRed()?0:1)}}Dt.EMPTY=null,Dt.RED=!0,Dt.BLACK=!1;Dt.EMPTY=new class{constructor(){this.size=0}get key(){throw se(57766)}get value(){throw se(16141)}get color(){throw se(16727)}get left(){throw se(29726)}get right(){throw se(36894)}copy(e,n,r,i,s){return this}insert(e,n,r){return new Dt(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ue{constructor(e){this.comparator=e,this.data=new tt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;n(i.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new vE(this.data.getIterator())}getIteratorFrom(e){return new vE(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof Ue)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const i=n.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new Ue(this.comparator);return n.data=e,n}}class vE{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function ho(t){return t.hasNext()?t.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class un{constructor(e){this.fields=e,e.sort(rt.comparator)}static empty(){return new un([])}unionWith(e){let n=new Ue(rt.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new un(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return ia(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iA extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _t{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new iA("Invalid base64 string: "+s):s}}(e);return new _t(n)}static fromUint8Array(e){const n=function(i){let s="";for(let o=0;o<i.length;++o)s+=String.fromCharCode(i[o]);return s}(e);return new _t(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return we(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}_t.EMPTY_BYTE_STRING=new _t("");const kO=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Kr(t){if(ae(!!t,39018),typeof t=="string"){let e=0;const n=kO.exec(t);if(ae(!!n,46558,{timestamp:t}),n[1]){let i=n[1];i=(i+"000000000").substr(0,9),e=Number(i)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:Je(t.seconds),nanos:Je(t.nanos)}}function Je(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Gr(t){return typeof t=="string"?_t.fromBase64String(t):_t.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sA="server_timestamp",oA="__type__",aA="__previous_value__",lA="__local_write_time__";function Vh(t){var n,r;return((r=(((n=t==null?void 0:t.mapValue)==null?void 0:n.fields)||{})[oA])==null?void 0:r.stringValue)===sA}function Oh(t){const e=t.mapValue.fields[aA];return Vh(e)?Oh(e):e}function oc(t){const e=Kr(t.mapValue.fields[lA].timestampValue);return new Ne(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NO{constructor(e,n,r,i,s,o,a,l,u,h){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=l,this.useFetchStreams=u,this.isUsingEmulator=h}}const Ld="(default)";class $s{constructor(e,n){this.projectId=e,this.database=n||Ld}static empty(){return new $s("","")}get isDefaultDatabase(){return this.database===Ld}isEqual(e){return e instanceof $s&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xy="__type__",cA="__max__",Ai={mapValue:{fields:{__type__:{stringValue:cA}}}},Sy="__vector__",ca="value",Wu={nullValue:"NULL_VALUE"};function qi(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Vh(t)?4:uA(t)?9007199254740991:jh(t)?10:11:se(28295,{value:t})}function xr(t,e){if(t===e)return!0;const n=qi(t);if(n!==qi(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return oc(t).isEqual(oc(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const o=Kr(i.timestampValue),a=Kr(s.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(i,s){return Gr(i.bytesValue).isEqual(Gr(s.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(i,s){return Je(i.geoPointValue.latitude)===Je(s.geoPointValue.latitude)&&Je(i.geoPointValue.longitude)===Je(s.geoPointValue.longitude)}(t,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return Je(i.integerValue)===Je(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const o=Je(i.doubleValue),a=Je(s.doubleValue);return o===a?nc(o)===nc(a):isNaN(o)&&isNaN(a)}return!1}(t,e);case 9:return ia(t.arrayValue.values||[],e.arrayValue.values||[],xr);case 10:case 11:return function(i,s){const o=i.mapValue.fields||{},a=s.mapValue.fields||{};if(_E(o)!==_E(a))return!1;for(const l in o)if(o.hasOwnProperty(l)&&(a[l]===void 0||!xr(o[l],a[l])))return!1;return!0}(t,e);default:return se(52216,{left:t})}}function ac(t,e){return(t.values||[]).find(n=>xr(n,e))!==void 0}function Hi(t,e){if(t===e)return 0;const n=qi(t),r=qi(e);if(n!==r)return we(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return we(t.booleanValue,e.booleanValue);case 2:return function(s,o){const a=Je(s.integerValue||s.doubleValue),l=Je(o.integerValue||o.doubleValue);return a<l?-1:a>l?1:a===l?0:isNaN(a)?isNaN(l)?0:-1:1}(t,e);case 3:return wE(t.timestampValue,e.timestampValue);case 4:return wE(oc(t),oc(e));case 5:return Cm(t.stringValue,e.stringValue);case 6:return function(s,o){const a=Gr(s),l=Gr(o);return a.compareTo(l)}(t.bytesValue,e.bytesValue);case 7:return function(s,o){const a=s.split("/"),l=o.split("/");for(let u=0;u<a.length&&u<l.length;u++){const h=we(a[u],l[u]);if(h!==0)return h}return we(a.length,l.length)}(t.referenceValue,e.referenceValue);case 8:return function(s,o){const a=we(Je(s.latitude),Je(o.latitude));return a!==0?a:we(Je(s.longitude),Je(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return EE(t.arrayValue,e.arrayValue);case 10:return function(s,o){var m,E,_,A;const a=s.fields||{},l=o.fields||{},u=(m=a[ca])==null?void 0:m.arrayValue,h=(E=l[ca])==null?void 0:E.arrayValue,f=we(((_=u==null?void 0:u.values)==null?void 0:_.length)||0,((A=h==null?void 0:h.values)==null?void 0:A.length)||0);return f!==0?f:EE(u,h)}(t.mapValue,e.mapValue);case 11:return function(s,o){if(s===Ai.mapValue&&o===Ai.mapValue)return 0;if(s===Ai.mapValue)return 1;if(o===Ai.mapValue)return-1;const a=s.fields||{},l=Object.keys(a),u=o.fields||{},h=Object.keys(u);l.sort(),h.sort();for(let f=0;f<l.length&&f<h.length;++f){const m=Cm(l[f],h[f]);if(m!==0)return m;const E=Hi(a[l[f]],u[h[f]]);if(E!==0)return E}return we(l.length,h.length)}(t.mapValue,e.mapValue);default:throw se(23264,{he:n})}}function wE(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return we(t,e);const n=Kr(t),r=Kr(e),i=we(n.seconds,r.seconds);return i!==0?i:we(n.nanos,r.nanos)}function EE(t,e){const n=t.values||[],r=e.values||[];for(let i=0;i<n.length&&i<r.length;++i){const s=Hi(n[i],r[i]);if(s)return s}return we(n.length,r.length)}function ua(t){return Dm(t)}function Dm(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=Kr(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return Gr(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return X.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",i=!0;for(const s of n.values||[])i?i=!1:r+=",",r+=Dm(s);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let i="{",s=!0;for(const o of r)s?s=!1:i+=",",i+=`${o}:${Dm(n.fields[o])}`;return i+"}"}(t.mapValue):se(61005,{value:t})}function Ku(t){switch(qi(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Oh(t);return e?16+Ku(e):16;case 5:return 2*t.stringValue.length;case 6:return Gr(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return function(r){return(r.values||[]).reduce((i,s)=>i+Ku(s),0)}(t.arrayValue);case 10:case 11:return function(r){let i=0;return rs(r.fields,(s,o)=>{i+=s.length+Ku(o)}),i}(t.mapValue);default:throw se(13486,{value:t})}}function zs(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function Vm(t){return!!t&&"integerValue"in t}function lc(t){return!!t&&"arrayValue"in t}function IE(t){return!!t&&"nullValue"in t}function TE(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Gu(t){return!!t&&"mapValue"in t}function jh(t){var n,r;return((r=(((n=t==null?void 0:t.mapValue)==null?void 0:n.fields)||{})[xy])==null?void 0:r.stringValue)===Sy}function Rl(t){if(t.geoPointValue)return{geoPointValue:{...t.geoPointValue}};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:{...t.timestampValue}};if(t.mapValue){const e={mapValue:{fields:{}}};return rs(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=Rl(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=Rl(t.arrayValue.values[n]);return e}return{...t}}function uA(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===cA}const dA={mapValue:{fields:{[xy]:{stringValue:Sy},[ca]:{arrayValue:{}}}}};function DO(t){return"nullValue"in t?Wu:"booleanValue"in t?{booleanValue:!1}:"integerValue"in t||"doubleValue"in t?{doubleValue:NaN}:"timestampValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in t?{stringValue:""}:"bytesValue"in t?{bytesValue:""}:"referenceValue"in t?zs($s.empty(),X.empty()):"geoPointValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in t?{arrayValue:{}}:"mapValue"in t?jh(t)?dA:{mapValue:{}}:se(35942,{value:t})}function VO(t){return"nullValue"in t?{booleanValue:!1}:"booleanValue"in t?{doubleValue:NaN}:"integerValue"in t||"doubleValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in t?{stringValue:""}:"stringValue"in t?{bytesValue:""}:"bytesValue"in t?zs($s.empty(),X.empty()):"referenceValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in t?{arrayValue:{}}:"arrayValue"in t?dA:"mapValue"in t?jh(t)?{mapValue:{}}:Ai:se(61959,{value:t})}function xE(t,e){const n=Hi(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?-1:!t.inclusive&&e.inclusive?1:0}function SE(t,e){const n=Hi(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?1:!t.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zt{constructor(e){this.value=e}static empty(){return new zt({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!Gu(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=Rl(n)}setAll(e){let n=rt.emptyPath(),r={},i=[];e.forEach((o,a)=>{if(!n.isImmediateParentOf(a)){const l=this.getFieldsMap(n);this.applyChanges(l,r,i),r={},i=[],n=a.popLast()}o?r[a.lastSegment()]=Rl(o):i.push(a.lastSegment())});const s=this.getFieldsMap(n);this.applyChanges(s,r,i)}delete(e){const n=this.field(e.popLast());Gu(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return xr(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=n.mapValue.fields[e.get(r)];Gu(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=i),n=i}return n.mapValue.fields}applyChanges(e,n,r){rs(n,(i,s)=>e[i]=s);for(const i of r)delete e[i]}clone(){return new zt(Rl(this.value))}}function hA(t){const e=[];return rs(t.fields,(n,r)=>{const i=new rt([n]);if(Gu(r)){const s=hA(r.mapValue).fields;if(s.length===0)e.push(i);else for(const o of s)e.push(i.child(o))}else e.push(i)}),new un(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lt{constructor(e,n,r,i,s,o,a){this.key=e,this.documentType=n,this.version=r,this.readTime=i,this.createTime=s,this.data=o,this.documentState=a}static newInvalidDocument(e){return new lt(e,0,de.min(),de.min(),de.min(),zt.empty(),0)}static newFoundDocument(e,n,r,i){return new lt(e,1,n,de.min(),r,i,0)}static newNoDocument(e,n){return new lt(e,2,n,de.min(),de.min(),zt.empty(),0)}static newUnknownDocument(e,n){return new lt(e,3,n,de.min(),de.min(),zt.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(de.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=zt.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=zt.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=de.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof lt&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new lt(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wi{constructor(e,n){this.position=e,this.inclusive=n}}function AE(t,e,n){let r=0;for(let i=0;i<t.position.length;i++){const s=e[i],o=t.position[i];if(s.field.isKeyField()?r=X.comparator(X.fromName(o.referenceValue),n.key):r=Hi(o,n.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function CE(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!xr(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cc{constructor(e,n="asc"){this.field=e,this.dir=n}}function OO(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fA{}class be extends fA{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new jO(e,n,r):n==="array-contains"?new FO(e,r):n==="in"?new vA(e,r):n==="not-in"?new UO(e,r):n==="array-contains-any"?new BO(e,r):new be(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new LO(e,r):new MO(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&n.nullValue===void 0&&this.matchesComparison(Hi(n,this.value)):n!==null&&qi(this.value)===qi(n)&&this.matchesComparison(Hi(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return se(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Me extends fA{constructor(e,n){super(),this.filters=e,this.op=n,this.Pe=null}static create(e,n){return new Me(e,n)}matches(e){return da(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function da(t){return t.op==="and"}function Om(t){return t.op==="or"}function Ay(t){return pA(t)&&da(t)}function pA(t){for(const e of t.filters)if(e instanceof Me)return!1;return!0}function jm(t){if(t instanceof be)return t.field.canonicalString()+t.op.toString()+ua(t.value);if(Ay(t))return t.filters.map(e=>jm(e)).join(",");{const e=t.filters.map(n=>jm(n)).join(",");return`${t.op}(${e})`}}function mA(t,e){return t instanceof be?function(r,i){return i instanceof be&&r.op===i.op&&r.field.isEqual(i.field)&&xr(r.value,i.value)}(t,e):t instanceof Me?function(r,i){return i instanceof Me&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((s,o,a)=>s&&mA(o,i.filters[a]),!0):!1}(t,e):void se(19439)}function gA(t,e){const n=t.filters.concat(e);return Me.create(n,t.op)}function yA(t){return t instanceof be?function(n){return`${n.field.canonicalString()} ${n.op} ${ua(n.value)}`}(t):t instanceof Me?function(n){return n.op.toString()+" {"+n.getFilters().map(yA).join(" ,")+"}"}(t):"Filter"}class jO extends be{constructor(e,n,r){super(e,n,r),this.key=X.fromName(r.referenceValue)}matches(e){const n=X.comparator(e.key,this.key);return this.matchesComparison(n)}}class LO extends be{constructor(e,n){super(e,"in",n),this.keys=_A("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class MO extends be{constructor(e,n){super(e,"not-in",n),this.keys=_A("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function _A(t,e){var n;return(((n=e.arrayValue)==null?void 0:n.values)||[]).map(r=>X.fromName(r.referenceValue))}class FO extends be{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return lc(n)&&ac(n.arrayValue,this.value)}}class vA extends be{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&ac(this.value.arrayValue,n)}}class UO extends be{constructor(e,n){super(e,"not-in",n)}matches(e){if(ac(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&n.nullValue===void 0&&!ac(this.value.arrayValue,n)}}class BO extends be{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!lc(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>ac(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $O{constructor(e,n=null,r=[],i=[],s=null,o=null,a=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=o,this.endAt=a,this.Te=null}}function Lm(t,e=null,n=[],r=[],i=null,s=null,o=null){return new $O(t,e,n,r,i,s,o)}function qs(t){const e=ge(t);if(e.Te===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>jm(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),Ph(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>ua(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>ua(r)).join(",")),e.Te=n}return e.Te}function Sc(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!OO(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!mA(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!CE(t.startAt,e.startAt)&&CE(t.endAt,e.endAt)}function Md(t){return X.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}function Fd(t,e){return t.filters.filter(n=>n instanceof be&&n.field.isEqual(e))}function bE(t,e,n){let r=Wu,i=!0;for(const s of Fd(t,e)){let o=Wu,a=!0;switch(s.op){case"<":case"<=":o=DO(s.value);break;case"==":case"in":case">=":o=s.value;break;case">":o=s.value,a=!1;break;case"!=":case"not-in":o=Wu}xE({value:r,inclusive:i},{value:o,inclusive:a})<0&&(r=o,i=a)}if(n!==null){for(let s=0;s<t.orderBy.length;++s)if(t.orderBy[s].field.isEqual(e)){const o=n.position[s];xE({value:r,inclusive:i},{value:o,inclusive:n.inclusive})<0&&(r=o,i=n.inclusive);break}}return{value:r,inclusive:i}}function RE(t,e,n){let r=Ai,i=!0;for(const s of Fd(t,e)){let o=Ai,a=!0;switch(s.op){case">=":case">":o=VO(s.value),a=!1;break;case"==":case"in":case"<=":o=s.value;break;case"<":o=s.value,a=!1;break;case"!=":case"not-in":o=Ai}SE({value:r,inclusive:i},{value:o,inclusive:a})>0&&(r=o,i=a)}if(n!==null){for(let s=0;s<t.orderBy.length;++s)if(t.orderBy[s].field.isEqual(e)){const o=n.position[s];SE({value:r,inclusive:i},{value:o,inclusive:n.inclusive})>0&&(r=o,i=n.inclusive);break}}return{value:r,inclusive:i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class is{constructor(e,n=null,r=[],i=[],s=null,o="F",a=null,l=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=o,this.startAt=a,this.endAt=l,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function zO(t,e,n,r,i,s,o,a){return new is(t,e,n,r,i,s,o,a)}function Ac(t){return new is(t)}function PE(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function Cy(t){return t.collectionGroup!==null}function Wo(t){const e=ge(t);if(e.Ie===null){e.Ie=[];const n=new Set;for(const s of e.explicitOrderBy)e.Ie.push(s),n.add(s.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new Ue(rt.comparator);return o.filters.forEach(l=>{l.getFlattenedFilters().forEach(u=>{u.isInequality()&&(a=a.add(u.field))})}),a})(e).forEach(s=>{n.has(s.canonicalString())||s.isKeyField()||e.Ie.push(new cc(s,r))}),n.has(rt.keyField().canonicalString())||e.Ie.push(new cc(rt.keyField(),r))}return e.Ie}function Mn(t){const e=ge(t);return e.Ee||(e.Ee=wA(e,Wo(t))),e.Ee}function qO(t){const e=ge(t);return e.de||(e.de=wA(e,t.explicitOrderBy)),e.de}function wA(t,e){if(t.limitType==="F")return Lm(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(i=>{const s=i.dir==="desc"?"asc":"desc";return new cc(i.field,s)});const n=t.endAt?new Wi(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new Wi(t.startAt.position,t.startAt.inclusive):null;return Lm(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function Mm(t,e){const n=t.filters.concat([e]);return new is(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function Ud(t,e,n){return new is(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Lh(t,e){return Sc(Mn(t),Mn(e))&&t.limitType===e.limitType}function EA(t){return`${qs(Mn(t))}|lt:${t.limitType}`}function Eo(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(i=>yA(i)).join(", ")}]`),Ph(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(i=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(i)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(i=>ua(i)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(i=>ua(i)).join(",")),`Target(${r})`}(Mn(t))}; limitType=${t.limitType})`}function Cc(t,e){return e.isFoundDocument()&&function(r,i){const s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):X.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)}(t,e)&&function(r,i){for(const s of Wo(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(t,e)&&function(r,i){for(const s of r.filters)if(!s.matches(i))return!1;return!0}(t,e)&&function(r,i){return!(r.startAt&&!function(o,a,l){const u=AE(o,a,l);return o.inclusive?u<=0:u<0}(r.startAt,Wo(r),i)||r.endAt&&!function(o,a,l){const u=AE(o,a,l);return o.inclusive?u>=0:u>0}(r.endAt,Wo(r),i))}(t,e)}function HO(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function IA(t){return(e,n)=>{let r=!1;for(const i of Wo(t)){const s=WO(i,e,n);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function WO(t,e,n){const r=t.field.isKeyField()?X.comparator(e.key,n.key):function(s,o,a){const l=o.data.field(s),u=a.data.field(s);return l!==null&&u!==null?Hi(l,u):se(42886)}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return se(19790,{direction:t.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yr{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,n]);i.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[n]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){rs(this.inner,(n,r)=>{for(const[i,s]of r)e(i,s)})}isEmpty(){return rA(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KO=new tt(X.comparator);function Tn(){return KO}const TA=new tt(X.comparator);function cl(...t){let e=TA;for(const n of t)e=e.insert(n.key,n);return e}function xA(t){let e=TA;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function mr(){return Pl()}function SA(){return Pl()}function Pl(){return new Yr(t=>t.toString(),(t,e)=>t.isEqual(e))}const GO=new tt(X.comparator),QO=new Ue(X.comparator);function Te(...t){let e=QO;for(const n of t)e=e.add(n);return e}const YO=new Ue(we);function XO(){return YO}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function by(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:nc(e)?"-0":e}}function AA(t){return{integerValue:""+t}}function JO(t,e){return rO(e)?AA(e):by(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mh{constructor(){this._=void 0}}function ZO(t,e,n){return t instanceof ha?function(i,s){const o={fields:{[oA]:{stringValue:sA},[lA]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&Vh(s)&&(s=Oh(s)),s&&(o.fields[aA]=s),{mapValue:o}}(n,e):t instanceof Hs?bA(t,e):t instanceof fa?RA(t,e):function(i,s){const o=CA(i,s),a=kE(o)+kE(i.Ae);return Vm(o)&&Vm(i.Ae)?AA(a):by(i.serializer,a)}(t,e)}function ej(t,e,n){return t instanceof Hs?bA(t,e):t instanceof fa?RA(t,e):n}function CA(t,e){return t instanceof uc?function(r){return Vm(r)||function(s){return!!s&&"doubleValue"in s}(r)}(e)?e:{integerValue:0}:null}class ha extends Mh{}class Hs extends Mh{constructor(e){super(),this.elements=e}}function bA(t,e){const n=PA(e);for(const r of t.elements)n.some(i=>xr(i,r))||n.push(r);return{arrayValue:{values:n}}}class fa extends Mh{constructor(e){super(),this.elements=e}}function RA(t,e){let n=PA(e);for(const r of t.elements)n=n.filter(i=>!xr(i,r));return{arrayValue:{values:n}}}class uc extends Mh{constructor(e,n){super(),this.serializer=e,this.Ae=n}}function kE(t){return Je(t.integerValue||t.doubleValue)}function PA(t){return lc(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ry{constructor(e,n){this.field=e,this.transform=n}}function tj(t,e){return t.field.isEqual(e.field)&&function(r,i){return r instanceof Hs&&i instanceof Hs||r instanceof fa&&i instanceof fa?ia(r.elements,i.elements,xr):r instanceof uc&&i instanceof uc?xr(r.Ae,i.Ae):r instanceof ha&&i instanceof ha}(t.transform,e.transform)}class nj{constructor(e,n){this.version=e,this.transformResults=n}}class qt{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new qt}static exists(e){return new qt(void 0,e)}static updateTime(e){return new qt(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Qu(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class Fh{}function kA(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new Uh(t.key,qt.none()):new Sa(t.key,t.data,qt.none());{const n=t.data,r=zt.empty();let i=new Ue(rt.comparator);for(let s of e.fields)if(!i.has(s)){let o=n.field(s);o===null&&s.length>1&&(s=s.popLast(),o=n.field(s)),o===null?r.delete(s):r.set(s,o),i=i.add(s)}return new Xr(t.key,r,new un(i.toArray()),qt.none())}}function rj(t,e,n){t instanceof Sa?function(i,s,o){const a=i.value.clone(),l=DE(i.fieldTransforms,s,o.transformResults);a.setAll(l),s.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(t,e,n):t instanceof Xr?function(i,s,o){if(!Qu(i.precondition,s))return void s.convertToUnknownDocument(o.version);const a=DE(i.fieldTransforms,s,o.transformResults),l=s.data;l.setAll(NA(i)),l.setAll(a),s.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(t,e,n):function(i,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,n)}function kl(t,e,n,r){return t instanceof Sa?function(s,o,a,l){if(!Qu(s.precondition,o))return a;const u=s.value.clone(),h=VE(s.fieldTransforms,l,o);return u.setAll(h),o.convertToFoundDocument(o.version,u).setHasLocalMutations(),null}(t,e,n,r):t instanceof Xr?function(s,o,a,l){if(!Qu(s.precondition,o))return a;const u=VE(s.fieldTransforms,l,o),h=o.data;return h.setAll(NA(s)),h.setAll(u),o.convertToFoundDocument(o.version,h).setHasLocalMutations(),a===null?null:a.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(f=>f.field))}(t,e,n,r):function(s,o,a){return Qu(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(t,e,n)}function ij(t,e){let n=null;for(const r of t.fieldTransforms){const i=e.data.field(r.field),s=CA(r.transform,i||null);s!=null&&(n===null&&(n=zt.empty()),n.set(r.field,s))}return n||null}function NE(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&ia(r,i,(s,o)=>tj(s,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class Sa extends Fh{constructor(e,n,r,i=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class Xr extends Fh{constructor(e,n,r,i,s=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function NA(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function DE(t,e,n){const r=new Map;ae(t.length===n.length,32656,{Re:n.length,Ve:t.length});for(let i=0;i<n.length;i++){const s=t[i],o=s.transform,a=e.data.field(s.field);r.set(s.field,ej(o,a,n[i]))}return r}function VE(t,e,n){const r=new Map;for(const i of t){const s=i.transform,o=n.data.field(i.field);r.set(i.field,ZO(s,o,e))}return r}class Uh extends Fh{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class DA extends Fh{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Py{constructor(e,n,r,i){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(e.key)&&rj(s,e,r[i])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=kl(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=kl(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=SA();return this.mutations.forEach(i=>{const s=e.get(i.key),o=s.overlayedDocument;let a=this.applyToLocalView(o,s.mutatedFields);a=n.has(i.key)?null:a;const l=kA(o,a);l!==null&&r.set(i.key,l),o.isValidDocument()||o.convertToNoDocument(de.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),Te())}isEqual(e){return this.batchId===e.batchId&&ia(this.mutations,e.mutations,(n,r)=>NE(n,r))&&ia(this.baseMutations,e.baseMutations,(n,r)=>NE(n,r))}}class ky{constructor(e,n,r,i){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=i}static from(e,n,r){ae(e.mutations.length===r.length,58842,{me:e.mutations.length,fe:r.length});let i=function(){return GO}();const s=e.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,r[o].version);return new ky(e,n,r,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ny{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sj{constructor(e,n,r){this.alias=e,this.aggregateType=n,this.fieldPath=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oj{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var pt,ke;function aj(t){switch(t){case B.OK:return se(64938);case B.CANCELLED:case B.UNKNOWN:case B.DEADLINE_EXCEEDED:case B.RESOURCE_EXHAUSTED:case B.INTERNAL:case B.UNAVAILABLE:case B.UNAUTHENTICATED:return!1;case B.INVALID_ARGUMENT:case B.NOT_FOUND:case B.ALREADY_EXISTS:case B.PERMISSION_DENIED:case B.FAILED_PRECONDITION:case B.ABORTED:case B.OUT_OF_RANGE:case B.UNIMPLEMENTED:case B.DATA_LOSS:return!0;default:return se(15467,{code:t})}}function VA(t){if(t===void 0)return Jt("GRPC error has no .code"),B.UNKNOWN;switch(t){case pt.OK:return B.OK;case pt.CANCELLED:return B.CANCELLED;case pt.UNKNOWN:return B.UNKNOWN;case pt.DEADLINE_EXCEEDED:return B.DEADLINE_EXCEEDED;case pt.RESOURCE_EXHAUSTED:return B.RESOURCE_EXHAUSTED;case pt.INTERNAL:return B.INTERNAL;case pt.UNAVAILABLE:return B.UNAVAILABLE;case pt.UNAUTHENTICATED:return B.UNAUTHENTICATED;case pt.INVALID_ARGUMENT:return B.INVALID_ARGUMENT;case pt.NOT_FOUND:return B.NOT_FOUND;case pt.ALREADY_EXISTS:return B.ALREADY_EXISTS;case pt.PERMISSION_DENIED:return B.PERMISSION_DENIED;case pt.FAILED_PRECONDITION:return B.FAILED_PRECONDITION;case pt.ABORTED:return B.ABORTED;case pt.OUT_OF_RANGE:return B.OUT_OF_RANGE;case pt.UNIMPLEMENTED:return B.UNIMPLEMENTED;case pt.DATA_LOSS:return B.DATA_LOSS;default:return se(39323,{code:t})}}(ke=pt||(pt={}))[ke.OK=0]="OK",ke[ke.CANCELLED=1]="CANCELLED",ke[ke.UNKNOWN=2]="UNKNOWN",ke[ke.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ke[ke.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ke[ke.NOT_FOUND=5]="NOT_FOUND",ke[ke.ALREADY_EXISTS=6]="ALREADY_EXISTS",ke[ke.PERMISSION_DENIED=7]="PERMISSION_DENIED",ke[ke.UNAUTHENTICATED=16]="UNAUTHENTICATED",ke[ke.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ke[ke.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ke[ke.ABORTED=10]="ABORTED",ke[ke.OUT_OF_RANGE=11]="OUT_OF_RANGE",ke[ke.UNIMPLEMENTED=12]="UNIMPLEMENTED",ke[ke.INTERNAL=13]="INTERNAL",ke[ke.UNAVAILABLE=14]="UNAVAILABLE",ke[ke.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lj(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cj=new Mi([4294967295,4294967295],0);function OE(t){const e=lj().encode(t),n=new NS;return n.update(e),new Uint8Array(n.digest())}function jE(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new Mi([n,r],0),new Mi([i,s],0)]}class Dy{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new ul(`Invalid padding: ${n}`);if(r<0)throw new ul(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new ul(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new ul(`Invalid padding when bitmap length is 0: ${n}`);this.ge=8*e.length-n,this.pe=Mi.fromNumber(this.ge)}ye(e,n,r){let i=e.add(n.multiply(Mi.fromNumber(r)));return i.compare(cj)===1&&(i=new Mi([i.getBits(0),i.getBits(1)],0)),i.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const n=OE(e),[r,i]=jE(n);for(let s=0;s<this.hashCount;s++){const o=this.ye(r,i,s);if(!this.we(o))return!1}return!0}static create(e,n,r){const i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new Dy(s,i,n);return r.forEach(a=>o.insert(a)),o}insert(e){if(this.ge===0)return;const n=OE(e),[r,i]=jE(n);for(let s=0;s<this.hashCount;s++){const o=this.ye(r,i,s);this.Se(o)}}Se(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class ul extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bh{constructor(e,n,r,i,s){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const i=new Map;return i.set(e,bc.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new Bh(de.min(),i,new tt(we),Tn(),Te())}}class bc{constructor(e,n,r,i,s){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new bc(r,n,Te(),Te(),Te())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yu{constructor(e,n,r,i){this.be=e,this.removedTargetIds=n,this.key=r,this.De=i}}class OA{constructor(e,n){this.targetId=e,this.Ce=n}}class jA{constructor(e,n,r=_t.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=i}}class LE{constructor(){this.ve=0,this.Fe=ME(),this.Me=_t.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=Te(),n=Te(),r=Te();return this.Fe.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:n=n.add(i);break;case 1:r=r.add(i);break;default:se(38017,{changeType:s})}}),new bc(this.Me,this.xe,e,n,r)}qe(){this.Oe=!1,this.Fe=ME()}Qe(e,n){this.Oe=!0,this.Fe=this.Fe.insert(e,n)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,ae(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class uj{constructor(e){this.Ge=e,this.ze=new Map,this.je=Tn(),this.Je=mu(),this.He=mu(),this.Ye=new tt(we)}Ze(e){for(const n of e.be)e.De&&e.De.isFoundDocument()?this.Xe(n,e.De):this.et(n,e.key,e.De);for(const n of e.removedTargetIds)this.et(n,e.key,e.De)}tt(e){this.forEachTarget(e,n=>{const r=this.nt(n);switch(e.state){case 0:this.rt(n)&&r.Le(e.resumeToken);break;case 1:r.Ke(),r.Ne||r.qe(),r.Le(e.resumeToken);break;case 2:r.Ke(),r.Ne||this.removeTarget(n);break;case 3:this.rt(n)&&(r.We(),r.Le(e.resumeToken));break;case 4:this.rt(n)&&(this.it(n),r.Le(e.resumeToken));break;default:se(56790,{state:e.state})}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.ze.forEach((r,i)=>{this.rt(i)&&n(i)})}st(e){const n=e.targetId,r=e.Ce.count,i=this.ot(n);if(i){const s=i.target;if(Md(s))if(r===0){const o=new X(s.path);this.et(n,o,lt.newNoDocument(o,de.min()))}else ae(r===1,20013,{expectedCount:r});else{const o=this._t(n);if(o!==r){const a=this.ut(e),l=a?this.ct(a,e,o):1;if(l!==0){this.it(n);const u=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(n,u)}}}}}ut(e){const n=e.Ce.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=n;let o,a;try{o=Gr(r).toUint8Array()}catch(l){if(l instanceof iA)return Bs("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{a=new Dy(o,i,s)}catch(l){return Bs(l instanceof ul?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return a.ge===0?null:a}ct(e,n,r){return n.Ce.count===r-this.Pt(e,n.targetId)?0:2}Pt(e,n){const r=this.Ge.getRemoteKeysForTarget(n);let i=0;return r.forEach(s=>{const o=this.Ge.ht(),a=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(a)||(this.et(n,s,null),i++)}),i}Tt(e){const n=new Map;this.ze.forEach((s,o)=>{const a=this.ot(o);if(a){if(s.current&&Md(a.target)){const l=new X(a.target.path);this.It(l).has(o)||this.Et(o,l)||this.et(o,l,lt.newNoDocument(l,e))}s.Be&&(n.set(o,s.ke()),s.qe())}});let r=Te();this.He.forEach((s,o)=>{let a=!0;o.forEachWhile(l=>{const u=this.ot(l);return!u||u.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(s))}),this.je.forEach((s,o)=>o.setReadTime(e));const i=new Bh(e,n,this.Ye,this.je,r);return this.je=Tn(),this.Je=mu(),this.He=mu(),this.Ye=new tt(we),i}Xe(e,n){if(!this.rt(e))return;const r=this.Et(e,n.key)?2:0;this.nt(e).Qe(n.key,r),this.je=this.je.insert(n.key,n),this.Je=this.Je.insert(n.key,this.It(n.key).add(e)),this.He=this.He.insert(n.key,this.dt(n.key).add(e))}et(e,n,r){if(!this.rt(e))return;const i=this.nt(e);this.Et(e,n)?i.Qe(n,1):i.$e(n),this.He=this.He.insert(n,this.dt(n).delete(e)),this.He=this.He.insert(n,this.dt(n).add(e)),r&&(this.je=this.je.insert(n,r))}removeTarget(e){this.ze.delete(e)}_t(e){const n=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let n=this.ze.get(e);return n||(n=new LE,this.ze.set(e,n)),n}dt(e){let n=this.He.get(e);return n||(n=new Ue(we),this.He=this.He.insert(e,n)),n}It(e){let n=this.Je.get(e);return n||(n=new Ue(we),this.Je=this.Je.insert(e,n)),n}rt(e){const n=this.ot(e)!==null;return n||W("WatchChangeAggregator","Detected inactive target",e),n}ot(e){const n=this.ze.get(e);return n&&n.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new LE),this.Ge.getRemoteKeysForTarget(e).forEach(n=>{this.et(e,n,null)})}Et(e,n){return this.Ge.getRemoteKeysForTarget(e).has(n)}}function mu(){return new tt(X.comparator)}function ME(){return new tt(X.comparator)}const dj={asc:"ASCENDING",desc:"DESCENDING"},hj={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},fj={and:"AND",or:"OR"};class pj{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function Fm(t,e){return t.useProto3Json||Ph(e)?e:{value:e}}function pa(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function LA(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function mj(t,e){return pa(t,e.toTimestamp())}function tn(t){return ae(!!t,49232),de.fromTimestamp(function(n){const r=Kr(n);return new Ne(r.seconds,r.nanos)}(t))}function Vy(t,e){return Um(t,e).canonicalString()}function Um(t,e){const n=function(i){return new Oe(["projects",i.projectId,"databases",i.database])}(t).child("documents");return e===void 0?n:n.child(e)}function MA(t){const e=Oe.fromString(t);return ae(WA(e),10190,{key:e.toString()}),e}function Bd(t,e){return Vy(t.databaseId,e.path)}function Ps(t,e){const n=MA(e);if(n.get(1)!==t.databaseId.projectId)throw new G(B.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new G(B.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new X(BA(n))}function FA(t,e){return Vy(t.databaseId,e)}function UA(t){const e=MA(t);return e.length===4?Oe.emptyPath():BA(e)}function Bm(t){return new Oe(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function BA(t){return ae(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function FE(t,e,n){return{name:Bd(t,e),fields:n.value.mapValue.fields}}function gj(t,e,n){const r=Ps(t,e.name),i=tn(e.updateTime),s=e.createTime?tn(e.createTime):de.min(),o=new zt({mapValue:{fields:e.fields}}),a=lt.newFoundDocument(r,i,s,o);return n&&a.setHasCommittedMutations(),n?a.setHasCommittedMutations():a}function yj(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(u){return u==="NO_CHANGE"?0:u==="ADD"?1:u==="REMOVE"?2:u==="CURRENT"?3:u==="RESET"?4:se(39313,{state:u})}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(u,h){return u.useProto3Json?(ae(h===void 0||typeof h=="string",58123),_t.fromBase64String(h||"")):(ae(h===void 0||h instanceof Buffer||h instanceof Uint8Array,16193),_t.fromUint8Array(h||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(u){const h=u.code===void 0?B.UNKNOWN:VA(u.code);return new G(h,u.message||"")}(o);n=new jA(r,i,s,a||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const i=Ps(t,r.document.name),s=tn(r.document.updateTime),o=r.document.createTime?tn(r.document.createTime):de.min(),a=new zt({mapValue:{fields:r.document.fields}}),l=lt.newFoundDocument(i,s,o,a),u=r.targetIds||[],h=r.removedTargetIds||[];n=new Yu(u,h,l.key,l)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const i=Ps(t,r.document),s=r.readTime?tn(r.readTime):de.min(),o=lt.newNoDocument(i,s),a=r.removedTargetIds||[];n=new Yu([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const i=Ps(t,r.document),s=r.removedTargetIds||[];n=new Yu([],s,i,null)}else{if(!("filter"in e))return se(11601,{Rt:e});{e.filter;const r=e.filter;r.targetId;const{count:i=0,unchangedNames:s}=r,o=new oj(i,s),a=r.targetId;n=new OA(a,o)}}return n}function $d(t,e){let n;if(e instanceof Sa)n={update:FE(t,e.key,e.value)};else if(e instanceof Uh)n={delete:Bd(t,e.key)};else if(e instanceof Xr)n={update:FE(t,e.key,e.data),updateMask:xj(e.fieldMask)};else{if(!(e instanceof DA))return se(16599,{Vt:e.type});n={verify:Bd(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(s,o){const a=o.transform;if(a instanceof ha)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof Hs)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof fa)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof uc)return{fieldPath:o.field.canonicalString(),increment:a.Ae};throw se(20930,{transform:o.transform})}(0,r))),e.precondition.isNone||(n.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:mj(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:se(27497)}(t,e.precondition)),n}function $m(t,e){const n=e.currentDocument?function(s){return s.updateTime!==void 0?qt.updateTime(tn(s.updateTime)):s.exists!==void 0?qt.exists(s.exists):qt.none()}(e.currentDocument):qt.none(),r=e.updateTransforms?e.updateTransforms.map(i=>function(o,a){let l=null;if("setToServerValue"in a)ae(a.setToServerValue==="REQUEST_TIME",16630,{proto:a}),l=new ha;else if("appendMissingElements"in a){const h=a.appendMissingElements.values||[];l=new Hs(h)}else if("removeAllFromArray"in a){const h=a.removeAllFromArray.values||[];l=new fa(h)}else"increment"in a?l=new uc(o,a.increment):se(16584,{proto:a});const u=rt.fromServerFormat(a.fieldPath);return new Ry(u,l)}(t,i)):[];if(e.update){e.update.name;const i=Ps(t,e.update.name),s=new zt({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=function(l){const u=l.fieldPaths||[];return new un(u.map(h=>rt.fromServerFormat(h)))}(e.updateMask);return new Xr(i,s,o,n,r)}return new Sa(i,s,n,r)}if(e.delete){const i=Ps(t,e.delete);return new Uh(i,n)}if(e.verify){const i=Ps(t,e.verify);return new DA(i,n)}return se(1463,{proto:e})}function _j(t,e){return t&&t.length>0?(ae(e!==void 0,14353),t.map(n=>function(i,s){let o=i.updateTime?tn(i.updateTime):tn(s);return o.isEqual(de.min())&&(o=tn(s)),new nj(o,i.transformResults||[])}(n,e))):[]}function $A(t,e){return{documents:[FA(t,e.path)]}}function Oy(t,e){const n={structuredQuery:{}},r=e.path;let i;e.collectionGroup!==null?(i=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=FA(t,i);const s=function(u){if(u.length!==0)return HA(Me.create(u,"and"))}(e.filters);s&&(n.structuredQuery.where=s);const o=function(u){if(u.length!==0)return u.map(h=>function(m){return{field:Ei(m.field),direction:Ej(m.dir)}}(h))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);const a=Fm(t,e.limit);return a!==null&&(n.structuredQuery.limit=a),e.startAt&&(n.structuredQuery.startAt=function(u){return{before:u.inclusive,values:u.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(u){return{before:!u.inclusive,values:u.position}}(e.endAt)),{ft:n,parent:i}}function vj(t,e,n,r){const{ft:i,parent:s}=Oy(t,e),o={},a=[];let l=0;return n.forEach(u=>{const h="aggregate_"+l++;o[h]=u.alias,u.aggregateType==="count"?a.push({alias:h,count:{}}):u.aggregateType==="avg"?a.push({alias:h,avg:{field:Ei(u.fieldPath)}}):u.aggregateType==="sum"&&a.push({alias:h,sum:{field:Ei(u.fieldPath)}})}),{request:{structuredAggregationQuery:{aggregations:a,structuredQuery:i.structuredQuery},parent:i.parent},gt:o,parent:s}}function zA(t){let e=UA(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let i=null;if(r>0){ae(r===1,65062);const h=n.from[0];h.allDescendants?i=h.collectionId:e=e.child(h.collectionId)}let s=[];n.where&&(s=function(f){const m=qA(f);return m instanceof Me&&Ay(m)?m.getFilters():[m]}(n.where));let o=[];n.orderBy&&(o=function(f){return f.map(m=>function(_){return new cc(Io(_.field),function(P){switch(P){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(_.direction))}(m))}(n.orderBy));let a=null;n.limit&&(a=function(f){let m;return m=typeof f=="object"?f.value:f,Ph(m)?null:m}(n.limit));let l=null;n.startAt&&(l=function(f){const m=!!f.before,E=f.values||[];return new Wi(E,m)}(n.startAt));let u=null;return n.endAt&&(u=function(f){const m=!f.before,E=f.values||[];return new Wi(E,m)}(n.endAt)),zO(e,i,o,s,a,"F",l,u)}function wj(t,e){const n=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return se(28987,{purpose:i})}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function qA(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=Io(n.unaryFilter.field);return be.create(r,"==",{doubleValue:NaN});case"IS_NULL":const i=Io(n.unaryFilter.field);return be.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=Io(n.unaryFilter.field);return be.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=Io(n.unaryFilter.field);return be.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return se(61313);default:return se(60726)}}(t):t.fieldFilter!==void 0?function(n){return be.create(Io(n.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return se(58110);default:return se(50506)}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return Me.create(n.compositeFilter.filters.map(r=>qA(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return se(1026)}}(n.compositeFilter.op))}(t):se(30097,{filter:t})}function Ej(t){return dj[t]}function Ij(t){return hj[t]}function Tj(t){return fj[t]}function Ei(t){return{fieldPath:t.canonicalString()}}function Io(t){return rt.fromServerFormat(t.fieldPath)}function HA(t){return t instanceof be?function(n){if(n.op==="=="){if(TE(n.value))return{unaryFilter:{field:Ei(n.field),op:"IS_NAN"}};if(IE(n.value))return{unaryFilter:{field:Ei(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(TE(n.value))return{unaryFilter:{field:Ei(n.field),op:"IS_NOT_NAN"}};if(IE(n.value))return{unaryFilter:{field:Ei(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Ei(n.field),op:Ij(n.op),value:n.value}}}(t):t instanceof Me?function(n){const r=n.getFilters().map(i=>HA(i));return r.length===1?r[0]:{compositeFilter:{op:Tj(n.op),filters:r}}}(t):se(54877,{filter:t})}function xj(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function WA(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jr{constructor(e,n,r,i,s=de.min(),o=de.min(),a=_t.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=l}withSequenceNumber(e){return new jr(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new jr(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new jr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new jr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KA{constructor(e){this.yt=e}}function Sj(t,e){let n;if(e.document)n=gj(t.yt,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=X.fromSegments(e.noDocument.path),i=Ks(e.noDocument.readTime);n=lt.newNoDocument(r,i),e.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!e.unknownDocument)return se(56709);{const r=X.fromSegments(e.unknownDocument.path),i=Ks(e.unknownDocument.version);n=lt.newUnknownDocument(r,i)}}return e.readTime&&n.setReadTime(function(i){const s=new Ne(i[0],i[1]);return de.fromTimestamp(s)}(e.readTime)),n}function UE(t,e){const n=e.key,r={prefixPath:n.getCollectionPath().popLast().toArray(),collectionGroup:n.collectionGroup,documentId:n.path.lastSegment(),readTime:zd(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=function(s,o){return{name:Bd(s,o.key),fields:o.data.value.mapValue.fields,updateTime:pa(s,o.version.toTimestamp()),createTime:pa(s,o.createTime.toTimestamp())}}(t.yt,e);else if(e.isNoDocument())r.noDocument={path:n.path.toArray(),readTime:Ws(e.version)};else{if(!e.isUnknownDocument())return se(57904,{document:e});r.unknownDocument={path:n.path.toArray(),version:Ws(e.version)}}return r}function zd(t){const e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function Ws(t){const e=t.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function Ks(t){const e=new Ne(t.seconds,t.nanoseconds);return de.fromTimestamp(e)}function ys(t,e){const n=(e.baseMutations||[]).map(s=>$m(t.yt,s));for(let s=0;s<e.mutations.length-1;++s){const o=e.mutations[s];if(s+1<e.mutations.length&&e.mutations[s+1].transform!==void 0){const a=e.mutations[s+1];o.updateTransforms=a.transform.fieldTransforms,e.mutations.splice(s+1,1),++s}}const r=e.mutations.map(s=>$m(t.yt,s)),i=Ne.fromMillis(e.localWriteTimeMs);return new Py(e.batchId,i,n,r)}function dl(t){const e=Ks(t.readTime),n=t.lastLimboFreeSnapshotVersion!==void 0?Ks(t.lastLimboFreeSnapshotVersion):de.min();let r;return r=function(s){return s.documents!==void 0}(t.query)?function(s){const o=s.documents.length;return ae(o===1,1966,{count:o}),Mn(Ac(UA(s.documents[0])))}(t.query):function(s){return Mn(zA(s))}(t.query),new jr(r,t.targetId,"TargetPurposeListen",t.lastListenSequenceNumber,e,n,_t.fromBase64String(t.resumeToken))}function GA(t,e){const n=Ws(e.snapshotVersion),r=Ws(e.lastLimboFreeSnapshotVersion);let i;i=Md(e.target)?$A(t.yt,e.target):Oy(t.yt,e.target).ft;const s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:qs(e.target),readTime:n,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function QA(t){const e=zA({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?Ud(e,e.limit,"L"):e}function ip(t,e){return new Ny(e.largestBatchId,$m(t.yt,e.overlayMutation))}function BE(t,e){const n=e.path.lastSegment();return[t,Wt(e.path.popLast()),n]}function $E(t,e,n,r){return{indexId:t,uid:e,sequenceNumber:n,readTime:Ws(r.readTime),documentKey:Wt(r.documentKey.path),largestBatchId:r.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Aj{getBundleMetadata(e,n){return zE(e).get(n).next(r=>{if(r)return function(s){return{id:s.bundleId,createTime:Ks(s.createTime),version:s.version}}(r)})}saveBundleMetadata(e,n){return zE(e).put(function(i){return{bundleId:i.id,createTime:Ws(tn(i.createTime)),version:i.version}}(n))}getNamedQuery(e,n){return qE(e).get(n).next(r=>{if(r)return function(s){return{name:s.name,query:QA(s.bundledQuery),readTime:Ks(s.readTime)}}(r)})}saveNamedQuery(e,n){return qE(e).put(function(i){return{name:i.name,readTime:Ws(tn(i.readTime)),bundledQuery:i.bundledQuery}}(n))}}function zE(t){return St(t,kh)}function qE(t){return St(t,Nh)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $h{constructor(e,n){this.serializer=e,this.userId=n}static wt(e,n){const r=n.uid||"";return new $h(e,r)}getOverlay(e,n){return Qa(e).get(BE(this.userId,n)).next(r=>r?ip(this.serializer,r):null)}getOverlays(e,n){const r=mr();return O.forEach(n,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,n,r){const i=[];return r.forEach((s,o)=>{const a=new Ny(n,o);i.push(this.St(e,a))}),O.waitFor(i)}removeOverlaysForBatchId(e,n,r){const i=new Set;n.forEach(o=>i.add(Wt(o.getCollectionPath())));const s=[];return i.forEach(o=>{const a=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,r+1],!1,!0);s.push(Qa(e).Z(km,a))}),O.waitFor(s)}getOverlaysForCollection(e,n,r){const i=mr(),s=Wt(n),o=IDBKeyRange.bound([this.userId,s,r],[this.userId,s,Number.POSITIVE_INFINITY],!0);return Qa(e).J(km,o).next(a=>{for(const l of a){const u=ip(this.serializer,l);i.set(u.getKey(),u)}return i})}getOverlaysForCollectionGroup(e,n,r,i){const s=mr();let o;const a=IDBKeyRange.bound([this.userId,n,r],[this.userId,n,Number.POSITIVE_INFINITY],!0);return Qa(e).ee({index:JS,range:a},(l,u,h)=>{const f=ip(this.serializer,u);s.size()<i||f.largestBatchId===o?(s.set(f.getKey(),f),o=f.largestBatchId):h.done()}).next(()=>s)}St(e,n){return Qa(e).put(function(i,s,o){const[a,l,u]=BE(s,o.mutation.key);return{userId:s,collectionPath:l,documentId:u,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:$d(i.yt,o.mutation)}}(this.serializer,this.userId,n))}}function Qa(t){return St(t,Dh)}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cj{bt(e){return St(e,Iy)}getSessionToken(e){return this.bt(e).get("sessionToken").next(n=>{const r=n==null?void 0:n.value;return r?_t.fromUint8Array(r):_t.EMPTY_BYTE_STRING})}setSessionToken(e,n){return this.bt(e).put({name:"sessionToken",value:n.toUint8Array()})}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _s{constructor(){}Dt(e,n){this.Ct(e,n),n.vt()}Ct(e,n){if("nullValue"in e)this.Ft(n,5);else if("booleanValue"in e)this.Ft(n,10),n.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(n,15),n.Mt(Je(e.integerValue));else if("doubleValue"in e){const r=Je(e.doubleValue);isNaN(r)?this.Ft(n,13):(this.Ft(n,15),nc(r)?n.Mt(0):n.Mt(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Ft(n,20),typeof r=="string"&&(r=Kr(r)),n.xt(`${r.seconds||""}`),n.Mt(r.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,n),this.Nt(n);else if("bytesValue"in e)this.Ft(n,30),n.Bt(Gr(e.bytesValue)),this.Nt(n);else if("referenceValue"in e)this.Lt(e.referenceValue,n);else if("geoPointValue"in e){const r=e.geoPointValue;this.Ft(n,45),n.Mt(r.latitude||0),n.Mt(r.longitude||0)}else"mapValue"in e?uA(e)?this.Ft(n,Number.MAX_SAFE_INTEGER):jh(e)?this.kt(e.mapValue,n):(this.qt(e.mapValue,n),this.Nt(n)):"arrayValue"in e?(this.Qt(e.arrayValue,n),this.Nt(n)):se(19022,{$t:e})}Ot(e,n){this.Ft(n,25),this.Ut(e,n)}Ut(e,n){n.xt(e)}qt(e,n){const r=e.fields||{};this.Ft(n,55);for(const i of Object.keys(r))this.Ot(i,n),this.Ct(r[i],n)}kt(e,n){var o,a;const r=e.fields||{};this.Ft(n,53);const i=ca,s=((a=(o=r[i].arrayValue)==null?void 0:o.values)==null?void 0:a.length)||0;this.Ft(n,15),n.Mt(Je(s)),this.Ot(i,n),this.Ct(r[i],n)}Qt(e,n){const r=e.values||[];this.Ft(n,50);for(const i of r)this.Ct(i,n)}Lt(e,n){this.Ft(n,37),X.fromName(e).path.forEach(r=>{this.Ft(n,60),this.Ut(r,n)})}Ft(e,n){e.Mt(n)}Nt(e){e.Mt(2)}}_s.Kt=new _s;/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law | agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES | CONDITIONS OF ANY KIND, either express | implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fo=255;function bj(t){if(t===0)return 8;let e=0;return t>>4||(e+=4,t<<=4),t>>6||(e+=2,t<<=2),t>>7||(e+=1),e}function HE(t){const e=64-function(r){let i=0;for(let s=0;s<8;++s){const o=bj(255&r[s]);if(i+=o,o!==8)break}return i}(t);return Math.ceil(e/8)}class Rj{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Wt(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.Gt(r.value),r=n.next();this.zt()}jt(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.Jt(r.value),r=n.next();this.Ht()}Yt(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.Gt(r);else if(r<2048)this.Gt(960|r>>>6),this.Gt(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Gt(480|r>>>12),this.Gt(128|63&r>>>6),this.Gt(128|63&r);else{const i=n.codePointAt(0);this.Gt(240|i>>>18),this.Gt(128|63&i>>>12),this.Gt(128|63&i>>>6),this.Gt(128|63&i)}}this.zt()}Zt(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.Jt(r);else if(r<2048)this.Jt(960|r>>>6),this.Jt(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Jt(480|r>>>12),this.Jt(128|63&r>>>6),this.Jt(128|63&r);else{const i=n.codePointAt(0);this.Jt(240|i>>>18),this.Jt(128|63&i>>>12),this.Jt(128|63&i>>>6),this.Jt(128|63&i)}}this.Ht()}Xt(e){const n=this.en(e),r=HE(n);this.tn(1+r),this.buffer[this.position++]=255&r;for(let i=n.length-r;i<n.length;++i)this.buffer[this.position++]=255&n[i]}nn(e){const n=this.en(e),r=HE(n);this.tn(1+r),this.buffer[this.position++]=~(255&r);for(let i=n.length-r;i<n.length;++i)this.buffer[this.position++]=~(255&n[i])}rn(){this.sn(fo),this.sn(255)}_n(){this.an(fo),this.an(255)}reset(){this.position=0}seed(e){this.tn(e.length),this.buffer.set(e,this.position),this.position+=e.length}un(){return this.buffer.slice(0,this.position)}en(e){const n=function(s){const o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,s,!1),new Uint8Array(o.buffer)}(e),r=!!(128&n[0]);n[0]^=r?255:128;for(let i=1;i<n.length;++i)n[i]^=r?255:0;return n}Gt(e){const n=255&e;n===0?(this.sn(0),this.sn(255)):n===fo?(this.sn(fo),this.sn(0)):this.sn(n)}Jt(e){const n=255&e;n===0?(this.an(0),this.an(255)):n===fo?(this.an(fo),this.an(0)):this.an(e)}zt(){this.sn(0),this.sn(1)}Ht(){this.an(0),this.an(1)}sn(e){this.tn(1),this.buffer[this.position++]=e}an(e){this.tn(1),this.buffer[this.position++]=~e}tn(e){const n=e+this.position;if(n<=this.buffer.length)return;let r=2*this.buffer.length;r<n&&(r=n);const i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}}class Pj{constructor(e){this.cn=e}Bt(e){this.cn.Wt(e)}xt(e){this.cn.Yt(e)}Mt(e){this.cn.Xt(e)}vt(){this.cn.rn()}}class kj{constructor(e){this.cn=e}Bt(e){this.cn.jt(e)}xt(e){this.cn.Zt(e)}Mt(e){this.cn.nn(e)}vt(){this.cn._n()}}class Ya{constructor(){this.cn=new Rj,this.ln=new Pj(this.cn),this.hn=new kj(this.cn)}seed(e){this.cn.seed(e)}Pn(e){return e===0?this.ln:this.hn}un(){return this.cn.un()}reset(){this.cn.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vs{constructor(e,n,r,i){this.Tn=e,this.In=n,this.En=r,this.dn=i}An(){const e=this.dn.length,n=e===0||this.dn[e-1]===255?e+1:e,r=new Uint8Array(n);return r.set(this.dn,0),n!==e?r.set([0],this.dn.length):++r[r.length-1],new vs(this.Tn,this.In,this.En,r)}Rn(e,n,r){return{indexId:this.Tn,uid:e,arrayValue:Xu(this.En),directionalValue:Xu(this.dn),orderedDocumentKey:Xu(n),documentKey:r.path.toArray()}}Vn(e,n,r){const i=this.Rn(e,n,r);return[i.indexId,i.uid,i.arrayValue,i.directionalValue,i.orderedDocumentKey,i.documentKey]}}function ci(t,e){let n=t.Tn-e.Tn;return n!==0?n:(n=WE(t.En,e.En),n!==0?n:(n=WE(t.dn,e.dn),n!==0?n:X.comparator(t.In,e.In)))}function WE(t,e){for(let n=0;n<t.length&&n<e.length;++n){const r=t[n]-e[n];if(r!==0)return r}return t.length-e.length}function Xu(t){return qx()?function(n){let r="";for(let i=0;i<n.length;i++)r+=String.fromCharCode(n[i]);return r}(t):t}function KE(t){return typeof t!="string"?t:function(n){const r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}(t)}class GE{constructor(e){this.mn=new Ue((n,r)=>rt.comparator(n.field,r.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.fn=e.orderBy,this.gn=[];for(const n of e.filters){const r=n;r.isInequality()?this.mn=this.mn.add(r):this.gn.push(r)}}get pn(){return this.mn.size>1}yn(e){if(ae(e.collectionGroup===this.collectionId,49279),this.pn)return!1;const n=bm(e);if(n!==void 0&&!this.wn(n))return!1;const r=ps(e);let i=new Set,s=0,o=0;for(;s<r.length&&this.wn(r[s]);++s)i=i.add(r[s].fieldPath.canonicalString());if(s===r.length)return!0;if(this.mn.size>0){const a=this.mn.getIterator().getNext();if(!i.has(a.field.canonicalString())){const l=r[s];if(!this.Sn(a,l)||!this.bn(this.fn[o++],l))return!1}++s}for(;s<r.length;++s){const a=r[s];if(o>=this.fn.length||!this.bn(this.fn[o++],a))return!1}return!0}Dn(){if(this.pn)return null;let e=new Ue(rt.comparator);const n=[];for(const r of this.gn)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")n.push(new zu(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),n.push(new zu(r.field,0))}for(const r of this.fn)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),n.push(new zu(r.field,r.dir==="asc"?0:1)));return new Dd(Dd.UNKNOWN_ID,this.collectionId,n,tc.empty())}wn(e){for(const n of this.gn)if(this.Sn(n,e))return!0;return!1}Sn(e,n){if(e===void 0||!e.field.isEqual(n.fieldPath))return!1;const r=e.op==="array-contains"||e.op==="array-contains-any";return n.kind===2===r}bn(e,n){return!!e.field.isEqual(n.fieldPath)&&(n.kind===0&&e.dir==="asc"||n.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function YA(t){var n,r;if(ae(t instanceof be||t instanceof Me,20012),t instanceof be){if(t instanceof vA){const i=((r=(n=t.value.arrayValue)==null?void 0:n.values)==null?void 0:r.map(s=>be.create(t.field,"==",s)))||[];return Me.create(i,"or")}return t}const e=t.filters.map(i=>YA(i));return Me.create(e,t.op)}function Nj(t){if(t.getFilters().length===0)return[];const e=Hm(YA(t));return ae(XA(e),7391),zm(e)||qm(e)?[e]:e.getFilters()}function zm(t){return t instanceof be}function qm(t){return t instanceof Me&&Ay(t)}function XA(t){return zm(t)||qm(t)||function(n){if(n instanceof Me&&Om(n)){for(const r of n.getFilters())if(!zm(r)&&!qm(r))return!1;return!0}return!1}(t)}function Hm(t){if(ae(t instanceof be||t instanceof Me,34018),t instanceof be)return t;if(t.filters.length===1)return Hm(t.filters[0]);const e=t.filters.map(r=>Hm(r));let n=Me.create(e,t.op);return n=qd(n),XA(n)?n:(ae(n instanceof Me,64498),ae(da(n),40251),ae(n.filters.length>1,57927),n.filters.reduce((r,i)=>jy(r,i)))}function jy(t,e){let n;return ae(t instanceof be||t instanceof Me,38388),ae(e instanceof be||e instanceof Me,25473),n=t instanceof be?e instanceof be?function(i,s){return Me.create([i,s],"and")}(t,e):QE(t,e):e instanceof be?QE(e,t):function(i,s){if(ae(i.filters.length>0&&s.filters.length>0,48005),da(i)&&da(s))return gA(i,s.getFilters());const o=Om(i)?i:s,a=Om(i)?s:i,l=o.filters.map(u=>jy(u,a));return Me.create(l,"or")}(t,e),qd(n)}function QE(t,e){if(da(e))return gA(e,t.getFilters());{const n=e.filters.map(r=>jy(t,r));return Me.create(n,"or")}}function qd(t){if(ae(t instanceof be||t instanceof Me,11850),t instanceof be)return t;const e=t.getFilters();if(e.length===1)return qd(e[0]);if(pA(t))return t;const n=e.map(i=>qd(i)),r=[];return n.forEach(i=>{i instanceof be?r.push(i):i instanceof Me&&(i.op===t.op?r.push(...i.filters):r.push(i))}),r.length===1?r[0]:Me.create(r,t.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dj{constructor(){this.Cn=new Ly}addToCollectionParentIndex(e,n){return this.Cn.add(n),O.resolve()}getCollectionParents(e,n){return O.resolve(this.Cn.getEntries(n))}addFieldIndex(e,n){return O.resolve()}deleteFieldIndex(e,n){return O.resolve()}deleteAllFieldIndexes(e){return O.resolve()}createTargetIndexes(e,n){return O.resolve()}getDocumentsMatchingTarget(e,n){return O.resolve(null)}getIndexType(e,n){return O.resolve(0)}getFieldIndexes(e,n){return O.resolve([])}getNextCollectionGroupToUpdate(e){return O.resolve(null)}getMinOffset(e,n){return O.resolve(Cn.min())}getMinOffsetFromCollectionGroup(e,n){return O.resolve(Cn.min())}updateCollectionGroup(e,n,r){return O.resolve()}updateIndexEntries(e,n){return O.resolve()}}class Ly{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),i=this.index[n]||new Ue(Oe.comparator),s=!i.has(r);return this.index[n]=i.add(r),s}has(e){const n=e.lastSegment(),r=e.popLast(),i=this.index[n];return i&&i.has(r)}getEntries(e){return(this.index[e]||new Ue(Oe.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YE="IndexedDbIndexManager",gu=new Uint8Array(0);class Vj{constructor(e,n){this.databaseId=n,this.vn=new Ly,this.Fn=new Yr(r=>qs(r),(r,i)=>Sc(r,i)),this.uid=e.uid||""}addToCollectionParentIndex(e,n){if(!this.vn.has(n)){const r=n.lastSegment(),i=n.popLast();e.addOnCommittedListener(()=>{this.vn.add(n)});const s={collectionId:r,parent:Wt(i)};return XE(e).put(s)}return O.resolve()}getCollectionParents(e,n){const r=[],i=IDBKeyRange.bound([n,""],[US(n),""],!1,!0);return XE(e).J(i).next(s=>{for(const o of s){if(o.collectionId!==n)break;r.push(pr(o.parent))}return r})}addFieldIndex(e,n){const r=Xa(e),i=function(a){return{indexId:a.indexId,collectionGroup:a.collectionGroup,fields:a.fields.map(l=>[l.fieldPath.canonicalString(),l.kind])}}(n);delete i.indexId;const s=r.add(i);if(n.indexState){const o=mo(e);return s.next(a=>{o.put($E(a,this.uid,n.indexState.sequenceNumber,n.indexState.offset))})}return s.next()}deleteFieldIndex(e,n){const r=Xa(e),i=mo(e),s=po(e);return r.delete(n.indexId).next(()=>i.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0))).next(()=>s.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){const n=Xa(e),r=po(e),i=mo(e);return n.Z().next(()=>r.Z()).next(()=>i.Z())}createTargetIndexes(e,n){return O.forEach(this.Mn(n),r=>this.getIndexType(e,r).next(i=>{if(i===0||i===1){const s=new GE(r).Dn();if(s!=null)return this.addFieldIndex(e,s)}}))}getDocumentsMatchingTarget(e,n){const r=po(e);let i=!0;const s=new Map;return O.forEach(this.Mn(n),o=>this.xn(e,o).next(a=>{i&&(i=!!a),s.set(o,a)})).next(()=>{if(i){let o=Te();const a=[];return O.forEach(s,(l,u)=>{W(YE,`Using index ${function(y){return`id=${y.indexId}|cg=${y.collectionGroup}|f=${y.fields.map(V=>`${V.fieldPath}:${V.kind}`).join(",")}`}(l)} to execute ${qs(n)}`);const h=function(y,V){const U=bm(V);if(U===void 0)return null;for(const $ of Fd(y,U.fieldPath))switch($.op){case"array-contains-any":return $.value.arrayValue.values||[];case"array-contains":return[$.value]}return null}(u,l),f=function(y,V){const U=new Map;for(const $ of ps(V))for(const S of Fd(y,$.fieldPath))switch(S.op){case"==":case"in":U.set($.fieldPath.canonicalString(),S.value);break;case"not-in":case"!=":return U.set($.fieldPath.canonicalString(),S.value),Array.from(U.values())}return null}(u,l),m=function(y,V){const U=[];let $=!0;for(const S of ps(V)){const I=S.kind===0?bE(y,S.fieldPath,y.startAt):RE(y,S.fieldPath,y.startAt);U.push(I.value),$&&($=I.inclusive)}return new Wi(U,$)}(u,l),E=function(y,V){const U=[];let $=!0;for(const S of ps(V)){const I=S.kind===0?RE(y,S.fieldPath,y.endAt):bE(y,S.fieldPath,y.endAt);U.push(I.value),$&&($=I.inclusive)}return new Wi(U,$)}(u,l),_=this.On(l,u,m),A=this.On(l,u,E),P=this.Nn(l,u,f),v=this.Bn(l.indexId,h,_,m.inclusive,A,E.inclusive,P);return O.forEach(v,w=>r.Y(w,n.limit).next(y=>{y.forEach(V=>{const U=X.fromSegments(V.documentKey);o.has(U)||(o=o.add(U),a.push(U))})}))}).next(()=>a)}return O.resolve(null)})}Mn(e){let n=this.Fn.get(e);return n||(e.filters.length===0?n=[e]:n=Nj(Me.create(e.filters,"and")).map(r=>Lm(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.Fn.set(e,n),n)}Bn(e,n,r,i,s,o,a){const l=(n!=null?n.length:1)*Math.max(r.length,s.length),u=l/(n!=null?n.length:1),h=[];for(let f=0;f<l;++f){const m=n?this.Ln(n[f/u]):gu,E=this.kn(e,m,r[f%u],i),_=this.qn(e,m,s[f%u],o),A=a.map(P=>this.kn(e,m,P,!0));h.push(...this.createRange(E,_,A))}return h}kn(e,n,r,i){const s=new vs(e,X.empty(),n,r);return i?s:s.An()}qn(e,n,r,i){const s=new vs(e,X.empty(),n,r);return i?s.An():s}xn(e,n){const r=new GE(n),i=n.collectionGroup!=null?n.collectionGroup:n.path.lastSegment();return this.getFieldIndexes(e,i).next(s=>{let o=null;for(const a of s)r.yn(a)&&(!o||a.fields.length>o.fields.length)&&(o=a);return o})}getIndexType(e,n){let r=2;const i=this.Mn(n);return O.forEach(i,s=>this.xn(e,s).next(o=>{o?r!==0&&o.fields.length<function(l){let u=new Ue(rt.comparator),h=!1;for(const f of l.filters)for(const m of f.getFlattenedFilters())m.field.isKeyField()||(m.op==="array-contains"||m.op==="array-contains-any"?h=!0:u=u.add(m.field));for(const f of l.orderBy)f.field.isKeyField()||(u=u.add(f.field));return u.size+(h?1:0)}(s)&&(r=1):r=0})).next(()=>function(o){return o.limit!==null}(n)&&i.length>1&&r===2?1:r)}Qn(e,n){const r=new Ya;for(const i of ps(e)){const s=n.data.field(i.fieldPath);if(s==null)return null;const o=r.Pn(i.kind);_s.Kt.Dt(s,o)}return r.un()}Ln(e){const n=new Ya;return _s.Kt.Dt(e,n.Pn(0)),n.un()}$n(e,n){const r=new Ya;return _s.Kt.Dt(zs(this.databaseId,n),r.Pn(function(s){const o=ps(s);return o.length===0?0:o[o.length-1].kind}(e))),r.un()}Nn(e,n,r){if(r===null)return[];let i=[];i.push(new Ya);let s=0;for(const o of ps(e)){const a=r[s++];for(const l of i)if(this.Un(n,o.fieldPath)&&lc(a))i=this.Kn(i,o,a);else{const u=l.Pn(o.kind);_s.Kt.Dt(a,u)}}return this.Wn(i)}On(e,n,r){return this.Nn(e,n,r.position)}Wn(e){const n=[];for(let r=0;r<e.length;++r)n[r]=e[r].un();return n}Kn(e,n,r){const i=[...e],s=[];for(const o of r.arrayValue.values||[])for(const a of i){const l=new Ya;l.seed(a.un()),_s.Kt.Dt(o,l.Pn(n.kind)),s.push(l)}return s}Un(e,n){return!!e.filters.find(r=>r instanceof be&&r.field.isEqual(n)&&(r.op==="in"||r.op==="not-in"))}getFieldIndexes(e,n){const r=Xa(e),i=mo(e);return(n?r.J(Pm,IDBKeyRange.bound(n,n)):r.J()).next(s=>{const o=[];return O.forEach(s,a=>i.get([a.indexId,this.uid]).next(l=>{o.push(function(h,f){const m=f?new tc(f.sequenceNumber,new Cn(Ks(f.readTime),new X(pr(f.documentKey)),f.largestBatchId)):tc.empty(),E=h.fields.map(([_,A])=>new zu(rt.fromServerFormat(_),A));return new Dd(h.indexId,h.collectionGroup,E,m)}(a,l))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(n=>n.length===0?null:(n.sort((r,i)=>{const s=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return s!==0?s:we(r.collectionGroup,i.collectionGroup)}),n[0].collectionGroup))}updateCollectionGroup(e,n,r){const i=Xa(e),s=mo(e);return this.Gn(e).next(o=>i.J(Pm,IDBKeyRange.bound(n,n)).next(a=>O.forEach(a,l=>s.put($E(l.indexId,this.uid,o,r)))))}updateIndexEntries(e,n){const r=new Map;return O.forEach(n,(i,s)=>{const o=r.get(i.collectionGroup);return(o?O.resolve(o):this.getFieldIndexes(e,i.collectionGroup)).next(a=>(r.set(i.collectionGroup,a),O.forEach(a,l=>this.zn(e,i,l).next(u=>{const h=this.jn(s,l);return u.isEqual(h)?O.resolve():this.Jn(e,s,l,u,h)}))))})}Hn(e,n,r,i){return po(e).put(i.Rn(this.uid,this.$n(r,n.key),n.key))}Yn(e,n,r,i){return po(e).delete(i.Vn(this.uid,this.$n(r,n.key),n.key))}zn(e,n,r){const i=po(e);let s=new Ue(ci);return i.ee({index:XS,range:IDBKeyRange.only([r.indexId,this.uid,Xu(this.$n(r,n))])},(o,a)=>{s=s.add(new vs(r.indexId,n,KE(a.arrayValue),KE(a.directionalValue)))}).next(()=>s)}jn(e,n){let r=new Ue(ci);const i=this.Qn(n,e);if(i==null)return r;const s=bm(n);if(s!=null){const o=e.data.field(s.fieldPath);if(lc(o))for(const a of o.arrayValue.values||[])r=r.add(new vs(n.indexId,e.key,this.Ln(a),i))}else r=r.add(new vs(n.indexId,e.key,gu,i));return r}Jn(e,n,r,i,s){W(YE,"Updating index entries for document '%s'",n.key);const o=[];return function(l,u,h,f,m){const E=l.getIterator(),_=u.getIterator();let A=ho(E),P=ho(_);for(;A||P;){let v=!1,w=!1;if(A&&P){const y=h(A,P);y<0?w=!0:y>0&&(v=!0)}else A!=null?w=!0:v=!0;v?(f(P),P=ho(_)):w?(m(A),A=ho(E)):(A=ho(E),P=ho(_))}}(i,s,ci,a=>{o.push(this.Hn(e,n,r,a))},a=>{o.push(this.Yn(e,n,r,a))}),O.waitFor(o)}Gn(e){let n=1;return mo(e).ee({index:YS,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,i,s)=>{s.done(),n=i.sequenceNumber+1}).next(()=>n)}createRange(e,n,r){r=r.sort((o,a)=>ci(o,a)).filter((o,a,l)=>!a||ci(o,l[a-1])!==0);const i=[];i.push(e);for(const o of r){const a=ci(o,e),l=ci(o,n);if(a===0)i[0]=e.An();else if(a>0&&l<0)i.push(o),i.push(o.An());else if(l>0)break}i.push(n);const s=[];for(let o=0;o<i.length;o+=2){if(this.Zn(i[o],i[o+1]))return[];const a=i[o].Vn(this.uid,gu,X.empty()),l=i[o+1].Vn(this.uid,gu,X.empty());s.push(IDBKeyRange.bound(a,l))}return s}Zn(e,n){return ci(e,n)>0}getMinOffsetFromCollectionGroup(e,n){return this.getFieldIndexes(e,n).next(JE)}getMinOffset(e,n){return O.mapArray(this.Mn(n),r=>this.xn(e,r).next(i=>i||se(44426))).next(JE)}}function XE(t){return St(t,sc)}function po(t){return St(t,bl)}function Xa(t){return St(t,Ey)}function mo(t){return St(t,Cl)}function JE(t){ae(t.length!==0,28825);let e=t[0].indexState.offset,n=e.largestBatchId;for(let r=1;r<t.length;r++){const i=t[r].indexState.offset;_y(i,e)<0&&(e=i),n<i.largestBatchId&&(n=i.largestBatchId)}return new Cn(e.readTime,e.documentKey,n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZE={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},JA=41943040;class Bt{static withCacheSize(e){return new Bt(e,Bt.DEFAULT_COLLECTION_PERCENTILE,Bt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZA(t,e,n){const r=t.store(Kn),i=t.store(sa),s=[],o=IDBKeyRange.only(n.batchId);let a=0;const l=r.ee({range:o},(h,f,m)=>(a++,m.delete()));s.push(l.next(()=>{ae(a===1,47070,{batchId:n.batchId})}));const u=[];for(const h of n.mutations){const f=KS(e,h.key.path,n.batchId);s.push(i.delete(f)),u.push(h.key)}return O.waitFor(s).next(()=>u)}function Hd(t){if(!t)return 0;let e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw se(14731);e=t.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Bt.DEFAULT_COLLECTION_PERCENTILE=10,Bt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Bt.DEFAULT=new Bt(JA,Bt.DEFAULT_COLLECTION_PERCENTILE,Bt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Bt.DISABLED=new Bt(-1,0,0);class zh{constructor(e,n,r,i){this.userId=e,this.serializer=n,this.indexManager=r,this.referenceDelegate=i,this.Xn={}}static wt(e,n,r,i){ae(e.uid!=="",64387);const s=e.isAuthenticated()?e.uid:"";return new zh(s,n,r,i)}checkEmpty(e){let n=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return ui(e).ee({index:xs,range:r},(i,s,o)=>{n=!1,o.done()}).next(()=>n)}addMutationBatch(e,n,r,i){const s=To(e),o=ui(e);return o.add({}).next(a=>{ae(typeof a=="number",49019);const l=new Py(a,n,r,i),u=function(E,_,A){const P=A.baseMutations.map(w=>$d(E.yt,w)),v=A.mutations.map(w=>$d(E.yt,w));return{userId:_,batchId:A.batchId,localWriteTimeMs:A.localWriteTime.toMillis(),baseMutations:P,mutations:v}}(this.serializer,this.userId,l),h=[];let f=new Ue((m,E)=>we(m.canonicalString(),E.canonicalString()));for(const m of i){const E=KS(this.userId,m.key.path,a);f=f.add(m.key.path.popLast()),h.push(o.put(u)),h.push(s.put(E,oO))}return f.forEach(m=>{h.push(this.indexManager.addToCollectionParentIndex(e,m))}),e.addOnCommittedListener(()=>{this.Xn[a]=l.keys()}),O.waitFor(h).next(()=>l)})}lookupMutationBatch(e,n){return ui(e).get(n).next(r=>r?(ae(r.userId===this.userId,48,"Unexpected user for mutation batch",{userId:r.userId,batchId:n}),ys(this.serializer,r)):null)}er(e,n){return this.Xn[n]?O.resolve(this.Xn[n]):this.lookupMutationBatch(e,n).next(r=>{if(r){const i=r.keys();return this.Xn[n]=i,i}return null})}getNextMutationBatchAfterBatchId(e,n){const r=n+1,i=IDBKeyRange.lowerBound([this.userId,r]);let s=null;return ui(e).ee({index:xs,range:i},(o,a,l)=>{a.userId===this.userId&&(ae(a.batchId>=r,47524,{tr:r}),s=ys(this.serializer,a)),l.done()}).next(()=>s)}getHighestUnacknowledgedBatchId(e){const n=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=bs;return ui(e).ee({index:xs,range:n,reverse:!0},(i,s,o)=>{r=s.batchId,o.done()}).next(()=>r)}getAllMutationBatches(e){const n=IDBKeyRange.bound([this.userId,bs],[this.userId,Number.POSITIVE_INFINITY]);return ui(e).J(xs,n).next(r=>r.map(i=>ys(this.serializer,i)))}getAllMutationBatchesAffectingDocumentKey(e,n){const r=qu(this.userId,n.path),i=IDBKeyRange.lowerBound(r),s=[];return To(e).ee({range:i},(o,a,l)=>{const[u,h,f]=o,m=pr(h);if(u===this.userId&&n.path.isEqual(m))return ui(e).get(f).next(E=>{if(!E)throw se(61480,{nr:o,batchId:f});ae(E.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:E.userId,batchId:f}),s.push(ys(this.serializer,E))});l.done()}).next(()=>s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Ue(we);const i=[];return n.forEach(s=>{const o=qu(this.userId,s.path),a=IDBKeyRange.lowerBound(o),l=To(e).ee({range:a},(u,h,f)=>{const[m,E,_]=u,A=pr(E);m===this.userId&&s.path.isEqual(A)?r=r.add(_):f.done()});i.push(l)}),O.waitFor(i).next(()=>this.rr(e,r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,i=r.length+1,s=qu(this.userId,r),o=IDBKeyRange.lowerBound(s);let a=new Ue(we);return To(e).ee({range:o},(l,u,h)=>{const[f,m,E]=l,_=pr(m);f===this.userId&&r.isPrefixOf(_)?_.length===i&&(a=a.add(E)):h.done()}).next(()=>this.rr(e,a))}rr(e,n){const r=[],i=[];return n.forEach(s=>{i.push(ui(e).get(s).next(o=>{if(o===null)throw se(35274,{batchId:s});ae(o.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:o.userId,batchId:s}),r.push(ys(this.serializer,o))}))}),O.waitFor(i).next(()=>r)}removeMutationBatch(e,n){return ZA(e.le,this.userId,n).next(r=>(e.addOnCommittedListener(()=>{this.ir(n.batchId)}),O.forEach(r,i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))}ir(e){delete this.Xn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(n=>{if(!n)return O.resolve();const r=IDBKeyRange.lowerBound(function(o){return[o]}(this.userId)),i=[];return To(e).ee({range:r},(s,o,a)=>{if(s[0]===this.userId){const l=pr(s[1]);i.push(l)}else a.done()}).next(()=>{ae(i.length===0,56720,{sr:i.map(s=>s.canonicalString())})})})}containsKey(e,n){return eC(e,this.userId,n)}_r(e){return tC(e).get(this.userId).next(n=>n||{userId:this.userId,lastAcknowledgedBatchId:bs,lastStreamToken:""})}}function eC(t,e,n){const r=qu(e,n.path),i=r[1],s=IDBKeyRange.lowerBound(r);let o=!1;return To(t).ee({range:s,X:!0},(a,l,u)=>{const[h,f,m]=a;h===e&&f===i&&(o=!0),u.done()}).next(()=>o)}function ui(t){return St(t,Kn)}function To(t){return St(t,sa)}function tC(t){return St(t,rc)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gs{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new Gs(0)}static cr(){return new Gs(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oj{constructor(e,n){this.referenceDelegate=e,this.serializer=n}allocateTargetId(e){return this.lr(e).next(n=>{const r=new Gs(n.highestTargetId);return n.highestTargetId=r.next(),this.hr(e,n).next(()=>n.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.lr(e).next(n=>de.fromTimestamp(new Ne(n.lastRemoteSnapshotVersion.seconds,n.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.lr(e).next(n=>n.highestListenSequenceNumber)}setTargetsMetadata(e,n,r){return this.lr(e).next(i=>(i.highestListenSequenceNumber=n,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),n>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=n),this.hr(e,i)))}addTargetData(e,n){return this.Pr(e,n).next(()=>this.lr(e).next(r=>(r.targetCount+=1,this.Tr(n,r),this.hr(e,r))))}updateTargetData(e,n){return this.Pr(e,n)}removeTargetData(e,n){return this.removeMatchingKeysForTargetId(e,n.targetId).next(()=>go(e).delete(n.targetId)).next(()=>this.lr(e)).next(r=>(ae(r.targetCount>0,8065),r.targetCount-=1,this.hr(e,r)))}removeTargets(e,n,r){let i=0;const s=[];return go(e).ee((o,a)=>{const l=dl(a);l.sequenceNumber<=n&&r.get(l.targetId)===null&&(i++,s.push(this.removeTargetData(e,l)))}).next(()=>O.waitFor(s)).next(()=>i)}forEachTarget(e,n){return go(e).ee((r,i)=>{const s=dl(i);n(s)})}lr(e){return eI(e).get(jd).next(n=>(ae(n!==null,2888),n))}hr(e,n){return eI(e).put(jd,n)}Pr(e,n){return go(e).put(GA(this.serializer,n))}Tr(e,n){let r=!1;return e.targetId>n.highestTargetId&&(n.highestTargetId=e.targetId,r=!0),e.sequenceNumber>n.highestListenSequenceNumber&&(n.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.lr(e).next(n=>n.targetCount)}getTargetData(e,n){const r=qs(n),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let s=null;return go(e).ee({range:i,index:QS},(o,a,l)=>{const u=dl(a);Sc(n,u.target)&&(s=u,l.done())}).next(()=>s)}addMatchingKeys(e,n,r){const i=[],s=Ii(e);return n.forEach(o=>{const a=Wt(o.path);i.push(s.put({targetId:r,path:a})),i.push(this.referenceDelegate.addReference(e,r,o))}),O.waitFor(i)}removeMatchingKeys(e,n,r){const i=Ii(e);return O.forEach(n,s=>{const o=Wt(s.path);return O.waitFor([i.delete([r,o]),this.referenceDelegate.removeReference(e,r,s)])})}removeMatchingKeysForTargetId(e,n){const r=Ii(e),i=IDBKeyRange.bound([n],[n+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,n){const r=IDBKeyRange.bound([n],[n+1],!1,!0),i=Ii(e);let s=Te();return i.ee({range:r,X:!0},(o,a,l)=>{const u=pr(o[1]),h=new X(u);s=s.add(h)}).next(()=>s)}containsKey(e,n){const r=Wt(n.path),i=IDBKeyRange.bound([r],[US(r)],!1,!0);let s=0;return Ii(e).ee({index:wy,X:!0,range:i},([o,a],l,u)=>{o!==0&&(s++,u.done())}).next(()=>s>0)}At(e,n){return go(e).get(n).next(r=>r?dl(r):null)}}function go(t){return St(t,oa)}function eI(t){return St(t,Rs)}function Ii(t){return St(t,aa)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tI="LruGarbageCollector",jj=1048576;function nI([t,e],[n,r]){const i=we(t,n);return i===0?we(e,r):i}class Lj{constructor(e){this.Ir=e,this.buffer=new Ue(nI),this.Er=0}dr(){return++this.Er}Ar(e){const n=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(n);else{const r=this.buffer.last();nI(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}}class nC{constructor(e,n,r){this.garbageCollector=e,this.asyncQueue=n,this.localStore=r,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){W(tI,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){ns(n)?W(tI,"Ignoring IndexedDB error during garbage collection: ",n):await io(n)}await this.Vr(3e5)})}}class Mj{constructor(e,n){this.mr=e,this.params=n}calculateTargetCount(e,n){return this.mr.gr(e).next(r=>Math.floor(n/100*r))}nthSequenceNumber(e,n){if(n===0)return O.resolve(jn.ce);const r=new Lj(n);return this.mr.forEachTarget(e,i=>r.Ar(i.sequenceNumber)).next(()=>this.mr.pr(e,i=>r.Ar(i))).next(()=>r.maxValue)}removeTargets(e,n,r){return this.mr.removeTargets(e,n,r)}removeOrphanedDocuments(e,n){return this.mr.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(W("LruGarbageCollector","Garbage collection skipped; disabled"),O.resolve(ZE)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(W("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),ZE):this.yr(e,n))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,n){let r,i,s,o,a,l,u;const h=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(f=>(f>this.params.maximumSequenceNumbersToCollect?(W("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${f}`),i=this.params.maximumSequenceNumbersToCollect):i=f,o=Date.now(),this.nthSequenceNumber(e,i))).next(f=>(r=f,a=Date.now(),this.removeTargets(e,r,n))).next(f=>(s=f,l=Date.now(),this.removeOrphanedDocuments(e,r))).next(f=>(u=Date.now(),wo()<=Ce.DEBUG&&W("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-h}ms
	Determined least recently used ${i} in `+(a-o)+`ms
	Removed ${s} targets in `+(l-a)+`ms
	Removed ${f} documents in `+(u-l)+`ms
Total Duration: ${u-h}ms`),O.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:f})))}}function rC(t,e){return new Mj(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fj{constructor(e,n){this.db=e,this.garbageCollector=rC(this,n)}gr(e){const n=this.wr(e);return this.db.getTargetCache().getTargetCount(e).next(r=>n.next(i=>r+i))}wr(e){let n=0;return this.pr(e,r=>{n++}).next(()=>n)}forEachTarget(e,n){return this.db.getTargetCache().forEachTarget(e,n)}pr(e,n){return this.Sr(e,(r,i)=>n(i))}addReference(e,n,r){return yu(e,r)}removeReference(e,n,r){return yu(e,r)}removeTargets(e,n,r){return this.db.getTargetCache().removeTargets(e,n,r)}markPotentiallyOrphaned(e,n){return yu(e,n)}br(e,n){return function(i,s){let o=!1;return tC(i).te(a=>eC(i,a,s).next(l=>(l&&(o=!0),O.resolve(!l)))).next(()=>o)}(e,n)}removeOrphanedDocuments(e,n){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[];let s=0;return this.Sr(e,(o,a)=>{if(a<=n){const l=this.br(e,o).next(u=>{if(!u)return s++,r.getEntry(e,o).next(()=>(r.removeEntry(o,de.min()),Ii(e).delete(function(f){return[0,Wt(f.path)]}(o))))});i.push(l)}}).next(()=>O.waitFor(i)).next(()=>r.apply(e)).next(()=>s)}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,n){return yu(e,n)}Sr(e,n){const r=Ii(e);let i,s=jn.ce;return r.ee({index:wy},([o,a],{path:l,sequenceNumber:u})=>{o===0?(s!==jn.ce&&n(new X(pr(i)),s),s=u,i=l):s=jn.ce}).next(()=>{s!==jn.ce&&n(new X(pr(i)),s)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function yu(t,e){return Ii(t).put(function(r,i){return{targetId:0,path:Wt(r.path),sequenceNumber:i}}(e,t.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iC{constructor(){this.changes=new Yr(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,lt.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?O.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uj{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,n,r){return cs(e).put(r)}removeEntry(e,n,r){return cs(e).delete(function(s,o){const a=s.path.toArray();return[a.slice(0,a.length-2),a[a.length-2],zd(o),a[a.length-1]]}(n,r))}updateMetadata(e,n){return this.getMetadata(e).next(r=>(r.byteSize+=n,this.Dr(e,r)))}getEntry(e,n){let r=lt.newInvalidDocument(n);return cs(e).ee({index:Hu,range:IDBKeyRange.only(Ja(n))},(i,s)=>{r=this.Cr(n,s)}).next(()=>r)}vr(e,n){let r={size:0,document:lt.newInvalidDocument(n)};return cs(e).ee({index:Hu,range:IDBKeyRange.only(Ja(n))},(i,s)=>{r={document:this.Cr(n,s),size:Hd(s)}}).next(()=>r)}getEntries(e,n){let r=Tn();return this.Fr(e,n,(i,s)=>{const o=this.Cr(i,s);r=r.insert(i,o)}).next(()=>r)}Mr(e,n){let r=Tn(),i=new tt(X.comparator);return this.Fr(e,n,(s,o)=>{const a=this.Cr(s,o);r=r.insert(s,a),i=i.insert(s,Hd(o))}).next(()=>({documents:r,Or:i}))}Fr(e,n,r){if(n.isEmpty())return O.resolve();let i=new Ue(sI);n.forEach(l=>i=i.add(l));const s=IDBKeyRange.bound(Ja(i.first()),Ja(i.last())),o=i.getIterator();let a=o.getNext();return cs(e).ee({index:Hu,range:s},(l,u,h)=>{const f=X.fromSegments([...u.prefixPath,u.collectionGroup,u.documentId]);for(;a&&sI(a,f)<0;)r(a,null),a=o.getNext();a&&a.isEqual(f)&&(r(a,u),a=o.hasNext()?o.getNext():null),a?h.j(Ja(a)):h.done()}).next(()=>{for(;a;)r(a,null),a=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,n,r,i,s){const o=n.path,a=[o.popLast().toArray(),o.lastSegment(),zd(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],l=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return cs(e).J(IDBKeyRange.bound(a,l,!0)).next(u=>{s==null||s.incrementDocumentReadCount(u.length);let h=Tn();for(const f of u){const m=this.Cr(X.fromSegments(f.prefixPath.concat(f.collectionGroup,f.documentId)),f);m.isFoundDocument()&&(Cc(n,m)||i.has(m.key))&&(h=h.insert(m.key,m))}return h})}getAllFromCollectionGroup(e,n,r,i){let s=Tn();const o=iI(n,r),a=iI(n,Cn.max());return cs(e).ee({index:GS,range:IDBKeyRange.bound(o,a,!0)},(l,u,h)=>{const f=this.Cr(X.fromSegments(u.prefixPath.concat(u.collectionGroup,u.documentId)),u);s=s.insert(f.key,f),s.size===i&&h.done()}).next(()=>s)}newChangeBuffer(e){return new Bj(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(n=>n.byteSize)}getMetadata(e){return rI(e).get(Rm).next(n=>(ae(!!n,20021),n))}Dr(e,n){return rI(e).put(Rm,n)}Cr(e,n){if(n){const r=Sj(this.serializer,n);if(!(r.isNoDocument()&&r.version.isEqual(de.min())))return r}return lt.newInvalidDocument(e)}}function sC(t){return new Uj(t)}class Bj extends iC{constructor(e,n){super(),this.Nr=e,this.trackRemovals=n,this.Br=new Yr(r=>r.toString(),(r,i)=>r.isEqual(i))}applyChanges(e){const n=[];let r=0,i=new Ue((s,o)=>we(s.canonicalString(),o.canonicalString()));return this.changes.forEach((s,o)=>{const a=this.Br.get(s);if(n.push(this.Nr.removeEntry(e,s,a.readTime)),o.isValidDocument()){const l=UE(this.Nr.serializer,o);i=i.add(s.path.popLast());const u=Hd(l);r+=u-a.size,n.push(this.Nr.addEntry(e,s,l))}else if(r-=a.size,this.trackRemovals){const l=UE(this.Nr.serializer,o.convertToNoDocument(de.min()));n.push(this.Nr.addEntry(e,s,l))}}),i.forEach(s=>{n.push(this.Nr.indexManager.addToCollectionParentIndex(e,s))}),n.push(this.Nr.updateMetadata(e,r)),O.waitFor(n)}getFromCache(e,n){return this.Nr.vr(e,n).next(r=>(this.Br.set(n,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,n){return this.Nr.Mr(e,n).next(({documents:r,Or:i})=>(i.forEach((s,o)=>{this.Br.set(s,{size:o,readTime:r.get(s).readTime})}),r))}}function rI(t){return St(t,ic)}function cs(t){return St(t,Od)}function Ja(t){const e=t.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function iI(t,e){const n=e.documentKey.path.toArray();return[t,zd(e.readTime),n.slice(0,n.length-2),n.length>0?n[n.length-1]:""]}function sI(t,e){const n=t.path.toArray(),r=e.path.toArray();let i=0;for(let s=0;s<n.length-2&&s<r.length-2;++s)if(i=we(n[s],r[s]),i)return i;return i=we(n.length,r.length),i||(i=we(n[n.length-2],r[r.length-2]),i||we(n[n.length-1],r[r.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $j{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oC{constructor(e,n,r,i){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,n))).next(i=>(r!==null&&kl(r.mutation,i,un.empty(),Ne.now()),i))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,Te()).next(()=>r))}getLocalViewOfDocuments(e,n,r=Te()){const i=mr();return this.populateOverlays(e,i,n).next(()=>this.computeViews(e,n,i,r).next(s=>{let o=cl();return s.forEach((a,l)=>{o=o.insert(a,l.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){const r=mr();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,Te()))}populateOverlays(e,n,r){const i=[];return r.forEach(s=>{n.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((o,a)=>{n.set(o,a)})})}computeViews(e,n,r,i){let s=Tn();const o=Pl(),a=function(){return Pl()}();return n.forEach((l,u)=>{const h=r.get(u.key);i.has(u.key)&&(h===void 0||h.mutation instanceof Xr)?s=s.insert(u.key,u):h!==void 0?(o.set(u.key,h.mutation.getFieldMask()),kl(h.mutation,u,h.mutation.getFieldMask(),Ne.now())):o.set(u.key,un.empty())}),this.recalculateAndSaveOverlays(e,s).next(l=>(l.forEach((u,h)=>o.set(u,h)),n.forEach((u,h)=>a.set(u,new $j(h,o.get(u)??null))),a))}recalculateAndSaveOverlays(e,n){const r=Pl();let i=new tt((o,a)=>o-a),s=Te();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(const a of o)a.keys().forEach(l=>{const u=n.get(l);if(u===null)return;let h=r.get(l)||un.empty();h=a.applyToLocalView(u,h),r.set(l,h);const f=(i.get(a.batchId)||Te()).add(l);i=i.insert(a.batchId,f)})}).next(()=>{const o=[],a=i.getReverseIterator();for(;a.hasNext();){const l=a.getNext(),u=l.key,h=l.value,f=SA();h.forEach(m=>{if(!s.has(m)){const E=kA(n.get(m),r.get(m));E!==null&&f.set(m,E),s=s.add(m)}}),o.push(this.documentOverlayCache.saveOverlays(e,u,f))}return O.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,i){return function(o){return X.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):Cy(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,i):this.getDocumentsMatchingCollectionQuery(e,n,r,i)}getNextDocuments(e,n,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,i).next(s=>{const o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,i-s.size):O.resolve(mr());let a=ec,l=s;return o.next(u=>O.forEach(u,(h,f)=>(a<f.largestBatchId&&(a=f.largestBatchId),s.get(h)?O.resolve():this.remoteDocumentCache.getEntry(e,h).next(m=>{l=l.insert(h,m)}))).next(()=>this.populateOverlays(e,u,s)).next(()=>this.computeViews(e,l,u,Te())).next(h=>({batchId:a,changes:xA(h)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new X(n)).next(r=>{let i=cl();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,n,r,i){const s=n.collectionGroup;let o=cl();return this.indexManager.getCollectionParents(e,s).next(a=>O.forEach(a,l=>{const u=function(f,m){return new is(m,null,f.explicitOrderBy.slice(),f.filters.slice(),f.limit,f.limitType,f.startAt,f.endAt)}(n,l.child(s));return this.getDocumentsMatchingCollectionQuery(e,u,r,i).next(h=>{h.forEach((f,m)=>{o=o.insert(f,m)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,n,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,s,i))).next(o=>{s.forEach((l,u)=>{const h=u.getKey();o.get(h)===null&&(o=o.insert(h,lt.newInvalidDocument(h)))});let a=cl();return o.forEach((l,u)=>{const h=s.get(l);h!==void 0&&kl(h.mutation,u,un.empty(),Ne.now()),Cc(n,u)&&(a=a.insert(l,u))}),a})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zj{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,n){return O.resolve(this.Lr.get(n))}saveBundleMetadata(e,n){return this.Lr.set(n.id,function(i){return{id:i.id,version:i.version,createTime:tn(i.createTime)}}(n)),O.resolve()}getNamedQuery(e,n){return O.resolve(this.kr.get(n))}saveNamedQuery(e,n){return this.kr.set(n.name,function(i){return{name:i.name,query:QA(i.bundledQuery),readTime:tn(i.readTime)}}(n)),O.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qj{constructor(){this.overlays=new tt(X.comparator),this.qr=new Map}getOverlay(e,n){return O.resolve(this.overlays.get(n))}getOverlays(e,n){const r=mr();return O.forEach(n,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((i,s)=>{this.St(e,n,s)}),O.resolve()}removeOverlaysForBatchId(e,n,r){const i=this.qr.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.qr.delete(r)),O.resolve()}getOverlaysForCollection(e,n,r){const i=mr(),s=n.length+1,o=new X(n.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const l=a.getNext().value,u=l.getKey();if(!n.isPrefixOf(u.path))break;u.path.length===s&&l.largestBatchId>r&&i.set(l.getKey(),l)}return O.resolve(i)}getOverlaysForCollectionGroup(e,n,r,i){let s=new tt((u,h)=>u-h);const o=this.overlays.getIterator();for(;o.hasNext();){const u=o.getNext().value;if(u.getKey().getCollectionGroup()===n&&u.largestBatchId>r){let h=s.get(u.largestBatchId);h===null&&(h=mr(),s=s.insert(u.largestBatchId,h)),h.set(u.getKey(),u)}}const a=mr(),l=s.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((u,h)=>a.set(u,h)),!(a.size()>=i)););return O.resolve(a)}St(e,n,r){const i=this.overlays.get(r.key);if(i!==null){const o=this.qr.get(i.largestBatchId).delete(r.key);this.qr.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new Ny(n,r));let s=this.qr.get(n);s===void 0&&(s=Te(),this.qr.set(n,s)),this.qr.set(n,s.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hj{constructor(){this.sessionToken=_t.EMPTY_BYTE_STRING}getSessionToken(e){return O.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,O.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class My{constructor(){this.Qr=new Ue(Ct.$r),this.Ur=new Ue(Ct.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,n){const r=new Ct(e,n);this.Qr=this.Qr.add(r),this.Ur=this.Ur.add(r)}Wr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Gr(new Ct(e,n))}zr(e,n){e.forEach(r=>this.removeReference(r,n))}jr(e){const n=new X(new Oe([])),r=new Ct(n,e),i=new Ct(n,e+1),s=[];return this.Ur.forEachInRange([r,i],o=>{this.Gr(o),s.push(o.key)}),s}Jr(){this.Qr.forEach(e=>this.Gr(e))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const n=new X(new Oe([])),r=new Ct(n,e),i=new Ct(n,e+1);let s=Te();return this.Ur.forEachInRange([r,i],o=>{s=s.add(o.key)}),s}containsKey(e){const n=new Ct(e,0),r=this.Qr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class Ct{constructor(e,n){this.key=e,this.Yr=n}static $r(e,n){return X.comparator(e.key,n.key)||we(e.Yr,n.Yr)}static Kr(e,n){return we(e.Yr,n.Yr)||X.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wj{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.tr=1,this.Zr=new Ue(Ct.$r)}checkEmpty(e){return O.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,i){const s=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new Py(s,n,r,i);this.mutationQueue.push(o);for(const a of i)this.Zr=this.Zr.add(new Ct(a.key,s)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return O.resolve(o)}lookupMutationBatch(e,n){return O.resolve(this.Xr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,i=this.ei(r),s=i<0?0:i;return O.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return O.resolve(this.mutationQueue.length===0?bs:this.tr-1)}getAllMutationBatches(e){return O.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new Ct(n,0),i=new Ct(n,Number.POSITIVE_INFINITY),s=[];return this.Zr.forEachInRange([r,i],o=>{const a=this.Xr(o.Yr);s.push(a)}),O.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Ue(we);return n.forEach(i=>{const s=new Ct(i,0),o=new Ct(i,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([s,o],a=>{r=r.add(a.Yr)})}),O.resolve(this.ti(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,i=r.length+1;let s=r;X.isDocumentKey(s)||(s=s.child(""));const o=new Ct(new X(s),0);let a=new Ue(we);return this.Zr.forEachWhile(l=>{const u=l.key.path;return!!r.isPrefixOf(u)&&(u.length===i&&(a=a.add(l.Yr)),!0)},o),O.resolve(this.ti(a))}ti(e){const n=[];return e.forEach(r=>{const i=this.Xr(r);i!==null&&n.push(i)}),n}removeMutationBatch(e,n){ae(this.ni(n.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Zr;return O.forEach(n.mutations,i=>{const s=new Ct(i.key,n.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.Zr=r})}ir(e){}containsKey(e,n){const r=new Ct(n,0),i=this.Zr.firstAfterOrEqual(r);return O.resolve(n.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,O.resolve()}ni(e,n){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const n=this.ei(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kj{constructor(e){this.ri=e,this.docs=function(){return new tt(X.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,i=this.docs.get(r),s=i?i.size:0,o=this.ri(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return O.resolve(r?r.document.mutableCopy():lt.newInvalidDocument(n))}getEntries(e,n){let r=Tn();return n.forEach(i=>{const s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():lt.newInvalidDocument(i))}),O.resolve(r)}getDocumentsMatchingQuery(e,n,r,i){let s=Tn();const o=n.path,a=new X(o.child("__id-9223372036854775808__")),l=this.docs.getIteratorFrom(a);for(;l.hasNext();){const{key:u,value:{document:h}}=l.getNext();if(!o.isPrefixOf(u.path))break;u.path.length>o.length+1||_y(zS(h),r)<=0||(i.has(h.key)||Cc(n,h))&&(s=s.insert(h.key,h.mutableCopy()))}return O.resolve(s)}getAllFromCollectionGroup(e,n,r,i){se(9500)}ii(e,n){return O.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new Gj(this)}getSize(e){return O.resolve(this.size)}}class Gj extends iC{constructor(e){super(),this.Nr=e}applyChanges(e){const n=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?n.push(this.Nr.addEntry(e,i)):this.Nr.removeEntry(r)}),O.waitFor(n)}getFromCache(e,n){return this.Nr.getEntry(e,n)}getAllFromCache(e,n){return this.Nr.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qj{constructor(e){this.persistence=e,this.si=new Yr(n=>qs(n),Sc),this.lastRemoteSnapshotVersion=de.min(),this.highestTargetId=0,this.oi=0,this._i=new My,this.targetCount=0,this.ai=Gs.ur()}forEachTarget(e,n){return this.si.forEach((r,i)=>n(i)),O.resolve()}getLastRemoteSnapshotVersion(e){return O.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return O.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),O.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.oi&&(this.oi=n),O.resolve()}Pr(e){this.si.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.ai=new Gs(n),this.highestTargetId=n),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,n){return this.Pr(n),this.targetCount+=1,O.resolve()}updateTargetData(e,n){return this.Pr(n),O.resolve()}removeTargetData(e,n){return this.si.delete(n.target),this._i.jr(n.targetId),this.targetCount-=1,O.resolve()}removeTargets(e,n,r){let i=0;const s=[];return this.si.forEach((o,a)=>{a.sequenceNumber<=n&&r.get(a.targetId)===null&&(this.si.delete(o),s.push(this.removeMatchingKeysForTargetId(e,a.targetId)),i++)}),O.waitFor(s).next(()=>i)}getTargetCount(e){return O.resolve(this.targetCount)}getTargetData(e,n){const r=this.si.get(n)||null;return O.resolve(r)}addMatchingKeys(e,n,r){return this._i.Wr(n,r),O.resolve()}removeMatchingKeys(e,n,r){this._i.zr(n,r);const i=this.persistence.referenceDelegate,s=[];return i&&n.forEach(o=>{s.push(i.markPotentiallyOrphaned(e,o))}),O.waitFor(s)}removeMatchingKeysForTargetId(e,n){return this._i.jr(n),O.resolve()}getMatchingKeysForTargetId(e,n){const r=this._i.Hr(n);return O.resolve(r)}containsKey(e,n){return O.resolve(this._i.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fy{constructor(e,n){this.ui={},this.overlays={},this.ci=new jn(0),this.li=!1,this.li=!0,this.hi=new Hj,this.referenceDelegate=e(this),this.Pi=new Qj(this),this.indexManager=new Dj,this.remoteDocumentCache=function(i){return new Kj(i)}(r=>this.referenceDelegate.Ti(r)),this.serializer=new KA(n),this.Ii=new zj(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new qj,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.ui[e.toKey()];return r||(r=new Wj(n,this.referenceDelegate),this.ui[e.toKey()]=r),r}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,n,r){W("MemoryPersistence","Starting transaction:",e);const i=new Yj(this.ci.next());return this.referenceDelegate.Ei(),r(i).next(s=>this.referenceDelegate.di(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Ai(e,n){return O.or(Object.values(this.ui).map(r=>()=>r.containsKey(e,n)))}}class Yj extends HS{constructor(e){super(),this.currentSequenceNumber=e}}class qh{constructor(e){this.persistence=e,this.Ri=new My,this.Vi=null}static mi(e){return new qh(e)}get fi(){if(this.Vi)return this.Vi;throw se(60996)}addReference(e,n,r){return this.Ri.addReference(r,n),this.fi.delete(r.toString()),O.resolve()}removeReference(e,n,r){return this.Ri.removeReference(r,n),this.fi.add(r.toString()),O.resolve()}markPotentiallyOrphaned(e,n){return this.fi.add(n.toString()),O.resolve()}removeTarget(e,n){this.Ri.jr(n.targetId).forEach(i=>this.fi.add(i.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(i=>{i.forEach(s=>this.fi.add(s.toString()))}).next(()=>r.removeTargetData(e,n))}Ei(){this.Vi=new Set}di(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return O.forEach(this.fi,r=>{const i=X.fromPath(r);return this.gi(e,i).next(s=>{s||n.removeEntry(i,de.min())})}).next(()=>(this.Vi=null,n.apply(e)))}updateLimboDocument(e,n){return this.gi(e,n).next(r=>{r?this.fi.delete(n.toString()):this.fi.add(n.toString())})}Ti(e){return 0}gi(e,n){return O.or([()=>O.resolve(this.Ri.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Ai(e,n)])}}class Wd{constructor(e,n){this.persistence=e,this.pi=new Yr(r=>Wt(r.path),(r,i)=>r.isEqual(i)),this.garbageCollector=rC(this,n)}static mi(e,n){return new Wd(e,n)}Ei(){}di(e){return O.resolve()}forEachTarget(e,n){return this.persistence.getTargetCache().forEachTarget(e,n)}gr(e){const n=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next(r=>n.next(i=>r+i))}wr(e){let n=0;return this.pr(e,r=>{n++}).next(()=>n)}pr(e,n){return O.forEach(this.pi,(r,i)=>this.br(e,r,i).next(s=>s?O.resolve():n(i)))}removeTargets(e,n,r){return this.persistence.getTargetCache().removeTargets(e,n,r)}removeOrphanedDocuments(e,n){let r=0;const i=this.persistence.getRemoteDocumentCache(),s=i.newChangeBuffer();return i.ii(e,o=>this.br(e,o,n).next(a=>{a||(r++,s.removeEntry(o,de.min()))})).next(()=>s.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,n){return this.pi.set(n,e.currentSequenceNumber),O.resolve()}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,n,r){return this.pi.set(r,e.currentSequenceNumber),O.resolve()}removeReference(e,n,r){return this.pi.set(r,e.currentSequenceNumber),O.resolve()}updateLimboDocument(e,n){return this.pi.set(n,e.currentSequenceNumber),O.resolve()}Ti(e){let n=e.key.toString().length;return e.isFoundDocument()&&(n+=Ku(e.data.value)),n}br(e,n,r){return O.or([()=>this.persistence.Ai(e,n),()=>this.persistence.getTargetCache().containsKey(e,n),()=>{const i=this.pi.get(n);return O.resolve(i!==void 0&&i>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xj{constructor(e){this.serializer=e}k(e,n,r,i){const s=new Rh("createOrUpgrade",n);r<1&&i>=1&&(function(l){l.createObjectStore(xc)}(e),function(l){l.createObjectStore(rc,{keyPath:sO}),l.createObjectStore(Kn,{keyPath:gE,autoIncrement:!0}).createIndex(xs,yE,{unique:!0}),l.createObjectStore(sa)}(e),oI(e),function(l){l.createObjectStore(ms)}(e));let o=O.resolve();return r<3&&i>=3&&(r!==0&&(function(l){l.deleteObjectStore(aa),l.deleteObjectStore(oa),l.deleteObjectStore(Rs)}(e),oI(e)),o=o.next(()=>function(l){const u=l.store(Rs),h={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:de.min().toTimestamp(),targetCount:0};return u.put(jd,h)}(s))),r<4&&i>=4&&(r!==0&&(o=o.next(()=>function(l,u){return u.store(Kn).J().next(f=>{l.deleteObjectStore(Kn),l.createObjectStore(Kn,{keyPath:gE,autoIncrement:!0}).createIndex(xs,yE,{unique:!0});const m=u.store(Kn),E=f.map(_=>m.put(_));return O.waitFor(E)})}(e,s))),o=o.next(()=>{(function(l){l.createObjectStore(la,{keyPath:pO})})(e)})),r<5&&i>=5&&(o=o.next(()=>this.yi(s))),r<6&&i>=6&&(o=o.next(()=>(function(l){l.createObjectStore(ic)}(e),this.wi(s)))),r<7&&i>=7&&(o=o.next(()=>this.Si(s))),r<8&&i>=8&&(o=o.next(()=>this.bi(e,s))),r<9&&i>=9&&(o=o.next(()=>{(function(l){l.objectStoreNames.contains("remoteDocumentChanges")&&l.deleteObjectStore("remoteDocumentChanges")})(e)})),r<10&&i>=10&&(o=o.next(()=>this.Di(s))),r<11&&i>=11&&(o=o.next(()=>{(function(l){l.createObjectStore(kh,{keyPath:mO})})(e),function(l){l.createObjectStore(Nh,{keyPath:gO})}(e)})),r<12&&i>=12&&(o=o.next(()=>{(function(l){const u=l.createObjectStore(Dh,{keyPath:TO});u.createIndex(km,xO,{unique:!1}),u.createIndex(JS,SO,{unique:!1})})(e)})),r<13&&i>=13&&(o=o.next(()=>function(l){const u=l.createObjectStore(Od,{keyPath:aO});u.createIndex(Hu,lO),u.createIndex(GS,cO)}(e)).next(()=>this.Ci(e,s)).next(()=>e.deleteObjectStore(ms))),r<14&&i>=14&&(o=o.next(()=>this.Fi(e,s))),r<15&&i>=15&&(o=o.next(()=>function(l){l.createObjectStore(Ey,{keyPath:yO,autoIncrement:!0}).createIndex(Pm,_O,{unique:!1}),l.createObjectStore(Cl,{keyPath:vO}).createIndex(YS,wO,{unique:!1}),l.createObjectStore(bl,{keyPath:EO}).createIndex(XS,IO,{unique:!1})}(e))),r<16&&i>=16&&(o=o.next(()=>{n.objectStore(Cl).clear()}).next(()=>{n.objectStore(bl).clear()})),r<17&&i>=17&&(o=o.next(()=>{(function(l){l.createObjectStore(Iy,{keyPath:AO})})(e)})),r<18&&i>=18&&qx()&&(o=o.next(()=>{n.objectStore(Cl).clear()}).next(()=>{n.objectStore(bl).clear()})),o}wi(e){let n=0;return e.store(ms).ee((r,i)=>{n+=Hd(i)}).next(()=>{const r={byteSize:n};return e.store(ic).put(Rm,r)})}yi(e){const n=e.store(rc),r=e.store(Kn);return n.J().next(i=>O.forEach(i,s=>{const o=IDBKeyRange.bound([s.userId,bs],[s.userId,s.lastAcknowledgedBatchId]);return r.J(xs,o).next(a=>O.forEach(a,l=>{ae(l.userId===s.userId,18650,"Cannot process batch from unexpected user",{batchId:l.batchId});const u=ys(this.serializer,l);return ZA(e,s.userId,u).next(()=>{})}))}))}Si(e){const n=e.store(aa),r=e.store(ms);return e.store(Rs).get(jd).next(i=>{const s=[];return r.ee((o,a)=>{const l=new Oe(o),u=function(f){return[0,Wt(f)]}(l);s.push(n.get(u).next(h=>h?O.resolve():(f=>n.put({targetId:0,path:Wt(f),sequenceNumber:i.highestListenSequenceNumber}))(l)))}).next(()=>O.waitFor(s))})}bi(e,n){e.createObjectStore(sc,{keyPath:fO});const r=n.store(sc),i=new Ly,s=o=>{if(i.add(o)){const a=o.lastSegment(),l=o.popLast();return r.put({collectionId:a,parent:Wt(l)})}};return n.store(ms).ee({X:!0},(o,a)=>{const l=new Oe(o);return s(l.popLast())}).next(()=>n.store(sa).ee({X:!0},([o,a,l],u)=>{const h=pr(a);return s(h.popLast())}))}Di(e){const n=e.store(oa);return n.ee((r,i)=>{const s=dl(i),o=GA(this.serializer,s);return n.put(o)})}Ci(e,n){const r=n.store(ms),i=[];return r.ee((s,o)=>{const a=n.store(Od),l=function(f){return f.document?new X(Oe.fromString(f.document.name).popFirst(5)):f.noDocument?X.fromSegments(f.noDocument.path):f.unknownDocument?X.fromSegments(f.unknownDocument.path):se(36783)}(o).path.toArray(),u={prefixPath:l.slice(0,l.length-2),collectionGroup:l[l.length-2],documentId:l[l.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};i.push(a.put(u))}).next(()=>O.waitFor(i))}Fi(e,n){const r=n.store(Kn),i=sC(this.serializer),s=new Fy(qh.mi,this.serializer.yt);return r.J().next(o=>{const a=new Map;return o.forEach(l=>{let u=a.get(l.userId)??Te();ys(this.serializer,l).keys().forEach(h=>u=u.add(h)),a.set(l.userId,u)}),O.forEach(a,(l,u)=>{const h=new Nt(u),f=$h.wt(this.serializer,h),m=s.getIndexManager(h),E=zh.wt(h,this.serializer,m,s.referenceDelegate);return new oC(i,E,f,m).recalculateAndSaveOverlaysForDocumentKeys(new Nm(n,jn.ce),l).next()})})}}function oI(t){t.createObjectStore(aa,{keyPath:dO}).createIndex(wy,hO,{unique:!0}),t.createObjectStore(oa,{keyPath:"targetId"}).createIndex(QS,uO,{unique:!0}),t.createObjectStore(Rs)}const di="IndexedDbPersistence",sp=18e5,op=5e3,ap="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",Jj="main";class Uy{constructor(e,n,r,i,s,o,a,l,u,h,f=18){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.Mi=s,this.window=o,this.document=a,this.xi=u,this.Oi=h,this.Ni=f,this.ci=null,this.li=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Bi=null,this.inForeground=!1,this.Li=null,this.ki=null,this.qi=Number.NEGATIVE_INFINITY,this.Qi=m=>Promise.resolve(),!Uy.v())throw new G(B.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new Fj(this,i),this.$i=n+Jj,this.serializer=new KA(l),this.Ui=new Fi(this.$i,this.Ni,new Xj(this.serializer)),this.hi=new Cj,this.Pi=new Oj(this.referenceDelegate,this.serializer),this.remoteDocumentCache=sC(this.serializer),this.Ii=new Aj,this.window&&this.window.localStorage?this.Ki=this.window.localStorage:(this.Ki=null,h===!1&&Jt(di,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Wi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new G(B.FAILED_PRECONDITION,ap);return this.Gi(),this.zi(),this.ji(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Pi.getHighestSequenceNumber(e))}).then(e=>{this.ci=new jn(e,this.xi)}).then(()=>{this.li=!0}).catch(e=>(this.Ui&&this.Ui.close(),Promise.reject(e)))}Ji(e){return this.Qi=async n=>{if(this.started)return e(n)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ui.$(async n=>{n.newVersion===null&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Mi.enqueueAndForget(async()=>{this.started&&await this.Wi()}))}Wi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>_u(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.Hi(e).next(n=>{n||(this.isPrimary=!1,this.Mi.enqueueRetryable(()=>this.Qi(!1)))})}).next(()=>this.Yi(e)).next(n=>this.isPrimary&&!n?this.Zi(e).next(()=>!1):!!n&&this.Xi(e).next(()=>!0))).catch(e=>{if(ns(e))return W(di,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return W(di,"Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.Mi.enqueueRetryable(()=>this.Qi(e)),this.isPrimary=e})}Hi(e){return Za(e).get(uo).next(n=>O.resolve(this.es(n)))}ts(e){return _u(e).delete(this.clientId)}async ns(){if(this.isPrimary&&!this.rs(this.qi,sp)){this.qi=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",n=>{const r=St(n,la);return r.J().next(i=>{const s=this.ss(i,sp),o=i.filter(a=>s.indexOf(a)===-1);return O.forEach(o,a=>r.delete(a.clientId)).next(()=>o)})}).catch(()=>[]);if(this.Ki)for(const n of e)this.Ki.removeItem(this._s(n.clientId))}}ji(){this.ki=this.Mi.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.Wi().then(()=>this.ns()).then(()=>this.ji()))}es(e){return!!e&&e.ownerId===this.clientId}Yi(e){return this.Oi?O.resolve(!0):Za(e).get(uo).next(n=>{if(n!==null&&this.rs(n.leaseTimestampMs,op)&&!this.us(n.ownerId)){if(this.es(n)&&this.networkEnabled)return!0;if(!this.es(n)){if(!n.allowTabSynchronization)throw new G(B.FAILED_PRECONDITION,ap);return!1}}return!(!this.networkEnabled||!this.inForeground)||_u(e).J().next(r=>this.ss(r,op).find(i=>{if(this.clientId!==i.clientId){const s=!this.networkEnabled&&i.networkEnabled,o=!this.inForeground&&i.inForeground,a=this.networkEnabled===i.networkEnabled;if(s||o&&a)return!0}return!1})===void 0)}).next(n=>(this.isPrimary!==n&&W(di,`Client ${n?"is":"is not"} eligible for a primary lease.`),n))}async shutdown(){this.li=!1,this.cs(),this.ki&&(this.ki.cancel(),this.ki=null),this.ls(),this.hs(),await this.Ui.runTransaction("shutdown","readwrite",[xc,la],e=>{const n=new Nm(e,jn.ce);return this.Zi(n).next(()=>this.ts(n))}),this.Ui.close(),this.Ps()}ss(e,n){return e.filter(r=>this.rs(r.updateTimeMs,n)&&!this.us(r.clientId))}Ts(){return this.runTransaction("getActiveClients","readonly",e=>_u(e).J().next(n=>this.ss(n,sp).map(r=>r.clientId)))}get started(){return this.li}getGlobalsCache(){return this.hi}getMutationQueue(e,n){return zh.wt(e,this.serializer,n,this.referenceDelegate)}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new Vj(e,this.serializer.yt.databaseId)}getDocumentOverlayCache(e){return $h.wt(this.serializer,e)}getBundleCache(){return this.Ii}runTransaction(e,n,r){W(di,"Starting transaction:",e);const i=n==="readonly"?"readonly":"readwrite",s=function(l){return l===18?RO:l===17?nA:l===16?bO:l===15?Ty:l===14?tA:l===13?eA:l===12?CO:l===11?ZS:void se(60245)}(this.Ni);let o;return this.Ui.runTransaction(e,i,s,a=>(o=new Nm(a,this.ci?this.ci.next():jn.ce),n==="readwrite-primary"?this.Hi(o).next(l=>!!l||this.Yi(o)).next(l=>{if(!l)throw Jt(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Mi.enqueueRetryable(()=>this.Qi(!1)),new G(B.FAILED_PRECONDITION,qS);return r(o)}).next(l=>this.Xi(o).next(()=>l)):this.Is(o).next(()=>r(o)))).then(a=>(o.raiseOnCommittedEvent(),a))}Is(e){return Za(e).get(uo).next(n=>{if(n!==null&&this.rs(n.leaseTimestampMs,op)&&!this.us(n.ownerId)&&!this.es(n)&&!(this.Oi||this.allowTabSynchronization&&n.allowTabSynchronization))throw new G(B.FAILED_PRECONDITION,ap)})}Xi(e){const n={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return Za(e).put(uo,n)}static v(){return Fi.v()}Zi(e){const n=Za(e);return n.get(uo).next(r=>this.es(r)?(W(di,"Releasing primary lease."),n.delete(uo)):O.resolve())}rs(e,n){const r=Date.now();return!(e<r-n)&&(!(e>r)||(Jt(`Detected an update time that is in the future: ${e} > ${r}`),!1))}Gi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Li=()=>{this.Mi.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.Wi()))},this.document.addEventListener("visibilitychange",this.Li),this.inForeground=this.document.visibilityState==="visible")}ls(){this.Li&&(this.document.removeEventListener("visibilitychange",this.Li),this.Li=null)}zi(){var e;typeof((e=this.window)==null?void 0:e.addEventListener)=="function"&&(this.Bi=()=>{this.cs();const n=/(?:Version|Mobile)\/1[456]/;zx()&&(navigator.appVersion.match(n)||navigator.userAgent.match(n))&&this.Mi.enterRestrictedMode(!0),this.Mi.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Bi))}hs(){this.Bi&&(this.window.removeEventListener("pagehide",this.Bi),this.Bi=null)}us(e){var n;try{const r=((n=this.Ki)==null?void 0:n.getItem(this._s(e)))!==null;return W(di,`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return Jt(di,"Failed to get zombied client id.",r),!1}}cs(){if(this.Ki)try{this.Ki.setItem(this._s(this.clientId),String(Date.now()))}catch(e){Jt("Failed to set zombie client id.",e)}}Ps(){if(this.Ki)try{this.Ki.removeItem(this._s(this.clientId))}catch{}}_s(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function Za(t){return St(t,xc)}function _u(t){return St(t,la)}function Zj(t,e){let n=t.projectId;return t.isDefaultDatabase||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class By{constructor(e,n,r,i){this.targetId=e,this.fromCache=n,this.Es=r,this.ds=i}static As(e,n){let r=Te(),i=Te();for(const s of n.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new By(e,n.fromCache,r,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eL{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aC{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=function(){return zx()?8:WS(xt())>0?6:4}()}initialize(e,n){this.ps=e,this.indexManager=n,this.Rs=!0}getDocumentsMatchingQuery(e,n,r,i){const s={result:null};return this.ys(e,n).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.ws(e,n,i,r).next(o=>{s.result=o})}).next(()=>{if(s.result)return;const o=new eL;return this.Ss(e,n,o).next(a=>{if(s.result=a,this.Vs)return this.bs(e,n,o,a.size)})}).next(()=>s.result)}bs(e,n,r,i){return r.documentReadCount<this.fs?(wo()<=Ce.DEBUG&&W("QueryEngine","SDK will not create cache indexes for query:",Eo(n),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),O.resolve()):(wo()<=Ce.DEBUG&&W("QueryEngine","Query:",Eo(n),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.gs*i?(wo()<=Ce.DEBUG&&W("QueryEngine","The SDK decides to create cache indexes for query:",Eo(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Mn(n))):O.resolve())}ys(e,n){if(PE(n))return O.resolve(null);let r=Mn(n);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(n.limit!==null&&i===1&&(n=Ud(n,null,"F"),r=Mn(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{const o=Te(...s);return this.ps.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,r).next(l=>{const u=this.Ds(n,a);return this.Cs(n,u,o,l.readTime)?this.ys(e,Ud(n,null,"F")):this.vs(e,u,n,l)}))})))}ws(e,n,r,i){return PE(n)||i.isEqual(de.min())?O.resolve(null):this.ps.getDocuments(e,r).next(s=>{const o=this.Ds(n,s);return this.Cs(n,o,r,i)?O.resolve(null):(wo()<=Ce.DEBUG&&W("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Eo(n)),this.vs(e,o,n,JV(i,ec)).next(a=>a))})}Ds(e,n){let r=new Ue(IA(e));return n.forEach((i,s)=>{Cc(e,s)&&(r=r.add(s))}),r}Cs(e,n,r,i){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const s=e.limitType==="F"?n.last():n.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Ss(e,n,r){return wo()<=Ce.DEBUG&&W("QueryEngine","Using full collection scan to execute query:",Eo(n)),this.ps.getDocumentsMatchingQuery(e,n,Cn.min(),r)}vs(e,n,r,i){return this.ps.getDocumentsMatchingQuery(e,r,i).next(s=>(n.forEach(o=>{s=s.insert(o.key,o)}),s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $y="LocalStore",tL=3e8;class nL{constructor(e,n,r,i){this.persistence=e,this.Fs=n,this.serializer=i,this.Ms=new tt(we),this.xs=new Yr(s=>qs(s),Sc),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(r)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new oC(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.Ms))}}function lC(t,e,n,r){return new nL(t,e,n,r)}async function cC(t,e){const n=ge(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let i;return n.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,n.Bs(e),n.mutationQueue.getAllMutationBatches(r))).next(s=>{const o=[],a=[];let l=Te();for(const u of i){o.push(u.batchId);for(const h of u.mutations)l=l.add(h.key)}for(const u of s){a.push(u.batchId);for(const h of u.mutations)l=l.add(h.key)}return n.localDocuments.getDocuments(r,l).next(u=>({Ls:u,removedBatchIds:o,addedBatchIds:a}))})})}function rL(t,e){const n=ge(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const i=e.batch.keys(),s=n.Ns.newChangeBuffer({trackRemovals:!0});return function(a,l,u,h){const f=u.batch,m=f.keys();let E=O.resolve();return m.forEach(_=>{E=E.next(()=>h.getEntry(l,_)).next(A=>{const P=u.docVersions.get(_);ae(P!==null,48541),A.version.compareTo(P)<0&&(f.applyToRemoteDocument(A,u),A.isValidDocument()&&(A.setReadTime(u.commitVersion),h.addEntry(A)))})}),E.next(()=>a.mutationQueue.removeMutationBatch(l,f))}(n,r,e,s).next(()=>s.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let l=Te();for(let u=0;u<a.mutationResults.length;++u)a.mutationResults[u].transformResults.length>0&&(l=l.add(a.batch.mutations[u].key));return l}(e))).next(()=>n.localDocuments.getDocuments(r,i))})}function uC(t){const e=ge(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Pi.getLastRemoteSnapshotVersion(n))}function iL(t,e){const n=ge(t),r=e.snapshotVersion;let i=n.Ms;return n.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const o=n.Ns.newChangeBuffer({trackRemovals:!0});i=n.Ms;const a=[];e.targetChanges.forEach((h,f)=>{const m=i.get(f);if(!m)return;a.push(n.Pi.removeMatchingKeys(s,h.removedDocuments,f).next(()=>n.Pi.addMatchingKeys(s,h.addedDocuments,f)));let E=m.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(f)!==null?E=E.withResumeToken(_t.EMPTY_BYTE_STRING,de.min()).withLastLimboFreeSnapshotVersion(de.min()):h.resumeToken.approximateByteSize()>0&&(E=E.withResumeToken(h.resumeToken,r)),i=i.insert(f,E),function(A,P,v){return A.resumeToken.approximateByteSize()===0||P.snapshotVersion.toMicroseconds()-A.snapshotVersion.toMicroseconds()>=tL?!0:v.addedDocuments.size+v.modifiedDocuments.size+v.removedDocuments.size>0}(m,E,h)&&a.push(n.Pi.updateTargetData(s,E))});let l=Tn(),u=Te();if(e.documentUpdates.forEach(h=>{e.resolvedLimboDocuments.has(h)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(s,h))}),a.push(sL(s,o,e.documentUpdates).next(h=>{l=h.ks,u=h.qs})),!r.isEqual(de.min())){const h=n.Pi.getLastRemoteSnapshotVersion(s).next(f=>n.Pi.setTargetsMetadata(s,s.currentSequenceNumber,r));a.push(h)}return O.waitFor(a).next(()=>o.apply(s)).next(()=>n.localDocuments.getLocalViewOfDocuments(s,l,u)).next(()=>l)}).then(s=>(n.Ms=i,s))}function sL(t,e,n){let r=Te(),i=Te();return n.forEach(s=>r=r.add(s)),e.getEntries(t,r).next(s=>{let o=Tn();return n.forEach((a,l)=>{const u=s.get(a);l.isFoundDocument()!==u.isFoundDocument()&&(i=i.add(a)),l.isNoDocument()&&l.version.isEqual(de.min())?(e.removeEntry(a,l.readTime),o=o.insert(a,l)):!u.isValidDocument()||l.version.compareTo(u.version)>0||l.version.compareTo(u.version)===0&&u.hasPendingWrites?(e.addEntry(l),o=o.insert(a,l)):W($y,"Ignoring outdated watch update for ",a,". Current version:",u.version," Watch version:",l.version)}),{ks:o,qs:i}})}function oL(t,e){const n=ge(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=bs),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function aL(t,e){const n=ge(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return n.Pi.getTargetData(r,e).next(s=>s?(i=s,O.resolve(i)):n.Pi.allocateTargetId(r).next(o=>(i=new jr(e,o,"TargetPurposeListen",r.currentSequenceNumber),n.Pi.addTargetData(r,i).next(()=>i))))}).then(r=>{const i=n.Ms.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(n.Ms=n.Ms.insert(r.targetId,r),n.xs.set(e,r.targetId)),r})}async function Wm(t,e,n){const r=ge(t),i=r.Ms.get(e),s=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",s,o=>r.persistence.referenceDelegate.removeTarget(o,i))}catch(o){if(!ns(o))throw o;W($y,`Failed to update sequence numbers for target ${e}: ${o}`)}r.Ms=r.Ms.remove(e),r.xs.delete(i.target)}function aI(t,e,n){const r=ge(t);let i=de.min(),s=Te();return r.persistence.runTransaction("Execute query","readwrite",o=>function(l,u,h){const f=ge(l),m=f.xs.get(h);return m!==void 0?O.resolve(f.Ms.get(m)):f.Pi.getTargetData(u,h)}(r,o,Mn(e)).next(a=>{if(a)return i=a.lastLimboFreeSnapshotVersion,r.Pi.getMatchingKeysForTargetId(o,a.targetId).next(l=>{s=l})}).next(()=>r.Fs.getDocumentsMatchingQuery(o,e,n?i:de.min(),n?s:Te())).next(a=>(lL(r,HO(e),a),{documents:a,Qs:s})))}function lL(t,e,n){let r=t.Os.get(e)||de.min();n.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),t.Os.set(e,r)}class lI{constructor(){this.activeTargetIds=XO()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class dC{constructor(){this.Mo=new lI,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,n,r){this.xo[e]=n}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new lI,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cL{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cI="ConnectivityMonitor";class uI{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){W(cI,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){W(cI,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let vu=null;function Km(){return vu===null?vu=function(){return 268435456+Math.round(2147483648*Math.random())}():vu++,"0x"+vu.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lp="RestConnection",uL={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class dL{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const n=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Uo=n+"://"+e.host,this.Ko=`projects/${r}/databases/${i}`,this.Wo=this.databaseId.database===Ld?`project_id=${r}`:`project_id=${r}&database_id=${i}`}Go(e,n,r,i,s){const o=Km(),a=this.zo(e,n.toUriEncodedString());W(lp,`Sending RPC '${e}' ${o}:`,a,r);const l={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(l,i,s);const{host:u}=new URL(a),h=Zi(u);return this.Jo(e,a,l,r,h).then(f=>(W(lp,`Received RPC '${e}' ${o}: `,f),f),f=>{throw Bs(lp,`RPC '${e}' ${o} failed with error: `,f,"url: ",a,"request:",r),f})}Ho(e,n,r,i,s,o){return this.Go(e,n,r,i,s)}jo(e,n,r){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+xa}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((i,s)=>e[s]=i),r&&r.headers.forEach((i,s)=>e[s]=i)}zo(e,n){const r=uL[e];return`${this.Uo}/v1/${n}:${r}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hL{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ut="WebChannelConnection";class fL extends dL{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,n,r,i,s){const o=Km();return new Promise((a,l)=>{const u=new DS;u.setWithCredentials(!0),u.listenOnce(VS.COMPLETE,()=>{try{switch(u.getLastErrorCode()){case $u.NO_ERROR:const f=u.getResponseJson();W(Ut,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(f)),a(f);break;case $u.TIMEOUT:W(Ut,`RPC '${e}' ${o} timed out`),l(new G(B.DEADLINE_EXCEEDED,"Request time out"));break;case $u.HTTP_ERROR:const m=u.getStatus();if(W(Ut,`RPC '${e}' ${o} failed with status:`,m,"response text:",u.getResponseText()),m>0){let E=u.getResponseJson();Array.isArray(E)&&(E=E[0]);const _=E==null?void 0:E.error;if(_&&_.status&&_.message){const A=function(v){const w=v.toLowerCase().replace(/_/g,"-");return Object.values(B).indexOf(w)>=0?w:B.UNKNOWN}(_.status);l(new G(A,_.message))}else l(new G(B.UNKNOWN,"Server responded with status "+u.getStatus()))}else l(new G(B.UNAVAILABLE,"Connection failed."));break;default:se(9055,{l_:e,streamId:o,h_:u.getLastErrorCode(),P_:u.getLastError()})}}finally{W(Ut,`RPC '${e}' ${o} completed.`)}});const h=JSON.stringify(i);W(Ut,`RPC '${e}' ${o} sending request:`,i),u.send(n,"POST",h,r,15)})}T_(e,n,r){const i=Km(),s=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=LS(),a=jS(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},u=this.longPollingOptions.timeoutSeconds;u!==void 0&&(l.longPollingTimeout=Math.round(1e3*u)),this.useFetchStreams&&(l.useFetchStreams=!0),this.jo(l.initMessageHeaders,n,r),l.encodeInitMessageHeaders=!0;const h=s.join("");W(Ut,`Creating RPC '${e}' stream ${i}: ${h}`,l);const f=o.createWebChannel(h,l);this.I_(f);let m=!1,E=!1;const _=new hL({Yo:P=>{E?W(Ut,`Not sending because RPC '${e}' stream ${i} is closed:`,P):(m||(W(Ut,`Opening RPC '${e}' stream ${i} transport.`),f.open(),m=!0),W(Ut,`RPC '${e}' stream ${i} sending:`,P),f.send(P))},Zo:()=>f.close()}),A=(P,v,w)=>{P.listen(v,y=>{try{w(y)}catch(V){setTimeout(()=>{throw V},0)}})};return A(f,ll.EventType.OPEN,()=>{E||(W(Ut,`RPC '${e}' stream ${i} transport opened.`),_.o_())}),A(f,ll.EventType.CLOSE,()=>{E||(E=!0,W(Ut,`RPC '${e}' stream ${i} transport closed`),_.a_(),this.E_(f))}),A(f,ll.EventType.ERROR,P=>{E||(E=!0,Bs(Ut,`RPC '${e}' stream ${i} transport errored. Name:`,P.name,"Message:",P.message),_.a_(new G(B.UNAVAILABLE,"The operation could not be completed")))}),A(f,ll.EventType.MESSAGE,P=>{var v;if(!E){const w=P.data[0];ae(!!w,16349);const y=w,V=(y==null?void 0:y.error)||((v=y[0])==null?void 0:v.error);if(V){W(Ut,`RPC '${e}' stream ${i} received error:`,V);const U=V.status;let $=function(C){const R=pt[C];if(R!==void 0)return VA(R)}(U),S=V.message;$===void 0&&($=B.INTERNAL,S="Unknown error status: "+U+" with message "+V.message),E=!0,_.a_(new G($,S)),f.close()}else W(Ut,`RPC '${e}' stream ${i} received:`,w),_.u_(w)}}),A(a,OS.STAT_EVENT,P=>{P.stat===Am.PROXY?W(Ut,`RPC '${e}' stream ${i} detected buffering proxy`):P.stat===Am.NOPROXY&&W(Ut,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{_.__()},0),_}terminate(){this.c_.forEach(e=>e.close()),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter(n=>n===e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pL(){return typeof window<"u"?window:null}function Ju(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hh(t){return new pj(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hC{constructor(e,n,r=1e3,i=1.5,s=6e4){this.Mi=e,this.timerId=n,this.d_=r,this.A_=i,this.R_=s,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const n=Math.floor(this.V_+this.y_()),r=Math.max(0,Date.now()-this.f_),i=Math.max(0,n-r);i>0&&W("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.V_} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,i,()=>(this.f_=Date.now(),e())),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dI="PersistentStream";class fC{constructor(e,n,r,i,s,o,a,l){this.Mi=e,this.S_=r,this.b_=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=l,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new hC(e,n)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,()=>this.k_()))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,n){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():n&&n.code===B.RESOURCE_EXHAUSTED?(Jt(n.toString()),Jt("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):n&&n.code===B.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(n)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),n=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.D_===n&&this.G_(r,i)},r=>{e(()=>{const i=new G(B.UNKNOWN,"Fetching auth token failed: "+r.message);return this.z_(i)})})}G_(e,n){const r=this.W_(this.D_);this.stream=this.j_(e,n),this.stream.Xo(()=>{r(()=>this.listener.Xo())}),this.stream.t_(()=>{r(()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.t_()))}),this.stream.r_(i=>{r(()=>this.z_(i))}),this.stream.onMessage(i=>{r(()=>++this.F_==1?this.J_(i):this.onNext(i))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return W(dI,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return n=>{this.Mi.enqueueAndForget(()=>this.D_===e?n():(W(dI,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class mL extends fC{constructor(e,n,r,i,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s}j_(e,n){return this.connection.T_("Listen",e,n)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const n=yj(this.serializer,e),r=function(s){if(!("targetChange"in s))return de.min();const o=s.targetChange;return o.targetIds&&o.targetIds.length?de.min():o.readTime?tn(o.readTime):de.min()}(e);return this.listener.H_(n,r)}Y_(e){const n={};n.database=Bm(this.serializer),n.addTarget=function(s,o){let a;const l=o.target;if(a=Md(l)?{documents:$A(s,l)}:{query:Oy(s,l).ft},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=LA(s,o.resumeToken);const u=Fm(s,o.expectedCount);u!==null&&(a.expectedCount=u)}else if(o.snapshotVersion.compareTo(de.min())>0){a.readTime=pa(s,o.snapshotVersion.toTimestamp());const u=Fm(s,o.expectedCount);u!==null&&(a.expectedCount=u)}return a}(this.serializer,e);const r=wj(this.serializer,e);r&&(n.labels=r),this.q_(n)}Z_(e){const n={};n.database=Bm(this.serializer),n.removeTarget=e,this.q_(n)}}class gL extends fC{constructor(e,n,r,i,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,n){return this.connection.T_("Write",e,n)}J_(e){return ae(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,ae(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){ae(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const n=_j(e.writeResults,e.commitTime),r=tn(e.commitTime);return this.listener.na(r,n)}ra(){const e={};e.database=Bm(this.serializer),this.q_(e)}ea(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>$d(this.serializer,r))};this.q_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yL{}class _L extends yL{constructor(e,n,r,i){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=i,this.ia=!1}sa(){if(this.ia)throw new G(B.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,n,r,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.Go(e,Um(n,r),i,s,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===B.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new G(B.UNKNOWN,s.toString())})}Ho(e,n,r,i,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.Ho(e,Um(n,r),i,o,a,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===B.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new G(B.UNKNOWN,o.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}class vL{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Jt(n),this.aa=!1):W("OnlineStateTracker",n)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qs="RemoteStore";class wL{constructor(e,n,r,i,s){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=s,this.Aa.Oo(o=>{r.enqueueAndForget(async()=>{so(this)&&(W(Qs,"Restarting streams for network reachability change."),await async function(l){const u=ge(l);u.Ea.add(4),await Rc(u),u.Ra.set("Unknown"),u.Ea.delete(4),await Wh(u)}(this))})}),this.Ra=new vL(r,i)}}async function Wh(t){if(so(t))for(const e of t.da)await e(!0)}async function Rc(t){for(const e of t.da)await e(!1)}function pC(t,e){const n=ge(t);n.Ia.has(e.targetId)||(n.Ia.set(e.targetId,e),Wy(n)?Hy(n):Aa(n).O_()&&qy(n,e))}function zy(t,e){const n=ge(t),r=Aa(n);n.Ia.delete(e),r.O_()&&mC(n,e),n.Ia.size===0&&(r.O_()?r.L_():so(n)&&n.Ra.set("Unknown"))}function qy(t,e){if(t.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(de.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}Aa(t).Y_(e)}function mC(t,e){t.Va.Ue(e),Aa(t).Z_(e)}function Hy(t){t.Va=new uj({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),At:e=>t.Ia.get(e)||null,ht:()=>t.datastore.serializer.databaseId}),Aa(t).start(),t.Ra.ua()}function Wy(t){return so(t)&&!Aa(t).x_()&&t.Ia.size>0}function so(t){return ge(t).Ea.size===0}function gC(t){t.Va=void 0}async function EL(t){t.Ra.set("Online")}async function IL(t){t.Ia.forEach((e,n)=>{qy(t,e)})}async function TL(t,e){gC(t),Wy(t)?(t.Ra.ha(e),Hy(t)):t.Ra.set("Unknown")}async function xL(t,e,n){if(t.Ra.set("Online"),e instanceof jA&&e.state===2&&e.cause)try{await async function(i,s){const o=s.cause;for(const a of s.targetIds)i.Ia.has(a)&&(await i.remoteSyncer.rejectListen(a,o),i.Ia.delete(a),i.Va.removeTarget(a))}(t,e)}catch(r){W(Qs,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await Kd(t,r)}else if(e instanceof Yu?t.Va.Ze(e):e instanceof OA?t.Va.st(e):t.Va.tt(e),!n.isEqual(de.min()))try{const r=await uC(t.localStore);n.compareTo(r)>=0&&await function(s,o){const a=s.Va.Tt(o);return a.targetChanges.forEach((l,u)=>{if(l.resumeToken.approximateByteSize()>0){const h=s.Ia.get(u);h&&s.Ia.set(u,h.withResumeToken(l.resumeToken,o))}}),a.targetMismatches.forEach((l,u)=>{const h=s.Ia.get(l);if(!h)return;s.Ia.set(l,h.withResumeToken(_t.EMPTY_BYTE_STRING,h.snapshotVersion)),mC(s,l);const f=new jr(h.target,l,u,h.sequenceNumber);qy(s,f)}),s.remoteSyncer.applyRemoteEvent(a)}(t,n)}catch(r){W(Qs,"Failed to raise snapshot:",r),await Kd(t,r)}}async function Kd(t,e,n){if(!ns(e))throw e;t.Ea.add(1),await Rc(t),t.Ra.set("Offline"),n||(n=()=>uC(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{W(Qs,"Retrying IndexedDB access"),await n(),t.Ea.delete(1),await Wh(t)})}function yC(t,e){return e().catch(n=>Kd(t,n,e))}async function Pc(t){const e=ge(t),n=Ki(e);let r=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:bs;for(;SL(e);)try{const i=await oL(e.localStore,r);if(i===null){e.Ta.length===0&&n.L_();break}r=i.batchId,AL(e,i)}catch(i){await Kd(e,i)}_C(e)&&vC(e)}function SL(t){return so(t)&&t.Ta.length<10}function AL(t,e){t.Ta.push(e);const n=Ki(t);n.O_()&&n.X_&&n.ea(e.mutations)}function _C(t){return so(t)&&!Ki(t).x_()&&t.Ta.length>0}function vC(t){Ki(t).start()}async function CL(t){Ki(t).ra()}async function bL(t){const e=Ki(t);for(const n of t.Ta)e.ea(n.mutations)}async function RL(t,e,n){const r=t.Ta.shift(),i=ky.from(r,e,n);await yC(t,()=>t.remoteSyncer.applySuccessfulWrite(i)),await Pc(t)}async function PL(t,e){e&&Ki(t).X_&&await async function(r,i){if(function(o){return aj(o)&&o!==B.ABORTED}(i.code)){const s=r.Ta.shift();Ki(r).B_(),await yC(r,()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i)),await Pc(r)}}(t,e),_C(t)&&vC(t)}async function hI(t,e){const n=ge(t);n.asyncQueue.verifyOperationInProgress(),W(Qs,"RemoteStore received new credentials");const r=so(n);n.Ea.add(3),await Rc(n),r&&n.Ra.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.Ea.delete(3),await Wh(n)}async function kL(t,e){const n=ge(t);e?(n.Ea.delete(2),await Wh(n)):e||(n.Ea.add(2),await Rc(n),n.Ra.set("Unknown"))}function Aa(t){return t.ma||(t.ma=function(n,r,i){const s=ge(n);return s.sa(),new mL(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Xo:EL.bind(null,t),t_:IL.bind(null,t),r_:TL.bind(null,t),H_:xL.bind(null,t)}),t.da.push(async e=>{e?(t.ma.B_(),Wy(t)?Hy(t):t.Ra.set("Unknown")):(await t.ma.stop(),gC(t))})),t.ma}function Ki(t){return t.fa||(t.fa=function(n,r,i){const s=ge(n);return s.sa(),new gL(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Xo:()=>Promise.resolve(),t_:CL.bind(null,t),r_:PL.bind(null,t),ta:bL.bind(null,t),na:RL.bind(null,t)}),t.da.push(async e=>{e?(t.fa.B_(),await Pc(t)):(await t.fa.stop(),t.Ta.length>0&&(W(Qs,`Stopping write stream with ${t.Ta.length} pending writes`),t.Ta=[]))})),t.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ky{constructor(e,n,r,i,s){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new Jn,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,i,s){const o=Date.now()+r,a=new Ky(e,n,o,i,s);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new G(B.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Gy(t,e){if(Jt("AsyncQueue",`${e}: ${t}`),ns(t))return new G(B.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ko{static emptySet(e){return new Ko(e.comparator)}constructor(e){this.comparator=e?(n,r)=>e(n,r)||X.comparator(n.key,r.key):(n,r)=>X.comparator(n.key,r.key),this.keyedMap=cl(),this.sortedSet=new tt(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof Ko)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const i=n.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new Ko;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fI{constructor(){this.ga=new tt(X.comparator)}track(e){const n=e.doc.key,r=this.ga.get(n);r?e.type!==0&&r.type===3?this.ga=this.ga.insert(n,e):e.type===3&&r.type!==1?this.ga=this.ga.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.ga=this.ga.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.ga=this.ga.remove(n):e.type===1&&r.type===2?this.ga=this.ga.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):se(63341,{Rt:e,pa:r}):this.ga=this.ga.insert(n,e)}ya(){const e=[];return this.ga.inorderTraversal((n,r)=>{e.push(r)}),e}}class ma{constructor(e,n,r,i,s,o,a,l,u){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=l,this.hasCachedResults=u}static fromInitialDocuments(e,n,r,i,s){const o=[];return n.forEach(a=>{o.push({type:0,doc:a})}),new ma(e,n,Ko.emptySet(n),o,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Lh(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let i=0;i<n.length;i++)if(n[i].type!==r[i].type||!n[i].doc.isEqual(r[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NL{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some(e=>e.Da())}}class DL{constructor(){this.queries=pI(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(n,r){const i=ge(n),s=i.queries;i.queries=pI(),s.forEach((o,a)=>{for(const l of a.Sa)l.onError(r)})})(this,new G(B.ABORTED,"Firestore shutting down"))}}function pI(){return new Yr(t=>EA(t),Lh)}async function Qy(t,e){const n=ge(t);let r=3;const i=e.query;let s=n.queries.get(i);s?!s.ba()&&e.Da()&&(r=2):(s=new NL,r=e.Da()?0:1);try{switch(r){case 0:s.wa=await n.onListen(i,!0);break;case 1:s.wa=await n.onListen(i,!1);break;case 2:await n.onFirstRemoteStoreListen(i)}}catch(o){const a=Gy(o,`Initialization of query '${Eo(e.query)}' failed`);return void e.onError(a)}n.queries.set(i,s),s.Sa.push(e),e.va(n.onlineState),s.wa&&e.Fa(s.wa)&&Xy(n)}async function Yy(t,e){const n=ge(t),r=e.query;let i=3;const s=n.queries.get(r);if(s){const o=s.Sa.indexOf(e);o>=0&&(s.Sa.splice(o,1),s.Sa.length===0?i=e.Da()?0:1:!s.ba()&&e.Da()&&(i=2))}switch(i){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function VL(t,e){const n=ge(t);let r=!1;for(const i of e){const s=i.query,o=n.queries.get(s);if(o){for(const a of o.Sa)a.Fa(i)&&(r=!0);o.wa=i}}r&&Xy(n)}function OL(t,e,n){const r=ge(t),i=r.queries.get(e);if(i)for(const s of i.Sa)s.onError(n);r.queries.delete(e)}function Xy(t){t.Ca.forEach(e=>{e.next()})}var Gm,mI;(mI=Gm||(Gm={})).Ma="default",mI.Cache="cache";class Jy{constructor(e,n,r){this.query=e,this.xa=n,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=r||{}}Fa(e){if(!this.options.includeMetadataChanges){const r=[];for(const i of e.docChanges)i.type!==3&&r.push(i);e=new ma(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),n=!0):this.La(e,this.onlineState)&&(this.ka(e),n=!0),this.Na=e,n}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let n=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),n=!0),n}La(e,n){if(!e.fromCache||!this.Da())return!0;const r=n!=="Offline";return(!this.options.qa||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const n=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}ka(e){e=ma.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==Gm.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wC{constructor(e){this.key=e}}class EC{constructor(e){this.key=e}}class jL{constructor(e,n){this.query=e,this.Ya=n,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=Te(),this.mutatedKeys=Te(),this.eu=IA(e),this.tu=new Ko(this.eu)}get nu(){return this.Ya}ru(e,n){const r=n?n.iu:new fI,i=n?n.tu:this.tu;let s=n?n.mutatedKeys:this.mutatedKeys,o=i,a=!1;const l=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,u=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((h,f)=>{const m=i.get(h),E=Cc(this.query,f)?f:null,_=!!m&&this.mutatedKeys.has(m.key),A=!!E&&(E.hasLocalMutations||this.mutatedKeys.has(E.key)&&E.hasCommittedMutations);let P=!1;m&&E?m.data.isEqual(E.data)?_!==A&&(r.track({type:3,doc:E}),P=!0):this.su(m,E)||(r.track({type:2,doc:E}),P=!0,(l&&this.eu(E,l)>0||u&&this.eu(E,u)<0)&&(a=!0)):!m&&E?(r.track({type:0,doc:E}),P=!0):m&&!E&&(r.track({type:1,doc:m}),P=!0,(l||u)&&(a=!0)),P&&(E?(o=o.add(E),s=A?s.add(h):s.delete(h)):(o=o.delete(h),s=s.delete(h)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const h=this.query.limitType==="F"?o.last():o.first();o=o.delete(h.key),s=s.delete(h.key),r.track({type:1,doc:h})}return{tu:o,iu:r,Cs:a,mutatedKeys:s}}su(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,i){const s=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const o=e.iu.ya();o.sort((h,f)=>function(E,_){const A=P=>{switch(P){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return se(20277,{Rt:P})}};return A(E)-A(_)}(h.type,f.type)||this.eu(h.doc,f.doc)),this.ou(r),i=i??!1;const a=n&&!i?this._u():[],l=this.Xa.size===0&&this.current&&!i?1:0,u=l!==this.Za;return this.Za=l,o.length!==0||u?{snapshot:new ma(this.query,e.tu,s,o,e.mutatedKeys,l===0,u,!1,!!r&&r.resumeToken.approximateByteSize()>0),au:a}:{au:a}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new fI,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(n=>this.Ya=this.Ya.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Ya=this.Ya.delete(n)),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=Te(),this.tu.forEach(r=>{this.uu(r.key)&&(this.Xa=this.Xa.add(r.key))});const n=[];return e.forEach(r=>{this.Xa.has(r)||n.push(new EC(r))}),this.Xa.forEach(r=>{e.has(r)||n.push(new wC(r))}),n}cu(e){this.Ya=e.Qs,this.Xa=Te();const n=this.ru(e.documents);return this.applyChanges(n,!0)}lu(){return ma.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const Zy="SyncEngine";class LL{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class ML{constructor(e){this.key=e,this.hu=!1}}class FL{constructor(e,n,r,i,s,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.Pu={},this.Tu=new Yr(a=>EA(a),Lh),this.Iu=new Map,this.Eu=new Set,this.du=new tt(X.comparator),this.Au=new Map,this.Ru=new My,this.Vu={},this.mu=new Map,this.fu=Gs.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function UL(t,e,n=!0){const r=CC(t);let i;const s=r.Tu.get(e);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.lu()):i=await IC(r,e,n,!0),i}async function BL(t,e){const n=CC(t);await IC(n,e,!0,!1)}async function IC(t,e,n,r){const i=await aL(t.localStore,Mn(e)),s=i.targetId,o=t.sharedClientState.addLocalQueryTarget(s,n);let a;return r&&(a=await $L(t,e,s,o==="current",i.resumeToken)),t.isPrimaryClient&&n&&pC(t.remoteStore,i),a}async function $L(t,e,n,r,i){t.pu=(f,m,E)=>async function(A,P,v,w){let y=P.view.ru(v);y.Cs&&(y=await aI(A.localStore,P.query,!1).then(({documents:S})=>P.view.ru(S,y)));const V=w&&w.targetChanges.get(P.targetId),U=w&&w.targetMismatches.get(P.targetId)!=null,$=P.view.applyChanges(y,A.isPrimaryClient,V,U);return yI(A,P.targetId,$.au),$.snapshot}(t,f,m,E);const s=await aI(t.localStore,e,!0),o=new jL(e,s.Qs),a=o.ru(s.documents),l=bc.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",i),u=o.applyChanges(a,t.isPrimaryClient,l);yI(t,n,u.au);const h=new LL(e,n,o);return t.Tu.set(e,h),t.Iu.has(n)?t.Iu.get(n).push(e):t.Iu.set(n,[e]),u.snapshot}async function zL(t,e,n){const r=ge(t),i=r.Tu.get(e),s=r.Iu.get(i.targetId);if(s.length>1)return r.Iu.set(i.targetId,s.filter(o=>!Lh(o,e))),void r.Tu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await Wm(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),n&&zy(r.remoteStore,i.targetId),Qm(r,i.targetId)}).catch(io)):(Qm(r,i.targetId),await Wm(r.localStore,i.targetId,!0))}async function qL(t,e){const n=ge(t),r=n.Tu.get(e),i=n.Iu.get(r.targetId);n.isPrimaryClient&&i.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),zy(n.remoteStore,r.targetId))}async function HL(t,e,n){const r=bC(t);try{const i=await function(o,a){const l=ge(o),u=Ne.now(),h=a.reduce((E,_)=>E.add(_.key),Te());let f,m;return l.persistence.runTransaction("Locally write mutations","readwrite",E=>{let _=Tn(),A=Te();return l.Ns.getEntries(E,h).next(P=>{_=P,_.forEach((v,w)=>{w.isValidDocument()||(A=A.add(v))})}).next(()=>l.localDocuments.getOverlayedDocuments(E,_)).next(P=>{f=P;const v=[];for(const w of a){const y=ij(w,f.get(w.key).overlayedDocument);y!=null&&v.push(new Xr(w.key,y,hA(y.value.mapValue),qt.exists(!0)))}return l.mutationQueue.addMutationBatch(E,u,v,a)}).next(P=>{m=P;const v=P.applyToLocalDocumentSet(f,A);return l.documentOverlayCache.saveOverlays(E,P.batchId,v)})}).then(()=>({batchId:m.batchId,changes:xA(f)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(o,a,l){let u=o.Vu[o.currentUser.toKey()];u||(u=new tt(we)),u=u.insert(a,l),o.Vu[o.currentUser.toKey()]=u}(r,i.batchId,n),await kc(r,i.changes),await Pc(r.remoteStore)}catch(i){const s=Gy(i,"Failed to persist write");n.reject(s)}}async function TC(t,e){const n=ge(t);try{const r=await iL(n.localStore,e);e.targetChanges.forEach((i,s)=>{const o=n.Au.get(s);o&&(ae(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?o.hu=!0:i.modifiedDocuments.size>0?ae(o.hu,14607):i.removedDocuments.size>0&&(ae(o.hu,42227),o.hu=!1))}),await kc(n,r,e)}catch(r){await io(r)}}function gI(t,e,n){const r=ge(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const i=[];r.Tu.forEach((s,o)=>{const a=o.view.va(e);a.snapshot&&i.push(a.snapshot)}),function(o,a){const l=ge(o);l.onlineState=a;let u=!1;l.queries.forEach((h,f)=>{for(const m of f.Sa)m.va(a)&&(u=!0)}),u&&Xy(l)}(r.eventManager,e),i.length&&r.Pu.H_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function WL(t,e,n){const r=ge(t);r.sharedClientState.updateQueryState(e,"rejected",n);const i=r.Au.get(e),s=i&&i.key;if(s){let o=new tt(X.comparator);o=o.insert(s,lt.newNoDocument(s,de.min()));const a=Te().add(s),l=new Bh(de.min(),new Map,new tt(we),o,a);await TC(r,l),r.du=r.du.remove(s),r.Au.delete(e),e_(r)}else await Wm(r.localStore,e,!1).then(()=>Qm(r,e,n)).catch(io)}async function KL(t,e){const n=ge(t),r=e.batch.batchId;try{const i=await rL(n.localStore,e);SC(n,r,null),xC(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await kc(n,i)}catch(i){await io(i)}}async function GL(t,e,n){const r=ge(t);try{const i=await function(o,a){const l=ge(o);return l.persistence.runTransaction("Reject batch","readwrite-primary",u=>{let h;return l.mutationQueue.lookupMutationBatch(u,a).next(f=>(ae(f!==null,37113),h=f.keys(),l.mutationQueue.removeMutationBatch(u,f))).next(()=>l.mutationQueue.performConsistencyCheck(u)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(u,h,a)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(u,h)).next(()=>l.localDocuments.getDocuments(u,h))})}(r.localStore,e);SC(r,e,n),xC(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await kc(r,i)}catch(i){await io(i)}}function xC(t,e){(t.mu.get(e)||[]).forEach(n=>{n.resolve()}),t.mu.delete(e)}function SC(t,e,n){const r=ge(t);let i=r.Vu[r.currentUser.toKey()];if(i){const s=i.get(e);s&&(n?s.reject(n):s.resolve(),i=i.remove(e)),r.Vu[r.currentUser.toKey()]=i}}function Qm(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Iu.get(e))t.Tu.delete(r),n&&t.Pu.yu(r,n);t.Iu.delete(e),t.isPrimaryClient&&t.Ru.jr(e).forEach(r=>{t.Ru.containsKey(r)||AC(t,r)})}function AC(t,e){t.Eu.delete(e.path.canonicalString());const n=t.du.get(e);n!==null&&(zy(t.remoteStore,n),t.du=t.du.remove(e),t.Au.delete(n),e_(t))}function yI(t,e,n){for(const r of n)r instanceof wC?(t.Ru.addReference(r.key,e),QL(t,r)):r instanceof EC?(W(Zy,"Document no longer in limbo: "+r.key),t.Ru.removeReference(r.key,e),t.Ru.containsKey(r.key)||AC(t,r.key)):se(19791,{wu:r})}function QL(t,e){const n=e.key,r=n.path.canonicalString();t.du.get(n)||t.Eu.has(r)||(W(Zy,"New document in limbo: "+n),t.Eu.add(r),e_(t))}function e_(t){for(;t.Eu.size>0&&t.du.size<t.maxConcurrentLimboResolutions;){const e=t.Eu.values().next().value;t.Eu.delete(e);const n=new X(Oe.fromString(e)),r=t.fu.next();t.Au.set(r,new ML(n)),t.du=t.du.insert(n,r),pC(t.remoteStore,new jr(Mn(Ac(n.path)),r,"TargetPurposeLimboResolution",jn.ce))}}async function kc(t,e,n){const r=ge(t),i=[],s=[],o=[];r.Tu.isEmpty()||(r.Tu.forEach((a,l)=>{o.push(r.pu(l,e,n).then(u=>{var h;if((u||n)&&r.isPrimaryClient){const f=u?!u.fromCache:(h=n==null?void 0:n.targetChanges.get(l.targetId))==null?void 0:h.current;r.sharedClientState.updateQueryState(l.targetId,f?"current":"not-current")}if(u){i.push(u);const f=By.As(l.targetId,u);s.push(f)}}))}),await Promise.all(o),r.Pu.H_(i),await async function(l,u){const h=ge(l);try{await h.persistence.runTransaction("notifyLocalViewChanges","readwrite",f=>O.forEach(u,m=>O.forEach(m.Es,E=>h.persistence.referenceDelegate.addReference(f,m.targetId,E)).next(()=>O.forEach(m.ds,E=>h.persistence.referenceDelegate.removeReference(f,m.targetId,E)))))}catch(f){if(!ns(f))throw f;W($y,"Failed to update sequence numbers: "+f)}for(const f of u){const m=f.targetId;if(!f.fromCache){const E=h.Ms.get(m),_=E.snapshotVersion,A=E.withLastLimboFreeSnapshotVersion(_);h.Ms=h.Ms.insert(m,A)}}}(r.localStore,s))}async function YL(t,e){const n=ge(t);if(!n.currentUser.isEqual(e)){W(Zy,"User change. New user:",e.toKey());const r=await cC(n.localStore,e);n.currentUser=e,function(s,o){s.mu.forEach(a=>{a.forEach(l=>{l.reject(new G(B.CANCELLED,o))})}),s.mu.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await kc(n,r.Ls)}}function XL(t,e){const n=ge(t),r=n.Au.get(e);if(r&&r.hu)return Te().add(r.key);{let i=Te();const s=n.Iu.get(e);if(!s)return i;for(const o of s){const a=n.Tu.get(o);i=i.unionWith(a.view.nu)}return i}}function CC(t){const e=ge(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=TC.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=XL.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=WL.bind(null,e),e.Pu.H_=VL.bind(null,e.eventManager),e.Pu.yu=OL.bind(null,e.eventManager),e}function bC(t){const e=ge(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=KL.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=GL.bind(null,e),e}class dc{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Hh(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,n){return null}Mu(e,n){return null}vu(e){return lC(this.persistence,new aC,e.initialUser,this.serializer)}Cu(e){return new Fy(qh.mi,this.serializer)}Du(e){return new dC}async terminate(){var e,n;(e=this.gcScheduler)==null||e.stop(),(n=this.indexBackfillerScheduler)==null||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}dc.provider={build:()=>new dc};class JL extends dc{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,n){ae(this.persistence.referenceDelegate instanceof Wd,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new nC(r,e.asyncQueue,n)}Cu(e){const n=this.cacheSizeBytes!==void 0?Bt.withCacheSize(this.cacheSizeBytes):Bt.DEFAULT;return new Fy(r=>Wd.mi(r,n),this.serializer)}}class ZL extends dc{constructor(e,n,r){super(),this.xu=e,this.cacheSizeBytes=n,this.forceOwnership=r,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.xu.initialize(this,e),await bC(this.xu.syncEngine),await Pc(this.xu.remoteStore),await this.persistence.Ji(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}vu(e){return lC(this.persistence,new aC,e.initialUser,this.serializer)}Fu(e,n){const r=this.persistence.referenceDelegate.garbageCollector;return new nC(r,e.asyncQueue,n)}Mu(e,n){const r=new nO(n,this.persistence);return new tO(e.asyncQueue,r)}Cu(e){const n=Zj(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?Bt.withCacheSize(this.cacheSizeBytes):Bt.DEFAULT;return new Uy(this.synchronizeTabs,n,e.clientId,r,e.asyncQueue,pL(),Ju(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Du(e){return new dC}}class Gd{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>gI(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=YL.bind(null,this.syncEngine),await kL(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new DL}()}createDatastore(e){const n=Hh(e.databaseInfo.databaseId),r=function(s){return new fL(s)}(e.databaseInfo);return function(s,o,a,l){return new _L(s,o,a,l)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,i,s,o,a){return new wL(r,i,s,o,a)}(this.localStore,this.datastore,e.asyncQueue,n=>gI(this.syncEngine,n,0),function(){return uI.v()?new uI:new cL}())}createSyncEngine(e,n){return function(i,s,o,a,l,u,h){const f=new FL(i,s,o,a,l,u);return h&&(f.gu=!0),f}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(i){const s=ge(i);W(Qs,"RemoteStore shutting down."),s.Ea.add(5),await Rc(s),s.Aa.shutdown(),s.Ra.set("Unknown")}(this.remoteStore),(e=this.datastore)==null||e.terminate(),(n=this.eventManager)==null||n.terminate()}}Gd.provider={build:()=>new Gd};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class t_{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Jt("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gi="FirestoreClient";class eM{constructor(e,n,r,i,s){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=i,this.user=Nt.UNAUTHENTICATED,this.clientId=yy.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(r,async o=>{W(Gi,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>(W(Gi,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Jn;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=Gy(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function cp(t,e){t.asyncQueue.verifyOperationInProgress(),W(Gi,"Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async i=>{r.isEqual(i)||(await cC(e.localStore,i),r=i)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function _I(t,e){t.asyncQueue.verifyOperationInProgress();const n=await tM(t);W(Gi,"Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>hI(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,i)=>hI(e.remoteStore,i)),t._onlineComponents=e}async function tM(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){W(Gi,"Using user provided OfflineComponentProvider");try{await cp(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(i){return i.name==="FirebaseError"?i.code===B.FAILED_PRECONDITION||i.code===B.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(n))throw n;Bs("Error using user provided cache. Falling back to memory cache: "+n),await cp(t,new dc)}}else W(Gi,"Using default OfflineComponentProvider"),await cp(t,new JL(void 0));return t._offlineComponents}async function n_(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(W(Gi,"Using user provided OnlineComponentProvider"),await _I(t,t._uninitializedComponentsProvider._online)):(W(Gi,"Using default OnlineComponentProvider"),await _I(t,new Gd))),t._onlineComponents}function nM(t){return n_(t).then(e=>e.syncEngine)}function rM(t){return n_(t).then(e=>e.datastore)}async function Qd(t){const e=await n_(t),n=e.eventManager;return n.onListen=UL.bind(null,e.syncEngine),n.onUnlisten=zL.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=BL.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=qL.bind(null,e.syncEngine),n}function iM(t,e,n={}){const r=new Jn;return t.asyncQueue.enqueueAndForget(async()=>function(s,o,a,l,u){const h=new t_({next:m=>{h.Nu(),o.enqueueAndForget(()=>Yy(s,f));const E=m.docs.has(a);!E&&m.fromCache?u.reject(new G(B.UNAVAILABLE,"Failed to get document because the client is offline.")):E&&m.fromCache&&l&&l.source==="server"?u.reject(new G(B.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):u.resolve(m)},error:m=>u.reject(m)}),f=new Jy(Ac(a.path),h,{includeMetadataChanges:!0,qa:!0});return Qy(s,f)}(await Qd(t),t.asyncQueue,e,n,r)),r.promise}function sM(t,e,n={}){const r=new Jn;return t.asyncQueue.enqueueAndForget(async()=>function(s,o,a,l,u){const h=new t_({next:m=>{h.Nu(),o.enqueueAndForget(()=>Yy(s,f)),m.fromCache&&l.source==="server"?u.reject(new G(B.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):u.resolve(m)},error:m=>u.reject(m)}),f=new Jy(a,h,{includeMetadataChanges:!0,qa:!0});return Qy(s,f)}(await Qd(t),t.asyncQueue,e,n,r)),r.promise}function oM(t,e,n){const r=new Jn;return t.asyncQueue.enqueueAndForget(async()=>{try{const i=await rM(t);r.resolve(async function(o,a,l){var A;const u=ge(o),{request:h,gt:f,parent:m}=vj(u.serializer,qO(a),l);u.connection.$o||delete h.parent;const E=(await u.Ho("RunAggregationQuery",u.serializer.databaseId,m,h,1)).filter(P=>!!P.result);ae(E.length===1,64727);const _=(A=E[0].result)==null?void 0:A.aggregateFields;return Object.keys(_).reduce((P,v)=>(P[f[v]]=_[v],P),{})}(i,e,n))}catch(i){r.reject(i)}}),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function RC(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vI=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PC="firestore.googleapis.com",wI=!0;class EI{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new G(B.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=PC,this.ssl=wI}else this.host=e.host,this.ssl=e.ssl??wI;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=JA;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<jj)throw new G(B.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}YV("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=RC(e.experimentalLongPollingOptions??{}),function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new G(B.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new G(B.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new G(B.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Kh{constructor(e,n,r,i){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new EI({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new G(B.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new G(B.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new EI(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new UV;switch(r.type){case"firstParty":return new qV(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new G(B.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=vI.get(n);r&&(W("ComponentProvider","Removing Datastore"),vI.delete(n),r.terminate())}(this),Promise.resolve()}}function aM(t,e,n,r={}){var u;t=Ht(t,Kh);const i=Zi(e),s=t._getSettings(),o={...s,emulatorOptions:t._getEmulatorOptions()},a=`${e}:${n}`;i&&(ny(`https://${a}`),ry("Firestore",!0)),s.host!==PC&&s.host!==a&&Bs("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const l={...s,host:a,ssl:i,emulatorOptions:r};if(!qr(l,o)&&(t._setSettings(l),r.mockUserToken)){let h,f;if(typeof r.mockUserToken=="string")h=r.mockUserToken,f=Nt.MOCK_USER;else{h=Ux(r.mockUserToken,(u=t._app)==null?void 0:u.options.projectId);const m=r.mockUserToken.sub||r.mockUserToken.user_id;if(!m)throw new G(B.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");f=new Nt(m)}t._authCredentials=new BV(new FS(h,f))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ir{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new ir(this.firestore,e,this._query)}}class ct{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Ui(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new ct(this.firestore,e,this._key)}toJSON(){return{type:ct._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,n,r){if(Tc(n,ct._jsonSchema))return new ct(e,r||null,new X(Oe.fromString(n.referencePath)))}}ct._jsonSchemaVersion="firestore/documentReference/1.0",ct._jsonSchema={type:yt("string",ct._jsonSchemaVersion),referencePath:yt("string")};class Ui extends ir{constructor(e,n,r){super(e,n,Ac(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new ct(this.firestore,null,new X(e))}withConverter(e){return new Ui(this.firestore,e,this._path)}}function Xe(t,e,...n){if(t=Le(t),BS("collection","path",e),t instanceof Kh){const r=Oe.fromString(e,...n);return dE(r),new Ui(t,null,r)}{if(!(t instanceof ct||t instanceof Ui))throw new G(B.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(Oe.fromString(e,...n));return dE(r),new Ui(t.firestore,null,r)}}function Xt(t,e,...n){if(t=Le(t),arguments.length===1&&(e=yy.newId()),BS("doc","path",e),t instanceof Kh){const r=Oe.fromString(e,...n);return uE(r),new ct(t,null,new X(r))}{if(!(t instanceof ct||t instanceof Ui))throw new G(B.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(Oe.fromString(e,...n));return uE(r),new ct(t.firestore,t instanceof Ui?t.converter:null,new X(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const II="AsyncQueue";class TI{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new hC(this,"async_queue_retry"),this._c=()=>{const r=Ju();r&&W(II,"Visibility state changed to "+r.visibilityState),this.M_.w_()},this.ac=e;const n=Ju();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const n=Ju();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});const n=new Jn;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Xu.push(e),this.lc()))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!ns(e))throw e;W(II,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){const n=this.ac.then(()=>(this.rc=!0,e().catch(r=>{throw this.nc=r,this.rc=!1,Jt("INTERNAL UNHANDLED ERROR: ",xI(r)),r}).then(r=>(this.rc=!1,r))));return this.ac=n,n}enqueueAfterDelay(e,n,r){this.uc(),this.oc.indexOf(e)>-1&&(n=0);const i=Ky.createAndSchedule(this,e,n,r,s=>this.hc(s));return this.tc.push(i),i}uc(){this.nc&&se(47125,{Pc:xI(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const n of this.tc)if(n.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.tc)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.Tc()})}dc(e){this.oc.push(e)}hc(e){const n=this.tc.indexOf(e);this.tc.splice(n,1)}}function xI(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function SI(t){return function(n,r){if(typeof n!="object"||n===null)return!1;const i=n;for(const s of r)if(s in i&&typeof i[s]=="function")return!0;return!1}(t,["next","error","complete"])}class nr extends Kh{constructor(e,n,r,i){super(e,n,r,i),this.type="firestore",this._queue=new TI,this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new TI(e),this._firestoreClient=void 0,await e}}}function kC(t,e){const n=typeof t=="object"?t:Th(),r=typeof t=="string"?t:Ld,i=es(n,"firestore").getImmediate({identifier:r});if(!i._initialized){const s=Lx("firestore");s&&aM(i,...s)}return i}function Nc(t){if(t._terminated)throw new G(B.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||NC(t),t._firestoreClient}function NC(t){var r,i,s;const e=t._freezeSettings(),n=function(a,l,u,h){return new NO(a,l,u,h.host,h.ssl,h.experimentalForceLongPolling,h.experimentalAutoDetectLongPolling,RC(h.experimentalLongPollingOptions),h.useFetchStreams,h.isUsingEmulator)}(t._databaseId,((r=t._app)==null?void 0:r.options.appId)||"",t._persistenceKey,e);t._componentsProvider||(i=e.localCache)!=null&&i._offlineComponentProvider&&((s=e.localCache)!=null&&s._onlineComponentProvider)&&(t._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),t._firestoreClient=new eM(t._authCredentials,t._appCheckCredentials,t._queue,n,t._componentsProvider&&function(a){const l=a==null?void 0:a._online.build();return{_offline:a==null?void 0:a._offline.build(l),_online:l}}(t._componentsProvider))}function lM(t,e){Bs("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const n=t._freezeSettings();return cM(t,Gd.provider,{build:r=>new ZL(r,n.cacheSizeBytes,e==null?void 0:e.forceOwnership)}),Promise.resolve()}function cM(t,e,n){if((t=Ht(t,nr))._firestoreClient||t._terminated)throw new G(B.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(t._componentsProvider||t._getSettings().localCache)throw new G(B.FAILED_PRECONDITION,"SDK cache is already specified.");t._componentsProvider={_online:e,_offline:n},NC(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uM{constructor(e="count",n){this._internalFieldPath=n,this.type="AggregateField",this.aggregateType=e}}class dM{constructor(e,n,r){this._userDataWriter=n,this._data=r,this.type="AggregateQuerySnapshot",this.query=e}data(){return this._userDataWriter.convertObjectMap(this._data)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vn{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Vn(_t.fromBase64String(e))}catch(n){throw new G(B.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new Vn(_t.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Vn._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Tc(e,Vn._jsonSchema))return Vn.fromBase64String(e.bytes)}}Vn._jsonSchemaVersion="firestore/bytes/1.0",Vn._jsonSchema={type:yt("string",Vn._jsonSchemaVersion),bytes:yt("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gh{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new G(B.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new rt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dc{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ir{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new G(B.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new G(B.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return we(this._lat,e._lat)||we(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Ir._jsonSchemaVersion}}static fromJSON(e){if(Tc(e,Ir._jsonSchema))return new Ir(e.latitude,e.longitude)}}Ir._jsonSchemaVersion="firestore/geoPoint/1.0",Ir._jsonSchema={type:yt("string",Ir._jsonSchemaVersion),latitude:yt("number"),longitude:yt("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tr{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,i){if(r.length!==i.length)return!1;for(let s=0;s<r.length;++s)if(r[s]!==i[s])return!1;return!0}(this._values,e._values)}toJSON(){return{type:Tr._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Tc(e,Tr._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(n=>typeof n=="number"))return new Tr(e.vectorValues);throw new G(B.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Tr._jsonSchemaVersion="firestore/vectorValue/1.0",Tr._jsonSchema={type:yt("string",Tr._jsonSchemaVersion),vectorValues:yt("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hM=/^__.*__$/;class fM{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new Xr(e,this.data,this.fieldMask,n,this.fieldTransforms):new Sa(e,this.data,n,this.fieldTransforms)}}class DC{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new Xr(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function VC(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw se(40011,{Ac:t})}}class Qh{constructor(e,n,r,i,s,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.Rc(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new Qh({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){var i;const n=(i=this.path)==null?void 0:i.child(e),r=this.Vc({path:n,fc:!1});return r.gc(e),r}yc(e){var i;const n=(i=this.path)==null?void 0:i.child(e),r=this.Vc({path:n,fc:!1});return r.Rc(),r}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return Yd(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(VC(this.Ac)&&hM.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class pM{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||Hh(e)}Cc(e,n,r,i=!1){return new Qh({Ac:e,methodName:n,Dc:r,path:rt.emptyPath(),fc:!1,bc:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Vc(t){const e=t._freezeSettings(),n=Hh(t._databaseId);return new pM(t._databaseId,!!e.ignoreUndefinedProperties,n)}function OC(t,e,n,r,i,s={}){const o=t.Cc(s.merge||s.mergeFields?2:0,e,n,i);s_("Data must be an object, but it was:",o,r);const a=LC(r,o);let l,u;if(s.merge)l=new un(o.fieldMask),u=o.fieldTransforms;else if(s.mergeFields){const h=[];for(const f of s.mergeFields){const m=Ym(e,f,n);if(!o.contains(m))throw new G(B.INVALID_ARGUMENT,`Field '${m}' is specified in your field mask but missing from your input data.`);FC(h,m)||h.push(m)}l=new un(h),u=o.fieldTransforms.filter(f=>l.covers(f.field))}else l=null,u=o.fieldTransforms;return new fM(new zt(a),l,u)}class Yh extends Dc{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Yh}}function mM(t,e,n){return new Qh({Ac:3,Dc:e.settings.Dc,methodName:t._methodName,fc:n},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class r_ extends Dc{_toFieldTransform(e){return new Ry(e.path,new ha)}isEqual(e){return e instanceof r_}}class i_ extends Dc{constructor(e,n){super(e),this.vc=n}_toFieldTransform(e){const n=mM(this,e,!0),r=this.vc.map(s=>Ca(s,n)),i=new Hs(r);return new Ry(e.path,i)}isEqual(e){return e instanceof i_&&qr(this.vc,e.vc)}}function gM(t,e,n,r){const i=t.Cc(1,e,n);s_("Data must be an object, but it was:",i,r);const s=[],o=zt.empty();rs(r,(l,u)=>{const h=o_(e,l,n);u=Le(u);const f=i.yc(h);if(u instanceof Yh)s.push(h);else{const m=Ca(u,f);m!=null&&(s.push(h),o.set(h,m))}});const a=new un(s);return new DC(o,a,i.fieldTransforms)}function yM(t,e,n,r,i,s){const o=t.Cc(1,e,n),a=[Ym(e,r,n)],l=[i];if(s.length%2!=0)throw new G(B.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let m=0;m<s.length;m+=2)a.push(Ym(e,s[m])),l.push(s[m+1]);const u=[],h=zt.empty();for(let m=a.length-1;m>=0;--m)if(!FC(u,a[m])){const E=a[m];let _=l[m];_=Le(_);const A=o.yc(E);if(_ instanceof Yh)u.push(E);else{const P=Ca(_,A);P!=null&&(u.push(E),h.set(E,P))}}const f=new un(u);return new DC(h,f,o.fieldTransforms)}function jC(t,e,n,r=!1){return Ca(n,t.Cc(r?4:3,e))}function Ca(t,e){if(MC(t=Le(t)))return s_("Unsupported field value:",e,t),LC(t,e);if(t instanceof Dc)return function(r,i){if(!VC(i.Ac))throw i.Sc(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Sc(`${r._methodName}() is not currently supported inside arrays`);const s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return function(r,i){const s=[];let o=0;for(const a of r){let l=Ca(a,i.wc(o));l==null&&(l={nullValue:"NULL_VALUE"}),s.push(l),o++}return{arrayValue:{values:s}}}(t,e)}return function(r,i){if((r=Le(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return JO(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const s=Ne.fromDate(r);return{timestampValue:pa(i.serializer,s)}}if(r instanceof Ne){const s=new Ne(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:pa(i.serializer,s)}}if(r instanceof Ir)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Vn)return{bytesValue:LA(i.serializer,r._byteString)};if(r instanceof ct){const s=i.databaseId,o=r.firestore._databaseId;if(!o.isEqual(s))throw i.Sc(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:Vy(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof Tr)return function(o,a){return{mapValue:{fields:{[xy]:{stringValue:Sy},[ca]:{arrayValue:{values:o.toArray().map(u=>{if(typeof u!="number")throw a.Sc("VectorValues must only contain numeric values.");return by(a.serializer,u)})}}}}}}(r,i);throw i.Sc(`Unsupported field value: ${bh(r)}`)}(t,e)}function LC(t,e){const n={};return rA(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):rs(t,(r,i)=>{const s=Ca(i,e.mc(r));s!=null&&(n[r]=s)}),{mapValue:{fields:n}}}function MC(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof Ne||t instanceof Ir||t instanceof Vn||t instanceof ct||t instanceof Dc||t instanceof Tr)}function s_(t,e,n){if(!MC(n)||!$S(n)){const r=bh(n);throw r==="an object"?e.Sc(t+" a custom object"):e.Sc(t+" "+r)}}function Ym(t,e,n){if((e=Le(e))instanceof Gh)return e._internalPath;if(typeof e=="string")return o_(t,e);throw Yd("Field path arguments must be of type string or ",t,!1,void 0,n)}const _M=new RegExp("[~\\*/\\[\\]]");function o_(t,e,n){if(e.search(_M)>=0)throw Yd(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new Gh(...e.split("."))._internalPath}catch{throw Yd(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function Yd(t,e,n,r,i){const s=r&&!r.isEmpty(),o=i!==void 0;let a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let l="";return(s||o)&&(l+=" (found",s&&(l+=` in field ${r}`),o&&(l+=` in document ${i}`),l+=")"),new G(B.INVALID_ARGUMENT,a+t+l)}function FC(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class a_{constructor(e,n,r,i,s){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new ct(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new vM(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(Xh("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class vM extends a_{data(){return super.data()}}function Xh(t,e){return typeof e=="string"?o_(t,e):e instanceof Gh?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function UC(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new G(B.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class l_{}class Oc extends l_{}function mt(t,e,...n){let r=[];e instanceof l_&&r.push(e),r=r.concat(n),function(s){const o=s.filter(l=>l instanceof c_).length,a=s.filter(l=>l instanceof Jh).length;if(o>1||o>0&&a>0)throw new G(B.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const i of r)t=i._apply(t);return t}class Jh extends Oc{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new Jh(e,n,r)}_apply(e){const n=this._parse(e);return $C(e._query,n),new ir(e.firestore,e.converter,Mm(e._query,n))}_parse(e){const n=Vc(e.firestore);return function(s,o,a,l,u,h,f){let m;if(u.isKeyField()){if(h==="array-contains"||h==="array-contains-any")throw new G(B.INVALID_ARGUMENT,`Invalid Query. You can't perform '${h}' queries on documentId().`);if(h==="in"||h==="not-in"){RI(f,h);const _=[];for(const A of f)_.push(bI(l,s,A));m={arrayValue:{values:_}}}else m=bI(l,s,f)}else h!=="in"&&h!=="not-in"&&h!=="array-contains-any"||RI(f,h),m=jC(a,o,f,h==="in"||h==="not-in");return be.create(u,h,m)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function It(t,e,n){const r=e,i=Xh("where",t);return Jh._create(i,r,n)}class c_ extends l_{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new c_(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:Me.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(i,s){let o=i;const a=s.getFlattenedFilters();for(const l of a)$C(o,l),o=Mm(o,l)}(e._query,n),new ir(e.firestore,e.converter,Mm(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class u_ extends Oc{constructor(e,n){super(),this._field=e,this._direction=n,this.type="orderBy"}static _create(e,n){return new u_(e,n)}_apply(e){const n=function(i,s,o){if(i.startAt!==null)throw new G(B.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new G(B.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new cc(s,o)}(e._query,this._field,this._direction);return new ir(e.firestore,e.converter,function(i,s){const o=i.explicitOrderBy.concat([s]);return new is(i.path,i.collectionGroup,o,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,n))}}function gr(t,e="asc"){const n=e,r=Xh("orderBy",t);return u_._create(r,n)}class d_ extends Oc{constructor(e,n,r){super(),this.type=e,this._limit=n,this._limitType=r}static _create(e,n,r){return new d_(e,n,r)}_apply(e){return new ir(e.firestore,e.converter,Ud(e._query,this._limit,this._limitType))}}function Go(t){return XV("limit",t),d_._create("limit",t,"F")}class Zh extends Oc{constructor(e,n,r){super(),this.type=e,this._docOrFields=n,this._inclusive=r}static _create(e,n,r){return new Zh(e,n,r)}_apply(e){const n=BC(e,this.type,this._docOrFields,this._inclusive);return new ir(e.firestore,e.converter,function(i,s){return new is(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,s,i.endAt)}(e._query,n))}}function AI(...t){return Zh._create("startAt",t,!0)}function wM(...t){return Zh._create("startAfter",t,!1)}class h_ extends Oc{constructor(e,n,r){super(),this.type=e,this._docOrFields=n,this._inclusive=r}static _create(e,n,r){return new h_(e,n,r)}_apply(e){const n=BC(e,this.type,this._docOrFields,this._inclusive);return new ir(e.firestore,e.converter,function(i,s){return new is(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,i.startAt,s)}(e._query,n))}}function CI(...t){return h_._create("endAt",t,!0)}function BC(t,e,n,r){if(n[0]=Le(n[0]),n[0]instanceof a_)return function(s,o,a,l,u){if(!l)throw new G(B.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${a}().`);const h=[];for(const f of Wo(s))if(f.field.isKeyField())h.push(zs(o,l.key));else{const m=l.data.field(f.field);if(Vh(m))throw new G(B.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+f.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(m===null){const E=f.field.canonicalString();throw new G(B.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${E}' (used as the orderBy) does not exist.`)}h.push(m)}return new Wi(h,u)}(t._query,t.firestore._databaseId,e,n[0]._document,r);{const i=Vc(t.firestore);return function(o,a,l,u,h,f){const m=o.explicitOrderBy;if(h.length>m.length)throw new G(B.INVALID_ARGUMENT,`Too many arguments provided to ${u}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const E=[];for(let _=0;_<h.length;_++){const A=h[_];if(m[_].field.isKeyField()){if(typeof A!="string")throw new G(B.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${u}(), but got a ${typeof A}`);if(!Cy(o)&&A.indexOf("/")!==-1)throw new G(B.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${u}() must be a plain document ID, but '${A}' contains a slash.`);const P=o.path.child(Oe.fromString(A));if(!X.isDocumentKey(P))throw new G(B.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${u}() must result in a valid document path, but '${P}' is not because it contains an odd number of segments.`);const v=new X(P);E.push(zs(a,v))}else{const P=jC(l,u,A);E.push(P)}}return new Wi(E,f)}(t._query,t.firestore._databaseId,i,e,n,r)}}function bI(t,e,n){if(typeof(n=Le(n))=="string"){if(n==="")throw new G(B.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Cy(e)&&n.indexOf("/")!==-1)throw new G(B.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(Oe.fromString(n));if(!X.isDocumentKey(r))throw new G(B.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return zs(t,new X(r))}if(n instanceof ct)return zs(t,n._key);throw new G(B.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${bh(n)}.`)}function RI(t,e){if(!Array.isArray(t)||t.length===0)throw new G(B.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function $C(t,e){const n=function(i,s){for(const o of i)for(const a of o.getFlattenedFilters())if(s.indexOf(a.op)>=0)return a.op;return null}(t.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new G(B.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new G(B.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class EM{convertValue(e,n="none"){switch(qi(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Je(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(Gr(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw se(62114,{value:e})}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return rs(e,(i,s)=>{r[i]=this.convertValue(s,n)}),r}convertVectorValue(e){var r,i,s;const n=(s=(i=(r=e.fields)==null?void 0:r[ca].arrayValue)==null?void 0:i.values)==null?void 0:s.map(o=>Je(o.doubleValue));return new Tr(n)}convertGeoPoint(e){return new Ir(Je(e.latitude),Je(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=Oh(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(oc(e));default:return null}}convertTimestamp(e){const n=Kr(e);return new Ne(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=Oe.fromString(e);ae(WA(r),9688,{name:e});const i=new $s(r.get(1),r.get(3)),s=new X(r.popFirst(5));return i.isEqual(n)||Jt(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zC(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}function IM(){return new uM("count")}class hl{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class ks extends a_{constructor(e,n,r,i,s,o){super(e,n,r,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new Zu(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(Xh("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new G(B.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,n={};return n.type=ks._jsonSchemaVersion,n.bundle="",n.bundleSource="DocumentSnapshot",n.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?n:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),n.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),n)}}ks._jsonSchemaVersion="firestore/documentSnapshot/1.0",ks._jsonSchema={type:yt("string",ks._jsonSchemaVersion),bundleSource:yt("string","DocumentSnapshot"),bundleName:yt("string"),bundle:yt("string")};class Zu extends ks{data(e={}){return super.data(e)}}class Ns{constructor(e,n,r,i){this._firestore=e,this._userDataWriter=n,this._snapshot=i,this.metadata=new hl(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new Zu(this._firestore,this._userDataWriter,r.key,r,new hl(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new G(B.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map(a=>{const l=new Zu(i._firestore,i._userDataWriter,a.doc.key,a.doc,new hl(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);return a.doc,{type:"added",doc:l,oldIndex:-1,newIndex:o++}})}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(a=>s||a.type!==3).map(a=>{const l=new Zu(i._firestore,i._userDataWriter,a.doc.key,a.doc,new hl(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);let u=-1,h=-1;return a.type!==0&&(u=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),h=o.indexOf(a.doc.key)),{type:TM(a.type),doc:l,oldIndex:u,newIndex:h}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new G(B.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Ns._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=yy.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const n=[],r=[],i=[];return this.docs.forEach(s=>{s._document!==null&&(n.push(s._document),r.push(this._userDataWriter.convertObjectMap(s._document.data.value.mapValue.fields,"previous")),i.push(s.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function TM(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return se(61501,{type:t})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xd(t){t=Ht(t,ct);const e=Ht(t.firestore,nr);return iM(Nc(e),t._key).then(n=>WC(e,t,n))}Ns._jsonSchemaVersion="firestore/querySnapshot/1.0",Ns._jsonSchema={type:yt("string",Ns._jsonSchemaVersion),bundleSource:yt("string","QuerySnapshot"),bundleName:yt("string"),bundle:yt("string")};class ef extends EM{constructor(e){super(),this.firestore=e}convertBytes(e){return new Vn(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new ct(this.firestore,null,n)}}function En(t){t=Ht(t,ir);const e=Ht(t.firestore,nr),n=Nc(e),r=new ef(e);return UC(t._query),sM(n,t._query).then(i=>new Ns(e,r,t,i))}function Jd(t,e,n){t=Ht(t,ct);const r=Ht(t.firestore,nr),i=zC(t.converter,e,n);return tf(r,[OC(Vc(r),"setDoc",t._key,i,t.converter!==null,n).toMutation(t._key,qt.none())])}function Zd(t,e,n,...r){t=Ht(t,ct);const i=Ht(t.firestore,nr),s=Vc(i);let o;return o=typeof(e=Le(e))=="string"||e instanceof Gh?yM(s,"updateDoc",t._key,e,n,r):gM(s,"updateDoc",t._key,e),tf(i,[o.toMutation(t._key,qt.exists(!0))])}function qC(t){return tf(Ht(t.firestore,nr),[new Uh(t._key,qt.none())])}function HC(t,e){const n=Ht(t.firestore,nr),r=Xt(t),i=zC(t.converter,e);return tf(n,[OC(Vc(t.firestore),"addDoc",r._key,i,t.converter!==null,{}).toMutation(r._key,qt.exists(!1))]).then(()=>r)}function Bi(t,...e){var l,u,h;t=Le(t);let n={includeMetadataChanges:!1,source:"default"},r=0;typeof e[r]!="object"||SI(e[r])||(n=e[r++]);const i={includeMetadataChanges:n.includeMetadataChanges,source:n.source};if(SI(e[r])){const f=e[r];e[r]=(l=f.next)==null?void 0:l.bind(f),e[r+1]=(u=f.error)==null?void 0:u.bind(f),e[r+2]=(h=f.complete)==null?void 0:h.bind(f)}let s,o,a;if(t instanceof ct)o=Ht(t.firestore,nr),a=Ac(t._key.path),s={next:f=>{e[r]&&e[r](WC(o,t,f))},error:e[r+1],complete:e[r+2]};else{const f=Ht(t,ir);o=Ht(f.firestore,nr),a=f._query;const m=new ef(o);s={next:E=>{e[r]&&e[r](new Ns(o,m,f,E))},error:e[r+1],complete:e[r+2]},UC(t._query)}return function(m,E,_,A){const P=new t_(A),v=new Jy(E,P,_);return m.asyncQueue.enqueueAndForget(async()=>Qy(await Qd(m),v)),()=>{P.Nu(),m.asyncQueue.enqueueAndForget(async()=>Yy(await Qd(m),v))}}(Nc(o),a,i,s)}function tf(t,e){return function(r,i){const s=new Jn;return r.asyncQueue.enqueueAndForget(async()=>HL(await nM(r),i,s)),s.promise}(Nc(t),e)}function WC(t,e,n){const r=n.docs.get(e._key),i=new ef(t);return new ks(t,i,e._key,r,new hl(n.hasPendingWrites,n.fromCache),e.converter)}function xM(t){return SM(t,{count:IM()})}function SM(t,e){const n=Ht(t.firestore,nr),r=Nc(n),i=PO(e,(s,o)=>new sj(o,s.aggregateType,s._internalFieldPath));return oM(r,t._query,i).then(s=>function(a,l,u){const h=new ef(a);return new dM(l,h,u)}(n,t,s))}function Pr(){return new r_("serverTimestamp")}function AM(...t){return new i_("arrayUnion",t)}(function(e,n=!0){(function(i){xa=i})(no),er(new $n("firestore",(r,{instanceIdentifier:i,options:s})=>{const o=r.getProvider("app").getImmediate(),a=new nr(new $V(r.getProvider("auth-internal")),new HV(o,r.getProvider("app-check-internal")),function(u,h){if(!Object.prototype.hasOwnProperty.apply(u.options,["projectId"]))throw new G(B.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new $s(u.options.projectId,h)}(o,i),o);return s={useFetchStreams:n,...s},a._setSettings(s),a},"PUBLIC").setMultipleInstances(!0)),pn(oE,aE,e),pn(oE,aE,"esm2020")})();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KC="firebasestorage.googleapis.com",GC="storageBucket",CM=2*60*1e3,bM=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dt extends zn{constructor(e,n,r=0){super(up(e),`Firebase Storage: ${n} (${up(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,dt.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return up(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var ut;(function(t){t.UNKNOWN="unknown",t.OBJECT_NOT_FOUND="object-not-found",t.BUCKET_NOT_FOUND="bucket-not-found",t.PROJECT_NOT_FOUND="project-not-found",t.QUOTA_EXCEEDED="quota-exceeded",t.UNAUTHENTICATED="unauthenticated",t.UNAUTHORIZED="unauthorized",t.UNAUTHORIZED_APP="unauthorized-app",t.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",t.INVALID_CHECKSUM="invalid-checksum",t.CANCELED="canceled",t.INVALID_EVENT_NAME="invalid-event-name",t.INVALID_URL="invalid-url",t.INVALID_DEFAULT_BUCKET="invalid-default-bucket",t.NO_DEFAULT_BUCKET="no-default-bucket",t.CANNOT_SLICE_BLOB="cannot-slice-blob",t.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",t.NO_DOWNLOAD_URL="no-download-url",t.INVALID_ARGUMENT="invalid-argument",t.INVALID_ARGUMENT_COUNT="invalid-argument-count",t.APP_DELETED="app-deleted",t.INVALID_ROOT_OPERATION="invalid-root-operation",t.INVALID_FORMAT="invalid-format",t.INTERNAL_ERROR="internal-error",t.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(ut||(ut={}));function up(t){return"storage/"+t}function f_(){const t="An unknown error occurred, please check the error payload for server response.";return new dt(ut.UNKNOWN,t)}function RM(t){return new dt(ut.OBJECT_NOT_FOUND,"Object '"+t+"' does not exist.")}function PM(t){return new dt(ut.QUOTA_EXCEEDED,"Quota for bucket '"+t+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function kM(){const t="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new dt(ut.UNAUTHENTICATED,t)}function NM(){return new dt(ut.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function DM(t){return new dt(ut.UNAUTHORIZED,"User does not have permission to access '"+t+"'.")}function VM(){return new dt(ut.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function OM(){return new dt(ut.CANCELED,"User canceled the upload/download.")}function jM(t){return new dt(ut.INVALID_URL,"Invalid URL '"+t+"'.")}function LM(t){return new dt(ut.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}function MM(){return new dt(ut.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+GC+"' property when initializing the app?")}function FM(){return new dt(ut.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function UM(){return new dt(ut.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function BM(t){return new dt(ut.UNSUPPORTED_ENVIRONMENT,`${t} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function Xm(t){return new dt(ut.INVALID_ARGUMENT,t)}function QC(){return new dt(ut.APP_DELETED,"The Firebase app was deleted.")}function $M(t){return new dt(ut.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function Nl(t,e){return new dt(ut.INVALID_FORMAT,"String does not match format '"+t+"': "+e)}function el(t){throw new dt(ut.INTERNAL_ERROR,"Internal error: "+t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zt{constructor(e,n){this.bucket=e,this.path_=n}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,n){let r;try{r=Zt.makeFromUrl(e,n)}catch{return new Zt(e,"")}if(r.path==="")return r;throw LM(e)}static makeFromUrl(e,n){let r=null;const i="([A-Za-z0-9.\\-_]+)";function s(V){V.path.charAt(V.path.length-1)==="/"&&(V.path_=V.path_.slice(0,-1))}const o="(/(.*))?$",a=new RegExp("^gs://"+i+o,"i"),l={bucket:1,path:3};function u(V){V.path_=decodeURIComponent(V.path)}const h="v[A-Za-z0-9_]+",f=n.replace(/[.]/g,"\\."),m="(/([^?#]*).*)?$",E=new RegExp(`^https?://${f}/${h}/b/${i}/o${m}`,"i"),_={bucket:1,path:3},A=n===KC?"(?:storage.googleapis.com|storage.cloud.google.com)":n,P="([^?#]*)",v=new RegExp(`^https?://${A}/${i}/${P}`,"i"),y=[{regex:a,indices:l,postModify:s},{regex:E,indices:_,postModify:u},{regex:v,indices:{bucket:1,path:2},postModify:u}];for(let V=0;V<y.length;V++){const U=y[V],$=U.regex.exec(e);if($){const S=$[U.indices.bucket];let I=$[U.indices.path];I||(I=""),r=new Zt(S,I),U.postModify(r);break}}if(r==null)throw jM(e);return r}}class zM{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qM(t,e,n){let r=1,i=null,s=null,o=!1,a=0;function l(){return a===2}let u=!1;function h(...P){u||(u=!0,e.apply(null,P))}function f(P){i=setTimeout(()=>{i=null,t(E,l())},P)}function m(){s&&clearTimeout(s)}function E(P,...v){if(u){m();return}if(P){m(),h.call(null,P,...v);return}if(l()||o){m(),h.call(null,P,...v);return}r<64&&(r*=2);let y;a===1?(a=2,y=0):y=(r+Math.random())*1e3,f(y)}let _=!1;function A(P){_||(_=!0,m(),!u&&(i!==null?(P||(a=2),clearTimeout(i),f(0)):P||(a=1)))}return f(0),s=setTimeout(()=>{o=!0,A(!0)},n),A}function HM(t){t(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function WM(t){return t!==void 0}function KM(t){return typeof t=="object"&&!Array.isArray(t)}function p_(t){return typeof t=="string"||t instanceof String}function PI(t){return m_()&&t instanceof Blob}function m_(){return typeof Blob<"u"}function Jm(t,e,n,r){if(r<e)throw Xm(`Invalid value for '${t}'. Expected ${e} or greater.`);if(r>n)throw Xm(`Invalid value for '${t}'. Expected ${n} or less.`)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jc(t,e,n){let r=e;return n==null&&(r=`https://${e}`),`${n}://${r}/v0${t}`}function YC(t){const e=encodeURIComponent;let n="?";for(const r in t)if(t.hasOwnProperty(r)){const i=e(r)+"="+e(t[r]);n=n+i+"&"}return n=n.slice(0,-1),n}var Ds;(function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"})(Ds||(Ds={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GM(t,e){const n=t>=500&&t<600,i=[408,429].indexOf(t)!==-1,s=e.indexOf(t)!==-1;return n||i||s}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QM{constructor(e,n,r,i,s,o,a,l,u,h,f,m=!0,E=!1){this.url_=e,this.method_=n,this.headers_=r,this.body_=i,this.successCodes_=s,this.additionalRetryCodes_=o,this.callback_=a,this.errorCallback_=l,this.timeout_=u,this.progressCallback_=h,this.connectionFactory_=f,this.retry=m,this.isUsingEmulator=E,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((_,A)=>{this.resolve_=_,this.reject_=A,this.start_()})}start_(){const e=(r,i)=>{if(i){r(!1,new wu(!1,null,!0));return}const s=this.connectionFactory_();this.pendingConnection_=s;const o=a=>{const l=a.loaded,u=a.lengthComputable?a.total:-1;this.progressCallback_!==null&&this.progressCallback_(l,u)};this.progressCallback_!==null&&s.addUploadProgressListener(o),s.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&s.removeUploadProgressListener(o),this.pendingConnection_=null;const a=s.getErrorCode()===Ds.NO_ERROR,l=s.getStatus();if(!a||GM(l,this.additionalRetryCodes_)&&this.retry){const h=s.getErrorCode()===Ds.ABORT;r(!1,new wu(!1,null,h));return}const u=this.successCodes_.indexOf(l)!==-1;r(!0,new wu(u,s))})},n=(r,i)=>{const s=this.resolve_,o=this.reject_,a=i.connection;if(i.wasSuccessCode)try{const l=this.callback_(a,a.getResponse());WM(l)?s(l):s()}catch(l){o(l)}else if(a!==null){const l=f_();l.serverResponse=a.getErrorText(),this.errorCallback_?o(this.errorCallback_(a,l)):o(l)}else if(i.canceled){const l=this.appDelete_?QC():OM();o(l)}else{const l=VM();o(l)}};this.canceled_?n(!1,new wu(!1,null,!0)):this.backoffId_=qM(e,n,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&HM(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class wu{constructor(e,n,r){this.wasSuccessCode=e,this.connection=n,this.canceled=!!r}}function YM(t,e){e!==null&&e.length>0&&(t.Authorization="Firebase "+e)}function XM(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function JM(t,e){e&&(t["X-Firebase-GMPID"]=e)}function ZM(t,e){e!==null&&(t["X-Firebase-AppCheck"]=e)}function eF(t,e,n,r,i,s,o=!0,a=!1){const l=YC(t.urlParams),u=t.url+l,h=Object.assign({},t.headers);return JM(h,e),YM(h,n),XM(h,s),ZM(h,r),new QM(u,t.method,h,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,i,o,a)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tF(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function nF(...t){const e=tF();if(e!==void 0){const n=new e;for(let r=0;r<t.length;r++)n.append(t[r]);return n.getBlob()}else{if(m_())return new Blob(t);throw new dt(ut.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function rF(t,e,n){return t.webkitSlice?t.webkitSlice(e,n):t.mozSlice?t.mozSlice(e,n):t.slice?t.slice(e,n):null}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iF(t){if(typeof atob>"u")throw BM("base-64");return atob(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yr={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class dp{constructor(e,n){this.data=e,this.contentType=n||null}}function sF(t,e){switch(t){case yr.RAW:return new dp(XC(e));case yr.BASE64:case yr.BASE64URL:return new dp(JC(t,e));case yr.DATA_URL:return new dp(aF(e),lF(e))}throw f_()}function XC(t){const e=[];for(let n=0;n<t.length;n++){let r=t.charCodeAt(n);if(r<=127)e.push(r);else if(r<=2047)e.push(192|r>>6,128|r&63);else if((r&64512)===55296)if(!(n<t.length-1&&(t.charCodeAt(n+1)&64512)===56320))e.push(239,191,189);else{const s=r,o=t.charCodeAt(++n);r=65536|(s&1023)<<10|o&1023,e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|r&63)}else(r&64512)===56320?e.push(239,191,189):e.push(224|r>>12,128|r>>6&63,128|r&63)}return new Uint8Array(e)}function oF(t){let e;try{e=decodeURIComponent(t)}catch{throw Nl(yr.DATA_URL,"Malformed data URL.")}return XC(e)}function JC(t,e){switch(t){case yr.BASE64:{const i=e.indexOf("-")!==-1,s=e.indexOf("_")!==-1;if(i||s)throw Nl(t,"Invalid character '"+(i?"-":"_")+"' found: is it base64url encoded?");break}case yr.BASE64URL:{const i=e.indexOf("+")!==-1,s=e.indexOf("/")!==-1;if(i||s)throw Nl(t,"Invalid character '"+(i?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let n;try{n=iF(e)}catch(i){throw i.message.includes("polyfill")?i:Nl(t,"Invalid character found")}const r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}class ZC{constructor(e){this.base64=!1,this.contentType=null;const n=e.match(/^data:([^,]+)?,/);if(n===null)throw Nl(yr.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const r=n[1]||null;r!=null&&(this.base64=cF(r,";base64"),this.contentType=this.base64?r.substring(0,r.length-7):r),this.rest=e.substring(e.indexOf(",")+1)}}function aF(t){const e=new ZC(t);return e.base64?JC(yr.BASE64,e.rest):oF(e.rest)}function lF(t){return new ZC(t).contentType}function cF(t,e){return t.length>=e.length?t.substring(t.length-e.length)===e:!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ti{constructor(e,n){let r=0,i="";PI(e)?(this.data_=e,r=e.size,i=e.type):e instanceof ArrayBuffer?(n?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),r=this.data_.length):e instanceof Uint8Array&&(n?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),r=e.length),this.size_=r,this.type_=i}size(){return this.size_}type(){return this.type_}slice(e,n){if(PI(this.data_)){const r=this.data_,i=rF(r,e,n);return i===null?null:new Ti(i)}else{const r=new Uint8Array(this.data_.buffer,e,n-e);return new Ti(r,!0)}}static getBlob(...e){if(m_()){const n=e.map(r=>r instanceof Ti?r.data_:r);return new Ti(nF.apply(null,n))}else{const n=e.map(o=>p_(o)?sF(yr.RAW,o).data:o.data_);let r=0;n.forEach(o=>{r+=o.byteLength});const i=new Uint8Array(r);let s=0;return n.forEach(o=>{for(let a=0;a<o.length;a++)i[s++]=o[a]}),new Ti(i,!0)}}uploadData(){return this.data_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function g_(t){let e;try{e=JSON.parse(t)}catch{return null}return KM(e)?e:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uF(t){if(t.length===0)return null;const e=t.lastIndexOf("/");return e===-1?"":t.slice(0,e)}function dF(t,e){const n=e.split("/").filter(r=>r.length>0).join("/");return t.length===0?n:t+"/"+n}function eb(t){const e=t.lastIndexOf("/",t.length-2);return e===-1?t:t.slice(e+1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hF(t,e){return e}class Qt{constructor(e,n,r,i){this.server=e,this.local=n||e,this.writable=!!r,this.xform=i||hF}}let Eu=null;function fF(t){return!p_(t)||t.length<2?t:eb(t)}function tb(){if(Eu)return Eu;const t=[];t.push(new Qt("bucket")),t.push(new Qt("generation")),t.push(new Qt("metageneration")),t.push(new Qt("name","fullPath",!0));function e(s,o){return fF(o)}const n=new Qt("name");n.xform=e,t.push(n);function r(s,o){return o!==void 0?Number(o):o}const i=new Qt("size");return i.xform=r,t.push(i),t.push(new Qt("timeCreated")),t.push(new Qt("updated")),t.push(new Qt("md5Hash",null,!0)),t.push(new Qt("cacheControl",null,!0)),t.push(new Qt("contentDisposition",null,!0)),t.push(new Qt("contentEncoding",null,!0)),t.push(new Qt("contentLanguage",null,!0)),t.push(new Qt("contentType",null,!0)),t.push(new Qt("metadata","customMetadata",!0)),Eu=t,Eu}function pF(t,e){function n(){const r=t.bucket,i=t.fullPath,s=new Zt(r,i);return e._makeStorageReference(s)}Object.defineProperty(t,"ref",{get:n})}function mF(t,e,n){const r={};r.type="file";const i=n.length;for(let s=0;s<i;s++){const o=n[s];r[o.local]=o.xform(r,e[o.server])}return pF(r,t),r}function nb(t,e,n){const r=g_(e);return r===null?null:mF(t,r,n)}function gF(t,e,n,r){const i=g_(e);if(i===null||!p_(i.downloadTokens))return null;const s=i.downloadTokens;if(s.length===0)return null;const o=encodeURIComponent;return s.split(",").map(u=>{const h=t.bucket,f=t.fullPath,m="/b/"+o(h)+"/o/"+o(f),E=jc(m,n,r),_=YC({alt:"media",token:u});return E+_})[0]}function yF(t,e){const n={},r=e.length;for(let i=0;i<r;i++){const s=e[i];s.writable&&(n[s.server]=t[s.local])}return JSON.stringify(n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kI="prefixes",NI="items";function _F(t,e,n){const r={prefixes:[],items:[],nextPageToken:n.nextPageToken};if(n[kI])for(const i of n[kI]){const s=i.replace(/\/$/,""),o=t._makeStorageReference(new Zt(e,s));r.prefixes.push(o)}if(n[NI])for(const i of n[NI]){const s=t._makeStorageReference(new Zt(e,i.name));r.items.push(s)}return r}function vF(t,e,n){const r=g_(n);return r===null?null:_F(t,e,r)}class nf{constructor(e,n,r,i){this.url=e,this.method=n,this.handler=r,this.timeout=i,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function y_(t){if(!t)throw f_()}function wF(t,e){function n(r,i){const s=nb(t,i,e);return y_(s!==null),s}return n}function EF(t,e){function n(r,i){const s=vF(t,e,i);return y_(s!==null),s}return n}function IF(t,e){function n(r,i){const s=nb(t,i,e);return y_(s!==null),gF(s,i,t.host,t._protocol)}return n}function __(t){function e(n,r){let i;return n.getStatus()===401?n.getErrorText().includes("Firebase App Check token is invalid")?i=NM():i=kM():n.getStatus()===402?i=PM(t.bucket):n.getStatus()===403?i=DM(t.path):i=r,i.status=n.getStatus(),i.serverResponse=r.serverResponse,i}return e}function rb(t){const e=__(t);function n(r,i){let s=e(r,i);return r.getStatus()===404&&(s=RM(t.path)),s.serverResponse=i.serverResponse,s}return n}function TF(t,e,n,r,i){const s={};e.isRoot?s.prefix="":s.prefix=e.path+"/",n.length>0&&(s.delimiter=n),r&&(s.pageToken=r),i&&(s.maxResults=i);const o=e.bucketOnlyServerUrl(),a=jc(o,t.host,t._protocol),l="GET",u=t.maxOperationRetryTime,h=new nf(a,l,EF(t,e.bucket),u);return h.urlParams=s,h.errorHandler=__(e),h}function xF(t,e,n){const r=e.fullServerUrl(),i=jc(r,t.host,t._protocol),s="GET",o=t.maxOperationRetryTime,a=new nf(i,s,IF(t,n),o);return a.errorHandler=rb(e),a}function SF(t,e){const n=e.fullServerUrl(),r=jc(n,t.host,t._protocol),i="DELETE",s=t.maxOperationRetryTime;function o(l,u){}const a=new nf(r,i,o,s);return a.successCodes=[200,204],a.errorHandler=rb(e),a}function AF(t,e){return t&&t.contentType||e&&e.type()||"application/octet-stream"}function CF(t,e,n){const r=Object.assign({},n);return r.fullPath=t.path,r.size=e.size(),r.contentType||(r.contentType=AF(null,e)),r}function bF(t,e,n,r,i){const s=e.bucketOnlyServerUrl(),o={"X-Goog-Upload-Protocol":"multipart"};function a(){let y="";for(let V=0;V<2;V++)y=y+Math.random().toString().slice(2);return y}const l=a();o["Content-Type"]="multipart/related; boundary="+l;const u=CF(e,r,i),h=yF(u,n),f="--"+l+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+h+`\r
--`+l+`\r
Content-Type: `+u.contentType+`\r
\r
`,m=`\r
--`+l+"--",E=Ti.getBlob(f,r,m);if(E===null)throw FM();const _={name:u.fullPath},A=jc(s,t.host,t._protocol),P="POST",v=t.maxUploadRetryTime,w=new nf(A,P,wF(t,n),v);return w.urlParams=_,w.headers=o,w.body=E.uploadData(),w.errorHandler=__(e),w}class RF{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=Ds.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=Ds.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=Ds.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,n,r,i,s){if(this.sent_)throw el("cannot .send() more than once");if(Zi(e)&&r&&(this.xhr_.withCredentials=!0),this.sent_=!0,this.xhr_.open(n,e,!0),s!==void 0)for(const o in s)s.hasOwnProperty(o)&&this.xhr_.setRequestHeader(o,s[o].toString());return i!==void 0?this.xhr_.send(i):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw el("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw el("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw el("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw el("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class PF extends RF{initXhr(){this.xhr_.responseType="text"}}function rf(){return new PF}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ys{constructor(e,n){this._service=e,n instanceof Zt?this._location=n:this._location=Zt.makeFromUrl(n,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,n){return new Ys(e,n)}get root(){const e=new Zt(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return eb(this._location.path)}get storage(){return this._service}get parent(){const e=uF(this._location.path);if(e===null)return null;const n=new Zt(this._location.bucket,e);return new Ys(this._service,n)}_throwIfRoot(e){if(this._location.path==="")throw $M(e)}}function kF(t,e,n){t._throwIfRoot("uploadBytes");const r=bF(t.storage,t._location,tb(),new Ti(e,!0),n);return t.storage.makeRequestWithTokens(r,rf).then(i=>({metadata:i,ref:t}))}function NF(t){const e={prefixes:[],items:[]};return ib(t,e).then(()=>e)}async function ib(t,e,n){const i=await DF(t,{pageToken:n});e.prefixes.push(...i.prefixes),e.items.push(...i.items),i.nextPageToken!=null&&await ib(t,e,i.nextPageToken)}function DF(t,e){e!=null&&typeof e.maxResults=="number"&&Jm("options.maxResults",1,1e3,e.maxResults);const n=e||{},r=TF(t.storage,t._location,"/",n.pageToken,n.maxResults);return t.storage.makeRequestWithTokens(r,rf)}function VF(t){t._throwIfRoot("getDownloadURL");const e=xF(t.storage,t._location,tb());return t.storage.makeRequestWithTokens(e,rf).then(n=>{if(n===null)throw UM();return n})}function OF(t){t._throwIfRoot("deleteObject");const e=SF(t.storage,t._location);return t.storage.makeRequestWithTokens(e,rf)}function jF(t,e){const n=dF(t._location.path,e),r=new Zt(t._location.bucket,n);return new Ys(t.storage,r)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function LF(t){return/^[A-Za-z]+:\/\//.test(t)}function MF(t,e){return new Ys(t,e)}function sb(t,e){if(t instanceof v_){const n=t;if(n._bucket==null)throw MM();const r=new Ys(n,n._bucket);return e!=null?sb(r,e):r}else return e!==void 0?jF(t,e):t}function FF(t,e){if(e&&LF(e)){if(t instanceof v_)return MF(t,e);throw Xm("To use ref(service, url), the first argument must be a Storage instance.")}else return sb(t,e)}function DI(t,e){const n=e==null?void 0:e[GC];return n==null?null:Zt.makeFromBucketSpec(n,t)}function UF(t,e,n,r={}){t.host=`${e}:${n}`;const i=Zi(e);i&&(ny(`https://${t.host}/b`),ry("Storage",!0)),t._isUsingEmulator=!0,t._protocol=i?"https":"http";const{mockUserToken:s}=r;s&&(t._overrideAuthToken=typeof s=="string"?s:Ux(s,t.app.options.projectId))}class v_{constructor(e,n,r,i,s,o=!1){this.app=e,this._authProvider=n,this._appCheckProvider=r,this._url=i,this._firebaseVersion=s,this._isUsingEmulator=o,this._bucket=null,this._host=KC,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=CM,this._maxUploadRetryTime=bM,this._requests=new Set,i!=null?this._bucket=Zt.makeFromBucketSpec(i,this._host):this._bucket=DI(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=Zt.makeFromBucketSpec(this._url,e):this._bucket=DI(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){Jm("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){Jm("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const n=await e.getToken();if(n!==null)return n.accessToken}return null}async _getAppCheckToken(){if(Dn(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Ys(this,e)}_makeRequest(e,n,r,i,s=!0){if(this._deleted)return new zM(QC());{const o=eF(e,this._appId,r,i,n,this._firebaseVersion,s,this._isUsingEmulator);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}async makeRequestWithTokens(e,n){const[r,i]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,n,r,i).getPromise()}}const VI="@firebase/storage",OI="0.14.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ob="storage";function jI(t,e,n){return t=Le(t),kF(t,e,n)}function LI(t){return t=Le(t),NF(t)}function MI(t){return t=Le(t),VF(t)}function hp(t){return t=Le(t),OF(t)}function tl(t,e){return t=Le(t),FF(t,e)}function ws(t=Th(),e){t=Le(t);const r=es(t,ob).getImmediate({identifier:e}),i=Lx("storage");return i&&BF(r,...i),r}function BF(t,e,n,r={}){UF(t,e,n,r)}function $F(t,{instanceIdentifier:e}){const n=t.getProvider("app").getImmediate(),r=t.getProvider("auth-internal"),i=t.getProvider("app-check-internal");return new v_(n,r,i,e,no)}function zF(){er(new $n(ob,$F,"PUBLIC").setMultipleInstances(!0)),pn(VI,OI,""),pn(VI,OI,"esm2020")}zF();const qF={apiKey:"AIzaSyC70mGCRrjE8iOap8iTHuid8HEuyadue8Y",authDomain:"odontocloud-d92ac.firebaseapp.com",projectId:"odontocloud-d92ac",storageBucket:"odontocloud-d92ac.firebasestorage.app",messagingSenderId:"267020714981",appId:"1:267020714981:web:a44416ea83aa1d1172650c",measurementId:"G-ZMCC5CFY0C"},w_=oy(qF),FI=kS(w_),UI=kC(w_);ws(w_);const HF="/odontocloud-react/assets/fondo.png",ab="/odontocloud-react/assets/logo.png",BI=(t,e)=>{const n={email:t,rol:e,timestamp:Date.now()};localStorage.setItem("odc_session",JSON.stringify(n))},fp=()=>{try{const t=JSON.parse(localStorage.getItem("odc_session"));return t&&Date.now()-t.timestamp<1e3*60*60*24?t:null}catch{return null}},WF=()=>{const t=Xg(),[e,n]=k.useState(""),[r,i]=k.useState(""),[s,o]=k.useState(""),[a,l]=k.useState(navigator.onLine);k.useEffect(()=>{const f=()=>l(!0),m=()=>l(!1);return window.addEventListener("online",f),window.addEventListener("offline",m),()=>{window.removeEventListener("online",f),window.removeEventListener("offline",m)}},[]);const u=f=>{const m=(f||"").toLowerCase();m==="administrador"?t("/dashboard_admin",{replace:!0}):m==="doctor"?t("/dashboard_doctor",{replace:!0}):m==="recepcionista"?t("/dashboard_recepcion",{replace:!0}):o("Rol no reconocido. Contacte al administrador.")};k.useEffect(()=>{if(!navigator.onLine){const m=fp();m!=null&&m.rol?u(m.rol):o("Sin conexin y no hay sesin guardada.");return}const f=fy(FI,async m=>{if(m){const E=fp();if(E!=null&&E.rol){u(E.rol);return}try{const _=mt(Xe(UI,"users"),It("correo","==",m.email||"")),A=await En(_);if(!A.empty){const P=A.docs[0].data().rol||"sin_rol";BI(m.email||"",P),u(P)}}catch{u("administrador")}}});return()=>f()},[]);const h=async f=>{if(f.preventDefault(),o(""),!a){const m=fp();m!=null&&m.rol?u(m.rol):o("Sin conexin y no hay sesin guardada.");return}try{const E=(await S2(FI,e,r)).user,_=mt(Xe(UI,"users"),It("correo","==",e)),A=await En(_);if(A.empty){o("Usuario no encontrado en la base de datos.");return}const v=A.docs[0].data().rol||"sin_rol";BI(e,v),u(v)}catch(m){switch(console.error("Error login:",m),m.code){case"auth/user-not-found":o("Usuario no registrado.");break;case"auth/wrong-password":o("Contrasea incorrecta.");break;case"auth/invalid-email":o("Correo no vlido.");break;case"auth/network-request-failed":o("Sin conexin. Usa la sesin guardada o reconecta.");break;default:o("Error al iniciar sesin.")}}};return d.jsx("div",{className:"login-root",style:{backgroundImage:`url(${HF})`,backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat",backgroundAttachment:"fixed",width:"100vw",height:"100vh",display:"flex",justifyContent:"center",alignItems:"center",overflow:"hidden"},children:d.jsxs("div",{className:"container",children:[d.jsxs("div",{className:"left-panel",children:[d.jsx("img",{src:ab,alt:"OdontoCloud Logo",className:"logo"}),d.jsxs("h2",{children:["Su clnica, ",d.jsx("br",{})," ms conectada."]}),d.jsx("p",{children:"OdontoCloud optimiza cada detalle de su gestin."})]}),d.jsxs("div",{className:"right-panel",children:[d.jsx("h3",{children:"Acceso a la plataforma"}),d.jsxs("form",{onSubmit:h,children:[d.jsx("input",{type:"email",placeholder:"usuario@ejemplo.com",value:e,onChange:f=>n(f.target.value),required:a}),d.jsx("input",{type:"password",placeholder:"Contrasea",value:r,onChange:f=>i(f.target.value),required:a}),d.jsx("button",{type:"submit",children:a?"Iniciar sesin":"Entrar (modo offline)"}),s&&d.jsx("p",{style:{color:"red",marginTop:10},children:s}),!a&&d.jsx("p",{style:{color:"orange",marginTop:10},children:" Modo offline activado"})]})]})]})})},lb="@firebase/installations",E_="0.6.19";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cb=1e4,ub=`w:${E_}`,db="FIS_v2",KF="https://firebaseinstallations.googleapis.com/v1",GF=60*60*1e3,QF="installations",YF="Installations";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XF={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},Xs=new to(QF,YF,XF);function hb(t){return t instanceof zn&&t.code.includes("request-failed")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fb({projectId:t}){return`${KF}/projects/${t}/installations`}function pb(t){return{token:t.token,requestStatus:2,expiresIn:ZF(t.expiresIn),creationTime:Date.now()}}async function mb(t,e){const r=(await e.json()).error;return Xs.create("request-failed",{requestName:t,serverCode:r.code,serverMessage:r.message,serverStatus:r.status})}function gb({apiKey:t}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t})}function JF(t,{refreshToken:e}){const n=gb(t);return n.append("Authorization",e4(e)),n}async function yb(t){const e=await t();return e.status>=500&&e.status<600?t():e}function ZF(t){return Number(t.replace("s","000"))}function e4(t){return`${db} ${t}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function t4({appConfig:t,heartbeatServiceProvider:e},{fid:n}){const r=fb(t),i=gb(t),s=e.getImmediate({optional:!0});if(s){const u=await s.getHeartbeatsHeader();u&&i.append("x-firebase-client",u)}const o={fid:n,authVersion:db,appId:t.appId,sdkVersion:ub},a={method:"POST",headers:i,body:JSON.stringify(o)},l=await yb(()=>fetch(r,a));if(l.ok){const u=await l.json();return{fid:u.fid||n,registrationStatus:2,refreshToken:u.refreshToken,authToken:pb(u.authToken)}}else throw await mb("Create Installation",l)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _b(t){return new Promise(e=>{setTimeout(e,t)})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function n4(t){return btoa(String.fromCharCode(...t)).replace(/\+/g,"-").replace(/\//g,"_")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const r4=/^[cdef][\w-]{21}$/,Zm="";function i4(){try{const t=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(t),t[0]=112+t[0]%16;const n=s4(t);return r4.test(n)?n:Zm}catch{return Zm}}function s4(t){return n4(t).substr(0,22)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sf(t){return`${t.appName}!${t.appId}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vb=new Map;function wb(t,e){const n=sf(t);Eb(n,e),o4(n,e)}function Eb(t,e){const n=vb.get(t);if(n)for(const r of n)r(e)}function o4(t,e){const n=a4();n&&n.postMessage({key:t,fid:e}),l4()}let Ss=null;function a4(){return!Ss&&"BroadcastChannel"in self&&(Ss=new BroadcastChannel("[Firebase] FID Change"),Ss.onmessage=t=>{Eb(t.data.key,t.data.fid)}),Ss}function l4(){vb.size===0&&Ss&&(Ss.close(),Ss=null)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const c4="firebase-installations-database",u4=1,Js="firebase-installations-store";let pp=null;function I_(){return pp||(pp=Gx(c4,u4,{upgrade:(t,e)=>{switch(e){case 0:t.createObjectStore(Js)}}})),pp}async function eh(t,e){const n=sf(t),i=(await I_()).transaction(Js,"readwrite"),s=i.objectStore(Js),o=await s.get(n);return await s.put(e,n),await i.done,(!o||o.fid!==e.fid)&&wb(t,e.fid),e}async function Ib(t){const e=sf(t),r=(await I_()).transaction(Js,"readwrite");await r.objectStore(Js).delete(e),await r.done}async function of(t,e){const n=sf(t),i=(await I_()).transaction(Js,"readwrite"),s=i.objectStore(Js),o=await s.get(n),a=e(o);return a===void 0?await s.delete(n):await s.put(a,n),await i.done,a&&(!o||o.fid!==a.fid)&&wb(t,a.fid),a}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function T_(t){let e;const n=await of(t.appConfig,r=>{const i=d4(r),s=h4(t,i);return e=s.registrationPromise,s.installationEntry});return n.fid===Zm?{installationEntry:await e}:{installationEntry:n,registrationPromise:e}}function d4(t){const e=t||{fid:i4(),registrationStatus:0};return Tb(e)}function h4(t,e){if(e.registrationStatus===0){if(!navigator.onLine){const i=Promise.reject(Xs.create("app-offline"));return{installationEntry:e,registrationPromise:i}}const n={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},r=f4(t,n);return{installationEntry:n,registrationPromise:r}}else return e.registrationStatus===1?{installationEntry:e,registrationPromise:p4(t)}:{installationEntry:e}}async function f4(t,e){try{const n=await t4(t,e);return eh(t.appConfig,n)}catch(n){throw hb(n)&&n.customData.serverCode===409?await Ib(t.appConfig):await eh(t.appConfig,{fid:e.fid,registrationStatus:0}),n}}async function p4(t){let e=await $I(t.appConfig);for(;e.registrationStatus===1;)await _b(100),e=await $I(t.appConfig);if(e.registrationStatus===0){const{installationEntry:n,registrationPromise:r}=await T_(t);return r||n}return e}function $I(t){return of(t,e=>{if(!e)throw Xs.create("installation-not-found");return Tb(e)})}function Tb(t){return m4(t)?{fid:t.fid,registrationStatus:0}:t}function m4(t){return t.registrationStatus===1&&t.registrationTime+cb<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function g4({appConfig:t,heartbeatServiceProvider:e},n){const r=y4(t,n),i=JF(t,n),s=e.getImmediate({optional:!0});if(s){const u=await s.getHeartbeatsHeader();u&&i.append("x-firebase-client",u)}const o={installation:{sdkVersion:ub,appId:t.appId}},a={method:"POST",headers:i,body:JSON.stringify(o)},l=await yb(()=>fetch(r,a));if(l.ok){const u=await l.json();return pb(u)}else throw await mb("Generate Auth Token",l)}function y4(t,{fid:e}){return`${fb(t)}/${e}/authTokens:generate`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function x_(t,e=!1){let n;const r=await of(t.appConfig,s=>{if(!xb(s))throw Xs.create("not-registered");const o=s.authToken;if(!e&&w4(o))return s;if(o.requestStatus===1)return n=_4(t,e),s;{if(!navigator.onLine)throw Xs.create("app-offline");const a=I4(s);return n=v4(t,a),a}});return n?await n:r.authToken}async function _4(t,e){let n=await zI(t.appConfig);for(;n.authToken.requestStatus===1;)await _b(100),n=await zI(t.appConfig);const r=n.authToken;return r.requestStatus===0?x_(t,e):r}function zI(t){return of(t,e=>{if(!xb(e))throw Xs.create("not-registered");const n=e.authToken;return T4(n)?{...e,authToken:{requestStatus:0}}:e})}async function v4(t,e){try{const n=await g4(t,e),r={...e,authToken:n};return await eh(t.appConfig,r),n}catch(n){if(hb(n)&&(n.customData.serverCode===401||n.customData.serverCode===404))await Ib(t.appConfig);else{const r={...e,authToken:{requestStatus:0}};await eh(t.appConfig,r)}throw n}}function xb(t){return t!==void 0&&t.registrationStatus===2}function w4(t){return t.requestStatus===2&&!E4(t)}function E4(t){const e=Date.now();return e<t.creationTime||t.creationTime+t.expiresIn<e+GF}function I4(t){const e={requestStatus:1,requestTime:Date.now()};return{...t,authToken:e}}function T4(t){return t.requestStatus===1&&t.requestTime+cb<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function x4(t){const e=t,{installationEntry:n,registrationPromise:r}=await T_(e);return r?r.catch(console.error):x_(e).catch(console.error),n.fid}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function S4(t,e=!1){const n=t;return await A4(n),(await x_(n,e)).token}async function A4(t){const{registrationPromise:e}=await T_(t);e&&await e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function C4(t){if(!t||!t.options)throw mp("App Configuration");if(!t.name)throw mp("App Name");const e=["projectId","apiKey","appId"];for(const n of e)if(!t.options[n])throw mp(n);return{appName:t.name,projectId:t.options.projectId,apiKey:t.options.apiKey,appId:t.options.appId}}function mp(t){return Xs.create("missing-app-config-values",{valueName:t})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sb="installations",b4="installations-internal",R4=t=>{const e=t.getProvider("app").getImmediate(),n=C4(e),r=es(e,"heartbeat");return{app:e,appConfig:n,heartbeatServiceProvider:r,_delete:()=>Promise.resolve()}},P4=t=>{const e=t.getProvider("app").getImmediate(),n=es(e,Sb).getImmediate();return{getId:()=>x4(n),getToken:i=>S4(n,i)}};function k4(){er(new $n(Sb,R4,"PUBLIC")),er(new $n(b4,P4,"PRIVATE"))}k4();pn(lb,E_);pn(lb,E_,"esm2020");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const th="analytics",N4="firebase_id",D4="origin",V4=60*1e3,O4="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",S_="https://www.googletagmanager.com/gtag/js";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nn=new Ih("@firebase/analytics");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const j4={"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-initialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."},Sn=new to("analytics","Analytics",j4);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function L4(t){if(!t.startsWith(S_)){const e=Sn.create("invalid-gtag-resource",{gtagURL:t});return nn.warn(e.message),""}return t}function Ab(t){return Promise.all(t.map(e=>e.catch(n=>n)))}function M4(t,e){let n;return window.trustedTypes&&(n=window.trustedTypes.createPolicy(t,e)),n}function F4(t,e){const n=M4("firebase-js-sdk-policy",{createScriptURL:L4}),r=document.createElement("script"),i=`${S_}?l=${t}&id=${e}`;r.src=n?n==null?void 0:n.createScriptURL(i):i,r.async=!0,document.head.appendChild(r)}function U4(t){let e=[];return Array.isArray(window[t])?e=window[t]:window[t]=e,e}async function B4(t,e,n,r,i,s){const o=r[i];try{if(o)await e[o];else{const l=(await Ab(n)).find(u=>u.measurementId===i);l&&await e[l.appId]}}catch(a){nn.error(a)}t("config",i,s)}async function $4(t,e,n,r,i){try{let s=[];if(i&&i.send_to){let o=i.send_to;Array.isArray(o)||(o=[o]);const a=await Ab(n);for(const l of o){const u=a.find(f=>f.measurementId===l),h=u&&e[u.appId];if(h)s.push(h);else{s=[];break}}}s.length===0&&(s=Object.values(e)),await Promise.all(s),t("event",r,i||{})}catch(s){nn.error(s)}}function z4(t,e,n,r){async function i(s,...o){try{if(s==="event"){const[a,l]=o;await $4(t,e,n,a,l)}else if(s==="config"){const[a,l]=o;await B4(t,e,n,r,a,l)}else if(s==="consent"){const[a,l]=o;t("consent",a,l)}else if(s==="get"){const[a,l,u]=o;t("get",a,l,u)}else if(s==="set"){const[a]=o;t("set",a)}else t(s,...o)}catch(a){nn.error(a)}}return i}function q4(t,e,n,r,i){let s=function(...o){window[r].push(arguments)};return window[i]&&typeof window[i]=="function"&&(s=window[i]),window[i]=z4(s,t,e,n),{gtagCore:s,wrappedGtag:window[i]}}function H4(t){const e=window.document.getElementsByTagName("script");for(const n of Object.values(e))if(n.src&&n.src.includes(S_)&&n.src.includes(t))return n;return null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const W4=30,K4=1e3;class G4{constructor(e={},n=K4){this.throttleMetadata=e,this.intervalMillis=n}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,n){this.throttleMetadata[e]=n}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}}const Cb=new G4;function Q4(t){return new Headers({Accept:"application/json","x-goog-api-key":t})}async function Y4(t){var o;const{appId:e,apiKey:n}=t,r={method:"GET",headers:Q4(n)},i=O4.replace("{app-id}",e),s=await fetch(i,r);if(s.status!==200&&s.status!==304){let a="";try{const l=await s.json();(o=l.error)!=null&&o.message&&(a=l.error.message)}catch{}throw Sn.create("config-fetch-failed",{httpStatus:s.status,responseMessage:a})}return s.json()}async function X4(t,e=Cb,n){const{appId:r,apiKey:i,measurementId:s}=t.options;if(!r)throw Sn.create("no-app-id");if(!i){if(s)return{measurementId:s,appId:r};throw Sn.create("no-api-key")}const o=e.getThrottleMetadata(r)||{backoffCount:0,throttleEndTimeMillis:Date.now()},a=new eU;return setTimeout(async()=>{a.abort()},V4),bb({appId:r,apiKey:i,measurementId:s},o,a,e)}async function bb(t,{throttleEndTimeMillis:e,backoffCount:n},r,i=Cb){var a;const{appId:s,measurementId:o}=t;try{await J4(r,e)}catch(l){if(o)return nn.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${o} provided in the "measurementId" field in the local Firebase config. [${l==null?void 0:l.message}]`),{appId:s,measurementId:o};throw l}try{const l=await Y4(t);return i.deleteThrottleMetadata(s),l}catch(l){const u=l;if(!Z4(u)){if(i.deleteThrottleMetadata(s),o)return nn.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${o} provided in the "measurementId" field in the local Firebase config. [${u==null?void 0:u.message}]`),{appId:s,measurementId:o};throw l}const h=Number((a=u==null?void 0:u.customData)==null?void 0:a.httpStatus)===503?Pw(n,i.intervalMillis,W4):Pw(n,i.intervalMillis),f={throttleEndTimeMillis:Date.now()+h,backoffCount:n+1};return i.setThrottleMetadata(s,f),nn.debug(`Calling attemptFetch again in ${h} millis`),bb(t,f,r,i)}}function J4(t,e){return new Promise((n,r)=>{const i=Math.max(e-Date.now(),0),s=setTimeout(n,i);t.addEventListener(()=>{clearTimeout(s),r(Sn.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}function Z4(t){if(!(t instanceof zn)||!t.customData)return!1;const e=Number(t.customData.httpStatus);return e===429||e===500||e===503||e===504}class eU{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach(e=>e())}}async function tU(t,e,n,r,i){if(i&&i.global){t("event",n,r);return}else{const s=await e,o={...r,send_to:s};t("event",n,o)}}async function nU(t,e,n,r){if(r&&r.global){const i={};for(const s of Object.keys(n))i[`user_properties.${s}`]=n[s];return t("set",i),Promise.resolve()}else{const i=await e;t("config",i,{update:!0,user_properties:n})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function rU(){if(iy())try{await Hx()}catch(t){return nn.warn(Sn.create("indexeddb-unavailable",{errorInfo:t==null?void 0:t.toString()}).message),!1}else return nn.warn(Sn.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;return!0}async function iU(t,e,n,r,i,s,o){const a=X4(t);a.then(m=>{n[m.measurementId]=m.appId,t.options.measurementId&&m.measurementId!==t.options.measurementId&&nn.warn(`The measurement ID in the local Firebase config (${t.options.measurementId}) does not match the measurement ID fetched from the server (${m.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(m=>nn.error(m)),e.push(a);const l=rU().then(m=>{if(m)return r.getId()}),[u,h]=await Promise.all([a,l]);H4(s)||F4(s,u.measurementId),i("js",new Date);const f=(o==null?void 0:o.config)??{};return f[D4]="firebase",f.update=!0,h!=null&&(f[N4]=h),i("config",u.measurementId,f),u.measurementId}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sU{constructor(e){this.app=e}_delete(){return delete Qo[this.app.options.appId],Promise.resolve()}}let Qo={},qI=[];const HI={};let gp="dataLayer",oU="gtag",WI,A_,KI=!1;function aU(){const t=[];if($x()&&t.push("This is a browser extension environment."),aN()||t.push("Cookies are not available."),t.length>0){const e=t.map((r,i)=>`(${i+1}) ${r}`).join(" "),n=Sn.create("invalid-analytics-context",{errorInfo:e});nn.warn(n.message)}}function lU(t,e,n){aU();const r=t.options.appId;if(!r)throw Sn.create("no-app-id");if(!t.options.apiKey)if(t.options.measurementId)nn.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${t.options.measurementId} provided in the "measurementId" field in the local Firebase config.`);else throw Sn.create("no-api-key");if(Qo[r]!=null)throw Sn.create("already-exists",{id:r});if(!KI){U4(gp);const{wrappedGtag:s,gtagCore:o}=q4(Qo,qI,HI,gp,oU);A_=s,WI=o,KI=!0}return Qo[r]=iU(t,qI,HI,e,WI,gp,n),new sU(t)}function cU(t=Th()){t=Le(t);const e=es(t,th);return e.isInitialized()?e.getImmediate():uU(t)}function uU(t,e={}){const n=es(t,th);if(n.isInitialized()){const i=n.getImmediate();if(qr(e,n.getOptions()))return i;throw Sn.create("already-initialized")}return n.initialize({options:e})}function dU(t,e,n){t=Le(t),nU(A_,Qo[t.app.options.appId],e,n).catch(r=>nn.error(r))}function hU(t,e,n,r){t=Le(t),tU(A_,Qo[t.app.options.appId],e,n,r).catch(i=>nn.error(i))}const GI="@firebase/analytics",QI="0.10.19";function fU(){er(new $n(th,(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),i=e.getProvider("installations-internal").getImmediate();return lU(r,i,n)},"PUBLIC")),er(new $n("analytics-internal",t,"PRIVATE")),pn(GI,QI),pn(GI,QI,"esm2020");function t(e){try{const n=e.getProvider(th).getImmediate();return{logEvent:(r,i,s)=>hU(n,r,i,s),setUserProperties:(r,i)=>dU(n,r,i)}}catch(n){throw Sn.create("interop-component-reg-failed",{reason:n})}}}fU();const pU={apiKey:"AIzaSyC70mGCRrjE8iOap8iTHuid8HEuyadue8Y",authDomain:"odontocloud-d92ac.firebaseapp.com",projectId:"odontocloud-d92ac",storageBucket:"odontocloud-d92ac.firebasestorage.app",messagingSenderId:"267020714981",appId:"1:267020714981:web:a44416ea83aa1d1172650c",measurementId:"G-ZMCC5CFY0C"},af=oy(pU),nh=kS(af),Se=kC(af);ws(af);cU(af);const yp="TU EMPRESA S.A.S.",mU="Generado por OdontoCloud",Iu=()=>{const t=new Date;return t.setHours(0,0,0,0),t},us=t=>{const e=new Date(t);return e.setHours(0,0,0,0),e},_p=t=>{const e=new Date(t);return e.setHours(23,59,59,999),e},ur=(t,e)=>{const n=new Date(t);return n.setDate(n.getDate()+e),n},YI=t=>{const e=new Date(t),n=e.getDay(),r=(n===0?-6:1)-n;return e.setDate(e.getDate()+r),e.setHours(0,0,0,0),e},XI=(t,e)=>t.getFullYear()===e.getFullYear()&&t.getMonth()===e.getMonth()&&t.getDate()===e.getDate();var nT;const an=typeof navigator<"u"&&((nT=navigator.language)!=null&&nT.startsWith("es"))?"es-ES":"en-US",vp=t=>{const e=t.getFullYear(),n=String(t.getMonth()+1).padStart(2,"0"),r=String(t.getDate()).padStart(2,"0");return`${e}-${n}-${r}`},yo=t=>(t||"").toString().toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/\s+/g," ").trim();function gU(){const[t,e]=k.useState("day"),[n,r]=k.useState(Iu()),[i,s]=k.useState(Iu()),[o,a]=k.useState(!0),[l,u]=k.useState([]),[h,f]=k.useState(""),[m,E]=k.useState(""),[_,A]=k.useState("");k.useEffect(()=>{a(!0);const L=Xe(Se,"citas"),z=mt(L,gr("fecha","asc")),re=Bi(z,ye=>{const pe=ye.docs.map(me=>{const Z=me.data(),xe=Z.horaInicio||Z.hora||"00:00",[vt="0",Pt="0"]=xe.split(":"),ee=parseInt(vt,10)||0,te=parseInt(Pt,10)||0;let ue;if(Z.fecha&&Z.fecha.toDate)ue=Z.fecha.toDate(),ue.setHours(ee,te,0,0);else if(typeof Z.fecha=="string"){const[M,q,oe]=Z.fecha.split("-");ue=new Date(parseInt(M,10),parseInt(q,10)-1,parseInt(oe,10),ee,te,0,0)}else Z.fecha instanceof Date?(ue=new Date(Z.fecha),ue.setHours(ee,te,0,0)):(ue=new Date,ue.setHours(ee,te,0,0));const ne=Z.documentoPaciente||Z.docPaciente||Z.pacienteDocumento||Z.documento||"",T=Z.celularPaciente||Z.telefonoPaciente||Z.celular||Z.telefono||"";return{id:me.id,raw:Z,fecha:ue,horaInicio:xe,paciente:Z.paciente||Z.pacienteNombre||"Sin nombre",doctor:Z.doctor||Z.doctorNombre||"",sucursal:Z.sucursal||"",espacio:Z.espacio||Z.consultorio||"",comentario:Z.comentario||"",estado:Z.estado||"En espera",recordatorio:Z.recordatorio||"",documento:ne,telefono:T}});let Pe,_e;if(t==="day")Pe=us(n),_e=_p(n);else if(t==="week"){const me=YI(n),Z=ur(me,6);Pe=us(me),_e=_p(Z)}else{const me=us(n),Z=ur(me,-30),xe=ur(me,60);Pe=us(Z),_e=_p(xe)}const $e=pe.filter(me=>me.fecha>=Pe&&me.fecha<=_e);u($e),a(!1)},ye=>{console.error("Error leyendo citas:",ye),u([]),a(!1)});return()=>re()},[t,n]);const P=k.useMemo(()=>{const L=new Set;return l.forEach(z=>z.sucursal&&L.add(z.sucursal)),Array.from(L)},[l]),v=k.useMemo(()=>{const L=new Set;return l.forEach(z=>z.doctor&&L.add(z.doctor)),Array.from(L)},[l]),w=k.useMemo(()=>{const L=_.trim().toLowerCase();return l.filter(z=>{if(h&&z.sucursal!==h||m&&z.doctor!==m)return!1;if(!L)return!0;const re=[z.paciente,z.doctor,z.comentario,z.documento,z.sucursal,z.espacio,z.estado],ye=z.raw?JSON.stringify(z.raw):"";return[...re,ye].filter(Boolean).some(Pe=>String(Pe).toLowerCase().includes(L))})},[l,h,m,_]),y=k.useMemo(()=>o?"Ocupacin: cargando...":w.length===0?"Ocupacin: sin citas para el rango seleccionado.":`Ocupacin: ${w.length} cita${w.length!==1?"s":""} en el rango actual.`,[w,o]),V=k.useMemo(()=>{const L=new Date(i.getFullYear(),i.getMonth(),1),z=(L.getDay()+6)%7,re=new Date(L);re.setDate(re.getDate()-z);const ye=[];for(let pe=0;pe<6;pe++){const Pe=[];for(let _e=0;_e<7;_e++){const $e=new Date(re),me=$e.getMonth()===i.getMonth(),Z=XI($e,Iu()),xe=XI($e,n);Pe.push({date:$e,isCurrentMonth:me,isToday:Z,isSelected:xe}),re.setDate(re.getDate()+1)}ye.push(Pe)}return ye},[i,n]),U=()=>{const L=new Date(i);L.setMonth(L.getMonth()-1),s(L)},$=()=>{const L=new Date(i);L.setMonth(L.getMonth()+1),s(L)},S=L=>{r(us(L)),s(us(L)),e("day")},I=k.useMemo(()=>i.toLocaleDateString(an,{month:"long",year:"numeric"}),[i]),C=k.useMemo(()=>{if(t==="day")return n.toLocaleDateString(an,{weekday:"long",day:"2-digit",month:"long",year:"numeric"});if(t==="week"){const L=YI(n),z=ur(L,6);return L.toLocaleDateString(an,{day:"2-digit",month:"short"})+" - "+z.toLocaleDateString(an,{day:"2-digit",month:"short",year:"numeric"})}return"ltimas citas (detalle)"},[t,n]),R=()=>{r(t==="day"?ur(n,-1):t==="week"?ur(n,-7):ur(n,-1))},N=()=>{r(t==="day"?ur(n,1):t==="week"?ur(n,7):ur(n,1))},D=()=>{const L=Iu();r(L),s(L),e("day")},b=()=>{var vt,Pt,ee;const L=te=>String(te??"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),z=((vt=document.querySelector('meta[name="company-name"]'))==null?void 0:vt.getAttribute("content"))||yp,re=((Pt=document.querySelector('meta[name="company-logo"]'))==null?void 0:Pt.getAttribute("content"))||"",ye="Generado por OdontoCloud",pe=w.length===0?'<tr><td colspan="6" style="padding:8px 6px;color:#6b7280">No hay citas registradas para este rango.</td></tr>':w.map(te=>{const ue=te.fecha.toLocaleDateString(an),ne=te.fecha.toLocaleTimeString(an,{hour:"2-digit",minute:"2-digit",hour12:!0});return`<tr>
              <td>${L(ue)}</td>
              <td>${L(ne)}</td>
              <td>${L(te.paciente)}</td>
              <td>${L(te.doctor)}</td>
              <td>${L(te.espacio)}</td>
              <td>${L(te.comentario)}</td>
            </tr>`}).join(""),_e=`<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>Imprimir  ${L(z)}</title>
  <style>
    @page { size: A4 portrait; margin: 18mm; }
    body { font-family: Segoe UI, Roboto, Arial, sans-serif; color:#0f172a; }
    .hdr { display:flex; align-items:center; gap:12px; border-bottom:2px solid #e5e7eb; padding-bottom:8px; margin-bottom:12px; }
    .brand { font-size:18px; font-weight:700; color:#0a86d8; line-height:1.1; }
    .sub { font-size:12px; color:#6b7280; }
    table { width:100%; border-collapse:collapse; font-size:12px; }
    th { text-align:left; background:#f3f4f6; border-bottom:1px solid #e5e7eb; padding:8px 6px; }
    td { border-bottom:1px solid #f1f5f9; padding:7px 6px; vertical-align:top; }
    .note { margin-top:8px; font-size:10px; color:#9ca3af; }
    tr, .hdr { page-break-inside: avoid; }
  </style>
</head>
<body>
  <div class="hdr">
    ${re?`<img src="${re}" alt="Logo" style="height:36px;object-fit:contain">`:""}
    <div>
      <div class="brand">${L(z)}</div>
      <div class="sub">Agenda de citas  ${L(C)}</div>
    </div>
  </div>

  <table>
    <thead>
      <tr>
        <th style="width:18%">Fecha</th>
        <th style="width:10%">Hora</th>
        <th style="width:22%">Paciente</th>
        <th style="width:20%">Doctor</th>
        <th style="width:15%">Espacio</th>
        <th>Comentario</th>
      </tr>
    </thead>
    <tbody>${pe}</tbody>
  </table>

  <div class="note">${L(ye)}. ${L(new Date().toLocaleString(an))}</div>
  <script>
    // Imprimir cuando termine de cargar la pestaa (incluye el logo)
    window.addEventListener('load', function() {
      try { window.focus(); window.print(); } catch (e) {}
    });
  <\/script>
</body>
</html>`,$e=new Blob([_e],{type:"text/html;charset=utf-8"}),me=URL.createObjectURL($e),Z=window.open(me,"_blank","noopener,noreferrer,width=900,height=700");if(!Z){alert("El navegador bloque la ventana de impresin. Permite pop-ups para este sitio."),URL.revokeObjectURL(me);return}const xe=()=>{try{URL.revokeObjectURL(me)}catch{}};(ee=Z.addEventListener)==null||ee.call(Z,"load",xe),setTimeout(xe,15e3)},Q=()=>alert("Funcin de confirmar citas se integrar con n8n / correo."),Be=()=>D(),jt=()=>{if(w.length===0){alert("No hay citas para exportar.");return}const L=[`Empresa: ${yp}`],z=["Fecha","Hora","Paciente","Doctor","Espacio","Comentario"],re=w.map(Z=>{const xe=Z.fecha.toLocaleDateString(an),vt=Z.fecha.toLocaleTimeString(an,{hour:"2-digit",minute:"2-digit",hour12:!0});return[xe,vt,Z.paciente||"",Z.doctor||"",Z.espacio||"",(Z.comentario||"").replace(/\r?\n/g," ")]}),ye=[mU],pe=[L,[],z,...re,[],ye].map(Z=>(Z||[]).map(xe=>`"${String(xe??"").replace(/"/g,'""')}"`).join(",")).join(`
`),Pe=`citas_${yp.toLowerCase().replace(/\s+/g,"_")}_${vp(us(n))}`+(t==="week"?"_semana":t==="detail"?"_detalle":"")+".csv",_e=new Blob(["\uFEFF"+pe],{type:"text/csv;charset=utf-8;"}),$e=URL.createObjectURL(_e),me=document.createElement("a");me.href=$e,me.download=Pe,me.click(),URL.revokeObjectURL($e)},on=async(L,z)=>{try{const re=Xt(Se,"citas",L);await Zd(re,{estado:z})}catch(re){console.error("Error actualizando estado:",re),alert("No se pudo actualizar el estado de la cita.")}},J=(L,z)=>{if(!L){alert("Este paciente no tiene celular registrado.");return}const re=String(L).replace(/\D/g,""),ye=z.fecha.toLocaleDateString(an),pe=z.fecha.toLocaleTimeString(an,{hour:"numeric",minute:"2-digit",hour12:!0}),Pe=encodeURIComponent(`Hola ${z.paciente}, le recordamos su cita odontolgica el ${ye} a las ${pe}. Por favor confirme su asistencia.`),_e=`https://wa.me/${re}?text=${Pe}`;window.open(_e,"_blank")},ce=async L=>{if(window.confirm(`Seguro que deseas eliminar la cita de ${L.paciente} del ${L.fecha.toLocaleDateString(an)}?`))try{const re=Xt(Se,"citas",L.id);await qC(re)}catch(re){console.error("Error eliminando cita:",re),alert(" No se pudo eliminar la cita.")}},he=()=>{const L=document.createElement("div");Object.assign(L.style,{position:"fixed",top:"0",left:"0",width:"100%",height:"100%",background:"rgba(0,0,0,0.55)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:"9999"});const z=document.createElement("div");Object.assign(z.style,{background:"#fff",padding:"25px 30px",borderRadius:"14px",width:"520px",maxWidth:"95%",maxHeight:"95%",overflowY:"auto",boxShadow:"0 8px 30px rgba(0,0,0,0.3)",fontFamily:"Segoe UI, Roboto, sans-serif"}),z.innerHTML=`
      <h2 style="margin-top:0;text-align:center;color:#0a86d8;font-weight:600;"> Nueva Cita</h2>
      <form id="formNuevaCita" style="display:flex;flex-direction:column;gap:12px;margin-top:10px;">
        <label style="font-weight:600;">Paciente existente</label>
        <div style="position:relative;">
          <input type="text" id="buscarPaciente" placeholder="Buscar por nombre, apellido o documento..." autocomplete="off"/>
          <div id="acResultados" style="position:absolute;left:0;right:0;top:calc(100% + 6px);z-index:10000;display:none;background:#fff;border:1px solid #ddd;border-radius:8px;box-shadow:0 8px 22px rgba(0,0,0,.12);max-height:240px;overflow:auto;"></div>
        </div>
        <small style="color:gray;">Si el paciente no existe, marca Registrar nuevo paciente.</small>

        <label style="display:flex;align-items:center;gap:8px;margin-top:5px;">
          <input type="checkbox" id="esNuevoPaciente" />
          <span>Registrar nuevo paciente</span>
        </label>

        <div id="nuevoPacienteCampos" style="display:none;flex-direction:column;gap:8px;margin-top:10px;padding:10px;border-radius:8px;background:#f9f9f9;border:1px solid #ddd;">
          <h4 style="margin:0;text-align:center;color:#0a86d8;">Datos del paciente</h4>
          <div style="display:flex;gap:8px;">
            <input type="text" id="npNombre" placeholder="Nombre" style="flex:1;" />
            <input type="text" id="npApellido" placeholder="Apellido" style="flex:1;" />
          </div>
          <select id="npTipoDocumento">
            <option value="">Tipo de documento</option>
            <option value="CC">Cdula de Ciudadana</option>
            <option value="CE">Cdula de Extranjera</option>
            <option value="TI">Tarjeta de Identidad</option>
            <option value="PA">Pasaporte</option>
            <option value="DI">Documento Internacional</option>
            <option value="OTRO">Otro</option>
          </select>
          <input type="text" id="npDocumento" placeholder="Nmero de documento" />
          <input type="email" id="npCorreo" placeholder="Correo electrnico" />
          <div style="display:flex;gap:5px;">
            <select id="npIndicativo" style="width:40%;">
              <option value="+57"> +57</option>
              <option value="+1"> +1</option>
              <option value="+34"> +34</option>
              <option value="+52"> +52</option>
              <option value="+54"> +54</option>
              <option value="+593"> +593</option>
              <option value="+56"> +56</option>
              <option value="+58"> +58</option>
            </select>
            <input type="tel" id="npCelular" placeholder="Celular (obligatorio)" style="flex:1;" />
          </div>
          <input type="tel" id="npTelefono" placeholder="Telfono fijo (opcional)" />
          <label style="font-weight:500;">Fecha de nacimiento:</label>
          <input type="date" id="npNacimiento" />
          <select id="npSexo">
            <option value="">Sexo</option>
            <option value="Masculino">Masculino</option>
            <option value="Femenino">Femenino</option>
            <option value="Otro">Otro</option>
          </select>
          <textarea id="npComentario" placeholder="Comentario o antecedentes del paciente" rows="2"></textarea>
        </div>

        <hr style="margin:10px 0;border:none;border-top:1px solid #ddd;" />
        <h4 style="margin:0;text-align:center;color:#0a86d8;">Detalles de la cita</h4>
        <input type="text" id="ncDoctor" placeholder="Doctor asignado" required />
        <input type="date" id="ncFecha" required value="${vp(n)}" />
        <input type="time" id="ncHora" required />
        <input type="text" id="ncEspacio" placeholder="Espacio fsico / Sala" />
        <textarea id="ncComentario" placeholder="Comentario sobre la cita" rows="3"></textarea>

        <div style="display:flex;justify-content:flex-end;gap:10px;margin-top:10px;">
          <button type="button" id="btnCancelarModal" class="btn-cancelar">Cancelar</button>
          <button type="submit" class="btn-guardar">Guardar</button>
        </div>
      </form>
    `;const re=document.createElement("style");re.textContent=`
      .btn-cancelar, .btn-guardar { padding: 8px 14px; border: none; border-radius: 6px; cursor: pointer; font-weight: 600; font-size: 14px; transition: .2s; }
      .btn-cancelar { background: #e0e0e0; color: #333; } .btn-cancelar:hover { background: #d5d5d5; }
      .btn-guardar { background: #0a86d8; color: white; } .btn-guardar:hover { background: #0669ac; }
      input, select, textarea { width: 100%; padding: 8px 10px; border: 1px solid #ccc; border-radius: 6px; font-size: 14px; outline: none; }
      input:focus, select:focus, textarea:focus { border-color: #0a86d8; box-shadow: 0 0 0 2px rgba(10,134,216,.2); }
      .ac-item { padding: 8px 10px; display:flex; gap:8px; align-items:baseline; cursor:pointer; }
      .ac-item:hover, .ac-item.active { background:#f5f7fb; }
      .ac-name { font-weight:600; } .ac-doc { color:#64748b; font-size:12px; } .ac-tel { margin-left:auto; font-size:12px; color:#0f172a; }
      .ac-empty { padding:10px; color:#9aa4b2; font-size:13px; }
    `,document.head.appendChild(re),L.appendChild(z),document.body.appendChild(L);const ye=z.querySelector("#esNuevoPaciente"),pe=z.querySelector("#nuevoPacienteCampos"),Pe=z.querySelector("#buscarPaciente"),_e=z.querySelector("#acResultados");ye.addEventListener("change",()=>{pe.style.display=ye.checked?"flex":"none",ye.checked&&(_e.style.display="none")}),z.querySelector("#btnCancelarModal").addEventListener("click",()=>L.remove());let $e=null,me=null,Z=-1,xe=[];const vt=T=>{if(xe=T||[],Z=-1,!T||T.length===0){_e.innerHTML='<div class="ac-empty">Sin resultados</div>',_e.style.display="block";return}_e.innerHTML=T.map((M,q)=>`
            <div class="ac-item" data-index="${q}" data-id="${M.id}">
              <span class="ac-name">${M.nombre}</span>
              <span class="ac-doc"> ${M.documento||"s/doc"}</span>
              <span class="ac-tel">${M.celular||M.telefono||""}</span>
            </div>`).join(""),_e.style.display="block",[..._e.querySelectorAll(".ac-item")].forEach(M=>{M.addEventListener("click",()=>{const q=Number(M.getAttribute("data-index"));Pt(q)})})},Pt=T=>{const M=xe[T];M&&(me=M,Pe.value=M.nombre,_e.style.display="none",ye.checked=!1,pe.style.display="none")},ee=T=>{xe.length&&(Z=(Z+T+xe.length)%xe.length,[..._e.querySelectorAll(".ac-item")].forEach((M,q)=>{q===Z?M.classList.add("active"):M.classList.remove("active")}))},te=(T,M)=>T.nombreCompleto||T.paciente||[T.nombres,T.apellidos].filter(Boolean).join(" ")||M,ue=async T=>{const M=(T||"").toString().trim(),q=yo(M);if(!q||q.length<2)return[];if(/^\d{5,}$/.test(M))try{const oe=mt(Xe(Se,"pacientes"),It("documento","==",M)),le=mt(Xe(Se,"pacientes"),It("nroDocumento","==",M)),[ve,qe]=await Promise.all([En(oe),En(le)]),Ie=ve.empty?qe:ve;if(!Ie.empty)return Ie.docs.slice(0,10).map(He=>{const Re=He.data()||{};return{id:He.id,nombre:te(Re,He.id),documento:Re.documento||Re.nroDocumento||He.id,celular:Re.celularPaciente||Re.celular||"",telefono:Re.telefonoPaciente||Re.telefono||""}})}catch{}try{const oe=mt(Xe(Se,"pacientes"),gr("nombre_busqueda"),AI(q),CI(q+""),Go(10)),le=await En(oe);if(!le.empty)return le.docs.map(ve=>{const qe=ve.data()||{};return{id:ve.id,nombre:te(qe,ve.id),documento:qe.documento||qe.nroDocumento||ve.id,celular:qe.celularPaciente||qe.celular||"",telefono:qe.telefonoPaciente||qe.telefono||""}})}catch{}try{const oe=mt(Xe(Se,"pacientes"),gr("creado","desc"),Go(50));return(await En(oe)).docs.map(Ie=>({id:Ie.id,...Ie.data()||{}})).map(Ie=>({id:Ie.id,nombre:te(Ie,Ie.id),documento:Ie.documento||Ie.nroDocumento||Ie.id,celular:Ie.celularPaciente||Ie.celular||"",telefono:Ie.telefonoPaciente||Ie.telefono||"",_norm:yo(`${Ie.nombreCompleto||Ie.paciente||""} ${Ie.nombres||""} ${Ie.apellidos||""} ${Ie.documento||Ie.nroDocumento||""}`)})).filter(Ie=>Ie._norm.includes(q)).slice(0,10).map(({_norm:Ie,...He})=>He)}catch{}return[]};Pe.addEventListener("input",()=>{me=null;const T=Pe.value;if(clearTimeout($e),!T||T.trim().length<2){_e.style.display="none";return}$e=setTimeout(async()=>{const M=await ue(T.trim());vt(M)},220)}),Pe.addEventListener("keydown",T=>{_e.style.display==="block"&&(T.key==="ArrowDown"?(T.preventDefault(),ee(1)):T.key==="ArrowUp"?(T.preventDefault(),ee(-1)):T.key==="Enter"?Z>=0&&(T.preventDefault(),Pt(Z)):T.key==="Escape"&&(_e.style.display="none"))}),document.addEventListener("click",T=>{z.contains(T.target)&&!_e.contains(T.target)&&T.target!==Pe&&(_e.style.display="none")},{capture:!0});const ne=z.querySelector("#formNuevaCita");ne.addEventListener("submit",async T=>{T.preventDefault();const M=ye.checked,q=(ne.querySelector("#buscarPaciente").value||"").trim(),oe=ne.querySelector("#ncDoctor").value.trim(),le=ne.querySelector("#ncFecha").value,ve=ne.querySelector("#ncHora").value,qe=ne.querySelector("#ncEspacio").value.trim(),Ie=ne.querySelector("#ncComentario").value.trim();if(!le||!ve){alert(" Debes seleccionar fecha y hora para la cita.");return}if(!oe){alert(" Indica el doctor asignado.");return}try{let He=null,Re=null,ht="",Lt="",mn="";if(M){const gn=(ne.querySelector("#npNombre").value||"").trim(),Zr=(ne.querySelector("#npApellido").value||"").trim();if(ht=`${gn} ${Zr}`.trim(),!ht){alert(" Debes indicar nombre y apellido para el nuevo paciente.");return}const sr=(ne.querySelector("#npDocumento").value||"").trim(),Cr=(ne.querySelector("#npCelular").value||"").trim(),yn=(ne.querySelector("#npTelefono").value||"").trim();if(!Cr&&!yn){alert(" Debes registrar al menos un telfono (celular o fijo) del paciente o de un acudiente.");return}if(He=sr||ht.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/\s+/g,"_"),Re=Xt(Se,"pacientes",He),!(await Xd(Re)).exists()){const je=yo(ht);await Jd(Re,{nombres:gn,apellidos:Zr,nombreCompleto:ht,paciente:ht,nombre_busqueda:je,variantes_busqueda:[je,yo(gn),yo(Zr)],tipoDocumento:ne.querySelector("#npTipoDocumento").value,documento:sr,correo:(ne.querySelector("#npCorreo").value||"").trim(),indicativo:ne.querySelector("#npIndicativo").value,celular:Cr,telefono:yn,celularPaciente:Cr,telefonoPaciente:yn,fechaNacimiento:ne.querySelector("#npNacimiento").value,sexo:ne.querySelector("#npSexo").value,notas:(ne.querySelector("#npComentario").value||"").trim(),creado:new Date().toISOString(),activo:!0,citas:[]},{merge:!0})}Lt=Cr,mn=yn}else if(me)He=me.id,ht=me.nombre,Re=Xt(Se,"pacientes",He),Lt=me.celular||"",mn=me.telefono||"";else{if(!q){alert(" Por favor, escribe o selecciona un paciente.");return}const gn=mt(Xe(Se,"pacientes"),It("documento","==",q)),Zr=mt(Xe(Se,"pacientes"),It("nroDocumento","==",q)),[sr,Cr]=await Promise.all([En(gn),En(Zr)]),yn=sr.empty?Cr:sr;if(yn.empty){let Gt=null;try{const je=yo(q),Lc=mt(Xe(Se,"pacientes"),gr("nombre_busqueda"),AI(je),CI(je+""),Go(1)),ei=await En(Lc);if(!ei.empty){const br=ei.docs[0],or=br.data()||{};Gt={id:br.id,ref:br.ref,nombre:or.nombreCompleto||or.paciente||[or.nombres,or.apellidos].filter(Boolean).join(" "),cel:or.celularPaciente||or.celular||"",tel:or.telefonoPaciente||or.telefono||""}}}catch{}Gt?(He=Gt.id,Re=Gt.ref,ht=Gt.nombre||q,Lt=Gt.cel||"",mn=Gt.tel||""):ht=q}else{const Gt=yn.docs[0],je=Gt.data()||{};He=Gt.id,Re=Gt.ref,ht=je.nombreCompleto||je.paciente||[je.nombres,je.apellidos].filter(Boolean).join(" ")||q,Lt=je.celularPaciente||je.celular||"",mn=je.telefonoPaciente||je.telefono||""}}if(!(Lt||mn||"").trim()){alert(" Este paciente no tiene ningn telfono registrado. Edita sus datos y agrega un nmero antes de guardar la cita.");return}const Ar={paciente:ht||"Paciente",pacienteId:He||null,doctor:oe,fecha:le,horaInicio:ve,espacio:qe,comentario:Ie,estado:"En espera",creado:new Date().toISOString(),celularPaciente:Lt||"",telefonoPaciente:mn||""},ba=await HC(Xe(Se,"citas"),Ar);Re&&await Jd(Re,{citas:AM(ba.id)},{merge:!0}),alert(" Cita registrada correctamente y vinculada al paciente."),L.remove()}catch(He){console.error(" Error al guardar cita:",He),alert(" Error al guardar la cita. Revisa la consola para ms detalles.")}})},De=L=>{var $e,me;const z=document.createElement("div");Object.assign(z.style,{position:"fixed",top:"0",left:"0",width:"100%",height:"100%",background:"rgba(0,0,0,0.55)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:"9999"});const re=document.createElement("div");Object.assign(re.style,{background:"#fff",padding:"25px 30px",borderRadius:"14px",width:"520px",maxWidth:"95%",maxHeight:"95%",overflowY:"auto",boxShadow:"0 8px 30px rgba(0,0,0,0.3)",fontFamily:"Segoe UI, Roboto, sans-serif"});const ye=($e=L.raw)!=null&&$e.fecha&&typeof L.raw.fecha=="string"?L.raw.fecha:vp(L.fecha),pe=((me=L.raw)==null?void 0:me.horaInicio)||L.fecha.toTimeString().slice(0,5);re.innerHTML=`
      <h2 style="margin-top:0;text-align:center;color:#0a86d8;font-weight:600;"> Editar Cita</h2>
      <form id="formEditarCita" style="display:flex;flex-direction:column;gap:12px;margin-top:10px;">
        <label>Paciente</label>
        <input type="text" id="editPaciente" value="${L.paciente||""}" />

        <label>Doctor asignado</label>
        <input type="text" id="editDoctor" value="${L.doctor||""}" />

        <div style="display:flex;gap:8px;">
          <div style="flex:1;">
            <label>Fecha</label>
            <input type="date" id="editFecha" value="${ye}" />
          </div>
          <div style="flex:1;">
            <label>Hora</label>
            <input type="time" id="editHora" value="${pe}" />
          </div>
        </div>

        <label>Espacio fsico / Sala</label>
        <input type="text" id="editEspacio" value="${L.espacio||""}" />

        <label>Estado</label>
        <select id="editEstado" className="estado-select">
          <option value="En espera" ${L.estado==="En espera"?"selected":""}>En espera</option>
          <option value="En sala" ${L.estado==="En sala"?"selected":""}>En sala</option>
          <option value="Atendiendo" ${L.estado==="Atendiendo"?"selected":""}>Atendiendo</option>
          <option value="Finalizada" ${L.estado==="Finalizada"?"selected":""}>Finalizada</option>
          <option value="pendiente" ${L.estado==="pendiente"?"selected":""}>Pendiente</option>
          <option value="No asisti" ${L.estado==="No asisti"?"selected":""}>No asisti</option>
        </select>

        <label>Comentario</label>
        <textarea id="editComentario" rows="3">${L.comentario||""}</textarea>

        <div style="display:flex;justify-content:flex-end;gap:10px;margin-top:10px;">
          <button type="button" id="btnCancelarEdit" className="btn-cancelar">Cancelar</button>
          <button type="submit" className="btn-guardar">Guardar cambios</button>
        </div>
      </form>
    `;const Pe=document.createElement("style");Pe.textContent=`
      .btn-cancelar, .btn-guardar { padding: 8px 14px; border: none; border-radius: 6px; cursor: pointer; font-weight: 600; font-size: 14px; transition: .2s; }
      .btn-cancelar { background: #e0e0e0; color: #333; } .btn-cancelar:hover { background: #d5d5d5; }
      .btn-guardar { background: #0a86d8; color: white; } .btn-guardar:hover { background: #0669ac; }
      #formEditarCita input, #formEditarCita select, #formEditarCita textarea { width: 100%; padding: 8px 10px; border: 1px solid #ccc; border-radius: 6px; font-size: 14px; outline: none; }
      #formEditarCita input:focus, #formEditarCita select:focus, #formEditarCita textarea:focus { border-color: #0a86d8; box-shadow: 0 0 0 2px rgba(10,134,216,.2); }
    `,document.head.appendChild(Pe),z.appendChild(re),document.body.appendChild(z),re.querySelector("#btnCancelarEdit").addEventListener("click",()=>z.remove());const _e=re.querySelector("#formEditarCita");_e.addEventListener("submit",async Z=>{Z.preventDefault();const xe=_e.querySelector("#editPaciente").value.trim(),vt=_e.querySelector("#editDoctor").value.trim(),Pt=_e.querySelector("#editFecha").value,ee=_e.querySelector("#editHora").value,te=_e.querySelector("#editEspacio").value.trim(),ue=_e.querySelector("#editEstado").value,ne=_e.querySelector("#editComentario").value.trim();if(!xe)return alert(" El nombre del paciente es obligatorio.");if(!Pt||!ee)return alert(" Debes indicar fecha y hora.");try{const T=Xt(Se,"citas",L.id);await Zd(T,{paciente:xe,doctor:vt,fecha:Pt,horaInicio:ee,espacio:te,estado:ue,comentario:ne}),alert(" Cita actualizada correctamente."),z.remove()}catch(T){console.error(" Error al actualizar cita:",T),alert(" Error al actualizar la cita. Revisa la consola para ms detalles.")}})},H=L=>{const z=L.fecha.toLocaleDateString(an),re=L.fecha.toLocaleTimeString(an,{hour:"numeric",minute:"2-digit",hour12:!0}),ye=`${z}  ${re}`;return d.jsxs("tr",{className:"fade-in-row",onClick:()=>De(L),style:{cursor:"pointer"},children:[d.jsx("td",{children:ye}),d.jsx("td",{children:L.paciente}),d.jsx("td",{children:L.doctor}),d.jsx("td",{children:L.espacio}),d.jsx("td",{children:L.comentario}),d.jsx("td",{onClick:pe=>{pe.stopPropagation()},children:d.jsxs("select",{className:"estado-select",value:L.estado,onChange:pe=>on(L.id,pe.target.value),children:[d.jsx("option",{value:"En espera",children:"En espera"}),d.jsx("option",{value:"En sala",children:"En sala"}),d.jsx("option",{value:"Atendiendo",children:"Atendiendo"}),d.jsx("option",{value:"Finalizada",children:"Finalizada"}),d.jsx("option",{value:"pendiente",children:"Pendiente"}),d.jsx("option",{value:"No asisti",children:"No asisti"})]})}),d.jsxs("td",{className:"acciones-cell",onClick:pe=>{pe.stopPropagation()},children:[L.telefono?d.jsx("button",{type:"button",className:"btn-whatsapp",onClick:pe=>{pe.stopPropagation(),J(L.telefono,L)},children:"WhatsApp"}):d.jsx("span",{className:"acciones-texto",children:"Sin celular"}),d.jsx("button",{type:"button",className:"btn-delete",onClick:pe=>{pe.stopPropagation(),ce(L)},children:"Eliminar"}),L.recordatorio&&d.jsx("span",{className:"acciones-texto",children:L.recordatorio})]})]},L.id)};return d.jsxs(d.Fragment,{children:[d.jsx("div",{className:"odc-topbar-green"}),d.jsx("div",{className:"odc-topbar-blue",children:"Agenda"}),d.jsx("section",{className:"odc-agenda-root",children:d.jsxs("div",{className:"odc-agenda-inner",children:[d.jsxs("aside",{className:"odc-left","aria-label":"Panel izquierdo - calendario y filtros",children:[d.jsxs("div",{className:"odc-mini-calendar-card",role:"region","aria-label":"Mini calendario",children:[d.jsxs("div",{className:"mini-cal-header",children:[d.jsx("button",{className:"cal-arrow",id:"miniCalPrev","aria-label":"Mes anterior",onClick:U,children:""}),d.jsx("div",{id:"miniCalMonthYear","aria-live":"polite",children:I}),d.jsx("button",{className:"cal-arrow",id:"miniCalNext","aria-label":"Mes siguiente",onClick:$,children:""})]}),d.jsxs("table",{className:"mini-month-table","aria-hidden":"false",children:[d.jsx("thead",{children:d.jsxs("tr",{children:[d.jsx("th",{children:"Lu"}),d.jsx("th",{children:"Ma"}),d.jsx("th",{children:"Mi"}),d.jsx("th",{children:"Ju"}),d.jsx("th",{children:"Vi"}),d.jsx("th",{children:"Sa"}),d.jsx("th",{children:"Do"})]})}),d.jsx("tbody",{id:"miniCalendar",children:V.map((L,z)=>d.jsx("tr",{children:L.map((re,ye)=>d.jsx("td",{className:[re.isCurrentMonth?"":"empty",re.isToday?"today":"",re.isSelected?"selected":""].filter(Boolean).join(" "),onClick:()=>re.isCurrentMonth&&S(re.date),children:re.date.getDate()},ye))},z))})]})]}),d.jsxs("div",{className:"odc-filters-card","aria-label":"Filtros de agenda",children:[d.jsx("label",{htmlFor:"filterSucursal",children:"Sucursal"}),d.jsxs("select",{id:"filterSucursal",value:h,onChange:L=>f(L.target.value),children:[d.jsx("option",{value:"",children:" Todas "}),P.map(L=>d.jsx("option",{value:L,children:L},L))]}),d.jsx("label",{htmlFor:"filterDoctor",children:"Doctores"}),d.jsxs("select",{id:"filterDoctor",value:m,onChange:L=>E(L.target.value),children:[d.jsx("option",{value:"",children:" Todos "}),v.map(L=>d.jsx("option",{value:L,children:L},L))]})]})]}),d.jsxs("main",{className:"odc-right","aria-label":"Panel principal - agenda",children:[d.jsxs("div",{className:"odc-header-bar",role:"region","aria-label":"Controles de la agenda",style:{display:"flex",alignItems:"center",justifyContent:"space-between",gap:12},children:[d.jsxs("div",{className:"odc-header-left",style:{display:"flex",alignItems:"center",gap:12,flexWrap:"wrap"},children:[d.jsx("h3",{className:"odc-title",style:{marginRight:8},children:"Agenda"}),d.jsxs("div",{className:"view-buttons",role:"tablist","aria-label":"Vistas",style:{display:"flex",gap:6},children:[d.jsx("button",{className:`btn view ${t==="day"?"active":""}`,"data-view":"day",role:"tab","aria-selected":t==="day",onClick:()=>e("day"),children:"Da"}),d.jsx("button",{className:`btn view ${t==="week"?"active":""}`,"data-view":"week",role:"tab","aria-selected":t==="week",onClick:()=>e("week"),children:"Semana"}),d.jsx("button",{className:`btn view ${t==="detail"?"active":""}`,"data-view":"detail",role:"tab","aria-selected":t==="detail",onClick:()=>e("detail"),children:"Detalle"})]}),d.jsxs("div",{className:"date-nav",style:{display:"flex",alignItems:"center",gap:6,flex:"0 0 auto"},children:[d.jsx("button",{className:"btn icon",id:"btnPrev","aria-label":"Anterior",onClick:R,children:""}),d.jsx("button",{className:"btn icon",id:"btnNext","aria-label":"Siguiente",onClick:N,children:""}),d.jsx("span",{id:"currentDateDisplay",className:"current-date","aria-live":"polite",style:{whiteSpace:"nowrap"},children:C}),d.jsx("button",{id:"btnHoy",className:"btn small",onClick:D,children:"Hoy"})]})]}),d.jsx("div",{className:"odc-header-right",style:{display:"flex",alignItems:"center",gap:8,flexShrink:0},children:d.jsxs("div",{className:"right-actions",style:{display:"flex",alignItems:"center",gap:8},children:[d.jsx("input",{id:"searchCitas",placeholder:"Buscar...",className:"search-input","aria-label":"Buscar citas",value:_,onChange:L=>A(L.target.value)}),d.jsx("button",{id:"btnNuevaCita",className:"btn green","aria-label":"Nueva cita",onClick:he,children:"+ Nueva cita"})]})})]}),d.jsxs("div",{className:"odc-content-card",role:"region","aria-label":"Contenido agenda",children:[d.jsxs("div",{className:"tools-row",children:[d.jsx("div",{className:"tools-left",children:d.jsx("div",{id:"ocupacionInfo",className:"ocupacion-info",children:y})}),d.jsxs("div",{className:"tools-right",children:[d.jsx("button",{id:"btnPrint",className:"btn",title:"Imprimir agenda",onClick:b,children:" Imprimir"}),d.jsx("button",{id:"btnConfirmar",className:"btn blue",title:"Confirmar citas",onClick:Q,children:" Confirmar"}),d.jsx("button",{id:"btnHoyCitas",className:"btn",title:"Ver citas de hoy",onClick:Be,children:" Hoy"}),d.jsx("button",{id:"btnExportar",className:"btn",title:"Exportar citas a CSV",onClick:jt,children:" Exportar"})]})]}),d.jsx("div",{className:"table-wrap",role:"region","aria-label":"Lista de citas",children:d.jsxs("table",{className:"appointments-table","aria-live":"polite",children:[d.jsx("thead",{children:d.jsxs("tr",{children:[d.jsx("th",{style:{width:"180px"},children:"Fecha / Hora"}),d.jsx("th",{children:"Paciente"}),d.jsx("th",{children:"Doctor"}),d.jsx("th",{children:"Espacio fsico"}),d.jsx("th",{children:"Comentario"}),d.jsx("th",{style:{width:"120px"},children:"Estado"}),d.jsx("th",{children:"Acciones"})]})}),d.jsx("tbody",{id:"citasTbody",children:o?d.jsx("tr",{children:d.jsx("td",{colSpan:7,className:"no-data",children:"Cargando citas..."})}):w.length===0?d.jsx("tr",{children:d.jsx("td",{colSpan:7,className:"no-data",children:"No hay citas registradas para este rango."})}):w.map(H)})]})})]})]})]})})]})}function yU(){return d.jsxs("div",{style:{padding:"20px"},children:[d.jsx("h2",{children:"Mdulo de Facturacin"}),d.jsx("p",{children:"Aqu se registrarn los pagos, facturas y cobros."})]})}function _U(){return d.jsxs("div",{style:{padding:"20px"},children:[d.jsx("h2",{children:"Mdulo de Facturacin"}),d.jsx("p",{children:"Aqu se registrarn los pagos, facturas y cobros."})]})}function vU(){return d.jsxs("div",{style:{padding:"20px"},children:[d.jsx("h2",{children:"Mdulo de Facturacin"}),d.jsx("p",{children:"Aqu se registrarn los pagos, facturas y cobros."})]})}var rT;const Tu=typeof navigator<"u"&&((rT=navigator.language)!=null&&rT.startsWith("es"))?"es-ES":"en-US",wU=["Colombia","Argentina","Bolivia","Chile","Costa Rica","Cuba","Ecuador","El Salvador","Espaa","Guatemala","Honduras","Mxico","Nicaragua","Panam","Paraguay","Per","Puerto Rico","Repblica Dominicana","Uruguay","Venezuela","Estados Unidos","Canad"],JI={Colombia:["Bogot","Medelln","Cali","Barranquilla","Cartagena","Ccuta","Bucaramanga","Pereira","Santa Marta","Ibagu"],Mxico:["Ciudad de Mxico","Guadalajara","Monterrey","Puebla","Quertaro","Tijuana","Mrida","Len"],Per:["Lima","Arequipa","Trujillo","Chiclayo","Cusco","Piura"],Chile:["Santiago","Valparaso","Concepcin","La Serena","Antofagasta"],Argentina:["Buenos Aires","Crdoba","Rosario","Mendoza","La Plata"],Espaa:["Madrid","Barcelona","Valencia","Sevilla","Zaragoza","Bilbao"],"Estados Unidos":["Miami","New York","Los ngeles","Houston","Chicago"],Ecuador:["Quito","Guayaquil","Cuenca","Manta"],Venezuela:["Caracas","Maracaibo","Valencia","Barquisimeto","Maracay"]},EU=t=>{if(!t)return"";const[e,n,r]=t.split("-").map(l=>parseInt(l,10)),i=new Date(e,(n||1)-1,r||1),s=new Date;let o=s.getFullYear()-i.getFullYear();const a=s.getMonth()-i.getMonth();return(a<0||a===0&&s.getDate()<i.getDate())&&o--,isNaN(o)?"":String(o)};async function IU(t,{maxW:e=900,maxH:n=900,quality:r=.82}={}){var m;if(!t||!((m=t.type)!=null&&m.startsWith("image/")))return t;const i=await new Promise((E,_)=>{const A=new Image;A.onload=()=>E(A),A.onerror=_,A.src=URL.createObjectURL(t)});let{width:s,height:o}=i;const a=Math.min(e/s,n/o,1);s=Math.round(s*a),o=Math.round(o*a);const l=document.createElement("canvas");l.width=s,l.height=o,l.getContext("2d").drawImage(i,0,0,s,o);const h=await new Promise(E=>l.toBlob(E,"image/jpeg",r)),f=new File([h],(t.name||"foto.jpg").replace(/\.[^.]+$/,".jpg"),{type:"image/jpeg",lastModified:Date.now()});return URL.revokeObjectURL(i.src),f}const fl=t=>(t||"").toString().toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/\s+/g," ").trim(),TU=t=>fl([t.nombres,t.apellidos,t.nombreCompleto,t.nroDocumento,t.celular,t.email].filter(Boolean).join(" ")),_o={tipoDocumento:"",nroDocumento:"",nroHistoria:"",nombres:"",apellidos:"",nombreCompleto:"",sexo:"",estadoCivil:"",paisNacimiento:"",ciudadNacimiento:"",fechaIngreso:"",fechaNacimiento:"",edad:"",paisDomicilio:"",ciudadDomicilio:"",barrio:"",lugarResidencia:"",estrato:"",zonaResidencial:"",esExtranjero:!1,permitePublicidad:!1,celular:"",telDomicilio:"",telOficina:"",extension:"",email:"",ocupacion:"",nombreResponsable:"",parentesco:"",celularResponsable:"",telefonoResponsable:"",emailResponsable:"",nombreAcompanante:"",telefonoAcompanante:"",convenioBeneficio:"",comoConocio:"",campania:"",remitidoPor:"",asesorComercial:"",tipoVinculacion:"",nombreEps:"",polizaSalud:"",doctor:"",notas:"",rxImagenes:[],historiaClinica:{antecedentes:"",alergias:"",medicamentos:"",motivoConsulta:"",notas:""},odontograma:[],periodontograma:[],presupuestos:[],evoluciones:[],facturacion:{saldoFavor:0,saldoCredito:0},fotoUrl:"",activo:!0},wp=20;function xU(){var xe,vt,Pt,ee,te,ue,ne;const[t,e]=k.useState(!0),[n,r]=k.useState([]),[i,s]=k.useState(""),[o,a]=k.useState(null),[l,u]=k.useState(!0),[h,f]=k.useState(!1),[m,E]=k.useState(null),[_,A]=k.useState(null),P=k.useRef(null),[v,w]=k.useState("datos"),[y,V]=k.useState(_o),[U,$]=k.useState(null),[S,I]=k.useState(""),[C,R]=k.useState([]),N=k.useMemo(()=>JI[y.paisNacimiento]||[],[y.paisNacimiento]);k.useEffect(()=>((async()=>{e(!0);try{const q=(await En(Xe(Se,"eps"))).docs.map(le=>{var ve;return(ve=le.data())==null?void 0:ve.nombre}).filter(Boolean),oe=Array.from(new Map(q.map(le=>[String(le).toLowerCase(),le])).values()).sort((le,ve)=>le.localeCompare(ve,"es"));R(oe),await Be(!0)}catch(M){console.error(M),alert("No se pudieron cargar pacientes/EPS.")}finally{e(!1)}})(),()=>{P.current&&(P.current(),P.current=null)}),[]),k.useEffect(()=>{V(T=>({...T,nombreCompleto:`${T.nombres} ${T.apellidos}`.trim()}))},[y.nombres,y.apellidos]),k.useEffect(()=>{V(T=>({...T,nroHistoria:T.nroDocumento}))},[y.nroDocumento]),k.useEffect(()=>{V(T=>({...T,edad:EU(T.fechaNacimiento)}))},[y.fechaNacimiento]),k.useEffect(()=>{const T=new Date,M=T.toLocaleDateString(Tu)+" - "+T.toLocaleTimeString(Tu,{hour:"2-digit",minute:"2-digit",hour12:!0});V(q=>({...q,fechaIngreso:M}))},[]);const D=(T,M)=>V(q=>({...q,[T]:M})),b=()=>{V(_o);const T=new Date,M=T.toLocaleDateString(Tu)+" - "+T.toLocaleTimeString(Tu,{hour:"2-digit",minute:"2-digit",hour12:!0});V(q=>({...q,fechaIngreso:M})),$(null),I(""),E(null)},Q=async T=>{if(!T){$(null),I("");return}try{const M=await IU(T,{maxW:900,maxH:900,quality:.82});$(M);const q=new FileReader;q.onload=oe=>I(oe.target.result),q.readAsDataURL(M)}catch{$(T);const M=new FileReader;M.onload=q=>I(q.target.result),M.readAsDataURL(T)}},Be=async(T=!1)=>{e(!0);try{let M;T||!o?M=mt(Xe(Se,"pacientes"),gr("creado","desc"),Go(wp)):M=mt(Xe(Se,"pacientes"),gr("creado","desc"),wM(o),Go(wp));const q=await En(M),oe=q.docs.map(le=>({id:le.id,...le.data()}));r(T?oe:le=>[...le,...oe]),a(q.docs[q.docs.length-1]||null),u(q.size===wp)}catch(M){console.error(M),alert("No se pudo cargar pacientes.")}finally{e(!1)}},jt=async T=>{if(T.preventDefault(),!y.nroDocumento.trim())return alert("El nmero de documento es obligatorio.");if(!y.nombres.trim())return alert("Los nombres son obligatorios.");if(!y.apellidos.trim())return alert("Los apellidos son obligatorios.");if(!y.sexo.trim())return alert("El sexo es obligatorio.");if(!y.fechaNacimiento.trim())return alert("La fecha de nacimiento es obligatoria.");if(!y.celular.trim())return alert("El celular es obligatorio.");if(!y.email.trim())return alert("El correo electrnico es obligatorio.");if(!y.tipoVinculacion.trim())return alert("El tipo de vinculacin es obligatorio.");if(!y.nombreEps.trim())return alert("El nombre de la EPS es obligatorio.");try{const M=y.nroDocumento.trim();if(!m&&(await Xd(Xt(Se,"pacientes",M))).exists())return alert("Ya existe un paciente con ese nmero de documento.");const q=(y.nombreEps||"").trim(),oe=C.map(Re=>Re.toLowerCase()).includes(q.toLowerCase());if(q&&!oe&&window.confirm(`La EPS "${q}" no existe. Deseas guardarla para futuras selecciones?`)){const ht=q.toLowerCase().replace(/\s+/g,"_");await Jd(Xt(Se,"eps",ht),{nombre:q,nombreLower:q.toLowerCase(),creado:Pr()},{merge:!0})}let le=y.fotoUrl||"",ve="";if(U)try{const Re=ws(),ht=(U.name||"foto.jpg").replace(/\s+/g,"_");ve=`pacientes/${M}/${Date.now()}_${ht}`;const Lt=tl(Re,ve),mn={contentType:U.type||"image/jpeg",cacheControl:"public, max-age=86400"};await jI(Lt,U,mn),le=await MI(Lt)}catch(Re){console.error("Foto (warning):",Re)}const qe=y.creado||null,Ie=m&&qe||Pr(),He={...y,fotoUrl:le,nombre_busqueda:TU({...y,fotoUrl:le}),nombresLower:fl(y.nombres),apellidosLower:fl(y.apellidos),documentoLower:fl(y.nroDocumento),emailLower:fl(y.email),creado:Ie,createdAt:Ie,actualizado:Pr(),updatedAt:Pr(),activo:y.activo??!0,celularPaciente:y.celular,telefonoPaciente:y.telDomicilio||"",documento:y.nroDocumento,paciente:y.nombreCompleto};if(await Jd(Xt(Se,"pacientes",M),He,{merge:!0}),ve)try{const Re=ws(),ht=tl(Re,`pacientes/${M}`),Lt=await LI(ht),mn=ve,Jr=Lt.items.filter(Ar=>Ar.fullPath!==mn).map(Ar=>hp(Ar).catch(()=>null));await Promise.allSettled(Jr)}catch(Re){console.warn("No se pudo limpiar fotos antiguas:",Re)}alert(m?" Paciente actualizado.":" Paciente guardado."),r(Re=>{const ht=Re.filter(Lt=>Lt.id!==M);return[{id:M,...He},...ht]}),f(!1),E(null),b()}catch(M){console.error("Error guardando paciente:",M),alert(`No se pudo guardar el paciente.

`+((M==null?void 0:M.message)||M))}},on=()=>{b(),f(!0)},J=()=>{_&&(V({..._o,..._,fotoUrl:_.fotoUrl||""}),$(null),I(_.fotoUrl||""),E(_.id),H(),f(!0))},ce=async T=>{if(window.confirm(`Eliminar al paciente "${T.nombreCompleto}"?`))try{await qC(Xt(Se,"pacientes",T.id)),r(M=>M.filter(q=>q.id!==T.id));try{const M=ws(),q=tl(M,`pacientes/${T.id}`),le=(await LI(q)).items.map(ve=>hp(ve).catch(()=>null));await Promise.allSettled(le)}catch(M){console.warn("No se pudo borrar la carpeta de fotos:",M)}}catch(M){console.error(M),alert("No se pudo eliminar.")}},he=k.useMemo(()=>{const T=i.trim().toLowerCase();return T?n.filter(M=>`${M.nombreCompleto||M.paciente||""} ${M.nroDocumento||""} ${M.celular||M.celularPaciente||""} ${M.email||""}`.toLowerCase().includes(T)):n},[n,i]),De=T=>{H();const M=Xt(Se,"pacientes",T.id),q=Bi(M,oe=>{oe.exists()?A({id:oe.id,...L(oe.data())}):A(null)});P.current=q,w("datos")},H=()=>{P.current&&(P.current(),P.current=null),A(null)},L=T=>({..._o,...T,historiaClinica:{..._o.historiaClinica,...T.historiaClinica||{}},facturacion:{..._o.facturacion,...T.facturacion||{}},rxImagenes:Array.isArray(T.rxImagenes)?T.rxImagenes:[],odontograma:Array.isArray(T.odontograma)?T.odontograma:[],periodontograma:Array.isArray(T.periodontograma)?T.periodontograma:[],presupuestos:Array.isArray(T.presupuestos)?T.presupuestos:[],evoluciones:Array.isArray(T.evoluciones)?T.evoluciones:[]}),z=async T=>{if(_!=null&&_.id)try{await Zd(Xt(Se,"pacientes",_.id),{...T,actualizado:Pr(),updatedAt:Pr()})}catch(M){console.error(M),alert("No se pudo actualizar.")}},re=async T=>{if(!(_!=null&&_.id)||!(T!=null&&T.length))return;const M=ws(),q=[];for(const oe of T){const le=(oe.name||"archivo").replace(/\s+/g,"_"),ve=`pacientes/${_.id}/rx/${Date.now()}_${le}`,qe=tl(M,ve);await jI(qe,oe,{contentType:oe.type});const Ie=await MI(qe);q.push({url:Ie,name:oe.name,type:oe.type,size:oe.size||0,created:Date.now(),path:ve})}await z({rxImagenes:[..._.rxImagenes||[],...q]})},ye=async T=>{if(!(_!=null&&_.id))return;const M=_.rxImagenes[T],q=_.rxImagenes.filter((oe,le)=>le!==T);await z({rxImagenes:q});try{if(M!=null&&M.path){const oe=ws();await hp(tl(oe,M.path))}}catch(oe){console.warn("No se pudo borrar del Storage:",oe)}},pe=(T,M)=>{const q={..._.historiaClinica||{},[T]:M};z({historiaClinica:q})},Pe=T=>{const M=[..._.presupuestos||[],{id:String(Date.now()),...T}];z({presupuestos:M})},_e=T=>{z({presupuestos:(_.presupuestos||[]).filter(M=>M.id!==T)})},$e=T=>{const M=[..._.evoluciones||[],{id:String(Date.now()),fechaISO:new Date().toISOString(),nota:T}];z({evoluciones:M})},me=T=>{z({evoluciones:(_.evoluciones||[]).filter(M=>M.id!==T)})},Z=(T,M)=>{const q=Array.isArray(_[T])?_[T]:[],oe=q.find(ve=>ve.pieza===M);let le;oe?le=q.filter(ve=>ve.pieza!==M):le=[...q,{pieza:M,estado:"marcada"}],z({[T]:le})};return d.jsxs("div",{className:"odc-container",children:[d.jsx("div",{className:"odc-topbar-green"}),d.jsx("div",{className:"odc-topbar-blue",children:d.jsx("div",{className:"odc-top-inner",children:d.jsx("div",{className:"odc-breadcrumbs",children:"Pacientes"})})}),d.jsxs("div",{className:"odc-card",children:[d.jsxs("div",{className:"odc-card-header",children:[d.jsx("h3",{className:"odc-title",children:"Pacientes"}),d.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[d.jsx("input",{className:"search-input",style:{minWidth:280},placeholder:"Buscar por nombre, documento o telfono",value:i,onChange:T=>s(T.target.value)}),d.jsx("button",{className:"btn green",onClick:on,children:"+ Nuevo paciente"})]})]}),d.jsx("div",{className:"table-wrap",children:d.jsxs("table",{className:"appointments-table",children:[d.jsx("thead",{children:d.jsxs("tr",{children:[d.jsx("th",{children:"Foto"}),d.jsx("th",{children:"Nombre"}),d.jsx("th",{children:"Documento"}),d.jsx("th",{children:"Celular"}),d.jsx("th",{children:"Correo"}),d.jsx("th",{children:"Estado"})]})}),d.jsx("tbody",{children:t&&n.length===0?d.jsx("tr",{children:d.jsx("td",{className:"no-data",colSpan:6,children:"Cargando"})}):he.length===0?d.jsx("tr",{children:d.jsx("td",{className:"no-data",colSpan:6,children:"No hay pacientes o no coinciden con la bsqueda."})}):he.map(T=>d.jsxs("tr",{className:"row-click",onClick:()=>De(T),children:[d.jsx("td",{onClick:M=>M.stopPropagation(),children:T.fotoUrl?d.jsx("img",{src:T.fotoUrl,alt:"Foto",style:{width:36,height:36,borderRadius:"50%",objectFit:"cover"}}):d.jsx("div",{className:"avatar-fallback",children:(T.nombreCompleto||"P")[0]})}),d.jsx("td",{children:T.nombreCompleto||T.paciente||""}),d.jsx("td",{children:T.nroDocumento||T.documento||""}),d.jsx("td",{children:T.celular||T.celularPaciente||""}),d.jsx("td",{children:T.email||""}),d.jsx("td",{children:d.jsx("span",{className:"pill pill-ok",children:T.activo?"Activo":"Inactivo"})})]},T.id))})]})}),d.jsxs("div",{className:"footer-actions",children:[d.jsx("button",{className:"btn",disabled:t||!l,onClick:()=>Be(!1),children:l?"Cargar ms":"No hay ms"}),d.jsxs("div",{className:"hint",children:[n.length," registros cargados"]})]})]}),h&&d.jsxs("div",{className:"odc-modal",role:"dialog","aria-modal":"true",children:[d.jsx("div",{className:"odc-modal-backdrop",onClick:()=>f(!1)}),d.jsxs("div",{className:"odc-card",style:{width:1e3,maxWidth:"95%",maxHeight:"92vh",overflowY:"auto"},children:[d.jsxs("div",{className:"odc-card-header",children:[d.jsx("h3",{className:"odc-title",children:m?"Editar paciente":"Nuevo paciente"}),d.jsx("button",{className:"btn",onClick:()=>f(!1),children:""})]}),d.jsxs("form",{onSubmit:jt,children:[d.jsx("div",{className:"form-section-title",children:"Foto del paciente"}),d.jsxs("div",{className:"foto-row",children:[d.jsxs("label",{className:"foto-drop",children:[d.jsx("input",{type:"file",accept:"image/*",onChange:T=>{var M;return Q(((M=T.target.files)==null?void 0:M[0])||null)},style:{display:"none"}}),S?d.jsx("img",{src:S,alt:"Preview",className:"foto-preview"}):d.jsx("div",{className:"foto-empty",children:"Arrastra o haz clic para cargar"})]}),S&&d.jsx("button",{type:"button",className:"btn",onClick:()=>Q(null),children:"Quitar foto"})]}),d.jsx("div",{className:"form-section-title",children:"Datos de identificacin"}),d.jsxs("div",{className:"form-grid",children:[d.jsxs("div",{children:[d.jsx("label",{className:"form-label",children:"Tipo de documento *"}),d.jsxs("select",{className:"form-input",value:y.tipoDocumento,onChange:T=>D("tipoDocumento",T.target.value),children:[d.jsx("option",{value:"",children:"Seleccione"}),d.jsx("option",{value:"CC",children:"Cdula"}),d.jsx("option",{value:"TI",children:"Tarjeta de identidad"}),d.jsx("option",{value:"PA",children:"Pasaporte"}),d.jsx("option",{value:"OTRO",children:"Otro"})]})]}),d.jsxs("div",{children:[d.jsx("label",{className:"form-label",children:"Nro. de documento *"}),d.jsx("input",{className:"form-input",value:y.nroDocumento,onChange:T=>D("nroDocumento",T.target.value),placeholder:"Nmero de documento",required:!0})]}),d.jsxs("div",{children:[d.jsx("label",{className:"form-label",children:"Nmero de Historia"}),d.jsx("input",{className:"form-input",value:y.nroHistoria,readOnly:!0})]}),d.jsxs("div",{children:[d.jsx("label",{className:"form-label",children:"Nombres *"}),d.jsx("input",{className:"form-input",value:y.nombres,onChange:T=>D("nombres",T.target.value),required:!0})]}),d.jsxs("div",{children:[d.jsx("label",{className:"form-label",children:"Apellidos *"}),d.jsx("input",{className:"form-input",value:y.apellidos,onChange:T=>D("apellidos",T.target.value),required:!0})]}),d.jsxs("div",{children:[d.jsx("label",{className:"form-label",children:"Nombre completo"}),d.jsx("input",{className:"form-input",value:y.nombreCompleto,readOnly:!0})]}),d.jsxs("div",{children:[d.jsx("label",{className:"form-label",children:"Sexo *"}),d.jsxs("select",{className:"form-input",value:y.sexo,onChange:T=>D("sexo",T.target.value),required:!0,children:[d.jsx("option",{value:"",children:"Seleccione"}),d.jsx("option",{children:"Masculino"}),d.jsx("option",{children:"Femenino"}),d.jsx("option",{children:"Otro"})]})]}),d.jsxs("div",{children:[d.jsx("label",{className:"form-label",children:"Estado civil *"}),d.jsxs("select",{className:"form-input",value:y.estadoCivil,onChange:T=>D("estadoCivil",T.target.value),required:!0,children:[d.jsx("option",{value:"",children:"Seleccione"}),d.jsx("option",{children:"Soltero"}),d.jsx("option",{children:"Casado"}),d.jsx("option",{children:"Unin libre"}),d.jsx("option",{children:"Divorciado"}),d.jsx("option",{children:"Viudo"})]})]}),d.jsxs("div",{children:[d.jsx("label",{className:"form-label",children:"Pas de nacimiento *"}),d.jsx("input",{className:"form-input",list:"listCountries",value:y.paisNacimiento,onChange:T=>D("paisNacimiento",T.target.value),placeholder:"Escribe y elige",required:!0}),d.jsx("datalist",{id:"listCountries",children:wU.map(T=>d.jsx("option",{value:T},T))})]}),d.jsxs("div",{children:[d.jsx("label",{className:"form-label",children:"Ciudad de nacimiento"}),d.jsx("input",{className:"form-input",list:"listCitiesBirth",value:y.ciudadNacimiento,onChange:T=>D("ciudadNacimiento",T.target.value),placeholder:"Escribe y elige"}),d.jsx("datalist",{id:"listCitiesBirth",children:N.map(T=>d.jsx("option",{value:T},T))})]}),d.jsxs("div",{children:[d.jsx("label",{className:"form-label",children:"Fecha de ingreso"}),d.jsx("input",{className:"form-input",value:y.fechaIngreso,readOnly:!0})]}),d.jsxs("div",{children:[d.jsx("label",{className:"form-label",children:"Fecha de nacimiento *"}),d.jsx("input",{type:"date",className:"form-input",value:y.fechaNacimiento,onChange:T=>D("fechaNacimiento",T.target.value),required:!0})]}),d.jsxs("div",{children:[d.jsx("label",{className:"form-label",children:"Edad"}),d.jsx("input",{className:"form-input",value:y.edad,readOnly:!0})]}),d.jsxs("div",{children:[d.jsx("label",{className:"form-label",children:"Pas de domicilio *"}),d.jsx("input",{className:"form-input",list:"listCountries",value:y.paisDomicilio,onChange:T=>D("paisDomicilio",T.target.value),required:!0})]}),d.jsxs("div",{children:[d.jsx("label",{className:"form-label",children:"Ciudad de domicilio *"}),d.jsx("input",{className:"form-input",list:"listCitiesHome",value:y.ciudadDomicilio,onChange:T=>D("ciudadDomicilio",T.target.value),required:!0}),d.jsx("datalist",{id:"listCitiesHome",children:(JI[y.paisDomicilio]||[]).map(T=>d.jsx("option",{value:T},T))})]}),d.jsxs("div",{children:[d.jsx("label",{className:"form-label",children:"Barrio *"}),d.jsx("input",{className:"form-input",value:y.barrio,onChange:T=>D("barrio",T.target.value),required:!0,placeholder:"Barrio"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"form-label",children:"Lugar de residencia *"}),d.jsx("input",{className:"form-input",value:y.lugarResidencia,onChange:T=>D("lugarResidencia",T.target.value),required:!0})]}),d.jsxs("div",{children:[d.jsx("label",{className:"form-label",children:"Estrato"}),d.jsxs("select",{className:"form-input",value:y.estrato,onChange:T=>D("estrato",T.target.value),children:[d.jsx("option",{value:"",children:"Seleccione"}),d.jsx("option",{children:"1"}),d.jsx("option",{children:"2"}),d.jsx("option",{children:"3"}),d.jsx("option",{children:"4"}),d.jsx("option",{children:"5"}),d.jsx("option",{children:"6"})]})]}),d.jsxs("div",{children:[d.jsx("label",{className:"form-label",children:"Zona residencial *"}),d.jsxs("select",{className:"form-input",value:y.zonaResidencial,onChange:T=>D("zonaResidencial",T.target.value),required:!0,children:[d.jsx("option",{value:"",children:"Seleccione"}),d.jsx("option",{children:"Urbana"}),d.jsx("option",{children:"Rural"})]})]}),d.jsxs("div",{className:"checkbox-cell",children:[d.jsx("label",{className:"form-label",children:"Es extranjero?"}),d.jsx("input",{type:"checkbox",checked:y.esExtranjero,onChange:T=>D("esExtranjero",T.target.checked)})]}),d.jsxs("div",{className:"checkbox-cell",children:[d.jsx("label",{className:"form-label",children:"Permite publicidad?"}),d.jsx("input",{type:"checkbox",checked:y.permitePublicidad,onChange:T=>D("permitePublicidad",T.target.checked)})]})]}),d.jsx("div",{className:"form-section-title",children:"Contacto"}),d.jsxs("div",{className:"form-grid",children:[d.jsxs("div",{children:[d.jsx("label",{className:"form-label",children:"Celular *"}),d.jsx("input",{className:"form-input",value:y.celular,onChange:T=>D("celular",T.target.value),required:!0,placeholder:"Celular del paciente"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"form-label",children:"Telfono de domicilio"}),d.jsx("input",{className:"form-input",value:y.telDomicilio,onChange:T=>D("telDomicilio",T.target.value)})]}),d.jsxs("div",{children:[d.jsx("label",{className:"form-label",children:"Telfono de oficina"}),d.jsx("input",{className:"form-input",value:y.telOficina,onChange:T=>D("telOficina",T.target.value)})]}),d.jsxs("div",{children:[d.jsx("label",{className:"form-label",children:"Extensin"}),d.jsx("input",{className:"form-input",value:y.extension,onChange:T=>D("extension",T.target.value)})]}),d.jsxs("div",{children:[d.jsx("label",{className:"form-label",children:"Correo electrnico *"}),d.jsx("input",{type:"email",className:"form-input",value:y.email,onChange:T=>D("email",T.target.value),required:!0,placeholder:"correo@dominio.com"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"form-label",children:"Ocupacin *"}),d.jsx("input",{className:"form-input",value:y.ocupacion,onChange:T=>D("ocupacion",T.target.value),required:!0})]})]}),d.jsx("div",{className:"form-section-title",children:"Datos de facturacin"}),d.jsxs("div",{className:"form-grid",children:[d.jsxs("div",{children:[d.jsx("label",{className:"form-label",children:"Responsable"}),d.jsx("input",{className:"form-input",value:y.nombreResponsable,onChange:T=>D("nombreResponsable",T.target.value)})]}),d.jsxs("div",{children:[d.jsx("label",{className:"form-label",children:"Parentesco"}),d.jsxs("select",{className:"form-input",value:y.parentesco,onChange:T=>D("parentesco",T.target.value),children:[d.jsx("option",{value:"",children:"Seleccione"}),d.jsx("option",{children:"Padre/Madre"}),d.jsx("option",{children:"Hermano"}),d.jsx("option",{children:"Esposo/a"}),d.jsx("option",{children:"Otro"})]})]}),d.jsxs("div",{children:[d.jsx("label",{className:"form-label",children:"Celular"}),d.jsx("input",{className:"form-input",value:y.celularResponsable,onChange:T=>D("celularResponsable",T.target.value)})]}),d.jsxs("div",{children:[d.jsx("label",{className:"form-label",children:"Telfono"}),d.jsx("input",{className:"form-input",value:y.telefonoResponsable,onChange:T=>D("telefonoResponsable",T.target.value)})]}),d.jsxs("div",{children:[d.jsx("label",{className:"form-label",children:"Correo electrnico"}),d.jsx("input",{type:"email",className:"form-input",value:y.emailResponsable,onChange:T=>D("emailResponsable",T.target.value)})]})]}),d.jsx("div",{className:"form-section-title",children:"Acompaante"}),d.jsxs("div",{className:"form-grid",children:[d.jsxs("div",{children:[d.jsx("label",{className:"form-label",children:"Nombre"}),d.jsx("input",{className:"form-input",value:y.nombreAcompanante,onChange:T=>D("nombreAcompanante",T.target.value),placeholder:"Nombre acompaante"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"form-label",children:"Telfono"}),d.jsx("input",{className:"form-input",value:y.telefonoAcompanante,onChange:T=>D("telefonoAcompanante",T.target.value),placeholder:"Telfono acompaante"})]})]}),d.jsx("div",{className:"form-section-title",children:"Mercadeo"}),d.jsxs("div",{className:"form-grid",children:[d.jsxs("div",{children:[d.jsx("label",{className:"form-label",children:"Convenio beneficio"}),d.jsx("input",{className:"form-input",value:y.convenioBeneficio,onChange:T=>D("convenioBeneficio",T.target.value)})]}),d.jsxs("div",{children:[d.jsx("label",{className:"form-label",children:"Cmo nos conoci?"}),d.jsxs("select",{className:"form-input",value:y.comoConocio,onChange:T=>D("comoConocio",T.target.value),children:[d.jsx("option",{value:"",children:"Seleccione"}),d.jsx("option",{children:"Redes sociales"}),d.jsx("option",{children:"Publicidad"}),d.jsx("option",{children:"Recomendacin"}),d.jsx("option",{children:"Otro"})]})]}),d.jsxs("div",{children:[d.jsx("label",{className:"form-label",children:"Campaa"}),d.jsx("input",{className:"form-input",value:y.campania,onChange:T=>D("campania",T.target.value)})]}),d.jsxs("div",{children:[d.jsx("label",{className:"form-label",children:"Remitido por"}),d.jsx("input",{className:"form-input",value:y.remitidoPor,onChange:T=>D("remitidoPor",T.target.value)})]}),d.jsxs("div",{children:[d.jsx("label",{className:"form-label",children:"Asesor comercial"}),d.jsx("input",{className:"form-input",value:y.asesorComercial,onChange:T=>D("asesorComercial",T.target.value)})]})]}),d.jsx("div",{className:"form-section-title",children:"EPS"}),d.jsxs("div",{className:"form-grid",children:[d.jsxs("div",{children:[d.jsx("label",{className:"form-label",children:"Tipo de vinculacin *"}),d.jsxs("select",{className:"form-input",value:y.tipoVinculacion,onChange:T=>D("tipoVinculacion",T.target.value),required:!0,children:[d.jsx("option",{value:"",children:"Seleccione"}),d.jsx("option",{children:"Contributivo"}),d.jsx("option",{children:"Subsidiado"}),d.jsx("option",{children:"Particular"}),d.jsx("option",{children:"Otro"})]})]}),d.jsxs("div",{children:[d.jsx("label",{className:"form-label",children:"Nombre de la EPS *"}),d.jsx("input",{className:"form-input",list:"listEps",value:y.nombreEps,onChange:T=>D("nombreEps",T.target.value),placeholder:"Escribe y selecciona",required:!0}),d.jsx("datalist",{id:"listEps",children:C.map(T=>d.jsx("option",{value:T},T))})]}),d.jsxs("div",{children:[d.jsx("label",{className:"form-label",children:"Pliza de salud"}),d.jsx("input",{className:"form-input",value:y.polizaSalud,onChange:T=>D("polizaSalud",T.target.value)})]})]}),d.jsx("div",{className:"form-section-title",children:"Doctor"}),d.jsx("div",{className:"form-grid",children:d.jsxs("div",{children:[d.jsx("label",{className:"form-label",children:"Doctor"}),d.jsx("input",{className:"form-input",value:y.doctor,onChange:T=>D("doctor",T.target.value),placeholder:"Usuario / Libre"})]})}),d.jsx("div",{className:"form-section-title",children:"Alertas y Notas"}),d.jsx("div",{className:"form-grid",children:d.jsx("textarea",{className:"form-input",rows:3,value:y.notas,onChange:T=>D("notas",T.target.value),placeholder:"Notas del paciente"})}),d.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:8,marginTop:12},children:[m?d.jsx("button",{type:"button",className:"btn",onClick:()=>ce({id:m,nombreCompleto:y.nombreCompleto}),children:"Eliminar"}):d.jsx("div",{}),d.jsxs("div",{style:{display:"flex",gap:8},children:[d.jsx("button",{type:"button",className:"btn",onClick:()=>f(!1),children:"Cancelar"}),d.jsx("button",{type:"submit",className:"btn blue",children:m?"Actualizar":"Guardar paciente"})]})]})]})]})]}),_&&d.jsxs("div",{className:"odc-modal",role:"dialog","aria-modal":"true",children:[d.jsx("div",{className:"odc-modal-backdrop",onClick:H}),d.jsxs("div",{className:"odc-card ficha-card",children:[d.jsxs("div",{className:"ficha-header",children:[d.jsxs("div",{className:"ficha-header-left",children:[_.fotoUrl?d.jsx("img",{src:_.fotoUrl,alt:"Foto",className:"ficha-avatar"}):d.jsx("div",{className:"avatar-fallback ficha-avatar-fallback",children:(_.nombreCompleto||"P")[0]}),d.jsxs("div",{children:[d.jsx("div",{className:"ficha-nombre",children:_.nombreCompleto||""}),d.jsxs("div",{className:"ficha-doc",children:[_.tipoDocumento||""," ",_.nroDocumento||""]}),d.jsxs("div",{className:"ficha-badges",children:[d.jsx("span",{className:"ficha-badge blue",children:"En valoracin"}),d.jsx("span",{className:"ficha-badge green",children:"Sin deuda"})]})]})]}),d.jsx("div",{className:"ficha-header-right",children:d.jsxs("div",{className:"ficha-actions",children:[d.jsx("button",{className:"btn",onClick:H,children:"Cerrar"}),d.jsx("button",{className:"btn blue",onClick:J,children:"Editar"})]})})]}),d.jsxs("div",{className:"ficha-body",children:[d.jsxs("aside",{className:"ficha-sidebar",children:[d.jsx("div",{className:"ficha-sidebar-title",children:"Informacin general"}),d.jsx("button",{className:`ficha-link ${v==="datos"?"active":""}`,onClick:()=>w("datos"),children:"Datos personales"}),d.jsx("button",{className:`ficha-link ${v==="marketing"?"active":""}`,onClick:()=>w("marketing"),children:"Marketing"}),d.jsx("button",{className:`ficha-link ${v==="eps"?"active":""}`,onClick:()=>w("eps"),children:"EPS"}),d.jsx("button",{className:`ficha-link ${v==="prof"?"active":""}`,onClick:()=>w("prof"),children:"Profesionales"}),d.jsx("button",{className:`ficha-link ${v==="rx"?"active":""}`,onClick:()=>w("rx"),children:"Rx/Imgenes/Doc"}),d.jsx("button",{className:`ficha-link ${v==="citas"?"active":""}`,onClick:()=>w("citas"),children:"Citas"}),d.jsx("button",{className:`ficha-link ${v==="crm"?"active":""}`,onClick:()=>w("crm"),children:"CRM"}),d.jsx("div",{className:"ficha-sidebar-title mt",children:"Historia clnica"}),d.jsx("button",{className:`ficha-link ${v==="doc"?"active":""}`,onClick:()=>w("doc"),children:"Doc. Clnicos"}),d.jsx("button",{className:`ficha-link ${v==="odonto"?"active":""}`,onClick:()=>w("odonto"),children:"Odontogramas"}),d.jsx("button",{className:`ficha-link ${v==="perio"?"active":""}`,onClick:()=>w("perio"),children:"Periodontogramas"}),d.jsx("button",{className:`ficha-link ${v==="presu"?"active":""}`,onClick:()=>w("presu"),children:"Presupuestos"}),d.jsx("button",{className:`ficha-link ${v==="evo"?"active":""}`,onClick:()=>w("evo"),children:"Evoluciones"}),d.jsx("div",{className:"ficha-sidebar-title mt",children:"Facturacin"}),d.jsx("button",{className:`ficha-link ${v==="fact"?"active":""}`,onClick:()=>w("fact"),children:"Resumen"})]}),d.jsxs("main",{className:"ficha-content",children:[v==="datos"&&d.jsxs("section",{className:"ficha-section",children:[d.jsx("h4",{className:"ficha-section-title",children:"Datos personales"}),d.jsx("div",{className:"ficha-grid",children:[["Tipo de documento",_.tipoDocumento],["Nro. de documento",_.nroDocumento],["Nmero de Historia",_.nroHistoria],["Fecha de ingreso",_.fechaIngreso],["Nombres",_.nombres],["Apellidos",_.apellidos],["Nombre completo",_.nombreCompleto],["Sexo",_.sexo],["Estado civil",_.estadoCivil],["Pas de nacimiento",_.paisNacimiento],["Ciudad de nacimiento",_.ciudadNacimiento],["Fecha de nacimiento",_.fechaNacimiento],["Edad",_.edad],["Pas de domicilio",_.paisDomicilio],["Ciudad de domicilio",_.ciudadDomicilio],["Barrio",_.barrio],["Lugar de residencia",_.lugarResidencia],["Estrato",_.estrato],["Zona residencial",_.zonaResidencial],["Extranjero",_.esExtranjero?"S":"No"],["Permite publicidad",_.permitePublicidad?"S":"No"],["Celular",_.celular||_.celularPaciente],["Telfono domicilio",_.telDomicilio||_.telefonoPaciente],["Telfono oficina",_.telOficina],["Extensin",_.extension],["Correo electrnico",_.email],["Ocupacin",_.ocupacion],["Responsable",_.nombreResponsable],["Parentesco",_.parentesco],["Cel. responsable",_.celularResponsable],["Tel. responsable",_.telefonoResponsable],["Email responsable",_.emailResponsable],["Acompaante",_.nombreAcompanante],["Tel. acompaante",_.telefonoAcompanante]].map(([T,M])=>d.jsxs("div",{className:"field",children:[d.jsx("label",{children:T}),d.jsx("input",{className:"form-input",value:M||"",readOnly:!0})]},T))})]}),v==="marketing"&&d.jsxs("section",{className:"ficha-section",children:[d.jsx("h4",{className:"ficha-section-title",children:"Marketing"}),d.jsx("div",{className:"ficha-grid",children:[["Convenio beneficio",_.convenioBeneficio],["Cmo nos conoci?",_.comoConocio],["Campaa",_.campania],["Remitido por",_.remitidoPor],["Asesor comercial",_.asesorComercial]].map(([T,M])=>d.jsxs("div",{className:"field",children:[d.jsx("label",{children:T}),d.jsx("input",{className:"form-input",value:M||"",readOnly:!0})]},T))})]}),v==="eps"&&d.jsxs("section",{className:"ficha-section",children:[d.jsx("h4",{className:"ficha-section-title",children:"EPS"}),d.jsx("div",{className:"ficha-grid",children:[["Tipo de vinculacin",_.tipoVinculacion],["Nombre EPS",_.nombreEps],["Pliza de salud",_.polizaSalud]].map(([T,M])=>d.jsxs("div",{className:"field",children:[d.jsx("label",{children:T}),d.jsx("input",{className:"form-input",value:M||"",readOnly:!0})]},T))})]}),v==="prof"&&d.jsxs("section",{className:"ficha-section",children:[d.jsx("h4",{className:"ficha-section-title",children:"Profesionales"}),d.jsx("div",{className:"ficha-grid",children:d.jsxs("div",{className:"field",children:[d.jsx("label",{children:"Doctor"}),d.jsx("input",{className:"form-input",value:_.doctor||"",readOnly:!0})]})})]}),v==="rx"&&d.jsxs("section",{className:"ficha-section",children:[d.jsx("h4",{className:"ficha-section-title",children:"Rx / Imgenes / Documentos"}),d.jsx("div",{className:"rx-actions",children:d.jsxs("label",{className:"btn blue",children:["Subir archivos",d.jsx("input",{type:"file",multiple:!0,style:{display:"none"},onChange:T=>re([...T.target.files])})]})}),d.jsxs("div",{className:"rx-grid",children:[(_.rxImagenes||[]).map((T,M)=>{var q;return d.jsxs("div",{className:"rx-item",children:[(q=T.type)!=null&&q.startsWith("image/")?d.jsx("a",{href:T.url,target:"_blank",rel:"noreferrer",children:d.jsx("img",{src:T.url,alt:T.name})}):d.jsx("a",{className:"rx-file",href:T.url,target:"_blank",rel:"noreferrer",children:T.name||"archivo"}),d.jsxs("div",{className:"rx-meta",children:[d.jsx("span",{children:T.name}),d.jsx("button",{className:"btn small",onClick:()=>ye(M),children:"Eliminar"})]})]},M)}),(!_.rxImagenes||_.rxImagenes.length===0)&&d.jsx("div",{className:"no-data",children:"Sin archivos an."})]})]}),v==="doc"&&d.jsxs("section",{className:"ficha-section",children:[d.jsx("h4",{className:"ficha-section-title",children:"Doc. Clnicos"}),d.jsxs("div",{className:"ficha-grid",children:[d.jsxs("div",{className:"field",children:[d.jsx("label",{children:"Motivo de consulta"}),d.jsx("textarea",{className:"form-input",rows:3,value:((xe=_.historiaClinica)==null?void 0:xe.motivoConsulta)||"",onChange:T=>pe("motivoConsulta",T.target.value)})]}),d.jsxs("div",{className:"field",children:[d.jsx("label",{children:"Antecedentes"}),d.jsx("textarea",{className:"form-input",rows:3,value:((vt=_.historiaClinica)==null?void 0:vt.antecedentes)||"",onChange:T=>pe("antecedentes",T.target.value)})]}),d.jsxs("div",{className:"field",children:[d.jsx("label",{children:"Alergias"}),d.jsx("textarea",{className:"form-input",rows:2,value:((Pt=_.historiaClinica)==null?void 0:Pt.alergias)||"",onChange:T=>pe("alergias",T.target.value)})]}),d.jsxs("div",{className:"field",children:[d.jsx("label",{children:"Medicamentos"}),d.jsx("textarea",{className:"form-input",rows:2,value:((ee=_.historiaClinica)==null?void 0:ee.medicamentos)||"",onChange:T=>pe("medicamentos",T.target.value)})]}),d.jsxs("div",{className:"field",children:[d.jsx("label",{children:"Notas"}),d.jsx("textarea",{className:"form-input",rows:3,value:((te=_.historiaClinica)==null?void 0:te.notas)||"",onChange:T=>pe("notas",T.target.value)})]})]})]}),v==="odonto"&&d.jsxs("section",{className:"ficha-section",children:[d.jsx("h4",{className:"ficha-section-title",children:"Odontograma (placeholder)"}),d.jsx("div",{className:"odont-grid",children:Array.from({length:32},(T,M)=>M+1).map(T=>{const M=(_.odontograma||[]).some(q=>q.pieza===T);return d.jsx("button",{className:`tooth ${M?"on":""}`,onClick:()=>Z("odontograma",T),title:`Pieza ${T}`,children:T},T)})})]}),v==="perio"&&d.jsxs("section",{className:"ficha-section",children:[d.jsx("h4",{className:"ficha-section-title",children:"Periodontograma (placeholder)"}),d.jsx("div",{className:"odont-grid",children:Array.from({length:32},(T,M)=>M+1).map(T=>{const M=(_.periodontograma||[]).some(q=>q.pieza===T);return d.jsx("button",{className:`tooth ${M?"on":""}`,onClick:()=>Z("periodontograma",T),title:`Pieza ${T}`,children:T},T)})})]}),v==="presu"&&d.jsxs("section",{className:"ficha-section",children:[d.jsx("h4",{className:"ficha-section-title",children:"Presupuestos & planes"}),d.jsx(SU,{onAdd:Pe}),d.jsxs("div",{className:"presu-list",children:[(_.presupuestos||[]).map(T=>d.jsxs("div",{className:"presu-item",children:[d.jsxs("div",{children:[d.jsx("div",{className:"presu-title",children:T.titulo}),d.jsxs("div",{className:"presu-meta",children:["Costo: $",T.costo||0,"  Estado: ",T.estado||"Pendiente"]})]}),d.jsx("button",{className:"btn small",onClick:()=>_e(T.id),children:"Eliminar"})]},T.id)),(!_.presupuestos||_.presupuestos.length===0)&&d.jsx("div",{className:"no-data",children:"Sin presupuestos an."})]})]}),v==="evo"&&d.jsxs("section",{className:"ficha-section",children:[d.jsx("h4",{className:"ficha-section-title",children:"Evoluciones & Remisiones"}),d.jsx(AU,{onAdd:$e}),d.jsxs("div",{className:"evo-list",children:[(_.evoluciones||[]).map(T=>d.jsxs("div",{className:"evo-item",children:[d.jsx("div",{className:"evo-date",children:new Date(T.fechaISO).toLocaleString()}),d.jsx("div",{className:"evo-note",children:T.nota}),d.jsx("button",{className:"btn small",onClick:()=>me(T.id),children:"Eliminar"})]},T.id)),(!_.evoluciones||_.evoluciones.length===0)&&d.jsx("div",{className:"no-data",children:"Sin evoluciones an."})]})]}),v==="fact"&&d.jsxs("section",{className:"ficha-section",children:[d.jsx("h4",{className:"ficha-section-title",children:"Facturacin"}),d.jsxs("div",{className:"ficha-grid",children:[d.jsxs("div",{className:"field",children:[d.jsx("label",{children:"Saldo a favor"}),d.jsx("input",{type:"number",className:"form-input",value:((ue=_.facturacion)==null?void 0:ue.saldoFavor)??0,onChange:T=>z({facturacion:{..._.facturacion||{},saldoFavor:Number(T.target.value||0)}})})]}),d.jsxs("div",{className:"field",children:[d.jsx("label",{children:"Saldo crdito"}),d.jsx("input",{type:"number",className:"form-input",value:((ne=_.facturacion)==null?void 0:ne.saldoCredito)??0,onChange:T=>z({facturacion:{..._.facturacion||{},saldoCredito:Number(T.target.value||0)}})})]})]}),d.jsxs("div",{className:"tools-right",style:{marginTop:8},children:[d.jsx("button",{className:"btn blue",onClick:()=>alert("Conecta aqu tu flujo de pago"),children:"Realizar pago"}),d.jsx("button",{className:"btn",onClick:()=>alert("Histrico de pagos (pendiente de tu backend)"),children:"Histrico de pagos"}),d.jsx("button",{className:"btn",onClick:()=>alert("Histrico de facturas (pendiente de tu backend)"),children:"Histrico de facturas"})]})]}),v==="citas"&&d.jsxs("section",{className:"ficha-section",children:[d.jsx("h4",{className:"ficha-section-title",children:"Citas"}),d.jsx("div",{className:"no-data",children:"Integra aqu la tabla de citas del paciente."})]}),v==="crm"&&d.jsxs("section",{className:"ficha-section",children:[d.jsx("h4",{className:"ficha-section-title",children:"CRM"}),d.jsx("div",{className:"no-data",children:"Notas / recordatorios comerciales del paciente."})]}),d.jsx("div",{className:"ficha-footer"})]})]})]})]})]})}function SU({onAdd:t}){const[e,n]=k.useState(""),[r,i]=k.useState(""),[s,o]=k.useState("Pendiente");return d.jsxs("div",{className:"presu-form",children:[d.jsx("input",{className:"form-input",placeholder:"Procedimiento / plan",value:e,onChange:a=>n(a.target.value)}),d.jsx("input",{type:"number",className:"form-input",placeholder:"Costo",value:r,onChange:a=>i(a.target.value)}),d.jsxs("select",{className:"form-input",value:s,onChange:a=>o(a.target.value),children:[d.jsx("option",{children:"Pendiente"}),d.jsx("option",{children:"Aprobado"}),d.jsx("option",{children:"Rechazado"})]}),d.jsx("button",{className:"btn blue",onClick:()=>{if(!e)return alert("Ttulo requerido");t({titulo:e,costo:Number(r||0),estado:s}),n(""),i(""),o("Pendiente")},children:"Agregar"})]})}function AU({onAdd:t}){const[e,n]=k.useState("");return d.jsxs("div",{className:"evo-form",children:[d.jsx("textarea",{className:"form-input",rows:2,placeholder:"Escribe la evolucin / remisin",value:e,onChange:r=>n(r.target.value)}),d.jsx("button",{className:"btn blue",onClick:()=>{e.trim()&&(t(e.trim()),n(""))},children:"Guardar evolucin"})]})}function CU(){return d.jsxs("div",{style:{padding:"20px"},children:[d.jsx("h2",{children:"Mdulo de Facturacin"}),d.jsx("p",{children:"Aqu se registrarn los pagos, facturas y cobros."})]})}const hi=t=>(Number(t)||0).toLocaleString("es-CO",{maximumFractionDigits:0}),bU=(t=new Date)=>new Date(t.getFullYear(),t.getMonth(),t.getDate(),0,0,0,0),RU=(t=new Date)=>new Date(t.getFullYear(),t.getMonth(),t.getDate()+1,0,0,0,0),ZI=t=>Ne.fromDate(t),PU=()=>{const[t,e]=k.useState(null);return k.useEffect(()=>{const n=fy(nh,r=>e(r||null));return()=>n()},[]),t},Pn=({children:t,align:e})=>d.jsx("th",{className:"oc-th",style:{position:"sticky",top:0,zIndex:1,textAlign:e||"left",background:"var(--oc-surface, #fff)"},children:t});function kU(){var De;const t=PU(),e=[{key:"abrir",label:"Abrir caja",icon:""},{key:"abiertas",label:"Cajas abiertas",icon:""},{key:"cerradas",label:"Cajas cerradas",icon:""},{key:"mio",label:"Mi caja (hoy)",icon:""},{key:"simulados",label:"Cierres simulados",icon:""},{key:"bancos",label:"Bancos",icon:""}],[n,r]=k.useState("abiertas"),[i,s]=k.useState(""),[o,a]=k.useState(""),l=k.useRef(null),[u,h]=k.useState(!1),[f,m]=k.useState(""),[E,_]=k.useState([]),[A,P]=k.useState(!0),[v,w]=k.useState([]),[y,V]=k.useState(!0),[U,$]=k.useState(null),[S,I]=k.useState(!0);k.useEffect(()=>{const H=mt(Xe(Se,"cajas"),It("estado","==","abierta"),gr("fechaApertura","desc")),L=Bi(H,z=>{_(z.docs.map(re=>C(re.id,re.data()))),P(!1),s("")},z=>{console.error(z),s((z==null?void 0:z.code)==="failed-precondition"?"Falta ndice (estado, fechaApertura) en Firestore.":(z==null?void 0:z.code)==="permission-denied"?"Permiso denegado en Firestore (revisa reglas).":"No se pudieron leer las cajas."),P(!1)});return()=>L()},[]),k.useEffect(()=>{const H=mt(Xe(Se,"cajas"),It("estado","==","cerrada"),gr("fechaCierre","desc")),L=Bi(H,z=>{w(z.docs.map(re=>C(re.id,re.data()))),V(!1)},z=>{console.error(z),V(!1)});return()=>L()},[]),k.useEffect(()=>{if(!t){$(null),I(!1);return}I(!0);const H=mt(Xe(Se,"cajas"),It("estado","==","abierta"),It("usuarioId","==",t.uid),It("fechaApertura",">=",ZI(bU())),It("fechaApertura","<",ZI(RU()))),L=Bi(H,z=>{const re=z.docs[0];$(re?C(re.id,re.data()):null),I(!1)},z=>{console.error(z),I(!1),(z==null?void 0:z.code)==="failed-precondition"&&s("Falta ndice (estado, usuarioId, fechaApertura) en Firestore.")});return()=>L()},[t]);function C(H,L={}){const z=Z=>{var xe;return((xe=Z==null?void 0:Z.toDate)==null?void 0:xe.call(Z))||(typeof Z=="string"?new Date(Z):Z||null)},re=z(L.fechaApertura),ye=z(L.fechaCierre),pe=Number(L.baseInicial||0),Pe=Number(L.baseActual!==void 0?L.baseActual:pe),_e=Number(L.saldoInicial||0),$e=Number(L.saldoActual!==void 0?L.saldoActual:_e),me=[];return $e<0&&me.push("Saldo negativo"),Pe<0&&me.push("Base negativa"),{id:H,estado:L.estado||"abierta",usuarioId:L.usuarioId||"",usuarioNombre:L.usuarioNombre||"Usuario",nombre:L.nombre||L.usuarioNombre||"Caja",fechaApertura:re,fechaCierre:ye,baseInicial:pe,baseActual:Pe,saldoInicial:_e,saldoActual:$e,ia:me}}const R=async H=>{var L;if((L=H==null?void 0:H.preventDefault)==null||L.call(H),!t){s("Debes iniciar sesin para abrir una caja.");return}h(!0);try{const z=Number(f||0);await HC(Xe(Se,"cajas"),{estado:"abierta",usuarioId:t.uid,usuarioNombre:t.displayName||t.email||"Usuario",fechaApertura:Pr(),baseInicial:z,baseActual:z,saldoInicial:0,saldoActual:0,dia:new Date().toISOString().slice(0,10)}),m(""),r("mio"),s("")}catch(z){console.error(z),s("No se pudo abrir la caja.")}finally{h(!1)}},N=async H=>{try{await Zd(Xt(Se,"cajas",H),{estado:"cerrada",fechaCierre:Pr()}),r("cerradas")}catch(L){console.error(L),s("No se pudo cerrar la caja.")}},D=H=>(H||"").toString().normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase(),b=k.useMemo(()=>{const H=D(o);return H?E.filter(L=>[L.nombre,L.usuarioNombre,hi(L.saldoActual),hi(L.baseActual)].map(D).some(z=>z.includes(H))):E},[o,E]);k.useEffect(()=>{const H=L=>{var z;(L.ctrlKey||L.metaKey)&&L.key.toLowerCase()==="k"&&(L.preventDefault(),(z=l.current)==null||z.focus())};return window.addEventListener("keydown",H),()=>window.removeEventListener("keydown",H)},[]);const Q=()=>d.jsxs("div",{className:"card",children:[d.jsx("div",{className:"oc-card-head",style:{marginBottom:8},children:d.jsx("h3",{children:"Abrir caja"})}),d.jsxs("form",{className:"oc-form",onSubmit:R,style:{display:"flex",gap:12,alignItems:"end",flexWrap:"wrap"},children:[d.jsxs("label",{style:{display:"inline-flex",flexDirection:"column",gap:6},children:[d.jsx("span",{children:"Base inicial (COP)"}),d.jsx("input",{type:"number",className:"oc-input",min:"0",step:"1000",value:f,onChange:H=>m(H.target.value),placeholder:"0"})]}),d.jsx("button",{className:"oc-btn",type:"submit",disabled:u,children:u?"Abriendo...":"Abrir caja"})]}),d.jsxs("p",{className:"oc-muted",style:{marginTop:8},children:["Se asociar a tu usuario y quedar visible en ",d.jsx("b",{children:"Mi caja (hoy)"}),"."]})]}),Be=()=>d.jsxs(d.Fragment,{children:[d.jsx("div",{className:"card",style:{marginBottom:10},children:d.jsxs("div",{className:"oc-card-head",style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[d.jsx("h3",{style:{margin:0},children:"Cajas Abiertas"}),d.jsx("span",{className:"oc-tag",children:b.length}),i&&d.jsx("span",{className:"oc-tag oc-tag-danger",children:i})]}),d.jsx("input",{ref:l,className:"oc-input",style:{maxWidth:280},placeholder:"Buscar...",value:o,onChange:H=>a(H.target.value)})]})}),d.jsx("div",{className:"card",children:d.jsx("div",{className:"oc-table-wrap",children:d.jsxs("table",{className:"oc-table",children:[d.jsx("thead",{className:"oc-thead",children:d.jsxs("tr",{className:"oc-tr",children:[d.jsx(Pn,{children:"Caja"}),d.jsx(Pn,{children:"Fecha apertura"}),d.jsx(Pn,{align:"right",children:"Base actual"}),d.jsx(Pn,{align:"right",children:"Saldo inicial"}),d.jsx(Pn,{align:"right",children:"Saldo actual"}),d.jsx(Pn,{children:"Usuario"}),d.jsx(Pn,{children:"Acciones"})]})}),d.jsx("tbody",{className:"oc-tbody",children:A?d.jsx(eT,{cols:7}):b.length===0?d.jsx("tr",{className:"oc-tr",children:d.jsx("td",{className:"oc-td",colSpan:7,children:d.jsx("span",{className:"oc-muted",children:"Sin cajas abiertas."})})}):b.map(H=>{var L;return d.jsxs("tr",{className:"oc-tr",children:[d.jsxs("td",{className:"oc-td",children:[d.jsx("b",{children:H.nombre})," ",(L=H.ia)!=null&&L.length?d.jsx("span",{className:"oc-tag oc-tag-danger",title:H.ia.join("  "),children:"IA"}):null]}),d.jsx("td",{className:"oc-td",children:H.fechaApertura?H.fechaApertura.toLocaleString("es-CO"):""}),d.jsxs("td",{className:"oc-td",style:{textAlign:"right"},children:["$",hi(H.baseActual)]}),d.jsxs("td",{className:"oc-td",style:{textAlign:"right"},children:["$",hi(H.saldoInicial)]}),d.jsxs("td",{className:"oc-td",style:{textAlign:"right",color:H.saldoActual<0?"#b91c1c":void 0,fontWeight:600},children:["$",hi(H.saldoActual)]}),d.jsx("td",{className:"oc-td",children:H.usuarioNombre}),d.jsxs("td",{className:"oc-td",style:{whiteSpace:"nowrap"},children:[d.jsx("button",{className:"oc-small-btn",onClick:()=>r("mio"),children:"Ver"})," ",d.jsx("button",{className:"oc-small-btn oc-danger",onClick:()=>N(H.id),children:"Cerrar"})]})]},H.id)})})]})})})]}),jt=()=>d.jsxs("div",{className:"card",children:[d.jsxs("div",{className:"oc-card-head",style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[d.jsx("h3",{children:"Mi caja (hoy)"}),(U==null?void 0:U.estado)==="abierta"&&d.jsxs("div",{style:{display:"flex",gap:8},children:[d.jsx("span",{className:"oc-tag oc-tag-success",children:"Abierta"}),d.jsx("button",{className:"oc-small-btn oc-danger",onClick:()=>N(U.id),children:"Cerrar caja"})]})]}),S?d.jsx("div",{className:"oc-muted",children:"Cargando"}):U?d.jsxs(d.Fragment,{children:[d.jsxs("div",{className:"oc-stats-row",style:{marginBottom:12},children:[d.jsxs("div",{className:"stat-card",children:[d.jsx("span",{className:"stat-label",children:"Base actual"}),d.jsxs("span",{className:"stat-value",children:["$",hi(U.baseActual)]})]}),d.jsxs("div",{className:"stat-card",children:[d.jsx("span",{className:"stat-label",children:"Saldo actual"}),d.jsxs("span",{className:"stat-value",style:{color:U.saldoActual<0?"#b91c1c":void 0},children:["$",hi(U.saldoActual)]})]})]}),d.jsxs("div",{className:"card",children:[d.jsx("h4",{children:"Movimientos (hoy)"}),d.jsxs("p",{className:"oc-muted",children:["Conecta tu coleccin ",d.jsx("code",{children:"movimientos"})," para listar ingresos/egresos y validar descuadres con IA."]})]})]}):d.jsxs("div",{className:"oc-empty",children:[d.jsx("p",{className:"oc-muted",children:"No tienes una caja abierta hoy."}),d.jsx("button",{className:"oc-btn",onClick:()=>r("abrir"),children:"Abrir caja"})]})]}),on=()=>d.jsxs("div",{className:"card",children:[d.jsx("div",{className:"oc-card-head",style:{marginBottom:8},children:d.jsxs("h3",{children:["Cajas cerradas ",d.jsx("span",{className:"oc-tag",children:v.length})]})}),d.jsx("div",{className:"oc-table-wrap",children:d.jsxs("table",{className:"oc-table",children:[d.jsx("thead",{className:"oc-thead",children:d.jsxs("tr",{className:"oc-tr",children:[d.jsx(Pn,{children:"Caja"}),d.jsx(Pn,{children:"Usuario"}),d.jsx(Pn,{children:"Apertura"}),d.jsx(Pn,{children:"Cierre"}),d.jsx(Pn,{align:"right",children:"Saldo final"})]})}),d.jsx("tbody",{className:"oc-tbody",children:y?d.jsx(eT,{cols:5}):v.length===0?d.jsx("tr",{className:"oc-tr",children:d.jsx("td",{className:"oc-td",colSpan:5,children:d.jsx("span",{className:"oc-muted",children:"Sin cajas cerradas."})})}):v.map(H=>d.jsxs("tr",{className:"oc-tr",children:[d.jsx("td",{className:"oc-td",children:H.nombre}),d.jsx("td",{className:"oc-td",children:H.usuarioNombre}),d.jsx("td",{className:"oc-td",children:H.fechaApertura?H.fechaApertura.toLocaleString("es-CO"):""}),d.jsx("td",{className:"oc-td",children:H.fechaCierre?H.fechaCierre.toLocaleString("es-CO"):""}),d.jsxs("td",{className:"oc-td",style:{textAlign:"right"},children:["$",hi(H.saldoActual)]})]},H.id))})]})})]}),J=()=>d.jsxs("div",{className:"card",children:[d.jsx("h3",{children:"Cierres simulados"}),d.jsx("p",{className:"oc-muted",children:"El cierre hipottico compara ventas y movimientos detectando errores y descuadres con IA. (Conectar fuente de datos para activarlo)."})]}),ce=()=>d.jsxs("div",{className:"card",children:[d.jsx("h3",{children:"Bancos"}),d.jsx("p",{className:"oc-muted",children:"Conciliacin de consignaciones/pagos electrnicos contra caja del da. (Conectar pasarela o extractos para habilitar)."})]}),he=({m:H})=>d.jsxs("button",{type:"button",onClick:()=>r(H.key),className:`oc-menu-item ${n===H.key?"active":""}`,style:{width:"100%",textAlign:"left",padding:"10px 12px",borderRadius:10,border:"1px solid transparent",background:n===H.key?"var(--oc-surface-2, #f3f6ff)":"transparent",fontWeight:600},title:H.label,children:[d.jsx("span",{style:{opacity:.8,marginRight:6},children:H.icon}),H.label]});return d.jsxs("div",{className:"oc-main-content",style:{display:"grid",gridTemplateColumns:"240px 1fr",gap:16},children:[d.jsx("aside",{className:"card",role:"navigation","aria-label":"Men de caja",style:{height:"fit-content",padding:12},children:d.jsx("div",{style:{display:"flex",flexDirection:"column",gap:8},children:e.map(H=>d.jsx(he,{m:H},H.key))})}),d.jsxs("section",{children:[d.jsx("div",{className:"card",style:{marginBottom:12,padding:12},children:d.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",gap:12},children:[d.jsxs("div",{className:"oc-breadcrumb",children:[d.jsx("span",{children:"Caja"}),d.jsx("span",{children:""}),d.jsx("b",{children:(De=e.find(H=>H.key===n))==null?void 0:De.label})]}),n==="abiertas"&&d.jsx("input",{ref:l,className:"oc-input",placeholder:"Buscar...",value:o,onChange:H=>a(H.target.value),style:{maxWidth:300}})]})}),n==="abrir"&&d.jsx(Q,{}),n==="abiertas"&&d.jsx(Be,{}),n==="cerradas"&&d.jsx(on,{}),n==="mio"&&d.jsx(jt,{}),n==="simulados"&&d.jsx(J,{}),n==="bancos"&&d.jsx(ce,{})]})]})}function eT({cols:t=6,n:e=3}){return d.jsx(d.Fragment,{children:Array.from({length:e}).map((n,r)=>d.jsx("tr",{className:"oc-tr",children:Array.from({length:t}).map((i,s)=>d.jsx("td",{className:"oc-td",children:d.jsx("div",{style:{height:12,width:s===0?160:100+s%3*40,background:"var(--oc-skeleton, #e5e7eb)",borderRadius:6}})},s))},r))})}function NU({items:t=[]}){return d.jsxs("div",{className:"card activity-card",children:[d.jsx("h4",{children:"Actividad reciente"}),d.jsx("ul",{className:"activity-list",children:t.map(e=>d.jsxs("li",{children:[d.jsx("strong",{children:e.title}),d.jsx("div",{className:"time",children:e.time})]},e.id))})]})}function DU({status:t}){return t?d.jsxs("div",{className:"card",children:[d.jsx("h4",{children:"Automatizaciones (N8N)"}),d.jsxs("div",{className:"n8n-line",children:[d.jsx("strong",{children:"Conectado:"})," ",t.connected?"S":"No"]}),d.jsxs("div",{className:"n8n-line",children:[d.jsx("strong",{children:"Flujos activos:"})," ",t.flowsRunning]}),t.lastError&&d.jsxs("div",{className:"n8n-error",children:["Error: ",t.lastError]})]}):null}const Ge={es:{nav_home:"Inicio",nav_agenda:"Agenda",nav_patients:"Pacientes",nav_billing:"Facturacin",nav_inventory:"Inventario",nav_odontogram:"Odontograma",nav_reports:"Reportes",nav_cash:"Caja",nav_admin:"Administracin",welcomeTitle:"Bienvenido a OdontoCloud",welcomeSubtitle:"Administra tus pacientes, agenda, inventario y facturacin de manera inteligente y moderna.",clinicLabel:"Clnica",userLabel:"Usuario",roleLabel:"Rol",searchPlaceholder:"Buscar acciones o ir a",stats_patientsToday:"Pacientes totales",stats_appointmentsToday:"Citas hoy",stats_revenueToday:"Facturacin hoy",stats_waiting:"En espera",stats_currency:"COP",n8n_title:"Automatizaciones (n8n)",recent_title:"Actividad reciente",recent_empty:"Sin actividad registrada.",loading:"Cargando...",logout:"Cerrar sesin",module_coming:"Mdulo prximamente.",todays_appts:"Citas de hoy",see_schedule:"Ir a Agenda",no_appts_today:"No hay citas programadas hoy.",at:"a las"},en:{nav_home:"Overview",nav_agenda:"Schedule",nav_patients:"Patients",nav_billing:"Billing",nav_inventory:"Inventory",nav_odontogram:"Odontogram",nav_reports:"Reports",nav_cash:"Cash",nav_admin:"Administration",welcomeTitle:"Welcome to OdontoCloud",welcomeSubtitle:"Manage your patients, schedule, inventory and billing in a smart and modern way.",clinicLabel:"Clinic",userLabel:"User",roleLabel:"Role",searchPlaceholder:"Search actions or go to",stats_patientsToday:"Total patients",stats_appointmentsToday:"Appointments today",stats_revenueToday:"Revenue today",stats_waiting:"In waiting room",stats_currency:"COP",n8n_title:"Automations (n8n)",recent_title:"Recent activity",recent_empty:"No activity yet.",loading:"Loading...",logout:"Log out",module_coming:"Module coming soon.",todays_appts:"Today's appointments",see_schedule:"Open Schedule",no_appts_today:"No appointments today.",at:"at"}},VU=()=>typeof navigator>"u"||(navigator.language||navigator.userLanguage||"es").toLowerCase().startsWith("es")?"es":"en",OU=()=>{try{const t=JSON.parse(localStorage.getItem("odc_session"));return t&&Date.now()-t.timestamp<1e3*60*60*24?t:null}catch{return null}},jU=()=>k.useMemo(()=>{const t=new Date,e=new Date(t.getFullYear(),t.getMonth(),t.getDate(),0,0,0,0),n=new Date(t.getFullYear(),t.getMonth(),t.getDate()+1,0,0,0,0);return{startToday:Ne.fromDate(e),endToday:Ne.fromDate(n),startTodayJS:e}},[]),LU=t=>`${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,"0")}-${String(t.getDate()).padStart(2,"0")}`,MU=(t,e)=>t.toLocaleTimeString(e==="es"?"es-CO":"en-US",{hour:"2-digit",minute:"2-digit"}),FU=(t,e)=>{try{const[n,r,i]=(t||"").split("-").map(a=>parseInt(a,10)),[s=0,o=0]=(e||"00:00").split(":").map(a=>parseInt(a,10));return new Date(n,(r||1)-1,i||1,s,o,0,0)}catch{return new Date}};function UU({data:t=[]}){const i=Math.max(1,...t.map(u=>Number(u.value)||0)),s=t.length||7,o=10,a=Math.max(16,Math.min(44,(640-o*(s+1))/s)),l=(a+o)*s+o;return d.jsx("div",{style:{width:"100%",overflowX:"auto"},children:d.jsxs("svg",{width:l,height:240,role:"img","aria-label":"Pacientes registrados por da en la ltima semana",children:[[.25,.5,.75,1].map((u,h)=>{const f=18+(1-u)*182;return d.jsx("line",{x1:0,x2:l,y1:f,y2:f,stroke:"#e5e7eb",strokeDasharray:"4 4"},h)}),t.map((u,h)=>{const f=Number(u.value)||0,m=Math.round(f/i*182),E=o+h*(a+o),_=200-m;return d.jsxs("g",{children:[d.jsx("rect",{x:E,y:_,width:a,height:m,rx:"6",ry:"6",fill:f>0?"#0ea5e9":"#cbd5e1",children:d.jsx("title",{children:`${u.label||u.shortLabel||""}  ${f} paciente${f!==1?"s":""}`})}),f>0&&m>14&&d.jsx("text",{x:E+a/2,y:_-6,textAnchor:"middle",fontSize:"11",fill:"#0f172a",children:f}),d.jsx("text",{x:E+a/2,y:214,textAnchor:"middle",fontSize:"11",fill:"#64748b",children:u.shortLabel||""})]},h)})]})})}function BU({onNavigate:t,onAction:e,placeholder:n}){const[r,i]=k.useState(""),[s,o]=k.useState(!1),[a,l]=k.useState(0),u=k.useRef(null),h=k.useMemo(()=>[{group:"Navegacin",label:"Ir a Inicio",keywords:"inicio home overview",run:()=>t==null?void 0:t("Inicio")},{group:"Navegacin",label:"Ir a Agenda",keywords:"agenda calendario schedule",run:()=>t==null?void 0:t("Agenda")},{group:"Navegacin",label:"Ir a Pacientes",keywords:"pacientes",run:()=>t==null?void 0:t("Pacientes")},{group:"Navegacin",label:"Ir a Facturacin",keywords:"facturacion facturas billing",run:()=>t==null?void 0:t("Facturacin")},{group:"Navegacin",label:"Ir a Inventario",keywords:"inventario stock",run:()=>t==null?void 0:t("Inventario")},{group:"Navegacin",label:"Ir a Odontograma",keywords:"odontograma",run:()=>t==null?void 0:t("Odontograma")},{group:"Navegacin",label:"Ir a Reportes",keywords:"reportes informes",run:()=>t==null?void 0:t("Reportes")},{group:"Acciones",label:"Nueva cita",keywords:"nueva cita agendar",run:()=>e==null?void 0:e("new_appointment")},{group:"Acciones",label:"Nuevo paciente",keywords:"nuevo paciente alta",run:()=>e==null?void 0:e("new_patient")},{group:"Acciones",label:"Nueva factura",keywords:"nueva factura",run:()=>e==null?void 0:e("new_invoice")},{group:"Acciones",label:"Exportar agenda",keywords:"exportar agenda",run:()=>e==null?void 0:e("export_agenda")},{group:"Acciones",label:"Ir a hoy (Agenda)",keywords:"hoy today",run:()=>e==null?void 0:e("agenda_today")},{group:"Acciones",label:"Cambiar modo oscuro",keywords:"oscuro dark mode",run:()=>e==null?void 0:e("toggle_dark")},{group:"Acciones",label:"Cerrar sesin",keywords:"logout salir cerrar",run:()=>e==null?void 0:e("logout")},{group:"Ayuda",label:"Ver atajos de teclado",keywords:"atajos ayuda",run:()=>e==null?void 0:e("show_shortcuts")},{group:"Ayuda",label:"Soporte / Contacto",keywords:"soporte ayuda contacto",run:()=>e==null?void 0:e("support")}],[t,e]),f=k.useMemo(()=>{const A=r.toLowerCase().trim();return A?h.filter(P=>P.label.toLowerCase().includes(A)||P.keywords.includes(A)):[]},[r,h]);k.useEffect(()=>{const A=P=>{u.current&&(u.current.contains(P.target)||o(!1))};return document.addEventListener("mousedown",A),()=>document.removeEventListener("mousedown",A)},[]);const m=A=>{var P;(P=A.run)==null||P.call(A),i(""),o(!1)},E=A=>{!s||f.length===0||(A.key==="ArrowDown"&&(A.preventDefault(),l(P=>(P+1)%f.length)),A.key==="ArrowUp"&&(A.preventDefault(),l(P=>(P-1+f.length)%f.length)),A.key==="Enter"&&(A.preventDefault(),f[a]&&m(f[a])),A.key==="Escape"&&o(!1))},_=k.useMemo(()=>{const A=new Map;return f.forEach(P=>{A.has(P.group)||A.set(P.group,[]),A.get(P.group).push(P)}),Array.from(A.entries())},[f]);return d.jsxs("div",{className:"oc-search-wrap",ref:u,children:[d.jsx("input",{className:"oc-search",type:"search",inputMode:"search",placeholder:n,"aria-label":n,value:r,onChange:A=>{i(A.target.value),o(!!A.target.value),l(0)},onFocus:()=>o(!!r),onKeyDown:E}),s&&d.jsx("div",{className:"oc-search-dropdown",role:"listbox","aria-label":"Resultados de comandos",children:_.length===0?d.jsx("div",{className:"oc-search-item empty",children:"Escribe para ver opciones"}):_.map(([A,P])=>d.jsxs("div",{children:[d.jsx("div",{className:"oc-search-group",children:A}),P.map(v=>{const w=f.indexOf(v);return d.jsx("button",{className:`oc-search-item ${w===a?"active":""}`,onMouseEnter:()=>l(w),onClick:()=>m(v),role:"option",children:d.jsx("span",{className:"oc-search-title",children:v.label})},v.label)})]},A))})]})}function $U({open:t,anchorRect:e,onClose:n,onGo:r,onSoon:i,onFact:s,dark:o}){const[a,l]=k.useState(null),u=k.useRef(null);if(k.useEffect(()=>{if(!t)return;const Q=jt=>jt.key==="Escape"&&(n==null?void 0:n()),Be=()=>n==null?void 0:n();return window.addEventListener("keydown",Q),window.addEventListener("scroll",Be,!0),()=>{window.removeEventListener("keydown",Q),window.removeEventListener("scroll",Be,!0)}},[t,n]),!t)return null;const h=((e==null?void 0:e.bottom)||60)+8,f=Math.max(12,Math.min(((e==null?void 0:e.left)||300)-160,window.innerWidth-920)),m=10,E=f+360+m,_=o?"#0b1220":"#ffffff",A=o?"#e5e7eb":"#0f172a",P=o?"#0f1a32":"#f3f6ff",v=o?"#1f2a44":"#e2e8f0",w=o?"#b6c1d1":"#475569",y={position:"fixed",top:h,left:f,width:880,maxWidth:"calc(100vw - 24px)",background:_,color:A,borderRadius:14,boxShadow:"0 18px 40px rgba(2,6,23,.18)",border:`1px solid ${v}`,zIndex:400,padding:12},V={position:"fixed",top:h,left:E,width:420,maxWidth:"calc(100vw - 24px)",background:_,color:A,borderRadius:14,boxShadow:"0 18px 40px rgba(2,6,23,.18)",border:`1px solid ${v}`,zIndex:410,padding:12},U={display:"flex",flexDirection:"column",gap:6,padding:"8px 10px"},$={height:38,borderRadius:10,padding:"0 12px",display:"flex",alignItems:"center",gap:8,fontSize:".92rem",cursor:"pointer",border:"1px solid transparent",background:"transparent",color:A,fontWeight:500,textAlign:"left"},S=(Q,Be=!0)=>Object.assign(Q.currentTarget.style,Be?{background:P,borderColor:v}:{background:"transparent",borderColor:"transparent"}),I=()=>{u.current&&clearTimeout(u.current)},C=()=>{I(),u.current=setTimeout(()=>n==null?void 0:n(),180)},R={position:"fixed",top:h,left:f+360,width:m,height:520,zIndex:405},N=[{label:"Recibo de caja",key:"recibo"},{label:"Saldo a favor",key:"saldo"},{label:"Nota crdito",key:"nc"},{label:"Nota dbito",key:"nd"},{label:"Liquidaciones",key:"liq"},{label:"Traslados",key:"tras"},{label:"Pagos",key:"pagos"},{label:"rdenes de compra",key:"oc"},{label:"Factura de venta",key:"fv"},{label:"Facturas de compra",key:"fc"}],D=[{label:"RIPS anteriores (RS-3374)",key:"rips3374"},{label:"RIPS nuevo (RS-2275)",key:"rips2275"}],b=Q=>{s==null||s(Q),r==null||r("Facturacin")};return d.jsxs(d.Fragment,{children:[d.jsx("div",{onClick:n,style:{position:"fixed",inset:0,background:"transparent",zIndex:399}}),d.jsx("div",{style:y,onMouseEnter:I,onMouseLeave:C,children:d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"360px 1fr",gap:8,alignItems:"start"},children:[d.jsxs("div",{style:U,children:[d.jsx("button",{type:"button",style:$,onMouseEnter:()=>{I(),l("facturacion")},onFocus:()=>{I(),l("facturacion")},onClick:()=>l(Q=>Q==="facturacion"?null:"facturacion"),onMouseOver:Q=>S(Q,!0),onMouseOut:Q=>S(Q,!1),children:" Facturacin "}),d.jsx("button",{type:"button",style:$,onMouseEnter:()=>{I(),l("rips")},onFocus:()=>{I(),l("rips")},onClick:()=>l(Q=>Q==="rips"?null:"rips"),onMouseOver:Q=>S(Q,!0),onMouseOut:Q=>S(Q,!1),children:" RIPS "}),d.jsx("button",{type:"button",style:$,onClick:()=>i==null?void 0:i(),onMouseOver:Q=>S(Q,!0),onMouseOut:Q=>S(Q,!1),children:" Convenios"}),d.jsx("button",{type:"button",style:$,onClick:()=>r==null?void 0:r("Agenda"),onMouseOver:Q=>S(Q,!0),onMouseOut:Q=>S(Q,!1),children:" Gestin de agenda"}),d.jsx("button",{type:"button",style:$,onClick:()=>i==null?void 0:i(),onMouseOver:Q=>S(Q,!0),onMouseOut:Q=>S(Q,!1),children:" Terceros"}),d.jsx("button",{type:"button",style:$,onClick:()=>i==null?void 0:i(),onMouseOver:Q=>S(Q,!0),onMouseOut:Q=>S(Q,!1),children:" Campaas"}),d.jsx("button",{type:"button",style:$,onClick:()=>i==null?void 0:i(),onMouseOver:Q=>S(Q,!0),onMouseOut:Q=>S(Q,!1),children:" Temperatura y humedad"}),d.jsx("button",{type:"button",style:$,onClick:()=>i==null?void 0:i(),onMouseOver:Q=>S(Q,!0),onMouseOut:Q=>S(Q,!1),children:" Residuos"}),d.jsx("button",{type:"button",style:$,onClick:()=>r==null?void 0:r("Inventario"),onMouseOver:Q=>S(Q,!0),onMouseOut:Q=>S(Q,!1),children:" Inventario"}),d.jsx("button",{type:"button",style:$,onClick:()=>i==null?void 0:i(),onMouseOver:Q=>S(Q,!0),onMouseOut:Q=>S(Q,!1),children:" Medicamentos y planes"}),d.jsx("button",{type:"button",style:$,onClick:()=>i==null?void 0:i(),onMouseOver:Q=>S(Q,!0),onMouseOut:Q=>S(Q,!1),children:" Esterilizacin"})]}),d.jsx("div",{style:U,children:d.jsxs("div",{style:{fontSize:".85rem",color:w},children:["Accesos rpidos a mdulos de administracin. Pasa el mouse por ",d.jsx("b",{children:"Facturacin"})," o ",d.jsx("b",{children:"RIPS"})," para ver sus acciones."]})})]})}),d.jsx("div",{style:R,onMouseEnter:I,onMouseLeave:C}),a&&d.jsx("div",{style:V,onMouseEnter:I,onMouseLeave:C,children:d.jsx("div",{style:{...U,display:"grid",gridTemplateColumns:"1fr"},children:(a==="facturacion"?N:D).map(Q=>d.jsx("button",{type:"button",style:$,onClick:()=>a==="facturacion"?b(Q.key):i==null?void 0:i(),onMouseOver:Be=>S(Be,!0),onMouseOut:Be=>S(Be,!1),children:Q.label},Q.label))})})]})}function Ep(){const[t]=k.useState(VU()),e=ee=>Ge[t][ee]||ee,[n,r]=k.useState("Inicio"),[i,s]=k.useState("recibo"),[o,a]=k.useState(()=>{try{return localStorage.getItem("odontocloud:dark")==="1"}catch{return!1}});k.useEffect(()=>{try{localStorage.setItem("odontocloud:dark",o?"1":"0")}catch{}document.documentElement.classList.toggle("dark",o)},[o]);const[l]=k.useState(()=>OU()),[u]=k.useState((l==null?void 0:l.rol)||""),[h]=k.useState((l==null?void 0:l.email)||""),[f,m]=k.useState("OdontoCloud"),[E,_]=k.useState(h||"Usuario"),[A,P]=k.useState(!0);k.useEffect(()=>{const ee=fy(nh,async te=>{try{if(!te){_(h||"Usuario"),m("OdontoCloud"),P(!1);return}_(te.displayName||te.email||h||"Usuario");const ue=Xt(Se,"empresas",te.uid),ne=await Xd(ue);m(ne.exists()&&ne.data().nombre||"OdontoCloud")}catch(ue){console.error("Error cargando empresa/usuario:",ue)}finally{P(!1)}});return()=>ee()},[h]);const[v,w]=k.useState({pacientesHoy:0,citasHoy:0,facturacionHoy:0,enEspera:0}),[y,V]=k.useState(!0),[U,$]=k.useState([]),[S,I]=k.useState([]),[C,R]=k.useState(!0),{startToday:N,endToday:D,startTodayJS:b}=jU(),Q=k.useMemo(()=>LU(b),[b]),Be=k.useMemo(()=>{const ee=new Date,te=new Date(ee.getFullYear(),ee.getMonth(),ee.getDate()-6),ue=ee,ne=T=>T.toLocaleDateString(t==="es"?"es-ES":"en-US",{weekday:"short",day:"2-digit",month:"short"}).replace(".","");return`${ne(te)}  ${ne(ue)}`},[t]),jt=ee=>{var M;const te=ee.data()||{};let ue;if((M=te.fecha)!=null&&M.toDate){ue=te.fecha.toDate();const q=te.horaInicio||te.hora;if(q&&typeof q=="string"){const[oe=0,le=0]=q.split(":").map(ve=>parseInt(ve,10));ue.setHours(oe||0,le||0,0,0)}}else if(typeof te.fecha=="string"){const q=te.horaInicio||te.hora||"00:00";ue=FU(te.fecha,q)}else ue=new Date;const ne=te.pacienteNombre||te.paciente||"Paciente",T=te.estado&&String(te.estado)||"programada";return{id:ee.id,fecha:ue,pacienteId:te.pacienteId||"",pacienteNombre:ne,estado:T,motivo:te.motivo||""}};k.useEffect(()=>{const ee=mt(Xe(Se,"citas"),It("fecha",">=",N),It("fecha","<",D),gr("fecha","asc")),te=mt(Xe(Se,"citas"),It("fecha","==",Q));let ue=new Map,ne=!1,T=!1;const M=()=>{const q=Array.from(ue.values()).sort((le,ve)=>le.fecha.getTime()-ve.fecha.getTime()),oe=q.filter(le=>String(le.estado).toLowerCase().trim()==="en espera").length;I(q),w(le=>({...le,citasHoy:q.length,enEspera:oe})),ne&&T&&R(!1)};Bi(ee,q=>{ne=!0;const oe=new Map(ue);q.docs.forEach(le=>oe.set(le.id,jt(le))),ue=oe,M()},q=>{console.error("Realtime citas hoy (TS):",q),ne=!0,M()}),Bi(te,q=>{T=!0;const oe=new Map(ue);q.docs.forEach(le=>oe.set(le.id,jt(le))),ue=oe,M()},q=>{console.error("Realtime citas hoy (STR):",q),T=!0,M()})},[N,D,Q]),k.useEffect(()=>{(async()=>{try{const ue=(await xM(Xe(Se,"pacientes"))).data().count||0;let ne=0;try{const T=mt(Xe(Se,"facturas"),It("fecha",">=",N),It("fecha","<",D));(await En(T)).forEach(q=>{const oe=q.data();typeof oe.monto=="number"&&(ne+=oe.monto)})}catch{ne=0}w(T=>({...T,pacientesHoy:ue,facturacionHoy:ne}))}catch(te){console.error("Error cargando mtricas:",te),w(ue=>({...ue,pacientesHoy:0,facturacionHoy:0}))}finally{V(!1)}})()},[N,D]),k.useEffect(()=>{const ee=new Date,te=new Date(ee.getFullYear(),ee.getMonth(),ee.getDate()-6),ue=new Date(ee.getFullYear(),ee.getMonth(),ee.getDate()+1),ne=new Map;for(let q=0;q<7;q++){const oe=new Date(ee.getFullYear(),ee.getMonth(),ee.getDate()-(6-q)),le=oe.toISOString().slice(0,10),ve=oe.toLocaleDateString(t==="es"?"es-ES":"en-US"),qe=oe.toLocaleDateString(t==="es"?"es-ES":"en-US",{weekday:"short",day:"2-digit"}).replace(".","");ne.set(le,{label:ve,shortLabel:qe,value:0})}const T=mt(Xe(Se,"pacientes"),It("createdAt",">=",Ne.fromDate(te)),It("createdAt","<",Ne.fromDate(ue))),M=Bi(T,q=>{const oe=new Map(ne);q.docs.forEach(le=>{var Re;const ve=le.data()||{},qe=(Re=le.data().createdAt)!=null&&Re.toDate?le.data().createdAt.toDate():ve.createdAt?new Date(ve.createdAt):null;if(!qe||isNaN(qe))return;const Ie=qe.toISOString().slice(0,10);if(!oe.has(Ie))return;const He=oe.get(Ie);He.value+=1,oe.set(Ie,He)}),$(Array.from(oe.values()))},q=>{console.error("Error realtime serie semanal (pacientes):",q),$(Array.from(ne.values()))});return()=>{try{M()}catch{}}},[t]);const[on,J]=k.useState([]),[ce,he]=k.useState(!0);k.useEffect(()=>{(async()=>{try{const te=mt(Xe(Se,"actividad"),gr("fecha","desc"),Go(5)),ue=await En(te);J(ue.docs.map(ne=>({id:ne.id,title:ne.data().descripcion||ne.data().titulo||"Actividad",time:ne.data().resumenTiempo||""})))}catch(te){console.error("Error cargando actividad:",te),J([])}finally{he(!1)}})()},[]);const[De,H]=k.useState(null),[L,z]=k.useState(!0);k.useEffect(()=>{(async()=>{try{const te=Xt(Se,"integraciones","n8n"),ue=await Xd(te);H(ue.exists()?{connected:!!ue.data().connected,flowsRunning:ue.data().flowsRunning||0,lastError:ue.data().lastError||null}:{connected:!1,flowsRunning:0,lastError:null})}catch(te){console.error("Error cargando estado n8n:",te),H({connected:!1,flowsRunning:0,lastError:"No se pudo leer el estado desde Firebase."})}finally{z(!1)}})()},[]);const re=async()=>{try{localStorage.removeItem("odc_session")}catch{}try{await R2(nh)}catch(ee){console.error("Error al cerrar sesin:",ee)}window.location.href="/"},[ye,pe]=k.useState(!1),[Pe,_e]=k.useState(null),$e=k.useRef(null),me=k.useRef(null),Z=()=>{var te,ue;const ee=(ue=(te=$e.current)==null?void 0:te.getBoundingClientRect)==null?void 0:ue.call(te);_e(ee),pe(!0)},xe=()=>{pe(!1),me.current&&(clearTimeout(me.current),me.current=null)},vt=()=>{me.current&&(clearTimeout(me.current),me.current=null)},Pt=()=>{switch(n){case"Agenda":return d.jsx(gU,{});case"Pacientes":return d.jsx(xU,{});case"Facturacin":return d.jsx(yU,{view:i});case"Inventario":return d.jsx(_U,{});case"Odontograma":return d.jsx(vU,{});case"Reportes":return d.jsx(CU,{});case"Caja":return d.jsx(kU,{});case"Inicio":default:return null}};return d.jsxs("div",{className:`oc-shell ${o?"oc-dark":""}`,children:[d.jsx("a",{href:"#oc-main",className:"oc-skip-link",children:"Saltar al contenido"}),d.jsxs("header",{className:"oc-header",role:"banner",children:[d.jsxs("div",{className:"oc-header-left",children:[d.jsx("img",{src:ab,alt:"OdontoCloud",className:"oc-logo"}),d.jsxs("div",{className:"oc-brand-text",children:[d.jsx("span",{className:"oc-brand-main",children:"OdontoCloud"}),d.jsx("span",{className:"oc-brand-sub",children:A?"...":f})]})]}),d.jsxs("nav",{className:"oc-nav",role:"navigation","aria-label":"Navegacin principal",children:[d.jsx("button",{type:"button",className:n==="Inicio"?"oc-nav-btn active":"oc-nav-btn","aria-current":n==="Inicio"?"page":void 0,onClick:()=>r("Inicio"),title:e("nav_home"),children:e("nav_home")}),d.jsx("button",{type:"button",className:n==="Agenda"?"oc-nav-btn active":"oc-nav-btn","aria-current":n==="Agenda"?"page":void 0,onClick:()=>r("Agenda"),title:e("nav_agenda"),children:e("nav_agenda")}),d.jsx("button",{type:"button",className:n==="Pacientes"?"oc-nav-btn active":"oc-nav-btn","aria-current":n==="Pacientes"?"page":void 0,onClick:()=>r("Pacientes"),title:e("nav_patients"),children:e("nav_patients")}),d.jsx("button",{type:"button",className:n==="Caja"?"oc-nav-btn active":"oc-nav-btn",onClick:()=>r("Caja"),title:e("nav_cash"),children:e("nav_cash")}),d.jsx("button",{type:"button",ref:$e,className:"oc-nav-btn",title:e("nav_admin"),"aria-haspopup":"true","aria-expanded":ye,onClick:()=>ye?xe():Z(),onMouseEnter:()=>{vt(),Z()},onFocus:()=>{vt(),Z()},children:e("nav_admin")}),d.jsx("button",{type:"button",className:n==="Reportes"?"oc-nav-btn active":"oc-nav-btn","aria-current":n==="Reportes"?"page":void 0,onClick:()=>r("Reportes"),title:e("nav_reports"),children:e("nav_reports")})]}),d.jsxs("div",{className:"oc-header-right",children:[d.jsx(BU,{placeholder:e("searchPlaceholder"),onNavigate:ee=>r(ee),onAction:ee=>{switch(ee){case"new_appointment":r("Agenda");break;case"new_patient":r("Pacientes");break;case"new_invoice":r("Facturacin"),s("fv");break;case"export_agenda":r("Agenda");break;case"agenda_today":r("Agenda");break;case"toggle_dark":a(te=>!te);break;case"logout":re();break;case"show_shortcuts":alert("Atajos: Ctrl/Cmd + K para abrir bsqueda, / para moverse, Enter para ejecutar.");break;case"support":window.open("https://tu-soporte.odc","_blank");break}}}),d.jsx("button",{className:"oc-icon-btn",type:"button",onClick:()=>a(ee=>!ee),"aria-pressed":o,title:o?"Activar modo claro":"Activar modo oscuro",children:o?"":""}),d.jsx("button",{className:"oc-icon-btn",type:"button",onClick:re,title:Ge[t].logout,children:Ge[t].logout})]})]}),d.jsx($U,{open:ye,anchorRect:Pe,dark:o,onClose:xe,onGo:ee=>{r(ee),xe()},onSoon:()=>{alert("Prximamente"),xe()},onFact:ee=>{s(ee)}}),d.jsxs("main",{id:"oc-main",className:"oc-main-wrapper",role:"main",children:[n!=="Inicio"&&Pt(),n==="Inicio"&&d.jsxs("div",{className:"oc-main-content",children:[d.jsxs("section",{className:"oc-hero","aria-label":"Resumen general",children:[d.jsxs("div",{className:"oc-hero-text",children:[d.jsx("h1",{children:Ge[t].welcomeTitle}),d.jsx("p",{children:Ge[t].welcomeSubtitle}),d.jsxs("p",{className:"oc-hero-meta",children:[Ge[t].clinicLabel,": ",f,"  ",Ge[t].userLabel,":"," ",E,"  ",Ge[t].roleLabel,": ",u||""]})]}),d.jsxs("div",{className:"oc-hero-badge","aria-live":"polite",children:[d.jsx("span",{className:"oc-hero-badge-title",children:Ge[t].stats_appointmentsToday}),d.jsx("span",{className:"oc-hero-badge-value",children:y&&C?"":v.citasHoy}),d.jsxs("span",{className:"oc-hero-badge-sub",children:[Ge[t].stats_patientsToday,": ",y?"":v.pacientesHoy]})]})]}),d.jsxs("section",{className:"oc-stats-row","aria-label":"Indicadores del da",children:[d.jsxs("div",{className:"stat-card",children:[d.jsx("span",{className:"stat-label",children:Ge[t].stats_patientsToday}),d.jsx("span",{className:"stat-value",children:v.pacientesHoy})]}),d.jsxs("div",{className:"stat-card",children:[d.jsx("span",{className:"stat-label",children:Ge[t].stats_appointmentsToday}),d.jsx("span",{className:"stat-value",children:v.citasHoy})]}),d.jsxs("div",{className:"stat-card",children:[d.jsx("span",{className:"stat-label",children:Ge[t].stats_revenueToday}),d.jsxs("span",{className:"stat-value",children:[v.facturacionHoy.toLocaleString("es-CO")," ",d.jsx("span",{className:"stat-currency",children:Ge[t].stats_currency})]})]}),d.jsxs("div",{className:"stat-card",children:[d.jsx("span",{className:"stat-label",children:Ge[t].stats_waiting}),d.jsx("span",{className:"stat-value",children:v.enEspera})]})]}),d.jsxs("section",{className:"oc-grid","aria-label":"Contenido principal del dashboard",children:[d.jsx("div",{className:"oc-grid-main",children:d.jsxs("div",{className:"card card-quickcharts",children:[d.jsxs("div",{className:"oc-card-head",style:{display:"flex",justifyContent:"space-between",alignItems:"center",gap:8},children:[d.jsx("h3",{children:"Pacientes registrados  ltimos 7 das"}),d.jsx("span",{className:"oc-muted",style:{marginLeft:8,fontSize:12},children:Be})]}),U.length===0||U.every(ee=>((ee==null?void 0:ee.value)||0)===0)?d.jsx("p",{className:"oc-weekly-empty",children:"Sin pacientes registrados en la ltima semana."}):d.jsx(UU,{data:U})]})}),d.jsxs("aside",{className:"oc-grid-side","aria-label":"Panel lateral",children:[d.jsxs("div",{className:"card",children:[d.jsx("h3",{children:Ge[t].n8n_title}),L?d.jsx("span",{className:"oc-muted",children:Ge[t].loading}):d.jsx(DU,{status:De})]}),d.jsxs("div",{className:"card",children:[d.jsxs("div",{className:"oc-card-head",style:{display:"flex",justifyContent:"space-between",alignItems:"center",gap:8},children:[d.jsx("h3",{children:Ge[t].todays_appts}),d.jsx("button",{className:"oc-small-link",type:"button",onClick:()=>r("Agenda"),children:Ge[t].see_schedule})]}),C?d.jsx("span",{className:"oc-muted",children:Ge[t].loading}):S.length===0?d.jsx("p",{className:"oc-muted",children:Ge[t].no_appts_today}):d.jsx("ul",{className:"oc-list",children:S.slice(0,5).map(ee=>d.jsxs("li",{className:"oc-list-item",children:[d.jsxs("div",{className:"oc-list-main",children:[d.jsx("b",{children:ee.pacienteNombre||"Paciente"})," ",d.jsxs("span",{className:"oc-muted",children:[Ge[t].at," ",MU(ee.fecha,t)]})]}),d.jsx("div",{className:`oc-tag oc-tag-${(ee.estado||"programada").toLowerCase().replace(/\s+/g,"-")}`,children:ee.estado||"programada"})]},ee.id))})]}),d.jsxs("div",{className:"card",children:[d.jsx("h3",{children:Ge[t].recent_title}),ce?d.jsx("span",{className:"oc-muted",children:Ge[t].loading}):on.length===0?d.jsx("p",{className:"oc-muted",children:Ge[t].recent_empty}):d.jsx(NU,{items:on})]})]})]}),d.jsxs("footer",{className:"oc-footer",children:[" ",new Date().getFullYear()," OdontoCloud | Creado por Ingeniero Juan Madrid"]})]})]})]})}const zU=()=>{try{const t=JSON.parse(localStorage.getItem("odc_session"));return t&&Date.now()-t.timestamp<1e3*60*60*24?t:null}catch{return null}};function Ip({allowedRoles:t,children:e}){var i;const n=zU();if(!n)return d.jsx(gm,{to:"/",replace:!0});const r=(i=n.rol)==null?void 0:i.toLowerCase();return t.map(s=>s.toLowerCase()).includes(r)?e:d.jsx(gm,{to:"/",replace:!0})}function qU(){return d.jsxs(pk,{children:[d.jsx(vo,{path:"/",element:d.jsx(WF,{})}),d.jsx(vo,{path:"/dashboard_admin",element:d.jsx(Ip,{allowedRoles:["administrador"],children:d.jsx(Ep,{})})}),d.jsx(vo,{path:"/dashboard_doctor",element:d.jsx(Ip,{allowedRoles:["doctor"],children:d.jsx(Ep,{})})}),d.jsx(vo,{path:"/dashboard_recepcion",element:d.jsx(Ip,{allowedRoles:["recepcionista"],children:d.jsx(Ep,{})})}),d.jsx(vo,{path:"*",element:d.jsx(gm,{to:"/",replace:!0})})]})}async function HU(){try{await A2(nh,IS),await lM(Se),console.log(" Firebase listo con sesin persistente y modo offline.")}catch(t){console.warn(" Firebase offline/persistencia fall:",t.message)}}const WU="modulepreload",KU=function(t){return"/odontocloud-react/"+t},tT={},GU=function(e,n,r){let i=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),a=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));i=Promise.allSettled(n.map(l=>{if(l=KU(l),l in tT)return;tT[l]=!0;const u=l.endsWith(".css"),h=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${h}`))return;const f=document.createElement("link");if(f.rel=u?"stylesheet":WU,u||(f.as="script"),f.crossOrigin="",f.href=l,a&&f.setAttribute("nonce",a),document.head.appendChild(f),u)return new Promise((m,E)=>{f.addEventListener("load",m),f.addEventListener("error",()=>E(new Error(`Unable to preload CSS for ${l}`)))})}))}function s(o){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=o,window.dispatchEvent(a),!a.defaultPrevented)throw o}return i.then(o=>{for(const a of o||[])a.status==="rejected"&&s(a.reason);return e().catch(s)})};function QU(t={}){const{immediate:e=!1,onNeedRefresh:n,onOfflineReady:r,onRegistered:i,onRegisteredSW:s,onRegisterError:o}=t;let a,l;const u=async(f=!0)=>{await l};async function h(){if("serviceWorker"in navigator){if(a=await GU(async()=>{const{Workbox:f}=await import("./workbox-window.prod.es5-vqzQaGvo.js");return{Workbox:f}},[]).then(({Workbox:f})=>new f("/odontocloud-react/sw.js",{scope:"/odontocloud-react/",type:"classic"})).catch(f=>{o==null||o(f)}),!a)return;a.addEventListener("activated",f=>{(f.isUpdate||f.isExternal)&&window.location.reload()}),a.addEventListener("installed",f=>{f.isUpdate||r==null||r()}),a.register({immediate:e}).then(f=>{s?s("/odontocloud-react/sw.js",f):i==null||i(f)}).catch(f=>{o==null||o(f)})}}return l=h(),u}const YU="/odontocloud-react/";HU();QU({immediate:!0});gx(document.getElementById("root")).render(d.jsx(hR.StrictMode,{children:d.jsx(Lk,{basename:YU,children:d.jsx(qU,{})})}));
