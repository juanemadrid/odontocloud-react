(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();function eR(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var lT={exports:{}},sh={},cT={exports:{}},ke={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var gc=Symbol.for("react.element"),tR=Symbol.for("react.portal"),nR=Symbol.for("react.fragment"),rR=Symbol.for("react.strict_mode"),iR=Symbol.for("react.profiler"),sR=Symbol.for("react.provider"),oR=Symbol.for("react.context"),aR=Symbol.for("react.forward_ref"),lR=Symbol.for("react.suspense"),cR=Symbol.for("react.memo"),uR=Symbol.for("react.lazy"),mv=Symbol.iterator;function dR(t){return t===null||typeof t!="object"?null:(t=mv&&t[mv]||t["@@iterator"],typeof t=="function"?t:null)}var uT={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},dT=Object.assign,hT={};function wa(t,e,n){this.props=t,this.context=e,this.refs=hT,this.updater=n||uT}wa.prototype.isReactComponent={};wa.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};wa.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function fT(){}fT.prototype=wa.prototype;function ig(t,e,n){this.props=t,this.context=e,this.refs=hT,this.updater=n||uT}var sg=ig.prototype=new fT;sg.constructor=ig;dT(sg,wa.prototype);sg.isPureReactComponent=!0;var gv=Array.isArray,pT=Object.prototype.hasOwnProperty,og={current:null},mT={key:!0,ref:!0,__self:!0,__source:!0};function gT(t,e,n){var r,i={},s=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(s=""+e.key),e)pT.call(e,r)&&!mT.hasOwnProperty(r)&&(i[r]=e[r]);var a=arguments.length-2;if(a===1)i.children=n;else if(1<a){for(var l=Array(a),d=0;d<a;d++)l[d]=arguments[d+2];i.children=l}if(t&&t.defaultProps)for(r in a=t.defaultProps,a)i[r]===void 0&&(i[r]=a[r]);return{$$typeof:gc,type:t,key:s,ref:o,props:i,_owner:og.current}}function hR(t,e){return{$$typeof:gc,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function ag(t){return typeof t=="object"&&t!==null&&t.$$typeof===gc}function fR(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var yv=/\/+/g;function bf(t,e){return typeof t=="object"&&t!==null&&t.key!=null?fR(""+t.key):e.toString(36)}function Au(t,e,n,r,i){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case gc:case tR:o=!0}}if(o)return o=t,i=i(o),t=r===""?"."+bf(o,0):r,gv(i)?(n="",t!=null&&(n=t.replace(yv,"$&/")+"/"),Au(i,e,n,"",function(d){return d})):i!=null&&(ag(i)&&(i=hR(i,n+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(yv,"$&/")+"/")+t)),e.push(i)),1;if(o=0,r=r===""?".":r+":",gv(t))for(var a=0;a<t.length;a++){s=t[a];var l=r+bf(s,a);o+=Au(s,e,n,l,i)}else if(l=dR(t),typeof l=="function")for(t=l.call(t),a=0;!(s=t.next()).done;)s=s.value,l=r+bf(s,a++),o+=Au(s,e,n,l,i);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function Xc(t,e,n){if(t==null)return t;var r=[],i=0;return Au(t,r,"","",function(s){return e.call(n,s,i++)}),r}function pR(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var hn={current:null},Cu={transition:null},mR={ReactCurrentDispatcher:hn,ReactCurrentBatchConfig:Cu,ReactCurrentOwner:og};function yT(){throw Error("act(...) is not supported in production builds of React.")}ke.Children={map:Xc,forEach:function(t,e,n){Xc(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return Xc(t,function(){e++}),e},toArray:function(t){return Xc(t,function(e){return e})||[]},only:function(t){if(!ag(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};ke.Component=wa;ke.Fragment=nR;ke.Profiler=iR;ke.PureComponent=ig;ke.StrictMode=rR;ke.Suspense=lR;ke.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=mR;ke.act=yT;ke.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=dT({},t.props),i=t.key,s=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,o=og.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(l in e)pT.call(e,l)&&!mT.hasOwnProperty(l)&&(r[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)r.children=n;else if(1<l){a=Array(l);for(var d=0;d<l;d++)a[d]=arguments[d+2];r.children=a}return{$$typeof:gc,type:t.type,key:i,ref:s,props:r,_owner:o}};ke.createContext=function(t){return t={$$typeof:oR,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:sR,_context:t},t.Consumer=t};ke.createElement=gT;ke.createFactory=function(t){var e=gT.bind(null,t);return e.type=t,e};ke.createRef=function(){return{current:null}};ke.forwardRef=function(t){return{$$typeof:aR,render:t}};ke.isValidElement=ag;ke.lazy=function(t){return{$$typeof:uR,_payload:{_status:-1,_result:t},_init:pR}};ke.memo=function(t,e){return{$$typeof:cR,type:t,compare:e===void 0?null:e}};ke.startTransition=function(t){var e=Cu.transition;Cu.transition={};try{t()}finally{Cu.transition=e}};ke.unstable_act=yT;ke.useCallback=function(t,e){return hn.current.useCallback(t,e)};ke.useContext=function(t){return hn.current.useContext(t)};ke.useDebugValue=function(){};ke.useDeferredValue=function(t){return hn.current.useDeferredValue(t)};ke.useEffect=function(t,e){return hn.current.useEffect(t,e)};ke.useId=function(){return hn.current.useId()};ke.useImperativeHandle=function(t,e,n){return hn.current.useImperativeHandle(t,e,n)};ke.useInsertionEffect=function(t,e){return hn.current.useInsertionEffect(t,e)};ke.useLayoutEffect=function(t,e){return hn.current.useLayoutEffect(t,e)};ke.useMemo=function(t,e){return hn.current.useMemo(t,e)};ke.useReducer=function(t,e,n){return hn.current.useReducer(t,e,n)};ke.useRef=function(t){return hn.current.useRef(t)};ke.useState=function(t){return hn.current.useState(t)};ke.useSyncExternalStore=function(t,e,n){return hn.current.useSyncExternalStore(t,e,n)};ke.useTransition=function(){return hn.current.useTransition()};ke.version="18.3.1";cT.exports=ke;var P=cT.exports;const gR=eR(P);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var yR=P,_R=Symbol.for("react.element"),vR=Symbol.for("react.fragment"),wR=Object.prototype.hasOwnProperty,ER=yR.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,IR={key:!0,ref:!0,__self:!0,__source:!0};function _T(t,e,n){var r,i={},s=null,o=null;n!==void 0&&(s=""+n),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)wR.call(e,r)&&!IR.hasOwnProperty(r)&&(i[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)i[r]===void 0&&(i[r]=e[r]);return{$$typeof:_R,type:t,key:s,ref:o,props:i,_owner:ER.current}}sh.Fragment=vR;sh.jsx=_T;sh.jsxs=_T;lT.exports=sh;var u=lT.exports,vT={exports:{}},jn={},wT={exports:{}},ET={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(X,de){var me=X.length;X.push(de);e:for(;0<me;){var Ne=me-1>>>1,Ue=X[Ne];if(0<i(Ue,de))X[Ne]=de,X[me]=Ue,me=Ne;else break e}}function n(X){return X.length===0?null:X[0]}function r(X){if(X.length===0)return null;var de=X[0],me=X.pop();if(me!==de){X[0]=me;e:for(var Ne=0,Ue=X.length,z=Ue>>>1;Ne<z;){var Z=2*(Ne+1)-1,oe=X[Z],ye=Z+1,xe=X[ye];if(0>i(oe,me))ye<Ue&&0>i(xe,oe)?(X[Ne]=xe,X[ye]=me,Ne=ye):(X[Ne]=oe,X[Z]=me,Ne=Z);else if(ye<Ue&&0>i(xe,me))X[Ne]=xe,X[ye]=me,Ne=ye;else break e}}return de}function i(X,de){var me=X.sortIndex-de.sortIndex;return me!==0?me:X.id-de.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var l=[],d=[],h=1,f=null,m=3,v=!1,C=!1,y=!1,N=typeof setTimeout=="function"?setTimeout:null,I=typeof clearTimeout=="function"?clearTimeout:null,_=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function T(X){for(var de=n(d);de!==null;){if(de.callback===null)r(d);else if(de.startTime<=X)r(d),de.sortIndex=de.expirationTime,e(l,de);else break;de=n(d)}}function R(X){if(y=!1,T(X),!C)if(n(l)!==null)C=!0,St(O);else{var de=n(d);de!==null&&qt(R,de.startTime-X)}}function O(X,de){C=!1,y&&(y=!1,I(w),w=-1),v=!0;var me=m;try{for(T(de),f=n(l);f!==null&&(!(f.expirationTime>de)||X&&!D());){var Ne=f.callback;if(typeof Ne=="function"){f.callback=null,m=f.priorityLevel;var Ue=Ne(f.expirationTime<=de);de=t.unstable_now(),typeof Ue=="function"?f.callback=Ue:f===n(l)&&r(l),T(de)}else r(l);f=n(l)}if(f!==null)var z=!0;else{var Z=n(d);Z!==null&&qt(R,Z.startTime-de),z=!1}return z}finally{f=null,m=me,v=!1}}var $=!1,x=null,w=-1,A=5,k=-1;function D(){return!(t.unstable_now()-k<A)}function j(){if(x!==null){var X=t.unstable_now();k=X;var de=!0;try{de=x(!0,X)}finally{de?b():($=!1,x=null)}}else $=!1}var b;if(typeof _=="function")b=function(){_(j)};else if(typeof MessageChannel<"u"){var Q=new MessageChannel,qe=Q.port2;Q.port1.onmessage=j,b=function(){qe.postMessage(null)}}else b=function(){N(j,0)};function St(X){x=X,$||($=!0,b())}function qt(X,de){w=N(function(){X(t.unstable_now())},de)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(X){X.callback=null},t.unstable_continueExecution=function(){C||v||(C=!0,St(O))},t.unstable_forceFrameRate=function(X){0>X||125<X?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):A=0<X?Math.floor(1e3/X):5},t.unstable_getCurrentPriorityLevel=function(){return m},t.unstable_getFirstCallbackNode=function(){return n(l)},t.unstable_next=function(X){switch(m){case 1:case 2:case 3:var de=3;break;default:de=m}var me=m;m=de;try{return X()}finally{m=me}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(X,de){switch(X){case 1:case 2:case 3:case 4:case 5:break;default:X=3}var me=m;m=X;try{return de()}finally{m=me}},t.unstable_scheduleCallback=function(X,de,me){var Ne=t.unstable_now();switch(typeof me=="object"&&me!==null?(me=me.delay,me=typeof me=="number"&&0<me?Ne+me:Ne):me=Ne,X){case 1:var Ue=-1;break;case 2:Ue=250;break;case 5:Ue=1073741823;break;case 4:Ue=1e4;break;default:Ue=5e3}return Ue=me+Ue,X={id:h++,callback:de,priorityLevel:X,startTime:me,expirationTime:Ue,sortIndex:-1},me>Ne?(X.sortIndex=me,e(d,X),n(l)===null&&X===n(d)&&(y?(I(w),w=-1):y=!0,qt(R,me-Ne))):(X.sortIndex=Ue,e(l,X),C||v||(C=!0,St(O))),X},t.unstable_shouldYield=D,t.unstable_wrapCallback=function(X){var de=m;return function(){var me=m;m=de;try{return X.apply(this,arguments)}finally{m=me}}}})(ET);wT.exports=ET;var TR=wT.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var xR=P,Nn=TR;function H(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var IT=new Set,Ml={};function eo(t,e){Zo(t,e),Zo(t+"Capture",e)}function Zo(t,e){for(Ml[t]=e,t=0;t<e.length;t++)IT.add(e[t])}var qr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Ap=Object.prototype.hasOwnProperty,SR=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,_v={},vv={};function bR(t){return Ap.call(vv,t)?!0:Ap.call(_v,t)?!1:SR.test(t)?vv[t]=!0:(_v[t]=!0,!1)}function AR(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function CR(t,e,n,r){if(e===null||typeof e>"u"||AR(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function fn(t,e,n,r,i,s,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=o}var zt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){zt[t]=new fn(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];zt[e]=new fn(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){zt[t]=new fn(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){zt[t]=new fn(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){zt[t]=new fn(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){zt[t]=new fn(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){zt[t]=new fn(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){zt[t]=new fn(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){zt[t]=new fn(t,5,!1,t.toLowerCase(),null,!1,!1)});var lg=/[\-:]([a-z])/g;function cg(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(lg,cg);zt[e]=new fn(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(lg,cg);zt[e]=new fn(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(lg,cg);zt[e]=new fn(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){zt[t]=new fn(t,1,!1,t.toLowerCase(),null,!1,!1)});zt.xlinkHref=new fn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){zt[t]=new fn(t,1,!1,t.toLowerCase(),null,!0,!0)});function ug(t,e,n,r){var i=zt.hasOwnProperty(e)?zt[e]:null;(i!==null?i.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(CR(e,n,i,r)&&(n=null),r||i===null?bR(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):i.mustUseProperty?t[i.propertyName]=n===null?i.type===3?!1:"":n:(e=i.attributeName,r=i.attributeNamespace,n===null?t.removeAttribute(e):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var ei=xR.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Jc=Symbol.for("react.element"),bo=Symbol.for("react.portal"),Ao=Symbol.for("react.fragment"),dg=Symbol.for("react.strict_mode"),Cp=Symbol.for("react.profiler"),TT=Symbol.for("react.provider"),xT=Symbol.for("react.context"),hg=Symbol.for("react.forward_ref"),Rp=Symbol.for("react.suspense"),Pp=Symbol.for("react.suspense_list"),fg=Symbol.for("react.memo"),mi=Symbol.for("react.lazy"),ST=Symbol.for("react.offscreen"),wv=Symbol.iterator;function qa(t){return t===null||typeof t!="object"?null:(t=wv&&t[wv]||t["@@iterator"],typeof t=="function"?t:null)}var dt=Object.assign,Af;function ol(t){if(Af===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);Af=e&&e[1]||""}return`
`+Af+t}var Cf=!1;function Rf(t,e){if(!t||Cf)return"";Cf=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(d){var r=d}Reflect.construct(t,[],e)}else{try{e.call()}catch(d){r=d}t.call(e.prototype)}else{try{throw Error()}catch(d){r=d}t()}}catch(d){if(d&&r&&typeof d.stack=="string"){for(var i=d.stack.split(`
`),s=r.stack.split(`
`),o=i.length-1,a=s.length-1;1<=o&&0<=a&&i[o]!==s[a];)a--;for(;1<=o&&0<=a;o--,a--)if(i[o]!==s[a]){if(o!==1||a!==1)do if(o--,a--,0>a||i[o]!==s[a]){var l=`
`+i[o].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=o&&0<=a);break}}}finally{Cf=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?ol(t):""}function RR(t){switch(t.tag){case 5:return ol(t.type);case 16:return ol("Lazy");case 13:return ol("Suspense");case 19:return ol("SuspenseList");case 0:case 2:case 15:return t=Rf(t.type,!1),t;case 11:return t=Rf(t.type.render,!1),t;case 1:return t=Rf(t.type,!0),t;default:return""}}function kp(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Ao:return"Fragment";case bo:return"Portal";case Cp:return"Profiler";case dg:return"StrictMode";case Rp:return"Suspense";case Pp:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case xT:return(t.displayName||"Context")+".Consumer";case TT:return(t._context.displayName||"Context")+".Provider";case hg:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case fg:return e=t.displayName||null,e!==null?e:kp(t.type)||"Memo";case mi:e=t._payload,t=t._init;try{return kp(t(e))}catch{}}return null}function PR(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return kp(e);case 8:return e===dg?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function zi(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function bT(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function kR(t){var e=bT(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,s=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(o){r=""+o,s.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Zc(t){t._valueTracker||(t._valueTracker=kR(t))}function AT(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=bT(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function rd(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Np(t,e){var n=e.checked;return dt({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function Ev(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=zi(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function CT(t,e){e=e.checked,e!=null&&ug(t,"checked",e,!1)}function Dp(t,e){CT(t,e);var n=zi(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?jp(t,e.type,n):e.hasOwnProperty("defaultValue")&&jp(t,e.type,zi(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function Iv(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function jp(t,e,n){(e!=="number"||rd(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var al=Array.isArray;function Fo(t,e,n,r){if(t=t.options,e){e={};for(var i=0;i<n.length;i++)e["$"+n[i]]=!0;for(n=0;n<t.length;n++)i=e.hasOwnProperty("$"+t[n].value),t[n].selected!==i&&(t[n].selected=i),i&&r&&(t[n].defaultSelected=!0)}else{for(n=""+zi(n),e=null,i=0;i<t.length;i++){if(t[i].value===n){t[i].selected=!0,r&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function Vp(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(H(91));return dt({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function Tv(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(H(92));if(al(n)){if(1<n.length)throw Error(H(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:zi(n)}}function RT(t,e){var n=zi(e.value),r=zi(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function xv(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function PT(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Op(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?PT(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var eu,kT=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,i){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(eu=eu||document.createElement("div"),eu.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=eu.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Fl(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var vl={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},NR=["Webkit","ms","Moz","O"];Object.keys(vl).forEach(function(t){NR.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),vl[e]=vl[t]})});function NT(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||vl.hasOwnProperty(t)&&vl[t]?(""+e).trim():e+"px"}function DT(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=NT(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,i):t[n]=i}}var DR=dt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Lp(t,e){if(e){if(DR[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(H(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(H(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(H(61))}if(e.style!=null&&typeof e.style!="object")throw Error(H(62))}}function Mp(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Fp=null;function pg(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Up=null,Uo=null,Bo=null;function Sv(t){if(t=vc(t)){if(typeof Up!="function")throw Error(H(280));var e=t.stateNode;e&&(e=uh(e),Up(t.stateNode,t.type,e))}}function jT(t){Uo?Bo?Bo.push(t):Bo=[t]:Uo=t}function VT(){if(Uo){var t=Uo,e=Bo;if(Bo=Uo=null,Sv(t),e)for(t=0;t<e.length;t++)Sv(e[t])}}function OT(t,e){return t(e)}function LT(){}var Pf=!1;function MT(t,e,n){if(Pf)return t(e,n);Pf=!0;try{return OT(t,e,n)}finally{Pf=!1,(Uo!==null||Bo!==null)&&(LT(),VT())}}function Ul(t,e){var n=t.stateNode;if(n===null)return null;var r=uh(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(H(231,e,typeof n));return n}var Bp=!1;if(qr)try{var Ha={};Object.defineProperty(Ha,"passive",{get:function(){Bp=!0}}),window.addEventListener("test",Ha,Ha),window.removeEventListener("test",Ha,Ha)}catch{Bp=!1}function jR(t,e,n,r,i,s,o,a,l){var d=Array.prototype.slice.call(arguments,3);try{e.apply(n,d)}catch(h){this.onError(h)}}var wl=!1,id=null,sd=!1,$p=null,VR={onError:function(t){wl=!0,id=t}};function OR(t,e,n,r,i,s,o,a,l){wl=!1,id=null,jR.apply(VR,arguments)}function LR(t,e,n,r,i,s,o,a,l){if(OR.apply(this,arguments),wl){if(wl){var d=id;wl=!1,id=null}else throw Error(H(198));sd||(sd=!0,$p=d)}}function to(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function FT(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function bv(t){if(to(t)!==t)throw Error(H(188))}function MR(t){var e=t.alternate;if(!e){if(e=to(t),e===null)throw Error(H(188));return e!==t?null:t}for(var n=t,r=e;;){var i=n.return;if(i===null)break;var s=i.alternate;if(s===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===n)return bv(i),t;if(s===r)return bv(i),e;s=s.sibling}throw Error(H(188))}if(n.return!==r.return)n=i,r=s;else{for(var o=!1,a=i.child;a;){if(a===n){o=!0,n=i,r=s;break}if(a===r){o=!0,r=i,n=s;break}a=a.sibling}if(!o){for(a=s.child;a;){if(a===n){o=!0,n=s,r=i;break}if(a===r){o=!0,r=s,n=i;break}a=a.sibling}if(!o)throw Error(H(189))}}if(n.alternate!==r)throw Error(H(190))}if(n.tag!==3)throw Error(H(188));return n.stateNode.current===n?t:e}function UT(t){return t=MR(t),t!==null?BT(t):null}function BT(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=BT(t);if(e!==null)return e;t=t.sibling}return null}var $T=Nn.unstable_scheduleCallback,Av=Nn.unstable_cancelCallback,FR=Nn.unstable_shouldYield,UR=Nn.unstable_requestPaint,vt=Nn.unstable_now,BR=Nn.unstable_getCurrentPriorityLevel,mg=Nn.unstable_ImmediatePriority,zT=Nn.unstable_UserBlockingPriority,od=Nn.unstable_NormalPriority,$R=Nn.unstable_LowPriority,qT=Nn.unstable_IdlePriority,oh=null,br=null;function zR(t){if(br&&typeof br.onCommitFiberRoot=="function")try{br.onCommitFiberRoot(oh,t,void 0,(t.current.flags&128)===128)}catch{}}var sr=Math.clz32?Math.clz32:WR,qR=Math.log,HR=Math.LN2;function WR(t){return t>>>=0,t===0?32:31-(qR(t)/HR|0)|0}var tu=64,nu=4194304;function ll(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function ad(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,i=t.suspendedLanes,s=t.pingedLanes,o=n&268435455;if(o!==0){var a=o&~i;a!==0?r=ll(a):(s&=o,s!==0&&(r=ll(s)))}else o=n&~i,o!==0?r=ll(o):s!==0&&(r=ll(s));if(r===0)return 0;if(e!==0&&e!==r&&!(e&i)&&(i=r&-r,s=e&-e,i>=s||i===16&&(s&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-sr(e),i=1<<n,r|=t[n],e&=~i;return r}function KR(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function GR(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,i=t.expirationTimes,s=t.pendingLanes;0<s;){var o=31-sr(s),a=1<<o,l=i[o];l===-1?(!(a&n)||a&r)&&(i[o]=KR(a,e)):l<=e&&(t.expiredLanes|=a),s&=~a}}function zp(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function HT(){var t=tu;return tu<<=1,!(tu&4194240)&&(tu=64),t}function kf(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function yc(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-sr(e),t[e]=n}function QR(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var i=31-sr(n),s=1<<i;e[i]=0,r[i]=-1,t[i]=-1,n&=~s}}function gg(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-sr(n),i=1<<r;i&e|t[r]&e&&(t[r]|=e),n&=~i}}var We=0;function WT(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var KT,yg,GT,QT,YT,qp=!1,ru=[],Ri=null,Pi=null,ki=null,Bl=new Map,$l=new Map,yi=[],YR="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Cv(t,e){switch(t){case"focusin":case"focusout":Ri=null;break;case"dragenter":case"dragleave":Pi=null;break;case"mouseover":case"mouseout":ki=null;break;case"pointerover":case"pointerout":Bl.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":$l.delete(e.pointerId)}}function Wa(t,e,n,r,i,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:s,targetContainers:[i]},e!==null&&(e=vc(e),e!==null&&yg(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function XR(t,e,n,r,i){switch(e){case"focusin":return Ri=Wa(Ri,t,e,n,r,i),!0;case"dragenter":return Pi=Wa(Pi,t,e,n,r,i),!0;case"mouseover":return ki=Wa(ki,t,e,n,r,i),!0;case"pointerover":var s=i.pointerId;return Bl.set(s,Wa(Bl.get(s)||null,t,e,n,r,i)),!0;case"gotpointercapture":return s=i.pointerId,$l.set(s,Wa($l.get(s)||null,t,e,n,r,i)),!0}return!1}function XT(t){var e=Is(t.target);if(e!==null){var n=to(e);if(n!==null){if(e=n.tag,e===13){if(e=FT(n),e!==null){t.blockedOn=e,YT(t.priority,function(){GT(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Ru(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=Hp(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);Fp=r,n.target.dispatchEvent(r),Fp=null}else return e=vc(n),e!==null&&yg(e),t.blockedOn=n,!1;e.shift()}return!0}function Rv(t,e,n){Ru(t)&&n.delete(e)}function JR(){qp=!1,Ri!==null&&Ru(Ri)&&(Ri=null),Pi!==null&&Ru(Pi)&&(Pi=null),ki!==null&&Ru(ki)&&(ki=null),Bl.forEach(Rv),$l.forEach(Rv)}function Ka(t,e){t.blockedOn===e&&(t.blockedOn=null,qp||(qp=!0,Nn.unstable_scheduleCallback(Nn.unstable_NormalPriority,JR)))}function zl(t){function e(i){return Ka(i,t)}if(0<ru.length){Ka(ru[0],t);for(var n=1;n<ru.length;n++){var r=ru[n];r.blockedOn===t&&(r.blockedOn=null)}}for(Ri!==null&&Ka(Ri,t),Pi!==null&&Ka(Pi,t),ki!==null&&Ka(ki,t),Bl.forEach(e),$l.forEach(e),n=0;n<yi.length;n++)r=yi[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<yi.length&&(n=yi[0],n.blockedOn===null);)XT(n),n.blockedOn===null&&yi.shift()}var $o=ei.ReactCurrentBatchConfig,ld=!0;function ZR(t,e,n,r){var i=We,s=$o.transition;$o.transition=null;try{We=1,_g(t,e,n,r)}finally{We=i,$o.transition=s}}function e1(t,e,n,r){var i=We,s=$o.transition;$o.transition=null;try{We=4,_g(t,e,n,r)}finally{We=i,$o.transition=s}}function _g(t,e,n,r){if(ld){var i=Hp(t,e,n,r);if(i===null)Bf(t,e,r,cd,n),Cv(t,r);else if(XR(i,t,e,n,r))r.stopPropagation();else if(Cv(t,r),e&4&&-1<YR.indexOf(t)){for(;i!==null;){var s=vc(i);if(s!==null&&KT(s),s=Hp(t,e,n,r),s===null&&Bf(t,e,r,cd,n),s===i)break;i=s}i!==null&&r.stopPropagation()}else Bf(t,e,r,null,n)}}var cd=null;function Hp(t,e,n,r){if(cd=null,t=pg(r),t=Is(t),t!==null)if(e=to(t),e===null)t=null;else if(n=e.tag,n===13){if(t=FT(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return cd=t,null}function JT(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(BR()){case mg:return 1;case zT:return 4;case od:case $R:return 16;case qT:return 536870912;default:return 16}default:return 16}}var bi=null,vg=null,Pu=null;function ZT(){if(Pu)return Pu;var t,e=vg,n=e.length,r,i="value"in bi?bi.value:bi.textContent,s=i.length;for(t=0;t<n&&e[t]===i[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===i[s-r];r++);return Pu=i.slice(t,1<r?1-r:void 0)}function ku(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function iu(){return!0}function Pv(){return!1}function Vn(t){function e(n,r,i,s,o){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(n=t[a],this[a]=n?n(s):s[a]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?iu:Pv,this.isPropagationStopped=Pv,this}return dt(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=iu)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=iu)},persist:function(){},isPersistent:iu}),e}var Ea={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},wg=Vn(Ea),_c=dt({},Ea,{view:0,detail:0}),t1=Vn(_c),Nf,Df,Ga,ah=dt({},_c,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Eg,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Ga&&(Ga&&t.type==="mousemove"?(Nf=t.screenX-Ga.screenX,Df=t.screenY-Ga.screenY):Df=Nf=0,Ga=t),Nf)},movementY:function(t){return"movementY"in t?t.movementY:Df}}),kv=Vn(ah),n1=dt({},ah,{dataTransfer:0}),r1=Vn(n1),i1=dt({},_c,{relatedTarget:0}),jf=Vn(i1),s1=dt({},Ea,{animationName:0,elapsedTime:0,pseudoElement:0}),o1=Vn(s1),a1=dt({},Ea,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),l1=Vn(a1),c1=dt({},Ea,{data:0}),Nv=Vn(c1),u1={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},d1={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},h1={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function f1(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=h1[t])?!!e[t]:!1}function Eg(){return f1}var p1=dt({},_c,{key:function(t){if(t.key){var e=u1[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=ku(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?d1[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Eg,charCode:function(t){return t.type==="keypress"?ku(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?ku(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),m1=Vn(p1),g1=dt({},ah,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Dv=Vn(g1),y1=dt({},_c,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Eg}),_1=Vn(y1),v1=dt({},Ea,{propertyName:0,elapsedTime:0,pseudoElement:0}),w1=Vn(v1),E1=dt({},ah,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),I1=Vn(E1),T1=[9,13,27,32],Ig=qr&&"CompositionEvent"in window,El=null;qr&&"documentMode"in document&&(El=document.documentMode);var x1=qr&&"TextEvent"in window&&!El,e0=qr&&(!Ig||El&&8<El&&11>=El),jv=" ",Vv=!1;function t0(t,e){switch(t){case"keyup":return T1.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function n0(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Co=!1;function S1(t,e){switch(t){case"compositionend":return n0(e);case"keypress":return e.which!==32?null:(Vv=!0,jv);case"textInput":return t=e.data,t===jv&&Vv?null:t;default:return null}}function b1(t,e){if(Co)return t==="compositionend"||!Ig&&t0(t,e)?(t=ZT(),Pu=vg=bi=null,Co=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return e0&&e.locale!=="ko"?null:e.data;default:return null}}var A1={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Ov(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!A1[t.type]:e==="textarea"}function r0(t,e,n,r){jT(r),e=ud(e,"onChange"),0<e.length&&(n=new wg("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var Il=null,ql=null;function C1(t){p0(t,0)}function lh(t){var e=ko(t);if(AT(e))return t}function R1(t,e){if(t==="change")return e}var i0=!1;if(qr){var Vf;if(qr){var Of="oninput"in document;if(!Of){var Lv=document.createElement("div");Lv.setAttribute("oninput","return;"),Of=typeof Lv.oninput=="function"}Vf=Of}else Vf=!1;i0=Vf&&(!document.documentMode||9<document.documentMode)}function Mv(){Il&&(Il.detachEvent("onpropertychange",s0),ql=Il=null)}function s0(t){if(t.propertyName==="value"&&lh(ql)){var e=[];r0(e,ql,t,pg(t)),MT(C1,e)}}function P1(t,e,n){t==="focusin"?(Mv(),Il=e,ql=n,Il.attachEvent("onpropertychange",s0)):t==="focusout"&&Mv()}function k1(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return lh(ql)}function N1(t,e){if(t==="click")return lh(e)}function D1(t,e){if(t==="input"||t==="change")return lh(e)}function j1(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var lr=typeof Object.is=="function"?Object.is:j1;function Hl(t,e){if(lr(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!Ap.call(e,i)||!lr(t[i],e[i]))return!1}return!0}function Fv(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Uv(t,e){var n=Fv(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Fv(n)}}function o0(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?o0(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function a0(){for(var t=window,e=rd();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=rd(t.document)}return e}function Tg(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function V1(t){var e=a0(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&o0(n.ownerDocument.documentElement,n)){if(r!==null&&Tg(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=n.textContent.length,s=Math.min(r.start,i);r=r.end===void 0?s:Math.min(r.end,i),!t.extend&&s>r&&(i=r,r=s,s=i),i=Uv(n,s);var o=Uv(n,r);i&&o&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),s>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var O1=qr&&"documentMode"in document&&11>=document.documentMode,Ro=null,Wp=null,Tl=null,Kp=!1;function Bv(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Kp||Ro==null||Ro!==rd(r)||(r=Ro,"selectionStart"in r&&Tg(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Tl&&Hl(Tl,r)||(Tl=r,r=ud(Wp,"onSelect"),0<r.length&&(e=new wg("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=Ro)))}function su(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Po={animationend:su("Animation","AnimationEnd"),animationiteration:su("Animation","AnimationIteration"),animationstart:su("Animation","AnimationStart"),transitionend:su("Transition","TransitionEnd")},Lf={},l0={};qr&&(l0=document.createElement("div").style,"AnimationEvent"in window||(delete Po.animationend.animation,delete Po.animationiteration.animation,delete Po.animationstart.animation),"TransitionEvent"in window||delete Po.transitionend.transition);function ch(t){if(Lf[t])return Lf[t];if(!Po[t])return t;var e=Po[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in l0)return Lf[t]=e[n];return t}var c0=ch("animationend"),u0=ch("animationiteration"),d0=ch("animationstart"),h0=ch("transitionend"),f0=new Map,$v="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Yi(t,e){f0.set(t,e),eo(e,[t])}for(var Mf=0;Mf<$v.length;Mf++){var Ff=$v[Mf],L1=Ff.toLowerCase(),M1=Ff[0].toUpperCase()+Ff.slice(1);Yi(L1,"on"+M1)}Yi(c0,"onAnimationEnd");Yi(u0,"onAnimationIteration");Yi(d0,"onAnimationStart");Yi("dblclick","onDoubleClick");Yi("focusin","onFocus");Yi("focusout","onBlur");Yi(h0,"onTransitionEnd");Zo("onMouseEnter",["mouseout","mouseover"]);Zo("onMouseLeave",["mouseout","mouseover"]);Zo("onPointerEnter",["pointerout","pointerover"]);Zo("onPointerLeave",["pointerout","pointerover"]);eo("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));eo("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));eo("onBeforeInput",["compositionend","keypress","textInput","paste"]);eo("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));eo("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));eo("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var cl="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),F1=new Set("cancel close invalid load scroll toggle".split(" ").concat(cl));function zv(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,LR(r,e,void 0,t),t.currentTarget=null}function p0(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],i=r.event;r=r.listeners;e:{var s=void 0;if(e)for(var o=r.length-1;0<=o;o--){var a=r[o],l=a.instance,d=a.currentTarget;if(a=a.listener,l!==s&&i.isPropagationStopped())break e;zv(i,a,d),s=l}else for(o=0;o<r.length;o++){if(a=r[o],l=a.instance,d=a.currentTarget,a=a.listener,l!==s&&i.isPropagationStopped())break e;zv(i,a,d),s=l}}}if(sd)throw t=$p,sd=!1,$p=null,t}function Ze(t,e){var n=e[Jp];n===void 0&&(n=e[Jp]=new Set);var r=t+"__bubble";n.has(r)||(m0(e,t,2,!1),n.add(r))}function Uf(t,e,n){var r=0;e&&(r|=4),m0(n,t,r,e)}var ou="_reactListening"+Math.random().toString(36).slice(2);function Wl(t){if(!t[ou]){t[ou]=!0,IT.forEach(function(n){n!=="selectionchange"&&(F1.has(n)||Uf(n,!1,t),Uf(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[ou]||(e[ou]=!0,Uf("selectionchange",!1,e))}}function m0(t,e,n,r){switch(JT(e)){case 1:var i=ZR;break;case 4:i=e1;break;default:i=_g}n=i.bind(null,e,n,t),i=void 0,!Bp||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),r?i!==void 0?t.addEventListener(e,n,{capture:!0,passive:i}):t.addEventListener(e,n,!0):i!==void 0?t.addEventListener(e,n,{passive:i}):t.addEventListener(e,n,!1)}function Bf(t,e,n,r,i){var s=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var a=r.stateNode.containerInfo;if(a===i||a.nodeType===8&&a.parentNode===i)break;if(o===4)for(o=r.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===i||l.nodeType===8&&l.parentNode===i))return;o=o.return}for(;a!==null;){if(o=Is(a),o===null)return;if(l=o.tag,l===5||l===6){r=s=o;continue e}a=a.parentNode}}r=r.return}MT(function(){var d=s,h=pg(n),f=[];e:{var m=f0.get(t);if(m!==void 0){var v=wg,C=t;switch(t){case"keypress":if(ku(n)===0)break e;case"keydown":case"keyup":v=m1;break;case"focusin":C="focus",v=jf;break;case"focusout":C="blur",v=jf;break;case"beforeblur":case"afterblur":v=jf;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":v=kv;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":v=r1;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":v=_1;break;case c0:case u0:case d0:v=o1;break;case h0:v=w1;break;case"scroll":v=t1;break;case"wheel":v=I1;break;case"copy":case"cut":case"paste":v=l1;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":v=Dv}var y=(e&4)!==0,N=!y&&t==="scroll",I=y?m!==null?m+"Capture":null:m;y=[];for(var _=d,T;_!==null;){T=_;var R=T.stateNode;if(T.tag===5&&R!==null&&(T=R,I!==null&&(R=Ul(_,I),R!=null&&y.push(Kl(_,R,T)))),N)break;_=_.return}0<y.length&&(m=new v(m,C,null,n,h),f.push({event:m,listeners:y}))}}if(!(e&7)){e:{if(m=t==="mouseover"||t==="pointerover",v=t==="mouseout"||t==="pointerout",m&&n!==Fp&&(C=n.relatedTarget||n.fromElement)&&(Is(C)||C[Hr]))break e;if((v||m)&&(m=h.window===h?h:(m=h.ownerDocument)?m.defaultView||m.parentWindow:window,v?(C=n.relatedTarget||n.toElement,v=d,C=C?Is(C):null,C!==null&&(N=to(C),C!==N||C.tag!==5&&C.tag!==6)&&(C=null)):(v=null,C=d),v!==C)){if(y=kv,R="onMouseLeave",I="onMouseEnter",_="mouse",(t==="pointerout"||t==="pointerover")&&(y=Dv,R="onPointerLeave",I="onPointerEnter",_="pointer"),N=v==null?m:ko(v),T=C==null?m:ko(C),m=new y(R,_+"leave",v,n,h),m.target=N,m.relatedTarget=T,R=null,Is(h)===d&&(y=new y(I,_+"enter",C,n,h),y.target=T,y.relatedTarget=N,R=y),N=R,v&&C)t:{for(y=v,I=C,_=0,T=y;T;T=uo(T))_++;for(T=0,R=I;R;R=uo(R))T++;for(;0<_-T;)y=uo(y),_--;for(;0<T-_;)I=uo(I),T--;for(;_--;){if(y===I||I!==null&&y===I.alternate)break t;y=uo(y),I=uo(I)}y=null}else y=null;v!==null&&qv(f,m,v,y,!1),C!==null&&N!==null&&qv(f,N,C,y,!0)}}e:{if(m=d?ko(d):window,v=m.nodeName&&m.nodeName.toLowerCase(),v==="select"||v==="input"&&m.type==="file")var O=R1;else if(Ov(m))if(i0)O=D1;else{O=k1;var $=P1}else(v=m.nodeName)&&v.toLowerCase()==="input"&&(m.type==="checkbox"||m.type==="radio")&&(O=N1);if(O&&(O=O(t,d))){r0(f,O,n,h);break e}$&&$(t,m,d),t==="focusout"&&($=m._wrapperState)&&$.controlled&&m.type==="number"&&jp(m,"number",m.value)}switch($=d?ko(d):window,t){case"focusin":(Ov($)||$.contentEditable==="true")&&(Ro=$,Wp=d,Tl=null);break;case"focusout":Tl=Wp=Ro=null;break;case"mousedown":Kp=!0;break;case"contextmenu":case"mouseup":case"dragend":Kp=!1,Bv(f,n,h);break;case"selectionchange":if(O1)break;case"keydown":case"keyup":Bv(f,n,h)}var x;if(Ig)e:{switch(t){case"compositionstart":var w="onCompositionStart";break e;case"compositionend":w="onCompositionEnd";break e;case"compositionupdate":w="onCompositionUpdate";break e}w=void 0}else Co?t0(t,n)&&(w="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(w="onCompositionStart");w&&(e0&&n.locale!=="ko"&&(Co||w!=="onCompositionStart"?w==="onCompositionEnd"&&Co&&(x=ZT()):(bi=h,vg="value"in bi?bi.value:bi.textContent,Co=!0)),$=ud(d,w),0<$.length&&(w=new Nv(w,t,null,n,h),f.push({event:w,listeners:$}),x?w.data=x:(x=n0(n),x!==null&&(w.data=x)))),(x=x1?S1(t,n):b1(t,n))&&(d=ud(d,"onBeforeInput"),0<d.length&&(h=new Nv("onBeforeInput","beforeinput",null,n,h),f.push({event:h,listeners:d}),h.data=x))}p0(f,e)})}function Kl(t,e,n){return{instance:t,listener:e,currentTarget:n}}function ud(t,e){for(var n=e+"Capture",r=[];t!==null;){var i=t,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=Ul(t,n),s!=null&&r.unshift(Kl(t,s,i)),s=Ul(t,e),s!=null&&r.push(Kl(t,s,i))),t=t.return}return r}function uo(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function qv(t,e,n,r,i){for(var s=e._reactName,o=[];n!==null&&n!==r;){var a=n,l=a.alternate,d=a.stateNode;if(l!==null&&l===r)break;a.tag===5&&d!==null&&(a=d,i?(l=Ul(n,s),l!=null&&o.unshift(Kl(n,l,a))):i||(l=Ul(n,s),l!=null&&o.push(Kl(n,l,a)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var U1=/\r\n?/g,B1=/\u0000|\uFFFD/g;function Hv(t){return(typeof t=="string"?t:""+t).replace(U1,`
`).replace(B1,"")}function au(t,e,n){if(e=Hv(e),Hv(t)!==e&&n)throw Error(H(425))}function dd(){}var Gp=null,Qp=null;function Yp(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Xp=typeof setTimeout=="function"?setTimeout:void 0,$1=typeof clearTimeout=="function"?clearTimeout:void 0,Wv=typeof Promise=="function"?Promise:void 0,z1=typeof queueMicrotask=="function"?queueMicrotask:typeof Wv<"u"?function(t){return Wv.resolve(null).then(t).catch(q1)}:Xp;function q1(t){setTimeout(function(){throw t})}function $f(t,e){var n=e,r=0;do{var i=n.nextSibling;if(t.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){t.removeChild(i),zl(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);zl(e)}function Ni(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function Kv(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var Ia=Math.random().toString(36).slice(2),Ir="__reactFiber$"+Ia,Gl="__reactProps$"+Ia,Hr="__reactContainer$"+Ia,Jp="__reactEvents$"+Ia,H1="__reactListeners$"+Ia,W1="__reactHandles$"+Ia;function Is(t){var e=t[Ir];if(e)return e;for(var n=t.parentNode;n;){if(e=n[Hr]||n[Ir]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=Kv(t);t!==null;){if(n=t[Ir])return n;t=Kv(t)}return e}t=n,n=t.parentNode}return null}function vc(t){return t=t[Ir]||t[Hr],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function ko(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(H(33))}function uh(t){return t[Gl]||null}var Zp=[],No=-1;function Xi(t){return{current:t}}function tt(t){0>No||(t.current=Zp[No],Zp[No]=null,No--)}function Ye(t,e){No++,Zp[No]=t.current,t.current=e}var qi={},nn=Xi(qi),vn=Xi(!1),Vs=qi;function ea(t,e){var n=t.type.contextTypes;if(!n)return qi;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in n)i[s]=e[s];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function wn(t){return t=t.childContextTypes,t!=null}function hd(){tt(vn),tt(nn)}function Gv(t,e,n){if(nn.current!==qi)throw Error(H(168));Ye(nn,e),Ye(vn,n)}function g0(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in e))throw Error(H(108,PR(t)||"Unknown",i));return dt({},n,r)}function fd(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||qi,Vs=nn.current,Ye(nn,t),Ye(vn,vn.current),!0}function Qv(t,e,n){var r=t.stateNode;if(!r)throw Error(H(169));n?(t=g0(t,e,Vs),r.__reactInternalMemoizedMergedChildContext=t,tt(vn),tt(nn),Ye(nn,t)):tt(vn),Ye(vn,n)}var Or=null,dh=!1,zf=!1;function y0(t){Or===null?Or=[t]:Or.push(t)}function K1(t){dh=!0,y0(t)}function Ji(){if(!zf&&Or!==null){zf=!0;var t=0,e=We;try{var n=Or;for(We=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}Or=null,dh=!1}catch(i){throw Or!==null&&(Or=Or.slice(t+1)),$T(mg,Ji),i}finally{We=e,zf=!1}}return null}var Do=[],jo=0,pd=null,md=0,Mn=[],Fn=0,Os=null,Lr=1,Mr="";function hs(t,e){Do[jo++]=md,Do[jo++]=pd,pd=t,md=e}function _0(t,e,n){Mn[Fn++]=Lr,Mn[Fn++]=Mr,Mn[Fn++]=Os,Os=t;var r=Lr;t=Mr;var i=32-sr(r)-1;r&=~(1<<i),n+=1;var s=32-sr(e)+i;if(30<s){var o=i-i%5;s=(r&(1<<o)-1).toString(32),r>>=o,i-=o,Lr=1<<32-sr(e)+i|n<<i|r,Mr=s+t}else Lr=1<<s|n<<i|r,Mr=t}function xg(t){t.return!==null&&(hs(t,1),_0(t,1,0))}function Sg(t){for(;t===pd;)pd=Do[--jo],Do[jo]=null,md=Do[--jo],Do[jo]=null;for(;t===Os;)Os=Mn[--Fn],Mn[Fn]=null,Mr=Mn[--Fn],Mn[Fn]=null,Lr=Mn[--Fn],Mn[Fn]=null}var Pn=null,Cn=null,rt=!1,nr=null;function v0(t,e){var n=$n(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function Yv(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Pn=t,Cn=Ni(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Pn=t,Cn=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=Os!==null?{id:Lr,overflow:Mr}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=$n(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,Pn=t,Cn=null,!0):!1;default:return!1}}function em(t){return(t.mode&1)!==0&&(t.flags&128)===0}function tm(t){if(rt){var e=Cn;if(e){var n=e;if(!Yv(t,e)){if(em(t))throw Error(H(418));e=Ni(n.nextSibling);var r=Pn;e&&Yv(t,e)?v0(r,n):(t.flags=t.flags&-4097|2,rt=!1,Pn=t)}}else{if(em(t))throw Error(H(418));t.flags=t.flags&-4097|2,rt=!1,Pn=t}}}function Xv(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Pn=t}function lu(t){if(t!==Pn)return!1;if(!rt)return Xv(t),rt=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Yp(t.type,t.memoizedProps)),e&&(e=Cn)){if(em(t))throw w0(),Error(H(418));for(;e;)v0(t,e),e=Ni(e.nextSibling)}if(Xv(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(H(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){Cn=Ni(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}Cn=null}}else Cn=Pn?Ni(t.stateNode.nextSibling):null;return!0}function w0(){for(var t=Cn;t;)t=Ni(t.nextSibling)}function ta(){Cn=Pn=null,rt=!1}function bg(t){nr===null?nr=[t]:nr.push(t)}var G1=ei.ReactCurrentBatchConfig;function Qa(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(H(309));var r=n.stateNode}if(!r)throw Error(H(147,t));var i=r,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(o){var a=i.refs;o===null?delete a[s]:a[s]=o},e._stringRef=s,e)}if(typeof t!="string")throw Error(H(284));if(!n._owner)throw Error(H(290,t))}return t}function cu(t,e){throw t=Object.prototype.toString.call(e),Error(H(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function Jv(t){var e=t._init;return e(t._payload)}function E0(t){function e(I,_){if(t){var T=I.deletions;T===null?(I.deletions=[_],I.flags|=16):T.push(_)}}function n(I,_){if(!t)return null;for(;_!==null;)e(I,_),_=_.sibling;return null}function r(I,_){for(I=new Map;_!==null;)_.key!==null?I.set(_.key,_):I.set(_.index,_),_=_.sibling;return I}function i(I,_){return I=Oi(I,_),I.index=0,I.sibling=null,I}function s(I,_,T){return I.index=T,t?(T=I.alternate,T!==null?(T=T.index,T<_?(I.flags|=2,_):T):(I.flags|=2,_)):(I.flags|=1048576,_)}function o(I){return t&&I.alternate===null&&(I.flags|=2),I}function a(I,_,T,R){return _===null||_.tag!==6?(_=Yf(T,I.mode,R),_.return=I,_):(_=i(_,T),_.return=I,_)}function l(I,_,T,R){var O=T.type;return O===Ao?h(I,_,T.props.children,R,T.key):_!==null&&(_.elementType===O||typeof O=="object"&&O!==null&&O.$$typeof===mi&&Jv(O)===_.type)?(R=i(_,T.props),R.ref=Qa(I,_,T),R.return=I,R):(R=Mu(T.type,T.key,T.props,null,I.mode,R),R.ref=Qa(I,_,T),R.return=I,R)}function d(I,_,T,R){return _===null||_.tag!==4||_.stateNode.containerInfo!==T.containerInfo||_.stateNode.implementation!==T.implementation?(_=Xf(T,I.mode,R),_.return=I,_):(_=i(_,T.children||[]),_.return=I,_)}function h(I,_,T,R,O){return _===null||_.tag!==7?(_=Cs(T,I.mode,R,O),_.return=I,_):(_=i(_,T),_.return=I,_)}function f(I,_,T){if(typeof _=="string"&&_!==""||typeof _=="number")return _=Yf(""+_,I.mode,T),_.return=I,_;if(typeof _=="object"&&_!==null){switch(_.$$typeof){case Jc:return T=Mu(_.type,_.key,_.props,null,I.mode,T),T.ref=Qa(I,null,_),T.return=I,T;case bo:return _=Xf(_,I.mode,T),_.return=I,_;case mi:var R=_._init;return f(I,R(_._payload),T)}if(al(_)||qa(_))return _=Cs(_,I.mode,T,null),_.return=I,_;cu(I,_)}return null}function m(I,_,T,R){var O=_!==null?_.key:null;if(typeof T=="string"&&T!==""||typeof T=="number")return O!==null?null:a(I,_,""+T,R);if(typeof T=="object"&&T!==null){switch(T.$$typeof){case Jc:return T.key===O?l(I,_,T,R):null;case bo:return T.key===O?d(I,_,T,R):null;case mi:return O=T._init,m(I,_,O(T._payload),R)}if(al(T)||qa(T))return O!==null?null:h(I,_,T,R,null);cu(I,T)}return null}function v(I,_,T,R,O){if(typeof R=="string"&&R!==""||typeof R=="number")return I=I.get(T)||null,a(_,I,""+R,O);if(typeof R=="object"&&R!==null){switch(R.$$typeof){case Jc:return I=I.get(R.key===null?T:R.key)||null,l(_,I,R,O);case bo:return I=I.get(R.key===null?T:R.key)||null,d(_,I,R,O);case mi:var $=R._init;return v(I,_,T,$(R._payload),O)}if(al(R)||qa(R))return I=I.get(T)||null,h(_,I,R,O,null);cu(_,R)}return null}function C(I,_,T,R){for(var O=null,$=null,x=_,w=_=0,A=null;x!==null&&w<T.length;w++){x.index>w?(A=x,x=null):A=x.sibling;var k=m(I,x,T[w],R);if(k===null){x===null&&(x=A);break}t&&x&&k.alternate===null&&e(I,x),_=s(k,_,w),$===null?O=k:$.sibling=k,$=k,x=A}if(w===T.length)return n(I,x),rt&&hs(I,w),O;if(x===null){for(;w<T.length;w++)x=f(I,T[w],R),x!==null&&(_=s(x,_,w),$===null?O=x:$.sibling=x,$=x);return rt&&hs(I,w),O}for(x=r(I,x);w<T.length;w++)A=v(x,I,w,T[w],R),A!==null&&(t&&A.alternate!==null&&x.delete(A.key===null?w:A.key),_=s(A,_,w),$===null?O=A:$.sibling=A,$=A);return t&&x.forEach(function(D){return e(I,D)}),rt&&hs(I,w),O}function y(I,_,T,R){var O=qa(T);if(typeof O!="function")throw Error(H(150));if(T=O.call(T),T==null)throw Error(H(151));for(var $=O=null,x=_,w=_=0,A=null,k=T.next();x!==null&&!k.done;w++,k=T.next()){x.index>w?(A=x,x=null):A=x.sibling;var D=m(I,x,k.value,R);if(D===null){x===null&&(x=A);break}t&&x&&D.alternate===null&&e(I,x),_=s(D,_,w),$===null?O=D:$.sibling=D,$=D,x=A}if(k.done)return n(I,x),rt&&hs(I,w),O;if(x===null){for(;!k.done;w++,k=T.next())k=f(I,k.value,R),k!==null&&(_=s(k,_,w),$===null?O=k:$.sibling=k,$=k);return rt&&hs(I,w),O}for(x=r(I,x);!k.done;w++,k=T.next())k=v(x,I,w,k.value,R),k!==null&&(t&&k.alternate!==null&&x.delete(k.key===null?w:k.key),_=s(k,_,w),$===null?O=k:$.sibling=k,$=k);return t&&x.forEach(function(j){return e(I,j)}),rt&&hs(I,w),O}function N(I,_,T,R){if(typeof T=="object"&&T!==null&&T.type===Ao&&T.key===null&&(T=T.props.children),typeof T=="object"&&T!==null){switch(T.$$typeof){case Jc:e:{for(var O=T.key,$=_;$!==null;){if($.key===O){if(O=T.type,O===Ao){if($.tag===7){n(I,$.sibling),_=i($,T.props.children),_.return=I,I=_;break e}}else if($.elementType===O||typeof O=="object"&&O!==null&&O.$$typeof===mi&&Jv(O)===$.type){n(I,$.sibling),_=i($,T.props),_.ref=Qa(I,$,T),_.return=I,I=_;break e}n(I,$);break}else e(I,$);$=$.sibling}T.type===Ao?(_=Cs(T.props.children,I.mode,R,T.key),_.return=I,I=_):(R=Mu(T.type,T.key,T.props,null,I.mode,R),R.ref=Qa(I,_,T),R.return=I,I=R)}return o(I);case bo:e:{for($=T.key;_!==null;){if(_.key===$)if(_.tag===4&&_.stateNode.containerInfo===T.containerInfo&&_.stateNode.implementation===T.implementation){n(I,_.sibling),_=i(_,T.children||[]),_.return=I,I=_;break e}else{n(I,_);break}else e(I,_);_=_.sibling}_=Xf(T,I.mode,R),_.return=I,I=_}return o(I);case mi:return $=T._init,N(I,_,$(T._payload),R)}if(al(T))return C(I,_,T,R);if(qa(T))return y(I,_,T,R);cu(I,T)}return typeof T=="string"&&T!==""||typeof T=="number"?(T=""+T,_!==null&&_.tag===6?(n(I,_.sibling),_=i(_,T),_.return=I,I=_):(n(I,_),_=Yf(T,I.mode,R),_.return=I,I=_),o(I)):n(I,_)}return N}var na=E0(!0),I0=E0(!1),gd=Xi(null),yd=null,Vo=null,Ag=null;function Cg(){Ag=Vo=yd=null}function Rg(t){var e=gd.current;tt(gd),t._currentValue=e}function nm(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function zo(t,e){yd=t,Ag=Vo=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(yn=!0),t.firstContext=null)}function Wn(t){var e=t._currentValue;if(Ag!==t)if(t={context:t,memoizedValue:e,next:null},Vo===null){if(yd===null)throw Error(H(308));Vo=t,yd.dependencies={lanes:0,firstContext:t}}else Vo=Vo.next=t;return e}var Ts=null;function Pg(t){Ts===null?Ts=[t]:Ts.push(t)}function T0(t,e,n,r){var i=e.interleaved;return i===null?(n.next=n,Pg(e)):(n.next=i.next,i.next=n),e.interleaved=n,Wr(t,r)}function Wr(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var gi=!1;function kg(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function x0(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function $r(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Di(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,Le&2){var i=r.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),r.pending=e,Wr(t,n)}return i=r.interleaved,i===null?(e.next=e,Pg(r)):(e.next=i.next,i.next=e),r.interleaved=e,Wr(t,n)}function Nu(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,gg(t,n)}}function Zv(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,s=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};s===null?i=s=o:s=s.next=o,n=n.next}while(n!==null);s===null?i=s=e:s=s.next=e}else i=s=e;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function _d(t,e,n,r){var i=t.updateQueue;gi=!1;var s=i.firstBaseUpdate,o=i.lastBaseUpdate,a=i.shared.pending;if(a!==null){i.shared.pending=null;var l=a,d=l.next;l.next=null,o===null?s=d:o.next=d,o=l;var h=t.alternate;h!==null&&(h=h.updateQueue,a=h.lastBaseUpdate,a!==o&&(a===null?h.firstBaseUpdate=d:a.next=d,h.lastBaseUpdate=l))}if(s!==null){var f=i.baseState;o=0,h=d=l=null,a=s;do{var m=a.lane,v=a.eventTime;if((r&m)===m){h!==null&&(h=h.next={eventTime:v,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var C=t,y=a;switch(m=e,v=n,y.tag){case 1:if(C=y.payload,typeof C=="function"){f=C.call(v,f,m);break e}f=C;break e;case 3:C.flags=C.flags&-65537|128;case 0:if(C=y.payload,m=typeof C=="function"?C.call(v,f,m):C,m==null)break e;f=dt({},f,m);break e;case 2:gi=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,m=i.effects,m===null?i.effects=[a]:m.push(a))}else v={eventTime:v,lane:m,tag:a.tag,payload:a.payload,callback:a.callback,next:null},h===null?(d=h=v,l=f):h=h.next=v,o|=m;if(a=a.next,a===null){if(a=i.shared.pending,a===null)break;m=a,a=m.next,m.next=null,i.lastBaseUpdate=m,i.shared.pending=null}}while(!0);if(h===null&&(l=f),i.baseState=l,i.firstBaseUpdate=d,i.lastBaseUpdate=h,e=i.shared.interleaved,e!==null){i=e;do o|=i.lane,i=i.next;while(i!==e)}else s===null&&(i.shared.lanes=0);Ms|=o,t.lanes=o,t.memoizedState=f}}function ew(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(H(191,i));i.call(r)}}}var wc={},Ar=Xi(wc),Ql=Xi(wc),Yl=Xi(wc);function xs(t){if(t===wc)throw Error(H(174));return t}function Ng(t,e){switch(Ye(Yl,e),Ye(Ql,t),Ye(Ar,wc),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Op(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Op(e,t)}tt(Ar),Ye(Ar,e)}function ra(){tt(Ar),tt(Ql),tt(Yl)}function S0(t){xs(Yl.current);var e=xs(Ar.current),n=Op(e,t.type);e!==n&&(Ye(Ql,t),Ye(Ar,n))}function Dg(t){Ql.current===t&&(tt(Ar),tt(Ql))}var at=Xi(0);function vd(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var qf=[];function jg(){for(var t=0;t<qf.length;t++)qf[t]._workInProgressVersionPrimary=null;qf.length=0}var Du=ei.ReactCurrentDispatcher,Hf=ei.ReactCurrentBatchConfig,Ls=0,ut=null,At=null,Vt=null,wd=!1,xl=!1,Xl=0,Q1=0;function Kt(){throw Error(H(321))}function Vg(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!lr(t[n],e[n]))return!1;return!0}function Og(t,e,n,r,i,s){if(Ls=s,ut=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Du.current=t===null||t.memoizedState===null?Z1:eP,t=n(r,i),xl){s=0;do{if(xl=!1,Xl=0,25<=s)throw Error(H(301));s+=1,Vt=At=null,e.updateQueue=null,Du.current=tP,t=n(r,i)}while(xl)}if(Du.current=Ed,e=At!==null&&At.next!==null,Ls=0,Vt=At=ut=null,wd=!1,e)throw Error(H(300));return t}function Lg(){var t=Xl!==0;return Xl=0,t}function wr(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Vt===null?ut.memoizedState=Vt=t:Vt=Vt.next=t,Vt}function Kn(){if(At===null){var t=ut.alternate;t=t!==null?t.memoizedState:null}else t=At.next;var e=Vt===null?ut.memoizedState:Vt.next;if(e!==null)Vt=e,At=t;else{if(t===null)throw Error(H(310));At=t,t={memoizedState:At.memoizedState,baseState:At.baseState,baseQueue:At.baseQueue,queue:At.queue,next:null},Vt===null?ut.memoizedState=Vt=t:Vt=Vt.next=t}return Vt}function Jl(t,e){return typeof e=="function"?e(t):e}function Wf(t){var e=Kn(),n=e.queue;if(n===null)throw Error(H(311));n.lastRenderedReducer=t;var r=At,i=r.baseQueue,s=n.pending;if(s!==null){if(i!==null){var o=i.next;i.next=s.next,s.next=o}r.baseQueue=i=s,n.pending=null}if(i!==null){s=i.next,r=r.baseState;var a=o=null,l=null,d=s;do{var h=d.lane;if((Ls&h)===h)l!==null&&(l=l.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),r=d.hasEagerState?d.eagerState:t(r,d.action);else{var f={lane:h,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};l===null?(a=l=f,o=r):l=l.next=f,ut.lanes|=h,Ms|=h}d=d.next}while(d!==null&&d!==s);l===null?o=r:l.next=a,lr(r,e.memoizedState)||(yn=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=l,n.lastRenderedState=r}if(t=n.interleaved,t!==null){i=t;do s=i.lane,ut.lanes|=s,Ms|=s,i=i.next;while(i!==t)}else i===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function Kf(t){var e=Kn(),n=e.queue;if(n===null)throw Error(H(311));n.lastRenderedReducer=t;var r=n.dispatch,i=n.pending,s=e.memoizedState;if(i!==null){n.pending=null;var o=i=i.next;do s=t(s,o.action),o=o.next;while(o!==i);lr(s,e.memoizedState)||(yn=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),n.lastRenderedState=s}return[s,r]}function b0(){}function A0(t,e){var n=ut,r=Kn(),i=e(),s=!lr(r.memoizedState,i);if(s&&(r.memoizedState=i,yn=!0),r=r.queue,Mg(P0.bind(null,n,r,t),[t]),r.getSnapshot!==e||s||Vt!==null&&Vt.memoizedState.tag&1){if(n.flags|=2048,Zl(9,R0.bind(null,n,r,i,e),void 0,null),Ot===null)throw Error(H(349));Ls&30||C0(n,e,i)}return i}function C0(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=ut.updateQueue,e===null?(e={lastEffect:null,stores:null},ut.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function R0(t,e,n,r){e.value=n,e.getSnapshot=r,k0(e)&&N0(t)}function P0(t,e,n){return n(function(){k0(e)&&N0(t)})}function k0(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!lr(t,n)}catch{return!0}}function N0(t){var e=Wr(t,1);e!==null&&or(e,t,1,-1)}function tw(t){var e=wr();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Jl,lastRenderedState:t},e.queue=t,t=t.dispatch=J1.bind(null,ut,t),[e.memoizedState,t]}function Zl(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=ut.updateQueue,e===null?(e={lastEffect:null,stores:null},ut.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function D0(){return Kn().memoizedState}function ju(t,e,n,r){var i=wr();ut.flags|=t,i.memoizedState=Zl(1|e,n,void 0,r===void 0?null:r)}function hh(t,e,n,r){var i=Kn();r=r===void 0?null:r;var s=void 0;if(At!==null){var o=At.memoizedState;if(s=o.destroy,r!==null&&Vg(r,o.deps)){i.memoizedState=Zl(e,n,s,r);return}}ut.flags|=t,i.memoizedState=Zl(1|e,n,s,r)}function nw(t,e){return ju(8390656,8,t,e)}function Mg(t,e){return hh(2048,8,t,e)}function j0(t,e){return hh(4,2,t,e)}function V0(t,e){return hh(4,4,t,e)}function O0(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function L0(t,e,n){return n=n!=null?n.concat([t]):null,hh(4,4,O0.bind(null,e,t),n)}function Fg(){}function M0(t,e){var n=Kn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Vg(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function F0(t,e){var n=Kn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Vg(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function U0(t,e,n){return Ls&21?(lr(n,e)||(n=HT(),ut.lanes|=n,Ms|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,yn=!0),t.memoizedState=n)}function Y1(t,e){var n=We;We=n!==0&&4>n?n:4,t(!0);var r=Hf.transition;Hf.transition={};try{t(!1),e()}finally{We=n,Hf.transition=r}}function B0(){return Kn().memoizedState}function X1(t,e,n){var r=Vi(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},$0(t))z0(e,n);else if(n=T0(t,e,n,r),n!==null){var i=cn();or(n,t,r,i),q0(n,e,r)}}function J1(t,e,n){var r=Vi(t),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if($0(t))z0(e,i);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var o=e.lastRenderedState,a=s(o,n);if(i.hasEagerState=!0,i.eagerState=a,lr(a,o)){var l=e.interleaved;l===null?(i.next=i,Pg(e)):(i.next=l.next,l.next=i),e.interleaved=i;return}}catch{}finally{}n=T0(t,e,i,r),n!==null&&(i=cn(),or(n,t,r,i),q0(n,e,r))}}function $0(t){var e=t.alternate;return t===ut||e!==null&&e===ut}function z0(t,e){xl=wd=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function q0(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,gg(t,n)}}var Ed={readContext:Wn,useCallback:Kt,useContext:Kt,useEffect:Kt,useImperativeHandle:Kt,useInsertionEffect:Kt,useLayoutEffect:Kt,useMemo:Kt,useReducer:Kt,useRef:Kt,useState:Kt,useDebugValue:Kt,useDeferredValue:Kt,useTransition:Kt,useMutableSource:Kt,useSyncExternalStore:Kt,useId:Kt,unstable_isNewReconciler:!1},Z1={readContext:Wn,useCallback:function(t,e){return wr().memoizedState=[t,e===void 0?null:e],t},useContext:Wn,useEffect:nw,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,ju(4194308,4,O0.bind(null,e,t),n)},useLayoutEffect:function(t,e){return ju(4194308,4,t,e)},useInsertionEffect:function(t,e){return ju(4,2,t,e)},useMemo:function(t,e){var n=wr();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=wr();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=X1.bind(null,ut,t),[r.memoizedState,t]},useRef:function(t){var e=wr();return t={current:t},e.memoizedState=t},useState:tw,useDebugValue:Fg,useDeferredValue:function(t){return wr().memoizedState=t},useTransition:function(){var t=tw(!1),e=t[0];return t=Y1.bind(null,t[1]),wr().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=ut,i=wr();if(rt){if(n===void 0)throw Error(H(407));n=n()}else{if(n=e(),Ot===null)throw Error(H(349));Ls&30||C0(r,e,n)}i.memoizedState=n;var s={value:n,getSnapshot:e};return i.queue=s,nw(P0.bind(null,r,s,t),[t]),r.flags|=2048,Zl(9,R0.bind(null,r,s,n,e),void 0,null),n},useId:function(){var t=wr(),e=Ot.identifierPrefix;if(rt){var n=Mr,r=Lr;n=(r&~(1<<32-sr(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=Xl++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=Q1++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},eP={readContext:Wn,useCallback:M0,useContext:Wn,useEffect:Mg,useImperativeHandle:L0,useInsertionEffect:j0,useLayoutEffect:V0,useMemo:F0,useReducer:Wf,useRef:D0,useState:function(){return Wf(Jl)},useDebugValue:Fg,useDeferredValue:function(t){var e=Kn();return U0(e,At.memoizedState,t)},useTransition:function(){var t=Wf(Jl)[0],e=Kn().memoizedState;return[t,e]},useMutableSource:b0,useSyncExternalStore:A0,useId:B0,unstable_isNewReconciler:!1},tP={readContext:Wn,useCallback:M0,useContext:Wn,useEffect:Mg,useImperativeHandle:L0,useInsertionEffect:j0,useLayoutEffect:V0,useMemo:F0,useReducer:Kf,useRef:D0,useState:function(){return Kf(Jl)},useDebugValue:Fg,useDeferredValue:function(t){var e=Kn();return At===null?e.memoizedState=t:U0(e,At.memoizedState,t)},useTransition:function(){var t=Kf(Jl)[0],e=Kn().memoizedState;return[t,e]},useMutableSource:b0,useSyncExternalStore:A0,useId:B0,unstable_isNewReconciler:!1};function Zn(t,e){if(t&&t.defaultProps){e=dt({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function rm(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:dt({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var fh={isMounted:function(t){return(t=t._reactInternals)?to(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=cn(),i=Vi(t),s=$r(r,i);s.payload=e,n!=null&&(s.callback=n),e=Di(t,s,i),e!==null&&(or(e,t,i,r),Nu(e,t,i))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=cn(),i=Vi(t),s=$r(r,i);s.tag=1,s.payload=e,n!=null&&(s.callback=n),e=Di(t,s,i),e!==null&&(or(e,t,i,r),Nu(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=cn(),r=Vi(t),i=$r(n,r);i.tag=2,e!=null&&(i.callback=e),e=Di(t,i,r),e!==null&&(or(e,t,r,n),Nu(e,t,r))}};function rw(t,e,n,r,i,s,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,s,o):e.prototype&&e.prototype.isPureReactComponent?!Hl(n,r)||!Hl(i,s):!0}function H0(t,e,n){var r=!1,i=qi,s=e.contextType;return typeof s=="object"&&s!==null?s=Wn(s):(i=wn(e)?Vs:nn.current,r=e.contextTypes,s=(r=r!=null)?ea(t,i):qi),e=new e(n,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=fh,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=s),e}function iw(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&fh.enqueueReplaceState(e,e.state,null)}function im(t,e,n,r){var i=t.stateNode;i.props=n,i.state=t.memoizedState,i.refs={},kg(t);var s=e.contextType;typeof s=="object"&&s!==null?i.context=Wn(s):(s=wn(e)?Vs:nn.current,i.context=ea(t,s)),i.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(rm(t,e,s,n),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&fh.enqueueReplaceState(i,i.state,null),_d(t,n,i,r),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function ia(t,e){try{var n="",r=e;do n+=RR(r),r=r.return;while(r);var i=n}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:i,digest:null}}function Gf(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function sm(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var nP=typeof WeakMap=="function"?WeakMap:Map;function W0(t,e,n){n=$r(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){Td||(Td=!0,mm=r),sm(t,e)},n}function K0(t,e,n){n=$r(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var i=e.value;n.payload=function(){return r(i)},n.callback=function(){sm(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(n.callback=function(){sm(t,e),typeof r!="function"&&(ji===null?ji=new Set([this]):ji.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function sw(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new nP;var i=new Set;r.set(e,i)}else i=r.get(e),i===void 0&&(i=new Set,r.set(e,i));i.has(n)||(i.add(n),t=gP.bind(null,t,e,n),e.then(t,t))}function ow(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function aw(t,e,n,r,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=$r(-1,1),e.tag=2,Di(n,e,1))),n.lanes|=1),t)}var rP=ei.ReactCurrentOwner,yn=!1;function on(t,e,n,r){e.child=t===null?I0(e,null,n,r):na(e,t.child,n,r)}function lw(t,e,n,r,i){n=n.render;var s=e.ref;return zo(e,i),r=Og(t,e,n,r,s,i),n=Lg(),t!==null&&!yn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,Kr(t,e,i)):(rt&&n&&xg(e),e.flags|=1,on(t,e,r,i),e.child)}function cw(t,e,n,r,i){if(t===null){var s=n.type;return typeof s=="function"&&!Kg(s)&&s.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=s,G0(t,e,s,r,i)):(t=Mu(n.type,null,r,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&i)){var o=s.memoizedProps;if(n=n.compare,n=n!==null?n:Hl,n(o,r)&&t.ref===e.ref)return Kr(t,e,i)}return e.flags|=1,t=Oi(s,r),t.ref=e.ref,t.return=e,e.child=t}function G0(t,e,n,r,i){if(t!==null){var s=t.memoizedProps;if(Hl(s,r)&&t.ref===e.ref)if(yn=!1,e.pendingProps=r=s,(t.lanes&i)!==0)t.flags&131072&&(yn=!0);else return e.lanes=t.lanes,Kr(t,e,i)}return om(t,e,n,r,i)}function Q0(t,e,n){var r=e.pendingProps,i=r.children,s=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ye(Lo,xn),xn|=n;else{if(!(n&1073741824))return t=s!==null?s.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Ye(Lo,xn),xn|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=s!==null?s.baseLanes:n,Ye(Lo,xn),xn|=r}else s!==null?(r=s.baseLanes|n,e.memoizedState=null):r=n,Ye(Lo,xn),xn|=r;return on(t,e,i,n),e.child}function Y0(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function om(t,e,n,r,i){var s=wn(n)?Vs:nn.current;return s=ea(e,s),zo(e,i),n=Og(t,e,n,r,s,i),r=Lg(),t!==null&&!yn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,Kr(t,e,i)):(rt&&r&&xg(e),e.flags|=1,on(t,e,n,i),e.child)}function uw(t,e,n,r,i){if(wn(n)){var s=!0;fd(e)}else s=!1;if(zo(e,i),e.stateNode===null)Vu(t,e),H0(e,n,r),im(e,n,r,i),r=!0;else if(t===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var l=o.context,d=n.contextType;typeof d=="object"&&d!==null?d=Wn(d):(d=wn(n)?Vs:nn.current,d=ea(e,d));var h=n.getDerivedStateFromProps,f=typeof h=="function"||typeof o.getSnapshotBeforeUpdate=="function";f||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==r||l!==d)&&iw(e,o,r,d),gi=!1;var m=e.memoizedState;o.state=m,_d(e,r,o,i),l=e.memoizedState,a!==r||m!==l||vn.current||gi?(typeof h=="function"&&(rm(e,n,h,r),l=e.memoizedState),(a=gi||rw(e,n,a,r,m,l,d))?(f||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=l),o.props=r,o.state=l,o.context=d,r=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,x0(t,e),a=e.memoizedProps,d=e.type===e.elementType?a:Zn(e.type,a),o.props=d,f=e.pendingProps,m=o.context,l=n.contextType,typeof l=="object"&&l!==null?l=Wn(l):(l=wn(n)?Vs:nn.current,l=ea(e,l));var v=n.getDerivedStateFromProps;(h=typeof v=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==f||m!==l)&&iw(e,o,r,l),gi=!1,m=e.memoizedState,o.state=m,_d(e,r,o,i);var C=e.memoizedState;a!==f||m!==C||vn.current||gi?(typeof v=="function"&&(rm(e,n,v,r),C=e.memoizedState),(d=gi||rw(e,n,d,r,m,C,l)||!1)?(h||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,C,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,C,l)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&m===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&m===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=C),o.props=r,o.state=C,o.context=l,r=d):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&m===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&m===t.memoizedState||(e.flags|=1024),r=!1)}return am(t,e,n,r,s,i)}function am(t,e,n,r,i,s){Y0(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return i&&Qv(e,n,!1),Kr(t,e,s);r=e.stateNode,rP.current=e;var a=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=na(e,t.child,null,s),e.child=na(e,null,a,s)):on(t,e,a,s),e.memoizedState=r.state,i&&Qv(e,n,!0),e.child}function X0(t){var e=t.stateNode;e.pendingContext?Gv(t,e.pendingContext,e.pendingContext!==e.context):e.context&&Gv(t,e.context,!1),Ng(t,e.containerInfo)}function dw(t,e,n,r,i){return ta(),bg(i),e.flags|=256,on(t,e,n,r),e.child}var lm={dehydrated:null,treeContext:null,retryLane:0};function cm(t){return{baseLanes:t,cachePool:null,transitions:null}}function J0(t,e,n){var r=e.pendingProps,i=at.current,s=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=t!==null&&t.memoizedState===null?!1:(i&2)!==0),a?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),Ye(at,i&1),t===null)return tm(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,s?(r=e.mode,s=e.child,o={mode:"hidden",children:o},!(r&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=gh(o,r,0,null),t=Cs(t,r,n,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=cm(n),e.memoizedState=lm,t):Ug(e,o));if(i=t.memoizedState,i!==null&&(a=i.dehydrated,a!==null))return iP(t,e,o,r,a,i,n);if(s){s=r.fallback,o=e.mode,i=t.child,a=i.sibling;var l={mode:"hidden",children:r.children};return!(o&1)&&e.child!==i?(r=e.child,r.childLanes=0,r.pendingProps=l,e.deletions=null):(r=Oi(i,l),r.subtreeFlags=i.subtreeFlags&14680064),a!==null?s=Oi(a,s):(s=Cs(s,o,n,null),s.flags|=2),s.return=e,r.return=e,r.sibling=s,e.child=r,r=s,s=e.child,o=t.child.memoizedState,o=o===null?cm(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=t.childLanes&~n,e.memoizedState=lm,r}return s=t.child,t=s.sibling,r=Oi(s,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function Ug(t,e){return e=gh({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function uu(t,e,n,r){return r!==null&&bg(r),na(e,t.child,null,n),t=Ug(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function iP(t,e,n,r,i,s,o){if(n)return e.flags&256?(e.flags&=-257,r=Gf(Error(H(422))),uu(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=r.fallback,i=e.mode,r=gh({mode:"visible",children:r.children},i,0,null),s=Cs(s,i,o,null),s.flags|=2,r.return=e,s.return=e,r.sibling=s,e.child=r,e.mode&1&&na(e,t.child,null,o),e.child.memoizedState=cm(o),e.memoizedState=lm,s);if(!(e.mode&1))return uu(t,e,o,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var a=r.dgst;return r=a,s=Error(H(419)),r=Gf(s,r,void 0),uu(t,e,o,r)}if(a=(o&t.childLanes)!==0,yn||a){if(r=Ot,r!==null){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|o)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,Wr(t,i),or(r,t,i,-1))}return Wg(),r=Gf(Error(H(421))),uu(t,e,o,r)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=yP.bind(null,t),i._reactRetry=e,null):(t=s.treeContext,Cn=Ni(i.nextSibling),Pn=e,rt=!0,nr=null,t!==null&&(Mn[Fn++]=Lr,Mn[Fn++]=Mr,Mn[Fn++]=Os,Lr=t.id,Mr=t.overflow,Os=e),e=Ug(e,r.children),e.flags|=4096,e)}function hw(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),nm(t.return,e,n)}function Qf(t,e,n,r,i){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailMode=i)}function Z0(t,e,n){var r=e.pendingProps,i=r.revealOrder,s=r.tail;if(on(t,e,r.children,n),r=at.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&hw(t,n,e);else if(t.tag===19)hw(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(Ye(at,r),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(n=e.child,i=null;n!==null;)t=n.alternate,t!==null&&vd(t)===null&&(i=n),n=n.sibling;n=i,n===null?(i=e.child,e.child=null):(i=n.sibling,n.sibling=null),Qf(e,!1,i,n,s);break;case"backwards":for(n=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&vd(t)===null){e.child=i;break}t=i.sibling,i.sibling=n,n=i,i=t}Qf(e,!0,n,null,s);break;case"together":Qf(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Vu(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Kr(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),Ms|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(H(153));if(e.child!==null){for(t=e.child,n=Oi(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Oi(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function sP(t,e,n){switch(e.tag){case 3:X0(e),ta();break;case 5:S0(e);break;case 1:wn(e.type)&&fd(e);break;case 4:Ng(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;Ye(gd,r._currentValue),r._currentValue=i;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(Ye(at,at.current&1),e.flags|=128,null):n&e.child.childLanes?J0(t,e,n):(Ye(at,at.current&1),t=Kr(t,e,n),t!==null?t.sibling:null);Ye(at,at.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return Z0(t,e,n);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),Ye(at,at.current),r)break;return null;case 22:case 23:return e.lanes=0,Q0(t,e,n)}return Kr(t,e,n)}var ex,um,tx,nx;ex=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};um=function(){};tx=function(t,e,n,r){var i=t.memoizedProps;if(i!==r){t=e.stateNode,xs(Ar.current);var s=null;switch(n){case"input":i=Np(t,i),r=Np(t,r),s=[];break;case"select":i=dt({},i,{value:void 0}),r=dt({},r,{value:void 0}),s=[];break;case"textarea":i=Vp(t,i),r=Vp(t,r),s=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=dd)}Lp(n,r);var o;n=null;for(d in i)if(!r.hasOwnProperty(d)&&i.hasOwnProperty(d)&&i[d]!=null)if(d==="style"){var a=i[d];for(o in a)a.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(Ml.hasOwnProperty(d)?s||(s=[]):(s=s||[]).push(d,null));for(d in r){var l=r[d];if(a=i!=null?i[d]:void 0,r.hasOwnProperty(d)&&l!==a&&(l!=null||a!=null))if(d==="style")if(a){for(o in a)!a.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in l)l.hasOwnProperty(o)&&a[o]!==l[o]&&(n||(n={}),n[o]=l[o])}else n||(s||(s=[]),s.push(d,n)),n=l;else d==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(s=s||[]).push(d,l)):d==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(d,""+l):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(Ml.hasOwnProperty(d)?(l!=null&&d==="onScroll"&&Ze("scroll",t),s||a===l||(s=[])):(s=s||[]).push(d,l))}n&&(s=s||[]).push("style",n);var d=s;(e.updateQueue=d)&&(e.flags|=4)}};nx=function(t,e,n,r){n!==r&&(e.flags|=4)};function Ya(t,e){if(!rt)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function Gt(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function oP(t,e,n){var r=e.pendingProps;switch(Sg(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Gt(e),null;case 1:return wn(e.type)&&hd(),Gt(e),null;case 3:return r=e.stateNode,ra(),tt(vn),tt(nn),jg(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(lu(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,nr!==null&&(_m(nr),nr=null))),um(t,e),Gt(e),null;case 5:Dg(e);var i=xs(Yl.current);if(n=e.type,t!==null&&e.stateNode!=null)tx(t,e,n,r,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(H(166));return Gt(e),null}if(t=xs(Ar.current),lu(e)){r=e.stateNode,n=e.type;var s=e.memoizedProps;switch(r[Ir]=e,r[Gl]=s,t=(e.mode&1)!==0,n){case"dialog":Ze("cancel",r),Ze("close",r);break;case"iframe":case"object":case"embed":Ze("load",r);break;case"video":case"audio":for(i=0;i<cl.length;i++)Ze(cl[i],r);break;case"source":Ze("error",r);break;case"img":case"image":case"link":Ze("error",r),Ze("load",r);break;case"details":Ze("toggle",r);break;case"input":Ev(r,s),Ze("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},Ze("invalid",r);break;case"textarea":Tv(r,s),Ze("invalid",r)}Lp(n,s),i=null;for(var o in s)if(s.hasOwnProperty(o)){var a=s[o];o==="children"?typeof a=="string"?r.textContent!==a&&(s.suppressHydrationWarning!==!0&&au(r.textContent,a,t),i=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(s.suppressHydrationWarning!==!0&&au(r.textContent,a,t),i=["children",""+a]):Ml.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&Ze("scroll",r)}switch(n){case"input":Zc(r),Iv(r,s,!0);break;case"textarea":Zc(r),xv(r);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(r.onclick=dd)}r=i,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=PT(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[Ir]=e,t[Gl]=r,ex(t,e,!1,!1),e.stateNode=t;e:{switch(o=Mp(n,r),n){case"dialog":Ze("cancel",t),Ze("close",t),i=r;break;case"iframe":case"object":case"embed":Ze("load",t),i=r;break;case"video":case"audio":for(i=0;i<cl.length;i++)Ze(cl[i],t);i=r;break;case"source":Ze("error",t),i=r;break;case"img":case"image":case"link":Ze("error",t),Ze("load",t),i=r;break;case"details":Ze("toggle",t),i=r;break;case"input":Ev(t,r),i=Np(t,r),Ze("invalid",t);break;case"option":i=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},i=dt({},r,{value:void 0}),Ze("invalid",t);break;case"textarea":Tv(t,r),i=Vp(t,r),Ze("invalid",t);break;default:i=r}Lp(n,i),a=i;for(s in a)if(a.hasOwnProperty(s)){var l=a[s];s==="style"?DT(t,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&kT(t,l)):s==="children"?typeof l=="string"?(n!=="textarea"||l!=="")&&Fl(t,l):typeof l=="number"&&Fl(t,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(Ml.hasOwnProperty(s)?l!=null&&s==="onScroll"&&Ze("scroll",t):l!=null&&ug(t,s,l,o))}switch(n){case"input":Zc(t),Iv(t,r,!1);break;case"textarea":Zc(t),xv(t);break;case"option":r.value!=null&&t.setAttribute("value",""+zi(r.value));break;case"select":t.multiple=!!r.multiple,s=r.value,s!=null?Fo(t,!!r.multiple,s,!1):r.defaultValue!=null&&Fo(t,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=dd)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Gt(e),null;case 6:if(t&&e.stateNode!=null)nx(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(H(166));if(n=xs(Yl.current),xs(Ar.current),lu(e)){if(r=e.stateNode,n=e.memoizedProps,r[Ir]=e,(s=r.nodeValue!==n)&&(t=Pn,t!==null))switch(t.tag){case 3:au(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&au(r.nodeValue,n,(t.mode&1)!==0)}s&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Ir]=e,e.stateNode=r}return Gt(e),null;case 13:if(tt(at),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(rt&&Cn!==null&&e.mode&1&&!(e.flags&128))w0(),ta(),e.flags|=98560,s=!1;else if(s=lu(e),r!==null&&r.dehydrated!==null){if(t===null){if(!s)throw Error(H(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(H(317));s[Ir]=e}else ta(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Gt(e),s=!1}else nr!==null&&(_m(nr),nr=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||at.current&1?Ct===0&&(Ct=3):Wg())),e.updateQueue!==null&&(e.flags|=4),Gt(e),null);case 4:return ra(),um(t,e),t===null&&Wl(e.stateNode.containerInfo),Gt(e),null;case 10:return Rg(e.type._context),Gt(e),null;case 17:return wn(e.type)&&hd(),Gt(e),null;case 19:if(tt(at),s=e.memoizedState,s===null)return Gt(e),null;if(r=(e.flags&128)!==0,o=s.rendering,o===null)if(r)Ya(s,!1);else{if(Ct!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=vd(t),o!==null){for(e.flags|=128,Ya(s,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)s=n,t=r,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,t=o.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return Ye(at,at.current&1|2),e.child}t=t.sibling}s.tail!==null&&vt()>sa&&(e.flags|=128,r=!0,Ya(s,!1),e.lanes=4194304)}else{if(!r)if(t=vd(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Ya(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!rt)return Gt(e),null}else 2*vt()-s.renderingStartTime>sa&&n!==1073741824&&(e.flags|=128,r=!0,Ya(s,!1),e.lanes=4194304);s.isBackwards?(o.sibling=e.child,e.child=o):(n=s.last,n!==null?n.sibling=o:e.child=o,s.last=o)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=vt(),e.sibling=null,n=at.current,Ye(at,r?n&1|2:n&1),e):(Gt(e),null);case 22:case 23:return Hg(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?xn&1073741824&&(Gt(e),e.subtreeFlags&6&&(e.flags|=8192)):Gt(e),null;case 24:return null;case 25:return null}throw Error(H(156,e.tag))}function aP(t,e){switch(Sg(e),e.tag){case 1:return wn(e.type)&&hd(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return ra(),tt(vn),tt(nn),jg(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return Dg(e),null;case 13:if(tt(at),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(H(340));ta()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return tt(at),null;case 4:return ra(),null;case 10:return Rg(e.type._context),null;case 22:case 23:return Hg(),null;case 24:return null;default:return null}}var du=!1,Xt=!1,lP=typeof WeakSet=="function"?WeakSet:Set,ae=null;function Oo(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){ft(t,e,r)}else n.current=null}function dm(t,e,n){try{n()}catch(r){ft(t,e,r)}}var fw=!1;function cP(t,e){if(Gp=ld,t=a0(),Tg(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{n.nodeType,s.nodeType}catch{n=null;break e}var o=0,a=-1,l=-1,d=0,h=0,f=t,m=null;t:for(;;){for(var v;f!==n||i!==0&&f.nodeType!==3||(a=o+i),f!==s||r!==0&&f.nodeType!==3||(l=o+r),f.nodeType===3&&(o+=f.nodeValue.length),(v=f.firstChild)!==null;)m=f,f=v;for(;;){if(f===t)break t;if(m===n&&++d===i&&(a=o),m===s&&++h===r&&(l=o),(v=f.nextSibling)!==null)break;f=m,m=f.parentNode}f=v}n=a===-1||l===-1?null:{start:a,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(Qp={focusedElem:t,selectionRange:n},ld=!1,ae=e;ae!==null;)if(e=ae,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,ae=t;else for(;ae!==null;){e=ae;try{var C=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(C!==null){var y=C.memoizedProps,N=C.memoizedState,I=e.stateNode,_=I.getSnapshotBeforeUpdate(e.elementType===e.type?y:Zn(e.type,y),N);I.__reactInternalSnapshotBeforeUpdate=_}break;case 3:var T=e.stateNode.containerInfo;T.nodeType===1?T.textContent="":T.nodeType===9&&T.documentElement&&T.removeChild(T.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(H(163))}}catch(R){ft(e,e.return,R)}if(t=e.sibling,t!==null){t.return=e.return,ae=t;break}ae=e.return}return C=fw,fw=!1,C}function Sl(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&t)===t){var s=i.destroy;i.destroy=void 0,s!==void 0&&dm(e,n,s)}i=i.next}while(i!==r)}}function ph(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function hm(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function rx(t){var e=t.alternate;e!==null&&(t.alternate=null,rx(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Ir],delete e[Gl],delete e[Jp],delete e[H1],delete e[W1])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function ix(t){return t.tag===5||t.tag===3||t.tag===4}function pw(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||ix(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function fm(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=dd));else if(r!==4&&(t=t.child,t!==null))for(fm(t,e,n),t=t.sibling;t!==null;)fm(t,e,n),t=t.sibling}function pm(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(pm(t,e,n),t=t.sibling;t!==null;)pm(t,e,n),t=t.sibling}var Mt=null,er=!1;function ui(t,e,n){for(n=n.child;n!==null;)sx(t,e,n),n=n.sibling}function sx(t,e,n){if(br&&typeof br.onCommitFiberUnmount=="function")try{br.onCommitFiberUnmount(oh,n)}catch{}switch(n.tag){case 5:Xt||Oo(n,e);case 6:var r=Mt,i=er;Mt=null,ui(t,e,n),Mt=r,er=i,Mt!==null&&(er?(t=Mt,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Mt.removeChild(n.stateNode));break;case 18:Mt!==null&&(er?(t=Mt,n=n.stateNode,t.nodeType===8?$f(t.parentNode,n):t.nodeType===1&&$f(t,n),zl(t)):$f(Mt,n.stateNode));break;case 4:r=Mt,i=er,Mt=n.stateNode.containerInfo,er=!0,ui(t,e,n),Mt=r,er=i;break;case 0:case 11:case 14:case 15:if(!Xt&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var s=i,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&dm(n,e,o),i=i.next}while(i!==r)}ui(t,e,n);break;case 1:if(!Xt&&(Oo(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(a){ft(n,e,a)}ui(t,e,n);break;case 21:ui(t,e,n);break;case 22:n.mode&1?(Xt=(r=Xt)||n.memoizedState!==null,ui(t,e,n),Xt=r):ui(t,e,n);break;default:ui(t,e,n)}}function mw(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new lP),e.forEach(function(r){var i=_P.bind(null,t,r);n.has(r)||(n.add(r),r.then(i,i))})}}function Jn(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var s=t,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:Mt=a.stateNode,er=!1;break e;case 3:Mt=a.stateNode.containerInfo,er=!0;break e;case 4:Mt=a.stateNode.containerInfo,er=!0;break e}a=a.return}if(Mt===null)throw Error(H(160));sx(s,o,i),Mt=null,er=!1;var l=i.alternate;l!==null&&(l.return=null),i.return=null}catch(d){ft(i,e,d)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)ox(e,t),e=e.sibling}function ox(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Jn(e,t),yr(t),r&4){try{Sl(3,t,t.return),ph(3,t)}catch(y){ft(t,t.return,y)}try{Sl(5,t,t.return)}catch(y){ft(t,t.return,y)}}break;case 1:Jn(e,t),yr(t),r&512&&n!==null&&Oo(n,n.return);break;case 5:if(Jn(e,t),yr(t),r&512&&n!==null&&Oo(n,n.return),t.flags&32){var i=t.stateNode;try{Fl(i,"")}catch(y){ft(t,t.return,y)}}if(r&4&&(i=t.stateNode,i!=null)){var s=t.memoizedProps,o=n!==null?n.memoizedProps:s,a=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{a==="input"&&s.type==="radio"&&s.name!=null&&CT(i,s),Mp(a,o);var d=Mp(a,s);for(o=0;o<l.length;o+=2){var h=l[o],f=l[o+1];h==="style"?DT(i,f):h==="dangerouslySetInnerHTML"?kT(i,f):h==="children"?Fl(i,f):ug(i,h,f,d)}switch(a){case"input":Dp(i,s);break;case"textarea":RT(i,s);break;case"select":var m=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var v=s.value;v!=null?Fo(i,!!s.multiple,v,!1):m!==!!s.multiple&&(s.defaultValue!=null?Fo(i,!!s.multiple,s.defaultValue,!0):Fo(i,!!s.multiple,s.multiple?[]:"",!1))}i[Gl]=s}catch(y){ft(t,t.return,y)}}break;case 6:if(Jn(e,t),yr(t),r&4){if(t.stateNode===null)throw Error(H(162));i=t.stateNode,s=t.memoizedProps;try{i.nodeValue=s}catch(y){ft(t,t.return,y)}}break;case 3:if(Jn(e,t),yr(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{zl(e.containerInfo)}catch(y){ft(t,t.return,y)}break;case 4:Jn(e,t),yr(t);break;case 13:Jn(e,t),yr(t),i=t.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(zg=vt())),r&4&&mw(t);break;case 22:if(h=n!==null&&n.memoizedState!==null,t.mode&1?(Xt=(d=Xt)||h,Jn(e,t),Xt=d):Jn(e,t),yr(t),r&8192){if(d=t.memoizedState!==null,(t.stateNode.isHidden=d)&&!h&&t.mode&1)for(ae=t,h=t.child;h!==null;){for(f=ae=h;ae!==null;){switch(m=ae,v=m.child,m.tag){case 0:case 11:case 14:case 15:Sl(4,m,m.return);break;case 1:Oo(m,m.return);var C=m.stateNode;if(typeof C.componentWillUnmount=="function"){r=m,n=m.return;try{e=r,C.props=e.memoizedProps,C.state=e.memoizedState,C.componentWillUnmount()}catch(y){ft(r,n,y)}}break;case 5:Oo(m,m.return);break;case 22:if(m.memoizedState!==null){yw(f);continue}}v!==null?(v.return=m,ae=v):yw(f)}h=h.sibling}e:for(h=null,f=t;;){if(f.tag===5){if(h===null){h=f;try{i=f.stateNode,d?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(a=f.stateNode,l=f.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=NT("display",o))}catch(y){ft(t,t.return,y)}}}else if(f.tag===6){if(h===null)try{f.stateNode.nodeValue=d?"":f.memoizedProps}catch(y){ft(t,t.return,y)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===t)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===t)break e;for(;f.sibling===null;){if(f.return===null||f.return===t)break e;h===f&&(h=null),f=f.return}h===f&&(h=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:Jn(e,t),yr(t),r&4&&mw(t);break;case 21:break;default:Jn(e,t),yr(t)}}function yr(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(ix(n)){var r=n;break e}n=n.return}throw Error(H(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(Fl(i,""),r.flags&=-33);var s=pw(t);pm(t,s,i);break;case 3:case 4:var o=r.stateNode.containerInfo,a=pw(t);fm(t,a,o);break;default:throw Error(H(161))}}catch(l){ft(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function uP(t,e,n){ae=t,ax(t)}function ax(t,e,n){for(var r=(t.mode&1)!==0;ae!==null;){var i=ae,s=i.child;if(i.tag===22&&r){var o=i.memoizedState!==null||du;if(!o){var a=i.alternate,l=a!==null&&a.memoizedState!==null||Xt;a=du;var d=Xt;if(du=o,(Xt=l)&&!d)for(ae=i;ae!==null;)o=ae,l=o.child,o.tag===22&&o.memoizedState!==null?_w(i):l!==null?(l.return=o,ae=l):_w(i);for(;s!==null;)ae=s,ax(s),s=s.sibling;ae=i,du=a,Xt=d}gw(t)}else i.subtreeFlags&8772&&s!==null?(s.return=i,ae=s):gw(t)}}function gw(t){for(;ae!==null;){var e=ae;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Xt||ph(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!Xt)if(n===null)r.componentDidMount();else{var i=e.elementType===e.type?n.memoizedProps:Zn(e.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&ew(e,s,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}ew(e,o,n)}break;case 5:var a=e.stateNode;if(n===null&&e.flags&4){n=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var d=e.alternate;if(d!==null){var h=d.memoizedState;if(h!==null){var f=h.dehydrated;f!==null&&zl(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(H(163))}Xt||e.flags&512&&hm(e)}catch(m){ft(e,e.return,m)}}if(e===t){ae=null;break}if(n=e.sibling,n!==null){n.return=e.return,ae=n;break}ae=e.return}}function yw(t){for(;ae!==null;){var e=ae;if(e===t){ae=null;break}var n=e.sibling;if(n!==null){n.return=e.return,ae=n;break}ae=e.return}}function _w(t){for(;ae!==null;){var e=ae;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{ph(4,e)}catch(l){ft(e,n,l)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var i=e.return;try{r.componentDidMount()}catch(l){ft(e,i,l)}}var s=e.return;try{hm(e)}catch(l){ft(e,s,l)}break;case 5:var o=e.return;try{hm(e)}catch(l){ft(e,o,l)}}}catch(l){ft(e,e.return,l)}if(e===t){ae=null;break}var a=e.sibling;if(a!==null){a.return=e.return,ae=a;break}ae=e.return}}var dP=Math.ceil,Id=ei.ReactCurrentDispatcher,Bg=ei.ReactCurrentOwner,qn=ei.ReactCurrentBatchConfig,Le=0,Ot=null,It=null,$t=0,xn=0,Lo=Xi(0),Ct=0,ec=null,Ms=0,mh=0,$g=0,bl=null,gn=null,zg=0,sa=1/0,Vr=null,Td=!1,mm=null,ji=null,hu=!1,Ai=null,xd=0,Al=0,gm=null,Ou=-1,Lu=0;function cn(){return Le&6?vt():Ou!==-1?Ou:Ou=vt()}function Vi(t){return t.mode&1?Le&2&&$t!==0?$t&-$t:G1.transition!==null?(Lu===0&&(Lu=HT()),Lu):(t=We,t!==0||(t=window.event,t=t===void 0?16:JT(t.type)),t):1}function or(t,e,n,r){if(50<Al)throw Al=0,gm=null,Error(H(185));yc(t,n,r),(!(Le&2)||t!==Ot)&&(t===Ot&&(!(Le&2)&&(mh|=n),Ct===4&&_i(t,$t)),En(t,r),n===1&&Le===0&&!(e.mode&1)&&(sa=vt()+500,dh&&Ji()))}function En(t,e){var n=t.callbackNode;GR(t,e);var r=ad(t,t===Ot?$t:0);if(r===0)n!==null&&Av(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&Av(n),e===1)t.tag===0?K1(vw.bind(null,t)):y0(vw.bind(null,t)),z1(function(){!(Le&6)&&Ji()}),n=null;else{switch(WT(r)){case 1:n=mg;break;case 4:n=zT;break;case 16:n=od;break;case 536870912:n=qT;break;default:n=od}n=mx(n,lx.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function lx(t,e){if(Ou=-1,Lu=0,Le&6)throw Error(H(327));var n=t.callbackNode;if(qo()&&t.callbackNode!==n)return null;var r=ad(t,t===Ot?$t:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=Sd(t,r);else{e=r;var i=Le;Le|=2;var s=ux();(Ot!==t||$t!==e)&&(Vr=null,sa=vt()+500,As(t,e));do try{pP();break}catch(a){cx(t,a)}while(!0);Cg(),Id.current=s,Le=i,It!==null?e=0:(Ot=null,$t=0,e=Ct)}if(e!==0){if(e===2&&(i=zp(t),i!==0&&(r=i,e=ym(t,i))),e===1)throw n=ec,As(t,0),_i(t,r),En(t,vt()),n;if(e===6)_i(t,r);else{if(i=t.current.alternate,!(r&30)&&!hP(i)&&(e=Sd(t,r),e===2&&(s=zp(t),s!==0&&(r=s,e=ym(t,s))),e===1))throw n=ec,As(t,0),_i(t,r),En(t,vt()),n;switch(t.finishedWork=i,t.finishedLanes=r,e){case 0:case 1:throw Error(H(345));case 2:fs(t,gn,Vr);break;case 3:if(_i(t,r),(r&130023424)===r&&(e=zg+500-vt(),10<e)){if(ad(t,0)!==0)break;if(i=t.suspendedLanes,(i&r)!==r){cn(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=Xp(fs.bind(null,t,gn,Vr),e);break}fs(t,gn,Vr);break;case 4:if(_i(t,r),(r&4194240)===r)break;for(e=t.eventTimes,i=-1;0<r;){var o=31-sr(r);s=1<<o,o=e[o],o>i&&(i=o),r&=~s}if(r=i,r=vt()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*dP(r/1960))-r,10<r){t.timeoutHandle=Xp(fs.bind(null,t,gn,Vr),r);break}fs(t,gn,Vr);break;case 5:fs(t,gn,Vr);break;default:throw Error(H(329))}}}return En(t,vt()),t.callbackNode===n?lx.bind(null,t):null}function ym(t,e){var n=bl;return t.current.memoizedState.isDehydrated&&(As(t,e).flags|=256),t=Sd(t,e),t!==2&&(e=gn,gn=n,e!==null&&_m(e)),t}function _m(t){gn===null?gn=t:gn.push.apply(gn,t)}function hP(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],s=i.getSnapshot;i=i.value;try{if(!lr(s(),i))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function _i(t,e){for(e&=~$g,e&=~mh,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-sr(e),r=1<<n;t[n]=-1,e&=~r}}function vw(t){if(Le&6)throw Error(H(327));qo();var e=ad(t,0);if(!(e&1))return En(t,vt()),null;var n=Sd(t,e);if(t.tag!==0&&n===2){var r=zp(t);r!==0&&(e=r,n=ym(t,r))}if(n===1)throw n=ec,As(t,0),_i(t,e),En(t,vt()),n;if(n===6)throw Error(H(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,fs(t,gn,Vr),En(t,vt()),null}function qg(t,e){var n=Le;Le|=1;try{return t(e)}finally{Le=n,Le===0&&(sa=vt()+500,dh&&Ji())}}function Fs(t){Ai!==null&&Ai.tag===0&&!(Le&6)&&qo();var e=Le;Le|=1;var n=qn.transition,r=We;try{if(qn.transition=null,We=1,t)return t()}finally{We=r,qn.transition=n,Le=e,!(Le&6)&&Ji()}}function Hg(){xn=Lo.current,tt(Lo)}function As(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,$1(n)),It!==null)for(n=It.return;n!==null;){var r=n;switch(Sg(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&hd();break;case 3:ra(),tt(vn),tt(nn),jg();break;case 5:Dg(r);break;case 4:ra();break;case 13:tt(at);break;case 19:tt(at);break;case 10:Rg(r.type._context);break;case 22:case 23:Hg()}n=n.return}if(Ot=t,It=t=Oi(t.current,null),$t=xn=e,Ct=0,ec=null,$g=mh=Ms=0,gn=bl=null,Ts!==null){for(e=0;e<Ts.length;e++)if(n=Ts[e],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,s=n.pending;if(s!==null){var o=s.next;s.next=i,r.next=o}n.pending=r}Ts=null}return t}function cx(t,e){do{var n=It;try{if(Cg(),Du.current=Ed,wd){for(var r=ut.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}wd=!1}if(Ls=0,Vt=At=ut=null,xl=!1,Xl=0,Bg.current=null,n===null||n.return===null){Ct=1,ec=e,It=null;break}e:{var s=t,o=n.return,a=n,l=e;if(e=$t,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var d=l,h=a,f=h.tag;if(!(h.mode&1)&&(f===0||f===11||f===15)){var m=h.alternate;m?(h.updateQueue=m.updateQueue,h.memoizedState=m.memoizedState,h.lanes=m.lanes):(h.updateQueue=null,h.memoizedState=null)}var v=ow(o);if(v!==null){v.flags&=-257,aw(v,o,a,s,e),v.mode&1&&sw(s,d,e),e=v,l=d;var C=e.updateQueue;if(C===null){var y=new Set;y.add(l),e.updateQueue=y}else C.add(l);break e}else{if(!(e&1)){sw(s,d,e),Wg();break e}l=Error(H(426))}}else if(rt&&a.mode&1){var N=ow(o);if(N!==null){!(N.flags&65536)&&(N.flags|=256),aw(N,o,a,s,e),bg(ia(l,a));break e}}s=l=ia(l,a),Ct!==4&&(Ct=2),bl===null?bl=[s]:bl.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var I=W0(s,l,e);Zv(s,I);break e;case 1:a=l;var _=s.type,T=s.stateNode;if(!(s.flags&128)&&(typeof _.getDerivedStateFromError=="function"||T!==null&&typeof T.componentDidCatch=="function"&&(ji===null||!ji.has(T)))){s.flags|=65536,e&=-e,s.lanes|=e;var R=K0(s,a,e);Zv(s,R);break e}}s=s.return}while(s!==null)}hx(n)}catch(O){e=O,It===n&&n!==null&&(It=n=n.return);continue}break}while(!0)}function ux(){var t=Id.current;return Id.current=Ed,t===null?Ed:t}function Wg(){(Ct===0||Ct===3||Ct===2)&&(Ct=4),Ot===null||!(Ms&268435455)&&!(mh&268435455)||_i(Ot,$t)}function Sd(t,e){var n=Le;Le|=2;var r=ux();(Ot!==t||$t!==e)&&(Vr=null,As(t,e));do try{fP();break}catch(i){cx(t,i)}while(!0);if(Cg(),Le=n,Id.current=r,It!==null)throw Error(H(261));return Ot=null,$t=0,Ct}function fP(){for(;It!==null;)dx(It)}function pP(){for(;It!==null&&!FR();)dx(It)}function dx(t){var e=px(t.alternate,t,xn);t.memoizedProps=t.pendingProps,e===null?hx(t):It=e,Bg.current=null}function hx(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=aP(n,e),n!==null){n.flags&=32767,It=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Ct=6,It=null;return}}else if(n=oP(n,e,xn),n!==null){It=n;return}if(e=e.sibling,e!==null){It=e;return}It=e=t}while(e!==null);Ct===0&&(Ct=5)}function fs(t,e,n){var r=We,i=qn.transition;try{qn.transition=null,We=1,mP(t,e,n,r)}finally{qn.transition=i,We=r}return null}function mP(t,e,n,r){do qo();while(Ai!==null);if(Le&6)throw Error(H(327));n=t.finishedWork;var i=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(H(177));t.callbackNode=null,t.callbackPriority=0;var s=n.lanes|n.childLanes;if(QR(t,s),t===Ot&&(It=Ot=null,$t=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||hu||(hu=!0,mx(od,function(){return qo(),null})),s=(n.flags&15990)!==0,n.subtreeFlags&15990||s){s=qn.transition,qn.transition=null;var o=We;We=1;var a=Le;Le|=4,Bg.current=null,cP(t,n),ox(n,t),V1(Qp),ld=!!Gp,Qp=Gp=null,t.current=n,uP(n),UR(),Le=a,We=o,qn.transition=s}else t.current=n;if(hu&&(hu=!1,Ai=t,xd=i),s=t.pendingLanes,s===0&&(ji=null),zR(n.stateNode),En(t,vt()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)i=e[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(Td)throw Td=!1,t=mm,mm=null,t;return xd&1&&t.tag!==0&&qo(),s=t.pendingLanes,s&1?t===gm?Al++:(Al=0,gm=t):Al=0,Ji(),null}function qo(){if(Ai!==null){var t=WT(xd),e=qn.transition,n=We;try{if(qn.transition=null,We=16>t?16:t,Ai===null)var r=!1;else{if(t=Ai,Ai=null,xd=0,Le&6)throw Error(H(331));var i=Le;for(Le|=4,ae=t.current;ae!==null;){var s=ae,o=s.child;if(ae.flags&16){var a=s.deletions;if(a!==null){for(var l=0;l<a.length;l++){var d=a[l];for(ae=d;ae!==null;){var h=ae;switch(h.tag){case 0:case 11:case 15:Sl(8,h,s)}var f=h.child;if(f!==null)f.return=h,ae=f;else for(;ae!==null;){h=ae;var m=h.sibling,v=h.return;if(rx(h),h===d){ae=null;break}if(m!==null){m.return=v,ae=m;break}ae=v}}}var C=s.alternate;if(C!==null){var y=C.child;if(y!==null){C.child=null;do{var N=y.sibling;y.sibling=null,y=N}while(y!==null)}}ae=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,ae=o;else e:for(;ae!==null;){if(s=ae,s.flags&2048)switch(s.tag){case 0:case 11:case 15:Sl(9,s,s.return)}var I=s.sibling;if(I!==null){I.return=s.return,ae=I;break e}ae=s.return}}var _=t.current;for(ae=_;ae!==null;){o=ae;var T=o.child;if(o.subtreeFlags&2064&&T!==null)T.return=o,ae=T;else e:for(o=_;ae!==null;){if(a=ae,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:ph(9,a)}}catch(O){ft(a,a.return,O)}if(a===o){ae=null;break e}var R=a.sibling;if(R!==null){R.return=a.return,ae=R;break e}ae=a.return}}if(Le=i,Ji(),br&&typeof br.onPostCommitFiberRoot=="function")try{br.onPostCommitFiberRoot(oh,t)}catch{}r=!0}return r}finally{We=n,qn.transition=e}}return!1}function ww(t,e,n){e=ia(n,e),e=W0(t,e,1),t=Di(t,e,1),e=cn(),t!==null&&(yc(t,1,e),En(t,e))}function ft(t,e,n){if(t.tag===3)ww(t,t,n);else for(;e!==null;){if(e.tag===3){ww(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(ji===null||!ji.has(r))){t=ia(n,t),t=K0(e,t,1),e=Di(e,t,1),t=cn(),e!==null&&(yc(e,1,t),En(e,t));break}}e=e.return}}function gP(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=cn(),t.pingedLanes|=t.suspendedLanes&n,Ot===t&&($t&n)===n&&(Ct===4||Ct===3&&($t&130023424)===$t&&500>vt()-zg?As(t,0):$g|=n),En(t,e)}function fx(t,e){e===0&&(t.mode&1?(e=nu,nu<<=1,!(nu&130023424)&&(nu=4194304)):e=1);var n=cn();t=Wr(t,e),t!==null&&(yc(t,e,n),En(t,n))}function yP(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),fx(t,n)}function _P(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,i=t.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(H(314))}r!==null&&r.delete(e),fx(t,n)}var px;px=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||vn.current)yn=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return yn=!1,sP(t,e,n);yn=!!(t.flags&131072)}else yn=!1,rt&&e.flags&1048576&&_0(e,md,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;Vu(t,e),t=e.pendingProps;var i=ea(e,nn.current);zo(e,n),i=Og(null,e,r,t,i,n);var s=Lg();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,wn(r)?(s=!0,fd(e)):s=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,kg(e),i.updater=fh,e.stateNode=i,i._reactInternals=e,im(e,r,t,n),e=am(null,e,r,!0,s,n)):(e.tag=0,rt&&s&&xg(e),on(null,e,i,n),e=e.child),e;case 16:r=e.elementType;e:{switch(Vu(t,e),t=e.pendingProps,i=r._init,r=i(r._payload),e.type=r,i=e.tag=wP(r),t=Zn(r,t),i){case 0:e=om(null,e,r,t,n);break e;case 1:e=uw(null,e,r,t,n);break e;case 11:e=lw(null,e,r,t,n);break e;case 14:e=cw(null,e,r,Zn(r.type,t),n);break e}throw Error(H(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Zn(r,i),om(t,e,r,i,n);case 1:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Zn(r,i),uw(t,e,r,i,n);case 3:e:{if(X0(e),t===null)throw Error(H(387));r=e.pendingProps,s=e.memoizedState,i=s.element,x0(t,e),_d(e,r,null,n);var o=e.memoizedState;if(r=o.element,s.isDehydrated)if(s={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){i=ia(Error(H(423)),e),e=dw(t,e,r,n,i);break e}else if(r!==i){i=ia(Error(H(424)),e),e=dw(t,e,r,n,i);break e}else for(Cn=Ni(e.stateNode.containerInfo.firstChild),Pn=e,rt=!0,nr=null,n=I0(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(ta(),r===i){e=Kr(t,e,n);break e}on(t,e,r,n)}e=e.child}return e;case 5:return S0(e),t===null&&tm(e),r=e.type,i=e.pendingProps,s=t!==null?t.memoizedProps:null,o=i.children,Yp(r,i)?o=null:s!==null&&Yp(r,s)&&(e.flags|=32),Y0(t,e),on(t,e,o,n),e.child;case 6:return t===null&&tm(e),null;case 13:return J0(t,e,n);case 4:return Ng(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=na(e,null,r,n):on(t,e,r,n),e.child;case 11:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Zn(r,i),lw(t,e,r,i,n);case 7:return on(t,e,e.pendingProps,n),e.child;case 8:return on(t,e,e.pendingProps.children,n),e.child;case 12:return on(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,i=e.pendingProps,s=e.memoizedProps,o=i.value,Ye(gd,r._currentValue),r._currentValue=o,s!==null)if(lr(s.value,o)){if(s.children===i.children&&!vn.current){e=Kr(t,e,n);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var a=s.dependencies;if(a!==null){o=s.child;for(var l=a.firstContext;l!==null;){if(l.context===r){if(s.tag===1){l=$r(-1,n&-n),l.tag=2;var d=s.updateQueue;if(d!==null){d=d.shared;var h=d.pending;h===null?l.next=l:(l.next=h.next,h.next=l),d.pending=l}}s.lanes|=n,l=s.alternate,l!==null&&(l.lanes|=n),nm(s.return,n,e),a.lanes|=n;break}l=l.next}}else if(s.tag===10)o=s.type===e.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(H(341));o.lanes|=n,a=o.alternate,a!==null&&(a.lanes|=n),nm(o,n,e),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===e){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}on(t,e,i.children,n),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,zo(e,n),i=Wn(i),r=r(i),e.flags|=1,on(t,e,r,n),e.child;case 14:return r=e.type,i=Zn(r,e.pendingProps),i=Zn(r.type,i),cw(t,e,r,i,n);case 15:return G0(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Zn(r,i),Vu(t,e),e.tag=1,wn(r)?(t=!0,fd(e)):t=!1,zo(e,n),H0(e,r,i),im(e,r,i,n),am(null,e,r,!0,t,n);case 19:return Z0(t,e,n);case 22:return Q0(t,e,n)}throw Error(H(156,e.tag))};function mx(t,e){return $T(t,e)}function vP(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function $n(t,e,n,r){return new vP(t,e,n,r)}function Kg(t){return t=t.prototype,!(!t||!t.isReactComponent)}function wP(t){if(typeof t=="function")return Kg(t)?1:0;if(t!=null){if(t=t.$$typeof,t===hg)return 11;if(t===fg)return 14}return 2}function Oi(t,e){var n=t.alternate;return n===null?(n=$n(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Mu(t,e,n,r,i,s){var o=2;if(r=t,typeof t=="function")Kg(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case Ao:return Cs(n.children,i,s,e);case dg:o=8,i|=8;break;case Cp:return t=$n(12,n,e,i|2),t.elementType=Cp,t.lanes=s,t;case Rp:return t=$n(13,n,e,i),t.elementType=Rp,t.lanes=s,t;case Pp:return t=$n(19,n,e,i),t.elementType=Pp,t.lanes=s,t;case ST:return gh(n,i,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case TT:o=10;break e;case xT:o=9;break e;case hg:o=11;break e;case fg:o=14;break e;case mi:o=16,r=null;break e}throw Error(H(130,t==null?t:typeof t,""))}return e=$n(o,n,e,i),e.elementType=t,e.type=r,e.lanes=s,e}function Cs(t,e,n,r){return t=$n(7,t,r,e),t.lanes=n,t}function gh(t,e,n,r){return t=$n(22,t,r,e),t.elementType=ST,t.lanes=n,t.stateNode={isHidden:!1},t}function Yf(t,e,n){return t=$n(6,t,null,e),t.lanes=n,t}function Xf(t,e,n){return e=$n(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function EP(t,e,n,r,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=kf(0),this.expirationTimes=kf(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=kf(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function Gg(t,e,n,r,i,s,o,a,l){return t=new EP(t,e,n,a,l),e===1?(e=1,s===!0&&(e|=8)):e=0,s=$n(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},kg(s),t}function IP(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:bo,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function gx(t){if(!t)return qi;t=t._reactInternals;e:{if(to(t)!==t||t.tag!==1)throw Error(H(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(wn(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(H(171))}if(t.tag===1){var n=t.type;if(wn(n))return g0(t,n,e)}return e}function yx(t,e,n,r,i,s,o,a,l){return t=Gg(n,r,!0,t,i,s,o,a,l),t.context=gx(null),n=t.current,r=cn(),i=Vi(n),s=$r(r,i),s.callback=e??null,Di(n,s,i),t.current.lanes=i,yc(t,i,r),En(t,r),t}function yh(t,e,n,r){var i=e.current,s=cn(),o=Vi(i);return n=gx(n),e.context===null?e.context=n:e.pendingContext=n,e=$r(s,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=Di(i,e,o),t!==null&&(or(t,i,o,s),Nu(t,i,o)),o}function bd(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function Ew(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function Qg(t,e){Ew(t,e),(t=t.alternate)&&Ew(t,e)}function TP(){return null}var _x=typeof reportError=="function"?reportError:function(t){console.error(t)};function Yg(t){this._internalRoot=t}_h.prototype.render=Yg.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(H(409));yh(t,e,null,null)};_h.prototype.unmount=Yg.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Fs(function(){yh(null,t,null,null)}),e[Hr]=null}};function _h(t){this._internalRoot=t}_h.prototype.unstable_scheduleHydration=function(t){if(t){var e=QT();t={blockedOn:null,target:t,priority:e};for(var n=0;n<yi.length&&e!==0&&e<yi[n].priority;n++);yi.splice(n,0,t),n===0&&XT(t)}};function Xg(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function vh(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function Iw(){}function xP(t,e,n,r,i){if(i){if(typeof r=="function"){var s=r;r=function(){var d=bd(o);s.call(d)}}var o=yx(e,r,t,0,null,!1,!1,"",Iw);return t._reactRootContainer=o,t[Hr]=o.current,Wl(t.nodeType===8?t.parentNode:t),Fs(),o}for(;i=t.lastChild;)t.removeChild(i);if(typeof r=="function"){var a=r;r=function(){var d=bd(l);a.call(d)}}var l=Gg(t,0,!1,null,null,!1,!1,"",Iw);return t._reactRootContainer=l,t[Hr]=l.current,Wl(t.nodeType===8?t.parentNode:t),Fs(function(){yh(e,l,n,r)}),l}function wh(t,e,n,r,i){var s=n._reactRootContainer;if(s){var o=s;if(typeof i=="function"){var a=i;i=function(){var l=bd(o);a.call(l)}}yh(e,o,t,i)}else o=xP(n,e,t,i,r);return bd(o)}KT=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=ll(e.pendingLanes);n!==0&&(gg(e,n|1),En(e,vt()),!(Le&6)&&(sa=vt()+500,Ji()))}break;case 13:Fs(function(){var r=Wr(t,1);if(r!==null){var i=cn();or(r,t,1,i)}}),Qg(t,1)}};yg=function(t){if(t.tag===13){var e=Wr(t,134217728);if(e!==null){var n=cn();or(e,t,134217728,n)}Qg(t,134217728)}};GT=function(t){if(t.tag===13){var e=Vi(t),n=Wr(t,e);if(n!==null){var r=cn();or(n,t,e,r)}Qg(t,e)}};QT=function(){return We};YT=function(t,e){var n=We;try{return We=t,e()}finally{We=n}};Up=function(t,e,n){switch(e){case"input":if(Dp(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var i=uh(r);if(!i)throw Error(H(90));AT(r),Dp(r,i)}}}break;case"textarea":RT(t,n);break;case"select":e=n.value,e!=null&&Fo(t,!!n.multiple,e,!1)}};OT=qg;LT=Fs;var SP={usingClientEntryPoint:!1,Events:[vc,ko,uh,jT,VT,qg]},Xa={findFiberByHostInstance:Is,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},bP={bundleType:Xa.bundleType,version:Xa.version,rendererPackageName:Xa.rendererPackageName,rendererConfig:Xa.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ei.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=UT(t),t===null?null:t.stateNode},findFiberByHostInstance:Xa.findFiberByHostInstance||TP,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var fu=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!fu.isDisabled&&fu.supportsFiber)try{oh=fu.inject(bP),br=fu}catch{}}jn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=SP;jn.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Xg(e))throw Error(H(200));return IP(t,e,null,n)};jn.createRoot=function(t,e){if(!Xg(t))throw Error(H(299));var n=!1,r="",i=_x;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=Gg(t,1,!1,null,null,n,!1,r,i),t[Hr]=e.current,Wl(t.nodeType===8?t.parentNode:t),new Yg(e)};jn.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(H(188)):(t=Object.keys(t).join(","),Error(H(268,t)));return t=UT(e),t=t===null?null:t.stateNode,t};jn.flushSync=function(t){return Fs(t)};jn.hydrate=function(t,e,n){if(!vh(e))throw Error(H(200));return wh(null,t,e,!0,n)};jn.hydrateRoot=function(t,e,n){if(!Xg(t))throw Error(H(405));var r=n!=null&&n.hydratedSources||null,i=!1,s="",o=_x;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(s=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=yx(e,null,t,1,n??null,i,!1,s,o),t[Hr]=e.current,Wl(t),r)for(t=0;t<r.length;t++)n=r[t],i=n._getVersion,i=i(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,i]:e.mutableSourceEagerHydrationData.push(n,i);return new _h(e)};jn.render=function(t,e,n){if(!vh(e))throw Error(H(200));return wh(null,t,e,!1,n)};jn.unmountComponentAtNode=function(t){if(!vh(t))throw Error(H(40));return t._reactRootContainer?(Fs(function(){wh(null,null,t,!1,function(){t._reactRootContainer=null,t[Hr]=null})}),!0):!1};jn.unstable_batchedUpdates=qg;jn.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!vh(n))throw Error(H(200));if(t==null||t._reactInternals===void 0)throw Error(H(38));return wh(t,e,n,!1,r)};jn.version="18.3.1-next-f1338f8080-20240426";function vx(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(vx)}catch(t){console.error(t)}}vx(),vT.exports=jn;var AP=vT.exports,wx,Tw=AP;wx=Tw.createRoot,Tw.hydrateRoot;/**
 * react-router v7.9.6
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var xw="popstate";function CP(t={}){function e(r,i){let{pathname:s,search:o,hash:a}=r.location;return vm("",{pathname:s,search:o,hash:a},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function n(r,i){return typeof i=="string"?i:tc(i)}return PP(e,n,null,t)}function it(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function Gn(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function RP(){return Math.random().toString(36).substring(2,10)}function Sw(t,e){return{usr:t.state,key:t.key,idx:e}}function vm(t,e,n=null,r){return{pathname:typeof t=="string"?t:t.pathname,search:"",hash:"",...typeof e=="string"?Ta(e):e,state:n,key:e&&e.key||r||RP()}}function tc({pathname:t="/",search:e="",hash:n=""}){return e&&e!=="?"&&(t+=e.charAt(0)==="?"?e:"?"+e),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function Ta(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substring(n),t=t.substring(0,n));let r=t.indexOf("?");r>=0&&(e.search=t.substring(r),t=t.substring(0,r)),t&&(e.pathname=t)}return e}function PP(t,e,n,r={}){let{window:i=document.defaultView,v5Compat:s=!1}=r,o=i.history,a="POP",l=null,d=h();d==null&&(d=0,o.replaceState({...o.state,idx:d},""));function h(){return(o.state||{idx:null}).idx}function f(){a="POP";let N=h(),I=N==null?null:N-d;d=N,l&&l({action:a,location:y.location,delta:I})}function m(N,I){a="PUSH";let _=vm(y.location,N,I);d=h()+1;let T=Sw(_,d),R=y.createHref(_);try{o.pushState(T,"",R)}catch(O){if(O instanceof DOMException&&O.name==="DataCloneError")throw O;i.location.assign(R)}s&&l&&l({action:a,location:y.location,delta:1})}function v(N,I){a="REPLACE";let _=vm(y.location,N,I);d=h();let T=Sw(_,d),R=y.createHref(_);o.replaceState(T,"",R),s&&l&&l({action:a,location:y.location,delta:0})}function C(N){return kP(N)}let y={get action(){return a},get location(){return t(i,o)},listen(N){if(l)throw new Error("A history only accepts one active listener");return i.addEventListener(xw,f),l=N,()=>{i.removeEventListener(xw,f),l=null}},createHref(N){return e(i,N)},createURL:C,encodeLocation(N){let I=C(N);return{pathname:I.pathname,search:I.search,hash:I.hash}},push:m,replace:v,go(N){return o.go(N)}};return y}function kP(t,e=!1){let n="http://localhost";typeof window<"u"&&(n=window.location.origin!=="null"?window.location.origin:window.location.href),it(n,"No window.location.(origin|href) available to create URL");let r=typeof t=="string"?t:tc(t);return r=r.replace(/ $/,"%20"),!e&&r.startsWith("//")&&(r=n+r),new URL(r,n)}function Ex(t,e,n="/"){return NP(t,e,n,!1)}function NP(t,e,n,r){let i=typeof e=="string"?Ta(e):e,s=Gr(i.pathname||"/",n);if(s==null)return null;let o=Ix(t);DP(o);let a=null;for(let l=0;a==null&&l<o.length;++l){let d=qP(s);a=$P(o[l],d,r)}return a}function Ix(t,e=[],n=[],r="",i=!1){let s=(o,a,l=i,d)=>{let h={relativePath:d===void 0?o.path||"":d,caseSensitive:o.caseSensitive===!0,childrenIndex:a,route:o};if(h.relativePath.startsWith("/")){if(!h.relativePath.startsWith(r)&&l)return;it(h.relativePath.startsWith(r),`Absolute route path "${h.relativePath}" nested under path "${r}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),h.relativePath=h.relativePath.slice(r.length)}let f=zr([r,h.relativePath]),m=n.concat(h);o.children&&o.children.length>0&&(it(o.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${f}".`),Ix(o.children,e,m,f,l)),!(o.path==null&&!o.index)&&e.push({path:f,score:UP(f,o.index),routesMeta:m})};return t.forEach((o,a)=>{var l;if(o.path===""||!((l=o.path)!=null&&l.includes("?")))s(o,a);else for(let d of Tx(o.path))s(o,a,!0,d)}),e}function Tx(t){let e=t.split("/");if(e.length===0)return[];let[n,...r]=e,i=n.endsWith("?"),s=n.replace(/\?$/,"");if(r.length===0)return i?[s,""]:[s];let o=Tx(r.join("/")),a=[];return a.push(...o.map(l=>l===""?s:[s,l].join("/"))),i&&a.push(...o),a.map(l=>t.startsWith("/")&&l===""?"/":l)}function DP(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:BP(e.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}var jP=/^:[\w-]+$/,VP=3,OP=2,LP=1,MP=10,FP=-2,bw=t=>t==="*";function UP(t,e){let n=t.split("/"),r=n.length;return n.some(bw)&&(r+=FP),e&&(r+=OP),n.filter(i=>!bw(i)).reduce((i,s)=>i+(jP.test(s)?VP:s===""?LP:MP),r)}function BP(t,e){return t.length===e.length&&t.slice(0,-1).every((r,i)=>r===e[i])?t[t.length-1]-e[e.length-1]:0}function $P(t,e,n=!1){let{routesMeta:r}=t,i={},s="/",o=[];for(let a=0;a<r.length;++a){let l=r[a],d=a===r.length-1,h=s==="/"?e:e.slice(s.length)||"/",f=Ad({path:l.relativePath,caseSensitive:l.caseSensitive,end:d},h),m=l.route;if(!f&&d&&n&&!r[r.length-1].route.index&&(f=Ad({path:l.relativePath,caseSensitive:l.caseSensitive,end:!1},h)),!f)return null;Object.assign(i,f.params),o.push({params:i,pathname:zr([s,f.pathname]),pathnameBase:QP(zr([s,f.pathnameBase])),route:m}),f.pathnameBase!=="/"&&(s=zr([s,f.pathnameBase]))}return o}function Ad(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,r]=zP(t.path,t.caseSensitive,t.end),i=e.match(n);if(!i)return null;let s=i[0],o=s.replace(/(.)\/+$/,"$1"),a=i.slice(1);return{params:r.reduce((d,{paramName:h,isOptional:f},m)=>{if(h==="*"){let C=a[m]||"";o=s.slice(0,s.length-C.length).replace(/(.)\/+$/,"$1")}const v=a[m];return f&&!v?d[h]=void 0:d[h]=(v||"").replace(/%2F/g,"/"),d},{}),pathname:s,pathnameBase:o,pattern:t}}function zP(t,e=!1,n=!0){Gn(t==="*"||!t.endsWith("*")||t.endsWith("/*"),`Route path "${t}" will be treated as if it were "${t.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${t.replace(/\*$/,"/*")}".`);let r=[],i="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,a,l)=>(r.push({paramName:a,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return t.endsWith("*")?(r.push({paramName:"*"}),i+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?i+="\\/*$":t!==""&&t!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,e?void 0:"i"),r]}function qP(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Gn(!1,`The URL path "${t}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),t}}function Gr(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,r=t.charAt(n);return r&&r!=="/"?null:t.slice(n)||"/"}var HP=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,WP=t=>HP.test(t);function KP(t,e="/"){let{pathname:n,search:r="",hash:i=""}=typeof t=="string"?Ta(t):t,s;if(n)if(WP(n))s=n;else{if(n.includes("//")){let o=n;n=n.replace(/\/\/+/g,"/"),Gn(!1,`Pathnames cannot have embedded double slashes - normalizing ${o} -> ${n}`)}n.startsWith("/")?s=Aw(n.substring(1),"/"):s=Aw(n,e)}else s=e;return{pathname:s,search:YP(r),hash:XP(i)}}function Aw(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(i=>{i===".."?n.length>1&&n.pop():i!=="."&&n.push(i)}),n.length>1?n.join("/"):"/"}function Jf(t,e,n,r){return`Cannot include a '${t}' character in a manually specified \`to.${e}\` field [${JSON.stringify(r)}].  Please separate it out to the \`to.${n}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function GP(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function Jg(t){let e=GP(t);return e.map((n,r)=>r===e.length-1?n.pathname:n.pathnameBase)}function Zg(t,e,n,r=!1){let i;typeof t=="string"?i=Ta(t):(i={...t},it(!i.pathname||!i.pathname.includes("?"),Jf("?","pathname","search",i)),it(!i.pathname||!i.pathname.includes("#"),Jf("#","pathname","hash",i)),it(!i.search||!i.search.includes("#"),Jf("#","search","hash",i)));let s=t===""||i.pathname==="",o=s?"/":i.pathname,a;if(o==null)a=n;else{let f=e.length-1;if(!r&&o.startsWith("..")){let m=o.split("/");for(;m[0]==="..";)m.shift(),f-=1;i.pathname=m.join("/")}a=f>=0?e[f]:"/"}let l=KP(i,a),d=o&&o!=="/"&&o.endsWith("/"),h=(s||o===".")&&n.endsWith("/");return!l.pathname.endsWith("/")&&(d||h)&&(l.pathname+="/"),l}var zr=t=>t.join("/").replace(/\/\/+/g,"/"),QP=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),YP=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,XP=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function JP(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var xx=["POST","PUT","PATCH","DELETE"];new Set(xx);var ZP=["GET",...xx];new Set(ZP);var xa=P.createContext(null);xa.displayName="DataRouter";var Eh=P.createContext(null);Eh.displayName="DataRouterState";P.createContext(!1);var Sx=P.createContext({isTransitioning:!1});Sx.displayName="ViewTransition";var ek=P.createContext(new Map);ek.displayName="Fetchers";var tk=P.createContext(null);tk.displayName="Await";var hr=P.createContext(null);hr.displayName="Navigation";var Ec=P.createContext(null);Ec.displayName="Location";var Dr=P.createContext({outlet:null,matches:[],isDataRoute:!1});Dr.displayName="Route";var ey=P.createContext(null);ey.displayName="RouteError";function nk(t,{relative:e}={}){it(Sa(),"useHref() may be used only in the context of a <Router> component.");let{basename:n,navigator:r}=P.useContext(hr),{hash:i,pathname:s,search:o}=Ic(t,{relative:e}),a=s;return n!=="/"&&(a=s==="/"?n:zr([n,s])),r.createHref({pathname:a,search:o,hash:i})}function Sa(){return P.useContext(Ec)!=null}function Zi(){return it(Sa(),"useLocation() may be used only in the context of a <Router> component."),P.useContext(Ec).location}var bx="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function Ax(t){P.useContext(hr).static||P.useLayoutEffect(t)}function Ih(){let{isDataRoute:t}=P.useContext(Dr);return t?mk():rk()}function rk(){it(Sa(),"useNavigate() may be used only in the context of a <Router> component.");let t=P.useContext(xa),{basename:e,navigator:n}=P.useContext(hr),{matches:r}=P.useContext(Dr),{pathname:i}=Zi(),s=JSON.stringify(Jg(r)),o=P.useRef(!1);return Ax(()=>{o.current=!0}),P.useCallback((l,d={})=>{if(Gn(o.current,bx),!o.current)return;if(typeof l=="number"){n.go(l);return}let h=Zg(l,JSON.parse(s),i,d.relative==="path");t==null&&e!=="/"&&(h.pathname=h.pathname==="/"?e:zr([e,h.pathname])),(d.replace?n.replace:n.push)(h,d.state,d)},[e,n,s,i,t])}P.createContext(null);function Ic(t,{relative:e}={}){let{matches:n}=P.useContext(Dr),{pathname:r}=Zi(),i=JSON.stringify(Jg(n));return P.useMemo(()=>Zg(t,JSON.parse(i),r,e==="path"),[t,i,r,e])}function ik(t,e){return Cx(t,e)}function Cx(t,e,n,r,i){var _;it(Sa(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:s}=P.useContext(hr),{matches:o}=P.useContext(Dr),a=o[o.length-1],l=a?a.params:{},d=a?a.pathname:"/",h=a?a.pathnameBase:"/",f=a&&a.route;{let T=f&&f.path||"";Rx(d,!f||T.endsWith("*")||T.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${d}" (under <Route path="${T}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${T}"> to <Route path="${T==="/"?"*":`${T}/*`}">.`)}let m=Zi(),v;if(e){let T=typeof e=="string"?Ta(e):e;it(h==="/"||((_=T.pathname)==null?void 0:_.startsWith(h)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${h}" but pathname "${T.pathname}" was given in the \`location\` prop.`),v=T}else v=m;let C=v.pathname||"/",y=C;if(h!=="/"){let T=h.replace(/^\//,"").split("/");y="/"+C.replace(/^\//,"").split("/").slice(T.length).join("/")}let N=Ex(t,{pathname:y});Gn(f||N!=null,`No routes matched location "${v.pathname}${v.search}${v.hash}" `),Gn(N==null||N[N.length-1].route.element!==void 0||N[N.length-1].route.Component!==void 0||N[N.length-1].route.lazy!==void 0,`Matched leaf route at location "${v.pathname}${v.search}${v.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let I=ck(N&&N.map(T=>Object.assign({},T,{params:Object.assign({},l,T.params),pathname:zr([h,s.encodeLocation?s.encodeLocation(T.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:T.pathname]),pathnameBase:T.pathnameBase==="/"?h:zr([h,s.encodeLocation?s.encodeLocation(T.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:T.pathnameBase])})),o,n,r,i);return e&&I?P.createElement(Ec.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...v},navigationType:"POP"}},I):I}function sk(){let t=pk(),e=JP(t)?`${t.status} ${t.statusText}`:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,r="rgba(200,200,200, 0.5)",i={padding:"0.5rem",backgroundColor:r},s={padding:"2px 4px",backgroundColor:r},o=null;return console.error("Error handled by React Router default ErrorBoundary:",t),o=P.createElement(P.Fragment,null,P.createElement("p",null," Hey developer "),P.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",P.createElement("code",{style:s},"ErrorBoundary")," or"," ",P.createElement("code",{style:s},"errorElement")," prop on your route.")),P.createElement(P.Fragment,null,P.createElement("h2",null,"Unexpected Application Error!"),P.createElement("h3",{style:{fontStyle:"italic"}},e),n?P.createElement("pre",{style:i},n):null,o)}var ok=P.createElement(sk,null),ak=class extends P.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,e){return e.location!==t.location||e.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:e.error,location:e.location,revalidation:t.revalidation||e.revalidation}}componentDidCatch(t,e){this.props.onError?this.props.onError(t,e):console.error("React Router caught the following error during render",t)}render(){return this.state.error!==void 0?P.createElement(Dr.Provider,{value:this.props.routeContext},P.createElement(ey.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function lk({routeContext:t,match:e,children:n}){let r=P.useContext(xa);return r&&r.static&&r.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=e.route.id),P.createElement(Dr.Provider,{value:t},n)}function ck(t,e=[],n=null,r=null,i=null){if(t==null){if(!n)return null;if(n.errors)t=n.matches;else if(e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let s=t,o=n==null?void 0:n.errors;if(o!=null){let h=s.findIndex(f=>f.route.id&&(o==null?void 0:o[f.route.id])!==void 0);it(h>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(o).join(",")}`),s=s.slice(0,Math.min(s.length,h+1))}let a=!1,l=-1;if(n)for(let h=0;h<s.length;h++){let f=s[h];if((f.route.HydrateFallback||f.route.hydrateFallbackElement)&&(l=h),f.route.id){let{loaderData:m,errors:v}=n,C=f.route.loader&&!m.hasOwnProperty(f.route.id)&&(!v||v[f.route.id]===void 0);if(f.route.lazy||C){a=!0,l>=0?s=s.slice(0,l+1):s=[s[0]];break}}}let d=n&&r?(h,f)=>{var m,v;r(h,{location:n.location,params:((v=(m=n.matches)==null?void 0:m[0])==null?void 0:v.params)??{},errorInfo:f})}:void 0;return s.reduceRight((h,f,m)=>{let v,C=!1,y=null,N=null;n&&(v=o&&f.route.id?o[f.route.id]:void 0,y=f.route.errorElement||ok,a&&(l<0&&m===0?(Rx("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),C=!0,N=null):l===m&&(C=!0,N=f.route.hydrateFallbackElement||null)));let I=e.concat(s.slice(0,m+1)),_=()=>{let T;return v?T=y:C?T=N:f.route.Component?T=P.createElement(f.route.Component,null):f.route.element?T=f.route.element:T=h,P.createElement(lk,{match:f,routeContext:{outlet:h,matches:I,isDataRoute:n!=null},children:T})};return n&&(f.route.ErrorBoundary||f.route.errorElement||m===0)?P.createElement(ak,{location:n.location,revalidation:n.revalidation,component:y,error:v,children:_(),routeContext:{outlet:null,matches:I,isDataRoute:!0},onError:d}):_()},null)}function ty(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function uk(t){let e=P.useContext(xa);return it(e,ty(t)),e}function dk(t){let e=P.useContext(Eh);return it(e,ty(t)),e}function hk(t){let e=P.useContext(Dr);return it(e,ty(t)),e}function ny(t){let e=hk(t),n=e.matches[e.matches.length-1];return it(n.route.id,`${t} can only be used on routes that contain a unique "id"`),n.route.id}function fk(){return ny("useRouteId")}function pk(){var r;let t=P.useContext(ey),e=dk("useRouteError"),n=ny("useRouteError");return t!==void 0?t:(r=e.errors)==null?void 0:r[n]}function mk(){let{router:t}=uk("useNavigate"),e=ny("useNavigate"),n=P.useRef(!1);return Ax(()=>{n.current=!0}),P.useCallback(async(i,s={})=>{Gn(n.current,bx),n.current&&(typeof i=="number"?t.navigate(i):await t.navigate(i,{fromRouteId:e,...s}))},[t,e])}var Cw={};function Rx(t,e,n){!e&&!Cw[t]&&(Cw[t]=!0,Gn(!1,n))}P.memo(gk);function gk({routes:t,future:e,state:n,unstable_onError:r}){return Cx(t,void 0,n,r,e)}function wm({to:t,replace:e,state:n,relative:r}){it(Sa(),"<Navigate> may be used only in the context of a <Router> component.");let{static:i}=P.useContext(hr);Gn(!i,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:s}=P.useContext(Dr),{pathname:o}=Zi(),a=Ih(),l=Zg(t,Jg(s),o,r==="path"),d=JSON.stringify(l);return P.useEffect(()=>{a(JSON.parse(d),{replace:e,state:n,relative:r})},[a,d,r,e,n]),null}function Eo(t){it(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function yk({basename:t="/",children:e=null,location:n,navigationType:r="POP",navigator:i,static:s=!1}){it(!Sa(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let o=t.replace(/^\/*/,"/"),a=P.useMemo(()=>({basename:o,navigator:i,static:s,future:{}}),[o,i,s]);typeof n=="string"&&(n=Ta(n));let{pathname:l="/",search:d="",hash:h="",state:f=null,key:m="default"}=n,v=P.useMemo(()=>{let C=Gr(l,o);return C==null?null:{location:{pathname:C,search:d,hash:h,state:f,key:m},navigationType:r}},[o,l,d,h,f,m,r]);return Gn(v!=null,`<Router basename="${o}"> is not able to match the URL "${l}${d}${h}" because it does not start with the basename, so the <Router> won't render anything.`),v==null?null:P.createElement(hr.Provider,{value:a},P.createElement(Ec.Provider,{children:e,value:v}))}function _k({children:t,location:e}){return ik(Em(t),e)}function Em(t,e=[]){let n=[];return P.Children.forEach(t,(r,i)=>{if(!P.isValidElement(r))return;let s=[...e,i];if(r.type===P.Fragment){n.push.apply(n,Em(r.props.children,s));return}it(r.type===Eo,`[${typeof r.type=="string"?r.type:r.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),it(!r.props.index||!r.props.children,"An index route cannot have child routes.");let o={id:r.props.id||s.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,middleware:r.props.middleware,loader:r.props.loader,action:r.props.action,hydrateFallbackElement:r.props.hydrateFallbackElement,HydrateFallback:r.props.HydrateFallback,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.hasErrorBoundary===!0||r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(o.children=Em(r.props.children,s)),n.push(o)}),n}var Fu="get",Uu="application/x-www-form-urlencoded";function Th(t){return t!=null&&typeof t.tagName=="string"}function vk(t){return Th(t)&&t.tagName.toLowerCase()==="button"}function wk(t){return Th(t)&&t.tagName.toLowerCase()==="form"}function Ek(t){return Th(t)&&t.tagName.toLowerCase()==="input"}function Ik(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function Tk(t,e){return t.button===0&&(!e||e==="_self")&&!Ik(t)}var pu=null;function xk(){if(pu===null)try{new FormData(document.createElement("form"),0),pu=!1}catch{pu=!0}return pu}var Sk=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Zf(t){return t!=null&&!Sk.has(t)?(Gn(!1,`"${t}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Uu}"`),null):t}function bk(t,e){let n,r,i,s,o;if(wk(t)){let a=t.getAttribute("action");r=a?Gr(a,e):null,n=t.getAttribute("method")||Fu,i=Zf(t.getAttribute("enctype"))||Uu,s=new FormData(t)}else if(vk(t)||Ek(t)&&(t.type==="submit"||t.type==="image")){let a=t.form;if(a==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let l=t.getAttribute("formaction")||a.getAttribute("action");if(r=l?Gr(l,e):null,n=t.getAttribute("formmethod")||a.getAttribute("method")||Fu,i=Zf(t.getAttribute("formenctype"))||Zf(a.getAttribute("enctype"))||Uu,s=new FormData(a,t),!xk()){let{name:d,type:h,value:f}=t;if(h==="image"){let m=d?`${d}.`:"";s.append(`${m}x`,"0"),s.append(`${m}y`,"0")}else d&&s.append(d,f)}}else{if(Th(t))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');n=Fu,r=null,i=Uu,o=t}return s&&i==="text/plain"&&(o=s,s=void 0),{action:r,method:n.toLowerCase(),encType:i,formData:s,body:o}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function ry(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function Ak(t,e,n){let r=typeof t=="string"?new URL(t,typeof window>"u"?"server://singlefetch/":window.location.origin):t;return r.pathname==="/"?r.pathname=`_root.${n}`:e&&Gr(r.pathname,e)==="/"?r.pathname=`${e.replace(/\/$/,"")}/_root.${n}`:r.pathname=`${r.pathname.replace(/\/$/,"")}.${n}`,r}async function Ck(t,e){if(t.id in e)return e[t.id];try{let n=await import(t.module);return e[t.id]=n,n}catch(n){return console.error(`Error loading route module \`${t.module}\`, reloading page...`),console.error(n),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function Rk(t){return t==null?!1:t.href==null?t.rel==="preload"&&typeof t.imageSrcSet=="string"&&typeof t.imageSizes=="string":typeof t.rel=="string"&&typeof t.href=="string"}async function Pk(t,e,n){let r=await Promise.all(t.map(async i=>{let s=e.routes[i.route.id];if(s){let o=await Ck(s,n);return o.links?o.links():[]}return[]}));return jk(r.flat(1).filter(Rk).filter(i=>i.rel==="stylesheet"||i.rel==="preload").map(i=>i.rel==="stylesheet"?{...i,rel:"prefetch",as:"style"}:{...i,rel:"prefetch"}))}function Rw(t,e,n,r,i,s){let o=(l,d)=>n[d]?l.route.id!==n[d].route.id:!0,a=(l,d)=>{var h;return n[d].pathname!==l.pathname||((h=n[d].route.path)==null?void 0:h.endsWith("*"))&&n[d].params["*"]!==l.params["*"]};return s==="assets"?e.filter((l,d)=>o(l,d)||a(l,d)):s==="data"?e.filter((l,d)=>{var f;let h=r.routes[l.route.id];if(!h||!h.hasLoader)return!1;if(o(l,d)||a(l,d))return!0;if(l.route.shouldRevalidate){let m=l.route.shouldRevalidate({currentUrl:new URL(i.pathname+i.search+i.hash,window.origin),currentParams:((f=n[0])==null?void 0:f.params)||{},nextUrl:new URL(t,window.origin),nextParams:l.params,defaultShouldRevalidate:!0});if(typeof m=="boolean")return m}return!0}):[]}function kk(t,e,{includeHydrateFallback:n}={}){return Nk(t.map(r=>{let i=e.routes[r.route.id];if(!i)return[];let s=[i.module];return i.clientActionModule&&(s=s.concat(i.clientActionModule)),i.clientLoaderModule&&(s=s.concat(i.clientLoaderModule)),n&&i.hydrateFallbackModule&&(s=s.concat(i.hydrateFallbackModule)),i.imports&&(s=s.concat(i.imports)),s}).flat(1))}function Nk(t){return[...new Set(t)]}function Dk(t){let e={},n=Object.keys(t).sort();for(let r of n)e[r]=t[r];return e}function jk(t,e){let n=new Set;return new Set(e),t.reduce((r,i)=>{let s=JSON.stringify(Dk(i));return n.has(s)||(n.add(s),r.push({key:s,link:i})),r},[])}function Px(){let t=P.useContext(xa);return ry(t,"You must render this element inside a <DataRouterContext.Provider> element"),t}function Vk(){let t=P.useContext(Eh);return ry(t,"You must render this element inside a <DataRouterStateContext.Provider> element"),t}var iy=P.createContext(void 0);iy.displayName="FrameworkContext";function kx(){let t=P.useContext(iy);return ry(t,"You must render this element inside a <HydratedRouter> element"),t}function Ok(t,e){let n=P.useContext(iy),[r,i]=P.useState(!1),[s,o]=P.useState(!1),{onFocus:a,onBlur:l,onMouseEnter:d,onMouseLeave:h,onTouchStart:f}=e,m=P.useRef(null);P.useEffect(()=>{if(t==="render"&&o(!0),t==="viewport"){let y=I=>{I.forEach(_=>{o(_.isIntersecting)})},N=new IntersectionObserver(y,{threshold:.5});return m.current&&N.observe(m.current),()=>{N.disconnect()}}},[t]),P.useEffect(()=>{if(r){let y=setTimeout(()=>{o(!0)},100);return()=>{clearTimeout(y)}}},[r]);let v=()=>{i(!0)},C=()=>{i(!1),o(!1)};return n?t!=="intent"?[s,m,{}]:[s,m,{onFocus:Ja(a,v),onBlur:Ja(l,C),onMouseEnter:Ja(d,v),onMouseLeave:Ja(h,C),onTouchStart:Ja(f,v)}]:[!1,m,{}]}function Ja(t,e){return n=>{t&&t(n),n.defaultPrevented||e(n)}}function Lk({page:t,...e}){let{router:n}=Px(),r=P.useMemo(()=>Ex(n.routes,t,n.basename),[n.routes,t,n.basename]);return r?P.createElement(Fk,{page:t,matches:r,...e}):null}function Mk(t){let{manifest:e,routeModules:n}=kx(),[r,i]=P.useState([]);return P.useEffect(()=>{let s=!1;return Pk(t,e,n).then(o=>{s||i(o)}),()=>{s=!0}},[t,e,n]),r}function Fk({page:t,matches:e,...n}){let r=Zi(),{manifest:i,routeModules:s}=kx(),{basename:o}=Px(),{loaderData:a,matches:l}=Vk(),d=P.useMemo(()=>Rw(t,e,l,i,r,"data"),[t,e,l,i,r]),h=P.useMemo(()=>Rw(t,e,l,i,r,"assets"),[t,e,l,i,r]),f=P.useMemo(()=>{if(t===r.pathname+r.search+r.hash)return[];let C=new Set,y=!1;if(e.forEach(I=>{var T;let _=i.routes[I.route.id];!_||!_.hasLoader||(!d.some(R=>R.route.id===I.route.id)&&I.route.id in a&&((T=s[I.route.id])!=null&&T.shouldRevalidate)||_.hasClientLoader?y=!0:C.add(I.route.id))}),C.size===0)return[];let N=Ak(t,o,"data");return y&&C.size>0&&N.searchParams.set("_routes",e.filter(I=>C.has(I.route.id)).map(I=>I.route.id).join(",")),[N.pathname+N.search]},[o,a,r,i,d,e,t,s]),m=P.useMemo(()=>kk(h,i),[h,i]),v=Mk(h);return P.createElement(P.Fragment,null,f.map(C=>P.createElement("link",{key:C,rel:"prefetch",as:"fetch",href:C,...n})),m.map(C=>P.createElement("link",{key:C,rel:"modulepreload",href:C,...n})),v.map(({key:C,link:y})=>P.createElement("link",{key:C,nonce:n.nonce,...y})))}function Uk(...t){return e=>{t.forEach(n=>{typeof n=="function"?n(e):n!=null&&(n.current=e)})}}var Nx=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{Nx&&(window.__reactRouterVersion="7.9.6")}catch{}function Bk({basename:t,children:e,window:n}){let r=P.useRef();r.current==null&&(r.current=CP({window:n,v5Compat:!0}));let i=r.current,[s,o]=P.useState({action:i.action,location:i.location}),a=P.useCallback(l=>{P.startTransition(()=>o(l))},[o]);return P.useLayoutEffect(()=>i.listen(a),[i,a]),P.createElement(yk,{basename:t,children:e,location:s.location,navigationType:s.action,navigator:i})}var Dx=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,jx=P.forwardRef(function({onClick:e,discover:n="render",prefetch:r="none",relative:i,reloadDocument:s,replace:o,state:a,target:l,to:d,preventScrollReset:h,viewTransition:f,...m},v){let{basename:C}=P.useContext(hr),y=typeof d=="string"&&Dx.test(d),N,I=!1;if(typeof d=="string"&&y&&(N=d,Nx))try{let A=new URL(window.location.href),k=d.startsWith("//")?new URL(A.protocol+d):new URL(d),D=Gr(k.pathname,C);k.origin===A.origin&&D!=null?d=D+k.search+k.hash:I=!0}catch{Gn(!1,`<Link to="${d}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let _=nk(d,{relative:i}),[T,R,O]=Ok(r,m),$=Hk(d,{replace:o,state:a,target:l,preventScrollReset:h,relative:i,viewTransition:f});function x(A){e&&e(A),A.defaultPrevented||$(A)}let w=P.createElement("a",{...m,...O,href:N||_,onClick:I||s?e:x,ref:Uk(v,R),target:l,"data-discover":!y&&n==="render"?"true":void 0});return T&&!y?P.createElement(P.Fragment,null,w,P.createElement(Lk,{page:_})):w});jx.displayName="Link";var $k=P.forwardRef(function({"aria-current":e="page",caseSensitive:n=!1,className:r="",end:i=!1,style:s,to:o,viewTransition:a,children:l,...d},h){let f=Ic(o,{relative:d.relative}),m=Zi(),v=P.useContext(Eh),{navigator:C,basename:y}=P.useContext(hr),N=v!=null&&Yk(f)&&a===!0,I=C.encodeLocation?C.encodeLocation(f).pathname:f.pathname,_=m.pathname,T=v&&v.navigation&&v.navigation.location?v.navigation.location.pathname:null;n||(_=_.toLowerCase(),T=T?T.toLowerCase():null,I=I.toLowerCase()),T&&y&&(T=Gr(T,y)||T);const R=I!=="/"&&I.endsWith("/")?I.length-1:I.length;let O=_===I||!i&&_.startsWith(I)&&_.charAt(R)==="/",$=T!=null&&(T===I||!i&&T.startsWith(I)&&T.charAt(I.length)==="/"),x={isActive:O,isPending:$,isTransitioning:N},w=O?e:void 0,A;typeof r=="function"?A=r(x):A=[r,O?"active":null,$?"pending":null,N?"transitioning":null].filter(Boolean).join(" ");let k=typeof s=="function"?s(x):s;return P.createElement(jx,{...d,"aria-current":w,className:A,ref:h,style:k,to:o,viewTransition:a},typeof l=="function"?l(x):l)});$k.displayName="NavLink";var zk=P.forwardRef(({discover:t="render",fetcherKey:e,navigate:n,reloadDocument:r,replace:i,state:s,method:o=Fu,action:a,onSubmit:l,relative:d,preventScrollReset:h,viewTransition:f,...m},v)=>{let C=Gk(),y=Qk(a,{relative:d}),N=o.toLowerCase()==="get"?"get":"post",I=typeof a=="string"&&Dx.test(a),_=T=>{if(l&&l(T),T.defaultPrevented)return;T.preventDefault();let R=T.nativeEvent.submitter,O=(R==null?void 0:R.getAttribute("formmethod"))||o;C(R||T.currentTarget,{fetcherKey:e,method:O,navigate:n,replace:i,state:s,relative:d,preventScrollReset:h,viewTransition:f})};return P.createElement("form",{ref:v,method:N,action:y,onSubmit:r?l:_,...m,"data-discover":!I&&t==="render"?"true":void 0})});zk.displayName="Form";function qk(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function Vx(t){let e=P.useContext(xa);return it(e,qk(t)),e}function Hk(t,{target:e,replace:n,state:r,preventScrollReset:i,relative:s,viewTransition:o}={}){let a=Ih(),l=Zi(),d=Ic(t,{relative:s});return P.useCallback(h=>{if(Tk(h,e)){h.preventDefault();let f=n!==void 0?n:tc(l)===tc(d);a(t,{replace:f,state:r,preventScrollReset:i,relative:s,viewTransition:o})}},[l,a,d,n,r,e,t,i,s,o])}var Wk=0,Kk=()=>`__${String(++Wk)}__`;function Gk(){let{router:t}=Vx("useSubmit"),{basename:e}=P.useContext(hr),n=fk();return P.useCallback(async(r,i={})=>{let{action:s,method:o,encType:a,formData:l,body:d}=bk(r,e);if(i.navigate===!1){let h=i.fetcherKey||Kk();await t.fetch(h,n,i.action||s,{preventScrollReset:i.preventScrollReset,formData:l,body:d,formMethod:i.method||o,formEncType:i.encType||a,flushSync:i.flushSync})}else await t.navigate(i.action||s,{preventScrollReset:i.preventScrollReset,formData:l,body:d,formMethod:i.method||o,formEncType:i.encType||a,replace:i.replace,state:i.state,fromRouteId:n,flushSync:i.flushSync,viewTransition:i.viewTransition})},[t,e,n])}function Qk(t,{relative:e}={}){let{basename:n}=P.useContext(hr),r=P.useContext(Dr);it(r,"useFormAction must be used inside a RouteContext");let[i]=r.matches.slice(-1),s={...Ic(t||".",{relative:e})},o=Zi();if(t==null){s.search=o.search;let a=new URLSearchParams(s.search),l=a.getAll("index");if(l.some(h=>h==="")){a.delete("index"),l.filter(f=>f).forEach(f=>a.append("index",f));let h=a.toString();s.search=h?`?${h}`:""}}return(!t||t===".")&&i.route.index&&(s.search=s.search?s.search.replace(/^\?/,"?index&"):"?index"),n!=="/"&&(s.pathname=s.pathname==="/"?n:zr([n,s.pathname])),tc(s)}function Yk(t,{relative:e}={}){let n=P.useContext(Sx);it(n!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:r}=Vx("useViewTransitionState"),i=Ic(t,{relative:e});if(!n.isTransitioning)return!1;let s=Gr(n.currentLocation.pathname,r)||n.currentLocation.pathname,o=Gr(n.nextLocation.pathname,r)||n.nextLocation.pathname;return Ad(i.pathname,o)!=null||Ad(i.pathname,s)!=null}const Xk=()=>{};var Pw={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ox=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let i=t.charCodeAt(r);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=i&63|128):(i&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=i&63|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=i&63|128)}return e},Jk=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const i=t[n++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=t[n++];e[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){const s=t[n++],o=t[n++],a=t[n++],l=((i&7)<<18|(s&63)<<12|(o&63)<<6|a&63)-65536;e[r++]=String.fromCharCode(55296+(l>>10)),e[r++]=String.fromCharCode(56320+(l&1023))}else{const s=t[n++],o=t[n++];e[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|o&63)}}return e.join("")},Lx={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<t.length;i+=3){const s=t[i],o=i+1<t.length,a=o?t[i+1]:0,l=i+2<t.length,d=l?t[i+2]:0,h=s>>2,f=(s&3)<<4|a>>4;let m=(a&15)<<2|d>>6,v=d&63;l||(v=64,o||(m=64)),r.push(n[h],n[f],n[m],n[v])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(Ox(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):Jk(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<t.length;){const s=n[t.charAt(i++)],a=i<t.length?n[t.charAt(i)]:0;++i;const d=i<t.length?n[t.charAt(i)]:64;++i;const f=i<t.length?n[t.charAt(i)]:64;if(++i,s==null||a==null||d==null||f==null)throw new Zk;const m=s<<2|a>>4;if(r.push(m),d!==64){const v=a<<4&240|d>>2;if(r.push(v),f!==64){const C=d<<6&192|f;r.push(C)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class Zk extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const eN=function(t){const e=Ox(t);return Lx.encodeByteArray(e,!0)},Cd=function(t){return eN(t).replace(/\./g,"")},Mx=function(t){try{return Lx.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fx(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tN=()=>Fx().__FIREBASE_DEFAULTS__,nN=()=>{if(typeof process>"u"||typeof Pw>"u")return;const t=Pw.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},rN=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&Mx(t[1]);return e&&JSON.parse(e)},xh=()=>{try{return Xk()||tN()||nN()||rN()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},Ux=t=>{var e,n;return(n=(e=xh())==null?void 0:e.emulatorHosts)==null?void 0:n[t]},Bx=t=>{const e=Ux(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},$x=()=>{var t;return(t=xh())==null?void 0:t.config},zx=t=>{var e;return(e=xh())==null?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iN{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function es(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function sy(t){return(await fetch(t,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qx(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",i=t.iat||0,s=t.sub||t.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o={iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}},...t};return[Cd(JSON.stringify(n)),Cd(JSON.stringify(o)),""].join(".")}const Cl={};function sN(){const t={prod:[],emulator:[]};for(const e of Object.keys(Cl))Cl[e]?t.emulator.push(e):t.prod.push(e);return t}function oN(t){let e=document.getElementById(t),n=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),n=!0),{created:n,element:e}}let kw=!1;function oy(t,e){if(typeof window>"u"||typeof document>"u"||!es(window.location.host)||Cl[t]===e||Cl[t]||kw)return;Cl[t]=e;function n(m){return`__firebase__banner__${m}`}const r="__firebase__banner",s=sN().prod.length>0;function o(){const m=document.getElementById(r);m&&m.remove()}function a(m){m.style.display="flex",m.style.background="#7faaf0",m.style.position="fixed",m.style.bottom="5px",m.style.left="5px",m.style.padding=".5em",m.style.borderRadius="5px",m.style.alignItems="center"}function l(m,v){m.setAttribute("width","24"),m.setAttribute("id",v),m.setAttribute("height","24"),m.setAttribute("viewBox","0 0 24 24"),m.setAttribute("fill","none"),m.style.marginLeft="-6px"}function d(){const m=document.createElement("span");return m.style.cursor="pointer",m.style.marginLeft="16px",m.style.fontSize="24px",m.innerHTML=" &times;",m.onclick=()=>{kw=!0,o()},m}function h(m,v){m.setAttribute("id",v),m.innerText="Learn more",m.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",m.setAttribute("target","__blank"),m.style.paddingLeft="5px",m.style.textDecoration="underline"}function f(){const m=oN(r),v=n("text"),C=document.getElementById(v)||document.createElement("span"),y=n("learnmore"),N=document.getElementById(y)||document.createElement("a"),I=n("preprendIcon"),_=document.getElementById(I)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(m.created){const T=m.element;a(T),h(N,y);const R=d();l(_,I),T.append(_,C,N,R),document.body.appendChild(T)}s?(C.innerText="Preview backend disconnected.",_.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(_.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,C.innerText="Preview backend running in this workspace."),C.setAttribute("id",v)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",f):f()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rt(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function aN(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Rt())}function Hx(){var e;const t=(e=xh())==null?void 0:e.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function lN(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function Wx(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function cN(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function uN(){const t=Rt();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function Kx(){return!Hx()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Gx(){return!Hx()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function ay(){try{return typeof indexedDB=="object"}catch{return!1}}function Qx(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var s;e(((s=i.error)==null?void 0:s.message)||"")}}catch(n){e(n)}})}function dN(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hN="FirebaseError";class Yn extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=hN,Object.setPrototypeOf(this,Yn.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,no.prototype.create)}}class no{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},i=`${this.service}/${e}`,s=this.errors[e],o=s?fN(s,r):"Error",a=`${this.serviceName}: ${o} (${i}).`;return new Yn(i,a,r)}}function fN(t,e){return t.replace(pN,(n,r)=>{const i=e[r];return i!=null?String(i):`<${r}?>`})}const pN=/\{\$([^}]+)}/g;function mN(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Qr(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const i of n){if(!r.includes(i))return!1;const s=t[i],o=e[i];if(Nw(s)&&Nw(o)){if(!Qr(s,o))return!1}else if(s!==o)return!1}for(const i of r)if(!n.includes(i))return!1;return!0}function Nw(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tc(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function ul(t){const e={};return t.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[i,s]=r.split("=");e[decodeURIComponent(i)]=decodeURIComponent(s)}}),e}function dl(t){const e=t.indexOf("?");if(!e)return"";const n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}function gN(t,e){const n=new yN(t,e);return n.subscribe.bind(n)}class yN{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let i;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");_N(e,["next","error","complete"])?i=e:i={next:e,error:n,complete:r},i.next===void 0&&(i.next=ep),i.error===void 0&&(i.error=ep),i.complete===void 0&&(i.complete=ep);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function _N(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function ep(){}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vN=1e3,wN=2,EN=4*60*60*1e3,IN=.5;function Dw(t,e=vN,n=wN){const r=e*Math.pow(n,t),i=Math.round(IN*r*(Math.random()-.5)*2);return Math.min(EN,r+i)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ze(t){return t&&t._delegate?t._delegate:t}class Qn{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ps="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TN{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new iN;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:n});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){const n=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),r=(e==null?void 0:e.optional)??!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(i){if(r)return null;throw i}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(SN(e))try{this.getOrInitializeService({instanceIdentifier:ps})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(n);try{const s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(e=ps){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=ps){return this.instances.has(e)}getOptions(e=ps){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[s,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(s);r===a&&o.resolve(i)}return i}onInit(e,n){const r=this.normalizeInstanceIdentifier(n),i=this.onInitCallbacks.get(r)??new Set;i.add(e),this.onInitCallbacks.set(r,i);const s=this.instances.get(r);return s&&e(s,r),()=>{i.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const i of r)try{i(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:xN(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=ps){return this.component?this.component.multipleInstances?e:ps:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function xN(t){return t===ps?void 0:t}function SN(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bN{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new TN(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var De;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(De||(De={}));const AN={debug:De.DEBUG,verbose:De.VERBOSE,info:De.INFO,warn:De.WARN,error:De.ERROR,silent:De.SILENT},CN=De.INFO,RN={[De.DEBUG]:"log",[De.VERBOSE]:"log",[De.INFO]:"info",[De.WARN]:"warn",[De.ERROR]:"error"},PN=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),i=RN[e];if(i)console[i](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Sh{constructor(e){this.name=e,this._logLevel=CN,this._logHandler=PN,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in De))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?AN[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,De.DEBUG,...e),this._logHandler(this,De.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,De.VERBOSE,...e),this._logHandler(this,De.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,De.INFO,...e),this._logHandler(this,De.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,De.WARN,...e),this._logHandler(this,De.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,De.ERROR,...e),this._logHandler(this,De.ERROR,...e)}}const kN=(t,e)=>e.some(n=>t instanceof n);let jw,Vw;function NN(){return jw||(jw=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function DN(){return Vw||(Vw=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Yx=new WeakMap,Im=new WeakMap,Xx=new WeakMap,tp=new WeakMap,ly=new WeakMap;function jN(t){const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("success",s),t.removeEventListener("error",o)},s=()=>{n(Li(t.result)),i()},o=()=>{r(t.error),i()};t.addEventListener("success",s),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&Yx.set(n,t)}).catch(()=>{}),ly.set(e,t),e}function VN(t){if(Im.has(t))return;const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("complete",s),t.removeEventListener("error",o),t.removeEventListener("abort",o)},s=()=>{n(),i()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",s),t.addEventListener("error",o),t.addEventListener("abort",o)});Im.set(t,e)}let Tm={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return Im.get(t);if(e==="objectStoreNames")return t.objectStoreNames||Xx.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Li(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function ON(t){Tm=t(Tm)}function LN(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(np(this),e,...n);return Xx.set(r,e.sort?e.sort():[e]),Li(r)}:DN().includes(t)?function(...e){return t.apply(np(this),e),Li(Yx.get(this))}:function(...e){return Li(t.apply(np(this),e))}}function MN(t){return typeof t=="function"?LN(t):(t instanceof IDBTransaction&&VN(t),kN(t,NN())?new Proxy(t,Tm):t)}function Li(t){if(t instanceof IDBRequest)return jN(t);if(tp.has(t))return tp.get(t);const e=MN(t);return e!==t&&(tp.set(t,e),ly.set(e,t)),e}const np=t=>ly.get(t);function Jx(t,e,{blocked:n,upgrade:r,blocking:i,terminated:s}={}){const o=indexedDB.open(t,e),a=Li(o);return r&&o.addEventListener("upgradeneeded",l=>{r(Li(o.result),l.oldVersion,l.newVersion,Li(o.transaction),l)}),n&&o.addEventListener("blocked",l=>n(l.oldVersion,l.newVersion,l)),a.then(l=>{s&&l.addEventListener("close",()=>s()),i&&l.addEventListener("versionchange",d=>i(d.oldVersion,d.newVersion,d))}).catch(()=>{}),a}const FN=["get","getKey","getAll","getAllKeys","count"],UN=["put","add","delete","clear"],rp=new Map;function Ow(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(rp.get(e))return rp.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,i=UN.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(i||FN.includes(n)))return;const s=async function(o,...a){const l=this.transaction(o,i?"readwrite":"readonly");let d=l.store;return r&&(d=d.index(a.shift())),(await Promise.all([d[n](...a),i&&l.done]))[0]};return rp.set(e,s),s}ON(t=>({...t,get:(e,n,r)=>Ow(e,n)||t.get(e,n,r),has:(e,n)=>!!Ow(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BN{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if($N(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function $N(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const xm="@firebase/app",Lw="0.14.5";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yr=new Sh("@firebase/app"),zN="@firebase/app-compat",qN="@firebase/analytics-compat",HN="@firebase/analytics",WN="@firebase/app-check-compat",KN="@firebase/app-check",GN="@firebase/auth",QN="@firebase/auth-compat",YN="@firebase/database",XN="@firebase/data-connect",JN="@firebase/database-compat",ZN="@firebase/functions",eD="@firebase/functions-compat",tD="@firebase/installations",nD="@firebase/installations-compat",rD="@firebase/messaging",iD="@firebase/messaging-compat",sD="@firebase/performance",oD="@firebase/performance-compat",aD="@firebase/remote-config",lD="@firebase/remote-config-compat",cD="@firebase/storage",uD="@firebase/storage-compat",dD="@firebase/firestore",hD="@firebase/ai",fD="@firebase/firestore-compat",pD="firebase",mD="12.5.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sm="[DEFAULT]",gD={[xm]:"fire-core",[zN]:"fire-core-compat",[HN]:"fire-analytics",[qN]:"fire-analytics-compat",[KN]:"fire-app-check",[WN]:"fire-app-check-compat",[GN]:"fire-auth",[QN]:"fire-auth-compat",[YN]:"fire-rtdb",[XN]:"fire-data-connect",[JN]:"fire-rtdb-compat",[ZN]:"fire-fn",[eD]:"fire-fn-compat",[tD]:"fire-iid",[nD]:"fire-iid-compat",[rD]:"fire-fcm",[iD]:"fire-fcm-compat",[sD]:"fire-perf",[oD]:"fire-perf-compat",[aD]:"fire-rc",[lD]:"fire-rc-compat",[cD]:"fire-gcs",[uD]:"fire-gcs-compat",[dD]:"fire-fst",[fD]:"fire-fst-compat",[hD]:"fire-vertex","fire-js":"fire-js",[pD]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rd=new Map,yD=new Map,bm=new Map;function Mw(t,e){try{t.container.addComponent(e)}catch(n){Yr.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function cr(t){const e=t.name;if(bm.has(e))return Yr.debug(`There were multiple attempts to register component ${e}.`),!1;bm.set(e,t);for(const n of Rd.values())Mw(n,t);for(const n of yD.values())Mw(n,t);return!0}function ts(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function Un(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _D={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Mi=new no("app","Firebase",_D);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vD{constructor(e,n,r){this._isDeleted=!1,this._options={...e},this._config={...n},this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Qn("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Mi.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ro=mD;function cy(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r={name:Sm,automaticDataCollectionEnabled:!0,...e},i=r.name;if(typeof i!="string"||!i)throw Mi.create("bad-app-name",{appName:String(i)});if(n||(n=$x()),!n)throw Mi.create("no-options");const s=Rd.get(i);if(s){if(Qr(n,s.options)&&Qr(r,s.config))return s;throw Mi.create("duplicate-app",{appName:i})}const o=new bN(i);for(const l of bm.values())o.addComponent(l);const a=new vD(n,r,o);return Rd.set(i,a),a}function bh(t=Sm){const e=Rd.get(t);if(!e&&t===Sm&&$x())return cy();if(!e)throw Mi.create("no-app",{appName:t});return e}function In(t,e,n){let r=gD[t]??t;n&&(r+=`-${n}`);const i=r.match(/\s|\//),s=e.match(/\s|\//);if(i||s){const o=[`Unable to register library "${r}" with version "${e}":`];i&&o.push(`library name "${r}" contains illegal characters (whitespace or "/")`),i&&s&&o.push("and"),s&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Yr.warn(o.join(" "));return}cr(new Qn(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wD="firebase-heartbeat-database",ED=1,nc="firebase-heartbeat-store";let ip=null;function Zx(){return ip||(ip=Jx(wD,ED,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(nc)}catch(n){console.warn(n)}}}}).catch(t=>{throw Mi.create("idb-open",{originalErrorMessage:t.message})})),ip}async function ID(t){try{const n=(await Zx()).transaction(nc),r=await n.objectStore(nc).get(eS(t));return await n.done,r}catch(e){if(e instanceof Yn)Yr.warn(e.message);else{const n=Mi.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Yr.warn(n.message)}}}async function Fw(t,e){try{const r=(await Zx()).transaction(nc,"readwrite");await r.objectStore(nc).put(e,eS(t)),await r.done}catch(n){if(n instanceof Yn)Yr.warn(n.message);else{const r=Mi.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});Yr.warn(r.message)}}}function eS(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TD=1024,xD=30;class SD{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new AD(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=Uw();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)==null?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(o=>o.date===s))return;if(this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats.length>xD){const o=CD(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){Yr.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=Uw(),{heartbeatsToSend:r,unsentEntries:i}=bD(this._heartbeatsCache.heartbeats),s=Cd(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(n){return Yr.warn(n),""}}}function Uw(){return new Date().toISOString().substring(0,10)}function bD(t,e=TD){const n=[];let r=t.slice();for(const i of t){const s=n.find(o=>o.agent===i.agent);if(s){if(s.dates.push(i.date),Bw(n)>e){s.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),Bw(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class AD{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return ay()?Qx().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await ID(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return Fw(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return Fw(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function Bw(t){return Cd(JSON.stringify({version:2,heartbeats:t})).length}function CD(t){if(t.length===0)return-1;let e=0,n=t[0].date;for(let r=1;r<t.length;r++)t[r].date<n&&(n=t[r].date,e=r);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function RD(t){cr(new Qn("platform-logger",e=>new BN(e),"PRIVATE")),cr(new Qn("heartbeat",e=>new SD(e),"PRIVATE")),In(xm,Lw,t),In(xm,Lw,"esm2020"),In("fire-js","")}RD("");var PD="firebase",kD="12.5.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */In(PD,kD,"app");function tS(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const ND=tS,nS=new no("auth","Firebase",tS());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pd=new Sh("@firebase/auth");function DD(t,...e){Pd.logLevel<=De.WARN&&Pd.warn(`Auth (${ro}): ${t}`,...e)}function Bu(t,...e){Pd.logLevel<=De.ERROR&&Pd.error(`Auth (${ro}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ur(t,...e){throw uy(t,...e)}function Cr(t,...e){return uy(t,...e)}function rS(t,e,n){const r={...ND(),[e]:n};return new no("auth","Firebase",r).create(e,{appName:t.name})}function Fi(t){return rS(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function uy(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return nS.create(t,...e)}function ge(t,e,...n){if(!t)throw uy(e,...n)}function Fr(t){const e="INTERNAL ASSERTION FAILED: "+t;throw Bu(e),new Error(e)}function Xr(t,e){t||Fr(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Am(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.href)||""}function jD(){return $w()==="http:"||$w()==="https:"}function $w(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VD(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(jD()||Wx()||"connection"in navigator)?navigator.onLine:!0}function OD(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xc{constructor(e,n){this.shortDelay=e,this.longDelay=n,Xr(n>e,"Short delay should be less than long delay!"),this.isMobile=aN()||cN()}get(){return VD()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dy(t,e){Xr(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iS{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Fr("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Fr("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Fr("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LD={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MD=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],FD=new xc(3e4,6e4);function io(t,e){return t.tenantId&&!e.tenantId?{...e,tenantId:t.tenantId}:e}async function ns(t,e,n,r,i={}){return sS(t,i,async()=>{let s={},o={};r&&(e==="GET"?o=r:s={body:JSON.stringify(r)});const a=Tc({key:t.config.apiKey,...o}).slice(1),l=await t._getAdditionalHeaders();l["Content-Type"]="application/json",t.languageCode&&(l["X-Firebase-Locale"]=t.languageCode);const d={method:e,headers:l,...s};return lN()||(d.referrerPolicy="no-referrer"),t.emulatorConfig&&es(t.emulatorConfig.host)&&(d.credentials="include"),iS.fetch()(await oS(t,t.config.apiHost,n,a),d)})}async function sS(t,e,n){t._canInitEmulator=!1;const r={...LD,...e};try{const i=new BD(t),s=await Promise.race([n(),i.promise]);i.clearNetworkTimeout();const o=await s.json();if("needConfirmation"in o)throw mu(t,"account-exists-with-different-credential",o);if(s.ok&&!("errorMessage"in o))return o;{const a=s.ok?o.errorMessage:o.error.message,[l,d]=a.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw mu(t,"credential-already-in-use",o);if(l==="EMAIL_EXISTS")throw mu(t,"email-already-in-use",o);if(l==="USER_DISABLED")throw mu(t,"user-disabled",o);const h=r[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(d)throw rS(t,h,d);ur(t,h)}}catch(i){if(i instanceof Yn)throw i;ur(t,"network-request-failed",{message:String(i)})}}async function Ah(t,e,n,r,i={}){const s=await ns(t,e,n,r,i);return"mfaPendingCredential"in s&&ur(t,"multi-factor-auth-required",{_serverResponse:s}),s}async function oS(t,e,n,r){const i=`${e}${n}?${r}`,s=t,o=s.config.emulator?dy(t.config,i):`${t.config.apiScheme}://${i}`;return MD.includes(n)&&(await s._persistenceManagerAvailable,s._getPersistenceType()==="COOKIE")?s._getPersistence()._getFinalTarget(o).toString():o}function UD(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class BD{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(Cr(this.auth,"network-request-failed")),FD.get())})}}function mu(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const i=Cr(t,e,r);return i.customData._tokenResponse=n,i}function zw(t){return t!==void 0&&t.enterprise!==void 0}class $D{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const n of this.recaptchaEnforcementState)if(n.provider&&n.provider===e)return UD(n.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function zD(t,e){return ns(t,"GET","/v2/recaptchaConfig",io(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function qD(t,e){return ns(t,"POST","/v1/accounts:delete",e)}async function kd(t,e){return ns(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rl(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function HD(t,e=!1){const n=ze(t),r=await n.getIdToken(e),i=hy(r);ge(i&&i.exp&&i.auth_time&&i.iat,n.auth,"internal-error");const s=typeof i.firebase=="object"?i.firebase:void 0,o=s==null?void 0:s.sign_in_provider;return{claims:i,token:r,authTime:Rl(sp(i.auth_time)),issuedAtTime:Rl(sp(i.iat)),expirationTime:Rl(sp(i.exp)),signInProvider:o||null,signInSecondFactor:(s==null?void 0:s.sign_in_second_factor)||null}}function sp(t){return Number(t)*1e3}function hy(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return Bu("JWT malformed, contained fewer than 3 sections"),null;try{const i=Mx(n);return i?JSON.parse(i):(Bu("Failed to decode base64 JWT payload"),null)}catch(i){return Bu("Caught error parsing JWT payload as JSON",i==null?void 0:i.toString()),null}}function qw(t){const e=hy(t);return ge(e,"internal-error"),ge(typeof e.exp<"u","internal-error"),ge(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function rc(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof Yn&&WD(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function WD({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KD{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const r=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cm{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=Rl(this.lastLoginAt),this.creationTime=Rl(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Nd(t){var f;const e=t.auth,n=await t.getIdToken(),r=await rc(t,kd(e,{idToken:n}));ge(r==null?void 0:r.users.length,e,"internal-error");const i=r.users[0];t._notifyReloadListener(i);const s=(f=i.providerUserInfo)!=null&&f.length?aS(i.providerUserInfo):[],o=QD(t.providerData,s),a=t.isAnonymous,l=!(t.email&&i.passwordHash)&&!(o!=null&&o.length),d=a?l:!1,h={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:o,metadata:new Cm(i.createdAt,i.lastLoginAt),isAnonymous:d};Object.assign(t,h)}async function GD(t){const e=ze(t);await Nd(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function QD(t,e){return[...t.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function aS(t){return t.map(({providerId:e,...n})=>({providerId:e,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function YD(t,e){const n=await sS(t,{},async()=>{const r=Tc({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=t.config,o=await oS(t,i,"/v1/token",`key=${s}`),a=await t._getAdditionalHeaders();a["Content-Type"]="application/x-www-form-urlencoded";const l={method:"POST",headers:a,body:r};return t.emulatorConfig&&es(t.emulatorConfig.host)&&(l.credentials="include"),iS.fetch()(o,l)});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function XD(t,e){return ns(t,"POST","/v2/accounts:revokeToken",io(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ho{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){ge(e.idToken,"internal-error"),ge(typeof e.idToken<"u","internal-error"),ge(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):qw(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){ge(e.length!==0,"internal-error");const n=qw(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(ge(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:i,expiresIn:s}=await YD(e,n);this.updateTokensAndExpiration(r,i,Number(s))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:i,expirationTime:s}=n,o=new Ho;return r&&(ge(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),i&&(ge(typeof i=="string","internal-error",{appName:e}),o.accessToken=i),s&&(ge(typeof s=="number","internal-error",{appName:e}),o.expirationTime=s),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Ho,this.toJSON())}_performRefresh(){return Fr("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function di(t,e){ge(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class ir{constructor({uid:e,auth:n,stsTokenManager:r,...i}){this.providerId="firebase",this.proactiveRefresh=new KD(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=n,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new Cm(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const n=await rc(this,this.stsTokenManager.getToken(this.auth,e));return ge(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return HD(this,e)}reload(){return GD(this)}_assign(e){this!==e&&(ge(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>({...n})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new ir({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return n.metadata._copy(this.metadata),n}_onReload(e){ge(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await Nd(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Un(this.auth.app))return Promise.reject(Fi(this.auth));const e=await this.getIdToken();return await rc(this,qD(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){const r=n.displayName??void 0,i=n.email??void 0,s=n.phoneNumber??void 0,o=n.photoURL??void 0,a=n.tenantId??void 0,l=n._redirectEventId??void 0,d=n.createdAt??void 0,h=n.lastLoginAt??void 0,{uid:f,emailVerified:m,isAnonymous:v,providerData:C,stsTokenManager:y}=n;ge(f&&y,e,"internal-error");const N=Ho.fromJSON(this.name,y);ge(typeof f=="string",e,"internal-error"),di(r,e.name),di(i,e.name),ge(typeof m=="boolean",e,"internal-error"),ge(typeof v=="boolean",e,"internal-error"),di(s,e.name),di(o,e.name),di(a,e.name),di(l,e.name),di(d,e.name),di(h,e.name);const I=new ir({uid:f,auth:e,email:i,emailVerified:m,displayName:r,isAnonymous:v,photoURL:o,phoneNumber:s,tenantId:a,stsTokenManager:N,createdAt:d,lastLoginAt:h});return C&&Array.isArray(C)&&(I.providerData=C.map(_=>({..._}))),l&&(I._redirectEventId=l),I}static async _fromIdTokenResponse(e,n,r=!1){const i=new Ho;i.updateFromServerResponse(n);const s=new ir({uid:n.localId,auth:e,stsTokenManager:i,isAnonymous:r});return await Nd(s),s}static async _fromGetAccountInfoResponse(e,n,r){const i=n.users[0];ge(i.localId!==void 0,"internal-error");const s=i.providerUserInfo!==void 0?aS(i.providerUserInfo):[],o=!(i.email&&i.passwordHash)&&!(s!=null&&s.length),a=new Ho;a.updateFromIdToken(r);const l=new ir({uid:i.localId,auth:e,stsTokenManager:a,isAnonymous:o}),d={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new Cm(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!(s!=null&&s.length)};return Object.assign(l,d),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hw=new Map;function Ur(t){Xr(t instanceof Function,"Expected a class definition");let e=Hw.get(t);return e?(Xr(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,Hw.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lS{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}lS.type="NONE";const Ww=lS;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $u(t,e,n){return`firebase:${t}:${e}:${n}`}class Wo{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:i,name:s}=this.auth;this.fullUserKey=$u(this.userKey,i.apiKey,s),this.fullPersistenceKey=$u("persistence",i.apiKey,s),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const n=await kd(this.auth,{idToken:e}).catch(()=>{});return n?ir._fromGetAccountInfoResponse(this.auth,n,e):null}return ir._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new Wo(Ur(Ww),e,r);const i=(await Promise.all(n.map(async d=>{if(await d._isAvailable())return d}))).filter(d=>d);let s=i[0]||Ur(Ww);const o=$u(r,e.config.apiKey,e.name);let a=null;for(const d of n)try{const h=await d._get(o);if(h){let f;if(typeof h=="string"){const m=await kd(e,{idToken:h}).catch(()=>{});if(!m)break;f=await ir._fromGetAccountInfoResponse(e,m,h)}else f=ir._fromJSON(e,h);d!==s&&(a=f),s=d;break}}catch{}const l=i.filter(d=>d._shouldAllowMigration);return!s._shouldAllowMigration||!l.length?new Wo(s,e,r):(s=l[0],a&&await s._set(o,a.toJSON()),await Promise.all(n.map(async d=>{if(d!==s)try{await d._remove(o)}catch{}})),new Wo(s,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kw(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(hS(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(cS(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(pS(e))return"Blackberry";if(mS(e))return"Webos";if(uS(e))return"Safari";if((e.includes("chrome/")||dS(e))&&!e.includes("edge/"))return"Chrome";if(fS(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function cS(t=Rt()){return/firefox\//i.test(t)}function uS(t=Rt()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function dS(t=Rt()){return/crios\//i.test(t)}function hS(t=Rt()){return/iemobile/i.test(t)}function fS(t=Rt()){return/android/i.test(t)}function pS(t=Rt()){return/blackberry/i.test(t)}function mS(t=Rt()){return/webos/i.test(t)}function fy(t=Rt()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function JD(t=Rt()){var e;return fy(t)&&!!((e=window.navigator)!=null&&e.standalone)}function ZD(){return uN()&&document.documentMode===10}function gS(t=Rt()){return fy(t)||fS(t)||mS(t)||pS(t)||/windows phone/i.test(t)||hS(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yS(t,e=[]){let n;switch(t){case"Browser":n=Kw(Rt());break;case"Worker":n=`${Kw(Rt())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${ro}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ej{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=s=>new Promise((o,a)=>{try{const l=e(s);o(l)}catch(l){a(l)}});r.onAbort=n,this.queue.push(r);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const i of n)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function tj(t,e={}){return ns(t,"GET","/v2/passwordPolicy",io(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nj=6;class rj{constructor(e){var r;const n=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=n.minPasswordLength??nj,n.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=n.maxPasswordLength),n.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=n.containsLowercaseCharacter),n.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=n.containsUppercaseCharacter),n.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=n.containsNumericCharacter),n.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=n.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=((r=e.allowedNonAlphanumericCharacters)==null?void 0:r.join(""))??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const n={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,n),this.validatePasswordCharacterOptions(e,n),n.isValid&&(n.isValid=n.meetsMinPasswordLength??!0),n.isValid&&(n.isValid=n.meetsMaxPasswordLength??!0),n.isValid&&(n.isValid=n.containsLowercaseLetter??!0),n.isValid&&(n.isValid=n.containsUppercaseLetter??!0),n.isValid&&(n.isValid=n.containsNumericCharacter??!0),n.isValid&&(n.isValid=n.containsNonAlphanumericCharacter??!0),n}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),i&&(n.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ij{constructor(e,n,r,i){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Gw(this),this.idTokenSubscription=new Gw(this),this.beforeStateQueue=new ej(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=nS,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion,this._persistenceManagerAvailable=new Promise(s=>this._resolvePersistenceManagerAvailable=s)}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=Ur(n)),this._initializationPromise=this.queue(async()=>{var r,i,s;if(!this._deleted&&(this.persistenceManager=await Wo.create(this,e),(r=this._resolvePersistenceManagerAvailable)==null||r.call(this),!this._deleted)){if((i=this._popupRedirectResolver)!=null&&i._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((s=this.currentUser)==null?void 0:s.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await kd(this,{idToken:e}),r=await ir._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(r)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var s;if(Un(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(a,a))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let r=n,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(s=this.redirectUser)==null?void 0:s._redirectEventId,a=r==null?void 0:r._redirectEventId,l=await this.tryRedirectSignIn(e);(!o||o===a)&&(l!=null&&l.user)&&(r=l.user,i=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(r)}catch(o){r=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return ge(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await Nd(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=OD()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Un(this.app))return Promise.reject(Fi(this));const n=e?ze(e):null;return n&&ge(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&ge(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Un(this.app)?Promise.reject(Fi(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Un(this.app)?Promise.reject(Fi(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Ur(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await tj(this),n=new rj(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new no("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),await XD(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)==null?void 0:e.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&Ur(e)||this._popupRedirectResolver;ge(n,this,"argument-error"),this.redirectPersistenceManager=await Wo.create(this,[Ur(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)==null?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)==null?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=((n=this.currentUser)==null?void 0:n.uid)??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,i){if(this._deleted)return()=>{};const s=typeof n=="function"?n:n.next.bind(n);let o=!1;const a=this._isInitialized?Promise.resolve():this._initializationPromise;if(ge(a,this,"internal-error"),a.then(()=>{o||s(this.currentUser)}),typeof n=="function"){const l=e.addObserver(n,r,i);return()=>{o=!0,l()}}else{const l=e.addObserver(n);return()=>{o=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return ge(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=yS(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var i;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const n=await((i=this.heartbeatServiceProvider.getImmediate({optional:!0}))==null?void 0:i.getHeartbeatsHeader());n&&(e["X-Firebase-Client"]=n);const r=await this._getAppCheckToken();return r&&(e["X-Firebase-AppCheck"]=r),e}async _getAppCheckToken(){var n;if(Un(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await((n=this.appCheckServiceProvider.getImmediate({optional:!0}))==null?void 0:n.getToken());return e!=null&&e.error&&DD(`Error while retrieving App Check token: ${e.error}`),e==null?void 0:e.token}}function ba(t){return ze(t)}class Gw{constructor(e){this.auth=e,this.observer=null,this.addObserver=gN(n=>this.observer=n)}get next(){return ge(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ch={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function sj(t){Ch=t}function _S(t){return Ch.loadJS(t)}function oj(){return Ch.recaptchaEnterpriseScript}function aj(){return Ch.gapiScript}function lj(t){return`__${t}${Math.floor(Math.random()*1e6)}`}class cj{constructor(){this.enterprise=new uj}ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}class uj{ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}const dj="recaptcha-enterprise",vS="NO_RECAPTCHA";class hj{constructor(e){this.type=dj,this.auth=ba(e)}async verify(e="verify",n=!1){async function r(s){if(!n){if(s.tenantId==null&&s._agentRecaptchaConfig!=null)return s._agentRecaptchaConfig.siteKey;if(s.tenantId!=null&&s._tenantRecaptchaConfigs[s.tenantId]!==void 0)return s._tenantRecaptchaConfigs[s.tenantId].siteKey}return new Promise(async(o,a)=>{zD(s,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(l=>{if(l.recaptchaKey===void 0)a(new Error("recaptcha Enterprise site key undefined"));else{const d=new $D(l);return s.tenantId==null?s._agentRecaptchaConfig=d:s._tenantRecaptchaConfigs[s.tenantId]=d,o(d.siteKey)}}).catch(l=>{a(l)})})}function i(s,o,a){const l=window.grecaptcha;zw(l)?l.enterprise.ready(()=>{l.enterprise.execute(s,{action:e}).then(d=>{o(d)}).catch(()=>{o(vS)})}):a(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new cj().execute("siteKey",{action:"verify"}):new Promise((s,o)=>{r(this.auth).then(a=>{if(!n&&zw(window.grecaptcha))i(a,s,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let l=oj();l.length!==0&&(l+=a),_S(l).then(()=>{i(a,s,o)}).catch(d=>{o(d)})}}).catch(a=>{o(a)})})}}async function Qw(t,e,n,r=!1,i=!1){const s=new hj(t);let o;if(i)o=vS;else try{o=await s.verify(n)}catch{o=await s.verify(n,!0)}const a={...e};if(n==="mfaSmsEnrollment"||n==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in a){const l=a.phoneEnrollmentInfo.phoneNumber,d=a.phoneEnrollmentInfo.recaptchaToken;Object.assign(a,{phoneEnrollmentInfo:{phoneNumber:l,recaptchaToken:d,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in a){const l=a.phoneSignInInfo.recaptchaToken;Object.assign(a,{phoneSignInInfo:{recaptchaToken:l,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return a}return r?Object.assign(a,{captchaResp:o}):Object.assign(a,{captchaResponse:o}),Object.assign(a,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(a,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),a}async function Yw(t,e,n,r,i){var s;if((s=t._getRecaptchaConfig())!=null&&s.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const o=await Qw(t,e,n,n==="getOobCode");return r(t,o)}else return r(t,e).catch(async o=>{if(o.code==="auth/missing-recaptcha-token"){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const a=await Qw(t,e,n,n==="getOobCode");return r(t,a)}else return Promise.reject(o)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fj(t,e){const n=ts(t,"auth");if(n.isInitialized()){const i=n.getImmediate(),s=n.getOptions();if(Qr(s,e??{}))return i;ur(i,"already-initialized")}return n.initialize({options:e})}function pj(t,e){const n=(e==null?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(Ur);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function mj(t,e,n){const r=ba(t);ge(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const i=!1,s=wS(e),{host:o,port:a}=gj(e),l=a===null?"":`:${a}`,d={url:`${s}//${o}${l}/`},h=Object.freeze({host:o,port:a,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!r._canInitEmulator){ge(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),ge(Qr(d,r.config.emulator)&&Qr(h,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=d,r.emulatorConfig=h,r.settings.appVerificationDisabledForTesting=!0,es(o)?(sy(`${s}//${o}${l}`),oy("Auth",!0)):yj()}function wS(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function gj(t){const e=wS(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const s=i[1];return{host:s,port:Xw(r.substr(s.length+1))}}else{const[s,o]=r.split(":");return{host:s,port:Xw(o)}}}function Xw(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function yj(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class py{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return Fr("not implemented")}_getIdTokenResponse(e){return Fr("not implemented")}_linkToIdToken(e,n){return Fr("not implemented")}_getReauthenticationResolver(e){return Fr("not implemented")}}async function _j(t,e){return ns(t,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function vj(t,e){return Ah(t,"POST","/v1/accounts:signInWithPassword",io(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function wj(t,e){return Ah(t,"POST","/v1/accounts:signInWithEmailLink",io(t,e))}async function Ej(t,e){return Ah(t,"POST","/v1/accounts:signInWithEmailLink",io(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ic extends py{constructor(e,n,r,i=null){super("password",r),this._email=e,this._password=n,this._tenantId=i}static _fromEmailAndPassword(e,n){return new ic(e,n,"password")}static _fromEmailAndCode(e,n,r=null){return new ic(e,n,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;if(n!=null&&n.email&&(n!=null&&n.password)){if(n.signInMethod==="password")return this._fromEmailAndPassword(n.email,n.password);if(n.signInMethod==="emailLink")return this._fromEmailAndCode(n.email,n.password,n.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const n={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Yw(e,n,"signInWithPassword",vj);case"emailLink":return wj(e,{email:this._email,oobCode:this._password});default:ur(e,"internal-error")}}async _linkToIdToken(e,n){switch(this.signInMethod){case"password":const r={idToken:n,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Yw(e,r,"signUpPassword",_j);case"emailLink":return Ej(e,{idToken:n,email:this._email,oobCode:this._password});default:ur(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ko(t,e){return Ah(t,"POST","/v1/accounts:signInWithIdp",io(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ij="http://localhost";class Us extends py{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new Us(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):ur("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i,...s}=n;if(!r||!i)return null;const o=new Us(r,i);return o.idToken=s.idToken||void 0,o.accessToken=s.accessToken||void 0,o.secret=s.secret,o.nonce=s.nonce,o.pendingToken=s.pendingToken||null,o}_getIdTokenResponse(e){const n=this.buildRequest();return Ko(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,Ko(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,Ko(e,n)}buildRequest(){const e={requestUri:Ij,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=Tc(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tj(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function xj(t){const e=ul(dl(t)).link,n=e?ul(dl(e)).deep_link_id:null,r=ul(dl(t)).deep_link_id;return(r?ul(dl(r)).link:null)||r||n||e||t}class my{constructor(e){const n=ul(dl(e)),r=n.apiKey??null,i=n.oobCode??null,s=Tj(n.mode??null);ge(r&&i&&s,"argument-error"),this.apiKey=r,this.operation=s,this.code=i,this.continueUrl=n.continueUrl??null,this.languageCode=n.lang??null,this.tenantId=n.tenantId??null}static parseLink(e){const n=xj(e);try{return new my(n)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Aa{constructor(){this.providerId=Aa.PROVIDER_ID}static credential(e,n){return ic._fromEmailAndPassword(e,n)}static credentialWithLink(e,n){const r=my.parseLink(n);return ge(r,"argument-error"),ic._fromEmailAndCode(e,r.code,r.tenantId)}}Aa.PROVIDER_ID="password";Aa.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Aa.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ES{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sc extends ES{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vi extends Sc{constructor(){super("facebook.com")}static credential(e){return Us._fromParams({providerId:vi.PROVIDER_ID,signInMethod:vi.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return vi.credentialFromTaggedObject(e)}static credentialFromError(e){return vi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return vi.credential(e.oauthAccessToken)}catch{return null}}}vi.FACEBOOK_SIGN_IN_METHOD="facebook.com";vi.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wi extends Sc{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return Us._fromParams({providerId:wi.PROVIDER_ID,signInMethod:wi.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return wi.credentialFromTaggedObject(e)}static credentialFromError(e){return wi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return wi.credential(n,r)}catch{return null}}}wi.GOOGLE_SIGN_IN_METHOD="google.com";wi.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ei extends Sc{constructor(){super("github.com")}static credential(e){return Us._fromParams({providerId:Ei.PROVIDER_ID,signInMethod:Ei.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ei.credentialFromTaggedObject(e)}static credentialFromError(e){return Ei.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ei.credential(e.oauthAccessToken)}catch{return null}}}Ei.GITHUB_SIGN_IN_METHOD="github.com";Ei.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ii extends Sc{constructor(){super("twitter.com")}static credential(e,n){return Us._fromParams({providerId:Ii.PROVIDER_ID,signInMethod:Ii.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return Ii.credentialFromTaggedObject(e)}static credentialFromError(e){return Ii.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return Ii.credential(n,r)}catch{return null}}}Ii.TWITTER_SIGN_IN_METHOD="twitter.com";Ii.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oa{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,i=!1){const s=await ir._fromIdTokenResponse(e,r,i),o=Jw(r);return new oa({user:s,providerId:o,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const i=Jw(r);return new oa({user:e,providerId:i,_tokenResponse:r,operationType:n})}}function Jw(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dd extends Yn{constructor(e,n,r,i){super(n.code,n.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,Dd.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,i){return new Dd(e,n,r,i)}}function IS(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?Dd._fromErrorAndOperation(t,s,e,r):s})}async function Sj(t,e,n=!1){const r=await rc(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return oa._forOperation(t,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function bj(t,e,n=!1){const{auth:r}=t;if(Un(r.app))return Promise.reject(Fi(r));const i="reauthenticate";try{const s=await rc(t,IS(r,i,e,t),n);ge(s.idToken,r,"internal-error");const o=hy(s.idToken);ge(o,r,"internal-error");const{sub:a}=o;return ge(t.uid===a,r,"user-mismatch"),oa._forOperation(t,i,s)}catch(s){throw(s==null?void 0:s.code)==="auth/user-not-found"&&ur(r,"user-mismatch"),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function TS(t,e,n=!1){if(Un(t.app))return Promise.reject(Fi(t));const r="signIn",i=await IS(t,r,e),s=await oa._fromIdTokenResponse(t,r,i);return n||await t._updateCurrentUser(s.user),s}async function Aj(t,e){return TS(ba(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Cj(t){const e=ba(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}function Rj(t,e,n){return Un(t.app)?Promise.reject(Fi(t)):Aj(ze(t),Aa.credential(e,n)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&Cj(t),r})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pj(t,e){return ze(t).setPersistence(e)}function kj(t,e,n,r){return ze(t).onIdTokenChanged(e,n,r)}function Nj(t,e,n){return ze(t).beforeAuthStateChanged(e,n)}function gy(t,e,n,r){return ze(t).onAuthStateChanged(e,n,r)}function Dj(t){return ze(t).signOut()}const jd="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xS{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(jd,"1"),this.storage.removeItem(jd),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jj=1e3,Vj=10;class SS extends xS{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=gS(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),i=this.localCache[n];r!==i&&e(n,i,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((o,a,l)=>{this.notifyListeners(o,l)});return}const r=e.key;n?this.detachListener():this.stopPolling();const i=()=>{const o=this.storage.getItem(r);!n&&this.localCache[r]===o||this.notifyListeners(r,o)},s=this.storage.getItem(r);ZD()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,Vj):i()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},jj)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}SS.type="LOCAL";const bS=SS;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AS extends xS{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}AS.type="SESSION";const CS=AS;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Oj(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rh{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(i=>i.isListeningto(e));if(n)return n;const r=new Rh(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:i,data:s}=n.data,o=this.handlersMap[i];if(!(o!=null&&o.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:i});const a=Array.from(o).map(async d=>d(n.origin,s)),l=await Oj(a);n.ports[0].postMessage({status:"done",eventId:r,eventType:i,response:l})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Rh.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yy(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lj{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,o;return new Promise((a,l)=>{const d=yy("",20);i.port1.start();const h=setTimeout(()=>{l(new Error("unsupported_event"))},r);o={messageChannel:i,onMessage(f){const m=f;if(m.data.eventId===d)switch(m.data.status){case"ack":clearTimeout(h),s=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),a(m.data.response);break;default:clearTimeout(h),clearTimeout(s),l(new Error("invalid_response"));break}}},this.handlers.add(o),i.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:d,data:n},[i.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rr(){return window}function Mj(t){Rr().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function RS(){return typeof Rr().WorkerGlobalScope<"u"&&typeof Rr().importScripts=="function"}async function Fj(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function Uj(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)==null?void 0:t.controller)||null}function Bj(){return RS()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PS="firebaseLocalStorageDb",$j=1,Vd="firebaseLocalStorage",kS="fbase_key";class bc{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function Ph(t,e){return t.transaction([Vd],e?"readwrite":"readonly").objectStore(Vd)}function zj(){const t=indexedDB.deleteDatabase(PS);return new bc(t).toPromise()}function Rm(){const t=indexedDB.open(PS,$j);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(Vd,{keyPath:kS})}catch(i){n(i)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(Vd)?e(r):(r.close(),await zj(),e(await Rm()))})})}async function Zw(t,e,n){const r=Ph(t,!0).put({[kS]:e,value:n});return new bc(r).toPromise()}async function qj(t,e){const n=Ph(t,!1).get(e),r=await new bc(n).toPromise();return r===void 0?null:r.value}function eE(t,e){const n=Ph(t,!0).delete(e);return new bc(n).toPromise()}const Hj=800,Wj=3;class NS{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Rm(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>Wj)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return RS()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Rh._getInstance(Bj()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var n,r;if(this.activeServiceWorker=await Fj(),!this.activeServiceWorker)return;this.sender=new Lj(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&(n=e[0])!=null&&n.fulfilled&&(r=e[0])!=null&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||Uj()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Rm();return await Zw(e,jd,"1"),await eE(e,jd),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>Zw(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>qj(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>eE(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const s=Ph(i,!1).getAll();return new bc(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;if(e.length!==0)for(const{fbase_key:i,value:s}of e)r.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(s)&&(this.notifyListeners(i,s),n.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!r.has(i)&&(this.notifyListeners(i,null),n.push(i));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),Hj)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}NS.type="LOCAL";const Kj=NS;new xc(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gj(t,e){return e?Ur(e):(ge(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _y extends py{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Ko(e,this._buildIdpRequest())}_linkToIdToken(e,n){return Ko(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return Ko(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function Qj(t){return TS(t.auth,new _y(t),t.bypassAuthState)}function Yj(t){const{auth:e,user:n}=t;return ge(n,e,"internal-error"),bj(n,new _y(t),t.bypassAuthState)}async function Xj(t){const{auth:e,user:n}=t;return ge(n,e,"internal-error"),Sj(n,new _y(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DS{constructor(e,n,r,i,s=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:i,tenantId:s,error:o,type:a}=e;if(o){this.reject(o);return}const l={auth:this.auth,requestUri:n,sessionId:r,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(l))}catch(d){this.reject(d)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return Qj;case"linkViaPopup":case"linkViaRedirect":return Xj;case"reauthViaPopup":case"reauthViaRedirect":return Yj;default:ur(this.auth,"internal-error")}}resolve(e){Xr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Xr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jj=new xc(2e3,1e4);class Mo extends DS{constructor(e,n,r,i,s){super(e,n,i,s),this.provider=r,this.authWindow=null,this.pollId=null,Mo.currentPopupAction&&Mo.currentPopupAction.cancel(),Mo.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return ge(e,this.auth,"internal-error"),e}async onExecution(){Xr(this.filter.length===1,"Popup operations only handle one event");const e=yy();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(Cr(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)==null?void 0:e.associatedEvent)||null}cancel(){this.reject(Cr(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Mo.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,r;if((r=(n=this.authWindow)==null?void 0:n.window)!=null&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Cr(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,Jj.get())};e()}}Mo.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zj="pendingRedirect",zu=new Map;class e2 extends DS{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=zu.get(this.auth._key());if(!e){try{const r=await t2(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}zu.set(this.auth._key(),e)}return this.bypassAuthState||zu.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function t2(t,e){const n=i2(e),r=r2(t);if(!await r._isAvailable())return!1;const i=await r._get(n)==="true";return await r._remove(n),i}function n2(t,e){zu.set(t._key(),e)}function r2(t){return Ur(t._redirectPersistence)}function i2(t){return $u(Zj,t.config.apiKey,t.name)}async function s2(t,e,n=!1){if(Un(t.app))return Promise.reject(Fi(t));const r=ba(t),i=Gj(r,e),o=await new e2(r,i,n).execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const o2=10*60*1e3;class a2{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!l2(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!jS(e)){const i=((r=e.error.code)==null?void 0:r.split("auth/")[1])||"internal-error";n.onError(Cr(this.auth,i))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=o2&&this.cachedEventUids.clear(),this.cachedEventUids.has(tE(e))}saveEventToCache(e){this.cachedEventUids.add(tE(e)),this.lastProcessedEventTime=Date.now()}}function tE(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function jS({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function l2(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return jS(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function c2(t,e={}){return ns(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const u2=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,d2=/^https?/;async function h2(t){if(t.config.emulator)return;const{authorizedDomains:e}=await c2(t);for(const n of e)try{if(f2(n))return}catch{}ur(t,"unauthorized-domain")}function f2(t){const e=Am(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&o.hostname===r}if(!d2.test(n))return!1;if(u2.test(t))return r===t;const i=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const p2=new xc(3e4,6e4);function nE(){const t=Rr().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function m2(t){return new Promise((e,n)=>{var i,s,o;function r(){nE(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{nE(),n(Cr(t,"network-request-failed"))},timeout:p2.get()})}if((s=(i=Rr().gapi)==null?void 0:i.iframes)!=null&&s.Iframe)e(gapi.iframes.getContext());else if((o=Rr().gapi)!=null&&o.load)r();else{const a=lj("iframefcb");return Rr()[a]=()=>{gapi.load?r():n(Cr(t,"network-request-failed"))},_S(`${aj()}?onload=${a}`).catch(l=>n(l))}}).catch(e=>{throw qu=null,e})}let qu=null;function g2(t){return qu=qu||m2(t),qu}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const y2=new xc(5e3,15e3),_2="__/auth/iframe",v2="emulator/auth/iframe",w2={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},E2=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function I2(t){const e=t.config;ge(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?dy(e,v2):`https://${t.config.authDomain}/${_2}`,r={apiKey:e.apiKey,appName:t.name,v:ro},i=E2.get(t.config.apiHost);i&&(r.eid=i);const s=t._getFrameworks();return s.length&&(r.fw=s.join(",")),`${n}?${Tc(r).slice(1)}`}async function T2(t){const e=await g2(t),n=Rr().gapi;return ge(n,t,"internal-error"),e.open({where:document.body,url:I2(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:w2,dontclear:!0},r=>new Promise(async(i,s)=>{await r.restyle({setHideOnLeave:!1});const o=Cr(t,"network-request-failed"),a=Rr().setTimeout(()=>{s(o)},y2.get());function l(){Rr().clearTimeout(a),i(r)}r.ping(l).then(l,()=>{s(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const x2={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},S2=500,b2=600,A2="_blank",C2="http://localhost";class rE{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function R2(t,e,n,r=S2,i=b2){const s=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let a="";const l={...x2,width:r.toString(),height:i.toString(),top:s,left:o},d=Rt().toLowerCase();n&&(a=dS(d)?A2:n),cS(d)&&(e=e||C2,l.scrollbars="yes");const h=Object.entries(l).reduce((m,[v,C])=>`${m}${v}=${C},`,"");if(JD(d)&&a!=="_self")return P2(e||"",a),new rE(null);const f=window.open(e||"",a,h);ge(f,t,"popup-blocked");try{f.focus()}catch{}return new rE(f)}function P2(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const k2="__/auth/handler",N2="emulator/auth/handler",D2=encodeURIComponent("fac");async function iE(t,e,n,r,i,s){ge(t.config.authDomain,t,"auth-domain-config-required"),ge(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:ro,eventId:i};if(e instanceof ES){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",mN(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[h,f]of Object.entries({}))o[h]=f}if(e instanceof Sc){const h=e.getScopes().filter(f=>f!=="");h.length>0&&(o.scopes=h.join(","))}t.tenantId&&(o.tid=t.tenantId);const a=o;for(const h of Object.keys(a))a[h]===void 0&&delete a[h];const l=await t._getAppCheckToken(),d=l?`#${D2}=${encodeURIComponent(l)}`:"";return`${j2(t)}?${Tc(a).slice(1)}${d}`}function j2({config:t}){return t.emulator?dy(t,N2):`https://${t.authDomain}/${k2}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const op="webStorageSupport";class V2{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=CS,this._completeRedirectFn=s2,this._overrideRedirectResult=n2}async _openPopup(e,n,r,i){var o;Xr((o=this.eventManagers[e._key()])==null?void 0:o.manager,"_initialize() not called before _openPopup()");const s=await iE(e,n,r,Am(),i);return R2(e,s,yy())}async _openRedirect(e,n,r,i){await this._originValidation(e);const s=await iE(e,n,r,Am(),i);return Mj(s),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:i,promise:s}=this.eventManagers[n];return i?Promise.resolve(i):(Xr(s,"If manager is not set, promise should be"),s)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await T2(e),r=new a2(e);return n.register("authEvent",i=>(ge(i==null?void 0:i.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(op,{type:op},i=>{var o;const s=(o=i==null?void 0:i[0])==null?void 0:o[op];s!==void 0&&n(!!s),ur(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=h2(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return gS()||uS()||fy()}}const O2=V2;var sE="@firebase/auth",oE="1.11.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L2{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)==null?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){ge(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function M2(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function F2(t){cr(new Qn("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=r.options;ge(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const l={apiKey:o,authDomain:a,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:yS(t)},d=new ij(r,i,s,l);return pj(d,n),d},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),cr(new Qn("auth-internal",e=>{const n=ba(e.getProvider("auth").getImmediate());return(r=>new L2(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),In(sE,oE,M2(t)),In(sE,oE,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const U2=5*60,B2=zx("authIdTokenMaxAge")||U2;let aE=null;const $2=t=>async e=>{const n=e&&await e.getIdTokenResult(),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>B2)return;const i=n==null?void 0:n.token;aE!==i&&(aE=i,await fetch(t,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function VS(t=bh()){const e=ts(t,"auth");if(e.isInitialized())return e.getImmediate();const n=fj(t,{popupRedirectResolver:O2,persistence:[Kj,bS,CS]}),r=zx("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const s=new URL(r,location.origin);if(location.origin===s.origin){const o=$2(s.toString());Nj(n,o,()=>o(n.currentUser)),kj(n,a=>o(a))}}const i=Ux("auth");return i&&mj(n,`http://${i}`),n}function z2(){var t;return((t=document.getElementsByTagName("head"))==null?void 0:t[0])??document}sj({loadJS(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=i=>{const s=Cr("internal-error");s.customData=i,n(s)},r.type="text/javascript",r.charset="UTF-8",z2().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});F2("Browser");var lE=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Ui,OS;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(x,w){function A(){}A.prototype=w.prototype,x.F=w.prototype,x.prototype=new A,x.prototype.constructor=x,x.D=function(k,D,j){for(var b=Array(arguments.length-2),Q=2;Q<arguments.length;Q++)b[Q-2]=arguments[Q];return w.prototype[D].apply(k,b)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(r,n),r.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(x,w,A){A||(A=0);const k=Array(16);if(typeof w=="string")for(var D=0;D<16;++D)k[D]=w.charCodeAt(A++)|w.charCodeAt(A++)<<8|w.charCodeAt(A++)<<16|w.charCodeAt(A++)<<24;else for(D=0;D<16;++D)k[D]=w[A++]|w[A++]<<8|w[A++]<<16|w[A++]<<24;w=x.g[0],A=x.g[1],D=x.g[2];let j=x.g[3],b;b=w+(j^A&(D^j))+k[0]+3614090360&4294967295,w=A+(b<<7&4294967295|b>>>25),b=j+(D^w&(A^D))+k[1]+3905402710&4294967295,j=w+(b<<12&4294967295|b>>>20),b=D+(A^j&(w^A))+k[2]+606105819&4294967295,D=j+(b<<17&4294967295|b>>>15),b=A+(w^D&(j^w))+k[3]+3250441966&4294967295,A=D+(b<<22&4294967295|b>>>10),b=w+(j^A&(D^j))+k[4]+4118548399&4294967295,w=A+(b<<7&4294967295|b>>>25),b=j+(D^w&(A^D))+k[5]+1200080426&4294967295,j=w+(b<<12&4294967295|b>>>20),b=D+(A^j&(w^A))+k[6]+2821735955&4294967295,D=j+(b<<17&4294967295|b>>>15),b=A+(w^D&(j^w))+k[7]+4249261313&4294967295,A=D+(b<<22&4294967295|b>>>10),b=w+(j^A&(D^j))+k[8]+1770035416&4294967295,w=A+(b<<7&4294967295|b>>>25),b=j+(D^w&(A^D))+k[9]+2336552879&4294967295,j=w+(b<<12&4294967295|b>>>20),b=D+(A^j&(w^A))+k[10]+4294925233&4294967295,D=j+(b<<17&4294967295|b>>>15),b=A+(w^D&(j^w))+k[11]+2304563134&4294967295,A=D+(b<<22&4294967295|b>>>10),b=w+(j^A&(D^j))+k[12]+1804603682&4294967295,w=A+(b<<7&4294967295|b>>>25),b=j+(D^w&(A^D))+k[13]+4254626195&4294967295,j=w+(b<<12&4294967295|b>>>20),b=D+(A^j&(w^A))+k[14]+2792965006&4294967295,D=j+(b<<17&4294967295|b>>>15),b=A+(w^D&(j^w))+k[15]+1236535329&4294967295,A=D+(b<<22&4294967295|b>>>10),b=w+(D^j&(A^D))+k[1]+4129170786&4294967295,w=A+(b<<5&4294967295|b>>>27),b=j+(A^D&(w^A))+k[6]+3225465664&4294967295,j=w+(b<<9&4294967295|b>>>23),b=D+(w^A&(j^w))+k[11]+643717713&4294967295,D=j+(b<<14&4294967295|b>>>18),b=A+(j^w&(D^j))+k[0]+3921069994&4294967295,A=D+(b<<20&4294967295|b>>>12),b=w+(D^j&(A^D))+k[5]+3593408605&4294967295,w=A+(b<<5&4294967295|b>>>27),b=j+(A^D&(w^A))+k[10]+38016083&4294967295,j=w+(b<<9&4294967295|b>>>23),b=D+(w^A&(j^w))+k[15]+3634488961&4294967295,D=j+(b<<14&4294967295|b>>>18),b=A+(j^w&(D^j))+k[4]+3889429448&4294967295,A=D+(b<<20&4294967295|b>>>12),b=w+(D^j&(A^D))+k[9]+568446438&4294967295,w=A+(b<<5&4294967295|b>>>27),b=j+(A^D&(w^A))+k[14]+3275163606&4294967295,j=w+(b<<9&4294967295|b>>>23),b=D+(w^A&(j^w))+k[3]+4107603335&4294967295,D=j+(b<<14&4294967295|b>>>18),b=A+(j^w&(D^j))+k[8]+1163531501&4294967295,A=D+(b<<20&4294967295|b>>>12),b=w+(D^j&(A^D))+k[13]+2850285829&4294967295,w=A+(b<<5&4294967295|b>>>27),b=j+(A^D&(w^A))+k[2]+4243563512&4294967295,j=w+(b<<9&4294967295|b>>>23),b=D+(w^A&(j^w))+k[7]+1735328473&4294967295,D=j+(b<<14&4294967295|b>>>18),b=A+(j^w&(D^j))+k[12]+2368359562&4294967295,A=D+(b<<20&4294967295|b>>>12),b=w+(A^D^j)+k[5]+4294588738&4294967295,w=A+(b<<4&4294967295|b>>>28),b=j+(w^A^D)+k[8]+2272392833&4294967295,j=w+(b<<11&4294967295|b>>>21),b=D+(j^w^A)+k[11]+1839030562&4294967295,D=j+(b<<16&4294967295|b>>>16),b=A+(D^j^w)+k[14]+4259657740&4294967295,A=D+(b<<23&4294967295|b>>>9),b=w+(A^D^j)+k[1]+2763975236&4294967295,w=A+(b<<4&4294967295|b>>>28),b=j+(w^A^D)+k[4]+1272893353&4294967295,j=w+(b<<11&4294967295|b>>>21),b=D+(j^w^A)+k[7]+4139469664&4294967295,D=j+(b<<16&4294967295|b>>>16),b=A+(D^j^w)+k[10]+3200236656&4294967295,A=D+(b<<23&4294967295|b>>>9),b=w+(A^D^j)+k[13]+681279174&4294967295,w=A+(b<<4&4294967295|b>>>28),b=j+(w^A^D)+k[0]+3936430074&4294967295,j=w+(b<<11&4294967295|b>>>21),b=D+(j^w^A)+k[3]+3572445317&4294967295,D=j+(b<<16&4294967295|b>>>16),b=A+(D^j^w)+k[6]+76029189&4294967295,A=D+(b<<23&4294967295|b>>>9),b=w+(A^D^j)+k[9]+3654602809&4294967295,w=A+(b<<4&4294967295|b>>>28),b=j+(w^A^D)+k[12]+3873151461&4294967295,j=w+(b<<11&4294967295|b>>>21),b=D+(j^w^A)+k[15]+530742520&4294967295,D=j+(b<<16&4294967295|b>>>16),b=A+(D^j^w)+k[2]+3299628645&4294967295,A=D+(b<<23&4294967295|b>>>9),b=w+(D^(A|~j))+k[0]+4096336452&4294967295,w=A+(b<<6&4294967295|b>>>26),b=j+(A^(w|~D))+k[7]+1126891415&4294967295,j=w+(b<<10&4294967295|b>>>22),b=D+(w^(j|~A))+k[14]+2878612391&4294967295,D=j+(b<<15&4294967295|b>>>17),b=A+(j^(D|~w))+k[5]+4237533241&4294967295,A=D+(b<<21&4294967295|b>>>11),b=w+(D^(A|~j))+k[12]+1700485571&4294967295,w=A+(b<<6&4294967295|b>>>26),b=j+(A^(w|~D))+k[3]+2399980690&4294967295,j=w+(b<<10&4294967295|b>>>22),b=D+(w^(j|~A))+k[10]+4293915773&4294967295,D=j+(b<<15&4294967295|b>>>17),b=A+(j^(D|~w))+k[1]+2240044497&4294967295,A=D+(b<<21&4294967295|b>>>11),b=w+(D^(A|~j))+k[8]+1873313359&4294967295,w=A+(b<<6&4294967295|b>>>26),b=j+(A^(w|~D))+k[15]+4264355552&4294967295,j=w+(b<<10&4294967295|b>>>22),b=D+(w^(j|~A))+k[6]+2734768916&4294967295,D=j+(b<<15&4294967295|b>>>17),b=A+(j^(D|~w))+k[13]+1309151649&4294967295,A=D+(b<<21&4294967295|b>>>11),b=w+(D^(A|~j))+k[4]+4149444226&4294967295,w=A+(b<<6&4294967295|b>>>26),b=j+(A^(w|~D))+k[11]+3174756917&4294967295,j=w+(b<<10&4294967295|b>>>22),b=D+(w^(j|~A))+k[2]+718787259&4294967295,D=j+(b<<15&4294967295|b>>>17),b=A+(j^(D|~w))+k[9]+3951481745&4294967295,x.g[0]=x.g[0]+w&4294967295,x.g[1]=x.g[1]+(D+(b<<21&4294967295|b>>>11))&4294967295,x.g[2]=x.g[2]+D&4294967295,x.g[3]=x.g[3]+j&4294967295}r.prototype.v=function(x,w){w===void 0&&(w=x.length);const A=w-this.blockSize,k=this.C;let D=this.h,j=0;for(;j<w;){if(D==0)for(;j<=A;)i(this,x,j),j+=this.blockSize;if(typeof x=="string"){for(;j<w;)if(k[D++]=x.charCodeAt(j++),D==this.blockSize){i(this,k),D=0;break}}else for(;j<w;)if(k[D++]=x[j++],D==this.blockSize){i(this,k),D=0;break}}this.h=D,this.o+=w},r.prototype.A=function(){var x=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);x[0]=128;for(var w=1;w<x.length-8;++w)x[w]=0;w=this.o*8;for(var A=x.length-8;A<x.length;++A)x[A]=w&255,w/=256;for(this.v(x),x=Array(16),w=0,A=0;A<4;++A)for(let k=0;k<32;k+=8)x[w++]=this.g[A]>>>k&255;return x};function s(x,w){var A=a;return Object.prototype.hasOwnProperty.call(A,x)?A[x]:A[x]=w(x)}function o(x,w){this.h=w;const A=[];let k=!0;for(let D=x.length-1;D>=0;D--){const j=x[D]|0;k&&j==w||(A[D]=j,k=!1)}this.g=A}var a={};function l(x){return-128<=x&&x<128?s(x,function(w){return new o([w|0],w<0?-1:0)}):new o([x|0],x<0?-1:0)}function d(x){if(isNaN(x)||!isFinite(x))return f;if(x<0)return N(d(-x));const w=[];let A=1;for(let k=0;x>=A;k++)w[k]=x/A|0,A*=4294967296;return new o(w,0)}function h(x,w){if(x.length==0)throw Error("number format error: empty string");if(w=w||10,w<2||36<w)throw Error("radix out of range: "+w);if(x.charAt(0)=="-")return N(h(x.substring(1),w));if(x.indexOf("-")>=0)throw Error('number format error: interior "-" character');const A=d(Math.pow(w,8));let k=f;for(let j=0;j<x.length;j+=8){var D=Math.min(8,x.length-j);const b=parseInt(x.substring(j,j+D),w);D<8?(D=d(Math.pow(w,D)),k=k.j(D).add(d(b))):(k=k.j(A),k=k.add(d(b)))}return k}var f=l(0),m=l(1),v=l(16777216);t=o.prototype,t.m=function(){if(y(this))return-N(this).m();let x=0,w=1;for(let A=0;A<this.g.length;A++){const k=this.i(A);x+=(k>=0?k:4294967296+k)*w,w*=4294967296}return x},t.toString=function(x){if(x=x||10,x<2||36<x)throw Error("radix out of range: "+x);if(C(this))return"0";if(y(this))return"-"+N(this).toString(x);const w=d(Math.pow(x,6));var A=this;let k="";for(;;){const D=R(A,w).g;A=I(A,D.j(w));let j=((A.g.length>0?A.g[0]:A.h)>>>0).toString(x);if(A=D,C(A))return j+k;for(;j.length<6;)j="0"+j;k=j+k}},t.i=function(x){return x<0?0:x<this.g.length?this.g[x]:this.h};function C(x){if(x.h!=0)return!1;for(let w=0;w<x.g.length;w++)if(x.g[w]!=0)return!1;return!0}function y(x){return x.h==-1}t.l=function(x){return x=I(this,x),y(x)?-1:C(x)?0:1};function N(x){const w=x.g.length,A=[];for(let k=0;k<w;k++)A[k]=~x.g[k];return new o(A,~x.h).add(m)}t.abs=function(){return y(this)?N(this):this},t.add=function(x){const w=Math.max(this.g.length,x.g.length),A=[];let k=0;for(let D=0;D<=w;D++){let j=k+(this.i(D)&65535)+(x.i(D)&65535),b=(j>>>16)+(this.i(D)>>>16)+(x.i(D)>>>16);k=b>>>16,j&=65535,b&=65535,A[D]=b<<16|j}return new o(A,A[A.length-1]&-2147483648?-1:0)};function I(x,w){return x.add(N(w))}t.j=function(x){if(C(this)||C(x))return f;if(y(this))return y(x)?N(this).j(N(x)):N(N(this).j(x));if(y(x))return N(this.j(N(x)));if(this.l(v)<0&&x.l(v)<0)return d(this.m()*x.m());const w=this.g.length+x.g.length,A=[];for(var k=0;k<2*w;k++)A[k]=0;for(k=0;k<this.g.length;k++)for(let D=0;D<x.g.length;D++){const j=this.i(k)>>>16,b=this.i(k)&65535,Q=x.i(D)>>>16,qe=x.i(D)&65535;A[2*k+2*D]+=b*qe,_(A,2*k+2*D),A[2*k+2*D+1]+=j*qe,_(A,2*k+2*D+1),A[2*k+2*D+1]+=b*Q,_(A,2*k+2*D+1),A[2*k+2*D+2]+=j*Q,_(A,2*k+2*D+2)}for(x=0;x<w;x++)A[x]=A[2*x+1]<<16|A[2*x];for(x=w;x<2*w;x++)A[x]=0;return new o(A,0)};function _(x,w){for(;(x[w]&65535)!=x[w];)x[w+1]+=x[w]>>>16,x[w]&=65535,w++}function T(x,w){this.g=x,this.h=w}function R(x,w){if(C(w))throw Error("division by zero");if(C(x))return new T(f,f);if(y(x))return w=R(N(x),w),new T(N(w.g),N(w.h));if(y(w))return w=R(x,N(w)),new T(N(w.g),w.h);if(x.g.length>30){if(y(x)||y(w))throw Error("slowDivide_ only works with positive integers.");for(var A=m,k=w;k.l(x)<=0;)A=O(A),k=O(k);var D=$(A,1),j=$(k,1);for(k=$(k,2),A=$(A,2);!C(k);){var b=j.add(k);b.l(x)<=0&&(D=D.add(A),j=b),k=$(k,1),A=$(A,1)}return w=I(x,D.j(w)),new T(D,w)}for(D=f;x.l(w)>=0;){for(A=Math.max(1,Math.floor(x.m()/w.m())),k=Math.ceil(Math.log(A)/Math.LN2),k=k<=48?1:Math.pow(2,k-48),j=d(A),b=j.j(w);y(b)||b.l(x)>0;)A-=k,j=d(A),b=j.j(w);C(j)&&(j=m),D=D.add(j),x=I(x,b)}return new T(D,x)}t.B=function(x){return R(this,x).h},t.and=function(x){const w=Math.max(this.g.length,x.g.length),A=[];for(let k=0;k<w;k++)A[k]=this.i(k)&x.i(k);return new o(A,this.h&x.h)},t.or=function(x){const w=Math.max(this.g.length,x.g.length),A=[];for(let k=0;k<w;k++)A[k]=this.i(k)|x.i(k);return new o(A,this.h|x.h)},t.xor=function(x){const w=Math.max(this.g.length,x.g.length),A=[];for(let k=0;k<w;k++)A[k]=this.i(k)^x.i(k);return new o(A,this.h^x.h)};function O(x){const w=x.g.length+1,A=[];for(let k=0;k<w;k++)A[k]=x.i(k)<<1|x.i(k-1)>>>31;return new o(A,x.h)}function $(x,w){const A=w>>5;w%=32;const k=x.g.length-A,D=[];for(let j=0;j<k;j++)D[j]=w>0?x.i(j+A)>>>w|x.i(j+A+1)<<32-w:x.i(j+A);return new o(D,x.h)}r.prototype.digest=r.prototype.A,r.prototype.reset=r.prototype.u,r.prototype.update=r.prototype.v,OS=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.B,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=d,o.fromString=h,Ui=o}).apply(typeof lE<"u"?lE:typeof self<"u"?self:typeof window<"u"?window:{});var gu=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var LS,hl,MS,Hu,Pm,FS,US,BS;(function(){var t,e=Object.defineProperty;function n(c){c=[typeof globalThis=="object"&&globalThis,c,typeof window=="object"&&window,typeof self=="object"&&self,typeof gu=="object"&&gu];for(var p=0;p<c.length;++p){var g=c[p];if(g&&g.Math==Math)return g}throw Error("Cannot find global object")}var r=n(this);function i(c,p){if(p)e:{var g=r;c=c.split(".");for(var E=0;E<c.length-1;E++){var L=c[E];if(!(L in g))break e;g=g[L]}c=c[c.length-1],E=g[c],p=p(E),p!=E&&p!=null&&e(g,c,{configurable:!0,writable:!0,value:p})}}i("Symbol.dispose",function(c){return c||Symbol("Symbol.dispose")}),i("Array.prototype.values",function(c){return c||function(){return this[Symbol.iterator]()}}),i("Object.entries",function(c){return c||function(p){var g=[],E;for(E in p)Object.prototype.hasOwnProperty.call(p,E)&&g.push([E,p[E]]);return g}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var s=s||{},o=this||self;function a(c){var p=typeof c;return p=="object"&&c!=null||p=="function"}function l(c,p,g){return c.call.apply(c.bind,arguments)}function d(c,p,g){return d=l,d.apply(null,arguments)}function h(c,p){var g=Array.prototype.slice.call(arguments,1);return function(){var E=g.slice();return E.push.apply(E,arguments),c.apply(this,E)}}function f(c,p){function g(){}g.prototype=p.prototype,c.Z=p.prototype,c.prototype=new g,c.prototype.constructor=c,c.Ob=function(E,L,U){for(var Y=Array(arguments.length-2),Ae=2;Ae<arguments.length;Ae++)Y[Ae-2]=arguments[Ae];return p.prototype[L].apply(E,Y)}}var m=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?c=>c&&AsyncContext.Snapshot.wrap(c):c=>c;function v(c){const p=c.length;if(p>0){const g=Array(p);for(let E=0;E<p;E++)g[E]=c[E];return g}return[]}function C(c,p){for(let E=1;E<arguments.length;E++){const L=arguments[E];var g=typeof L;if(g=g!="object"?g:L?Array.isArray(L)?"array":g:"null",g=="array"||g=="object"&&typeof L.length=="number"){g=c.length||0;const U=L.length||0;c.length=g+U;for(let Y=0;Y<U;Y++)c[g+Y]=L[Y]}else c.push(L)}}class y{constructor(p,g){this.i=p,this.j=g,this.h=0,this.g=null}get(){let p;return this.h>0?(this.h--,p=this.g,this.g=p.next,p.next=null):p=this.i(),p}}function N(c){o.setTimeout(()=>{throw c},0)}function I(){var c=x;let p=null;return c.g&&(p=c.g,c.g=c.g.next,c.g||(c.h=null),p.next=null),p}class _{constructor(){this.h=this.g=null}add(p,g){const E=T.get();E.set(p,g),this.h?this.h.next=E:this.g=E,this.h=E}}var T=new y(()=>new R,c=>c.reset());class R{constructor(){this.next=this.g=this.h=null}set(p,g){this.h=p,this.g=g,this.next=null}reset(){this.next=this.g=this.h=null}}let O,$=!1,x=new _,w=()=>{const c=Promise.resolve(void 0);O=()=>{c.then(A)}};function A(){for(var c;c=I();){try{c.h.call(c.g)}catch(g){N(g)}var p=T;p.j(c),p.h<100&&(p.h++,c.next=p.g,p.g=c)}$=!1}function k(){this.u=this.u,this.C=this.C}k.prototype.u=!1,k.prototype.dispose=function(){this.u||(this.u=!0,this.N())},k.prototype[Symbol.dispose]=function(){this.dispose()},k.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function D(c,p){this.type=c,this.g=this.target=p,this.defaultPrevented=!1}D.prototype.h=function(){this.defaultPrevented=!0};var j=function(){if(!o.addEventListener||!Object.defineProperty)return!1;var c=!1,p=Object.defineProperty({},"passive",{get:function(){c=!0}});try{const g=()=>{};o.addEventListener("test",g,p),o.removeEventListener("test",g,p)}catch{}return c}();function b(c){return/^[\s\xa0]*$/.test(c)}function Q(c,p){D.call(this,c?c.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,c&&this.init(c,p)}f(Q,D),Q.prototype.init=function(c,p){const g=this.type=c.type,E=c.changedTouches&&c.changedTouches.length?c.changedTouches[0]:null;this.target=c.target||c.srcElement,this.g=p,p=c.relatedTarget,p||(g=="mouseover"?p=c.fromElement:g=="mouseout"&&(p=c.toElement)),this.relatedTarget=p,E?(this.clientX=E.clientX!==void 0?E.clientX:E.pageX,this.clientY=E.clientY!==void 0?E.clientY:E.pageY,this.screenX=E.screenX||0,this.screenY=E.screenY||0):(this.clientX=c.clientX!==void 0?c.clientX:c.pageX,this.clientY=c.clientY!==void 0?c.clientY:c.pageY,this.screenX=c.screenX||0,this.screenY=c.screenY||0),this.button=c.button,this.key=c.key||"",this.ctrlKey=c.ctrlKey,this.altKey=c.altKey,this.shiftKey=c.shiftKey,this.metaKey=c.metaKey,this.pointerId=c.pointerId||0,this.pointerType=c.pointerType,this.state=c.state,this.i=c,c.defaultPrevented&&Q.Z.h.call(this)},Q.prototype.h=function(){Q.Z.h.call(this);const c=this.i;c.preventDefault?c.preventDefault():c.returnValue=!1};var qe="closure_listenable_"+(Math.random()*1e6|0),St=0;function qt(c,p,g,E,L){this.listener=c,this.proxy=null,this.src=p,this.type=g,this.capture=!!E,this.ha=L,this.key=++St,this.da=this.fa=!1}function X(c){c.da=!0,c.listener=null,c.proxy=null,c.src=null,c.ha=null}function de(c,p,g){for(const E in c)p.call(g,c[E],E,c)}function me(c,p){for(const g in c)p.call(void 0,c[g],g,c)}function Ne(c){const p={};for(const g in c)p[g]=c[g];return p}const Ue="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function z(c,p){let g,E;for(let L=1;L<arguments.length;L++){E=arguments[L];for(g in E)c[g]=E[g];for(let U=0;U<Ue.length;U++)g=Ue[U],Object.prototype.hasOwnProperty.call(E,g)&&(c[g]=E[g])}}function Z(c){this.src=c,this.g={},this.h=0}Z.prototype.add=function(c,p,g,E,L){const U=c.toString();c=this.g[U],c||(c=this.g[U]=[],this.h++);const Y=ye(c,p,E,L);return Y>-1?(p=c[Y],g||(p.fa=!1)):(p=new qt(p,this.src,U,!!E,L),p.fa=g,c.push(p)),p};function oe(c,p){const g=p.type;if(g in c.g){var E=c.g[g],L=Array.prototype.indexOf.call(E,p,void 0),U;(U=L>=0)&&Array.prototype.splice.call(E,L,1),U&&(X(p),c.g[g].length==0&&(delete c.g[g],c.h--))}}function ye(c,p,g,E){for(let L=0;L<c.length;++L){const U=c[L];if(!U.da&&U.listener==p&&U.capture==!!g&&U.ha==E)return L}return-1}var xe="closure_lm_"+(Math.random()*1e6|0),Re={};function ve(c,p,g,E,L){if(Array.isArray(p)){for(let U=0;U<p.length;U++)ve(c,p[U],g,E,L);return null}return g=he(g),c&&c[qe]?c.J(p,g,a(E)?!!E.capture:!1,L):Ge(c,p,g,!1,E,L)}function Ge(c,p,g,E,L,U){if(!p)throw Error("Invalid event type");const Y=a(L)?!!L.capture:!!L;let Ae=te(c);if(Ae||(c[xe]=Ae=new Z(c)),g=Ae.add(p,g,E,Y,U),g.proxy)return g;if(E=we(),g.proxy=E,E.src=c,E.listener=g,c.addEventListener)j||(L=Y),L===void 0&&(L=!1),c.addEventListener(p.toString(),E,L);else if(c.attachEvent)c.attachEvent(_t(p.toString()),E);else if(c.addListener&&c.removeListener)c.addListener(E);else throw Error("addEventListener and attachEvent are unavailable.");return g}function we(){function c(g){return p.call(c.src,c.listener,g)}const p=wt;return c}function ie(c,p,g,E,L){if(Array.isArray(p))for(var U=0;U<p.length;U++)ie(c,p[U],g,E,L);else E=a(E)?!!E.capture:!!E,g=he(g),c&&c[qe]?(c=c.i,U=String(p).toString(),U in c.g&&(p=c.g[U],g=ye(p,g,E,L),g>-1&&(X(p[g]),Array.prototype.splice.call(p,g,1),p.length==0&&(delete c.g[U],c.h--)))):c&&(c=te(c))&&(p=c.g[p.toString()],c=-1,p&&(c=ye(p,g,E,L)),(g=c>-1?p[c]:null)&&Pe(g))}function Pe(c){if(typeof c!="number"&&c&&!c.da){var p=c.src;if(p&&p[qe])oe(p.i,c);else{var g=c.type,E=c.proxy;p.removeEventListener?p.removeEventListener(g,E,c.capture):p.detachEvent?p.detachEvent(_t(g),E):p.addListener&&p.removeListener&&p.removeListener(E),(g=te(p))?(oe(g,c),g.h==0&&(g.src=null,p[xe]=null)):X(c)}}}function _t(c){return c in Re?Re[c]:Re[c]="on"+c}function wt(c,p){if(c.da)c=!0;else{p=new Q(p,this);const g=c.listener,E=c.ha||c.src;c.fa&&Pe(c),c=g.call(E,p)}return c}function te(c){return c=c[xe],c instanceof Z?c:null}var re="__closure_events_fn_"+(Math.random()*1e9>>>0);function he(c){return typeof c=="function"?c:(c[re]||(c[re]=function(p){return c.handleEvent(p)}),c[re])}function ne(){k.call(this),this.i=new Z(this),this.M=this,this.G=null}f(ne,k),ne.prototype[qe]=!0,ne.prototype.removeEventListener=function(c,p,g,E){ie(this,c,p,g,E)};function ee(c,p){var g,E=c.G;if(E)for(g=[];E;E=E.G)g.push(E);if(c=c.M,E=p.type||p,typeof p=="string")p=new D(p,c);else if(p instanceof D)p.target=p.target||c;else{var L=p;p=new D(E,c),z(p,L)}L=!0;let U,Y;if(g)for(Y=g.length-1;Y>=0;Y--)U=p.g=g[Y],L=S(U,E,!0,p)&&L;if(U=p.g=c,L=S(U,E,!0,p)&&L,L=S(U,E,!1,p)&&L,g)for(Y=0;Y<g.length;Y++)U=p.g=g[Y],L=S(U,E,!1,p)&&L}ne.prototype.N=function(){if(ne.Z.N.call(this),this.i){var c=this.i;for(const p in c.g){const g=c.g[p];for(let E=0;E<g.length;E++)X(g[E]);delete c.g[p],c.h--}}this.G=null},ne.prototype.J=function(c,p,g,E){return this.i.add(String(c),p,!1,g,E)},ne.prototype.K=function(c,p,g,E){return this.i.add(String(c),p,!0,g,E)};function S(c,p,g,E){if(p=c.i.g[String(p)],!p)return!0;p=p.concat();let L=!0;for(let U=0;U<p.length;++U){const Y=p[U];if(Y&&!Y.da&&Y.capture==g){const Ae=Y.listener,bt=Y.ha||Y.src;Y.fa&&oe(c.i,Y),L=Ae.call(bt,E)!==!1&&L}}return L&&!E.defaultPrevented}function F(c,p){if(typeof c!="function")if(c&&typeof c.handleEvent=="function")c=d(c.handleEvent,c);else throw Error("Invalid listener argument");return Number(p)>2147483647?-1:o.setTimeout(c,p||0)}function G(c){c.g=F(()=>{c.g=null,c.i&&(c.i=!1,G(c))},c.l);const p=c.h;c.h=null,c.m.apply(null,p)}class ce extends k{constructor(p,g){super(),this.m=p,this.l=g,this.h=null,this.i=!1,this.g=null}j(p){this.h=arguments,this.g?this.i=!0:G(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function fe(c){k.call(this),this.h=c,this.g={}}f(fe,k);var Se=[];function be(c){de(c.g,function(p,g){this.g.hasOwnProperty(g)&&Pe(p)},c),c.g={}}fe.prototype.N=function(){fe.Z.N.call(this),be(this)},fe.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Fe=o.JSON.stringify,M=o.JSON.parse,K=class{stringify(c){return o.JSON.stringify(c,void 0)}parse(c){return o.JSON.parse(c,void 0)}};function se(){}function Te(){}var ot={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function Lt(){D.call(this,"d")}f(Lt,D);function On(){D.call(this,"c")}f(On,D);var Ht={},Xn=null;function pn(){return Xn=Xn||new ne}Ht.Ia="serverreachability";function kt(c){D.call(this,Ht.Ia,c)}f(kt,D);function Wt(c){const p=pn();ee(p,new kt(p))}Ht.STAT_EVENT="statevent";function rn(c,p){D.call(this,Ht.STAT_EVENT,c),this.stat=p}f(rn,D);function Be(c){const p=pn();ee(p,new rn(p,c))}Ht.Ja="timingevent";function Uc(c,p){D.call(this,Ht.Ja,c),this.size=p}f(Uc,D);function ri(c,p){if(typeof c!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){c()},p)}function jr(){this.g=!0}jr.prototype.ua=function(){this.g=!1};function pr(c,p,g,E,L,U){c.info(function(){if(c.g)if(U){var Y="",Ae=U.split("&");for(let Qe=0;Qe<Ae.length;Qe++){var bt=Ae[Qe].split("=");if(bt.length>1){const Nt=bt[0];bt=bt[1];const gr=Nt.split("_");Y=gr.length>=2&&gr[1]=="type"?Y+(Nt+"="+bt+"&"):Y+(Nt+"=redacted&")}}}else Y=null;else Y=U;return"XMLHTTP REQ ("+E+") [attempt "+L+"]: "+p+`
`+g+`
`+Y})}function DC(c,p,g,E,L,U,Y){c.info(function(){return"XMLHTTP RESP ("+E+") [ attempt "+L+"]: "+p+`
`+g+`
`+U+" "+Y})}function ao(c,p,g,E){c.info(function(){return"XMLHTTP TEXT ("+p+"): "+VC(c,g)+(E?" "+E:"")})}function jC(c,p){c.info(function(){return"TIMEOUT: "+p})}jr.prototype.info=function(){};function VC(c,p){if(!c.g)return p;if(!p)return null;try{const U=JSON.parse(p);if(U){for(c=0;c<U.length;c++)if(Array.isArray(U[c])){var g=U[c];if(!(g.length<2)){var E=g[1];if(Array.isArray(E)&&!(E.length<1)){var L=E[0];if(L!="noop"&&L!="stop"&&L!="close")for(let Y=1;Y<E.length;Y++)E[Y]=""}}}}return Fe(U)}catch{return p}}var Bc={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},P_={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},k_;function hf(){}f(hf,se),hf.prototype.g=function(){return new XMLHttpRequest},k_=new hf;function Da(c){return encodeURIComponent(String(c))}function OC(c){var p=1;c=c.split(":");const g=[];for(;p>0&&c.length;)g.push(c.shift()),p--;return c.length&&g.push(c.join(":")),g}function ii(c,p,g,E){this.j=c,this.i=p,this.l=g,this.S=E||1,this.V=new fe(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new N_}function N_(){this.i=null,this.g="",this.h=!1}var D_={},ff={};function pf(c,p,g){c.M=1,c.A=zc(mr(p)),c.u=g,c.R=!0,j_(c,null)}function j_(c,p){c.F=Date.now(),$c(c),c.B=mr(c.A);var g=c.B,E=c.S;Array.isArray(E)||(E=[String(E)]),K_(g.i,"t",E),c.C=0,g=c.j.L,c.h=new N_,c.g=dv(c.j,g?p:null,!c.u),c.P>0&&(c.O=new ce(d(c.Y,c,c.g),c.P)),p=c.V,g=c.g,E=c.ba;var L="readystatechange";Array.isArray(L)||(L&&(Se[0]=L.toString()),L=Se);for(let U=0;U<L.length;U++){const Y=ve(g,L[U],E||p.handleEvent,!1,p.h||p);if(!Y)break;p.g[Y.key]=Y}p=c.J?Ne(c.J):{},c.u?(c.v||(c.v="POST"),p["Content-Type"]="application/x-www-form-urlencoded",c.g.ea(c.B,c.v,c.u,p)):(c.v="GET",c.g.ea(c.B,c.v,null,p)),Wt(),pr(c.i,c.v,c.B,c.l,c.S,c.u)}ii.prototype.ba=function(c){c=c.target;const p=this.O;p&&ai(c)==3?p.j():this.Y(c)},ii.prototype.Y=function(c){try{if(c==this.g)e:{const Ae=ai(this.g),bt=this.g.ya(),Qe=this.g.ca();if(!(Ae<3)&&(Ae!=3||this.g&&(this.h.h||this.g.la()||ev(this.g)))){this.K||Ae!=4||bt==7||(bt==8||Qe<=0?Wt(3):Wt(2)),mf(this);var p=this.g.ca();this.X=p;var g=LC(this);if(this.o=p==200,DC(this.i,this.v,this.B,this.l,this.S,Ae,p),this.o){if(this.U&&!this.L){t:{if(this.g){var E,L=this.g;if((E=L.g?L.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!b(E)){var U=E;break t}}U=null}if(c=U)ao(this.i,this.l,c,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,gf(this,c);else{this.o=!1,this.m=3,Be(12),os(this),ja(this);break e}}if(this.R){c=!0;let Nt;for(;!this.K&&this.C<g.length;)if(Nt=MC(this,g),Nt==ff){Ae==4&&(this.m=4,Be(14),c=!1),ao(this.i,this.l,null,"[Incomplete Response]");break}else if(Nt==D_){this.m=4,Be(15),ao(this.i,this.l,g,"[Invalid Chunk]"),c=!1;break}else ao(this.i,this.l,Nt,null),gf(this,Nt);if(V_(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Ae!=4||g.length!=0||this.h.h||(this.m=1,Be(16),c=!1),this.o=this.o&&c,!c)ao(this.i,this.l,g,"[Invalid Chunked Response]"),os(this),ja(this);else if(g.length>0&&!this.W){this.W=!0;var Y=this.j;Y.g==this&&Y.aa&&!Y.P&&(Y.j.info("Great, no buffering proxy detected. Bytes received: "+g.length),xf(Y),Y.P=!0,Be(11))}}else ao(this.i,this.l,g,null),gf(this,g);Ae==4&&os(this),this.o&&!this.K&&(Ae==4?av(this.j,this):(this.o=!1,$c(this)))}else JC(this.g),p==400&&g.indexOf("Unknown SID")>0?(this.m=3,Be(12)):(this.m=0,Be(13)),os(this),ja(this)}}}catch{}finally{}};function LC(c){if(!V_(c))return c.g.la();const p=ev(c.g);if(p==="")return"";let g="";const E=p.length,L=ai(c.g)==4;if(!c.h.i){if(typeof TextDecoder>"u")return os(c),ja(c),"";c.h.i=new o.TextDecoder}for(let U=0;U<E;U++)c.h.h=!0,g+=c.h.i.decode(p[U],{stream:!(L&&U==E-1)});return p.length=0,c.h.g+=g,c.C=0,c.h.g}function V_(c){return c.g?c.v=="GET"&&c.M!=2&&c.j.Aa:!1}function MC(c,p){var g=c.C,E=p.indexOf(`
`,g);return E==-1?ff:(g=Number(p.substring(g,E)),isNaN(g)?D_:(E+=1,E+g>p.length?ff:(p=p.slice(E,E+g),c.C=E+g,p)))}ii.prototype.cancel=function(){this.K=!0,os(this)};function $c(c){c.T=Date.now()+c.H,O_(c,c.H)}function O_(c,p){if(c.D!=null)throw Error("WatchDog timer not null");c.D=ri(d(c.aa,c),p)}function mf(c){c.D&&(o.clearTimeout(c.D),c.D=null)}ii.prototype.aa=function(){this.D=null;const c=Date.now();c-this.T>=0?(jC(this.i,this.B),this.M!=2&&(Wt(),Be(17)),os(this),this.m=2,ja(this)):O_(this,this.T-c)};function ja(c){c.j.I==0||c.K||av(c.j,c)}function os(c){mf(c);var p=c.O;p&&typeof p.dispose=="function"&&p.dispose(),c.O=null,be(c.V),c.g&&(p=c.g,c.g=null,p.abort(),p.dispose())}function gf(c,p){try{var g=c.j;if(g.I!=0&&(g.g==c||yf(g.h,c))){if(!c.L&&yf(g.h,c)&&g.I==3){try{var E=g.Ba.g.parse(p)}catch{E=null}if(Array.isArray(E)&&E.length==3){var L=E;if(L[0]==0){e:if(!g.v){if(g.g)if(g.g.F+3e3<c.F)Gc(g),Wc(g);else break e;Tf(g),Be(18)}}else g.xa=L[1],0<g.xa-g.K&&L[2]<37500&&g.F&&g.A==0&&!g.C&&(g.C=ri(d(g.Va,g),6e3));F_(g.h)<=1&&g.ta&&(g.ta=void 0)}else ls(g,11)}else if((c.L||g.g==c)&&Gc(g),!b(p))for(L=g.Ba.g.parse(p),p=0;p<L.length;p++){let Qe=L[p];const Nt=Qe[0];if(!(Nt<=g.K))if(g.K=Nt,Qe=Qe[1],g.I==2)if(Qe[0]=="c"){g.M=Qe[1],g.ba=Qe[2];const gr=Qe[3];gr!=null&&(g.ka=gr,g.j.info("VER="+g.ka));const cs=Qe[4];cs!=null&&(g.za=cs,g.j.info("SVER="+g.za));const li=Qe[5];li!=null&&typeof li=="number"&&li>0&&(E=1.5*li,g.O=E,g.j.info("backChannelRequestTimeoutMs_="+E)),E=g;const ci=c.g;if(ci){const Yc=ci.g?ci.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Yc){var U=E.h;U.g||Yc.indexOf("spdy")==-1&&Yc.indexOf("quic")==-1&&Yc.indexOf("h2")==-1||(U.j=U.l,U.g=new Set,U.h&&(_f(U,U.h),U.h=null))}if(E.G){const Sf=ci.g?ci.g.getResponseHeader("X-HTTP-Session-Id"):null;Sf&&(E.wa=Sf,Xe(E.J,E.G,Sf))}}g.I=3,g.l&&g.l.ra(),g.aa&&(g.T=Date.now()-c.F,g.j.info("Handshake RTT: "+g.T+"ms")),E=g;var Y=c;if(E.na=uv(E,E.L?E.ba:null,E.W),Y.L){U_(E.h,Y);var Ae=Y,bt=E.O;bt&&(Ae.H=bt),Ae.D&&(mf(Ae),$c(Ae)),E.g=Y}else sv(E);g.i.length>0&&Kc(g)}else Qe[0]!="stop"&&Qe[0]!="close"||ls(g,7);else g.I==3&&(Qe[0]=="stop"||Qe[0]=="close"?Qe[0]=="stop"?ls(g,7):If(g):Qe[0]!="noop"&&g.l&&g.l.qa(Qe),g.A=0)}}Wt(4)}catch{}}var FC=class{constructor(c,p){this.g=c,this.map=p}};function L_(c){this.l=c||10,o.PerformanceNavigationTiming?(c=o.performance.getEntriesByType("navigation"),c=c.length>0&&(c[0].nextHopProtocol=="hq"||c[0].nextHopProtocol=="h2")):c=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=c?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function M_(c){return c.h?!0:c.g?c.g.size>=c.j:!1}function F_(c){return c.h?1:c.g?c.g.size:0}function yf(c,p){return c.h?c.h==p:c.g?c.g.has(p):!1}function _f(c,p){c.g?c.g.add(p):c.h=p}function U_(c,p){c.h&&c.h==p?c.h=null:c.g&&c.g.has(p)&&c.g.delete(p)}L_.prototype.cancel=function(){if(this.i=B_(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const c of this.g.values())c.cancel();this.g.clear()}};function B_(c){if(c.h!=null)return c.i.concat(c.h.G);if(c.g!=null&&c.g.size!==0){let p=c.i;for(const g of c.g.values())p=p.concat(g.G);return p}return v(c.i)}var $_=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function UC(c,p){if(c){c=c.split("&");for(let g=0;g<c.length;g++){const E=c[g].indexOf("=");let L,U=null;E>=0?(L=c[g].substring(0,E),U=c[g].substring(E+1)):L=c[g],p(L,U?decodeURIComponent(U.replace(/\+/g," ")):"")}}}function si(c){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let p;c instanceof si?(this.l=c.l,Va(this,c.j),this.o=c.o,this.g=c.g,Oa(this,c.u),this.h=c.h,vf(this,G_(c.i)),this.m=c.m):c&&(p=String(c).match($_))?(this.l=!1,Va(this,p[1]||"",!0),this.o=La(p[2]||""),this.g=La(p[3]||"",!0),Oa(this,p[4]),this.h=La(p[5]||"",!0),vf(this,p[6]||"",!0),this.m=La(p[7]||"")):(this.l=!1,this.i=new Fa(null,this.l))}si.prototype.toString=function(){const c=[];var p=this.j;p&&c.push(Ma(p,z_,!0),":");var g=this.g;return(g||p=="file")&&(c.push("//"),(p=this.o)&&c.push(Ma(p,z_,!0),"@"),c.push(Da(g).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),g=this.u,g!=null&&c.push(":",String(g))),(g=this.h)&&(this.g&&g.charAt(0)!="/"&&c.push("/"),c.push(Ma(g,g.charAt(0)=="/"?zC:$C,!0))),(g=this.i.toString())&&c.push("?",g),(g=this.m)&&c.push("#",Ma(g,HC)),c.join("")},si.prototype.resolve=function(c){const p=mr(this);let g=!!c.j;g?Va(p,c.j):g=!!c.o,g?p.o=c.o:g=!!c.g,g?p.g=c.g:g=c.u!=null;var E=c.h;if(g)Oa(p,c.u);else if(g=!!c.h){if(E.charAt(0)!="/")if(this.g&&!this.h)E="/"+E;else{var L=p.h.lastIndexOf("/");L!=-1&&(E=p.h.slice(0,L+1)+E)}if(L=E,L==".."||L==".")E="";else if(L.indexOf("./")!=-1||L.indexOf("/.")!=-1){E=L.lastIndexOf("/",0)==0,L=L.split("/");const U=[];for(let Y=0;Y<L.length;){const Ae=L[Y++];Ae=="."?E&&Y==L.length&&U.push(""):Ae==".."?((U.length>1||U.length==1&&U[0]!="")&&U.pop(),E&&Y==L.length&&U.push("")):(U.push(Ae),E=!0)}E=U.join("/")}else E=L}return g?p.h=E:g=c.i.toString()!=="",g?vf(p,G_(c.i)):g=!!c.m,g&&(p.m=c.m),p};function mr(c){return new si(c)}function Va(c,p,g){c.j=g?La(p,!0):p,c.j&&(c.j=c.j.replace(/:$/,""))}function Oa(c,p){if(p){if(p=Number(p),isNaN(p)||p<0)throw Error("Bad port number "+p);c.u=p}else c.u=null}function vf(c,p,g){p instanceof Fa?(c.i=p,WC(c.i,c.l)):(g||(p=Ma(p,qC)),c.i=new Fa(p,c.l))}function Xe(c,p,g){c.i.set(p,g)}function zc(c){return Xe(c,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),c}function La(c,p){return c?p?decodeURI(c.replace(/%25/g,"%2525")):decodeURIComponent(c):""}function Ma(c,p,g){return typeof c=="string"?(c=encodeURI(c).replace(p,BC),g&&(c=c.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),c):null}function BC(c){return c=c.charCodeAt(0),"%"+(c>>4&15).toString(16)+(c&15).toString(16)}var z_=/[#\/\?@]/g,$C=/[#\?:]/g,zC=/[#\?]/g,qC=/[#\?@]/g,HC=/#/g;function Fa(c,p){this.h=this.g=null,this.i=c||null,this.j=!!p}function as(c){c.g||(c.g=new Map,c.h=0,c.i&&UC(c.i,function(p,g){c.add(decodeURIComponent(p.replace(/\+/g," ")),g)}))}t=Fa.prototype,t.add=function(c,p){as(this),this.i=null,c=lo(this,c);let g=this.g.get(c);return g||this.g.set(c,g=[]),g.push(p),this.h+=1,this};function q_(c,p){as(c),p=lo(c,p),c.g.has(p)&&(c.i=null,c.h-=c.g.get(p).length,c.g.delete(p))}function H_(c,p){return as(c),p=lo(c,p),c.g.has(p)}t.forEach=function(c,p){as(this),this.g.forEach(function(g,E){g.forEach(function(L){c.call(p,L,E,this)},this)},this)};function W_(c,p){as(c);let g=[];if(typeof p=="string")H_(c,p)&&(g=g.concat(c.g.get(lo(c,p))));else for(c=Array.from(c.g.values()),p=0;p<c.length;p++)g=g.concat(c[p]);return g}t.set=function(c,p){return as(this),this.i=null,c=lo(this,c),H_(this,c)&&(this.h-=this.g.get(c).length),this.g.set(c,[p]),this.h+=1,this},t.get=function(c,p){return c?(c=W_(this,c),c.length>0?String(c[0]):p):p};function K_(c,p,g){q_(c,p),g.length>0&&(c.i=null,c.g.set(lo(c,p),v(g)),c.h+=g.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const c=[],p=Array.from(this.g.keys());for(let E=0;E<p.length;E++){var g=p[E];const L=Da(g);g=W_(this,g);for(let U=0;U<g.length;U++){let Y=L;g[U]!==""&&(Y+="="+Da(g[U])),c.push(Y)}}return this.i=c.join("&")};function G_(c){const p=new Fa;return p.i=c.i,c.g&&(p.g=new Map(c.g),p.h=c.h),p}function lo(c,p){return p=String(p),c.j&&(p=p.toLowerCase()),p}function WC(c,p){p&&!c.j&&(as(c),c.i=null,c.g.forEach(function(g,E){const L=E.toLowerCase();E!=L&&(q_(this,E),K_(this,L,g))},c)),c.j=p}function KC(c,p){const g=new jr;if(o.Image){const E=new Image;E.onload=h(oi,g,"TestLoadImage: loaded",!0,p,E),E.onerror=h(oi,g,"TestLoadImage: error",!1,p,E),E.onabort=h(oi,g,"TestLoadImage: abort",!1,p,E),E.ontimeout=h(oi,g,"TestLoadImage: timeout",!1,p,E),o.setTimeout(function(){E.ontimeout&&E.ontimeout()},1e4),E.src=c}else p(!1)}function GC(c,p){const g=new jr,E=new AbortController,L=setTimeout(()=>{E.abort(),oi(g,"TestPingServer: timeout",!1,p)},1e4);fetch(c,{signal:E.signal}).then(U=>{clearTimeout(L),U.ok?oi(g,"TestPingServer: ok",!0,p):oi(g,"TestPingServer: server error",!1,p)}).catch(()=>{clearTimeout(L),oi(g,"TestPingServer: error",!1,p)})}function oi(c,p,g,E,L){try{L&&(L.onload=null,L.onerror=null,L.onabort=null,L.ontimeout=null),E(g)}catch{}}function QC(){this.g=new K}function wf(c){this.i=c.Sb||null,this.h=c.ab||!1}f(wf,se),wf.prototype.g=function(){return new qc(this.i,this.h)};function qc(c,p){ne.call(this),this.H=c,this.o=p,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}f(qc,ne),t=qc.prototype,t.open=function(c,p){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=c,this.D=p,this.readyState=1,Ba(this)},t.send=function(c){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const p={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};c&&(p.body=c),(this.H||o).fetch(new Request(this.D,p)).then(this.Pa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,Ua(this)),this.readyState=0},t.Pa=function(c){if(this.g&&(this.l=c,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=c.headers,this.readyState=2,Ba(this)),this.g&&(this.readyState=3,Ba(this),this.g)))if(this.responseType==="arraybuffer")c.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in c){if(this.j=c.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;Q_(this)}else c.text().then(this.Oa.bind(this),this.ga.bind(this))};function Q_(c){c.j.read().then(c.Ma.bind(c)).catch(c.ga.bind(c))}t.Ma=function(c){if(this.g){if(this.o&&c.value)this.response.push(c.value);else if(!this.o){var p=c.value?c.value:new Uint8Array(0);(p=this.B.decode(p,{stream:!c.done}))&&(this.response=this.responseText+=p)}c.done?Ua(this):Ba(this),this.readyState==3&&Q_(this)}},t.Oa=function(c){this.g&&(this.response=this.responseText=c,Ua(this))},t.Na=function(c){this.g&&(this.response=c,Ua(this))},t.ga=function(){this.g&&Ua(this)};function Ua(c){c.readyState=4,c.l=null,c.j=null,c.B=null,Ba(c)}t.setRequestHeader=function(c,p){this.A.append(c,p)},t.getResponseHeader=function(c){return this.h&&this.h.get(c.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const c=[],p=this.h.entries();for(var g=p.next();!g.done;)g=g.value,c.push(g[0]+": "+g[1]),g=p.next();return c.join(`\r
`)};function Ba(c){c.onreadystatechange&&c.onreadystatechange.call(c)}Object.defineProperty(qc.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(c){this.m=c?"include":"same-origin"}});function Y_(c){let p="";return de(c,function(g,E){p+=E,p+=":",p+=g,p+=`\r
`}),p}function Ef(c,p,g){e:{for(E in g){var E=!1;break e}E=!0}E||(g=Y_(g),typeof c=="string"?g!=null&&Da(g):Xe(c,p,g))}function ht(c){ne.call(this),this.headers=new Map,this.L=c||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}f(ht,ne);var YC=/^https?$/i,XC=["POST","PUT"];t=ht.prototype,t.Fa=function(c){this.H=c},t.ea=function(c,p,g,E){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+c);p=p?p.toUpperCase():"GET",this.D=c,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():k_.g(),this.g.onreadystatechange=m(d(this.Ca,this));try{this.B=!0,this.g.open(p,String(c),!0),this.B=!1}catch(U){X_(this,U);return}if(c=g||"",g=new Map(this.headers),E)if(Object.getPrototypeOf(E)===Object.prototype)for(var L in E)g.set(L,E[L]);else if(typeof E.keys=="function"&&typeof E.get=="function")for(const U of E.keys())g.set(U,E.get(U));else throw Error("Unknown input type for opt_headers: "+String(E));E=Array.from(g.keys()).find(U=>U.toLowerCase()=="content-type"),L=o.FormData&&c instanceof o.FormData,!(Array.prototype.indexOf.call(XC,p,void 0)>=0)||E||L||g.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[U,Y]of g)this.g.setRequestHeader(U,Y);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(c),this.v=!1}catch(U){X_(this,U)}};function X_(c,p){c.h=!1,c.g&&(c.j=!0,c.g.abort(),c.j=!1),c.l=p,c.o=5,J_(c),Hc(c)}function J_(c){c.A||(c.A=!0,ee(c,"complete"),ee(c,"error"))}t.abort=function(c){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=c||7,ee(this,"complete"),ee(this,"abort"),Hc(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Hc(this,!0)),ht.Z.N.call(this)},t.Ca=function(){this.u||(this.B||this.v||this.j?Z_(this):this.Xa())},t.Xa=function(){Z_(this)};function Z_(c){if(c.h&&typeof s<"u"){if(c.v&&ai(c)==4)setTimeout(c.Ca.bind(c),0);else if(ee(c,"readystatechange"),ai(c)==4){c.h=!1;try{const U=c.ca();e:switch(U){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var p=!0;break e;default:p=!1}var g;if(!(g=p)){var E;if(E=U===0){let Y=String(c.D).match($_)[1]||null;!Y&&o.self&&o.self.location&&(Y=o.self.location.protocol.slice(0,-1)),E=!YC.test(Y?Y.toLowerCase():"")}g=E}if(g)ee(c,"complete"),ee(c,"success");else{c.o=6;try{var L=ai(c)>2?c.g.statusText:""}catch{L=""}c.l=L+" ["+c.ca()+"]",J_(c)}}finally{Hc(c)}}}}function Hc(c,p){if(c.g){c.m&&(clearTimeout(c.m),c.m=null);const g=c.g;c.g=null,p||ee(c,"ready");try{g.onreadystatechange=null}catch{}}}t.isActive=function(){return!!this.g};function ai(c){return c.g?c.g.readyState:0}t.ca=function(){try{return ai(this)>2?this.g.status:-1}catch{return-1}},t.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.La=function(c){if(this.g){var p=this.g.responseText;return c&&p.indexOf(c)==0&&(p=p.substring(c.length)),M(p)}};function ev(c){try{if(!c.g)return null;if("response"in c.g)return c.g.response;switch(c.F){case"":case"text":return c.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in c.g)return c.g.mozResponseArrayBuffer}return null}catch{return null}}function JC(c){const p={};c=(c.g&&ai(c)>=2&&c.g.getAllResponseHeaders()||"").split(`\r
`);for(let E=0;E<c.length;E++){if(b(c[E]))continue;var g=OC(c[E]);const L=g[0];if(g=g[1],typeof g!="string")continue;g=g.trim();const U=p[L]||[];p[L]=U,U.push(g)}me(p,function(E){return E.join(", ")})}t.ya=function(){return this.o},t.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function $a(c,p,g){return g&&g.internalChannelParams&&g.internalChannelParams[c]||p}function tv(c){this.za=0,this.i=[],this.j=new jr,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=$a("failFast",!1,c),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=$a("baseRetryDelayMs",5e3,c),this.Za=$a("retryDelaySeedMs",1e4,c),this.Ta=$a("forwardChannelMaxRetries",2,c),this.va=$a("forwardChannelRequestTimeoutMs",2e4,c),this.ma=c&&c.xmlHttpFactory||void 0,this.Ua=c&&c.Rb||void 0,this.Aa=c&&c.useFetchStreams||!1,this.O=void 0,this.L=c&&c.supportsCrossDomainXhr||!1,this.M="",this.h=new L_(c&&c.concurrentRequestLimit),this.Ba=new QC,this.S=c&&c.fastHandshake||!1,this.R=c&&c.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=c&&c.Pb||!1,c&&c.ua&&this.j.ua(),c&&c.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&c&&c.detectBufferingProxy||!1,this.ia=void 0,c&&c.longPollingTimeout&&c.longPollingTimeout>0&&(this.ia=c.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}t=tv.prototype,t.ka=8,t.I=1,t.connect=function(c,p,g,E){Be(0),this.W=c,this.H=p||{},g&&E!==void 0&&(this.H.OSID=g,this.H.OAID=E),this.F=this.X,this.J=uv(this,null,this.W),Kc(this)};function If(c){if(nv(c),c.I==3){var p=c.V++,g=mr(c.J);if(Xe(g,"SID",c.M),Xe(g,"RID",p),Xe(g,"TYPE","terminate"),za(c,g),p=new ii(c,c.j,p),p.M=2,p.A=zc(mr(g)),g=!1,o.navigator&&o.navigator.sendBeacon)try{g=o.navigator.sendBeacon(p.A.toString(),"")}catch{}!g&&o.Image&&(new Image().src=p.A,g=!0),g||(p.g=dv(p.j,null),p.g.ea(p.A)),p.F=Date.now(),$c(p)}cv(c)}function Wc(c){c.g&&(xf(c),c.g.cancel(),c.g=null)}function nv(c){Wc(c),c.v&&(o.clearTimeout(c.v),c.v=null),Gc(c),c.h.cancel(),c.m&&(typeof c.m=="number"&&o.clearTimeout(c.m),c.m=null)}function Kc(c){if(!M_(c.h)&&!c.m){c.m=!0;var p=c.Ea;O||w(),$||(O(),$=!0),x.add(p,c),c.D=0}}function ZC(c,p){return F_(c.h)>=c.h.j-(c.m?1:0)?!1:c.m?(c.i=p.G.concat(c.i),!0):c.I==1||c.I==2||c.D>=(c.Sa?0:c.Ta)?!1:(c.m=ri(d(c.Ea,c,p),lv(c,c.D)),c.D++,!0)}t.Ea=function(c){if(this.m)if(this.m=null,this.I==1){if(!c){this.V=Math.floor(Math.random()*1e5),c=this.V++;const L=new ii(this,this.j,c);let U=this.o;if(this.U&&(U?(U=Ne(U),z(U,this.U)):U=this.U),this.u!==null||this.R||(L.J=U,U=null),this.S)e:{for(var p=0,g=0;g<this.i.length;g++){t:{var E=this.i[g];if("__data__"in E.map&&(E=E.map.__data__,typeof E=="string")){E=E.length;break t}E=void 0}if(E===void 0)break;if(p+=E,p>4096){p=g;break e}if(p===4096||g===this.i.length-1){p=g+1;break e}}p=1e3}else p=1e3;p=iv(this,L,p),g=mr(this.J),Xe(g,"RID",c),Xe(g,"CVER",22),this.G&&Xe(g,"X-HTTP-Session-Id",this.G),za(this,g),U&&(this.R?p="headers="+Da(Y_(U))+"&"+p:this.u&&Ef(g,this.u,U)),_f(this.h,L),this.Ra&&Xe(g,"TYPE","init"),this.S?(Xe(g,"$req",p),Xe(g,"SID","null"),L.U=!0,pf(L,g,null)):pf(L,g,p),this.I=2}}else this.I==3&&(c?rv(this,c):this.i.length==0||M_(this.h)||rv(this))};function rv(c,p){var g;p?g=p.l:g=c.V++;const E=mr(c.J);Xe(E,"SID",c.M),Xe(E,"RID",g),Xe(E,"AID",c.K),za(c,E),c.u&&c.o&&Ef(E,c.u,c.o),g=new ii(c,c.j,g,c.D+1),c.u===null&&(g.J=c.o),p&&(c.i=p.G.concat(c.i)),p=iv(c,g,1e3),g.H=Math.round(c.va*.5)+Math.round(c.va*.5*Math.random()),_f(c.h,g),pf(g,E,p)}function za(c,p){c.H&&de(c.H,function(g,E){Xe(p,E,g)}),c.l&&de({},function(g,E){Xe(p,E,g)})}function iv(c,p,g){g=Math.min(c.i.length,g);const E=c.l?d(c.l.Ka,c.l,c):null;e:{var L=c.i;let Ae=-1;for(;;){const bt=["count="+g];Ae==-1?g>0?(Ae=L[0].g,bt.push("ofs="+Ae)):Ae=0:bt.push("ofs="+Ae);let Qe=!0;for(let Nt=0;Nt<g;Nt++){var U=L[Nt].g;const gr=L[Nt].map;if(U-=Ae,U<0)Ae=Math.max(0,L[Nt].g-100),Qe=!1;else try{U="req"+U+"_"||"";try{var Y=gr instanceof Map?gr:Object.entries(gr);for(const[cs,li]of Y){let ci=li;a(li)&&(ci=Fe(li)),bt.push(U+cs+"="+encodeURIComponent(ci))}}catch(cs){throw bt.push(U+"type="+encodeURIComponent("_badmap")),cs}}catch{E&&E(gr)}}if(Qe){Y=bt.join("&");break e}}Y=void 0}return c=c.i.splice(0,g),p.G=c,Y}function sv(c){if(!c.g&&!c.v){c.Y=1;var p=c.Da;O||w(),$||(O(),$=!0),x.add(p,c),c.A=0}}function Tf(c){return c.g||c.v||c.A>=3?!1:(c.Y++,c.v=ri(d(c.Da,c),lv(c,c.A)),c.A++,!0)}t.Da=function(){if(this.v=null,ov(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var c=4*this.T;this.j.info("BP detection timer enabled: "+c),this.B=ri(d(this.Wa,this),c)}},t.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,Be(10),Wc(this),ov(this))};function xf(c){c.B!=null&&(o.clearTimeout(c.B),c.B=null)}function ov(c){c.g=new ii(c,c.j,"rpc",c.Y),c.u===null&&(c.g.J=c.o),c.g.P=0;var p=mr(c.na);Xe(p,"RID","rpc"),Xe(p,"SID",c.M),Xe(p,"AID",c.K),Xe(p,"CI",c.F?"0":"1"),!c.F&&c.ia&&Xe(p,"TO",c.ia),Xe(p,"TYPE","xmlhttp"),za(c,p),c.u&&c.o&&Ef(p,c.u,c.o),c.O&&(c.g.H=c.O);var g=c.g;c=c.ba,g.M=1,g.A=zc(mr(p)),g.u=null,g.R=!0,j_(g,c)}t.Va=function(){this.C!=null&&(this.C=null,Wc(this),Tf(this),Be(19))};function Gc(c){c.C!=null&&(o.clearTimeout(c.C),c.C=null)}function av(c,p){var g=null;if(c.g==p){Gc(c),xf(c),c.g=null;var E=2}else if(yf(c.h,p))g=p.G,U_(c.h,p),E=1;else return;if(c.I!=0){if(p.o)if(E==1){g=p.u?p.u.length:0,p=Date.now()-p.F;var L=c.D;E=pn(),ee(E,new Uc(E,g)),Kc(c)}else sv(c);else if(L=p.m,L==3||L==0&&p.X>0||!(E==1&&ZC(c,p)||E==2&&Tf(c)))switch(g&&g.length>0&&(p=c.h,p.i=p.i.concat(g)),L){case 1:ls(c,5);break;case 4:ls(c,10);break;case 3:ls(c,6);break;default:ls(c,2)}}}function lv(c,p){let g=c.Qa+Math.floor(Math.random()*c.Za);return c.isActive()||(g*=2),g*p}function ls(c,p){if(c.j.info("Error code "+p),p==2){var g=d(c.bb,c),E=c.Ua;const L=!E;E=new si(E||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||Va(E,"https"),zc(E),L?KC(E.toString(),g):GC(E.toString(),g)}else Be(2);c.I=0,c.l&&c.l.pa(p),cv(c),nv(c)}t.bb=function(c){c?(this.j.info("Successfully pinged google.com"),Be(2)):(this.j.info("Failed to ping google.com"),Be(1))};function cv(c){if(c.I=0,c.ja=[],c.l){const p=B_(c.h);(p.length!=0||c.i.length!=0)&&(C(c.ja,p),C(c.ja,c.i),c.h.i.length=0,v(c.i),c.i.length=0),c.l.oa()}}function uv(c,p,g){var E=g instanceof si?mr(g):new si(g);if(E.g!="")p&&(E.g=p+"."+E.g),Oa(E,E.u);else{var L=o.location;E=L.protocol,p=p?p+"."+L.hostname:L.hostname,L=+L.port;const U=new si(null);E&&Va(U,E),p&&(U.g=p),L&&Oa(U,L),g&&(U.h=g),E=U}return g=c.G,p=c.wa,g&&p&&Xe(E,g,p),Xe(E,"VER",c.ka),za(c,E),E}function dv(c,p,g){if(p&&!c.L)throw Error("Can't create secondary domain capable XhrIo object.");return p=c.Aa&&!c.ma?new ht(new wf({ab:g})):new ht(c.ma),p.Fa(c.L),p}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function hv(){}t=hv.prototype,t.ra=function(){},t.qa=function(){},t.pa=function(){},t.oa=function(){},t.isActive=function(){return!0},t.Ka=function(){};function Qc(){}Qc.prototype.g=function(c,p){return new Tn(c,p)};function Tn(c,p){ne.call(this),this.g=new tv(p),this.l=c,this.h=p&&p.messageUrlParams||null,c=p&&p.messageHeaders||null,p&&p.clientProtocolHeaderRequired&&(c?c["X-Client-Protocol"]="webchannel":c={"X-Client-Protocol":"webchannel"}),this.g.o=c,c=p&&p.initMessageHeaders||null,p&&p.messageContentType&&(c?c["X-WebChannel-Content-Type"]=p.messageContentType:c={"X-WebChannel-Content-Type":p.messageContentType}),p&&p.sa&&(c?c["X-WebChannel-Client-Profile"]=p.sa:c={"X-WebChannel-Client-Profile":p.sa}),this.g.U=c,(c=p&&p.Qb)&&!b(c)&&(this.g.u=c),this.A=p&&p.supportsCrossDomainXhr||!1,this.v=p&&p.sendRawJson||!1,(p=p&&p.httpSessionIdParam)&&!b(p)&&(this.g.G=p,c=this.h,c!==null&&p in c&&(c=this.h,p in c&&delete c[p])),this.j=new co(this)}f(Tn,ne),Tn.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},Tn.prototype.close=function(){If(this.g)},Tn.prototype.o=function(c){var p=this.g;if(typeof c=="string"){var g={};g.__data__=c,c=g}else this.v&&(g={},g.__data__=Fe(c),c=g);p.i.push(new FC(p.Ya++,c)),p.I==3&&Kc(p)},Tn.prototype.N=function(){this.g.l=null,delete this.j,If(this.g),delete this.g,Tn.Z.N.call(this)};function fv(c){Lt.call(this),c.__headers__&&(this.headers=c.__headers__,this.statusCode=c.__status__,delete c.__headers__,delete c.__status__);var p=c.__sm__;if(p){e:{for(const g in p){c=g;break e}c=void 0}(this.i=c)&&(c=this.i,p=p!==null&&c in p?p[c]:void 0),this.data=p}else this.data=c}f(fv,Lt);function pv(){On.call(this),this.status=1}f(pv,On);function co(c){this.g=c}f(co,hv),co.prototype.ra=function(){ee(this.g,"a")},co.prototype.qa=function(c){ee(this.g,new fv(c))},co.prototype.pa=function(c){ee(this.g,new pv)},co.prototype.oa=function(){ee(this.g,"b")},Qc.prototype.createWebChannel=Qc.prototype.g,Tn.prototype.send=Tn.prototype.o,Tn.prototype.open=Tn.prototype.m,Tn.prototype.close=Tn.prototype.close,BS=function(){return new Qc},US=function(){return pn()},FS=Ht,Pm={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},Bc.NO_ERROR=0,Bc.TIMEOUT=8,Bc.HTTP_ERROR=6,Hu=Bc,P_.COMPLETE="complete",MS=P_,Te.EventType=ot,ot.OPEN="a",ot.CLOSE="b",ot.ERROR="c",ot.MESSAGE="d",ne.prototype.listen=ne.prototype.J,hl=Te,ht.prototype.listenOnce=ht.prototype.K,ht.prototype.getLastError=ht.prototype.Ha,ht.prototype.getLastErrorCode=ht.prototype.ya,ht.prototype.getStatus=ht.prototype.ca,ht.prototype.getResponseJson=ht.prototype.La,ht.prototype.getResponseText=ht.prototype.la,ht.prototype.send=ht.prototype.ea,ht.prototype.setWithCredentials=ht.prototype.Fa,LS=ht}).apply(typeof gu<"u"?gu:typeof self<"u"?self:typeof window<"u"?window:{});const cE="@firebase/firestore",uE="4.9.2";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ft{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Ft.UNAUTHENTICATED=new Ft(null),Ft.GOOGLE_CREDENTIALS=new Ft("google-credentials-uid"),Ft.FIRST_PARTY=new Ft("first-party-uid"),Ft.MOCK_USER=new Ft("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ca="12.3.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bs=new Sh("@firebase/firestore");function Io(){return Bs.logLevel}function q(t,...e){if(Bs.logLevel<=De.DEBUG){const n=e.map(vy);Bs.debug(`Firestore (${Ca}): ${t}`,...n)}}function an(t,...e){if(Bs.logLevel<=De.ERROR){const n=e.map(vy);Bs.error(`Firestore (${Ca}): ${t}`,...n)}}function $s(t,...e){if(Bs.logLevel<=De.WARN){const n=e.map(vy);Bs.warn(`Firestore (${Ca}): ${t}`,...n)}}function vy(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function le(t,e,n){let r="Unexpected state";typeof e=="string"?r=e:n=e,$S(t,r,n)}function $S(t,e,n){let r=`FIRESTORE (${Ca}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(n!==void 0)try{r+=" CONTEXT: "+JSON.stringify(n)}catch{r+=" CONTEXT: "+n}throw an(r),new Error(r)}function ue(t,e,n,r){let i="Unexpected state";typeof n=="string"?i=n:r=n,t||$S(e,i,r)}function _e(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const B={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class W extends Yn{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ar{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zS{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class q2{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(Ft.UNAUTHENTICATED))}shutdown(){}}class H2{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class W2{constructor(e){this.t=e,this.currentUser=Ft.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){ue(this.o===void 0,42304);let r=this.i;const i=l=>this.i!==r?(r=this.i,n(l)):Promise.resolve();let s=new ar;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new ar,e.enqueueRetryable(()=>i(this.currentUser))};const o=()=>{const l=s;e.enqueueRetryable(async()=>{await l.promise,await i(this.currentUser)})},a=l=>{q("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(l=>a(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?a(l):(q("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new ar)}},0),o()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(q("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(ue(typeof r.accessToken=="string",31837,{l:r}),new zS(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return ue(e===null||typeof e=="string",2055,{h:e}),new Ft(e)}}class K2{constructor(e,n,r){this.P=e,this.T=n,this.I=r,this.type="FirstParty",this.user=Ft.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class G2{constructor(e,n,r){this.P=e,this.T=n,this.I=r}getToken(){return Promise.resolve(new K2(this.P,this.T,this.I))}start(e,n){e.enqueueRetryable(()=>n(Ft.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class dE{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class Q2{constructor(e,n){this.V=n,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Un(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,n){ue(this.o===void 0,3512);const r=s=>{s.error!=null&&q("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const o=s.token!==this.m;return this.m=s.token,q("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};const i=s=>{q("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){const s=this.V.getImmediate({optional:!0});s?i(s):q("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new dE(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(ue(typeof n.token=="string",44558,{tokenResult:n}),this.m=n.token,new dE(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Y2(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wy{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const i=Y2(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<n&&(r+=e.charAt(i[s]%62))}return r}}function Ie(t,e){return t<e?-1:t>e?1:0}function km(t,e){const n=Math.min(t.length,e.length);for(let r=0;r<n;r++){const i=t.charAt(r),s=e.charAt(r);if(i!==s)return ap(i)===ap(s)?Ie(i,s):ap(i)?1:-1}return Ie(t.length,e.length)}const X2=55296,J2=57343;function ap(t){const e=t.charCodeAt(0);return e>=X2&&e<=J2}function aa(t,e,n){return t.length===e.length&&t.every((r,i)=>n(r,e[i]))}function qS(t){return t+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hE="__name__";class Er{constructor(e,n,r){n===void 0?n=0:n>e.length&&le(637,{offset:n,range:e.length}),r===void 0?r=e.length-n:r>e.length-n&&le(1746,{length:r,range:e.length-n}),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return Er.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof Er?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let i=0;i<r;i++){const s=Er.compareSegments(e.get(i),n.get(i));if(s!==0)return s}return Ie(e.length,n.length)}static compareSegments(e,n){const r=Er.isNumericId(e),i=Er.isNumericId(n);return r&&!i?-1:!r&&i?1:r&&i?Er.extractNumericId(e).compare(Er.extractNumericId(n)):km(e,n)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Ui.fromString(e.substring(4,e.length-2))}}class Me extends Er{construct(e,n,r){return new Me(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new W(B.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(i=>i.length>0))}return new Me(n)}static emptyPath(){return new Me([])}}const Z2=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class ct extends Er{construct(e,n,r){return new ct(e,n,r)}static isValidIdentifier(e){return Z2.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),ct.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===hE}static keyField(){return new ct([hE])}static fromServerFormat(e){const n=[];let r="",i=0;const s=()=>{if(r.length===0)throw new W(B.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let o=!1;for(;i<e.length;){const a=e[i];if(a==="\\"){if(i+1===e.length)throw new W(B.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[i+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new W(B.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=l,i+=2}else a==="`"?(o=!o,i++):a!=="."||o?(r+=a,i++):(s(),i++)}if(s(),o)throw new W(B.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new ct(n)}static emptyPath(){return new ct([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J{constructor(e){this.path=e}static fromPath(e){return new J(Me.fromString(e))}static fromName(e){return new J(Me.fromString(e).popFirst(5))}static empty(){return new J(Me.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Me.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return Me.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new J(new Me(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function HS(t,e,n){if(!n)throw new W(B.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function eV(t,e,n,r){if(e===!0&&r===!0)throw new W(B.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function fE(t){if(!J.isDocumentKey(t))throw new W(B.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function pE(t){if(J.isDocumentKey(t))throw new W(B.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function WS(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function kh(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":le(12329,{type:typeof t})}function en(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new W(B.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=kh(t);throw new W(B.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}function tV(t,e){if(e<=0)throw new W(B.INVALID_ARGUMENT,`Function ${t}() requires a positive number, but it was: ${e}.`)}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tt(t,e){const n={typeString:t};return e&&(n.value=e),n}function Ac(t,e){if(!WS(t))throw new W(B.INVALID_ARGUMENT,"JSON must be an object");let n;for(const r in e)if(e[r]){const i=e[r].typeString,s="value"in e[r]?{value:e[r].value}:void 0;if(!(r in t)){n=`JSON missing required field: '${r}'`;break}const o=t[r];if(i&&typeof o!==i){n=`JSON field '${r}' must be a ${i}.`;break}if(s!==void 0&&o!==s.value){n=`Expected '${r}' field to equal '${s.value}'`;break}}if(n)throw new W(B.INVALID_ARGUMENT,n);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mE=-62135596800,gE=1e6;class Oe{static now(){return Oe.fromMillis(Date.now())}static fromDate(e){return Oe.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor((e-1e3*n)*gE);return new Oe(n,r)}constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new W(B.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new W(B.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<mE)throw new W(B.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new W(B.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/gE}_compareTo(e){return this.seconds===e.seconds?Ie(this.nanoseconds,e.nanoseconds):Ie(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:Oe._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Ac(e,Oe._jsonSchema))return new Oe(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-mE;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}Oe._jsonSchemaVersion="firestore/timestamp/1.0",Oe._jsonSchema={type:Tt("string",Oe._jsonSchemaVersion),seconds:Tt("number"),nanoseconds:Tt("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pe{static fromTimestamp(e){return new pe(e)}static min(){return new pe(new Oe(0,0))}static max(){return new pe(new Oe(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sc=-1;class Od{constructor(e,n,r,i){this.indexId=e,this.collectionGroup=n,this.fields=r,this.indexState=i}}function Nm(t){return t.fields.find(e=>e.kind===2)}function ms(t){return t.fields.filter(e=>e.kind!==2)}Od.UNKNOWN_ID=-1;class Wu{constructor(e,n){this.fieldPath=e,this.kind=n}}class oc{constructor(e,n){this.sequenceNumber=e,this.offset=n}static empty(){return new oc(0,Dn.min())}}function nV(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,i=pe.fromTimestamp(r===1e9?new Oe(n+1,0):new Oe(n,r));return new Dn(i,J.empty(),e)}function KS(t){return new Dn(t.readTime,t.key,sc)}class Dn{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new Dn(pe.min(),J.empty(),sc)}static max(){return new Dn(pe.max(),J.empty(),sc)}}function Ey(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=J.comparator(t.documentKey,e.documentKey),n!==0?n:Ie(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GS="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class QS{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function so(t){if(t.code!==B.FAILED_PRECONDITION||t.message!==GS)throw t;q("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&le(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new V((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(n,s).next(r,i)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof V?n:V.resolve(n)}catch(n){return V.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):V.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):V.reject(n)}static resolve(e){return new V((n,r)=>{n(e)})}static reject(e){return new V((n,r)=>{r(e)})}static waitFor(e){return new V((n,r)=>{let i=0,s=0,o=!1;e.forEach(a=>{++i,a.next(()=>{++s,o&&s===i&&n()},l=>r(l))}),o=!0,s===i&&n()})}static or(e){let n=V.resolve(!1);for(const r of e)n=n.next(i=>i?V.resolve(i):r());return n}static forEach(e,n){const r=[];return e.forEach((i,s)=>{r.push(n.call(this,i,s))}),this.waitFor(r)}static mapArray(e,n){return new V((r,i)=>{const s=e.length,o=new Array(s);let a=0;for(let l=0;l<s;l++){const d=l;n(e[d]).next(h=>{o[d]=h,++a,a===s&&r(o)},h=>i(h))}})}static doWhile(e,n){return new V((r,i)=>{const s=()=>{e()===!0?n().next(()=>{s()},i):r()};s()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sn="SimpleDb";class Nh{static open(e,n,r,i){try{return new Nh(n,e.transaction(i,r))}catch(s){throw new Pl(n,s)}}constructor(e,n){this.action=e,this.transaction=n,this.aborted=!1,this.S=new ar,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{n.error?this.S.reject(new Pl(e,n.error)):this.S.resolve()},this.transaction.onerror=r=>{const i=Iy(r.target.error);this.S.reject(new Pl(e,i))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(q(Sn,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}C(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const n=this.transaction.objectStore(e);return new iV(n)}}class Bi{static delete(e){return q(Sn,"Removing database:",e),ys(Fx().indexedDB.deleteDatabase(e)).toPromise()}static v(){if(!ay())return!1;if(Bi.F())return!0;const e=Rt(),n=Bi.M(e),r=0<n&&n<10,i=YS(e),s=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||s)}static F(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)==null?void 0:e.__PRIVATE_USE_MOCK_PERSISTENCE)==="YES"}static O(e,n){return e.store(n)}static M(e){const n=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=n?n[1].split("_").slice(0,2).join("."):"-1";return Number(r)}constructor(e,n,r){this.name=e,this.version=n,this.N=r,this.B=null,Bi.M(Rt())===12.2&&an("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async L(e){return this.db||(q(Sn,"Opening database:",this.name),this.db=await new Promise((n,r)=>{const i=indexedDB.open(this.name,this.version);i.onsuccess=s=>{const o=s.target.result;n(o)},i.onblocked=()=>{r(new Pl(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=s=>{const o=s.target.error;o.name==="VersionError"?r(new W(B.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?r(new W(B.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):r(new Pl(e,o))},i.onupgradeneeded=s=>{q(Sn,'Database "'+this.name+'" requires upgrade from version:',s.oldVersion);const o=s.target.result;this.N.k(o,i.transaction,s.oldVersion,this.version).next(()=>{q(Sn,"Database upgrade to version "+this.version+" complete")})}})),this.q&&(this.db.onversionchange=n=>this.q(n)),this.db}$(e){this.q=e,this.db&&(this.db.onversionchange=n=>e(n))}async runTransaction(e,n,r,i){const s=n==="readonly";let o=0;for(;;){++o;try{this.db=await this.L(e);const a=Nh.open(this.db,e,s?"readonly":"readwrite",r),l=i(a).next(d=>(a.C(),d)).catch(d=>(a.abort(d),V.reject(d))).toPromise();return l.catch(()=>{}),await a.D,l}catch(a){const l=a,d=l.name!=="FirebaseError"&&o<3;if(q(Sn,"Transaction failed with error:",l.message,"Retrying:",d),this.close(),!d)return Promise.reject(l)}}}close(){this.db&&this.db.close(),this.db=void 0}}function YS(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}class rV{constructor(e){this.U=e,this.K=!1,this.W=null}get isDone(){return this.K}get G(){return this.W}set cursor(e){this.U=e}done(){this.K=!0}j(e){this.W=e}delete(){return ys(this.U.delete())}}class Pl extends W{constructor(e,n){super(B.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${n}`),this.name="IndexedDbTransactionError"}}function rs(t){return t.name==="IndexedDbTransactionError"}class iV{constructor(e){this.store=e}put(e,n){let r;return n!==void 0?(q(Sn,"PUT",this.store.name,e,n),r=this.store.put(n,e)):(q(Sn,"PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),ys(r)}add(e){return q(Sn,"ADD",this.store.name,e,e),ys(this.store.add(e))}get(e){return ys(this.store.get(e)).next(n=>(n===void 0&&(n=null),q(Sn,"GET",this.store.name,e,n),n))}delete(e){return q(Sn,"DELETE",this.store.name,e),ys(this.store.delete(e))}count(){return q(Sn,"COUNT",this.store.name),ys(this.store.count())}J(e,n){const r=this.options(e,n),i=r.index?this.store.index(r.index):this.store;if(typeof i.getAll=="function"){const s=i.getAll(r.range);return new V((o,a)=>{s.onerror=l=>{a(l.target.error)},s.onsuccess=l=>{o(l.target.result)}})}{const s=this.cursor(r),o=[];return this.H(s,(a,l)=>{o.push(l)}).next(()=>o)}}Y(e,n){const r=this.store.getAll(e,n===null?void 0:n);return new V((i,s)=>{r.onerror=o=>{s(o.target.error)},r.onsuccess=o=>{i(o.target.result)}})}Z(e,n){q(Sn,"DELETE ALL",this.store.name);const r=this.options(e,n);r.X=!1;const i=this.cursor(r);return this.H(i,(s,o,a)=>a.delete())}ee(e,n){let r;n?r=e:(r={},n=e);const i=this.cursor(r);return this.H(i,n)}te(e){const n=this.cursor({});return new V((r,i)=>{n.onerror=s=>{const o=Iy(s.target.error);i(o)},n.onsuccess=s=>{const o=s.target.result;o?e(o.primaryKey,o.value).next(a=>{a?o.continue():r()}):r()}})}H(e,n){const r=[];return new V((i,s)=>{e.onerror=o=>{s(o.target.error)},e.onsuccess=o=>{const a=o.target.result;if(!a)return void i();const l=new rV(a),d=n(a.primaryKey,a.value,l);if(d instanceof V){const h=d.catch(f=>(l.done(),V.reject(f)));r.push(h)}l.isDone?i():l.G===null?a.continue():a.continue(l.G)}}).next(()=>V.waitFor(r))}options(e,n){let r;return e!==void 0&&(typeof e=="string"?r=e:n=e),{index:r,range:n}}cursor(e){let n="next";if(e.reverse&&(n="prev"),e.index){const r=this.store.index(e.index);return e.X?r.openKeyCursor(e.range,n):r.openCursor(e.range,n)}return this.store.openCursor(e.range,n)}}function ys(t){return new V((e,n)=>{t.onsuccess=r=>{const i=r.target.result;e(i)},t.onerror=r=>{const i=Iy(r.target.error);n(i)}})}let yE=!1;function Iy(t){const e=Bi.M(Rt());if(e>=12.2&&e<13){const n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){const r=new W("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${n}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return yE||(yE=!0,setTimeout(()=>{throw r},0)),r}}return t}const kl="IndexBackfiller";class sV{constructor(e,n){this.asyncQueue=e,this.ne=n,this.task=null}start(){this.re(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}re(e){q(kl,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{const n=await this.ne.ie();q(kl,`Documents written: ${n}`)}catch(n){rs(n)?q(kl,"Ignoring IndexedDB error during index backfill: ",n):await so(n)}await this.re(6e4)})}}class oV{constructor(e,n){this.localStore=e,this.persistence=n}async ie(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",n=>this.se(n,e))}se(e,n){const r=new Set;let i=n,s=!0;return V.doWhile(()=>s===!0&&i>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(o!==null&&!r.has(o))return q(kl,`Processing collection: ${o}`),this.oe(e,o,i).next(a=>{i-=a,r.add(o)});s=!1})).next(()=>n-i)}oe(e,n,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,n).next(i=>this.localStore.localDocuments.getNextDocuments(e,n,i,r).next(s=>{const o=s.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this._e(i,s)).next(a=>(q(kl,`Updating offset: ${a}`),this.localStore.indexManager.updateCollectionGroup(e,n,a))).next(()=>o.size)}))}_e(e,n){let r=e;return n.changes.forEach((i,s)=>{const o=KS(s);Ey(o,r)>0&&(r=o)}),new Dn(r.readTime,r.documentKey,Math.max(n.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zn{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ae(r),this.ue=r=>n.writeSequenceNumber(r))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}zn.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rs=-1;function Dh(t){return t==null}function ac(t){return t===0&&1/t==-1/0}function aV(t){return typeof t=="number"&&Number.isInteger(t)&&!ac(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ld="";function tn(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=_E(e)),e=lV(t.get(n),e);return _E(e)}function lV(t,e){let n=e;const r=t.length;for(let i=0;i<r;i++){const s=t.charAt(i);switch(s){case"\0":n+="";break;case Ld:n+="";break;default:n+=s}}return n}function _E(t){return t+Ld+""}function Tr(t){const e=t.length;if(ue(e>=2,64408,{path:t}),e===2)return ue(t.charAt(0)===Ld&&t.charAt(1)==="",56145,{path:t}),Me.emptyPath();const n=e-2,r=[];let i="";for(let s=0;s<e;){const o=t.indexOf(Ld,s);switch((o<0||o>n)&&le(50515,{path:t}),t.charAt(o+1)){case"":const a=t.substring(s,o);let l;i.length===0?l=a:(i+=a,l=i,i=""),r.push(l);break;case"":i+=t.substring(s,o),i+="\0";break;case"":i+=t.substring(s,o+1);break;default:le(61167,{path:t})}s=o+2}return new Me(r)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gs="remoteDocuments",Cc="owner",ho="owner",lc="mutationQueues",cV="userId",tr="mutations",vE="batchId",Ss="userMutationsIndex",wE=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ku(t,e){return[t,tn(e)]}function XS(t,e,n){return[t,tn(e),n]}const uV={},la="documentMutations",Md="remoteDocumentsV14",dV=["prefixPath","collectionGroup","readTime","documentId"],Gu="documentKeyIndex",hV=["prefixPath","collectionGroup","documentId"],JS="collectionGroupIndex",fV=["collectionGroup","readTime","prefixPath","documentId"],cc="remoteDocumentGlobal",Dm="remoteDocumentGlobalKey",ca="targets",ZS="queryTargetsIndex",pV=["canonicalId","targetId"],ua="targetDocuments",mV=["targetId","path"],Ty="documentTargetsIndex",gV=["path","targetId"],Fd="targetGlobalKey",Ps="targetGlobal",uc="collectionParents",yV=["collectionId","parent"],da="clientMetadata",_V="clientId",jh="bundles",vV="bundleId",Vh="namedQueries",wV="name",xy="indexConfiguration",EV="indexId",jm="collectionGroupIndex",IV="collectionGroup",Nl="indexState",TV=["indexId","uid"],eb="sequenceNumberIndex",xV=["uid","sequenceNumber"],Dl="indexEntries",SV=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],tb="documentKeyIndex",bV=["indexId","uid","orderedDocumentKey"],Oh="documentOverlays",AV=["userId","collectionPath","documentId"],Vm="collectionPathOverlayIndex",CV=["userId","collectionPath","largestBatchId"],nb="collectionGroupOverlayIndex",RV=["userId","collectionGroup","largestBatchId"],Sy="globals",PV="name",rb=[lc,tr,la,gs,ca,Cc,Ps,ua,da,cc,uc,jh,Vh],kV=[...rb,Oh],ib=[lc,tr,la,Md,ca,Cc,Ps,ua,da,cc,uc,jh,Vh,Oh],sb=ib,by=[...sb,xy,Nl,Dl],NV=by,ob=[...by,Sy],DV=ob;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Om extends QS{constructor(e,n){super(),this.le=e,this.currentSequenceNumber=n}}function Pt(t,e){const n=_e(t);return Bi.O(n.le,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function EE(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function is(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function jV(t,e){const n=[];for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&n.push(e(t[r],r,t));return n}function ab(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class st{constructor(e,n){this.comparator=e,this.root=n||Ut.EMPTY}insert(e,n){return new st(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,Ut.BLACK,null,null))}remove(e){return new st(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Ut.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(e,r.key);if(i===0)return n+r.left.size;i<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new yu(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new yu(this.root,e,this.comparator,!1)}getReverseIterator(){return new yu(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new yu(this.root,e,this.comparator,!0)}}class yu{constructor(e,n,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=n?r(e.key,n):1,n&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Ut{constructor(e,n,r,i,s){this.key=e,this.value=n,this.color=r??Ut.RED,this.left=i??Ut.EMPTY,this.right=s??Ut.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,i,s){return new Ut(e??this.key,n??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let i=this;const s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,n,r),null):s===0?i.copy(null,n,null,null,null):i.copy(null,null,null,null,i.right.insert(e,n,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return Ut.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),n(e,i.key)===0){if(i.right.isEmpty())return Ut.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Ut.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Ut.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw le(43730,{key:this.key,value:this.value});if(this.right.isRed())throw le(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw le(27949);return e+(this.isRed()?0:1)}}Ut.EMPTY=null,Ut.RED=!0,Ut.BLACK=!1;Ut.EMPTY=new class{constructor(){this.size=0}get key(){throw le(57766)}get value(){throw le(16141)}get color(){throw le(16727)}get left(){throw le(29726)}get right(){throw le(36894)}copy(e,n,r,i,s){return this}insert(e,n,r){return new Ut(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ke{constructor(e){this.comparator=e,this.data=new st(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;n(i.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new IE(this.data.getIterator())}getIteratorFrom(e){return new IE(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof Ke)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const i=n.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new Ke(this.comparator);return n.data=e,n}}class IE{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function fo(t){return t.hasNext()?t.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _n{constructor(e){this.fields=e,e.sort(ct.comparator)}static empty(){return new _n([])}unionWith(e){let n=new Ke(ct.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new _n(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return aa(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lb extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xt{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new lb("Invalid base64 string: "+s):s}}(e);return new xt(n)}static fromUint8Array(e){const n=function(i){let s="";for(let o=0;o<i.length;++o)s+=String.fromCharCode(i[o]);return s}(e);return new xt(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Ie(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}xt.EMPTY_BYTE_STRING=new xt("");const VV=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Jr(t){if(ue(!!t,39018),typeof t=="string"){let e=0;const n=VV.exec(t);if(ue(!!n,46558,{timestamp:t}),n[1]){let i=n[1];i=(i+"000000000").substr(0,9),e=Number(i)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:nt(t.seconds),nanos:nt(t.nanos)}}function nt(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Zr(t){return typeof t=="string"?xt.fromBase64String(t):xt.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cb="server_timestamp",ub="__type__",db="__previous_value__",hb="__local_write_time__";function Lh(t){var n,r;return((r=(((n=t==null?void 0:t.mapValue)==null?void 0:n.fields)||{})[ub])==null?void 0:r.stringValue)===cb}function Mh(t){const e=t.mapValue.fields[db];return Lh(e)?Mh(e):e}function dc(t){const e=Jr(t.mapValue.fields[hb].timestampValue);return new Oe(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OV{constructor(e,n,r,i,s,o,a,l,d,h){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=l,this.useFetchStreams=d,this.isUsingEmulator=h}}const Ud="(default)";class zs{constructor(e,n){this.projectId=e,this.database=n||Ud}static empty(){return new zs("","")}get isDefaultDatabase(){return this.database===Ud}isEqual(e){return e instanceof zs&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ay="__type__",fb="__max__",Ci={mapValue:{fields:{__type__:{stringValue:fb}}}},Cy="__vector__",ha="value",Qu={nullValue:"NULL_VALUE"};function Hi(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Lh(t)?4:pb(t)?9007199254740991:Fh(t)?10:11:le(28295,{value:t})}function Nr(t,e){if(t===e)return!0;const n=Hi(t);if(n!==Hi(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return dc(t).isEqual(dc(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const o=Jr(i.timestampValue),a=Jr(s.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(i,s){return Zr(i.bytesValue).isEqual(Zr(s.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(i,s){return nt(i.geoPointValue.latitude)===nt(s.geoPointValue.latitude)&&nt(i.geoPointValue.longitude)===nt(s.geoPointValue.longitude)}(t,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return nt(i.integerValue)===nt(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const o=nt(i.doubleValue),a=nt(s.doubleValue);return o===a?ac(o)===ac(a):isNaN(o)&&isNaN(a)}return!1}(t,e);case 9:return aa(t.arrayValue.values||[],e.arrayValue.values||[],Nr);case 10:case 11:return function(i,s){const o=i.mapValue.fields||{},a=s.mapValue.fields||{};if(EE(o)!==EE(a))return!1;for(const l in o)if(o.hasOwnProperty(l)&&(a[l]===void 0||!Nr(o[l],a[l])))return!1;return!0}(t,e);default:return le(52216,{left:t})}}function hc(t,e){return(t.values||[]).find(n=>Nr(n,e))!==void 0}function Wi(t,e){if(t===e)return 0;const n=Hi(t),r=Hi(e);if(n!==r)return Ie(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return Ie(t.booleanValue,e.booleanValue);case 2:return function(s,o){const a=nt(s.integerValue||s.doubleValue),l=nt(o.integerValue||o.doubleValue);return a<l?-1:a>l?1:a===l?0:isNaN(a)?isNaN(l)?0:-1:1}(t,e);case 3:return TE(t.timestampValue,e.timestampValue);case 4:return TE(dc(t),dc(e));case 5:return km(t.stringValue,e.stringValue);case 6:return function(s,o){const a=Zr(s),l=Zr(o);return a.compareTo(l)}(t.bytesValue,e.bytesValue);case 7:return function(s,o){const a=s.split("/"),l=o.split("/");for(let d=0;d<a.length&&d<l.length;d++){const h=Ie(a[d],l[d]);if(h!==0)return h}return Ie(a.length,l.length)}(t.referenceValue,e.referenceValue);case 8:return function(s,o){const a=Ie(nt(s.latitude),nt(o.latitude));return a!==0?a:Ie(nt(s.longitude),nt(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return xE(t.arrayValue,e.arrayValue);case 10:return function(s,o){var m,v,C,y;const a=s.fields||{},l=o.fields||{},d=(m=a[ha])==null?void 0:m.arrayValue,h=(v=l[ha])==null?void 0:v.arrayValue,f=Ie(((C=d==null?void 0:d.values)==null?void 0:C.length)||0,((y=h==null?void 0:h.values)==null?void 0:y.length)||0);return f!==0?f:xE(d,h)}(t.mapValue,e.mapValue);case 11:return function(s,o){if(s===Ci.mapValue&&o===Ci.mapValue)return 0;if(s===Ci.mapValue)return 1;if(o===Ci.mapValue)return-1;const a=s.fields||{},l=Object.keys(a),d=o.fields||{},h=Object.keys(d);l.sort(),h.sort();for(let f=0;f<l.length&&f<h.length;++f){const m=km(l[f],h[f]);if(m!==0)return m;const v=Wi(a[l[f]],d[h[f]]);if(v!==0)return v}return Ie(l.length,h.length)}(t.mapValue,e.mapValue);default:throw le(23264,{he:n})}}function TE(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return Ie(t,e);const n=Jr(t),r=Jr(e),i=Ie(n.seconds,r.seconds);return i!==0?i:Ie(n.nanos,r.nanos)}function xE(t,e){const n=t.values||[],r=e.values||[];for(let i=0;i<n.length&&i<r.length;++i){const s=Wi(n[i],r[i]);if(s)return s}return Ie(n.length,r.length)}function fa(t){return Lm(t)}function Lm(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=Jr(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return Zr(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return J.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",i=!0;for(const s of n.values||[])i?i=!1:r+=",",r+=Lm(s);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let i="{",s=!0;for(const o of r)s?s=!1:i+=",",i+=`${o}:${Lm(n.fields[o])}`;return i+"}"}(t.mapValue):le(61005,{value:t})}function Yu(t){switch(Hi(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Mh(t);return e?16+Yu(e):16;case 5:return 2*t.stringValue.length;case 6:return Zr(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return function(r){return(r.values||[]).reduce((i,s)=>i+Yu(s),0)}(t.arrayValue);case 10:case 11:return function(r){let i=0;return is(r.fields,(s,o)=>{i+=s.length+Yu(o)}),i}(t.mapValue);default:throw le(13486,{value:t})}}function qs(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function Mm(t){return!!t&&"integerValue"in t}function fc(t){return!!t&&"arrayValue"in t}function SE(t){return!!t&&"nullValue"in t}function bE(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Xu(t){return!!t&&"mapValue"in t}function Fh(t){var n,r;return((r=(((n=t==null?void 0:t.mapValue)==null?void 0:n.fields)||{})[Ay])==null?void 0:r.stringValue)===Cy}function jl(t){if(t.geoPointValue)return{geoPointValue:{...t.geoPointValue}};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:{...t.timestampValue}};if(t.mapValue){const e={mapValue:{fields:{}}};return is(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=jl(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=jl(t.arrayValue.values[n]);return e}return{...t}}function pb(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===fb}const mb={mapValue:{fields:{[Ay]:{stringValue:Cy},[ha]:{arrayValue:{}}}}};function LV(t){return"nullValue"in t?Qu:"booleanValue"in t?{booleanValue:!1}:"integerValue"in t||"doubleValue"in t?{doubleValue:NaN}:"timestampValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in t?{stringValue:""}:"bytesValue"in t?{bytesValue:""}:"referenceValue"in t?qs(zs.empty(),J.empty()):"geoPointValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in t?{arrayValue:{}}:"mapValue"in t?Fh(t)?mb:{mapValue:{}}:le(35942,{value:t})}function MV(t){return"nullValue"in t?{booleanValue:!1}:"booleanValue"in t?{doubleValue:NaN}:"integerValue"in t||"doubleValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in t?{stringValue:""}:"stringValue"in t?{bytesValue:""}:"bytesValue"in t?qs(zs.empty(),J.empty()):"referenceValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in t?{arrayValue:{}}:"arrayValue"in t?mb:"mapValue"in t?Fh(t)?{mapValue:{}}:Ci:le(61959,{value:t})}function AE(t,e){const n=Wi(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?-1:!t.inclusive&&e.inclusive?1:0}function CE(t,e){const n=Wi(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?1:!t.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jt{constructor(e){this.value=e}static empty(){return new Jt({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!Xu(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=jl(n)}setAll(e){let n=ct.emptyPath(),r={},i=[];e.forEach((o,a)=>{if(!n.isImmediateParentOf(a)){const l=this.getFieldsMap(n);this.applyChanges(l,r,i),r={},i=[],n=a.popLast()}o?r[a.lastSegment()]=jl(o):i.push(a.lastSegment())});const s=this.getFieldsMap(n);this.applyChanges(s,r,i)}delete(e){const n=this.field(e.popLast());Xu(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return Nr(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=n.mapValue.fields[e.get(r)];Xu(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=i),n=i}return n.mapValue.fields}applyChanges(e,n,r){is(n,(i,s)=>e[i]=s);for(const i of r)delete e[i]}clone(){return new Jt(jl(this.value))}}function gb(t){const e=[];return is(t.fields,(n,r)=>{const i=new ct([n]);if(Xu(r)){const s=gb(r.mapValue).fields;if(s.length===0)e.push(i);else for(const o of s)e.push(i.child(o))}else e.push(i)}),new _n(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pt{constructor(e,n,r,i,s,o,a){this.key=e,this.documentType=n,this.version=r,this.readTime=i,this.createTime=s,this.data=o,this.documentState=a}static newInvalidDocument(e){return new pt(e,0,pe.min(),pe.min(),pe.min(),Jt.empty(),0)}static newFoundDocument(e,n,r,i){return new pt(e,1,n,pe.min(),r,i,0)}static newNoDocument(e,n){return new pt(e,2,n,pe.min(),pe.min(),Jt.empty(),0)}static newUnknownDocument(e,n){return new pt(e,3,n,pe.min(),pe.min(),Jt.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(pe.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Jt.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Jt.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=pe.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof pt&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new pt(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ki{constructor(e,n){this.position=e,this.inclusive=n}}function RE(t,e,n){let r=0;for(let i=0;i<t.position.length;i++){const s=e[i],o=t.position[i];if(s.field.isKeyField()?r=J.comparator(J.fromName(o.referenceValue),n.key):r=Wi(o,n.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function PE(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!Nr(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pc{constructor(e,n="asc"){this.field=e,this.dir=n}}function FV(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yb{}class je extends yb{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new UV(e,n,r):n==="array-contains"?new zV(e,r):n==="in"?new Tb(e,r):n==="not-in"?new qV(e,r):n==="array-contains-any"?new HV(e,r):new je(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new BV(e,r):new $V(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&n.nullValue===void 0&&this.matchesComparison(Wi(n,this.value)):n!==null&&Hi(this.value)===Hi(n)&&this.matchesComparison(Wi(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return le(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class He extends yb{constructor(e,n){super(),this.filters=e,this.op=n,this.Pe=null}static create(e,n){return new He(e,n)}matches(e){return pa(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function pa(t){return t.op==="and"}function Fm(t){return t.op==="or"}function Ry(t){return _b(t)&&pa(t)}function _b(t){for(const e of t.filters)if(e instanceof He)return!1;return!0}function Um(t){if(t instanceof je)return t.field.canonicalString()+t.op.toString()+fa(t.value);if(Ry(t))return t.filters.map(e=>Um(e)).join(",");{const e=t.filters.map(n=>Um(n)).join(",");return`${t.op}(${e})`}}function vb(t,e){return t instanceof je?function(r,i){return i instanceof je&&r.op===i.op&&r.field.isEqual(i.field)&&Nr(r.value,i.value)}(t,e):t instanceof He?function(r,i){return i instanceof He&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((s,o,a)=>s&&vb(o,i.filters[a]),!0):!1}(t,e):void le(19439)}function wb(t,e){const n=t.filters.concat(e);return He.create(n,t.op)}function Eb(t){return t instanceof je?function(n){return`${n.field.canonicalString()} ${n.op} ${fa(n.value)}`}(t):t instanceof He?function(n){return n.op.toString()+" {"+n.getFilters().map(Eb).join(" ,")+"}"}(t):"Filter"}class UV extends je{constructor(e,n,r){super(e,n,r),this.key=J.fromName(r.referenceValue)}matches(e){const n=J.comparator(e.key,this.key);return this.matchesComparison(n)}}class BV extends je{constructor(e,n){super(e,"in",n),this.keys=Ib("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class $V extends je{constructor(e,n){super(e,"not-in",n),this.keys=Ib("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function Ib(t,e){var n;return(((n=e.arrayValue)==null?void 0:n.values)||[]).map(r=>J.fromName(r.referenceValue))}class zV extends je{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return fc(n)&&hc(n.arrayValue,this.value)}}class Tb extends je{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&hc(this.value.arrayValue,n)}}class qV extends je{constructor(e,n){super(e,"not-in",n)}matches(e){if(hc(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&n.nullValue===void 0&&!hc(this.value.arrayValue,n)}}class HV extends je{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!fc(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>hc(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WV{constructor(e,n=null,r=[],i=[],s=null,o=null,a=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=o,this.endAt=a,this.Te=null}}function Bm(t,e=null,n=[],r=[],i=null,s=null,o=null){return new WV(t,e,n,r,i,s,o)}function Hs(t){const e=_e(t);if(e.Te===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>Um(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),Dh(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>fa(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>fa(r)).join(",")),e.Te=n}return e.Te}function Rc(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!FV(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!vb(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!PE(t.startAt,e.startAt)&&PE(t.endAt,e.endAt)}function Bd(t){return J.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}function $d(t,e){return t.filters.filter(n=>n instanceof je&&n.field.isEqual(e))}function kE(t,e,n){let r=Qu,i=!0;for(const s of $d(t,e)){let o=Qu,a=!0;switch(s.op){case"<":case"<=":o=LV(s.value);break;case"==":case"in":case">=":o=s.value;break;case">":o=s.value,a=!1;break;case"!=":case"not-in":o=Qu}AE({value:r,inclusive:i},{value:o,inclusive:a})<0&&(r=o,i=a)}if(n!==null){for(let s=0;s<t.orderBy.length;++s)if(t.orderBy[s].field.isEqual(e)){const o=n.position[s];AE({value:r,inclusive:i},{value:o,inclusive:n.inclusive})<0&&(r=o,i=n.inclusive);break}}return{value:r,inclusive:i}}function NE(t,e,n){let r=Ci,i=!0;for(const s of $d(t,e)){let o=Ci,a=!0;switch(s.op){case">=":case">":o=MV(s.value),a=!1;break;case"==":case"in":case"<=":o=s.value;break;case"<":o=s.value,a=!1;break;case"!=":case"not-in":o=Ci}CE({value:r,inclusive:i},{value:o,inclusive:a})>0&&(r=o,i=a)}if(n!==null){for(let s=0;s<t.orderBy.length;++s)if(t.orderBy[s].field.isEqual(e)){const o=n.position[s];CE({value:r,inclusive:i},{value:o,inclusive:n.inclusive})>0&&(r=o,i=n.inclusive);break}}return{value:r,inclusive:i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ss{constructor(e,n=null,r=[],i=[],s=null,o="F",a=null,l=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=o,this.startAt=a,this.endAt=l,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function KV(t,e,n,r,i,s,o,a){return new ss(t,e,n,r,i,s,o,a)}function Pc(t){return new ss(t)}function DE(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function Py(t){return t.collectionGroup!==null}function Go(t){const e=_e(t);if(e.Ie===null){e.Ie=[];const n=new Set;for(const s of e.explicitOrderBy)e.Ie.push(s),n.add(s.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new Ke(ct.comparator);return o.filters.forEach(l=>{l.getFlattenedFilters().forEach(d=>{d.isInequality()&&(a=a.add(d.field))})}),a})(e).forEach(s=>{n.has(s.canonicalString())||s.isKeyField()||e.Ie.push(new pc(s,r))}),n.has(ct.keyField().canonicalString())||e.Ie.push(new pc(ct.keyField(),r))}return e.Ie}function Hn(t){const e=_e(t);return e.Ee||(e.Ee=xb(e,Go(t))),e.Ee}function GV(t){const e=_e(t);return e.de||(e.de=xb(e,t.explicitOrderBy)),e.de}function xb(t,e){if(t.limitType==="F")return Bm(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(i=>{const s=i.dir==="desc"?"asc":"desc";return new pc(i.field,s)});const n=t.endAt?new Ki(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new Ki(t.startAt.position,t.startAt.inclusive):null;return Bm(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function $m(t,e){const n=t.filters.concat([e]);return new ss(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function zd(t,e,n){return new ss(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Uh(t,e){return Rc(Hn(t),Hn(e))&&t.limitType===e.limitType}function Sb(t){return`${Hs(Hn(t))}|lt:${t.limitType}`}function To(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(i=>Eb(i)).join(", ")}]`),Dh(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(i=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(i)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(i=>fa(i)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(i=>fa(i)).join(",")),`Target(${r})`}(Hn(t))}; limitType=${t.limitType})`}function kc(t,e){return e.isFoundDocument()&&function(r,i){const s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):J.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)}(t,e)&&function(r,i){for(const s of Go(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(t,e)&&function(r,i){for(const s of r.filters)if(!s.matches(i))return!1;return!0}(t,e)&&function(r,i){return!(r.startAt&&!function(o,a,l){const d=RE(o,a,l);return o.inclusive?d<=0:d<0}(r.startAt,Go(r),i)||r.endAt&&!function(o,a,l){const d=RE(o,a,l);return o.inclusive?d>=0:d>0}(r.endAt,Go(r),i))}(t,e)}function QV(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function bb(t){return(e,n)=>{let r=!1;for(const i of Go(t)){const s=YV(i,e,n);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function YV(t,e,n){const r=t.field.isKeyField()?J.comparator(e.key,n.key):function(s,o,a){const l=o.data.field(s),d=a.data.field(s);return l!==null&&d!==null?Wi(l,d):le(42886)}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return le(19790,{direction:t.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ti{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,n]);i.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[n]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){is(this.inner,(n,r)=>{for(const[i,s]of r)e(i,s)})}isEmpty(){return ab(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XV=new st(J.comparator);function Rn(){return XV}const Ab=new st(J.comparator);function fl(...t){let e=Ab;for(const n of t)e=e.insert(n.key,n);return e}function Cb(t){let e=Ab;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function xr(){return Vl()}function Rb(){return Vl()}function Vl(){return new ti(t=>t.toString(),(t,e)=>t.isEqual(e))}const JV=new st(J.comparator),ZV=new Ke(J.comparator);function Ce(...t){let e=ZV;for(const n of t)e=e.add(n);return e}const eO=new Ke(Ie);function tO(){return eO}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ky(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:ac(e)?"-0":e}}function Pb(t){return{integerValue:""+t}}function kb(t,e){return aV(e)?Pb(e):ky(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bh{constructor(){this._=void 0}}function nO(t,e,n){return t instanceof ma?function(i,s){const o={fields:{[ub]:{stringValue:cb},[hb]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&Lh(s)&&(s=Mh(s)),s&&(o.fields[db]=s),{mapValue:o}}(n,e):t instanceof Ws?Db(t,e):t instanceof ga?jb(t,e):function(i,s){const o=Nb(i,s),a=jE(o)+jE(i.Ae);return Mm(o)&&Mm(i.Ae)?Pb(a):ky(i.serializer,a)}(t,e)}function rO(t,e,n){return t instanceof Ws?Db(t,e):t instanceof ga?jb(t,e):n}function Nb(t,e){return t instanceof ya?function(r){return Mm(r)||function(s){return!!s&&"doubleValue"in s}(r)}(e)?e:{integerValue:0}:null}class ma extends Bh{}class Ws extends Bh{constructor(e){super(),this.elements=e}}function Db(t,e){const n=Vb(e);for(const r of t.elements)n.some(i=>Nr(i,r))||n.push(r);return{arrayValue:{values:n}}}class ga extends Bh{constructor(e){super(),this.elements=e}}function jb(t,e){let n=Vb(e);for(const r of t.elements)n=n.filter(i=>!Nr(i,r));return{arrayValue:{values:n}}}class ya extends Bh{constructor(e,n){super(),this.serializer=e,this.Ae=n}}function jE(t){return nt(t.integerValue||t.doubleValue)}function Vb(t){return fc(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $h{constructor(e,n){this.field=e,this.transform=n}}function iO(t,e){return t.field.isEqual(e.field)&&function(r,i){return r instanceof Ws&&i instanceof Ws||r instanceof ga&&i instanceof ga?aa(r.elements,i.elements,Nr):r instanceof ya&&i instanceof ya?Nr(r.Ae,i.Ae):r instanceof ma&&i instanceof ma}(t.transform,e.transform)}class sO{constructor(e,n){this.version=e,this.transformResults=n}}class Zt{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new Zt}static exists(e){return new Zt(void 0,e)}static updateTime(e){return new Zt(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Ju(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class zh{}function Ob(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new qh(t.key,Zt.none()):new Ra(t.key,t.data,Zt.none());{const n=t.data,r=Jt.empty();let i=new Ke(ct.comparator);for(let s of e.fields)if(!i.has(s)){let o=n.field(s);o===null&&s.length>1&&(s=s.popLast(),o=n.field(s)),o===null?r.delete(s):r.set(s,o),i=i.add(s)}return new ni(t.key,r,new _n(i.toArray()),Zt.none())}}function oO(t,e,n){t instanceof Ra?function(i,s,o){const a=i.value.clone(),l=OE(i.fieldTransforms,s,o.transformResults);a.setAll(l),s.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(t,e,n):t instanceof ni?function(i,s,o){if(!Ju(i.precondition,s))return void s.convertToUnknownDocument(o.version);const a=OE(i.fieldTransforms,s,o.transformResults),l=s.data;l.setAll(Lb(i)),l.setAll(a),s.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(t,e,n):function(i,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,n)}function Ol(t,e,n,r){return t instanceof Ra?function(s,o,a,l){if(!Ju(s.precondition,o))return a;const d=s.value.clone(),h=LE(s.fieldTransforms,l,o);return d.setAll(h),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),null}(t,e,n,r):t instanceof ni?function(s,o,a,l){if(!Ju(s.precondition,o))return a;const d=LE(s.fieldTransforms,l,o),h=o.data;return h.setAll(Lb(s)),h.setAll(d),o.convertToFoundDocument(o.version,h).setHasLocalMutations(),a===null?null:a.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(f=>f.field))}(t,e,n,r):function(s,o,a){return Ju(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(t,e,n)}function aO(t,e){let n=null;for(const r of t.fieldTransforms){const i=e.data.field(r.field),s=Nb(r.transform,i||null);s!=null&&(n===null&&(n=Jt.empty()),n.set(r.field,s))}return n||null}function VE(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&aa(r,i,(s,o)=>iO(s,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class Ra extends zh{constructor(e,n,r,i=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class ni extends zh{constructor(e,n,r,i,s=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function Lb(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function OE(t,e,n){const r=new Map;ue(t.length===n.length,32656,{Re:n.length,Ve:t.length});for(let i=0;i<n.length;i++){const s=t[i],o=s.transform,a=e.data.field(s.field);r.set(s.field,rO(o,a,n[i]))}return r}function LE(t,e,n){const r=new Map;for(const i of t){const s=i.transform,o=n.data.field(i.field);r.set(i.field,nO(s,o,e))}return r}class qh extends zh{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Mb extends zh{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ny{constructor(e,n,r,i){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(e.key)&&oO(s,e,r[i])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=Ol(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=Ol(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=Rb();return this.mutations.forEach(i=>{const s=e.get(i.key),o=s.overlayedDocument;let a=this.applyToLocalView(o,s.mutatedFields);a=n.has(i.key)?null:a;const l=Ob(o,a);l!==null&&r.set(i.key,l),o.isValidDocument()||o.convertToNoDocument(pe.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),Ce())}isEqual(e){return this.batchId===e.batchId&&aa(this.mutations,e.mutations,(n,r)=>VE(n,r))&&aa(this.baseMutations,e.baseMutations,(n,r)=>VE(n,r))}}class Dy{constructor(e,n,r,i){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=i}static from(e,n,r){ue(e.mutations.length===r.length,58842,{me:e.mutations.length,fe:r.length});let i=function(){return JV}();const s=e.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,r[o].version);return new Dy(e,n,r,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jy{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lO{constructor(e,n,r){this.alias=e,this.aggregateType=n,this.fieldPath=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cO{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Et,Ve;function uO(t){switch(t){case B.OK:return le(64938);case B.CANCELLED:case B.UNKNOWN:case B.DEADLINE_EXCEEDED:case B.RESOURCE_EXHAUSTED:case B.INTERNAL:case B.UNAVAILABLE:case B.UNAUTHENTICATED:return!1;case B.INVALID_ARGUMENT:case B.NOT_FOUND:case B.ALREADY_EXISTS:case B.PERMISSION_DENIED:case B.FAILED_PRECONDITION:case B.ABORTED:case B.OUT_OF_RANGE:case B.UNIMPLEMENTED:case B.DATA_LOSS:return!0;default:return le(15467,{code:t})}}function Fb(t){if(t===void 0)return an("GRPC error has no .code"),B.UNKNOWN;switch(t){case Et.OK:return B.OK;case Et.CANCELLED:return B.CANCELLED;case Et.UNKNOWN:return B.UNKNOWN;case Et.DEADLINE_EXCEEDED:return B.DEADLINE_EXCEEDED;case Et.RESOURCE_EXHAUSTED:return B.RESOURCE_EXHAUSTED;case Et.INTERNAL:return B.INTERNAL;case Et.UNAVAILABLE:return B.UNAVAILABLE;case Et.UNAUTHENTICATED:return B.UNAUTHENTICATED;case Et.INVALID_ARGUMENT:return B.INVALID_ARGUMENT;case Et.NOT_FOUND:return B.NOT_FOUND;case Et.ALREADY_EXISTS:return B.ALREADY_EXISTS;case Et.PERMISSION_DENIED:return B.PERMISSION_DENIED;case Et.FAILED_PRECONDITION:return B.FAILED_PRECONDITION;case Et.ABORTED:return B.ABORTED;case Et.OUT_OF_RANGE:return B.OUT_OF_RANGE;case Et.UNIMPLEMENTED:return B.UNIMPLEMENTED;case Et.DATA_LOSS:return B.DATA_LOSS;default:return le(39323,{code:t})}}(Ve=Et||(Et={}))[Ve.OK=0]="OK",Ve[Ve.CANCELLED=1]="CANCELLED",Ve[Ve.UNKNOWN=2]="UNKNOWN",Ve[Ve.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ve[Ve.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ve[Ve.NOT_FOUND=5]="NOT_FOUND",Ve[Ve.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ve[Ve.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ve[Ve.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ve[Ve.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ve[Ve.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ve[Ve.ABORTED=10]="ABORTED",Ve[Ve.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ve[Ve.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ve[Ve.INTERNAL=13]="INTERNAL",Ve[Ve.UNAVAILABLE=14]="UNAVAILABLE",Ve[Ve.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dO(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hO=new Ui([4294967295,4294967295],0);function ME(t){const e=dO().encode(t),n=new OS;return n.update(e),new Uint8Array(n.digest())}function FE(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new Ui([n,r],0),new Ui([i,s],0)]}class Vy{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new pl(`Invalid padding: ${n}`);if(r<0)throw new pl(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new pl(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new pl(`Invalid padding when bitmap length is 0: ${n}`);this.ge=8*e.length-n,this.pe=Ui.fromNumber(this.ge)}ye(e,n,r){let i=e.add(n.multiply(Ui.fromNumber(r)));return i.compare(hO)===1&&(i=new Ui([i.getBits(0),i.getBits(1)],0)),i.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const n=ME(e),[r,i]=FE(n);for(let s=0;s<this.hashCount;s++){const o=this.ye(r,i,s);if(!this.we(o))return!1}return!0}static create(e,n,r){const i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new Vy(s,i,n);return r.forEach(a=>o.insert(a)),o}insert(e){if(this.ge===0)return;const n=ME(e),[r,i]=FE(n);for(let s=0;s<this.hashCount;s++){const o=this.ye(r,i,s);this.Se(o)}}Se(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class pl extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hh{constructor(e,n,r,i,s){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const i=new Map;return i.set(e,Nc.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new Hh(pe.min(),i,new st(Ie),Rn(),Ce())}}class Nc{constructor(e,n,r,i,s){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new Nc(r,n,Ce(),Ce(),Ce())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zu{constructor(e,n,r,i){this.be=e,this.removedTargetIds=n,this.key=r,this.De=i}}class Ub{constructor(e,n){this.targetId=e,this.Ce=n}}class Bb{constructor(e,n,r=xt.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=i}}class UE{constructor(){this.ve=0,this.Fe=BE(),this.Me=xt.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=Ce(),n=Ce(),r=Ce();return this.Fe.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:n=n.add(i);break;case 1:r=r.add(i);break;default:le(38017,{changeType:s})}}),new Nc(this.Me,this.xe,e,n,r)}qe(){this.Oe=!1,this.Fe=BE()}Qe(e,n){this.Oe=!0,this.Fe=this.Fe.insert(e,n)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,ue(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class fO{constructor(e){this.Ge=e,this.ze=new Map,this.je=Rn(),this.Je=_u(),this.He=_u(),this.Ye=new st(Ie)}Ze(e){for(const n of e.be)e.De&&e.De.isFoundDocument()?this.Xe(n,e.De):this.et(n,e.key,e.De);for(const n of e.removedTargetIds)this.et(n,e.key,e.De)}tt(e){this.forEachTarget(e,n=>{const r=this.nt(n);switch(e.state){case 0:this.rt(n)&&r.Le(e.resumeToken);break;case 1:r.Ke(),r.Ne||r.qe(),r.Le(e.resumeToken);break;case 2:r.Ke(),r.Ne||this.removeTarget(n);break;case 3:this.rt(n)&&(r.We(),r.Le(e.resumeToken));break;case 4:this.rt(n)&&(this.it(n),r.Le(e.resumeToken));break;default:le(56790,{state:e.state})}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.ze.forEach((r,i)=>{this.rt(i)&&n(i)})}st(e){const n=e.targetId,r=e.Ce.count,i=this.ot(n);if(i){const s=i.target;if(Bd(s))if(r===0){const o=new J(s.path);this.et(n,o,pt.newNoDocument(o,pe.min()))}else ue(r===1,20013,{expectedCount:r});else{const o=this._t(n);if(o!==r){const a=this.ut(e),l=a?this.ct(a,e,o):1;if(l!==0){this.it(n);const d=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(n,d)}}}}}ut(e){const n=e.Ce.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=n;let o,a;try{o=Zr(r).toUint8Array()}catch(l){if(l instanceof lb)return $s("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{a=new Vy(o,i,s)}catch(l){return $s(l instanceof pl?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return a.ge===0?null:a}ct(e,n,r){return n.Ce.count===r-this.Pt(e,n.targetId)?0:2}Pt(e,n){const r=this.Ge.getRemoteKeysForTarget(n);let i=0;return r.forEach(s=>{const o=this.Ge.ht(),a=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(a)||(this.et(n,s,null),i++)}),i}Tt(e){const n=new Map;this.ze.forEach((s,o)=>{const a=this.ot(o);if(a){if(s.current&&Bd(a.target)){const l=new J(a.target.path);this.It(l).has(o)||this.Et(o,l)||this.et(o,l,pt.newNoDocument(l,e))}s.Be&&(n.set(o,s.ke()),s.qe())}});let r=Ce();this.He.forEach((s,o)=>{let a=!0;o.forEachWhile(l=>{const d=this.ot(l);return!d||d.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(s))}),this.je.forEach((s,o)=>o.setReadTime(e));const i=new Hh(e,n,this.Ye,this.je,r);return this.je=Rn(),this.Je=_u(),this.He=_u(),this.Ye=new st(Ie),i}Xe(e,n){if(!this.rt(e))return;const r=this.Et(e,n.key)?2:0;this.nt(e).Qe(n.key,r),this.je=this.je.insert(n.key,n),this.Je=this.Je.insert(n.key,this.It(n.key).add(e)),this.He=this.He.insert(n.key,this.dt(n.key).add(e))}et(e,n,r){if(!this.rt(e))return;const i=this.nt(e);this.Et(e,n)?i.Qe(n,1):i.$e(n),this.He=this.He.insert(n,this.dt(n).delete(e)),this.He=this.He.insert(n,this.dt(n).add(e)),r&&(this.je=this.je.insert(n,r))}removeTarget(e){this.ze.delete(e)}_t(e){const n=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let n=this.ze.get(e);return n||(n=new UE,this.ze.set(e,n)),n}dt(e){let n=this.He.get(e);return n||(n=new Ke(Ie),this.He=this.He.insert(e,n)),n}It(e){let n=this.Je.get(e);return n||(n=new Ke(Ie),this.Je=this.Je.insert(e,n)),n}rt(e){const n=this.ot(e)!==null;return n||q("WatchChangeAggregator","Detected inactive target",e),n}ot(e){const n=this.ze.get(e);return n&&n.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new UE),this.Ge.getRemoteKeysForTarget(e).forEach(n=>{this.et(e,n,null)})}Et(e,n){return this.Ge.getRemoteKeysForTarget(e).has(n)}}function _u(){return new st(J.comparator)}function BE(){return new st(J.comparator)}const pO={asc:"ASCENDING",desc:"DESCENDING"},mO={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},gO={and:"AND",or:"OR"};class yO{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function zm(t,e){return t.useProto3Json||Dh(e)?e:{value:e}}function _a(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function $b(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function _O(t,e){return _a(t,e.toTimestamp())}function un(t){return ue(!!t,49232),pe.fromTimestamp(function(n){const r=Jr(n);return new Oe(r.seconds,r.nanos)}(t))}function Oy(t,e){return qm(t,e).canonicalString()}function qm(t,e){const n=function(i){return new Me(["projects",i.projectId,"databases",i.database])}(t).child("documents");return e===void 0?n:n.child(e)}function zb(t){const e=Me.fromString(t);return ue(Xb(e),10190,{key:e.toString()}),e}function qd(t,e){return Oy(t.databaseId,e.path)}function ks(t,e){const n=zb(e);if(n.get(1)!==t.databaseId.projectId)throw new W(B.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new W(B.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new J(Wb(n))}function qb(t,e){return Oy(t.databaseId,e)}function Hb(t){const e=zb(t);return e.length===4?Me.emptyPath():Wb(e)}function Hm(t){return new Me(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function Wb(t){return ue(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function $E(t,e,n){return{name:qd(t,e),fields:n.value.mapValue.fields}}function vO(t,e,n){const r=ks(t,e.name),i=un(e.updateTime),s=e.createTime?un(e.createTime):pe.min(),o=new Jt({mapValue:{fields:e.fields}}),a=pt.newFoundDocument(r,i,s,o);return n&&a.setHasCommittedMutations(),n?a.setHasCommittedMutations():a}function wO(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(d){return d==="NO_CHANGE"?0:d==="ADD"?1:d==="REMOVE"?2:d==="CURRENT"?3:d==="RESET"?4:le(39313,{state:d})}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(d,h){return d.useProto3Json?(ue(h===void 0||typeof h=="string",58123),xt.fromBase64String(h||"")):(ue(h===void 0||h instanceof Buffer||h instanceof Uint8Array,16193),xt.fromUint8Array(h||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(d){const h=d.code===void 0?B.UNKNOWN:Fb(d.code);return new W(h,d.message||"")}(o);n=new Bb(r,i,s,a||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const i=ks(t,r.document.name),s=un(r.document.updateTime),o=r.document.createTime?un(r.document.createTime):pe.min(),a=new Jt({mapValue:{fields:r.document.fields}}),l=pt.newFoundDocument(i,s,o,a),d=r.targetIds||[],h=r.removedTargetIds||[];n=new Zu(d,h,l.key,l)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const i=ks(t,r.document),s=r.readTime?un(r.readTime):pe.min(),o=pt.newNoDocument(i,s),a=r.removedTargetIds||[];n=new Zu([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const i=ks(t,r.document),s=r.removedTargetIds||[];n=new Zu([],s,i,null)}else{if(!("filter"in e))return le(11601,{Rt:e});{e.filter;const r=e.filter;r.targetId;const{count:i=0,unchangedNames:s}=r,o=new cO(i,s),a=r.targetId;n=new Ub(a,o)}}return n}function Hd(t,e){let n;if(e instanceof Ra)n={update:$E(t,e.key,e.value)};else if(e instanceof qh)n={delete:qd(t,e.key)};else if(e instanceof ni)n={update:$E(t,e.key,e.data),updateMask:AO(e.fieldMask)};else{if(!(e instanceof Mb))return le(16599,{Vt:e.type});n={verify:qd(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(s,o){const a=o.transform;if(a instanceof ma)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof Ws)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof ga)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof ya)return{fieldPath:o.field.canonicalString(),increment:a.Ae};throw le(20930,{transform:o.transform})}(0,r))),e.precondition.isNone||(n.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:_O(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:le(27497)}(t,e.precondition)),n}function Wm(t,e){const n=e.currentDocument?function(s){return s.updateTime!==void 0?Zt.updateTime(un(s.updateTime)):s.exists!==void 0?Zt.exists(s.exists):Zt.none()}(e.currentDocument):Zt.none(),r=e.updateTransforms?e.updateTransforms.map(i=>function(o,a){let l=null;if("setToServerValue"in a)ue(a.setToServerValue==="REQUEST_TIME",16630,{proto:a}),l=new ma;else if("appendMissingElements"in a){const h=a.appendMissingElements.values||[];l=new Ws(h)}else if("removeAllFromArray"in a){const h=a.removeAllFromArray.values||[];l=new ga(h)}else"increment"in a?l=new ya(o,a.increment):le(16584,{proto:a});const d=ct.fromServerFormat(a.fieldPath);return new $h(d,l)}(t,i)):[];if(e.update){e.update.name;const i=ks(t,e.update.name),s=new Jt({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=function(l){const d=l.fieldPaths||[];return new _n(d.map(h=>ct.fromServerFormat(h)))}(e.updateMask);return new ni(i,s,o,n,r)}return new Ra(i,s,n,r)}if(e.delete){const i=ks(t,e.delete);return new qh(i,n)}if(e.verify){const i=ks(t,e.verify);return new Mb(i,n)}return le(1463,{proto:e})}function EO(t,e){return t&&t.length>0?(ue(e!==void 0,14353),t.map(n=>function(i,s){let o=i.updateTime?un(i.updateTime):un(s);return o.isEqual(pe.min())&&(o=un(s)),new sO(o,i.transformResults||[])}(n,e))):[]}function Kb(t,e){return{documents:[qb(t,e.path)]}}function Ly(t,e){const n={structuredQuery:{}},r=e.path;let i;e.collectionGroup!==null?(i=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=qb(t,i);const s=function(d){if(d.length!==0)return Yb(He.create(d,"and"))}(e.filters);s&&(n.structuredQuery.where=s);const o=function(d){if(d.length!==0)return d.map(h=>function(m){return{field:Ti(m.field),direction:xO(m.dir)}}(h))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);const a=zm(t,e.limit);return a!==null&&(n.structuredQuery.limit=a),e.startAt&&(n.structuredQuery.startAt=function(d){return{before:d.inclusive,values:d.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(d){return{before:!d.inclusive,values:d.position}}(e.endAt)),{ft:n,parent:i}}function IO(t,e,n,r){const{ft:i,parent:s}=Ly(t,e),o={},a=[];let l=0;return n.forEach(d=>{const h="aggregate_"+l++;o[h]=d.alias,d.aggregateType==="count"?a.push({alias:h,count:{}}):d.aggregateType==="avg"?a.push({alias:h,avg:{field:Ti(d.fieldPath)}}):d.aggregateType==="sum"&&a.push({alias:h,sum:{field:Ti(d.fieldPath)}})}),{request:{structuredAggregationQuery:{aggregations:a,structuredQuery:i.structuredQuery},parent:i.parent},gt:o,parent:s}}function Gb(t){let e=Hb(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let i=null;if(r>0){ue(r===1,65062);const h=n.from[0];h.allDescendants?i=h.collectionId:e=e.child(h.collectionId)}let s=[];n.where&&(s=function(f){const m=Qb(f);return m instanceof He&&Ry(m)?m.getFilters():[m]}(n.where));let o=[];n.orderBy&&(o=function(f){return f.map(m=>function(C){return new pc(xo(C.field),function(N){switch(N){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(C.direction))}(m))}(n.orderBy));let a=null;n.limit&&(a=function(f){let m;return m=typeof f=="object"?f.value:f,Dh(m)?null:m}(n.limit));let l=null;n.startAt&&(l=function(f){const m=!!f.before,v=f.values||[];return new Ki(v,m)}(n.startAt));let d=null;return n.endAt&&(d=function(f){const m=!f.before,v=f.values||[];return new Ki(v,m)}(n.endAt)),KV(e,i,o,s,a,"F",l,d)}function TO(t,e){const n=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return le(28987,{purpose:i})}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function Qb(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=xo(n.unaryFilter.field);return je.create(r,"==",{doubleValue:NaN});case"IS_NULL":const i=xo(n.unaryFilter.field);return je.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=xo(n.unaryFilter.field);return je.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=xo(n.unaryFilter.field);return je.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return le(61313);default:return le(60726)}}(t):t.fieldFilter!==void 0?function(n){return je.create(xo(n.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return le(58110);default:return le(50506)}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return He.create(n.compositeFilter.filters.map(r=>Qb(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return le(1026)}}(n.compositeFilter.op))}(t):le(30097,{filter:t})}function xO(t){return pO[t]}function SO(t){return mO[t]}function bO(t){return gO[t]}function Ti(t){return{fieldPath:t.canonicalString()}}function xo(t){return ct.fromServerFormat(t.fieldPath)}function Yb(t){return t instanceof je?function(n){if(n.op==="=="){if(bE(n.value))return{unaryFilter:{field:Ti(n.field),op:"IS_NAN"}};if(SE(n.value))return{unaryFilter:{field:Ti(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(bE(n.value))return{unaryFilter:{field:Ti(n.field),op:"IS_NOT_NAN"}};if(SE(n.value))return{unaryFilter:{field:Ti(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Ti(n.field),op:SO(n.op),value:n.value}}}(t):t instanceof He?function(n){const r=n.getFilters().map(i=>Yb(i));return r.length===1?r[0]:{compositeFilter:{op:bO(n.op),filters:r}}}(t):le(54877,{filter:t})}function AO(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function Xb(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Br{constructor(e,n,r,i,s=pe.min(),o=pe.min(),a=xt.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=l}withSequenceNumber(e){return new Br(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new Br(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Br(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Br(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jb{constructor(e){this.yt=e}}function CO(t,e){let n;if(e.document)n=vO(t.yt,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=J.fromSegments(e.noDocument.path),i=Gs(e.noDocument.readTime);n=pt.newNoDocument(r,i),e.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!e.unknownDocument)return le(56709);{const r=J.fromSegments(e.unknownDocument.path),i=Gs(e.unknownDocument.version);n=pt.newUnknownDocument(r,i)}}return e.readTime&&n.setReadTime(function(i){const s=new Oe(i[0],i[1]);return pe.fromTimestamp(s)}(e.readTime)),n}function zE(t,e){const n=e.key,r={prefixPath:n.getCollectionPath().popLast().toArray(),collectionGroup:n.collectionGroup,documentId:n.path.lastSegment(),readTime:Wd(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=function(s,o){return{name:qd(s,o.key),fields:o.data.value.mapValue.fields,updateTime:_a(s,o.version.toTimestamp()),createTime:_a(s,o.createTime.toTimestamp())}}(t.yt,e);else if(e.isNoDocument())r.noDocument={path:n.path.toArray(),readTime:Ks(e.version)};else{if(!e.isUnknownDocument())return le(57904,{document:e});r.unknownDocument={path:n.path.toArray(),version:Ks(e.version)}}return r}function Wd(t){const e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function Ks(t){const e=t.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function Gs(t){const e=new Oe(t.seconds,t.nanoseconds);return pe.fromTimestamp(e)}function _s(t,e){const n=(e.baseMutations||[]).map(s=>Wm(t.yt,s));for(let s=0;s<e.mutations.length-1;++s){const o=e.mutations[s];if(s+1<e.mutations.length&&e.mutations[s+1].transform!==void 0){const a=e.mutations[s+1];o.updateTransforms=a.transform.fieldTransforms,e.mutations.splice(s+1,1),++s}}const r=e.mutations.map(s=>Wm(t.yt,s)),i=Oe.fromMillis(e.localWriteTimeMs);return new Ny(e.batchId,i,n,r)}function ml(t){const e=Gs(t.readTime),n=t.lastLimboFreeSnapshotVersion!==void 0?Gs(t.lastLimboFreeSnapshotVersion):pe.min();let r;return r=function(s){return s.documents!==void 0}(t.query)?function(s){const o=s.documents.length;return ue(o===1,1966,{count:o}),Hn(Pc(Hb(s.documents[0])))}(t.query):function(s){return Hn(Gb(s))}(t.query),new Br(r,t.targetId,"TargetPurposeListen",t.lastListenSequenceNumber,e,n,xt.fromBase64String(t.resumeToken))}function Zb(t,e){const n=Ks(e.snapshotVersion),r=Ks(e.lastLimboFreeSnapshotVersion);let i;i=Bd(e.target)?Kb(t.yt,e.target):Ly(t.yt,e.target).ft;const s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Hs(e.target),readTime:n,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function eA(t){const e=Gb({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?zd(e,e.limit,"L"):e}function lp(t,e){return new jy(e.largestBatchId,Wm(t.yt,e.overlayMutation))}function qE(t,e){const n=e.path.lastSegment();return[t,tn(e.path.popLast()),n]}function HE(t,e,n,r){return{indexId:t,uid:e,sequenceNumber:n,readTime:Ks(r.readTime),documentKey:tn(r.documentKey.path),largestBatchId:r.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RO{getBundleMetadata(e,n){return WE(e).get(n).next(r=>{if(r)return function(s){return{id:s.bundleId,createTime:Gs(s.createTime),version:s.version}}(r)})}saveBundleMetadata(e,n){return WE(e).put(function(i){return{bundleId:i.id,createTime:Ks(un(i.createTime)),version:i.version}}(n))}getNamedQuery(e,n){return KE(e).get(n).next(r=>{if(r)return function(s){return{name:s.name,query:eA(s.bundledQuery),readTime:Gs(s.readTime)}}(r)})}saveNamedQuery(e,n){return KE(e).put(function(i){return{name:i.name,readTime:Ks(un(i.readTime)),bundledQuery:i.bundledQuery}}(n))}}function WE(t){return Pt(t,jh)}function KE(t){return Pt(t,Vh)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wh{constructor(e,n){this.serializer=e,this.userId=n}static wt(e,n){const r=n.uid||"";return new Wh(e,r)}getOverlay(e,n){return Za(e).get(qE(this.userId,n)).next(r=>r?lp(this.serializer,r):null)}getOverlays(e,n){const r=xr();return V.forEach(n,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,n,r){const i=[];return r.forEach((s,o)=>{const a=new jy(n,o);i.push(this.St(e,a))}),V.waitFor(i)}removeOverlaysForBatchId(e,n,r){const i=new Set;n.forEach(o=>i.add(tn(o.getCollectionPath())));const s=[];return i.forEach(o=>{const a=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,r+1],!1,!0);s.push(Za(e).Z(Vm,a))}),V.waitFor(s)}getOverlaysForCollection(e,n,r){const i=xr(),s=tn(n),o=IDBKeyRange.bound([this.userId,s,r],[this.userId,s,Number.POSITIVE_INFINITY],!0);return Za(e).J(Vm,o).next(a=>{for(const l of a){const d=lp(this.serializer,l);i.set(d.getKey(),d)}return i})}getOverlaysForCollectionGroup(e,n,r,i){const s=xr();let o;const a=IDBKeyRange.bound([this.userId,n,r],[this.userId,n,Number.POSITIVE_INFINITY],!0);return Za(e).ee({index:nb,range:a},(l,d,h)=>{const f=lp(this.serializer,d);s.size()<i||f.largestBatchId===o?(s.set(f.getKey(),f),o=f.largestBatchId):h.done()}).next(()=>s)}St(e,n){return Za(e).put(function(i,s,o){const[a,l,d]=qE(s,o.mutation.key);return{userId:s,collectionPath:l,documentId:d,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:Hd(i.yt,o.mutation)}}(this.serializer,this.userId,n))}}function Za(t){return Pt(t,Oh)}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PO{bt(e){return Pt(e,Sy)}getSessionToken(e){return this.bt(e).get("sessionToken").next(n=>{const r=n==null?void 0:n.value;return r?xt.fromUint8Array(r):xt.EMPTY_BYTE_STRING})}setSessionToken(e,n){return this.bt(e).put({name:"sessionToken",value:n.toUint8Array()})}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vs{constructor(){}Dt(e,n){this.Ct(e,n),n.vt()}Ct(e,n){if("nullValue"in e)this.Ft(n,5);else if("booleanValue"in e)this.Ft(n,10),n.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(n,15),n.Mt(nt(e.integerValue));else if("doubleValue"in e){const r=nt(e.doubleValue);isNaN(r)?this.Ft(n,13):(this.Ft(n,15),ac(r)?n.Mt(0):n.Mt(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Ft(n,20),typeof r=="string"&&(r=Jr(r)),n.xt(`${r.seconds||""}`),n.Mt(r.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,n),this.Nt(n);else if("bytesValue"in e)this.Ft(n,30),n.Bt(Zr(e.bytesValue)),this.Nt(n);else if("referenceValue"in e)this.Lt(e.referenceValue,n);else if("geoPointValue"in e){const r=e.geoPointValue;this.Ft(n,45),n.Mt(r.latitude||0),n.Mt(r.longitude||0)}else"mapValue"in e?pb(e)?this.Ft(n,Number.MAX_SAFE_INTEGER):Fh(e)?this.kt(e.mapValue,n):(this.qt(e.mapValue,n),this.Nt(n)):"arrayValue"in e?(this.Qt(e.arrayValue,n),this.Nt(n)):le(19022,{$t:e})}Ot(e,n){this.Ft(n,25),this.Ut(e,n)}Ut(e,n){n.xt(e)}qt(e,n){const r=e.fields||{};this.Ft(n,55);for(const i of Object.keys(r))this.Ot(i,n),this.Ct(r[i],n)}kt(e,n){var o,a;const r=e.fields||{};this.Ft(n,53);const i=ha,s=((a=(o=r[i].arrayValue)==null?void 0:o.values)==null?void 0:a.length)||0;this.Ft(n,15),n.Mt(nt(s)),this.Ot(i,n),this.Ct(r[i],n)}Qt(e,n){const r=e.values||[];this.Ft(n,50);for(const i of r)this.Ct(i,n)}Lt(e,n){this.Ft(n,37),J.fromName(e).path.forEach(r=>{this.Ft(n,60),this.Ut(r,n)})}Ft(e,n){e.Mt(n)}Nt(e){e.Mt(2)}}vs.Kt=new vs;/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law | agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES | CONDITIONS OF ANY KIND, either express | implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const po=255;function kO(t){if(t===0)return 8;let e=0;return t>>4||(e+=4,t<<=4),t>>6||(e+=2,t<<=2),t>>7||(e+=1),e}function GE(t){const e=64-function(r){let i=0;for(let s=0;s<8;++s){const o=kO(255&r[s]);if(i+=o,o!==8)break}return i}(t);return Math.ceil(e/8)}class NO{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Wt(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.Gt(r.value),r=n.next();this.zt()}jt(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.Jt(r.value),r=n.next();this.Ht()}Yt(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.Gt(r);else if(r<2048)this.Gt(960|r>>>6),this.Gt(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Gt(480|r>>>12),this.Gt(128|63&r>>>6),this.Gt(128|63&r);else{const i=n.codePointAt(0);this.Gt(240|i>>>18),this.Gt(128|63&i>>>12),this.Gt(128|63&i>>>6),this.Gt(128|63&i)}}this.zt()}Zt(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.Jt(r);else if(r<2048)this.Jt(960|r>>>6),this.Jt(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Jt(480|r>>>12),this.Jt(128|63&r>>>6),this.Jt(128|63&r);else{const i=n.codePointAt(0);this.Jt(240|i>>>18),this.Jt(128|63&i>>>12),this.Jt(128|63&i>>>6),this.Jt(128|63&i)}}this.Ht()}Xt(e){const n=this.en(e),r=GE(n);this.tn(1+r),this.buffer[this.position++]=255&r;for(let i=n.length-r;i<n.length;++i)this.buffer[this.position++]=255&n[i]}nn(e){const n=this.en(e),r=GE(n);this.tn(1+r),this.buffer[this.position++]=~(255&r);for(let i=n.length-r;i<n.length;++i)this.buffer[this.position++]=~(255&n[i])}rn(){this.sn(po),this.sn(255)}_n(){this.an(po),this.an(255)}reset(){this.position=0}seed(e){this.tn(e.length),this.buffer.set(e,this.position),this.position+=e.length}un(){return this.buffer.slice(0,this.position)}en(e){const n=function(s){const o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,s,!1),new Uint8Array(o.buffer)}(e),r=!!(128&n[0]);n[0]^=r?255:128;for(let i=1;i<n.length;++i)n[i]^=r?255:0;return n}Gt(e){const n=255&e;n===0?(this.sn(0),this.sn(255)):n===po?(this.sn(po),this.sn(0)):this.sn(n)}Jt(e){const n=255&e;n===0?(this.an(0),this.an(255)):n===po?(this.an(po),this.an(0)):this.an(e)}zt(){this.sn(0),this.sn(1)}Ht(){this.an(0),this.an(1)}sn(e){this.tn(1),this.buffer[this.position++]=e}an(e){this.tn(1),this.buffer[this.position++]=~e}tn(e){const n=e+this.position;if(n<=this.buffer.length)return;let r=2*this.buffer.length;r<n&&(r=n);const i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}}class DO{constructor(e){this.cn=e}Bt(e){this.cn.Wt(e)}xt(e){this.cn.Yt(e)}Mt(e){this.cn.Xt(e)}vt(){this.cn.rn()}}class jO{constructor(e){this.cn=e}Bt(e){this.cn.jt(e)}xt(e){this.cn.Zt(e)}Mt(e){this.cn.nn(e)}vt(){this.cn._n()}}class el{constructor(){this.cn=new NO,this.ln=new DO(this.cn),this.hn=new jO(this.cn)}seed(e){this.cn.seed(e)}Pn(e){return e===0?this.ln:this.hn}un(){return this.cn.un()}reset(){this.cn.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ws{constructor(e,n,r,i){this.Tn=e,this.In=n,this.En=r,this.dn=i}An(){const e=this.dn.length,n=e===0||this.dn[e-1]===255?e+1:e,r=new Uint8Array(n);return r.set(this.dn,0),n!==e?r.set([0],this.dn.length):++r[r.length-1],new ws(this.Tn,this.In,this.En,r)}Rn(e,n,r){return{indexId:this.Tn,uid:e,arrayValue:ed(this.En),directionalValue:ed(this.dn),orderedDocumentKey:ed(n),documentKey:r.path.toArray()}}Vn(e,n,r){const i=this.Rn(e,n,r);return[i.indexId,i.uid,i.arrayValue,i.directionalValue,i.orderedDocumentKey,i.documentKey]}}function hi(t,e){let n=t.Tn-e.Tn;return n!==0?n:(n=QE(t.En,e.En),n!==0?n:(n=QE(t.dn,e.dn),n!==0?n:J.comparator(t.In,e.In)))}function QE(t,e){for(let n=0;n<t.length&&n<e.length;++n){const r=t[n]-e[n];if(r!==0)return r}return t.length-e.length}function ed(t){return Gx()?function(n){let r="";for(let i=0;i<n.length;i++)r+=String.fromCharCode(n[i]);return r}(t):t}function YE(t){return typeof t!="string"?t:function(n){const r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}(t)}class XE{constructor(e){this.mn=new Ke((n,r)=>ct.comparator(n.field,r.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.fn=e.orderBy,this.gn=[];for(const n of e.filters){const r=n;r.isInequality()?this.mn=this.mn.add(r):this.gn.push(r)}}get pn(){return this.mn.size>1}yn(e){if(ue(e.collectionGroup===this.collectionId,49279),this.pn)return!1;const n=Nm(e);if(n!==void 0&&!this.wn(n))return!1;const r=ms(e);let i=new Set,s=0,o=0;for(;s<r.length&&this.wn(r[s]);++s)i=i.add(r[s].fieldPath.canonicalString());if(s===r.length)return!0;if(this.mn.size>0){const a=this.mn.getIterator().getNext();if(!i.has(a.field.canonicalString())){const l=r[s];if(!this.Sn(a,l)||!this.bn(this.fn[o++],l))return!1}++s}for(;s<r.length;++s){const a=r[s];if(o>=this.fn.length||!this.bn(this.fn[o++],a))return!1}return!0}Dn(){if(this.pn)return null;let e=new Ke(ct.comparator);const n=[];for(const r of this.gn)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")n.push(new Wu(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),n.push(new Wu(r.field,0))}for(const r of this.fn)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),n.push(new Wu(r.field,r.dir==="asc"?0:1)));return new Od(Od.UNKNOWN_ID,this.collectionId,n,oc.empty())}wn(e){for(const n of this.gn)if(this.Sn(n,e))return!0;return!1}Sn(e,n){if(e===void 0||!e.field.isEqual(n.fieldPath))return!1;const r=e.op==="array-contains"||e.op==="array-contains-any";return n.kind===2===r}bn(e,n){return!!e.field.isEqual(n.fieldPath)&&(n.kind===0&&e.dir==="asc"||n.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tA(t){var n,r;if(ue(t instanceof je||t instanceof He,20012),t instanceof je){if(t instanceof Tb){const i=((r=(n=t.value.arrayValue)==null?void 0:n.values)==null?void 0:r.map(s=>je.create(t.field,"==",s)))||[];return He.create(i,"or")}return t}const e=t.filters.map(i=>tA(i));return He.create(e,t.op)}function VO(t){if(t.getFilters().length===0)return[];const e=Qm(tA(t));return ue(nA(e),7391),Km(e)||Gm(e)?[e]:e.getFilters()}function Km(t){return t instanceof je}function Gm(t){return t instanceof He&&Ry(t)}function nA(t){return Km(t)||Gm(t)||function(n){if(n instanceof He&&Fm(n)){for(const r of n.getFilters())if(!Km(r)&&!Gm(r))return!1;return!0}return!1}(t)}function Qm(t){if(ue(t instanceof je||t instanceof He,34018),t instanceof je)return t;if(t.filters.length===1)return Qm(t.filters[0]);const e=t.filters.map(r=>Qm(r));let n=He.create(e,t.op);return n=Kd(n),nA(n)?n:(ue(n instanceof He,64498),ue(pa(n),40251),ue(n.filters.length>1,57927),n.filters.reduce((r,i)=>My(r,i)))}function My(t,e){let n;return ue(t instanceof je||t instanceof He,38388),ue(e instanceof je||e instanceof He,25473),n=t instanceof je?e instanceof je?function(i,s){return He.create([i,s],"and")}(t,e):JE(t,e):e instanceof je?JE(e,t):function(i,s){if(ue(i.filters.length>0&&s.filters.length>0,48005),pa(i)&&pa(s))return wb(i,s.getFilters());const o=Fm(i)?i:s,a=Fm(i)?s:i,l=o.filters.map(d=>My(d,a));return He.create(l,"or")}(t,e),Kd(n)}function JE(t,e){if(pa(e))return wb(e,t.getFilters());{const n=e.filters.map(r=>My(t,r));return He.create(n,"or")}}function Kd(t){if(ue(t instanceof je||t instanceof He,11850),t instanceof je)return t;const e=t.getFilters();if(e.length===1)return Kd(e[0]);if(_b(t))return t;const n=e.map(i=>Kd(i)),r=[];return n.forEach(i=>{i instanceof je?r.push(i):i instanceof He&&(i.op===t.op?r.push(...i.filters):r.push(i))}),r.length===1?r[0]:He.create(r,t.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OO{constructor(){this.Cn=new Fy}addToCollectionParentIndex(e,n){return this.Cn.add(n),V.resolve()}getCollectionParents(e,n){return V.resolve(this.Cn.getEntries(n))}addFieldIndex(e,n){return V.resolve()}deleteFieldIndex(e,n){return V.resolve()}deleteAllFieldIndexes(e){return V.resolve()}createTargetIndexes(e,n){return V.resolve()}getDocumentsMatchingTarget(e,n){return V.resolve(null)}getIndexType(e,n){return V.resolve(0)}getFieldIndexes(e,n){return V.resolve([])}getNextCollectionGroupToUpdate(e){return V.resolve(null)}getMinOffset(e,n){return V.resolve(Dn.min())}getMinOffsetFromCollectionGroup(e,n){return V.resolve(Dn.min())}updateCollectionGroup(e,n,r){return V.resolve()}updateIndexEntries(e,n){return V.resolve()}}class Fy{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),i=this.index[n]||new Ke(Me.comparator),s=!i.has(r);return this.index[n]=i.add(r),s}has(e){const n=e.lastSegment(),r=e.popLast(),i=this.index[n];return i&&i.has(r)}getEntries(e){return(this.index[e]||new Ke(Me.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZE="IndexedDbIndexManager",vu=new Uint8Array(0);class LO{constructor(e,n){this.databaseId=n,this.vn=new Fy,this.Fn=new ti(r=>Hs(r),(r,i)=>Rc(r,i)),this.uid=e.uid||""}addToCollectionParentIndex(e,n){if(!this.vn.has(n)){const r=n.lastSegment(),i=n.popLast();e.addOnCommittedListener(()=>{this.vn.add(n)});const s={collectionId:r,parent:tn(i)};return eI(e).put(s)}return V.resolve()}getCollectionParents(e,n){const r=[],i=IDBKeyRange.bound([n,""],[qS(n),""],!1,!0);return eI(e).J(i).next(s=>{for(const o of s){if(o.collectionId!==n)break;r.push(Tr(o.parent))}return r})}addFieldIndex(e,n){const r=tl(e),i=function(a){return{indexId:a.indexId,collectionGroup:a.collectionGroup,fields:a.fields.map(l=>[l.fieldPath.canonicalString(),l.kind])}}(n);delete i.indexId;const s=r.add(i);if(n.indexState){const o=go(e);return s.next(a=>{o.put(HE(a,this.uid,n.indexState.sequenceNumber,n.indexState.offset))})}return s.next()}deleteFieldIndex(e,n){const r=tl(e),i=go(e),s=mo(e);return r.delete(n.indexId).next(()=>i.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0))).next(()=>s.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){const n=tl(e),r=mo(e),i=go(e);return n.Z().next(()=>r.Z()).next(()=>i.Z())}createTargetIndexes(e,n){return V.forEach(this.Mn(n),r=>this.getIndexType(e,r).next(i=>{if(i===0||i===1){const s=new XE(r).Dn();if(s!=null)return this.addFieldIndex(e,s)}}))}getDocumentsMatchingTarget(e,n){const r=mo(e);let i=!0;const s=new Map;return V.forEach(this.Mn(n),o=>this.xn(e,o).next(a=>{i&&(i=!!a),s.set(o,a)})).next(()=>{if(i){let o=Ce();const a=[];return V.forEach(s,(l,d)=>{q(ZE,`Using index ${function(T){return`id=${T.indexId}|cg=${T.collectionGroup}|f=${T.fields.map(R=>`${R.fieldPath}:${R.kind}`).join(",")}`}(l)} to execute ${Hs(n)}`);const h=function(T,R){const O=Nm(R);if(O===void 0)return null;for(const $ of $d(T,O.fieldPath))switch($.op){case"array-contains-any":return $.value.arrayValue.values||[];case"array-contains":return[$.value]}return null}(d,l),f=function(T,R){const O=new Map;for(const $ of ms(R))for(const x of $d(T,$.fieldPath))switch(x.op){case"==":case"in":O.set($.fieldPath.canonicalString(),x.value);break;case"not-in":case"!=":return O.set($.fieldPath.canonicalString(),x.value),Array.from(O.values())}return null}(d,l),m=function(T,R){const O=[];let $=!0;for(const x of ms(R)){const w=x.kind===0?kE(T,x.fieldPath,T.startAt):NE(T,x.fieldPath,T.startAt);O.push(w.value),$&&($=w.inclusive)}return new Ki(O,$)}(d,l),v=function(T,R){const O=[];let $=!0;for(const x of ms(R)){const w=x.kind===0?NE(T,x.fieldPath,T.endAt):kE(T,x.fieldPath,T.endAt);O.push(w.value),$&&($=w.inclusive)}return new Ki(O,$)}(d,l),C=this.On(l,d,m),y=this.On(l,d,v),N=this.Nn(l,d,f),I=this.Bn(l.indexId,h,C,m.inclusive,y,v.inclusive,N);return V.forEach(I,_=>r.Y(_,n.limit).next(T=>{T.forEach(R=>{const O=J.fromSegments(R.documentKey);o.has(O)||(o=o.add(O),a.push(O))})}))}).next(()=>a)}return V.resolve(null)})}Mn(e){let n=this.Fn.get(e);return n||(e.filters.length===0?n=[e]:n=VO(He.create(e.filters,"and")).map(r=>Bm(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.Fn.set(e,n),n)}Bn(e,n,r,i,s,o,a){const l=(n!=null?n.length:1)*Math.max(r.length,s.length),d=l/(n!=null?n.length:1),h=[];for(let f=0;f<l;++f){const m=n?this.Ln(n[f/d]):vu,v=this.kn(e,m,r[f%d],i),C=this.qn(e,m,s[f%d],o),y=a.map(N=>this.kn(e,m,N,!0));h.push(...this.createRange(v,C,y))}return h}kn(e,n,r,i){const s=new ws(e,J.empty(),n,r);return i?s:s.An()}qn(e,n,r,i){const s=new ws(e,J.empty(),n,r);return i?s.An():s}xn(e,n){const r=new XE(n),i=n.collectionGroup!=null?n.collectionGroup:n.path.lastSegment();return this.getFieldIndexes(e,i).next(s=>{let o=null;for(const a of s)r.yn(a)&&(!o||a.fields.length>o.fields.length)&&(o=a);return o})}getIndexType(e,n){let r=2;const i=this.Mn(n);return V.forEach(i,s=>this.xn(e,s).next(o=>{o?r!==0&&o.fields.length<function(l){let d=new Ke(ct.comparator),h=!1;for(const f of l.filters)for(const m of f.getFlattenedFilters())m.field.isKeyField()||(m.op==="array-contains"||m.op==="array-contains-any"?h=!0:d=d.add(m.field));for(const f of l.orderBy)f.field.isKeyField()||(d=d.add(f.field));return d.size+(h?1:0)}(s)&&(r=1):r=0})).next(()=>function(o){return o.limit!==null}(n)&&i.length>1&&r===2?1:r)}Qn(e,n){const r=new el;for(const i of ms(e)){const s=n.data.field(i.fieldPath);if(s==null)return null;const o=r.Pn(i.kind);vs.Kt.Dt(s,o)}return r.un()}Ln(e){const n=new el;return vs.Kt.Dt(e,n.Pn(0)),n.un()}$n(e,n){const r=new el;return vs.Kt.Dt(qs(this.databaseId,n),r.Pn(function(s){const o=ms(s);return o.length===0?0:o[o.length-1].kind}(e))),r.un()}Nn(e,n,r){if(r===null)return[];let i=[];i.push(new el);let s=0;for(const o of ms(e)){const a=r[s++];for(const l of i)if(this.Un(n,o.fieldPath)&&fc(a))i=this.Kn(i,o,a);else{const d=l.Pn(o.kind);vs.Kt.Dt(a,d)}}return this.Wn(i)}On(e,n,r){return this.Nn(e,n,r.position)}Wn(e){const n=[];for(let r=0;r<e.length;++r)n[r]=e[r].un();return n}Kn(e,n,r){const i=[...e],s=[];for(const o of r.arrayValue.values||[])for(const a of i){const l=new el;l.seed(a.un()),vs.Kt.Dt(o,l.Pn(n.kind)),s.push(l)}return s}Un(e,n){return!!e.filters.find(r=>r instanceof je&&r.field.isEqual(n)&&(r.op==="in"||r.op==="not-in"))}getFieldIndexes(e,n){const r=tl(e),i=go(e);return(n?r.J(jm,IDBKeyRange.bound(n,n)):r.J()).next(s=>{const o=[];return V.forEach(s,a=>i.get([a.indexId,this.uid]).next(l=>{o.push(function(h,f){const m=f?new oc(f.sequenceNumber,new Dn(Gs(f.readTime),new J(Tr(f.documentKey)),f.largestBatchId)):oc.empty(),v=h.fields.map(([C,y])=>new Wu(ct.fromServerFormat(C),y));return new Od(h.indexId,h.collectionGroup,v,m)}(a,l))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(n=>n.length===0?null:(n.sort((r,i)=>{const s=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return s!==0?s:Ie(r.collectionGroup,i.collectionGroup)}),n[0].collectionGroup))}updateCollectionGroup(e,n,r){const i=tl(e),s=go(e);return this.Gn(e).next(o=>i.J(jm,IDBKeyRange.bound(n,n)).next(a=>V.forEach(a,l=>s.put(HE(l.indexId,this.uid,o,r)))))}updateIndexEntries(e,n){const r=new Map;return V.forEach(n,(i,s)=>{const o=r.get(i.collectionGroup);return(o?V.resolve(o):this.getFieldIndexes(e,i.collectionGroup)).next(a=>(r.set(i.collectionGroup,a),V.forEach(a,l=>this.zn(e,i,l).next(d=>{const h=this.jn(s,l);return d.isEqual(h)?V.resolve():this.Jn(e,s,l,d,h)}))))})}Hn(e,n,r,i){return mo(e).put(i.Rn(this.uid,this.$n(r,n.key),n.key))}Yn(e,n,r,i){return mo(e).delete(i.Vn(this.uid,this.$n(r,n.key),n.key))}zn(e,n,r){const i=mo(e);let s=new Ke(hi);return i.ee({index:tb,range:IDBKeyRange.only([r.indexId,this.uid,ed(this.$n(r,n))])},(o,a)=>{s=s.add(new ws(r.indexId,n,YE(a.arrayValue),YE(a.directionalValue)))}).next(()=>s)}jn(e,n){let r=new Ke(hi);const i=this.Qn(n,e);if(i==null)return r;const s=Nm(n);if(s!=null){const o=e.data.field(s.fieldPath);if(fc(o))for(const a of o.arrayValue.values||[])r=r.add(new ws(n.indexId,e.key,this.Ln(a),i))}else r=r.add(new ws(n.indexId,e.key,vu,i));return r}Jn(e,n,r,i,s){q(ZE,"Updating index entries for document '%s'",n.key);const o=[];return function(l,d,h,f,m){const v=l.getIterator(),C=d.getIterator();let y=fo(v),N=fo(C);for(;y||N;){let I=!1,_=!1;if(y&&N){const T=h(y,N);T<0?_=!0:T>0&&(I=!0)}else y!=null?_=!0:I=!0;I?(f(N),N=fo(C)):_?(m(y),y=fo(v)):(y=fo(v),N=fo(C))}}(i,s,hi,a=>{o.push(this.Hn(e,n,r,a))},a=>{o.push(this.Yn(e,n,r,a))}),V.waitFor(o)}Gn(e){let n=1;return go(e).ee({index:eb,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,i,s)=>{s.done(),n=i.sequenceNumber+1}).next(()=>n)}createRange(e,n,r){r=r.sort((o,a)=>hi(o,a)).filter((o,a,l)=>!a||hi(o,l[a-1])!==0);const i=[];i.push(e);for(const o of r){const a=hi(o,e),l=hi(o,n);if(a===0)i[0]=e.An();else if(a>0&&l<0)i.push(o),i.push(o.An());else if(l>0)break}i.push(n);const s=[];for(let o=0;o<i.length;o+=2){if(this.Zn(i[o],i[o+1]))return[];const a=i[o].Vn(this.uid,vu,J.empty()),l=i[o+1].Vn(this.uid,vu,J.empty());s.push(IDBKeyRange.bound(a,l))}return s}Zn(e,n){return hi(e,n)>0}getMinOffsetFromCollectionGroup(e,n){return this.getFieldIndexes(e,n).next(tI)}getMinOffset(e,n){return V.mapArray(this.Mn(n),r=>this.xn(e,r).next(i=>i||le(44426))).next(tI)}}function eI(t){return Pt(t,uc)}function mo(t){return Pt(t,Dl)}function tl(t){return Pt(t,xy)}function go(t){return Pt(t,Nl)}function tI(t){ue(t.length!==0,28825);let e=t[0].indexState.offset,n=e.largestBatchId;for(let r=1;r<t.length;r++){const i=t[r].indexState.offset;Ey(i,e)<0&&(e=i),n<i.largestBatchId&&(n=i.largestBatchId)}return new Dn(e.readTime,e.documentKey,n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nI={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},rA=41943040;class Yt{static withCacheSize(e){return new Yt(e,Yt.DEFAULT_COLLECTION_PERCENTILE,Yt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iA(t,e,n){const r=t.store(tr),i=t.store(la),s=[],o=IDBKeyRange.only(n.batchId);let a=0;const l=r.ee({range:o},(h,f,m)=>(a++,m.delete()));s.push(l.next(()=>{ue(a===1,47070,{batchId:n.batchId})}));const d=[];for(const h of n.mutations){const f=XS(e,h.key.path,n.batchId);s.push(i.delete(f)),d.push(h.key)}return V.waitFor(s).next(()=>d)}function Gd(t){if(!t)return 0;let e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw le(14731);e=t.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Yt.DEFAULT_COLLECTION_PERCENTILE=10,Yt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Yt.DEFAULT=new Yt(rA,Yt.DEFAULT_COLLECTION_PERCENTILE,Yt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Yt.DISABLED=new Yt(-1,0,0);class Kh{constructor(e,n,r,i){this.userId=e,this.serializer=n,this.indexManager=r,this.referenceDelegate=i,this.Xn={}}static wt(e,n,r,i){ue(e.uid!=="",64387);const s=e.isAuthenticated()?e.uid:"";return new Kh(s,n,r,i)}checkEmpty(e){let n=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return fi(e).ee({index:Ss,range:r},(i,s,o)=>{n=!1,o.done()}).next(()=>n)}addMutationBatch(e,n,r,i){const s=So(e),o=fi(e);return o.add({}).next(a=>{ue(typeof a=="number",49019);const l=new Ny(a,n,r,i),d=function(v,C,y){const N=y.baseMutations.map(_=>Hd(v.yt,_)),I=y.mutations.map(_=>Hd(v.yt,_));return{userId:C,batchId:y.batchId,localWriteTimeMs:y.localWriteTime.toMillis(),baseMutations:N,mutations:I}}(this.serializer,this.userId,l),h=[];let f=new Ke((m,v)=>Ie(m.canonicalString(),v.canonicalString()));for(const m of i){const v=XS(this.userId,m.key.path,a);f=f.add(m.key.path.popLast()),h.push(o.put(d)),h.push(s.put(v,uV))}return f.forEach(m=>{h.push(this.indexManager.addToCollectionParentIndex(e,m))}),e.addOnCommittedListener(()=>{this.Xn[a]=l.keys()}),V.waitFor(h).next(()=>l)})}lookupMutationBatch(e,n){return fi(e).get(n).next(r=>r?(ue(r.userId===this.userId,48,"Unexpected user for mutation batch",{userId:r.userId,batchId:n}),_s(this.serializer,r)):null)}er(e,n){return this.Xn[n]?V.resolve(this.Xn[n]):this.lookupMutationBatch(e,n).next(r=>{if(r){const i=r.keys();return this.Xn[n]=i,i}return null})}getNextMutationBatchAfterBatchId(e,n){const r=n+1,i=IDBKeyRange.lowerBound([this.userId,r]);let s=null;return fi(e).ee({index:Ss,range:i},(o,a,l)=>{a.userId===this.userId&&(ue(a.batchId>=r,47524,{tr:r}),s=_s(this.serializer,a)),l.done()}).next(()=>s)}getHighestUnacknowledgedBatchId(e){const n=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=Rs;return fi(e).ee({index:Ss,range:n,reverse:!0},(i,s,o)=>{r=s.batchId,o.done()}).next(()=>r)}getAllMutationBatches(e){const n=IDBKeyRange.bound([this.userId,Rs],[this.userId,Number.POSITIVE_INFINITY]);return fi(e).J(Ss,n).next(r=>r.map(i=>_s(this.serializer,i)))}getAllMutationBatchesAffectingDocumentKey(e,n){const r=Ku(this.userId,n.path),i=IDBKeyRange.lowerBound(r),s=[];return So(e).ee({range:i},(o,a,l)=>{const[d,h,f]=o,m=Tr(h);if(d===this.userId&&n.path.isEqual(m))return fi(e).get(f).next(v=>{if(!v)throw le(61480,{nr:o,batchId:f});ue(v.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:v.userId,batchId:f}),s.push(_s(this.serializer,v))});l.done()}).next(()=>s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Ke(Ie);const i=[];return n.forEach(s=>{const o=Ku(this.userId,s.path),a=IDBKeyRange.lowerBound(o),l=So(e).ee({range:a},(d,h,f)=>{const[m,v,C]=d,y=Tr(v);m===this.userId&&s.path.isEqual(y)?r=r.add(C):f.done()});i.push(l)}),V.waitFor(i).next(()=>this.rr(e,r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,i=r.length+1,s=Ku(this.userId,r),o=IDBKeyRange.lowerBound(s);let a=new Ke(Ie);return So(e).ee({range:o},(l,d,h)=>{const[f,m,v]=l,C=Tr(m);f===this.userId&&r.isPrefixOf(C)?C.length===i&&(a=a.add(v)):h.done()}).next(()=>this.rr(e,a))}rr(e,n){const r=[],i=[];return n.forEach(s=>{i.push(fi(e).get(s).next(o=>{if(o===null)throw le(35274,{batchId:s});ue(o.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:o.userId,batchId:s}),r.push(_s(this.serializer,o))}))}),V.waitFor(i).next(()=>r)}removeMutationBatch(e,n){return iA(e.le,this.userId,n).next(r=>(e.addOnCommittedListener(()=>{this.ir(n.batchId)}),V.forEach(r,i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))}ir(e){delete this.Xn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(n=>{if(!n)return V.resolve();const r=IDBKeyRange.lowerBound(function(o){return[o]}(this.userId)),i=[];return So(e).ee({range:r},(s,o,a)=>{if(s[0]===this.userId){const l=Tr(s[1]);i.push(l)}else a.done()}).next(()=>{ue(i.length===0,56720,{sr:i.map(s=>s.canonicalString())})})})}containsKey(e,n){return sA(e,this.userId,n)}_r(e){return oA(e).get(this.userId).next(n=>n||{userId:this.userId,lastAcknowledgedBatchId:Rs,lastStreamToken:""})}}function sA(t,e,n){const r=Ku(e,n.path),i=r[1],s=IDBKeyRange.lowerBound(r);let o=!1;return So(t).ee({range:s,X:!0},(a,l,d)=>{const[h,f,m]=a;h===e&&f===i&&(o=!0),d.done()}).next(()=>o)}function fi(t){return Pt(t,tr)}function So(t){return Pt(t,la)}function oA(t){return Pt(t,lc)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qs{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new Qs(0)}static cr(){return new Qs(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MO{constructor(e,n){this.referenceDelegate=e,this.serializer=n}allocateTargetId(e){return this.lr(e).next(n=>{const r=new Qs(n.highestTargetId);return n.highestTargetId=r.next(),this.hr(e,n).next(()=>n.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.lr(e).next(n=>pe.fromTimestamp(new Oe(n.lastRemoteSnapshotVersion.seconds,n.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.lr(e).next(n=>n.highestListenSequenceNumber)}setTargetsMetadata(e,n,r){return this.lr(e).next(i=>(i.highestListenSequenceNumber=n,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),n>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=n),this.hr(e,i)))}addTargetData(e,n){return this.Pr(e,n).next(()=>this.lr(e).next(r=>(r.targetCount+=1,this.Tr(n,r),this.hr(e,r))))}updateTargetData(e,n){return this.Pr(e,n)}removeTargetData(e,n){return this.removeMatchingKeysForTargetId(e,n.targetId).next(()=>yo(e).delete(n.targetId)).next(()=>this.lr(e)).next(r=>(ue(r.targetCount>0,8065),r.targetCount-=1,this.hr(e,r)))}removeTargets(e,n,r){let i=0;const s=[];return yo(e).ee((o,a)=>{const l=ml(a);l.sequenceNumber<=n&&r.get(l.targetId)===null&&(i++,s.push(this.removeTargetData(e,l)))}).next(()=>V.waitFor(s)).next(()=>i)}forEachTarget(e,n){return yo(e).ee((r,i)=>{const s=ml(i);n(s)})}lr(e){return rI(e).get(Fd).next(n=>(ue(n!==null,2888),n))}hr(e,n){return rI(e).put(Fd,n)}Pr(e,n){return yo(e).put(Zb(this.serializer,n))}Tr(e,n){let r=!1;return e.targetId>n.highestTargetId&&(n.highestTargetId=e.targetId,r=!0),e.sequenceNumber>n.highestListenSequenceNumber&&(n.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.lr(e).next(n=>n.targetCount)}getTargetData(e,n){const r=Hs(n),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let s=null;return yo(e).ee({range:i,index:ZS},(o,a,l)=>{const d=ml(a);Rc(n,d.target)&&(s=d,l.done())}).next(()=>s)}addMatchingKeys(e,n,r){const i=[],s=xi(e);return n.forEach(o=>{const a=tn(o.path);i.push(s.put({targetId:r,path:a})),i.push(this.referenceDelegate.addReference(e,r,o))}),V.waitFor(i)}removeMatchingKeys(e,n,r){const i=xi(e);return V.forEach(n,s=>{const o=tn(s.path);return V.waitFor([i.delete([r,o]),this.referenceDelegate.removeReference(e,r,s)])})}removeMatchingKeysForTargetId(e,n){const r=xi(e),i=IDBKeyRange.bound([n],[n+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,n){const r=IDBKeyRange.bound([n],[n+1],!1,!0),i=xi(e);let s=Ce();return i.ee({range:r,X:!0},(o,a,l)=>{const d=Tr(o[1]),h=new J(d);s=s.add(h)}).next(()=>s)}containsKey(e,n){const r=tn(n.path),i=IDBKeyRange.bound([r],[qS(r)],!1,!0);let s=0;return xi(e).ee({index:Ty,X:!0,range:i},([o,a],l,d)=>{o!==0&&(s++,d.done())}).next(()=>s>0)}At(e,n){return yo(e).get(n).next(r=>r?ml(r):null)}}function yo(t){return Pt(t,ca)}function rI(t){return Pt(t,Ps)}function xi(t){return Pt(t,ua)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iI="LruGarbageCollector",FO=1048576;function sI([t,e],[n,r]){const i=Ie(t,n);return i===0?Ie(e,r):i}class UO{constructor(e){this.Ir=e,this.buffer=new Ke(sI),this.Er=0}dr(){return++this.Er}Ar(e){const n=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(n);else{const r=this.buffer.last();sI(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}}class aA{constructor(e,n,r){this.garbageCollector=e,this.asyncQueue=n,this.localStore=r,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){q(iI,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){rs(n)?q(iI,"Ignoring IndexedDB error during garbage collection: ",n):await so(n)}await this.Vr(3e5)})}}class BO{constructor(e,n){this.mr=e,this.params=n}calculateTargetCount(e,n){return this.mr.gr(e).next(r=>Math.floor(n/100*r))}nthSequenceNumber(e,n){if(n===0)return V.resolve(zn.ce);const r=new UO(n);return this.mr.forEachTarget(e,i=>r.Ar(i.sequenceNumber)).next(()=>this.mr.pr(e,i=>r.Ar(i))).next(()=>r.maxValue)}removeTargets(e,n,r){return this.mr.removeTargets(e,n,r)}removeOrphanedDocuments(e,n){return this.mr.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(q("LruGarbageCollector","Garbage collection skipped; disabled"),V.resolve(nI)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(q("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),nI):this.yr(e,n))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,n){let r,i,s,o,a,l,d;const h=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(f=>(f>this.params.maximumSequenceNumbersToCollect?(q("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${f}`),i=this.params.maximumSequenceNumbersToCollect):i=f,o=Date.now(),this.nthSequenceNumber(e,i))).next(f=>(r=f,a=Date.now(),this.removeTargets(e,r,n))).next(f=>(s=f,l=Date.now(),this.removeOrphanedDocuments(e,r))).next(f=>(d=Date.now(),Io()<=De.DEBUG&&q("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-h}ms
	Determined least recently used ${i} in `+(a-o)+`ms
	Removed ${s} targets in `+(l-a)+`ms
	Removed ${f} documents in `+(d-l)+`ms
Total Duration: ${d-h}ms`),V.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:f})))}}function lA(t,e){return new BO(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $O{constructor(e,n){this.db=e,this.garbageCollector=lA(this,n)}gr(e){const n=this.wr(e);return this.db.getTargetCache().getTargetCount(e).next(r=>n.next(i=>r+i))}wr(e){let n=0;return this.pr(e,r=>{n++}).next(()=>n)}forEachTarget(e,n){return this.db.getTargetCache().forEachTarget(e,n)}pr(e,n){return this.Sr(e,(r,i)=>n(i))}addReference(e,n,r){return wu(e,r)}removeReference(e,n,r){return wu(e,r)}removeTargets(e,n,r){return this.db.getTargetCache().removeTargets(e,n,r)}markPotentiallyOrphaned(e,n){return wu(e,n)}br(e,n){return function(i,s){let o=!1;return oA(i).te(a=>sA(i,a,s).next(l=>(l&&(o=!0),V.resolve(!l)))).next(()=>o)}(e,n)}removeOrphanedDocuments(e,n){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[];let s=0;return this.Sr(e,(o,a)=>{if(a<=n){const l=this.br(e,o).next(d=>{if(!d)return s++,r.getEntry(e,o).next(()=>(r.removeEntry(o,pe.min()),xi(e).delete(function(f){return[0,tn(f.path)]}(o))))});i.push(l)}}).next(()=>V.waitFor(i)).next(()=>r.apply(e)).next(()=>s)}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,n){return wu(e,n)}Sr(e,n){const r=xi(e);let i,s=zn.ce;return r.ee({index:Ty},([o,a],{path:l,sequenceNumber:d})=>{o===0?(s!==zn.ce&&n(new J(Tr(i)),s),s=d,i=l):s=zn.ce}).next(()=>{s!==zn.ce&&n(new J(Tr(i)),s)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function wu(t,e){return xi(t).put(function(r,i){return{targetId:0,path:tn(r.path),sequenceNumber:i}}(e,t.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cA{constructor(){this.changes=new ti(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,pt.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?V.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zO{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,n,r){return us(e).put(r)}removeEntry(e,n,r){return us(e).delete(function(s,o){const a=s.path.toArray();return[a.slice(0,a.length-2),a[a.length-2],Wd(o),a[a.length-1]]}(n,r))}updateMetadata(e,n){return this.getMetadata(e).next(r=>(r.byteSize+=n,this.Dr(e,r)))}getEntry(e,n){let r=pt.newInvalidDocument(n);return us(e).ee({index:Gu,range:IDBKeyRange.only(nl(n))},(i,s)=>{r=this.Cr(n,s)}).next(()=>r)}vr(e,n){let r={size:0,document:pt.newInvalidDocument(n)};return us(e).ee({index:Gu,range:IDBKeyRange.only(nl(n))},(i,s)=>{r={document:this.Cr(n,s),size:Gd(s)}}).next(()=>r)}getEntries(e,n){let r=Rn();return this.Fr(e,n,(i,s)=>{const o=this.Cr(i,s);r=r.insert(i,o)}).next(()=>r)}Mr(e,n){let r=Rn(),i=new st(J.comparator);return this.Fr(e,n,(s,o)=>{const a=this.Cr(s,o);r=r.insert(s,a),i=i.insert(s,Gd(o))}).next(()=>({documents:r,Or:i}))}Fr(e,n,r){if(n.isEmpty())return V.resolve();let i=new Ke(lI);n.forEach(l=>i=i.add(l));const s=IDBKeyRange.bound(nl(i.first()),nl(i.last())),o=i.getIterator();let a=o.getNext();return us(e).ee({index:Gu,range:s},(l,d,h)=>{const f=J.fromSegments([...d.prefixPath,d.collectionGroup,d.documentId]);for(;a&&lI(a,f)<0;)r(a,null),a=o.getNext();a&&a.isEqual(f)&&(r(a,d),a=o.hasNext()?o.getNext():null),a?h.j(nl(a)):h.done()}).next(()=>{for(;a;)r(a,null),a=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,n,r,i,s){const o=n.path,a=[o.popLast().toArray(),o.lastSegment(),Wd(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],l=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return us(e).J(IDBKeyRange.bound(a,l,!0)).next(d=>{s==null||s.incrementDocumentReadCount(d.length);let h=Rn();for(const f of d){const m=this.Cr(J.fromSegments(f.prefixPath.concat(f.collectionGroup,f.documentId)),f);m.isFoundDocument()&&(kc(n,m)||i.has(m.key))&&(h=h.insert(m.key,m))}return h})}getAllFromCollectionGroup(e,n,r,i){let s=Rn();const o=aI(n,r),a=aI(n,Dn.max());return us(e).ee({index:JS,range:IDBKeyRange.bound(o,a,!0)},(l,d,h)=>{const f=this.Cr(J.fromSegments(d.prefixPath.concat(d.collectionGroup,d.documentId)),d);s=s.insert(f.key,f),s.size===i&&h.done()}).next(()=>s)}newChangeBuffer(e){return new qO(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(n=>n.byteSize)}getMetadata(e){return oI(e).get(Dm).next(n=>(ue(!!n,20021),n))}Dr(e,n){return oI(e).put(Dm,n)}Cr(e,n){if(n){const r=CO(this.serializer,n);if(!(r.isNoDocument()&&r.version.isEqual(pe.min())))return r}return pt.newInvalidDocument(e)}}function uA(t){return new zO(t)}class qO extends cA{constructor(e,n){super(),this.Nr=e,this.trackRemovals=n,this.Br=new ti(r=>r.toString(),(r,i)=>r.isEqual(i))}applyChanges(e){const n=[];let r=0,i=new Ke((s,o)=>Ie(s.canonicalString(),o.canonicalString()));return this.changes.forEach((s,o)=>{const a=this.Br.get(s);if(n.push(this.Nr.removeEntry(e,s,a.readTime)),o.isValidDocument()){const l=zE(this.Nr.serializer,o);i=i.add(s.path.popLast());const d=Gd(l);r+=d-a.size,n.push(this.Nr.addEntry(e,s,l))}else if(r-=a.size,this.trackRemovals){const l=zE(this.Nr.serializer,o.convertToNoDocument(pe.min()));n.push(this.Nr.addEntry(e,s,l))}}),i.forEach(s=>{n.push(this.Nr.indexManager.addToCollectionParentIndex(e,s))}),n.push(this.Nr.updateMetadata(e,r)),V.waitFor(n)}getFromCache(e,n){return this.Nr.vr(e,n).next(r=>(this.Br.set(n,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,n){return this.Nr.Mr(e,n).next(({documents:r,Or:i})=>(i.forEach((s,o)=>{this.Br.set(s,{size:o,readTime:r.get(s).readTime})}),r))}}function oI(t){return Pt(t,cc)}function us(t){return Pt(t,Md)}function nl(t){const e=t.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function aI(t,e){const n=e.documentKey.path.toArray();return[t,Wd(e.readTime),n.slice(0,n.length-2),n.length>0?n[n.length-1]:""]}function lI(t,e){const n=t.path.toArray(),r=e.path.toArray();let i=0;for(let s=0;s<n.length-2&&s<r.length-2;++s)if(i=Ie(n[s],r[s]),i)return i;return i=Ie(n.length,r.length),i||(i=Ie(n[n.length-2],r[r.length-2]),i||Ie(n[n.length-1],r[r.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HO{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dA{constructor(e,n,r,i){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,n))).next(i=>(r!==null&&Ol(r.mutation,i,_n.empty(),Oe.now()),i))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,Ce()).next(()=>r))}getLocalViewOfDocuments(e,n,r=Ce()){const i=xr();return this.populateOverlays(e,i,n).next(()=>this.computeViews(e,n,i,r).next(s=>{let o=fl();return s.forEach((a,l)=>{o=o.insert(a,l.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){const r=xr();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,Ce()))}populateOverlays(e,n,r){const i=[];return r.forEach(s=>{n.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((o,a)=>{n.set(o,a)})})}computeViews(e,n,r,i){let s=Rn();const o=Vl(),a=function(){return Vl()}();return n.forEach((l,d)=>{const h=r.get(d.key);i.has(d.key)&&(h===void 0||h.mutation instanceof ni)?s=s.insert(d.key,d):h!==void 0?(o.set(d.key,h.mutation.getFieldMask()),Ol(h.mutation,d,h.mutation.getFieldMask(),Oe.now())):o.set(d.key,_n.empty())}),this.recalculateAndSaveOverlays(e,s).next(l=>(l.forEach((d,h)=>o.set(d,h)),n.forEach((d,h)=>a.set(d,new HO(h,o.get(d)??null))),a))}recalculateAndSaveOverlays(e,n){const r=Vl();let i=new st((o,a)=>o-a),s=Ce();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(const a of o)a.keys().forEach(l=>{const d=n.get(l);if(d===null)return;let h=r.get(l)||_n.empty();h=a.applyToLocalView(d,h),r.set(l,h);const f=(i.get(a.batchId)||Ce()).add(l);i=i.insert(a.batchId,f)})}).next(()=>{const o=[],a=i.getReverseIterator();for(;a.hasNext();){const l=a.getNext(),d=l.key,h=l.value,f=Rb();h.forEach(m=>{if(!s.has(m)){const v=Ob(n.get(m),r.get(m));v!==null&&f.set(m,v),s=s.add(m)}}),o.push(this.documentOverlayCache.saveOverlays(e,d,f))}return V.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,i){return function(o){return J.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):Py(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,i):this.getDocumentsMatchingCollectionQuery(e,n,r,i)}getNextDocuments(e,n,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,i).next(s=>{const o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,i-s.size):V.resolve(xr());let a=sc,l=s;return o.next(d=>V.forEach(d,(h,f)=>(a<f.largestBatchId&&(a=f.largestBatchId),s.get(h)?V.resolve():this.remoteDocumentCache.getEntry(e,h).next(m=>{l=l.insert(h,m)}))).next(()=>this.populateOverlays(e,d,s)).next(()=>this.computeViews(e,l,d,Ce())).next(h=>({batchId:a,changes:Cb(h)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new J(n)).next(r=>{let i=fl();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,n,r,i){const s=n.collectionGroup;let o=fl();return this.indexManager.getCollectionParents(e,s).next(a=>V.forEach(a,l=>{const d=function(f,m){return new ss(m,null,f.explicitOrderBy.slice(),f.filters.slice(),f.limit,f.limitType,f.startAt,f.endAt)}(n,l.child(s));return this.getDocumentsMatchingCollectionQuery(e,d,r,i).next(h=>{h.forEach((f,m)=>{o=o.insert(f,m)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,n,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,s,i))).next(o=>{s.forEach((l,d)=>{const h=d.getKey();o.get(h)===null&&(o=o.insert(h,pt.newInvalidDocument(h)))});let a=fl();return o.forEach((l,d)=>{const h=s.get(l);h!==void 0&&Ol(h.mutation,d,_n.empty(),Oe.now()),kc(n,d)&&(a=a.insert(l,d))}),a})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WO{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,n){return V.resolve(this.Lr.get(n))}saveBundleMetadata(e,n){return this.Lr.set(n.id,function(i){return{id:i.id,version:i.version,createTime:un(i.createTime)}}(n)),V.resolve()}getNamedQuery(e,n){return V.resolve(this.kr.get(n))}saveNamedQuery(e,n){return this.kr.set(n.name,function(i){return{name:i.name,query:eA(i.bundledQuery),readTime:un(i.readTime)}}(n)),V.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KO{constructor(){this.overlays=new st(J.comparator),this.qr=new Map}getOverlay(e,n){return V.resolve(this.overlays.get(n))}getOverlays(e,n){const r=xr();return V.forEach(n,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((i,s)=>{this.St(e,n,s)}),V.resolve()}removeOverlaysForBatchId(e,n,r){const i=this.qr.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.qr.delete(r)),V.resolve()}getOverlaysForCollection(e,n,r){const i=xr(),s=n.length+1,o=new J(n.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const l=a.getNext().value,d=l.getKey();if(!n.isPrefixOf(d.path))break;d.path.length===s&&l.largestBatchId>r&&i.set(l.getKey(),l)}return V.resolve(i)}getOverlaysForCollectionGroup(e,n,r,i){let s=new st((d,h)=>d-h);const o=this.overlays.getIterator();for(;o.hasNext();){const d=o.getNext().value;if(d.getKey().getCollectionGroup()===n&&d.largestBatchId>r){let h=s.get(d.largestBatchId);h===null&&(h=xr(),s=s.insert(d.largestBatchId,h)),h.set(d.getKey(),d)}}const a=xr(),l=s.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((d,h)=>a.set(d,h)),!(a.size()>=i)););return V.resolve(a)}St(e,n,r){const i=this.overlays.get(r.key);if(i!==null){const o=this.qr.get(i.largestBatchId).delete(r.key);this.qr.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new jy(n,r));let s=this.qr.get(n);s===void 0&&(s=Ce(),this.qr.set(n,s)),this.qr.set(n,s.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GO{constructor(){this.sessionToken=xt.EMPTY_BYTE_STRING}getSessionToken(e){return V.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,V.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uy{constructor(){this.Qr=new Ke(jt.$r),this.Ur=new Ke(jt.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,n){const r=new jt(e,n);this.Qr=this.Qr.add(r),this.Ur=this.Ur.add(r)}Wr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Gr(new jt(e,n))}zr(e,n){e.forEach(r=>this.removeReference(r,n))}jr(e){const n=new J(new Me([])),r=new jt(n,e),i=new jt(n,e+1),s=[];return this.Ur.forEachInRange([r,i],o=>{this.Gr(o),s.push(o.key)}),s}Jr(){this.Qr.forEach(e=>this.Gr(e))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const n=new J(new Me([])),r=new jt(n,e),i=new jt(n,e+1);let s=Ce();return this.Ur.forEachInRange([r,i],o=>{s=s.add(o.key)}),s}containsKey(e){const n=new jt(e,0),r=this.Qr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class jt{constructor(e,n){this.key=e,this.Yr=n}static $r(e,n){return J.comparator(e.key,n.key)||Ie(e.Yr,n.Yr)}static Kr(e,n){return Ie(e.Yr,n.Yr)||J.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QO{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.tr=1,this.Zr=new Ke(jt.$r)}checkEmpty(e){return V.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,i){const s=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new Ny(s,n,r,i);this.mutationQueue.push(o);for(const a of i)this.Zr=this.Zr.add(new jt(a.key,s)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return V.resolve(o)}lookupMutationBatch(e,n){return V.resolve(this.Xr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,i=this.ei(r),s=i<0?0:i;return V.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return V.resolve(this.mutationQueue.length===0?Rs:this.tr-1)}getAllMutationBatches(e){return V.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new jt(n,0),i=new jt(n,Number.POSITIVE_INFINITY),s=[];return this.Zr.forEachInRange([r,i],o=>{const a=this.Xr(o.Yr);s.push(a)}),V.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Ke(Ie);return n.forEach(i=>{const s=new jt(i,0),o=new jt(i,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([s,o],a=>{r=r.add(a.Yr)})}),V.resolve(this.ti(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,i=r.length+1;let s=r;J.isDocumentKey(s)||(s=s.child(""));const o=new jt(new J(s),0);let a=new Ke(Ie);return this.Zr.forEachWhile(l=>{const d=l.key.path;return!!r.isPrefixOf(d)&&(d.length===i&&(a=a.add(l.Yr)),!0)},o),V.resolve(this.ti(a))}ti(e){const n=[];return e.forEach(r=>{const i=this.Xr(r);i!==null&&n.push(i)}),n}removeMutationBatch(e,n){ue(this.ni(n.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Zr;return V.forEach(n.mutations,i=>{const s=new jt(i.key,n.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.Zr=r})}ir(e){}containsKey(e,n){const r=new jt(n,0),i=this.Zr.firstAfterOrEqual(r);return V.resolve(n.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,V.resolve()}ni(e,n){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const n=this.ei(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YO{constructor(e){this.ri=e,this.docs=function(){return new st(J.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,i=this.docs.get(r),s=i?i.size:0,o=this.ri(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return V.resolve(r?r.document.mutableCopy():pt.newInvalidDocument(n))}getEntries(e,n){let r=Rn();return n.forEach(i=>{const s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():pt.newInvalidDocument(i))}),V.resolve(r)}getDocumentsMatchingQuery(e,n,r,i){let s=Rn();const o=n.path,a=new J(o.child("__id-9223372036854775808__")),l=this.docs.getIteratorFrom(a);for(;l.hasNext();){const{key:d,value:{document:h}}=l.getNext();if(!o.isPrefixOf(d.path))break;d.path.length>o.length+1||Ey(KS(h),r)<=0||(i.has(h.key)||kc(n,h))&&(s=s.insert(h.key,h.mutableCopy()))}return V.resolve(s)}getAllFromCollectionGroup(e,n,r,i){le(9500)}ii(e,n){return V.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new XO(this)}getSize(e){return V.resolve(this.size)}}class XO extends cA{constructor(e){super(),this.Nr=e}applyChanges(e){const n=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?n.push(this.Nr.addEntry(e,i)):this.Nr.removeEntry(r)}),V.waitFor(n)}getFromCache(e,n){return this.Nr.getEntry(e,n)}getAllFromCache(e,n){return this.Nr.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JO{constructor(e){this.persistence=e,this.si=new ti(n=>Hs(n),Rc),this.lastRemoteSnapshotVersion=pe.min(),this.highestTargetId=0,this.oi=0,this._i=new Uy,this.targetCount=0,this.ai=Qs.ur()}forEachTarget(e,n){return this.si.forEach((r,i)=>n(i)),V.resolve()}getLastRemoteSnapshotVersion(e){return V.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return V.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),V.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.oi&&(this.oi=n),V.resolve()}Pr(e){this.si.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.ai=new Qs(n),this.highestTargetId=n),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,n){return this.Pr(n),this.targetCount+=1,V.resolve()}updateTargetData(e,n){return this.Pr(n),V.resolve()}removeTargetData(e,n){return this.si.delete(n.target),this._i.jr(n.targetId),this.targetCount-=1,V.resolve()}removeTargets(e,n,r){let i=0;const s=[];return this.si.forEach((o,a)=>{a.sequenceNumber<=n&&r.get(a.targetId)===null&&(this.si.delete(o),s.push(this.removeMatchingKeysForTargetId(e,a.targetId)),i++)}),V.waitFor(s).next(()=>i)}getTargetCount(e){return V.resolve(this.targetCount)}getTargetData(e,n){const r=this.si.get(n)||null;return V.resolve(r)}addMatchingKeys(e,n,r){return this._i.Wr(n,r),V.resolve()}removeMatchingKeys(e,n,r){this._i.zr(n,r);const i=this.persistence.referenceDelegate,s=[];return i&&n.forEach(o=>{s.push(i.markPotentiallyOrphaned(e,o))}),V.waitFor(s)}removeMatchingKeysForTargetId(e,n){return this._i.jr(n),V.resolve()}getMatchingKeysForTargetId(e,n){const r=this._i.Hr(n);return V.resolve(r)}containsKey(e,n){return V.resolve(this._i.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class By{constructor(e,n){this.ui={},this.overlays={},this.ci=new zn(0),this.li=!1,this.li=!0,this.hi=new GO,this.referenceDelegate=e(this),this.Pi=new JO(this),this.indexManager=new OO,this.remoteDocumentCache=function(i){return new YO(i)}(r=>this.referenceDelegate.Ti(r)),this.serializer=new Jb(n),this.Ii=new WO(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new KO,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.ui[e.toKey()];return r||(r=new QO(n,this.referenceDelegate),this.ui[e.toKey()]=r),r}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,n,r){q("MemoryPersistence","Starting transaction:",e);const i=new ZO(this.ci.next());return this.referenceDelegate.Ei(),r(i).next(s=>this.referenceDelegate.di(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Ai(e,n){return V.or(Object.values(this.ui).map(r=>()=>r.containsKey(e,n)))}}class ZO extends QS{constructor(e){super(),this.currentSequenceNumber=e}}class Gh{constructor(e){this.persistence=e,this.Ri=new Uy,this.Vi=null}static mi(e){return new Gh(e)}get fi(){if(this.Vi)return this.Vi;throw le(60996)}addReference(e,n,r){return this.Ri.addReference(r,n),this.fi.delete(r.toString()),V.resolve()}removeReference(e,n,r){return this.Ri.removeReference(r,n),this.fi.add(r.toString()),V.resolve()}markPotentiallyOrphaned(e,n){return this.fi.add(n.toString()),V.resolve()}removeTarget(e,n){this.Ri.jr(n.targetId).forEach(i=>this.fi.add(i.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(i=>{i.forEach(s=>this.fi.add(s.toString()))}).next(()=>r.removeTargetData(e,n))}Ei(){this.Vi=new Set}di(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return V.forEach(this.fi,r=>{const i=J.fromPath(r);return this.gi(e,i).next(s=>{s||n.removeEntry(i,pe.min())})}).next(()=>(this.Vi=null,n.apply(e)))}updateLimboDocument(e,n){return this.gi(e,n).next(r=>{r?this.fi.delete(n.toString()):this.fi.add(n.toString())})}Ti(e){return 0}gi(e,n){return V.or([()=>V.resolve(this.Ri.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Ai(e,n)])}}class Qd{constructor(e,n){this.persistence=e,this.pi=new ti(r=>tn(r.path),(r,i)=>r.isEqual(i)),this.garbageCollector=lA(this,n)}static mi(e,n){return new Qd(e,n)}Ei(){}di(e){return V.resolve()}forEachTarget(e,n){return this.persistence.getTargetCache().forEachTarget(e,n)}gr(e){const n=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next(r=>n.next(i=>r+i))}wr(e){let n=0;return this.pr(e,r=>{n++}).next(()=>n)}pr(e,n){return V.forEach(this.pi,(r,i)=>this.br(e,r,i).next(s=>s?V.resolve():n(i)))}removeTargets(e,n,r){return this.persistence.getTargetCache().removeTargets(e,n,r)}removeOrphanedDocuments(e,n){let r=0;const i=this.persistence.getRemoteDocumentCache(),s=i.newChangeBuffer();return i.ii(e,o=>this.br(e,o,n).next(a=>{a||(r++,s.removeEntry(o,pe.min()))})).next(()=>s.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,n){return this.pi.set(n,e.currentSequenceNumber),V.resolve()}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,n,r){return this.pi.set(r,e.currentSequenceNumber),V.resolve()}removeReference(e,n,r){return this.pi.set(r,e.currentSequenceNumber),V.resolve()}updateLimboDocument(e,n){return this.pi.set(n,e.currentSequenceNumber),V.resolve()}Ti(e){let n=e.key.toString().length;return e.isFoundDocument()&&(n+=Yu(e.data.value)),n}br(e,n,r){return V.or([()=>this.persistence.Ai(e,n),()=>this.persistence.getTargetCache().containsKey(e,n),()=>{const i=this.pi.get(n);return V.resolve(i!==void 0&&i>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eL{constructor(e){this.serializer=e}k(e,n,r,i){const s=new Nh("createOrUpgrade",n);r<1&&i>=1&&(function(l){l.createObjectStore(Cc)}(e),function(l){l.createObjectStore(lc,{keyPath:cV}),l.createObjectStore(tr,{keyPath:vE,autoIncrement:!0}).createIndex(Ss,wE,{unique:!0}),l.createObjectStore(la)}(e),cI(e),function(l){l.createObjectStore(gs)}(e));let o=V.resolve();return r<3&&i>=3&&(r!==0&&(function(l){l.deleteObjectStore(ua),l.deleteObjectStore(ca),l.deleteObjectStore(Ps)}(e),cI(e)),o=o.next(()=>function(l){const d=l.store(Ps),h={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:pe.min().toTimestamp(),targetCount:0};return d.put(Fd,h)}(s))),r<4&&i>=4&&(r!==0&&(o=o.next(()=>function(l,d){return d.store(tr).J().next(f=>{l.deleteObjectStore(tr),l.createObjectStore(tr,{keyPath:vE,autoIncrement:!0}).createIndex(Ss,wE,{unique:!0});const m=d.store(tr),v=f.map(C=>m.put(C));return V.waitFor(v)})}(e,s))),o=o.next(()=>{(function(l){l.createObjectStore(da,{keyPath:_V})})(e)})),r<5&&i>=5&&(o=o.next(()=>this.yi(s))),r<6&&i>=6&&(o=o.next(()=>(function(l){l.createObjectStore(cc)}(e),this.wi(s)))),r<7&&i>=7&&(o=o.next(()=>this.Si(s))),r<8&&i>=8&&(o=o.next(()=>this.bi(e,s))),r<9&&i>=9&&(o=o.next(()=>{(function(l){l.objectStoreNames.contains("remoteDocumentChanges")&&l.deleteObjectStore("remoteDocumentChanges")})(e)})),r<10&&i>=10&&(o=o.next(()=>this.Di(s))),r<11&&i>=11&&(o=o.next(()=>{(function(l){l.createObjectStore(jh,{keyPath:vV})})(e),function(l){l.createObjectStore(Vh,{keyPath:wV})}(e)})),r<12&&i>=12&&(o=o.next(()=>{(function(l){const d=l.createObjectStore(Oh,{keyPath:AV});d.createIndex(Vm,CV,{unique:!1}),d.createIndex(nb,RV,{unique:!1})})(e)})),r<13&&i>=13&&(o=o.next(()=>function(l){const d=l.createObjectStore(Md,{keyPath:dV});d.createIndex(Gu,hV),d.createIndex(JS,fV)}(e)).next(()=>this.Ci(e,s)).next(()=>e.deleteObjectStore(gs))),r<14&&i>=14&&(o=o.next(()=>this.Fi(e,s))),r<15&&i>=15&&(o=o.next(()=>function(l){l.createObjectStore(xy,{keyPath:EV,autoIncrement:!0}).createIndex(jm,IV,{unique:!1}),l.createObjectStore(Nl,{keyPath:TV}).createIndex(eb,xV,{unique:!1}),l.createObjectStore(Dl,{keyPath:SV}).createIndex(tb,bV,{unique:!1})}(e))),r<16&&i>=16&&(o=o.next(()=>{n.objectStore(Nl).clear()}).next(()=>{n.objectStore(Dl).clear()})),r<17&&i>=17&&(o=o.next(()=>{(function(l){l.createObjectStore(Sy,{keyPath:PV})})(e)})),r<18&&i>=18&&Gx()&&(o=o.next(()=>{n.objectStore(Nl).clear()}).next(()=>{n.objectStore(Dl).clear()})),o}wi(e){let n=0;return e.store(gs).ee((r,i)=>{n+=Gd(i)}).next(()=>{const r={byteSize:n};return e.store(cc).put(Dm,r)})}yi(e){const n=e.store(lc),r=e.store(tr);return n.J().next(i=>V.forEach(i,s=>{const o=IDBKeyRange.bound([s.userId,Rs],[s.userId,s.lastAcknowledgedBatchId]);return r.J(Ss,o).next(a=>V.forEach(a,l=>{ue(l.userId===s.userId,18650,"Cannot process batch from unexpected user",{batchId:l.batchId});const d=_s(this.serializer,l);return iA(e,s.userId,d).next(()=>{})}))}))}Si(e){const n=e.store(ua),r=e.store(gs);return e.store(Ps).get(Fd).next(i=>{const s=[];return r.ee((o,a)=>{const l=new Me(o),d=function(f){return[0,tn(f)]}(l);s.push(n.get(d).next(h=>h?V.resolve():(f=>n.put({targetId:0,path:tn(f),sequenceNumber:i.highestListenSequenceNumber}))(l)))}).next(()=>V.waitFor(s))})}bi(e,n){e.createObjectStore(uc,{keyPath:yV});const r=n.store(uc),i=new Fy,s=o=>{if(i.add(o)){const a=o.lastSegment(),l=o.popLast();return r.put({collectionId:a,parent:tn(l)})}};return n.store(gs).ee({X:!0},(o,a)=>{const l=new Me(o);return s(l.popLast())}).next(()=>n.store(la).ee({X:!0},([o,a,l],d)=>{const h=Tr(a);return s(h.popLast())}))}Di(e){const n=e.store(ca);return n.ee((r,i)=>{const s=ml(i),o=Zb(this.serializer,s);return n.put(o)})}Ci(e,n){const r=n.store(gs),i=[];return r.ee((s,o)=>{const a=n.store(Md),l=function(f){return f.document?new J(Me.fromString(f.document.name).popFirst(5)):f.noDocument?J.fromSegments(f.noDocument.path):f.unknownDocument?J.fromSegments(f.unknownDocument.path):le(36783)}(o).path.toArray(),d={prefixPath:l.slice(0,l.length-2),collectionGroup:l[l.length-2],documentId:l[l.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};i.push(a.put(d))}).next(()=>V.waitFor(i))}Fi(e,n){const r=n.store(tr),i=uA(this.serializer),s=new By(Gh.mi,this.serializer.yt);return r.J().next(o=>{const a=new Map;return o.forEach(l=>{let d=a.get(l.userId)??Ce();_s(this.serializer,l).keys().forEach(h=>d=d.add(h)),a.set(l.userId,d)}),V.forEach(a,(l,d)=>{const h=new Ft(d),f=Wh.wt(this.serializer,h),m=s.getIndexManager(h),v=Kh.wt(h,this.serializer,m,s.referenceDelegate);return new dA(i,v,f,m).recalculateAndSaveOverlaysForDocumentKeys(new Om(n,zn.ce),l).next()})})}}function cI(t){t.createObjectStore(ua,{keyPath:mV}).createIndex(Ty,gV,{unique:!0}),t.createObjectStore(ca,{keyPath:"targetId"}).createIndex(ZS,pV,{unique:!0}),t.createObjectStore(Ps)}const pi="IndexedDbPersistence",cp=18e5,up=5e3,dp="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",tL="main";class $y{constructor(e,n,r,i,s,o,a,l,d,h,f=18){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.Mi=s,this.window=o,this.document=a,this.xi=d,this.Oi=h,this.Ni=f,this.ci=null,this.li=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Bi=null,this.inForeground=!1,this.Li=null,this.ki=null,this.qi=Number.NEGATIVE_INFINITY,this.Qi=m=>Promise.resolve(),!$y.v())throw new W(B.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new $O(this,i),this.$i=n+tL,this.serializer=new Jb(l),this.Ui=new Bi(this.$i,this.Ni,new eL(this.serializer)),this.hi=new PO,this.Pi=new MO(this.referenceDelegate,this.serializer),this.remoteDocumentCache=uA(this.serializer),this.Ii=new RO,this.window&&this.window.localStorage?this.Ki=this.window.localStorage:(this.Ki=null,h===!1&&an(pi,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Wi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new W(B.FAILED_PRECONDITION,dp);return this.Gi(),this.zi(),this.ji(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Pi.getHighestSequenceNumber(e))}).then(e=>{this.ci=new zn(e,this.xi)}).then(()=>{this.li=!0}).catch(e=>(this.Ui&&this.Ui.close(),Promise.reject(e)))}Ji(e){return this.Qi=async n=>{if(this.started)return e(n)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ui.$(async n=>{n.newVersion===null&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Mi.enqueueAndForget(async()=>{this.started&&await this.Wi()}))}Wi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>Eu(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.Hi(e).next(n=>{n||(this.isPrimary=!1,this.Mi.enqueueRetryable(()=>this.Qi(!1)))})}).next(()=>this.Yi(e)).next(n=>this.isPrimary&&!n?this.Zi(e).next(()=>!1):!!n&&this.Xi(e).next(()=>!0))).catch(e=>{if(rs(e))return q(pi,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return q(pi,"Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.Mi.enqueueRetryable(()=>this.Qi(e)),this.isPrimary=e})}Hi(e){return rl(e).get(ho).next(n=>V.resolve(this.es(n)))}ts(e){return Eu(e).delete(this.clientId)}async ns(){if(this.isPrimary&&!this.rs(this.qi,cp)){this.qi=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",n=>{const r=Pt(n,da);return r.J().next(i=>{const s=this.ss(i,cp),o=i.filter(a=>s.indexOf(a)===-1);return V.forEach(o,a=>r.delete(a.clientId)).next(()=>o)})}).catch(()=>[]);if(this.Ki)for(const n of e)this.Ki.removeItem(this._s(n.clientId))}}ji(){this.ki=this.Mi.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.Wi().then(()=>this.ns()).then(()=>this.ji()))}es(e){return!!e&&e.ownerId===this.clientId}Yi(e){return this.Oi?V.resolve(!0):rl(e).get(ho).next(n=>{if(n!==null&&this.rs(n.leaseTimestampMs,up)&&!this.us(n.ownerId)){if(this.es(n)&&this.networkEnabled)return!0;if(!this.es(n)){if(!n.allowTabSynchronization)throw new W(B.FAILED_PRECONDITION,dp);return!1}}return!(!this.networkEnabled||!this.inForeground)||Eu(e).J().next(r=>this.ss(r,up).find(i=>{if(this.clientId!==i.clientId){const s=!this.networkEnabled&&i.networkEnabled,o=!this.inForeground&&i.inForeground,a=this.networkEnabled===i.networkEnabled;if(s||o&&a)return!0}return!1})===void 0)}).next(n=>(this.isPrimary!==n&&q(pi,`Client ${n?"is":"is not"} eligible for a primary lease.`),n))}async shutdown(){this.li=!1,this.cs(),this.ki&&(this.ki.cancel(),this.ki=null),this.ls(),this.hs(),await this.Ui.runTransaction("shutdown","readwrite",[Cc,da],e=>{const n=new Om(e,zn.ce);return this.Zi(n).next(()=>this.ts(n))}),this.Ui.close(),this.Ps()}ss(e,n){return e.filter(r=>this.rs(r.updateTimeMs,n)&&!this.us(r.clientId))}Ts(){return this.runTransaction("getActiveClients","readonly",e=>Eu(e).J().next(n=>this.ss(n,cp).map(r=>r.clientId)))}get started(){return this.li}getGlobalsCache(){return this.hi}getMutationQueue(e,n){return Kh.wt(e,this.serializer,n,this.referenceDelegate)}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new LO(e,this.serializer.yt.databaseId)}getDocumentOverlayCache(e){return Wh.wt(this.serializer,e)}getBundleCache(){return this.Ii}runTransaction(e,n,r){q(pi,"Starting transaction:",e);const i=n==="readonly"?"readonly":"readwrite",s=function(l){return l===18?DV:l===17?ob:l===16?NV:l===15?by:l===14?sb:l===13?ib:l===12?kV:l===11?rb:void le(60245)}(this.Ni);let o;return this.Ui.runTransaction(e,i,s,a=>(o=new Om(a,this.ci?this.ci.next():zn.ce),n==="readwrite-primary"?this.Hi(o).next(l=>!!l||this.Yi(o)).next(l=>{if(!l)throw an(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Mi.enqueueRetryable(()=>this.Qi(!1)),new W(B.FAILED_PRECONDITION,GS);return r(o)}).next(l=>this.Xi(o).next(()=>l)):this.Is(o).next(()=>r(o)))).then(a=>(o.raiseOnCommittedEvent(),a))}Is(e){return rl(e).get(ho).next(n=>{if(n!==null&&this.rs(n.leaseTimestampMs,up)&&!this.us(n.ownerId)&&!this.es(n)&&!(this.Oi||this.allowTabSynchronization&&n.allowTabSynchronization))throw new W(B.FAILED_PRECONDITION,dp)})}Xi(e){const n={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return rl(e).put(ho,n)}static v(){return Bi.v()}Zi(e){const n=rl(e);return n.get(ho).next(r=>this.es(r)?(q(pi,"Releasing primary lease."),n.delete(ho)):V.resolve())}rs(e,n){const r=Date.now();return!(e<r-n)&&(!(e>r)||(an(`Detected an update time that is in the future: ${e} > ${r}`),!1))}Gi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Li=()=>{this.Mi.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.Wi()))},this.document.addEventListener("visibilitychange",this.Li),this.inForeground=this.document.visibilityState==="visible")}ls(){this.Li&&(this.document.removeEventListener("visibilitychange",this.Li),this.Li=null)}zi(){var e;typeof((e=this.window)==null?void 0:e.addEventListener)=="function"&&(this.Bi=()=>{this.cs();const n=/(?:Version|Mobile)\/1[456]/;Kx()&&(navigator.appVersion.match(n)||navigator.userAgent.match(n))&&this.Mi.enterRestrictedMode(!0),this.Mi.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Bi))}hs(){this.Bi&&(this.window.removeEventListener("pagehide",this.Bi),this.Bi=null)}us(e){var n;try{const r=((n=this.Ki)==null?void 0:n.getItem(this._s(e)))!==null;return q(pi,`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return an(pi,"Failed to get zombied client id.",r),!1}}cs(){if(this.Ki)try{this.Ki.setItem(this._s(this.clientId),String(Date.now()))}catch(e){an("Failed to set zombie client id.",e)}}Ps(){if(this.Ki)try{this.Ki.removeItem(this._s(this.clientId))}catch{}}_s(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function rl(t){return Pt(t,Cc)}function Eu(t){return Pt(t,da)}function nL(t,e){let n=t.projectId;return t.isDefaultDatabase||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zy{constructor(e,n,r,i){this.targetId=e,this.fromCache=n,this.Es=r,this.ds=i}static As(e,n){let r=Ce(),i=Ce();for(const s of n.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new zy(e,n.fromCache,r,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rL{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hA{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=function(){return Kx()?8:YS(Rt())>0?6:4}()}initialize(e,n){this.ps=e,this.indexManager=n,this.Rs=!0}getDocumentsMatchingQuery(e,n,r,i){const s={result:null};return this.ys(e,n).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.ws(e,n,i,r).next(o=>{s.result=o})}).next(()=>{if(s.result)return;const o=new rL;return this.Ss(e,n,o).next(a=>{if(s.result=a,this.Vs)return this.bs(e,n,o,a.size)})}).next(()=>s.result)}bs(e,n,r,i){return r.documentReadCount<this.fs?(Io()<=De.DEBUG&&q("QueryEngine","SDK will not create cache indexes for query:",To(n),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),V.resolve()):(Io()<=De.DEBUG&&q("QueryEngine","Query:",To(n),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.gs*i?(Io()<=De.DEBUG&&q("QueryEngine","The SDK decides to create cache indexes for query:",To(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Hn(n))):V.resolve())}ys(e,n){if(DE(n))return V.resolve(null);let r=Hn(n);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(n.limit!==null&&i===1&&(n=zd(n,null,"F"),r=Hn(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{const o=Ce(...s);return this.ps.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,r).next(l=>{const d=this.Ds(n,a);return this.Cs(n,d,o,l.readTime)?this.ys(e,zd(n,null,"F")):this.vs(e,d,n,l)}))})))}ws(e,n,r,i){return DE(n)||i.isEqual(pe.min())?V.resolve(null):this.ps.getDocuments(e,r).next(s=>{const o=this.Ds(n,s);return this.Cs(n,o,r,i)?V.resolve(null):(Io()<=De.DEBUG&&q("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),To(n)),this.vs(e,o,n,nV(i,sc)).next(a=>a))})}Ds(e,n){let r=new Ke(bb(e));return n.forEach((i,s)=>{kc(e,s)&&(r=r.add(s))}),r}Cs(e,n,r,i){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const s=e.limitType==="F"?n.last():n.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Ss(e,n,r){return Io()<=De.DEBUG&&q("QueryEngine","Using full collection scan to execute query:",To(n)),this.ps.getDocumentsMatchingQuery(e,n,Dn.min(),r)}vs(e,n,r,i){return this.ps.getDocumentsMatchingQuery(e,r,i).next(s=>(n.forEach(o=>{s=s.insert(o.key,o)}),s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qy="LocalStore",iL=3e8;class sL{constructor(e,n,r,i){this.persistence=e,this.Fs=n,this.serializer=i,this.Ms=new st(Ie),this.xs=new ti(s=>Hs(s),Rc),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(r)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new dA(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.Ms))}}function fA(t,e,n,r){return new sL(t,e,n,r)}async function pA(t,e){const n=_e(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let i;return n.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,n.Bs(e),n.mutationQueue.getAllMutationBatches(r))).next(s=>{const o=[],a=[];let l=Ce();for(const d of i){o.push(d.batchId);for(const h of d.mutations)l=l.add(h.key)}for(const d of s){a.push(d.batchId);for(const h of d.mutations)l=l.add(h.key)}return n.localDocuments.getDocuments(r,l).next(d=>({Ls:d,removedBatchIds:o,addedBatchIds:a}))})})}function oL(t,e){const n=_e(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const i=e.batch.keys(),s=n.Ns.newChangeBuffer({trackRemovals:!0});return function(a,l,d,h){const f=d.batch,m=f.keys();let v=V.resolve();return m.forEach(C=>{v=v.next(()=>h.getEntry(l,C)).next(y=>{const N=d.docVersions.get(C);ue(N!==null,48541),y.version.compareTo(N)<0&&(f.applyToRemoteDocument(y,d),y.isValidDocument()&&(y.setReadTime(d.commitVersion),h.addEntry(y)))})}),v.next(()=>a.mutationQueue.removeMutationBatch(l,f))}(n,r,e,s).next(()=>s.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let l=Ce();for(let d=0;d<a.mutationResults.length;++d)a.mutationResults[d].transformResults.length>0&&(l=l.add(a.batch.mutations[d].key));return l}(e))).next(()=>n.localDocuments.getDocuments(r,i))})}function mA(t){const e=_e(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Pi.getLastRemoteSnapshotVersion(n))}function aL(t,e){const n=_e(t),r=e.snapshotVersion;let i=n.Ms;return n.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const o=n.Ns.newChangeBuffer({trackRemovals:!0});i=n.Ms;const a=[];e.targetChanges.forEach((h,f)=>{const m=i.get(f);if(!m)return;a.push(n.Pi.removeMatchingKeys(s,h.removedDocuments,f).next(()=>n.Pi.addMatchingKeys(s,h.addedDocuments,f)));let v=m.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(f)!==null?v=v.withResumeToken(xt.EMPTY_BYTE_STRING,pe.min()).withLastLimboFreeSnapshotVersion(pe.min()):h.resumeToken.approximateByteSize()>0&&(v=v.withResumeToken(h.resumeToken,r)),i=i.insert(f,v),function(y,N,I){return y.resumeToken.approximateByteSize()===0||N.snapshotVersion.toMicroseconds()-y.snapshotVersion.toMicroseconds()>=iL?!0:I.addedDocuments.size+I.modifiedDocuments.size+I.removedDocuments.size>0}(m,v,h)&&a.push(n.Pi.updateTargetData(s,v))});let l=Rn(),d=Ce();if(e.documentUpdates.forEach(h=>{e.resolvedLimboDocuments.has(h)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(s,h))}),a.push(lL(s,o,e.documentUpdates).next(h=>{l=h.ks,d=h.qs})),!r.isEqual(pe.min())){const h=n.Pi.getLastRemoteSnapshotVersion(s).next(f=>n.Pi.setTargetsMetadata(s,s.currentSequenceNumber,r));a.push(h)}return V.waitFor(a).next(()=>o.apply(s)).next(()=>n.localDocuments.getLocalViewOfDocuments(s,l,d)).next(()=>l)}).then(s=>(n.Ms=i,s))}function lL(t,e,n){let r=Ce(),i=Ce();return n.forEach(s=>r=r.add(s)),e.getEntries(t,r).next(s=>{let o=Rn();return n.forEach((a,l)=>{const d=s.get(a);l.isFoundDocument()!==d.isFoundDocument()&&(i=i.add(a)),l.isNoDocument()&&l.version.isEqual(pe.min())?(e.removeEntry(a,l.readTime),o=o.insert(a,l)):!d.isValidDocument()||l.version.compareTo(d.version)>0||l.version.compareTo(d.version)===0&&d.hasPendingWrites?(e.addEntry(l),o=o.insert(a,l)):q(qy,"Ignoring outdated watch update for ",a,". Current version:",d.version," Watch version:",l.version)}),{ks:o,qs:i}})}function cL(t,e){const n=_e(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=Rs),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function uL(t,e){const n=_e(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return n.Pi.getTargetData(r,e).next(s=>s?(i=s,V.resolve(i)):n.Pi.allocateTargetId(r).next(o=>(i=new Br(e,o,"TargetPurposeListen",r.currentSequenceNumber),n.Pi.addTargetData(r,i).next(()=>i))))}).then(r=>{const i=n.Ms.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(n.Ms=n.Ms.insert(r.targetId,r),n.xs.set(e,r.targetId)),r})}async function Ym(t,e,n){const r=_e(t),i=r.Ms.get(e),s=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",s,o=>r.persistence.referenceDelegate.removeTarget(o,i))}catch(o){if(!rs(o))throw o;q(qy,`Failed to update sequence numbers for target ${e}: ${o}`)}r.Ms=r.Ms.remove(e),r.xs.delete(i.target)}function uI(t,e,n){const r=_e(t);let i=pe.min(),s=Ce();return r.persistence.runTransaction("Execute query","readwrite",o=>function(l,d,h){const f=_e(l),m=f.xs.get(h);return m!==void 0?V.resolve(f.Ms.get(m)):f.Pi.getTargetData(d,h)}(r,o,Hn(e)).next(a=>{if(a)return i=a.lastLimboFreeSnapshotVersion,r.Pi.getMatchingKeysForTargetId(o,a.targetId).next(l=>{s=l})}).next(()=>r.Fs.getDocumentsMatchingQuery(o,e,n?i:pe.min(),n?s:Ce())).next(a=>(dL(r,QV(e),a),{documents:a,Qs:s})))}function dL(t,e,n){let r=t.Os.get(e)||pe.min();n.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),t.Os.set(e,r)}class dI{constructor(){this.activeTargetIds=tO()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class gA{constructor(){this.Mo=new dI,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,n,r){this.xo[e]=n}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new dI,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hL{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hI="ConnectivityMonitor";class fI{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){q(hI,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){q(hI,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Iu=null;function Xm(){return Iu===null?Iu=function(){return 268435456+Math.round(2147483648*Math.random())}():Iu++,"0x"+Iu.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hp="RestConnection",fL={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class pL{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const n=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Uo=n+"://"+e.host,this.Ko=`projects/${r}/databases/${i}`,this.Wo=this.databaseId.database===Ud?`project_id=${r}`:`project_id=${r}&database_id=${i}`}Go(e,n,r,i,s){const o=Xm(),a=this.zo(e,n.toUriEncodedString());q(hp,`Sending RPC '${e}' ${o}:`,a,r);const l={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(l,i,s);const{host:d}=new URL(a),h=es(d);return this.Jo(e,a,l,r,h).then(f=>(q(hp,`Received RPC '${e}' ${o}: `,f),f),f=>{throw $s(hp,`RPC '${e}' ${o} failed with error: `,f,"url: ",a,"request:",r),f})}Ho(e,n,r,i,s,o){return this.Go(e,n,r,i,s)}jo(e,n,r){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Ca}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((i,s)=>e[s]=i),r&&r.headers.forEach((i,s)=>e[s]=i)}zo(e,n){const r=fL[e];return`${this.Uo}/v1/${n}:${r}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mL{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qt="WebChannelConnection";class gL extends pL{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,n,r,i,s){const o=Xm();return new Promise((a,l)=>{const d=new LS;d.setWithCredentials(!0),d.listenOnce(MS.COMPLETE,()=>{try{switch(d.getLastErrorCode()){case Hu.NO_ERROR:const f=d.getResponseJson();q(Qt,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(f)),a(f);break;case Hu.TIMEOUT:q(Qt,`RPC '${e}' ${o} timed out`),l(new W(B.DEADLINE_EXCEEDED,"Request time out"));break;case Hu.HTTP_ERROR:const m=d.getStatus();if(q(Qt,`RPC '${e}' ${o} failed with status:`,m,"response text:",d.getResponseText()),m>0){let v=d.getResponseJson();Array.isArray(v)&&(v=v[0]);const C=v==null?void 0:v.error;if(C&&C.status&&C.message){const y=function(I){const _=I.toLowerCase().replace(/_/g,"-");return Object.values(B).indexOf(_)>=0?_:B.UNKNOWN}(C.status);l(new W(y,C.message))}else l(new W(B.UNKNOWN,"Server responded with status "+d.getStatus()))}else l(new W(B.UNAVAILABLE,"Connection failed."));break;default:le(9055,{l_:e,streamId:o,h_:d.getLastErrorCode(),P_:d.getLastError()})}}finally{q(Qt,`RPC '${e}' ${o} completed.`)}});const h=JSON.stringify(i);q(Qt,`RPC '${e}' ${o} sending request:`,i),d.send(n,"POST",h,r,15)})}T_(e,n,r){const i=Xm(),s=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=BS(),a=US(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},d=this.longPollingOptions.timeoutSeconds;d!==void 0&&(l.longPollingTimeout=Math.round(1e3*d)),this.useFetchStreams&&(l.useFetchStreams=!0),this.jo(l.initMessageHeaders,n,r),l.encodeInitMessageHeaders=!0;const h=s.join("");q(Qt,`Creating RPC '${e}' stream ${i}: ${h}`,l);const f=o.createWebChannel(h,l);this.I_(f);let m=!1,v=!1;const C=new mL({Yo:N=>{v?q(Qt,`Not sending because RPC '${e}' stream ${i} is closed:`,N):(m||(q(Qt,`Opening RPC '${e}' stream ${i} transport.`),f.open(),m=!0),q(Qt,`RPC '${e}' stream ${i} sending:`,N),f.send(N))},Zo:()=>f.close()}),y=(N,I,_)=>{N.listen(I,T=>{try{_(T)}catch(R){setTimeout(()=>{throw R},0)}})};return y(f,hl.EventType.OPEN,()=>{v||(q(Qt,`RPC '${e}' stream ${i} transport opened.`),C.o_())}),y(f,hl.EventType.CLOSE,()=>{v||(v=!0,q(Qt,`RPC '${e}' stream ${i} transport closed`),C.a_(),this.E_(f))}),y(f,hl.EventType.ERROR,N=>{v||(v=!0,$s(Qt,`RPC '${e}' stream ${i} transport errored. Name:`,N.name,"Message:",N.message),C.a_(new W(B.UNAVAILABLE,"The operation could not be completed")))}),y(f,hl.EventType.MESSAGE,N=>{var I;if(!v){const _=N.data[0];ue(!!_,16349);const T=_,R=(T==null?void 0:T.error)||((I=T[0])==null?void 0:I.error);if(R){q(Qt,`RPC '${e}' stream ${i} received error:`,R);const O=R.status;let $=function(A){const k=Et[A];if(k!==void 0)return Fb(k)}(O),x=R.message;$===void 0&&($=B.INTERNAL,x="Unknown error status: "+O+" with message "+R.message),v=!0,C.a_(new W($,x)),f.close()}else q(Qt,`RPC '${e}' stream ${i} received:`,_),C.u_(_)}}),y(a,FS.STAT_EVENT,N=>{N.stat===Pm.PROXY?q(Qt,`RPC '${e}' stream ${i} detected buffering proxy`):N.stat===Pm.NOPROXY&&q(Qt,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{C.__()},0),C}terminate(){this.c_.forEach(e=>e.close()),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter(n=>n===e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yL(){return typeof window<"u"?window:null}function td(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qh(t){return new yO(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yA{constructor(e,n,r=1e3,i=1.5,s=6e4){this.Mi=e,this.timerId=n,this.d_=r,this.A_=i,this.R_=s,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const n=Math.floor(this.V_+this.y_()),r=Math.max(0,Date.now()-this.f_),i=Math.max(0,n-r);i>0&&q("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.V_} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,i,()=>(this.f_=Date.now(),e())),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pI="PersistentStream";class _A{constructor(e,n,r,i,s,o,a,l){this.Mi=e,this.S_=r,this.b_=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=l,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new yA(e,n)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,()=>this.k_()))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,n){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():n&&n.code===B.RESOURCE_EXHAUSTED?(an(n.toString()),an("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):n&&n.code===B.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(n)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),n=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.D_===n&&this.G_(r,i)},r=>{e(()=>{const i=new W(B.UNKNOWN,"Fetching auth token failed: "+r.message);return this.z_(i)})})}G_(e,n){const r=this.W_(this.D_);this.stream=this.j_(e,n),this.stream.Xo(()=>{r(()=>this.listener.Xo())}),this.stream.t_(()=>{r(()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.t_()))}),this.stream.r_(i=>{r(()=>this.z_(i))}),this.stream.onMessage(i=>{r(()=>++this.F_==1?this.J_(i):this.onNext(i))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return q(pI,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return n=>{this.Mi.enqueueAndForget(()=>this.D_===e?n():(q(pI,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class _L extends _A{constructor(e,n,r,i,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s}j_(e,n){return this.connection.T_("Listen",e,n)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const n=wO(this.serializer,e),r=function(s){if(!("targetChange"in s))return pe.min();const o=s.targetChange;return o.targetIds&&o.targetIds.length?pe.min():o.readTime?un(o.readTime):pe.min()}(e);return this.listener.H_(n,r)}Y_(e){const n={};n.database=Hm(this.serializer),n.addTarget=function(s,o){let a;const l=o.target;if(a=Bd(l)?{documents:Kb(s,l)}:{query:Ly(s,l).ft},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=$b(s,o.resumeToken);const d=zm(s,o.expectedCount);d!==null&&(a.expectedCount=d)}else if(o.snapshotVersion.compareTo(pe.min())>0){a.readTime=_a(s,o.snapshotVersion.toTimestamp());const d=zm(s,o.expectedCount);d!==null&&(a.expectedCount=d)}return a}(this.serializer,e);const r=TO(this.serializer,e);r&&(n.labels=r),this.q_(n)}Z_(e){const n={};n.database=Hm(this.serializer),n.removeTarget=e,this.q_(n)}}class vL extends _A{constructor(e,n,r,i,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,n){return this.connection.T_("Write",e,n)}J_(e){return ue(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,ue(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){ue(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const n=EO(e.writeResults,e.commitTime),r=un(e.commitTime);return this.listener.na(r,n)}ra(){const e={};e.database=Hm(this.serializer),this.q_(e)}ea(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>Hd(this.serializer,r))};this.q_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wL{}class EL extends wL{constructor(e,n,r,i){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=i,this.ia=!1}sa(){if(this.ia)throw new W(B.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,n,r,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.Go(e,qm(n,r),i,s,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===B.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new W(B.UNKNOWN,s.toString())})}Ho(e,n,r,i,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.Ho(e,qm(n,r),i,o,a,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===B.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new W(B.UNKNOWN,o.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}class IL{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(an(n),this.aa=!1):q("OnlineStateTracker",n)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ys="RemoteStore";class TL{constructor(e,n,r,i,s){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=s,this.Aa.Oo(o=>{r.enqueueAndForget(async()=>{oo(this)&&(q(Ys,"Restarting streams for network reachability change."),await async function(l){const d=_e(l);d.Ea.add(4),await Dc(d),d.Ra.set("Unknown"),d.Ea.delete(4),await Yh(d)}(this))})}),this.Ra=new IL(r,i)}}async function Yh(t){if(oo(t))for(const e of t.da)await e(!0)}async function Dc(t){for(const e of t.da)await e(!1)}function vA(t,e){const n=_e(t);n.Ia.has(e.targetId)||(n.Ia.set(e.targetId,e),Gy(n)?Ky(n):Pa(n).O_()&&Wy(n,e))}function Hy(t,e){const n=_e(t),r=Pa(n);n.Ia.delete(e),r.O_()&&wA(n,e),n.Ia.size===0&&(r.O_()?r.L_():oo(n)&&n.Ra.set("Unknown"))}function Wy(t,e){if(t.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(pe.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}Pa(t).Y_(e)}function wA(t,e){t.Va.Ue(e),Pa(t).Z_(e)}function Ky(t){t.Va=new fO({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),At:e=>t.Ia.get(e)||null,ht:()=>t.datastore.serializer.databaseId}),Pa(t).start(),t.Ra.ua()}function Gy(t){return oo(t)&&!Pa(t).x_()&&t.Ia.size>0}function oo(t){return _e(t).Ea.size===0}function EA(t){t.Va=void 0}async function xL(t){t.Ra.set("Online")}async function SL(t){t.Ia.forEach((e,n)=>{Wy(t,e)})}async function bL(t,e){EA(t),Gy(t)?(t.Ra.ha(e),Ky(t)):t.Ra.set("Unknown")}async function AL(t,e,n){if(t.Ra.set("Online"),e instanceof Bb&&e.state===2&&e.cause)try{await async function(i,s){const o=s.cause;for(const a of s.targetIds)i.Ia.has(a)&&(await i.remoteSyncer.rejectListen(a,o),i.Ia.delete(a),i.Va.removeTarget(a))}(t,e)}catch(r){q(Ys,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await Yd(t,r)}else if(e instanceof Zu?t.Va.Ze(e):e instanceof Ub?t.Va.st(e):t.Va.tt(e),!n.isEqual(pe.min()))try{const r=await mA(t.localStore);n.compareTo(r)>=0&&await function(s,o){const a=s.Va.Tt(o);return a.targetChanges.forEach((l,d)=>{if(l.resumeToken.approximateByteSize()>0){const h=s.Ia.get(d);h&&s.Ia.set(d,h.withResumeToken(l.resumeToken,o))}}),a.targetMismatches.forEach((l,d)=>{const h=s.Ia.get(l);if(!h)return;s.Ia.set(l,h.withResumeToken(xt.EMPTY_BYTE_STRING,h.snapshotVersion)),wA(s,l);const f=new Br(h.target,l,d,h.sequenceNumber);Wy(s,f)}),s.remoteSyncer.applyRemoteEvent(a)}(t,n)}catch(r){q(Ys,"Failed to raise snapshot:",r),await Yd(t,r)}}async function Yd(t,e,n){if(!rs(e))throw e;t.Ea.add(1),await Dc(t),t.Ra.set("Offline"),n||(n=()=>mA(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{q(Ys,"Retrying IndexedDB access"),await n(),t.Ea.delete(1),await Yh(t)})}function IA(t,e){return e().catch(n=>Yd(t,n,e))}async function jc(t){const e=_e(t),n=Gi(e);let r=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:Rs;for(;CL(e);)try{const i=await cL(e.localStore,r);if(i===null){e.Ta.length===0&&n.L_();break}r=i.batchId,RL(e,i)}catch(i){await Yd(e,i)}TA(e)&&xA(e)}function CL(t){return oo(t)&&t.Ta.length<10}function RL(t,e){t.Ta.push(e);const n=Gi(t);n.O_()&&n.X_&&n.ea(e.mutations)}function TA(t){return oo(t)&&!Gi(t).x_()&&t.Ta.length>0}function xA(t){Gi(t).start()}async function PL(t){Gi(t).ra()}async function kL(t){const e=Gi(t);for(const n of t.Ta)e.ea(n.mutations)}async function NL(t,e,n){const r=t.Ta.shift(),i=Dy.from(r,e,n);await IA(t,()=>t.remoteSyncer.applySuccessfulWrite(i)),await jc(t)}async function DL(t,e){e&&Gi(t).X_&&await async function(r,i){if(function(o){return uO(o)&&o!==B.ABORTED}(i.code)){const s=r.Ta.shift();Gi(r).B_(),await IA(r,()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i)),await jc(r)}}(t,e),TA(t)&&xA(t)}async function mI(t,e){const n=_e(t);n.asyncQueue.verifyOperationInProgress(),q(Ys,"RemoteStore received new credentials");const r=oo(n);n.Ea.add(3),await Dc(n),r&&n.Ra.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.Ea.delete(3),await Yh(n)}async function jL(t,e){const n=_e(t);e?(n.Ea.delete(2),await Yh(n)):e||(n.Ea.add(2),await Dc(n),n.Ra.set("Unknown"))}function Pa(t){return t.ma||(t.ma=function(n,r,i){const s=_e(n);return s.sa(),new _L(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Xo:xL.bind(null,t),t_:SL.bind(null,t),r_:bL.bind(null,t),H_:AL.bind(null,t)}),t.da.push(async e=>{e?(t.ma.B_(),Gy(t)?Ky(t):t.Ra.set("Unknown")):(await t.ma.stop(),EA(t))})),t.ma}function Gi(t){return t.fa||(t.fa=function(n,r,i){const s=_e(n);return s.sa(),new vL(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Xo:()=>Promise.resolve(),t_:PL.bind(null,t),r_:DL.bind(null,t),ta:kL.bind(null,t),na:NL.bind(null,t)}),t.da.push(async e=>{e?(t.fa.B_(),await jc(t)):(await t.fa.stop(),t.Ta.length>0&&(q(Ys,`Stopping write stream with ${t.Ta.length} pending writes`),t.Ta=[]))})),t.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qy{constructor(e,n,r,i,s){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new ar,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,i,s){const o=Date.now()+r,a=new Qy(e,n,o,i,s);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new W(B.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Yy(t,e){if(an("AsyncQueue",`${e}: ${t}`),rs(t))return new W(B.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qo{static emptySet(e){return new Qo(e.comparator)}constructor(e){this.comparator=e?(n,r)=>e(n,r)||J.comparator(n.key,r.key):(n,r)=>J.comparator(n.key,r.key),this.keyedMap=fl(),this.sortedSet=new st(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof Qo)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const i=n.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new Qo;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gI{constructor(){this.ga=new st(J.comparator)}track(e){const n=e.doc.key,r=this.ga.get(n);r?e.type!==0&&r.type===3?this.ga=this.ga.insert(n,e):e.type===3&&r.type!==1?this.ga=this.ga.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.ga=this.ga.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.ga=this.ga.remove(n):e.type===1&&r.type===2?this.ga=this.ga.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):le(63341,{Rt:e,pa:r}):this.ga=this.ga.insert(n,e)}ya(){const e=[];return this.ga.inorderTraversal((n,r)=>{e.push(r)}),e}}class va{constructor(e,n,r,i,s,o,a,l,d){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=l,this.hasCachedResults=d}static fromInitialDocuments(e,n,r,i,s){const o=[];return n.forEach(a=>{o.push({type:0,doc:a})}),new va(e,n,Qo.emptySet(n),o,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Uh(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let i=0;i<n.length;i++)if(n[i].type!==r[i].type||!n[i].doc.isEqual(r[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VL{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some(e=>e.Da())}}class OL{constructor(){this.queries=yI(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(n,r){const i=_e(n),s=i.queries;i.queries=yI(),s.forEach((o,a)=>{for(const l of a.Sa)l.onError(r)})})(this,new W(B.ABORTED,"Firestore shutting down"))}}function yI(){return new ti(t=>Sb(t),Uh)}async function Xy(t,e){const n=_e(t);let r=3;const i=e.query;let s=n.queries.get(i);s?!s.ba()&&e.Da()&&(r=2):(s=new VL,r=e.Da()?0:1);try{switch(r){case 0:s.wa=await n.onListen(i,!0);break;case 1:s.wa=await n.onListen(i,!1);break;case 2:await n.onFirstRemoteStoreListen(i)}}catch(o){const a=Yy(o,`Initialization of query '${To(e.query)}' failed`);return void e.onError(a)}n.queries.set(i,s),s.Sa.push(e),e.va(n.onlineState),s.wa&&e.Fa(s.wa)&&Zy(n)}async function Jy(t,e){const n=_e(t),r=e.query;let i=3;const s=n.queries.get(r);if(s){const o=s.Sa.indexOf(e);o>=0&&(s.Sa.splice(o,1),s.Sa.length===0?i=e.Da()?0:1:!s.ba()&&e.Da()&&(i=2))}switch(i){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function LL(t,e){const n=_e(t);let r=!1;for(const i of e){const s=i.query,o=n.queries.get(s);if(o){for(const a of o.Sa)a.Fa(i)&&(r=!0);o.wa=i}}r&&Zy(n)}function ML(t,e,n){const r=_e(t),i=r.queries.get(e);if(i)for(const s of i.Sa)s.onError(n);r.queries.delete(e)}function Zy(t){t.Ca.forEach(e=>{e.next()})}var Jm,_I;(_I=Jm||(Jm={})).Ma="default",_I.Cache="cache";class e_{constructor(e,n,r){this.query=e,this.xa=n,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=r||{}}Fa(e){if(!this.options.includeMetadataChanges){const r=[];for(const i of e.docChanges)i.type!==3&&r.push(i);e=new va(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),n=!0):this.La(e,this.onlineState)&&(this.ka(e),n=!0),this.Na=e,n}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let n=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),n=!0),n}La(e,n){if(!e.fromCache||!this.Da())return!0;const r=n!=="Offline";return(!this.options.qa||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const n=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}ka(e){e=va.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==Jm.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SA{constructor(e){this.key=e}}class bA{constructor(e){this.key=e}}class FL{constructor(e,n){this.query=e,this.Ya=n,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=Ce(),this.mutatedKeys=Ce(),this.eu=bb(e),this.tu=new Qo(this.eu)}get nu(){return this.Ya}ru(e,n){const r=n?n.iu:new gI,i=n?n.tu:this.tu;let s=n?n.mutatedKeys:this.mutatedKeys,o=i,a=!1;const l=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,d=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((h,f)=>{const m=i.get(h),v=kc(this.query,f)?f:null,C=!!m&&this.mutatedKeys.has(m.key),y=!!v&&(v.hasLocalMutations||this.mutatedKeys.has(v.key)&&v.hasCommittedMutations);let N=!1;m&&v?m.data.isEqual(v.data)?C!==y&&(r.track({type:3,doc:v}),N=!0):this.su(m,v)||(r.track({type:2,doc:v}),N=!0,(l&&this.eu(v,l)>0||d&&this.eu(v,d)<0)&&(a=!0)):!m&&v?(r.track({type:0,doc:v}),N=!0):m&&!v&&(r.track({type:1,doc:m}),N=!0,(l||d)&&(a=!0)),N&&(v?(o=o.add(v),s=y?s.add(h):s.delete(h)):(o=o.delete(h),s=s.delete(h)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const h=this.query.limitType==="F"?o.last():o.first();o=o.delete(h.key),s=s.delete(h.key),r.track({type:1,doc:h})}return{tu:o,iu:r,Cs:a,mutatedKeys:s}}su(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,i){const s=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const o=e.iu.ya();o.sort((h,f)=>function(v,C){const y=N=>{switch(N){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return le(20277,{Rt:N})}};return y(v)-y(C)}(h.type,f.type)||this.eu(h.doc,f.doc)),this.ou(r),i=i??!1;const a=n&&!i?this._u():[],l=this.Xa.size===0&&this.current&&!i?1:0,d=l!==this.Za;return this.Za=l,o.length!==0||d?{snapshot:new va(this.query,e.tu,s,o,e.mutatedKeys,l===0,d,!1,!!r&&r.resumeToken.approximateByteSize()>0),au:a}:{au:a}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new gI,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(n=>this.Ya=this.Ya.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Ya=this.Ya.delete(n)),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=Ce(),this.tu.forEach(r=>{this.uu(r.key)&&(this.Xa=this.Xa.add(r.key))});const n=[];return e.forEach(r=>{this.Xa.has(r)||n.push(new bA(r))}),this.Xa.forEach(r=>{e.has(r)||n.push(new SA(r))}),n}cu(e){this.Ya=e.Qs,this.Xa=Ce();const n=this.ru(e.documents);return this.applyChanges(n,!0)}lu(){return va.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const t_="SyncEngine";class UL{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class BL{constructor(e){this.key=e,this.hu=!1}}class $L{constructor(e,n,r,i,s,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.Pu={},this.Tu=new ti(a=>Sb(a),Uh),this.Iu=new Map,this.Eu=new Set,this.du=new st(J.comparator),this.Au=new Map,this.Ru=new Uy,this.Vu={},this.mu=new Map,this.fu=Qs.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function zL(t,e,n=!0){const r=NA(t);let i;const s=r.Tu.get(e);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.lu()):i=await AA(r,e,n,!0),i}async function qL(t,e){const n=NA(t);await AA(n,e,!0,!1)}async function AA(t,e,n,r){const i=await uL(t.localStore,Hn(e)),s=i.targetId,o=t.sharedClientState.addLocalQueryTarget(s,n);let a;return r&&(a=await HL(t,e,s,o==="current",i.resumeToken)),t.isPrimaryClient&&n&&vA(t.remoteStore,i),a}async function HL(t,e,n,r,i){t.pu=(f,m,v)=>async function(y,N,I,_){let T=N.view.ru(I);T.Cs&&(T=await uI(y.localStore,N.query,!1).then(({documents:x})=>N.view.ru(x,T)));const R=_&&_.targetChanges.get(N.targetId),O=_&&_.targetMismatches.get(N.targetId)!=null,$=N.view.applyChanges(T,y.isPrimaryClient,R,O);return wI(y,N.targetId,$.au),$.snapshot}(t,f,m,v);const s=await uI(t.localStore,e,!0),o=new FL(e,s.Qs),a=o.ru(s.documents),l=Nc.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",i),d=o.applyChanges(a,t.isPrimaryClient,l);wI(t,n,d.au);const h=new UL(e,n,o);return t.Tu.set(e,h),t.Iu.has(n)?t.Iu.get(n).push(e):t.Iu.set(n,[e]),d.snapshot}async function WL(t,e,n){const r=_e(t),i=r.Tu.get(e),s=r.Iu.get(i.targetId);if(s.length>1)return r.Iu.set(i.targetId,s.filter(o=>!Uh(o,e))),void r.Tu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await Ym(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),n&&Hy(r.remoteStore,i.targetId),Zm(r,i.targetId)}).catch(so)):(Zm(r,i.targetId),await Ym(r.localStore,i.targetId,!0))}async function KL(t,e){const n=_e(t),r=n.Tu.get(e),i=n.Iu.get(r.targetId);n.isPrimaryClient&&i.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),Hy(n.remoteStore,r.targetId))}async function GL(t,e,n){const r=DA(t);try{const i=await function(o,a){const l=_e(o),d=Oe.now(),h=a.reduce((v,C)=>v.add(C.key),Ce());let f,m;return l.persistence.runTransaction("Locally write mutations","readwrite",v=>{let C=Rn(),y=Ce();return l.Ns.getEntries(v,h).next(N=>{C=N,C.forEach((I,_)=>{_.isValidDocument()||(y=y.add(I))})}).next(()=>l.localDocuments.getOverlayedDocuments(v,C)).next(N=>{f=N;const I=[];for(const _ of a){const T=aO(_,f.get(_.key).overlayedDocument);T!=null&&I.push(new ni(_.key,T,gb(T.value.mapValue),Zt.exists(!0)))}return l.mutationQueue.addMutationBatch(v,d,I,a)}).next(N=>{m=N;const I=N.applyToLocalDocumentSet(f,y);return l.documentOverlayCache.saveOverlays(v,N.batchId,I)})}).then(()=>({batchId:m.batchId,changes:Cb(f)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(o,a,l){let d=o.Vu[o.currentUser.toKey()];d||(d=new st(Ie)),d=d.insert(a,l),o.Vu[o.currentUser.toKey()]=d}(r,i.batchId,n),await Vc(r,i.changes),await jc(r.remoteStore)}catch(i){const s=Yy(i,"Failed to persist write");n.reject(s)}}async function CA(t,e){const n=_e(t);try{const r=await aL(n.localStore,e);e.targetChanges.forEach((i,s)=>{const o=n.Au.get(s);o&&(ue(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?o.hu=!0:i.modifiedDocuments.size>0?ue(o.hu,14607):i.removedDocuments.size>0&&(ue(o.hu,42227),o.hu=!1))}),await Vc(n,r,e)}catch(r){await so(r)}}function vI(t,e,n){const r=_e(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const i=[];r.Tu.forEach((s,o)=>{const a=o.view.va(e);a.snapshot&&i.push(a.snapshot)}),function(o,a){const l=_e(o);l.onlineState=a;let d=!1;l.queries.forEach((h,f)=>{for(const m of f.Sa)m.va(a)&&(d=!0)}),d&&Zy(l)}(r.eventManager,e),i.length&&r.Pu.H_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function QL(t,e,n){const r=_e(t);r.sharedClientState.updateQueryState(e,"rejected",n);const i=r.Au.get(e),s=i&&i.key;if(s){let o=new st(J.comparator);o=o.insert(s,pt.newNoDocument(s,pe.min()));const a=Ce().add(s),l=new Hh(pe.min(),new Map,new st(Ie),o,a);await CA(r,l),r.du=r.du.remove(s),r.Au.delete(e),n_(r)}else await Ym(r.localStore,e,!1).then(()=>Zm(r,e,n)).catch(so)}async function YL(t,e){const n=_e(t),r=e.batch.batchId;try{const i=await oL(n.localStore,e);PA(n,r,null),RA(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await Vc(n,i)}catch(i){await so(i)}}async function XL(t,e,n){const r=_e(t);try{const i=await function(o,a){const l=_e(o);return l.persistence.runTransaction("Reject batch","readwrite-primary",d=>{let h;return l.mutationQueue.lookupMutationBatch(d,a).next(f=>(ue(f!==null,37113),h=f.keys(),l.mutationQueue.removeMutationBatch(d,f))).next(()=>l.mutationQueue.performConsistencyCheck(d)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(d,h,a)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(d,h)).next(()=>l.localDocuments.getDocuments(d,h))})}(r.localStore,e);PA(r,e,n),RA(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await Vc(r,i)}catch(i){await so(i)}}function RA(t,e){(t.mu.get(e)||[]).forEach(n=>{n.resolve()}),t.mu.delete(e)}function PA(t,e,n){const r=_e(t);let i=r.Vu[r.currentUser.toKey()];if(i){const s=i.get(e);s&&(n?s.reject(n):s.resolve(),i=i.remove(e)),r.Vu[r.currentUser.toKey()]=i}}function Zm(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Iu.get(e))t.Tu.delete(r),n&&t.Pu.yu(r,n);t.Iu.delete(e),t.isPrimaryClient&&t.Ru.jr(e).forEach(r=>{t.Ru.containsKey(r)||kA(t,r)})}function kA(t,e){t.Eu.delete(e.path.canonicalString());const n=t.du.get(e);n!==null&&(Hy(t.remoteStore,n),t.du=t.du.remove(e),t.Au.delete(n),n_(t))}function wI(t,e,n){for(const r of n)r instanceof SA?(t.Ru.addReference(r.key,e),JL(t,r)):r instanceof bA?(q(t_,"Document no longer in limbo: "+r.key),t.Ru.removeReference(r.key,e),t.Ru.containsKey(r.key)||kA(t,r.key)):le(19791,{wu:r})}function JL(t,e){const n=e.key,r=n.path.canonicalString();t.du.get(n)||t.Eu.has(r)||(q(t_,"New document in limbo: "+n),t.Eu.add(r),n_(t))}function n_(t){for(;t.Eu.size>0&&t.du.size<t.maxConcurrentLimboResolutions;){const e=t.Eu.values().next().value;t.Eu.delete(e);const n=new J(Me.fromString(e)),r=t.fu.next();t.Au.set(r,new BL(n)),t.du=t.du.insert(n,r),vA(t.remoteStore,new Br(Hn(Pc(n.path)),r,"TargetPurposeLimboResolution",zn.ce))}}async function Vc(t,e,n){const r=_e(t),i=[],s=[],o=[];r.Tu.isEmpty()||(r.Tu.forEach((a,l)=>{o.push(r.pu(l,e,n).then(d=>{var h;if((d||n)&&r.isPrimaryClient){const f=d?!d.fromCache:(h=n==null?void 0:n.targetChanges.get(l.targetId))==null?void 0:h.current;r.sharedClientState.updateQueryState(l.targetId,f?"current":"not-current")}if(d){i.push(d);const f=zy.As(l.targetId,d);s.push(f)}}))}),await Promise.all(o),r.Pu.H_(i),await async function(l,d){const h=_e(l);try{await h.persistence.runTransaction("notifyLocalViewChanges","readwrite",f=>V.forEach(d,m=>V.forEach(m.Es,v=>h.persistence.referenceDelegate.addReference(f,m.targetId,v)).next(()=>V.forEach(m.ds,v=>h.persistence.referenceDelegate.removeReference(f,m.targetId,v)))))}catch(f){if(!rs(f))throw f;q(qy,"Failed to update sequence numbers: "+f)}for(const f of d){const m=f.targetId;if(!f.fromCache){const v=h.Ms.get(m),C=v.snapshotVersion,y=v.withLastLimboFreeSnapshotVersion(C);h.Ms=h.Ms.insert(m,y)}}}(r.localStore,s))}async function ZL(t,e){const n=_e(t);if(!n.currentUser.isEqual(e)){q(t_,"User change. New user:",e.toKey());const r=await pA(n.localStore,e);n.currentUser=e,function(s,o){s.mu.forEach(a=>{a.forEach(l=>{l.reject(new W(B.CANCELLED,o))})}),s.mu.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await Vc(n,r.Ls)}}function eM(t,e){const n=_e(t),r=n.Au.get(e);if(r&&r.hu)return Ce().add(r.key);{let i=Ce();const s=n.Iu.get(e);if(!s)return i;for(const o of s){const a=n.Tu.get(o);i=i.unionWith(a.view.nu)}return i}}function NA(t){const e=_e(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=CA.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=eM.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=QL.bind(null,e),e.Pu.H_=LL.bind(null,e.eventManager),e.Pu.yu=ML.bind(null,e.eventManager),e}function DA(t){const e=_e(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=YL.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=XL.bind(null,e),e}class mc{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Qh(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,n){return null}Mu(e,n){return null}vu(e){return fA(this.persistence,new hA,e.initialUser,this.serializer)}Cu(e){return new By(Gh.mi,this.serializer)}Du(e){return new gA}async terminate(){var e,n;(e=this.gcScheduler)==null||e.stop(),(n=this.indexBackfillerScheduler)==null||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}mc.provider={build:()=>new mc};class tM extends mc{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,n){ue(this.persistence.referenceDelegate instanceof Qd,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new aA(r,e.asyncQueue,n)}Cu(e){const n=this.cacheSizeBytes!==void 0?Yt.withCacheSize(this.cacheSizeBytes):Yt.DEFAULT;return new By(r=>Qd.mi(r,n),this.serializer)}}class nM extends mc{constructor(e,n,r){super(),this.xu=e,this.cacheSizeBytes=n,this.forceOwnership=r,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.xu.initialize(this,e),await DA(this.xu.syncEngine),await jc(this.xu.remoteStore),await this.persistence.Ji(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}vu(e){return fA(this.persistence,new hA,e.initialUser,this.serializer)}Fu(e,n){const r=this.persistence.referenceDelegate.garbageCollector;return new aA(r,e.asyncQueue,n)}Mu(e,n){const r=new oV(n,this.persistence);return new sV(e.asyncQueue,r)}Cu(e){const n=nL(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?Yt.withCacheSize(this.cacheSizeBytes):Yt.DEFAULT;return new $y(this.synchronizeTabs,n,e.clientId,r,e.asyncQueue,yL(),td(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Du(e){return new gA}}class Xd{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>vI(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=ZL.bind(null,this.syncEngine),await jL(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new OL}()}createDatastore(e){const n=Qh(e.databaseInfo.databaseId),r=function(s){return new gL(s)}(e.databaseInfo);return function(s,o,a,l){return new EL(s,o,a,l)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,i,s,o,a){return new TL(r,i,s,o,a)}(this.localStore,this.datastore,e.asyncQueue,n=>vI(this.syncEngine,n,0),function(){return fI.v()?new fI:new hL}())}createSyncEngine(e,n){return function(i,s,o,a,l,d,h){const f=new $L(i,s,o,a,l,d);return h&&(f.gu=!0),f}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(i){const s=_e(i);q(Ys,"RemoteStore shutting down."),s.Ea.add(5),await Dc(s),s.Aa.shutdown(),s.Ra.set("Unknown")}(this.remoteStore),(e=this.datastore)==null||e.terminate(),(n=this.eventManager)==null||n.terminate()}}Xd.provider={build:()=>new Xd};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class r_{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):an("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qi="FirestoreClient";class rM{constructor(e,n,r,i,s){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=i,this.user=Ft.UNAUTHENTICATED,this.clientId=wy.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(r,async o=>{q(Qi,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>(q(Qi,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new ar;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=Yy(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function fp(t,e){t.asyncQueue.verifyOperationInProgress(),q(Qi,"Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async i=>{r.isEqual(i)||(await pA(e.localStore,i),r=i)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function EI(t,e){t.asyncQueue.verifyOperationInProgress();const n=await iM(t);q(Qi,"Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>mI(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,i)=>mI(e.remoteStore,i)),t._onlineComponents=e}async function iM(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){q(Qi,"Using user provided OfflineComponentProvider");try{await fp(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(i){return i.name==="FirebaseError"?i.code===B.FAILED_PRECONDITION||i.code===B.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(n))throw n;$s("Error using user provided cache. Falling back to memory cache: "+n),await fp(t,new mc)}}else q(Qi,"Using default OfflineComponentProvider"),await fp(t,new tM(void 0));return t._offlineComponents}async function i_(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(q(Qi,"Using user provided OnlineComponentProvider"),await EI(t,t._uninitializedComponentsProvider._online)):(q(Qi,"Using default OnlineComponentProvider"),await EI(t,new Xd))),t._onlineComponents}function sM(t){return i_(t).then(e=>e.syncEngine)}function oM(t){return i_(t).then(e=>e.datastore)}async function Jd(t){const e=await i_(t),n=e.eventManager;return n.onListen=zL.bind(null,e.syncEngine),n.onUnlisten=WL.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=qL.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=KL.bind(null,e.syncEngine),n}function aM(t,e,n={}){const r=new ar;return t.asyncQueue.enqueueAndForget(async()=>function(s,o,a,l,d){const h=new r_({next:m=>{h.Nu(),o.enqueueAndForget(()=>Jy(s,f));const v=m.docs.has(a);!v&&m.fromCache?d.reject(new W(B.UNAVAILABLE,"Failed to get document because the client is offline.")):v&&m.fromCache&&l&&l.source==="server"?d.reject(new W(B.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):d.resolve(m)},error:m=>d.reject(m)}),f=new e_(Pc(a.path),h,{includeMetadataChanges:!0,qa:!0});return Xy(s,f)}(await Jd(t),t.asyncQueue,e,n,r)),r.promise}function lM(t,e,n={}){const r=new ar;return t.asyncQueue.enqueueAndForget(async()=>function(s,o,a,l,d){const h=new r_({next:m=>{h.Nu(),o.enqueueAndForget(()=>Jy(s,f)),m.fromCache&&l.source==="server"?d.reject(new W(B.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):d.resolve(m)},error:m=>d.reject(m)}),f=new e_(a,h,{includeMetadataChanges:!0,qa:!0});return Xy(s,f)}(await Jd(t),t.asyncQueue,e,n,r)),r.promise}function cM(t,e,n){const r=new ar;return t.asyncQueue.enqueueAndForget(async()=>{try{const i=await oM(t);r.resolve(async function(o,a,l){var y;const d=_e(o),{request:h,gt:f,parent:m}=IO(d.serializer,GV(a),l);d.connection.$o||delete h.parent;const v=(await d.Ho("RunAggregationQuery",d.serializer.databaseId,m,h,1)).filter(N=>!!N.result);ue(v.length===1,64727);const C=(y=v[0].result)==null?void 0:y.aggregateFields;return Object.keys(C).reduce((N,I)=>(N[f[I]]=C[I],N),{})}(i,e,n))}catch(i){r.reject(i)}}),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jA(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const II=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VA="firestore.googleapis.com",TI=!0;class xI{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new W(B.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=VA,this.ssl=TI}else this.host=e.host,this.ssl=e.ssl??TI;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=rA;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<FO)throw new W(B.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}eV("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=jA(e.experimentalLongPollingOptions??{}),function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new W(B.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new W(B.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new W(B.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Xh{constructor(e,n,r,i){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new xI({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new W(B.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new W(B.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new xI(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new q2;switch(r.type){case"firstParty":return new G2(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new W(B.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=II.get(n);r&&(q("ComponentProvider","Removing Datastore"),II.delete(n),r.terminate())}(this),Promise.resolve()}}function uM(t,e,n,r={}){var d;t=en(t,Xh);const i=es(e),s=t._getSettings(),o={...s,emulatorOptions:t._getEmulatorOptions()},a=`${e}:${n}`;i&&(sy(`https://${a}`),oy("Firestore",!0)),s.host!==VA&&s.host!==a&&$s("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const l={...s,host:a,ssl:i,emulatorOptions:r};if(!Qr(l,o)&&(t._setSettings(l),r.mockUserToken)){let h,f;if(typeof r.mockUserToken=="string")h=r.mockUserToken,f=Ft.MOCK_USER;else{h=qx(r.mockUserToken,(d=t._app)==null?void 0:d.options.projectId);const m=r.mockUserToken.sub||r.mockUserToken.user_id;if(!m)throw new W(B.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");f=new Ft(m)}t._authCredentials=new H2(new zS(h,f))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fr{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new fr(this.firestore,e,this._query)}}class mt{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new $i(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new mt(this.firestore,e,this._key)}toJSON(){return{type:mt._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,n,r){if(Ac(n,mt._jsonSchema))return new mt(e,r||null,new J(Me.fromString(n.referencePath)))}}mt._jsonSchemaVersion="firestore/documentReference/1.0",mt._jsonSchema={type:Tt("string",mt._jsonSchemaVersion),referencePath:Tt("string")};class $i extends fr{constructor(e,n,r){super(e,n,Pc(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new mt(this.firestore,null,new J(e))}withConverter(e){return new $i(this.firestore,e,this._path)}}function $e(t,e,...n){if(t=ze(t),HS("collection","path",e),t instanceof Xh){const r=Me.fromString(e,...n);return pE(r),new $i(t,null,r)}{if(!(t instanceof mt||t instanceof $i))throw new W(B.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(Me.fromString(e,...n));return pE(r),new $i(t.firestore,null,r)}}function Bt(t,e,...n){if(t=ze(t),arguments.length===1&&(e=wy.newId()),HS("doc","path",e),t instanceof Xh){const r=Me.fromString(e,...n);return fE(r),new mt(t,null,new J(r))}{if(!(t instanceof mt||t instanceof $i))throw new W(B.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(Me.fromString(e,...n));return fE(r),new mt(t.firestore,t instanceof $i?t.converter:null,new J(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SI="AsyncQueue";class bI{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new yA(this,"async_queue_retry"),this._c=()=>{const r=td();r&&q(SI,"Visibility state changed to "+r.visibilityState),this.M_.w_()},this.ac=e;const n=td();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const n=td();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});const n=new ar;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Xu.push(e),this.lc()))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!rs(e))throw e;q(SI,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){const n=this.ac.then(()=>(this.rc=!0,e().catch(r=>{throw this.nc=r,this.rc=!1,an("INTERNAL UNHANDLED ERROR: ",AI(r)),r}).then(r=>(this.rc=!1,r))));return this.ac=n,n}enqueueAfterDelay(e,n,r){this.uc(),this.oc.indexOf(e)>-1&&(n=0);const i=Qy.createAndSchedule(this,e,n,r,s=>this.hc(s));return this.tc.push(i),i}uc(){this.nc&&le(47125,{Pc:AI(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const n of this.tc)if(n.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.tc)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.Tc()})}dc(e){this.oc.push(e)}hc(e){const n=this.tc.indexOf(e);this.tc.splice(n,1)}}function AI(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function CI(t){return function(n,r){if(typeof n!="object"||n===null)return!1;const i=n;for(const s of r)if(s in i&&typeof i[s]=="function")return!0;return!1}(t,["next","error","complete"])}class dr extends Xh{constructor(e,n,r,i){super(e,n,r,i),this.type="firestore",this._queue=new bI,this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new bI(e),this._firestoreClient=void 0,await e}}}function OA(t,e){const n=typeof t=="object"?t:bh(),r=typeof t=="string"?t:Ud,i=ts(n,"firestore").getImmediate({identifier:r});if(!i._initialized){const s=Bx("firestore");s&&uM(i,...s)}return i}function Oc(t){if(t._terminated)throw new W(B.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||LA(t),t._firestoreClient}function LA(t){var r,i,s;const e=t._freezeSettings(),n=function(a,l,d,h){return new OV(a,l,d,h.host,h.ssl,h.experimentalForceLongPolling,h.experimentalAutoDetectLongPolling,jA(h.experimentalLongPollingOptions),h.useFetchStreams,h.isUsingEmulator)}(t._databaseId,((r=t._app)==null?void 0:r.options.appId)||"",t._persistenceKey,e);t._componentsProvider||(i=e.localCache)!=null&&i._offlineComponentProvider&&((s=e.localCache)!=null&&s._onlineComponentProvider)&&(t._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),t._firestoreClient=new rM(t._authCredentials,t._appCheckCredentials,t._queue,n,t._componentsProvider&&function(a){const l=a==null?void 0:a._online.build();return{_offline:a==null?void 0:a._offline.build(l),_online:l}}(t._componentsProvider))}function dM(t,e){$s("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const n=t._freezeSettings();return hM(t,Xd.provider,{build:r=>new nM(r,n.cacheSizeBytes,e==null?void 0:e.forceOwnership)}),Promise.resolve()}function hM(t,e,n){if((t=en(t,dr))._firestoreClient||t._terminated)throw new W(B.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(t._componentsProvider||t._getSettings().localCache)throw new W(B.FAILED_PRECONDITION,"SDK cache is already specified.");t._componentsProvider={_online:e,_offline:n},LA(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fM{constructor(e="count",n){this._internalFieldPath=n,this.type="AggregateField",this.aggregateType=e}}class pM{constructor(e,n,r){this._userDataWriter=n,this._data=r,this.type="AggregateQuerySnapshot",this.query=e}data(){return this._userDataWriter.convertObjectMap(this._data)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bn{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Bn(xt.fromBase64String(e))}catch(n){throw new W(B.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new Bn(xt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Bn._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Ac(e,Bn._jsonSchema))return Bn.fromBase64String(e.bytes)}}Bn._jsonSchemaVersion="firestore/bytes/1.0",Bn._jsonSchema={type:Tt("string",Bn._jsonSchemaVersion),bytes:Tt("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jh{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new W(B.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new ct(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ka{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pr{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new W(B.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new W(B.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return Ie(this._lat,e._lat)||Ie(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Pr._jsonSchemaVersion}}static fromJSON(e){if(Ac(e,Pr._jsonSchema))return new Pr(e.latitude,e.longitude)}}Pr._jsonSchemaVersion="firestore/geoPoint/1.0",Pr._jsonSchema={type:Tt("string",Pr._jsonSchemaVersion),latitude:Tt("number"),longitude:Tt("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kr{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,i){if(r.length!==i.length)return!1;for(let s=0;s<r.length;++s)if(r[s]!==i[s])return!1;return!0}(this._values,e._values)}toJSON(){return{type:kr._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Ac(e,kr._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(n=>typeof n=="number"))return new kr(e.vectorValues);throw new W(B.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}kr._jsonSchemaVersion="firestore/vectorValue/1.0",kr._jsonSchema={type:Tt("string",kr._jsonSchemaVersion),vectorValues:Tt("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mM=/^__.*__$/;class gM{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new ni(e,this.data,this.fieldMask,n,this.fieldTransforms):new Ra(e,this.data,n,this.fieldTransforms)}}class MA{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new ni(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function FA(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw le(40011,{Ac:t})}}class Zh{constructor(e,n,r,i,s,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.Rc(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new Zh({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){var i;const n=(i=this.path)==null?void 0:i.child(e),r=this.Vc({path:n,fc:!1});return r.gc(e),r}yc(e){var i;const n=(i=this.path)==null?void 0:i.child(e),r=this.Vc({path:n,fc:!1});return r.Rc(),r}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return Zd(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(FA(this.Ac)&&mM.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class yM{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||Qh(e)}Cc(e,n,r,i=!1){return new Zh({Ac:e,methodName:n,Dc:r,path:ct.emptyPath(),fc:!1,bc:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Lc(t){const e=t._freezeSettings(),n=Qh(t._databaseId);return new yM(t._databaseId,!!e.ignoreUndefinedProperties,n)}function UA(t,e,n,r,i,s={}){const o=t.Cc(s.merge||s.mergeFields?2:0,e,n,i);l_("Data must be an object, but it was:",o,r);const a=$A(r,o);let l,d;if(s.merge)l=new _n(o.fieldMask),d=o.fieldTransforms;else if(s.mergeFields){const h=[];for(const f of s.mergeFields){const m=eg(e,f,n);if(!o.contains(m))throw new W(B.INVALID_ARGUMENT,`Field '${m}' is specified in your field mask but missing from your input data.`);qA(h,m)||h.push(m)}l=new _n(h),d=o.fieldTransforms.filter(f=>l.covers(f.field))}else l=null,d=o.fieldTransforms;return new gM(new Jt(a),l,d)}class ef extends ka{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof ef}}function _M(t,e,n){return new Zh({Ac:3,Dc:e.settings.Dc,methodName:t._methodName,fc:n},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class s_ extends ka{_toFieldTransform(e){return new $h(e.path,new ma)}isEqual(e){return e instanceof s_}}class o_ extends ka{constructor(e,n){super(e),this.vc=n}_toFieldTransform(e){const n=_M(this,e,!0),r=this.vc.map(s=>Na(s,n)),i=new Ws(r);return new $h(e.path,i)}isEqual(e){return e instanceof o_&&Qr(this.vc,e.vc)}}class a_ extends ka{constructor(e,n){super(e),this.Fc=n}_toFieldTransform(e){const n=new ya(e.serializer,kb(e.serializer,this.Fc));return new $h(e.path,n)}isEqual(e){return e instanceof a_&&this.Fc===e.Fc}}function vM(t,e,n,r){const i=t.Cc(1,e,n);l_("Data must be an object, but it was:",i,r);const s=[],o=Jt.empty();is(r,(l,d)=>{const h=c_(e,l,n);d=ze(d);const f=i.yc(h);if(d instanceof ef)s.push(h);else{const m=Na(d,f);m!=null&&(s.push(h),o.set(h,m))}});const a=new _n(s);return new MA(o,a,i.fieldTransforms)}function wM(t,e,n,r,i,s){const o=t.Cc(1,e,n),a=[eg(e,r,n)],l=[i];if(s.length%2!=0)throw new W(B.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let m=0;m<s.length;m+=2)a.push(eg(e,s[m])),l.push(s[m+1]);const d=[],h=Jt.empty();for(let m=a.length-1;m>=0;--m)if(!qA(d,a[m])){const v=a[m];let C=l[m];C=ze(C);const y=o.yc(v);if(C instanceof ef)d.push(v);else{const N=Na(C,y);N!=null&&(d.push(v),h.set(v,N))}}const f=new _n(d);return new MA(h,f,o.fieldTransforms)}function BA(t,e,n,r=!1){return Na(n,t.Cc(r?4:3,e))}function Na(t,e){if(zA(t=ze(t)))return l_("Unsupported field value:",e,t),$A(t,e);if(t instanceof ka)return function(r,i){if(!FA(i.Ac))throw i.Sc(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Sc(`${r._methodName}() is not currently supported inside arrays`);const s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return function(r,i){const s=[];let o=0;for(const a of r){let l=Na(a,i.wc(o));l==null&&(l={nullValue:"NULL_VALUE"}),s.push(l),o++}return{arrayValue:{values:s}}}(t,e)}return function(r,i){if((r=ze(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return kb(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const s=Oe.fromDate(r);return{timestampValue:_a(i.serializer,s)}}if(r instanceof Oe){const s=new Oe(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:_a(i.serializer,s)}}if(r instanceof Pr)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Bn)return{bytesValue:$b(i.serializer,r._byteString)};if(r instanceof mt){const s=i.databaseId,o=r.firestore._databaseId;if(!o.isEqual(s))throw i.Sc(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:Oy(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof kr)return function(o,a){return{mapValue:{fields:{[Ay]:{stringValue:Cy},[ha]:{arrayValue:{values:o.toArray().map(d=>{if(typeof d!="number")throw a.Sc("VectorValues must only contain numeric values.");return ky(a.serializer,d)})}}}}}}(r,i);throw i.Sc(`Unsupported field value: ${kh(r)}`)}(t,e)}function $A(t,e){const n={};return ab(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):is(t,(r,i)=>{const s=Na(i,e.mc(r));s!=null&&(n[r]=s)}),{mapValue:{fields:n}}}function zA(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof Oe||t instanceof Pr||t instanceof Bn||t instanceof mt||t instanceof ka||t instanceof kr)}function l_(t,e,n){if(!zA(n)||!WS(n)){const r=kh(n);throw r==="an object"?e.Sc(t+" a custom object"):e.Sc(t+" "+r)}}function eg(t,e,n){if((e=ze(e))instanceof Jh)return e._internalPath;if(typeof e=="string")return c_(t,e);throw Zd("Field path arguments must be of type string or ",t,!1,void 0,n)}const EM=new RegExp("[~\\*/\\[\\]]");function c_(t,e,n){if(e.search(EM)>=0)throw Zd(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new Jh(...e.split("."))._internalPath}catch{throw Zd(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function Zd(t,e,n,r,i){const s=r&&!r.isEmpty(),o=i!==void 0;let a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let l="";return(s||o)&&(l+=" (found",s&&(l+=` in field ${r}`),o&&(l+=` in document ${i}`),l+=")"),new W(B.INVALID_ARGUMENT,a+t+l)}function qA(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u_{constructor(e,n,r,i,s){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new mt(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new IM(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(tf("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class IM extends u_{data(){return super.data()}}function tf(t,e){return typeof e=="string"?c_(t,e):e instanceof Jh?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function HA(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new W(B.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class d_{}class Mc extends d_{}function lt(t,e,...n){let r=[];e instanceof d_&&r.push(e),r=r.concat(n),function(s){const o=s.filter(l=>l instanceof h_).length,a=s.filter(l=>l instanceof nf).length;if(o>1||o>0&&a>0)throw new W(B.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const i of r)t=i._apply(t);return t}class nf extends Mc{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new nf(e,n,r)}_apply(e){const n=this._parse(e);return KA(e._query,n),new fr(e.firestore,e.converter,$m(e._query,n))}_parse(e){const n=Lc(e.firestore);return function(s,o,a,l,d,h,f){let m;if(d.isKeyField()){if(h==="array-contains"||h==="array-contains-any")throw new W(B.INVALID_ARGUMENT,`Invalid Query. You can't perform '${h}' queries on documentId().`);if(h==="in"||h==="not-in"){NI(f,h);const C=[];for(const y of f)C.push(kI(l,s,y));m={arrayValue:{values:C}}}else m=kI(l,s,f)}else h!=="in"&&h!=="not-in"&&h!=="array-contains-any"||NI(f,h),m=BA(a,o,f,h==="in"||h==="not-in");return je.create(d,h,m)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function et(t,e,n){const r=e,i=tf("where",t);return nf._create(i,r,n)}class h_ extends d_{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new h_(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:He.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(i,s){let o=i;const a=s.getFlattenedFilters();for(const l of a)KA(o,l),o=$m(o,l)}(e._query,n),new fr(e.firestore,e.converter,$m(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class f_ extends Mc{constructor(e,n){super(),this._field=e,this._direction=n,this.type="orderBy"}static _create(e,n){return new f_(e,n)}_apply(e){const n=function(i,s,o){if(i.startAt!==null)throw new W(B.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new W(B.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new pc(s,o)}(e._query,this._field,this._direction);return new fr(e.firestore,e.converter,function(i,s){const o=i.explicitOrderBy.concat([s]);return new ss(i.path,i.collectionGroup,o,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,n))}}function An(t,e="asc"){const n=e,r=tf("orderBy",t);return f_._create(r,n)}class p_ extends Mc{constructor(e,n,r){super(),this.type=e,this._limit=n,this._limitType=r}static _create(e,n,r){return new p_(e,n,r)}_apply(e){return new fr(e.firestore,e.converter,zd(e._query,this._limit,this._limitType))}}function Yo(t){return tV("limit",t),p_._create("limit",t,"F")}class rf extends Mc{constructor(e,n,r){super(),this.type=e,this._docOrFields=n,this._inclusive=r}static _create(e,n,r){return new rf(e,n,r)}_apply(e){const n=WA(e,this.type,this._docOrFields,this._inclusive);return new fr(e.firestore,e.converter,function(i,s){return new ss(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,s,i.endAt)}(e._query,n))}}function RI(...t){return rf._create("startAt",t,!0)}function TM(...t){return rf._create("startAfter",t,!1)}class m_ extends Mc{constructor(e,n,r){super(),this.type=e,this._docOrFields=n,this._inclusive=r}static _create(e,n,r){return new m_(e,n,r)}_apply(e){const n=WA(e,this.type,this._docOrFields,this._inclusive);return new fr(e.firestore,e.converter,function(i,s){return new ss(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,i.startAt,s)}(e._query,n))}}function PI(...t){return m_._create("endAt",t,!0)}function WA(t,e,n,r){if(n[0]=ze(n[0]),n[0]instanceof u_)return function(s,o,a,l,d){if(!l)throw new W(B.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${a}().`);const h=[];for(const f of Go(s))if(f.field.isKeyField())h.push(qs(o,l.key));else{const m=l.data.field(f.field);if(Lh(m))throw new W(B.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+f.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(m===null){const v=f.field.canonicalString();throw new W(B.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${v}' (used as the orderBy) does not exist.`)}h.push(m)}return new Ki(h,d)}(t._query,t.firestore._databaseId,e,n[0]._document,r);{const i=Lc(t.firestore);return function(o,a,l,d,h,f){const m=o.explicitOrderBy;if(h.length>m.length)throw new W(B.INVALID_ARGUMENT,`Too many arguments provided to ${d}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const v=[];for(let C=0;C<h.length;C++){const y=h[C];if(m[C].field.isKeyField()){if(typeof y!="string")throw new W(B.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${d}(), but got a ${typeof y}`);if(!Py(o)&&y.indexOf("/")!==-1)throw new W(B.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${d}() must be a plain document ID, but '${y}' contains a slash.`);const N=o.path.child(Me.fromString(y));if(!J.isDocumentKey(N))throw new W(B.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${d}() must result in a valid document path, but '${N}' is not because it contains an odd number of segments.`);const I=new J(N);v.push(qs(a,I))}else{const N=BA(l,d,y);v.push(N)}}return new Ki(v,f)}(t._query,t.firestore._databaseId,i,e,n,r)}}function kI(t,e,n){if(typeof(n=ze(n))=="string"){if(n==="")throw new W(B.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Py(e)&&n.indexOf("/")!==-1)throw new W(B.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(Me.fromString(n));if(!J.isDocumentKey(r))throw new W(B.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return qs(t,new J(r))}if(n instanceof mt)return qs(t,n._key);throw new W(B.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${kh(n)}.`)}function NI(t,e){if(!Array.isArray(t)||t.length===0)throw new W(B.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function KA(t,e){const n=function(i,s){for(const o of i)for(const a of o.getFlattenedFilters())if(s.indexOf(a.op)>=0)return a.op;return null}(t.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new W(B.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new W(B.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class xM{convertValue(e,n="none"){switch(Hi(e)){case 0:return null;case 1:return e.booleanValue;case 2:return nt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(Zr(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw le(62114,{value:e})}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return is(e,(i,s)=>{r[i]=this.convertValue(s,n)}),r}convertVectorValue(e){var r,i,s;const n=(s=(i=(r=e.fields)==null?void 0:r[ha].arrayValue)==null?void 0:i.values)==null?void 0:s.map(o=>nt(o.doubleValue));return new kr(n)}convertGeoPoint(e){return new Pr(nt(e.latitude),nt(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=Mh(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(dc(e));default:return null}}convertTimestamp(e){const n=Jr(e);return new Oe(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=Me.fromString(e);ue(Xb(r),9688,{name:e});const i=new zs(r.get(1),r.get(3)),s=new J(r.popFirst(5));return i.isEqual(n)||an(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GA(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}function SM(){return new fM("count")}class gl{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Ns extends u_{constructor(e,n,r,i,s,o){super(e,n,r,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new nd(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(tf("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new W(B.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,n={};return n.type=Ns._jsonSchemaVersion,n.bundle="",n.bundleSource="DocumentSnapshot",n.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?n:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),n.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),n)}}Ns._jsonSchemaVersion="firestore/documentSnapshot/1.0",Ns._jsonSchema={type:Tt("string",Ns._jsonSchemaVersion),bundleSource:Tt("string","DocumentSnapshot"),bundleName:Tt("string"),bundle:Tt("string")};class nd extends Ns{data(e={}){return super.data(e)}}class Ds{constructor(e,n,r,i){this._firestore=e,this._userDataWriter=n,this._snapshot=i,this.metadata=new gl(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new nd(this._firestore,this._userDataWriter,r.key,r,new gl(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new W(B.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map(a=>{const l=new nd(i._firestore,i._userDataWriter,a.doc.key,a.doc,new gl(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);return a.doc,{type:"added",doc:l,oldIndex:-1,newIndex:o++}})}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(a=>s||a.type!==3).map(a=>{const l=new nd(i._firestore,i._userDataWriter,a.doc.key,a.doc,new gl(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);let d=-1,h=-1;return a.type!==0&&(d=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),h=o.indexOf(a.doc.key)),{type:bM(a.type),doc:l,oldIndex:d,newIndex:h}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new W(B.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Ds._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=wy.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const n=[],r=[],i=[];return this.docs.forEach(s=>{s._document!==null&&(n.push(s._document),r.push(this._userDataWriter.convertObjectMap(s._document.data.value.mapValue.fields,"previous")),i.push(s.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function bM(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return le(61501,{type:t})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eh(t){t=en(t,mt);const e=en(t.firestore,dr);return aM(Oc(e),t._key).then(n=>YA(e,t,n))}Ds._jsonSchemaVersion="firestore/querySnapshot/1.0",Ds._jsonSchema={type:Tt("string",Ds._jsonSchemaVersion),bundleSource:Tt("string","QuerySnapshot"),bundleName:Tt("string"),bundle:Tt("string")};class sf extends xM{constructor(e){super(),this.firestore=e}convertBytes(e){return new Bn(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new mt(this.firestore,null,n)}}function bn(t){t=en(t,fr);const e=en(t.firestore,dr),n=Oc(e),r=new sf(e);return HA(t._query),lM(n,t._query).then(i=>new Ds(e,r,t,i))}function th(t,e,n){t=en(t,mt);const r=en(t.firestore,dr),i=GA(t.converter,e,n);return of(r,[UA(Lc(r),"setDoc",t._key,i,t.converter!==null,n).toMutation(t._key,Zt.none())])}function Xo(t,e,n,...r){t=en(t,mt);const i=en(t.firestore,dr),s=Lc(i);let o;return o=typeof(e=ze(e))=="string"||e instanceof Jh?wM(s,"updateDoc",t._key,e,n,r):vM(s,"updateDoc",t._key,e),of(i,[o.toMutation(t._key,Zt.exists(!0))])}function QA(t){return of(en(t.firestore,dr),[new qh(t._key,Zt.none())])}function yl(t,e){const n=en(t.firestore,dr),r=Bt(t),i=GA(t.converter,e);return of(n,[UA(Lc(t.firestore),"addDoc",r._key,i,t.converter!==null,{}).toMutation(r._key,Zt.exists(!1))]).then(()=>r)}function rr(t,...e){var l,d,h;t=ze(t);let n={includeMetadataChanges:!1,source:"default"},r=0;typeof e[r]!="object"||CI(e[r])||(n=e[r++]);const i={includeMetadataChanges:n.includeMetadataChanges,source:n.source};if(CI(e[r])){const f=e[r];e[r]=(l=f.next)==null?void 0:l.bind(f),e[r+1]=(d=f.error)==null?void 0:d.bind(f),e[r+2]=(h=f.complete)==null?void 0:h.bind(f)}let s,o,a;if(t instanceof mt)o=en(t.firestore,dr),a=Pc(t._key.path),s={next:f=>{e[r]&&e[r](YA(o,t,f))},error:e[r+1],complete:e[r+2]};else{const f=en(t,fr);o=en(f.firestore,dr),a=f._query;const m=new sf(o);s={next:v=>{e[r]&&e[r](new Ds(o,m,f,v))},error:e[r+1],complete:e[r+2]},HA(t._query)}return function(m,v,C,y){const N=new r_(y),I=new e_(v,N,C);return m.asyncQueue.enqueueAndForget(async()=>Xy(await Jd(m),I)),()=>{N.Nu(),m.asyncQueue.enqueueAndForget(async()=>Jy(await Jd(m),I))}}(Oc(o),a,i,s)}function of(t,e){return function(r,i){const s=new ar;return r.asyncQueue.enqueueAndForget(async()=>GL(await sM(r),i,s)),s.promise}(Oc(t),e)}function YA(t,e,n){const r=n.docs.get(e._key),i=new sf(t);return new Ns(t,i,e._key,r,new gl(n.hasPendingWrites,n.fromCache),e.converter)}function AM(t){return CM(t,{count:SM()})}function CM(t,e){const n=en(t.firestore,dr),r=Oc(n),i=jV(e,(s,o)=>new lO(o,s.aggregateType,s._internalFieldPath));return cM(r,t._query,i).then(s=>function(a,l,d){const h=new sf(a);return new pM(l,h,d)}(n,t,s))}function Ln(){return new s_("serverTimestamp")}function RM(...t){return new o_("arrayUnion",t)}function DI(t){return new a_("increment",t)}(function(e,n=!0){(function(i){Ca=i})(ro),cr(new Qn("firestore",(r,{instanceIdentifier:i,options:s})=>{const o=r.getProvider("app").getImmediate(),a=new dr(new W2(r.getProvider("auth-internal")),new Q2(o,r.getProvider("app-check-internal")),function(d,h){if(!Object.prototype.hasOwnProperty.apply(d.options,["projectId"]))throw new W(B.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new zs(d.options.projectId,h)}(o,i),o);return s={useFetchStreams:n,...s},a._setSettings(s),a},"PUBLIC").setMultipleInstances(!0)),In(cE,uE,e),In(cE,uE,"esm2020")})();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XA="firebasestorage.googleapis.com",JA="storageBucket",PM=2*60*1e3,kM=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yt extends Yn{constructor(e,n,r=0){super(pp(e),`Firebase Storage: ${n} (${pp(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,yt.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return pp(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var gt;(function(t){t.UNKNOWN="unknown",t.OBJECT_NOT_FOUND="object-not-found",t.BUCKET_NOT_FOUND="bucket-not-found",t.PROJECT_NOT_FOUND="project-not-found",t.QUOTA_EXCEEDED="quota-exceeded",t.UNAUTHENTICATED="unauthenticated",t.UNAUTHORIZED="unauthorized",t.UNAUTHORIZED_APP="unauthorized-app",t.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",t.INVALID_CHECKSUM="invalid-checksum",t.CANCELED="canceled",t.INVALID_EVENT_NAME="invalid-event-name",t.INVALID_URL="invalid-url",t.INVALID_DEFAULT_BUCKET="invalid-default-bucket",t.NO_DEFAULT_BUCKET="no-default-bucket",t.CANNOT_SLICE_BLOB="cannot-slice-blob",t.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",t.NO_DOWNLOAD_URL="no-download-url",t.INVALID_ARGUMENT="invalid-argument",t.INVALID_ARGUMENT_COUNT="invalid-argument-count",t.APP_DELETED="app-deleted",t.INVALID_ROOT_OPERATION="invalid-root-operation",t.INVALID_FORMAT="invalid-format",t.INTERNAL_ERROR="internal-error",t.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(gt||(gt={}));function pp(t){return"storage/"+t}function g_(){const t="An unknown error occurred, please check the error payload for server response.";return new yt(gt.UNKNOWN,t)}function NM(t){return new yt(gt.OBJECT_NOT_FOUND,"Object '"+t+"' does not exist.")}function DM(t){return new yt(gt.QUOTA_EXCEEDED,"Quota for bucket '"+t+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function jM(){const t="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new yt(gt.UNAUTHENTICATED,t)}function VM(){return new yt(gt.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function OM(t){return new yt(gt.UNAUTHORIZED,"User does not have permission to access '"+t+"'.")}function LM(){return new yt(gt.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function MM(){return new yt(gt.CANCELED,"User canceled the upload/download.")}function FM(t){return new yt(gt.INVALID_URL,"Invalid URL '"+t+"'.")}function UM(t){return new yt(gt.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}function BM(){return new yt(gt.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+JA+"' property when initializing the app?")}function $M(){return new yt(gt.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function zM(){return new yt(gt.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function qM(t){return new yt(gt.UNSUPPORTED_ENVIRONMENT,`${t} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function tg(t){return new yt(gt.INVALID_ARGUMENT,t)}function ZA(){return new yt(gt.APP_DELETED,"The Firebase app was deleted.")}function HM(t){return new yt(gt.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function Ll(t,e){return new yt(gt.INVALID_FORMAT,"String does not match format '"+t+"': "+e)}function il(t){throw new yt(gt.INTERNAL_ERROR,"Internal error: "+t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ln{constructor(e,n){this.bucket=e,this.path_=n}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,n){let r;try{r=ln.makeFromUrl(e,n)}catch{return new ln(e,"")}if(r.path==="")return r;throw UM(e)}static makeFromUrl(e,n){let r=null;const i="([A-Za-z0-9.\\-_]+)";function s(R){R.path.charAt(R.path.length-1)==="/"&&(R.path_=R.path_.slice(0,-1))}const o="(/(.*))?$",a=new RegExp("^gs://"+i+o,"i"),l={bucket:1,path:3};function d(R){R.path_=decodeURIComponent(R.path)}const h="v[A-Za-z0-9_]+",f=n.replace(/[.]/g,"\\."),m="(/([^?#]*).*)?$",v=new RegExp(`^https?://${f}/${h}/b/${i}/o${m}`,"i"),C={bucket:1,path:3},y=n===XA?"(?:storage.googleapis.com|storage.cloud.google.com)":n,N="([^?#]*)",I=new RegExp(`^https?://${y}/${i}/${N}`,"i"),T=[{regex:a,indices:l,postModify:s},{regex:v,indices:C,postModify:d},{regex:I,indices:{bucket:1,path:2},postModify:d}];for(let R=0;R<T.length;R++){const O=T[R],$=O.regex.exec(e);if($){const x=$[O.indices.bucket];let w=$[O.indices.path];w||(w=""),r=new ln(x,w),O.postModify(r);break}}if(r==null)throw FM(e);return r}}class WM{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function KM(t,e,n){let r=1,i=null,s=null,o=!1,a=0;function l(){return a===2}let d=!1;function h(...N){d||(d=!0,e.apply(null,N))}function f(N){i=setTimeout(()=>{i=null,t(v,l())},N)}function m(){s&&clearTimeout(s)}function v(N,...I){if(d){m();return}if(N){m(),h.call(null,N,...I);return}if(l()||o){m(),h.call(null,N,...I);return}r<64&&(r*=2);let T;a===1?(a=2,T=0):T=(r+Math.random())*1e3,f(T)}let C=!1;function y(N){C||(C=!0,m(),!d&&(i!==null?(N||(a=2),clearTimeout(i),f(0)):N||(a=1)))}return f(0),s=setTimeout(()=>{o=!0,y(!0)},n),y}function GM(t){t(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function QM(t){return t!==void 0}function YM(t){return typeof t=="object"&&!Array.isArray(t)}function y_(t){return typeof t=="string"||t instanceof String}function jI(t){return __()&&t instanceof Blob}function __(){return typeof Blob<"u"}function ng(t,e,n,r){if(r<e)throw tg(`Invalid value for '${t}'. Expected ${e} or greater.`);if(r>n)throw tg(`Invalid value for '${t}'. Expected ${n} or less.`)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fc(t,e,n){let r=e;return n==null&&(r=`https://${e}`),`${n}://${r}/v0${t}`}function eC(t){const e=encodeURIComponent;let n="?";for(const r in t)if(t.hasOwnProperty(r)){const i=e(r)+"="+e(t[r]);n=n+i+"&"}return n=n.slice(0,-1),n}var js;(function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"})(js||(js={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function XM(t,e){const n=t>=500&&t<600,i=[408,429].indexOf(t)!==-1,s=e.indexOf(t)!==-1;return n||i||s}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JM{constructor(e,n,r,i,s,o,a,l,d,h,f,m=!0,v=!1){this.url_=e,this.method_=n,this.headers_=r,this.body_=i,this.successCodes_=s,this.additionalRetryCodes_=o,this.callback_=a,this.errorCallback_=l,this.timeout_=d,this.progressCallback_=h,this.connectionFactory_=f,this.retry=m,this.isUsingEmulator=v,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((C,y)=>{this.resolve_=C,this.reject_=y,this.start_()})}start_(){const e=(r,i)=>{if(i){r(!1,new Tu(!1,null,!0));return}const s=this.connectionFactory_();this.pendingConnection_=s;const o=a=>{const l=a.loaded,d=a.lengthComputable?a.total:-1;this.progressCallback_!==null&&this.progressCallback_(l,d)};this.progressCallback_!==null&&s.addUploadProgressListener(o),s.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&s.removeUploadProgressListener(o),this.pendingConnection_=null;const a=s.getErrorCode()===js.NO_ERROR,l=s.getStatus();if(!a||XM(l,this.additionalRetryCodes_)&&this.retry){const h=s.getErrorCode()===js.ABORT;r(!1,new Tu(!1,null,h));return}const d=this.successCodes_.indexOf(l)!==-1;r(!0,new Tu(d,s))})},n=(r,i)=>{const s=this.resolve_,o=this.reject_,a=i.connection;if(i.wasSuccessCode)try{const l=this.callback_(a,a.getResponse());QM(l)?s(l):s()}catch(l){o(l)}else if(a!==null){const l=g_();l.serverResponse=a.getErrorText(),this.errorCallback_?o(this.errorCallback_(a,l)):o(l)}else if(i.canceled){const l=this.appDelete_?ZA():MM();o(l)}else{const l=LM();o(l)}};this.canceled_?n(!1,new Tu(!1,null,!0)):this.backoffId_=KM(e,n,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&GM(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class Tu{constructor(e,n,r){this.wasSuccessCode=e,this.connection=n,this.canceled=!!r}}function ZM(t,e){e!==null&&e.length>0&&(t.Authorization="Firebase "+e)}function eF(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function tF(t,e){e&&(t["X-Firebase-GMPID"]=e)}function nF(t,e){e!==null&&(t["X-Firebase-AppCheck"]=e)}function rF(t,e,n,r,i,s,o=!0,a=!1){const l=eC(t.urlParams),d=t.url+l,h=Object.assign({},t.headers);return tF(h,e),ZM(h,n),eF(h,s),nF(h,r),new JM(d,t.method,h,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,i,o,a)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iF(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function sF(...t){const e=iF();if(e!==void 0){const n=new e;for(let r=0;r<t.length;r++)n.append(t[r]);return n.getBlob()}else{if(__())return new Blob(t);throw new yt(gt.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function oF(t,e,n){return t.webkitSlice?t.webkitSlice(e,n):t.mozSlice?t.mozSlice(e,n):t.slice?t.slice(e,n):null}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aF(t){if(typeof atob>"u")throw qM("base-64");return atob(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sr={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class mp{constructor(e,n){this.data=e,this.contentType=n||null}}function lF(t,e){switch(t){case Sr.RAW:return new mp(tC(e));case Sr.BASE64:case Sr.BASE64URL:return new mp(nC(t,e));case Sr.DATA_URL:return new mp(uF(e),dF(e))}throw g_()}function tC(t){const e=[];for(let n=0;n<t.length;n++){let r=t.charCodeAt(n);if(r<=127)e.push(r);else if(r<=2047)e.push(192|r>>6,128|r&63);else if((r&64512)===55296)if(!(n<t.length-1&&(t.charCodeAt(n+1)&64512)===56320))e.push(239,191,189);else{const s=r,o=t.charCodeAt(++n);r=65536|(s&1023)<<10|o&1023,e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|r&63)}else(r&64512)===56320?e.push(239,191,189):e.push(224|r>>12,128|r>>6&63,128|r&63)}return new Uint8Array(e)}function cF(t){let e;try{e=decodeURIComponent(t)}catch{throw Ll(Sr.DATA_URL,"Malformed data URL.")}return tC(e)}function nC(t,e){switch(t){case Sr.BASE64:{const i=e.indexOf("-")!==-1,s=e.indexOf("_")!==-1;if(i||s)throw Ll(t,"Invalid character '"+(i?"-":"_")+"' found: is it base64url encoded?");break}case Sr.BASE64URL:{const i=e.indexOf("+")!==-1,s=e.indexOf("/")!==-1;if(i||s)throw Ll(t,"Invalid character '"+(i?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let n;try{n=aF(e)}catch(i){throw i.message.includes("polyfill")?i:Ll(t,"Invalid character found")}const r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}class rC{constructor(e){this.base64=!1,this.contentType=null;const n=e.match(/^data:([^,]+)?,/);if(n===null)throw Ll(Sr.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const r=n[1]||null;r!=null&&(this.base64=hF(r,";base64"),this.contentType=this.base64?r.substring(0,r.length-7):r),this.rest=e.substring(e.indexOf(",")+1)}}function uF(t){const e=new rC(t);return e.base64?nC(Sr.BASE64,e.rest):cF(e.rest)}function dF(t){return new rC(t).contentType}function hF(t,e){return t.length>=e.length?t.substring(t.length-e.length)===e:!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Si{constructor(e,n){let r=0,i="";jI(e)?(this.data_=e,r=e.size,i=e.type):e instanceof ArrayBuffer?(n?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),r=this.data_.length):e instanceof Uint8Array&&(n?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),r=e.length),this.size_=r,this.type_=i}size(){return this.size_}type(){return this.type_}slice(e,n){if(jI(this.data_)){const r=this.data_,i=oF(r,e,n);return i===null?null:new Si(i)}else{const r=new Uint8Array(this.data_.buffer,e,n-e);return new Si(r,!0)}}static getBlob(...e){if(__()){const n=e.map(r=>r instanceof Si?r.data_:r);return new Si(sF.apply(null,n))}else{const n=e.map(o=>y_(o)?lF(Sr.RAW,o).data:o.data_);let r=0;n.forEach(o=>{r+=o.byteLength});const i=new Uint8Array(r);let s=0;return n.forEach(o=>{for(let a=0;a<o.length;a++)i[s++]=o[a]}),new Si(i,!0)}}uploadData(){return this.data_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function v_(t){let e;try{e=JSON.parse(t)}catch{return null}return YM(e)?e:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fF(t){if(t.length===0)return null;const e=t.lastIndexOf("/");return e===-1?"":t.slice(0,e)}function pF(t,e){const n=e.split("/").filter(r=>r.length>0).join("/");return t.length===0?n:t+"/"+n}function iC(t){const e=t.lastIndexOf("/",t.length-2);return e===-1?t:t.slice(e+1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mF(t,e){return e}class sn{constructor(e,n,r,i){this.server=e,this.local=n||e,this.writable=!!r,this.xform=i||mF}}let xu=null;function gF(t){return!y_(t)||t.length<2?t:iC(t)}function sC(){if(xu)return xu;const t=[];t.push(new sn("bucket")),t.push(new sn("generation")),t.push(new sn("metageneration")),t.push(new sn("name","fullPath",!0));function e(s,o){return gF(o)}const n=new sn("name");n.xform=e,t.push(n);function r(s,o){return o!==void 0?Number(o):o}const i=new sn("size");return i.xform=r,t.push(i),t.push(new sn("timeCreated")),t.push(new sn("updated")),t.push(new sn("md5Hash",null,!0)),t.push(new sn("cacheControl",null,!0)),t.push(new sn("contentDisposition",null,!0)),t.push(new sn("contentEncoding",null,!0)),t.push(new sn("contentLanguage",null,!0)),t.push(new sn("contentType",null,!0)),t.push(new sn("metadata","customMetadata",!0)),xu=t,xu}function yF(t,e){function n(){const r=t.bucket,i=t.fullPath,s=new ln(r,i);return e._makeStorageReference(s)}Object.defineProperty(t,"ref",{get:n})}function _F(t,e,n){const r={};r.type="file";const i=n.length;for(let s=0;s<i;s++){const o=n[s];r[o.local]=o.xform(r,e[o.server])}return yF(r,t),r}function oC(t,e,n){const r=v_(e);return r===null?null:_F(t,r,n)}function vF(t,e,n,r){const i=v_(e);if(i===null||!y_(i.downloadTokens))return null;const s=i.downloadTokens;if(s.length===0)return null;const o=encodeURIComponent;return s.split(",").map(d=>{const h=t.bucket,f=t.fullPath,m="/b/"+o(h)+"/o/"+o(f),v=Fc(m,n,r),C=eC({alt:"media",token:d});return v+C})[0]}function wF(t,e){const n={},r=e.length;for(let i=0;i<r;i++){const s=e[i];s.writable&&(n[s.server]=t[s.local])}return JSON.stringify(n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VI="prefixes",OI="items";function EF(t,e,n){const r={prefixes:[],items:[],nextPageToken:n.nextPageToken};if(n[VI])for(const i of n[VI]){const s=i.replace(/\/$/,""),o=t._makeStorageReference(new ln(e,s));r.prefixes.push(o)}if(n[OI])for(const i of n[OI]){const s=t._makeStorageReference(new ln(e,i.name));r.items.push(s)}return r}function IF(t,e,n){const r=v_(n);return r===null?null:EF(t,e,r)}class af{constructor(e,n,r,i){this.url=e,this.method=n,this.handler=r,this.timeout=i,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function w_(t){if(!t)throw g_()}function TF(t,e){function n(r,i){const s=oC(t,i,e);return w_(s!==null),s}return n}function xF(t,e){function n(r,i){const s=IF(t,e,i);return w_(s!==null),s}return n}function SF(t,e){function n(r,i){const s=oC(t,i,e);return w_(s!==null),vF(s,i,t.host,t._protocol)}return n}function E_(t){function e(n,r){let i;return n.getStatus()===401?n.getErrorText().includes("Firebase App Check token is invalid")?i=VM():i=jM():n.getStatus()===402?i=DM(t.bucket):n.getStatus()===403?i=OM(t.path):i=r,i.status=n.getStatus(),i.serverResponse=r.serverResponse,i}return e}function aC(t){const e=E_(t);function n(r,i){let s=e(r,i);return r.getStatus()===404&&(s=NM(t.path)),s.serverResponse=i.serverResponse,s}return n}function bF(t,e,n,r,i){const s={};e.isRoot?s.prefix="":s.prefix=e.path+"/",n.length>0&&(s.delimiter=n),r&&(s.pageToken=r),i&&(s.maxResults=i);const o=e.bucketOnlyServerUrl(),a=Fc(o,t.host,t._protocol),l="GET",d=t.maxOperationRetryTime,h=new af(a,l,xF(t,e.bucket),d);return h.urlParams=s,h.errorHandler=E_(e),h}function AF(t,e,n){const r=e.fullServerUrl(),i=Fc(r,t.host,t._protocol),s="GET",o=t.maxOperationRetryTime,a=new af(i,s,SF(t,n),o);return a.errorHandler=aC(e),a}function CF(t,e){const n=e.fullServerUrl(),r=Fc(n,t.host,t._protocol),i="DELETE",s=t.maxOperationRetryTime;function o(l,d){}const a=new af(r,i,o,s);return a.successCodes=[200,204],a.errorHandler=aC(e),a}function RF(t,e){return t&&t.contentType||e&&e.type()||"application/octet-stream"}function PF(t,e,n){const r=Object.assign({},n);return r.fullPath=t.path,r.size=e.size(),r.contentType||(r.contentType=RF(null,e)),r}function kF(t,e,n,r,i){const s=e.bucketOnlyServerUrl(),o={"X-Goog-Upload-Protocol":"multipart"};function a(){let T="";for(let R=0;R<2;R++)T=T+Math.random().toString().slice(2);return T}const l=a();o["Content-Type"]="multipart/related; boundary="+l;const d=PF(e,r,i),h=wF(d,n),f="--"+l+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+h+`\r
--`+l+`\r
Content-Type: `+d.contentType+`\r
\r
`,m=`\r
--`+l+"--",v=Si.getBlob(f,r,m);if(v===null)throw $M();const C={name:d.fullPath},y=Fc(s,t.host,t._protocol),N="POST",I=t.maxUploadRetryTime,_=new af(y,N,TF(t,n),I);return _.urlParams=C,_.headers=o,_.body=v.uploadData(),_.errorHandler=E_(e),_}class NF{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=js.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=js.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=js.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,n,r,i,s){if(this.sent_)throw il("cannot .send() more than once");if(es(e)&&r&&(this.xhr_.withCredentials=!0),this.sent_=!0,this.xhr_.open(n,e,!0),s!==void 0)for(const o in s)s.hasOwnProperty(o)&&this.xhr_.setRequestHeader(o,s[o].toString());return i!==void 0?this.xhr_.send(i):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw il("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw il("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw il("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw il("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class DF extends NF{initXhr(){this.xhr_.responseType="text"}}function lf(){return new DF}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xs{constructor(e,n){this._service=e,n instanceof ln?this._location=n:this._location=ln.makeFromUrl(n,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,n){return new Xs(e,n)}get root(){const e=new ln(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return iC(this._location.path)}get storage(){return this._service}get parent(){const e=fF(this._location.path);if(e===null)return null;const n=new ln(this._location.bucket,e);return new Xs(this._service,n)}_throwIfRoot(e){if(this._location.path==="")throw HM(e)}}function jF(t,e,n){t._throwIfRoot("uploadBytes");const r=kF(t.storage,t._location,sC(),new Si(e,!0),n);return t.storage.makeRequestWithTokens(r,lf).then(i=>({metadata:i,ref:t}))}function VF(t){const e={prefixes:[],items:[]};return lC(t,e).then(()=>e)}async function lC(t,e,n){const i=await OF(t,{pageToken:n});e.prefixes.push(...i.prefixes),e.items.push(...i.items),i.nextPageToken!=null&&await lC(t,e,i.nextPageToken)}function OF(t,e){e!=null&&typeof e.maxResults=="number"&&ng("options.maxResults",1,1e3,e.maxResults);const n=e||{},r=bF(t.storage,t._location,"/",n.pageToken,n.maxResults);return t.storage.makeRequestWithTokens(r,lf)}function LF(t){t._throwIfRoot("getDownloadURL");const e=AF(t.storage,t._location,sC());return t.storage.makeRequestWithTokens(e,lf).then(n=>{if(n===null)throw zM();return n})}function MF(t){t._throwIfRoot("deleteObject");const e=CF(t.storage,t._location);return t.storage.makeRequestWithTokens(e,lf)}function FF(t,e){const n=pF(t._location.path,e),r=new ln(t._location.bucket,n);return new Xs(t.storage,r)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function UF(t){return/^[A-Za-z]+:\/\//.test(t)}function BF(t,e){return new Xs(t,e)}function cC(t,e){if(t instanceof I_){const n=t;if(n._bucket==null)throw BM();const r=new Xs(n,n._bucket);return e!=null?cC(r,e):r}else return e!==void 0?FF(t,e):t}function $F(t,e){if(e&&UF(e)){if(t instanceof I_)return BF(t,e);throw tg("To use ref(service, url), the first argument must be a Storage instance.")}else return cC(t,e)}function LI(t,e){const n=e==null?void 0:e[JA];return n==null?null:ln.makeFromBucketSpec(n,t)}function zF(t,e,n,r={}){t.host=`${e}:${n}`;const i=es(e);i&&(sy(`https://${t.host}/b`),oy("Storage",!0)),t._isUsingEmulator=!0,t._protocol=i?"https":"http";const{mockUserToken:s}=r;s&&(t._overrideAuthToken=typeof s=="string"?s:qx(s,t.app.options.projectId))}class I_{constructor(e,n,r,i,s,o=!1){this.app=e,this._authProvider=n,this._appCheckProvider=r,this._url=i,this._firebaseVersion=s,this._isUsingEmulator=o,this._bucket=null,this._host=XA,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=PM,this._maxUploadRetryTime=kM,this._requests=new Set,i!=null?this._bucket=ln.makeFromBucketSpec(i,this._host):this._bucket=LI(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=ln.makeFromBucketSpec(this._url,e):this._bucket=LI(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){ng("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){ng("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const n=await e.getToken();if(n!==null)return n.accessToken}return null}async _getAppCheckToken(){if(Un(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Xs(this,e)}_makeRequest(e,n,r,i,s=!0){if(this._deleted)return new WM(ZA());{const o=rF(e,this._appId,r,i,n,this._firebaseVersion,s,this._isUsingEmulator);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}async makeRequestWithTokens(e,n){const[r,i]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,n,r,i).getPromise()}}const MI="@firebase/storage",FI="0.14.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uC="storage";function UI(t,e,n){return t=ze(t),jF(t,e,n)}function BI(t){return t=ze(t),VF(t)}function $I(t){return t=ze(t),LF(t)}function gp(t){return t=ze(t),MF(t)}function sl(t,e){return t=ze(t),$F(t,e)}function Es(t=bh(),e){t=ze(t);const r=ts(t,uC).getImmediate({identifier:e}),i=Bx("storage");return i&&qF(r,...i),r}function qF(t,e,n,r={}){zF(t,e,n,r)}function HF(t,{instanceIdentifier:e}){const n=t.getProvider("app").getImmediate(),r=t.getProvider("auth-internal"),i=t.getProvider("app-check-internal");return new I_(n,r,i,e,ro)}function WF(){cr(new Qn(uC,HF,"PUBLIC").setMultipleInstances(!0)),In(MI,FI,""),In(MI,FI,"esm2020")}WF();const KF={apiKey:"AIzaSyC70mGCRrjE8iOap8iTHuid8HEuyadue8Y",authDomain:"odontocloud-d92ac.firebaseapp.com",projectId:"odontocloud-d92ac",storageBucket:"odontocloud-d92ac.firebasestorage.app",messagingSenderId:"267020714981",appId:"1:267020714981:web:a44416ea83aa1d1172650c",measurementId:"G-ZMCC5CFY0C"},T_=cy(KF),zI=VS(T_),qI=OA(T_);Es(T_);const GF="/odontocloud-react/assets/fondo.png",dC="/odontocloud-react/assets/logo.png",HI=(t,e)=>{const n={email:t,rol:e,timestamp:Date.now()};localStorage.setItem("odc_session",JSON.stringify(n))},yp=()=>{try{const t=JSON.parse(localStorage.getItem("odc_session"));return t&&Date.now()-t.timestamp<1e3*60*60*24?t:null}catch{return null}},QF=()=>{const t=Ih(),[e,n]=P.useState(""),[r,i]=P.useState(""),[s,o]=P.useState(""),[a,l]=P.useState(navigator.onLine);P.useEffect(()=>{const f=()=>l(!0),m=()=>l(!1);return window.addEventListener("online",f),window.addEventListener("offline",m),()=>{window.removeEventListener("online",f),window.removeEventListener("offline",m)}},[]);const d=f=>{const m=(f||"").toLowerCase();m==="administrador"?t("/dashboard_admin",{replace:!0}):m==="doctor"?t("/dashboard_doctor",{replace:!0}):m==="recepcionista"?t("/dashboard_recepcion",{replace:!0}):o("Rol no reconocido. Contacte al administrador.")};P.useEffect(()=>{if(!navigator.onLine){const m=yp();m!=null&&m.rol?d(m.rol):o("Sin conexin y no hay sesin guardada.");return}const f=gy(zI,async m=>{if(m){const v=yp();if(v!=null&&v.rol){d(v.rol);return}try{const C=lt($e(qI,"users"),et("correo","==",m.email||"")),y=await bn(C);if(!y.empty){const N=y.docs[0].data().rol||"sin_rol";HI(m.email||"",N),d(N)}}catch{d("administrador")}}});return()=>f()},[]);const h=async f=>{if(f.preventDefault(),o(""),!a){const m=yp();m!=null&&m.rol?d(m.rol):o("Sin conexin y no hay sesin guardada.");return}try{const v=(await Rj(zI,e,r)).user,C=lt($e(qI,"users"),et("correo","==",e)),y=await bn(C);if(y.empty){o("Usuario no encontrado en la base de datos.");return}const I=y.docs[0].data().rol||"sin_rol";HI(e,I),d(I)}catch(m){switch(console.error("Error login:",m),m.code){case"auth/user-not-found":o("Usuario no registrado.");break;case"auth/wrong-password":o("Contrasea incorrecta.");break;case"auth/invalid-email":o("Correo no vlido.");break;case"auth/network-request-failed":o("Sin conexin. Usa la sesin guardada o reconecta.");break;default:o("Error al iniciar sesin.")}}};return u.jsx("div",{className:"login-root",style:{backgroundImage:`url(${GF})`,backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat",backgroundAttachment:"fixed",width:"100vw",height:"100vh",display:"flex",justifyContent:"center",alignItems:"center",overflow:"hidden"},children:u.jsxs("div",{className:"container",children:[u.jsxs("div",{className:"left-panel",children:[u.jsx("img",{src:dC,alt:"OdontoCloud Logo",className:"logo"}),u.jsxs("h2",{children:["Su clnica, ",u.jsx("br",{})," ms conectada."]}),u.jsx("p",{children:"OdontoCloud optimiza cada detalle de su gestin."})]}),u.jsxs("div",{className:"right-panel",children:[u.jsx("h3",{children:"Acceso a la plataforma"}),u.jsxs("form",{onSubmit:h,children:[u.jsx("input",{type:"email",placeholder:"usuario@ejemplo.com",value:e,onChange:f=>n(f.target.value),required:a}),u.jsx("input",{type:"password",placeholder:"Contrasea",value:r,onChange:f=>i(f.target.value),required:a}),u.jsx("button",{type:"submit",children:a?"Iniciar sesin":"Entrar (modo offline)"}),s&&u.jsx("p",{style:{color:"red",marginTop:10},children:s}),!a&&u.jsx("p",{style:{color:"orange",marginTop:10},children:" Modo offline activado"})]})]})]})})},hC="@firebase/installations",x_="0.6.19";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fC=1e4,pC=`w:${x_}`,mC="FIS_v2",YF="https://firebaseinstallations.googleapis.com/v1",XF=60*60*1e3,JF="installations",ZF="Installations";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const e4={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},Js=new no(JF,ZF,e4);function gC(t){return t instanceof Yn&&t.code.includes("request-failed")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yC({projectId:t}){return`${YF}/projects/${t}/installations`}function _C(t){return{token:t.token,requestStatus:2,expiresIn:n4(t.expiresIn),creationTime:Date.now()}}async function vC(t,e){const r=(await e.json()).error;return Js.create("request-failed",{requestName:t,serverCode:r.code,serverMessage:r.message,serverStatus:r.status})}function wC({apiKey:t}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t})}function t4(t,{refreshToken:e}){const n=wC(t);return n.append("Authorization",r4(e)),n}async function EC(t){const e=await t();return e.status>=500&&e.status<600?t():e}function n4(t){return Number(t.replace("s","000"))}function r4(t){return`${mC} ${t}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function i4({appConfig:t,heartbeatServiceProvider:e},{fid:n}){const r=yC(t),i=wC(t),s=e.getImmediate({optional:!0});if(s){const d=await s.getHeartbeatsHeader();d&&i.append("x-firebase-client",d)}const o={fid:n,authVersion:mC,appId:t.appId,sdkVersion:pC},a={method:"POST",headers:i,body:JSON.stringify(o)},l=await EC(()=>fetch(r,a));if(l.ok){const d=await l.json();return{fid:d.fid||n,registrationStatus:2,refreshToken:d.refreshToken,authToken:_C(d.authToken)}}else throw await vC("Create Installation",l)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function IC(t){return new Promise(e=>{setTimeout(e,t)})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function s4(t){return btoa(String.fromCharCode(...t)).replace(/\+/g,"-").replace(/\//g,"_")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const o4=/^[cdef][\w-]{21}$/,rg="";function a4(){try{const t=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(t),t[0]=112+t[0]%16;const n=l4(t);return o4.test(n)?n:rg}catch{return rg}}function l4(t){return s4(t).substr(0,22)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cf(t){return`${t.appName}!${t.appId}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TC=new Map;function xC(t,e){const n=cf(t);SC(n,e),c4(n,e)}function SC(t,e){const n=TC.get(t);if(n)for(const r of n)r(e)}function c4(t,e){const n=u4();n&&n.postMessage({key:t,fid:e}),d4()}let bs=null;function u4(){return!bs&&"BroadcastChannel"in self&&(bs=new BroadcastChannel("[Firebase] FID Change"),bs.onmessage=t=>{SC(t.data.key,t.data.fid)}),bs}function d4(){TC.size===0&&bs&&(bs.close(),bs=null)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const h4="firebase-installations-database",f4=1,Zs="firebase-installations-store";let _p=null;function S_(){return _p||(_p=Jx(h4,f4,{upgrade:(t,e)=>{switch(e){case 0:t.createObjectStore(Zs)}}})),_p}async function nh(t,e){const n=cf(t),i=(await S_()).transaction(Zs,"readwrite"),s=i.objectStore(Zs),o=await s.get(n);return await s.put(e,n),await i.done,(!o||o.fid!==e.fid)&&xC(t,e.fid),e}async function bC(t){const e=cf(t),r=(await S_()).transaction(Zs,"readwrite");await r.objectStore(Zs).delete(e),await r.done}async function uf(t,e){const n=cf(t),i=(await S_()).transaction(Zs,"readwrite"),s=i.objectStore(Zs),o=await s.get(n),a=e(o);return a===void 0?await s.delete(n):await s.put(a,n),await i.done,a&&(!o||o.fid!==a.fid)&&xC(t,a.fid),a}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function b_(t){let e;const n=await uf(t.appConfig,r=>{const i=p4(r),s=m4(t,i);return e=s.registrationPromise,s.installationEntry});return n.fid===rg?{installationEntry:await e}:{installationEntry:n,registrationPromise:e}}function p4(t){const e=t||{fid:a4(),registrationStatus:0};return AC(e)}function m4(t,e){if(e.registrationStatus===0){if(!navigator.onLine){const i=Promise.reject(Js.create("app-offline"));return{installationEntry:e,registrationPromise:i}}const n={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},r=g4(t,n);return{installationEntry:n,registrationPromise:r}}else return e.registrationStatus===1?{installationEntry:e,registrationPromise:y4(t)}:{installationEntry:e}}async function g4(t,e){try{const n=await i4(t,e);return nh(t.appConfig,n)}catch(n){throw gC(n)&&n.customData.serverCode===409?await bC(t.appConfig):await nh(t.appConfig,{fid:e.fid,registrationStatus:0}),n}}async function y4(t){let e=await WI(t.appConfig);for(;e.registrationStatus===1;)await IC(100),e=await WI(t.appConfig);if(e.registrationStatus===0){const{installationEntry:n,registrationPromise:r}=await b_(t);return r||n}return e}function WI(t){return uf(t,e=>{if(!e)throw Js.create("installation-not-found");return AC(e)})}function AC(t){return _4(t)?{fid:t.fid,registrationStatus:0}:t}function _4(t){return t.registrationStatus===1&&t.registrationTime+fC<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function v4({appConfig:t,heartbeatServiceProvider:e},n){const r=w4(t,n),i=t4(t,n),s=e.getImmediate({optional:!0});if(s){const d=await s.getHeartbeatsHeader();d&&i.append("x-firebase-client",d)}const o={installation:{sdkVersion:pC,appId:t.appId}},a={method:"POST",headers:i,body:JSON.stringify(o)},l=await EC(()=>fetch(r,a));if(l.ok){const d=await l.json();return _C(d)}else throw await vC("Generate Auth Token",l)}function w4(t,{fid:e}){return`${yC(t)}/${e}/authTokens:generate`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function A_(t,e=!1){let n;const r=await uf(t.appConfig,s=>{if(!CC(s))throw Js.create("not-registered");const o=s.authToken;if(!e&&T4(o))return s;if(o.requestStatus===1)return n=E4(t,e),s;{if(!navigator.onLine)throw Js.create("app-offline");const a=S4(s);return n=I4(t,a),a}});return n?await n:r.authToken}async function E4(t,e){let n=await KI(t.appConfig);for(;n.authToken.requestStatus===1;)await IC(100),n=await KI(t.appConfig);const r=n.authToken;return r.requestStatus===0?A_(t,e):r}function KI(t){return uf(t,e=>{if(!CC(e))throw Js.create("not-registered");const n=e.authToken;return b4(n)?{...e,authToken:{requestStatus:0}}:e})}async function I4(t,e){try{const n=await v4(t,e),r={...e,authToken:n};return await nh(t.appConfig,r),n}catch(n){if(gC(n)&&(n.customData.serverCode===401||n.customData.serverCode===404))await bC(t.appConfig);else{const r={...e,authToken:{requestStatus:0}};await nh(t.appConfig,r)}throw n}}function CC(t){return t!==void 0&&t.registrationStatus===2}function T4(t){return t.requestStatus===2&&!x4(t)}function x4(t){const e=Date.now();return e<t.creationTime||t.creationTime+t.expiresIn<e+XF}function S4(t){const e={requestStatus:1,requestTime:Date.now()};return{...t,authToken:e}}function b4(t){return t.requestStatus===1&&t.requestTime+fC<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function A4(t){const e=t,{installationEntry:n,registrationPromise:r}=await b_(e);return r?r.catch(console.error):A_(e).catch(console.error),n.fid}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function C4(t,e=!1){const n=t;return await R4(n),(await A_(n,e)).token}async function R4(t){const{registrationPromise:e}=await b_(t);e&&await e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function P4(t){if(!t||!t.options)throw vp("App Configuration");if(!t.name)throw vp("App Name");const e=["projectId","apiKey","appId"];for(const n of e)if(!t.options[n])throw vp(n);return{appName:t.name,projectId:t.options.projectId,apiKey:t.options.apiKey,appId:t.options.appId}}function vp(t){return Js.create("missing-app-config-values",{valueName:t})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RC="installations",k4="installations-internal",N4=t=>{const e=t.getProvider("app").getImmediate(),n=P4(e),r=ts(e,"heartbeat");return{app:e,appConfig:n,heartbeatServiceProvider:r,_delete:()=>Promise.resolve()}},D4=t=>{const e=t.getProvider("app").getImmediate(),n=ts(e,RC).getImmediate();return{getId:()=>A4(n),getToken:i=>C4(n,i)}};function j4(){cr(new Qn(RC,N4,"PUBLIC")),cr(new Qn(k4,D4,"PRIVATE"))}j4();In(hC,x_);In(hC,x_,"esm2020");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rh="analytics",V4="firebase_id",O4="origin",L4=60*1e3,M4="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",C_="https://www.googletagmanager.com/gtag/js";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dn=new Sh("@firebase/analytics");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const F4={"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-initialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."},kn=new no("analytics","Analytics",F4);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function U4(t){if(!t.startsWith(C_)){const e=kn.create("invalid-gtag-resource",{gtagURL:t});return dn.warn(e.message),""}return t}function PC(t){return Promise.all(t.map(e=>e.catch(n=>n)))}function B4(t,e){let n;return window.trustedTypes&&(n=window.trustedTypes.createPolicy(t,e)),n}function $4(t,e){const n=B4("firebase-js-sdk-policy",{createScriptURL:U4}),r=document.createElement("script"),i=`${C_}?l=${t}&id=${e}`;r.src=n?n==null?void 0:n.createScriptURL(i):i,r.async=!0,document.head.appendChild(r)}function z4(t){let e=[];return Array.isArray(window[t])?e=window[t]:window[t]=e,e}async function q4(t,e,n,r,i,s){const o=r[i];try{if(o)await e[o];else{const l=(await PC(n)).find(d=>d.measurementId===i);l&&await e[l.appId]}}catch(a){dn.error(a)}t("config",i,s)}async function H4(t,e,n,r,i){try{let s=[];if(i&&i.send_to){let o=i.send_to;Array.isArray(o)||(o=[o]);const a=await PC(n);for(const l of o){const d=a.find(f=>f.measurementId===l),h=d&&e[d.appId];if(h)s.push(h);else{s=[];break}}}s.length===0&&(s=Object.values(e)),await Promise.all(s),t("event",r,i||{})}catch(s){dn.error(s)}}function W4(t,e,n,r){async function i(s,...o){try{if(s==="event"){const[a,l]=o;await H4(t,e,n,a,l)}else if(s==="config"){const[a,l]=o;await q4(t,e,n,r,a,l)}else if(s==="consent"){const[a,l]=o;t("consent",a,l)}else if(s==="get"){const[a,l,d]=o;t("get",a,l,d)}else if(s==="set"){const[a]=o;t("set",a)}else t(s,...o)}catch(a){dn.error(a)}}return i}function K4(t,e,n,r,i){let s=function(...o){window[r].push(arguments)};return window[i]&&typeof window[i]=="function"&&(s=window[i]),window[i]=W4(s,t,e,n),{gtagCore:s,wrappedGtag:window[i]}}function G4(t){const e=window.document.getElementsByTagName("script");for(const n of Object.values(e))if(n.src&&n.src.includes(C_)&&n.src.includes(t))return n;return null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Q4=30,Y4=1e3;class X4{constructor(e={},n=Y4){this.throttleMetadata=e,this.intervalMillis=n}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,n){this.throttleMetadata[e]=n}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}}const kC=new X4;function J4(t){return new Headers({Accept:"application/json","x-goog-api-key":t})}async function Z4(t){var o;const{appId:e,apiKey:n}=t,r={method:"GET",headers:J4(n)},i=M4.replace("{app-id}",e),s=await fetch(i,r);if(s.status!==200&&s.status!==304){let a="";try{const l=await s.json();(o=l.error)!=null&&o.message&&(a=l.error.message)}catch{}throw kn.create("config-fetch-failed",{httpStatus:s.status,responseMessage:a})}return s.json()}async function eU(t,e=kC,n){const{appId:r,apiKey:i,measurementId:s}=t.options;if(!r)throw kn.create("no-app-id");if(!i){if(s)return{measurementId:s,appId:r};throw kn.create("no-api-key")}const o=e.getThrottleMetadata(r)||{backoffCount:0,throttleEndTimeMillis:Date.now()},a=new rU;return setTimeout(async()=>{a.abort()},L4),NC({appId:r,apiKey:i,measurementId:s},o,a,e)}async function NC(t,{throttleEndTimeMillis:e,backoffCount:n},r,i=kC){var a;const{appId:s,measurementId:o}=t;try{await tU(r,e)}catch(l){if(o)return dn.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${o} provided in the "measurementId" field in the local Firebase config. [${l==null?void 0:l.message}]`),{appId:s,measurementId:o};throw l}try{const l=await Z4(t);return i.deleteThrottleMetadata(s),l}catch(l){const d=l;if(!nU(d)){if(i.deleteThrottleMetadata(s),o)return dn.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${o} provided in the "measurementId" field in the local Firebase config. [${d==null?void 0:d.message}]`),{appId:s,measurementId:o};throw l}const h=Number((a=d==null?void 0:d.customData)==null?void 0:a.httpStatus)===503?Dw(n,i.intervalMillis,Q4):Dw(n,i.intervalMillis),f={throttleEndTimeMillis:Date.now()+h,backoffCount:n+1};return i.setThrottleMetadata(s,f),dn.debug(`Calling attemptFetch again in ${h} millis`),NC(t,f,r,i)}}function tU(t,e){return new Promise((n,r)=>{const i=Math.max(e-Date.now(),0),s=setTimeout(n,i);t.addEventListener(()=>{clearTimeout(s),r(kn.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}function nU(t){if(!(t instanceof Yn)||!t.customData)return!1;const e=Number(t.customData.httpStatus);return e===429||e===500||e===503||e===504}class rU{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach(e=>e())}}async function iU(t,e,n,r,i){if(i&&i.global){t("event",n,r);return}else{const s=await e,o={...r,send_to:s};t("event",n,o)}}async function sU(t,e,n,r){if(r&&r.global){const i={};for(const s of Object.keys(n))i[`user_properties.${s}`]=n[s];return t("set",i),Promise.resolve()}else{const i=await e;t("config",i,{update:!0,user_properties:n})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function oU(){if(ay())try{await Qx()}catch(t){return dn.warn(kn.create("indexeddb-unavailable",{errorInfo:t==null?void 0:t.toString()}).message),!1}else return dn.warn(kn.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;return!0}async function aU(t,e,n,r,i,s,o){const a=eU(t);a.then(m=>{n[m.measurementId]=m.appId,t.options.measurementId&&m.measurementId!==t.options.measurementId&&dn.warn(`The measurement ID in the local Firebase config (${t.options.measurementId}) does not match the measurement ID fetched from the server (${m.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(m=>dn.error(m)),e.push(a);const l=oU().then(m=>{if(m)return r.getId()}),[d,h]=await Promise.all([a,l]);G4(s)||$4(s,d.measurementId),i("js",new Date);const f=(o==null?void 0:o.config)??{};return f[O4]="firebase",f.update=!0,h!=null&&(f[V4]=h),i("config",d.measurementId,f),d.measurementId}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lU{constructor(e){this.app=e}_delete(){return delete Jo[this.app.options.appId],Promise.resolve()}}let Jo={},GI=[];const QI={};let wp="dataLayer",cU="gtag",YI,R_,XI=!1;function uU(){const t=[];if(Wx()&&t.push("This is a browser extension environment."),dN()||t.push("Cookies are not available."),t.length>0){const e=t.map((r,i)=>`(${i+1}) ${r}`).join(" "),n=kn.create("invalid-analytics-context",{errorInfo:e});dn.warn(n.message)}}function dU(t,e,n){uU();const r=t.options.appId;if(!r)throw kn.create("no-app-id");if(!t.options.apiKey)if(t.options.measurementId)dn.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${t.options.measurementId} provided in the "measurementId" field in the local Firebase config.`);else throw kn.create("no-api-key");if(Jo[r]!=null)throw kn.create("already-exists",{id:r});if(!XI){z4(wp);const{wrappedGtag:s,gtagCore:o}=K4(Jo,GI,QI,wp,cU);R_=s,YI=o,XI=!0}return Jo[r]=aU(t,GI,QI,e,YI,wp,n),new lU(t)}function hU(t=bh()){t=ze(t);const e=ts(t,rh);return e.isInitialized()?e.getImmediate():fU(t)}function fU(t,e={}){const n=ts(t,rh);if(n.isInitialized()){const i=n.getImmediate();if(Qr(e,n.getOptions()))return i;throw kn.create("already-initialized")}return n.initialize({options:e})}function pU(t,e,n){t=ze(t),sU(R_,Jo[t.app.options.appId],e,n).catch(r=>dn.error(r))}function mU(t,e,n,r){t=ze(t),iU(R_,Jo[t.app.options.appId],e,n,r).catch(i=>dn.error(i))}const JI="@firebase/analytics",ZI="0.10.19";function gU(){cr(new Qn(rh,(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),i=e.getProvider("installations-internal").getImmediate();return dU(r,i,n)},"PUBLIC")),cr(new Qn("analytics-internal",t,"PRIVATE")),In(JI,ZI),In(JI,ZI,"esm2020");function t(e){try{const n=e.getProvider(rh).getImmediate();return{logEvent:(r,i,s)=>mU(n,r,i,s),setUserProperties:(r,i)=>pU(n,r,i)}}catch(n){throw kn.create("interop-component-reg-failed",{reason:n})}}}gU();const yU={apiKey:"AIzaSyC70mGCRrjE8iOap8iTHuid8HEuyadue8Y",authDomain:"odontocloud-d92ac.firebaseapp.com",projectId:"odontocloud-d92ac",storageBucket:"odontocloud-d92ac.firebasestorage.app",messagingSenderId:"267020714981",appId:"1:267020714981:web:a44416ea83aa1d1172650c",measurementId:"G-ZMCC5CFY0C"},df=cy(yU),ih=VS(df),Ee=OA(df);Es(df);hU(df);const Ep="TU EMPRESA S.A.S.",_U="Generado por OdontoCloud",Su=()=>{const t=new Date;return t.setHours(0,0,0,0),t},ds=t=>{const e=new Date(t);return e.setHours(0,0,0,0),e},Ip=t=>{const e=new Date(t);return e.setHours(23,59,59,999),e},_r=(t,e)=>{const n=new Date(t);return n.setDate(n.getDate()+e),n},eT=t=>{const e=new Date(t),n=e.getDay(),r=(n===0?-6:1)-n;return e.setDate(e.getDate()+r),e.setHours(0,0,0,0),e},tT=(t,e)=>t.getFullYear()===e.getFullYear()&&t.getMonth()===e.getMonth()&&t.getDate()===e.getDate();var oT;const mn=typeof navigator<"u"&&((oT=navigator.language)!=null&&oT.startsWith("es"))?"es-ES":"en-US",Tp=t=>{const e=t.getFullYear(),n=String(t.getMonth()+1).padStart(2,"0"),r=String(t.getDate()).padStart(2,"0");return`${e}-${n}-${r}`},_o=t=>(t||"").toString().toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/\s+/g," ").trim();function vU(){const[t,e]=P.useState("day"),[n,r]=P.useState(Su()),[i,s]=P.useState(Su()),[o,a]=P.useState(!0),[l,d]=P.useState([]),[h,f]=P.useState(""),[m,v]=P.useState(""),[C,y]=P.useState("");P.useEffect(()=>{a(!0);const z=$e(Ee,"citas"),Z=lt(z,An("fecha","asc")),oe=rr(Z,ye=>{const xe=ye.docs.map(we=>{const ie=we.data(),Pe=ie.horaInicio||ie.hora||"00:00",[_t="0",wt="0"]=Pe.split(":"),te=parseInt(_t,10)||0,re=parseInt(wt,10)||0;let he;if(ie.fecha&&ie.fecha.toDate)he=ie.fecha.toDate(),he.setHours(te,re,0,0);else if(typeof ie.fecha=="string"){const[S,F,G]=ie.fecha.split("-");he=new Date(parseInt(S,10),parseInt(F,10)-1,parseInt(G,10),te,re,0,0)}else ie.fecha instanceof Date?(he=new Date(ie.fecha),he.setHours(te,re,0,0)):(he=new Date,he.setHours(te,re,0,0));const ne=ie.documentoPaciente||ie.docPaciente||ie.pacienteDocumento||ie.documento||"",ee=ie.celularPaciente||ie.telefonoPaciente||ie.celular||ie.telefono||"";return{id:we.id,raw:ie,fecha:he,horaInicio:Pe,paciente:ie.paciente||ie.pacienteNombre||"Sin nombre",doctor:ie.doctor||ie.doctorNombre||"",sucursal:ie.sucursal||"",espacio:ie.espacio||ie.consultorio||"",comentario:ie.comentario||"",estado:ie.estado||"En espera",recordatorio:ie.recordatorio||"",documento:ne,telefono:ee}});let Re,ve;if(t==="day")Re=ds(n),ve=Ip(n);else if(t==="week"){const we=eT(n),ie=_r(we,6);Re=ds(we),ve=Ip(ie)}else{const we=ds(n),ie=_r(we,-30),Pe=_r(we,60);Re=ds(ie),ve=Ip(Pe)}const Ge=xe.filter(we=>we.fecha>=Re&&we.fecha<=ve);d(Ge),a(!1)},ye=>{console.error("Error leyendo citas:",ye),d([]),a(!1)});return()=>oe()},[t,n]);const N=P.useMemo(()=>{const z=new Set;return l.forEach(Z=>Z.sucursal&&z.add(Z.sucursal)),Array.from(z)},[l]),I=P.useMemo(()=>{const z=new Set;return l.forEach(Z=>Z.doctor&&z.add(Z.doctor)),Array.from(z)},[l]),_=P.useMemo(()=>{const z=C.trim().toLowerCase();return l.filter(Z=>{if(h&&Z.sucursal!==h||m&&Z.doctor!==m)return!1;if(!z)return!0;const oe=[Z.paciente,Z.doctor,Z.comentario,Z.documento,Z.sucursal,Z.espacio,Z.estado],ye=Z.raw?JSON.stringify(Z.raw):"";return[...oe,ye].filter(Boolean).some(Re=>String(Re).toLowerCase().includes(z))})},[l,h,m,C]),T=P.useMemo(()=>o?"Ocupacin: cargando...":_.length===0?"Ocupacin: sin citas para el rango seleccionado.":`Ocupacin: ${_.length} cita${_.length!==1?"s":""} en el rango actual.`,[_,o]),R=P.useMemo(()=>{const z=new Date(i.getFullYear(),i.getMonth(),1),Z=(z.getDay()+6)%7,oe=new Date(z);oe.setDate(oe.getDate()-Z);const ye=[];for(let xe=0;xe<6;xe++){const Re=[];for(let ve=0;ve<7;ve++){const Ge=new Date(oe),we=Ge.getMonth()===i.getMonth(),ie=tT(Ge,Su()),Pe=tT(Ge,n);Re.push({date:Ge,isCurrentMonth:we,isToday:ie,isSelected:Pe}),oe.setDate(oe.getDate()+1)}ye.push(Re)}return ye},[i,n]),O=()=>{const z=new Date(i);z.setMonth(z.getMonth()-1),s(z)},$=()=>{const z=new Date(i);z.setMonth(z.getMonth()+1),s(z)},x=z=>{r(ds(z)),s(ds(z)),e("day")},w=P.useMemo(()=>i.toLocaleDateString(mn,{month:"long",year:"numeric"}),[i]),A=P.useMemo(()=>{if(t==="day")return n.toLocaleDateString(mn,{weekday:"long",day:"2-digit",month:"long",year:"numeric"});if(t==="week"){const z=eT(n),Z=_r(z,6);return z.toLocaleDateString(mn,{day:"2-digit",month:"short"})+" - "+Z.toLocaleDateString(mn,{day:"2-digit",month:"short",year:"numeric"})}return"ltimas citas (detalle)"},[t,n]),k=()=>{r(t==="day"?_r(n,-1):t==="week"?_r(n,-7):_r(n,-1))},D=()=>{r(t==="day"?_r(n,1):t==="week"?_r(n,7):_r(n,1))},j=()=>{const z=Su();r(z),s(z),e("day")},b=()=>{var _t,wt,te;const z=re=>String(re??"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),Z=((_t=document.querySelector('meta[name="company-name"]'))==null?void 0:_t.getAttribute("content"))||Ep,oe=((wt=document.querySelector('meta[name="company-logo"]'))==null?void 0:wt.getAttribute("content"))||"",ye="Generado por OdontoCloud",xe=_.length===0?'<tr><td colspan="6" style="padding:8px 6px;color:#6b7280">No hay citas registradas para este rango.</td></tr>':_.map(re=>{const he=re.fecha.toLocaleDateString(mn),ne=re.fecha.toLocaleTimeString(mn,{hour:"2-digit",minute:"2-digit",hour12:!0});return`<tr>
              <td>${z(he)}</td>
              <td>${z(ne)}</td>
              <td>${z(re.paciente)}</td>
              <td>${z(re.doctor)}</td>
              <td>${z(re.espacio)}</td>
              <td>${z(re.comentario)}</td>
            </tr>`}).join(""),ve=`<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>Imprimir  ${z(Z)}</title>
  <style>
    @page { size: A4 portrait; margin: 18mm; }
    body { font-family: Segoe UI, Roboto, Arial, sans-serif; color:#0f172a; }
    .hdr { display:flex; align-items:center; gap:12px; border-bottom:2px solid #e5e7eb; padding-bottom:8px; margin-bottom:12px; }
    .brand { font-size:18px; font-weight:700; color:#0a86d8; line-height:1.1; }
    .sub { font-size:12px; color:#6b7280; }
    table { width:100%; border-collapse:collapse; font-size:12px; }
    th { text-align:left; background:#f3f4f6; border-bottom:1px solid #e5e7eb; padding:8px 6px; }
    td { border-bottom:1px solid #f1f5f9; padding:7px 6px; vertical-align:top; }
    .note { margin-top:8px; font-size:10px; color:#9ca3af; }
    tr, .hdr { page-break-inside: avoid; }
  </style>
</head>
<body>
  <div class="hdr">
    ${oe?`<img src="${oe}" alt="Logo" style="height:36px;object-fit:contain">`:""}
    <div>
      <div class="brand">${z(Z)}</div>
      <div class="sub">Agenda de citas  ${z(A)}</div>
    </div>
  </div>

  <table>
    <thead>
      <tr>
        <th style="width:18%">Fecha</th>
        <th style="width:10%">Hora</th>
        <th style="width:22%">Paciente</th>
        <th style="width:20%">Doctor</th>
        <th style="width:15%">Espacio</th>
        <th>Comentario</th>
      </tr>
    </thead>
    <tbody>${xe}</tbody>
  </table>

  <div class="note">${z(ye)}. ${z(new Date().toLocaleString(mn))}</div>
  <script>
    // Imprimir cuando termine de cargar la pestaa (incluye el logo)
    window.addEventListener('load', function() {
      try { window.focus(); window.print(); } catch (e) {}
    });
  <\/script>
</body>
</html>`,Ge=new Blob([ve],{type:"text/html;charset=utf-8"}),we=URL.createObjectURL(Ge),ie=window.open(we,"_blank","noopener,noreferrer,width=900,height=700");if(!ie){alert("El navegador bloque la ventana de impresin. Permite pop-ups para este sitio."),URL.revokeObjectURL(we);return}const Pe=()=>{try{URL.revokeObjectURL(we)}catch{}};(te=ie.addEventListener)==null||te.call(ie,"load",Pe),setTimeout(Pe,15e3)},Q=()=>alert("Funcin de confirmar citas se integrar con n8n / correo."),qe=()=>j(),St=()=>{if(_.length===0){alert("No hay citas para exportar.");return}const z=[`Empresa: ${Ep}`],Z=["Fecha","Hora","Paciente","Doctor","Espacio","Comentario"],oe=_.map(ie=>{const Pe=ie.fecha.toLocaleDateString(mn),_t=ie.fecha.toLocaleTimeString(mn,{hour:"2-digit",minute:"2-digit",hour12:!0});return[Pe,_t,ie.paciente||"",ie.doctor||"",ie.espacio||"",(ie.comentario||"").replace(/\r?\n/g," ")]}),ye=[_U],xe=[z,[],Z,...oe,[],ye].map(ie=>(ie||[]).map(Pe=>`"${String(Pe??"").replace(/"/g,'""')}"`).join(",")).join(`
`),Re=`citas_${Ep.toLowerCase().replace(/\s+/g,"_")}_${Tp(ds(n))}`+(t==="week"?"_semana":t==="detail"?"_detalle":"")+".csv",ve=new Blob(["\uFEFF"+xe],{type:"text/csv;charset=utf-8;"}),Ge=URL.createObjectURL(ve),we=document.createElement("a");we.href=Ge,we.download=Re,we.click(),URL.revokeObjectURL(Ge)},qt=async(z,Z)=>{try{const oe=Bt(Ee,"citas",z);await Xo(oe,{estado:Z})}catch(oe){console.error("Error actualizando estado:",oe),alert("No se pudo actualizar el estado de la cita.")}},X=(z,Z)=>{if(!z){alert("Este paciente no tiene celular registrado.");return}const oe=String(z).replace(/\D/g,""),ye=Z.fecha.toLocaleDateString(mn),xe=Z.fecha.toLocaleTimeString(mn,{hour:"numeric",minute:"2-digit",hour12:!0}),Re=encodeURIComponent(`Hola ${Z.paciente}, le recordamos su cita odontolgica el ${ye} a las ${xe}. Por favor confirme su asistencia.`),ve=`https://wa.me/${oe}?text=${Re}`;window.open(ve,"_blank")},de=async z=>{if(window.confirm(`Seguro que deseas eliminar la cita de ${z.paciente} del ${z.fecha.toLocaleDateString(mn)}?`))try{const oe=Bt(Ee,"citas",z.id);await QA(oe)}catch(oe){console.error("Error eliminando cita:",oe),alert(" No se pudo eliminar la cita.")}},me=()=>{const z=document.createElement("div");Object.assign(z.style,{position:"fixed",top:"0",left:"0",width:"100%",height:"100%",background:"rgba(0,0,0,0.55)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:"9999"});const Z=document.createElement("div");Object.assign(Z.style,{background:"#fff",padding:"25px 30px",borderRadius:"14px",width:"520px",maxWidth:"95%",maxHeight:"95%",overflowY:"auto",boxShadow:"0 8px 30px rgba(0,0,0,0.3)",fontFamily:"Segoe UI, Roboto, sans-serif"}),Z.innerHTML=`
      <h2 style="margin-top:0;text-align:center;color:#0a86d8;font-weight:600;"> Nueva Cita</h2>
      <form id="formNuevaCita" style="display:flex;flex-direction:column;gap:12px;margin-top:10px;">
        <label style="font-weight:600;">Paciente existente</label>
        <div style="position:relative;">
          <input type="text" id="buscarPaciente" placeholder="Buscar por nombre, apellido o documento..." autocomplete="off"/>
          <div id="acResultados" style="position:absolute;left:0;right:0;top:calc(100% + 6px);z-index:10000;display:none;background:#fff;border:1px solid #ddd;border-radius:8px;box-shadow:0 8px 22px rgba(0,0,0,.12);max-height:240px;overflow:auto;"></div>
        </div>
        <small style="color:gray;">Si el paciente no existe, marca Registrar nuevo paciente.</small>

        <label style="display:flex;align-items:center;gap:8px;margin-top:5px;">
          <input type="checkbox" id="esNuevoPaciente" />
          <span>Registrar nuevo paciente</span>
        </label>

        <div id="nuevoPacienteCampos" style="display:none;flex-direction:column;gap:8px;margin-top:10px;padding:10px;border-radius:8px;background:#f9f9f9;border:1px solid #ddd;">
          <h4 style="margin:0;text-align:center;color:#0a86d8;">Datos del paciente</h4>
          <div style="display:flex;gap:8px;">
            <input type="text" id="npNombre" placeholder="Nombre" style="flex:1;" />
            <input type="text" id="npApellido" placeholder="Apellido" style="flex:1;" />
          </div>
          <select id="npTipoDocumento">
            <option value="">Tipo de documento</option>
            <option value="CC">Cdula de Ciudadana</option>
            <option value="CE">Cdula de Extranjera</option>
            <option value="TI">Tarjeta de Identidad</option>
            <option value="PA">Pasaporte</option>
            <option value="DI">Documento Internacional</option>
            <option value="OTRO">Otro</option>
          </select>
          <input type="text" id="npDocumento" placeholder="Nmero de documento" />
          <input type="email" id="npCorreo" placeholder="Correo electrnico" />
          <div style="display:flex;gap:5px;">
            <select id="npIndicativo" style="width:40%;">
              <option value="+57"> +57</option>
              <option value="+1"> +1</option>
              <option value="+34"> +34</option>
              <option value="+52"> +52</option>
              <option value="+54"> +54</option>
              <option value="+593"> +593</option>
              <option value="+56"> +56</option>
              <option value="+58"> +58</option>
            </select>
            <input type="tel" id="npCelular" placeholder="Celular (obligatorio)" style="flex:1;" />
          </div>
          <input type="tel" id="npTelefono" placeholder="Telfono fijo (opcional)" />
          <label style="font-weight:500;">Fecha de nacimiento:</label>
          <input type="date" id="npNacimiento" />
          <select id="npSexo">
            <option value="">Sexo</option>
            <option value="Masculino">Masculino</option>
            <option value="Femenino">Femenino</option>
            <option value="Otro">Otro</option>
          </select>
          <textarea id="npComentario" placeholder="Comentario o antecedentes del paciente" rows="2"></textarea>
        </div>

        <hr style="margin:10px 0;border:none;border-top:1px solid #ddd;" />
        <h4 style="margin:0;text-align:center;color:#0a86d8;">Detalles de la cita</h4>
        <input type="text" id="ncDoctor" placeholder="Doctor asignado" required />
        <input type="date" id="ncFecha" required value="${Tp(n)}" />
        <input type="time" id="ncHora" required />
        <input type="text" id="ncEspacio" placeholder="Espacio fsico / Sala" />
        <textarea id="ncComentario" placeholder="Comentario sobre la cita" rows="3"></textarea>

        <div style="display:flex;justify-content:flex-end;gap:10px;margin-top:10px;">
          <button type="button" id="btnCancelarModal" class="btn-cancelar">Cancelar</button>
          <button type="submit" class="btn-guardar">Guardar</button>
        </div>
      </form>
    `;const oe=document.createElement("style");oe.textContent=`
      .btn-cancelar, .btn-guardar { padding: 8px 14px; border: none; border-radius: 6px; cursor: pointer; font-weight: 600; font-size: 14px; transition: .2s; }
      .btn-cancelar { background: #e0e0e0; color: #333; } .btn-cancelar:hover { background: #d5d5d5; }
      .btn-guardar { background: #0a86d8; color: white; } .btn-guardar:hover { background: #0669ac; }
      input, select, textarea { width: 100%; padding: 8px 10px; border: 1px solid #ccc; border-radius: 6px; font-size: 14px; outline: none; }
      input:focus, select:focus, textarea:focus { border-color: #0a86d8; box-shadow: 0 0 0 2px rgba(10,134,216,.2); }
      .ac-item { padding: 8px 10px; display:flex; gap:8px; align-items:baseline; cursor:pointer; }
      .ac-item:hover, .ac-item.active { background:#f5f7fb; }
      .ac-name { font-weight:600; } .ac-doc { color:#64748b; font-size:12px; } .ac-tel { margin-left:auto; font-size:12px; color:#0f172a; }
      .ac-empty { padding:10px; color:#9aa4b2; font-size:13px; }
    `,document.head.appendChild(oe),z.appendChild(Z),document.body.appendChild(z);const ye=Z.querySelector("#esNuevoPaciente"),xe=Z.querySelector("#nuevoPacienteCampos"),Re=Z.querySelector("#buscarPaciente"),ve=Z.querySelector("#acResultados");ye.addEventListener("change",()=>{xe.style.display=ye.checked?"flex":"none",ye.checked&&(ve.style.display="none")}),Z.querySelector("#btnCancelarModal").addEventListener("click",()=>z.remove());let Ge=null,we=null,ie=-1,Pe=[];const _t=ee=>{if(Pe=ee||[],ie=-1,!ee||ee.length===0){ve.innerHTML='<div class="ac-empty">Sin resultados</div>',ve.style.display="block";return}ve.innerHTML=ee.map((S,F)=>`
            <div class="ac-item" data-index="${F}" data-id="${S.id}">
              <span class="ac-name">${S.nombre}</span>
              <span class="ac-doc"> ${S.documento||"s/doc"}</span>
              <span class="ac-tel">${S.celular||S.telefono||""}</span>
            </div>`).join(""),ve.style.display="block",[...ve.querySelectorAll(".ac-item")].forEach(S=>{S.addEventListener("click",()=>{const F=Number(S.getAttribute("data-index"));wt(F)})})},wt=ee=>{const S=Pe[ee];S&&(we=S,Re.value=S.nombre,ve.style.display="none",ye.checked=!1,xe.style.display="none")},te=ee=>{Pe.length&&(ie=(ie+ee+Pe.length)%Pe.length,[...ve.querySelectorAll(".ac-item")].forEach((S,F)=>{F===ie?S.classList.add("active"):S.classList.remove("active")}))},re=(ee,S)=>ee.nombreCompleto||ee.paciente||[ee.nombres,ee.apellidos].filter(Boolean).join(" ")||S,he=async ee=>{const S=(ee||"").toString().trim(),F=_o(S);if(!F||F.length<2)return[];if(/^\d{5,}$/.test(S))try{const G=lt($e(Ee,"pacientes"),et("documento","==",S)),ce=lt($e(Ee,"pacientes"),et("nroDocumento","==",S)),[fe,Se]=await Promise.all([bn(G),bn(ce)]),be=fe.empty?Se:fe;if(!be.empty)return be.docs.slice(0,10).map(Fe=>{const M=Fe.data()||{};return{id:Fe.id,nombre:re(M,Fe.id),documento:M.documento||M.nroDocumento||Fe.id,celular:M.celularPaciente||M.celular||"",telefono:M.telefonoPaciente||M.telefono||""}})}catch{}try{const G=lt($e(Ee,"pacientes"),An("nombre_busqueda"),RI(F),PI(F+""),Yo(10)),ce=await bn(G);if(!ce.empty)return ce.docs.map(fe=>{const Se=fe.data()||{};return{id:fe.id,nombre:re(Se,fe.id),documento:Se.documento||Se.nroDocumento||fe.id,celular:Se.celularPaciente||Se.celular||"",telefono:Se.telefonoPaciente||Se.telefono||""}})}catch{}try{const G=lt($e(Ee,"pacientes"),An("creado","desc"),Yo(50));return(await bn(G)).docs.map(be=>({id:be.id,...be.data()||{}})).map(be=>({id:be.id,nombre:re(be,be.id),documento:be.documento||be.nroDocumento||be.id,celular:be.celularPaciente||be.celular||"",telefono:be.telefonoPaciente||be.telefono||"",_norm:_o(`${be.nombreCompleto||be.paciente||""} ${be.nombres||""} ${be.apellidos||""} ${be.documento||be.nroDocumento||""}`)})).filter(be=>be._norm.includes(F)).slice(0,10).map(({_norm:be,...Fe})=>Fe)}catch{}return[]};Re.addEventListener("input",()=>{we=null;const ee=Re.value;if(clearTimeout(Ge),!ee||ee.trim().length<2){ve.style.display="none";return}Ge=setTimeout(async()=>{const S=await he(ee.trim());_t(S)},220)}),Re.addEventListener("keydown",ee=>{ve.style.display==="block"&&(ee.key==="ArrowDown"?(ee.preventDefault(),te(1)):ee.key==="ArrowUp"?(ee.preventDefault(),te(-1)):ee.key==="Enter"?ie>=0&&(ee.preventDefault(),wt(ie)):ee.key==="Escape"&&(ve.style.display="none"))}),document.addEventListener("click",ee=>{Z.contains(ee.target)&&!ve.contains(ee.target)&&ee.target!==Re&&(ve.style.display="none")},{capture:!0});const ne=Z.querySelector("#formNuevaCita");ne.addEventListener("submit",async ee=>{ee.preventDefault();const S=ye.checked,F=(ne.querySelector("#buscarPaciente").value||"").trim(),G=ne.querySelector("#ncDoctor").value.trim(),ce=ne.querySelector("#ncFecha").value,fe=ne.querySelector("#ncHora").value,Se=ne.querySelector("#ncEspacio").value.trim(),be=ne.querySelector("#ncComentario").value.trim();if(!ce||!fe){alert(" Debes seleccionar fecha y hora para la cita.");return}if(!G){alert(" Indica el doctor asignado.");return}try{let Fe=null,M=null,K="",se="",Te="";if(S){const Ht=(ne.querySelector("#npNombre").value||"").trim(),Xn=(ne.querySelector("#npApellido").value||"").trim();if(K=`${Ht} ${Xn}`.trim(),!K){alert(" Debes indicar nombre y apellido para el nuevo paciente.");return}const pn=(ne.querySelector("#npDocumento").value||"").trim(),kt=(ne.querySelector("#npCelular").value||"").trim(),Wt=(ne.querySelector("#npTelefono").value||"").trim();if(!kt&&!Wt){alert(" Debes registrar al menos un telfono (celular o fijo) del paciente o de un acudiente.");return}if(Fe=pn||K.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/\s+/g,"_"),M=Bt(Ee,"pacientes",Fe),!(await eh(M)).exists()){const Be=_o(K);await th(M,{nombres:Ht,apellidos:Xn,nombreCompleto:K,paciente:K,nombre_busqueda:Be,variantes_busqueda:[Be,_o(Ht),_o(Xn)],tipoDocumento:ne.querySelector("#npTipoDocumento").value,documento:pn,correo:(ne.querySelector("#npCorreo").value||"").trim(),indicativo:ne.querySelector("#npIndicativo").value,celular:kt,telefono:Wt,celularPaciente:kt,telefonoPaciente:Wt,fechaNacimiento:ne.querySelector("#npNacimiento").value,sexo:ne.querySelector("#npSexo").value,notas:(ne.querySelector("#npComentario").value||"").trim(),creado:new Date().toISOString(),activo:!0,citas:[]},{merge:!0})}se=kt,Te=Wt}else if(we)Fe=we.id,K=we.nombre,M=Bt(Ee,"pacientes",Fe),se=we.celular||"",Te=we.telefono||"";else{if(!F){alert(" Por favor, escribe o selecciona un paciente.");return}const Ht=lt($e(Ee,"pacientes"),et("documento","==",F)),Xn=lt($e(Ee,"pacientes"),et("nroDocumento","==",F)),[pn,kt]=await Promise.all([bn(Ht),bn(Xn)]),Wt=pn.empty?kt:pn;if(Wt.empty){let rn=null;try{const Be=_o(F),Uc=lt($e(Ee,"pacientes"),An("nombre_busqueda"),RI(Be),PI(Be+""),Yo(1)),ri=await bn(Uc);if(!ri.empty){const jr=ri.docs[0],pr=jr.data()||{};rn={id:jr.id,ref:jr.ref,nombre:pr.nombreCompleto||pr.paciente||[pr.nombres,pr.apellidos].filter(Boolean).join(" "),cel:pr.celularPaciente||pr.celular||"",tel:pr.telefonoPaciente||pr.telefono||""}}}catch{}rn?(Fe=rn.id,M=rn.ref,K=rn.nombre||F,se=rn.cel||"",Te=rn.tel||""):K=F}else{const rn=Wt.docs[0],Be=rn.data()||{};Fe=rn.id,M=rn.ref,K=Be.nombreCompleto||Be.paciente||[Be.nombres,Be.apellidos].filter(Boolean).join(" ")||F,se=Be.celularPaciente||Be.celular||"",Te=Be.telefonoPaciente||Be.telefono||""}}if(!(se||Te||"").trim()){alert(" Este paciente no tiene ningn telfono registrado. Edita sus datos y agrega un nmero antes de guardar la cita.");return}const Lt={paciente:K||"Paciente",pacienteId:Fe||null,doctor:G,fecha:ce,horaInicio:fe,espacio:Se,comentario:be,estado:"En espera",creado:new Date().toISOString(),celularPaciente:se||"",telefonoPaciente:Te||""},On=await yl($e(Ee,"citas"),Lt);M&&await th(M,{citas:RM(On.id)},{merge:!0}),alert(" Cita registrada correctamente y vinculada al paciente."),z.remove()}catch(Fe){console.error(" Error al guardar cita:",Fe),alert(" Error al guardar la cita. Revisa la consola para ms detalles.")}})},Ne=z=>{var Ge,we;const Z=document.createElement("div");Object.assign(Z.style,{position:"fixed",top:"0",left:"0",width:"100%",height:"100%",background:"rgba(0,0,0,0.55)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:"9999"});const oe=document.createElement("div");Object.assign(oe.style,{background:"#fff",padding:"25px 30px",borderRadius:"14px",width:"520px",maxWidth:"95%",maxHeight:"95%",overflowY:"auto",boxShadow:"0 8px 30px rgba(0,0,0,0.3)",fontFamily:"Segoe UI, Roboto, sans-serif"});const ye=(Ge=z.raw)!=null&&Ge.fecha&&typeof z.raw.fecha=="string"?z.raw.fecha:Tp(z.fecha),xe=((we=z.raw)==null?void 0:we.horaInicio)||z.fecha.toTimeString().slice(0,5);oe.innerHTML=`
      <h2 style="margin-top:0;text-align:center;color:#0a86d8;font-weight:600;"> Editar Cita</h2>
      <form id="formEditarCita" style="display:flex;flex-direction:column;gap:12px;margin-top:10px;">
        <label>Paciente</label>
        <input type="text" id="editPaciente" value="${z.paciente||""}" />

        <label>Doctor asignado</label>
        <input type="text" id="editDoctor" value="${z.doctor||""}" />

        <div style="display:flex;gap:8px;">
          <div style="flex:1;">
            <label>Fecha</label>
            <input type="date" id="editFecha" value="${ye}" />
          </div>
          <div style="flex:1;">
            <label>Hora</label>
            <input type="time" id="editHora" value="${xe}" />
          </div>
        </div>

        <label>Espacio fsico / Sala</label>
        <input type="text" id="editEspacio" value="${z.espacio||""}" />

        <label>Estado</label>
        <select id="editEstado" className="estado-select">
          <option value="En espera" ${z.estado==="En espera"?"selected":""}>En espera</option>
          <option value="En sala" ${z.estado==="En sala"?"selected":""}>En sala</option>
          <option value="Atendiendo" ${z.estado==="Atendiendo"?"selected":""}>Atendiendo</option>
          <option value="Finalizada" ${z.estado==="Finalizada"?"selected":""}>Finalizada</option>
          <option value="pendiente" ${z.estado==="pendiente"?"selected":""}>Pendiente</option>
          <option value="No asisti" ${z.estado==="No asisti"?"selected":""}>No asisti</option>
        </select>

        <label>Comentario</label>
        <textarea id="editComentario" rows="3">${z.comentario||""}</textarea>

        <div style="display:flex;justify-content:flex-end;gap:10px;margin-top:10px;">
          <button type="button" id="btnCancelarEdit" className="btn-cancelar">Cancelar</button>
          <button type="submit" className="btn-guardar">Guardar cambios</button>
        </div>
      </form>
    `;const Re=document.createElement("style");Re.textContent=`
      .btn-cancelar, .btn-guardar { padding: 8px 14px; border: none; border-radius: 6px; cursor: pointer; font-weight: 600; font-size: 14px; transition: .2s; }
      .btn-cancelar { background: #e0e0e0; color: #333; } .btn-cancelar:hover { background: #d5d5d5; }
      .btn-guardar { background: #0a86d8; color: white; } .btn-guardar:hover { background: #0669ac; }
      #formEditarCita input, #formEditarCita select, #formEditarCita textarea { width: 100%; padding: 8px 10px; border: 1px solid #ccc; border-radius: 6px; font-size: 14px; outline: none; }
      #formEditarCita input:focus, #formEditarCita select:focus, #formEditarCita textarea:focus { border-color: #0a86d8; box-shadow: 0 0 0 2px rgba(10,134,216,.2); }
    `,document.head.appendChild(Re),Z.appendChild(oe),document.body.appendChild(Z),oe.querySelector("#btnCancelarEdit").addEventListener("click",()=>Z.remove());const ve=oe.querySelector("#formEditarCita");ve.addEventListener("submit",async ie=>{ie.preventDefault();const Pe=ve.querySelector("#editPaciente").value.trim(),_t=ve.querySelector("#editDoctor").value.trim(),wt=ve.querySelector("#editFecha").value,te=ve.querySelector("#editHora").value,re=ve.querySelector("#editEspacio").value.trim(),he=ve.querySelector("#editEstado").value,ne=ve.querySelector("#editComentario").value.trim();if(!Pe)return alert(" El nombre del paciente es obligatorio.");if(!wt||!te)return alert(" Debes indicar fecha y hora.");try{const ee=Bt(Ee,"citas",z.id);await Xo(ee,{paciente:Pe,doctor:_t,fecha:wt,horaInicio:te,espacio:re,estado:he,comentario:ne}),alert(" Cita actualizada correctamente."),Z.remove()}catch(ee){console.error(" Error al actualizar cita:",ee),alert(" Error al actualizar la cita. Revisa la consola para ms detalles.")}})},Ue=z=>{const Z=z.fecha.toLocaleDateString(mn),oe=z.fecha.toLocaleTimeString(mn,{hour:"numeric",minute:"2-digit",hour12:!0}),ye=`${Z}  ${oe}`;return u.jsxs("tr",{className:"fade-in-row",onClick:()=>Ne(z),style:{cursor:"pointer"},children:[u.jsx("td",{children:ye}),u.jsx("td",{children:z.paciente}),u.jsx("td",{children:z.doctor}),u.jsx("td",{children:z.espacio}),u.jsx("td",{children:z.comentario}),u.jsx("td",{onClick:xe=>{xe.stopPropagation()},children:u.jsxs("select",{className:"estado-select",value:z.estado,onChange:xe=>qt(z.id,xe.target.value),children:[u.jsx("option",{value:"En espera",children:"En espera"}),u.jsx("option",{value:"En sala",children:"En sala"}),u.jsx("option",{value:"Atendiendo",children:"Atendiendo"}),u.jsx("option",{value:"Finalizada",children:"Finalizada"}),u.jsx("option",{value:"pendiente",children:"Pendiente"}),u.jsx("option",{value:"No asisti",children:"No asisti"})]})}),u.jsxs("td",{className:"acciones-cell",onClick:xe=>{xe.stopPropagation()},children:[z.telefono?u.jsx("button",{type:"button",className:"btn-whatsapp",onClick:xe=>{xe.stopPropagation(),X(z.telefono,z)},children:"WhatsApp"}):u.jsx("span",{className:"acciones-texto",children:"Sin celular"}),u.jsx("button",{type:"button",className:"btn-delete",onClick:xe=>{xe.stopPropagation(),de(z)},children:"Eliminar"}),z.recordatorio&&u.jsx("span",{className:"acciones-texto",children:z.recordatorio})]})]},z.id)};return u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"odc-topbar-green"}),u.jsx("div",{className:"odc-topbar-blue",children:"Agenda"}),u.jsx("section",{className:"odc-agenda-root",children:u.jsxs("div",{className:"odc-agenda-inner",children:[u.jsxs("aside",{className:"odc-left","aria-label":"Panel izquierdo - calendario y filtros",children:[u.jsxs("div",{className:"odc-mini-calendar-card",role:"region","aria-label":"Mini calendario",children:[u.jsxs("div",{className:"mini-cal-header",children:[u.jsx("button",{className:"cal-arrow",id:"miniCalPrev","aria-label":"Mes anterior",onClick:O,children:""}),u.jsx("div",{id:"miniCalMonthYear","aria-live":"polite",children:w}),u.jsx("button",{className:"cal-arrow",id:"miniCalNext","aria-label":"Mes siguiente",onClick:$,children:""})]}),u.jsxs("table",{className:"mini-month-table","aria-hidden":"false",children:[u.jsx("thead",{children:u.jsxs("tr",{children:[u.jsx("th",{children:"Lu"}),u.jsx("th",{children:"Ma"}),u.jsx("th",{children:"Mi"}),u.jsx("th",{children:"Ju"}),u.jsx("th",{children:"Vi"}),u.jsx("th",{children:"Sa"}),u.jsx("th",{children:"Do"})]})}),u.jsx("tbody",{id:"miniCalendar",children:R.map((z,Z)=>u.jsx("tr",{children:z.map((oe,ye)=>u.jsx("td",{className:[oe.isCurrentMonth?"":"empty",oe.isToday?"today":"",oe.isSelected?"selected":""].filter(Boolean).join(" "),onClick:()=>oe.isCurrentMonth&&x(oe.date),children:oe.date.getDate()},ye))},Z))})]})]}),u.jsxs("div",{className:"odc-filters-card","aria-label":"Filtros de agenda",children:[u.jsx("label",{htmlFor:"filterSucursal",children:"Sucursal"}),u.jsxs("select",{id:"filterSucursal",value:h,onChange:z=>f(z.target.value),children:[u.jsx("option",{value:"",children:" Todas "}),N.map(z=>u.jsx("option",{value:z,children:z},z))]}),u.jsx("label",{htmlFor:"filterDoctor",children:"Doctores"}),u.jsxs("select",{id:"filterDoctor",value:m,onChange:z=>v(z.target.value),children:[u.jsx("option",{value:"",children:" Todos "}),I.map(z=>u.jsx("option",{value:z,children:z},z))]})]})]}),u.jsxs("main",{className:"odc-right","aria-label":"Panel principal - agenda",children:[u.jsxs("div",{className:"odc-header-bar",role:"region","aria-label":"Controles de la agenda",style:{display:"flex",alignItems:"center",justifyContent:"space-between",gap:12},children:[u.jsxs("div",{className:"odc-header-left",style:{display:"flex",alignItems:"center",gap:12,flexWrap:"wrap"},children:[u.jsx("h3",{className:"odc-title",style:{marginRight:8},children:"Agenda"}),u.jsxs("div",{className:"view-buttons",role:"tablist","aria-label":"Vistas",style:{display:"flex",gap:6},children:[u.jsx("button",{className:`btn view ${t==="day"?"active":""}`,"data-view":"day",role:"tab","aria-selected":t==="day",onClick:()=>e("day"),children:"Da"}),u.jsx("button",{className:`btn view ${t==="week"?"active":""}`,"data-view":"week",role:"tab","aria-selected":t==="week",onClick:()=>e("week"),children:"Semana"}),u.jsx("button",{className:`btn view ${t==="detail"?"active":""}`,"data-view":"detail",role:"tab","aria-selected":t==="detail",onClick:()=>e("detail"),children:"Detalle"})]}),u.jsxs("div",{className:"date-nav",style:{display:"flex",alignItems:"center",gap:6,flex:"0 0 auto"},children:[u.jsx("button",{className:"btn icon",id:"btnPrev","aria-label":"Anterior",onClick:k,children:""}),u.jsx("button",{className:"btn icon",id:"btnNext","aria-label":"Siguiente",onClick:D,children:""}),u.jsx("span",{id:"currentDateDisplay",className:"current-date","aria-live":"polite",style:{whiteSpace:"nowrap"},children:A}),u.jsx("button",{id:"btnHoy",className:"btn small",onClick:j,children:"Hoy"})]})]}),u.jsx("div",{className:"odc-header-right",style:{display:"flex",alignItems:"center",gap:8,flexShrink:0},children:u.jsxs("div",{className:"right-actions",style:{display:"flex",alignItems:"center",gap:8},children:[u.jsx("input",{id:"searchCitas",placeholder:"Buscar...",className:"search-input","aria-label":"Buscar citas",value:C,onChange:z=>y(z.target.value)}),u.jsx("button",{id:"btnNuevaCita",className:"btn green","aria-label":"Nueva cita",onClick:me,children:"+ Nueva cita"})]})})]}),u.jsxs("div",{className:"odc-content-card",role:"region","aria-label":"Contenido agenda",children:[u.jsxs("div",{className:"tools-row",children:[u.jsx("div",{className:"tools-left",children:u.jsx("div",{id:"ocupacionInfo",className:"ocupacion-info",children:T})}),u.jsxs("div",{className:"tools-right",children:[u.jsx("button",{id:"btnPrint",className:"btn",title:"Imprimir agenda",onClick:b,children:" Imprimir"}),u.jsx("button",{id:"btnConfirmar",className:"btn blue",title:"Confirmar citas",onClick:Q,children:" Confirmar"}),u.jsx("button",{id:"btnHoyCitas",className:"btn",title:"Ver citas de hoy",onClick:qe,children:" Hoy"}),u.jsx("button",{id:"btnExportar",className:"btn",title:"Exportar citas a CSV",onClick:St,children:" Exportar"})]})]}),u.jsx("div",{className:"table-wrap",role:"region","aria-label":"Lista de citas",children:u.jsxs("table",{className:"appointments-table","aria-live":"polite",children:[u.jsx("thead",{children:u.jsxs("tr",{children:[u.jsx("th",{style:{width:"180px"},children:"Fecha / Hora"}),u.jsx("th",{children:"Paciente"}),u.jsx("th",{children:"Doctor"}),u.jsx("th",{children:"Espacio fsico"}),u.jsx("th",{children:"Comentario"}),u.jsx("th",{style:{width:"120px"},children:"Estado"}),u.jsx("th",{children:"Acciones"})]})}),u.jsx("tbody",{id:"citasTbody",children:o?u.jsx("tr",{children:u.jsx("td",{colSpan:7,className:"no-data",children:"Cargando citas..."})}):_.length===0?u.jsx("tr",{children:u.jsx("td",{colSpan:7,className:"no-data",children:"No hay citas registradas para este rango."})}):_.map(Ue)})]})})]})]})]})})]})}function wU(){return u.jsxs("div",{style:{padding:"20px"},children:[u.jsx("h2",{children:"Mdulo de Facturacin"}),u.jsx("p",{children:"Aqu se registrarn los pagos, facturas y cobros."})]})}function EU(){return u.jsxs("div",{style:{padding:"20px"},children:[u.jsx("h2",{children:"Mdulo de Facturacin"}),u.jsx("p",{children:"Aqu se registrarn los pagos, facturas y cobros."})]})}function IU(){return u.jsxs("div",{style:{padding:"20px"},children:[u.jsx("h2",{children:"Mdulo de Facturacin"}),u.jsx("p",{children:"Aqu se registrarn los pagos, facturas y cobros."})]})}var aT;const bu=typeof navigator<"u"&&((aT=navigator.language)!=null&&aT.startsWith("es"))?"es-ES":"en-US",TU=["Colombia","Argentina","Bolivia","Chile","Costa Rica","Cuba","Ecuador","El Salvador","Espaa","Guatemala","Honduras","Mxico","Nicaragua","Panam","Paraguay","Per","Puerto Rico","Repblica Dominicana","Uruguay","Venezuela","Estados Unidos","Canad"],nT={Colombia:["Bogot","Medelln","Cali","Barranquilla","Cartagena","Ccuta","Bucaramanga","Pereira","Santa Marta","Ibagu"],Mxico:["Ciudad de Mxico","Guadalajara","Monterrey","Puebla","Quertaro","Tijuana","Mrida","Len"],Per:["Lima","Arequipa","Trujillo","Chiclayo","Cusco","Piura"],Chile:["Santiago","Valparaso","Concepcin","La Serena","Antofagasta"],Argentina:["Buenos Aires","Crdoba","Rosario","Mendoza","La Plata"],Espaa:["Madrid","Barcelona","Valencia","Sevilla","Zaragoza","Bilbao"],"Estados Unidos":["Miami","New York","Los ngeles","Houston","Chicago"],Ecuador:["Quito","Guayaquil","Cuenca","Manta"],Venezuela:["Caracas","Maracaibo","Valencia","Barquisimeto","Maracay"]},xU=t=>{if(!t)return"";const[e,n,r]=t.split("-").map(l=>parseInt(l,10)),i=new Date(e,(n||1)-1,r||1),s=new Date;let o=s.getFullYear()-i.getFullYear();const a=s.getMonth()-i.getMonth();return(a<0||a===0&&s.getDate()<i.getDate())&&o--,isNaN(o)?"":String(o)};async function SU(t,{maxW:e=900,maxH:n=900,quality:r=.82}={}){var m;if(!t||!((m=t.type)!=null&&m.startsWith("image/")))return t;const i=await new Promise((v,C)=>{const y=new Image;y.onload=()=>v(y),y.onerror=C,y.src=URL.createObjectURL(t)});let{width:s,height:o}=i;const a=Math.min(e/s,n/o,1);s=Math.round(s*a),o=Math.round(o*a);const l=document.createElement("canvas");l.width=s,l.height=o,l.getContext("2d").drawImage(i,0,0,s,o);const h=await new Promise(v=>l.toBlob(v,"image/jpeg",r)),f=new File([h],(t.name||"foto.jpg").replace(/\.[^.]+$/,".jpg"),{type:"image/jpeg",lastModified:Date.now()});return URL.revokeObjectURL(i.src),f}const _l=t=>(t||"").toString().toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/\s+/g," ").trim(),bU=t=>_l([t.nombres,t.apellidos,t.nombreCompleto,t.nroDocumento,t.celular,t.email].filter(Boolean).join(" ")),vo={tipoDocumento:"",nroDocumento:"",nroHistoria:"",nombres:"",apellidos:"",nombreCompleto:"",sexo:"",estadoCivil:"",paisNacimiento:"",ciudadNacimiento:"",fechaIngreso:"",fechaNacimiento:"",edad:"",paisDomicilio:"",ciudadDomicilio:"",barrio:"",lugarResidencia:"",estrato:"",zonaResidencial:"",esExtranjero:!1,permitePublicidad:!1,celular:"",telDomicilio:"",telOficina:"",extension:"",email:"",ocupacion:"",nombreResponsable:"",parentesco:"",celularResponsable:"",telefonoResponsable:"",emailResponsable:"",nombreAcompanante:"",telefonoAcompanante:"",convenioBeneficio:"",comoConocio:"",campania:"",remitidoPor:"",asesorComercial:"",tipoVinculacion:"",nombreEps:"",polizaSalud:"",doctor:"",notas:"",rxImagenes:[],historiaClinica:{antecedentes:"",alergias:"",medicamentos:"",motivoConsulta:"",notas:""},odontograma:[],periodontograma:[],presupuestos:[],evoluciones:[],facturacion:{saldoFavor:0,saldoCredito:0},fotoUrl:"",activo:!0},xp=20;function AU(){var _t,wt,te,re,he,ne,ee;const t=Ih(),[e,n]=P.useState(!0),[r,i]=P.useState([]),[s,o]=P.useState(""),[a,l]=P.useState(null),[d,h]=P.useState(!0),[f,m]=P.useState(!1),[v,C]=P.useState(null),[y,N]=P.useState(null),I=P.useRef(null),[_,T]=P.useState("datos"),[R,O]=P.useState(vo),[$,x]=P.useState(null),[w,A]=P.useState(""),[k,D]=P.useState([]),j=P.useMemo(()=>nT[R.paisNacimiento]||[],[R.paisNacimiento]);P.useEffect(()=>((async()=>{n(!0);try{const G=(await bn($e(Ee,"eps"))).docs.map(fe=>{var Se;return(Se=fe.data())==null?void 0:Se.nombre}).filter(Boolean),ce=Array.from(new Map(G.map(fe=>[String(fe).toLowerCase(),fe])).values()).sort((fe,Se)=>fe.localeCompare(Se,"es"));D(ce),await St(!0)}catch(F){console.error(F),alert("No se pudieron cargar pacientes/EPS.")}finally{n(!1)}})(),()=>{I.current&&(I.current(),I.current=null)}),[]),P.useEffect(()=>{O(S=>({...S,nombreCompleto:`${S.nombres} ${S.apellidos}`.trim()}))},[R.nombres,R.apellidos]),P.useEffect(()=>{O(S=>({...S,nroHistoria:S.nroDocumento}))},[R.nroDocumento]),P.useEffect(()=>{O(S=>({...S,edad:xU(S.fechaNacimiento)}))},[R.fechaNacimiento]),P.useEffect(()=>{const S=new Date,F=S.toLocaleDateString(bu)+" - "+S.toLocaleTimeString(bu,{hour:"2-digit",minute:"2-digit",hour12:!0});O(G=>({...G,fechaIngreso:F}))},[]);const b=(S,F)=>O(G=>({...G,[S]:F})),Q=()=>{O(vo);const S=new Date,F=S.toLocaleDateString(bu)+" - "+S.toLocaleTimeString(bu,{hour:"2-digit",minute:"2-digit",hour12:!0});O(G=>({...G,fechaIngreso:F})),x(null),A(""),C(null)},qe=async S=>{if(!S){x(null),A("");return}try{const F=await SU(S,{maxW:900,maxH:900,quality:.82});x(F);const G=new FileReader;G.onload=ce=>A(ce.target.result),G.readAsDataURL(F)}catch{x(S);const F=new FileReader;F.onload=G=>A(G.target.result),F.readAsDataURL(S)}},St=async(S=!1)=>{n(!0);try{let F;S||!a?F=lt($e(Ee,"pacientes"),An("creado","desc"),Yo(xp)):F=lt($e(Ee,"pacientes"),An("creado","desc"),TM(a),Yo(xp));const G=await bn(F),ce=G.docs.map(fe=>({id:fe.id,...fe.data()}));i(S?ce:fe=>[...fe,...ce]),l(G.docs[G.docs.length-1]||null),h(G.size===xp)}catch(F){console.error(F),alert("No se pudo cargar pacientes.")}finally{n(!1)}},qt=async S=>{if(S.preventDefault(),!R.nroDocumento.trim())return alert("El nmero de documento es obligatorio.");if(!R.nombres.trim())return alert("Los nombres son obligatorios.");if(!R.apellidos.trim())return alert("Los apellidos son obligatorios.");if(!R.sexo.trim())return alert("El sexo es obligatorio.");if(!R.fechaNacimiento.trim())return alert("La fecha de nacimiento es obligatoria.");if(!R.celular.trim())return alert("El celular es obligatorio.");if(!R.email.trim())return alert("El correo electrnico es obligatorio.");if(!R.tipoVinculacion.trim())return alert("El tipo de vinculacin es obligatorio.");if(!R.nombreEps.trim())return alert("El nombre de la EPS es obligatorio.");try{const F=R.nroDocumento.trim();if(!v&&(await eh(Bt(Ee,"pacientes",F))).exists())return alert("Ya existe un paciente con ese nmero de documento.");const G=(R.nombreEps||"").trim(),ce=k.map(K=>K.toLowerCase()).includes(G.toLowerCase());if(G&&!ce&&window.confirm(`La EPS "${G}" no existe. Deseas guardarla para futuras selecciones?`)){const se=G.toLowerCase().replace(/\s+/g,"_");await th(Bt(Ee,"eps",se),{nombre:G,nombreLower:G.toLowerCase(),creado:Ln()},{merge:!0})}let fe=R.fotoUrl||"",Se="";if($)try{const K=Es(),se=($.name||"foto.jpg").replace(/\s+/g,"_");Se=`pacientes/${F}/${Date.now()}_${se}`;const Te=sl(K,Se),ot={contentType:$.type||"image/jpeg",cacheControl:"public, max-age=86400"};await UI(Te,$,ot),fe=await $I(Te)}catch(K){console.error("Foto (warning):",K)}const be=R.creado||null,Fe=v&&be||Ln(),M={...R,fotoUrl:fe,nombre_busqueda:bU({...R,fotoUrl:fe}),nombresLower:_l(R.nombres),apellidosLower:_l(R.apellidos),documentoLower:_l(R.nroDocumento),emailLower:_l(R.email),creado:Fe,createdAt:Fe,actualizado:Ln(),updatedAt:Ln(),activo:R.activo??!0,celularPaciente:R.celular,telefonoPaciente:R.telDomicilio||"",documento:R.nroDocumento,paciente:R.nombreCompleto};if(await th(Bt(Ee,"pacientes",F),M,{merge:!0}),Se)try{const K=Es(),se=sl(K,`pacientes/${F}`),Te=await BI(se),ot=Se,Lt=Te.items.filter(On=>On.fullPath!==ot).map(On=>gp(On).catch(()=>null));await Promise.allSettled(Lt)}catch(K){console.warn("No se pudo limpiar fotos antiguas:",K)}alert(v?" Paciente actualizado.":" Paciente guardado."),i(K=>{const se=K.filter(Te=>Te.id!==F);return[{id:F,...M},...se]}),m(!1),C(null),Q()}catch(F){console.error("Error guardando paciente:",F),alert(`No se pudo guardar el paciente.

`+((F==null?void 0:F.message)||F))}},X=()=>{Q(),m(!0)},de=()=>{y&&(O({...vo,...y,fotoUrl:y.fotoUrl||""}),x(null),A(y.fotoUrl||""),C(y.id),z(),m(!0))},me=async S=>{if(window.confirm(`Eliminar al paciente "${S.nombreCompleto}"?`))try{await QA(Bt(Ee,"pacientes",S.id)),i(F=>F.filter(G=>G.id!==S.id));try{const F=Es(),G=sl(F,`pacientes/${S.id}`),fe=(await BI(G)).items.map(Se=>gp(Se).catch(()=>null));await Promise.allSettled(fe)}catch(F){console.warn("No se pudo borrar la carpeta de fotos:",F)}}catch(F){console.error(F),alert("No se pudo eliminar.")}},Ne=P.useMemo(()=>{const S=s.trim().toLowerCase();return S?r.filter(F=>`${F.nombreCompleto||F.paciente||""} ${F.nroDocumento||""} ${F.celular||F.celularPaciente||""} ${F.email||""}`.toLowerCase().includes(S)):r},[r,s]),Ue=S=>{z();const F=Bt(Ee,"pacientes",S.id),G=rr(F,ce=>{ce.exists()?N({id:ce.id,...Z(ce.data())}):N(null)});I.current=G,T("datos")},z=()=>{I.current&&(I.current(),I.current=null),N(null)},Z=S=>({...vo,...S,historiaClinica:{...vo.historiaClinica,...S.historiaClinica||{}},facturacion:{...vo.facturacion,...S.facturacion||{}},rxImagenes:Array.isArray(S.rxImagenes)?S.rxImagenes:[],odontograma:Array.isArray(S.odontograma)?S.odontograma:[],periodontograma:Array.isArray(S.periodontograma)?S.periodontograma:[],presupuestos:Array.isArray(S.presupuestos)?S.presupuestos:[],evoluciones:Array.isArray(S.evoluciones)?S.evoluciones:[]}),oe=async S=>{if(y!=null&&y.id)try{await Xo(Bt(Ee,"pacientes",y.id),{...S,actualizado:Ln(),updatedAt:Ln()})}catch(F){console.error(F),alert("No se pudo actualizar.")}},ye=async S=>{if(!(y!=null&&y.id)||!(S!=null&&S.length))return;const F=Es(),G=[];for(const ce of S){const fe=(ce.name||"archivo").replace(/\s+/g,"_"),Se=`pacientes/${y.id}/rx/${Date.now()}_${fe}`,be=sl(F,Se);await UI(be,ce,{contentType:ce.type});const Fe=await $I(be);G.push({url:Fe,name:ce.name,type:ce.type,size:ce.size||0,created:Date.now(),path:Se})}await oe({rxImagenes:[...y.rxImagenes||[],...G]})},xe=async S=>{if(!(y!=null&&y.id))return;const F=y.rxImagenes[S],G=y.rxImagenes.filter((ce,fe)=>fe!==S);await oe({rxImagenes:G});try{if(F!=null&&F.path){const ce=Es();await gp(sl(ce,F.path))}}catch(ce){console.warn("No se pudo borrar del Storage:",ce)}},Re=(S,F)=>{const G={...y.historiaClinica||{},[S]:F};oe({historiaClinica:G})},ve=S=>{const F=[...y.presupuestos||[],{id:String(Date.now()),...S}];oe({presupuestos:F})},Ge=S=>{oe({presupuestos:(y.presupuestos||[]).filter(F=>F.id!==S)})},we=S=>{const F=[...y.evoluciones||[],{id:String(Date.now()),fechaISO:new Date().toISOString(),nota:S}];oe({evoluciones:F})},ie=S=>{oe({evoluciones:(y.evoluciones||[]).filter(F=>F.id!==S)})},Pe=(S,F)=>{const G=Array.isArray(y[S])?y[S]:[],ce=G.find(Se=>Se.pieza===F);let fe;ce?fe=G.filter(Se=>Se.pieza!==F):fe=[...G,{pieza:F,estado:"marcada"}],oe({[S]:fe})};return u.jsxs("div",{className:"odc-container",children:[u.jsx("div",{className:"odc-topbar-green"}),u.jsx("div",{className:"odc-topbar-blue",children:u.jsx("div",{className:"odc-top-inner",children:u.jsx("div",{className:"odc-breadcrumbs",children:"Pacientes"})})}),u.jsxs("div",{className:"odc-card",children:[u.jsxs("div",{className:"odc-card-header",children:[u.jsx("h3",{className:"odc-title",children:"Pacientes"}),u.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[u.jsx("input",{className:"search-input",style:{minWidth:280},placeholder:"Buscar por nombre, documento o telfono",value:s,onChange:S=>o(S.target.value)}),u.jsx("button",{className:"btn green",onClick:X,children:"+ Nuevo paciente"})]})]}),u.jsx("div",{className:"table-wrap",children:u.jsxs("table",{className:"appointments-table",children:[u.jsx("thead",{children:u.jsxs("tr",{children:[u.jsx("th",{children:"Foto"}),u.jsx("th",{children:"Nombre"}),u.jsx("th",{children:"Documento"}),u.jsx("th",{children:"Celular"}),u.jsx("th",{children:"Correo"}),u.jsx("th",{children:"Estado"})]})}),u.jsx("tbody",{children:e&&r.length===0?u.jsx("tr",{children:u.jsx("td",{className:"no-data",colSpan:6,children:"Cargando"})}):Ne.length===0?u.jsx("tr",{children:u.jsx("td",{className:"no-data",colSpan:6,children:"No hay pacientes o no coinciden con la bsqueda."})}):Ne.map(S=>u.jsxs("tr",{className:"row-click",onClick:()=>Ue(S),children:[u.jsx("td",{onClick:F=>F.stopPropagation(),children:S.fotoUrl?u.jsx("img",{src:S.fotoUrl,alt:"Foto",style:{width:36,height:36,borderRadius:"50%",objectFit:"cover"}}):u.jsx("div",{className:"avatar-fallback",children:(S.nombreCompleto||"P")[0]})}),u.jsx("td",{children:S.nombreCompleto||S.paciente||""}),u.jsx("td",{children:S.nroDocumento||S.documento||""}),u.jsx("td",{children:S.celular||S.celularPaciente||""}),u.jsx("td",{children:S.email||""}),u.jsx("td",{children:u.jsx("span",{className:"pill pill-ok",children:S.activo?"Activo":"Inactivo"})})]},S.id))})]})}),u.jsxs("div",{className:"footer-actions",children:[u.jsx("button",{className:"btn",disabled:e||!d,onClick:()=>St(!1),children:d?"Cargar ms":"No hay ms"}),u.jsxs("div",{className:"hint",children:[r.length," registros cargados"]})]})]}),f&&u.jsxs("div",{className:"odc-modal",role:"dialog","aria-modal":"true",children:[u.jsx("div",{className:"odc-modal-backdrop",onClick:()=>m(!1)}),u.jsxs("div",{className:"odc-card",style:{width:1e3,maxWidth:"95%",maxHeight:"92vh",overflowY:"auto"},children:[u.jsxs("div",{className:"odc-card-header",children:[u.jsx("h3",{className:"odc-title",children:v?"Editar paciente":"Nuevo paciente"}),u.jsx("button",{className:"btn",onClick:()=>m(!1),children:""})]}),u.jsxs("form",{onSubmit:qt,children:[u.jsx("div",{className:"form-section-title",children:"Foto del paciente"}),u.jsxs("div",{className:"foto-row",children:[u.jsxs("label",{className:"foto-drop",children:[u.jsx("input",{type:"file",accept:"image/*",onChange:S=>{var F;return qe(((F=S.target.files)==null?void 0:F[0])||null)},style:{display:"none"}}),w?u.jsx("img",{src:w,alt:"Preview",className:"foto-preview"}):u.jsx("div",{className:"foto-empty",children:"Arrastra o haz clic para cargar"})]}),w&&u.jsx("button",{type:"button",className:"btn",onClick:()=>qe(null),children:"Quitar foto"})]}),u.jsx("div",{className:"form-section-title",children:"Datos de identificacin"}),u.jsxs("div",{className:"form-grid",children:[u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Tipo de documento *"}),u.jsxs("select",{className:"form-input",value:R.tipoDocumento,onChange:S=>b("tipoDocumento",S.target.value),children:[u.jsx("option",{value:"",children:"Seleccione"}),u.jsx("option",{value:"CC",children:"Cdula"}),u.jsx("option",{value:"TI",children:"Tarjeta de identidad"}),u.jsx("option",{value:"PA",children:"Pasaporte"}),u.jsx("option",{value:"OTRO",children:"Otro"})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Nro. de documento *"}),u.jsx("input",{className:"form-input",value:R.nroDocumento,onChange:S=>b("nroDocumento",S.target.value),placeholder:"Nmero de documento",required:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Nmero de Historia"}),u.jsx("input",{className:"form-input",value:R.nroHistoria,readOnly:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Nombres *"}),u.jsx("input",{className:"form-input",value:R.nombres,onChange:S=>b("nombres",S.target.value),required:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Apellidos *"}),u.jsx("input",{className:"form-input",value:R.apellidos,onChange:S=>b("apellidos",S.target.value),required:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Nombre completo"}),u.jsx("input",{className:"form-input",value:R.nombreCompleto,readOnly:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Sexo *"}),u.jsxs("select",{className:"form-input",value:R.sexo,onChange:S=>b("sexo",S.target.value),required:!0,children:[u.jsx("option",{value:"",children:"Seleccione"}),u.jsx("option",{children:"Masculino"}),u.jsx("option",{children:"Femenino"}),u.jsx("option",{children:"Otro"})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Estado civil *"}),u.jsxs("select",{className:"form-input",value:R.estadoCivil,onChange:S=>b("estadoCivil",S.target.value),required:!0,children:[u.jsx("option",{value:"",children:"Seleccione"}),u.jsx("option",{children:"Soltero"}),u.jsx("option",{children:"Casado"}),u.jsx("option",{children:"Unin libre"}),u.jsx("option",{children:"Divorciado"}),u.jsx("option",{children:"Viudo"})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Pas de nacimiento *"}),u.jsx("input",{className:"form-input",list:"listCountries",value:R.paisNacimiento,onChange:S=>b("paisNacimiento",S.target.value),placeholder:"Escribe y elige",required:!0}),u.jsx("datalist",{id:"listCountries",children:TU.map(S=>u.jsx("option",{value:S},S))})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Ciudad de nacimiento"}),u.jsx("input",{className:"form-input",list:"listCitiesBirth",value:R.ciudadNacimiento,onChange:S=>b("ciudadNacimiento",S.target.value),placeholder:"Escribe y elige"}),u.jsx("datalist",{id:"listCitiesBirth",children:j.map(S=>u.jsx("option",{value:S},S))})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Fecha de ingreso"}),u.jsx("input",{className:"form-input",value:R.fechaIngreso,readOnly:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Fecha de nacimiento *"}),u.jsx("input",{type:"date",className:"form-input",value:R.fechaNacimiento,onChange:S=>b("fechaNacimiento",S.target.value),required:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Edad"}),u.jsx("input",{className:"form-input",value:R.edad,readOnly:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Pas de domicilio *"}),u.jsx("input",{className:"form-input",list:"listCountries",value:R.paisDomicilio,onChange:S=>b("paisDomicilio",S.target.value),required:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Ciudad de domicilio *"}),u.jsx("input",{className:"form-input",list:"listCitiesHome",value:R.ciudadDomicilio,onChange:S=>b("ciudadDomicilio",S.target.value),required:!0}),u.jsx("datalist",{id:"listCitiesHome",children:(nT[R.paisDomicilio]||[]).map(S=>u.jsx("option",{value:S},S))})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Barrio *"}),u.jsx("input",{className:"form-input",value:R.barrio,onChange:S=>b("barrio",S.target.value),required:!0,placeholder:"Barrio"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Lugar de residencia *"}),u.jsx("input",{className:"form-input",value:R.lugarResidencia,onChange:S=>b("lugarResidencia",S.target.value),required:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Estrato"}),u.jsxs("select",{className:"form-input",value:R.estrato,onChange:S=>b("estrato",S.target.value),children:[u.jsx("option",{value:"",children:"Seleccione"}),u.jsx("option",{children:"1"}),u.jsx("option",{children:"2"}),u.jsx("option",{children:"3"}),u.jsx("option",{children:"4"}),u.jsx("option",{children:"5"}),u.jsx("option",{children:"6"})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Zona residencial *"}),u.jsxs("select",{className:"form-input",value:R.zonaResidencial,onChange:S=>b("zonaResidencial",S.target.value),required:!0,children:[u.jsx("option",{value:"",children:"Seleccione"}),u.jsx("option",{children:"Urbana"}),u.jsx("option",{children:"Rural"})]})]}),u.jsxs("div",{className:"checkbox-cell",children:[u.jsx("label",{className:"form-label",children:"Es extranjero?"}),u.jsx("input",{type:"checkbox",checked:R.esExtranjero,onChange:S=>b("esExtranjero",S.target.checked)})]}),u.jsxs("div",{className:"checkbox-cell",children:[u.jsx("label",{className:"form-label",children:"Permite publicidad?"}),u.jsx("input",{type:"checkbox",checked:R.permitePublicidad,onChange:S=>b("permitePublicidad",S.target.checked)})]})]}),u.jsx("div",{className:"form-section-title",children:"Contacto"}),u.jsxs("div",{className:"form-grid",children:[u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Celular *"}),u.jsx("input",{className:"form-input",value:R.celular,onChange:S=>b("celular",S.target.value),required:!0,placeholder:"Celular del paciente"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Telfono de domicilio"}),u.jsx("input",{className:"form-input",value:R.telDomicilio,onChange:S=>b("telDomicilio",S.target.value)})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Telfono de oficina"}),u.jsx("input",{className:"form-input",value:R.telOficina,onChange:S=>b("telOficina",S.target.value)})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Extensin"}),u.jsx("input",{className:"form-input",value:R.extension,onChange:S=>b("extension",S.target.value)})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Correo electrnico *"}),u.jsx("input",{type:"email",className:"form-input",value:R.email,onChange:S=>b("email",S.target.value),required:!0,placeholder:"correo@dominio.com"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Ocupacin *"}),u.jsx("input",{className:"form-input",value:R.ocupacion,onChange:S=>b("ocupacion",S.target.value),required:!0})]})]}),u.jsx("div",{className:"form-section-title",children:"Datos de facturacin"}),u.jsxs("div",{className:"form-grid",children:[u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Responsable"}),u.jsx("input",{className:"form-input",value:R.nombreResponsable,onChange:S=>b("nombreResponsable",S.target.value)})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Parentesco"}),u.jsxs("select",{className:"form-input",value:R.parentesco,onChange:S=>b("parentesco",S.target.value),children:[u.jsx("option",{value:"",children:"Seleccione"}),u.jsx("option",{children:"Padre/Madre"}),u.jsx("option",{children:"Hermano"}),u.jsx("option",{children:"Esposo/a"}),u.jsx("option",{children:"Otro"})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Celular"}),u.jsx("input",{className:"form-input",value:R.celularResponsable,onChange:S=>b("celularResponsable",S.target.value)})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Telfono"}),u.jsx("input",{className:"form-input",value:R.telefonoResponsable,onChange:S=>b("telefonoResponsable",S.target.value)})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Correo electrnico"}),u.jsx("input",{type:"email",className:"form-input",value:R.emailResponsable,onChange:S=>b("emailResponsable",S.target.value)})]})]}),u.jsx("div",{className:"form-section-title",children:"Acompaante"}),u.jsxs("div",{className:"form-grid",children:[u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Nombre"}),u.jsx("input",{className:"form-input",value:R.nombreAcompanante,onChange:S=>b("nombreAcompanante",S.target.value),placeholder:"Nombre acompaante"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Telfono"}),u.jsx("input",{className:"form-input",value:R.telefonoAcompanante,onChange:S=>b("telefonoAcompanante",S.target.value),placeholder:"Telfono acompaante"})]})]}),u.jsx("div",{className:"form-section-title",children:"Mercadeo"}),u.jsxs("div",{className:"form-grid",children:[u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Convenio beneficio"}),u.jsx("input",{className:"form-input",value:R.convenioBeneficio,onChange:S=>b("convenioBeneficio",S.target.value)})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Cmo nos conoci?"}),u.jsxs("select",{className:"form-input",value:R.comoConocio,onChange:S=>b("comoConocio",S.target.value),children:[u.jsx("option",{value:"",children:"Seleccione"}),u.jsx("option",{children:"Redes sociales"}),u.jsx("option",{children:"Publicidad"}),u.jsx("option",{children:"Recomendacin"}),u.jsx("option",{children:"Otro"})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Campaa"}),u.jsx("input",{className:"form-input",value:R.campania,onChange:S=>b("campania",S.target.value)})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Remitido por"}),u.jsx("input",{className:"form-input",value:R.remitidoPor,onChange:S=>b("remitidoPor",S.target.value)})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Asesor comercial"}),u.jsx("input",{className:"form-input",value:R.asesorComercial,onChange:S=>b("asesorComercial",S.target.value)})]})]}),u.jsx("div",{className:"form-section-title",children:"EPS"}),u.jsxs("div",{className:"form-grid",children:[u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Tipo de vinculacin *"}),u.jsxs("select",{className:"form-input",value:R.tipoVinculacion,onChange:S=>b("tipoVinculacion",S.target.value),required:!0,children:[u.jsx("option",{value:"",children:"Seleccione"}),u.jsx("option",{children:"Contributivo"}),u.jsx("option",{children:"Subsidiado"}),u.jsx("option",{children:"Particular"}),u.jsx("option",{children:"Otro"})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Nombre de la EPS *"}),u.jsx("input",{className:"form-input",list:"listEps",value:R.nombreEps,onChange:S=>b("nombreEps",S.target.value),placeholder:"Escribe y selecciona",required:!0}),u.jsx("datalist",{id:"listEps",children:k.map(S=>u.jsx("option",{value:S},S))})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Pliza de salud"}),u.jsx("input",{className:"form-input",value:R.polizaSalud,onChange:S=>b("polizaSalud",S.target.value)})]})]}),u.jsx("div",{className:"form-section-title",children:"Doctor"}),u.jsx("div",{className:"form-grid",children:u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Doctor"}),u.jsx("input",{className:"form-input",value:R.doctor,onChange:S=>b("doctor",S.target.value),placeholder:"Usuario / Libre"})]})}),u.jsx("div",{className:"form-section-title",children:"Alertas y Notas"}),u.jsx("div",{className:"form-grid",children:u.jsx("textarea",{className:"form-input",rows:3,value:R.notas,onChange:S=>b("notas",S.target.value),placeholder:"Notas del paciente"})}),u.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:8,marginTop:12},children:[v?u.jsx("button",{type:"button",className:"btn",onClick:()=>me({id:v,nombreCompleto:R.nombreCompleto}),children:"Eliminar"}):u.jsx("div",{}),u.jsxs("div",{style:{display:"flex",gap:8},children:[u.jsx("button",{type:"button",className:"btn",onClick:()=>m(!1),children:"Cancelar"}),u.jsx("button",{type:"submit",className:"btn blue",children:v?"Actualizar":"Guardar paciente"})]})]})]})]})]}),y&&u.jsxs("div",{className:"odc-modal",role:"dialog","aria-modal":"true",children:[u.jsx("div",{className:"odc-modal-backdrop",onClick:z}),u.jsxs("div",{className:"odc-card ficha-card",children:[u.jsxs("div",{className:"ficha-header",children:[u.jsxs("div",{className:"ficha-header-left",children:[y.fotoUrl?u.jsx("img",{src:y.fotoUrl,alt:"Foto",className:"ficha-avatar"}):u.jsx("div",{className:"avatar-fallback ficha-avatar-fallback",children:(y.nombreCompleto||"P")[0]}),u.jsxs("div",{children:[u.jsx("div",{className:"ficha-nombre",children:y.nombreCompleto||""}),u.jsxs("div",{className:"ficha-doc",children:[y.tipoDocumento||""," ",y.nroDocumento||""]}),u.jsxs("div",{className:"ficha-badges",children:[u.jsx("span",{className:"ficha-badge blue",children:"En valoracin"}),u.jsx("span",{className:"ficha-badge green",children:"Sin deuda"})]})]})]}),u.jsx("div",{className:"ficha-header-right",children:u.jsxs("div",{className:"ficha-actions",children:[u.jsx("button",{className:"btn",onClick:z,children:"Cerrar"}),u.jsx("button",{className:"btn blue",onClick:de,children:"Editar"}),u.jsx("button",{className:"btn green",onClick:()=>t(`/caja?cobro=1&patientId=${y.id}`),title:"Ir a Caja para cobrar a este paciente",children:"Cobrar"})]})})]}),u.jsxs("div",{className:"ficha-body",children:[u.jsxs("aside",{className:"ficha-sidebar",children:[u.jsx("div",{className:"ficha-sidebar-title",children:"Informacin general"}),u.jsx("button",{className:`ficha-link ${_==="datos"?"active":""}`,onClick:()=>T("datos"),children:"Datos personales"}),u.jsx("button",{className:`ficha-link ${_==="marketing"?"active":""}`,onClick:()=>T("marketing"),children:"Marketing"}),u.jsx("button",{className:`ficha-link ${_==="eps"?"active":""}`,onClick:()=>T("eps"),children:"EPS"}),u.jsx("button",{className:`ficha-link ${_==="prof"?"active":""}`,onClick:()=>T("prof"),children:"Profesionales"}),u.jsx("button",{className:`ficha-link ${_==="rx"?"active":""}`,onClick:()=>T("rx"),children:"Rx/Imgenes/Doc"}),u.jsx("button",{className:`ficha-link ${_==="citas"?"active":""}`,onClick:()=>T("citas"),children:"Citas"}),u.jsx("button",{className:`ficha-link ${_==="crm"?"active":""}`,onClick:()=>T("crm"),children:"CRM"}),u.jsx("div",{className:"ficha-sidebar-title mt",children:"Historia clnica"}),u.jsx("button",{className:`ficha-link ${_==="doc"?"active":""}`,onClick:()=>T("doc"),children:"Doc. Clnicos"}),u.jsx("button",{className:`ficha-link ${_==="odonto"?"active":""}`,onClick:()=>T("odonto"),children:"Odontogramas"}),u.jsx("button",{className:`ficha-link ${_==="perio"?"active":""}`,onClick:()=>T("perio"),children:"Periodontogramas"}),u.jsx("button",{className:`ficha-link ${_==="presu"?"active":""}`,onClick:()=>T("presu"),children:"Presupuestos"}),u.jsx("button",{className:`ficha-link ${_==="evo"?"active":""}`,onClick:()=>T("evo"),children:"Evoluciones"}),u.jsx("div",{className:"ficha-sidebar-title mt",children:"Facturacin"}),u.jsx("button",{className:`ficha-link ${_==="fact"?"active":""}`,onClick:()=>T("fact"),children:"Resumen"})]}),u.jsxs("main",{className:"ficha-content",children:[_==="datos"&&u.jsxs("section",{className:"ficha-section",children:[u.jsx("h4",{className:"ficha-section-title",children:"Datos personales"}),u.jsx("div",{className:"ficha-grid",children:[["Tipo de documento",y.tipoDocumento],["Nro. de documento",y.nroDocumento],["Nmero de Historia",y.nroHistoria],["Fecha de ingreso",y.fechaIngreso],["Nombres",y.nombres],["Apellidos",y.apellidos],["Nombre completo",y.nombreCompleto],["Sexo",y.sexo],["Estado civil",y.estadoCivil],["Pas de nacimiento",y.paisNacimiento],["Ciudad de nacimiento",y.ciudadNacimiento],["Fecha de nacimiento",y.fechaNacimiento],["Edad",y.edad],["Pas de domicilio",y.paisDomicilio],["Ciudad de domicilio",y.ciudadDomicilio],["Barrio",y.barrio],["Lugar de residencia",y.lugarResidencia],["Estrato",y.estrato],["Zona residencial",y.zonaResidencial],["Extranjero",y.esExtranjero?"S":"No"],["Permite publicidad",y.permitePublicidad?"S":"No"],["Celular",y.celular||y.celularPaciente],["Telfono domicilio",y.telDomicilio||y.telefonoPaciente],["Telfono oficina",y.telOficina],["Extensin",y.extension],["Correo electrnico",y.email],["Ocupacin",y.ocupacion],["Responsable",y.nombreResponsable],["Parentesco",y.parentesco],["Cel. responsable",y.celularResponsable],["Tel. responsable",y.telefonoResponsable],["Email responsable",y.emailResponsable],["Acompaante",y.nombreAcompanante],["Tel. acompaante",y.telefonoAcompanante]].map(([S,F])=>u.jsxs("div",{className:"field",children:[u.jsx("label",{children:S}),u.jsx("input",{className:"form-input",value:F||"",readOnly:!0})]},S))})]}),_==="marketing"&&u.jsxs("section",{className:"ficha-section",children:[u.jsx("h4",{className:"ficha-section-title",children:"Marketing"}),u.jsx("div",{className:"ficha-grid",children:[["Convenio beneficio",y.convenioBeneficio],["Cmo nos conoci?",y.comoConocio],["Campaa",y.campania],["Remitido por",y.remitidoPor],["Asesor comercial",y.asesorComercial]].map(([S,F])=>u.jsxs("div",{className:"field",children:[u.jsx("label",{children:S}),u.jsx("input",{className:"form-input",value:F||"",readOnly:!0})]},S))})]}),_==="eps"&&u.jsxs("section",{className:"ficha-section",children:[u.jsx("h4",{className:"ficha-section-title",children:"EPS"}),u.jsx("div",{className:"ficha-grid",children:[["Tipo de vinculacin",y.tipoVinculacion],["Nombre EPS",y.nombreEps],["Pliza de salud",y.polizaSalud]].map(([S,F])=>u.jsxs("div",{className:"field",children:[u.jsx("label",{children:S}),u.jsx("input",{className:"form-input",value:F||"",readOnly:!0})]},S))})]}),_==="prof"&&u.jsxs("section",{className:"ficha-section",children:[u.jsx("h4",{className:"ficha-section-title",children:"Profesionales"}),u.jsx("div",{className:"ficha-grid",children:u.jsxs("div",{className:"field",children:[u.jsx("label",{children:"Doctor"}),u.jsx("input",{className:"form-input",value:y.doctor||"",readOnly:!0})]})})]}),_==="rx"&&u.jsxs("section",{className:"ficha-section",children:[u.jsx("h4",{className:"ficha-section-title",children:"Rx / Imgenes / Documentos"}),u.jsx("div",{className:"rx-actions",children:u.jsxs("label",{className:"btn blue",children:["Subir archivos",u.jsx("input",{type:"file",multiple:!0,style:{display:"none"},onChange:S=>ye([...S.target.files])})]})}),u.jsxs("div",{className:"rx-grid",children:[(y.rxImagenes||[]).map((S,F)=>{var G;return u.jsxs("div",{className:"rx-item",children:[(G=S.type)!=null&&G.startsWith("image/")?u.jsx("a",{href:S.url,target:"_blank",rel:"noreferrer",children:u.jsx("img",{src:S.url,alt:S.name})}):u.jsx("a",{className:"rx-file",href:S.url,target:"_blank",rel:"noreferrer",children:S.name||"archivo"}),u.jsxs("div",{className:"rx-meta",children:[u.jsx("span",{children:S.name}),u.jsx("button",{className:"btn small",onClick:()=>xe(F),children:"Eliminar"})]})]},F)}),(!y.rxImagenes||y.rxImagenes.length===0)&&u.jsx("div",{className:"no-data",children:"Sin archivos an."})]})]}),_==="doc"&&u.jsxs("section",{className:"ficha-section",children:[u.jsx("h4",{className:"ficha-section-title",children:"Doc. Clnicos"}),u.jsxs("div",{className:"ficha-grid",children:[u.jsxs("div",{className:"field",children:[u.jsx("label",{children:"Motivo de consulta"}),u.jsx("textarea",{className:"form-input",rows:3,value:((_t=y.historiaClinica)==null?void 0:_t.motivoConsulta)||"",onChange:S=>Re("motivoConsulta",S.target.value)})]}),u.jsxs("div",{className:"field",children:[u.jsx("label",{children:"Antecedentes"}),u.jsx("textarea",{className:"form-input",rows:3,value:((wt=y.historiaClinica)==null?void 0:wt.antecedentes)||"",onChange:S=>Re("antecedentes",S.target.value)})]}),u.jsxs("div",{className:"field",children:[u.jsx("label",{children:"Alergias"}),u.jsx("textarea",{className:"form-input",rows:2,value:((te=y.historiaClinica)==null?void 0:te.alergias)||"",onChange:S=>Re("alergias",S.target.value)})]}),u.jsxs("div",{className:"field",children:[u.jsx("label",{children:"Medicamentos"}),u.jsx("textarea",{className:"form-input",rows:2,value:((re=y.historiaClinica)==null?void 0:re.medicamentos)||"",onChange:S=>Re("medicamentos",S.target.value)})]}),u.jsxs("div",{className:"field",children:[u.jsx("label",{children:"Notas"}),u.jsx("textarea",{className:"form-input",rows:3,value:((he=y.historiaClinica)==null?void 0:he.notas)||"",onChange:S=>Re("notas",S.target.value)})]})]})]}),_==="odonto"&&u.jsxs("section",{className:"ficha-section",children:[u.jsx("h4",{className:"ficha-section-title",children:"Odontograma (placeholder)"}),u.jsx("div",{className:"odont-grid",children:Array.from({length:32},(S,F)=>F+1).map(S=>{const F=(y.odontograma||[]).some(G=>G.pieza===S);return u.jsx("button",{className:`tooth ${F?"on":""}`,onClick:()=>Pe("odontograma",S),title:`Pieza ${S}`,children:S},S)})})]}),_==="perio"&&u.jsxs("section",{className:"ficha-section",children:[u.jsx("h4",{className:"ficha-section-title",children:"Periodontograma (placeholder)"}),u.jsx("div",{className:"odont-grid",children:Array.from({length:32},(S,F)=>F+1).map(S=>{const F=(y.periodontograma||[]).some(G=>G.pieza===S);return u.jsx("button",{className:`tooth ${F?"on":""}`,onClick:()=>Pe("periodontograma",S),title:`Pieza ${S}`,children:S},S)})})]}),_==="presu"&&u.jsxs("section",{className:"ficha-section",children:[u.jsx("h4",{className:"ficha-section-title",children:"Presupuestos & planes"}),u.jsx(CU,{onAdd:ve}),u.jsxs("div",{className:"presu-list",children:[(y.presupuestos||[]).map(S=>u.jsxs("div",{className:"presu-item",children:[u.jsxs("div",{children:[u.jsx("div",{className:"presu-title",children:S.titulo}),u.jsxs("div",{className:"presu-meta",children:["Costo: $",S.costo||0,"  Estado: ",S.estado||"Pendiente"]})]}),u.jsx("button",{className:"btn small",onClick:()=>Ge(S.id),children:"Eliminar"})]},S.id)),(!y.presupuestos||y.presupuestos.length===0)&&u.jsx("div",{className:"no-data",children:"Sin presupuestos an."})]})]}),_==="evo"&&u.jsxs("section",{className:"ficha-section",children:[u.jsx("h4",{className:"ficha-section-title",children:"Evoluciones & Remisiones"}),u.jsx(RU,{onAdd:we}),u.jsxs("div",{className:"evo-list",children:[(y.evoluciones||[]).map(S=>u.jsxs("div",{className:"evo-item",children:[u.jsx("div",{className:"evo-date",children:new Date(S.fechaISO).toLocaleString()}),u.jsx("div",{className:"evo-note",children:S.nota}),u.jsx("button",{className:"btn small",onClick:()=>ie(S.id),children:"Eliminar"})]},S.id)),(!y.evoluciones||y.evoluciones.length===0)&&u.jsx("div",{className:"no-data",children:"Sin evoluciones an."})]})]}),_==="fact"&&u.jsxs("section",{className:"ficha-section",children:[u.jsx("h4",{className:"ficha-section-title",children:"Facturacin"}),u.jsxs("div",{className:"ficha-grid",children:[u.jsxs("div",{className:"field",children:[u.jsx("label",{children:"Saldo a favor"}),u.jsx("input",{type:"number",className:"form-input",value:((ne=y.facturacion)==null?void 0:ne.saldoFavor)??0,onChange:S=>oe({facturacion:{...y.facturacion||{},saldoFavor:Number(S.target.value||0)}})})]}),u.jsxs("div",{className:"field",children:[u.jsx("label",{children:"Saldo crdito"}),u.jsx("input",{type:"number",className:"form-input",value:((ee=y.facturacion)==null?void 0:ee.saldoCredito)??0,onChange:S=>oe({facturacion:{...y.facturacion||{},saldoCredito:Number(S.target.value||0)}})})]})]}),u.jsxs("div",{className:"tools-right",style:{marginTop:8,display:"flex",gap:8,flexWrap:"wrap"},children:[u.jsx("button",{className:"btn blue",onClick:()=>t(`/caja?cobro=1&patientId=${y.id}`),children:"Realizar pago"}),u.jsx("button",{className:"btn",onClick:()=>t("/facturacion/pagos"),children:"Histrico de pagos"}),u.jsx("button",{className:"btn",onClick:()=>t("/facturacion/facturas"),children:"Histrico de facturacin"})]})]}),_==="citas"&&u.jsxs("section",{className:"ficha-section",children:[u.jsx("h4",{className:"ficha-section-title",children:"Citas"}),u.jsx("div",{className:"no-data",children:"Integra aqu la tabla de citas del paciente."})]}),_==="crm"&&u.jsxs("section",{className:"ficha-section",children:[u.jsx("h4",{className:"ficha-section-title",children:"CRM"}),u.jsx("div",{className:"no-data",children:"Notas / recordatorios comerciales del paciente."})]}),u.jsx("div",{className:"ficha-footer"})]})]})]})]})]})}function CU({onAdd:t}){const[e,n]=P.useState(""),[r,i]=P.useState(""),[s,o]=P.useState("Pendiente");return u.jsxs("div",{className:"presu-form",children:[u.jsx("input",{className:"form-input",placeholder:"Procedimiento / plan",value:e,onChange:a=>n(a.target.value)}),u.jsx("input",{type:"number",className:"form-input",placeholder:"Costo",value:r,onChange:a=>i(a.target.value)}),u.jsxs("select",{className:"form-input",value:s,onChange:a=>o(a.target.value),children:[u.jsx("option",{children:"Pendiente"}),u.jsx("option",{children:"Aprobado"}),u.jsx("option",{children:"Rechazado"})]}),u.jsx("button",{className:"btn blue",onClick:()=>{if(!e)return alert("Ttulo requerido");t({titulo:e,costo:Number(r||0),estado:s}),n(""),i(""),o("Pendiente")},children:"Agregar"})]})}function RU({onAdd:t}){const[e,n]=P.useState("");return u.jsxs("div",{className:"evo-form",children:[u.jsx("textarea",{className:"form-input",rows:2,placeholder:"Escribe la evolucin / remisin",value:e,onChange:r=>n(r.target.value)}),u.jsx("button",{className:"btn blue",onClick:()=>{e.trim()&&(t(e.trim()),n(""))},children:"Guardar evolucin"})]})}function PU(){return u.jsxs("div",{style:{padding:"20px"},children:[u.jsx("h2",{children:"Mdulo de Facturacin"}),u.jsx("p",{children:"Aqu se registrarn los pagos, facturas y cobros."})]})}const vr=t=>(Number(t)||0).toLocaleString("es-CO",{maximumFractionDigits:0}),wo=()=>new Date().toISOString().slice(0,10),kU=(t=new Date)=>new Date(t.getFullYear(),t.getMonth(),t.getDate(),0,0,0,0),NU=(t=new Date)=>new Date(t.getFullYear(),t.getMonth(),t.getDate()+1,0,0,0,0),rT=t=>Oe.fromDate(t),DU=()=>{const[t,e]=P.useState(null);return P.useEffect(()=>{const n=gy(ih,r=>e(r||null));return()=>n()},[]),t},Dt=({children:t,align:e})=>u.jsx("th",{className:"oc-th",style:{position:"sticky",top:0,zIndex:1,textAlign:e||"left",background:"var(--oc-surface, #fff)"},children:t}),jU=()=>Math.random().toString(36).slice(2)+Math.random().toString(36).slice(2);function VU(){var Fe;const t=DU(),e=[{key:"abrir",label:"Abrir caja",icon:""},{key:"abiertas",label:"Cajas abiertas",icon:""},{key:"cerradas",label:"Cajas cerradas",icon:""},{key:"mio",label:"Mi caja (hoy)",icon:""},{key:"simulados",label:"Cierres simulados",icon:""},{key:"bancos",label:"Bancos",icon:""}],[n,r]=P.useState("abiertas"),[i,s]=P.useState(""),[o,a]=P.useState(""),l=P.useRef(null),[d,h]=P.useState(!1),[f,m]=P.useState(""),[v,C]=P.useState([]),[y,N]=P.useState(!0),[I,_]=P.useState([]),[T,R]=P.useState(!0),[O,$]=P.useState(null),[x,w]=P.useState(!0),[A,k]=P.useState(""),[D,j]=P.useState([]),[b,Q]=P.useState(null),[qe,St]=P.useState(""),[qt,X]=P.useState("efectivo"),[de,me]=P.useState(!1),[Ne,Ue]=P.useState("ingreso"),[z,Z]=P.useState(""),[oe,ye]=P.useState(""),[xe,Re]=P.useState(!1),[ve,Ge]=P.useState([]),[we,ie]=P.useState([]);P.useEffect(()=>{const M=lt($e(Ee,"cajas"),et("estado","==","abierta"),An("fechaApertura","desc")),K=rr(M,se=>{C(se.docs.map(Te=>Pe(Te.id,Te.data()))),N(!1),s("")},se=>{console.error(se),s((se==null?void 0:se.code)==="failed-precondition"?"Falta ndice (estado, fechaApertura) en Firestore.":(se==null?void 0:se.code)==="permission-denied"?"Permiso denegado en Firestore (revisa reglas).":"No se pudieron leer las cajas."),N(!1)});return()=>K()},[]),P.useEffect(()=>{const M=lt($e(Ee,"cajas"),et("estado","==","cerrada"),An("fechaCierre","desc")),K=rr(M,se=>{_(se.docs.map(Te=>Pe(Te.id,Te.data()))),R(!1)},se=>{console.error(se),R(!1)});return()=>K()},[]),P.useEffect(()=>{if(!t){$(null),w(!1);return}w(!0);const M=lt($e(Ee,"cajas"),et("estado","==","abierta"),et("usuarioId","==",t.uid),et("fechaApertura",">=",rT(kU())),et("fechaApertura","<",rT(NU()))),K=rr(M,se=>{const Te=se.docs[0];$(Te?Pe(Te.id,Te.data()):null),w(!1)},se=>{console.error(se),w(!1),(se==null?void 0:se.code)==="failed-precondition"&&s("Falta ndice (estado, usuarioId, fechaApertura) en Firestore.")});return()=>K()},[t]),P.useEffect(()=>{if(!(O!=null&&O.id)){Ge([]),ie([]);return}const M=lt($e(Ee,"movimientos"),et("cashId","==",O.id),et("dia","==",wo()),An("fecha","desc")),K=rr(M,ot=>Ge(ot.docs.map(Lt=>({id:Lt.id,...Lt.data()}))),ot=>console.error(ot)),se=lt($e(Ee,"payments"),et("cashId","==",O.id),et("dia","==",wo()),An("fecha","desc")),Te=rr(se,ot=>ie(ot.docs.map(Lt=>({id:Lt.id,...Lt.data()}))),ot=>console.error(ot));return()=>{K(),Te()}},[O==null?void 0:O.id]),P.useEffect(()=>{if(!(A!=null&&A.trim())){j([]);return}const M=lt($e(Ee,"patients"),et("q",">=",ne(A)),et("q","<=",ne(A)+""),An("q","asc")),K=rr(M,se=>j(se.docs.map(Te=>({id:Te.id,...Te.data()}))),se=>console.error(se));return()=>K()},[A]);function Pe(M,K={}){const se=kt=>{var Wt;return((Wt=kt==null?void 0:kt.toDate)==null?void 0:Wt.call(kt))||(typeof kt=="string"?new Date(kt):kt||null)},Te=se(K.fechaApertura),ot=se(K.fechaCierre),Lt=Number(K.baseInicial||0),On=Number(K.baseActual!==void 0?K.baseActual:Lt),Ht=Number(K.saldoInicial||0),Xn=Number(K.saldoActual!==void 0?K.saldoActual:Ht),pn=[];return Xn<0&&pn.push("Saldo negativo"),On<0&&pn.push("Base negativa"),{id:M,estado:K.estado||"abierta",usuarioId:K.usuarioId||"",usuarioNombre:K.usuarioNombre||"Usuario",nombre:K.nombre||K.usuarioNombre||"Caja",fechaApertura:Te,fechaCierre:ot,baseInicial:Lt,baseActual:On,saldoInicial:Ht,saldoActual:Xn,ia:pn}}const _t=async M=>{var K;if((K=M==null?void 0:M.preventDefault)==null||K.call(M),!t){s("Debes iniciar sesin para abrir una caja.");return}h(!0);try{const se=Number(f||0);await yl($e(Ee,"cajas"),{estado:"abierta",usuarioId:t.uid,usuarioNombre:t.displayName||t.email||"Usuario",fechaApertura:Ln(),baseInicial:se,baseActual:se,saldoInicial:0,saldoActual:0,dia:wo()}),m(""),r("mio"),s("")}catch(se){console.error(se),s("No se pudo abrir la caja.")}finally{h(!1)}},wt=async M=>{try{await Xo(Bt(Ee,"cajas",M),{estado:"cerrada",fechaCierre:Ln()}),r("cerradas")}catch(K){console.error(K),s("No se pudo cerrar la caja.")}},te=async M=>{var se;if((se=M==null?void 0:M.preventDefault)==null||se.call(M),!(O!=null&&O.id)){s("Debes abrir tu caja para registrar movimientos.");return}const K=Number(oe||0);if(!(!K||K<=0)){Re(!0);try{await yl($e(Ee,"movimientos"),{cashId:O.id,tipo:Ne,concepto:z||(Ne==="ingreso"?"Ingreso":"Egreso"),valor:K,fecha:Ln(),dia:wo(),usuarioId:(t==null?void 0:t.uid)||null});const Te=Ne==="ingreso"?K:-K;await Xo(Bt(Ee,"cajas",O.id),{saldoActual:DI(Te)}),Z(""),ye("")}catch(Te){console.error(Te),s("No se pudo registrar el movimiento.")}finally{Re(!1)}}},re=async M=>{var se;if((se=M==null?void 0:M.preventDefault)==null||se.call(M),!(O!=null&&O.id))return s("Abre tu caja para cobrar.");const K=Number(qe||0);if(!(!K||K<=0)){if(!b)return s("Selecciona un paciente.");me(!0);try{const Te=await yl($e(Ee,"payments"),{cashId:O.id,patientId:b.id,patientName:b.nombre||b.name||"Paciente",invoiceId:null,valor:K,medio:qt,estado:"aprobado",fecha:Ln(),dia:wo()});await Xo(Bt(Ee,"cajas",O.id),{saldoActual:DI(K)}),St(""),X("efectivo"),s(`Pago registrado (${Te.id}).`)}catch(Te){console.error(Te),s("No se pudo registrar el pago.")}finally{me(!1)}}},he=async M=>{var se;if((se=M==null?void 0:M.preventDefault)==null||se.call(M),!(O!=null&&O.id))return s("Abre tu caja para cobrar.");const K=Number(qe||0);if(!(!K||K<=0)){if(!b)return s("Selecciona un paciente.");me(!0);try{const ot=`https://pay.odontocloud/mock/${jU()}`,Lt=await yl($e(Ee,"payments"),{cashId:O.id,patientId:b.id,patientName:b.nombre||b.name||"Paciente",invoiceId:null,valor:K,medio:"link",estado:"pending",linkUrl:ot,fecha:Ln(),dia:wo()});s(`Link de pago generado: ${ot}`),St("")}catch(Te){console.error(Te),s("No se pudo generar link de pago.")}finally{me(!1)}}},ne=M=>(M||"").toString().normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase(),ee=P.useMemo(()=>{const M=ne(o);return M?v.filter(K=>[K.nombre,K.usuarioNombre,vr(K.saldoActual),vr(K.baseActual)].map(ne).some(se=>se.includes(M))):v},[o,v]),S=()=>u.jsxs("div",{className:"card",children:[u.jsx("div",{className:"oc-card-head",style:{marginBottom:8},children:u.jsx("h3",{children:"Abrir caja"})}),u.jsxs("form",{className:"oc-form",onSubmit:_t,style:{display:"flex",gap:12,alignItems:"end",flexWrap:"wrap"},children:[u.jsxs("label",{style:{display:"inline-flex",flexDirection:"column",gap:6},children:[u.jsx("span",{children:"Base inicial (COP)"}),u.jsx("input",{type:"number",className:"oc-input",min:"0",step:"1000",value:f,onChange:M=>m(M.target.value),placeholder:"0"})]}),u.jsx("button",{className:"oc-btn",type:"submit",disabled:d,children:d?"Abriendo...":"Abrir caja"})]}),u.jsxs("p",{className:"oc-muted",style:{marginTop:8},children:["Se asociar a tu usuario y quedar visible en ",u.jsx("b",{children:"Mi caja (hoy)"}),"."]})]}),F=()=>u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"card",style:{marginBottom:10},children:u.jsxs("div",{className:"oc-card-head",style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[u.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[u.jsx("h3",{style:{margin:0},children:"Cajas Abiertas"}),u.jsx("span",{className:"oc-tag",children:ee.length}),i&&u.jsx("span",{className:"oc-tag oc-tag-danger",children:i})]}),u.jsx("input",{ref:l,className:"oc-input",style:{maxWidth:280},placeholder:"Buscar...",value:o,onChange:M=>a(M.target.value)})]})}),u.jsx("div",{className:"card",children:u.jsx("div",{className:"oc-table-wrap",children:u.jsxs("table",{className:"oc-table",children:[u.jsx("thead",{className:"oc-thead",children:u.jsxs("tr",{className:"oc-tr",children:[u.jsx(Dt,{children:"Caja"}),u.jsx(Dt,{children:"Fecha apertura"}),u.jsx(Dt,{align:"right",children:"Base actual"}),u.jsx(Dt,{align:"right",children:"Saldo inicial"}),u.jsx(Dt,{align:"right",children:"Saldo actual"}),u.jsx(Dt,{children:"Usuario"}),u.jsx(Dt,{children:"Acciones"})]})}),u.jsx("tbody",{className:"oc-tbody",children:y?u.jsx(iT,{cols:7}):ee.length===0?u.jsx("tr",{className:"oc-tr",children:u.jsx("td",{className:"oc-td",colSpan:7,children:u.jsx("span",{className:"oc-muted",children:"Sin cajas abiertas."})})}):ee.map(M=>{var K;return u.jsxs("tr",{className:"oc-tr",children:[u.jsxs("td",{className:"oc-td",children:[u.jsx("b",{children:M.nombre})," ",(K=M.ia)!=null&&K.length?u.jsx("span",{className:"oc-tag oc-tag-danger",title:M.ia.join("  "),children:"IA"}):null]}),u.jsx("td",{className:"oc-td",children:M.fechaApertura?M.fechaApertura.toLocaleString("es-CO"):""}),u.jsxs("td",{className:"oc-td",style:{textAlign:"right"},children:["$",vr(M.baseActual)]}),u.jsxs("td",{className:"oc-td",style:{textAlign:"right"},children:["$",vr(M.saldoInicial)]}),u.jsxs("td",{className:"oc-td",style:{textAlign:"right",color:M.saldoActual<0?"#b91c1c":void 0,fontWeight:600},children:["$",vr(M.saldoActual)]}),u.jsx("td",{className:"oc-td",children:M.usuarioNombre}),u.jsxs("td",{className:"oc-td",style:{whiteSpace:"nowrap"},children:[u.jsx("button",{className:"oc-small-btn",onClick:()=>r("mio"),children:"Ver"})," ",u.jsx("button",{className:"oc-small-btn oc-danger",onClick:()=>wt(M.id),children:"Cerrar"})]})]},M.id)})})]})})})]}),G=()=>u.jsxs("div",{className:"card",children:[u.jsxs("div",{className:"oc-card-head",style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[u.jsx("h3",{children:"Mi caja (hoy)"}),(O==null?void 0:O.estado)==="abierta"&&u.jsxs("div",{style:{display:"flex",gap:8},children:[u.jsx("span",{className:"oc-tag oc-tag-success",children:"Abierta"}),u.jsx("button",{className:"oc-small-btn oc-danger",onClick:()=>wt(O.id),children:"Cerrar caja"})]})]}),x?u.jsx("div",{className:"oc-muted",children:"Cargando"}):O?u.jsxs(u.Fragment,{children:[u.jsxs("div",{className:"oc-stats-row",style:{marginBottom:12},children:[u.jsxs("div",{className:"stat-card",children:[u.jsx("span",{className:"stat-label",children:"Base actual"}),u.jsxs("span",{className:"stat-value",children:["$",vr(O.baseActual)]})]}),u.jsxs("div",{className:"stat-card",children:[u.jsx("span",{className:"stat-label",children:"Saldo actual"}),u.jsxs("span",{className:"stat-value",style:{color:O.saldoActual<0?"#b91c1c":void 0},children:["$",vr(O.saldoActual)]})]})]}),u.jsxs("div",{className:"card",style:{marginBottom:12},children:[u.jsx("h4",{style:{marginBottom:8},children:"Cobro rpido"}),u.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr auto",gap:8},children:[u.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:6},children:[u.jsx("label",{className:"oc-muted",children:"Paciente"}),u.jsx("input",{className:"oc-input",placeholder:"Buscar nombre o documento",value:A,onChange:M=>k(M.target.value)}),A&&D.length>0&&u.jsx("div",{className:"oc-dropdown",children:D.slice(0,6).map(M=>u.jsx("button",{className:`oc-menu-item ${(b==null?void 0:b.id)===M.id?"active":""}`,onClick:()=>{Q(M),k(M.nombre||M.name||M.doc||"")},type:"button",children:(M.nombre||M.name||"Paciente")+(M.doc?`  ${M.doc}`:"")},M.id))})]}),u.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:6},children:[u.jsx("label",{className:"oc-muted",children:"Monto (COP)"}),u.jsx("input",{className:"oc-input",type:"number",min:"0",step:"1000",placeholder:"0",value:qe,onChange:M=>St(M.target.value)})]}),u.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:6},children:[u.jsx("label",{className:"oc-muted",children:"Medio"}),u.jsxs("select",{className:"oc-input",value:qt,onChange:M=>X(M.target.value),children:[u.jsx("option",{value:"efectivo",children:"Efectivo"}),u.jsx("option",{value:"tarjeta",children:"Tarjeta"}),u.jsx("option",{value:"transferencia",children:"Transferencia"}),u.jsx("option",{value:"link",children:"Link (en lnea)"})]})]}),u.jsx("div",{style:{display:"flex",alignItems:"end",gap:6},children:qt==="link"?u.jsx("button",{className:"oc-btn",onClick:he,disabled:de,children:de?"Creando":"Generar link"}):u.jsx("button",{className:"oc-btn",onClick:re,disabled:de,children:de?"Guardando":"Registrar pago"})})]}),u.jsxs("p",{className:"oc-muted",style:{marginTop:8},children:["Para link, el saldo se actualiza cuando el pago pase a ",u.jsx("b",{children:"aprobado"})," (webhook)."]})]}),u.jsxs("div",{className:"card",style:{marginBottom:12},children:[u.jsx("h4",{style:{marginBottom:8},children:"Movimiento manual"}),u.jsxs("form",{onSubmit:te,style:{display:"grid",gridTemplateColumns:"120px 1fr 180px auto",gap:8},children:[u.jsxs("select",{className:"oc-input",value:Ne,onChange:M=>Ue(M.target.value),children:[u.jsx("option",{value:"ingreso",children:"Ingreso"}),u.jsx("option",{value:"egreso",children:"Egreso"})]}),u.jsx("input",{className:"oc-input",placeholder:"Concepto (ej. Caja chica, Arriendo, etc.)",value:z,onChange:M=>Z(M.target.value)}),u.jsx("input",{className:"oc-input",type:"number",min:"0",step:"1000",placeholder:"0",value:oe,onChange:M=>ye(M.target.value)}),u.jsx("button",{className:"oc-btn",disabled:xe,children:xe?"Guardando":"Agregar"})]})]}),u.jsxs("div",{className:"card",children:[u.jsx("h4",{style:{marginBottom:8},children:"Movimientos y pagos (hoy)"}),u.jsx("div",{className:"oc-table-wrap",style:{marginBottom:12},children:u.jsxs("table",{className:"oc-table",children:[u.jsx("thead",{className:"oc-thead",children:u.jsxs("tr",{className:"oc-tr",children:[u.jsx(Dt,{children:"Tipo"}),u.jsx(Dt,{children:"Concepto / Paciente"}),u.jsx(Dt,{children:"Medio"}),u.jsx(Dt,{children:"Estado"}),u.jsx(Dt,{align:"right",children:"Valor"}),u.jsx(Dt,{children:"Hora"})]})}),u.jsx("tbody",{className:"oc-tbody",children:ve.length===0&&we.length===0?u.jsx("tr",{className:"oc-tr",children:u.jsx("td",{className:"oc-td",colSpan:6,children:u.jsx("span",{className:"oc-muted",children:"Sin movimientos ni pagos an."})})}):u.jsxs(u.Fragment,{children:[we.map(M=>{var K,se;return u.jsxs("tr",{className:"oc-tr",children:[u.jsx("td",{className:"oc-td",children:"Pago"}),u.jsxs("td",{className:"oc-td",children:[M.patientName||"Paciente"," ",M.linkUrl?u.jsx("a",{href:M.linkUrl,target:"_blank",rel:"noreferrer",children:"(link)"}):null]}),u.jsx("td",{className:"oc-td",children:M.medio}),u.jsx("td",{className:"oc-td",children:u.jsx("span",{className:`oc-tag ${M.estado==="aprobado"?"oc-tag-success":M.estado==="pending"?"oc-tag-warning":"oc-tag-danger"}`,children:M.estado})}),u.jsxs("td",{className:"oc-td",style:{textAlign:"right"},children:["$",vr(M.valor)]}),u.jsx("td",{className:"oc-td",children:(se=(K=M.fecha)==null?void 0:K.toDate)!=null&&se.call(K)?M.fecha.toDate().toLocaleTimeString("es-CO"):""})]},`pay-${M.id}`)}),ve.map(M=>{var K,se;return u.jsxs("tr",{className:"oc-tr",children:[u.jsx("td",{className:"oc-td",children:M.tipo}),u.jsx("td",{className:"oc-td",children:M.concepto}),u.jsx("td",{className:"oc-td",children:""}),u.jsx("td",{className:"oc-td",children:u.jsx("span",{className:"oc-tag",children:(M.tipo==="ingreso","ok")})}),u.jsxs("td",{className:"oc-td",style:{textAlign:"right"},children:["$",vr(M.valor)]}),u.jsx("td",{className:"oc-td",children:(se=(K=M.fecha)==null?void 0:K.toDate)!=null&&se.call(K)?M.fecha.toDate().toLocaleTimeString("es-CO"):""})]},`mov-${M.id}`)})]})})]})}),u.jsx("p",{className:"oc-muted",children:"Sugerencia: crea ndice compuesto para `movimientos(cashId, dia, fecha)` y `payments(cashId, dia, fecha)` para rendimiento."})]})]}):u.jsxs("div",{className:"oc-empty",children:[u.jsx("p",{className:"oc-muted",children:"No tienes una caja abierta hoy."}),u.jsx("button",{className:"oc-btn",onClick:()=>r("abrir"),children:"Abrir caja"})]})]}),ce=()=>u.jsxs("div",{className:"card",children:[u.jsx("div",{className:"oc-card-head",style:{marginBottom:8},children:u.jsxs("h3",{children:["Cajas cerradas ",u.jsx("span",{className:"oc-tag",children:I.length})]})}),u.jsx("div",{className:"oc-table-wrap",children:u.jsxs("table",{className:"oc-table",children:[u.jsx("thead",{className:"oc-thead",children:u.jsxs("tr",{className:"oc-tr",children:[u.jsx(Dt,{children:"Caja"}),u.jsx(Dt,{children:"Usuario"}),u.jsx(Dt,{children:"Apertura"}),u.jsx(Dt,{children:"Cierre"}),u.jsx(Dt,{align:"right",children:"Saldo final"})]})}),u.jsx("tbody",{className:"oc-tbody",children:T?u.jsx(iT,{cols:5}):I.length===0?u.jsx("tr",{className:"oc-tr",children:u.jsx("td",{className:"oc-td",colSpan:5,children:u.jsx("span",{className:"oc-muted",children:"Sin cajas cerradas."})})}):I.map(M=>u.jsxs("tr",{className:"oc-tr",children:[u.jsx("td",{className:"oc-td",children:M.nombre}),u.jsx("td",{className:"oc-td",children:M.usuarioNombre}),u.jsx("td",{className:"oc-td",children:M.fechaApertura?M.fechaApertura.toLocaleString("es-CO"):""}),u.jsx("td",{className:"oc-td",children:M.fechaCierre?M.fechaCierre.toLocaleString("es-CO"):""}),u.jsxs("td",{className:"oc-td",style:{textAlign:"right"},children:["$",vr(M.saldoActual)]})]},M.id))})]})})]}),fe=()=>u.jsxs("div",{className:"card",children:[u.jsx("h3",{children:"Cierres simulados"}),u.jsx("p",{className:"oc-muted",children:"El cierre hipottico compara ventas y movimientos detectando errores y descuadres con IA. (Conectar fuente de datos para activarlo)."})]}),Se=()=>u.jsxs("div",{className:"card",children:[u.jsx("h3",{children:"Bancos"}),u.jsx("p",{className:"oc-muted",children:"Conciliacin de consignaciones/pagos electrnicos contra caja del da. (Conectar pasarela o extractos para habilitar)."})]}),be=({m:M})=>u.jsxs("button",{type:"button",onClick:()=>r(M.key),className:`oc-menu-item ${n===M.key?"active":""}`,style:{width:"100%",textAlign:"left",padding:"10px 12px",borderRadius:10,border:"1px solid transparent",background:n===M.key?"var(--oc-surface-2, #f3f6ff)":"transparent",fontWeight:600},title:M.label,children:[u.jsx("span",{style:{opacity:.8,marginRight:6},children:M.icon}),M.label]});return u.jsxs("div",{className:"oc-main-content",style:{display:"grid",gridTemplateColumns:"240px 1fr",gap:16},children:[u.jsx("aside",{className:"card",role:"navigation","aria-label":"Men de caja",style:{height:"fit-content",padding:12},children:u.jsx("div",{style:{display:"flex",flexDirection:"column",gap:8},children:e.map(M=>u.jsx(be,{m:M},M.key))})}),u.jsxs("section",{children:[u.jsx("div",{className:"card",style:{marginBottom:12,padding:12},children:u.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",gap:12},children:[u.jsxs("div",{className:"oc-breadcrumb",children:[u.jsx("span",{children:"Caja"}),u.jsx("span",{children:""}),u.jsx("b",{children:(Fe=e.find(M=>M.key===n))==null?void 0:Fe.label})]}),n==="abiertas"&&u.jsx("input",{ref:l,className:"oc-input",placeholder:"Buscar...",value:o,onChange:M=>a(M.target.value),style:{maxWidth:300}})]})}),n==="abrir"&&u.jsx(S,{}),n==="abiertas"&&u.jsx(F,{}),n==="cerradas"&&u.jsx(ce,{}),n==="mio"&&u.jsx(G,{}),n==="simulados"&&u.jsx(fe,{}),n==="bancos"&&u.jsx(Se,{})]})]})}function iT({cols:t=6,n:e=3}){return u.jsx(u.Fragment,{children:Array.from({length:e}).map((n,r)=>u.jsx("tr",{className:"oc-tr",children:Array.from({length:t}).map((i,s)=>u.jsx("td",{className:"oc-td",children:u.jsx("div",{style:{height:12,width:s===0?160:100+s%3*40,background:"var(--oc-skeleton, #e5e7eb)",borderRadius:6}})},s))},r))})}function OU({items:t=[]}){return u.jsxs("div",{className:"card activity-card",children:[u.jsx("h4",{children:"Actividad reciente"}),u.jsx("ul",{className:"activity-list",children:t.map(e=>u.jsxs("li",{children:[u.jsx("strong",{children:e.title}),u.jsx("div",{className:"time",children:e.time})]},e.id))})]})}function LU({status:t}){return t?u.jsxs("div",{className:"card",children:[u.jsx("h4",{children:"Automatizaciones (N8N)"}),u.jsxs("div",{className:"n8n-line",children:[u.jsx("strong",{children:"Conectado:"})," ",t.connected?"S":"No"]}),u.jsxs("div",{className:"n8n-line",children:[u.jsx("strong",{children:"Flujos activos:"})," ",t.flowsRunning]}),t.lastError&&u.jsxs("div",{className:"n8n-error",children:["Error: ",t.lastError]})]}):null}const Je={es:{nav_home:"Inicio",nav_agenda:"Agenda",nav_patients:"Pacientes",nav_billing:"Facturacin",nav_inventory:"Inventario",nav_odontogram:"Odontograma",nav_reports:"Reportes",nav_cash:"Caja",nav_admin:"Administracin",welcomeTitle:"Bienvenido a OdontoCloud",welcomeSubtitle:"Administra tus pacientes, agenda, inventario y facturacin de manera inteligente y moderna.",clinicLabel:"Clnica",userLabel:"Usuario",roleLabel:"Rol",searchPlaceholder:"Buscar acciones o ir a",stats_patientsToday:"Pacientes totales",stats_appointmentsToday:"Citas hoy",stats_revenueToday:"Facturacin hoy",stats_waiting:"En espera",stats_currency:"COP",n8n_title:"Automatizaciones (n8n)",recent_title:"Actividad reciente",recent_empty:"Sin actividad registrada.",loading:"Cargando...",logout:"Cerrar sesin",module_coming:"Mdulo prximamente.",todays_appts:"Citas de hoy",see_schedule:"Ir a Agenda",no_appts_today:"No hay citas programadas hoy.",at:"a las"},en:{nav_home:"Overview",nav_agenda:"Schedule",nav_patients:"Patients",nav_billing:"Billing",nav_inventory:"Inventory",nav_odontogram:"Odontogram",nav_reports:"Reports",nav_cash:"Cash",nav_admin:"Administration",welcomeTitle:"Welcome to OdontoCloud",welcomeSubtitle:"Manage your patients, schedule, inventory and billing in a smart and modern way.",clinicLabel:"Clinic",userLabel:"User",roleLabel:"Role",searchPlaceholder:"Search actions or go to",stats_patientsToday:"Total patients",stats_appointmentsToday:"Appointments today",stats_revenueToday:"Revenue today",stats_waiting:"In waiting room",stats_currency:"COP",n8n_title:"Automations (n8n)",recent_title:"Recent activity",recent_empty:"No activity yet.",loading:"Loading...",logout:"Log out",module_coming:"Module coming soon.",todays_appts:"Today's appointments",see_schedule:"Open Schedule",no_appts_today:"No appointments today.",at:"at"}},MU=()=>typeof navigator>"u"||(navigator.language||navigator.userLanguage||"es").toLowerCase().startsWith("es")?"es":"en",FU=()=>{try{const t=JSON.parse(localStorage.getItem("odc_session"));return t&&Date.now()-t.timestamp<1e3*60*60*24?t:null}catch{return null}},UU=()=>P.useMemo(()=>{const t=new Date,e=new Date(t.getFullYear(),t.getMonth(),t.getDate(),0,0,0,0),n=new Date(t.getFullYear(),t.getMonth(),t.getDate()+1,0,0,0,0);return{startToday:Oe.fromDate(e),endToday:Oe.fromDate(n),startTodayJS:e}},[]),BU=t=>`${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,"0")}-${String(t.getDate()).padStart(2,"0")}`,$U=(t,e)=>t.toLocaleTimeString(e==="es"?"es-CO":"en-US",{hour:"2-digit",minute:"2-digit"}),zU=(t,e)=>{try{const[n,r,i]=(t||"").split("-").map(a=>parseInt(a,10)),[s=0,o=0]=(e||"00:00").split(":").map(a=>parseInt(a,10));return new Date(n,(r||1)-1,i||1,s,o,0,0)}catch{return new Date}};function qU({data:t=[]}){const i=Math.max(1,...t.map(d=>Number(d.value)||0)),s=t.length||7,o=10,a=Math.max(16,Math.min(44,(640-o*(s+1))/s)),l=(a+o)*s+o;return u.jsx("div",{style:{width:"100%",overflowX:"auto"},children:u.jsxs("svg",{width:l,height:240,role:"img","aria-label":"Pacientes registrados por da en la ltima semana",children:[[.25,.5,.75,1].map((d,h)=>{const f=18+(1-d)*182;return u.jsx("line",{x1:0,x2:l,y1:f,y2:f,stroke:"#e5e7eb",strokeDasharray:"4 4"},h)}),t.map((d,h)=>{const f=Number(d.value)||0,m=Math.round(f/i*182),v=o+h*(a+o),C=200-m;return u.jsxs("g",{children:[u.jsx("rect",{x:v,y:C,width:a,height:m,rx:"6",ry:"6",fill:f>0?"#0ea5e9":"#cbd5e1",children:u.jsx("title",{children:`${d.label||d.shortLabel||""}  ${f} paciente${f!==1?"s":""}`})}),f>0&&m>14&&u.jsx("text",{x:v+a/2,y:C-6,textAnchor:"middle",fontSize:"11",fill:"#0f172a",children:f}),u.jsx("text",{x:v+a/2,y:214,textAnchor:"middle",fontSize:"11",fill:"#64748b",children:d.shortLabel||""})]},h)})]})})}function HU({onNavigate:t,onAction:e,placeholder:n}){const[r,i]=P.useState(""),[s,o]=P.useState(!1),[a,l]=P.useState(0),d=P.useRef(null),h=P.useMemo(()=>[{group:"Navegacin",label:"Ir a Inicio",keywords:"inicio home overview",run:()=>t==null?void 0:t("Inicio")},{group:"Navegacin",label:"Ir a Agenda",keywords:"agenda calendario schedule",run:()=>t==null?void 0:t("Agenda")},{group:"Navegacin",label:"Ir a Pacientes",keywords:"pacientes",run:()=>t==null?void 0:t("Pacientes")},{group:"Navegacin",label:"Ir a Facturacin",keywords:"facturacion facturas billing",run:()=>t==null?void 0:t("Facturacin")},{group:"Navegacin",label:"Ir a Inventario",keywords:"inventario stock",run:()=>t==null?void 0:t("Inventario")},{group:"Navegacin",label:"Ir a Odontograma",keywords:"odontograma",run:()=>t==null?void 0:t("Odontograma")},{group:"Navegacin",label:"Ir a Reportes",keywords:"reportes informes",run:()=>t==null?void 0:t("Reportes")},{group:"Acciones",label:"Nueva cita",keywords:"nueva cita agendar",run:()=>e==null?void 0:e("new_appointment")},{group:"Acciones",label:"Nuevo paciente",keywords:"nuevo paciente alta",run:()=>e==null?void 0:e("new_patient")},{group:"Acciones",label:"Nueva factura",keywords:"nueva factura",run:()=>e==null?void 0:e("new_invoice")},{group:"Acciones",label:"Exportar agenda",keywords:"exportar agenda",run:()=>e==null?void 0:e("export_agenda")},{group:"Acciones",label:"Ir a hoy (Agenda)",keywords:"hoy today",run:()=>e==null?void 0:e("agenda_today")},{group:"Acciones",label:"Cambiar modo oscuro",keywords:"oscuro dark mode",run:()=>e==null?void 0:e("toggle_dark")},{group:"Acciones",label:"Cerrar sesin",keywords:"logout salir cerrar",run:()=>e==null?void 0:e("logout")},{group:"Ayuda",label:"Ver atajos de teclado",keywords:"atajos ayuda",run:()=>e==null?void 0:e("show_shortcuts")},{group:"Ayuda",label:"Soporte / Contacto",keywords:"soporte ayuda contacto",run:()=>e==null?void 0:e("support")}],[t,e]),f=P.useMemo(()=>{const y=r.toLowerCase().trim();return y?h.filter(N=>N.label.toLowerCase().includes(y)||N.keywords.includes(y)):[]},[r,h]);P.useEffect(()=>{const y=N=>{d.current&&(d.current.contains(N.target)||o(!1))};return document.addEventListener("mousedown",y),()=>document.removeEventListener("mousedown",y)},[]);const m=y=>{var N;(N=y.run)==null||N.call(y),i(""),o(!1)},v=y=>{!s||f.length===0||(y.key==="ArrowDown"&&(y.preventDefault(),l(N=>(N+1)%f.length)),y.key==="ArrowUp"&&(y.preventDefault(),l(N=>(N-1+f.length)%f.length)),y.key==="Enter"&&(y.preventDefault(),f[a]&&m(f[a])),y.key==="Escape"&&o(!1))},C=P.useMemo(()=>{const y=new Map;return f.forEach(N=>{y.has(N.group)||y.set(N.group,[]),y.get(N.group).push(N)}),Array.from(y.entries())},[f]);return u.jsxs("div",{className:"oc-search-wrap",ref:d,children:[u.jsx("input",{className:"oc-search",type:"search",inputMode:"search",placeholder:n,"aria-label":n,value:r,onChange:y=>{i(y.target.value),o(!!y.target.value),l(0)},onFocus:()=>o(!!r),onKeyDown:v}),s&&u.jsx("div",{className:"oc-search-dropdown",role:"listbox","aria-label":"Resultados de comandos",children:C.length===0?u.jsx("div",{className:"oc-search-item empty",children:"Escribe para ver opciones"}):C.map(([y,N])=>u.jsxs("div",{children:[u.jsx("div",{className:"oc-search-group",children:y}),N.map(I=>{const _=f.indexOf(I);return u.jsx("button",{className:`oc-search-item ${_===a?"active":""}`,onMouseEnter:()=>l(_),onClick:()=>m(I),role:"option",children:u.jsx("span",{className:"oc-search-title",children:I.label})},I.label)})]},y))})]})}function WU({open:t,anchorRect:e,onClose:n,onGo:r,onSoon:i,onFact:s,dark:o}){const[a,l]=P.useState(null),d=P.useRef(null);if(P.useEffect(()=>{if(!t)return;const Q=St=>St.key==="Escape"&&(n==null?void 0:n()),qe=()=>n==null?void 0:n();return window.addEventListener("keydown",Q),window.addEventListener("scroll",qe,!0),()=>{window.removeEventListener("keydown",Q),window.removeEventListener("scroll",qe,!0)}},[t,n]),!t)return null;const h=((e==null?void 0:e.bottom)||60)+8,f=Math.max(12,Math.min(((e==null?void 0:e.left)||300)-160,window.innerWidth-920)),m=10,v=f+360+m,C=o?"#0b1220":"#ffffff",y=o?"#e5e7eb":"#0f172a",N=o?"#0f1a32":"#f3f6ff",I=o?"#1f2a44":"#e2e8f0",_=o?"#b6c1d1":"#475569",T={position:"fixed",top:h,left:f,width:880,maxWidth:"calc(100vw - 24px)",background:C,color:y,borderRadius:14,boxShadow:"0 18px 40px rgba(2,6,23,.18)",border:`1px solid ${I}`,zIndex:400,padding:12},R={position:"fixed",top:h,left:v,width:420,maxWidth:"calc(100vw - 24px)",background:C,color:y,borderRadius:14,boxShadow:"0 18px 40px rgba(2,6,23,.18)",border:`1px solid ${I}`,zIndex:410,padding:12},O={display:"flex",flexDirection:"column",gap:6,padding:"8px 10px"},$={height:38,borderRadius:10,padding:"0 12px",display:"flex",alignItems:"center",gap:8,fontSize:".92rem",cursor:"pointer",border:"1px solid transparent",background:"transparent",color:y,fontWeight:500,textAlign:"left"},x=(Q,qe=!0)=>Object.assign(Q.currentTarget.style,qe?{background:N,borderColor:I}:{background:"transparent",borderColor:"transparent"}),w=()=>{d.current&&clearTimeout(d.current)},A=()=>{w(),d.current=setTimeout(()=>n==null?void 0:n(),180)},k={position:"fixed",top:h,left:f+360,width:m,height:520,zIndex:405},D=[{label:"Recibo de caja",key:"recibo"},{label:"Saldo a favor",key:"saldo"},{label:"Nota crdito",key:"nc"},{label:"Nota dbito",key:"nd"},{label:"Liquidaciones",key:"liq"},{label:"Traslados",key:"tras"},{label:"Pagos",key:"pagos"},{label:"rdenes de compra",key:"oc"},{label:"Factura de venta",key:"fv"},{label:"Facturas de compra",key:"fc"}],j=[{label:"RIPS anteriores (RS-3374)",key:"rips3374"},{label:"RIPS nuevo (RS-2275)",key:"rips2275"}],b=Q=>{s==null||s(Q),r==null||r("Facturacin")};return u.jsxs(u.Fragment,{children:[u.jsx("div",{onClick:n,style:{position:"fixed",inset:0,background:"transparent",zIndex:399}}),u.jsx("div",{style:T,onMouseEnter:w,onMouseLeave:A,children:u.jsxs("div",{style:{display:"grid",gridTemplateColumns:"360px 1fr",gap:8,alignItems:"start"},children:[u.jsxs("div",{style:O,children:[u.jsx("button",{type:"button",style:$,onMouseEnter:()=>{w(),l("facturacion")},onFocus:()=>{w(),l("facturacion")},onClick:()=>l(Q=>Q==="facturacion"?null:"facturacion"),onMouseOver:Q=>x(Q,!0),onMouseOut:Q=>x(Q,!1),children:" Facturacin "}),u.jsx("button",{type:"button",style:$,onMouseEnter:()=>{w(),l("rips")},onFocus:()=>{w(),l("rips")},onClick:()=>l(Q=>Q==="rips"?null:"rips"),onMouseOver:Q=>x(Q,!0),onMouseOut:Q=>x(Q,!1),children:" RIPS "}),u.jsx("button",{type:"button",style:$,onClick:()=>i==null?void 0:i(),onMouseOver:Q=>x(Q,!0),onMouseOut:Q=>x(Q,!1),children:" Convenios"}),u.jsx("button",{type:"button",style:$,onClick:()=>r==null?void 0:r("Agenda"),onMouseOver:Q=>x(Q,!0),onMouseOut:Q=>x(Q,!1),children:" Gestin de agenda"}),u.jsx("button",{type:"button",style:$,onClick:()=>i==null?void 0:i(),onMouseOver:Q=>x(Q,!0),onMouseOut:Q=>x(Q,!1),children:" Terceros"}),u.jsx("button",{type:"button",style:$,onClick:()=>i==null?void 0:i(),onMouseOver:Q=>x(Q,!0),onMouseOut:Q=>x(Q,!1),children:" Campaas"}),u.jsx("button",{type:"button",style:$,onClick:()=>i==null?void 0:i(),onMouseOver:Q=>x(Q,!0),onMouseOut:Q=>x(Q,!1),children:" Temperatura y humedad"}),u.jsx("button",{type:"button",style:$,onClick:()=>i==null?void 0:i(),onMouseOver:Q=>x(Q,!0),onMouseOut:Q=>x(Q,!1),children:" Residuos"}),u.jsx("button",{type:"button",style:$,onClick:()=>r==null?void 0:r("Inventario"),onMouseOver:Q=>x(Q,!0),onMouseOut:Q=>x(Q,!1),children:" Inventario"}),u.jsx("button",{type:"button",style:$,onClick:()=>i==null?void 0:i(),onMouseOver:Q=>x(Q,!0),onMouseOut:Q=>x(Q,!1),children:" Medicamentos y planes"}),u.jsx("button",{type:"button",style:$,onClick:()=>i==null?void 0:i(),onMouseOver:Q=>x(Q,!0),onMouseOut:Q=>x(Q,!1),children:" Esterilizacin"})]}),u.jsx("div",{style:O,children:u.jsxs("div",{style:{fontSize:".85rem",color:_},children:["Accesos rpidos a mdulos de administracin. Pasa el mouse por ",u.jsx("b",{children:"Facturacin"})," o ",u.jsx("b",{children:"RIPS"})," para ver sus acciones."]})})]})}),u.jsx("div",{style:k,onMouseEnter:w,onMouseLeave:A}),a&&u.jsx("div",{style:R,onMouseEnter:w,onMouseLeave:A,children:u.jsx("div",{style:{...O,display:"grid",gridTemplateColumns:"1fr"},children:(a==="facturacion"?D:j).map(Q=>u.jsx("button",{type:"button",style:$,onClick:()=>a==="facturacion"?b(Q.key):i==null?void 0:i(),onMouseOver:qe=>x(qe,!0),onMouseOut:qe=>x(qe,!1),children:Q.label},Q.label))})})]})}function Sp(){const[t]=P.useState(MU()),e=te=>Je[t][te]||te,[n,r]=P.useState("Inicio"),[i,s]=P.useState("recibo"),[o,a]=P.useState(()=>{try{return localStorage.getItem("odontocloud:dark")==="1"}catch{return!1}});P.useEffect(()=>{try{localStorage.setItem("odontocloud:dark",o?"1":"0")}catch{}document.documentElement.classList.toggle("dark",o)},[o]);const[l]=P.useState(()=>FU()),[d]=P.useState((l==null?void 0:l.rol)||""),[h]=P.useState((l==null?void 0:l.email)||""),[f,m]=P.useState("OdontoCloud"),[v,C]=P.useState(h||"Usuario"),[y,N]=P.useState(!0);P.useEffect(()=>{const te=gy(ih,async re=>{try{if(!re){C(h||"Usuario"),m("OdontoCloud"),N(!1);return}C(re.displayName||re.email||h||"Usuario");const he=Bt(Ee,"empresas",re.uid),ne=await eh(he);m(ne.exists()&&ne.data().nombre||"OdontoCloud")}catch(he){console.error("Error cargando empresa/usuario:",he)}finally{N(!1)}});return()=>te()},[h]);const[I,_]=P.useState({pacientesHoy:0,citasHoy:0,facturacionHoy:0,enEspera:0}),[T,R]=P.useState(!0),[O,$]=P.useState([]),[x,w]=P.useState([]),[A,k]=P.useState(!0),{startToday:D,endToday:j,startTodayJS:b}=UU(),Q=P.useMemo(()=>BU(b),[b]),qe=P.useMemo(()=>{const te=new Date,re=new Date(te.getFullYear(),te.getMonth(),te.getDate()-6),he=te,ne=ee=>ee.toLocaleDateString(t==="es"?"es-ES":"en-US",{weekday:"short",day:"2-digit",month:"short"}).replace(".","");return`${ne(re)}  ${ne(he)}`},[t]),St=te=>{var S;const re=te.data()||{};let he;if((S=re.fecha)!=null&&S.toDate){he=re.fecha.toDate();const F=re.horaInicio||re.hora;if(F&&typeof F=="string"){const[G=0,ce=0]=F.split(":").map(fe=>parseInt(fe,10));he.setHours(G||0,ce||0,0,0)}}else if(typeof re.fecha=="string"){const F=re.horaInicio||re.hora||"00:00";he=zU(re.fecha,F)}else he=new Date;const ne=re.pacienteNombre||re.paciente||"Paciente",ee=re.estado&&String(re.estado)||"programada";return{id:te.id,fecha:he,pacienteId:re.pacienteId||"",pacienteNombre:ne,estado:ee,motivo:re.motivo||""}};P.useEffect(()=>{const te=lt($e(Ee,"citas"),et("fecha",">=",D),et("fecha","<",j),An("fecha","asc")),re=lt($e(Ee,"citas"),et("fecha","==",Q));let he=new Map,ne=!1,ee=!1;const S=()=>{const F=Array.from(he.values()).sort((ce,fe)=>ce.fecha.getTime()-fe.fecha.getTime()),G=F.filter(ce=>String(ce.estado).toLowerCase().trim()==="en espera").length;w(F),_(ce=>({...ce,citasHoy:F.length,enEspera:G})),ne&&ee&&k(!1)};rr(te,F=>{ne=!0;const G=new Map(he);F.docs.forEach(ce=>G.set(ce.id,St(ce))),he=G,S()},F=>{console.error("Realtime citas hoy (TS):",F),ne=!0,S()}),rr(re,F=>{ee=!0;const G=new Map(he);F.docs.forEach(ce=>G.set(ce.id,St(ce))),he=G,S()},F=>{console.error("Realtime citas hoy (STR):",F),ee=!0,S()})},[D,j,Q]),P.useEffect(()=>{(async()=>{try{const he=(await AM($e(Ee,"pacientes"))).data().count||0;let ne=0;try{const ee=lt($e(Ee,"facturas"),et("fecha",">=",D),et("fecha","<",j));(await bn(ee)).forEach(F=>{const G=F.data();typeof G.monto=="number"&&(ne+=G.monto)})}catch{ne=0}_(ee=>({...ee,pacientesHoy:he,facturacionHoy:ne}))}catch(re){console.error("Error cargando mtricas:",re),_(he=>({...he,pacientesHoy:0,facturacionHoy:0}))}finally{R(!1)}})()},[D,j]),P.useEffect(()=>{const te=new Date,re=new Date(te.getFullYear(),te.getMonth(),te.getDate()-6),he=new Date(te.getFullYear(),te.getMonth(),te.getDate()+1),ne=new Map;for(let F=0;F<7;F++){const G=new Date(te.getFullYear(),te.getMonth(),te.getDate()-(6-F)),ce=G.toISOString().slice(0,10),fe=G.toLocaleDateString(t==="es"?"es-ES":"en-US"),Se=G.toLocaleDateString(t==="es"?"es-ES":"en-US",{weekday:"short",day:"2-digit"}).replace(".","");ne.set(ce,{label:fe,shortLabel:Se,value:0})}const ee=lt($e(Ee,"pacientes"),et("createdAt",">=",Oe.fromDate(re)),et("createdAt","<",Oe.fromDate(he))),S=rr(ee,F=>{const G=new Map(ne);F.docs.forEach(ce=>{var M;const fe=ce.data()||{},Se=(M=ce.data().createdAt)!=null&&M.toDate?ce.data().createdAt.toDate():fe.createdAt?new Date(fe.createdAt):null;if(!Se||isNaN(Se))return;const be=Se.toISOString().slice(0,10);if(!G.has(be))return;const Fe=G.get(be);Fe.value+=1,G.set(be,Fe)}),$(Array.from(G.values()))},F=>{console.error("Error realtime serie semanal (pacientes):",F),$(Array.from(ne.values()))});return()=>{try{S()}catch{}}},[t]);const[qt,X]=P.useState([]),[de,me]=P.useState(!0);P.useEffect(()=>{(async()=>{try{const re=lt($e(Ee,"actividad"),An("fecha","desc"),Yo(5)),he=await bn(re);X(he.docs.map(ne=>({id:ne.id,title:ne.data().descripcion||ne.data().titulo||"Actividad",time:ne.data().resumenTiempo||""})))}catch(re){console.error("Error cargando actividad:",re),X([])}finally{me(!1)}})()},[]);const[Ne,Ue]=P.useState(null),[z,Z]=P.useState(!0);P.useEffect(()=>{(async()=>{try{const re=Bt(Ee,"integraciones","n8n"),he=await eh(re);Ue(he.exists()?{connected:!!he.data().connected,flowsRunning:he.data().flowsRunning||0,lastError:he.data().lastError||null}:{connected:!1,flowsRunning:0,lastError:null})}catch(re){console.error("Error cargando estado n8n:",re),Ue({connected:!1,flowsRunning:0,lastError:"No se pudo leer el estado desde Firebase."})}finally{Z(!1)}})()},[]);const oe=async()=>{try{localStorage.removeItem("odc_session")}catch{}try{await Dj(ih)}catch(te){console.error("Error al cerrar sesin:",te)}window.location.href="/"},[ye,xe]=P.useState(!1),[Re,ve]=P.useState(null),Ge=P.useRef(null),we=P.useRef(null),ie=()=>{var re,he;const te=(he=(re=Ge.current)==null?void 0:re.getBoundingClientRect)==null?void 0:he.call(re);ve(te),xe(!0)},Pe=()=>{xe(!1),we.current&&(clearTimeout(we.current),we.current=null)},_t=()=>{we.current&&(clearTimeout(we.current),we.current=null)},wt=()=>{switch(n){case"Agenda":return u.jsx(vU,{});case"Pacientes":return u.jsx(AU,{});case"Facturacin":return u.jsx(wU,{view:i});case"Inventario":return u.jsx(EU,{});case"Odontograma":return u.jsx(IU,{});case"Reportes":return u.jsx(PU,{});case"Caja":return u.jsx(VU,{});case"Inicio":default:return null}};return u.jsxs("div",{className:`oc-shell ${o?"oc-dark":""}`,children:[u.jsx("a",{href:"#oc-main",className:"oc-skip-link",children:"Saltar al contenido"}),u.jsxs("header",{className:"oc-header",role:"banner",children:[u.jsxs("div",{className:"oc-header-left",children:[u.jsx("img",{src:dC,alt:"OdontoCloud",className:"oc-logo"}),u.jsxs("div",{className:"oc-brand-text",children:[u.jsx("span",{className:"oc-brand-main",children:"OdontoCloud"}),u.jsx("span",{className:"oc-brand-sub",children:y?"...":f})]})]}),u.jsxs("nav",{className:"oc-nav",role:"navigation","aria-label":"Navegacin principal",children:[u.jsx("button",{type:"button",className:n==="Inicio"?"oc-nav-btn active":"oc-nav-btn","aria-current":n==="Inicio"?"page":void 0,onClick:()=>r("Inicio"),title:e("nav_home"),children:e("nav_home")}),u.jsx("button",{type:"button",className:n==="Agenda"?"oc-nav-btn active":"oc-nav-btn","aria-current":n==="Agenda"?"page":void 0,onClick:()=>r("Agenda"),title:e("nav_agenda"),children:e("nav_agenda")}),u.jsx("button",{type:"button",className:n==="Pacientes"?"oc-nav-btn active":"oc-nav-btn","aria-current":n==="Pacientes"?"page":void 0,onClick:()=>r("Pacientes"),title:e("nav_patients"),children:e("nav_patients")}),u.jsx("button",{type:"button",className:n==="Caja"?"oc-nav-btn active":"oc-nav-btn",onClick:()=>r("Caja"),title:e("nav_cash"),children:e("nav_cash")}),u.jsx("button",{type:"button",ref:Ge,className:"oc-nav-btn",title:e("nav_admin"),"aria-haspopup":"true","aria-expanded":ye,onClick:()=>ye?Pe():ie(),onMouseEnter:()=>{_t(),ie()},onFocus:()=>{_t(),ie()},children:e("nav_admin")}),u.jsx("button",{type:"button",className:n==="Reportes"?"oc-nav-btn active":"oc-nav-btn","aria-current":n==="Reportes"?"page":void 0,onClick:()=>r("Reportes"),title:e("nav_reports"),children:e("nav_reports")})]}),u.jsxs("div",{className:"oc-header-right",children:[u.jsx(HU,{placeholder:e("searchPlaceholder"),onNavigate:te=>r(te),onAction:te=>{switch(te){case"new_appointment":r("Agenda");break;case"new_patient":r("Pacientes");break;case"new_invoice":r("Facturacin"),s("fv");break;case"export_agenda":r("Agenda");break;case"agenda_today":r("Agenda");break;case"toggle_dark":a(re=>!re);break;case"logout":oe();break;case"show_shortcuts":alert("Atajos: Ctrl/Cmd + K para abrir bsqueda, / para moverse, Enter para ejecutar.");break;case"support":window.open("https://tu-soporte.odc","_blank");break}}}),u.jsx("button",{className:"oc-icon-btn",type:"button",onClick:()=>a(te=>!te),"aria-pressed":o,title:o?"Activar modo claro":"Activar modo oscuro",children:o?"":""}),u.jsx("button",{className:"oc-icon-btn",type:"button",onClick:oe,title:Je[t].logout,children:Je[t].logout})]})]}),u.jsx(WU,{open:ye,anchorRect:Re,dark:o,onClose:Pe,onGo:te=>{r(te),Pe()},onSoon:()=>{alert("Prximamente"),Pe()},onFact:te=>{s(te)}}),u.jsxs("main",{id:"oc-main",className:"oc-main-wrapper",role:"main",children:[n!=="Inicio"&&wt(),n==="Inicio"&&u.jsxs("div",{className:"oc-main-content",children:[u.jsxs("section",{className:"oc-hero","aria-label":"Resumen general",children:[u.jsxs("div",{className:"oc-hero-text",children:[u.jsx("h1",{children:Je[t].welcomeTitle}),u.jsx("p",{children:Je[t].welcomeSubtitle}),u.jsxs("p",{className:"oc-hero-meta",children:[Je[t].clinicLabel,": ",f,"  ",Je[t].userLabel,":"," ",v,"  ",Je[t].roleLabel,": ",d||""]})]}),u.jsxs("div",{className:"oc-hero-badge","aria-live":"polite",children:[u.jsx("span",{className:"oc-hero-badge-title",children:Je[t].stats_appointmentsToday}),u.jsx("span",{className:"oc-hero-badge-value",children:T&&A?"":I.citasHoy}),u.jsxs("span",{className:"oc-hero-badge-sub",children:[Je[t].stats_patientsToday,": ",T?"":I.pacientesHoy]})]})]}),u.jsxs("section",{className:"oc-stats-row","aria-label":"Indicadores del da",children:[u.jsxs("div",{className:"stat-card",children:[u.jsx("span",{className:"stat-label",children:Je[t].stats_patientsToday}),u.jsx("span",{className:"stat-value",children:I.pacientesHoy})]}),u.jsxs("div",{className:"stat-card",children:[u.jsx("span",{className:"stat-label",children:Je[t].stats_appointmentsToday}),u.jsx("span",{className:"stat-value",children:I.citasHoy})]}),u.jsxs("div",{className:"stat-card",children:[u.jsx("span",{className:"stat-label",children:Je[t].stats_revenueToday}),u.jsxs("span",{className:"stat-value",children:[I.facturacionHoy.toLocaleString("es-CO")," ",u.jsx("span",{className:"stat-currency",children:Je[t].stats_currency})]})]}),u.jsxs("div",{className:"stat-card",children:[u.jsx("span",{className:"stat-label",children:Je[t].stats_waiting}),u.jsx("span",{className:"stat-value",children:I.enEspera})]})]}),u.jsxs("section",{className:"oc-grid","aria-label":"Contenido principal del dashboard",children:[u.jsx("div",{className:"oc-grid-main",children:u.jsxs("div",{className:"card card-quickcharts",children:[u.jsxs("div",{className:"oc-card-head",style:{display:"flex",justifyContent:"space-between",alignItems:"center",gap:8},children:[u.jsx("h3",{children:"Pacientes registrados  ltimos 7 das"}),u.jsx("span",{className:"oc-muted",style:{marginLeft:8,fontSize:12},children:qe})]}),O.length===0||O.every(te=>((te==null?void 0:te.value)||0)===0)?u.jsx("p",{className:"oc-weekly-empty",children:"Sin pacientes registrados en la ltima semana."}):u.jsx(qU,{data:O})]})}),u.jsxs("aside",{className:"oc-grid-side","aria-label":"Panel lateral",children:[u.jsxs("div",{className:"card",children:[u.jsx("h3",{children:Je[t].n8n_title}),z?u.jsx("span",{className:"oc-muted",children:Je[t].loading}):u.jsx(LU,{status:Ne})]}),u.jsxs("div",{className:"card",children:[u.jsxs("div",{className:"oc-card-head",style:{display:"flex",justifyContent:"space-between",alignItems:"center",gap:8},children:[u.jsx("h3",{children:Je[t].todays_appts}),u.jsx("button",{className:"oc-small-link",type:"button",onClick:()=>r("Agenda"),children:Je[t].see_schedule})]}),A?u.jsx("span",{className:"oc-muted",children:Je[t].loading}):x.length===0?u.jsx("p",{className:"oc-muted",children:Je[t].no_appts_today}):u.jsx("ul",{className:"oc-list",children:x.slice(0,5).map(te=>u.jsxs("li",{className:"oc-list-item",children:[u.jsxs("div",{className:"oc-list-main",children:[u.jsx("b",{children:te.pacienteNombre||"Paciente"})," ",u.jsxs("span",{className:"oc-muted",children:[Je[t].at," ",$U(te.fecha,t)]})]}),u.jsx("div",{className:`oc-tag oc-tag-${(te.estado||"programada").toLowerCase().replace(/\s+/g,"-")}`,children:te.estado||"programada"})]},te.id))})]}),u.jsxs("div",{className:"card",children:[u.jsx("h3",{children:Je[t].recent_title}),de?u.jsx("span",{className:"oc-muted",children:Je[t].loading}):qt.length===0?u.jsx("p",{className:"oc-muted",children:Je[t].recent_empty}):u.jsx(OU,{items:qt})]})]})]}),u.jsxs("footer",{className:"oc-footer",children:[" ",new Date().getFullYear()," OdontoCloud | Creado por Ingeniero Juan Madrid"]})]})]})]})}const KU=()=>{try{const t=JSON.parse(localStorage.getItem("odc_session"));return t&&Date.now()-t.timestamp<1e3*60*60*24?t:null}catch{return null}};function bp({allowedRoles:t,children:e}){var i;const n=KU();if(!n)return u.jsx(wm,{to:"/",replace:!0});const r=(i=n.rol)==null?void 0:i.toLowerCase();return t.map(s=>s.toLowerCase()).includes(r)?e:u.jsx(wm,{to:"/",replace:!0})}function GU(){return u.jsxs(_k,{children:[u.jsx(Eo,{path:"/",element:u.jsx(QF,{})}),u.jsx(Eo,{path:"/dashboard_admin",element:u.jsx(bp,{allowedRoles:["administrador"],children:u.jsx(Sp,{})})}),u.jsx(Eo,{path:"/dashboard_doctor",element:u.jsx(bp,{allowedRoles:["doctor"],children:u.jsx(Sp,{})})}),u.jsx(Eo,{path:"/dashboard_recepcion",element:u.jsx(bp,{allowedRoles:["recepcionista"],children:u.jsx(Sp,{})})}),u.jsx(Eo,{path:"*",element:u.jsx(wm,{to:"/",replace:!0})})]})}async function QU(){try{await Pj(ih,bS),await dM(Ee),console.log(" Firebase listo con sesin persistente y modo offline.")}catch(t){console.warn(" Firebase offline/persistencia fall:",t.message)}}const YU="modulepreload",XU=function(t){return"/odontocloud-react/"+t},sT={},JU=function(e,n,r){let i=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),a=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));i=Promise.allSettled(n.map(l=>{if(l=XU(l),l in sT)return;sT[l]=!0;const d=l.endsWith(".css"),h=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${h}`))return;const f=document.createElement("link");if(f.rel=d?"stylesheet":YU,d||(f.as="script"),f.crossOrigin="",f.href=l,a&&f.setAttribute("nonce",a),document.head.appendChild(f),d)return new Promise((m,v)=>{f.addEventListener("load",m),f.addEventListener("error",()=>v(new Error(`Unable to preload CSS for ${l}`)))})}))}function s(o){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=o,window.dispatchEvent(a),!a.defaultPrevented)throw o}return i.then(o=>{for(const a of o||[])a.status==="rejected"&&s(a.reason);return e().catch(s)})};function ZU(t={}){const{immediate:e=!1,onNeedRefresh:n,onOfflineReady:r,onRegistered:i,onRegisteredSW:s,onRegisterError:o}=t;let a,l;const d=async(f=!0)=>{await l};async function h(){if("serviceWorker"in navigator){if(a=await JU(async()=>{const{Workbox:f}=await import("./workbox-window.prod.es5-vqzQaGvo.js");return{Workbox:f}},[]).then(({Workbox:f})=>new f("/odontocloud-react/sw.js",{scope:"/odontocloud-react/",type:"classic"})).catch(f=>{o==null||o(f)}),!a)return;a.addEventListener("activated",f=>{(f.isUpdate||f.isExternal)&&window.location.reload()}),a.addEventListener("installed",f=>{f.isUpdate||r==null||r()}),a.register({immediate:e}).then(f=>{s?s("/odontocloud-react/sw.js",f):i==null||i(f)}).catch(f=>{o==null||o(f)})}}return l=h(),d}const e6="/odontocloud-react/";QU();ZU({immediate:!0});wx(document.getElementById("root")).render(u.jsx(gR.StrictMode,{children:u.jsx(Bk,{basename:e6,children:u.jsx(GU,{})})}));
