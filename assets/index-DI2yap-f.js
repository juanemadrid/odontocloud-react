(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();function lR(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var hT={exports:{}},uh={},fT={exports:{}},Ne={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var vc=Symbol.for("react.element"),cR=Symbol.for("react.portal"),uR=Symbol.for("react.fragment"),dR=Symbol.for("react.strict_mode"),hR=Symbol.for("react.profiler"),fR=Symbol.for("react.provider"),pR=Symbol.for("react.context"),mR=Symbol.for("react.forward_ref"),gR=Symbol.for("react.suspense"),yR=Symbol.for("react.memo"),_R=Symbol.for("react.lazy"),vv=Symbol.iterator;function vR(t){return t===null||typeof t!="object"?null:(t=vv&&t[vv]||t["@@iterator"],typeof t=="function"?t:null)}var pT={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},mT=Object.assign,gT={};function Ta(t,e,n){this.props=t,this.context=e,this.refs=gT,this.updater=n||pT}Ta.prototype.isReactComponent={};Ta.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Ta.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function yT(){}yT.prototype=Ta.prototype;function lg(t,e,n){this.props=t,this.context=e,this.refs=gT,this.updater=n||pT}var cg=lg.prototype=new yT;cg.constructor=lg;mT(cg,Ta.prototype);cg.isPureReactComponent=!0;var wv=Array.isArray,_T=Object.prototype.hasOwnProperty,ug={current:null},vT={key:!0,ref:!0,__self:!0,__source:!0};function wT(t,e,n){var r,s={},i=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(i=""+e.key),e)_T.call(e,r)&&!vT.hasOwnProperty(r)&&(s[r]=e[r]);var a=arguments.length-2;if(a===1)s.children=n;else if(1<a){for(var l=Array(a),d=0;d<a;d++)l[d]=arguments[d+2];s.children=l}if(t&&t.defaultProps)for(r in a=t.defaultProps,a)s[r]===void 0&&(s[r]=a[r]);return{$$typeof:vc,type:t,key:i,ref:o,props:s,_owner:ug.current}}function wR(t,e){return{$$typeof:vc,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function dg(t){return typeof t=="object"&&t!==null&&t.$$typeof===vc}function ER(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var Ev=/\/+/g;function Pf(t,e){return typeof t=="object"&&t!==null&&t.key!=null?ER(""+t.key):e.toString(36)}function Nu(t,e,n,r,s){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case vc:case cR:o=!0}}if(o)return o=t,s=s(o),t=r===""?"."+Pf(o,0):r,wv(s)?(n="",t!=null&&(n=t.replace(Ev,"$&/")+"/"),Nu(s,e,n,"",function(d){return d})):s!=null&&(dg(s)&&(s=wR(s,n+(!s.key||o&&o.key===s.key?"":(""+s.key).replace(Ev,"$&/")+"/")+t)),e.push(s)),1;if(o=0,r=r===""?".":r+":",wv(t))for(var a=0;a<t.length;a++){i=t[a];var l=r+Pf(i,a);o+=Nu(i,e,n,l,s)}else if(l=vR(t),typeof l=="function")for(t=l.call(t),a=0;!(i=t.next()).done;)i=i.value,l=r+Pf(i,a++),o+=Nu(i,e,n,l,s);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function eu(t,e,n){if(t==null)return t;var r=[],s=0;return Nu(t,r,"","",function(i){return e.call(n,i,s++)}),r}function IR(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var gn={current:null},ku={transition:null},TR={ReactCurrentDispatcher:gn,ReactCurrentBatchConfig:ku,ReactCurrentOwner:ug};function ET(){throw Error("act(...) is not supported in production builds of React.")}Ne.Children={map:eu,forEach:function(t,e,n){eu(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return eu(t,function(){e++}),e},toArray:function(t){return eu(t,function(e){return e})||[]},only:function(t){if(!dg(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Ne.Component=Ta;Ne.Fragment=uR;Ne.Profiler=hR;Ne.PureComponent=lg;Ne.StrictMode=dR;Ne.Suspense=gR;Ne.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=TR;Ne.act=ET;Ne.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=mT({},t.props),s=t.key,i=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,o=ug.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(l in e)_T.call(e,l)&&!vT.hasOwnProperty(l)&&(r[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)r.children=n;else if(1<l){a=Array(l);for(var d=0;d<l;d++)a[d]=arguments[d+2];r.children=a}return{$$typeof:vc,type:t.type,key:s,ref:i,props:r,_owner:o}};Ne.createContext=function(t){return t={$$typeof:pR,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:fR,_context:t},t.Consumer=t};Ne.createElement=wT;Ne.createFactory=function(t){var e=wT.bind(null,t);return e.type=t,e};Ne.createRef=function(){return{current:null}};Ne.forwardRef=function(t){return{$$typeof:mR,render:t}};Ne.isValidElement=dg;Ne.lazy=function(t){return{$$typeof:_R,_payload:{_status:-1,_result:t},_init:IR}};Ne.memo=function(t,e){return{$$typeof:yR,type:t,compare:e===void 0?null:e}};Ne.startTransition=function(t){var e=ku.transition;ku.transition={};try{t()}finally{ku.transition=e}};Ne.unstable_act=ET;Ne.useCallback=function(t,e){return gn.current.useCallback(t,e)};Ne.useContext=function(t){return gn.current.useContext(t)};Ne.useDebugValue=function(){};Ne.useDeferredValue=function(t){return gn.current.useDeferredValue(t)};Ne.useEffect=function(t,e){return gn.current.useEffect(t,e)};Ne.useId=function(){return gn.current.useId()};Ne.useImperativeHandle=function(t,e,n){return gn.current.useImperativeHandle(t,e,n)};Ne.useInsertionEffect=function(t,e){return gn.current.useInsertionEffect(t,e)};Ne.useLayoutEffect=function(t,e){return gn.current.useLayoutEffect(t,e)};Ne.useMemo=function(t,e){return gn.current.useMemo(t,e)};Ne.useReducer=function(t,e,n){return gn.current.useReducer(t,e,n)};Ne.useRef=function(t){return gn.current.useRef(t)};Ne.useState=function(t){return gn.current.useState(t)};Ne.useSyncExternalStore=function(t,e,n){return gn.current.useSyncExternalStore(t,e,n)};Ne.useTransition=function(){return gn.current.useTransition()};Ne.version="18.3.1";fT.exports=Ne;var N=fT.exports;const IT=lR(N);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var xR=N,SR=Symbol.for("react.element"),bR=Symbol.for("react.fragment"),CR=Object.prototype.hasOwnProperty,AR=xR.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,RR={key:!0,ref:!0,__self:!0,__source:!0};function TT(t,e,n){var r,s={},i=null,o=null;n!==void 0&&(i=""+n),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)CR.call(e,r)&&!RR.hasOwnProperty(r)&&(s[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)s[r]===void 0&&(s[r]=e[r]);return{$$typeof:SR,type:t,key:i,ref:o,props:s,_owner:AR.current}}uh.Fragment=bR;uh.jsx=TT;uh.jsxs=TT;hT.exports=uh;var u=hT.exports,xT={exports:{}},Vn={},ST={exports:{}},bT={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(Z,ce){var pe=Z.length;Z.push(ce);e:for(;0<pe;){var Ve=pe-1>>>1,Qe=Z[Ve];if(0<s(Qe,ce))Z[Ve]=ce,Z[pe]=Qe,pe=Ve;else break e}}function n(Z){return Z.length===0?null:Z[0]}function r(Z){if(Z.length===0)return null;var ce=Z[0],pe=Z.pop();if(pe!==ce){Z[0]=pe;e:for(var Ve=0,Qe=Z.length,z=Qe>>>1;Ve<z;){var te=2*(Ve+1)-1,ue=Z[te],Ee=te+1,we=Z[Ee];if(0>s(ue,pe))Ee<Qe&&0>s(we,ue)?(Z[Ve]=we,Z[Ee]=pe,Ve=Ee):(Z[Ve]=ue,Z[te]=pe,Ve=te);else if(Ee<Qe&&0>s(we,pe))Z[Ve]=we,Z[Ee]=pe,Ve=Ee;else break e}}return ce}function s(Z,ce){var pe=Z.sortIndex-ce.sortIndex;return pe!==0?pe:Z.id-ce.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var l=[],d=[],h=1,f=null,m=3,w=!1,R=!1,b=!1,A=typeof setTimeout=="function"?setTimeout:null,T=typeof clearTimeout=="function"?clearTimeout:null,E=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function y(Z){for(var ce=n(d);ce!==null;){if(ce.callback===null)r(d);else if(ce.startTime<=Z)r(d),ce.sortIndex=ce.expirationTime,e(l,ce);else break;ce=n(d)}}function j(Z){if(b=!1,y(Z),!R)if(n(l)!==null)R=!0,Lt(V);else{var ce=n(d);ce!==null&&he(j,ce.startTime-Z)}}function V(Z,ce){R=!1,b&&(b=!1,T(_),_=-1),w=!0;var pe=m;try{for(y(ce),f=n(l);f!==null&&(!(f.expirationTime>ce)||Z&&!k());){var Ve=f.callback;if(typeof Ve=="function"){f.callback=null,m=f.priorityLevel;var Qe=Ve(f.expirationTime<=ce);ce=t.unstable_now(),typeof Qe=="function"?f.callback=Qe:f===n(l)&&r(l),y(ce)}else r(l);f=n(l)}if(f!==null)var z=!0;else{var te=n(d);te!==null&&he(j,te.startTime-ce),z=!1}return z}finally{f=null,m=pe,w=!1}}var M=!1,x=null,_=-1,S=5,C=-1;function k(){return!(t.unstable_now()-C<S)}function D(){if(x!==null){var Z=t.unstable_now();C=Z;var ce=!0;try{ce=x(!0,Z)}finally{ce?P():(M=!1,x=null)}}else M=!1}var P;if(typeof E=="function")P=function(){E(D)};else if(typeof MessageChannel<"u"){var Y=new MessageChannel,Ge=Y.port2;Y.port1.onmessage=D,P=function(){Ge.postMessage(null)}}else P=function(){A(D,0)};function Lt(Z){x=Z,M||(M=!0,P())}function he(Z,ce){_=A(function(){Z(t.unstable_now())},ce)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(Z){Z.callback=null},t.unstable_continueExecution=function(){R||w||(R=!0,Lt(V))},t.unstable_forceFrameRate=function(Z){0>Z||125<Z?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):S=0<Z?Math.floor(1e3/Z):5},t.unstable_getCurrentPriorityLevel=function(){return m},t.unstable_getFirstCallbackNode=function(){return n(l)},t.unstable_next=function(Z){switch(m){case 1:case 2:case 3:var ce=3;break;default:ce=m}var pe=m;m=ce;try{return Z()}finally{m=pe}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(Z,ce){switch(Z){case 1:case 2:case 3:case 4:case 5:break;default:Z=3}var pe=m;m=Z;try{return ce()}finally{m=pe}},t.unstable_scheduleCallback=function(Z,ce,pe){var Ve=t.unstable_now();switch(typeof pe=="object"&&pe!==null?(pe=pe.delay,pe=typeof pe=="number"&&0<pe?Ve+pe:Ve):pe=Ve,Z){case 1:var Qe=-1;break;case 2:Qe=250;break;case 5:Qe=1073741823;break;case 4:Qe=1e4;break;default:Qe=5e3}return Qe=pe+Qe,Z={id:h++,callback:ce,priorityLevel:Z,startTime:pe,expirationTime:Qe,sortIndex:-1},pe>Ve?(Z.sortIndex=pe,e(d,Z),n(l)===null&&Z===n(d)&&(b?(T(_),_=-1):b=!0,he(j,pe-Ve))):(Z.sortIndex=Qe,e(l,Z),R||w||(R=!0,Lt(V))),Z},t.unstable_shouldYield=k,t.unstable_wrapCallback=function(Z){var ce=m;return function(){var pe=m;m=ce;try{return Z.apply(this,arguments)}finally{m=pe}}}})(bT);ST.exports=bT;var PR=ST.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var NR=N,jn=PR;function K(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var CT=new Set,$l={};function eo(t,e){na(t,e),na(t+"Capture",e)}function na(t,e){for($l[t]=e,t=0;t<e.length;t++)CT.add(e[t])}var Hr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),kp=Object.prototype.hasOwnProperty,kR=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Iv={},Tv={};function DR(t){return kp.call(Tv,t)?!0:kp.call(Iv,t)?!1:kR.test(t)?Tv[t]=!0:(Iv[t]=!0,!1)}function jR(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function OR(t,e,n,r){if(e===null||typeof e>"u"||jR(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function yn(t,e,n,r,s,i,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=o}var Yt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Yt[t]=new yn(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Yt[e]=new yn(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Yt[t]=new yn(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Yt[t]=new yn(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Yt[t]=new yn(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Yt[t]=new yn(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Yt[t]=new yn(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Yt[t]=new yn(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Yt[t]=new yn(t,5,!1,t.toLowerCase(),null,!1,!1)});var hg=/[\-:]([a-z])/g;function fg(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(hg,fg);Yt[e]=new yn(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(hg,fg);Yt[e]=new yn(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(hg,fg);Yt[e]=new yn(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Yt[t]=new yn(t,1,!1,t.toLowerCase(),null,!1,!1)});Yt.xlinkHref=new yn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Yt[t]=new yn(t,1,!1,t.toLowerCase(),null,!0,!0)});function pg(t,e,n,r){var s=Yt.hasOwnProperty(e)?Yt[e]:null;(s!==null?s.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(OR(e,n,s,r)&&(n=null),r||s===null?DR(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):s.mustUseProperty?t[s.propertyName]=n===null?s.type===3?!1:"":n:(e=s.attributeName,r=s.attributeNamespace,n===null?t.removeAttribute(e):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var ts=NR.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,tu=Symbol.for("react.element"),Ro=Symbol.for("react.portal"),Po=Symbol.for("react.fragment"),mg=Symbol.for("react.strict_mode"),Dp=Symbol.for("react.profiler"),AT=Symbol.for("react.provider"),RT=Symbol.for("react.context"),gg=Symbol.for("react.forward_ref"),jp=Symbol.for("react.suspense"),Op=Symbol.for("react.suspense_list"),yg=Symbol.for("react.memo"),gs=Symbol.for("react.lazy"),PT=Symbol.for("react.offscreen"),xv=Symbol.iterator;function Ka(t){return t===null||typeof t!="object"?null:(t=xv&&t[xv]||t["@@iterator"],typeof t=="function"?t:null)}var _t=Object.assign,Nf;function cl(t){if(Nf===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);Nf=e&&e[1]||""}return`
`+Nf+t}var kf=!1;function Df(t,e){if(!t||kf)return"";kf=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(d){var r=d}Reflect.construct(t,[],e)}else{try{e.call()}catch(d){r=d}t.call(e.prototype)}else{try{throw Error()}catch(d){r=d}t()}}catch(d){if(d&&r&&typeof d.stack=="string"){for(var s=d.stack.split(`
`),i=r.stack.split(`
`),o=s.length-1,a=i.length-1;1<=o&&0<=a&&s[o]!==i[a];)a--;for(;1<=o&&0<=a;o--,a--)if(s[o]!==i[a]){if(o!==1||a!==1)do if(o--,a--,0>a||s[o]!==i[a]){var l=`
`+s[o].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=o&&0<=a);break}}}finally{kf=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?cl(t):""}function VR(t){switch(t.tag){case 5:return cl(t.type);case 16:return cl("Lazy");case 13:return cl("Suspense");case 19:return cl("SuspenseList");case 0:case 2:case 15:return t=Df(t.type,!1),t;case 11:return t=Df(t.type.render,!1),t;case 1:return t=Df(t.type,!0),t;default:return""}}function Vp(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Po:return"Fragment";case Ro:return"Portal";case Dp:return"Profiler";case mg:return"StrictMode";case jp:return"Suspense";case Op:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case RT:return(t.displayName||"Context")+".Consumer";case AT:return(t._context.displayName||"Context")+".Provider";case gg:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case yg:return e=t.displayName||null,e!==null?e:Vp(t.type)||"Memo";case gs:e=t._payload,t=t._init;try{return Vp(t(e))}catch{}}return null}function LR(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Vp(e);case 8:return e===mg?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function qs(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function NT(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function MR(t){var e=NT(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,i=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(o){r=""+o,i.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function nu(t){t._valueTracker||(t._valueTracker=MR(t))}function kT(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=NT(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function ad(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Lp(t,e){var n=e.checked;return _t({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function Sv(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=qs(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function DT(t,e){e=e.checked,e!=null&&pg(t,"checked",e,!1)}function Mp(t,e){DT(t,e);var n=qs(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Fp(t,e.type,n):e.hasOwnProperty("defaultValue")&&Fp(t,e.type,qs(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function bv(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function Fp(t,e,n){(e!=="number"||ad(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var ul=Array.isArray;function Bo(t,e,n,r){if(t=t.options,e){e={};for(var s=0;s<n.length;s++)e["$"+n[s]]=!0;for(n=0;n<t.length;n++)s=e.hasOwnProperty("$"+t[n].value),t[n].selected!==s&&(t[n].selected=s),s&&r&&(t[n].defaultSelected=!0)}else{for(n=""+qs(n),e=null,s=0;s<t.length;s++){if(t[s].value===n){t[s].selected=!0,r&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function Up(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(K(91));return _t({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function Cv(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(K(92));if(ul(n)){if(1<n.length)throw Error(K(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:qs(n)}}function jT(t,e){var n=qs(e.value),r=qs(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function Av(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function OT(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function $p(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?OT(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var ru,VT=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,s){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(ru=ru||document.createElement("div"),ru.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=ru.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Bl(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var Il={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},FR=["Webkit","ms","Moz","O"];Object.keys(Il).forEach(function(t){FR.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Il[e]=Il[t]})});function LT(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||Il.hasOwnProperty(t)&&Il[t]?(""+e).trim():e+"px"}function MT(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=LT(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,s):t[n]=s}}var UR=_t({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Bp(t,e){if(e){if(UR[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(K(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(K(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(K(61))}if(e.style!=null&&typeof e.style!="object")throw Error(K(62))}}function zp(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var qp=null;function _g(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Hp=null,zo=null,qo=null;function Rv(t){if(t=Ic(t)){if(typeof Hp!="function")throw Error(K(280));var e=t.stateNode;e&&(e=mh(e),Hp(t.stateNode,t.type,e))}}function FT(t){zo?qo?qo.push(t):qo=[t]:zo=t}function UT(){if(zo){var t=zo,e=qo;if(qo=zo=null,Rv(t),e)for(t=0;t<e.length;t++)Rv(e[t])}}function $T(t,e){return t(e)}function BT(){}var jf=!1;function zT(t,e,n){if(jf)return t(e,n);jf=!0;try{return $T(t,e,n)}finally{jf=!1,(zo!==null||qo!==null)&&(BT(),UT())}}function zl(t,e){var n=t.stateNode;if(n===null)return null;var r=mh(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(K(231,e,typeof n));return n}var Wp=!1;if(Hr)try{var Ga={};Object.defineProperty(Ga,"passive",{get:function(){Wp=!0}}),window.addEventListener("test",Ga,Ga),window.removeEventListener("test",Ga,Ga)}catch{Wp=!1}function $R(t,e,n,r,s,i,o,a,l){var d=Array.prototype.slice.call(arguments,3);try{e.apply(n,d)}catch(h){this.onError(h)}}var Tl=!1,ld=null,cd=!1,Kp=null,BR={onError:function(t){Tl=!0,ld=t}};function zR(t,e,n,r,s,i,o,a,l){Tl=!1,ld=null,$R.apply(BR,arguments)}function qR(t,e,n,r,s,i,o,a,l){if(zR.apply(this,arguments),Tl){if(Tl){var d=ld;Tl=!1,ld=null}else throw Error(K(198));cd||(cd=!0,Kp=d)}}function to(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function qT(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function Pv(t){if(to(t)!==t)throw Error(K(188))}function HR(t){var e=t.alternate;if(!e){if(e=to(t),e===null)throw Error(K(188));return e!==t?null:t}for(var n=t,r=e;;){var s=n.return;if(s===null)break;var i=s.alternate;if(i===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===n)return Pv(s),t;if(i===r)return Pv(s),e;i=i.sibling}throw Error(K(188))}if(n.return!==r.return)n=s,r=i;else{for(var o=!1,a=s.child;a;){if(a===n){o=!0,n=s,r=i;break}if(a===r){o=!0,r=s,n=i;break}a=a.sibling}if(!o){for(a=i.child;a;){if(a===n){o=!0,n=i,r=s;break}if(a===r){o=!0,r=i,n=s;break}a=a.sibling}if(!o)throw Error(K(189))}}if(n.alternate!==r)throw Error(K(190))}if(n.tag!==3)throw Error(K(188));return n.stateNode.current===n?t:e}function HT(t){return t=HR(t),t!==null?WT(t):null}function WT(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=WT(t);if(e!==null)return e;t=t.sibling}return null}var KT=jn.unstable_scheduleCallback,Nv=jn.unstable_cancelCallback,WR=jn.unstable_shouldYield,KR=jn.unstable_requestPaint,bt=jn.unstable_now,GR=jn.unstable_getCurrentPriorityLevel,vg=jn.unstable_ImmediatePriority,GT=jn.unstable_UserBlockingPriority,ud=jn.unstable_NormalPriority,QR=jn.unstable_LowPriority,QT=jn.unstable_IdlePriority,dh=null,Cr=null;function YR(t){if(Cr&&typeof Cr.onCommitFiberRoot=="function")try{Cr.onCommitFiberRoot(dh,t,void 0,(t.current.flags&128)===128)}catch{}}var ir=Math.clz32?Math.clz32:ZR,XR=Math.log,JR=Math.LN2;function ZR(t){return t>>>=0,t===0?32:31-(XR(t)/JR|0)|0}var su=64,iu=4194304;function dl(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function dd(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,s=t.suspendedLanes,i=t.pingedLanes,o=n&268435455;if(o!==0){var a=o&~s;a!==0?r=dl(a):(i&=o,i!==0&&(r=dl(i)))}else o=n&~s,o!==0?r=dl(o):i!==0&&(r=dl(i));if(r===0)return 0;if(e!==0&&e!==r&&!(e&s)&&(s=r&-r,i=e&-e,s>=i||s===16&&(i&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-ir(e),s=1<<n,r|=t[n],e&=~s;return r}function e1(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function t1(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,s=t.expirationTimes,i=t.pendingLanes;0<i;){var o=31-ir(i),a=1<<o,l=s[o];l===-1?(!(a&n)||a&r)&&(s[o]=e1(a,e)):l<=e&&(t.expiredLanes|=a),i&=~a}}function Gp(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function YT(){var t=su;return su<<=1,!(su&4194240)&&(su=64),t}function Of(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function wc(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-ir(e),t[e]=n}function n1(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var s=31-ir(n),i=1<<s;e[s]=0,r[s]=-1,t[s]=-1,n&=~i}}function wg(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-ir(n),s=1<<r;s&e|t[r]&e&&(t[r]|=e),n&=~s}}var Je=0;function XT(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var JT,Eg,ZT,e0,t0,Qp=!1,ou=[],Ps=null,Ns=null,ks=null,ql=new Map,Hl=new Map,_s=[],r1="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function kv(t,e){switch(t){case"focusin":case"focusout":Ps=null;break;case"dragenter":case"dragleave":Ns=null;break;case"mouseover":case"mouseout":ks=null;break;case"pointerover":case"pointerout":ql.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Hl.delete(e.pointerId)}}function Qa(t,e,n,r,s,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[s]},e!==null&&(e=Ic(e),e!==null&&Eg(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function s1(t,e,n,r,s){switch(e){case"focusin":return Ps=Qa(Ps,t,e,n,r,s),!0;case"dragenter":return Ns=Qa(Ns,t,e,n,r,s),!0;case"mouseover":return ks=Qa(ks,t,e,n,r,s),!0;case"pointerover":var i=s.pointerId;return ql.set(i,Qa(ql.get(i)||null,t,e,n,r,s)),!0;case"gotpointercapture":return i=s.pointerId,Hl.set(i,Qa(Hl.get(i)||null,t,e,n,r,s)),!0}return!1}function n0(t){var e=Ii(t.target);if(e!==null){var n=to(e);if(n!==null){if(e=n.tag,e===13){if(e=qT(n),e!==null){t.blockedOn=e,t0(t.priority,function(){ZT(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Du(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=Yp(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);qp=r,n.target.dispatchEvent(r),qp=null}else return e=Ic(n),e!==null&&Eg(e),t.blockedOn=n,!1;e.shift()}return!0}function Dv(t,e,n){Du(t)&&n.delete(e)}function i1(){Qp=!1,Ps!==null&&Du(Ps)&&(Ps=null),Ns!==null&&Du(Ns)&&(Ns=null),ks!==null&&Du(ks)&&(ks=null),ql.forEach(Dv),Hl.forEach(Dv)}function Ya(t,e){t.blockedOn===e&&(t.blockedOn=null,Qp||(Qp=!0,jn.unstable_scheduleCallback(jn.unstable_NormalPriority,i1)))}function Wl(t){function e(s){return Ya(s,t)}if(0<ou.length){Ya(ou[0],t);for(var n=1;n<ou.length;n++){var r=ou[n];r.blockedOn===t&&(r.blockedOn=null)}}for(Ps!==null&&Ya(Ps,t),Ns!==null&&Ya(Ns,t),ks!==null&&Ya(ks,t),ql.forEach(e),Hl.forEach(e),n=0;n<_s.length;n++)r=_s[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<_s.length&&(n=_s[0],n.blockedOn===null);)n0(n),n.blockedOn===null&&_s.shift()}var Ho=ts.ReactCurrentBatchConfig,hd=!0;function o1(t,e,n,r){var s=Je,i=Ho.transition;Ho.transition=null;try{Je=1,Ig(t,e,n,r)}finally{Je=s,Ho.transition=i}}function a1(t,e,n,r){var s=Je,i=Ho.transition;Ho.transition=null;try{Je=4,Ig(t,e,n,r)}finally{Je=s,Ho.transition=i}}function Ig(t,e,n,r){if(hd){var s=Yp(t,e,n,r);if(s===null)Hf(t,e,r,fd,n),kv(t,r);else if(s1(s,t,e,n,r))r.stopPropagation();else if(kv(t,r),e&4&&-1<r1.indexOf(t)){for(;s!==null;){var i=Ic(s);if(i!==null&&JT(i),i=Yp(t,e,n,r),i===null&&Hf(t,e,r,fd,n),i===s)break;s=i}s!==null&&r.stopPropagation()}else Hf(t,e,r,null,n)}}var fd=null;function Yp(t,e,n,r){if(fd=null,t=_g(r),t=Ii(t),t!==null)if(e=to(t),e===null)t=null;else if(n=e.tag,n===13){if(t=qT(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return fd=t,null}function r0(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(GR()){case vg:return 1;case GT:return 4;case ud:case QR:return 16;case QT:return 536870912;default:return 16}default:return 16}}var Cs=null,Tg=null,ju=null;function s0(){if(ju)return ju;var t,e=Tg,n=e.length,r,s="value"in Cs?Cs.value:Cs.textContent,i=s.length;for(t=0;t<n&&e[t]===s[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===s[i-r];r++);return ju=s.slice(t,1<r?1-r:void 0)}function Ou(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function au(){return!0}function jv(){return!1}function Ln(t){function e(n,r,s,i,o){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(n=t[a],this[a]=n?n(i):i[a]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?au:jv,this.isPropagationStopped=jv,this}return _t(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=au)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=au)},persist:function(){},isPersistent:au}),e}var xa={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},xg=Ln(xa),Ec=_t({},xa,{view:0,detail:0}),l1=Ln(Ec),Vf,Lf,Xa,hh=_t({},Ec,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Sg,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Xa&&(Xa&&t.type==="mousemove"?(Vf=t.screenX-Xa.screenX,Lf=t.screenY-Xa.screenY):Lf=Vf=0,Xa=t),Vf)},movementY:function(t){return"movementY"in t?t.movementY:Lf}}),Ov=Ln(hh),c1=_t({},hh,{dataTransfer:0}),u1=Ln(c1),d1=_t({},Ec,{relatedTarget:0}),Mf=Ln(d1),h1=_t({},xa,{animationName:0,elapsedTime:0,pseudoElement:0}),f1=Ln(h1),p1=_t({},xa,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),m1=Ln(p1),g1=_t({},xa,{data:0}),Vv=Ln(g1),y1={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},_1={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},v1={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function w1(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=v1[t])?!!e[t]:!1}function Sg(){return w1}var E1=_t({},Ec,{key:function(t){if(t.key){var e=y1[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Ou(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?_1[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Sg,charCode:function(t){return t.type==="keypress"?Ou(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Ou(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),I1=Ln(E1),T1=_t({},hh,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Lv=Ln(T1),x1=_t({},Ec,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Sg}),S1=Ln(x1),b1=_t({},xa,{propertyName:0,elapsedTime:0,pseudoElement:0}),C1=Ln(b1),A1=_t({},hh,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),R1=Ln(A1),P1=[9,13,27,32],bg=Hr&&"CompositionEvent"in window,xl=null;Hr&&"documentMode"in document&&(xl=document.documentMode);var N1=Hr&&"TextEvent"in window&&!xl,i0=Hr&&(!bg||xl&&8<xl&&11>=xl),Mv=" ",Fv=!1;function o0(t,e){switch(t){case"keyup":return P1.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function a0(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var No=!1;function k1(t,e){switch(t){case"compositionend":return a0(e);case"keypress":return e.which!==32?null:(Fv=!0,Mv);case"textInput":return t=e.data,t===Mv&&Fv?null:t;default:return null}}function D1(t,e){if(No)return t==="compositionend"||!bg&&o0(t,e)?(t=s0(),ju=Tg=Cs=null,No=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return i0&&e.locale!=="ko"?null:e.data;default:return null}}var j1={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Uv(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!j1[t.type]:e==="textarea"}function l0(t,e,n,r){FT(r),e=pd(e,"onChange"),0<e.length&&(n=new xg("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var Sl=null,Kl=null;function O1(t){v0(t,0)}function fh(t){var e=jo(t);if(kT(e))return t}function V1(t,e){if(t==="change")return e}var c0=!1;if(Hr){var Ff;if(Hr){var Uf="oninput"in document;if(!Uf){var $v=document.createElement("div");$v.setAttribute("oninput","return;"),Uf=typeof $v.oninput=="function"}Ff=Uf}else Ff=!1;c0=Ff&&(!document.documentMode||9<document.documentMode)}function Bv(){Sl&&(Sl.detachEvent("onpropertychange",u0),Kl=Sl=null)}function u0(t){if(t.propertyName==="value"&&fh(Kl)){var e=[];l0(e,Kl,t,_g(t)),zT(O1,e)}}function L1(t,e,n){t==="focusin"?(Bv(),Sl=e,Kl=n,Sl.attachEvent("onpropertychange",u0)):t==="focusout"&&Bv()}function M1(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return fh(Kl)}function F1(t,e){if(t==="click")return fh(e)}function U1(t,e){if(t==="input"||t==="change")return fh(e)}function $1(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var lr=typeof Object.is=="function"?Object.is:$1;function Gl(t,e){if(lr(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!kp.call(e,s)||!lr(t[s],e[s]))return!1}return!0}function zv(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function qv(t,e){var n=zv(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=zv(n)}}function d0(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?d0(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function h0(){for(var t=window,e=ad();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=ad(t.document)}return e}function Cg(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function B1(t){var e=h0(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&d0(n.ownerDocument.documentElement,n)){if(r!==null&&Cg(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=n.textContent.length,i=Math.min(r.start,s);r=r.end===void 0?i:Math.min(r.end,s),!t.extend&&i>r&&(s=r,r=i,i=s),s=qv(n,i);var o=qv(n,r);s&&o&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),i>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var z1=Hr&&"documentMode"in document&&11>=document.documentMode,ko=null,Xp=null,bl=null,Jp=!1;function Hv(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Jp||ko==null||ko!==ad(r)||(r=ko,"selectionStart"in r&&Cg(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),bl&&Gl(bl,r)||(bl=r,r=pd(Xp,"onSelect"),0<r.length&&(e=new xg("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=ko)))}function lu(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Do={animationend:lu("Animation","AnimationEnd"),animationiteration:lu("Animation","AnimationIteration"),animationstart:lu("Animation","AnimationStart"),transitionend:lu("Transition","TransitionEnd")},$f={},f0={};Hr&&(f0=document.createElement("div").style,"AnimationEvent"in window||(delete Do.animationend.animation,delete Do.animationiteration.animation,delete Do.animationstart.animation),"TransitionEvent"in window||delete Do.transitionend.transition);function ph(t){if($f[t])return $f[t];if(!Do[t])return t;var e=Do[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in f0)return $f[t]=e[n];return t}var p0=ph("animationend"),m0=ph("animationiteration"),g0=ph("animationstart"),y0=ph("transitionend"),_0=new Map,Wv="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Xs(t,e){_0.set(t,e),eo(e,[t])}for(var Bf=0;Bf<Wv.length;Bf++){var zf=Wv[Bf],q1=zf.toLowerCase(),H1=zf[0].toUpperCase()+zf.slice(1);Xs(q1,"on"+H1)}Xs(p0,"onAnimationEnd");Xs(m0,"onAnimationIteration");Xs(g0,"onAnimationStart");Xs("dblclick","onDoubleClick");Xs("focusin","onFocus");Xs("focusout","onBlur");Xs(y0,"onTransitionEnd");na("onMouseEnter",["mouseout","mouseover"]);na("onMouseLeave",["mouseout","mouseover"]);na("onPointerEnter",["pointerout","pointerover"]);na("onPointerLeave",["pointerout","pointerover"]);eo("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));eo("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));eo("onBeforeInput",["compositionend","keypress","textInput","paste"]);eo("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));eo("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));eo("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var hl="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),W1=new Set("cancel close invalid load scroll toggle".split(" ").concat(hl));function Kv(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,qR(r,e,void 0,t),t.currentTarget=null}function v0(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],s=r.event;r=r.listeners;e:{var i=void 0;if(e)for(var o=r.length-1;0<=o;o--){var a=r[o],l=a.instance,d=a.currentTarget;if(a=a.listener,l!==i&&s.isPropagationStopped())break e;Kv(s,a,d),i=l}else for(o=0;o<r.length;o++){if(a=r[o],l=a.instance,d=a.currentTarget,a=a.listener,l!==i&&s.isPropagationStopped())break e;Kv(s,a,d),i=l}}}if(cd)throw t=Kp,cd=!1,Kp=null,t}function at(t,e){var n=e[rm];n===void 0&&(n=e[rm]=new Set);var r=t+"__bubble";n.has(r)||(w0(e,t,2,!1),n.add(r))}function qf(t,e,n){var r=0;e&&(r|=4),w0(n,t,r,e)}var cu="_reactListening"+Math.random().toString(36).slice(2);function Ql(t){if(!t[cu]){t[cu]=!0,CT.forEach(function(n){n!=="selectionchange"&&(W1.has(n)||qf(n,!1,t),qf(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[cu]||(e[cu]=!0,qf("selectionchange",!1,e))}}function w0(t,e,n,r){switch(r0(e)){case 1:var s=o1;break;case 4:s=a1;break;default:s=Ig}n=s.bind(null,e,n,t),s=void 0,!Wp||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),r?s!==void 0?t.addEventListener(e,n,{capture:!0,passive:s}):t.addEventListener(e,n,!0):s!==void 0?t.addEventListener(e,n,{passive:s}):t.addEventListener(e,n,!1)}function Hf(t,e,n,r,s){var i=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var a=r.stateNode.containerInfo;if(a===s||a.nodeType===8&&a.parentNode===s)break;if(o===4)for(o=r.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===s||l.nodeType===8&&l.parentNode===s))return;o=o.return}for(;a!==null;){if(o=Ii(a),o===null)return;if(l=o.tag,l===5||l===6){r=i=o;continue e}a=a.parentNode}}r=r.return}zT(function(){var d=i,h=_g(n),f=[];e:{var m=_0.get(t);if(m!==void 0){var w=xg,R=t;switch(t){case"keypress":if(Ou(n)===0)break e;case"keydown":case"keyup":w=I1;break;case"focusin":R="focus",w=Mf;break;case"focusout":R="blur",w=Mf;break;case"beforeblur":case"afterblur":w=Mf;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":w=Ov;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":w=u1;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":w=S1;break;case p0:case m0:case g0:w=f1;break;case y0:w=C1;break;case"scroll":w=l1;break;case"wheel":w=R1;break;case"copy":case"cut":case"paste":w=m1;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":w=Lv}var b=(e&4)!==0,A=!b&&t==="scroll",T=b?m!==null?m+"Capture":null:m;b=[];for(var E=d,y;E!==null;){y=E;var j=y.stateNode;if(y.tag===5&&j!==null&&(y=j,T!==null&&(j=zl(E,T),j!=null&&b.push(Yl(E,j,y)))),A)break;E=E.return}0<b.length&&(m=new w(m,R,null,n,h),f.push({event:m,listeners:b}))}}if(!(e&7)){e:{if(m=t==="mouseover"||t==="pointerover",w=t==="mouseout"||t==="pointerout",m&&n!==qp&&(R=n.relatedTarget||n.fromElement)&&(Ii(R)||R[Wr]))break e;if((w||m)&&(m=h.window===h?h:(m=h.ownerDocument)?m.defaultView||m.parentWindow:window,w?(R=n.relatedTarget||n.toElement,w=d,R=R?Ii(R):null,R!==null&&(A=to(R),R!==A||R.tag!==5&&R.tag!==6)&&(R=null)):(w=null,R=d),w!==R)){if(b=Ov,j="onMouseLeave",T="onMouseEnter",E="mouse",(t==="pointerout"||t==="pointerover")&&(b=Lv,j="onPointerLeave",T="onPointerEnter",E="pointer"),A=w==null?m:jo(w),y=R==null?m:jo(R),m=new b(j,E+"leave",w,n,h),m.target=A,m.relatedTarget=y,j=null,Ii(h)===d&&(b=new b(T,E+"enter",R,n,h),b.target=y,b.relatedTarget=A,j=b),A=j,w&&R)t:{for(b=w,T=R,E=0,y=b;y;y=uo(y))E++;for(y=0,j=T;j;j=uo(j))y++;for(;0<E-y;)b=uo(b),E--;for(;0<y-E;)T=uo(T),y--;for(;E--;){if(b===T||T!==null&&b===T.alternate)break t;b=uo(b),T=uo(T)}b=null}else b=null;w!==null&&Gv(f,m,w,b,!1),R!==null&&A!==null&&Gv(f,A,R,b,!0)}}e:{if(m=d?jo(d):window,w=m.nodeName&&m.nodeName.toLowerCase(),w==="select"||w==="input"&&m.type==="file")var V=V1;else if(Uv(m))if(c0)V=U1;else{V=M1;var M=L1}else(w=m.nodeName)&&w.toLowerCase()==="input"&&(m.type==="checkbox"||m.type==="radio")&&(V=F1);if(V&&(V=V(t,d))){l0(f,V,n,h);break e}M&&M(t,m,d),t==="focusout"&&(M=m._wrapperState)&&M.controlled&&m.type==="number"&&Fp(m,"number",m.value)}switch(M=d?jo(d):window,t){case"focusin":(Uv(M)||M.contentEditable==="true")&&(ko=M,Xp=d,bl=null);break;case"focusout":bl=Xp=ko=null;break;case"mousedown":Jp=!0;break;case"contextmenu":case"mouseup":case"dragend":Jp=!1,Hv(f,n,h);break;case"selectionchange":if(z1)break;case"keydown":case"keyup":Hv(f,n,h)}var x;if(bg)e:{switch(t){case"compositionstart":var _="onCompositionStart";break e;case"compositionend":_="onCompositionEnd";break e;case"compositionupdate":_="onCompositionUpdate";break e}_=void 0}else No?o0(t,n)&&(_="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(_="onCompositionStart");_&&(i0&&n.locale!=="ko"&&(No||_!=="onCompositionStart"?_==="onCompositionEnd"&&No&&(x=s0()):(Cs=h,Tg="value"in Cs?Cs.value:Cs.textContent,No=!0)),M=pd(d,_),0<M.length&&(_=new Vv(_,t,null,n,h),f.push({event:_,listeners:M}),x?_.data=x:(x=a0(n),x!==null&&(_.data=x)))),(x=N1?k1(t,n):D1(t,n))&&(d=pd(d,"onBeforeInput"),0<d.length&&(h=new Vv("onBeforeInput","beforeinput",null,n,h),f.push({event:h,listeners:d}),h.data=x))}v0(f,e)})}function Yl(t,e,n){return{instance:t,listener:e,currentTarget:n}}function pd(t,e){for(var n=e+"Capture",r=[];t!==null;){var s=t,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=zl(t,n),i!=null&&r.unshift(Yl(t,i,s)),i=zl(t,e),i!=null&&r.push(Yl(t,i,s))),t=t.return}return r}function uo(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function Gv(t,e,n,r,s){for(var i=e._reactName,o=[];n!==null&&n!==r;){var a=n,l=a.alternate,d=a.stateNode;if(l!==null&&l===r)break;a.tag===5&&d!==null&&(a=d,s?(l=zl(n,i),l!=null&&o.unshift(Yl(n,l,a))):s||(l=zl(n,i),l!=null&&o.push(Yl(n,l,a)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var K1=/\r\n?/g,G1=/\u0000|\uFFFD/g;function Qv(t){return(typeof t=="string"?t:""+t).replace(K1,`
`).replace(G1,"")}function uu(t,e,n){if(e=Qv(e),Qv(t)!==e&&n)throw Error(K(425))}function md(){}var Zp=null,em=null;function tm(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var nm=typeof setTimeout=="function"?setTimeout:void 0,Q1=typeof clearTimeout=="function"?clearTimeout:void 0,Yv=typeof Promise=="function"?Promise:void 0,Y1=typeof queueMicrotask=="function"?queueMicrotask:typeof Yv<"u"?function(t){return Yv.resolve(null).then(t).catch(X1)}:nm;function X1(t){setTimeout(function(){throw t})}function Wf(t,e){var n=e,r=0;do{var s=n.nextSibling;if(t.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){t.removeChild(s),Wl(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);Wl(e)}function Ds(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function Xv(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var Sa=Math.random().toString(36).slice(2),Tr="__reactFiber$"+Sa,Xl="__reactProps$"+Sa,Wr="__reactContainer$"+Sa,rm="__reactEvents$"+Sa,J1="__reactListeners$"+Sa,Z1="__reactHandles$"+Sa;function Ii(t){var e=t[Tr];if(e)return e;for(var n=t.parentNode;n;){if(e=n[Wr]||n[Tr]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=Xv(t);t!==null;){if(n=t[Tr])return n;t=Xv(t)}return e}t=n,n=t.parentNode}return null}function Ic(t){return t=t[Tr]||t[Wr],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function jo(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(K(33))}function mh(t){return t[Xl]||null}var sm=[],Oo=-1;function Js(t){return{current:t}}function lt(t){0>Oo||(t.current=sm[Oo],sm[Oo]=null,Oo--)}function st(t,e){Oo++,sm[Oo]=t.current,t.current=e}var Hs={},ln=Js(Hs),In=Js(!1),Oi=Hs;function ra(t,e){var n=t.type.contextTypes;if(!n)return Hs;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in n)s[i]=e[i];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function Tn(t){return t=t.childContextTypes,t!=null}function gd(){lt(In),lt(ln)}function Jv(t,e,n){if(ln.current!==Hs)throw Error(K(168));st(ln,e),st(In,n)}function E0(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in e))throw Error(K(108,LR(t)||"Unknown",s));return _t({},n,r)}function yd(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Hs,Oi=ln.current,st(ln,t),st(In,In.current),!0}function Zv(t,e,n){var r=t.stateNode;if(!r)throw Error(K(169));n?(t=E0(t,e,Oi),r.__reactInternalMemoizedMergedChildContext=t,lt(In),lt(ln),st(ln,t)):lt(In),st(In,n)}var Lr=null,gh=!1,Kf=!1;function I0(t){Lr===null?Lr=[t]:Lr.push(t)}function eP(t){gh=!0,I0(t)}function Zs(){if(!Kf&&Lr!==null){Kf=!0;var t=0,e=Je;try{var n=Lr;for(Je=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}Lr=null,gh=!1}catch(s){throw Lr!==null&&(Lr=Lr.slice(t+1)),KT(vg,Zs),s}finally{Je=e,Kf=!1}}return null}var Vo=[],Lo=0,_d=null,vd=0,Fn=[],Un=0,Vi=null,Mr=1,Fr="";function hi(t,e){Vo[Lo++]=vd,Vo[Lo++]=_d,_d=t,vd=e}function T0(t,e,n){Fn[Un++]=Mr,Fn[Un++]=Fr,Fn[Un++]=Vi,Vi=t;var r=Mr;t=Fr;var s=32-ir(r)-1;r&=~(1<<s),n+=1;var i=32-ir(e)+s;if(30<i){var o=s-s%5;i=(r&(1<<o)-1).toString(32),r>>=o,s-=o,Mr=1<<32-ir(e)+s|n<<s|r,Fr=i+t}else Mr=1<<i|n<<s|r,Fr=t}function Ag(t){t.return!==null&&(hi(t,1),T0(t,1,0))}function Rg(t){for(;t===_d;)_d=Vo[--Lo],Vo[Lo]=null,vd=Vo[--Lo],Vo[Lo]=null;for(;t===Vi;)Vi=Fn[--Un],Fn[Un]=null,Fr=Fn[--Un],Fn[Un]=null,Mr=Fn[--Un],Fn[Un]=null}var kn=null,Pn=null,ut=!1,nr=null;function x0(t,e){var n=zn(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function ew(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,kn=t,Pn=Ds(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,kn=t,Pn=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=Vi!==null?{id:Mr,overflow:Fr}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=zn(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,kn=t,Pn=null,!0):!1;default:return!1}}function im(t){return(t.mode&1)!==0&&(t.flags&128)===0}function om(t){if(ut){var e=Pn;if(e){var n=e;if(!ew(t,e)){if(im(t))throw Error(K(418));e=Ds(n.nextSibling);var r=kn;e&&ew(t,e)?x0(r,n):(t.flags=t.flags&-4097|2,ut=!1,kn=t)}}else{if(im(t))throw Error(K(418));t.flags=t.flags&-4097|2,ut=!1,kn=t}}}function tw(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;kn=t}function du(t){if(t!==kn)return!1;if(!ut)return tw(t),ut=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!tm(t.type,t.memoizedProps)),e&&(e=Pn)){if(im(t))throw S0(),Error(K(418));for(;e;)x0(t,e),e=Ds(e.nextSibling)}if(tw(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(K(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){Pn=Ds(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}Pn=null}}else Pn=kn?Ds(t.stateNode.nextSibling):null;return!0}function S0(){for(var t=Pn;t;)t=Ds(t.nextSibling)}function sa(){Pn=kn=null,ut=!1}function Pg(t){nr===null?nr=[t]:nr.push(t)}var tP=ts.ReactCurrentBatchConfig;function Ja(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(K(309));var r=n.stateNode}if(!r)throw Error(K(147,t));var s=r,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(o){var a=s.refs;o===null?delete a[i]:a[i]=o},e._stringRef=i,e)}if(typeof t!="string")throw Error(K(284));if(!n._owner)throw Error(K(290,t))}return t}function hu(t,e){throw t=Object.prototype.toString.call(e),Error(K(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function nw(t){var e=t._init;return e(t._payload)}function b0(t){function e(T,E){if(t){var y=T.deletions;y===null?(T.deletions=[E],T.flags|=16):y.push(E)}}function n(T,E){if(!t)return null;for(;E!==null;)e(T,E),E=E.sibling;return null}function r(T,E){for(T=new Map;E!==null;)E.key!==null?T.set(E.key,E):T.set(E.index,E),E=E.sibling;return T}function s(T,E){return T=Ls(T,E),T.index=0,T.sibling=null,T}function i(T,E,y){return T.index=y,t?(y=T.alternate,y!==null?(y=y.index,y<E?(T.flags|=2,E):y):(T.flags|=2,E)):(T.flags|=1048576,E)}function o(T){return t&&T.alternate===null&&(T.flags|=2),T}function a(T,E,y,j){return E===null||E.tag!==6?(E=ep(y,T.mode,j),E.return=T,E):(E=s(E,y),E.return=T,E)}function l(T,E,y,j){var V=y.type;return V===Po?h(T,E,y.props.children,j,y.key):E!==null&&(E.elementType===V||typeof V=="object"&&V!==null&&V.$$typeof===gs&&nw(V)===E.type)?(j=s(E,y.props),j.ref=Ja(T,E,y),j.return=T,j):(j=Bu(y.type,y.key,y.props,null,T.mode,j),j.ref=Ja(T,E,y),j.return=T,j)}function d(T,E,y,j){return E===null||E.tag!==4||E.stateNode.containerInfo!==y.containerInfo||E.stateNode.implementation!==y.implementation?(E=tp(y,T.mode,j),E.return=T,E):(E=s(E,y.children||[]),E.return=T,E)}function h(T,E,y,j,V){return E===null||E.tag!==7?(E=Ai(y,T.mode,j,V),E.return=T,E):(E=s(E,y),E.return=T,E)}function f(T,E,y){if(typeof E=="string"&&E!==""||typeof E=="number")return E=ep(""+E,T.mode,y),E.return=T,E;if(typeof E=="object"&&E!==null){switch(E.$$typeof){case tu:return y=Bu(E.type,E.key,E.props,null,T.mode,y),y.ref=Ja(T,null,E),y.return=T,y;case Ro:return E=tp(E,T.mode,y),E.return=T,E;case gs:var j=E._init;return f(T,j(E._payload),y)}if(ul(E)||Ka(E))return E=Ai(E,T.mode,y,null),E.return=T,E;hu(T,E)}return null}function m(T,E,y,j){var V=E!==null?E.key:null;if(typeof y=="string"&&y!==""||typeof y=="number")return V!==null?null:a(T,E,""+y,j);if(typeof y=="object"&&y!==null){switch(y.$$typeof){case tu:return y.key===V?l(T,E,y,j):null;case Ro:return y.key===V?d(T,E,y,j):null;case gs:return V=y._init,m(T,E,V(y._payload),j)}if(ul(y)||Ka(y))return V!==null?null:h(T,E,y,j,null);hu(T,y)}return null}function w(T,E,y,j,V){if(typeof j=="string"&&j!==""||typeof j=="number")return T=T.get(y)||null,a(E,T,""+j,V);if(typeof j=="object"&&j!==null){switch(j.$$typeof){case tu:return T=T.get(j.key===null?y:j.key)||null,l(E,T,j,V);case Ro:return T=T.get(j.key===null?y:j.key)||null,d(E,T,j,V);case gs:var M=j._init;return w(T,E,y,M(j._payload),V)}if(ul(j)||Ka(j))return T=T.get(y)||null,h(E,T,j,V,null);hu(E,j)}return null}function R(T,E,y,j){for(var V=null,M=null,x=E,_=E=0,S=null;x!==null&&_<y.length;_++){x.index>_?(S=x,x=null):S=x.sibling;var C=m(T,x,y[_],j);if(C===null){x===null&&(x=S);break}t&&x&&C.alternate===null&&e(T,x),E=i(C,E,_),M===null?V=C:M.sibling=C,M=C,x=S}if(_===y.length)return n(T,x),ut&&hi(T,_),V;if(x===null){for(;_<y.length;_++)x=f(T,y[_],j),x!==null&&(E=i(x,E,_),M===null?V=x:M.sibling=x,M=x);return ut&&hi(T,_),V}for(x=r(T,x);_<y.length;_++)S=w(x,T,_,y[_],j),S!==null&&(t&&S.alternate!==null&&x.delete(S.key===null?_:S.key),E=i(S,E,_),M===null?V=S:M.sibling=S,M=S);return t&&x.forEach(function(k){return e(T,k)}),ut&&hi(T,_),V}function b(T,E,y,j){var V=Ka(y);if(typeof V!="function")throw Error(K(150));if(y=V.call(y),y==null)throw Error(K(151));for(var M=V=null,x=E,_=E=0,S=null,C=y.next();x!==null&&!C.done;_++,C=y.next()){x.index>_?(S=x,x=null):S=x.sibling;var k=m(T,x,C.value,j);if(k===null){x===null&&(x=S);break}t&&x&&k.alternate===null&&e(T,x),E=i(k,E,_),M===null?V=k:M.sibling=k,M=k,x=S}if(C.done)return n(T,x),ut&&hi(T,_),V;if(x===null){for(;!C.done;_++,C=y.next())C=f(T,C.value,j),C!==null&&(E=i(C,E,_),M===null?V=C:M.sibling=C,M=C);return ut&&hi(T,_),V}for(x=r(T,x);!C.done;_++,C=y.next())C=w(x,T,_,C.value,j),C!==null&&(t&&C.alternate!==null&&x.delete(C.key===null?_:C.key),E=i(C,E,_),M===null?V=C:M.sibling=C,M=C);return t&&x.forEach(function(D){return e(T,D)}),ut&&hi(T,_),V}function A(T,E,y,j){if(typeof y=="object"&&y!==null&&y.type===Po&&y.key===null&&(y=y.props.children),typeof y=="object"&&y!==null){switch(y.$$typeof){case tu:e:{for(var V=y.key,M=E;M!==null;){if(M.key===V){if(V=y.type,V===Po){if(M.tag===7){n(T,M.sibling),E=s(M,y.props.children),E.return=T,T=E;break e}}else if(M.elementType===V||typeof V=="object"&&V!==null&&V.$$typeof===gs&&nw(V)===M.type){n(T,M.sibling),E=s(M,y.props),E.ref=Ja(T,M,y),E.return=T,T=E;break e}n(T,M);break}else e(T,M);M=M.sibling}y.type===Po?(E=Ai(y.props.children,T.mode,j,y.key),E.return=T,T=E):(j=Bu(y.type,y.key,y.props,null,T.mode,j),j.ref=Ja(T,E,y),j.return=T,T=j)}return o(T);case Ro:e:{for(M=y.key;E!==null;){if(E.key===M)if(E.tag===4&&E.stateNode.containerInfo===y.containerInfo&&E.stateNode.implementation===y.implementation){n(T,E.sibling),E=s(E,y.children||[]),E.return=T,T=E;break e}else{n(T,E);break}else e(T,E);E=E.sibling}E=tp(y,T.mode,j),E.return=T,T=E}return o(T);case gs:return M=y._init,A(T,E,M(y._payload),j)}if(ul(y))return R(T,E,y,j);if(Ka(y))return b(T,E,y,j);hu(T,y)}return typeof y=="string"&&y!==""||typeof y=="number"?(y=""+y,E!==null&&E.tag===6?(n(T,E.sibling),E=s(E,y),E.return=T,T=E):(n(T,E),E=ep(y,T.mode,j),E.return=T,T=E),o(T)):n(T,E)}return A}var ia=b0(!0),C0=b0(!1),wd=Js(null),Ed=null,Mo=null,Ng=null;function kg(){Ng=Mo=Ed=null}function Dg(t){var e=wd.current;lt(wd),t._currentValue=e}function am(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function Wo(t,e){Ed=t,Ng=Mo=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(wn=!0),t.firstContext=null)}function Kn(t){var e=t._currentValue;if(Ng!==t)if(t={context:t,memoizedValue:e,next:null},Mo===null){if(Ed===null)throw Error(K(308));Mo=t,Ed.dependencies={lanes:0,firstContext:t}}else Mo=Mo.next=t;return e}var Ti=null;function jg(t){Ti===null?Ti=[t]:Ti.push(t)}function A0(t,e,n,r){var s=e.interleaved;return s===null?(n.next=n,jg(e)):(n.next=s.next,s.next=n),e.interleaved=n,Kr(t,r)}function Kr(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var ys=!1;function Og(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function R0(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function zr(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function js(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,ze&2){var s=r.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),r.pending=e,Kr(t,n)}return s=r.interleaved,s===null?(e.next=e,jg(r)):(e.next=s.next,s.next=e),r.interleaved=e,Kr(t,n)}function Vu(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,wg(t,n)}}function rw(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?s=i=o:i=i.next=o,n=n.next}while(n!==null);i===null?s=i=e:i=i.next=e}else s=i=e;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function Id(t,e,n,r){var s=t.updateQueue;ys=!1;var i=s.firstBaseUpdate,o=s.lastBaseUpdate,a=s.shared.pending;if(a!==null){s.shared.pending=null;var l=a,d=l.next;l.next=null,o===null?i=d:o.next=d,o=l;var h=t.alternate;h!==null&&(h=h.updateQueue,a=h.lastBaseUpdate,a!==o&&(a===null?h.firstBaseUpdate=d:a.next=d,h.lastBaseUpdate=l))}if(i!==null){var f=s.baseState;o=0,h=d=l=null,a=i;do{var m=a.lane,w=a.eventTime;if((r&m)===m){h!==null&&(h=h.next={eventTime:w,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var R=t,b=a;switch(m=e,w=n,b.tag){case 1:if(R=b.payload,typeof R=="function"){f=R.call(w,f,m);break e}f=R;break e;case 3:R.flags=R.flags&-65537|128;case 0:if(R=b.payload,m=typeof R=="function"?R.call(w,f,m):R,m==null)break e;f=_t({},f,m);break e;case 2:ys=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,m=s.effects,m===null?s.effects=[a]:m.push(a))}else w={eventTime:w,lane:m,tag:a.tag,payload:a.payload,callback:a.callback,next:null},h===null?(d=h=w,l=f):h=h.next=w,o|=m;if(a=a.next,a===null){if(a=s.shared.pending,a===null)break;m=a,a=m.next,m.next=null,s.lastBaseUpdate=m,s.shared.pending=null}}while(!0);if(h===null&&(l=f),s.baseState=l,s.firstBaseUpdate=d,s.lastBaseUpdate=h,e=s.shared.interleaved,e!==null){s=e;do o|=s.lane,s=s.next;while(s!==e)}else i===null&&(s.shared.lanes=0);Mi|=o,t.lanes=o,t.memoizedState=f}}function sw(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(K(191,s));s.call(r)}}}var Tc={},Ar=Js(Tc),Jl=Js(Tc),Zl=Js(Tc);function xi(t){if(t===Tc)throw Error(K(174));return t}function Vg(t,e){switch(st(Zl,e),st(Jl,t),st(Ar,Tc),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:$p(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=$p(e,t)}lt(Ar),st(Ar,e)}function oa(){lt(Ar),lt(Jl),lt(Zl)}function P0(t){xi(Zl.current);var e=xi(Ar.current),n=$p(e,t.type);e!==n&&(st(Jl,t),st(Ar,n))}function Lg(t){Jl.current===t&&(lt(Ar),lt(Jl))}var mt=Js(0);function Td(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Gf=[];function Mg(){for(var t=0;t<Gf.length;t++)Gf[t]._workInProgressVersionPrimary=null;Gf.length=0}var Lu=ts.ReactCurrentDispatcher,Qf=ts.ReactCurrentBatchConfig,Li=0,yt=null,Dt=null,$t=null,xd=!1,Cl=!1,ec=0,nP=0;function Jt(){throw Error(K(321))}function Fg(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!lr(t[n],e[n]))return!1;return!0}function Ug(t,e,n,r,s,i){if(Li=i,yt=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Lu.current=t===null||t.memoizedState===null?oP:aP,t=n(r,s),Cl){i=0;do{if(Cl=!1,ec=0,25<=i)throw Error(K(301));i+=1,$t=Dt=null,e.updateQueue=null,Lu.current=lP,t=n(r,s)}while(Cl)}if(Lu.current=Sd,e=Dt!==null&&Dt.next!==null,Li=0,$t=Dt=yt=null,xd=!1,e)throw Error(K(300));return t}function $g(){var t=ec!==0;return ec=0,t}function Er(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return $t===null?yt.memoizedState=$t=t:$t=$t.next=t,$t}function Gn(){if(Dt===null){var t=yt.alternate;t=t!==null?t.memoizedState:null}else t=Dt.next;var e=$t===null?yt.memoizedState:$t.next;if(e!==null)$t=e,Dt=t;else{if(t===null)throw Error(K(310));Dt=t,t={memoizedState:Dt.memoizedState,baseState:Dt.baseState,baseQueue:Dt.baseQueue,queue:Dt.queue,next:null},$t===null?yt.memoizedState=$t=t:$t=$t.next=t}return $t}function tc(t,e){return typeof e=="function"?e(t):e}function Yf(t){var e=Gn(),n=e.queue;if(n===null)throw Error(K(311));n.lastRenderedReducer=t;var r=Dt,s=r.baseQueue,i=n.pending;if(i!==null){if(s!==null){var o=s.next;s.next=i.next,i.next=o}r.baseQueue=s=i,n.pending=null}if(s!==null){i=s.next,r=r.baseState;var a=o=null,l=null,d=i;do{var h=d.lane;if((Li&h)===h)l!==null&&(l=l.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),r=d.hasEagerState?d.eagerState:t(r,d.action);else{var f={lane:h,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};l===null?(a=l=f,o=r):l=l.next=f,yt.lanes|=h,Mi|=h}d=d.next}while(d!==null&&d!==i);l===null?o=r:l.next=a,lr(r,e.memoizedState)||(wn=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=l,n.lastRenderedState=r}if(t=n.interleaved,t!==null){s=t;do i=s.lane,yt.lanes|=i,Mi|=i,s=s.next;while(s!==t)}else s===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function Xf(t){var e=Gn(),n=e.queue;if(n===null)throw Error(K(311));n.lastRenderedReducer=t;var r=n.dispatch,s=n.pending,i=e.memoizedState;if(s!==null){n.pending=null;var o=s=s.next;do i=t(i,o.action),o=o.next;while(o!==s);lr(i,e.memoizedState)||(wn=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),n.lastRenderedState=i}return[i,r]}function N0(){}function k0(t,e){var n=yt,r=Gn(),s=e(),i=!lr(r.memoizedState,s);if(i&&(r.memoizedState=s,wn=!0),r=r.queue,Bg(O0.bind(null,n,r,t),[t]),r.getSnapshot!==e||i||$t!==null&&$t.memoizedState.tag&1){if(n.flags|=2048,nc(9,j0.bind(null,n,r,s,e),void 0,null),Bt===null)throw Error(K(349));Li&30||D0(n,e,s)}return s}function D0(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=yt.updateQueue,e===null?(e={lastEffect:null,stores:null},yt.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function j0(t,e,n,r){e.value=n,e.getSnapshot=r,V0(e)&&L0(t)}function O0(t,e,n){return n(function(){V0(e)&&L0(t)})}function V0(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!lr(t,n)}catch{return!0}}function L0(t){var e=Kr(t,1);e!==null&&or(e,t,1,-1)}function iw(t){var e=Er();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:tc,lastRenderedState:t},e.queue=t,t=t.dispatch=iP.bind(null,yt,t),[e.memoizedState,t]}function nc(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=yt.updateQueue,e===null?(e={lastEffect:null,stores:null},yt.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function M0(){return Gn().memoizedState}function Mu(t,e,n,r){var s=Er();yt.flags|=t,s.memoizedState=nc(1|e,n,void 0,r===void 0?null:r)}function yh(t,e,n,r){var s=Gn();r=r===void 0?null:r;var i=void 0;if(Dt!==null){var o=Dt.memoizedState;if(i=o.destroy,r!==null&&Fg(r,o.deps)){s.memoizedState=nc(e,n,i,r);return}}yt.flags|=t,s.memoizedState=nc(1|e,n,i,r)}function ow(t,e){return Mu(8390656,8,t,e)}function Bg(t,e){return yh(2048,8,t,e)}function F0(t,e){return yh(4,2,t,e)}function U0(t,e){return yh(4,4,t,e)}function $0(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function B0(t,e,n){return n=n!=null?n.concat([t]):null,yh(4,4,$0.bind(null,e,t),n)}function zg(){}function z0(t,e){var n=Gn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Fg(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function q0(t,e){var n=Gn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Fg(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function H0(t,e,n){return Li&21?(lr(n,e)||(n=YT(),yt.lanes|=n,Mi|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,wn=!0),t.memoizedState=n)}function rP(t,e){var n=Je;Je=n!==0&&4>n?n:4,t(!0);var r=Qf.transition;Qf.transition={};try{t(!1),e()}finally{Je=n,Qf.transition=r}}function W0(){return Gn().memoizedState}function sP(t,e,n){var r=Vs(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},K0(t))G0(e,n);else if(n=A0(t,e,n,r),n!==null){var s=fn();or(n,t,r,s),Q0(n,e,r)}}function iP(t,e,n){var r=Vs(t),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(K0(t))G0(e,s);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var o=e.lastRenderedState,a=i(o,n);if(s.hasEagerState=!0,s.eagerState=a,lr(a,o)){var l=e.interleaved;l===null?(s.next=s,jg(e)):(s.next=l.next,l.next=s),e.interleaved=s;return}}catch{}finally{}n=A0(t,e,s,r),n!==null&&(s=fn(),or(n,t,r,s),Q0(n,e,r))}}function K0(t){var e=t.alternate;return t===yt||e!==null&&e===yt}function G0(t,e){Cl=xd=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function Q0(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,wg(t,n)}}var Sd={readContext:Kn,useCallback:Jt,useContext:Jt,useEffect:Jt,useImperativeHandle:Jt,useInsertionEffect:Jt,useLayoutEffect:Jt,useMemo:Jt,useReducer:Jt,useRef:Jt,useState:Jt,useDebugValue:Jt,useDeferredValue:Jt,useTransition:Jt,useMutableSource:Jt,useSyncExternalStore:Jt,useId:Jt,unstable_isNewReconciler:!1},oP={readContext:Kn,useCallback:function(t,e){return Er().memoizedState=[t,e===void 0?null:e],t},useContext:Kn,useEffect:ow,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,Mu(4194308,4,$0.bind(null,e,t),n)},useLayoutEffect:function(t,e){return Mu(4194308,4,t,e)},useInsertionEffect:function(t,e){return Mu(4,2,t,e)},useMemo:function(t,e){var n=Er();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=Er();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=sP.bind(null,yt,t),[r.memoizedState,t]},useRef:function(t){var e=Er();return t={current:t},e.memoizedState=t},useState:iw,useDebugValue:zg,useDeferredValue:function(t){return Er().memoizedState=t},useTransition:function(){var t=iw(!1),e=t[0];return t=rP.bind(null,t[1]),Er().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=yt,s=Er();if(ut){if(n===void 0)throw Error(K(407));n=n()}else{if(n=e(),Bt===null)throw Error(K(349));Li&30||D0(r,e,n)}s.memoizedState=n;var i={value:n,getSnapshot:e};return s.queue=i,ow(O0.bind(null,r,i,t),[t]),r.flags|=2048,nc(9,j0.bind(null,r,i,n,e),void 0,null),n},useId:function(){var t=Er(),e=Bt.identifierPrefix;if(ut){var n=Fr,r=Mr;n=(r&~(1<<32-ir(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=ec++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=nP++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},aP={readContext:Kn,useCallback:z0,useContext:Kn,useEffect:Bg,useImperativeHandle:B0,useInsertionEffect:F0,useLayoutEffect:U0,useMemo:q0,useReducer:Yf,useRef:M0,useState:function(){return Yf(tc)},useDebugValue:zg,useDeferredValue:function(t){var e=Gn();return H0(e,Dt.memoizedState,t)},useTransition:function(){var t=Yf(tc)[0],e=Gn().memoizedState;return[t,e]},useMutableSource:N0,useSyncExternalStore:k0,useId:W0,unstable_isNewReconciler:!1},lP={readContext:Kn,useCallback:z0,useContext:Kn,useEffect:Bg,useImperativeHandle:B0,useInsertionEffect:F0,useLayoutEffect:U0,useMemo:q0,useReducer:Xf,useRef:M0,useState:function(){return Xf(tc)},useDebugValue:zg,useDeferredValue:function(t){var e=Gn();return Dt===null?e.memoizedState=t:H0(e,Dt.memoizedState,t)},useTransition:function(){var t=Xf(tc)[0],e=Gn().memoizedState;return[t,e]},useMutableSource:N0,useSyncExternalStore:k0,useId:W0,unstable_isNewReconciler:!1};function Zn(t,e){if(t&&t.defaultProps){e=_t({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function lm(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:_t({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var _h={isMounted:function(t){return(t=t._reactInternals)?to(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=fn(),s=Vs(t),i=zr(r,s);i.payload=e,n!=null&&(i.callback=n),e=js(t,i,s),e!==null&&(or(e,t,s,r),Vu(e,t,s))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=fn(),s=Vs(t),i=zr(r,s);i.tag=1,i.payload=e,n!=null&&(i.callback=n),e=js(t,i,s),e!==null&&(or(e,t,s,r),Vu(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=fn(),r=Vs(t),s=zr(n,r);s.tag=2,e!=null&&(s.callback=e),e=js(t,s,r),e!==null&&(or(e,t,r,n),Vu(e,t,r))}};function aw(t,e,n,r,s,i,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,i,o):e.prototype&&e.prototype.isPureReactComponent?!Gl(n,r)||!Gl(s,i):!0}function Y0(t,e,n){var r=!1,s=Hs,i=e.contextType;return typeof i=="object"&&i!==null?i=Kn(i):(s=Tn(e)?Oi:ln.current,r=e.contextTypes,i=(r=r!=null)?ra(t,s):Hs),e=new e(n,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=_h,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=i),e}function lw(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&_h.enqueueReplaceState(e,e.state,null)}function cm(t,e,n,r){var s=t.stateNode;s.props=n,s.state=t.memoizedState,s.refs={},Og(t);var i=e.contextType;typeof i=="object"&&i!==null?s.context=Kn(i):(i=Tn(e)?Oi:ln.current,s.context=ra(t,i)),s.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(lm(t,e,i,n),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&_h.enqueueReplaceState(s,s.state,null),Id(t,n,s,r),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function aa(t,e){try{var n="",r=e;do n+=VR(r),r=r.return;while(r);var s=n}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:s,digest:null}}function Jf(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function um(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var cP=typeof WeakMap=="function"?WeakMap:Map;function X0(t,e,n){n=zr(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){Cd||(Cd=!0,wm=r),um(t,e)},n}function J0(t,e,n){n=zr(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var s=e.value;n.payload=function(){return r(s)},n.callback=function(){um(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){um(t,e),typeof r!="function"&&(Os===null?Os=new Set([this]):Os.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function cw(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new cP;var s=new Set;r.set(e,s)}else s=r.get(e),s===void 0&&(s=new Set,r.set(e,s));s.has(n)||(s.add(n),t=TP.bind(null,t,e,n),e.then(t,t))}function uw(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function dw(t,e,n,r,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=zr(-1,1),e.tag=2,js(n,e,1))),n.lanes|=1),t)}var uP=ts.ReactCurrentOwner,wn=!1;function un(t,e,n,r){e.child=t===null?C0(e,null,n,r):ia(e,t.child,n,r)}function hw(t,e,n,r,s){n=n.render;var i=e.ref;return Wo(e,s),r=Ug(t,e,n,r,i,s),n=$g(),t!==null&&!wn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,Gr(t,e,s)):(ut&&n&&Ag(e),e.flags|=1,un(t,e,r,s),e.child)}function fw(t,e,n,r,s){if(t===null){var i=n.type;return typeof i=="function"&&!Xg(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=i,Z0(t,e,i,r,s)):(t=Bu(n.type,null,r,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&s)){var o=i.memoizedProps;if(n=n.compare,n=n!==null?n:Gl,n(o,r)&&t.ref===e.ref)return Gr(t,e,s)}return e.flags|=1,t=Ls(i,r),t.ref=e.ref,t.return=e,e.child=t}function Z0(t,e,n,r,s){if(t!==null){var i=t.memoizedProps;if(Gl(i,r)&&t.ref===e.ref)if(wn=!1,e.pendingProps=r=i,(t.lanes&s)!==0)t.flags&131072&&(wn=!0);else return e.lanes=t.lanes,Gr(t,e,s)}return dm(t,e,n,r,s)}function ex(t,e,n){var r=e.pendingProps,s=r.children,i=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},st(Uo,An),An|=n;else{if(!(n&1073741824))return t=i!==null?i.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,st(Uo,An),An|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,st(Uo,An),An|=r}else i!==null?(r=i.baseLanes|n,e.memoizedState=null):r=n,st(Uo,An),An|=r;return un(t,e,s,n),e.child}function tx(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function dm(t,e,n,r,s){var i=Tn(n)?Oi:ln.current;return i=ra(e,i),Wo(e,s),n=Ug(t,e,n,r,i,s),r=$g(),t!==null&&!wn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,Gr(t,e,s)):(ut&&r&&Ag(e),e.flags|=1,un(t,e,n,s),e.child)}function pw(t,e,n,r,s){if(Tn(n)){var i=!0;yd(e)}else i=!1;if(Wo(e,s),e.stateNode===null)Fu(t,e),Y0(e,n,r),cm(e,n,r,s),r=!0;else if(t===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var l=o.context,d=n.contextType;typeof d=="object"&&d!==null?d=Kn(d):(d=Tn(n)?Oi:ln.current,d=ra(e,d));var h=n.getDerivedStateFromProps,f=typeof h=="function"||typeof o.getSnapshotBeforeUpdate=="function";f||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==r||l!==d)&&lw(e,o,r,d),ys=!1;var m=e.memoizedState;o.state=m,Id(e,r,o,s),l=e.memoizedState,a!==r||m!==l||In.current||ys?(typeof h=="function"&&(lm(e,n,h,r),l=e.memoizedState),(a=ys||aw(e,n,a,r,m,l,d))?(f||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=l),o.props=r,o.state=l,o.context=d,r=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,R0(t,e),a=e.memoizedProps,d=e.type===e.elementType?a:Zn(e.type,a),o.props=d,f=e.pendingProps,m=o.context,l=n.contextType,typeof l=="object"&&l!==null?l=Kn(l):(l=Tn(n)?Oi:ln.current,l=ra(e,l));var w=n.getDerivedStateFromProps;(h=typeof w=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==f||m!==l)&&lw(e,o,r,l),ys=!1,m=e.memoizedState,o.state=m,Id(e,r,o,s);var R=e.memoizedState;a!==f||m!==R||In.current||ys?(typeof w=="function"&&(lm(e,n,w,r),R=e.memoizedState),(d=ys||aw(e,n,d,r,m,R,l)||!1)?(h||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,R,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,R,l)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&m===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&m===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=R),o.props=r,o.state=R,o.context=l,r=d):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&m===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&m===t.memoizedState||(e.flags|=1024),r=!1)}return hm(t,e,n,r,i,s)}function hm(t,e,n,r,s,i){tx(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return s&&Zv(e,n,!1),Gr(t,e,i);r=e.stateNode,uP.current=e;var a=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=ia(e,t.child,null,i),e.child=ia(e,null,a,i)):un(t,e,a,i),e.memoizedState=r.state,s&&Zv(e,n,!0),e.child}function nx(t){var e=t.stateNode;e.pendingContext?Jv(t,e.pendingContext,e.pendingContext!==e.context):e.context&&Jv(t,e.context,!1),Vg(t,e.containerInfo)}function mw(t,e,n,r,s){return sa(),Pg(s),e.flags|=256,un(t,e,n,r),e.child}var fm={dehydrated:null,treeContext:null,retryLane:0};function pm(t){return{baseLanes:t,cachePool:null,transitions:null}}function rx(t,e,n){var r=e.pendingProps,s=mt.current,i=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=t!==null&&t.memoizedState===null?!1:(s&2)!==0),a?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),st(mt,s&1),t===null)return om(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,i?(r=e.mode,i=e.child,o={mode:"hidden",children:o},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=Eh(o,r,0,null),t=Ai(t,r,n,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=pm(n),e.memoizedState=fm,t):qg(e,o));if(s=t.memoizedState,s!==null&&(a=s.dehydrated,a!==null))return dP(t,e,o,r,a,s,n);if(i){i=r.fallback,o=e.mode,s=t.child,a=s.sibling;var l={mode:"hidden",children:r.children};return!(o&1)&&e.child!==s?(r=e.child,r.childLanes=0,r.pendingProps=l,e.deletions=null):(r=Ls(s,l),r.subtreeFlags=s.subtreeFlags&14680064),a!==null?i=Ls(a,i):(i=Ai(i,o,n,null),i.flags|=2),i.return=e,r.return=e,r.sibling=i,e.child=r,r=i,i=e.child,o=t.child.memoizedState,o=o===null?pm(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=t.childLanes&~n,e.memoizedState=fm,r}return i=t.child,t=i.sibling,r=Ls(i,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function qg(t,e){return e=Eh({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function fu(t,e,n,r){return r!==null&&Pg(r),ia(e,t.child,null,n),t=qg(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function dP(t,e,n,r,s,i,o){if(n)return e.flags&256?(e.flags&=-257,r=Jf(Error(K(422))),fu(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=r.fallback,s=e.mode,r=Eh({mode:"visible",children:r.children},s,0,null),i=Ai(i,s,o,null),i.flags|=2,r.return=e,i.return=e,r.sibling=i,e.child=r,e.mode&1&&ia(e,t.child,null,o),e.child.memoizedState=pm(o),e.memoizedState=fm,i);if(!(e.mode&1))return fu(t,e,o,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var a=r.dgst;return r=a,i=Error(K(419)),r=Jf(i,r,void 0),fu(t,e,o,r)}if(a=(o&t.childLanes)!==0,wn||a){if(r=Bt,r!==null){switch(o&-o){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|o)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,Kr(t,s),or(r,t,s,-1))}return Yg(),r=Jf(Error(K(421))),fu(t,e,o,r)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=xP.bind(null,t),s._reactRetry=e,null):(t=i.treeContext,Pn=Ds(s.nextSibling),kn=e,ut=!0,nr=null,t!==null&&(Fn[Un++]=Mr,Fn[Un++]=Fr,Fn[Un++]=Vi,Mr=t.id,Fr=t.overflow,Vi=e),e=qg(e,r.children),e.flags|=4096,e)}function gw(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),am(t.return,e,n)}function Zf(t,e,n,r,s){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=s)}function sx(t,e,n){var r=e.pendingProps,s=r.revealOrder,i=r.tail;if(un(t,e,r.children,n),r=mt.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&gw(t,n,e);else if(t.tag===19)gw(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(st(mt,r),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(n=e.child,s=null;n!==null;)t=n.alternate,t!==null&&Td(t)===null&&(s=n),n=n.sibling;n=s,n===null?(s=e.child,e.child=null):(s=n.sibling,n.sibling=null),Zf(e,!1,s,n,i);break;case"backwards":for(n=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&Td(t)===null){e.child=s;break}t=s.sibling,s.sibling=n,n=s,s=t}Zf(e,!0,n,null,i);break;case"together":Zf(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Fu(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Gr(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),Mi|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(K(153));if(e.child!==null){for(t=e.child,n=Ls(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Ls(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function hP(t,e,n){switch(e.tag){case 3:nx(e),sa();break;case 5:P0(e);break;case 1:Tn(e.type)&&yd(e);break;case 4:Vg(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,s=e.memoizedProps.value;st(wd,r._currentValue),r._currentValue=s;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(st(mt,mt.current&1),e.flags|=128,null):n&e.child.childLanes?rx(t,e,n):(st(mt,mt.current&1),t=Gr(t,e,n),t!==null?t.sibling:null);st(mt,mt.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return sx(t,e,n);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),st(mt,mt.current),r)break;return null;case 22:case 23:return e.lanes=0,ex(t,e,n)}return Gr(t,e,n)}var ix,mm,ox,ax;ix=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};mm=function(){};ox=function(t,e,n,r){var s=t.memoizedProps;if(s!==r){t=e.stateNode,xi(Ar.current);var i=null;switch(n){case"input":s=Lp(t,s),r=Lp(t,r),i=[];break;case"select":s=_t({},s,{value:void 0}),r=_t({},r,{value:void 0}),i=[];break;case"textarea":s=Up(t,s),r=Up(t,r),i=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=md)}Bp(n,r);var o;n=null;for(d in s)if(!r.hasOwnProperty(d)&&s.hasOwnProperty(d)&&s[d]!=null)if(d==="style"){var a=s[d];for(o in a)a.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&($l.hasOwnProperty(d)?i||(i=[]):(i=i||[]).push(d,null));for(d in r){var l=r[d];if(a=s!=null?s[d]:void 0,r.hasOwnProperty(d)&&l!==a&&(l!=null||a!=null))if(d==="style")if(a){for(o in a)!a.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in l)l.hasOwnProperty(o)&&a[o]!==l[o]&&(n||(n={}),n[o]=l[o])}else n||(i||(i=[]),i.push(d,n)),n=l;else d==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(i=i||[]).push(d,l)):d==="children"?typeof l!="string"&&typeof l!="number"||(i=i||[]).push(d,""+l):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&($l.hasOwnProperty(d)?(l!=null&&d==="onScroll"&&at("scroll",t),i||a===l||(i=[])):(i=i||[]).push(d,l))}n&&(i=i||[]).push("style",n);var d=i;(e.updateQueue=d)&&(e.flags|=4)}};ax=function(t,e,n,r){n!==r&&(e.flags|=4)};function Za(t,e){if(!ut)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function Zt(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function fP(t,e,n){var r=e.pendingProps;switch(Rg(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Zt(e),null;case 1:return Tn(e.type)&&gd(),Zt(e),null;case 3:return r=e.stateNode,oa(),lt(In),lt(ln),Mg(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(du(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,nr!==null&&(Tm(nr),nr=null))),mm(t,e),Zt(e),null;case 5:Lg(e);var s=xi(Zl.current);if(n=e.type,t!==null&&e.stateNode!=null)ox(t,e,n,r,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(K(166));return Zt(e),null}if(t=xi(Ar.current),du(e)){r=e.stateNode,n=e.type;var i=e.memoizedProps;switch(r[Tr]=e,r[Xl]=i,t=(e.mode&1)!==0,n){case"dialog":at("cancel",r),at("close",r);break;case"iframe":case"object":case"embed":at("load",r);break;case"video":case"audio":for(s=0;s<hl.length;s++)at(hl[s],r);break;case"source":at("error",r);break;case"img":case"image":case"link":at("error",r),at("load",r);break;case"details":at("toggle",r);break;case"input":Sv(r,i),at("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},at("invalid",r);break;case"textarea":Cv(r,i),at("invalid",r)}Bp(n,i),s=null;for(var o in i)if(i.hasOwnProperty(o)){var a=i[o];o==="children"?typeof a=="string"?r.textContent!==a&&(i.suppressHydrationWarning!==!0&&uu(r.textContent,a,t),s=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(i.suppressHydrationWarning!==!0&&uu(r.textContent,a,t),s=["children",""+a]):$l.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&at("scroll",r)}switch(n){case"input":nu(r),bv(r,i,!0);break;case"textarea":nu(r),Av(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=md)}r=s,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=OT(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[Tr]=e,t[Xl]=r,ix(t,e,!1,!1),e.stateNode=t;e:{switch(o=zp(n,r),n){case"dialog":at("cancel",t),at("close",t),s=r;break;case"iframe":case"object":case"embed":at("load",t),s=r;break;case"video":case"audio":for(s=0;s<hl.length;s++)at(hl[s],t);s=r;break;case"source":at("error",t),s=r;break;case"img":case"image":case"link":at("error",t),at("load",t),s=r;break;case"details":at("toggle",t),s=r;break;case"input":Sv(t,r),s=Lp(t,r),at("invalid",t);break;case"option":s=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},s=_t({},r,{value:void 0}),at("invalid",t);break;case"textarea":Cv(t,r),s=Up(t,r),at("invalid",t);break;default:s=r}Bp(n,s),a=s;for(i in a)if(a.hasOwnProperty(i)){var l=a[i];i==="style"?MT(t,l):i==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&VT(t,l)):i==="children"?typeof l=="string"?(n!=="textarea"||l!=="")&&Bl(t,l):typeof l=="number"&&Bl(t,""+l):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&($l.hasOwnProperty(i)?l!=null&&i==="onScroll"&&at("scroll",t):l!=null&&pg(t,i,l,o))}switch(n){case"input":nu(t),bv(t,r,!1);break;case"textarea":nu(t),Av(t);break;case"option":r.value!=null&&t.setAttribute("value",""+qs(r.value));break;case"select":t.multiple=!!r.multiple,i=r.value,i!=null?Bo(t,!!r.multiple,i,!1):r.defaultValue!=null&&Bo(t,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=md)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Zt(e),null;case 6:if(t&&e.stateNode!=null)ax(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(K(166));if(n=xi(Zl.current),xi(Ar.current),du(e)){if(r=e.stateNode,n=e.memoizedProps,r[Tr]=e,(i=r.nodeValue!==n)&&(t=kn,t!==null))switch(t.tag){case 3:uu(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&uu(r.nodeValue,n,(t.mode&1)!==0)}i&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Tr]=e,e.stateNode=r}return Zt(e),null;case 13:if(lt(mt),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(ut&&Pn!==null&&e.mode&1&&!(e.flags&128))S0(),sa(),e.flags|=98560,i=!1;else if(i=du(e),r!==null&&r.dehydrated!==null){if(t===null){if(!i)throw Error(K(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(K(317));i[Tr]=e}else sa(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Zt(e),i=!1}else nr!==null&&(Tm(nr),nr=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||mt.current&1?jt===0&&(jt=3):Yg())),e.updateQueue!==null&&(e.flags|=4),Zt(e),null);case 4:return oa(),mm(t,e),t===null&&Ql(e.stateNode.containerInfo),Zt(e),null;case 10:return Dg(e.type._context),Zt(e),null;case 17:return Tn(e.type)&&gd(),Zt(e),null;case 19:if(lt(mt),i=e.memoizedState,i===null)return Zt(e),null;if(r=(e.flags&128)!==0,o=i.rendering,o===null)if(r)Za(i,!1);else{if(jt!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=Td(t),o!==null){for(e.flags|=128,Za(i,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)i=n,t=r,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,t=o.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return st(mt,mt.current&1|2),e.child}t=t.sibling}i.tail!==null&&bt()>la&&(e.flags|=128,r=!0,Za(i,!1),e.lanes=4194304)}else{if(!r)if(t=Td(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Za(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!ut)return Zt(e),null}else 2*bt()-i.renderingStartTime>la&&n!==1073741824&&(e.flags|=128,r=!0,Za(i,!1),e.lanes=4194304);i.isBackwards?(o.sibling=e.child,e.child=o):(n=i.last,n!==null?n.sibling=o:e.child=o,i.last=o)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=bt(),e.sibling=null,n=mt.current,st(mt,r?n&1|2:n&1),e):(Zt(e),null);case 22:case 23:return Qg(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?An&1073741824&&(Zt(e),e.subtreeFlags&6&&(e.flags|=8192)):Zt(e),null;case 24:return null;case 25:return null}throw Error(K(156,e.tag))}function pP(t,e){switch(Rg(e),e.tag){case 1:return Tn(e.type)&&gd(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return oa(),lt(In),lt(ln),Mg(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return Lg(e),null;case 13:if(lt(mt),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(K(340));sa()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return lt(mt),null;case 4:return oa(),null;case 10:return Dg(e.type._context),null;case 22:case 23:return Qg(),null;case 24:return null;default:return null}}var pu=!1,nn=!1,mP=typeof WeakSet=="function"?WeakSet:Set,ie=null;function Fo(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){wt(t,e,r)}else n.current=null}function gm(t,e,n){try{n()}catch(r){wt(t,e,r)}}var yw=!1;function gP(t,e){if(Zp=hd,t=h0(),Cg(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var o=0,a=-1,l=-1,d=0,h=0,f=t,m=null;t:for(;;){for(var w;f!==n||s!==0&&f.nodeType!==3||(a=o+s),f!==i||r!==0&&f.nodeType!==3||(l=o+r),f.nodeType===3&&(o+=f.nodeValue.length),(w=f.firstChild)!==null;)m=f,f=w;for(;;){if(f===t)break t;if(m===n&&++d===s&&(a=o),m===i&&++h===r&&(l=o),(w=f.nextSibling)!==null)break;f=m,m=f.parentNode}f=w}n=a===-1||l===-1?null:{start:a,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(em={focusedElem:t,selectionRange:n},hd=!1,ie=e;ie!==null;)if(e=ie,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,ie=t;else for(;ie!==null;){e=ie;try{var R=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(R!==null){var b=R.memoizedProps,A=R.memoizedState,T=e.stateNode,E=T.getSnapshotBeforeUpdate(e.elementType===e.type?b:Zn(e.type,b),A);T.__reactInternalSnapshotBeforeUpdate=E}break;case 3:var y=e.stateNode.containerInfo;y.nodeType===1?y.textContent="":y.nodeType===9&&y.documentElement&&y.removeChild(y.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(K(163))}}catch(j){wt(e,e.return,j)}if(t=e.sibling,t!==null){t.return=e.return,ie=t;break}ie=e.return}return R=yw,yw=!1,R}function Al(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&t)===t){var i=s.destroy;s.destroy=void 0,i!==void 0&&gm(e,n,i)}s=s.next}while(s!==r)}}function vh(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function ym(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function lx(t){var e=t.alternate;e!==null&&(t.alternate=null,lx(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Tr],delete e[Xl],delete e[rm],delete e[J1],delete e[Z1])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function cx(t){return t.tag===5||t.tag===3||t.tag===4}function _w(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||cx(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function _m(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=md));else if(r!==4&&(t=t.child,t!==null))for(_m(t,e,n),t=t.sibling;t!==null;)_m(t,e,n),t=t.sibling}function vm(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(vm(t,e,n),t=t.sibling;t!==null;)vm(t,e,n),t=t.sibling}var zt=null,er=!1;function ds(t,e,n){for(n=n.child;n!==null;)ux(t,e,n),n=n.sibling}function ux(t,e,n){if(Cr&&typeof Cr.onCommitFiberUnmount=="function")try{Cr.onCommitFiberUnmount(dh,n)}catch{}switch(n.tag){case 5:nn||Fo(n,e);case 6:var r=zt,s=er;zt=null,ds(t,e,n),zt=r,er=s,zt!==null&&(er?(t=zt,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):zt.removeChild(n.stateNode));break;case 18:zt!==null&&(er?(t=zt,n=n.stateNode,t.nodeType===8?Wf(t.parentNode,n):t.nodeType===1&&Wf(t,n),Wl(t)):Wf(zt,n.stateNode));break;case 4:r=zt,s=er,zt=n.stateNode.containerInfo,er=!0,ds(t,e,n),zt=r,er=s;break;case 0:case 11:case 14:case 15:if(!nn&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var i=s,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&gm(n,e,o),s=s.next}while(s!==r)}ds(t,e,n);break;case 1:if(!nn&&(Fo(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(a){wt(n,e,a)}ds(t,e,n);break;case 21:ds(t,e,n);break;case 22:n.mode&1?(nn=(r=nn)||n.memoizedState!==null,ds(t,e,n),nn=r):ds(t,e,n);break;default:ds(t,e,n)}}function vw(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new mP),e.forEach(function(r){var s=SP.bind(null,t,r);n.has(r)||(n.add(r),r.then(s,s))})}}function Jn(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var i=t,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:zt=a.stateNode,er=!1;break e;case 3:zt=a.stateNode.containerInfo,er=!0;break e;case 4:zt=a.stateNode.containerInfo,er=!0;break e}a=a.return}if(zt===null)throw Error(K(160));ux(i,o,s),zt=null,er=!1;var l=s.alternate;l!==null&&(l.return=null),s.return=null}catch(d){wt(s,e,d)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)dx(e,t),e=e.sibling}function dx(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Jn(e,t),_r(t),r&4){try{Al(3,t,t.return),vh(3,t)}catch(b){wt(t,t.return,b)}try{Al(5,t,t.return)}catch(b){wt(t,t.return,b)}}break;case 1:Jn(e,t),_r(t),r&512&&n!==null&&Fo(n,n.return);break;case 5:if(Jn(e,t),_r(t),r&512&&n!==null&&Fo(n,n.return),t.flags&32){var s=t.stateNode;try{Bl(s,"")}catch(b){wt(t,t.return,b)}}if(r&4&&(s=t.stateNode,s!=null)){var i=t.memoizedProps,o=n!==null?n.memoizedProps:i,a=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{a==="input"&&i.type==="radio"&&i.name!=null&&DT(s,i),zp(a,o);var d=zp(a,i);for(o=0;o<l.length;o+=2){var h=l[o],f=l[o+1];h==="style"?MT(s,f):h==="dangerouslySetInnerHTML"?VT(s,f):h==="children"?Bl(s,f):pg(s,h,f,d)}switch(a){case"input":Mp(s,i);break;case"textarea":jT(s,i);break;case"select":var m=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var w=i.value;w!=null?Bo(s,!!i.multiple,w,!1):m!==!!i.multiple&&(i.defaultValue!=null?Bo(s,!!i.multiple,i.defaultValue,!0):Bo(s,!!i.multiple,i.multiple?[]:"",!1))}s[Xl]=i}catch(b){wt(t,t.return,b)}}break;case 6:if(Jn(e,t),_r(t),r&4){if(t.stateNode===null)throw Error(K(162));s=t.stateNode,i=t.memoizedProps;try{s.nodeValue=i}catch(b){wt(t,t.return,b)}}break;case 3:if(Jn(e,t),_r(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Wl(e.containerInfo)}catch(b){wt(t,t.return,b)}break;case 4:Jn(e,t),_r(t);break;case 13:Jn(e,t),_r(t),s=t.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(Kg=bt())),r&4&&vw(t);break;case 22:if(h=n!==null&&n.memoizedState!==null,t.mode&1?(nn=(d=nn)||h,Jn(e,t),nn=d):Jn(e,t),_r(t),r&8192){if(d=t.memoizedState!==null,(t.stateNode.isHidden=d)&&!h&&t.mode&1)for(ie=t,h=t.child;h!==null;){for(f=ie=h;ie!==null;){switch(m=ie,w=m.child,m.tag){case 0:case 11:case 14:case 15:Al(4,m,m.return);break;case 1:Fo(m,m.return);var R=m.stateNode;if(typeof R.componentWillUnmount=="function"){r=m,n=m.return;try{e=r,R.props=e.memoizedProps,R.state=e.memoizedState,R.componentWillUnmount()}catch(b){wt(r,n,b)}}break;case 5:Fo(m,m.return);break;case 22:if(m.memoizedState!==null){Ew(f);continue}}w!==null?(w.return=m,ie=w):Ew(f)}h=h.sibling}e:for(h=null,f=t;;){if(f.tag===5){if(h===null){h=f;try{s=f.stateNode,d?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(a=f.stateNode,l=f.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=LT("display",o))}catch(b){wt(t,t.return,b)}}}else if(f.tag===6){if(h===null)try{f.stateNode.nodeValue=d?"":f.memoizedProps}catch(b){wt(t,t.return,b)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===t)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===t)break e;for(;f.sibling===null;){if(f.return===null||f.return===t)break e;h===f&&(h=null),f=f.return}h===f&&(h=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:Jn(e,t),_r(t),r&4&&vw(t);break;case 21:break;default:Jn(e,t),_r(t)}}function _r(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(cx(n)){var r=n;break e}n=n.return}throw Error(K(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(Bl(s,""),r.flags&=-33);var i=_w(t);vm(t,i,s);break;case 3:case 4:var o=r.stateNode.containerInfo,a=_w(t);_m(t,a,o);break;default:throw Error(K(161))}}catch(l){wt(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function yP(t,e,n){ie=t,hx(t)}function hx(t,e,n){for(var r=(t.mode&1)!==0;ie!==null;){var s=ie,i=s.child;if(s.tag===22&&r){var o=s.memoizedState!==null||pu;if(!o){var a=s.alternate,l=a!==null&&a.memoizedState!==null||nn;a=pu;var d=nn;if(pu=o,(nn=l)&&!d)for(ie=s;ie!==null;)o=ie,l=o.child,o.tag===22&&o.memoizedState!==null?Iw(s):l!==null?(l.return=o,ie=l):Iw(s);for(;i!==null;)ie=i,hx(i),i=i.sibling;ie=s,pu=a,nn=d}ww(t)}else s.subtreeFlags&8772&&i!==null?(i.return=s,ie=i):ww(t)}}function ww(t){for(;ie!==null;){var e=ie;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:nn||vh(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!nn)if(n===null)r.componentDidMount();else{var s=e.elementType===e.type?n.memoizedProps:Zn(e.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&sw(e,i,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}sw(e,o,n)}break;case 5:var a=e.stateNode;if(n===null&&e.flags&4){n=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var d=e.alternate;if(d!==null){var h=d.memoizedState;if(h!==null){var f=h.dehydrated;f!==null&&Wl(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(K(163))}nn||e.flags&512&&ym(e)}catch(m){wt(e,e.return,m)}}if(e===t){ie=null;break}if(n=e.sibling,n!==null){n.return=e.return,ie=n;break}ie=e.return}}function Ew(t){for(;ie!==null;){var e=ie;if(e===t){ie=null;break}var n=e.sibling;if(n!==null){n.return=e.return,ie=n;break}ie=e.return}}function Iw(t){for(;ie!==null;){var e=ie;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{vh(4,e)}catch(l){wt(e,n,l)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var s=e.return;try{r.componentDidMount()}catch(l){wt(e,s,l)}}var i=e.return;try{ym(e)}catch(l){wt(e,i,l)}break;case 5:var o=e.return;try{ym(e)}catch(l){wt(e,o,l)}}}catch(l){wt(e,e.return,l)}if(e===t){ie=null;break}var a=e.sibling;if(a!==null){a.return=e.return,ie=a;break}ie=e.return}}var _P=Math.ceil,bd=ts.ReactCurrentDispatcher,Hg=ts.ReactCurrentOwner,Hn=ts.ReactCurrentBatchConfig,ze=0,Bt=null,At=null,Qt=0,An=0,Uo=Js(0),jt=0,rc=null,Mi=0,wh=0,Wg=0,Rl=null,vn=null,Kg=0,la=1/0,Vr=null,Cd=!1,wm=null,Os=null,mu=!1,As=null,Ad=0,Pl=0,Em=null,Uu=-1,$u=0;function fn(){return ze&6?bt():Uu!==-1?Uu:Uu=bt()}function Vs(t){return t.mode&1?ze&2&&Qt!==0?Qt&-Qt:tP.transition!==null?($u===0&&($u=YT()),$u):(t=Je,t!==0||(t=window.event,t=t===void 0?16:r0(t.type)),t):1}function or(t,e,n,r){if(50<Pl)throw Pl=0,Em=null,Error(K(185));wc(t,n,r),(!(ze&2)||t!==Bt)&&(t===Bt&&(!(ze&2)&&(wh|=n),jt===4&&vs(t,Qt)),xn(t,r),n===1&&ze===0&&!(e.mode&1)&&(la=bt()+500,gh&&Zs()))}function xn(t,e){var n=t.callbackNode;t1(t,e);var r=dd(t,t===Bt?Qt:0);if(r===0)n!==null&&Nv(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&Nv(n),e===1)t.tag===0?eP(Tw.bind(null,t)):I0(Tw.bind(null,t)),Y1(function(){!(ze&6)&&Zs()}),n=null;else{switch(XT(r)){case 1:n=vg;break;case 4:n=GT;break;case 16:n=ud;break;case 536870912:n=QT;break;default:n=ud}n=wx(n,fx.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function fx(t,e){if(Uu=-1,$u=0,ze&6)throw Error(K(327));var n=t.callbackNode;if(Ko()&&t.callbackNode!==n)return null;var r=dd(t,t===Bt?Qt:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=Rd(t,r);else{e=r;var s=ze;ze|=2;var i=mx();(Bt!==t||Qt!==e)&&(Vr=null,la=bt()+500,Ci(t,e));do try{EP();break}catch(a){px(t,a)}while(!0);kg(),bd.current=i,ze=s,At!==null?e=0:(Bt=null,Qt=0,e=jt)}if(e!==0){if(e===2&&(s=Gp(t),s!==0&&(r=s,e=Im(t,s))),e===1)throw n=rc,Ci(t,0),vs(t,r),xn(t,bt()),n;if(e===6)vs(t,r);else{if(s=t.current.alternate,!(r&30)&&!vP(s)&&(e=Rd(t,r),e===2&&(i=Gp(t),i!==0&&(r=i,e=Im(t,i))),e===1))throw n=rc,Ci(t,0),vs(t,r),xn(t,bt()),n;switch(t.finishedWork=s,t.finishedLanes=r,e){case 0:case 1:throw Error(K(345));case 2:fi(t,vn,Vr);break;case 3:if(vs(t,r),(r&130023424)===r&&(e=Kg+500-bt(),10<e)){if(dd(t,0)!==0)break;if(s=t.suspendedLanes,(s&r)!==r){fn(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=nm(fi.bind(null,t,vn,Vr),e);break}fi(t,vn,Vr);break;case 4:if(vs(t,r),(r&4194240)===r)break;for(e=t.eventTimes,s=-1;0<r;){var o=31-ir(r);i=1<<o,o=e[o],o>s&&(s=o),r&=~i}if(r=s,r=bt()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*_P(r/1960))-r,10<r){t.timeoutHandle=nm(fi.bind(null,t,vn,Vr),r);break}fi(t,vn,Vr);break;case 5:fi(t,vn,Vr);break;default:throw Error(K(329))}}}return xn(t,bt()),t.callbackNode===n?fx.bind(null,t):null}function Im(t,e){var n=Rl;return t.current.memoizedState.isDehydrated&&(Ci(t,e).flags|=256),t=Rd(t,e),t!==2&&(e=vn,vn=n,e!==null&&Tm(e)),t}function Tm(t){vn===null?vn=t:vn.push.apply(vn,t)}function vP(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],i=s.getSnapshot;s=s.value;try{if(!lr(i(),s))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function vs(t,e){for(e&=~Wg,e&=~wh,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-ir(e),r=1<<n;t[n]=-1,e&=~r}}function Tw(t){if(ze&6)throw Error(K(327));Ko();var e=dd(t,0);if(!(e&1))return xn(t,bt()),null;var n=Rd(t,e);if(t.tag!==0&&n===2){var r=Gp(t);r!==0&&(e=r,n=Im(t,r))}if(n===1)throw n=rc,Ci(t,0),vs(t,e),xn(t,bt()),n;if(n===6)throw Error(K(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,fi(t,vn,Vr),xn(t,bt()),null}function Gg(t,e){var n=ze;ze|=1;try{return t(e)}finally{ze=n,ze===0&&(la=bt()+500,gh&&Zs())}}function Fi(t){As!==null&&As.tag===0&&!(ze&6)&&Ko();var e=ze;ze|=1;var n=Hn.transition,r=Je;try{if(Hn.transition=null,Je=1,t)return t()}finally{Je=r,Hn.transition=n,ze=e,!(ze&6)&&Zs()}}function Qg(){An=Uo.current,lt(Uo)}function Ci(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,Q1(n)),At!==null)for(n=At.return;n!==null;){var r=n;switch(Rg(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&gd();break;case 3:oa(),lt(In),lt(ln),Mg();break;case 5:Lg(r);break;case 4:oa();break;case 13:lt(mt);break;case 19:lt(mt);break;case 10:Dg(r.type._context);break;case 22:case 23:Qg()}n=n.return}if(Bt=t,At=t=Ls(t.current,null),Qt=An=e,jt=0,rc=null,Wg=wh=Mi=0,vn=Rl=null,Ti!==null){for(e=0;e<Ti.length;e++)if(n=Ti[e],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,i=n.pending;if(i!==null){var o=i.next;i.next=s,r.next=o}n.pending=r}Ti=null}return t}function px(t,e){do{var n=At;try{if(kg(),Lu.current=Sd,xd){for(var r=yt.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}xd=!1}if(Li=0,$t=Dt=yt=null,Cl=!1,ec=0,Hg.current=null,n===null||n.return===null){jt=1,rc=e,At=null;break}e:{var i=t,o=n.return,a=n,l=e;if(e=Qt,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var d=l,h=a,f=h.tag;if(!(h.mode&1)&&(f===0||f===11||f===15)){var m=h.alternate;m?(h.updateQueue=m.updateQueue,h.memoizedState=m.memoizedState,h.lanes=m.lanes):(h.updateQueue=null,h.memoizedState=null)}var w=uw(o);if(w!==null){w.flags&=-257,dw(w,o,a,i,e),w.mode&1&&cw(i,d,e),e=w,l=d;var R=e.updateQueue;if(R===null){var b=new Set;b.add(l),e.updateQueue=b}else R.add(l);break e}else{if(!(e&1)){cw(i,d,e),Yg();break e}l=Error(K(426))}}else if(ut&&a.mode&1){var A=uw(o);if(A!==null){!(A.flags&65536)&&(A.flags|=256),dw(A,o,a,i,e),Pg(aa(l,a));break e}}i=l=aa(l,a),jt!==4&&(jt=2),Rl===null?Rl=[i]:Rl.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var T=X0(i,l,e);rw(i,T);break e;case 1:a=l;var E=i.type,y=i.stateNode;if(!(i.flags&128)&&(typeof E.getDerivedStateFromError=="function"||y!==null&&typeof y.componentDidCatch=="function"&&(Os===null||!Os.has(y)))){i.flags|=65536,e&=-e,i.lanes|=e;var j=J0(i,a,e);rw(i,j);break e}}i=i.return}while(i!==null)}yx(n)}catch(V){e=V,At===n&&n!==null&&(At=n=n.return);continue}break}while(!0)}function mx(){var t=bd.current;return bd.current=Sd,t===null?Sd:t}function Yg(){(jt===0||jt===3||jt===2)&&(jt=4),Bt===null||!(Mi&268435455)&&!(wh&268435455)||vs(Bt,Qt)}function Rd(t,e){var n=ze;ze|=2;var r=mx();(Bt!==t||Qt!==e)&&(Vr=null,Ci(t,e));do try{wP();break}catch(s){px(t,s)}while(!0);if(kg(),ze=n,bd.current=r,At!==null)throw Error(K(261));return Bt=null,Qt=0,jt}function wP(){for(;At!==null;)gx(At)}function EP(){for(;At!==null&&!WR();)gx(At)}function gx(t){var e=vx(t.alternate,t,An);t.memoizedProps=t.pendingProps,e===null?yx(t):At=e,Hg.current=null}function yx(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=pP(n,e),n!==null){n.flags&=32767,At=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{jt=6,At=null;return}}else if(n=fP(n,e,An),n!==null){At=n;return}if(e=e.sibling,e!==null){At=e;return}At=e=t}while(e!==null);jt===0&&(jt=5)}function fi(t,e,n){var r=Je,s=Hn.transition;try{Hn.transition=null,Je=1,IP(t,e,n,r)}finally{Hn.transition=s,Je=r}return null}function IP(t,e,n,r){do Ko();while(As!==null);if(ze&6)throw Error(K(327));n=t.finishedWork;var s=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(K(177));t.callbackNode=null,t.callbackPriority=0;var i=n.lanes|n.childLanes;if(n1(t,i),t===Bt&&(At=Bt=null,Qt=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||mu||(mu=!0,wx(ud,function(){return Ko(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=Hn.transition,Hn.transition=null;var o=Je;Je=1;var a=ze;ze|=4,Hg.current=null,gP(t,n),dx(n,t),B1(em),hd=!!Zp,em=Zp=null,t.current=n,yP(n),KR(),ze=a,Je=o,Hn.transition=i}else t.current=n;if(mu&&(mu=!1,As=t,Ad=s),i=t.pendingLanes,i===0&&(Os=null),YR(n.stateNode),xn(t,bt()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)s=e[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(Cd)throw Cd=!1,t=wm,wm=null,t;return Ad&1&&t.tag!==0&&Ko(),i=t.pendingLanes,i&1?t===Em?Pl++:(Pl=0,Em=t):Pl=0,Zs(),null}function Ko(){if(As!==null){var t=XT(Ad),e=Hn.transition,n=Je;try{if(Hn.transition=null,Je=16>t?16:t,As===null)var r=!1;else{if(t=As,As=null,Ad=0,ze&6)throw Error(K(331));var s=ze;for(ze|=4,ie=t.current;ie!==null;){var i=ie,o=i.child;if(ie.flags&16){var a=i.deletions;if(a!==null){for(var l=0;l<a.length;l++){var d=a[l];for(ie=d;ie!==null;){var h=ie;switch(h.tag){case 0:case 11:case 15:Al(8,h,i)}var f=h.child;if(f!==null)f.return=h,ie=f;else for(;ie!==null;){h=ie;var m=h.sibling,w=h.return;if(lx(h),h===d){ie=null;break}if(m!==null){m.return=w,ie=m;break}ie=w}}}var R=i.alternate;if(R!==null){var b=R.child;if(b!==null){R.child=null;do{var A=b.sibling;b.sibling=null,b=A}while(b!==null)}}ie=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,ie=o;else e:for(;ie!==null;){if(i=ie,i.flags&2048)switch(i.tag){case 0:case 11:case 15:Al(9,i,i.return)}var T=i.sibling;if(T!==null){T.return=i.return,ie=T;break e}ie=i.return}}var E=t.current;for(ie=E;ie!==null;){o=ie;var y=o.child;if(o.subtreeFlags&2064&&y!==null)y.return=o,ie=y;else e:for(o=E;ie!==null;){if(a=ie,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:vh(9,a)}}catch(V){wt(a,a.return,V)}if(a===o){ie=null;break e}var j=a.sibling;if(j!==null){j.return=a.return,ie=j;break e}ie=a.return}}if(ze=s,Zs(),Cr&&typeof Cr.onPostCommitFiberRoot=="function")try{Cr.onPostCommitFiberRoot(dh,t)}catch{}r=!0}return r}finally{Je=n,Hn.transition=e}}return!1}function xw(t,e,n){e=aa(n,e),e=X0(t,e,1),t=js(t,e,1),e=fn(),t!==null&&(wc(t,1,e),xn(t,e))}function wt(t,e,n){if(t.tag===3)xw(t,t,n);else for(;e!==null;){if(e.tag===3){xw(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Os===null||!Os.has(r))){t=aa(n,t),t=J0(e,t,1),e=js(e,t,1),t=fn(),e!==null&&(wc(e,1,t),xn(e,t));break}}e=e.return}}function TP(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=fn(),t.pingedLanes|=t.suspendedLanes&n,Bt===t&&(Qt&n)===n&&(jt===4||jt===3&&(Qt&130023424)===Qt&&500>bt()-Kg?Ci(t,0):Wg|=n),xn(t,e)}function _x(t,e){e===0&&(t.mode&1?(e=iu,iu<<=1,!(iu&130023424)&&(iu=4194304)):e=1);var n=fn();t=Kr(t,e),t!==null&&(wc(t,e,n),xn(t,n))}function xP(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),_x(t,n)}function SP(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,s=t.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(K(314))}r!==null&&r.delete(e),_x(t,n)}var vx;vx=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||In.current)wn=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return wn=!1,hP(t,e,n);wn=!!(t.flags&131072)}else wn=!1,ut&&e.flags&1048576&&T0(e,vd,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;Fu(t,e),t=e.pendingProps;var s=ra(e,ln.current);Wo(e,n),s=Ug(null,e,r,t,s,n);var i=$g();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Tn(r)?(i=!0,yd(e)):i=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,Og(e),s.updater=_h,e.stateNode=s,s._reactInternals=e,cm(e,r,t,n),e=hm(null,e,r,!0,i,n)):(e.tag=0,ut&&i&&Ag(e),un(null,e,s,n),e=e.child),e;case 16:r=e.elementType;e:{switch(Fu(t,e),t=e.pendingProps,s=r._init,r=s(r._payload),e.type=r,s=e.tag=CP(r),t=Zn(r,t),s){case 0:e=dm(null,e,r,t,n);break e;case 1:e=pw(null,e,r,t,n);break e;case 11:e=hw(null,e,r,t,n);break e;case 14:e=fw(null,e,r,Zn(r.type,t),n);break e}throw Error(K(306,r,""))}return e;case 0:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Zn(r,s),dm(t,e,r,s,n);case 1:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Zn(r,s),pw(t,e,r,s,n);case 3:e:{if(nx(e),t===null)throw Error(K(387));r=e.pendingProps,i=e.memoizedState,s=i.element,R0(t,e),Id(e,r,null,n);var o=e.memoizedState;if(r=o.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){s=aa(Error(K(423)),e),e=mw(t,e,r,n,s);break e}else if(r!==s){s=aa(Error(K(424)),e),e=mw(t,e,r,n,s);break e}else for(Pn=Ds(e.stateNode.containerInfo.firstChild),kn=e,ut=!0,nr=null,n=C0(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(sa(),r===s){e=Gr(t,e,n);break e}un(t,e,r,n)}e=e.child}return e;case 5:return P0(e),t===null&&om(e),r=e.type,s=e.pendingProps,i=t!==null?t.memoizedProps:null,o=s.children,tm(r,s)?o=null:i!==null&&tm(r,i)&&(e.flags|=32),tx(t,e),un(t,e,o,n),e.child;case 6:return t===null&&om(e),null;case 13:return rx(t,e,n);case 4:return Vg(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=ia(e,null,r,n):un(t,e,r,n),e.child;case 11:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Zn(r,s),hw(t,e,r,s,n);case 7:return un(t,e,e.pendingProps,n),e.child;case 8:return un(t,e,e.pendingProps.children,n),e.child;case 12:return un(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,s=e.pendingProps,i=e.memoizedProps,o=s.value,st(wd,r._currentValue),r._currentValue=o,i!==null)if(lr(i.value,o)){if(i.children===s.children&&!In.current){e=Gr(t,e,n);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var a=i.dependencies;if(a!==null){o=i.child;for(var l=a.firstContext;l!==null;){if(l.context===r){if(i.tag===1){l=zr(-1,n&-n),l.tag=2;var d=i.updateQueue;if(d!==null){d=d.shared;var h=d.pending;h===null?l.next=l:(l.next=h.next,h.next=l),d.pending=l}}i.lanes|=n,l=i.alternate,l!==null&&(l.lanes|=n),am(i.return,n,e),a.lanes|=n;break}l=l.next}}else if(i.tag===10)o=i.type===e.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(K(341));o.lanes|=n,a=o.alternate,a!==null&&(a.lanes|=n),am(o,n,e),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===e){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}un(t,e,s.children,n),e=e.child}return e;case 9:return s=e.type,r=e.pendingProps.children,Wo(e,n),s=Kn(s),r=r(s),e.flags|=1,un(t,e,r,n),e.child;case 14:return r=e.type,s=Zn(r,e.pendingProps),s=Zn(r.type,s),fw(t,e,r,s,n);case 15:return Z0(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Zn(r,s),Fu(t,e),e.tag=1,Tn(r)?(t=!0,yd(e)):t=!1,Wo(e,n),Y0(e,r,s),cm(e,r,s,n),hm(null,e,r,!0,t,n);case 19:return sx(t,e,n);case 22:return ex(t,e,n)}throw Error(K(156,e.tag))};function wx(t,e){return KT(t,e)}function bP(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function zn(t,e,n,r){return new bP(t,e,n,r)}function Xg(t){return t=t.prototype,!(!t||!t.isReactComponent)}function CP(t){if(typeof t=="function")return Xg(t)?1:0;if(t!=null){if(t=t.$$typeof,t===gg)return 11;if(t===yg)return 14}return 2}function Ls(t,e){var n=t.alternate;return n===null?(n=zn(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Bu(t,e,n,r,s,i){var o=2;if(r=t,typeof t=="function")Xg(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case Po:return Ai(n.children,s,i,e);case mg:o=8,s|=8;break;case Dp:return t=zn(12,n,e,s|2),t.elementType=Dp,t.lanes=i,t;case jp:return t=zn(13,n,e,s),t.elementType=jp,t.lanes=i,t;case Op:return t=zn(19,n,e,s),t.elementType=Op,t.lanes=i,t;case PT:return Eh(n,s,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case AT:o=10;break e;case RT:o=9;break e;case gg:o=11;break e;case yg:o=14;break e;case gs:o=16,r=null;break e}throw Error(K(130,t==null?t:typeof t,""))}return e=zn(o,n,e,s),e.elementType=t,e.type=r,e.lanes=i,e}function Ai(t,e,n,r){return t=zn(7,t,r,e),t.lanes=n,t}function Eh(t,e,n,r){return t=zn(22,t,r,e),t.elementType=PT,t.lanes=n,t.stateNode={isHidden:!1},t}function ep(t,e,n){return t=zn(6,t,null,e),t.lanes=n,t}function tp(t,e,n){return e=zn(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function AP(t,e,n,r,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Of(0),this.expirationTimes=Of(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Of(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function Jg(t,e,n,r,s,i,o,a,l){return t=new AP(t,e,n,a,l),e===1?(e=1,i===!0&&(e|=8)):e=0,i=zn(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Og(i),t}function RP(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Ro,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function Ex(t){if(!t)return Hs;t=t._reactInternals;e:{if(to(t)!==t||t.tag!==1)throw Error(K(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Tn(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(K(171))}if(t.tag===1){var n=t.type;if(Tn(n))return E0(t,n,e)}return e}function Ix(t,e,n,r,s,i,o,a,l){return t=Jg(n,r,!0,t,s,i,o,a,l),t.context=Ex(null),n=t.current,r=fn(),s=Vs(n),i=zr(r,s),i.callback=e??null,js(n,i,s),t.current.lanes=s,wc(t,s,r),xn(t,r),t}function Ih(t,e,n,r){var s=e.current,i=fn(),o=Vs(s);return n=Ex(n),e.context===null?e.context=n:e.pendingContext=n,e=zr(i,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=js(s,e,o),t!==null&&(or(t,s,o,i),Vu(t,s,o)),o}function Pd(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function Sw(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function Zg(t,e){Sw(t,e),(t=t.alternate)&&Sw(t,e)}function PP(){return null}var Tx=typeof reportError=="function"?reportError:function(t){console.error(t)};function ey(t){this._internalRoot=t}Th.prototype.render=ey.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(K(409));Ih(t,e,null,null)};Th.prototype.unmount=ey.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Fi(function(){Ih(null,t,null,null)}),e[Wr]=null}};function Th(t){this._internalRoot=t}Th.prototype.unstable_scheduleHydration=function(t){if(t){var e=e0();t={blockedOn:null,target:t,priority:e};for(var n=0;n<_s.length&&e!==0&&e<_s[n].priority;n++);_s.splice(n,0,t),n===0&&n0(t)}};function ty(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function xh(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function bw(){}function NP(t,e,n,r,s){if(s){if(typeof r=="function"){var i=r;r=function(){var d=Pd(o);i.call(d)}}var o=Ix(e,r,t,0,null,!1,!1,"",bw);return t._reactRootContainer=o,t[Wr]=o.current,Ql(t.nodeType===8?t.parentNode:t),Fi(),o}for(;s=t.lastChild;)t.removeChild(s);if(typeof r=="function"){var a=r;r=function(){var d=Pd(l);a.call(d)}}var l=Jg(t,0,!1,null,null,!1,!1,"",bw);return t._reactRootContainer=l,t[Wr]=l.current,Ql(t.nodeType===8?t.parentNode:t),Fi(function(){Ih(e,l,n,r)}),l}function Sh(t,e,n,r,s){var i=n._reactRootContainer;if(i){var o=i;if(typeof s=="function"){var a=s;s=function(){var l=Pd(o);a.call(l)}}Ih(e,o,t,s)}else o=NP(n,e,t,s,r);return Pd(o)}JT=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=dl(e.pendingLanes);n!==0&&(wg(e,n|1),xn(e,bt()),!(ze&6)&&(la=bt()+500,Zs()))}break;case 13:Fi(function(){var r=Kr(t,1);if(r!==null){var s=fn();or(r,t,1,s)}}),Zg(t,1)}};Eg=function(t){if(t.tag===13){var e=Kr(t,134217728);if(e!==null){var n=fn();or(e,t,134217728,n)}Zg(t,134217728)}};ZT=function(t){if(t.tag===13){var e=Vs(t),n=Kr(t,e);if(n!==null){var r=fn();or(n,t,e,r)}Zg(t,e)}};e0=function(){return Je};t0=function(t,e){var n=Je;try{return Je=t,e()}finally{Je=n}};Hp=function(t,e,n){switch(e){case"input":if(Mp(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var s=mh(r);if(!s)throw Error(K(90));kT(r),Mp(r,s)}}}break;case"textarea":jT(t,n);break;case"select":e=n.value,e!=null&&Bo(t,!!n.multiple,e,!1)}};$T=Gg;BT=Fi;var kP={usingClientEntryPoint:!1,Events:[Ic,jo,mh,FT,UT,Gg]},el={findFiberByHostInstance:Ii,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},DP={bundleType:el.bundleType,version:el.version,rendererPackageName:el.rendererPackageName,rendererConfig:el.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ts.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=HT(t),t===null?null:t.stateNode},findFiberByHostInstance:el.findFiberByHostInstance||PP,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var gu=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!gu.isDisabled&&gu.supportsFiber)try{dh=gu.inject(DP),Cr=gu}catch{}}Vn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=kP;Vn.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!ty(e))throw Error(K(200));return RP(t,e,null,n)};Vn.createRoot=function(t,e){if(!ty(t))throw Error(K(299));var n=!1,r="",s=Tx;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=Jg(t,1,!1,null,null,n,!1,r,s),t[Wr]=e.current,Ql(t.nodeType===8?t.parentNode:t),new ey(e)};Vn.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(K(188)):(t=Object.keys(t).join(","),Error(K(268,t)));return t=HT(e),t=t===null?null:t.stateNode,t};Vn.flushSync=function(t){return Fi(t)};Vn.hydrate=function(t,e,n){if(!xh(e))throw Error(K(200));return Sh(null,t,e,!0,n)};Vn.hydrateRoot=function(t,e,n){if(!ty(t))throw Error(K(405));var r=n!=null&&n.hydratedSources||null,s=!1,i="",o=Tx;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=Ix(e,null,t,1,n??null,s,!1,i,o),t[Wr]=e.current,Ql(t),r)for(t=0;t<r.length;t++)n=r[t],s=n._getVersion,s=s(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,s]:e.mutableSourceEagerHydrationData.push(n,s);return new Th(e)};Vn.render=function(t,e,n){if(!xh(e))throw Error(K(200));return Sh(null,t,e,!1,n)};Vn.unmountComponentAtNode=function(t){if(!xh(t))throw Error(K(40));return t._reactRootContainer?(Fi(function(){Sh(null,null,t,!1,function(){t._reactRootContainer=null,t[Wr]=null})}),!0):!1};Vn.unstable_batchedUpdates=Gg;Vn.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!xh(n))throw Error(K(200));if(t==null||t._reactInternals===void 0)throw Error(K(38));return Sh(t,e,n,!1,r)};Vn.version="18.3.1-next-f1338f8080-20240426";function xx(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(xx)}catch(t){console.error(t)}}xx(),xT.exports=Vn;var jP=xT.exports,Sx,Cw=jP;Sx=Cw.createRoot,Cw.hydrateRoot;/**
 * react-router v7.9.6
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var Aw="popstate";function OP(t={}){function e(r,s){let{pathname:i,search:o,hash:a}=r.location;return xm("",{pathname:i,search:o,hash:a},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function n(r,s){return typeof s=="string"?s:sc(s)}return LP(e,n,null,t)}function dt(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function Qn(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function VP(){return Math.random().toString(36).substring(2,10)}function Rw(t,e){return{usr:t.state,key:t.key,idx:e}}function xm(t,e,n=null,r){return{pathname:typeof t=="string"?t:t.pathname,search:"",hash:"",...typeof e=="string"?ba(e):e,state:n,key:e&&e.key||r||VP()}}function sc({pathname:t="/",search:e="",hash:n=""}){return e&&e!=="?"&&(t+=e.charAt(0)==="?"?e:"?"+e),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function ba(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substring(n),t=t.substring(0,n));let r=t.indexOf("?");r>=0&&(e.search=t.substring(r),t=t.substring(0,r)),t&&(e.pathname=t)}return e}function LP(t,e,n,r={}){let{window:s=document.defaultView,v5Compat:i=!1}=r,o=s.history,a="POP",l=null,d=h();d==null&&(d=0,o.replaceState({...o.state,idx:d},""));function h(){return(o.state||{idx:null}).idx}function f(){a="POP";let A=h(),T=A==null?null:A-d;d=A,l&&l({action:a,location:b.location,delta:T})}function m(A,T){a="PUSH";let E=xm(b.location,A,T);d=h()+1;let y=Rw(E,d),j=b.createHref(E);try{o.pushState(y,"",j)}catch(V){if(V instanceof DOMException&&V.name==="DataCloneError")throw V;s.location.assign(j)}i&&l&&l({action:a,location:b.location,delta:1})}function w(A,T){a="REPLACE";let E=xm(b.location,A,T);d=h();let y=Rw(E,d),j=b.createHref(E);o.replaceState(y,"",j),i&&l&&l({action:a,location:b.location,delta:0})}function R(A){return MP(A)}let b={get action(){return a},get location(){return t(s,o)},listen(A){if(l)throw new Error("A history only accepts one active listener");return s.addEventListener(Aw,f),l=A,()=>{s.removeEventListener(Aw,f),l=null}},createHref(A){return e(s,A)},createURL:R,encodeLocation(A){let T=R(A);return{pathname:T.pathname,search:T.search,hash:T.hash}},push:m,replace:w,go(A){return o.go(A)}};return b}function MP(t,e=!1){let n="http://localhost";typeof window<"u"&&(n=window.location.origin!=="null"?window.location.origin:window.location.href),dt(n,"No window.location.(origin|href) available to create URL");let r=typeof t=="string"?t:sc(t);return r=r.replace(/ $/,"%20"),!e&&r.startsWith("//")&&(r=n+r),new URL(r,n)}function bx(t,e,n="/"){return FP(t,e,n,!1)}function FP(t,e,n,r){let s=typeof e=="string"?ba(e):e,i=Qr(s.pathname||"/",n);if(i==null)return null;let o=Cx(t);UP(o);let a=null;for(let l=0;a==null&&l<o.length;++l){let d=XP(i);a=QP(o[l],d,r)}return a}function Cx(t,e=[],n=[],r="",s=!1){let i=(o,a,l=s,d)=>{let h={relativePath:d===void 0?o.path||"":d,caseSensitive:o.caseSensitive===!0,childrenIndex:a,route:o};if(h.relativePath.startsWith("/")){if(!h.relativePath.startsWith(r)&&l)return;dt(h.relativePath.startsWith(r),`Absolute route path "${h.relativePath}" nested under path "${r}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),h.relativePath=h.relativePath.slice(r.length)}let f=qr([r,h.relativePath]),m=n.concat(h);o.children&&o.children.length>0&&(dt(o.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${f}".`),Cx(o.children,e,m,f,l)),!(o.path==null&&!o.index)&&e.push({path:f,score:KP(f,o.index),routesMeta:m})};return t.forEach((o,a)=>{var l;if(o.path===""||!((l=o.path)!=null&&l.includes("?")))i(o,a);else for(let d of Ax(o.path))i(o,a,!0,d)}),e}function Ax(t){let e=t.split("/");if(e.length===0)return[];let[n,...r]=e,s=n.endsWith("?"),i=n.replace(/\?$/,"");if(r.length===0)return s?[i,""]:[i];let o=Ax(r.join("/")),a=[];return a.push(...o.map(l=>l===""?i:[i,l].join("/"))),s&&a.push(...o),a.map(l=>t.startsWith("/")&&l===""?"/":l)}function UP(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:GP(e.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}var $P=/^:[\w-]+$/,BP=3,zP=2,qP=1,HP=10,WP=-2,Pw=t=>t==="*";function KP(t,e){let n=t.split("/"),r=n.length;return n.some(Pw)&&(r+=WP),e&&(r+=zP),n.filter(s=>!Pw(s)).reduce((s,i)=>s+($P.test(i)?BP:i===""?qP:HP),r)}function GP(t,e){return t.length===e.length&&t.slice(0,-1).every((r,s)=>r===e[s])?t[t.length-1]-e[e.length-1]:0}function QP(t,e,n=!1){let{routesMeta:r}=t,s={},i="/",o=[];for(let a=0;a<r.length;++a){let l=r[a],d=a===r.length-1,h=i==="/"?e:e.slice(i.length)||"/",f=Nd({path:l.relativePath,caseSensitive:l.caseSensitive,end:d},h),m=l.route;if(!f&&d&&n&&!r[r.length-1].route.index&&(f=Nd({path:l.relativePath,caseSensitive:l.caseSensitive,end:!1},h)),!f)return null;Object.assign(s,f.params),o.push({params:s,pathname:qr([i,f.pathname]),pathnameBase:nN(qr([i,f.pathnameBase])),route:m}),f.pathnameBase!=="/"&&(i=qr([i,f.pathnameBase]))}return o}function Nd(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,r]=YP(t.path,t.caseSensitive,t.end),s=e.match(n);if(!s)return null;let i=s[0],o=i.replace(/(.)\/+$/,"$1"),a=s.slice(1);return{params:r.reduce((d,{paramName:h,isOptional:f},m)=>{if(h==="*"){let R=a[m]||"";o=i.slice(0,i.length-R.length).replace(/(.)\/+$/,"$1")}const w=a[m];return f&&!w?d[h]=void 0:d[h]=(w||"").replace(/%2F/g,"/"),d},{}),pathname:i,pathnameBase:o,pattern:t}}function YP(t,e=!1,n=!0){Qn(t==="*"||!t.endsWith("*")||t.endsWith("/*"),`Route path "${t}" will be treated as if it were "${t.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${t.replace(/\*$/,"/*")}".`);let r=[],s="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,a,l)=>(r.push({paramName:a,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return t.endsWith("*")?(r.push({paramName:"*"}),s+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?s+="\\/*$":t!==""&&t!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,e?void 0:"i"),r]}function XP(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Qn(!1,`The URL path "${t}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),t}}function Qr(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,r=t.charAt(n);return r&&r!=="/"?null:t.slice(n)||"/"}var JP=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,ZP=t=>JP.test(t);function eN(t,e="/"){let{pathname:n,search:r="",hash:s=""}=typeof t=="string"?ba(t):t,i;if(n)if(ZP(n))i=n;else{if(n.includes("//")){let o=n;n=n.replace(/\/\/+/g,"/"),Qn(!1,`Pathnames cannot have embedded double slashes - normalizing ${o} -> ${n}`)}n.startsWith("/")?i=Nw(n.substring(1),"/"):i=Nw(n,e)}else i=e;return{pathname:i,search:rN(r),hash:sN(s)}}function Nw(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(s=>{s===".."?n.length>1&&n.pop():s!=="."&&n.push(s)}),n.length>1?n.join("/"):"/"}function np(t,e,n,r){return`Cannot include a '${t}' character in a manually specified \`to.${e}\` field [${JSON.stringify(r)}].  Please separate it out to the \`to.${n}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function tN(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function ny(t){let e=tN(t);return e.map((n,r)=>r===e.length-1?n.pathname:n.pathnameBase)}function ry(t,e,n,r=!1){let s;typeof t=="string"?s=ba(t):(s={...t},dt(!s.pathname||!s.pathname.includes("?"),np("?","pathname","search",s)),dt(!s.pathname||!s.pathname.includes("#"),np("#","pathname","hash",s)),dt(!s.search||!s.search.includes("#"),np("#","search","hash",s)));let i=t===""||s.pathname==="",o=i?"/":s.pathname,a;if(o==null)a=n;else{let f=e.length-1;if(!r&&o.startsWith("..")){let m=o.split("/");for(;m[0]==="..";)m.shift(),f-=1;s.pathname=m.join("/")}a=f>=0?e[f]:"/"}let l=eN(s,a),d=o&&o!=="/"&&o.endsWith("/"),h=(i||o===".")&&n.endsWith("/");return!l.pathname.endsWith("/")&&(d||h)&&(l.pathname+="/"),l}var qr=t=>t.join("/").replace(/\/\/+/g,"/"),nN=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),rN=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,sN=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function iN(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var Rx=["POST","PUT","PATCH","DELETE"];new Set(Rx);var oN=["GET",...Rx];new Set(oN);var Ca=N.createContext(null);Ca.displayName="DataRouter";var bh=N.createContext(null);bh.displayName="DataRouterState";N.createContext(!1);var Px=N.createContext({isTransitioning:!1});Px.displayName="ViewTransition";var aN=N.createContext(new Map);aN.displayName="Fetchers";var lN=N.createContext(null);lN.displayName="Await";var hr=N.createContext(null);hr.displayName="Navigation";var xc=N.createContext(null);xc.displayName="Location";var jr=N.createContext({outlet:null,matches:[],isDataRoute:!1});jr.displayName="Route";var sy=N.createContext(null);sy.displayName="RouteError";function cN(t,{relative:e}={}){dt(Aa(),"useHref() may be used only in the context of a <Router> component.");let{basename:n,navigator:r}=N.useContext(hr),{hash:s,pathname:i,search:o}=bc(t,{relative:e}),a=i;return n!=="/"&&(a=i==="/"?n:qr([n,i])),r.createHref({pathname:a,search:o,hash:s})}function Aa(){return N.useContext(xc)!=null}function Or(){return dt(Aa(),"useLocation() may be used only in the context of a <Router> component."),N.useContext(xc).location}var Nx="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function kx(t){N.useContext(hr).static||N.useLayoutEffect(t)}function Sc(){let{isDataRoute:t}=N.useContext(jr);return t?IN():uN()}function uN(){dt(Aa(),"useNavigate() may be used only in the context of a <Router> component.");let t=N.useContext(Ca),{basename:e,navigator:n}=N.useContext(hr),{matches:r}=N.useContext(jr),{pathname:s}=Or(),i=JSON.stringify(ny(r)),o=N.useRef(!1);return kx(()=>{o.current=!0}),N.useCallback((l,d={})=>{if(Qn(o.current,Nx),!o.current)return;if(typeof l=="number"){n.go(l);return}let h=ry(l,JSON.parse(i),s,d.relative==="path");t==null&&e!=="/"&&(h.pathname=h.pathname==="/"?e:qr([e,h.pathname])),(d.replace?n.replace:n.push)(h,d.state,d)},[e,n,i,s,t])}N.createContext(null);function bc(t,{relative:e}={}){let{matches:n}=N.useContext(jr),{pathname:r}=Or(),s=JSON.stringify(ny(n));return N.useMemo(()=>ry(t,JSON.parse(s),r,e==="path"),[t,s,r,e])}function dN(t,e){return Dx(t,e)}function Dx(t,e,n,r,s){var E;dt(Aa(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:i}=N.useContext(hr),{matches:o}=N.useContext(jr),a=o[o.length-1],l=a?a.params:{},d=a?a.pathname:"/",h=a?a.pathnameBase:"/",f=a&&a.route;{let y=f&&f.path||"";jx(d,!f||y.endsWith("*")||y.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${d}" (under <Route path="${y}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${y}"> to <Route path="${y==="/"?"*":`${y}/*`}">.`)}let m=Or(),w;if(e){let y=typeof e=="string"?ba(e):e;dt(h==="/"||((E=y.pathname)==null?void 0:E.startsWith(h)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${h}" but pathname "${y.pathname}" was given in the \`location\` prop.`),w=y}else w=m;let R=w.pathname||"/",b=R;if(h!=="/"){let y=h.replace(/^\//,"").split("/");b="/"+R.replace(/^\//,"").split("/").slice(y.length).join("/")}let A=bx(t,{pathname:b});Qn(f||A!=null,`No routes matched location "${w.pathname}${w.search}${w.hash}" `),Qn(A==null||A[A.length-1].route.element!==void 0||A[A.length-1].route.Component!==void 0||A[A.length-1].route.lazy!==void 0,`Matched leaf route at location "${w.pathname}${w.search}${w.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let T=gN(A&&A.map(y=>Object.assign({},y,{params:Object.assign({},l,y.params),pathname:qr([h,i.encodeLocation?i.encodeLocation(y.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:y.pathname]),pathnameBase:y.pathnameBase==="/"?h:qr([h,i.encodeLocation?i.encodeLocation(y.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:y.pathnameBase])})),o,n,r,s);return e&&T?N.createElement(xc.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...w},navigationType:"POP"}},T):T}function hN(){let t=EN(),e=iN(t)?`${t.status} ${t.statusText}`:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,r="rgba(200,200,200, 0.5)",s={padding:"0.5rem",backgroundColor:r},i={padding:"2px 4px",backgroundColor:r},o=null;return console.error("Error handled by React Router default ErrorBoundary:",t),o=N.createElement(N.Fragment,null,N.createElement("p",null," Hey developer "),N.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",N.createElement("code",{style:i},"ErrorBoundary")," or"," ",N.createElement("code",{style:i},"errorElement")," prop on your route.")),N.createElement(N.Fragment,null,N.createElement("h2",null,"Unexpected Application Error!"),N.createElement("h3",{style:{fontStyle:"italic"}},e),n?N.createElement("pre",{style:s},n):null,o)}var fN=N.createElement(hN,null),pN=class extends N.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,e){return e.location!==t.location||e.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:e.error,location:e.location,revalidation:t.revalidation||e.revalidation}}componentDidCatch(t,e){this.props.onError?this.props.onError(t,e):console.error("React Router caught the following error during render",t)}render(){return this.state.error!==void 0?N.createElement(jr.Provider,{value:this.props.routeContext},N.createElement(sy.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function mN({routeContext:t,match:e,children:n}){let r=N.useContext(Ca);return r&&r.static&&r.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=e.route.id),N.createElement(jr.Provider,{value:t},n)}function gN(t,e=[],n=null,r=null,s=null){if(t==null){if(!n)return null;if(n.errors)t=n.matches;else if(e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let i=t,o=n==null?void 0:n.errors;if(o!=null){let h=i.findIndex(f=>f.route.id&&(o==null?void 0:o[f.route.id])!==void 0);dt(h>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(o).join(",")}`),i=i.slice(0,Math.min(i.length,h+1))}let a=!1,l=-1;if(n)for(let h=0;h<i.length;h++){let f=i[h];if((f.route.HydrateFallback||f.route.hydrateFallbackElement)&&(l=h),f.route.id){let{loaderData:m,errors:w}=n,R=f.route.loader&&!m.hasOwnProperty(f.route.id)&&(!w||w[f.route.id]===void 0);if(f.route.lazy||R){a=!0,l>=0?i=i.slice(0,l+1):i=[i[0]];break}}}let d=n&&r?(h,f)=>{var m,w;r(h,{location:n.location,params:((w=(m=n.matches)==null?void 0:m[0])==null?void 0:w.params)??{},errorInfo:f})}:void 0;return i.reduceRight((h,f,m)=>{let w,R=!1,b=null,A=null;n&&(w=o&&f.route.id?o[f.route.id]:void 0,b=f.route.errorElement||fN,a&&(l<0&&m===0?(jx("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),R=!0,A=null):l===m&&(R=!0,A=f.route.hydrateFallbackElement||null)));let T=e.concat(i.slice(0,m+1)),E=()=>{let y;return w?y=b:R?y=A:f.route.Component?y=N.createElement(f.route.Component,null):f.route.element?y=f.route.element:y=h,N.createElement(mN,{match:f,routeContext:{outlet:h,matches:T,isDataRoute:n!=null},children:y})};return n&&(f.route.ErrorBoundary||f.route.errorElement||m===0)?N.createElement(pN,{location:n.location,revalidation:n.revalidation,component:b,error:w,children:E(),routeContext:{outlet:null,matches:T,isDataRoute:!0},onError:d}):E()},null)}function iy(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function yN(t){let e=N.useContext(Ca);return dt(e,iy(t)),e}function _N(t){let e=N.useContext(bh);return dt(e,iy(t)),e}function vN(t){let e=N.useContext(jr);return dt(e,iy(t)),e}function oy(t){let e=vN(t),n=e.matches[e.matches.length-1];return dt(n.route.id,`${t} can only be used on routes that contain a unique "id"`),n.route.id}function wN(){return oy("useRouteId")}function EN(){var r;let t=N.useContext(sy),e=_N("useRouteError"),n=oy("useRouteError");return t!==void 0?t:(r=e.errors)==null?void 0:r[n]}function IN(){let{router:t}=yN("useNavigate"),e=oy("useNavigate"),n=N.useRef(!1);return kx(()=>{n.current=!0}),N.useCallback(async(s,i={})=>{Qn(n.current,Nx),n.current&&(typeof s=="number"?t.navigate(s):await t.navigate(s,{fromRouteId:e,...i}))},[t,e])}var kw={};function jx(t,e,n){!e&&!kw[t]&&(kw[t]=!0,Qn(!1,n))}N.memo(TN);function TN({routes:t,future:e,state:n,unstable_onError:r}){return Dx(t,void 0,n,r,e)}function kd({to:t,replace:e,state:n,relative:r}){dt(Aa(),"<Navigate> may be used only in the context of a <Router> component.");let{static:s}=N.useContext(hr);Qn(!s,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:i}=N.useContext(jr),{pathname:o}=Or(),a=Sc(),l=ry(t,ny(i),o,r==="path"),d=JSON.stringify(l);return N.useEffect(()=>{a(JSON.parse(d),{replace:e,state:n,relative:r})},[a,d,r,e,n]),null}function To(t){dt(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function xN({basename:t="/",children:e=null,location:n,navigationType:r="POP",navigator:s,static:i=!1}){dt(!Aa(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let o=t.replace(/^\/*/,"/"),a=N.useMemo(()=>({basename:o,navigator:s,static:i,future:{}}),[o,s,i]);typeof n=="string"&&(n=ba(n));let{pathname:l="/",search:d="",hash:h="",state:f=null,key:m="default"}=n,w=N.useMemo(()=>{let R=Qr(l,o);return R==null?null:{location:{pathname:R,search:d,hash:h,state:f,key:m},navigationType:r}},[o,l,d,h,f,m,r]);return Qn(w!=null,`<Router basename="${o}"> is not able to match the URL "${l}${d}${h}" because it does not start with the basename, so the <Router> won't render anything.`),w==null?null:N.createElement(hr.Provider,{value:a},N.createElement(xc.Provider,{children:e,value:w}))}function SN({children:t,location:e}){return dN(Sm(t),e)}function Sm(t,e=[]){let n=[];return N.Children.forEach(t,(r,s)=>{if(!N.isValidElement(r))return;let i=[...e,s];if(r.type===N.Fragment){n.push.apply(n,Sm(r.props.children,i));return}dt(r.type===To,`[${typeof r.type=="string"?r.type:r.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),dt(!r.props.index||!r.props.children,"An index route cannot have child routes.");let o={id:r.props.id||i.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,middleware:r.props.middleware,loader:r.props.loader,action:r.props.action,hydrateFallbackElement:r.props.hydrateFallbackElement,HydrateFallback:r.props.HydrateFallback,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.hasErrorBoundary===!0||r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(o.children=Sm(r.props.children,i)),n.push(o)}),n}var zu="get",qu="application/x-www-form-urlencoded";function Ch(t){return t!=null&&typeof t.tagName=="string"}function bN(t){return Ch(t)&&t.tagName.toLowerCase()==="button"}function CN(t){return Ch(t)&&t.tagName.toLowerCase()==="form"}function AN(t){return Ch(t)&&t.tagName.toLowerCase()==="input"}function RN(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function PN(t,e){return t.button===0&&(!e||e==="_self")&&!RN(t)}var yu=null;function NN(){if(yu===null)try{new FormData(document.createElement("form"),0),yu=!1}catch{yu=!0}return yu}var kN=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function rp(t){return t!=null&&!kN.has(t)?(Qn(!1,`"${t}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${qu}"`),null):t}function DN(t,e){let n,r,s,i,o;if(CN(t)){let a=t.getAttribute("action");r=a?Qr(a,e):null,n=t.getAttribute("method")||zu,s=rp(t.getAttribute("enctype"))||qu,i=new FormData(t)}else if(bN(t)||AN(t)&&(t.type==="submit"||t.type==="image")){let a=t.form;if(a==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let l=t.getAttribute("formaction")||a.getAttribute("action");if(r=l?Qr(l,e):null,n=t.getAttribute("formmethod")||a.getAttribute("method")||zu,s=rp(t.getAttribute("formenctype"))||rp(a.getAttribute("enctype"))||qu,i=new FormData(a,t),!NN()){let{name:d,type:h,value:f}=t;if(h==="image"){let m=d?`${d}.`:"";i.append(`${m}x`,"0"),i.append(`${m}y`,"0")}else d&&i.append(d,f)}}else{if(Ch(t))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');n=zu,r=null,s=qu,o=t}return i&&s==="text/plain"&&(o=i,i=void 0),{action:r,method:n.toLowerCase(),encType:s,formData:i,body:o}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function ay(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function jN(t,e,n){let r=typeof t=="string"?new URL(t,typeof window>"u"?"server://singlefetch/":window.location.origin):t;return r.pathname==="/"?r.pathname=`_root.${n}`:e&&Qr(r.pathname,e)==="/"?r.pathname=`${e.replace(/\/$/,"")}/_root.${n}`:r.pathname=`${r.pathname.replace(/\/$/,"")}.${n}`,r}async function ON(t,e){if(t.id in e)return e[t.id];try{let n=await import(t.module);return e[t.id]=n,n}catch(n){return console.error(`Error loading route module \`${t.module}\`, reloading page...`),console.error(n),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function VN(t){return t==null?!1:t.href==null?t.rel==="preload"&&typeof t.imageSrcSet=="string"&&typeof t.imageSizes=="string":typeof t.rel=="string"&&typeof t.href=="string"}async function LN(t,e,n){let r=await Promise.all(t.map(async s=>{let i=e.routes[s.route.id];if(i){let o=await ON(i,n);return o.links?o.links():[]}return[]}));return $N(r.flat(1).filter(VN).filter(s=>s.rel==="stylesheet"||s.rel==="preload").map(s=>s.rel==="stylesheet"?{...s,rel:"prefetch",as:"style"}:{...s,rel:"prefetch"}))}function Dw(t,e,n,r,s,i){let o=(l,d)=>n[d]?l.route.id!==n[d].route.id:!0,a=(l,d)=>{var h;return n[d].pathname!==l.pathname||((h=n[d].route.path)==null?void 0:h.endsWith("*"))&&n[d].params["*"]!==l.params["*"]};return i==="assets"?e.filter((l,d)=>o(l,d)||a(l,d)):i==="data"?e.filter((l,d)=>{var f;let h=r.routes[l.route.id];if(!h||!h.hasLoader)return!1;if(o(l,d)||a(l,d))return!0;if(l.route.shouldRevalidate){let m=l.route.shouldRevalidate({currentUrl:new URL(s.pathname+s.search+s.hash,window.origin),currentParams:((f=n[0])==null?void 0:f.params)||{},nextUrl:new URL(t,window.origin),nextParams:l.params,defaultShouldRevalidate:!0});if(typeof m=="boolean")return m}return!0}):[]}function MN(t,e,{includeHydrateFallback:n}={}){return FN(t.map(r=>{let s=e.routes[r.route.id];if(!s)return[];let i=[s.module];return s.clientActionModule&&(i=i.concat(s.clientActionModule)),s.clientLoaderModule&&(i=i.concat(s.clientLoaderModule)),n&&s.hydrateFallbackModule&&(i=i.concat(s.hydrateFallbackModule)),s.imports&&(i=i.concat(s.imports)),i}).flat(1))}function FN(t){return[...new Set(t)]}function UN(t){let e={},n=Object.keys(t).sort();for(let r of n)e[r]=t[r];return e}function $N(t,e){let n=new Set;return new Set(e),t.reduce((r,s)=>{let i=JSON.stringify(UN(s));return n.has(i)||(n.add(i),r.push({key:i,link:s})),r},[])}function Ox(){let t=N.useContext(Ca);return ay(t,"You must render this element inside a <DataRouterContext.Provider> element"),t}function BN(){let t=N.useContext(bh);return ay(t,"You must render this element inside a <DataRouterStateContext.Provider> element"),t}var ly=N.createContext(void 0);ly.displayName="FrameworkContext";function Vx(){let t=N.useContext(ly);return ay(t,"You must render this element inside a <HydratedRouter> element"),t}function zN(t,e){let n=N.useContext(ly),[r,s]=N.useState(!1),[i,o]=N.useState(!1),{onFocus:a,onBlur:l,onMouseEnter:d,onMouseLeave:h,onTouchStart:f}=e,m=N.useRef(null);N.useEffect(()=>{if(t==="render"&&o(!0),t==="viewport"){let b=T=>{T.forEach(E=>{o(E.isIntersecting)})},A=new IntersectionObserver(b,{threshold:.5});return m.current&&A.observe(m.current),()=>{A.disconnect()}}},[t]),N.useEffect(()=>{if(r){let b=setTimeout(()=>{o(!0)},100);return()=>{clearTimeout(b)}}},[r]);let w=()=>{s(!0)},R=()=>{s(!1),o(!1)};return n?t!=="intent"?[i,m,{}]:[i,m,{onFocus:tl(a,w),onBlur:tl(l,R),onMouseEnter:tl(d,w),onMouseLeave:tl(h,R),onTouchStart:tl(f,w)}]:[!1,m,{}]}function tl(t,e){return n=>{t&&t(n),n.defaultPrevented||e(n)}}function qN({page:t,...e}){let{router:n}=Ox(),r=N.useMemo(()=>bx(n.routes,t,n.basename),[n.routes,t,n.basename]);return r?N.createElement(WN,{page:t,matches:r,...e}):null}function HN(t){let{manifest:e,routeModules:n}=Vx(),[r,s]=N.useState([]);return N.useEffect(()=>{let i=!1;return LN(t,e,n).then(o=>{i||s(o)}),()=>{i=!0}},[t,e,n]),r}function WN({page:t,matches:e,...n}){let r=Or(),{manifest:s,routeModules:i}=Vx(),{basename:o}=Ox(),{loaderData:a,matches:l}=BN(),d=N.useMemo(()=>Dw(t,e,l,s,r,"data"),[t,e,l,s,r]),h=N.useMemo(()=>Dw(t,e,l,s,r,"assets"),[t,e,l,s,r]),f=N.useMemo(()=>{if(t===r.pathname+r.search+r.hash)return[];let R=new Set,b=!1;if(e.forEach(T=>{var y;let E=s.routes[T.route.id];!E||!E.hasLoader||(!d.some(j=>j.route.id===T.route.id)&&T.route.id in a&&((y=i[T.route.id])!=null&&y.shouldRevalidate)||E.hasClientLoader?b=!0:R.add(T.route.id))}),R.size===0)return[];let A=jN(t,o,"data");return b&&R.size>0&&A.searchParams.set("_routes",e.filter(T=>R.has(T.route.id)).map(T=>T.route.id).join(",")),[A.pathname+A.search]},[o,a,r,s,d,e,t,i]),m=N.useMemo(()=>MN(h,s),[h,s]),w=HN(h);return N.createElement(N.Fragment,null,f.map(R=>N.createElement("link",{key:R,rel:"prefetch",as:"fetch",href:R,...n})),m.map(R=>N.createElement("link",{key:R,rel:"modulepreload",href:R,...n})),w.map(({key:R,link:b})=>N.createElement("link",{key:R,nonce:n.nonce,...b})))}function KN(...t){return e=>{t.forEach(n=>{typeof n=="function"?n(e):n!=null&&(n.current=e)})}}var Lx=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{Lx&&(window.__reactRouterVersion="7.9.6")}catch{}function GN({basename:t,children:e,window:n}){let r=N.useRef();r.current==null&&(r.current=OP({window:n,v5Compat:!0}));let s=r.current,[i,o]=N.useState({action:s.action,location:s.location}),a=N.useCallback(l=>{N.startTransition(()=>o(l))},[o]);return N.useLayoutEffect(()=>s.listen(a),[s,a]),N.createElement(xN,{basename:t,children:e,location:i.location,navigationType:i.action,navigator:s})}var Mx=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Fx=N.forwardRef(function({onClick:e,discover:n="render",prefetch:r="none",relative:s,reloadDocument:i,replace:o,state:a,target:l,to:d,preventScrollReset:h,viewTransition:f,...m},w){let{basename:R}=N.useContext(hr),b=typeof d=="string"&&Mx.test(d),A,T=!1;if(typeof d=="string"&&b&&(A=d,Lx))try{let S=new URL(window.location.href),C=d.startsWith("//")?new URL(S.protocol+d):new URL(d),k=Qr(C.pathname,R);C.origin===S.origin&&k!=null?d=k+C.search+C.hash:T=!0}catch{Qn(!1,`<Link to="${d}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let E=cN(d,{relative:s}),[y,j,V]=zN(r,m),M=XN(d,{replace:o,state:a,target:l,preventScrollReset:h,relative:s,viewTransition:f});function x(S){e&&e(S),S.defaultPrevented||M(S)}let _=N.createElement("a",{...m,...V,href:A||E,onClick:T||i?e:x,ref:KN(w,j),target:l,"data-discover":!b&&n==="render"?"true":void 0});return y&&!b?N.createElement(N.Fragment,null,_,N.createElement(qN,{page:E})):_});Fx.displayName="Link";var xo=N.forwardRef(function({"aria-current":e="page",caseSensitive:n=!1,className:r="",end:s=!1,style:i,to:o,viewTransition:a,children:l,...d},h){let f=bc(o,{relative:d.relative}),m=Or(),w=N.useContext(bh),{navigator:R,basename:b}=N.useContext(hr),A=w!=null&&nk(f)&&a===!0,T=R.encodeLocation?R.encodeLocation(f).pathname:f.pathname,E=m.pathname,y=w&&w.navigation&&w.navigation.location?w.navigation.location.pathname:null;n||(E=E.toLowerCase(),y=y?y.toLowerCase():null,T=T.toLowerCase()),y&&b&&(y=Qr(y,b)||y);const j=T!=="/"&&T.endsWith("/")?T.length-1:T.length;let V=E===T||!s&&E.startsWith(T)&&E.charAt(j)==="/",M=y!=null&&(y===T||!s&&y.startsWith(T)&&y.charAt(T.length)==="/"),x={isActive:V,isPending:M,isTransitioning:A},_=V?e:void 0,S;typeof r=="function"?S=r(x):S=[r,V?"active":null,M?"pending":null,A?"transitioning":null].filter(Boolean).join(" ");let C=typeof i=="function"?i(x):i;return N.createElement(Fx,{...d,"aria-current":_,className:S,ref:h,style:C,to:o,viewTransition:a},typeof l=="function"?l(x):l)});xo.displayName="NavLink";var QN=N.forwardRef(({discover:t="render",fetcherKey:e,navigate:n,reloadDocument:r,replace:s,state:i,method:o=zu,action:a,onSubmit:l,relative:d,preventScrollReset:h,viewTransition:f,...m},w)=>{let R=ek(),b=tk(a,{relative:d}),A=o.toLowerCase()==="get"?"get":"post",T=typeof a=="string"&&Mx.test(a),E=y=>{if(l&&l(y),y.defaultPrevented)return;y.preventDefault();let j=y.nativeEvent.submitter,V=(j==null?void 0:j.getAttribute("formmethod"))||o;R(j||y.currentTarget,{fetcherKey:e,method:V,navigate:n,replace:s,state:i,relative:d,preventScrollReset:h,viewTransition:f})};return N.createElement("form",{ref:w,method:A,action:b,onSubmit:r?l:E,...m,"data-discover":!T&&t==="render"?"true":void 0})});QN.displayName="Form";function YN(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function Ux(t){let e=N.useContext(Ca);return dt(e,YN(t)),e}function XN(t,{target:e,replace:n,state:r,preventScrollReset:s,relative:i,viewTransition:o}={}){let a=Sc(),l=Or(),d=bc(t,{relative:i});return N.useCallback(h=>{if(PN(h,e)){h.preventDefault();let f=n!==void 0?n:sc(l)===sc(d);a(t,{replace:f,state:r,preventScrollReset:s,relative:i,viewTransition:o})}},[l,a,d,n,r,e,t,s,i,o])}var JN=0,ZN=()=>`__${String(++JN)}__`;function ek(){let{router:t}=Ux("useSubmit"),{basename:e}=N.useContext(hr),n=wN();return N.useCallback(async(r,s={})=>{let{action:i,method:o,encType:a,formData:l,body:d}=DN(r,e);if(s.navigate===!1){let h=s.fetcherKey||ZN();await t.fetch(h,n,s.action||i,{preventScrollReset:s.preventScrollReset,formData:l,body:d,formMethod:s.method||o,formEncType:s.encType||a,flushSync:s.flushSync})}else await t.navigate(s.action||i,{preventScrollReset:s.preventScrollReset,formData:l,body:d,formMethod:s.method||o,formEncType:s.encType||a,replace:s.replace,state:s.state,fromRouteId:n,flushSync:s.flushSync,viewTransition:s.viewTransition})},[t,e,n])}function tk(t,{relative:e}={}){let{basename:n}=N.useContext(hr),r=N.useContext(jr);dt(r,"useFormAction must be used inside a RouteContext");let[s]=r.matches.slice(-1),i={...bc(t||".",{relative:e})},o=Or();if(t==null){i.search=o.search;let a=new URLSearchParams(i.search),l=a.getAll("index");if(l.some(h=>h==="")){a.delete("index"),l.filter(f=>f).forEach(f=>a.append("index",f));let h=a.toString();i.search=h?`?${h}`:""}}return(!t||t===".")&&s.route.index&&(i.search=i.search?i.search.replace(/^\?/,"?index&"):"?index"),n!=="/"&&(i.pathname=i.pathname==="/"?n:qr([n,i.pathname])),sc(i)}function nk(t,{relative:e}={}){let n=N.useContext(Px);dt(n!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:r}=Ux("useViewTransitionState"),s=bc(t,{relative:e});if(!n.isTransitioning)return!1;let i=Qr(n.currentLocation.pathname,r)||n.currentLocation.pathname,o=Qr(n.nextLocation.pathname,r)||n.nextLocation.pathname;return Nd(s.pathname,o)!=null||Nd(s.pathname,i)!=null}const rk=()=>{};var jw={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $x=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let s=t.charCodeAt(r);s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=s&63|128):(s&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=s&63|128):(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=s&63|128)}return e},sk=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const s=t[n++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=t[n++];e[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=t[n++],o=t[n++],a=t[n++],l=((s&7)<<18|(i&63)<<12|(o&63)<<6|a&63)-65536;e[r++]=String.fromCharCode(55296+(l>>10)),e[r++]=String.fromCharCode(56320+(l&1023))}else{const i=t[n++],o=t[n++];e[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|o&63)}}return e.join("")},Bx={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<t.length;s+=3){const i=t[s],o=s+1<t.length,a=o?t[s+1]:0,l=s+2<t.length,d=l?t[s+2]:0,h=i>>2,f=(i&3)<<4|a>>4;let m=(a&15)<<2|d>>6,w=d&63;l||(w=64,o||(m=64)),r.push(n[h],n[f],n[m],n[w])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray($x(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):sk(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<t.length;){const i=n[t.charAt(s++)],a=s<t.length?n[t.charAt(s)]:0;++s;const d=s<t.length?n[t.charAt(s)]:64;++s;const f=s<t.length?n[t.charAt(s)]:64;if(++s,i==null||a==null||d==null||f==null)throw new ik;const m=i<<2|a>>4;if(r.push(m),d!==64){const w=a<<4&240|d>>2;if(r.push(w),f!==64){const R=d<<6&192|f;r.push(R)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class ik extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const ok=function(t){const e=$x(t);return Bx.encodeByteArray(e,!0)},Dd=function(t){return ok(t).replace(/\./g,"")},zx=function(t){try{return Bx.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qx(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ak=()=>qx().__FIREBASE_DEFAULTS__,lk=()=>{if(typeof process>"u"||typeof jw>"u")return;const t=jw.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},ck=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&zx(t[1]);return e&&JSON.parse(e)},Ah=()=>{try{return rk()||ak()||lk()||ck()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},Hx=t=>{var e,n;return(n=(e=Ah())==null?void 0:e.emulatorHosts)==null?void 0:n[t]},Wx=t=>{const e=Hx(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},Kx=()=>{var t;return(t=Ah())==null?void 0:t.config},Gx=t=>{var e;return(e=Ah())==null?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uk{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ei(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function cy(t){return(await fetch(t,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qx(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",s=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o={iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}},...t};return[Dd(JSON.stringify(n)),Dd(JSON.stringify(o)),""].join(".")}const Nl={};function dk(){const t={prod:[],emulator:[]};for(const e of Object.keys(Nl))Nl[e]?t.emulator.push(e):t.prod.push(e);return t}function hk(t){let e=document.getElementById(t),n=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),n=!0),{created:n,element:e}}let Ow=!1;function uy(t,e){if(typeof window>"u"||typeof document>"u"||!ei(window.location.host)||Nl[t]===e||Nl[t]||Ow)return;Nl[t]=e;function n(m){return`__firebase__banner__${m}`}const r="__firebase__banner",i=dk().prod.length>0;function o(){const m=document.getElementById(r);m&&m.remove()}function a(m){m.style.display="flex",m.style.background="#7faaf0",m.style.position="fixed",m.style.bottom="5px",m.style.left="5px",m.style.padding=".5em",m.style.borderRadius="5px",m.style.alignItems="center"}function l(m,w){m.setAttribute("width","24"),m.setAttribute("id",w),m.setAttribute("height","24"),m.setAttribute("viewBox","0 0 24 24"),m.setAttribute("fill","none"),m.style.marginLeft="-6px"}function d(){const m=document.createElement("span");return m.style.cursor="pointer",m.style.marginLeft="16px",m.style.fontSize="24px",m.innerHTML=" &times;",m.onclick=()=>{Ow=!0,o()},m}function h(m,w){m.setAttribute("id",w),m.innerText="Learn more",m.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",m.setAttribute("target","__blank"),m.style.paddingLeft="5px",m.style.textDecoration="underline"}function f(){const m=hk(r),w=n("text"),R=document.getElementById(w)||document.createElement("span"),b=n("learnmore"),A=document.getElementById(b)||document.createElement("a"),T=n("preprendIcon"),E=document.getElementById(T)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(m.created){const y=m.element;a(y),h(A,b);const j=d();l(E,T),y.append(E,R,A,j),document.body.appendChild(y)}i?(R.innerText="Preview backend disconnected.",E.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(E.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,R.innerText="Preview backend running in this workspace."),R.setAttribute("id",w)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",f):f()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ot(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function fk(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Ot())}function Yx(){var e;const t=(e=Ah())==null?void 0:e.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function pk(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function Xx(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function mk(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function gk(){const t=Ot();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function Jx(){return!Yx()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Zx(){return!Yx()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function dy(){try{return typeof indexedDB=="object"}catch{return!1}}function eS(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{var i;e(((i=s.error)==null?void 0:i.message)||"")}}catch(n){e(n)}})}function yk(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _k="FirebaseError";class Xn extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=_k,Object.setPrototypeOf(this,Xn.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,no.prototype.create)}}class no{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},s=`${this.service}/${e}`,i=this.errors[e],o=i?vk(i,r):"Error",a=`${this.serviceName}: ${o} (${s}).`;return new Xn(s,a,r)}}function vk(t,e){return t.replace(wk,(n,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const wk=/\{\$([^}]+)}/g;function Ek(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Yr(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const s of n){if(!r.includes(s))return!1;const i=t[s],o=e[s];if(Vw(i)&&Vw(o)){if(!Yr(i,o))return!1}else if(i!==o)return!1}for(const s of r)if(!n.includes(s))return!1;return!0}function Vw(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cc(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(s=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function fl(t){const e={};return t.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[s,i]=r.split("=");e[decodeURIComponent(s)]=decodeURIComponent(i)}}),e}function pl(t){const e=t.indexOf("?");if(!e)return"";const n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}function Ik(t,e){const n=new Tk(t,e);return n.subscribe.bind(n)}class Tk{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let s;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");xk(e,["next","error","complete"])?s=e:s={next:e,error:n,complete:r},s.next===void 0&&(s.next=sp),s.error===void 0&&(s.error=sp),s.complete===void 0&&(s.complete=sp);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function xk(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function sp(){}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sk=1e3,bk=2,Ck=4*60*60*1e3,Ak=.5;function Lw(t,e=Sk,n=bk){const r=e*Math.pow(n,t),s=Math.round(Ak*r*(Math.random()-.5)*2);return Math.min(Ck,r+s)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ke(t){return t&&t._delegate?t._delegate:t}class Yn{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pi="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rk{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new uk;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:n});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){const n=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),r=(e==null?void 0:e.optional)??!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(s){if(r)return null;throw s}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(Nk(e))try{this.getOrInitializeService({instanceIdentifier:pi})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(n);try{const i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(e=pi){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=pi){return this.instances.has(e)}getOptions(e=pi){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[i,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(i);r===a&&o.resolve(s)}return s}onInit(e,n){const r=this.normalizeInstanceIdentifier(n),s=this.onInitCallbacks.get(r)??new Set;s.add(e),this.onInitCallbacks.set(r,s);const i=this.instances.get(r);return i&&e(i,r),()=>{s.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const s of r)try{s(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:Pk(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=pi){return this.component?this.component.multipleInstances?e:pi:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function Pk(t){return t===pi?void 0:t}function Nk(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kk{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new Rk(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var je;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(je||(je={}));const Dk={debug:je.DEBUG,verbose:je.VERBOSE,info:je.INFO,warn:je.WARN,error:je.ERROR,silent:je.SILENT},jk=je.INFO,Ok={[je.DEBUG]:"log",[je.VERBOSE]:"log",[je.INFO]:"info",[je.WARN]:"warn",[je.ERROR]:"error"},Vk=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),s=Ok[e];if(s)console[s](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Rh{constructor(e){this.name=e,this._logLevel=jk,this._logHandler=Vk,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in je))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?Dk[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,je.DEBUG,...e),this._logHandler(this,je.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,je.VERBOSE,...e),this._logHandler(this,je.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,je.INFO,...e),this._logHandler(this,je.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,je.WARN,...e),this._logHandler(this,je.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,je.ERROR,...e),this._logHandler(this,je.ERROR,...e)}}const Lk=(t,e)=>e.some(n=>t instanceof n);let Mw,Fw;function Mk(){return Mw||(Mw=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Fk(){return Fw||(Fw=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const tS=new WeakMap,bm=new WeakMap,nS=new WeakMap,ip=new WeakMap,hy=new WeakMap;function Uk(t){const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("success",i),t.removeEventListener("error",o)},i=()=>{n(Ms(t.result)),s()},o=()=>{r(t.error),s()};t.addEventListener("success",i),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&tS.set(n,t)}).catch(()=>{}),hy.set(e,t),e}function $k(t){if(bm.has(t))return;const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",o),t.removeEventListener("abort",o)},i=()=>{n(),s()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",i),t.addEventListener("error",o),t.addEventListener("abort",o)});bm.set(t,e)}let Cm={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return bm.get(t);if(e==="objectStoreNames")return t.objectStoreNames||nS.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Ms(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function Bk(t){Cm=t(Cm)}function zk(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(op(this),e,...n);return nS.set(r,e.sort?e.sort():[e]),Ms(r)}:Fk().includes(t)?function(...e){return t.apply(op(this),e),Ms(tS.get(this))}:function(...e){return Ms(t.apply(op(this),e))}}function qk(t){return typeof t=="function"?zk(t):(t instanceof IDBTransaction&&$k(t),Lk(t,Mk())?new Proxy(t,Cm):t)}function Ms(t){if(t instanceof IDBRequest)return Uk(t);if(ip.has(t))return ip.get(t);const e=qk(t);return e!==t&&(ip.set(t,e),hy.set(e,t)),e}const op=t=>hy.get(t);function rS(t,e,{blocked:n,upgrade:r,blocking:s,terminated:i}={}){const o=indexedDB.open(t,e),a=Ms(o);return r&&o.addEventListener("upgradeneeded",l=>{r(Ms(o.result),l.oldVersion,l.newVersion,Ms(o.transaction),l)}),n&&o.addEventListener("blocked",l=>n(l.oldVersion,l.newVersion,l)),a.then(l=>{i&&l.addEventListener("close",()=>i()),s&&l.addEventListener("versionchange",d=>s(d.oldVersion,d.newVersion,d))}).catch(()=>{}),a}const Hk=["get","getKey","getAll","getAllKeys","count"],Wk=["put","add","delete","clear"],ap=new Map;function Uw(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(ap.get(e))return ap.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,s=Wk.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(s||Hk.includes(n)))return;const i=async function(o,...a){const l=this.transaction(o,s?"readwrite":"readonly");let d=l.store;return r&&(d=d.index(a.shift())),(await Promise.all([d[n](...a),s&&l.done]))[0]};return ap.set(e,i),i}Bk(t=>({...t,get:(e,n,r)=>Uw(e,n)||t.get(e,n,r),has:(e,n)=>!!Uw(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kk{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(Gk(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function Gk(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Am="@firebase/app",$w="0.14.5";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xr=new Rh("@firebase/app"),Qk="@firebase/app-compat",Yk="@firebase/analytics-compat",Xk="@firebase/analytics",Jk="@firebase/app-check-compat",Zk="@firebase/app-check",eD="@firebase/auth",tD="@firebase/auth-compat",nD="@firebase/database",rD="@firebase/data-connect",sD="@firebase/database-compat",iD="@firebase/functions",oD="@firebase/functions-compat",aD="@firebase/installations",lD="@firebase/installations-compat",cD="@firebase/messaging",uD="@firebase/messaging-compat",dD="@firebase/performance",hD="@firebase/performance-compat",fD="@firebase/remote-config",pD="@firebase/remote-config-compat",mD="@firebase/storage",gD="@firebase/storage-compat",yD="@firebase/firestore",_D="@firebase/ai",vD="@firebase/firestore-compat",wD="firebase",ED="12.5.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rm="[DEFAULT]",ID={[Am]:"fire-core",[Qk]:"fire-core-compat",[Xk]:"fire-analytics",[Yk]:"fire-analytics-compat",[Zk]:"fire-app-check",[Jk]:"fire-app-check-compat",[eD]:"fire-auth",[tD]:"fire-auth-compat",[nD]:"fire-rtdb",[rD]:"fire-data-connect",[sD]:"fire-rtdb-compat",[iD]:"fire-fn",[oD]:"fire-fn-compat",[aD]:"fire-iid",[lD]:"fire-iid-compat",[cD]:"fire-fcm",[uD]:"fire-fcm-compat",[dD]:"fire-perf",[hD]:"fire-perf-compat",[fD]:"fire-rc",[pD]:"fire-rc-compat",[mD]:"fire-gcs",[gD]:"fire-gcs-compat",[yD]:"fire-fst",[vD]:"fire-fst-compat",[_D]:"fire-vertex","fire-js":"fire-js",[wD]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jd=new Map,TD=new Map,Pm=new Map;function Bw(t,e){try{t.container.addComponent(e)}catch(n){Xr.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function cr(t){const e=t.name;if(Pm.has(e))return Xr.debug(`There were multiple attempts to register component ${e}.`),!1;Pm.set(e,t);for(const n of jd.values())Bw(n,t);for(const n of TD.values())Bw(n,t);return!0}function ti(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function $n(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xD={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Fs=new no("app","Firebase",xD);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SD{constructor(e,n,r){this._isDeleted=!1,this._options={...e},this._config={...n},this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Yn("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Fs.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ro=ED;function fy(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r={name:Rm,automaticDataCollectionEnabled:!0,...e},s=r.name;if(typeof s!="string"||!s)throw Fs.create("bad-app-name",{appName:String(s)});if(n||(n=Kx()),!n)throw Fs.create("no-options");const i=jd.get(s);if(i){if(Yr(n,i.options)&&Yr(r,i.config))return i;throw Fs.create("duplicate-app",{appName:s})}const o=new kk(s);for(const l of Pm.values())o.addComponent(l);const a=new SD(n,r,o);return jd.set(s,a),a}function Ph(t=Rm){const e=jd.get(t);if(!e&&t===Rm&&Kx())return fy();if(!e)throw Fs.create("no-app",{appName:t});return e}function Sn(t,e,n){let r=ID[t]??t;n&&(r+=`-${n}`);const s=r.match(/\s|\//),i=e.match(/\s|\//);if(s||i){const o=[`Unable to register library "${r}" with version "${e}":`];s&&o.push(`library name "${r}" contains illegal characters (whitespace or "/")`),s&&i&&o.push("and"),i&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Xr.warn(o.join(" "));return}cr(new Yn(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bD="firebase-heartbeat-database",CD=1,ic="firebase-heartbeat-store";let lp=null;function sS(){return lp||(lp=rS(bD,CD,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(ic)}catch(n){console.warn(n)}}}}).catch(t=>{throw Fs.create("idb-open",{originalErrorMessage:t.message})})),lp}async function AD(t){try{const n=(await sS()).transaction(ic),r=await n.objectStore(ic).get(iS(t));return await n.done,r}catch(e){if(e instanceof Xn)Xr.warn(e.message);else{const n=Fs.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Xr.warn(n.message)}}}async function zw(t,e){try{const r=(await sS()).transaction(ic,"readwrite");await r.objectStore(ic).put(e,iS(t)),await r.done}catch(n){if(n instanceof Xn)Xr.warn(n.message);else{const r=Fs.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});Xr.warn(r.message)}}}function iS(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RD=1024,PD=30;class ND{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new DD(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=qw();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)==null?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(o=>o.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:s}),this._heartbeatsCache.heartbeats.length>PD){const o=jD(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){Xr.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=qw(),{heartbeatsToSend:r,unsentEntries:s}=kD(this._heartbeatsCache.heartbeats),i=Dd(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(n){return Xr.warn(n),""}}}function qw(){return new Date().toISOString().substring(0,10)}function kD(t,e=RD){const n=[];let r=t.slice();for(const s of t){const i=n.find(o=>o.agent===s.agent);if(i){if(i.dates.push(s.date),Hw(n)>e){i.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),Hw(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class DD{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return dy()?eS().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await AD(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return zw(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return zw(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function Hw(t){return Dd(JSON.stringify({version:2,heartbeats:t})).length}function jD(t){if(t.length===0)return-1;let e=0,n=t[0].date;for(let r=1;r<t.length;r++)t[r].date<n&&(n=t[r].date,e=r);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OD(t){cr(new Yn("platform-logger",e=>new Kk(e),"PRIVATE")),cr(new Yn("heartbeat",e=>new ND(e),"PRIVATE")),Sn(Am,$w,t),Sn(Am,$w,"esm2020"),Sn("fire-js","")}OD("");var VD="firebase",LD="12.5.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Sn(VD,LD,"app");function oS(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const MD=oS,aS=new no("auth","Firebase",oS());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Od=new Rh("@firebase/auth");function FD(t,...e){Od.logLevel<=je.WARN&&Od.warn(`Auth (${ro}): ${t}`,...e)}function Hu(t,...e){Od.logLevel<=je.ERROR&&Od.error(`Auth (${ro}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ur(t,...e){throw py(t,...e)}function Rr(t,...e){return py(t,...e)}function lS(t,e,n){const r={...MD(),[e]:n};return new no("auth","Firebase",r).create(e,{appName:t.name})}function Us(t){return lS(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function py(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return aS.create(t,...e)}function _e(t,e,...n){if(!t)throw py(e,...n)}function Ur(t){const e="INTERNAL ASSERTION FAILED: "+t;throw Hu(e),new Error(e)}function Jr(t,e){t||Ur(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nm(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.href)||""}function UD(){return Ww()==="http:"||Ww()==="https:"}function Ww(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $D(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(UD()||Xx()||"connection"in navigator)?navigator.onLine:!0}function BD(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ac{constructor(e,n){this.shortDelay=e,this.longDelay=n,Jr(n>e,"Short delay should be less than long delay!"),this.isMobile=fk()||mk()}get(){return $D()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function my(t,e){Jr(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cS{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Ur("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Ur("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Ur("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zD={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qD=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],HD=new Ac(3e4,6e4);function so(t,e){return t.tenantId&&!e.tenantId?{...e,tenantId:t.tenantId}:e}async function ni(t,e,n,r,s={}){return uS(t,s,async()=>{let i={},o={};r&&(e==="GET"?o=r:i={body:JSON.stringify(r)});const a=Cc({key:t.config.apiKey,...o}).slice(1),l=await t._getAdditionalHeaders();l["Content-Type"]="application/json",t.languageCode&&(l["X-Firebase-Locale"]=t.languageCode);const d={method:e,headers:l,...i};return pk()||(d.referrerPolicy="no-referrer"),t.emulatorConfig&&ei(t.emulatorConfig.host)&&(d.credentials="include"),cS.fetch()(await dS(t,t.config.apiHost,n,a),d)})}async function uS(t,e,n){t._canInitEmulator=!1;const r={...zD,...e};try{const s=new KD(t),i=await Promise.race([n(),s.promise]);s.clearNetworkTimeout();const o=await i.json();if("needConfirmation"in o)throw _u(t,"account-exists-with-different-credential",o);if(i.ok&&!("errorMessage"in o))return o;{const a=i.ok?o.errorMessage:o.error.message,[l,d]=a.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw _u(t,"credential-already-in-use",o);if(l==="EMAIL_EXISTS")throw _u(t,"email-already-in-use",o);if(l==="USER_DISABLED")throw _u(t,"user-disabled",o);const h=r[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(d)throw lS(t,h,d);ur(t,h)}}catch(s){if(s instanceof Xn)throw s;ur(t,"network-request-failed",{message:String(s)})}}async function Nh(t,e,n,r,s={}){const i=await ni(t,e,n,r,s);return"mfaPendingCredential"in i&&ur(t,"multi-factor-auth-required",{_serverResponse:i}),i}async function dS(t,e,n,r){const s=`${e}${n}?${r}`,i=t,o=i.config.emulator?my(t.config,s):`${t.config.apiScheme}://${s}`;return qD.includes(n)&&(await i._persistenceManagerAvailable,i._getPersistenceType()==="COOKIE")?i._getPersistence()._getFinalTarget(o).toString():o}function WD(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class KD{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(Rr(this.auth,"network-request-failed")),HD.get())})}}function _u(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const s=Rr(t,e,r);return s.customData._tokenResponse=n,s}function Kw(t){return t!==void 0&&t.enterprise!==void 0}class GD{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const n of this.recaptchaEnforcementState)if(n.provider&&n.provider===e)return WD(n.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function QD(t,e){return ni(t,"GET","/v2/recaptchaConfig",so(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function YD(t,e){return ni(t,"POST","/v1/accounts:delete",e)}async function Vd(t,e){return ni(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kl(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function XD(t,e=!1){const n=Ke(t),r=await n.getIdToken(e),s=gy(r);_e(s&&s.exp&&s.auth_time&&s.iat,n.auth,"internal-error");const i=typeof s.firebase=="object"?s.firebase:void 0,o=i==null?void 0:i.sign_in_provider;return{claims:s,token:r,authTime:kl(cp(s.auth_time)),issuedAtTime:kl(cp(s.iat)),expirationTime:kl(cp(s.exp)),signInProvider:o||null,signInSecondFactor:(i==null?void 0:i.sign_in_second_factor)||null}}function cp(t){return Number(t)*1e3}function gy(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return Hu("JWT malformed, contained fewer than 3 sections"),null;try{const s=zx(n);return s?JSON.parse(s):(Hu("Failed to decode base64 JWT payload"),null)}catch(s){return Hu("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function Gw(t){const e=gy(t);return _e(e,"internal-error"),_e(typeof e.exp<"u","internal-error"),_e(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function oc(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof Xn&&JD(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function JD({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZD{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const r=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class km{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=kl(this.lastLoginAt),this.creationTime=kl(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ld(t){var f;const e=t.auth,n=await t.getIdToken(),r=await oc(t,Vd(e,{idToken:n}));_e(r==null?void 0:r.users.length,e,"internal-error");const s=r.users[0];t._notifyReloadListener(s);const i=(f=s.providerUserInfo)!=null&&f.length?hS(s.providerUserInfo):[],o=tj(t.providerData,i),a=t.isAnonymous,l=!(t.email&&s.passwordHash)&&!(o!=null&&o.length),d=a?l:!1,h={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:o,metadata:new km(s.createdAt,s.lastLoginAt),isAnonymous:d};Object.assign(t,h)}async function ej(t){const e=Ke(t);await Ld(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function tj(t,e){return[...t.filter(r=>!e.some(s=>s.providerId===r.providerId)),...e]}function hS(t){return t.map(({providerId:e,...n})=>({providerId:e,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function nj(t,e){const n=await uS(t,{},async()=>{const r=Cc({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:i}=t.config,o=await dS(t,s,"/v1/token",`key=${i}`),a=await t._getAdditionalHeaders();a["Content-Type"]="application/x-www-form-urlencoded";const l={method:"POST",headers:a,body:r};return t.emulatorConfig&&ei(t.emulatorConfig.host)&&(l.credentials="include"),cS.fetch()(o,l)});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function rj(t,e){return ni(t,"POST","/v2/accounts:revokeToken",so(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Go{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){_e(e.idToken,"internal-error"),_e(typeof e.idToken<"u","internal-error"),_e(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Gw(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){_e(e.length!==0,"internal-error");const n=Gw(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(_e(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:s,expiresIn:i}=await nj(e,n);this.updateTokensAndExpiration(r,s,Number(i))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:s,expirationTime:i}=n,o=new Go;return r&&(_e(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),s&&(_e(typeof s=="string","internal-error",{appName:e}),o.accessToken=s),i&&(_e(typeof i=="number","internal-error",{appName:e}),o.expirationTime=i),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Go,this.toJSON())}_performRefresh(){return Ur("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hs(t,e){_e(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class sr{constructor({uid:e,auth:n,stsTokenManager:r,...s}){this.providerId="firebase",this.proactiveRefresh=new ZD(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=n,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new km(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const n=await oc(this,this.stsTokenManager.getToken(this.auth,e));return _e(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return XD(this,e)}reload(){return ej(this)}_assign(e){this!==e&&(_e(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>({...n})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new sr({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return n.metadata._copy(this.metadata),n}_onReload(e){_e(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await Ld(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if($n(this.auth.app))return Promise.reject(Us(this.auth));const e=await this.getIdToken();return await oc(this,YD(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){const r=n.displayName??void 0,s=n.email??void 0,i=n.phoneNumber??void 0,o=n.photoURL??void 0,a=n.tenantId??void 0,l=n._redirectEventId??void 0,d=n.createdAt??void 0,h=n.lastLoginAt??void 0,{uid:f,emailVerified:m,isAnonymous:w,providerData:R,stsTokenManager:b}=n;_e(f&&b,e,"internal-error");const A=Go.fromJSON(this.name,b);_e(typeof f=="string",e,"internal-error"),hs(r,e.name),hs(s,e.name),_e(typeof m=="boolean",e,"internal-error"),_e(typeof w=="boolean",e,"internal-error"),hs(i,e.name),hs(o,e.name),hs(a,e.name),hs(l,e.name),hs(d,e.name),hs(h,e.name);const T=new sr({uid:f,auth:e,email:s,emailVerified:m,displayName:r,isAnonymous:w,photoURL:o,phoneNumber:i,tenantId:a,stsTokenManager:A,createdAt:d,lastLoginAt:h});return R&&Array.isArray(R)&&(T.providerData=R.map(E=>({...E}))),l&&(T._redirectEventId=l),T}static async _fromIdTokenResponse(e,n,r=!1){const s=new Go;s.updateFromServerResponse(n);const i=new sr({uid:n.localId,auth:e,stsTokenManager:s,isAnonymous:r});return await Ld(i),i}static async _fromGetAccountInfoResponse(e,n,r){const s=n.users[0];_e(s.localId!==void 0,"internal-error");const i=s.providerUserInfo!==void 0?hS(s.providerUserInfo):[],o=!(s.email&&s.passwordHash)&&!(i!=null&&i.length),a=new Go;a.updateFromIdToken(r);const l=new sr({uid:s.localId,auth:e,stsTokenManager:a,isAnonymous:o}),d={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:i,metadata:new km(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(i!=null&&i.length)};return Object.assign(l,d),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qw=new Map;function $r(t){Jr(t instanceof Function,"Expected a class definition");let e=Qw.get(t);return e?(Jr(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,Qw.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fS{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}fS.type="NONE";const Yw=fS;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wu(t,e,n){return`firebase:${t}:${e}:${n}`}class Qo{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:s,name:i}=this.auth;this.fullUserKey=Wu(this.userKey,s.apiKey,i),this.fullPersistenceKey=Wu("persistence",s.apiKey,i),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const n=await Vd(this.auth,{idToken:e}).catch(()=>{});return n?sr._fromGetAccountInfoResponse(this.auth,n,e):null}return sr._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new Qo($r(Yw),e,r);const s=(await Promise.all(n.map(async d=>{if(await d._isAvailable())return d}))).filter(d=>d);let i=s[0]||$r(Yw);const o=Wu(r,e.config.apiKey,e.name);let a=null;for(const d of n)try{const h=await d._get(o);if(h){let f;if(typeof h=="string"){const m=await Vd(e,{idToken:h}).catch(()=>{});if(!m)break;f=await sr._fromGetAccountInfoResponse(e,m,h)}else f=sr._fromJSON(e,h);d!==i&&(a=f),i=d;break}}catch{}const l=s.filter(d=>d._shouldAllowMigration);return!i._shouldAllowMigration||!l.length?new Qo(i,e,r):(i=l[0],a&&await i._set(o,a.toJSON()),await Promise.all(n.map(async d=>{if(d!==i)try{await d._remove(o)}catch{}})),new Qo(i,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xw(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(yS(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(pS(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(vS(e))return"Blackberry";if(wS(e))return"Webos";if(mS(e))return"Safari";if((e.includes("chrome/")||gS(e))&&!e.includes("edge/"))return"Chrome";if(_S(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function pS(t=Ot()){return/firefox\//i.test(t)}function mS(t=Ot()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function gS(t=Ot()){return/crios\//i.test(t)}function yS(t=Ot()){return/iemobile/i.test(t)}function _S(t=Ot()){return/android/i.test(t)}function vS(t=Ot()){return/blackberry/i.test(t)}function wS(t=Ot()){return/webos/i.test(t)}function yy(t=Ot()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function sj(t=Ot()){var e;return yy(t)&&!!((e=window.navigator)!=null&&e.standalone)}function ij(){return gk()&&document.documentMode===10}function ES(t=Ot()){return yy(t)||_S(t)||wS(t)||vS(t)||/windows phone/i.test(t)||yS(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function IS(t,e=[]){let n;switch(t){case"Browser":n=Xw(Ot());break;case"Worker":n=`${Xw(Ot())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${ro}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oj{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=i=>new Promise((o,a)=>{try{const l=e(i);o(l)}catch(l){a(l)}});r.onAbort=n,this.queue.push(r);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const s of n)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function aj(t,e={}){return ni(t,"GET","/v2/passwordPolicy",so(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lj=6;class cj{constructor(e){var r;const n=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=n.minPasswordLength??lj,n.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=n.maxPasswordLength),n.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=n.containsLowercaseCharacter),n.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=n.containsUppercaseCharacter),n.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=n.containsNumericCharacter),n.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=n.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=((r=e.allowedNonAlphanumericCharacters)==null?void 0:r.join(""))??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const n={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,n),this.validatePasswordCharacterOptions(e,n),n.isValid&&(n.isValid=n.meetsMinPasswordLength??!0),n.isValid&&(n.isValid=n.meetsMaxPasswordLength??!0),n.isValid&&(n.isValid=n.containsLowercaseLetter??!0),n.isValid&&(n.isValid=n.containsUppercaseLetter??!0),n.isValid&&(n.isValid=n.containsNumericCharacter??!0),n.isValid&&(n.isValid=n.containsNonAlphanumericCharacter??!0),n}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),s&&(n.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let s=0;s<e.length;s++)r=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,s,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uj{constructor(e,n,r,s){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Jw(this),this.idTokenSubscription=new Jw(this),this.beforeStateQueue=new oj(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=aS,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion,this._persistenceManagerAvailable=new Promise(i=>this._resolvePersistenceManagerAvailable=i)}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=$r(n)),this._initializationPromise=this.queue(async()=>{var r,s,i;if(!this._deleted&&(this.persistenceManager=await Qo.create(this,e),(r=this._resolvePersistenceManagerAvailable)==null||r.call(this),!this._deleted)){if((s=this._popupRedirectResolver)!=null&&s._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((i=this.currentUser)==null?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await Vd(this,{idToken:e}),r=await sr._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(r)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var i;if($n(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(a,a))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let r=n,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(i=this.redirectUser)==null?void 0:i._redirectEventId,a=r==null?void 0:r._redirectEventId,l=await this.tryRedirectSignIn(e);(!o||o===a)&&(l!=null&&l.user)&&(r=l.user,s=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(r)}catch(o){r=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return _e(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await Ld(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=BD()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if($n(this.app))return Promise.reject(Us(this));const n=e?Ke(e):null;return n&&_e(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&_e(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return $n(this.app)?Promise.reject(Us(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return $n(this.app)?Promise.reject(Us(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence($r(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await aj(this),n=new cj(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new no("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),await rj(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)==null?void 0:e.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&$r(e)||this._popupRedirectResolver;_e(n,this,"argument-error"),this.redirectPersistenceManager=await Qo.create(this,[$r(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)==null?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)==null?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=((n=this.currentUser)==null?void 0:n.uid)??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,s){if(this._deleted)return()=>{};const i=typeof n=="function"?n:n.next.bind(n);let o=!1;const a=this._isInitialized?Promise.resolve():this._initializationPromise;if(_e(a,this,"internal-error"),a.then(()=>{o||i(this.currentUser)}),typeof n=="function"){const l=e.addObserver(n,r,s);return()=>{o=!0,l()}}else{const l=e.addObserver(n);return()=>{o=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return _e(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=IS(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var s;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const n=await((s=this.heartbeatServiceProvider.getImmediate({optional:!0}))==null?void 0:s.getHeartbeatsHeader());n&&(e["X-Firebase-Client"]=n);const r=await this._getAppCheckToken();return r&&(e["X-Firebase-AppCheck"]=r),e}async _getAppCheckToken(){var n;if($n(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await((n=this.appCheckServiceProvider.getImmediate({optional:!0}))==null?void 0:n.getToken());return e!=null&&e.error&&FD(`Error while retrieving App Check token: ${e.error}`),e==null?void 0:e.token}}function Ra(t){return Ke(t)}class Jw{constructor(e){this.auth=e,this.observer=null,this.addObserver=Ik(n=>this.observer=n)}get next(){return _e(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let kh={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function dj(t){kh=t}function TS(t){return kh.loadJS(t)}function hj(){return kh.recaptchaEnterpriseScript}function fj(){return kh.gapiScript}function pj(t){return`__${t}${Math.floor(Math.random()*1e6)}`}class mj{constructor(){this.enterprise=new gj}ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}class gj{ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}const yj="recaptcha-enterprise",xS="NO_RECAPTCHA";class _j{constructor(e){this.type=yj,this.auth=Ra(e)}async verify(e="verify",n=!1){async function r(i){if(!n){if(i.tenantId==null&&i._agentRecaptchaConfig!=null)return i._agentRecaptchaConfig.siteKey;if(i.tenantId!=null&&i._tenantRecaptchaConfigs[i.tenantId]!==void 0)return i._tenantRecaptchaConfigs[i.tenantId].siteKey}return new Promise(async(o,a)=>{QD(i,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(l=>{if(l.recaptchaKey===void 0)a(new Error("recaptcha Enterprise site key undefined"));else{const d=new GD(l);return i.tenantId==null?i._agentRecaptchaConfig=d:i._tenantRecaptchaConfigs[i.tenantId]=d,o(d.siteKey)}}).catch(l=>{a(l)})})}function s(i,o,a){const l=window.grecaptcha;Kw(l)?l.enterprise.ready(()=>{l.enterprise.execute(i,{action:e}).then(d=>{o(d)}).catch(()=>{o(xS)})}):a(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new mj().execute("siteKey",{action:"verify"}):new Promise((i,o)=>{r(this.auth).then(a=>{if(!n&&Kw(window.grecaptcha))s(a,i,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let l=hj();l.length!==0&&(l+=a),TS(l).then(()=>{s(a,i,o)}).catch(d=>{o(d)})}}).catch(a=>{o(a)})})}}async function Zw(t,e,n,r=!1,s=!1){const i=new _j(t);let o;if(s)o=xS;else try{o=await i.verify(n)}catch{o=await i.verify(n,!0)}const a={...e};if(n==="mfaSmsEnrollment"||n==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in a){const l=a.phoneEnrollmentInfo.phoneNumber,d=a.phoneEnrollmentInfo.recaptchaToken;Object.assign(a,{phoneEnrollmentInfo:{phoneNumber:l,recaptchaToken:d,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in a){const l=a.phoneSignInInfo.recaptchaToken;Object.assign(a,{phoneSignInInfo:{recaptchaToken:l,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return a}return r?Object.assign(a,{captchaResp:o}):Object.assign(a,{captchaResponse:o}),Object.assign(a,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(a,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),a}async function eE(t,e,n,r,s){var i;if((i=t._getRecaptchaConfig())!=null&&i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const o=await Zw(t,e,n,n==="getOobCode");return r(t,o)}else return r(t,e).catch(async o=>{if(o.code==="auth/missing-recaptcha-token"){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const a=await Zw(t,e,n,n==="getOobCode");return r(t,a)}else return Promise.reject(o)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vj(t,e){const n=ti(t,"auth");if(n.isInitialized()){const s=n.getImmediate(),i=n.getOptions();if(Yr(i,e??{}))return s;ur(s,"already-initialized")}return n.initialize({options:e})}function wj(t,e){const n=(e==null?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map($r);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function Ej(t,e,n){const r=Ra(t);_e(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const s=!1,i=SS(e),{host:o,port:a}=Ij(e),l=a===null?"":`:${a}`,d={url:`${i}//${o}${l}/`},h=Object.freeze({host:o,port:a,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:s})});if(!r._canInitEmulator){_e(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),_e(Yr(d,r.config.emulator)&&Yr(h,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=d,r.emulatorConfig=h,r.settings.appVerificationDisabledForTesting=!0,ei(o)?(cy(`${i}//${o}${l}`),uy("Auth",!0)):Tj()}function SS(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function Ij(t){const e=SS(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(r);if(s){const i=s[1];return{host:i,port:tE(r.substr(i.length+1))}}else{const[i,o]=r.split(":");return{host:i,port:tE(o)}}}function tE(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function Tj(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _y{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return Ur("not implemented")}_getIdTokenResponse(e){return Ur("not implemented")}_linkToIdToken(e,n){return Ur("not implemented")}_getReauthenticationResolver(e){return Ur("not implemented")}}async function xj(t,e){return ni(t,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Sj(t,e){return Nh(t,"POST","/v1/accounts:signInWithPassword",so(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function bj(t,e){return Nh(t,"POST","/v1/accounts:signInWithEmailLink",so(t,e))}async function Cj(t,e){return Nh(t,"POST","/v1/accounts:signInWithEmailLink",so(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ac extends _y{constructor(e,n,r,s=null){super("password",r),this._email=e,this._password=n,this._tenantId=s}static _fromEmailAndPassword(e,n){return new ac(e,n,"password")}static _fromEmailAndCode(e,n,r=null){return new ac(e,n,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;if(n!=null&&n.email&&(n!=null&&n.password)){if(n.signInMethod==="password")return this._fromEmailAndPassword(n.email,n.password);if(n.signInMethod==="emailLink")return this._fromEmailAndCode(n.email,n.password,n.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const n={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return eE(e,n,"signInWithPassword",Sj);case"emailLink":return bj(e,{email:this._email,oobCode:this._password});default:ur(e,"internal-error")}}async _linkToIdToken(e,n){switch(this.signInMethod){case"password":const r={idToken:n,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return eE(e,r,"signUpPassword",xj);case"emailLink":return Cj(e,{idToken:n,email:this._email,oobCode:this._password});default:ur(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Yo(t,e){return Nh(t,"POST","/v1/accounts:signInWithIdp",so(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Aj="http://localhost";class Ui extends _y{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new Ui(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):ur("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:s,...i}=n;if(!r||!s)return null;const o=new Ui(r,s);return o.idToken=i.idToken||void 0,o.accessToken=i.accessToken||void 0,o.secret=i.secret,o.nonce=i.nonce,o.pendingToken=i.pendingToken||null,o}_getIdTokenResponse(e){const n=this.buildRequest();return Yo(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,Yo(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,Yo(e,n)}buildRequest(){const e={requestUri:Aj,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=Cc(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rj(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function Pj(t){const e=fl(pl(t)).link,n=e?fl(pl(e)).deep_link_id:null,r=fl(pl(t)).deep_link_id;return(r?fl(pl(r)).link:null)||r||n||e||t}class vy{constructor(e){const n=fl(pl(e)),r=n.apiKey??null,s=n.oobCode??null,i=Rj(n.mode??null);_e(r&&s&&i,"argument-error"),this.apiKey=r,this.operation=i,this.code=s,this.continueUrl=n.continueUrl??null,this.languageCode=n.lang??null,this.tenantId=n.tenantId??null}static parseLink(e){const n=Pj(e);try{return new vy(n)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pa{constructor(){this.providerId=Pa.PROVIDER_ID}static credential(e,n){return ac._fromEmailAndPassword(e,n)}static credentialWithLink(e,n){const r=vy.parseLink(n);return _e(r,"argument-error"),ac._fromEmailAndCode(e,r.code,r.tenantId)}}Pa.PROVIDER_ID="password";Pa.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Pa.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bS{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rc extends bS{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ws extends Rc{constructor(){super("facebook.com")}static credential(e){return Ui._fromParams({providerId:ws.PROVIDER_ID,signInMethod:ws.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ws.credentialFromTaggedObject(e)}static credentialFromError(e){return ws.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return ws.credential(e.oauthAccessToken)}catch{return null}}}ws.FACEBOOK_SIGN_IN_METHOD="facebook.com";ws.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Es extends Rc{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return Ui._fromParams({providerId:Es.PROVIDER_ID,signInMethod:Es.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return Es.credentialFromTaggedObject(e)}static credentialFromError(e){return Es.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return Es.credential(n,r)}catch{return null}}}Es.GOOGLE_SIGN_IN_METHOD="google.com";Es.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Is extends Rc{constructor(){super("github.com")}static credential(e){return Ui._fromParams({providerId:Is.PROVIDER_ID,signInMethod:Is.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Is.credentialFromTaggedObject(e)}static credentialFromError(e){return Is.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Is.credential(e.oauthAccessToken)}catch{return null}}}Is.GITHUB_SIGN_IN_METHOD="github.com";Is.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ts extends Rc{constructor(){super("twitter.com")}static credential(e,n){return Ui._fromParams({providerId:Ts.PROVIDER_ID,signInMethod:Ts.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return Ts.credentialFromTaggedObject(e)}static credentialFromError(e){return Ts.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return Ts.credential(n,r)}catch{return null}}}Ts.TWITTER_SIGN_IN_METHOD="twitter.com";Ts.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ca{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,s=!1){const i=await sr._fromIdTokenResponse(e,r,s),o=nE(r);return new ca({user:i,providerId:o,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const s=nE(r);return new ca({user:e,providerId:s,_tokenResponse:r,operationType:n})}}function nE(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Md extends Xn{constructor(e,n,r,s){super(n.code,n.message),this.operationType=r,this.user=s,Object.setPrototypeOf(this,Md.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,s){return new Md(e,n,r,s)}}function CS(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?Md._fromErrorAndOperation(t,i,e,r):i})}async function Nj(t,e,n=!1){const r=await oc(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return ca._forOperation(t,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function kj(t,e,n=!1){const{auth:r}=t;if($n(r.app))return Promise.reject(Us(r));const s="reauthenticate";try{const i=await oc(t,CS(r,s,e,t),n);_e(i.idToken,r,"internal-error");const o=gy(i.idToken);_e(o,r,"internal-error");const{sub:a}=o;return _e(t.uid===a,r,"user-mismatch"),ca._forOperation(t,s,i)}catch(i){throw(i==null?void 0:i.code)==="auth/user-not-found"&&ur(r,"user-mismatch"),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function AS(t,e,n=!1){if($n(t.app))return Promise.reject(Us(t));const r="signIn",s=await CS(t,r,e),i=await ca._fromIdTokenResponse(t,r,s);return n||await t._updateCurrentUser(i.user),i}async function Dj(t,e){return AS(Ra(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function jj(t){const e=Ra(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}function Oj(t,e,n){return $n(t.app)?Promise.reject(Us(t)):Dj(Ke(t),Pa.credential(e,n)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&jj(t),r})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vj(t,e){return Ke(t).setPersistence(e)}function Lj(t,e,n,r){return Ke(t).onIdTokenChanged(e,n,r)}function Mj(t,e,n){return Ke(t).beforeAuthStateChanged(e,n)}function wy(t,e,n,r){return Ke(t).onAuthStateChanged(e,n,r)}function Fj(t){return Ke(t).signOut()}const Fd="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RS{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(Fd,"1"),this.storage.removeItem(Fd),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Uj=1e3,$j=10;class PS extends RS{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=ES(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),s=this.localCache[n];r!==s&&e(n,s,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((o,a,l)=>{this.notifyListeners(o,l)});return}const r=e.key;n?this.detachListener():this.stopPolling();const s=()=>{const o=this.storage.getItem(r);!n&&this.localCache[r]===o||this.notifyListeners(r,o)},i=this.storage.getItem(r);ij()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,$j):s()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},Uj)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}PS.type="LOCAL";const NS=PS;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kS extends RS{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}kS.type="SESSION";const DS=kS;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bj(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dh{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(s=>s.isListeningto(e));if(n)return n;const r=new Dh(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:s,data:i}=n.data,o=this.handlersMap[s];if(!(o!=null&&o.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:s});const a=Array.from(o).map(async d=>d(n.origin,i)),l=await Bj(a);n.ports[0].postMessage({status:"done",eventId:r,eventType:s,response:l})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Dh.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ey(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zj{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let i,o;return new Promise((a,l)=>{const d=Ey("",20);s.port1.start();const h=setTimeout(()=>{l(new Error("unsupported_event"))},r);o={messageChannel:s,onMessage(f){const m=f;if(m.data.eventId===d)switch(m.data.status){case"ack":clearTimeout(h),i=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),a(m.data.response);break;default:clearTimeout(h),clearTimeout(i),l(new Error("invalid_response"));break}}},this.handlers.add(o),s.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:d,data:n},[s.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pr(){return window}function qj(t){Pr().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jS(){return typeof Pr().WorkerGlobalScope<"u"&&typeof Pr().importScripts=="function"}async function Hj(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function Wj(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)==null?void 0:t.controller)||null}function Kj(){return jS()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OS="firebaseLocalStorageDb",Gj=1,Ud="firebaseLocalStorage",VS="fbase_key";class Pc{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function jh(t,e){return t.transaction([Ud],e?"readwrite":"readonly").objectStore(Ud)}function Qj(){const t=indexedDB.deleteDatabase(OS);return new Pc(t).toPromise()}function Dm(){const t=indexedDB.open(OS,Gj);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(Ud,{keyPath:VS})}catch(s){n(s)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(Ud)?e(r):(r.close(),await Qj(),e(await Dm()))})})}async function rE(t,e,n){const r=jh(t,!0).put({[VS]:e,value:n});return new Pc(r).toPromise()}async function Yj(t,e){const n=jh(t,!1).get(e),r=await new Pc(n).toPromise();return r===void 0?null:r.value}function sE(t,e){const n=jh(t,!0).delete(e);return new Pc(n).toPromise()}const Xj=800,Jj=3;class LS{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Dm(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>Jj)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return jS()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Dh._getInstance(Kj()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var n,r;if(this.activeServiceWorker=await Hj(),!this.activeServiceWorker)return;this.sender=new zj(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&(n=e[0])!=null&&n.fulfilled&&(r=e[0])!=null&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||Wj()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Dm();return await rE(e,Fd,"1"),await sE(e,Fd),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>rE(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>Yj(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>sE(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const i=jh(s,!1).getAll();return new Pc(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;if(e.length!==0)for(const{fbase_key:s,value:i}of e)r.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(i)&&(this.notifyListeners(s,i),n.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!r.has(s)&&(this.notifyListeners(s,null),n.push(s));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),Xj)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}LS.type="LOCAL";const Zj=LS;new Ac(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function e2(t,e){return e?$r(e):(_e(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Iy extends _y{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Yo(e,this._buildIdpRequest())}_linkToIdToken(e,n){return Yo(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return Yo(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function t2(t){return AS(t.auth,new Iy(t),t.bypassAuthState)}function n2(t){const{auth:e,user:n}=t;return _e(n,e,"internal-error"),kj(n,new Iy(t),t.bypassAuthState)}async function r2(t){const{auth:e,user:n}=t;return _e(n,e,"internal-error"),Nj(n,new Iy(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MS{constructor(e,n,r,s,i=!1){this.auth=e,this.resolver=r,this.user=s,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:s,tenantId:i,error:o,type:a}=e;if(o){this.reject(o);return}const l={auth:this.auth,requestUri:n,sessionId:r,tenantId:i||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(l))}catch(d){this.reject(d)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return t2;case"linkViaPopup":case"linkViaRedirect":return r2;case"reauthViaPopup":case"reauthViaRedirect":return n2;default:ur(this.auth,"internal-error")}}resolve(e){Jr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Jr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const s2=new Ac(2e3,1e4);class $o extends MS{constructor(e,n,r,s,i){super(e,n,s,i),this.provider=r,this.authWindow=null,this.pollId=null,$o.currentPopupAction&&$o.currentPopupAction.cancel(),$o.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return _e(e,this.auth,"internal-error"),e}async onExecution(){Jr(this.filter.length===1,"Popup operations only handle one event");const e=Ey();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(Rr(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)==null?void 0:e.associatedEvent)||null}cancel(){this.reject(Rr(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,$o.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,r;if((r=(n=this.authWindow)==null?void 0:n.window)!=null&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Rr(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,s2.get())};e()}}$o.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const i2="pendingRedirect",Ku=new Map;class o2 extends MS{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=Ku.get(this.auth._key());if(!e){try{const r=await a2(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}Ku.set(this.auth._key(),e)}return this.bypassAuthState||Ku.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function a2(t,e){const n=u2(e),r=c2(t);if(!await r._isAvailable())return!1;const s=await r._get(n)==="true";return await r._remove(n),s}function l2(t,e){Ku.set(t._key(),e)}function c2(t){return $r(t._redirectPersistence)}function u2(t){return Wu(i2,t.config.apiKey,t.name)}async function d2(t,e,n=!1){if($n(t.app))return Promise.reject(Us(t));const r=Ra(t),s=e2(r,e),o=await new o2(r,s,n).execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const h2=10*60*1e3;class f2{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!p2(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!FS(e)){const s=((r=e.error.code)==null?void 0:r.split("auth/")[1])||"internal-error";n.onError(Rr(this.auth,s))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=h2&&this.cachedEventUids.clear(),this.cachedEventUids.has(iE(e))}saveEventToCache(e){this.cachedEventUids.add(iE(e)),this.lastProcessedEventTime=Date.now()}}function iE(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function FS({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function p2(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return FS(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function m2(t,e={}){return ni(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const g2=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,y2=/^https?/;async function _2(t){if(t.config.emulator)return;const{authorizedDomains:e}=await m2(t);for(const n of e)try{if(v2(n))return}catch{}ur(t,"unauthorized-domain")}function v2(t){const e=Nm(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&o.hostname===r}if(!y2.test(n))return!1;if(g2.test(t))return r===t;const s=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const w2=new Ac(3e4,6e4);function oE(){const t=Pr().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function E2(t){return new Promise((e,n)=>{var s,i,o;function r(){oE(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{oE(),n(Rr(t,"network-request-failed"))},timeout:w2.get()})}if((i=(s=Pr().gapi)==null?void 0:s.iframes)!=null&&i.Iframe)e(gapi.iframes.getContext());else if((o=Pr().gapi)!=null&&o.load)r();else{const a=pj("iframefcb");return Pr()[a]=()=>{gapi.load?r():n(Rr(t,"network-request-failed"))},TS(`${fj()}?onload=${a}`).catch(l=>n(l))}}).catch(e=>{throw Gu=null,e})}let Gu=null;function I2(t){return Gu=Gu||E2(t),Gu}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const T2=new Ac(5e3,15e3),x2="__/auth/iframe",S2="emulator/auth/iframe",b2={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},C2=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function A2(t){const e=t.config;_e(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?my(e,S2):`https://${t.config.authDomain}/${x2}`,r={apiKey:e.apiKey,appName:t.name,v:ro},s=C2.get(t.config.apiHost);s&&(r.eid=s);const i=t._getFrameworks();return i.length&&(r.fw=i.join(",")),`${n}?${Cc(r).slice(1)}`}async function R2(t){const e=await I2(t),n=Pr().gapi;return _e(n,t,"internal-error"),e.open({where:document.body,url:A2(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:b2,dontclear:!0},r=>new Promise(async(s,i)=>{await r.restyle({setHideOnLeave:!1});const o=Rr(t,"network-request-failed"),a=Pr().setTimeout(()=>{i(o)},T2.get());function l(){Pr().clearTimeout(a),s(r)}r.ping(l).then(l,()=>{i(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const P2={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},N2=500,k2=600,D2="_blank",j2="http://localhost";class aE{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function O2(t,e,n,r=N2,s=k2){const i=Math.max((window.screen.availHeight-s)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let a="";const l={...P2,width:r.toString(),height:s.toString(),top:i,left:o},d=Ot().toLowerCase();n&&(a=gS(d)?D2:n),pS(d)&&(e=e||j2,l.scrollbars="yes");const h=Object.entries(l).reduce((m,[w,R])=>`${m}${w}=${R},`,"");if(sj(d)&&a!=="_self")return V2(e||"",a),new aE(null);const f=window.open(e||"",a,h);_e(f,t,"popup-blocked");try{f.focus()}catch{}return new aE(f)}function V2(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const L2="__/auth/handler",M2="emulator/auth/handler",F2=encodeURIComponent("fac");async function lE(t,e,n,r,s,i){_e(t.config.authDomain,t,"auth-domain-config-required"),_e(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:ro,eventId:s};if(e instanceof bS){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",Ek(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[h,f]of Object.entries({}))o[h]=f}if(e instanceof Rc){const h=e.getScopes().filter(f=>f!=="");h.length>0&&(o.scopes=h.join(","))}t.tenantId&&(o.tid=t.tenantId);const a=o;for(const h of Object.keys(a))a[h]===void 0&&delete a[h];const l=await t._getAppCheckToken(),d=l?`#${F2}=${encodeURIComponent(l)}`:"";return`${U2(t)}?${Cc(a).slice(1)}${d}`}function U2({config:t}){return t.emulator?my(t,M2):`https://${t.authDomain}/${L2}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const up="webStorageSupport";class $2{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=DS,this._completeRedirectFn=d2,this._overrideRedirectResult=l2}async _openPopup(e,n,r,s){var o;Jr((o=this.eventManagers[e._key()])==null?void 0:o.manager,"_initialize() not called before _openPopup()");const i=await lE(e,n,r,Nm(),s);return O2(e,i,Ey())}async _openRedirect(e,n,r,s){await this._originValidation(e);const i=await lE(e,n,r,Nm(),s);return qj(i),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:s,promise:i}=this.eventManagers[n];return s?Promise.resolve(s):(Jr(i,"If manager is not set, promise should be"),i)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await R2(e),r=new f2(e);return n.register("authEvent",s=>(_e(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:r.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(up,{type:up},s=>{var o;const i=(o=s==null?void 0:s[0])==null?void 0:o[up];i!==void 0&&n(!!i),ur(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=_2(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return ES()||mS()||yy()}}const B2=$2;var cE="@firebase/auth",uE="1.11.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z2{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)==null?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){_e(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function q2(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function H2(t){cr(new Yn("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=r.options;_e(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const l={apiKey:o,authDomain:a,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:IS(t)},d=new uj(r,s,i,l);return wj(d,n),d},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),cr(new Yn("auth-internal",e=>{const n=Ra(e.getProvider("auth").getImmediate());return(r=>new z2(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),Sn(cE,uE,q2(t)),Sn(cE,uE,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const W2=5*60,K2=Gx("authIdTokenMaxAge")||W2;let dE=null;const G2=t=>async e=>{const n=e&&await e.getIdTokenResult(),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>K2)return;const s=n==null?void 0:n.token;dE!==s&&(dE=s,await fetch(t,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function US(t=Ph()){const e=ti(t,"auth");if(e.isInitialized())return e.getImmediate();const n=vj(t,{popupRedirectResolver:B2,persistence:[Zj,NS,DS]}),r=Gx("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(r,location.origin);if(location.origin===i.origin){const o=G2(i.toString());Mj(n,o,()=>o(n.currentUser)),Lj(n,a=>o(a))}}const s=Hx("auth");return s&&Ej(n,`http://${s}`),n}function Q2(){var t;return((t=document.getElementsByTagName("head"))==null?void 0:t[0])??document}dj({loadJS(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=s=>{const i=Rr("internal-error");i.customData=s,n(i)},r.type="text/javascript",r.charset="UTF-8",Q2().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});H2("Browser");var hE=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var $s,$S;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(x,_){function S(){}S.prototype=_.prototype,x.F=_.prototype,x.prototype=new S,x.prototype.constructor=x,x.D=function(C,k,D){for(var P=Array(arguments.length-2),Y=2;Y<arguments.length;Y++)P[Y-2]=arguments[Y];return _.prototype[k].apply(C,P)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(r,n),r.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(x,_,S){S||(S=0);const C=Array(16);if(typeof _=="string")for(var k=0;k<16;++k)C[k]=_.charCodeAt(S++)|_.charCodeAt(S++)<<8|_.charCodeAt(S++)<<16|_.charCodeAt(S++)<<24;else for(k=0;k<16;++k)C[k]=_[S++]|_[S++]<<8|_[S++]<<16|_[S++]<<24;_=x.g[0],S=x.g[1],k=x.g[2];let D=x.g[3],P;P=_+(D^S&(k^D))+C[0]+3614090360&4294967295,_=S+(P<<7&4294967295|P>>>25),P=D+(k^_&(S^k))+C[1]+3905402710&4294967295,D=_+(P<<12&4294967295|P>>>20),P=k+(S^D&(_^S))+C[2]+606105819&4294967295,k=D+(P<<17&4294967295|P>>>15),P=S+(_^k&(D^_))+C[3]+3250441966&4294967295,S=k+(P<<22&4294967295|P>>>10),P=_+(D^S&(k^D))+C[4]+4118548399&4294967295,_=S+(P<<7&4294967295|P>>>25),P=D+(k^_&(S^k))+C[5]+1200080426&4294967295,D=_+(P<<12&4294967295|P>>>20),P=k+(S^D&(_^S))+C[6]+2821735955&4294967295,k=D+(P<<17&4294967295|P>>>15),P=S+(_^k&(D^_))+C[7]+4249261313&4294967295,S=k+(P<<22&4294967295|P>>>10),P=_+(D^S&(k^D))+C[8]+1770035416&4294967295,_=S+(P<<7&4294967295|P>>>25),P=D+(k^_&(S^k))+C[9]+2336552879&4294967295,D=_+(P<<12&4294967295|P>>>20),P=k+(S^D&(_^S))+C[10]+4294925233&4294967295,k=D+(P<<17&4294967295|P>>>15),P=S+(_^k&(D^_))+C[11]+2304563134&4294967295,S=k+(P<<22&4294967295|P>>>10),P=_+(D^S&(k^D))+C[12]+1804603682&4294967295,_=S+(P<<7&4294967295|P>>>25),P=D+(k^_&(S^k))+C[13]+4254626195&4294967295,D=_+(P<<12&4294967295|P>>>20),P=k+(S^D&(_^S))+C[14]+2792965006&4294967295,k=D+(P<<17&4294967295|P>>>15),P=S+(_^k&(D^_))+C[15]+1236535329&4294967295,S=k+(P<<22&4294967295|P>>>10),P=_+(k^D&(S^k))+C[1]+4129170786&4294967295,_=S+(P<<5&4294967295|P>>>27),P=D+(S^k&(_^S))+C[6]+3225465664&4294967295,D=_+(P<<9&4294967295|P>>>23),P=k+(_^S&(D^_))+C[11]+643717713&4294967295,k=D+(P<<14&4294967295|P>>>18),P=S+(D^_&(k^D))+C[0]+3921069994&4294967295,S=k+(P<<20&4294967295|P>>>12),P=_+(k^D&(S^k))+C[5]+3593408605&4294967295,_=S+(P<<5&4294967295|P>>>27),P=D+(S^k&(_^S))+C[10]+38016083&4294967295,D=_+(P<<9&4294967295|P>>>23),P=k+(_^S&(D^_))+C[15]+3634488961&4294967295,k=D+(P<<14&4294967295|P>>>18),P=S+(D^_&(k^D))+C[4]+3889429448&4294967295,S=k+(P<<20&4294967295|P>>>12),P=_+(k^D&(S^k))+C[9]+568446438&4294967295,_=S+(P<<5&4294967295|P>>>27),P=D+(S^k&(_^S))+C[14]+3275163606&4294967295,D=_+(P<<9&4294967295|P>>>23),P=k+(_^S&(D^_))+C[3]+4107603335&4294967295,k=D+(P<<14&4294967295|P>>>18),P=S+(D^_&(k^D))+C[8]+1163531501&4294967295,S=k+(P<<20&4294967295|P>>>12),P=_+(k^D&(S^k))+C[13]+2850285829&4294967295,_=S+(P<<5&4294967295|P>>>27),P=D+(S^k&(_^S))+C[2]+4243563512&4294967295,D=_+(P<<9&4294967295|P>>>23),P=k+(_^S&(D^_))+C[7]+1735328473&4294967295,k=D+(P<<14&4294967295|P>>>18),P=S+(D^_&(k^D))+C[12]+2368359562&4294967295,S=k+(P<<20&4294967295|P>>>12),P=_+(S^k^D)+C[5]+4294588738&4294967295,_=S+(P<<4&4294967295|P>>>28),P=D+(_^S^k)+C[8]+2272392833&4294967295,D=_+(P<<11&4294967295|P>>>21),P=k+(D^_^S)+C[11]+1839030562&4294967295,k=D+(P<<16&4294967295|P>>>16),P=S+(k^D^_)+C[14]+4259657740&4294967295,S=k+(P<<23&4294967295|P>>>9),P=_+(S^k^D)+C[1]+2763975236&4294967295,_=S+(P<<4&4294967295|P>>>28),P=D+(_^S^k)+C[4]+1272893353&4294967295,D=_+(P<<11&4294967295|P>>>21),P=k+(D^_^S)+C[7]+4139469664&4294967295,k=D+(P<<16&4294967295|P>>>16),P=S+(k^D^_)+C[10]+3200236656&4294967295,S=k+(P<<23&4294967295|P>>>9),P=_+(S^k^D)+C[13]+681279174&4294967295,_=S+(P<<4&4294967295|P>>>28),P=D+(_^S^k)+C[0]+3936430074&4294967295,D=_+(P<<11&4294967295|P>>>21),P=k+(D^_^S)+C[3]+3572445317&4294967295,k=D+(P<<16&4294967295|P>>>16),P=S+(k^D^_)+C[6]+76029189&4294967295,S=k+(P<<23&4294967295|P>>>9),P=_+(S^k^D)+C[9]+3654602809&4294967295,_=S+(P<<4&4294967295|P>>>28),P=D+(_^S^k)+C[12]+3873151461&4294967295,D=_+(P<<11&4294967295|P>>>21),P=k+(D^_^S)+C[15]+530742520&4294967295,k=D+(P<<16&4294967295|P>>>16),P=S+(k^D^_)+C[2]+3299628645&4294967295,S=k+(P<<23&4294967295|P>>>9),P=_+(k^(S|~D))+C[0]+4096336452&4294967295,_=S+(P<<6&4294967295|P>>>26),P=D+(S^(_|~k))+C[7]+1126891415&4294967295,D=_+(P<<10&4294967295|P>>>22),P=k+(_^(D|~S))+C[14]+2878612391&4294967295,k=D+(P<<15&4294967295|P>>>17),P=S+(D^(k|~_))+C[5]+4237533241&4294967295,S=k+(P<<21&4294967295|P>>>11),P=_+(k^(S|~D))+C[12]+1700485571&4294967295,_=S+(P<<6&4294967295|P>>>26),P=D+(S^(_|~k))+C[3]+2399980690&4294967295,D=_+(P<<10&4294967295|P>>>22),P=k+(_^(D|~S))+C[10]+4293915773&4294967295,k=D+(P<<15&4294967295|P>>>17),P=S+(D^(k|~_))+C[1]+2240044497&4294967295,S=k+(P<<21&4294967295|P>>>11),P=_+(k^(S|~D))+C[8]+1873313359&4294967295,_=S+(P<<6&4294967295|P>>>26),P=D+(S^(_|~k))+C[15]+4264355552&4294967295,D=_+(P<<10&4294967295|P>>>22),P=k+(_^(D|~S))+C[6]+2734768916&4294967295,k=D+(P<<15&4294967295|P>>>17),P=S+(D^(k|~_))+C[13]+1309151649&4294967295,S=k+(P<<21&4294967295|P>>>11),P=_+(k^(S|~D))+C[4]+4149444226&4294967295,_=S+(P<<6&4294967295|P>>>26),P=D+(S^(_|~k))+C[11]+3174756917&4294967295,D=_+(P<<10&4294967295|P>>>22),P=k+(_^(D|~S))+C[2]+718787259&4294967295,k=D+(P<<15&4294967295|P>>>17),P=S+(D^(k|~_))+C[9]+3951481745&4294967295,x.g[0]=x.g[0]+_&4294967295,x.g[1]=x.g[1]+(k+(P<<21&4294967295|P>>>11))&4294967295,x.g[2]=x.g[2]+k&4294967295,x.g[3]=x.g[3]+D&4294967295}r.prototype.v=function(x,_){_===void 0&&(_=x.length);const S=_-this.blockSize,C=this.C;let k=this.h,D=0;for(;D<_;){if(k==0)for(;D<=S;)s(this,x,D),D+=this.blockSize;if(typeof x=="string"){for(;D<_;)if(C[k++]=x.charCodeAt(D++),k==this.blockSize){s(this,C),k=0;break}}else for(;D<_;)if(C[k++]=x[D++],k==this.blockSize){s(this,C),k=0;break}}this.h=k,this.o+=_},r.prototype.A=function(){var x=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);x[0]=128;for(var _=1;_<x.length-8;++_)x[_]=0;_=this.o*8;for(var S=x.length-8;S<x.length;++S)x[S]=_&255,_/=256;for(this.v(x),x=Array(16),_=0,S=0;S<4;++S)for(let C=0;C<32;C+=8)x[_++]=this.g[S]>>>C&255;return x};function i(x,_){var S=a;return Object.prototype.hasOwnProperty.call(S,x)?S[x]:S[x]=_(x)}function o(x,_){this.h=_;const S=[];let C=!0;for(let k=x.length-1;k>=0;k--){const D=x[k]|0;C&&D==_||(S[k]=D,C=!1)}this.g=S}var a={};function l(x){return-128<=x&&x<128?i(x,function(_){return new o([_|0],_<0?-1:0)}):new o([x|0],x<0?-1:0)}function d(x){if(isNaN(x)||!isFinite(x))return f;if(x<0)return A(d(-x));const _=[];let S=1;for(let C=0;x>=S;C++)_[C]=x/S|0,S*=4294967296;return new o(_,0)}function h(x,_){if(x.length==0)throw Error("number format error: empty string");if(_=_||10,_<2||36<_)throw Error("radix out of range: "+_);if(x.charAt(0)=="-")return A(h(x.substring(1),_));if(x.indexOf("-")>=0)throw Error('number format error: interior "-" character');const S=d(Math.pow(_,8));let C=f;for(let D=0;D<x.length;D+=8){var k=Math.min(8,x.length-D);const P=parseInt(x.substring(D,D+k),_);k<8?(k=d(Math.pow(_,k)),C=C.j(k).add(d(P))):(C=C.j(S),C=C.add(d(P)))}return C}var f=l(0),m=l(1),w=l(16777216);t=o.prototype,t.m=function(){if(b(this))return-A(this).m();let x=0,_=1;for(let S=0;S<this.g.length;S++){const C=this.i(S);x+=(C>=0?C:4294967296+C)*_,_*=4294967296}return x},t.toString=function(x){if(x=x||10,x<2||36<x)throw Error("radix out of range: "+x);if(R(this))return"0";if(b(this))return"-"+A(this).toString(x);const _=d(Math.pow(x,6));var S=this;let C="";for(;;){const k=j(S,_).g;S=T(S,k.j(_));let D=((S.g.length>0?S.g[0]:S.h)>>>0).toString(x);if(S=k,R(S))return D+C;for(;D.length<6;)D="0"+D;C=D+C}},t.i=function(x){return x<0?0:x<this.g.length?this.g[x]:this.h};function R(x){if(x.h!=0)return!1;for(let _=0;_<x.g.length;_++)if(x.g[_]!=0)return!1;return!0}function b(x){return x.h==-1}t.l=function(x){return x=T(this,x),b(x)?-1:R(x)?0:1};function A(x){const _=x.g.length,S=[];for(let C=0;C<_;C++)S[C]=~x.g[C];return new o(S,~x.h).add(m)}t.abs=function(){return b(this)?A(this):this},t.add=function(x){const _=Math.max(this.g.length,x.g.length),S=[];let C=0;for(let k=0;k<=_;k++){let D=C+(this.i(k)&65535)+(x.i(k)&65535),P=(D>>>16)+(this.i(k)>>>16)+(x.i(k)>>>16);C=P>>>16,D&=65535,P&=65535,S[k]=P<<16|D}return new o(S,S[S.length-1]&-2147483648?-1:0)};function T(x,_){return x.add(A(_))}t.j=function(x){if(R(this)||R(x))return f;if(b(this))return b(x)?A(this).j(A(x)):A(A(this).j(x));if(b(x))return A(this.j(A(x)));if(this.l(w)<0&&x.l(w)<0)return d(this.m()*x.m());const _=this.g.length+x.g.length,S=[];for(var C=0;C<2*_;C++)S[C]=0;for(C=0;C<this.g.length;C++)for(let k=0;k<x.g.length;k++){const D=this.i(C)>>>16,P=this.i(C)&65535,Y=x.i(k)>>>16,Ge=x.i(k)&65535;S[2*C+2*k]+=P*Ge,E(S,2*C+2*k),S[2*C+2*k+1]+=D*Ge,E(S,2*C+2*k+1),S[2*C+2*k+1]+=P*Y,E(S,2*C+2*k+1),S[2*C+2*k+2]+=D*Y,E(S,2*C+2*k+2)}for(x=0;x<_;x++)S[x]=S[2*x+1]<<16|S[2*x];for(x=_;x<2*_;x++)S[x]=0;return new o(S,0)};function E(x,_){for(;(x[_]&65535)!=x[_];)x[_+1]+=x[_]>>>16,x[_]&=65535,_++}function y(x,_){this.g=x,this.h=_}function j(x,_){if(R(_))throw Error("division by zero");if(R(x))return new y(f,f);if(b(x))return _=j(A(x),_),new y(A(_.g),A(_.h));if(b(_))return _=j(x,A(_)),new y(A(_.g),_.h);if(x.g.length>30){if(b(x)||b(_))throw Error("slowDivide_ only works with positive integers.");for(var S=m,C=_;C.l(x)<=0;)S=V(S),C=V(C);var k=M(S,1),D=M(C,1);for(C=M(C,2),S=M(S,2);!R(C);){var P=D.add(C);P.l(x)<=0&&(k=k.add(S),D=P),C=M(C,1),S=M(S,1)}return _=T(x,k.j(_)),new y(k,_)}for(k=f;x.l(_)>=0;){for(S=Math.max(1,Math.floor(x.m()/_.m())),C=Math.ceil(Math.log(S)/Math.LN2),C=C<=48?1:Math.pow(2,C-48),D=d(S),P=D.j(_);b(P)||P.l(x)>0;)S-=C,D=d(S),P=D.j(_);R(D)&&(D=m),k=k.add(D),x=T(x,P)}return new y(k,x)}t.B=function(x){return j(this,x).h},t.and=function(x){const _=Math.max(this.g.length,x.g.length),S=[];for(let C=0;C<_;C++)S[C]=this.i(C)&x.i(C);return new o(S,this.h&x.h)},t.or=function(x){const _=Math.max(this.g.length,x.g.length),S=[];for(let C=0;C<_;C++)S[C]=this.i(C)|x.i(C);return new o(S,this.h|x.h)},t.xor=function(x){const _=Math.max(this.g.length,x.g.length),S=[];for(let C=0;C<_;C++)S[C]=this.i(C)^x.i(C);return new o(S,this.h^x.h)};function V(x){const _=x.g.length+1,S=[];for(let C=0;C<_;C++)S[C]=x.i(C)<<1|x.i(C-1)>>>31;return new o(S,x.h)}function M(x,_){const S=_>>5;_%=32;const C=x.g.length-S,k=[];for(let D=0;D<C;D++)k[D]=_>0?x.i(D+S)>>>_|x.i(D+S+1)<<32-_:x.i(D+S);return new o(k,x.h)}r.prototype.digest=r.prototype.A,r.prototype.reset=r.prototype.u,r.prototype.update=r.prototype.v,$S=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.B,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=d,o.fromString=h,$s=o}).apply(typeof hE<"u"?hE:typeof self<"u"?self:typeof window<"u"?window:{});var vu=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var BS,ml,zS,Qu,jm,qS,HS,WS;(function(){var t,e=Object.defineProperty;function n(c){c=[typeof globalThis=="object"&&globalThis,c,typeof window=="object"&&window,typeof self=="object"&&self,typeof vu=="object"&&vu];for(var p=0;p<c.length;++p){var g=c[p];if(g&&g.Math==Math)return g}throw Error("Cannot find global object")}var r=n(this);function s(c,p){if(p)e:{var g=r;c=c.split(".");for(var I=0;I<c.length-1;I++){var L=c[I];if(!(L in g))break e;g=g[L]}c=c[c.length-1],I=g[c],p=p(I),p!=I&&p!=null&&e(g,c,{configurable:!0,writable:!0,value:p})}}s("Symbol.dispose",function(c){return c||Symbol("Symbol.dispose")}),s("Array.prototype.values",function(c){return c||function(){return this[Symbol.iterator]()}}),s("Object.entries",function(c){return c||function(p){var g=[],I;for(I in p)Object.prototype.hasOwnProperty.call(p,I)&&g.push([I,p[I]]);return g}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var i=i||{},o=this||self;function a(c){var p=typeof c;return p=="object"&&c!=null||p=="function"}function l(c,p,g){return c.call.apply(c.bind,arguments)}function d(c,p,g){return d=l,d.apply(null,arguments)}function h(c,p){var g=Array.prototype.slice.call(arguments,1);return function(){var I=g.slice();return I.push.apply(I,arguments),c.apply(this,I)}}function f(c,p){function g(){}g.prototype=p.prototype,c.Z=p.prototype,c.prototype=new g,c.prototype.constructor=c,c.Ob=function(I,L,$){for(var J=Array(arguments.length-2),be=2;be<arguments.length;be++)J[be-2]=arguments[be];return p.prototype[L].apply(I,J)}}var m=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?c=>c&&AsyncContext.Snapshot.wrap(c):c=>c;function w(c){const p=c.length;if(p>0){const g=Array(p);for(let I=0;I<p;I++)g[I]=c[I];return g}return[]}function R(c,p){for(let I=1;I<arguments.length;I++){const L=arguments[I];var g=typeof L;if(g=g!="object"?g:L?Array.isArray(L)?"array":g:"null",g=="array"||g=="object"&&typeof L.length=="number"){g=c.length||0;const $=L.length||0;c.length=g+$;for(let J=0;J<$;J++)c[g+J]=L[J]}else c.push(L)}}class b{constructor(p,g){this.i=p,this.j=g,this.h=0,this.g=null}get(){let p;return this.h>0?(this.h--,p=this.g,this.g=p.next,p.next=null):p=this.i(),p}}function A(c){o.setTimeout(()=>{throw c},0)}function T(){var c=x;let p=null;return c.g&&(p=c.g,c.g=c.g.next,c.g||(c.h=null),p.next=null),p}class E{constructor(){this.h=this.g=null}add(p,g){const I=y.get();I.set(p,g),this.h?this.h.next=I:this.g=I,this.h=I}}var y=new b(()=>new j,c=>c.reset());class j{constructor(){this.next=this.g=this.h=null}set(p,g){this.h=p,this.g=g,this.next=null}reset(){this.next=this.g=this.h=null}}let V,M=!1,x=new E,_=()=>{const c=Promise.resolve(void 0);V=()=>{c.then(S)}};function S(){for(var c;c=T();){try{c.h.call(c.g)}catch(g){A(g)}var p=y;p.j(c),p.h<100&&(p.h++,c.next=p.g,p.g=c)}M=!1}function C(){this.u=this.u,this.C=this.C}C.prototype.u=!1,C.prototype.dispose=function(){this.u||(this.u=!0,this.N())},C.prototype[Symbol.dispose]=function(){this.dispose()},C.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function k(c,p){this.type=c,this.g=this.target=p,this.defaultPrevented=!1}k.prototype.h=function(){this.defaultPrevented=!0};var D=function(){if(!o.addEventListener||!Object.defineProperty)return!1;var c=!1,p=Object.defineProperty({},"passive",{get:function(){c=!0}});try{const g=()=>{};o.addEventListener("test",g,p),o.removeEventListener("test",g,p)}catch{}return c}();function P(c){return/^[\s\xa0]*$/.test(c)}function Y(c,p){k.call(this,c?c.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,c&&this.init(c,p)}f(Y,k),Y.prototype.init=function(c,p){const g=this.type=c.type,I=c.changedTouches&&c.changedTouches.length?c.changedTouches[0]:null;this.target=c.target||c.srcElement,this.g=p,p=c.relatedTarget,p||(g=="mouseover"?p=c.fromElement:g=="mouseout"&&(p=c.toElement)),this.relatedTarget=p,I?(this.clientX=I.clientX!==void 0?I.clientX:I.pageX,this.clientY=I.clientY!==void 0?I.clientY:I.pageY,this.screenX=I.screenX||0,this.screenY=I.screenY||0):(this.clientX=c.clientX!==void 0?c.clientX:c.pageX,this.clientY=c.clientY!==void 0?c.clientY:c.pageY,this.screenX=c.screenX||0,this.screenY=c.screenY||0),this.button=c.button,this.key=c.key||"",this.ctrlKey=c.ctrlKey,this.altKey=c.altKey,this.shiftKey=c.shiftKey,this.metaKey=c.metaKey,this.pointerId=c.pointerId||0,this.pointerType=c.pointerType,this.state=c.state,this.i=c,c.defaultPrevented&&Y.Z.h.call(this)},Y.prototype.h=function(){Y.Z.h.call(this);const c=this.i;c.preventDefault?c.preventDefault():c.returnValue=!1};var Ge="closure_listenable_"+(Math.random()*1e6|0),Lt=0;function he(c,p,g,I,L){this.listener=c,this.proxy=null,this.src=p,this.type=g,this.capture=!!I,this.ha=L,this.key=++Lt,this.da=this.fa=!1}function Z(c){c.da=!0,c.listener=null,c.proxy=null,c.src=null,c.ha=null}function ce(c,p,g){for(const I in c)p.call(g,c[I],I,c)}function pe(c,p){for(const g in c)p.call(void 0,c[g],g,c)}function Ve(c){const p={};for(const g in c)p[g]=c[g];return p}const Qe="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function z(c,p){let g,I;for(let L=1;L<arguments.length;L++){I=arguments[L];for(g in I)c[g]=I[g];for(let $=0;$<Qe.length;$++)g=Qe[$],Object.prototype.hasOwnProperty.call(I,g)&&(c[g]=I[g])}}function te(c){this.src=c,this.g={},this.h=0}te.prototype.add=function(c,p,g,I,L){const $=c.toString();c=this.g[$],c||(c=this.g[$]=[],this.h++);const J=Ee(c,p,I,L);return J>-1?(p=c[J],g||(p.fa=!1)):(p=new he(p,this.src,$,!!I,L),p.fa=g,c.push(p)),p};function ue(c,p){const g=p.type;if(g in c.g){var I=c.g[g],L=Array.prototype.indexOf.call(I,p,void 0),$;($=L>=0)&&Array.prototype.splice.call(I,L,1),$&&(Z(p),c.g[g].length==0&&(delete c.g[g],c.h--))}}function Ee(c,p,g,I){for(let L=0;L<c.length;++L){const $=c[L];if(!$.da&&$.listener==p&&$.capture==!!g&&$.ha==I)return L}return-1}var we="closure_lm_"+(Math.random()*1e6|0),ke={};function ae(c,p,g,I,L){if(Array.isArray(p)){for(let $=0;$<p.length;$++)ae(c,p[$],g,I,L);return null}return g=ne(g),c&&c[Ge]?c.J(p,g,a(I)?!!I.capture:!1,L):nt(c,p,g,!1,I,L)}function nt(c,p,g,I,L,$){if(!p)throw Error("Invalid event type");const J=a(L)?!!L.capture:!!L;let be=ft(c);if(be||(c[we]=be=new te(c)),g=be.add(p,g,I,J,$),g.proxy)return g;if(I=xe(),g.proxy=I,I.src=c,I.listener=g,c.addEventListener)D||(L=J),L===void 0&&(L=!1),c.addEventListener(p.toString(),I,L);else if(c.attachEvent)c.attachEvent(it(p.toString()),I);else if(c.addListener&&c.removeListener)c.addListener(I);else throw Error("addEventListener and attachEvent are unavailable.");return g}function xe(){function c(g){return p.call(c.src,c.listener,g)}const p=rt;return c}function se(c,p,g,I,L){if(Array.isArray(p))for(var $=0;$<p.length;$++)se(c,p[$],g,I,L);else I=a(I)?!!I.capture:!!I,g=ne(g),c&&c[Ge]?(c=c.i,$=String(p).toString(),$ in c.g&&(p=c.g[$],g=Ee(p,g,I,L),g>-1&&(Z(p[g]),Array.prototype.splice.call(p,g,1),p.length==0&&(delete c.g[$],c.h--)))):c&&(c=ft(c))&&(p=c.g[p.toString()],c=-1,p&&(c=Ee(p,g,I,L)),(g=c>-1?p[c]:null)&&De(g))}function De(c){if(typeof c!="number"&&c&&!c.da){var p=c.src;if(p&&p[Ge])ue(p.i,c);else{var g=c.type,I=c.proxy;p.removeEventListener?p.removeEventListener(g,I,c.capture):p.detachEvent?p.detachEvent(it(g),I):p.addListener&&p.removeListener&&p.removeListener(I),(g=ft(p))?(ue(g,c),g.h==0&&(g.src=null,p[we]=null)):Z(c)}}}function it(c){return c in ke?ke[c]:ke[c]="on"+c}function rt(c,p){if(c.da)c=!0;else{p=new Y(p,this);const g=c.listener,I=c.ha||c.src;c.fa&&De(c),c=g.call(I,p)}return c}function ft(c){return c=c[we],c instanceof te?c:null}var q="__closure_events_fn_"+(Math.random()*1e9>>>0);function ne(c){return typeof c=="function"?c:(c[q]||(c[q]=function(p){return c.handleEvent(p)}),c[q])}function H(){C.call(this),this.i=new te(this),this.M=this,this.G=null}f(H,C),H.prototype[Ge]=!0,H.prototype.removeEventListener=function(c,p,g,I){se(this,c,p,g,I)};function Q(c,p){var g,I=c.G;if(I)for(g=[];I;I=I.G)g.push(I);if(c=c.M,I=p.type||p,typeof p=="string")p=new k(p,c);else if(p instanceof k)p.target=p.target||c;else{var L=p;p=new k(I,c),z(p,L)}L=!0;let $,J;if(g)for(J=g.length-1;J>=0;J--)$=p.g=g[J],L=de($,I,!0,p)&&L;if($=p.g=c,L=de($,I,!0,p)&&L,L=de($,I,!1,p)&&L,g)for(J=0;J<g.length;J++)$=p.g=g[J],L=de($,I,!1,p)&&L}H.prototype.N=function(){if(H.Z.N.call(this),this.i){var c=this.i;for(const p in c.g){const g=c.g[p];for(let I=0;I<g.length;I++)Z(g[I]);delete c.g[p],c.h--}}this.G=null},H.prototype.J=function(c,p,g,I){return this.i.add(String(c),p,!1,g,I)},H.prototype.K=function(c,p,g,I){return this.i.add(String(c),p,!0,g,I)};function de(c,p,g,I){if(p=c.i.g[String(p)],!p)return!0;p=p.concat();let L=!0;for(let $=0;$<p.length;++$){const J=p[$];if(J&&!J.da&&J.capture==g){const be=J.listener,kt=J.ha||J.src;J.fa&&ue(c.i,J),L=be.call(kt,I)!==!1&&L}}return L&&!I.defaultPrevented}function Se(c,p){if(typeof c!="function")if(c&&typeof c.handleEvent=="function")c=d(c.handleEvent,c);else throw Error("Invalid listener argument");return Number(p)>2147483647?-1:o.setTimeout(c,p||0)}function Ae(c){c.g=Se(()=>{c.g=null,c.i&&(c.i=!1,Ae(c))},c.l);const p=c.h;c.h=null,c.m.apply(null,p)}class Be extends C{constructor(p,g){super(),this.m=p,this.l=g,this.h=null,this.i=!1,this.g=null}j(p){this.h=arguments,this.g?this.i=!0:Ae(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Te(c){C.call(this),this.h=c,this.g={}}f(Te,C);var Le=[];function me(c){ce(c.g,function(p,g){this.g.hasOwnProperty(g)&&De(p)},c),c.g={}}Te.prototype.N=function(){Te.Z.N.call(this),me(this)},Te.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var qe=o.JSON.stringify,F=o.JSON.parse,X=class{stringify(c){return o.JSON.stringify(c,void 0)}parse(c){return o.JSON.parse(c,void 0)}};function v(){}function U(){}var re={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function ge(){k.call(this,"d")}f(ge,k);function Re(){k.call(this,"c")}f(Re,k);var Me={},Xt=null;function Nt(){return Xt=Xt||new H}Me.Ia="serverreachability";function St(c){k.call(this,Me.Ia,c)}f(St,k);function We(c){const p=Nt();Q(p,new St(p))}Me.STAT_EVENT="statevent";function pt(c,p){k.call(this,Me.STAT_EVENT,c),this.stat=p}f(pt,k);function Pe(c){const p=Nt();Q(p,new pt(p,c))}Me.Ja="timingevent";function ss(c,p){k.call(this,Me.Ja,c),this.size=p}f(ss,k);function pr(c,p){if(typeof c!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){c()},p)}function bn(){this.g=!0}bn.prototype.ua=function(){this.g=!1};function mr(c,p,g,I,L,$){c.info(function(){if(c.g)if($){var J="",be=$.split("&");for(let et=0;et<be.length;et++){var kt=be[et].split("=");if(kt.length>1){const Mt=kt[0];kt=kt[1];const yr=Mt.split("_");J=yr.length>=2&&yr[1]=="type"?J+(Mt+"="+kt+"&"):J+(Mt+"=redacted&")}}}else J=null;else J=$;return"XMLHTTP REQ ("+I+") [attempt "+L+"]: "+p+`
`+g+`
`+J})}function $A(c,p,g,I,L,$,J){c.info(function(){return"XMLHTTP RESP ("+I+") [ attempt "+L+"]: "+p+`
`+g+`
`+$+" "+J})}function ao(c,p,g,I){c.info(function(){return"XMLHTTP TEXT ("+p+"): "+zA(c,g)+(I?" "+I:"")})}function BA(c,p){c.info(function(){return"TIMEOUT: "+p})}bn.prototype.info=function(){};function zA(c,p){if(!c.g)return p;if(!p)return null;try{const $=JSON.parse(p);if($){for(c=0;c<$.length;c++)if(Array.isArray($[c])){var g=$[c];if(!(g.length<2)){var I=g[1];if(Array.isArray(I)&&!(I.length<1)){var L=I[0];if(L!="noop"&&L!="stop"&&L!="close")for(let J=1;J<I.length;J++)I[J]=""}}}}return qe($)}catch{return p}}var qc={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},j_={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},O_;function gf(){}f(gf,v),gf.prototype.g=function(){return new XMLHttpRequest},O_=new gf;function Va(c){return encodeURIComponent(String(c))}function qA(c){var p=1;c=c.split(":");const g=[];for(;p>0&&c.length;)g.push(c.shift()),p--;return c.length&&g.push(c.join(":")),g}function is(c,p,g,I){this.j=c,this.i=p,this.l=g,this.S=I||1,this.V=new Te(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new V_}function V_(){this.i=null,this.g="",this.h=!1}var L_={},yf={};function _f(c,p,g){c.M=1,c.A=Wc(gr(p)),c.u=g,c.R=!0,M_(c,null)}function M_(c,p){c.F=Date.now(),Hc(c),c.B=gr(c.A);var g=c.B,I=c.S;Array.isArray(I)||(I=[String(I)]),X_(g.i,"t",I),c.C=0,g=c.j.L,c.h=new V_,c.g=mv(c.j,g?p:null,!c.u),c.P>0&&(c.O=new Be(d(c.Y,c,c.g),c.P)),p=c.V,g=c.g,I=c.ba;var L="readystatechange";Array.isArray(L)||(L&&(Le[0]=L.toString()),L=Le);for(let $=0;$<L.length;$++){const J=ae(g,L[$],I||p.handleEvent,!1,p.h||p);if(!J)break;p.g[J.key]=J}p=c.J?Ve(c.J):{},c.u?(c.v||(c.v="POST"),p["Content-Type"]="application/x-www-form-urlencoded",c.g.ea(c.B,c.v,c.u,p)):(c.v="GET",c.g.ea(c.B,c.v,null,p)),We(),mr(c.i,c.v,c.B,c.l,c.S,c.u)}is.prototype.ba=function(c){c=c.target;const p=this.O;p&&ls(c)==3?p.j():this.Y(c)},is.prototype.Y=function(c){try{if(c==this.g)e:{const be=ls(this.g),kt=this.g.ya(),et=this.g.ca();if(!(be<3)&&(be!=3||this.g&&(this.h.h||this.g.la()||sv(this.g)))){this.K||be!=4||kt==7||(kt==8||et<=0?We(3):We(2)),vf(this);var p=this.g.ca();this.X=p;var g=HA(this);if(this.o=p==200,$A(this.i,this.v,this.B,this.l,this.S,be,p),this.o){if(this.U&&!this.L){t:{if(this.g){var I,L=this.g;if((I=L.g?L.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!P(I)){var $=I;break t}}$=null}if(c=$)ao(this.i,this.l,c,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,wf(this,c);else{this.o=!1,this.m=3,Pe(12),oi(this),La(this);break e}}if(this.R){c=!0;let Mt;for(;!this.K&&this.C<g.length;)if(Mt=WA(this,g),Mt==yf){be==4&&(this.m=4,Pe(14),c=!1),ao(this.i,this.l,null,"[Incomplete Response]");break}else if(Mt==L_){this.m=4,Pe(15),ao(this.i,this.l,g,"[Invalid Chunk]"),c=!1;break}else ao(this.i,this.l,Mt,null),wf(this,Mt);if(F_(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),be!=4||g.length!=0||this.h.h||(this.m=1,Pe(16),c=!1),this.o=this.o&&c,!c)ao(this.i,this.l,g,"[Invalid Chunked Response]"),oi(this),La(this);else if(g.length>0&&!this.W){this.W=!0;var J=this.j;J.g==this&&J.aa&&!J.P&&(J.j.info("Great, no buffering proxy detected. Bytes received: "+g.length),Af(J),J.P=!0,Pe(11))}}else ao(this.i,this.l,g,null),wf(this,g);be==4&&oi(this),this.o&&!this.K&&(be==4?dv(this.j,this):(this.o=!1,Hc(this)))}else oR(this.g),p==400&&g.indexOf("Unknown SID")>0?(this.m=3,Pe(12)):(this.m=0,Pe(13)),oi(this),La(this)}}}catch{}finally{}};function HA(c){if(!F_(c))return c.g.la();const p=sv(c.g);if(p==="")return"";let g="";const I=p.length,L=ls(c.g)==4;if(!c.h.i){if(typeof TextDecoder>"u")return oi(c),La(c),"";c.h.i=new o.TextDecoder}for(let $=0;$<I;$++)c.h.h=!0,g+=c.h.i.decode(p[$],{stream:!(L&&$==I-1)});return p.length=0,c.h.g+=g,c.C=0,c.h.g}function F_(c){return c.g?c.v=="GET"&&c.M!=2&&c.j.Aa:!1}function WA(c,p){var g=c.C,I=p.indexOf(`
`,g);return I==-1?yf:(g=Number(p.substring(g,I)),isNaN(g)?L_:(I+=1,I+g>p.length?yf:(p=p.slice(I,I+g),c.C=I+g,p)))}is.prototype.cancel=function(){this.K=!0,oi(this)};function Hc(c){c.T=Date.now()+c.H,U_(c,c.H)}function U_(c,p){if(c.D!=null)throw Error("WatchDog timer not null");c.D=pr(d(c.aa,c),p)}function vf(c){c.D&&(o.clearTimeout(c.D),c.D=null)}is.prototype.aa=function(){this.D=null;const c=Date.now();c-this.T>=0?(BA(this.i,this.B),this.M!=2&&(We(),Pe(17)),oi(this),this.m=2,La(this)):U_(this,this.T-c)};function La(c){c.j.I==0||c.K||dv(c.j,c)}function oi(c){vf(c);var p=c.O;p&&typeof p.dispose=="function"&&p.dispose(),c.O=null,me(c.V),c.g&&(p=c.g,c.g=null,p.abort(),p.dispose())}function wf(c,p){try{var g=c.j;if(g.I!=0&&(g.g==c||Ef(g.h,c))){if(!c.L&&Ef(g.h,c)&&g.I==3){try{var I=g.Ba.g.parse(p)}catch{I=null}if(Array.isArray(I)&&I.length==3){var L=I;if(L[0]==0){e:if(!g.v){if(g.g)if(g.g.F+3e3<c.F)Xc(g),Qc(g);else break e;Cf(g),Pe(18)}}else g.xa=L[1],0<g.xa-g.K&&L[2]<37500&&g.F&&g.A==0&&!g.C&&(g.C=pr(d(g.Va,g),6e3));z_(g.h)<=1&&g.ta&&(g.ta=void 0)}else li(g,11)}else if((c.L||g.g==c)&&Xc(g),!P(p))for(L=g.Ba.g.parse(p),p=0;p<L.length;p++){let et=L[p];const Mt=et[0];if(!(Mt<=g.K))if(g.K=Mt,et=et[1],g.I==2)if(et[0]=="c"){g.M=et[1],g.ba=et[2];const yr=et[3];yr!=null&&(g.ka=yr,g.j.info("VER="+g.ka));const ci=et[4];ci!=null&&(g.za=ci,g.j.info("SVER="+g.za));const cs=et[5];cs!=null&&typeof cs=="number"&&cs>0&&(I=1.5*cs,g.O=I,g.j.info("backChannelRequestTimeoutMs_="+I)),I=g;const us=c.g;if(us){const Zc=us.g?us.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Zc){var $=I.h;$.g||Zc.indexOf("spdy")==-1&&Zc.indexOf("quic")==-1&&Zc.indexOf("h2")==-1||($.j=$.l,$.g=new Set,$.h&&(If($,$.h),$.h=null))}if(I.G){const Rf=us.g?us.g.getResponseHeader("X-HTTP-Session-Id"):null;Rf&&(I.wa=Rf,ot(I.J,I.G,Rf))}}g.I=3,g.l&&g.l.ra(),g.aa&&(g.T=Date.now()-c.F,g.j.info("Handshake RTT: "+g.T+"ms")),I=g;var J=c;if(I.na=pv(I,I.L?I.ba:null,I.W),J.L){q_(I.h,J);var be=J,kt=I.O;kt&&(be.H=kt),be.D&&(vf(be),Hc(be)),I.g=J}else cv(I);g.i.length>0&&Yc(g)}else et[0]!="stop"&&et[0]!="close"||li(g,7);else g.I==3&&(et[0]=="stop"||et[0]=="close"?et[0]=="stop"?li(g,7):bf(g):et[0]!="noop"&&g.l&&g.l.qa(et),g.A=0)}}We(4)}catch{}}var KA=class{constructor(c,p){this.g=c,this.map=p}};function $_(c){this.l=c||10,o.PerformanceNavigationTiming?(c=o.performance.getEntriesByType("navigation"),c=c.length>0&&(c[0].nextHopProtocol=="hq"||c[0].nextHopProtocol=="h2")):c=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=c?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function B_(c){return c.h?!0:c.g?c.g.size>=c.j:!1}function z_(c){return c.h?1:c.g?c.g.size:0}function Ef(c,p){return c.h?c.h==p:c.g?c.g.has(p):!1}function If(c,p){c.g?c.g.add(p):c.h=p}function q_(c,p){c.h&&c.h==p?c.h=null:c.g&&c.g.has(p)&&c.g.delete(p)}$_.prototype.cancel=function(){if(this.i=H_(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const c of this.g.values())c.cancel();this.g.clear()}};function H_(c){if(c.h!=null)return c.i.concat(c.h.G);if(c.g!=null&&c.g.size!==0){let p=c.i;for(const g of c.g.values())p=p.concat(g.G);return p}return w(c.i)}var W_=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function GA(c,p){if(c){c=c.split("&");for(let g=0;g<c.length;g++){const I=c[g].indexOf("=");let L,$=null;I>=0?(L=c[g].substring(0,I),$=c[g].substring(I+1)):L=c[g],p(L,$?decodeURIComponent($.replace(/\+/g," ")):"")}}}function os(c){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let p;c instanceof os?(this.l=c.l,Ma(this,c.j),this.o=c.o,this.g=c.g,Fa(this,c.u),this.h=c.h,Tf(this,J_(c.i)),this.m=c.m):c&&(p=String(c).match(W_))?(this.l=!1,Ma(this,p[1]||"",!0),this.o=Ua(p[2]||""),this.g=Ua(p[3]||"",!0),Fa(this,p[4]),this.h=Ua(p[5]||"",!0),Tf(this,p[6]||"",!0),this.m=Ua(p[7]||"")):(this.l=!1,this.i=new Ba(null,this.l))}os.prototype.toString=function(){const c=[];var p=this.j;p&&c.push($a(p,K_,!0),":");var g=this.g;return(g||p=="file")&&(c.push("//"),(p=this.o)&&c.push($a(p,K_,!0),"@"),c.push(Va(g).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),g=this.u,g!=null&&c.push(":",String(g))),(g=this.h)&&(this.g&&g.charAt(0)!="/"&&c.push("/"),c.push($a(g,g.charAt(0)=="/"?XA:YA,!0))),(g=this.i.toString())&&c.push("?",g),(g=this.m)&&c.push("#",$a(g,ZA)),c.join("")},os.prototype.resolve=function(c){const p=gr(this);let g=!!c.j;g?Ma(p,c.j):g=!!c.o,g?p.o=c.o:g=!!c.g,g?p.g=c.g:g=c.u!=null;var I=c.h;if(g)Fa(p,c.u);else if(g=!!c.h){if(I.charAt(0)!="/")if(this.g&&!this.h)I="/"+I;else{var L=p.h.lastIndexOf("/");L!=-1&&(I=p.h.slice(0,L+1)+I)}if(L=I,L==".."||L==".")I="";else if(L.indexOf("./")!=-1||L.indexOf("/.")!=-1){I=L.lastIndexOf("/",0)==0,L=L.split("/");const $=[];for(let J=0;J<L.length;){const be=L[J++];be=="."?I&&J==L.length&&$.push(""):be==".."?(($.length>1||$.length==1&&$[0]!="")&&$.pop(),I&&J==L.length&&$.push("")):($.push(be),I=!0)}I=$.join("/")}else I=L}return g?p.h=I:g=c.i.toString()!=="",g?Tf(p,J_(c.i)):g=!!c.m,g&&(p.m=c.m),p};function gr(c){return new os(c)}function Ma(c,p,g){c.j=g?Ua(p,!0):p,c.j&&(c.j=c.j.replace(/:$/,""))}function Fa(c,p){if(p){if(p=Number(p),isNaN(p)||p<0)throw Error("Bad port number "+p);c.u=p}else c.u=null}function Tf(c,p,g){p instanceof Ba?(c.i=p,eR(c.i,c.l)):(g||(p=$a(p,JA)),c.i=new Ba(p,c.l))}function ot(c,p,g){c.i.set(p,g)}function Wc(c){return ot(c,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),c}function Ua(c,p){return c?p?decodeURI(c.replace(/%25/g,"%2525")):decodeURIComponent(c):""}function $a(c,p,g){return typeof c=="string"?(c=encodeURI(c).replace(p,QA),g&&(c=c.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),c):null}function QA(c){return c=c.charCodeAt(0),"%"+(c>>4&15).toString(16)+(c&15).toString(16)}var K_=/[#\/\?@]/g,YA=/[#\?:]/g,XA=/[#\?]/g,JA=/[#\?@]/g,ZA=/#/g;function Ba(c,p){this.h=this.g=null,this.i=c||null,this.j=!!p}function ai(c){c.g||(c.g=new Map,c.h=0,c.i&&GA(c.i,function(p,g){c.add(decodeURIComponent(p.replace(/\+/g," ")),g)}))}t=Ba.prototype,t.add=function(c,p){ai(this),this.i=null,c=lo(this,c);let g=this.g.get(c);return g||this.g.set(c,g=[]),g.push(p),this.h+=1,this};function G_(c,p){ai(c),p=lo(c,p),c.g.has(p)&&(c.i=null,c.h-=c.g.get(p).length,c.g.delete(p))}function Q_(c,p){return ai(c),p=lo(c,p),c.g.has(p)}t.forEach=function(c,p){ai(this),this.g.forEach(function(g,I){g.forEach(function(L){c.call(p,L,I,this)},this)},this)};function Y_(c,p){ai(c);let g=[];if(typeof p=="string")Q_(c,p)&&(g=g.concat(c.g.get(lo(c,p))));else for(c=Array.from(c.g.values()),p=0;p<c.length;p++)g=g.concat(c[p]);return g}t.set=function(c,p){return ai(this),this.i=null,c=lo(this,c),Q_(this,c)&&(this.h-=this.g.get(c).length),this.g.set(c,[p]),this.h+=1,this},t.get=function(c,p){return c?(c=Y_(this,c),c.length>0?String(c[0]):p):p};function X_(c,p,g){G_(c,p),g.length>0&&(c.i=null,c.g.set(lo(c,p),w(g)),c.h+=g.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const c=[],p=Array.from(this.g.keys());for(let I=0;I<p.length;I++){var g=p[I];const L=Va(g);g=Y_(this,g);for(let $=0;$<g.length;$++){let J=L;g[$]!==""&&(J+="="+Va(g[$])),c.push(J)}}return this.i=c.join("&")};function J_(c){const p=new Ba;return p.i=c.i,c.g&&(p.g=new Map(c.g),p.h=c.h),p}function lo(c,p){return p=String(p),c.j&&(p=p.toLowerCase()),p}function eR(c,p){p&&!c.j&&(ai(c),c.i=null,c.g.forEach(function(g,I){const L=I.toLowerCase();I!=L&&(G_(this,I),X_(this,L,g))},c)),c.j=p}function tR(c,p){const g=new bn;if(o.Image){const I=new Image;I.onload=h(as,g,"TestLoadImage: loaded",!0,p,I),I.onerror=h(as,g,"TestLoadImage: error",!1,p,I),I.onabort=h(as,g,"TestLoadImage: abort",!1,p,I),I.ontimeout=h(as,g,"TestLoadImage: timeout",!1,p,I),o.setTimeout(function(){I.ontimeout&&I.ontimeout()},1e4),I.src=c}else p(!1)}function nR(c,p){const g=new bn,I=new AbortController,L=setTimeout(()=>{I.abort(),as(g,"TestPingServer: timeout",!1,p)},1e4);fetch(c,{signal:I.signal}).then($=>{clearTimeout(L),$.ok?as(g,"TestPingServer: ok",!0,p):as(g,"TestPingServer: server error",!1,p)}).catch(()=>{clearTimeout(L),as(g,"TestPingServer: error",!1,p)})}function as(c,p,g,I,L){try{L&&(L.onload=null,L.onerror=null,L.onabort=null,L.ontimeout=null),I(g)}catch{}}function rR(){this.g=new X}function xf(c){this.i=c.Sb||null,this.h=c.ab||!1}f(xf,v),xf.prototype.g=function(){return new Kc(this.i,this.h)};function Kc(c,p){H.call(this),this.H=c,this.o=p,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}f(Kc,H),t=Kc.prototype,t.open=function(c,p){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=c,this.D=p,this.readyState=1,qa(this)},t.send=function(c){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const p={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};c&&(p.body=c),(this.H||o).fetch(new Request(this.D,p)).then(this.Pa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,za(this)),this.readyState=0},t.Pa=function(c){if(this.g&&(this.l=c,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=c.headers,this.readyState=2,qa(this)),this.g&&(this.readyState=3,qa(this),this.g)))if(this.responseType==="arraybuffer")c.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in c){if(this.j=c.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;Z_(this)}else c.text().then(this.Oa.bind(this),this.ga.bind(this))};function Z_(c){c.j.read().then(c.Ma.bind(c)).catch(c.ga.bind(c))}t.Ma=function(c){if(this.g){if(this.o&&c.value)this.response.push(c.value);else if(!this.o){var p=c.value?c.value:new Uint8Array(0);(p=this.B.decode(p,{stream:!c.done}))&&(this.response=this.responseText+=p)}c.done?za(this):qa(this),this.readyState==3&&Z_(this)}},t.Oa=function(c){this.g&&(this.response=this.responseText=c,za(this))},t.Na=function(c){this.g&&(this.response=c,za(this))},t.ga=function(){this.g&&za(this)};function za(c){c.readyState=4,c.l=null,c.j=null,c.B=null,qa(c)}t.setRequestHeader=function(c,p){this.A.append(c,p)},t.getResponseHeader=function(c){return this.h&&this.h.get(c.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const c=[],p=this.h.entries();for(var g=p.next();!g.done;)g=g.value,c.push(g[0]+": "+g[1]),g=p.next();return c.join(`\r
`)};function qa(c){c.onreadystatechange&&c.onreadystatechange.call(c)}Object.defineProperty(Kc.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(c){this.m=c?"include":"same-origin"}});function ev(c){let p="";return ce(c,function(g,I){p+=I,p+=":",p+=g,p+=`\r
`}),p}function Sf(c,p,g){e:{for(I in g){var I=!1;break e}I=!0}I||(g=ev(g),typeof c=="string"?g!=null&&Va(g):ot(c,p,g))}function vt(c){H.call(this),this.headers=new Map,this.L=c||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}f(vt,H);var sR=/^https?$/i,iR=["POST","PUT"];t=vt.prototype,t.Fa=function(c){this.H=c},t.ea=function(c,p,g,I){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+c);p=p?p.toUpperCase():"GET",this.D=c,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():O_.g(),this.g.onreadystatechange=m(d(this.Ca,this));try{this.B=!0,this.g.open(p,String(c),!0),this.B=!1}catch($){tv(this,$);return}if(c=g||"",g=new Map(this.headers),I)if(Object.getPrototypeOf(I)===Object.prototype)for(var L in I)g.set(L,I[L]);else if(typeof I.keys=="function"&&typeof I.get=="function")for(const $ of I.keys())g.set($,I.get($));else throw Error("Unknown input type for opt_headers: "+String(I));I=Array.from(g.keys()).find($=>$.toLowerCase()=="content-type"),L=o.FormData&&c instanceof o.FormData,!(Array.prototype.indexOf.call(iR,p,void 0)>=0)||I||L||g.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[$,J]of g)this.g.setRequestHeader($,J);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(c),this.v=!1}catch($){tv(this,$)}};function tv(c,p){c.h=!1,c.g&&(c.j=!0,c.g.abort(),c.j=!1),c.l=p,c.o=5,nv(c),Gc(c)}function nv(c){c.A||(c.A=!0,Q(c,"complete"),Q(c,"error"))}t.abort=function(c){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=c||7,Q(this,"complete"),Q(this,"abort"),Gc(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Gc(this,!0)),vt.Z.N.call(this)},t.Ca=function(){this.u||(this.B||this.v||this.j?rv(this):this.Xa())},t.Xa=function(){rv(this)};function rv(c){if(c.h&&typeof i<"u"){if(c.v&&ls(c)==4)setTimeout(c.Ca.bind(c),0);else if(Q(c,"readystatechange"),ls(c)==4){c.h=!1;try{const $=c.ca();e:switch($){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var p=!0;break e;default:p=!1}var g;if(!(g=p)){var I;if(I=$===0){let J=String(c.D).match(W_)[1]||null;!J&&o.self&&o.self.location&&(J=o.self.location.protocol.slice(0,-1)),I=!sR.test(J?J.toLowerCase():"")}g=I}if(g)Q(c,"complete"),Q(c,"success");else{c.o=6;try{var L=ls(c)>2?c.g.statusText:""}catch{L=""}c.l=L+" ["+c.ca()+"]",nv(c)}}finally{Gc(c)}}}}function Gc(c,p){if(c.g){c.m&&(clearTimeout(c.m),c.m=null);const g=c.g;c.g=null,p||Q(c,"ready");try{g.onreadystatechange=null}catch{}}}t.isActive=function(){return!!this.g};function ls(c){return c.g?c.g.readyState:0}t.ca=function(){try{return ls(this)>2?this.g.status:-1}catch{return-1}},t.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.La=function(c){if(this.g){var p=this.g.responseText;return c&&p.indexOf(c)==0&&(p=p.substring(c.length)),F(p)}};function sv(c){try{if(!c.g)return null;if("response"in c.g)return c.g.response;switch(c.F){case"":case"text":return c.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in c.g)return c.g.mozResponseArrayBuffer}return null}catch{return null}}function oR(c){const p={};c=(c.g&&ls(c)>=2&&c.g.getAllResponseHeaders()||"").split(`\r
`);for(let I=0;I<c.length;I++){if(P(c[I]))continue;var g=qA(c[I]);const L=g[0];if(g=g[1],typeof g!="string")continue;g=g.trim();const $=p[L]||[];p[L]=$,$.push(g)}pe(p,function(I){return I.join(", ")})}t.ya=function(){return this.o},t.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function Ha(c,p,g){return g&&g.internalChannelParams&&g.internalChannelParams[c]||p}function iv(c){this.za=0,this.i=[],this.j=new bn,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Ha("failFast",!1,c),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Ha("baseRetryDelayMs",5e3,c),this.Za=Ha("retryDelaySeedMs",1e4,c),this.Ta=Ha("forwardChannelMaxRetries",2,c),this.va=Ha("forwardChannelRequestTimeoutMs",2e4,c),this.ma=c&&c.xmlHttpFactory||void 0,this.Ua=c&&c.Rb||void 0,this.Aa=c&&c.useFetchStreams||!1,this.O=void 0,this.L=c&&c.supportsCrossDomainXhr||!1,this.M="",this.h=new $_(c&&c.concurrentRequestLimit),this.Ba=new rR,this.S=c&&c.fastHandshake||!1,this.R=c&&c.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=c&&c.Pb||!1,c&&c.ua&&this.j.ua(),c&&c.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&c&&c.detectBufferingProxy||!1,this.ia=void 0,c&&c.longPollingTimeout&&c.longPollingTimeout>0&&(this.ia=c.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}t=iv.prototype,t.ka=8,t.I=1,t.connect=function(c,p,g,I){Pe(0),this.W=c,this.H=p||{},g&&I!==void 0&&(this.H.OSID=g,this.H.OAID=I),this.F=this.X,this.J=pv(this,null,this.W),Yc(this)};function bf(c){if(ov(c),c.I==3){var p=c.V++,g=gr(c.J);if(ot(g,"SID",c.M),ot(g,"RID",p),ot(g,"TYPE","terminate"),Wa(c,g),p=new is(c,c.j,p),p.M=2,p.A=Wc(gr(g)),g=!1,o.navigator&&o.navigator.sendBeacon)try{g=o.navigator.sendBeacon(p.A.toString(),"")}catch{}!g&&o.Image&&(new Image().src=p.A,g=!0),g||(p.g=mv(p.j,null),p.g.ea(p.A)),p.F=Date.now(),Hc(p)}fv(c)}function Qc(c){c.g&&(Af(c),c.g.cancel(),c.g=null)}function ov(c){Qc(c),c.v&&(o.clearTimeout(c.v),c.v=null),Xc(c),c.h.cancel(),c.m&&(typeof c.m=="number"&&o.clearTimeout(c.m),c.m=null)}function Yc(c){if(!B_(c.h)&&!c.m){c.m=!0;var p=c.Ea;V||_(),M||(V(),M=!0),x.add(p,c),c.D=0}}function aR(c,p){return z_(c.h)>=c.h.j-(c.m?1:0)?!1:c.m?(c.i=p.G.concat(c.i),!0):c.I==1||c.I==2||c.D>=(c.Sa?0:c.Ta)?!1:(c.m=pr(d(c.Ea,c,p),hv(c,c.D)),c.D++,!0)}t.Ea=function(c){if(this.m)if(this.m=null,this.I==1){if(!c){this.V=Math.floor(Math.random()*1e5),c=this.V++;const L=new is(this,this.j,c);let $=this.o;if(this.U&&($?($=Ve($),z($,this.U)):$=this.U),this.u!==null||this.R||(L.J=$,$=null),this.S)e:{for(var p=0,g=0;g<this.i.length;g++){t:{var I=this.i[g];if("__data__"in I.map&&(I=I.map.__data__,typeof I=="string")){I=I.length;break t}I=void 0}if(I===void 0)break;if(p+=I,p>4096){p=g;break e}if(p===4096||g===this.i.length-1){p=g+1;break e}}p=1e3}else p=1e3;p=lv(this,L,p),g=gr(this.J),ot(g,"RID",c),ot(g,"CVER",22),this.G&&ot(g,"X-HTTP-Session-Id",this.G),Wa(this,g),$&&(this.R?p="headers="+Va(ev($))+"&"+p:this.u&&Sf(g,this.u,$)),If(this.h,L),this.Ra&&ot(g,"TYPE","init"),this.S?(ot(g,"$req",p),ot(g,"SID","null"),L.U=!0,_f(L,g,null)):_f(L,g,p),this.I=2}}else this.I==3&&(c?av(this,c):this.i.length==0||B_(this.h)||av(this))};function av(c,p){var g;p?g=p.l:g=c.V++;const I=gr(c.J);ot(I,"SID",c.M),ot(I,"RID",g),ot(I,"AID",c.K),Wa(c,I),c.u&&c.o&&Sf(I,c.u,c.o),g=new is(c,c.j,g,c.D+1),c.u===null&&(g.J=c.o),p&&(c.i=p.G.concat(c.i)),p=lv(c,g,1e3),g.H=Math.round(c.va*.5)+Math.round(c.va*.5*Math.random()),If(c.h,g),_f(g,I,p)}function Wa(c,p){c.H&&ce(c.H,function(g,I){ot(p,I,g)}),c.l&&ce({},function(g,I){ot(p,I,g)})}function lv(c,p,g){g=Math.min(c.i.length,g);const I=c.l?d(c.l.Ka,c.l,c):null;e:{var L=c.i;let be=-1;for(;;){const kt=["count="+g];be==-1?g>0?(be=L[0].g,kt.push("ofs="+be)):be=0:kt.push("ofs="+be);let et=!0;for(let Mt=0;Mt<g;Mt++){var $=L[Mt].g;const yr=L[Mt].map;if($-=be,$<0)be=Math.max(0,L[Mt].g-100),et=!1;else try{$="req"+$+"_"||"";try{var J=yr instanceof Map?yr:Object.entries(yr);for(const[ci,cs]of J){let us=cs;a(cs)&&(us=qe(cs)),kt.push($+ci+"="+encodeURIComponent(us))}}catch(ci){throw kt.push($+"type="+encodeURIComponent("_badmap")),ci}}catch{I&&I(yr)}}if(et){J=kt.join("&");break e}}J=void 0}return c=c.i.splice(0,g),p.G=c,J}function cv(c){if(!c.g&&!c.v){c.Y=1;var p=c.Da;V||_(),M||(V(),M=!0),x.add(p,c),c.A=0}}function Cf(c){return c.g||c.v||c.A>=3?!1:(c.Y++,c.v=pr(d(c.Da,c),hv(c,c.A)),c.A++,!0)}t.Da=function(){if(this.v=null,uv(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var c=4*this.T;this.j.info("BP detection timer enabled: "+c),this.B=pr(d(this.Wa,this),c)}},t.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,Pe(10),Qc(this),uv(this))};function Af(c){c.B!=null&&(o.clearTimeout(c.B),c.B=null)}function uv(c){c.g=new is(c,c.j,"rpc",c.Y),c.u===null&&(c.g.J=c.o),c.g.P=0;var p=gr(c.na);ot(p,"RID","rpc"),ot(p,"SID",c.M),ot(p,"AID",c.K),ot(p,"CI",c.F?"0":"1"),!c.F&&c.ia&&ot(p,"TO",c.ia),ot(p,"TYPE","xmlhttp"),Wa(c,p),c.u&&c.o&&Sf(p,c.u,c.o),c.O&&(c.g.H=c.O);var g=c.g;c=c.ba,g.M=1,g.A=Wc(gr(p)),g.u=null,g.R=!0,M_(g,c)}t.Va=function(){this.C!=null&&(this.C=null,Qc(this),Cf(this),Pe(19))};function Xc(c){c.C!=null&&(o.clearTimeout(c.C),c.C=null)}function dv(c,p){var g=null;if(c.g==p){Xc(c),Af(c),c.g=null;var I=2}else if(Ef(c.h,p))g=p.G,q_(c.h,p),I=1;else return;if(c.I!=0){if(p.o)if(I==1){g=p.u?p.u.length:0,p=Date.now()-p.F;var L=c.D;I=Nt(),Q(I,new ss(I,g)),Yc(c)}else cv(c);else if(L=p.m,L==3||L==0&&p.X>0||!(I==1&&aR(c,p)||I==2&&Cf(c)))switch(g&&g.length>0&&(p=c.h,p.i=p.i.concat(g)),L){case 1:li(c,5);break;case 4:li(c,10);break;case 3:li(c,6);break;default:li(c,2)}}}function hv(c,p){let g=c.Qa+Math.floor(Math.random()*c.Za);return c.isActive()||(g*=2),g*p}function li(c,p){if(c.j.info("Error code "+p),p==2){var g=d(c.bb,c),I=c.Ua;const L=!I;I=new os(I||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||Ma(I,"https"),Wc(I),L?tR(I.toString(),g):nR(I.toString(),g)}else Pe(2);c.I=0,c.l&&c.l.pa(p),fv(c),ov(c)}t.bb=function(c){c?(this.j.info("Successfully pinged google.com"),Pe(2)):(this.j.info("Failed to ping google.com"),Pe(1))};function fv(c){if(c.I=0,c.ja=[],c.l){const p=H_(c.h);(p.length!=0||c.i.length!=0)&&(R(c.ja,p),R(c.ja,c.i),c.h.i.length=0,w(c.i),c.i.length=0),c.l.oa()}}function pv(c,p,g){var I=g instanceof os?gr(g):new os(g);if(I.g!="")p&&(I.g=p+"."+I.g),Fa(I,I.u);else{var L=o.location;I=L.protocol,p=p?p+"."+L.hostname:L.hostname,L=+L.port;const $=new os(null);I&&Ma($,I),p&&($.g=p),L&&Fa($,L),g&&($.h=g),I=$}return g=c.G,p=c.wa,g&&p&&ot(I,g,p),ot(I,"VER",c.ka),Wa(c,I),I}function mv(c,p,g){if(p&&!c.L)throw Error("Can't create secondary domain capable XhrIo object.");return p=c.Aa&&!c.ma?new vt(new xf({ab:g})):new vt(c.ma),p.Fa(c.L),p}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function gv(){}t=gv.prototype,t.ra=function(){},t.qa=function(){},t.pa=function(){},t.oa=function(){},t.isActive=function(){return!0},t.Ka=function(){};function Jc(){}Jc.prototype.g=function(c,p){return new Cn(c,p)};function Cn(c,p){H.call(this),this.g=new iv(p),this.l=c,this.h=p&&p.messageUrlParams||null,c=p&&p.messageHeaders||null,p&&p.clientProtocolHeaderRequired&&(c?c["X-Client-Protocol"]="webchannel":c={"X-Client-Protocol":"webchannel"}),this.g.o=c,c=p&&p.initMessageHeaders||null,p&&p.messageContentType&&(c?c["X-WebChannel-Content-Type"]=p.messageContentType:c={"X-WebChannel-Content-Type":p.messageContentType}),p&&p.sa&&(c?c["X-WebChannel-Client-Profile"]=p.sa:c={"X-WebChannel-Client-Profile":p.sa}),this.g.U=c,(c=p&&p.Qb)&&!P(c)&&(this.g.u=c),this.A=p&&p.supportsCrossDomainXhr||!1,this.v=p&&p.sendRawJson||!1,(p=p&&p.httpSessionIdParam)&&!P(p)&&(this.g.G=p,c=this.h,c!==null&&p in c&&(c=this.h,p in c&&delete c[p])),this.j=new co(this)}f(Cn,H),Cn.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},Cn.prototype.close=function(){bf(this.g)},Cn.prototype.o=function(c){var p=this.g;if(typeof c=="string"){var g={};g.__data__=c,c=g}else this.v&&(g={},g.__data__=qe(c),c=g);p.i.push(new KA(p.Ya++,c)),p.I==3&&Yc(p)},Cn.prototype.N=function(){this.g.l=null,delete this.j,bf(this.g),delete this.g,Cn.Z.N.call(this)};function yv(c){ge.call(this),c.__headers__&&(this.headers=c.__headers__,this.statusCode=c.__status__,delete c.__headers__,delete c.__status__);var p=c.__sm__;if(p){e:{for(const g in p){c=g;break e}c=void 0}(this.i=c)&&(c=this.i,p=p!==null&&c in p?p[c]:void 0),this.data=p}else this.data=c}f(yv,ge);function _v(){Re.call(this),this.status=1}f(_v,Re);function co(c){this.g=c}f(co,gv),co.prototype.ra=function(){Q(this.g,"a")},co.prototype.qa=function(c){Q(this.g,new yv(c))},co.prototype.pa=function(c){Q(this.g,new _v)},co.prototype.oa=function(){Q(this.g,"b")},Jc.prototype.createWebChannel=Jc.prototype.g,Cn.prototype.send=Cn.prototype.o,Cn.prototype.open=Cn.prototype.m,Cn.prototype.close=Cn.prototype.close,WS=function(){return new Jc},HS=function(){return Nt()},qS=Me,jm={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},qc.NO_ERROR=0,qc.TIMEOUT=8,qc.HTTP_ERROR=6,Qu=qc,j_.COMPLETE="complete",zS=j_,U.EventType=re,re.OPEN="a",re.CLOSE="b",re.ERROR="c",re.MESSAGE="d",H.prototype.listen=H.prototype.J,ml=U,vt.prototype.listenOnce=vt.prototype.K,vt.prototype.getLastError=vt.prototype.Ha,vt.prototype.getLastErrorCode=vt.prototype.ya,vt.prototype.getStatus=vt.prototype.ca,vt.prototype.getResponseJson=vt.prototype.La,vt.prototype.getResponseText=vt.prototype.la,vt.prototype.send=vt.prototype.ea,vt.prototype.setWithCredentials=vt.prototype.Fa,BS=vt}).apply(typeof vu<"u"?vu:typeof self<"u"?self:typeof window<"u"?window:{});const fE="@firebase/firestore",pE="4.9.2";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qt{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}qt.UNAUTHENTICATED=new qt(null),qt.GOOGLE_CREDENTIALS=new qt("google-credentials-uid"),qt.FIRST_PARTY=new qt("first-party-uid"),qt.MOCK_USER=new qt("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Na="12.3.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $i=new Rh("@firebase/firestore");function So(){return $i.logLevel}function W(t,...e){if($i.logLevel<=je.DEBUG){const n=e.map(Ty);$i.debug(`Firestore (${Na}): ${t}`,...n)}}function dn(t,...e){if($i.logLevel<=je.ERROR){const n=e.map(Ty);$i.error(`Firestore (${Na}): ${t}`,...n)}}function Bi(t,...e){if($i.logLevel<=je.WARN){const n=e.map(Ty);$i.warn(`Firestore (${Na}): ${t}`,...n)}}function Ty(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oe(t,e,n){let r="Unexpected state";typeof e=="string"?r=e:n=e,KS(t,r,n)}function KS(t,e,n){let r=`FIRESTORE (${Na}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(n!==void 0)try{r+=" CONTEXT: "+JSON.stringify(n)}catch{r+=" CONTEXT: "+n}throw dn(r),new Error(r)}function le(t,e,n,r){let s="Unexpected state";typeof n=="string"?s=n:r=n,t||KS(e,s,r)}function ve(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const B={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class G extends Xn{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ar{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GS{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class Y2{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(qt.UNAUTHENTICATED))}shutdown(){}}class X2{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class J2{constructor(e){this.t=e,this.currentUser=qt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){le(this.o===void 0,42304);let r=this.i;const s=l=>this.i!==r?(r=this.i,n(l)):Promise.resolve();let i=new ar;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new ar,e.enqueueRetryable(()=>s(this.currentUser))};const o=()=>{const l=i;e.enqueueRetryable(async()=>{await l.promise,await s(this.currentUser)})},a=l=>{W("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(l=>a(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?a(l):(W("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new ar)}},0),o()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(W("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(le(typeof r.accessToken=="string",31837,{l:r}),new GS(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return le(e===null||typeof e=="string",2055,{h:e}),new qt(e)}}class Z2{constructor(e,n,r){this.P=e,this.T=n,this.I=r,this.type="FirstParty",this.user=qt.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class eO{constructor(e,n,r){this.P=e,this.T=n,this.I=r}getToken(){return Promise.resolve(new Z2(this.P,this.T,this.I))}start(e,n){e.enqueueRetryable(()=>n(qt.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class mE{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class tO{constructor(e,n){this.V=n,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,$n(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,n){le(this.o===void 0,3512);const r=i=>{i.error!=null&&W("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.m;return this.m=i.token,W("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>r(i))};const s=i=>{W("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(i=>s(i)),setTimeout(()=>{if(!this.appCheck){const i=this.V.getImmediate({optional:!0});i?s(i):W("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new mE(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(le(typeof n.token=="string",44558,{tokenResult:n}),this.m=n.token,new mE(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nO(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xy{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const s=nO(40);for(let i=0;i<s.length;++i)r.length<20&&s[i]<n&&(r+=e.charAt(s[i]%62))}return r}}function Ie(t,e){return t<e?-1:t>e?1:0}function Om(t,e){const n=Math.min(t.length,e.length);for(let r=0;r<n;r++){const s=t.charAt(r),i=e.charAt(r);if(s!==i)return dp(s)===dp(i)?Ie(s,i):dp(s)?1:-1}return Ie(t.length,e.length)}const rO=55296,sO=57343;function dp(t){const e=t.charCodeAt(0);return e>=rO&&e<=sO}function ua(t,e,n){return t.length===e.length&&t.every((r,s)=>n(r,e[s]))}function QS(t){return t+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gE="__name__";class Ir{constructor(e,n,r){n===void 0?n=0:n>e.length&&oe(637,{offset:n,range:e.length}),r===void 0?r=e.length-n:r>e.length-n&&oe(1746,{length:r,range:e.length-n}),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return Ir.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof Ir?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let s=0;s<r;s++){const i=Ir.compareSegments(e.get(s),n.get(s));if(i!==0)return i}return Ie(e.length,n.length)}static compareSegments(e,n){const r=Ir.isNumericId(e),s=Ir.isNumericId(n);return r&&!s?-1:!r&&s?1:r&&s?Ir.extractNumericId(e).compare(Ir.extractNumericId(n)):Om(e,n)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return $s.fromString(e.substring(4,e.length-2))}}class He extends Ir{construct(e,n,r){return new He(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new G(B.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(s=>s.length>0))}return new He(n)}static emptyPath(){return new He([])}}const iO=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class gt extends Ir{construct(e,n,r){return new gt(e,n,r)}static isValidIdentifier(e){return iO.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),gt.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===gE}static keyField(){return new gt([gE])}static fromServerFormat(e){const n=[];let r="",s=0;const i=()=>{if(r.length===0)throw new G(B.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let o=!1;for(;s<e.length;){const a=e[s];if(a==="\\"){if(s+1===e.length)throw new G(B.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[s+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new G(B.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=l,s+=2}else a==="`"?(o=!o,s++):a!=="."||o?(r+=a,s++):(i(),s++)}if(i(),o)throw new G(B.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new gt(n)}static emptyPath(){return new gt([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ee{constructor(e){this.path=e}static fromPath(e){return new ee(He.fromString(e))}static fromName(e){return new ee(He.fromString(e).popFirst(5))}static empty(){return new ee(He.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&He.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return He.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new ee(new He(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function YS(t,e,n){if(!n)throw new G(B.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function oO(t,e,n,r){if(e===!0&&r===!0)throw new G(B.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function yE(t){if(!ee.isDocumentKey(t))throw new G(B.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function _E(t){if(ee.isDocumentKey(t))throw new G(B.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function XS(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function Oh(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":oe(12329,{type:typeof t})}function on(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new G(B.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Oh(t);throw new G(B.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}function aO(t,e){if(e<=0)throw new G(B.INVALID_ARGUMENT,`Function ${t}() requires a positive number, but it was: ${e}.`)}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rt(t,e){const n={typeString:t};return e&&(n.value=e),n}function Nc(t,e){if(!XS(t))throw new G(B.INVALID_ARGUMENT,"JSON must be an object");let n;for(const r in e)if(e[r]){const s=e[r].typeString,i="value"in e[r]?{value:e[r].value}:void 0;if(!(r in t)){n=`JSON missing required field: '${r}'`;break}const o=t[r];if(s&&typeof o!==s){n=`JSON field '${r}' must be a ${s}.`;break}if(i!==void 0&&o!==i.value){n=`Expected '${r}' field to equal '${i.value}'`;break}}if(n)throw new G(B.INVALID_ARGUMENT,n);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vE=-62135596800,wE=1e6;class $e{static now(){return $e.fromMillis(Date.now())}static fromDate(e){return $e.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor((e-1e3*n)*wE);return new $e(n,r)}constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new G(B.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new G(B.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<vE)throw new G(B.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new G(B.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/wE}_compareTo(e){return this.seconds===e.seconds?Ie(this.nanoseconds,e.nanoseconds):Ie(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:$e._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Nc(e,$e._jsonSchema))return new $e(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-vE;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}$e._jsonSchemaVersion="firestore/timestamp/1.0",$e._jsonSchema={type:Rt("string",$e._jsonSchemaVersion),seconds:Rt("number"),nanoseconds:Rt("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fe{static fromTimestamp(e){return new fe(e)}static min(){return new fe(new $e(0,0))}static max(){return new fe(new $e(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lc=-1;class $d{constructor(e,n,r,s){this.indexId=e,this.collectionGroup=n,this.fields=r,this.indexState=s}}function Vm(t){return t.fields.find(e=>e.kind===2)}function mi(t){return t.fields.filter(e=>e.kind!==2)}$d.UNKNOWN_ID=-1;class Yu{constructor(e,n){this.fieldPath=e,this.kind=n}}class cc{constructor(e,n){this.sequenceNumber=e,this.offset=n}static empty(){return new cc(0,On.min())}}function lO(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,s=fe.fromTimestamp(r===1e9?new $e(n+1,0):new $e(n,r));return new On(s,ee.empty(),e)}function JS(t){return new On(t.readTime,t.key,lc)}class On{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new On(fe.min(),ee.empty(),lc)}static max(){return new On(fe.max(),ee.empty(),lc)}}function Sy(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=ee.comparator(t.documentKey,e.documentKey),n!==0?n:Ie(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZS="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class eb{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function io(t){if(t.code!==B.FAILED_PRECONDITION||t.message!==ZS)throw t;W("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&oe(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new O((r,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(r,s)},this.catchCallback=i=>{this.wrapFailure(n,i).next(r,s)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof O?n:O.resolve(n)}catch(n){return O.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):O.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):O.reject(n)}static resolve(e){return new O((n,r)=>{n(e)})}static reject(e){return new O((n,r)=>{r(e)})}static waitFor(e){return new O((n,r)=>{let s=0,i=0,o=!1;e.forEach(a=>{++s,a.next(()=>{++i,o&&i===s&&n()},l=>r(l))}),o=!0,i===s&&n()})}static or(e){let n=O.resolve(!1);for(const r of e)n=n.next(s=>s?O.resolve(s):r());return n}static forEach(e,n){const r=[];return e.forEach((s,i)=>{r.push(n.call(this,s,i))}),this.waitFor(r)}static mapArray(e,n){return new O((r,s)=>{const i=e.length,o=new Array(i);let a=0;for(let l=0;l<i;l++){const d=l;n(e[d]).next(h=>{o[d]=h,++a,a===i&&r(o)},h=>s(h))}})}static doWhile(e,n){return new O((r,s)=>{const i=()=>{e()===!0?n().next(()=>{i()},s):r()};i()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rn="SimpleDb";class Vh{static open(e,n,r,s){try{return new Vh(n,e.transaction(s,r))}catch(i){throw new Dl(n,i)}}constructor(e,n){this.action=e,this.transaction=n,this.aborted=!1,this.S=new ar,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{n.error?this.S.reject(new Dl(e,n.error)):this.S.resolve()},this.transaction.onerror=r=>{const s=by(r.target.error);this.S.reject(new Dl(e,s))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(W(Rn,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}C(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const n=this.transaction.objectStore(e);return new uO(n)}}class Bs{static delete(e){return W(Rn,"Removing database:",e),yi(qx().indexedDB.deleteDatabase(e)).toPromise()}static v(){if(!dy())return!1;if(Bs.F())return!0;const e=Ot(),n=Bs.M(e),r=0<n&&n<10,s=tb(e),i=0<s&&s<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||i)}static F(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)==null?void 0:e.__PRIVATE_USE_MOCK_PERSISTENCE)==="YES"}static O(e,n){return e.store(n)}static M(e){const n=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=n?n[1].split("_").slice(0,2).join("."):"-1";return Number(r)}constructor(e,n,r){this.name=e,this.version=n,this.N=r,this.B=null,Bs.M(Ot())===12.2&&dn("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async L(e){return this.db||(W(Rn,"Opening database:",this.name),this.db=await new Promise((n,r)=>{const s=indexedDB.open(this.name,this.version);s.onsuccess=i=>{const o=i.target.result;n(o)},s.onblocked=()=>{r(new Dl(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},s.onerror=i=>{const o=i.target.error;o.name==="VersionError"?r(new G(B.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?r(new G(B.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):r(new Dl(e,o))},s.onupgradeneeded=i=>{W(Rn,'Database "'+this.name+'" requires upgrade from version:',i.oldVersion);const o=i.target.result;this.N.k(o,s.transaction,i.oldVersion,this.version).next(()=>{W(Rn,"Database upgrade to version "+this.version+" complete")})}})),this.q&&(this.db.onversionchange=n=>this.q(n)),this.db}$(e){this.q=e,this.db&&(this.db.onversionchange=n=>e(n))}async runTransaction(e,n,r,s){const i=n==="readonly";let o=0;for(;;){++o;try{this.db=await this.L(e);const a=Vh.open(this.db,e,i?"readonly":"readwrite",r),l=s(a).next(d=>(a.C(),d)).catch(d=>(a.abort(d),O.reject(d))).toPromise();return l.catch(()=>{}),await a.D,l}catch(a){const l=a,d=l.name!=="FirebaseError"&&o<3;if(W(Rn,"Transaction failed with error:",l.message,"Retrying:",d),this.close(),!d)return Promise.reject(l)}}}close(){this.db&&this.db.close(),this.db=void 0}}function tb(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}class cO{constructor(e){this.U=e,this.K=!1,this.W=null}get isDone(){return this.K}get G(){return this.W}set cursor(e){this.U=e}done(){this.K=!0}j(e){this.W=e}delete(){return yi(this.U.delete())}}class Dl extends G{constructor(e,n){super(B.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${n}`),this.name="IndexedDbTransactionError"}}function ri(t){return t.name==="IndexedDbTransactionError"}class uO{constructor(e){this.store=e}put(e,n){let r;return n!==void 0?(W(Rn,"PUT",this.store.name,e,n),r=this.store.put(n,e)):(W(Rn,"PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),yi(r)}add(e){return W(Rn,"ADD",this.store.name,e,e),yi(this.store.add(e))}get(e){return yi(this.store.get(e)).next(n=>(n===void 0&&(n=null),W(Rn,"GET",this.store.name,e,n),n))}delete(e){return W(Rn,"DELETE",this.store.name,e),yi(this.store.delete(e))}count(){return W(Rn,"COUNT",this.store.name),yi(this.store.count())}J(e,n){const r=this.options(e,n),s=r.index?this.store.index(r.index):this.store;if(typeof s.getAll=="function"){const i=s.getAll(r.range);return new O((o,a)=>{i.onerror=l=>{a(l.target.error)},i.onsuccess=l=>{o(l.target.result)}})}{const i=this.cursor(r),o=[];return this.H(i,(a,l)=>{o.push(l)}).next(()=>o)}}Y(e,n){const r=this.store.getAll(e,n===null?void 0:n);return new O((s,i)=>{r.onerror=o=>{i(o.target.error)},r.onsuccess=o=>{s(o.target.result)}})}Z(e,n){W(Rn,"DELETE ALL",this.store.name);const r=this.options(e,n);r.X=!1;const s=this.cursor(r);return this.H(s,(i,o,a)=>a.delete())}ee(e,n){let r;n?r=e:(r={},n=e);const s=this.cursor(r);return this.H(s,n)}te(e){const n=this.cursor({});return new O((r,s)=>{n.onerror=i=>{const o=by(i.target.error);s(o)},n.onsuccess=i=>{const o=i.target.result;o?e(o.primaryKey,o.value).next(a=>{a?o.continue():r()}):r()}})}H(e,n){const r=[];return new O((s,i)=>{e.onerror=o=>{i(o.target.error)},e.onsuccess=o=>{const a=o.target.result;if(!a)return void s();const l=new cO(a),d=n(a.primaryKey,a.value,l);if(d instanceof O){const h=d.catch(f=>(l.done(),O.reject(f)));r.push(h)}l.isDone?s():l.G===null?a.continue():a.continue(l.G)}}).next(()=>O.waitFor(r))}options(e,n){let r;return e!==void 0&&(typeof e=="string"?r=e:n=e),{index:r,range:n}}cursor(e){let n="next";if(e.reverse&&(n="prev"),e.index){const r=this.store.index(e.index);return e.X?r.openKeyCursor(e.range,n):r.openCursor(e.range,n)}return this.store.openCursor(e.range,n)}}function yi(t){return new O((e,n)=>{t.onsuccess=r=>{const s=r.target.result;e(s)},t.onerror=r=>{const s=by(r.target.error);n(s)}})}let EE=!1;function by(t){const e=Bs.M(Ot());if(e>=12.2&&e<13){const n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){const r=new G("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${n}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return EE||(EE=!0,setTimeout(()=>{throw r},0)),r}}return t}const jl="IndexBackfiller";class dO{constructor(e,n){this.asyncQueue=e,this.ne=n,this.task=null}start(){this.re(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}re(e){W(jl,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{const n=await this.ne.ie();W(jl,`Documents written: ${n}`)}catch(n){ri(n)?W(jl,"Ignoring IndexedDB error during index backfill: ",n):await io(n)}await this.re(6e4)})}}class hO{constructor(e,n){this.localStore=e,this.persistence=n}async ie(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",n=>this.se(n,e))}se(e,n){const r=new Set;let s=n,i=!0;return O.doWhile(()=>i===!0&&s>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(o!==null&&!r.has(o))return W(jl,`Processing collection: ${o}`),this.oe(e,o,s).next(a=>{s-=a,r.add(o)});i=!1})).next(()=>n-s)}oe(e,n,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,n).next(s=>this.localStore.localDocuments.getNextDocuments(e,n,s,r).next(i=>{const o=i.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this._e(s,i)).next(a=>(W(jl,`Updating offset: ${a}`),this.localStore.indexManager.updateCollectionGroup(e,n,a))).next(()=>o.size)}))}_e(e,n){let r=e;return n.changes.forEach((s,i)=>{const o=JS(i);Sy(o,r)>0&&(r=o)}),new On(r.readTime,r.documentKey,Math.max(n.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qn{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ae(r),this.ue=r=>n.writeSequenceNumber(r))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}qn.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ri=-1;function Lh(t){return t==null}function uc(t){return t===0&&1/t==-1/0}function fO(t){return typeof t=="number"&&Number.isInteger(t)&&!uc(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bd="";function an(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=IE(e)),e=pO(t.get(n),e);return IE(e)}function pO(t,e){let n=e;const r=t.length;for(let s=0;s<r;s++){const i=t.charAt(s);switch(i){case"\0":n+="";break;case Bd:n+="";break;default:n+=i}}return n}function IE(t){return t+Bd+""}function xr(t){const e=t.length;if(le(e>=2,64408,{path:t}),e===2)return le(t.charAt(0)===Bd&&t.charAt(1)==="",56145,{path:t}),He.emptyPath();const n=e-2,r=[];let s="";for(let i=0;i<e;){const o=t.indexOf(Bd,i);switch((o<0||o>n)&&oe(50515,{path:t}),t.charAt(o+1)){case"":const a=t.substring(i,o);let l;s.length===0?l=a:(s+=a,l=s,s=""),r.push(l);break;case"":s+=t.substring(i,o),s+="\0";break;case"":s+=t.substring(i,o+1);break;default:oe(61167,{path:t})}i=o+2}return new He(r)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gi="remoteDocuments",kc="owner",ho="owner",dc="mutationQueues",mO="userId",tr="mutations",TE="batchId",Si="userMutationsIndex",xE=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xu(t,e){return[t,an(e)]}function nb(t,e,n){return[t,an(e),n]}const gO={},da="documentMutations",zd="remoteDocumentsV14",yO=["prefixPath","collectionGroup","readTime","documentId"],Ju="documentKeyIndex",_O=["prefixPath","collectionGroup","documentId"],rb="collectionGroupIndex",vO=["collectionGroup","readTime","prefixPath","documentId"],hc="remoteDocumentGlobal",Lm="remoteDocumentGlobalKey",ha="targets",sb="queryTargetsIndex",wO=["canonicalId","targetId"],fa="targetDocuments",EO=["targetId","path"],Cy="documentTargetsIndex",IO=["path","targetId"],qd="targetGlobalKey",Pi="targetGlobal",fc="collectionParents",TO=["collectionId","parent"],pa="clientMetadata",xO="clientId",Mh="bundles",SO="bundleId",Fh="namedQueries",bO="name",Ay="indexConfiguration",CO="indexId",Mm="collectionGroupIndex",AO="collectionGroup",Ol="indexState",RO=["indexId","uid"],ib="sequenceNumberIndex",PO=["uid","sequenceNumber"],Vl="indexEntries",NO=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],ob="documentKeyIndex",kO=["indexId","uid","orderedDocumentKey"],Uh="documentOverlays",DO=["userId","collectionPath","documentId"],Fm="collectionPathOverlayIndex",jO=["userId","collectionPath","largestBatchId"],ab="collectionGroupOverlayIndex",OO=["userId","collectionGroup","largestBatchId"],Ry="globals",VO="name",lb=[dc,tr,da,gi,ha,kc,Pi,fa,pa,hc,fc,Mh,Fh],LO=[...lb,Uh],cb=[dc,tr,da,zd,ha,kc,Pi,fa,pa,hc,fc,Mh,Fh,Uh],ub=cb,Py=[...ub,Ay,Ol,Vl],MO=Py,db=[...Py,Ry],FO=db;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Um extends eb{constructor(e,n){super(),this.le=e,this.currentSequenceNumber=n}}function Vt(t,e){const n=ve(t);return Bs.O(n.le,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function SE(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function si(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function UO(t,e){const n=[];for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&n.push(e(t[r],r,t));return n}function hb(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ht{constructor(e,n){this.comparator=e,this.root=n||Ht.EMPTY}insert(e,n){return new ht(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,Ht.BLACK,null,null))}remove(e){return new ht(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Ht.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(e,r.key);if(s===0)return n+r.left.size;s<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new wu(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new wu(this.root,e,this.comparator,!1)}getReverseIterator(){return new wu(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new wu(this.root,e,this.comparator,!0)}}class wu{constructor(e,n,r,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=n?r(e.key,n):1,n&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Ht{constructor(e,n,r,s,i){this.key=e,this.value=n,this.color=r??Ht.RED,this.left=s??Ht.EMPTY,this.right=i??Ht.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,s,i){return new Ht(e??this.key,n??this.value,r??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let s=this;const i=r(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,n,r),null):i===0?s.copy(null,n,null,null,null):s.copy(null,null,null,null,s.right.insert(e,n,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return Ht.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,s=this;if(n(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,n),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),n(e,s.key)===0){if(s.right.isEmpty())return Ht.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,n))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Ht.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Ht.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw oe(43730,{key:this.key,value:this.value});if(this.right.isRed())throw oe(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw oe(27949);return e+(this.isRed()?0:1)}}Ht.EMPTY=null,Ht.RED=!0,Ht.BLACK=!1;Ht.EMPTY=new class{constructor(){this.size=0}get key(){throw oe(57766)}get value(){throw oe(16141)}get color(){throw oe(16727)}get left(){throw oe(29726)}get right(){throw oe(36894)}copy(e,n,r,s,i){return this}insert(e,n,r){return new Ht(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ze{constructor(e){this.comparator=e,this.data=new ht(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,e[1])>=0)return;n(s.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new bE(this.data.getIterator())}getIteratorFrom(e){return new bE(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof Ze)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new Ze(this.comparator);return n.data=e,n}}class bE{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function fo(t){return t.hasNext()?t.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class En{constructor(e){this.fields=e,e.sort(gt.comparator)}static empty(){return new En([])}unionWith(e){let n=new Ze(gt.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new En(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return ua(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fb extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pt{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(s){try{return atob(s)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new fb("Invalid base64 string: "+i):i}}(e);return new Pt(n)}static fromUint8Array(e){const n=function(s){let i="";for(let o=0;o<s.length;++o)i+=String.fromCharCode(s[o]);return i}(e);return new Pt(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Ie(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Pt.EMPTY_BYTE_STRING=new Pt("");const $O=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Zr(t){if(le(!!t,39018),typeof t=="string"){let e=0;const n=$O.exec(t);if(le(!!n,46558,{timestamp:t}),n[1]){let s=n[1];s=(s+"000000000").substr(0,9),e=Number(s)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:ct(t.seconds),nanos:ct(t.nanos)}}function ct(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function es(t){return typeof t=="string"?Pt.fromBase64String(t):Pt.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pb="server_timestamp",mb="__type__",gb="__previous_value__",yb="__local_write_time__";function $h(t){var n,r;return((r=(((n=t==null?void 0:t.mapValue)==null?void 0:n.fields)||{})[mb])==null?void 0:r.stringValue)===pb}function Bh(t){const e=t.mapValue.fields[gb];return $h(e)?Bh(e):e}function pc(t){const e=Zr(t.mapValue.fields[yb].timestampValue);return new $e(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BO{constructor(e,n,r,s,i,o,a,l,d,h){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=s,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=l,this.useFetchStreams=d,this.isUsingEmulator=h}}const Hd="(default)";class zi{constructor(e,n){this.projectId=e,this.database=n||Hd}static empty(){return new zi("","")}get isDefaultDatabase(){return this.database===Hd}isEqual(e){return e instanceof zi&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ny="__type__",_b="__max__",Rs={mapValue:{fields:{__type__:{stringValue:_b}}}},ky="__vector__",ma="value",Zu={nullValue:"NULL_VALUE"};function Ws(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?$h(t)?4:vb(t)?9007199254740991:zh(t)?10:11:oe(28295,{value:t})}function Dr(t,e){if(t===e)return!0;const n=Ws(t);if(n!==Ws(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return pc(t).isEqual(pc(e));case 3:return function(s,i){if(typeof s.timestampValue=="string"&&typeof i.timestampValue=="string"&&s.timestampValue.length===i.timestampValue.length)return s.timestampValue===i.timestampValue;const o=Zr(s.timestampValue),a=Zr(i.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(s,i){return es(s.bytesValue).isEqual(es(i.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(s,i){return ct(s.geoPointValue.latitude)===ct(i.geoPointValue.latitude)&&ct(s.geoPointValue.longitude)===ct(i.geoPointValue.longitude)}(t,e);case 2:return function(s,i){if("integerValue"in s&&"integerValue"in i)return ct(s.integerValue)===ct(i.integerValue);if("doubleValue"in s&&"doubleValue"in i){const o=ct(s.doubleValue),a=ct(i.doubleValue);return o===a?uc(o)===uc(a):isNaN(o)&&isNaN(a)}return!1}(t,e);case 9:return ua(t.arrayValue.values||[],e.arrayValue.values||[],Dr);case 10:case 11:return function(s,i){const o=s.mapValue.fields||{},a=i.mapValue.fields||{};if(SE(o)!==SE(a))return!1;for(const l in o)if(o.hasOwnProperty(l)&&(a[l]===void 0||!Dr(o[l],a[l])))return!1;return!0}(t,e);default:return oe(52216,{left:t})}}function mc(t,e){return(t.values||[]).find(n=>Dr(n,e))!==void 0}function Ks(t,e){if(t===e)return 0;const n=Ws(t),r=Ws(e);if(n!==r)return Ie(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return Ie(t.booleanValue,e.booleanValue);case 2:return function(i,o){const a=ct(i.integerValue||i.doubleValue),l=ct(o.integerValue||o.doubleValue);return a<l?-1:a>l?1:a===l?0:isNaN(a)?isNaN(l)?0:-1:1}(t,e);case 3:return CE(t.timestampValue,e.timestampValue);case 4:return CE(pc(t),pc(e));case 5:return Om(t.stringValue,e.stringValue);case 6:return function(i,o){const a=es(i),l=es(o);return a.compareTo(l)}(t.bytesValue,e.bytesValue);case 7:return function(i,o){const a=i.split("/"),l=o.split("/");for(let d=0;d<a.length&&d<l.length;d++){const h=Ie(a[d],l[d]);if(h!==0)return h}return Ie(a.length,l.length)}(t.referenceValue,e.referenceValue);case 8:return function(i,o){const a=Ie(ct(i.latitude),ct(o.latitude));return a!==0?a:Ie(ct(i.longitude),ct(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return AE(t.arrayValue,e.arrayValue);case 10:return function(i,o){var m,w,R,b;const a=i.fields||{},l=o.fields||{},d=(m=a[ma])==null?void 0:m.arrayValue,h=(w=l[ma])==null?void 0:w.arrayValue,f=Ie(((R=d==null?void 0:d.values)==null?void 0:R.length)||0,((b=h==null?void 0:h.values)==null?void 0:b.length)||0);return f!==0?f:AE(d,h)}(t.mapValue,e.mapValue);case 11:return function(i,o){if(i===Rs.mapValue&&o===Rs.mapValue)return 0;if(i===Rs.mapValue)return 1;if(o===Rs.mapValue)return-1;const a=i.fields||{},l=Object.keys(a),d=o.fields||{},h=Object.keys(d);l.sort(),h.sort();for(let f=0;f<l.length&&f<h.length;++f){const m=Om(l[f],h[f]);if(m!==0)return m;const w=Ks(a[l[f]],d[h[f]]);if(w!==0)return w}return Ie(l.length,h.length)}(t.mapValue,e.mapValue);default:throw oe(23264,{he:n})}}function CE(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return Ie(t,e);const n=Zr(t),r=Zr(e),s=Ie(n.seconds,r.seconds);return s!==0?s:Ie(n.nanos,r.nanos)}function AE(t,e){const n=t.values||[],r=e.values||[];for(let s=0;s<n.length&&s<r.length;++s){const i=Ks(n[s],r[s]);if(i)return i}return Ie(n.length,r.length)}function ga(t){return $m(t)}function $m(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=Zr(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return es(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return ee.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",s=!0;for(const i of n.values||[])s?s=!1:r+=",",r+=$m(i);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let s="{",i=!0;for(const o of r)i?i=!1:s+=",",s+=`${o}:${$m(n.fields[o])}`;return s+"}"}(t.mapValue):oe(61005,{value:t})}function ed(t){switch(Ws(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Bh(t);return e?16+ed(e):16;case 5:return 2*t.stringValue.length;case 6:return es(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return function(r){return(r.values||[]).reduce((s,i)=>s+ed(i),0)}(t.arrayValue);case 10:case 11:return function(r){let s=0;return si(r.fields,(i,o)=>{s+=i.length+ed(o)}),s}(t.mapValue);default:throw oe(13486,{value:t})}}function qi(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function Bm(t){return!!t&&"integerValue"in t}function gc(t){return!!t&&"arrayValue"in t}function RE(t){return!!t&&"nullValue"in t}function PE(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function td(t){return!!t&&"mapValue"in t}function zh(t){var n,r;return((r=(((n=t==null?void 0:t.mapValue)==null?void 0:n.fields)||{})[Ny])==null?void 0:r.stringValue)===ky}function Ll(t){if(t.geoPointValue)return{geoPointValue:{...t.geoPointValue}};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:{...t.timestampValue}};if(t.mapValue){const e={mapValue:{fields:{}}};return si(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=Ll(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=Ll(t.arrayValue.values[n]);return e}return{...t}}function vb(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===_b}const wb={mapValue:{fields:{[Ny]:{stringValue:ky},[ma]:{arrayValue:{}}}}};function zO(t){return"nullValue"in t?Zu:"booleanValue"in t?{booleanValue:!1}:"integerValue"in t||"doubleValue"in t?{doubleValue:NaN}:"timestampValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in t?{stringValue:""}:"bytesValue"in t?{bytesValue:""}:"referenceValue"in t?qi(zi.empty(),ee.empty()):"geoPointValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in t?{arrayValue:{}}:"mapValue"in t?zh(t)?wb:{mapValue:{}}:oe(35942,{value:t})}function qO(t){return"nullValue"in t?{booleanValue:!1}:"booleanValue"in t?{doubleValue:NaN}:"integerValue"in t||"doubleValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in t?{stringValue:""}:"stringValue"in t?{bytesValue:""}:"bytesValue"in t?qi(zi.empty(),ee.empty()):"referenceValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in t?{arrayValue:{}}:"arrayValue"in t?wb:"mapValue"in t?zh(t)?{mapValue:{}}:Rs:oe(61959,{value:t})}function NE(t,e){const n=Ks(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?-1:!t.inclusive&&e.inclusive?1:0}function kE(t,e){const n=Ks(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?1:!t.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rn{constructor(e){this.value=e}static empty(){return new rn({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!td(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=Ll(n)}setAll(e){let n=gt.emptyPath(),r={},s=[];e.forEach((o,a)=>{if(!n.isImmediateParentOf(a)){const l=this.getFieldsMap(n);this.applyChanges(l,r,s),r={},s=[],n=a.popLast()}o?r[a.lastSegment()]=Ll(o):s.push(a.lastSegment())});const i=this.getFieldsMap(n);this.applyChanges(i,r,s)}delete(e){const n=this.field(e.popLast());td(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return Dr(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let s=n.mapValue.fields[e.get(r)];td(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=s),n=s}return n.mapValue.fields}applyChanges(e,n,r){si(n,(s,i)=>e[s]=i);for(const s of r)delete e[s]}clone(){return new rn(Ll(this.value))}}function Eb(t){const e=[];return si(t.fields,(n,r)=>{const s=new gt([n]);if(td(r)){const i=Eb(r.mapValue).fields;if(i.length===0)e.push(s);else for(const o of i)e.push(s.child(o))}else e.push(s)}),new En(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Et{constructor(e,n,r,s,i,o,a){this.key=e,this.documentType=n,this.version=r,this.readTime=s,this.createTime=i,this.data=o,this.documentState=a}static newInvalidDocument(e){return new Et(e,0,fe.min(),fe.min(),fe.min(),rn.empty(),0)}static newFoundDocument(e,n,r,s){return new Et(e,1,n,fe.min(),r,s,0)}static newNoDocument(e,n){return new Et(e,2,n,fe.min(),fe.min(),rn.empty(),0)}static newUnknownDocument(e,n){return new Et(e,3,n,fe.min(),fe.min(),rn.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(fe.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=rn.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=rn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=fe.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Et&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Et(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gs{constructor(e,n){this.position=e,this.inclusive=n}}function DE(t,e,n){let r=0;for(let s=0;s<t.position.length;s++){const i=e[s],o=t.position[s];if(i.field.isKeyField()?r=ee.comparator(ee.fromName(o.referenceValue),n.key):r=Ks(o,n.data.field(i.field)),i.dir==="desc"&&(r*=-1),r!==0)break}return r}function jE(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!Dr(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yc{constructor(e,n="asc"){this.field=e,this.dir=n}}function HO(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ib{}class Oe extends Ib{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new WO(e,n,r):n==="array-contains"?new QO(e,r):n==="in"?new Ab(e,r):n==="not-in"?new YO(e,r):n==="array-contains-any"?new XO(e,r):new Oe(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new KO(e,r):new GO(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&n.nullValue===void 0&&this.matchesComparison(Ks(n,this.value)):n!==null&&Ws(this.value)===Ws(n)&&this.matchesComparison(Ks(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return oe(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Xe extends Ib{constructor(e,n){super(),this.filters=e,this.op=n,this.Pe=null}static create(e,n){return new Xe(e,n)}matches(e){return ya(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function ya(t){return t.op==="and"}function zm(t){return t.op==="or"}function Dy(t){return Tb(t)&&ya(t)}function Tb(t){for(const e of t.filters)if(e instanceof Xe)return!1;return!0}function qm(t){if(t instanceof Oe)return t.field.canonicalString()+t.op.toString()+ga(t.value);if(Dy(t))return t.filters.map(e=>qm(e)).join(",");{const e=t.filters.map(n=>qm(n)).join(",");return`${t.op}(${e})`}}function xb(t,e){return t instanceof Oe?function(r,s){return s instanceof Oe&&r.op===s.op&&r.field.isEqual(s.field)&&Dr(r.value,s.value)}(t,e):t instanceof Xe?function(r,s){return s instanceof Xe&&r.op===s.op&&r.filters.length===s.filters.length?r.filters.reduce((i,o,a)=>i&&xb(o,s.filters[a]),!0):!1}(t,e):void oe(19439)}function Sb(t,e){const n=t.filters.concat(e);return Xe.create(n,t.op)}function bb(t){return t instanceof Oe?function(n){return`${n.field.canonicalString()} ${n.op} ${ga(n.value)}`}(t):t instanceof Xe?function(n){return n.op.toString()+" {"+n.getFilters().map(bb).join(" ,")+"}"}(t):"Filter"}class WO extends Oe{constructor(e,n,r){super(e,n,r),this.key=ee.fromName(r.referenceValue)}matches(e){const n=ee.comparator(e.key,this.key);return this.matchesComparison(n)}}class KO extends Oe{constructor(e,n){super(e,"in",n),this.keys=Cb("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class GO extends Oe{constructor(e,n){super(e,"not-in",n),this.keys=Cb("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function Cb(t,e){var n;return(((n=e.arrayValue)==null?void 0:n.values)||[]).map(r=>ee.fromName(r.referenceValue))}class QO extends Oe{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return gc(n)&&mc(n.arrayValue,this.value)}}class Ab extends Oe{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&mc(this.value.arrayValue,n)}}class YO extends Oe{constructor(e,n){super(e,"not-in",n)}matches(e){if(mc(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&n.nullValue===void 0&&!mc(this.value.arrayValue,n)}}class XO extends Oe{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!gc(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>mc(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JO{constructor(e,n=null,r=[],s=[],i=null,o=null,a=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=s,this.limit=i,this.startAt=o,this.endAt=a,this.Te=null}}function Hm(t,e=null,n=[],r=[],s=null,i=null,o=null){return new JO(t,e,n,r,s,i,o)}function Hi(t){const e=ve(t);if(e.Te===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>qm(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(i){return i.field.canonicalString()+i.dir}(r)).join(","),Lh(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>ga(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>ga(r)).join(",")),e.Te=n}return e.Te}function Dc(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!HO(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!xb(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!jE(t.startAt,e.startAt)&&jE(t.endAt,e.endAt)}function Wd(t){return ee.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}function Kd(t,e){return t.filters.filter(n=>n instanceof Oe&&n.field.isEqual(e))}function OE(t,e,n){let r=Zu,s=!0;for(const i of Kd(t,e)){let o=Zu,a=!0;switch(i.op){case"<":case"<=":o=zO(i.value);break;case"==":case"in":case">=":o=i.value;break;case">":o=i.value,a=!1;break;case"!=":case"not-in":o=Zu}NE({value:r,inclusive:s},{value:o,inclusive:a})<0&&(r=o,s=a)}if(n!==null){for(let i=0;i<t.orderBy.length;++i)if(t.orderBy[i].field.isEqual(e)){const o=n.position[i];NE({value:r,inclusive:s},{value:o,inclusive:n.inclusive})<0&&(r=o,s=n.inclusive);break}}return{value:r,inclusive:s}}function VE(t,e,n){let r=Rs,s=!0;for(const i of Kd(t,e)){let o=Rs,a=!0;switch(i.op){case">=":case">":o=qO(i.value),a=!1;break;case"==":case"in":case"<=":o=i.value;break;case"<":o=i.value,a=!1;break;case"!=":case"not-in":o=Rs}kE({value:r,inclusive:s},{value:o,inclusive:a})>0&&(r=o,s=a)}if(n!==null){for(let i=0;i<t.orderBy.length;++i)if(t.orderBy[i].field.isEqual(e)){const o=n.position[i];kE({value:r,inclusive:s},{value:o,inclusive:n.inclusive})>0&&(r=o,s=n.inclusive);break}}return{value:r,inclusive:s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ii{constructor(e,n=null,r=[],s=[],i=null,o="F",a=null,l=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=s,this.limit=i,this.limitType=o,this.startAt=a,this.endAt=l,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function ZO(t,e,n,r,s,i,o,a){return new ii(t,e,n,r,s,i,o,a)}function jc(t){return new ii(t)}function LE(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function jy(t){return t.collectionGroup!==null}function Xo(t){const e=ve(t);if(e.Ie===null){e.Ie=[];const n=new Set;for(const i of e.explicitOrderBy)e.Ie.push(i),n.add(i.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new Ze(gt.comparator);return o.filters.forEach(l=>{l.getFlattenedFilters().forEach(d=>{d.isInequality()&&(a=a.add(d.field))})}),a})(e).forEach(i=>{n.has(i.canonicalString())||i.isKeyField()||e.Ie.push(new yc(i,r))}),n.has(gt.keyField().canonicalString())||e.Ie.push(new yc(gt.keyField(),r))}return e.Ie}function Wn(t){const e=ve(t);return e.Ee||(e.Ee=Rb(e,Xo(t))),e.Ee}function eV(t){const e=ve(t);return e.de||(e.de=Rb(e,t.explicitOrderBy)),e.de}function Rb(t,e){if(t.limitType==="F")return Hm(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(s=>{const i=s.dir==="desc"?"asc":"desc";return new yc(s.field,i)});const n=t.endAt?new Gs(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new Gs(t.startAt.position,t.startAt.inclusive):null;return Hm(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function Wm(t,e){const n=t.filters.concat([e]);return new ii(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function Gd(t,e,n){return new ii(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function qh(t,e){return Dc(Wn(t),Wn(e))&&t.limitType===e.limitType}function Pb(t){return`${Hi(Wn(t))}|lt:${t.limitType}`}function bo(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(s=>bb(s)).join(", ")}]`),Lh(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(s=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(s)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(s=>ga(s)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(s=>ga(s)).join(",")),`Target(${r})`}(Wn(t))}; limitType=${t.limitType})`}function Oc(t,e){return e.isFoundDocument()&&function(r,s){const i=s.key.path;return r.collectionGroup!==null?s.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(i):ee.isDocumentKey(r.path)?r.path.isEqual(i):r.path.isImmediateParentOf(i)}(t,e)&&function(r,s){for(const i of Xo(r))if(!i.field.isKeyField()&&s.data.field(i.field)===null)return!1;return!0}(t,e)&&function(r,s){for(const i of r.filters)if(!i.matches(s))return!1;return!0}(t,e)&&function(r,s){return!(r.startAt&&!function(o,a,l){const d=DE(o,a,l);return o.inclusive?d<=0:d<0}(r.startAt,Xo(r),s)||r.endAt&&!function(o,a,l){const d=DE(o,a,l);return o.inclusive?d>=0:d>0}(r.endAt,Xo(r),s))}(t,e)}function tV(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function Nb(t){return(e,n)=>{let r=!1;for(const s of Xo(t)){const i=nV(s,e,n);if(i!==0)return i;r=r||s.field.isKeyField()}return 0}}function nV(t,e,n){const r=t.field.isKeyField()?ee.comparator(e.key,n.key):function(i,o,a){const l=o.data.field(i),d=a.data.field(i);return l!==null&&d!==null?Ks(l,d):oe(42886)}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return oe(19790,{direction:t.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ns{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[s,i]of r)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),s=this.inner[r];if(s===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,n]);s.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return r.length===1?delete this.inner[n]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(e){si(this.inner,(n,r)=>{for(const[s,i]of r)e(s,i)})}isEmpty(){return hb(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rV=new ht(ee.comparator);function Nn(){return rV}const kb=new ht(ee.comparator);function gl(...t){let e=kb;for(const n of t)e=e.insert(n.key,n);return e}function Db(t){let e=kb;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function Sr(){return Ml()}function jb(){return Ml()}function Ml(){return new ns(t=>t.toString(),(t,e)=>t.isEqual(e))}const sV=new ht(ee.comparator),iV=new Ze(ee.comparator);function Ce(...t){let e=iV;for(const n of t)e=e.add(n);return e}const oV=new Ze(Ie);function aV(){return oV}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Oy(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:uc(e)?"-0":e}}function Ob(t){return{integerValue:""+t}}function Vb(t,e){return fO(e)?Ob(e):Oy(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hh{constructor(){this._=void 0}}function lV(t,e,n){return t instanceof _a?function(s,i){const o={fields:{[mb]:{stringValue:pb},[yb]:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return i&&$h(i)&&(i=Bh(i)),i&&(o.fields[gb]=i),{mapValue:o}}(n,e):t instanceof Wi?Mb(t,e):t instanceof va?Fb(t,e):function(s,i){const o=Lb(s,i),a=ME(o)+ME(s.Ae);return Bm(o)&&Bm(s.Ae)?Ob(a):Oy(s.serializer,a)}(t,e)}function cV(t,e,n){return t instanceof Wi?Mb(t,e):t instanceof va?Fb(t,e):n}function Lb(t,e){return t instanceof wa?function(r){return Bm(r)||function(i){return!!i&&"doubleValue"in i}(r)}(e)?e:{integerValue:0}:null}class _a extends Hh{}class Wi extends Hh{constructor(e){super(),this.elements=e}}function Mb(t,e){const n=Ub(e);for(const r of t.elements)n.some(s=>Dr(s,r))||n.push(r);return{arrayValue:{values:n}}}class va extends Hh{constructor(e){super(),this.elements=e}}function Fb(t,e){let n=Ub(e);for(const r of t.elements)n=n.filter(s=>!Dr(s,r));return{arrayValue:{values:n}}}class wa extends Hh{constructor(e,n){super(),this.serializer=e,this.Ae=n}}function ME(t){return ct(t.integerValue||t.doubleValue)}function Ub(t){return gc(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wh{constructor(e,n){this.field=e,this.transform=n}}function uV(t,e){return t.field.isEqual(e.field)&&function(r,s){return r instanceof Wi&&s instanceof Wi||r instanceof va&&s instanceof va?ua(r.elements,s.elements,Dr):r instanceof wa&&s instanceof wa?Dr(r.Ae,s.Ae):r instanceof _a&&s instanceof _a}(t.transform,e.transform)}class dV{constructor(e,n){this.version=e,this.transformResults=n}}class sn{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new sn}static exists(e){return new sn(void 0,e)}static updateTime(e){return new sn(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function nd(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class Kh{}function $b(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new Gh(t.key,sn.none()):new ka(t.key,t.data,sn.none());{const n=t.data,r=rn.empty();let s=new Ze(gt.comparator);for(let i of e.fields)if(!s.has(i)){let o=n.field(i);o===null&&i.length>1&&(i=i.popLast(),o=n.field(i)),o===null?r.delete(i):r.set(i,o),s=s.add(i)}return new rs(t.key,r,new En(s.toArray()),sn.none())}}function hV(t,e,n){t instanceof ka?function(s,i,o){const a=s.value.clone(),l=UE(s.fieldTransforms,i,o.transformResults);a.setAll(l),i.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(t,e,n):t instanceof rs?function(s,i,o){if(!nd(s.precondition,i))return void i.convertToUnknownDocument(o.version);const a=UE(s.fieldTransforms,i,o.transformResults),l=i.data;l.setAll(Bb(s)),l.setAll(a),i.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(t,e,n):function(s,i,o){i.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,n)}function Fl(t,e,n,r){return t instanceof ka?function(i,o,a,l){if(!nd(i.precondition,o))return a;const d=i.value.clone(),h=$E(i.fieldTransforms,l,o);return d.setAll(h),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),null}(t,e,n,r):t instanceof rs?function(i,o,a,l){if(!nd(i.precondition,o))return a;const d=$E(i.fieldTransforms,l,o),h=o.data;return h.setAll(Bb(i)),h.setAll(d),o.convertToFoundDocument(o.version,h).setHasLocalMutations(),a===null?null:a.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(f=>f.field))}(t,e,n,r):function(i,o,a){return nd(i.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(t,e,n)}function fV(t,e){let n=null;for(const r of t.fieldTransforms){const s=e.data.field(r.field),i=Lb(r.transform,s||null);i!=null&&(n===null&&(n=rn.empty()),n.set(r.field,i))}return n||null}function FE(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,s){return r===void 0&&s===void 0||!(!r||!s)&&ua(r,s,(i,o)=>uV(i,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class ka extends Kh{constructor(e,n,r,s=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class rs extends Kh{constructor(e,n,r,s,i=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function Bb(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function UE(t,e,n){const r=new Map;le(t.length===n.length,32656,{Re:n.length,Ve:t.length});for(let s=0;s<n.length;s++){const i=t[s],o=i.transform,a=e.data.field(i.field);r.set(i.field,cV(o,a,n[s]))}return r}function $E(t,e,n){const r=new Map;for(const s of t){const i=s.transform,o=n.data.field(s.field);r.set(s.field,lV(i,o,e))}return r}class Gh extends Kh{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class zb extends Kh{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vy{constructor(e,n,r,s){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&hV(i,e,r[s])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=Fl(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=Fl(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=jb();return this.mutations.forEach(s=>{const i=e.get(s.key),o=i.overlayedDocument;let a=this.applyToLocalView(o,i.mutatedFields);a=n.has(s.key)?null:a;const l=$b(o,a);l!==null&&r.set(s.key,l),o.isValidDocument()||o.convertToNoDocument(fe.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),Ce())}isEqual(e){return this.batchId===e.batchId&&ua(this.mutations,e.mutations,(n,r)=>FE(n,r))&&ua(this.baseMutations,e.baseMutations,(n,r)=>FE(n,r))}}class Ly{constructor(e,n,r,s){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=s}static from(e,n,r){le(e.mutations.length===r.length,58842,{me:e.mutations.length,fe:r.length});let s=function(){return sV}();const i=e.mutations;for(let o=0;o<i.length;o++)s=s.insert(i[o].key,r[o].version);return new Ly(e,n,r,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class My{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pV{constructor(e,n,r){this.alias=e,this.aggregateType=n,this.fieldPath=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mV{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ct,Fe;function gV(t){switch(t){case B.OK:return oe(64938);case B.CANCELLED:case B.UNKNOWN:case B.DEADLINE_EXCEEDED:case B.RESOURCE_EXHAUSTED:case B.INTERNAL:case B.UNAVAILABLE:case B.UNAUTHENTICATED:return!1;case B.INVALID_ARGUMENT:case B.NOT_FOUND:case B.ALREADY_EXISTS:case B.PERMISSION_DENIED:case B.FAILED_PRECONDITION:case B.ABORTED:case B.OUT_OF_RANGE:case B.UNIMPLEMENTED:case B.DATA_LOSS:return!0;default:return oe(15467,{code:t})}}function qb(t){if(t===void 0)return dn("GRPC error has no .code"),B.UNKNOWN;switch(t){case Ct.OK:return B.OK;case Ct.CANCELLED:return B.CANCELLED;case Ct.UNKNOWN:return B.UNKNOWN;case Ct.DEADLINE_EXCEEDED:return B.DEADLINE_EXCEEDED;case Ct.RESOURCE_EXHAUSTED:return B.RESOURCE_EXHAUSTED;case Ct.INTERNAL:return B.INTERNAL;case Ct.UNAVAILABLE:return B.UNAVAILABLE;case Ct.UNAUTHENTICATED:return B.UNAUTHENTICATED;case Ct.INVALID_ARGUMENT:return B.INVALID_ARGUMENT;case Ct.NOT_FOUND:return B.NOT_FOUND;case Ct.ALREADY_EXISTS:return B.ALREADY_EXISTS;case Ct.PERMISSION_DENIED:return B.PERMISSION_DENIED;case Ct.FAILED_PRECONDITION:return B.FAILED_PRECONDITION;case Ct.ABORTED:return B.ABORTED;case Ct.OUT_OF_RANGE:return B.OUT_OF_RANGE;case Ct.UNIMPLEMENTED:return B.UNIMPLEMENTED;case Ct.DATA_LOSS:return B.DATA_LOSS;default:return oe(39323,{code:t})}}(Fe=Ct||(Ct={}))[Fe.OK=0]="OK",Fe[Fe.CANCELLED=1]="CANCELLED",Fe[Fe.UNKNOWN=2]="UNKNOWN",Fe[Fe.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Fe[Fe.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Fe[Fe.NOT_FOUND=5]="NOT_FOUND",Fe[Fe.ALREADY_EXISTS=6]="ALREADY_EXISTS",Fe[Fe.PERMISSION_DENIED=7]="PERMISSION_DENIED",Fe[Fe.UNAUTHENTICATED=16]="UNAUTHENTICATED",Fe[Fe.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Fe[Fe.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Fe[Fe.ABORTED=10]="ABORTED",Fe[Fe.OUT_OF_RANGE=11]="OUT_OF_RANGE",Fe[Fe.UNIMPLEMENTED=12]="UNIMPLEMENTED",Fe[Fe.INTERNAL=13]="INTERNAL",Fe[Fe.UNAVAILABLE=14]="UNAVAILABLE",Fe[Fe.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yV(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _V=new $s([4294967295,4294967295],0);function BE(t){const e=yV().encode(t),n=new $S;return n.update(e),new Uint8Array(n.digest())}function zE(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),s=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new $s([n,r],0),new $s([s,i],0)]}class Fy{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new yl(`Invalid padding: ${n}`);if(r<0)throw new yl(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new yl(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new yl(`Invalid padding when bitmap length is 0: ${n}`);this.ge=8*e.length-n,this.pe=$s.fromNumber(this.ge)}ye(e,n,r){let s=e.add(n.multiply($s.fromNumber(r)));return s.compare(_V)===1&&(s=new $s([s.getBits(0),s.getBits(1)],0)),s.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const n=BE(e),[r,s]=zE(n);for(let i=0;i<this.hashCount;i++){const o=this.ye(r,s,i);if(!this.we(o))return!1}return!0}static create(e,n,r){const s=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),o=new Fy(i,s,n);return r.forEach(a=>o.insert(a)),o}insert(e){if(this.ge===0)return;const n=BE(e),[r,s]=zE(n);for(let i=0;i<this.hashCount;i++){const o=this.ye(r,s,i);this.Se(o)}}Se(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class yl extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qh{constructor(e,n,r,s,i){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const s=new Map;return s.set(e,Vc.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new Qh(fe.min(),s,new ht(Ie),Nn(),Ce())}}class Vc{constructor(e,n,r,s,i){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new Vc(r,n,Ce(),Ce(),Ce())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rd{constructor(e,n,r,s){this.be=e,this.removedTargetIds=n,this.key=r,this.De=s}}class Hb{constructor(e,n){this.targetId=e,this.Ce=n}}class Wb{constructor(e,n,r=Pt.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=s}}class qE{constructor(){this.ve=0,this.Fe=HE(),this.Me=Pt.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=Ce(),n=Ce(),r=Ce();return this.Fe.forEach((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:n=n.add(s);break;case 1:r=r.add(s);break;default:oe(38017,{changeType:i})}}),new Vc(this.Me,this.xe,e,n,r)}qe(){this.Oe=!1,this.Fe=HE()}Qe(e,n){this.Oe=!0,this.Fe=this.Fe.insert(e,n)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,le(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class vV{constructor(e){this.Ge=e,this.ze=new Map,this.je=Nn(),this.Je=Eu(),this.He=Eu(),this.Ye=new ht(Ie)}Ze(e){for(const n of e.be)e.De&&e.De.isFoundDocument()?this.Xe(n,e.De):this.et(n,e.key,e.De);for(const n of e.removedTargetIds)this.et(n,e.key,e.De)}tt(e){this.forEachTarget(e,n=>{const r=this.nt(n);switch(e.state){case 0:this.rt(n)&&r.Le(e.resumeToken);break;case 1:r.Ke(),r.Ne||r.qe(),r.Le(e.resumeToken);break;case 2:r.Ke(),r.Ne||this.removeTarget(n);break;case 3:this.rt(n)&&(r.We(),r.Le(e.resumeToken));break;case 4:this.rt(n)&&(this.it(n),r.Le(e.resumeToken));break;default:oe(56790,{state:e.state})}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.ze.forEach((r,s)=>{this.rt(s)&&n(s)})}st(e){const n=e.targetId,r=e.Ce.count,s=this.ot(n);if(s){const i=s.target;if(Wd(i))if(r===0){const o=new ee(i.path);this.et(n,o,Et.newNoDocument(o,fe.min()))}else le(r===1,20013,{expectedCount:r});else{const o=this._t(n);if(o!==r){const a=this.ut(e),l=a?this.ct(a,e,o):1;if(l!==0){this.it(n);const d=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(n,d)}}}}}ut(e){const n=e.Ce.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:s=0},hashCount:i=0}=n;let o,a;try{o=es(r).toUint8Array()}catch(l){if(l instanceof fb)return Bi("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{a=new Fy(o,s,i)}catch(l){return Bi(l instanceof yl?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return a.ge===0?null:a}ct(e,n,r){return n.Ce.count===r-this.Pt(e,n.targetId)?0:2}Pt(e,n){const r=this.Ge.getRemoteKeysForTarget(n);let s=0;return r.forEach(i=>{const o=this.Ge.ht(),a=`projects/${o.projectId}/databases/${o.database}/documents/${i.path.canonicalString()}`;e.mightContain(a)||(this.et(n,i,null),s++)}),s}Tt(e){const n=new Map;this.ze.forEach((i,o)=>{const a=this.ot(o);if(a){if(i.current&&Wd(a.target)){const l=new ee(a.target.path);this.It(l).has(o)||this.Et(o,l)||this.et(o,l,Et.newNoDocument(l,e))}i.Be&&(n.set(o,i.ke()),i.qe())}});let r=Ce();this.He.forEach((i,o)=>{let a=!0;o.forEachWhile(l=>{const d=this.ot(l);return!d||d.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(i))}),this.je.forEach((i,o)=>o.setReadTime(e));const s=new Qh(e,n,this.Ye,this.je,r);return this.je=Nn(),this.Je=Eu(),this.He=Eu(),this.Ye=new ht(Ie),s}Xe(e,n){if(!this.rt(e))return;const r=this.Et(e,n.key)?2:0;this.nt(e).Qe(n.key,r),this.je=this.je.insert(n.key,n),this.Je=this.Je.insert(n.key,this.It(n.key).add(e)),this.He=this.He.insert(n.key,this.dt(n.key).add(e))}et(e,n,r){if(!this.rt(e))return;const s=this.nt(e);this.Et(e,n)?s.Qe(n,1):s.$e(n),this.He=this.He.insert(n,this.dt(n).delete(e)),this.He=this.He.insert(n,this.dt(n).add(e)),r&&(this.je=this.je.insert(n,r))}removeTarget(e){this.ze.delete(e)}_t(e){const n=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let n=this.ze.get(e);return n||(n=new qE,this.ze.set(e,n)),n}dt(e){let n=this.He.get(e);return n||(n=new Ze(Ie),this.He=this.He.insert(e,n)),n}It(e){let n=this.Je.get(e);return n||(n=new Ze(Ie),this.Je=this.Je.insert(e,n)),n}rt(e){const n=this.ot(e)!==null;return n||W("WatchChangeAggregator","Detected inactive target",e),n}ot(e){const n=this.ze.get(e);return n&&n.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new qE),this.Ge.getRemoteKeysForTarget(e).forEach(n=>{this.et(e,n,null)})}Et(e,n){return this.Ge.getRemoteKeysForTarget(e).has(n)}}function Eu(){return new ht(ee.comparator)}function HE(){return new ht(ee.comparator)}const wV={asc:"ASCENDING",desc:"DESCENDING"},EV={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},IV={and:"AND",or:"OR"};class TV{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function Km(t,e){return t.useProto3Json||Lh(e)?e:{value:e}}function Ea(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Kb(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function xV(t,e){return Ea(t,e.toTimestamp())}function pn(t){return le(!!t,49232),fe.fromTimestamp(function(n){const r=Zr(n);return new $e(r.seconds,r.nanos)}(t))}function Uy(t,e){return Gm(t,e).canonicalString()}function Gm(t,e){const n=function(s){return new He(["projects",s.projectId,"databases",s.database])}(t).child("documents");return e===void 0?n:n.child(e)}function Gb(t){const e=He.fromString(t);return le(nC(e),10190,{key:e.toString()}),e}function Qd(t,e){return Uy(t.databaseId,e.path)}function Ni(t,e){const n=Gb(e);if(n.get(1)!==t.databaseId.projectId)throw new G(B.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new G(B.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new ee(Xb(n))}function Qb(t,e){return Uy(t.databaseId,e)}function Yb(t){const e=Gb(t);return e.length===4?He.emptyPath():Xb(e)}function Qm(t){return new He(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function Xb(t){return le(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function WE(t,e,n){return{name:Qd(t,e),fields:n.value.mapValue.fields}}function SV(t,e,n){const r=Ni(t,e.name),s=pn(e.updateTime),i=e.createTime?pn(e.createTime):fe.min(),o=new rn({mapValue:{fields:e.fields}}),a=Et.newFoundDocument(r,s,i,o);return n&&a.setHasCommittedMutations(),n?a.setHasCommittedMutations():a}function bV(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(d){return d==="NO_CHANGE"?0:d==="ADD"?1:d==="REMOVE"?2:d==="CURRENT"?3:d==="RESET"?4:oe(39313,{state:d})}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=function(d,h){return d.useProto3Json?(le(h===void 0||typeof h=="string",58123),Pt.fromBase64String(h||"")):(le(h===void 0||h instanceof Buffer||h instanceof Uint8Array,16193),Pt.fromUint8Array(h||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(d){const h=d.code===void 0?B.UNKNOWN:qb(d.code);return new G(h,d.message||"")}(o);n=new Wb(r,s,i,a||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const s=Ni(t,r.document.name),i=pn(r.document.updateTime),o=r.document.createTime?pn(r.document.createTime):fe.min(),a=new rn({mapValue:{fields:r.document.fields}}),l=Et.newFoundDocument(s,i,o,a),d=r.targetIds||[],h=r.removedTargetIds||[];n=new rd(d,h,l.key,l)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const s=Ni(t,r.document),i=r.readTime?pn(r.readTime):fe.min(),o=Et.newNoDocument(s,i),a=r.removedTargetIds||[];n=new rd([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const s=Ni(t,r.document),i=r.removedTargetIds||[];n=new rd([],i,s,null)}else{if(!("filter"in e))return oe(11601,{Rt:e});{e.filter;const r=e.filter;r.targetId;const{count:s=0,unchangedNames:i}=r,o=new mV(s,i),a=r.targetId;n=new Hb(a,o)}}return n}function Yd(t,e){let n;if(e instanceof ka)n={update:WE(t,e.key,e.value)};else if(e instanceof Gh)n={delete:Qd(t,e.key)};else if(e instanceof rs)n={update:WE(t,e.key,e.data),updateMask:DV(e.fieldMask)};else{if(!(e instanceof zb))return oe(16599,{Vt:e.type});n={verify:Qd(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(i,o){const a=o.transform;if(a instanceof _a)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof Wi)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof va)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof wa)return{fieldPath:o.field.canonicalString(),increment:a.Ae};throw oe(20930,{transform:o.transform})}(0,r))),e.precondition.isNone||(n.currentDocument=function(s,i){return i.updateTime!==void 0?{updateTime:xV(s,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:oe(27497)}(t,e.precondition)),n}function Ym(t,e){const n=e.currentDocument?function(i){return i.updateTime!==void 0?sn.updateTime(pn(i.updateTime)):i.exists!==void 0?sn.exists(i.exists):sn.none()}(e.currentDocument):sn.none(),r=e.updateTransforms?e.updateTransforms.map(s=>function(o,a){let l=null;if("setToServerValue"in a)le(a.setToServerValue==="REQUEST_TIME",16630,{proto:a}),l=new _a;else if("appendMissingElements"in a){const h=a.appendMissingElements.values||[];l=new Wi(h)}else if("removeAllFromArray"in a){const h=a.removeAllFromArray.values||[];l=new va(h)}else"increment"in a?l=new wa(o,a.increment):oe(16584,{proto:a});const d=gt.fromServerFormat(a.fieldPath);return new Wh(d,l)}(t,s)):[];if(e.update){e.update.name;const s=Ni(t,e.update.name),i=new rn({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=function(l){const d=l.fieldPaths||[];return new En(d.map(h=>gt.fromServerFormat(h)))}(e.updateMask);return new rs(s,i,o,n,r)}return new ka(s,i,n,r)}if(e.delete){const s=Ni(t,e.delete);return new Gh(s,n)}if(e.verify){const s=Ni(t,e.verify);return new zb(s,n)}return oe(1463,{proto:e})}function CV(t,e){return t&&t.length>0?(le(e!==void 0,14353),t.map(n=>function(s,i){let o=s.updateTime?pn(s.updateTime):pn(i);return o.isEqual(fe.min())&&(o=pn(i)),new dV(o,s.transformResults||[])}(n,e))):[]}function Jb(t,e){return{documents:[Qb(t,e.path)]}}function $y(t,e){const n={structuredQuery:{}},r=e.path;let s;e.collectionGroup!==null?(s=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=Qb(t,s);const i=function(d){if(d.length!==0)return tC(Xe.create(d,"and"))}(e.filters);i&&(n.structuredQuery.where=i);const o=function(d){if(d.length!==0)return d.map(h=>function(m){return{field:xs(m.field),direction:PV(m.dir)}}(h))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);const a=Km(t,e.limit);return a!==null&&(n.structuredQuery.limit=a),e.startAt&&(n.structuredQuery.startAt=function(d){return{before:d.inclusive,values:d.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(d){return{before:!d.inclusive,values:d.position}}(e.endAt)),{ft:n,parent:s}}function AV(t,e,n,r){const{ft:s,parent:i}=$y(t,e),o={},a=[];let l=0;return n.forEach(d=>{const h="aggregate_"+l++;o[h]=d.alias,d.aggregateType==="count"?a.push({alias:h,count:{}}):d.aggregateType==="avg"?a.push({alias:h,avg:{field:xs(d.fieldPath)}}):d.aggregateType==="sum"&&a.push({alias:h,sum:{field:xs(d.fieldPath)}})}),{request:{structuredAggregationQuery:{aggregations:a,structuredQuery:s.structuredQuery},parent:s.parent},gt:o,parent:i}}function Zb(t){let e=Yb(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let s=null;if(r>0){le(r===1,65062);const h=n.from[0];h.allDescendants?s=h.collectionId:e=e.child(h.collectionId)}let i=[];n.where&&(i=function(f){const m=eC(f);return m instanceof Xe&&Dy(m)?m.getFilters():[m]}(n.where));let o=[];n.orderBy&&(o=function(f){return f.map(m=>function(R){return new yc(Co(R.field),function(A){switch(A){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(R.direction))}(m))}(n.orderBy));let a=null;n.limit&&(a=function(f){let m;return m=typeof f=="object"?f.value:f,Lh(m)?null:m}(n.limit));let l=null;n.startAt&&(l=function(f){const m=!!f.before,w=f.values||[];return new Gs(w,m)}(n.startAt));let d=null;return n.endAt&&(d=function(f){const m=!f.before,w=f.values||[];return new Gs(w,m)}(n.endAt)),ZO(e,s,o,i,a,"F",l,d)}function RV(t,e){const n=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return oe(28987,{purpose:s})}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function eC(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=Co(n.unaryFilter.field);return Oe.create(r,"==",{doubleValue:NaN});case"IS_NULL":const s=Co(n.unaryFilter.field);return Oe.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=Co(n.unaryFilter.field);return Oe.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=Co(n.unaryFilter.field);return Oe.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return oe(61313);default:return oe(60726)}}(t):t.fieldFilter!==void 0?function(n){return Oe.create(Co(n.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return oe(58110);default:return oe(50506)}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return Xe.create(n.compositeFilter.filters.map(r=>eC(r)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return oe(1026)}}(n.compositeFilter.op))}(t):oe(30097,{filter:t})}function PV(t){return wV[t]}function NV(t){return EV[t]}function kV(t){return IV[t]}function xs(t){return{fieldPath:t.canonicalString()}}function Co(t){return gt.fromServerFormat(t.fieldPath)}function tC(t){return t instanceof Oe?function(n){if(n.op==="=="){if(PE(n.value))return{unaryFilter:{field:xs(n.field),op:"IS_NAN"}};if(RE(n.value))return{unaryFilter:{field:xs(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(PE(n.value))return{unaryFilter:{field:xs(n.field),op:"IS_NOT_NAN"}};if(RE(n.value))return{unaryFilter:{field:xs(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:xs(n.field),op:NV(n.op),value:n.value}}}(t):t instanceof Xe?function(n){const r=n.getFilters().map(s=>tC(s));return r.length===1?r[0]:{compositeFilter:{op:kV(n.op),filters:r}}}(t):oe(54877,{filter:t})}function DV(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function nC(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Br{constructor(e,n,r,s,i=fe.min(),o=fe.min(),a=Pt.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=l}withSequenceNumber(e){return new Br(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new Br(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Br(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Br(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rC{constructor(e){this.yt=e}}function jV(t,e){let n;if(e.document)n=SV(t.yt,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=ee.fromSegments(e.noDocument.path),s=Gi(e.noDocument.readTime);n=Et.newNoDocument(r,s),e.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!e.unknownDocument)return oe(56709);{const r=ee.fromSegments(e.unknownDocument.path),s=Gi(e.unknownDocument.version);n=Et.newUnknownDocument(r,s)}}return e.readTime&&n.setReadTime(function(s){const i=new $e(s[0],s[1]);return fe.fromTimestamp(i)}(e.readTime)),n}function KE(t,e){const n=e.key,r={prefixPath:n.getCollectionPath().popLast().toArray(),collectionGroup:n.collectionGroup,documentId:n.path.lastSegment(),readTime:Xd(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=function(i,o){return{name:Qd(i,o.key),fields:o.data.value.mapValue.fields,updateTime:Ea(i,o.version.toTimestamp()),createTime:Ea(i,o.createTime.toTimestamp())}}(t.yt,e);else if(e.isNoDocument())r.noDocument={path:n.path.toArray(),readTime:Ki(e.version)};else{if(!e.isUnknownDocument())return oe(57904,{document:e});r.unknownDocument={path:n.path.toArray(),version:Ki(e.version)}}return r}function Xd(t){const e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function Ki(t){const e=t.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function Gi(t){const e=new $e(t.seconds,t.nanoseconds);return fe.fromTimestamp(e)}function _i(t,e){const n=(e.baseMutations||[]).map(i=>Ym(t.yt,i));for(let i=0;i<e.mutations.length-1;++i){const o=e.mutations[i];if(i+1<e.mutations.length&&e.mutations[i+1].transform!==void 0){const a=e.mutations[i+1];o.updateTransforms=a.transform.fieldTransforms,e.mutations.splice(i+1,1),++i}}const r=e.mutations.map(i=>Ym(t.yt,i)),s=$e.fromMillis(e.localWriteTimeMs);return new Vy(e.batchId,s,n,r)}function _l(t){const e=Gi(t.readTime),n=t.lastLimboFreeSnapshotVersion!==void 0?Gi(t.lastLimboFreeSnapshotVersion):fe.min();let r;return r=function(i){return i.documents!==void 0}(t.query)?function(i){const o=i.documents.length;return le(o===1,1966,{count:o}),Wn(jc(Yb(i.documents[0])))}(t.query):function(i){return Wn(Zb(i))}(t.query),new Br(r,t.targetId,"TargetPurposeListen",t.lastListenSequenceNumber,e,n,Pt.fromBase64String(t.resumeToken))}function sC(t,e){const n=Ki(e.snapshotVersion),r=Ki(e.lastLimboFreeSnapshotVersion);let s;s=Wd(e.target)?Jb(t.yt,e.target):$y(t.yt,e.target).ft;const i=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Hi(e.target),readTime:n,resumeToken:i,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:s}}function iC(t){const e=Zb({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?Gd(e,e.limit,"L"):e}function hp(t,e){return new My(e.largestBatchId,Ym(t.yt,e.overlayMutation))}function GE(t,e){const n=e.path.lastSegment();return[t,an(e.path.popLast()),n]}function QE(t,e,n,r){return{indexId:t,uid:e,sequenceNumber:n,readTime:Ki(r.readTime),documentKey:an(r.documentKey.path),largestBatchId:r.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OV{getBundleMetadata(e,n){return YE(e).get(n).next(r=>{if(r)return function(i){return{id:i.bundleId,createTime:Gi(i.createTime),version:i.version}}(r)})}saveBundleMetadata(e,n){return YE(e).put(function(s){return{bundleId:s.id,createTime:Ki(pn(s.createTime)),version:s.version}}(n))}getNamedQuery(e,n){return XE(e).get(n).next(r=>{if(r)return function(i){return{name:i.name,query:iC(i.bundledQuery),readTime:Gi(i.readTime)}}(r)})}saveNamedQuery(e,n){return XE(e).put(function(s){return{name:s.name,readTime:Ki(pn(s.readTime)),bundledQuery:s.bundledQuery}}(n))}}function YE(t){return Vt(t,Mh)}function XE(t){return Vt(t,Fh)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yh{constructor(e,n){this.serializer=e,this.userId=n}static wt(e,n){const r=n.uid||"";return new Yh(e,r)}getOverlay(e,n){return nl(e).get(GE(this.userId,n)).next(r=>r?hp(this.serializer,r):null)}getOverlays(e,n){const r=Sr();return O.forEach(n,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,n,r){const s=[];return r.forEach((i,o)=>{const a=new My(n,o);s.push(this.St(e,a))}),O.waitFor(s)}removeOverlaysForBatchId(e,n,r){const s=new Set;n.forEach(o=>s.add(an(o.getCollectionPath())));const i=[];return s.forEach(o=>{const a=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,r+1],!1,!0);i.push(nl(e).Z(Fm,a))}),O.waitFor(i)}getOverlaysForCollection(e,n,r){const s=Sr(),i=an(n),o=IDBKeyRange.bound([this.userId,i,r],[this.userId,i,Number.POSITIVE_INFINITY],!0);return nl(e).J(Fm,o).next(a=>{for(const l of a){const d=hp(this.serializer,l);s.set(d.getKey(),d)}return s})}getOverlaysForCollectionGroup(e,n,r,s){const i=Sr();let o;const a=IDBKeyRange.bound([this.userId,n,r],[this.userId,n,Number.POSITIVE_INFINITY],!0);return nl(e).ee({index:ab,range:a},(l,d,h)=>{const f=hp(this.serializer,d);i.size()<s||f.largestBatchId===o?(i.set(f.getKey(),f),o=f.largestBatchId):h.done()}).next(()=>i)}St(e,n){return nl(e).put(function(s,i,o){const[a,l,d]=GE(i,o.mutation.key);return{userId:i,collectionPath:l,documentId:d,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:Yd(s.yt,o.mutation)}}(this.serializer,this.userId,n))}}function nl(t){return Vt(t,Uh)}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VV{bt(e){return Vt(e,Ry)}getSessionToken(e){return this.bt(e).get("sessionToken").next(n=>{const r=n==null?void 0:n.value;return r?Pt.fromUint8Array(r):Pt.EMPTY_BYTE_STRING})}setSessionToken(e,n){return this.bt(e).put({name:"sessionToken",value:n.toUint8Array()})}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vi{constructor(){}Dt(e,n){this.Ct(e,n),n.vt()}Ct(e,n){if("nullValue"in e)this.Ft(n,5);else if("booleanValue"in e)this.Ft(n,10),n.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(n,15),n.Mt(ct(e.integerValue));else if("doubleValue"in e){const r=ct(e.doubleValue);isNaN(r)?this.Ft(n,13):(this.Ft(n,15),uc(r)?n.Mt(0):n.Mt(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Ft(n,20),typeof r=="string"&&(r=Zr(r)),n.xt(`${r.seconds||""}`),n.Mt(r.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,n),this.Nt(n);else if("bytesValue"in e)this.Ft(n,30),n.Bt(es(e.bytesValue)),this.Nt(n);else if("referenceValue"in e)this.Lt(e.referenceValue,n);else if("geoPointValue"in e){const r=e.geoPointValue;this.Ft(n,45),n.Mt(r.latitude||0),n.Mt(r.longitude||0)}else"mapValue"in e?vb(e)?this.Ft(n,Number.MAX_SAFE_INTEGER):zh(e)?this.kt(e.mapValue,n):(this.qt(e.mapValue,n),this.Nt(n)):"arrayValue"in e?(this.Qt(e.arrayValue,n),this.Nt(n)):oe(19022,{$t:e})}Ot(e,n){this.Ft(n,25),this.Ut(e,n)}Ut(e,n){n.xt(e)}qt(e,n){const r=e.fields||{};this.Ft(n,55);for(const s of Object.keys(r))this.Ot(s,n),this.Ct(r[s],n)}kt(e,n){var o,a;const r=e.fields||{};this.Ft(n,53);const s=ma,i=((a=(o=r[s].arrayValue)==null?void 0:o.values)==null?void 0:a.length)||0;this.Ft(n,15),n.Mt(ct(i)),this.Ot(s,n),this.Ct(r[s],n)}Qt(e,n){const r=e.values||[];this.Ft(n,50);for(const s of r)this.Ct(s,n)}Lt(e,n){this.Ft(n,37),ee.fromName(e).path.forEach(r=>{this.Ft(n,60),this.Ut(r,n)})}Ft(e,n){e.Mt(n)}Nt(e){e.Mt(2)}}vi.Kt=new vi;/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law | agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES | CONDITIONS OF ANY KIND, either express | implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const po=255;function LV(t){if(t===0)return 8;let e=0;return t>>4||(e+=4,t<<=4),t>>6||(e+=2,t<<=2),t>>7||(e+=1),e}function JE(t){const e=64-function(r){let s=0;for(let i=0;i<8;++i){const o=LV(255&r[i]);if(s+=o,o!==8)break}return s}(t);return Math.ceil(e/8)}class MV{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Wt(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.Gt(r.value),r=n.next();this.zt()}jt(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.Jt(r.value),r=n.next();this.Ht()}Yt(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.Gt(r);else if(r<2048)this.Gt(960|r>>>6),this.Gt(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Gt(480|r>>>12),this.Gt(128|63&r>>>6),this.Gt(128|63&r);else{const s=n.codePointAt(0);this.Gt(240|s>>>18),this.Gt(128|63&s>>>12),this.Gt(128|63&s>>>6),this.Gt(128|63&s)}}this.zt()}Zt(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.Jt(r);else if(r<2048)this.Jt(960|r>>>6),this.Jt(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Jt(480|r>>>12),this.Jt(128|63&r>>>6),this.Jt(128|63&r);else{const s=n.codePointAt(0);this.Jt(240|s>>>18),this.Jt(128|63&s>>>12),this.Jt(128|63&s>>>6),this.Jt(128|63&s)}}this.Ht()}Xt(e){const n=this.en(e),r=JE(n);this.tn(1+r),this.buffer[this.position++]=255&r;for(let s=n.length-r;s<n.length;++s)this.buffer[this.position++]=255&n[s]}nn(e){const n=this.en(e),r=JE(n);this.tn(1+r),this.buffer[this.position++]=~(255&r);for(let s=n.length-r;s<n.length;++s)this.buffer[this.position++]=~(255&n[s])}rn(){this.sn(po),this.sn(255)}_n(){this.an(po),this.an(255)}reset(){this.position=0}seed(e){this.tn(e.length),this.buffer.set(e,this.position),this.position+=e.length}un(){return this.buffer.slice(0,this.position)}en(e){const n=function(i){const o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,i,!1),new Uint8Array(o.buffer)}(e),r=!!(128&n[0]);n[0]^=r?255:128;for(let s=1;s<n.length;++s)n[s]^=r?255:0;return n}Gt(e){const n=255&e;n===0?(this.sn(0),this.sn(255)):n===po?(this.sn(po),this.sn(0)):this.sn(n)}Jt(e){const n=255&e;n===0?(this.an(0),this.an(255)):n===po?(this.an(po),this.an(0)):this.an(e)}zt(){this.sn(0),this.sn(1)}Ht(){this.an(0),this.an(1)}sn(e){this.tn(1),this.buffer[this.position++]=e}an(e){this.tn(1),this.buffer[this.position++]=~e}tn(e){const n=e+this.position;if(n<=this.buffer.length)return;let r=2*this.buffer.length;r<n&&(r=n);const s=new Uint8Array(r);s.set(this.buffer),this.buffer=s}}class FV{constructor(e){this.cn=e}Bt(e){this.cn.Wt(e)}xt(e){this.cn.Yt(e)}Mt(e){this.cn.Xt(e)}vt(){this.cn.rn()}}class UV{constructor(e){this.cn=e}Bt(e){this.cn.jt(e)}xt(e){this.cn.Zt(e)}Mt(e){this.cn.nn(e)}vt(){this.cn._n()}}class rl{constructor(){this.cn=new MV,this.ln=new FV(this.cn),this.hn=new UV(this.cn)}seed(e){this.cn.seed(e)}Pn(e){return e===0?this.ln:this.hn}un(){return this.cn.un()}reset(){this.cn.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wi{constructor(e,n,r,s){this.Tn=e,this.In=n,this.En=r,this.dn=s}An(){const e=this.dn.length,n=e===0||this.dn[e-1]===255?e+1:e,r=new Uint8Array(n);return r.set(this.dn,0),n!==e?r.set([0],this.dn.length):++r[r.length-1],new wi(this.Tn,this.In,this.En,r)}Rn(e,n,r){return{indexId:this.Tn,uid:e,arrayValue:sd(this.En),directionalValue:sd(this.dn),orderedDocumentKey:sd(n),documentKey:r.path.toArray()}}Vn(e,n,r){const s=this.Rn(e,n,r);return[s.indexId,s.uid,s.arrayValue,s.directionalValue,s.orderedDocumentKey,s.documentKey]}}function fs(t,e){let n=t.Tn-e.Tn;return n!==0?n:(n=ZE(t.En,e.En),n!==0?n:(n=ZE(t.dn,e.dn),n!==0?n:ee.comparator(t.In,e.In)))}function ZE(t,e){for(let n=0;n<t.length&&n<e.length;++n){const r=t[n]-e[n];if(r!==0)return r}return t.length-e.length}function sd(t){return Zx()?function(n){let r="";for(let s=0;s<n.length;s++)r+=String.fromCharCode(n[s]);return r}(t):t}function eI(t){return typeof t!="string"?t:function(n){const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}(t)}class tI{constructor(e){this.mn=new Ze((n,r)=>gt.comparator(n.field,r.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.fn=e.orderBy,this.gn=[];for(const n of e.filters){const r=n;r.isInequality()?this.mn=this.mn.add(r):this.gn.push(r)}}get pn(){return this.mn.size>1}yn(e){if(le(e.collectionGroup===this.collectionId,49279),this.pn)return!1;const n=Vm(e);if(n!==void 0&&!this.wn(n))return!1;const r=mi(e);let s=new Set,i=0,o=0;for(;i<r.length&&this.wn(r[i]);++i)s=s.add(r[i].fieldPath.canonicalString());if(i===r.length)return!0;if(this.mn.size>0){const a=this.mn.getIterator().getNext();if(!s.has(a.field.canonicalString())){const l=r[i];if(!this.Sn(a,l)||!this.bn(this.fn[o++],l))return!1}++i}for(;i<r.length;++i){const a=r[i];if(o>=this.fn.length||!this.bn(this.fn[o++],a))return!1}return!0}Dn(){if(this.pn)return null;let e=new Ze(gt.comparator);const n=[];for(const r of this.gn)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")n.push(new Yu(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),n.push(new Yu(r.field,0))}for(const r of this.fn)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),n.push(new Yu(r.field,r.dir==="asc"?0:1)));return new $d($d.UNKNOWN_ID,this.collectionId,n,cc.empty())}wn(e){for(const n of this.gn)if(this.Sn(n,e))return!0;return!1}Sn(e,n){if(e===void 0||!e.field.isEqual(n.fieldPath))return!1;const r=e.op==="array-contains"||e.op==="array-contains-any";return n.kind===2===r}bn(e,n){return!!e.field.isEqual(n.fieldPath)&&(n.kind===0&&e.dir==="asc"||n.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oC(t){var n,r;if(le(t instanceof Oe||t instanceof Xe,20012),t instanceof Oe){if(t instanceof Ab){const s=((r=(n=t.value.arrayValue)==null?void 0:n.values)==null?void 0:r.map(i=>Oe.create(t.field,"==",i)))||[];return Xe.create(s,"or")}return t}const e=t.filters.map(s=>oC(s));return Xe.create(e,t.op)}function $V(t){if(t.getFilters().length===0)return[];const e=Zm(oC(t));return le(aC(e),7391),Xm(e)||Jm(e)?[e]:e.getFilters()}function Xm(t){return t instanceof Oe}function Jm(t){return t instanceof Xe&&Dy(t)}function aC(t){return Xm(t)||Jm(t)||function(n){if(n instanceof Xe&&zm(n)){for(const r of n.getFilters())if(!Xm(r)&&!Jm(r))return!1;return!0}return!1}(t)}function Zm(t){if(le(t instanceof Oe||t instanceof Xe,34018),t instanceof Oe)return t;if(t.filters.length===1)return Zm(t.filters[0]);const e=t.filters.map(r=>Zm(r));let n=Xe.create(e,t.op);return n=Jd(n),aC(n)?n:(le(n instanceof Xe,64498),le(ya(n),40251),le(n.filters.length>1,57927),n.filters.reduce((r,s)=>By(r,s)))}function By(t,e){let n;return le(t instanceof Oe||t instanceof Xe,38388),le(e instanceof Oe||e instanceof Xe,25473),n=t instanceof Oe?e instanceof Oe?function(s,i){return Xe.create([s,i],"and")}(t,e):nI(t,e):e instanceof Oe?nI(e,t):function(s,i){if(le(s.filters.length>0&&i.filters.length>0,48005),ya(s)&&ya(i))return Sb(s,i.getFilters());const o=zm(s)?s:i,a=zm(s)?i:s,l=o.filters.map(d=>By(d,a));return Xe.create(l,"or")}(t,e),Jd(n)}function nI(t,e){if(ya(e))return Sb(e,t.getFilters());{const n=e.filters.map(r=>By(t,r));return Xe.create(n,"or")}}function Jd(t){if(le(t instanceof Oe||t instanceof Xe,11850),t instanceof Oe)return t;const e=t.getFilters();if(e.length===1)return Jd(e[0]);if(Tb(t))return t;const n=e.map(s=>Jd(s)),r=[];return n.forEach(s=>{s instanceof Oe?r.push(s):s instanceof Xe&&(s.op===t.op?r.push(...s.filters):r.push(s))}),r.length===1?r[0]:Xe.create(r,t.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BV{constructor(){this.Cn=new zy}addToCollectionParentIndex(e,n){return this.Cn.add(n),O.resolve()}getCollectionParents(e,n){return O.resolve(this.Cn.getEntries(n))}addFieldIndex(e,n){return O.resolve()}deleteFieldIndex(e,n){return O.resolve()}deleteAllFieldIndexes(e){return O.resolve()}createTargetIndexes(e,n){return O.resolve()}getDocumentsMatchingTarget(e,n){return O.resolve(null)}getIndexType(e,n){return O.resolve(0)}getFieldIndexes(e,n){return O.resolve([])}getNextCollectionGroupToUpdate(e){return O.resolve(null)}getMinOffset(e,n){return O.resolve(On.min())}getMinOffsetFromCollectionGroup(e,n){return O.resolve(On.min())}updateCollectionGroup(e,n,r){return O.resolve()}updateIndexEntries(e,n){return O.resolve()}}class zy{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n]||new Ze(He.comparator),i=!s.has(r);return this.index[n]=s.add(r),i}has(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n];return s&&s.has(r)}getEntries(e){return(this.index[e]||new Ze(He.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rI="IndexedDbIndexManager",Iu=new Uint8Array(0);class zV{constructor(e,n){this.databaseId=n,this.vn=new zy,this.Fn=new ns(r=>Hi(r),(r,s)=>Dc(r,s)),this.uid=e.uid||""}addToCollectionParentIndex(e,n){if(!this.vn.has(n)){const r=n.lastSegment(),s=n.popLast();e.addOnCommittedListener(()=>{this.vn.add(n)});const i={collectionId:r,parent:an(s)};return sI(e).put(i)}return O.resolve()}getCollectionParents(e,n){const r=[],s=IDBKeyRange.bound([n,""],[QS(n),""],!1,!0);return sI(e).J(s).next(i=>{for(const o of i){if(o.collectionId!==n)break;r.push(xr(o.parent))}return r})}addFieldIndex(e,n){const r=sl(e),s=function(a){return{indexId:a.indexId,collectionGroup:a.collectionGroup,fields:a.fields.map(l=>[l.fieldPath.canonicalString(),l.kind])}}(n);delete s.indexId;const i=r.add(s);if(n.indexState){const o=go(e);return i.next(a=>{o.put(QE(a,this.uid,n.indexState.sequenceNumber,n.indexState.offset))})}return i.next()}deleteFieldIndex(e,n){const r=sl(e),s=go(e),i=mo(e);return r.delete(n.indexId).next(()=>s.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0))).next(()=>i.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){const n=sl(e),r=mo(e),s=go(e);return n.Z().next(()=>r.Z()).next(()=>s.Z())}createTargetIndexes(e,n){return O.forEach(this.Mn(n),r=>this.getIndexType(e,r).next(s=>{if(s===0||s===1){const i=new tI(r).Dn();if(i!=null)return this.addFieldIndex(e,i)}}))}getDocumentsMatchingTarget(e,n){const r=mo(e);let s=!0;const i=new Map;return O.forEach(this.Mn(n),o=>this.xn(e,o).next(a=>{s&&(s=!!a),i.set(o,a)})).next(()=>{if(s){let o=Ce();const a=[];return O.forEach(i,(l,d)=>{W(rI,`Using index ${function(y){return`id=${y.indexId}|cg=${y.collectionGroup}|f=${y.fields.map(j=>`${j.fieldPath}:${j.kind}`).join(",")}`}(l)} to execute ${Hi(n)}`);const h=function(y,j){const V=Vm(j);if(V===void 0)return null;for(const M of Kd(y,V.fieldPath))switch(M.op){case"array-contains-any":return M.value.arrayValue.values||[];case"array-contains":return[M.value]}return null}(d,l),f=function(y,j){const V=new Map;for(const M of mi(j))for(const x of Kd(y,M.fieldPath))switch(x.op){case"==":case"in":V.set(M.fieldPath.canonicalString(),x.value);break;case"not-in":case"!=":return V.set(M.fieldPath.canonicalString(),x.value),Array.from(V.values())}return null}(d,l),m=function(y,j){const V=[];let M=!0;for(const x of mi(j)){const _=x.kind===0?OE(y,x.fieldPath,y.startAt):VE(y,x.fieldPath,y.startAt);V.push(_.value),M&&(M=_.inclusive)}return new Gs(V,M)}(d,l),w=function(y,j){const V=[];let M=!0;for(const x of mi(j)){const _=x.kind===0?VE(y,x.fieldPath,y.endAt):OE(y,x.fieldPath,y.endAt);V.push(_.value),M&&(M=_.inclusive)}return new Gs(V,M)}(d,l),R=this.On(l,d,m),b=this.On(l,d,w),A=this.Nn(l,d,f),T=this.Bn(l.indexId,h,R,m.inclusive,b,w.inclusive,A);return O.forEach(T,E=>r.Y(E,n.limit).next(y=>{y.forEach(j=>{const V=ee.fromSegments(j.documentKey);o.has(V)||(o=o.add(V),a.push(V))})}))}).next(()=>a)}return O.resolve(null)})}Mn(e){let n=this.Fn.get(e);return n||(e.filters.length===0?n=[e]:n=$V(Xe.create(e.filters,"and")).map(r=>Hm(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.Fn.set(e,n),n)}Bn(e,n,r,s,i,o,a){const l=(n!=null?n.length:1)*Math.max(r.length,i.length),d=l/(n!=null?n.length:1),h=[];for(let f=0;f<l;++f){const m=n?this.Ln(n[f/d]):Iu,w=this.kn(e,m,r[f%d],s),R=this.qn(e,m,i[f%d],o),b=a.map(A=>this.kn(e,m,A,!0));h.push(...this.createRange(w,R,b))}return h}kn(e,n,r,s){const i=new wi(e,ee.empty(),n,r);return s?i:i.An()}qn(e,n,r,s){const i=new wi(e,ee.empty(),n,r);return s?i.An():i}xn(e,n){const r=new tI(n),s=n.collectionGroup!=null?n.collectionGroup:n.path.lastSegment();return this.getFieldIndexes(e,s).next(i=>{let o=null;for(const a of i)r.yn(a)&&(!o||a.fields.length>o.fields.length)&&(o=a);return o})}getIndexType(e,n){let r=2;const s=this.Mn(n);return O.forEach(s,i=>this.xn(e,i).next(o=>{o?r!==0&&o.fields.length<function(l){let d=new Ze(gt.comparator),h=!1;for(const f of l.filters)for(const m of f.getFlattenedFilters())m.field.isKeyField()||(m.op==="array-contains"||m.op==="array-contains-any"?h=!0:d=d.add(m.field));for(const f of l.orderBy)f.field.isKeyField()||(d=d.add(f.field));return d.size+(h?1:0)}(i)&&(r=1):r=0})).next(()=>function(o){return o.limit!==null}(n)&&s.length>1&&r===2?1:r)}Qn(e,n){const r=new rl;for(const s of mi(e)){const i=n.data.field(s.fieldPath);if(i==null)return null;const o=r.Pn(s.kind);vi.Kt.Dt(i,o)}return r.un()}Ln(e){const n=new rl;return vi.Kt.Dt(e,n.Pn(0)),n.un()}$n(e,n){const r=new rl;return vi.Kt.Dt(qi(this.databaseId,n),r.Pn(function(i){const o=mi(i);return o.length===0?0:o[o.length-1].kind}(e))),r.un()}Nn(e,n,r){if(r===null)return[];let s=[];s.push(new rl);let i=0;for(const o of mi(e)){const a=r[i++];for(const l of s)if(this.Un(n,o.fieldPath)&&gc(a))s=this.Kn(s,o,a);else{const d=l.Pn(o.kind);vi.Kt.Dt(a,d)}}return this.Wn(s)}On(e,n,r){return this.Nn(e,n,r.position)}Wn(e){const n=[];for(let r=0;r<e.length;++r)n[r]=e[r].un();return n}Kn(e,n,r){const s=[...e],i=[];for(const o of r.arrayValue.values||[])for(const a of s){const l=new rl;l.seed(a.un()),vi.Kt.Dt(o,l.Pn(n.kind)),i.push(l)}return i}Un(e,n){return!!e.filters.find(r=>r instanceof Oe&&r.field.isEqual(n)&&(r.op==="in"||r.op==="not-in"))}getFieldIndexes(e,n){const r=sl(e),s=go(e);return(n?r.J(Mm,IDBKeyRange.bound(n,n)):r.J()).next(i=>{const o=[];return O.forEach(i,a=>s.get([a.indexId,this.uid]).next(l=>{o.push(function(h,f){const m=f?new cc(f.sequenceNumber,new On(Gi(f.readTime),new ee(xr(f.documentKey)),f.largestBatchId)):cc.empty(),w=h.fields.map(([R,b])=>new Yu(gt.fromServerFormat(R),b));return new $d(h.indexId,h.collectionGroup,w,m)}(a,l))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(n=>n.length===0?null:(n.sort((r,s)=>{const i=r.indexState.sequenceNumber-s.indexState.sequenceNumber;return i!==0?i:Ie(r.collectionGroup,s.collectionGroup)}),n[0].collectionGroup))}updateCollectionGroup(e,n,r){const s=sl(e),i=go(e);return this.Gn(e).next(o=>s.J(Mm,IDBKeyRange.bound(n,n)).next(a=>O.forEach(a,l=>i.put(QE(l.indexId,this.uid,o,r)))))}updateIndexEntries(e,n){const r=new Map;return O.forEach(n,(s,i)=>{const o=r.get(s.collectionGroup);return(o?O.resolve(o):this.getFieldIndexes(e,s.collectionGroup)).next(a=>(r.set(s.collectionGroup,a),O.forEach(a,l=>this.zn(e,s,l).next(d=>{const h=this.jn(i,l);return d.isEqual(h)?O.resolve():this.Jn(e,i,l,d,h)}))))})}Hn(e,n,r,s){return mo(e).put(s.Rn(this.uid,this.$n(r,n.key),n.key))}Yn(e,n,r,s){return mo(e).delete(s.Vn(this.uid,this.$n(r,n.key),n.key))}zn(e,n,r){const s=mo(e);let i=new Ze(fs);return s.ee({index:ob,range:IDBKeyRange.only([r.indexId,this.uid,sd(this.$n(r,n))])},(o,a)=>{i=i.add(new wi(r.indexId,n,eI(a.arrayValue),eI(a.directionalValue)))}).next(()=>i)}jn(e,n){let r=new Ze(fs);const s=this.Qn(n,e);if(s==null)return r;const i=Vm(n);if(i!=null){const o=e.data.field(i.fieldPath);if(gc(o))for(const a of o.arrayValue.values||[])r=r.add(new wi(n.indexId,e.key,this.Ln(a),s))}else r=r.add(new wi(n.indexId,e.key,Iu,s));return r}Jn(e,n,r,s,i){W(rI,"Updating index entries for document '%s'",n.key);const o=[];return function(l,d,h,f,m){const w=l.getIterator(),R=d.getIterator();let b=fo(w),A=fo(R);for(;b||A;){let T=!1,E=!1;if(b&&A){const y=h(b,A);y<0?E=!0:y>0&&(T=!0)}else b!=null?E=!0:T=!0;T?(f(A),A=fo(R)):E?(m(b),b=fo(w)):(b=fo(w),A=fo(R))}}(s,i,fs,a=>{o.push(this.Hn(e,n,r,a))},a=>{o.push(this.Yn(e,n,r,a))}),O.waitFor(o)}Gn(e){let n=1;return go(e).ee({index:ib,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,s,i)=>{i.done(),n=s.sequenceNumber+1}).next(()=>n)}createRange(e,n,r){r=r.sort((o,a)=>fs(o,a)).filter((o,a,l)=>!a||fs(o,l[a-1])!==0);const s=[];s.push(e);for(const o of r){const a=fs(o,e),l=fs(o,n);if(a===0)s[0]=e.An();else if(a>0&&l<0)s.push(o),s.push(o.An());else if(l>0)break}s.push(n);const i=[];for(let o=0;o<s.length;o+=2){if(this.Zn(s[o],s[o+1]))return[];const a=s[o].Vn(this.uid,Iu,ee.empty()),l=s[o+1].Vn(this.uid,Iu,ee.empty());i.push(IDBKeyRange.bound(a,l))}return i}Zn(e,n){return fs(e,n)>0}getMinOffsetFromCollectionGroup(e,n){return this.getFieldIndexes(e,n).next(iI)}getMinOffset(e,n){return O.mapArray(this.Mn(n),r=>this.xn(e,r).next(s=>s||oe(44426))).next(iI)}}function sI(t){return Vt(t,fc)}function mo(t){return Vt(t,Vl)}function sl(t){return Vt(t,Ay)}function go(t){return Vt(t,Ol)}function iI(t){le(t.length!==0,28825);let e=t[0].indexState.offset,n=e.largestBatchId;for(let r=1;r<t.length;r++){const s=t[r].indexState.offset;Sy(s,e)<0&&(e=s),n<s.largestBatchId&&(n=s.largestBatchId)}return new On(e.readTime,e.documentKey,n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oI={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},lC=41943040;class tn{static withCacheSize(e){return new tn(e,tn.DEFAULT_COLLECTION_PERCENTILE,tn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cC(t,e,n){const r=t.store(tr),s=t.store(da),i=[],o=IDBKeyRange.only(n.batchId);let a=0;const l=r.ee({range:o},(h,f,m)=>(a++,m.delete()));i.push(l.next(()=>{le(a===1,47070,{batchId:n.batchId})}));const d=[];for(const h of n.mutations){const f=nb(e,h.key.path,n.batchId);i.push(s.delete(f)),d.push(h.key)}return O.waitFor(i).next(()=>d)}function Zd(t){if(!t)return 0;let e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw oe(14731);e=t.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */tn.DEFAULT_COLLECTION_PERCENTILE=10,tn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,tn.DEFAULT=new tn(lC,tn.DEFAULT_COLLECTION_PERCENTILE,tn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),tn.DISABLED=new tn(-1,0,0);class Xh{constructor(e,n,r,s){this.userId=e,this.serializer=n,this.indexManager=r,this.referenceDelegate=s,this.Xn={}}static wt(e,n,r,s){le(e.uid!=="",64387);const i=e.isAuthenticated()?e.uid:"";return new Xh(i,n,r,s)}checkEmpty(e){let n=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return ps(e).ee({index:Si,range:r},(s,i,o)=>{n=!1,o.done()}).next(()=>n)}addMutationBatch(e,n,r,s){const i=Ao(e),o=ps(e);return o.add({}).next(a=>{le(typeof a=="number",49019);const l=new Vy(a,n,r,s),d=function(w,R,b){const A=b.baseMutations.map(E=>Yd(w.yt,E)),T=b.mutations.map(E=>Yd(w.yt,E));return{userId:R,batchId:b.batchId,localWriteTimeMs:b.localWriteTime.toMillis(),baseMutations:A,mutations:T}}(this.serializer,this.userId,l),h=[];let f=new Ze((m,w)=>Ie(m.canonicalString(),w.canonicalString()));for(const m of s){const w=nb(this.userId,m.key.path,a);f=f.add(m.key.path.popLast()),h.push(o.put(d)),h.push(i.put(w,gO))}return f.forEach(m=>{h.push(this.indexManager.addToCollectionParentIndex(e,m))}),e.addOnCommittedListener(()=>{this.Xn[a]=l.keys()}),O.waitFor(h).next(()=>l)})}lookupMutationBatch(e,n){return ps(e).get(n).next(r=>r?(le(r.userId===this.userId,48,"Unexpected user for mutation batch",{userId:r.userId,batchId:n}),_i(this.serializer,r)):null)}er(e,n){return this.Xn[n]?O.resolve(this.Xn[n]):this.lookupMutationBatch(e,n).next(r=>{if(r){const s=r.keys();return this.Xn[n]=s,s}return null})}getNextMutationBatchAfterBatchId(e,n){const r=n+1,s=IDBKeyRange.lowerBound([this.userId,r]);let i=null;return ps(e).ee({index:Si,range:s},(o,a,l)=>{a.userId===this.userId&&(le(a.batchId>=r,47524,{tr:r}),i=_i(this.serializer,a)),l.done()}).next(()=>i)}getHighestUnacknowledgedBatchId(e){const n=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=Ri;return ps(e).ee({index:Si,range:n,reverse:!0},(s,i,o)=>{r=i.batchId,o.done()}).next(()=>r)}getAllMutationBatches(e){const n=IDBKeyRange.bound([this.userId,Ri],[this.userId,Number.POSITIVE_INFINITY]);return ps(e).J(Si,n).next(r=>r.map(s=>_i(this.serializer,s)))}getAllMutationBatchesAffectingDocumentKey(e,n){const r=Xu(this.userId,n.path),s=IDBKeyRange.lowerBound(r),i=[];return Ao(e).ee({range:s},(o,a,l)=>{const[d,h,f]=o,m=xr(h);if(d===this.userId&&n.path.isEqual(m))return ps(e).get(f).next(w=>{if(!w)throw oe(61480,{nr:o,batchId:f});le(w.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:w.userId,batchId:f}),i.push(_i(this.serializer,w))});l.done()}).next(()=>i)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Ze(Ie);const s=[];return n.forEach(i=>{const o=Xu(this.userId,i.path),a=IDBKeyRange.lowerBound(o),l=Ao(e).ee({range:a},(d,h,f)=>{const[m,w,R]=d,b=xr(w);m===this.userId&&i.path.isEqual(b)?r=r.add(R):f.done()});s.push(l)}),O.waitFor(s).next(()=>this.rr(e,r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,s=r.length+1,i=Xu(this.userId,r),o=IDBKeyRange.lowerBound(i);let a=new Ze(Ie);return Ao(e).ee({range:o},(l,d,h)=>{const[f,m,w]=l,R=xr(m);f===this.userId&&r.isPrefixOf(R)?R.length===s&&(a=a.add(w)):h.done()}).next(()=>this.rr(e,a))}rr(e,n){const r=[],s=[];return n.forEach(i=>{s.push(ps(e).get(i).next(o=>{if(o===null)throw oe(35274,{batchId:i});le(o.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:o.userId,batchId:i}),r.push(_i(this.serializer,o))}))}),O.waitFor(s).next(()=>r)}removeMutationBatch(e,n){return cC(e.le,this.userId,n).next(r=>(e.addOnCommittedListener(()=>{this.ir(n.batchId)}),O.forEach(r,s=>this.referenceDelegate.markPotentiallyOrphaned(e,s))))}ir(e){delete this.Xn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(n=>{if(!n)return O.resolve();const r=IDBKeyRange.lowerBound(function(o){return[o]}(this.userId)),s=[];return Ao(e).ee({range:r},(i,o,a)=>{if(i[0]===this.userId){const l=xr(i[1]);s.push(l)}else a.done()}).next(()=>{le(s.length===0,56720,{sr:s.map(i=>i.canonicalString())})})})}containsKey(e,n){return uC(e,this.userId,n)}_r(e){return dC(e).get(this.userId).next(n=>n||{userId:this.userId,lastAcknowledgedBatchId:Ri,lastStreamToken:""})}}function uC(t,e,n){const r=Xu(e,n.path),s=r[1],i=IDBKeyRange.lowerBound(r);let o=!1;return Ao(t).ee({range:i,X:!0},(a,l,d)=>{const[h,f,m]=a;h===e&&f===s&&(o=!0),d.done()}).next(()=>o)}function ps(t){return Vt(t,tr)}function Ao(t){return Vt(t,da)}function dC(t){return Vt(t,dc)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qi{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new Qi(0)}static cr(){return new Qi(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qV{constructor(e,n){this.referenceDelegate=e,this.serializer=n}allocateTargetId(e){return this.lr(e).next(n=>{const r=new Qi(n.highestTargetId);return n.highestTargetId=r.next(),this.hr(e,n).next(()=>n.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.lr(e).next(n=>fe.fromTimestamp(new $e(n.lastRemoteSnapshotVersion.seconds,n.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.lr(e).next(n=>n.highestListenSequenceNumber)}setTargetsMetadata(e,n,r){return this.lr(e).next(s=>(s.highestListenSequenceNumber=n,r&&(s.lastRemoteSnapshotVersion=r.toTimestamp()),n>s.highestListenSequenceNumber&&(s.highestListenSequenceNumber=n),this.hr(e,s)))}addTargetData(e,n){return this.Pr(e,n).next(()=>this.lr(e).next(r=>(r.targetCount+=1,this.Tr(n,r),this.hr(e,r))))}updateTargetData(e,n){return this.Pr(e,n)}removeTargetData(e,n){return this.removeMatchingKeysForTargetId(e,n.targetId).next(()=>yo(e).delete(n.targetId)).next(()=>this.lr(e)).next(r=>(le(r.targetCount>0,8065),r.targetCount-=1,this.hr(e,r)))}removeTargets(e,n,r){let s=0;const i=[];return yo(e).ee((o,a)=>{const l=_l(a);l.sequenceNumber<=n&&r.get(l.targetId)===null&&(s++,i.push(this.removeTargetData(e,l)))}).next(()=>O.waitFor(i)).next(()=>s)}forEachTarget(e,n){return yo(e).ee((r,s)=>{const i=_l(s);n(i)})}lr(e){return aI(e).get(qd).next(n=>(le(n!==null,2888),n))}hr(e,n){return aI(e).put(qd,n)}Pr(e,n){return yo(e).put(sC(this.serializer,n))}Tr(e,n){let r=!1;return e.targetId>n.highestTargetId&&(n.highestTargetId=e.targetId,r=!0),e.sequenceNumber>n.highestListenSequenceNumber&&(n.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.lr(e).next(n=>n.targetCount)}getTargetData(e,n){const r=Hi(n),s=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let i=null;return yo(e).ee({range:s,index:sb},(o,a,l)=>{const d=_l(a);Dc(n,d.target)&&(i=d,l.done())}).next(()=>i)}addMatchingKeys(e,n,r){const s=[],i=Ss(e);return n.forEach(o=>{const a=an(o.path);s.push(i.put({targetId:r,path:a})),s.push(this.referenceDelegate.addReference(e,r,o))}),O.waitFor(s)}removeMatchingKeys(e,n,r){const s=Ss(e);return O.forEach(n,i=>{const o=an(i.path);return O.waitFor([s.delete([r,o]),this.referenceDelegate.removeReference(e,r,i)])})}removeMatchingKeysForTargetId(e,n){const r=Ss(e),s=IDBKeyRange.bound([n],[n+1],!1,!0);return r.delete(s)}getMatchingKeysForTargetId(e,n){const r=IDBKeyRange.bound([n],[n+1],!1,!0),s=Ss(e);let i=Ce();return s.ee({range:r,X:!0},(o,a,l)=>{const d=xr(o[1]),h=new ee(d);i=i.add(h)}).next(()=>i)}containsKey(e,n){const r=an(n.path),s=IDBKeyRange.bound([r],[QS(r)],!1,!0);let i=0;return Ss(e).ee({index:Cy,X:!0,range:s},([o,a],l,d)=>{o!==0&&(i++,d.done())}).next(()=>i>0)}At(e,n){return yo(e).get(n).next(r=>r?_l(r):null)}}function yo(t){return Vt(t,ha)}function aI(t){return Vt(t,Pi)}function Ss(t){return Vt(t,fa)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lI="LruGarbageCollector",HV=1048576;function cI([t,e],[n,r]){const s=Ie(t,n);return s===0?Ie(e,r):s}class WV{constructor(e){this.Ir=e,this.buffer=new Ze(cI),this.Er=0}dr(){return++this.Er}Ar(e){const n=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(n);else{const r=this.buffer.last();cI(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}}class hC{constructor(e,n,r){this.garbageCollector=e,this.asyncQueue=n,this.localStore=r,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){W(lI,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){ri(n)?W(lI,"Ignoring IndexedDB error during garbage collection: ",n):await io(n)}await this.Vr(3e5)})}}class KV{constructor(e,n){this.mr=e,this.params=n}calculateTargetCount(e,n){return this.mr.gr(e).next(r=>Math.floor(n/100*r))}nthSequenceNumber(e,n){if(n===0)return O.resolve(qn.ce);const r=new WV(n);return this.mr.forEachTarget(e,s=>r.Ar(s.sequenceNumber)).next(()=>this.mr.pr(e,s=>r.Ar(s))).next(()=>r.maxValue)}removeTargets(e,n,r){return this.mr.removeTargets(e,n,r)}removeOrphanedDocuments(e,n){return this.mr.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(W("LruGarbageCollector","Garbage collection skipped; disabled"),O.resolve(oI)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(W("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),oI):this.yr(e,n))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,n){let r,s,i,o,a,l,d;const h=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(f=>(f>this.params.maximumSequenceNumbersToCollect?(W("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${f}`),s=this.params.maximumSequenceNumbersToCollect):s=f,o=Date.now(),this.nthSequenceNumber(e,s))).next(f=>(r=f,a=Date.now(),this.removeTargets(e,r,n))).next(f=>(i=f,l=Date.now(),this.removeOrphanedDocuments(e,r))).next(f=>(d=Date.now(),So()<=je.DEBUG&&W("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-h}ms
	Determined least recently used ${s} in `+(a-o)+`ms
	Removed ${i} targets in `+(l-a)+`ms
	Removed ${f} documents in `+(d-l)+`ms
Total Duration: ${d-h}ms`),O.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:i,documentsRemoved:f})))}}function fC(t,e){return new KV(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GV{constructor(e,n){this.db=e,this.garbageCollector=fC(this,n)}gr(e){const n=this.wr(e);return this.db.getTargetCache().getTargetCount(e).next(r=>n.next(s=>r+s))}wr(e){let n=0;return this.pr(e,r=>{n++}).next(()=>n)}forEachTarget(e,n){return this.db.getTargetCache().forEachTarget(e,n)}pr(e,n){return this.Sr(e,(r,s)=>n(s))}addReference(e,n,r){return Tu(e,r)}removeReference(e,n,r){return Tu(e,r)}removeTargets(e,n,r){return this.db.getTargetCache().removeTargets(e,n,r)}markPotentiallyOrphaned(e,n){return Tu(e,n)}br(e,n){return function(s,i){let o=!1;return dC(s).te(a=>uC(s,a,i).next(l=>(l&&(o=!0),O.resolve(!l)))).next(()=>o)}(e,n)}removeOrphanedDocuments(e,n){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),s=[];let i=0;return this.Sr(e,(o,a)=>{if(a<=n){const l=this.br(e,o).next(d=>{if(!d)return i++,r.getEntry(e,o).next(()=>(r.removeEntry(o,fe.min()),Ss(e).delete(function(f){return[0,an(f.path)]}(o))))});s.push(l)}}).next(()=>O.waitFor(s)).next(()=>r.apply(e)).next(()=>i)}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,n){return Tu(e,n)}Sr(e,n){const r=Ss(e);let s,i=qn.ce;return r.ee({index:Cy},([o,a],{path:l,sequenceNumber:d})=>{o===0?(i!==qn.ce&&n(new ee(xr(s)),i),i=d,s=l):i=qn.ce}).next(()=>{i!==qn.ce&&n(new ee(xr(s)),i)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function Tu(t,e){return Ss(t).put(function(r,s){return{targetId:0,path:an(r.path),sequenceNumber:s}}(e,t.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pC{constructor(){this.changes=new ns(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,Et.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?O.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QV{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,n,r){return ui(e).put(r)}removeEntry(e,n,r){return ui(e).delete(function(i,o){const a=i.path.toArray();return[a.slice(0,a.length-2),a[a.length-2],Xd(o),a[a.length-1]]}(n,r))}updateMetadata(e,n){return this.getMetadata(e).next(r=>(r.byteSize+=n,this.Dr(e,r)))}getEntry(e,n){let r=Et.newInvalidDocument(n);return ui(e).ee({index:Ju,range:IDBKeyRange.only(il(n))},(s,i)=>{r=this.Cr(n,i)}).next(()=>r)}vr(e,n){let r={size:0,document:Et.newInvalidDocument(n)};return ui(e).ee({index:Ju,range:IDBKeyRange.only(il(n))},(s,i)=>{r={document:this.Cr(n,i),size:Zd(i)}}).next(()=>r)}getEntries(e,n){let r=Nn();return this.Fr(e,n,(s,i)=>{const o=this.Cr(s,i);r=r.insert(s,o)}).next(()=>r)}Mr(e,n){let r=Nn(),s=new ht(ee.comparator);return this.Fr(e,n,(i,o)=>{const a=this.Cr(i,o);r=r.insert(i,a),s=s.insert(i,Zd(o))}).next(()=>({documents:r,Or:s}))}Fr(e,n,r){if(n.isEmpty())return O.resolve();let s=new Ze(hI);n.forEach(l=>s=s.add(l));const i=IDBKeyRange.bound(il(s.first()),il(s.last())),o=s.getIterator();let a=o.getNext();return ui(e).ee({index:Ju,range:i},(l,d,h)=>{const f=ee.fromSegments([...d.prefixPath,d.collectionGroup,d.documentId]);for(;a&&hI(a,f)<0;)r(a,null),a=o.getNext();a&&a.isEqual(f)&&(r(a,d),a=o.hasNext()?o.getNext():null),a?h.j(il(a)):h.done()}).next(()=>{for(;a;)r(a,null),a=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,n,r,s,i){const o=n.path,a=[o.popLast().toArray(),o.lastSegment(),Xd(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],l=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return ui(e).J(IDBKeyRange.bound(a,l,!0)).next(d=>{i==null||i.incrementDocumentReadCount(d.length);let h=Nn();for(const f of d){const m=this.Cr(ee.fromSegments(f.prefixPath.concat(f.collectionGroup,f.documentId)),f);m.isFoundDocument()&&(Oc(n,m)||s.has(m.key))&&(h=h.insert(m.key,m))}return h})}getAllFromCollectionGroup(e,n,r,s){let i=Nn();const o=dI(n,r),a=dI(n,On.max());return ui(e).ee({index:rb,range:IDBKeyRange.bound(o,a,!0)},(l,d,h)=>{const f=this.Cr(ee.fromSegments(d.prefixPath.concat(d.collectionGroup,d.documentId)),d);i=i.insert(f.key,f),i.size===s&&h.done()}).next(()=>i)}newChangeBuffer(e){return new YV(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(n=>n.byteSize)}getMetadata(e){return uI(e).get(Lm).next(n=>(le(!!n,20021),n))}Dr(e,n){return uI(e).put(Lm,n)}Cr(e,n){if(n){const r=jV(this.serializer,n);if(!(r.isNoDocument()&&r.version.isEqual(fe.min())))return r}return Et.newInvalidDocument(e)}}function mC(t){return new QV(t)}class YV extends pC{constructor(e,n){super(),this.Nr=e,this.trackRemovals=n,this.Br=new ns(r=>r.toString(),(r,s)=>r.isEqual(s))}applyChanges(e){const n=[];let r=0,s=new Ze((i,o)=>Ie(i.canonicalString(),o.canonicalString()));return this.changes.forEach((i,o)=>{const a=this.Br.get(i);if(n.push(this.Nr.removeEntry(e,i,a.readTime)),o.isValidDocument()){const l=KE(this.Nr.serializer,o);s=s.add(i.path.popLast());const d=Zd(l);r+=d-a.size,n.push(this.Nr.addEntry(e,i,l))}else if(r-=a.size,this.trackRemovals){const l=KE(this.Nr.serializer,o.convertToNoDocument(fe.min()));n.push(this.Nr.addEntry(e,i,l))}}),s.forEach(i=>{n.push(this.Nr.indexManager.addToCollectionParentIndex(e,i))}),n.push(this.Nr.updateMetadata(e,r)),O.waitFor(n)}getFromCache(e,n){return this.Nr.vr(e,n).next(r=>(this.Br.set(n,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,n){return this.Nr.Mr(e,n).next(({documents:r,Or:s})=>(s.forEach((i,o)=>{this.Br.set(i,{size:o,readTime:r.get(i).readTime})}),r))}}function uI(t){return Vt(t,hc)}function ui(t){return Vt(t,zd)}function il(t){const e=t.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function dI(t,e){const n=e.documentKey.path.toArray();return[t,Xd(e.readTime),n.slice(0,n.length-2),n.length>0?n[n.length-1]:""]}function hI(t,e){const n=t.path.toArray(),r=e.path.toArray();let s=0;for(let i=0;i<n.length-2&&i<r.length-2;++i)if(s=Ie(n[i],r[i]),s)return s;return s=Ie(n.length,r.length),s||(s=Ie(n[n.length-2],r[r.length-2]),s||Ie(n[n.length-1],r[r.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XV{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gC{constructor(e,n,r,s){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=s}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(s=>(r=s,this.remoteDocumentCache.getEntry(e,n))).next(s=>(r!==null&&Fl(r.mutation,s,En.empty(),$e.now()),s))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,Ce()).next(()=>r))}getLocalViewOfDocuments(e,n,r=Ce()){const s=Sr();return this.populateOverlays(e,s,n).next(()=>this.computeViews(e,n,s,r).next(i=>{let o=gl();return i.forEach((a,l)=>{o=o.insert(a,l.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){const r=Sr();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,Ce()))}populateOverlays(e,n,r){const s=[];return r.forEach(i=>{n.has(i)||s.push(i)}),this.documentOverlayCache.getOverlays(e,s).next(i=>{i.forEach((o,a)=>{n.set(o,a)})})}computeViews(e,n,r,s){let i=Nn();const o=Ml(),a=function(){return Ml()}();return n.forEach((l,d)=>{const h=r.get(d.key);s.has(d.key)&&(h===void 0||h.mutation instanceof rs)?i=i.insert(d.key,d):h!==void 0?(o.set(d.key,h.mutation.getFieldMask()),Fl(h.mutation,d,h.mutation.getFieldMask(),$e.now())):o.set(d.key,En.empty())}),this.recalculateAndSaveOverlays(e,i).next(l=>(l.forEach((d,h)=>o.set(d,h)),n.forEach((d,h)=>a.set(d,new XV(h,o.get(d)??null))),a))}recalculateAndSaveOverlays(e,n){const r=Ml();let s=new ht((o,a)=>o-a),i=Ce();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(const a of o)a.keys().forEach(l=>{const d=n.get(l);if(d===null)return;let h=r.get(l)||En.empty();h=a.applyToLocalView(d,h),r.set(l,h);const f=(s.get(a.batchId)||Ce()).add(l);s=s.insert(a.batchId,f)})}).next(()=>{const o=[],a=s.getReverseIterator();for(;a.hasNext();){const l=a.getNext(),d=l.key,h=l.value,f=jb();h.forEach(m=>{if(!i.has(m)){const w=$b(n.get(m),r.get(m));w!==null&&f.set(m,w),i=i.add(m)}}),o.push(this.documentOverlayCache.saveOverlays(e,d,f))}return O.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,s){return function(o){return ee.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):jy(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,s):this.getDocumentsMatchingCollectionQuery(e,n,r,s)}getNextDocuments(e,n,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,s).next(i=>{const o=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,s-i.size):O.resolve(Sr());let a=lc,l=i;return o.next(d=>O.forEach(d,(h,f)=>(a<f.largestBatchId&&(a=f.largestBatchId),i.get(h)?O.resolve():this.remoteDocumentCache.getEntry(e,h).next(m=>{l=l.insert(h,m)}))).next(()=>this.populateOverlays(e,d,i)).next(()=>this.computeViews(e,l,d,Ce())).next(h=>({batchId:a,changes:Db(h)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new ee(n)).next(r=>{let s=gl();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s})}getDocumentsMatchingCollectionGroupQuery(e,n,r,s){const i=n.collectionGroup;let o=gl();return this.indexManager.getCollectionParents(e,i).next(a=>O.forEach(a,l=>{const d=function(f,m){return new ii(m,null,f.explicitOrderBy.slice(),f.filters.slice(),f.limit,f.limitType,f.startAt,f.endAt)}(n,l.child(i));return this.getDocumentsMatchingCollectionQuery(e,d,r,s).next(h=>{h.forEach((f,m)=>{o=o.insert(f,m)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,n,r,s){let i;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(o=>(i=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,i,s))).next(o=>{i.forEach((l,d)=>{const h=d.getKey();o.get(h)===null&&(o=o.insert(h,Et.newInvalidDocument(h)))});let a=gl();return o.forEach((l,d)=>{const h=i.get(l);h!==void 0&&Fl(h.mutation,d,En.empty(),$e.now()),Oc(n,d)&&(a=a.insert(l,d))}),a})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JV{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,n){return O.resolve(this.Lr.get(n))}saveBundleMetadata(e,n){return this.Lr.set(n.id,function(s){return{id:s.id,version:s.version,createTime:pn(s.createTime)}}(n)),O.resolve()}getNamedQuery(e,n){return O.resolve(this.kr.get(n))}saveNamedQuery(e,n){return this.kr.set(n.name,function(s){return{name:s.name,query:iC(s.bundledQuery),readTime:pn(s.readTime)}}(n)),O.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZV{constructor(){this.overlays=new ht(ee.comparator),this.qr=new Map}getOverlay(e,n){return O.resolve(this.overlays.get(n))}getOverlays(e,n){const r=Sr();return O.forEach(n,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((s,i)=>{this.St(e,n,i)}),O.resolve()}removeOverlaysForBatchId(e,n,r){const s=this.qr.get(r);return s!==void 0&&(s.forEach(i=>this.overlays=this.overlays.remove(i)),this.qr.delete(r)),O.resolve()}getOverlaysForCollection(e,n,r){const s=Sr(),i=n.length+1,o=new ee(n.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const l=a.getNext().value,d=l.getKey();if(!n.isPrefixOf(d.path))break;d.path.length===i&&l.largestBatchId>r&&s.set(l.getKey(),l)}return O.resolve(s)}getOverlaysForCollectionGroup(e,n,r,s){let i=new ht((d,h)=>d-h);const o=this.overlays.getIterator();for(;o.hasNext();){const d=o.getNext().value;if(d.getKey().getCollectionGroup()===n&&d.largestBatchId>r){let h=i.get(d.largestBatchId);h===null&&(h=Sr(),i=i.insert(d.largestBatchId,h)),h.set(d.getKey(),d)}}const a=Sr(),l=i.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((d,h)=>a.set(d,h)),!(a.size()>=s)););return O.resolve(a)}St(e,n,r){const s=this.overlays.get(r.key);if(s!==null){const o=this.qr.get(s.largestBatchId).delete(r.key);this.qr.set(s.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new My(n,r));let i=this.qr.get(n);i===void 0&&(i=Ce(),this.qr.set(n,i)),this.qr.set(n,i.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eL{constructor(){this.sessionToken=Pt.EMPTY_BYTE_STRING}getSessionToken(e){return O.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,O.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qy{constructor(){this.Qr=new Ze(Ut.$r),this.Ur=new Ze(Ut.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,n){const r=new Ut(e,n);this.Qr=this.Qr.add(r),this.Ur=this.Ur.add(r)}Wr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Gr(new Ut(e,n))}zr(e,n){e.forEach(r=>this.removeReference(r,n))}jr(e){const n=new ee(new He([])),r=new Ut(n,e),s=new Ut(n,e+1),i=[];return this.Ur.forEachInRange([r,s],o=>{this.Gr(o),i.push(o.key)}),i}Jr(){this.Qr.forEach(e=>this.Gr(e))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const n=new ee(new He([])),r=new Ut(n,e),s=new Ut(n,e+1);let i=Ce();return this.Ur.forEachInRange([r,s],o=>{i=i.add(o.key)}),i}containsKey(e){const n=new Ut(e,0),r=this.Qr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class Ut{constructor(e,n){this.key=e,this.Yr=n}static $r(e,n){return ee.comparator(e.key,n.key)||Ie(e.Yr,n.Yr)}static Kr(e,n){return Ie(e.Yr,n.Yr)||ee.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tL{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.tr=1,this.Zr=new Ze(Ut.$r)}checkEmpty(e){return O.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,s){const i=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new Vy(i,n,r,s);this.mutationQueue.push(o);for(const a of s)this.Zr=this.Zr.add(new Ut(a.key,i)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return O.resolve(o)}lookupMutationBatch(e,n){return O.resolve(this.Xr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,s=this.ei(r),i=s<0?0:s;return O.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return O.resolve(this.mutationQueue.length===0?Ri:this.tr-1)}getAllMutationBatches(e){return O.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new Ut(n,0),s=new Ut(n,Number.POSITIVE_INFINITY),i=[];return this.Zr.forEachInRange([r,s],o=>{const a=this.Xr(o.Yr);i.push(a)}),O.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Ze(Ie);return n.forEach(s=>{const i=new Ut(s,0),o=new Ut(s,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([i,o],a=>{r=r.add(a.Yr)})}),O.resolve(this.ti(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,s=r.length+1;let i=r;ee.isDocumentKey(i)||(i=i.child(""));const o=new Ut(new ee(i),0);let a=new Ze(Ie);return this.Zr.forEachWhile(l=>{const d=l.key.path;return!!r.isPrefixOf(d)&&(d.length===s&&(a=a.add(l.Yr)),!0)},o),O.resolve(this.ti(a))}ti(e){const n=[];return e.forEach(r=>{const s=this.Xr(r);s!==null&&n.push(s)}),n}removeMutationBatch(e,n){le(this.ni(n.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Zr;return O.forEach(n.mutations,s=>{const i=new Ut(s.key,n.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.Zr=r})}ir(e){}containsKey(e,n){const r=new Ut(n,0),s=this.Zr.firstAfterOrEqual(r);return O.resolve(n.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,O.resolve()}ni(e,n){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const n=this.ei(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nL{constructor(e){this.ri=e,this.docs=function(){return new ht(ee.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,s=this.docs.get(r),i=s?s.size:0,o=this.ri(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return O.resolve(r?r.document.mutableCopy():Et.newInvalidDocument(n))}getEntries(e,n){let r=Nn();return n.forEach(s=>{const i=this.docs.get(s);r=r.insert(s,i?i.document.mutableCopy():Et.newInvalidDocument(s))}),O.resolve(r)}getDocumentsMatchingQuery(e,n,r,s){let i=Nn();const o=n.path,a=new ee(o.child("__id-9223372036854775808__")),l=this.docs.getIteratorFrom(a);for(;l.hasNext();){const{key:d,value:{document:h}}=l.getNext();if(!o.isPrefixOf(d.path))break;d.path.length>o.length+1||Sy(JS(h),r)<=0||(s.has(h.key)||Oc(n,h))&&(i=i.insert(h.key,h.mutableCopy()))}return O.resolve(i)}getAllFromCollectionGroup(e,n,r,s){oe(9500)}ii(e,n){return O.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new rL(this)}getSize(e){return O.resolve(this.size)}}class rL extends pC{constructor(e){super(),this.Nr=e}applyChanges(e){const n=[];return this.changes.forEach((r,s)=>{s.isValidDocument()?n.push(this.Nr.addEntry(e,s)):this.Nr.removeEntry(r)}),O.waitFor(n)}getFromCache(e,n){return this.Nr.getEntry(e,n)}getAllFromCache(e,n){return this.Nr.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sL{constructor(e){this.persistence=e,this.si=new ns(n=>Hi(n),Dc),this.lastRemoteSnapshotVersion=fe.min(),this.highestTargetId=0,this.oi=0,this._i=new qy,this.targetCount=0,this.ai=Qi.ur()}forEachTarget(e,n){return this.si.forEach((r,s)=>n(s)),O.resolve()}getLastRemoteSnapshotVersion(e){return O.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return O.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),O.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.oi&&(this.oi=n),O.resolve()}Pr(e){this.si.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.ai=new Qi(n),this.highestTargetId=n),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,n){return this.Pr(n),this.targetCount+=1,O.resolve()}updateTargetData(e,n){return this.Pr(n),O.resolve()}removeTargetData(e,n){return this.si.delete(n.target),this._i.jr(n.targetId),this.targetCount-=1,O.resolve()}removeTargets(e,n,r){let s=0;const i=[];return this.si.forEach((o,a)=>{a.sequenceNumber<=n&&r.get(a.targetId)===null&&(this.si.delete(o),i.push(this.removeMatchingKeysForTargetId(e,a.targetId)),s++)}),O.waitFor(i).next(()=>s)}getTargetCount(e){return O.resolve(this.targetCount)}getTargetData(e,n){const r=this.si.get(n)||null;return O.resolve(r)}addMatchingKeys(e,n,r){return this._i.Wr(n,r),O.resolve()}removeMatchingKeys(e,n,r){this._i.zr(n,r);const s=this.persistence.referenceDelegate,i=[];return s&&n.forEach(o=>{i.push(s.markPotentiallyOrphaned(e,o))}),O.waitFor(i)}removeMatchingKeysForTargetId(e,n){return this._i.jr(n),O.resolve()}getMatchingKeysForTargetId(e,n){const r=this._i.Hr(n);return O.resolve(r)}containsKey(e,n){return O.resolve(this._i.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hy{constructor(e,n){this.ui={},this.overlays={},this.ci=new qn(0),this.li=!1,this.li=!0,this.hi=new eL,this.referenceDelegate=e(this),this.Pi=new sL(this),this.indexManager=new BV,this.remoteDocumentCache=function(s){return new nL(s)}(r=>this.referenceDelegate.Ti(r)),this.serializer=new rC(n),this.Ii=new JV(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new ZV,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.ui[e.toKey()];return r||(r=new tL(n,this.referenceDelegate),this.ui[e.toKey()]=r),r}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,n,r){W("MemoryPersistence","Starting transaction:",e);const s=new iL(this.ci.next());return this.referenceDelegate.Ei(),r(s).next(i=>this.referenceDelegate.di(s).next(()=>i)).toPromise().then(i=>(s.raiseOnCommittedEvent(),i))}Ai(e,n){return O.or(Object.values(this.ui).map(r=>()=>r.containsKey(e,n)))}}class iL extends eb{constructor(e){super(),this.currentSequenceNumber=e}}class Jh{constructor(e){this.persistence=e,this.Ri=new qy,this.Vi=null}static mi(e){return new Jh(e)}get fi(){if(this.Vi)return this.Vi;throw oe(60996)}addReference(e,n,r){return this.Ri.addReference(r,n),this.fi.delete(r.toString()),O.resolve()}removeReference(e,n,r){return this.Ri.removeReference(r,n),this.fi.add(r.toString()),O.resolve()}markPotentiallyOrphaned(e,n){return this.fi.add(n.toString()),O.resolve()}removeTarget(e,n){this.Ri.jr(n.targetId).forEach(s=>this.fi.add(s.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(s=>{s.forEach(i=>this.fi.add(i.toString()))}).next(()=>r.removeTargetData(e,n))}Ei(){this.Vi=new Set}di(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return O.forEach(this.fi,r=>{const s=ee.fromPath(r);return this.gi(e,s).next(i=>{i||n.removeEntry(s,fe.min())})}).next(()=>(this.Vi=null,n.apply(e)))}updateLimboDocument(e,n){return this.gi(e,n).next(r=>{r?this.fi.delete(n.toString()):this.fi.add(n.toString())})}Ti(e){return 0}gi(e,n){return O.or([()=>O.resolve(this.Ri.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Ai(e,n)])}}class eh{constructor(e,n){this.persistence=e,this.pi=new ns(r=>an(r.path),(r,s)=>r.isEqual(s)),this.garbageCollector=fC(this,n)}static mi(e,n){return new eh(e,n)}Ei(){}di(e){return O.resolve()}forEachTarget(e,n){return this.persistence.getTargetCache().forEachTarget(e,n)}gr(e){const n=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next(r=>n.next(s=>r+s))}wr(e){let n=0;return this.pr(e,r=>{n++}).next(()=>n)}pr(e,n){return O.forEach(this.pi,(r,s)=>this.br(e,r,s).next(i=>i?O.resolve():n(s)))}removeTargets(e,n,r){return this.persistence.getTargetCache().removeTargets(e,n,r)}removeOrphanedDocuments(e,n){let r=0;const s=this.persistence.getRemoteDocumentCache(),i=s.newChangeBuffer();return s.ii(e,o=>this.br(e,o,n).next(a=>{a||(r++,i.removeEntry(o,fe.min()))})).next(()=>i.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,n){return this.pi.set(n,e.currentSequenceNumber),O.resolve()}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,n,r){return this.pi.set(r,e.currentSequenceNumber),O.resolve()}removeReference(e,n,r){return this.pi.set(r,e.currentSequenceNumber),O.resolve()}updateLimboDocument(e,n){return this.pi.set(n,e.currentSequenceNumber),O.resolve()}Ti(e){let n=e.key.toString().length;return e.isFoundDocument()&&(n+=ed(e.data.value)),n}br(e,n,r){return O.or([()=>this.persistence.Ai(e,n),()=>this.persistence.getTargetCache().containsKey(e,n),()=>{const s=this.pi.get(n);return O.resolve(s!==void 0&&s>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oL{constructor(e){this.serializer=e}k(e,n,r,s){const i=new Vh("createOrUpgrade",n);r<1&&s>=1&&(function(l){l.createObjectStore(kc)}(e),function(l){l.createObjectStore(dc,{keyPath:mO}),l.createObjectStore(tr,{keyPath:TE,autoIncrement:!0}).createIndex(Si,xE,{unique:!0}),l.createObjectStore(da)}(e),fI(e),function(l){l.createObjectStore(gi)}(e));let o=O.resolve();return r<3&&s>=3&&(r!==0&&(function(l){l.deleteObjectStore(fa),l.deleteObjectStore(ha),l.deleteObjectStore(Pi)}(e),fI(e)),o=o.next(()=>function(l){const d=l.store(Pi),h={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:fe.min().toTimestamp(),targetCount:0};return d.put(qd,h)}(i))),r<4&&s>=4&&(r!==0&&(o=o.next(()=>function(l,d){return d.store(tr).J().next(f=>{l.deleteObjectStore(tr),l.createObjectStore(tr,{keyPath:TE,autoIncrement:!0}).createIndex(Si,xE,{unique:!0});const m=d.store(tr),w=f.map(R=>m.put(R));return O.waitFor(w)})}(e,i))),o=o.next(()=>{(function(l){l.createObjectStore(pa,{keyPath:xO})})(e)})),r<5&&s>=5&&(o=o.next(()=>this.yi(i))),r<6&&s>=6&&(o=o.next(()=>(function(l){l.createObjectStore(hc)}(e),this.wi(i)))),r<7&&s>=7&&(o=o.next(()=>this.Si(i))),r<8&&s>=8&&(o=o.next(()=>this.bi(e,i))),r<9&&s>=9&&(o=o.next(()=>{(function(l){l.objectStoreNames.contains("remoteDocumentChanges")&&l.deleteObjectStore("remoteDocumentChanges")})(e)})),r<10&&s>=10&&(o=o.next(()=>this.Di(i))),r<11&&s>=11&&(o=o.next(()=>{(function(l){l.createObjectStore(Mh,{keyPath:SO})})(e),function(l){l.createObjectStore(Fh,{keyPath:bO})}(e)})),r<12&&s>=12&&(o=o.next(()=>{(function(l){const d=l.createObjectStore(Uh,{keyPath:DO});d.createIndex(Fm,jO,{unique:!1}),d.createIndex(ab,OO,{unique:!1})})(e)})),r<13&&s>=13&&(o=o.next(()=>function(l){const d=l.createObjectStore(zd,{keyPath:yO});d.createIndex(Ju,_O),d.createIndex(rb,vO)}(e)).next(()=>this.Ci(e,i)).next(()=>e.deleteObjectStore(gi))),r<14&&s>=14&&(o=o.next(()=>this.Fi(e,i))),r<15&&s>=15&&(o=o.next(()=>function(l){l.createObjectStore(Ay,{keyPath:CO,autoIncrement:!0}).createIndex(Mm,AO,{unique:!1}),l.createObjectStore(Ol,{keyPath:RO}).createIndex(ib,PO,{unique:!1}),l.createObjectStore(Vl,{keyPath:NO}).createIndex(ob,kO,{unique:!1})}(e))),r<16&&s>=16&&(o=o.next(()=>{n.objectStore(Ol).clear()}).next(()=>{n.objectStore(Vl).clear()})),r<17&&s>=17&&(o=o.next(()=>{(function(l){l.createObjectStore(Ry,{keyPath:VO})})(e)})),r<18&&s>=18&&Zx()&&(o=o.next(()=>{n.objectStore(Ol).clear()}).next(()=>{n.objectStore(Vl).clear()})),o}wi(e){let n=0;return e.store(gi).ee((r,s)=>{n+=Zd(s)}).next(()=>{const r={byteSize:n};return e.store(hc).put(Lm,r)})}yi(e){const n=e.store(dc),r=e.store(tr);return n.J().next(s=>O.forEach(s,i=>{const o=IDBKeyRange.bound([i.userId,Ri],[i.userId,i.lastAcknowledgedBatchId]);return r.J(Si,o).next(a=>O.forEach(a,l=>{le(l.userId===i.userId,18650,"Cannot process batch from unexpected user",{batchId:l.batchId});const d=_i(this.serializer,l);return cC(e,i.userId,d).next(()=>{})}))}))}Si(e){const n=e.store(fa),r=e.store(gi);return e.store(Pi).get(qd).next(s=>{const i=[];return r.ee((o,a)=>{const l=new He(o),d=function(f){return[0,an(f)]}(l);i.push(n.get(d).next(h=>h?O.resolve():(f=>n.put({targetId:0,path:an(f),sequenceNumber:s.highestListenSequenceNumber}))(l)))}).next(()=>O.waitFor(i))})}bi(e,n){e.createObjectStore(fc,{keyPath:TO});const r=n.store(fc),s=new zy,i=o=>{if(s.add(o)){const a=o.lastSegment(),l=o.popLast();return r.put({collectionId:a,parent:an(l)})}};return n.store(gi).ee({X:!0},(o,a)=>{const l=new He(o);return i(l.popLast())}).next(()=>n.store(da).ee({X:!0},([o,a,l],d)=>{const h=xr(a);return i(h.popLast())}))}Di(e){const n=e.store(ha);return n.ee((r,s)=>{const i=_l(s),o=sC(this.serializer,i);return n.put(o)})}Ci(e,n){const r=n.store(gi),s=[];return r.ee((i,o)=>{const a=n.store(zd),l=function(f){return f.document?new ee(He.fromString(f.document.name).popFirst(5)):f.noDocument?ee.fromSegments(f.noDocument.path):f.unknownDocument?ee.fromSegments(f.unknownDocument.path):oe(36783)}(o).path.toArray(),d={prefixPath:l.slice(0,l.length-2),collectionGroup:l[l.length-2],documentId:l[l.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};s.push(a.put(d))}).next(()=>O.waitFor(s))}Fi(e,n){const r=n.store(tr),s=mC(this.serializer),i=new Hy(Jh.mi,this.serializer.yt);return r.J().next(o=>{const a=new Map;return o.forEach(l=>{let d=a.get(l.userId)??Ce();_i(this.serializer,l).keys().forEach(h=>d=d.add(h)),a.set(l.userId,d)}),O.forEach(a,(l,d)=>{const h=new qt(d),f=Yh.wt(this.serializer,h),m=i.getIndexManager(h),w=Xh.wt(h,this.serializer,m,i.referenceDelegate);return new gC(s,w,f,m).recalculateAndSaveOverlaysForDocumentKeys(new Um(n,qn.ce),l).next()})})}}function fI(t){t.createObjectStore(fa,{keyPath:EO}).createIndex(Cy,IO,{unique:!0}),t.createObjectStore(ha,{keyPath:"targetId"}).createIndex(sb,wO,{unique:!0}),t.createObjectStore(Pi)}const ms="IndexedDbPersistence",fp=18e5,pp=5e3,mp="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",aL="main";class Wy{constructor(e,n,r,s,i,o,a,l,d,h,f=18){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.Mi=i,this.window=o,this.document=a,this.xi=d,this.Oi=h,this.Ni=f,this.ci=null,this.li=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Bi=null,this.inForeground=!1,this.Li=null,this.ki=null,this.qi=Number.NEGATIVE_INFINITY,this.Qi=m=>Promise.resolve(),!Wy.v())throw new G(B.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new GV(this,s),this.$i=n+aL,this.serializer=new rC(l),this.Ui=new Bs(this.$i,this.Ni,new oL(this.serializer)),this.hi=new VV,this.Pi=new qV(this.referenceDelegate,this.serializer),this.remoteDocumentCache=mC(this.serializer),this.Ii=new OV,this.window&&this.window.localStorage?this.Ki=this.window.localStorage:(this.Ki=null,h===!1&&dn(ms,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Wi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new G(B.FAILED_PRECONDITION,mp);return this.Gi(),this.zi(),this.ji(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Pi.getHighestSequenceNumber(e))}).then(e=>{this.ci=new qn(e,this.xi)}).then(()=>{this.li=!0}).catch(e=>(this.Ui&&this.Ui.close(),Promise.reject(e)))}Ji(e){return this.Qi=async n=>{if(this.started)return e(n)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ui.$(async n=>{n.newVersion===null&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Mi.enqueueAndForget(async()=>{this.started&&await this.Wi()}))}Wi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>xu(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.Hi(e).next(n=>{n||(this.isPrimary=!1,this.Mi.enqueueRetryable(()=>this.Qi(!1)))})}).next(()=>this.Yi(e)).next(n=>this.isPrimary&&!n?this.Zi(e).next(()=>!1):!!n&&this.Xi(e).next(()=>!0))).catch(e=>{if(ri(e))return W(ms,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return W(ms,"Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.Mi.enqueueRetryable(()=>this.Qi(e)),this.isPrimary=e})}Hi(e){return ol(e).get(ho).next(n=>O.resolve(this.es(n)))}ts(e){return xu(e).delete(this.clientId)}async ns(){if(this.isPrimary&&!this.rs(this.qi,fp)){this.qi=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",n=>{const r=Vt(n,pa);return r.J().next(s=>{const i=this.ss(s,fp),o=s.filter(a=>i.indexOf(a)===-1);return O.forEach(o,a=>r.delete(a.clientId)).next(()=>o)})}).catch(()=>[]);if(this.Ki)for(const n of e)this.Ki.removeItem(this._s(n.clientId))}}ji(){this.ki=this.Mi.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.Wi().then(()=>this.ns()).then(()=>this.ji()))}es(e){return!!e&&e.ownerId===this.clientId}Yi(e){return this.Oi?O.resolve(!0):ol(e).get(ho).next(n=>{if(n!==null&&this.rs(n.leaseTimestampMs,pp)&&!this.us(n.ownerId)){if(this.es(n)&&this.networkEnabled)return!0;if(!this.es(n)){if(!n.allowTabSynchronization)throw new G(B.FAILED_PRECONDITION,mp);return!1}}return!(!this.networkEnabled||!this.inForeground)||xu(e).J().next(r=>this.ss(r,pp).find(s=>{if(this.clientId!==s.clientId){const i=!this.networkEnabled&&s.networkEnabled,o=!this.inForeground&&s.inForeground,a=this.networkEnabled===s.networkEnabled;if(i||o&&a)return!0}return!1})===void 0)}).next(n=>(this.isPrimary!==n&&W(ms,`Client ${n?"is":"is not"} eligible for a primary lease.`),n))}async shutdown(){this.li=!1,this.cs(),this.ki&&(this.ki.cancel(),this.ki=null),this.ls(),this.hs(),await this.Ui.runTransaction("shutdown","readwrite",[kc,pa],e=>{const n=new Um(e,qn.ce);return this.Zi(n).next(()=>this.ts(n))}),this.Ui.close(),this.Ps()}ss(e,n){return e.filter(r=>this.rs(r.updateTimeMs,n)&&!this.us(r.clientId))}Ts(){return this.runTransaction("getActiveClients","readonly",e=>xu(e).J().next(n=>this.ss(n,fp).map(r=>r.clientId)))}get started(){return this.li}getGlobalsCache(){return this.hi}getMutationQueue(e,n){return Xh.wt(e,this.serializer,n,this.referenceDelegate)}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new zV(e,this.serializer.yt.databaseId)}getDocumentOverlayCache(e){return Yh.wt(this.serializer,e)}getBundleCache(){return this.Ii}runTransaction(e,n,r){W(ms,"Starting transaction:",e);const s=n==="readonly"?"readonly":"readwrite",i=function(l){return l===18?FO:l===17?db:l===16?MO:l===15?Py:l===14?ub:l===13?cb:l===12?LO:l===11?lb:void oe(60245)}(this.Ni);let o;return this.Ui.runTransaction(e,s,i,a=>(o=new Um(a,this.ci?this.ci.next():qn.ce),n==="readwrite-primary"?this.Hi(o).next(l=>!!l||this.Yi(o)).next(l=>{if(!l)throw dn(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Mi.enqueueRetryable(()=>this.Qi(!1)),new G(B.FAILED_PRECONDITION,ZS);return r(o)}).next(l=>this.Xi(o).next(()=>l)):this.Is(o).next(()=>r(o)))).then(a=>(o.raiseOnCommittedEvent(),a))}Is(e){return ol(e).get(ho).next(n=>{if(n!==null&&this.rs(n.leaseTimestampMs,pp)&&!this.us(n.ownerId)&&!this.es(n)&&!(this.Oi||this.allowTabSynchronization&&n.allowTabSynchronization))throw new G(B.FAILED_PRECONDITION,mp)})}Xi(e){const n={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return ol(e).put(ho,n)}static v(){return Bs.v()}Zi(e){const n=ol(e);return n.get(ho).next(r=>this.es(r)?(W(ms,"Releasing primary lease."),n.delete(ho)):O.resolve())}rs(e,n){const r=Date.now();return!(e<r-n)&&(!(e>r)||(dn(`Detected an update time that is in the future: ${e} > ${r}`),!1))}Gi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Li=()=>{this.Mi.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.Wi()))},this.document.addEventListener("visibilitychange",this.Li),this.inForeground=this.document.visibilityState==="visible")}ls(){this.Li&&(this.document.removeEventListener("visibilitychange",this.Li),this.Li=null)}zi(){var e;typeof((e=this.window)==null?void 0:e.addEventListener)=="function"&&(this.Bi=()=>{this.cs();const n=/(?:Version|Mobile)\/1[456]/;Jx()&&(navigator.appVersion.match(n)||navigator.userAgent.match(n))&&this.Mi.enterRestrictedMode(!0),this.Mi.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Bi))}hs(){this.Bi&&(this.window.removeEventListener("pagehide",this.Bi),this.Bi=null)}us(e){var n;try{const r=((n=this.Ki)==null?void 0:n.getItem(this._s(e)))!==null;return W(ms,`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return dn(ms,"Failed to get zombied client id.",r),!1}}cs(){if(this.Ki)try{this.Ki.setItem(this._s(this.clientId),String(Date.now()))}catch(e){dn("Failed to set zombie client id.",e)}}Ps(){if(this.Ki)try{this.Ki.removeItem(this._s(this.clientId))}catch{}}_s(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function ol(t){return Vt(t,kc)}function xu(t){return Vt(t,pa)}function lL(t,e){let n=t.projectId;return t.isDefaultDatabase||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ky{constructor(e,n,r,s){this.targetId=e,this.fromCache=n,this.Es=r,this.ds=s}static As(e,n){let r=Ce(),s=Ce();for(const i of n.docChanges)switch(i.type){case 0:r=r.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new Ky(e,n.fromCache,r,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cL{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yC{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=function(){return Jx()?8:tb(Ot())>0?6:4}()}initialize(e,n){this.ps=e,this.indexManager=n,this.Rs=!0}getDocumentsMatchingQuery(e,n,r,s){const i={result:null};return this.ys(e,n).next(o=>{i.result=o}).next(()=>{if(!i.result)return this.ws(e,n,s,r).next(o=>{i.result=o})}).next(()=>{if(i.result)return;const o=new cL;return this.Ss(e,n,o).next(a=>{if(i.result=a,this.Vs)return this.bs(e,n,o,a.size)})}).next(()=>i.result)}bs(e,n,r,s){return r.documentReadCount<this.fs?(So()<=je.DEBUG&&W("QueryEngine","SDK will not create cache indexes for query:",bo(n),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),O.resolve()):(So()<=je.DEBUG&&W("QueryEngine","Query:",bo(n),"scans",r.documentReadCount,"local documents and returns",s,"documents as results."),r.documentReadCount>this.gs*s?(So()<=je.DEBUG&&W("QueryEngine","The SDK decides to create cache indexes for query:",bo(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Wn(n))):O.resolve())}ys(e,n){if(LE(n))return O.resolve(null);let r=Wn(n);return this.indexManager.getIndexType(e,r).next(s=>s===0?null:(n.limit!==null&&s===1&&(n=Gd(n,null,"F"),r=Wn(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(i=>{const o=Ce(...i);return this.ps.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,r).next(l=>{const d=this.Ds(n,a);return this.Cs(n,d,o,l.readTime)?this.ys(e,Gd(n,null,"F")):this.vs(e,d,n,l)}))})))}ws(e,n,r,s){return LE(n)||s.isEqual(fe.min())?O.resolve(null):this.ps.getDocuments(e,r).next(i=>{const o=this.Ds(n,i);return this.Cs(n,o,r,s)?O.resolve(null):(So()<=je.DEBUG&&W("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),bo(n)),this.vs(e,o,n,lO(s,lc)).next(a=>a))})}Ds(e,n){let r=new Ze(Nb(e));return n.forEach((s,i)=>{Oc(e,i)&&(r=r.add(i))}),r}Cs(e,n,r,s){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const i=e.limitType==="F"?n.last():n.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}Ss(e,n,r){return So()<=je.DEBUG&&W("QueryEngine","Using full collection scan to execute query:",bo(n)),this.ps.getDocumentsMatchingQuery(e,n,On.min(),r)}vs(e,n,r,s){return this.ps.getDocumentsMatchingQuery(e,r,s).next(i=>(n.forEach(o=>{i=i.insert(o.key,o)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gy="LocalStore",uL=3e8;class dL{constructor(e,n,r,s){this.persistence=e,this.Fs=n,this.serializer=s,this.Ms=new ht(Ie),this.xs=new ns(i=>Hi(i),Dc),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(r)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new gC(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.Ms))}}function _C(t,e,n,r){return new dL(t,e,n,r)}async function vC(t,e){const n=ve(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let s;return n.mutationQueue.getAllMutationBatches(r).next(i=>(s=i,n.Bs(e),n.mutationQueue.getAllMutationBatches(r))).next(i=>{const o=[],a=[];let l=Ce();for(const d of s){o.push(d.batchId);for(const h of d.mutations)l=l.add(h.key)}for(const d of i){a.push(d.batchId);for(const h of d.mutations)l=l.add(h.key)}return n.localDocuments.getDocuments(r,l).next(d=>({Ls:d,removedBatchIds:o,addedBatchIds:a}))})})}function hL(t,e){const n=ve(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const s=e.batch.keys(),i=n.Ns.newChangeBuffer({trackRemovals:!0});return function(a,l,d,h){const f=d.batch,m=f.keys();let w=O.resolve();return m.forEach(R=>{w=w.next(()=>h.getEntry(l,R)).next(b=>{const A=d.docVersions.get(R);le(A!==null,48541),b.version.compareTo(A)<0&&(f.applyToRemoteDocument(b,d),b.isValidDocument()&&(b.setReadTime(d.commitVersion),h.addEntry(b)))})}),w.next(()=>a.mutationQueue.removeMutationBatch(l,f))}(n,r,e,i).next(()=>i.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,s,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let l=Ce();for(let d=0;d<a.mutationResults.length;++d)a.mutationResults[d].transformResults.length>0&&(l=l.add(a.batch.mutations[d].key));return l}(e))).next(()=>n.localDocuments.getDocuments(r,s))})}function wC(t){const e=ve(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Pi.getLastRemoteSnapshotVersion(n))}function fL(t,e){const n=ve(t),r=e.snapshotVersion;let s=n.Ms;return n.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const o=n.Ns.newChangeBuffer({trackRemovals:!0});s=n.Ms;const a=[];e.targetChanges.forEach((h,f)=>{const m=s.get(f);if(!m)return;a.push(n.Pi.removeMatchingKeys(i,h.removedDocuments,f).next(()=>n.Pi.addMatchingKeys(i,h.addedDocuments,f)));let w=m.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(f)!==null?w=w.withResumeToken(Pt.EMPTY_BYTE_STRING,fe.min()).withLastLimboFreeSnapshotVersion(fe.min()):h.resumeToken.approximateByteSize()>0&&(w=w.withResumeToken(h.resumeToken,r)),s=s.insert(f,w),function(b,A,T){return b.resumeToken.approximateByteSize()===0||A.snapshotVersion.toMicroseconds()-b.snapshotVersion.toMicroseconds()>=uL?!0:T.addedDocuments.size+T.modifiedDocuments.size+T.removedDocuments.size>0}(m,w,h)&&a.push(n.Pi.updateTargetData(i,w))});let l=Nn(),d=Ce();if(e.documentUpdates.forEach(h=>{e.resolvedLimboDocuments.has(h)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(i,h))}),a.push(pL(i,o,e.documentUpdates).next(h=>{l=h.ks,d=h.qs})),!r.isEqual(fe.min())){const h=n.Pi.getLastRemoteSnapshotVersion(i).next(f=>n.Pi.setTargetsMetadata(i,i.currentSequenceNumber,r));a.push(h)}return O.waitFor(a).next(()=>o.apply(i)).next(()=>n.localDocuments.getLocalViewOfDocuments(i,l,d)).next(()=>l)}).then(i=>(n.Ms=s,i))}function pL(t,e,n){let r=Ce(),s=Ce();return n.forEach(i=>r=r.add(i)),e.getEntries(t,r).next(i=>{let o=Nn();return n.forEach((a,l)=>{const d=i.get(a);l.isFoundDocument()!==d.isFoundDocument()&&(s=s.add(a)),l.isNoDocument()&&l.version.isEqual(fe.min())?(e.removeEntry(a,l.readTime),o=o.insert(a,l)):!d.isValidDocument()||l.version.compareTo(d.version)>0||l.version.compareTo(d.version)===0&&d.hasPendingWrites?(e.addEntry(l),o=o.insert(a,l)):W(Gy,"Ignoring outdated watch update for ",a,". Current version:",d.version," Watch version:",l.version)}),{ks:o,qs:s}})}function mL(t,e){const n=ve(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=Ri),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function gL(t,e){const n=ve(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let s;return n.Pi.getTargetData(r,e).next(i=>i?(s=i,O.resolve(s)):n.Pi.allocateTargetId(r).next(o=>(s=new Br(e,o,"TargetPurposeListen",r.currentSequenceNumber),n.Pi.addTargetData(r,s).next(()=>s))))}).then(r=>{const s=n.Ms.get(r.targetId);return(s===null||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(n.Ms=n.Ms.insert(r.targetId,r),n.xs.set(e,r.targetId)),r})}async function eg(t,e,n){const r=ve(t),s=r.Ms.get(e),i=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",i,o=>r.persistence.referenceDelegate.removeTarget(o,s))}catch(o){if(!ri(o))throw o;W(Gy,`Failed to update sequence numbers for target ${e}: ${o}`)}r.Ms=r.Ms.remove(e),r.xs.delete(s.target)}function pI(t,e,n){const r=ve(t);let s=fe.min(),i=Ce();return r.persistence.runTransaction("Execute query","readwrite",o=>function(l,d,h){const f=ve(l),m=f.xs.get(h);return m!==void 0?O.resolve(f.Ms.get(m)):f.Pi.getTargetData(d,h)}(r,o,Wn(e)).next(a=>{if(a)return s=a.lastLimboFreeSnapshotVersion,r.Pi.getMatchingKeysForTargetId(o,a.targetId).next(l=>{i=l})}).next(()=>r.Fs.getDocumentsMatchingQuery(o,e,n?s:fe.min(),n?i:Ce())).next(a=>(yL(r,tV(e),a),{documents:a,Qs:i})))}function yL(t,e,n){let r=t.Os.get(e)||fe.min();n.forEach((s,i)=>{i.readTime.compareTo(r)>0&&(r=i.readTime)}),t.Os.set(e,r)}class mI{constructor(){this.activeTargetIds=aV()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class EC{constructor(){this.Mo=new mI,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,n,r){this.xo[e]=n}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new mI,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _L{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gI="ConnectivityMonitor";class yI{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){W(gI,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){W(gI,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Su=null;function tg(){return Su===null?Su=function(){return 268435456+Math.round(2147483648*Math.random())}():Su++,"0x"+Su.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gp="RestConnection",vL={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class wL{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const n=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Uo=n+"://"+e.host,this.Ko=`projects/${r}/databases/${s}`,this.Wo=this.databaseId.database===Hd?`project_id=${r}`:`project_id=${r}&database_id=${s}`}Go(e,n,r,s,i){const o=tg(),a=this.zo(e,n.toUriEncodedString());W(gp,`Sending RPC '${e}' ${o}:`,a,r);const l={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(l,s,i);const{host:d}=new URL(a),h=ei(d);return this.Jo(e,a,l,r,h).then(f=>(W(gp,`Received RPC '${e}' ${o}: `,f),f),f=>{throw Bi(gp,`RPC '${e}' ${o} failed with error: `,f,"url: ",a,"request:",r),f})}Ho(e,n,r,s,i,o){return this.Go(e,n,r,s,i)}jo(e,n,r){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Na}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((s,i)=>e[i]=s),r&&r.headers.forEach((s,i)=>e[i]=s)}zo(e,n){const r=vL[e];return`${this.Uo}/v1/${n}:${r}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EL{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const en="WebChannelConnection";class IL extends wL{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,n,r,s,i){const o=tg();return new Promise((a,l)=>{const d=new BS;d.setWithCredentials(!0),d.listenOnce(zS.COMPLETE,()=>{try{switch(d.getLastErrorCode()){case Qu.NO_ERROR:const f=d.getResponseJson();W(en,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(f)),a(f);break;case Qu.TIMEOUT:W(en,`RPC '${e}' ${o} timed out`),l(new G(B.DEADLINE_EXCEEDED,"Request time out"));break;case Qu.HTTP_ERROR:const m=d.getStatus();if(W(en,`RPC '${e}' ${o} failed with status:`,m,"response text:",d.getResponseText()),m>0){let w=d.getResponseJson();Array.isArray(w)&&(w=w[0]);const R=w==null?void 0:w.error;if(R&&R.status&&R.message){const b=function(T){const E=T.toLowerCase().replace(/_/g,"-");return Object.values(B).indexOf(E)>=0?E:B.UNKNOWN}(R.status);l(new G(b,R.message))}else l(new G(B.UNKNOWN,"Server responded with status "+d.getStatus()))}else l(new G(B.UNAVAILABLE,"Connection failed."));break;default:oe(9055,{l_:e,streamId:o,h_:d.getLastErrorCode(),P_:d.getLastError()})}}finally{W(en,`RPC '${e}' ${o} completed.`)}});const h=JSON.stringify(s);W(en,`RPC '${e}' ${o} sending request:`,s),d.send(n,"POST",h,r,15)})}T_(e,n,r){const s=tg(),i=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=WS(),a=HS(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},d=this.longPollingOptions.timeoutSeconds;d!==void 0&&(l.longPollingTimeout=Math.round(1e3*d)),this.useFetchStreams&&(l.useFetchStreams=!0),this.jo(l.initMessageHeaders,n,r),l.encodeInitMessageHeaders=!0;const h=i.join("");W(en,`Creating RPC '${e}' stream ${s}: ${h}`,l);const f=o.createWebChannel(h,l);this.I_(f);let m=!1,w=!1;const R=new EL({Yo:A=>{w?W(en,`Not sending because RPC '${e}' stream ${s} is closed:`,A):(m||(W(en,`Opening RPC '${e}' stream ${s} transport.`),f.open(),m=!0),W(en,`RPC '${e}' stream ${s} sending:`,A),f.send(A))},Zo:()=>f.close()}),b=(A,T,E)=>{A.listen(T,y=>{try{E(y)}catch(j){setTimeout(()=>{throw j},0)}})};return b(f,ml.EventType.OPEN,()=>{w||(W(en,`RPC '${e}' stream ${s} transport opened.`),R.o_())}),b(f,ml.EventType.CLOSE,()=>{w||(w=!0,W(en,`RPC '${e}' stream ${s} transport closed`),R.a_(),this.E_(f))}),b(f,ml.EventType.ERROR,A=>{w||(w=!0,Bi(en,`RPC '${e}' stream ${s} transport errored. Name:`,A.name,"Message:",A.message),R.a_(new G(B.UNAVAILABLE,"The operation could not be completed")))}),b(f,ml.EventType.MESSAGE,A=>{var T;if(!w){const E=A.data[0];le(!!E,16349);const y=E,j=(y==null?void 0:y.error)||((T=y[0])==null?void 0:T.error);if(j){W(en,`RPC '${e}' stream ${s} received error:`,j);const V=j.status;let M=function(S){const C=Ct[S];if(C!==void 0)return qb(C)}(V),x=j.message;M===void 0&&(M=B.INTERNAL,x="Unknown error status: "+V+" with message "+j.message),w=!0,R.a_(new G(M,x)),f.close()}else W(en,`RPC '${e}' stream ${s} received:`,E),R.u_(E)}}),b(a,qS.STAT_EVENT,A=>{A.stat===jm.PROXY?W(en,`RPC '${e}' stream ${s} detected buffering proxy`):A.stat===jm.NOPROXY&&W(en,`RPC '${e}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{R.__()},0),R}terminate(){this.c_.forEach(e=>e.close()),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter(n=>n===e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function TL(){return typeof window<"u"?window:null}function id(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zh(t){return new TV(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IC{constructor(e,n,r=1e3,s=1.5,i=6e4){this.Mi=e,this.timerId=n,this.d_=r,this.A_=s,this.R_=i,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const n=Math.floor(this.V_+this.y_()),r=Math.max(0,Date.now()-this.f_),s=Math.max(0,n-r);s>0&&W("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.V_} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,s,()=>(this.f_=Date.now(),e())),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _I="PersistentStream";class TC{constructor(e,n,r,s,i,o,a,l){this.Mi=e,this.S_=r,this.b_=s,this.connection=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=l,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new IC(e,n)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,()=>this.k_()))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,n){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():n&&n.code===B.RESOURCE_EXHAUSTED?(dn(n.toString()),dn("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):n&&n.code===B.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(n)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),n=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,s])=>{this.D_===n&&this.G_(r,s)},r=>{e(()=>{const s=new G(B.UNKNOWN,"Fetching auth token failed: "+r.message);return this.z_(s)})})}G_(e,n){const r=this.W_(this.D_);this.stream=this.j_(e,n),this.stream.Xo(()=>{r(()=>this.listener.Xo())}),this.stream.t_(()=>{r(()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.t_()))}),this.stream.r_(s=>{r(()=>this.z_(s))}),this.stream.onMessage(s=>{r(()=>++this.F_==1?this.J_(s):this.onNext(s))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return W(_I,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return n=>{this.Mi.enqueueAndForget(()=>this.D_===e?n():(W(_I,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class xL extends TC{constructor(e,n,r,s,i,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,s,o),this.serializer=i}j_(e,n){return this.connection.T_("Listen",e,n)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const n=bV(this.serializer,e),r=function(i){if(!("targetChange"in i))return fe.min();const o=i.targetChange;return o.targetIds&&o.targetIds.length?fe.min():o.readTime?pn(o.readTime):fe.min()}(e);return this.listener.H_(n,r)}Y_(e){const n={};n.database=Qm(this.serializer),n.addTarget=function(i,o){let a;const l=o.target;if(a=Wd(l)?{documents:Jb(i,l)}:{query:$y(i,l).ft},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=Kb(i,o.resumeToken);const d=Km(i,o.expectedCount);d!==null&&(a.expectedCount=d)}else if(o.snapshotVersion.compareTo(fe.min())>0){a.readTime=Ea(i,o.snapshotVersion.toTimestamp());const d=Km(i,o.expectedCount);d!==null&&(a.expectedCount=d)}return a}(this.serializer,e);const r=RV(this.serializer,e);r&&(n.labels=r),this.q_(n)}Z_(e){const n={};n.database=Qm(this.serializer),n.removeTarget=e,this.q_(n)}}class SL extends TC{constructor(e,n,r,s,i,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,s,o),this.serializer=i}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,n){return this.connection.T_("Write",e,n)}J_(e){return le(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,le(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){le(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const n=CV(e.writeResults,e.commitTime),r=pn(e.commitTime);return this.listener.na(r,n)}ra(){const e={};e.database=Qm(this.serializer),this.q_(e)}ea(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>Yd(this.serializer,r))};this.q_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bL{}class CL extends bL{constructor(e,n,r,s){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=s,this.ia=!1}sa(){if(this.ia)throw new G(B.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,n,r,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.connection.Go(e,Gm(n,r),s,i,o)).catch(i=>{throw i.name==="FirebaseError"?(i.code===B.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new G(B.UNKNOWN,i.toString())})}Ho(e,n,r,s,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.Ho(e,Gm(n,r),s,o,a,i)).catch(o=>{throw o.name==="FirebaseError"?(o.code===B.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new G(B.UNKNOWN,o.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}class AL{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(dn(n),this.aa=!1):W("OnlineStateTracker",n)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yi="RemoteStore";class RL{constructor(e,n,r,s,i){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=i,this.Aa.Oo(o=>{r.enqueueAndForget(async()=>{oo(this)&&(W(Yi,"Restarting streams for network reachability change."),await async function(l){const d=ve(l);d.Ea.add(4),await Lc(d),d.Ra.set("Unknown"),d.Ea.delete(4),await ef(d)}(this))})}),this.Ra=new AL(r,s)}}async function ef(t){if(oo(t))for(const e of t.da)await e(!0)}async function Lc(t){for(const e of t.da)await e(!1)}function xC(t,e){const n=ve(t);n.Ia.has(e.targetId)||(n.Ia.set(e.targetId,e),Jy(n)?Xy(n):Da(n).O_()&&Yy(n,e))}function Qy(t,e){const n=ve(t),r=Da(n);n.Ia.delete(e),r.O_()&&SC(n,e),n.Ia.size===0&&(r.O_()?r.L_():oo(n)&&n.Ra.set("Unknown"))}function Yy(t,e){if(t.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(fe.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}Da(t).Y_(e)}function SC(t,e){t.Va.Ue(e),Da(t).Z_(e)}function Xy(t){t.Va=new vV({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),At:e=>t.Ia.get(e)||null,ht:()=>t.datastore.serializer.databaseId}),Da(t).start(),t.Ra.ua()}function Jy(t){return oo(t)&&!Da(t).x_()&&t.Ia.size>0}function oo(t){return ve(t).Ea.size===0}function bC(t){t.Va=void 0}async function PL(t){t.Ra.set("Online")}async function NL(t){t.Ia.forEach((e,n)=>{Yy(t,e)})}async function kL(t,e){bC(t),Jy(t)?(t.Ra.ha(e),Xy(t)):t.Ra.set("Unknown")}async function DL(t,e,n){if(t.Ra.set("Online"),e instanceof Wb&&e.state===2&&e.cause)try{await async function(s,i){const o=i.cause;for(const a of i.targetIds)s.Ia.has(a)&&(await s.remoteSyncer.rejectListen(a,o),s.Ia.delete(a),s.Va.removeTarget(a))}(t,e)}catch(r){W(Yi,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await th(t,r)}else if(e instanceof rd?t.Va.Ze(e):e instanceof Hb?t.Va.st(e):t.Va.tt(e),!n.isEqual(fe.min()))try{const r=await wC(t.localStore);n.compareTo(r)>=0&&await function(i,o){const a=i.Va.Tt(o);return a.targetChanges.forEach((l,d)=>{if(l.resumeToken.approximateByteSize()>0){const h=i.Ia.get(d);h&&i.Ia.set(d,h.withResumeToken(l.resumeToken,o))}}),a.targetMismatches.forEach((l,d)=>{const h=i.Ia.get(l);if(!h)return;i.Ia.set(l,h.withResumeToken(Pt.EMPTY_BYTE_STRING,h.snapshotVersion)),SC(i,l);const f=new Br(h.target,l,d,h.sequenceNumber);Yy(i,f)}),i.remoteSyncer.applyRemoteEvent(a)}(t,n)}catch(r){W(Yi,"Failed to raise snapshot:",r),await th(t,r)}}async function th(t,e,n){if(!ri(e))throw e;t.Ea.add(1),await Lc(t),t.Ra.set("Offline"),n||(n=()=>wC(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{W(Yi,"Retrying IndexedDB access"),await n(),t.Ea.delete(1),await ef(t)})}function CC(t,e){return e().catch(n=>th(t,n,e))}async function Mc(t){const e=ve(t),n=Qs(e);let r=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:Ri;for(;jL(e);)try{const s=await mL(e.localStore,r);if(s===null){e.Ta.length===0&&n.L_();break}r=s.batchId,OL(e,s)}catch(s){await th(e,s)}AC(e)&&RC(e)}function jL(t){return oo(t)&&t.Ta.length<10}function OL(t,e){t.Ta.push(e);const n=Qs(t);n.O_()&&n.X_&&n.ea(e.mutations)}function AC(t){return oo(t)&&!Qs(t).x_()&&t.Ta.length>0}function RC(t){Qs(t).start()}async function VL(t){Qs(t).ra()}async function LL(t){const e=Qs(t);for(const n of t.Ta)e.ea(n.mutations)}async function ML(t,e,n){const r=t.Ta.shift(),s=Ly.from(r,e,n);await CC(t,()=>t.remoteSyncer.applySuccessfulWrite(s)),await Mc(t)}async function FL(t,e){e&&Qs(t).X_&&await async function(r,s){if(function(o){return gV(o)&&o!==B.ABORTED}(s.code)){const i=r.Ta.shift();Qs(r).B_(),await CC(r,()=>r.remoteSyncer.rejectFailedWrite(i.batchId,s)),await Mc(r)}}(t,e),AC(t)&&RC(t)}async function vI(t,e){const n=ve(t);n.asyncQueue.verifyOperationInProgress(),W(Yi,"RemoteStore received new credentials");const r=oo(n);n.Ea.add(3),await Lc(n),r&&n.Ra.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.Ea.delete(3),await ef(n)}async function UL(t,e){const n=ve(t);e?(n.Ea.delete(2),await ef(n)):e||(n.Ea.add(2),await Lc(n),n.Ra.set("Unknown"))}function Da(t){return t.ma||(t.ma=function(n,r,s){const i=ve(n);return i.sa(),new xL(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Xo:PL.bind(null,t),t_:NL.bind(null,t),r_:kL.bind(null,t),H_:DL.bind(null,t)}),t.da.push(async e=>{e?(t.ma.B_(),Jy(t)?Xy(t):t.Ra.set("Unknown")):(await t.ma.stop(),bC(t))})),t.ma}function Qs(t){return t.fa||(t.fa=function(n,r,s){const i=ve(n);return i.sa(),new SL(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Xo:()=>Promise.resolve(),t_:VL.bind(null,t),r_:FL.bind(null,t),ta:LL.bind(null,t),na:ML.bind(null,t)}),t.da.push(async e=>{e?(t.fa.B_(),await Mc(t)):(await t.fa.stop(),t.Ta.length>0&&(W(Yi,`Stopping write stream with ${t.Ta.length} pending writes`),t.Ta=[]))})),t.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zy{constructor(e,n,r,s,i){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=s,this.removalCallback=i,this.deferred=new ar,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,s,i){const o=Date.now()+r,a=new Zy(e,n,o,s,i);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new G(B.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function e_(t,e){if(dn("AsyncQueue",`${e}: ${t}`),ri(t))return new G(B.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jo{static emptySet(e){return new Jo(e.comparator)}constructor(e){this.comparator=e?(n,r)=>e(n,r)||ee.comparator(n.key,r.key):(n,r)=>ee.comparator(n.key,r.key),this.keyedMap=gl(),this.sortedSet=new ht(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof Jo)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new Jo;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wI{constructor(){this.ga=new ht(ee.comparator)}track(e){const n=e.doc.key,r=this.ga.get(n);r?e.type!==0&&r.type===3?this.ga=this.ga.insert(n,e):e.type===3&&r.type!==1?this.ga=this.ga.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.ga=this.ga.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.ga=this.ga.remove(n):e.type===1&&r.type===2?this.ga=this.ga.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):oe(63341,{Rt:e,pa:r}):this.ga=this.ga.insert(n,e)}ya(){const e=[];return this.ga.inorderTraversal((n,r)=>{e.push(r)}),e}}class Ia{constructor(e,n,r,s,i,o,a,l,d){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=l,this.hasCachedResults=d}static fromInitialDocuments(e,n,r,s,i){const o=[];return n.forEach(a=>{o.push({type:0,doc:a})}),new Ia(e,n,Jo.emptySet(n),o,r,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&qh(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let s=0;s<n.length;s++)if(n[s].type!==r[s].type||!n[s].doc.isEqual(r[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $L{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some(e=>e.Da())}}class BL{constructor(){this.queries=EI(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(n,r){const s=ve(n),i=s.queries;s.queries=EI(),i.forEach((o,a)=>{for(const l of a.Sa)l.onError(r)})})(this,new G(B.ABORTED,"Firestore shutting down"))}}function EI(){return new ns(t=>Pb(t),qh)}async function t_(t,e){const n=ve(t);let r=3;const s=e.query;let i=n.queries.get(s);i?!i.ba()&&e.Da()&&(r=2):(i=new $L,r=e.Da()?0:1);try{switch(r){case 0:i.wa=await n.onListen(s,!0);break;case 1:i.wa=await n.onListen(s,!1);break;case 2:await n.onFirstRemoteStoreListen(s)}}catch(o){const a=e_(o,`Initialization of query '${bo(e.query)}' failed`);return void e.onError(a)}n.queries.set(s,i),i.Sa.push(e),e.va(n.onlineState),i.wa&&e.Fa(i.wa)&&r_(n)}async function n_(t,e){const n=ve(t),r=e.query;let s=3;const i=n.queries.get(r);if(i){const o=i.Sa.indexOf(e);o>=0&&(i.Sa.splice(o,1),i.Sa.length===0?s=e.Da()?0:1:!i.ba()&&e.Da()&&(s=2))}switch(s){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function zL(t,e){const n=ve(t);let r=!1;for(const s of e){const i=s.query,o=n.queries.get(i);if(o){for(const a of o.Sa)a.Fa(s)&&(r=!0);o.wa=s}}r&&r_(n)}function qL(t,e,n){const r=ve(t),s=r.queries.get(e);if(s)for(const i of s.Sa)i.onError(n);r.queries.delete(e)}function r_(t){t.Ca.forEach(e=>{e.next()})}var ng,II;(II=ng||(ng={})).Ma="default",II.Cache="cache";class s_{constructor(e,n,r){this.query=e,this.xa=n,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=r||{}}Fa(e){if(!this.options.includeMetadataChanges){const r=[];for(const s of e.docChanges)s.type!==3&&r.push(s);e=new Ia(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),n=!0):this.La(e,this.onlineState)&&(this.ka(e),n=!0),this.Na=e,n}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let n=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),n=!0),n}La(e,n){if(!e.fromCache||!this.Da())return!0;const r=n!=="Offline";return(!this.options.qa||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const n=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}ka(e){e=Ia.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==ng.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PC{constructor(e){this.key=e}}class NC{constructor(e){this.key=e}}class HL{constructor(e,n){this.query=e,this.Ya=n,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=Ce(),this.mutatedKeys=Ce(),this.eu=Nb(e),this.tu=new Jo(this.eu)}get nu(){return this.Ya}ru(e,n){const r=n?n.iu:new wI,s=n?n.tu:this.tu;let i=n?n.mutatedKeys:this.mutatedKeys,o=s,a=!1;const l=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,d=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((h,f)=>{const m=s.get(h),w=Oc(this.query,f)?f:null,R=!!m&&this.mutatedKeys.has(m.key),b=!!w&&(w.hasLocalMutations||this.mutatedKeys.has(w.key)&&w.hasCommittedMutations);let A=!1;m&&w?m.data.isEqual(w.data)?R!==b&&(r.track({type:3,doc:w}),A=!0):this.su(m,w)||(r.track({type:2,doc:w}),A=!0,(l&&this.eu(w,l)>0||d&&this.eu(w,d)<0)&&(a=!0)):!m&&w?(r.track({type:0,doc:w}),A=!0):m&&!w&&(r.track({type:1,doc:m}),A=!0,(l||d)&&(a=!0)),A&&(w?(o=o.add(w),i=b?i.add(h):i.delete(h)):(o=o.delete(h),i=i.delete(h)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const h=this.query.limitType==="F"?o.last():o.first();o=o.delete(h.key),i=i.delete(h.key),r.track({type:1,doc:h})}return{tu:o,iu:r,Cs:a,mutatedKeys:i}}su(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,s){const i=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const o=e.iu.ya();o.sort((h,f)=>function(w,R){const b=A=>{switch(A){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return oe(20277,{Rt:A})}};return b(w)-b(R)}(h.type,f.type)||this.eu(h.doc,f.doc)),this.ou(r),s=s??!1;const a=n&&!s?this._u():[],l=this.Xa.size===0&&this.current&&!s?1:0,d=l!==this.Za;return this.Za=l,o.length!==0||d?{snapshot:new Ia(this.query,e.tu,i,o,e.mutatedKeys,l===0,d,!1,!!r&&r.resumeToken.approximateByteSize()>0),au:a}:{au:a}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new wI,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(n=>this.Ya=this.Ya.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Ya=this.Ya.delete(n)),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=Ce(),this.tu.forEach(r=>{this.uu(r.key)&&(this.Xa=this.Xa.add(r.key))});const n=[];return e.forEach(r=>{this.Xa.has(r)||n.push(new NC(r))}),this.Xa.forEach(r=>{e.has(r)||n.push(new PC(r))}),n}cu(e){this.Ya=e.Qs,this.Xa=Ce();const n=this.ru(e.documents);return this.applyChanges(n,!0)}lu(){return Ia.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const i_="SyncEngine";class WL{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class KL{constructor(e){this.key=e,this.hu=!1}}class GL{constructor(e,n,r,s,i,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.Pu={},this.Tu=new ns(a=>Pb(a),qh),this.Iu=new Map,this.Eu=new Set,this.du=new ht(ee.comparator),this.Au=new Map,this.Ru=new qy,this.Vu={},this.mu=new Map,this.fu=Qi.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function QL(t,e,n=!0){const r=LC(t);let s;const i=r.Tu.get(e);return i?(r.sharedClientState.addLocalQueryTarget(i.targetId),s=i.view.lu()):s=await kC(r,e,n,!0),s}async function YL(t,e){const n=LC(t);await kC(n,e,!0,!1)}async function kC(t,e,n,r){const s=await gL(t.localStore,Wn(e)),i=s.targetId,o=t.sharedClientState.addLocalQueryTarget(i,n);let a;return r&&(a=await XL(t,e,i,o==="current",s.resumeToken)),t.isPrimaryClient&&n&&xC(t.remoteStore,s),a}async function XL(t,e,n,r,s){t.pu=(f,m,w)=>async function(b,A,T,E){let y=A.view.ru(T);y.Cs&&(y=await pI(b.localStore,A.query,!1).then(({documents:x})=>A.view.ru(x,y)));const j=E&&E.targetChanges.get(A.targetId),V=E&&E.targetMismatches.get(A.targetId)!=null,M=A.view.applyChanges(y,b.isPrimaryClient,j,V);return xI(b,A.targetId,M.au),M.snapshot}(t,f,m,w);const i=await pI(t.localStore,e,!0),o=new HL(e,i.Qs),a=o.ru(i.documents),l=Vc.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",s),d=o.applyChanges(a,t.isPrimaryClient,l);xI(t,n,d.au);const h=new WL(e,n,o);return t.Tu.set(e,h),t.Iu.has(n)?t.Iu.get(n).push(e):t.Iu.set(n,[e]),d.snapshot}async function JL(t,e,n){const r=ve(t),s=r.Tu.get(e),i=r.Iu.get(s.targetId);if(i.length>1)return r.Iu.set(s.targetId,i.filter(o=>!qh(o,e))),void r.Tu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(s.targetId),r.sharedClientState.isActiveQueryTarget(s.targetId)||await eg(r.localStore,s.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(s.targetId),n&&Qy(r.remoteStore,s.targetId),rg(r,s.targetId)}).catch(io)):(rg(r,s.targetId),await eg(r.localStore,s.targetId,!0))}async function ZL(t,e){const n=ve(t),r=n.Tu.get(e),s=n.Iu.get(r.targetId);n.isPrimaryClient&&s.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),Qy(n.remoteStore,r.targetId))}async function eM(t,e,n){const r=MC(t);try{const s=await function(o,a){const l=ve(o),d=$e.now(),h=a.reduce((w,R)=>w.add(R.key),Ce());let f,m;return l.persistence.runTransaction("Locally write mutations","readwrite",w=>{let R=Nn(),b=Ce();return l.Ns.getEntries(w,h).next(A=>{R=A,R.forEach((T,E)=>{E.isValidDocument()||(b=b.add(T))})}).next(()=>l.localDocuments.getOverlayedDocuments(w,R)).next(A=>{f=A;const T=[];for(const E of a){const y=fV(E,f.get(E.key).overlayedDocument);y!=null&&T.push(new rs(E.key,y,Eb(y.value.mapValue),sn.exists(!0)))}return l.mutationQueue.addMutationBatch(w,d,T,a)}).next(A=>{m=A;const T=A.applyToLocalDocumentSet(f,b);return l.documentOverlayCache.saveOverlays(w,A.batchId,T)})}).then(()=>({batchId:m.batchId,changes:Db(f)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(s.batchId),function(o,a,l){let d=o.Vu[o.currentUser.toKey()];d||(d=new ht(Ie)),d=d.insert(a,l),o.Vu[o.currentUser.toKey()]=d}(r,s.batchId,n),await Fc(r,s.changes),await Mc(r.remoteStore)}catch(s){const i=e_(s,"Failed to persist write");n.reject(i)}}async function DC(t,e){const n=ve(t);try{const r=await fL(n.localStore,e);e.targetChanges.forEach((s,i)=>{const o=n.Au.get(i);o&&(le(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1,22616),s.addedDocuments.size>0?o.hu=!0:s.modifiedDocuments.size>0?le(o.hu,14607):s.removedDocuments.size>0&&(le(o.hu,42227),o.hu=!1))}),await Fc(n,r,e)}catch(r){await io(r)}}function TI(t,e,n){const r=ve(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const s=[];r.Tu.forEach((i,o)=>{const a=o.view.va(e);a.snapshot&&s.push(a.snapshot)}),function(o,a){const l=ve(o);l.onlineState=a;let d=!1;l.queries.forEach((h,f)=>{for(const m of f.Sa)m.va(a)&&(d=!0)}),d&&r_(l)}(r.eventManager,e),s.length&&r.Pu.H_(s),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function tM(t,e,n){const r=ve(t);r.sharedClientState.updateQueryState(e,"rejected",n);const s=r.Au.get(e),i=s&&s.key;if(i){let o=new ht(ee.comparator);o=o.insert(i,Et.newNoDocument(i,fe.min()));const a=Ce().add(i),l=new Qh(fe.min(),new Map,new ht(Ie),o,a);await DC(r,l),r.du=r.du.remove(i),r.Au.delete(e),o_(r)}else await eg(r.localStore,e,!1).then(()=>rg(r,e,n)).catch(io)}async function nM(t,e){const n=ve(t),r=e.batch.batchId;try{const s=await hL(n.localStore,e);OC(n,r,null),jC(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await Fc(n,s)}catch(s){await io(s)}}async function rM(t,e,n){const r=ve(t);try{const s=await function(o,a){const l=ve(o);return l.persistence.runTransaction("Reject batch","readwrite-primary",d=>{let h;return l.mutationQueue.lookupMutationBatch(d,a).next(f=>(le(f!==null,37113),h=f.keys(),l.mutationQueue.removeMutationBatch(d,f))).next(()=>l.mutationQueue.performConsistencyCheck(d)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(d,h,a)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(d,h)).next(()=>l.localDocuments.getDocuments(d,h))})}(r.localStore,e);OC(r,e,n),jC(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await Fc(r,s)}catch(s){await io(s)}}function jC(t,e){(t.mu.get(e)||[]).forEach(n=>{n.resolve()}),t.mu.delete(e)}function OC(t,e,n){const r=ve(t);let s=r.Vu[r.currentUser.toKey()];if(s){const i=s.get(e);i&&(n?i.reject(n):i.resolve(),s=s.remove(e)),r.Vu[r.currentUser.toKey()]=s}}function rg(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Iu.get(e))t.Tu.delete(r),n&&t.Pu.yu(r,n);t.Iu.delete(e),t.isPrimaryClient&&t.Ru.jr(e).forEach(r=>{t.Ru.containsKey(r)||VC(t,r)})}function VC(t,e){t.Eu.delete(e.path.canonicalString());const n=t.du.get(e);n!==null&&(Qy(t.remoteStore,n),t.du=t.du.remove(e),t.Au.delete(n),o_(t))}function xI(t,e,n){for(const r of n)r instanceof PC?(t.Ru.addReference(r.key,e),sM(t,r)):r instanceof NC?(W(i_,"Document no longer in limbo: "+r.key),t.Ru.removeReference(r.key,e),t.Ru.containsKey(r.key)||VC(t,r.key)):oe(19791,{wu:r})}function sM(t,e){const n=e.key,r=n.path.canonicalString();t.du.get(n)||t.Eu.has(r)||(W(i_,"New document in limbo: "+n),t.Eu.add(r),o_(t))}function o_(t){for(;t.Eu.size>0&&t.du.size<t.maxConcurrentLimboResolutions;){const e=t.Eu.values().next().value;t.Eu.delete(e);const n=new ee(He.fromString(e)),r=t.fu.next();t.Au.set(r,new KL(n)),t.du=t.du.insert(n,r),xC(t.remoteStore,new Br(Wn(jc(n.path)),r,"TargetPurposeLimboResolution",qn.ce))}}async function Fc(t,e,n){const r=ve(t),s=[],i=[],o=[];r.Tu.isEmpty()||(r.Tu.forEach((a,l)=>{o.push(r.pu(l,e,n).then(d=>{var h;if((d||n)&&r.isPrimaryClient){const f=d?!d.fromCache:(h=n==null?void 0:n.targetChanges.get(l.targetId))==null?void 0:h.current;r.sharedClientState.updateQueryState(l.targetId,f?"current":"not-current")}if(d){s.push(d);const f=Ky.As(l.targetId,d);i.push(f)}}))}),await Promise.all(o),r.Pu.H_(s),await async function(l,d){const h=ve(l);try{await h.persistence.runTransaction("notifyLocalViewChanges","readwrite",f=>O.forEach(d,m=>O.forEach(m.Es,w=>h.persistence.referenceDelegate.addReference(f,m.targetId,w)).next(()=>O.forEach(m.ds,w=>h.persistence.referenceDelegate.removeReference(f,m.targetId,w)))))}catch(f){if(!ri(f))throw f;W(Gy,"Failed to update sequence numbers: "+f)}for(const f of d){const m=f.targetId;if(!f.fromCache){const w=h.Ms.get(m),R=w.snapshotVersion,b=w.withLastLimboFreeSnapshotVersion(R);h.Ms=h.Ms.insert(m,b)}}}(r.localStore,i))}async function iM(t,e){const n=ve(t);if(!n.currentUser.isEqual(e)){W(i_,"User change. New user:",e.toKey());const r=await vC(n.localStore,e);n.currentUser=e,function(i,o){i.mu.forEach(a=>{a.forEach(l=>{l.reject(new G(B.CANCELLED,o))})}),i.mu.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await Fc(n,r.Ls)}}function oM(t,e){const n=ve(t),r=n.Au.get(e);if(r&&r.hu)return Ce().add(r.key);{let s=Ce();const i=n.Iu.get(e);if(!i)return s;for(const o of i){const a=n.Tu.get(o);s=s.unionWith(a.view.nu)}return s}}function LC(t){const e=ve(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=DC.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=oM.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=tM.bind(null,e),e.Pu.H_=zL.bind(null,e.eventManager),e.Pu.yu=qL.bind(null,e.eventManager),e}function MC(t){const e=ve(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=nM.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=rM.bind(null,e),e}class _c{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Zh(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,n){return null}Mu(e,n){return null}vu(e){return _C(this.persistence,new yC,e.initialUser,this.serializer)}Cu(e){return new Hy(Jh.mi,this.serializer)}Du(e){return new EC}async terminate(){var e,n;(e=this.gcScheduler)==null||e.stop(),(n=this.indexBackfillerScheduler)==null||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}_c.provider={build:()=>new _c};class aM extends _c{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,n){le(this.persistence.referenceDelegate instanceof eh,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new hC(r,e.asyncQueue,n)}Cu(e){const n=this.cacheSizeBytes!==void 0?tn.withCacheSize(this.cacheSizeBytes):tn.DEFAULT;return new Hy(r=>eh.mi(r,n),this.serializer)}}class lM extends _c{constructor(e,n,r){super(),this.xu=e,this.cacheSizeBytes=n,this.forceOwnership=r,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.xu.initialize(this,e),await MC(this.xu.syncEngine),await Mc(this.xu.remoteStore),await this.persistence.Ji(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}vu(e){return _C(this.persistence,new yC,e.initialUser,this.serializer)}Fu(e,n){const r=this.persistence.referenceDelegate.garbageCollector;return new hC(r,e.asyncQueue,n)}Mu(e,n){const r=new hO(n,this.persistence);return new dO(e.asyncQueue,r)}Cu(e){const n=lL(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?tn.withCacheSize(this.cacheSizeBytes):tn.DEFAULT;return new Wy(this.synchronizeTabs,n,e.clientId,r,e.asyncQueue,TL(),id(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Du(e){return new EC}}class nh{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>TI(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=iM.bind(null,this.syncEngine),await UL(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new BL}()}createDatastore(e){const n=Zh(e.databaseInfo.databaseId),r=function(i){return new IL(i)}(e.databaseInfo);return function(i,o,a,l){return new CL(i,o,a,l)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,s,i,o,a){return new RL(r,s,i,o,a)}(this.localStore,this.datastore,e.asyncQueue,n=>TI(this.syncEngine,n,0),function(){return yI.v()?new yI:new _L}())}createSyncEngine(e,n){return function(s,i,o,a,l,d,h){const f=new GL(s,i,o,a,l,d);return h&&(f.gu=!0),f}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(s){const i=ve(s);W(Yi,"RemoteStore shutting down."),i.Ea.add(5),await Lc(i),i.Aa.shutdown(),i.Ra.set("Unknown")}(this.remoteStore),(e=this.datastore)==null||e.terminate(),(n=this.eventManager)==null||n.terminate()}}nh.provider={build:()=>new nh};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class a_{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):dn("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ys="FirestoreClient";class cM{constructor(e,n,r,s,i){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=s,this.user=qt.UNAUTHENTICATED,this.clientId=xy.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(r,async o=>{W(Ys,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>(W(Ys,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new ar;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=e_(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function yp(t,e){t.asyncQueue.verifyOperationInProgress(),W(Ys,"Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async s=>{r.isEqual(s)||(await vC(e.localStore,s),r=s)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function SI(t,e){t.asyncQueue.verifyOperationInProgress();const n=await uM(t);W(Ys,"Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>vI(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,s)=>vI(e.remoteStore,s)),t._onlineComponents=e}async function uM(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){W(Ys,"Using user provided OfflineComponentProvider");try{await yp(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(s){return s.name==="FirebaseError"?s.code===B.FAILED_PRECONDITION||s.code===B.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(n))throw n;Bi("Error using user provided cache. Falling back to memory cache: "+n),await yp(t,new _c)}}else W(Ys,"Using default OfflineComponentProvider"),await yp(t,new aM(void 0));return t._offlineComponents}async function l_(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(W(Ys,"Using user provided OnlineComponentProvider"),await SI(t,t._uninitializedComponentsProvider._online)):(W(Ys,"Using default OnlineComponentProvider"),await SI(t,new nh))),t._onlineComponents}function dM(t){return l_(t).then(e=>e.syncEngine)}function hM(t){return l_(t).then(e=>e.datastore)}async function rh(t){const e=await l_(t),n=e.eventManager;return n.onListen=QL.bind(null,e.syncEngine),n.onUnlisten=JL.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=YL.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=ZL.bind(null,e.syncEngine),n}function fM(t,e,n={}){const r=new ar;return t.asyncQueue.enqueueAndForget(async()=>function(i,o,a,l,d){const h=new a_({next:m=>{h.Nu(),o.enqueueAndForget(()=>n_(i,f));const w=m.docs.has(a);!w&&m.fromCache?d.reject(new G(B.UNAVAILABLE,"Failed to get document because the client is offline.")):w&&m.fromCache&&l&&l.source==="server"?d.reject(new G(B.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):d.resolve(m)},error:m=>d.reject(m)}),f=new s_(jc(a.path),h,{includeMetadataChanges:!0,qa:!0});return t_(i,f)}(await rh(t),t.asyncQueue,e,n,r)),r.promise}function pM(t,e,n={}){const r=new ar;return t.asyncQueue.enqueueAndForget(async()=>function(i,o,a,l,d){const h=new a_({next:m=>{h.Nu(),o.enqueueAndForget(()=>n_(i,f)),m.fromCache&&l.source==="server"?d.reject(new G(B.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):d.resolve(m)},error:m=>d.reject(m)}),f=new s_(a,h,{includeMetadataChanges:!0,qa:!0});return t_(i,f)}(await rh(t),t.asyncQueue,e,n,r)),r.promise}function mM(t,e,n){const r=new ar;return t.asyncQueue.enqueueAndForget(async()=>{try{const s=await hM(t);r.resolve(async function(o,a,l){var b;const d=ve(o),{request:h,gt:f,parent:m}=AV(d.serializer,eV(a),l);d.connection.$o||delete h.parent;const w=(await d.Ho("RunAggregationQuery",d.serializer.databaseId,m,h,1)).filter(A=>!!A.result);le(w.length===1,64727);const R=(b=w[0].result)==null?void 0:b.aggregateFields;return Object.keys(R).reduce((A,T)=>(A[f[T]]=R[T],A),{})}(s,e,n))}catch(s){r.reject(s)}}),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function FC(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bI=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UC="firestore.googleapis.com",CI=!0;class AI{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new G(B.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=UC,this.ssl=CI}else this.host=e.host,this.ssl=e.ssl??CI;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=lC;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<HV)throw new G(B.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}oO("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=FC(e.experimentalLongPollingOptions??{}),function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new G(B.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new G(B.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new G(B.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,s){return r.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class tf{constructor(e,n,r,s){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new AI({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new G(B.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new G(B.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new AI(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new Y2;switch(r.type){case"firstParty":return new eO(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new G(B.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=bI.get(n);r&&(W("ComponentProvider","Removing Datastore"),bI.delete(n),r.terminate())}(this),Promise.resolve()}}function gM(t,e,n,r={}){var d;t=on(t,tf);const s=ei(e),i=t._getSettings(),o={...i,emulatorOptions:t._getEmulatorOptions()},a=`${e}:${n}`;s&&(cy(`https://${a}`),uy("Firestore",!0)),i.host!==UC&&i.host!==a&&Bi("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const l={...i,host:a,ssl:s,emulatorOptions:r};if(!Yr(l,o)&&(t._setSettings(l),r.mockUserToken)){let h,f;if(typeof r.mockUserToken=="string")h=r.mockUserToken,f=qt.MOCK_USER;else{h=Qx(r.mockUserToken,(d=t._app)==null?void 0:d.options.projectId);const m=r.mockUserToken.sub||r.mockUserToken.user_id;if(!m)throw new G(B.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");f=new qt(m)}t._authCredentials=new X2(new GS(h,f))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fr{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new fr(this.firestore,e,this._query)}}class It{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new zs(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new It(this.firestore,e,this._key)}toJSON(){return{type:It._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,n,r){if(Nc(n,It._jsonSchema))return new It(e,r||null,new ee(He.fromString(n.referencePath)))}}It._jsonSchemaVersion="firestore/documentReference/1.0",It._jsonSchema={type:Rt("string",It._jsonSchemaVersion),referencePath:Rt("string")};class zs extends fr{constructor(e,n,r){super(e,n,jc(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new It(this.firestore,null,new ee(e))}withConverter(e){return new zs(this.firestore,e,this._path)}}function Ue(t,e,...n){if(t=Ke(t),YS("collection","path",e),t instanceof tf){const r=He.fromString(e,...n);return _E(r),new zs(t,null,r)}{if(!(t instanceof It||t instanceof zs))throw new G(B.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(He.fromString(e,...n));return _E(r),new zs(t.firestore,null,r)}}function Kt(t,e,...n){if(t=Ke(t),arguments.length===1&&(e=xy.newId()),YS("doc","path",e),t instanceof tf){const r=He.fromString(e,...n);return yE(r),new It(t,null,new ee(r))}{if(!(t instanceof It||t instanceof zs))throw new G(B.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(He.fromString(e,...n));return yE(r),new It(t.firestore,t instanceof zs?t.converter:null,new ee(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RI="AsyncQueue";class PI{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new IC(this,"async_queue_retry"),this._c=()=>{const r=id();r&&W(RI,"Visibility state changed to "+r.visibilityState),this.M_.w_()},this.ac=e;const n=id();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const n=id();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});const n=new ar;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Xu.push(e),this.lc()))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!ri(e))throw e;W(RI,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){const n=this.ac.then(()=>(this.rc=!0,e().catch(r=>{throw this.nc=r,this.rc=!1,dn("INTERNAL UNHANDLED ERROR: ",NI(r)),r}).then(r=>(this.rc=!1,r))));return this.ac=n,n}enqueueAfterDelay(e,n,r){this.uc(),this.oc.indexOf(e)>-1&&(n=0);const s=Zy.createAndSchedule(this,e,n,r,i=>this.hc(i));return this.tc.push(s),s}uc(){this.nc&&oe(47125,{Pc:NI(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const n of this.tc)if(n.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.tc)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.Tc()})}dc(e){this.oc.push(e)}hc(e){const n=this.tc.indexOf(e);this.tc.splice(n,1)}}function NI(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kI(t){return function(n,r){if(typeof n!="object"||n===null)return!1;const s=n;for(const i of r)if(i in s&&typeof s[i]=="function")return!0;return!1}(t,["next","error","complete"])}class dr extends tf{constructor(e,n,r,s){super(e,n,r,s),this.type="firestore",this._queue=new PI,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new PI(e),this._firestoreClient=void 0,await e}}}function $C(t,e){const n=typeof t=="object"?t:Ph(),r=typeof t=="string"?t:Hd,s=ti(n,"firestore").getImmediate({identifier:r});if(!s._initialized){const i=Wx("firestore");i&&gM(s,...i)}return s}function Uc(t){if(t._terminated)throw new G(B.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||BC(t),t._firestoreClient}function BC(t){var r,s,i;const e=t._freezeSettings(),n=function(a,l,d,h){return new BO(a,l,d,h.host,h.ssl,h.experimentalForceLongPolling,h.experimentalAutoDetectLongPolling,FC(h.experimentalLongPollingOptions),h.useFetchStreams,h.isUsingEmulator)}(t._databaseId,((r=t._app)==null?void 0:r.options.appId)||"",t._persistenceKey,e);t._componentsProvider||(s=e.localCache)!=null&&s._offlineComponentProvider&&((i=e.localCache)!=null&&i._onlineComponentProvider)&&(t._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),t._firestoreClient=new cM(t._authCredentials,t._appCheckCredentials,t._queue,n,t._componentsProvider&&function(a){const l=a==null?void 0:a._online.build();return{_offline:a==null?void 0:a._offline.build(l),_online:l}}(t._componentsProvider))}function yM(t,e){Bi("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const n=t._freezeSettings();return _M(t,nh.provider,{build:r=>new lM(r,n.cacheSizeBytes,e==null?void 0:e.forceOwnership)}),Promise.resolve()}function _M(t,e,n){if((t=on(t,dr))._firestoreClient||t._terminated)throw new G(B.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(t._componentsProvider||t._getSettings().localCache)throw new G(B.FAILED_PRECONDITION,"SDK cache is already specified.");t._componentsProvider={_online:e,_offline:n},BC(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vM{constructor(e="count",n){this._internalFieldPath=n,this.type="AggregateField",this.aggregateType=e}}class wM{constructor(e,n,r){this._userDataWriter=n,this._data=r,this.type="AggregateQuerySnapshot",this.query=e}data(){return this._userDataWriter.convertObjectMap(this._data)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bn{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Bn(Pt.fromBase64String(e))}catch(n){throw new G(B.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new Bn(Pt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Bn._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Nc(e,Bn._jsonSchema))return Bn.fromBase64String(e.bytes)}}Bn._jsonSchemaVersion="firestore/bytes/1.0",Bn._jsonSchema={type:Rt("string",Bn._jsonSchemaVersion),bytes:Rt("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nf{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new G(B.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new gt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ja{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nr{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new G(B.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new G(B.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return Ie(this._lat,e._lat)||Ie(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Nr._jsonSchemaVersion}}static fromJSON(e){if(Nc(e,Nr._jsonSchema))return new Nr(e.latitude,e.longitude)}}Nr._jsonSchemaVersion="firestore/geoPoint/1.0",Nr._jsonSchema={type:Rt("string",Nr._jsonSchemaVersion),latitude:Rt("number"),longitude:Rt("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kr{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,s){if(r.length!==s.length)return!1;for(let i=0;i<r.length;++i)if(r[i]!==s[i])return!1;return!0}(this._values,e._values)}toJSON(){return{type:kr._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Nc(e,kr._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(n=>typeof n=="number"))return new kr(e.vectorValues);throw new G(B.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}kr._jsonSchemaVersion="firestore/vectorValue/1.0",kr._jsonSchema={type:Rt("string",kr._jsonSchemaVersion),vectorValues:Rt("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EM=/^__.*__$/;class IM{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new rs(e,this.data,this.fieldMask,n,this.fieldTransforms):new ka(e,this.data,n,this.fieldTransforms)}}class zC{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new rs(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function qC(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw oe(40011,{Ac:t})}}class rf{constructor(e,n,r,s,i,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=s,i===void 0&&this.Rc(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new rf({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){var s;const n=(s=this.path)==null?void 0:s.child(e),r=this.Vc({path:n,fc:!1});return r.gc(e),r}yc(e){var s;const n=(s=this.path)==null?void 0:s.child(e),r=this.Vc({path:n,fc:!1});return r.Rc(),r}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return sh(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(qC(this.Ac)&&EM.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class TM{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||Zh(e)}Cc(e,n,r,s=!1){return new rf({Ac:e,methodName:n,Dc:r,path:gt.emptyPath(),fc:!1,bc:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function $c(t){const e=t._freezeSettings(),n=Zh(t._databaseId);return new TM(t._databaseId,!!e.ignoreUndefinedProperties,n)}function HC(t,e,n,r,s,i={}){const o=t.Cc(i.merge||i.mergeFields?2:0,e,n,s);h_("Data must be an object, but it was:",o,r);const a=KC(r,o);let l,d;if(i.merge)l=new En(o.fieldMask),d=o.fieldTransforms;else if(i.mergeFields){const h=[];for(const f of i.mergeFields){const m=sg(e,f,n);if(!o.contains(m))throw new G(B.INVALID_ARGUMENT,`Field '${m}' is specified in your field mask but missing from your input data.`);QC(h,m)||h.push(m)}l=new En(h),d=o.fieldTransforms.filter(f=>l.covers(f.field))}else l=null,d=o.fieldTransforms;return new IM(new rn(a),l,d)}class sf extends ja{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof sf}}function xM(t,e,n){return new rf({Ac:3,Dc:e.settings.Dc,methodName:t._methodName,fc:n},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class c_ extends ja{_toFieldTransform(e){return new Wh(e.path,new _a)}isEqual(e){return e instanceof c_}}class u_ extends ja{constructor(e,n){super(e),this.vc=n}_toFieldTransform(e){const n=xM(this,e,!0),r=this.vc.map(i=>Oa(i,n)),s=new Wi(r);return new Wh(e.path,s)}isEqual(e){return e instanceof u_&&Yr(this.vc,e.vc)}}class d_ extends ja{constructor(e,n){super(e),this.Fc=n}_toFieldTransform(e){const n=new wa(e.serializer,Vb(e.serializer,this.Fc));return new Wh(e.path,n)}isEqual(e){return e instanceof d_&&this.Fc===e.Fc}}function SM(t,e,n,r){const s=t.Cc(1,e,n);h_("Data must be an object, but it was:",s,r);const i=[],o=rn.empty();si(r,(l,d)=>{const h=f_(e,l,n);d=Ke(d);const f=s.yc(h);if(d instanceof sf)i.push(h);else{const m=Oa(d,f);m!=null&&(i.push(h),o.set(h,m))}});const a=new En(i);return new zC(o,a,s.fieldTransforms)}function bM(t,e,n,r,s,i){const o=t.Cc(1,e,n),a=[sg(e,r,n)],l=[s];if(i.length%2!=0)throw new G(B.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let m=0;m<i.length;m+=2)a.push(sg(e,i[m])),l.push(i[m+1]);const d=[],h=rn.empty();for(let m=a.length-1;m>=0;--m)if(!QC(d,a[m])){const w=a[m];let R=l[m];R=Ke(R);const b=o.yc(w);if(R instanceof sf)d.push(w);else{const A=Oa(R,b);A!=null&&(d.push(w),h.set(w,A))}}const f=new En(d);return new zC(h,f,o.fieldTransforms)}function WC(t,e,n,r=!1){return Oa(n,t.Cc(r?4:3,e))}function Oa(t,e){if(GC(t=Ke(t)))return h_("Unsupported field value:",e,t),KC(t,e);if(t instanceof ja)return function(r,s){if(!qC(s.Ac))throw s.Sc(`${r._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Sc(`${r._methodName}() is not currently supported inside arrays`);const i=r._toFieldTransform(s);i&&s.fieldTransforms.push(i)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return function(r,s){const i=[];let o=0;for(const a of r){let l=Oa(a,s.wc(o));l==null&&(l={nullValue:"NULL_VALUE"}),i.push(l),o++}return{arrayValue:{values:i}}}(t,e)}return function(r,s){if((r=Ke(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return Vb(s.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const i=$e.fromDate(r);return{timestampValue:Ea(s.serializer,i)}}if(r instanceof $e){const i=new $e(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Ea(s.serializer,i)}}if(r instanceof Nr)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Bn)return{bytesValue:Kb(s.serializer,r._byteString)};if(r instanceof It){const i=s.databaseId,o=r.firestore._databaseId;if(!o.isEqual(i))throw s.Sc(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:Uy(r.firestore._databaseId||s.databaseId,r._key.path)}}if(r instanceof kr)return function(o,a){return{mapValue:{fields:{[Ny]:{stringValue:ky},[ma]:{arrayValue:{values:o.toArray().map(d=>{if(typeof d!="number")throw a.Sc("VectorValues must only contain numeric values.");return Oy(a.serializer,d)})}}}}}}(r,s);throw s.Sc(`Unsupported field value: ${Oh(r)}`)}(t,e)}function KC(t,e){const n={};return hb(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):si(t,(r,s)=>{const i=Oa(s,e.mc(r));i!=null&&(n[r]=i)}),{mapValue:{fields:n}}}function GC(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof $e||t instanceof Nr||t instanceof Bn||t instanceof It||t instanceof ja||t instanceof kr)}function h_(t,e,n){if(!GC(n)||!XS(n)){const r=Oh(n);throw r==="an object"?e.Sc(t+" a custom object"):e.Sc(t+" "+r)}}function sg(t,e,n){if((e=Ke(e))instanceof nf)return e._internalPath;if(typeof e=="string")return f_(t,e);throw sh("Field path arguments must be of type string or ",t,!1,void 0,n)}const CM=new RegExp("[~\\*/\\[\\]]");function f_(t,e,n){if(e.search(CM)>=0)throw sh(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new nf(...e.split("."))._internalPath}catch{throw sh(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function sh(t,e,n,r,s){const i=r&&!r.isEmpty(),o=s!==void 0;let a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let l="";return(i||o)&&(l+=" (found",i&&(l+=` in field ${r}`),o&&(l+=` in document ${s}`),l+=")"),new G(B.INVALID_ARGUMENT,a+t+l)}function QC(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p_{constructor(e,n,r,s,i){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new It(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new AM(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(of("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class AM extends p_{data(){return super.data()}}function of(t,e){return typeof e=="string"?f_(t,e):e instanceof nf?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function YC(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new G(B.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class m_{}class Bc extends m_{}function tt(t,e,...n){let r=[];e instanceof m_&&r.push(e),r=r.concat(n),function(i){const o=i.filter(l=>l instanceof g_).length,a=i.filter(l=>l instanceof af).length;if(o>1||o>0&&a>0)throw new G(B.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const s of r)t=s._apply(t);return t}class af extends Bc{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new af(e,n,r)}_apply(e){const n=this._parse(e);return JC(e._query,n),new fr(e.firestore,e.converter,Wm(e._query,n))}_parse(e){const n=$c(e.firestore);return function(i,o,a,l,d,h,f){let m;if(d.isKeyField()){if(h==="array-contains"||h==="array-contains-any")throw new G(B.INVALID_ARGUMENT,`Invalid Query. You can't perform '${h}' queries on documentId().`);if(h==="in"||h==="not-in"){VI(f,h);const R=[];for(const b of f)R.push(OI(l,i,b));m={arrayValue:{values:R}}}else m=OI(l,i,f)}else h!=="in"&&h!=="not-in"&&h!=="array-contains-any"||VI(f,h),m=WC(a,o,f,h==="in"||h==="not-in");return Oe.create(d,h,m)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function Ye(t,e,n){const r=e,s=of("where",t);return af._create(s,r,n)}class g_ extends m_{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new g_(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:Xe.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(s,i){let o=s;const a=i.getFlattenedFilters();for(const l of a)JC(o,l),o=Wm(o,l)}(e._query,n),new fr(e.firestore,e.converter,Wm(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class y_ extends Bc{constructor(e,n){super(),this._field=e,this._direction=n,this.type="orderBy"}static _create(e,n){return new y_(e,n)}_apply(e){const n=function(s,i,o){if(s.startAt!==null)throw new G(B.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(s.endAt!==null)throw new G(B.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new yc(i,o)}(e._query,this._field,this._direction);return new fr(e.firestore,e.converter,function(s,i){const o=s.explicitOrderBy.concat([i]);return new ii(s.path,s.collectionGroup,o,s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt)}(e._query,n))}}function Gt(t,e="asc"){const n=e,r=of("orderBy",t);return y_._create(r,n)}class __ extends Bc{constructor(e,n,r){super(),this.type=e,this._limit=n,this._limitType=r}static _create(e,n,r){return new __(e,n,r)}_apply(e){return new fr(e.firestore,e.converter,Gd(e._query,this._limit,this._limitType))}}function Zo(t){return aO("limit",t),__._create("limit",t,"F")}class lf extends Bc{constructor(e,n,r){super(),this.type=e,this._docOrFields=n,this._inclusive=r}static _create(e,n,r){return new lf(e,n,r)}_apply(e){const n=XC(e,this.type,this._docOrFields,this._inclusive);return new fr(e.firestore,e.converter,function(s,i){return new ii(s.path,s.collectionGroup,s.explicitOrderBy.slice(),s.filters.slice(),s.limit,s.limitType,i,s.endAt)}(e._query,n))}}function DI(...t){return lf._create("startAt",t,!0)}function RM(...t){return lf._create("startAfter",t,!1)}class v_ extends Bc{constructor(e,n,r){super(),this.type=e,this._docOrFields=n,this._inclusive=r}static _create(e,n,r){return new v_(e,n,r)}_apply(e){const n=XC(e,this.type,this._docOrFields,this._inclusive);return new fr(e.firestore,e.converter,function(s,i){return new ii(s.path,s.collectionGroup,s.explicitOrderBy.slice(),s.filters.slice(),s.limit,s.limitType,s.startAt,i)}(e._query,n))}}function jI(...t){return v_._create("endAt",t,!0)}function XC(t,e,n,r){if(n[0]=Ke(n[0]),n[0]instanceof p_)return function(i,o,a,l,d){if(!l)throw new G(B.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${a}().`);const h=[];for(const f of Xo(i))if(f.field.isKeyField())h.push(qi(o,l.key));else{const m=l.data.field(f.field);if($h(m))throw new G(B.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+f.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(m===null){const w=f.field.canonicalString();throw new G(B.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${w}' (used as the orderBy) does not exist.`)}h.push(m)}return new Gs(h,d)}(t._query,t.firestore._databaseId,e,n[0]._document,r);{const s=$c(t.firestore);return function(o,a,l,d,h,f){const m=o.explicitOrderBy;if(h.length>m.length)throw new G(B.INVALID_ARGUMENT,`Too many arguments provided to ${d}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const w=[];for(let R=0;R<h.length;R++){const b=h[R];if(m[R].field.isKeyField()){if(typeof b!="string")throw new G(B.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${d}(), but got a ${typeof b}`);if(!jy(o)&&b.indexOf("/")!==-1)throw new G(B.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${d}() must be a plain document ID, but '${b}' contains a slash.`);const A=o.path.child(He.fromString(b));if(!ee.isDocumentKey(A))throw new G(B.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${d}() must result in a valid document path, but '${A}' is not because it contains an odd number of segments.`);const T=new ee(A);w.push(qi(a,T))}else{const A=WC(l,d,b);w.push(A)}}return new Gs(w,f)}(t._query,t.firestore._databaseId,s,e,n,r)}}function OI(t,e,n){if(typeof(n=Ke(n))=="string"){if(n==="")throw new G(B.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!jy(e)&&n.indexOf("/")!==-1)throw new G(B.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(He.fromString(n));if(!ee.isDocumentKey(r))throw new G(B.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return qi(t,new ee(r))}if(n instanceof It)return qi(t,n._key);throw new G(B.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Oh(n)}.`)}function VI(t,e){if(!Array.isArray(t)||t.length===0)throw new G(B.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function JC(t,e){const n=function(s,i){for(const o of s)for(const a of o.getFlattenedFilters())if(i.indexOf(a.op)>=0)return a.op;return null}(t.filters,function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new G(B.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new G(B.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class PM{convertValue(e,n="none"){switch(Ws(e)){case 0:return null;case 1:return e.booleanValue;case 2:return ct(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(es(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw oe(62114,{value:e})}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return si(e,(s,i)=>{r[s]=this.convertValue(i,n)}),r}convertVectorValue(e){var r,s,i;const n=(i=(s=(r=e.fields)==null?void 0:r[ma].arrayValue)==null?void 0:s.values)==null?void 0:i.map(o=>ct(o.doubleValue));return new kr(n)}convertGeoPoint(e){return new Nr(ct(e.latitude),ct(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=Bh(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(pc(e));default:return null}}convertTimestamp(e){const n=Zr(e);return new $e(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=He.fromString(e);le(nC(r),9688,{name:e});const s=new zi(r.get(1),r.get(3)),i=new ee(r.popFirst(5));return s.isEqual(n)||dn(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZC(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}function NM(){return new vM("count")}class vl{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class ki extends p_{constructor(e,n,r,s,i,o){super(e,n,r,s,o),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new od(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(of("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new G(B.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,n={};return n.type=ki._jsonSchemaVersion,n.bundle="",n.bundleSource="DocumentSnapshot",n.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?n:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),n.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),n)}}ki._jsonSchemaVersion="firestore/documentSnapshot/1.0",ki._jsonSchema={type:Rt("string",ki._jsonSchemaVersion),bundleSource:Rt("string","DocumentSnapshot"),bundleName:Rt("string"),bundle:Rt("string")};class od extends ki{data(e={}){return super.data(e)}}class Di{constructor(e,n,r,s){this._firestore=e,this._userDataWriter=n,this._snapshot=s,this.metadata=new vl(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new od(this._firestore,this._userDataWriter,r.key,r,new vl(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new G(B.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(s,i){if(s._snapshot.oldDocs.isEmpty()){let o=0;return s._snapshot.docChanges.map(a=>{const l=new od(s._firestore,s._userDataWriter,a.doc.key,a.doc,new vl(s._snapshot.mutatedKeys.has(a.doc.key),s._snapshot.fromCache),s.query.converter);return a.doc,{type:"added",doc:l,oldIndex:-1,newIndex:o++}})}{let o=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(a=>i||a.type!==3).map(a=>{const l=new od(s._firestore,s._userDataWriter,a.doc.key,a.doc,new vl(s._snapshot.mutatedKeys.has(a.doc.key),s._snapshot.fromCache),s.query.converter);let d=-1,h=-1;return a.type!==0&&(d=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),h=o.indexOf(a.doc.key)),{type:kM(a.type),doc:l,oldIndex:d,newIndex:h}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new G(B.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Di._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=xy.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const n=[],r=[],s=[];return this.docs.forEach(i=>{i._document!==null&&(n.push(i._document),r.push(this._userDataWriter.convertObjectMap(i._document.data.value.mapValue.fields,"previous")),s.push(i.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function kM(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return oe(61501,{type:t})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ih(t){t=on(t,It);const e=on(t.firestore,dr);return fM(Uc(e),t._key).then(n=>tA(e,t,n))}Di._jsonSchemaVersion="firestore/querySnapshot/1.0",Di._jsonSchema={type:Rt("string",Di._jsonSchemaVersion),bundleSource:Rt("string","QuerySnapshot"),bundleName:Rt("string"),bundle:Rt("string")};class cf extends PM{constructor(e){super(),this.firestore=e}convertBytes(e){return new Bn(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new It(this.firestore,null,n)}}function Wt(t){t=on(t,fr);const e=on(t.firestore,dr),n=Uc(e),r=new cf(e);return YC(t._query),pM(n,t._query).then(s=>new Di(e,r,t,s))}function oh(t,e,n){t=on(t,It);const r=on(t.firestore,dr),s=ZC(t.converter,e,n);return uf(r,[HC($c(r),"setDoc",t._key,s,t.converter!==null,n).toMutation(t._key,sn.none())])}function ea(t,e,n,...r){t=on(t,It);const s=on(t.firestore,dr),i=$c(s);let o;return o=typeof(e=Ke(e))=="string"||e instanceof nf?bM(i,"updateDoc",t._key,e,n,r):SM(i,"updateDoc",t._key,e),uf(s,[o.toMutation(t._key,sn.exists(!0))])}function eA(t){return uf(on(t.firestore,dr),[new Gh(t._key,sn.none())])}function wl(t,e){const n=on(t.firestore,dr),r=Kt(t),s=ZC(t.converter,e);return uf(n,[HC($c(t.firestore),"addDoc",r._key,s,t.converter!==null,{}).toMutation(r._key,sn.exists(!1))]).then(()=>r)}function rr(t,...e){var l,d,h;t=Ke(t);let n={includeMetadataChanges:!1,source:"default"},r=0;typeof e[r]!="object"||kI(e[r])||(n=e[r++]);const s={includeMetadataChanges:n.includeMetadataChanges,source:n.source};if(kI(e[r])){const f=e[r];e[r]=(l=f.next)==null?void 0:l.bind(f),e[r+1]=(d=f.error)==null?void 0:d.bind(f),e[r+2]=(h=f.complete)==null?void 0:h.bind(f)}let i,o,a;if(t instanceof It)o=on(t.firestore,dr),a=jc(t._key.path),i={next:f=>{e[r]&&e[r](tA(o,t,f))},error:e[r+1],complete:e[r+2]};else{const f=on(t,fr);o=on(f.firestore,dr),a=f._query;const m=new cf(o);i={next:w=>{e[r]&&e[r](new Di(o,m,f,w))},error:e[r+1],complete:e[r+2]},YC(t._query)}return function(m,w,R,b){const A=new a_(b),T=new s_(w,A,R);return m.asyncQueue.enqueueAndForget(async()=>t_(await rh(m),T)),()=>{A.Nu(),m.asyncQueue.enqueueAndForget(async()=>n_(await rh(m),T))}}(Uc(o),a,s,i)}function uf(t,e){return function(r,s){const i=new ar;return r.asyncQueue.enqueueAndForget(async()=>eM(await dM(r),s,i)),i.promise}(Uc(t),e)}function tA(t,e,n){const r=n.docs.get(e._key),s=new cf(t);return new ki(t,s,e._key,r,new vl(n.hasPendingWrites,n.fromCache),e.converter)}function DM(t){return jM(t,{count:NM()})}function jM(t,e){const n=on(t.firestore,dr),r=Uc(n),s=UO(e,(i,o)=>new pV(o,i.aggregateType,i._internalFieldPath));return mM(r,t._query,s).then(i=>function(a,l,d){const h=new cf(a);return new wM(l,h,d)}(n,t,i))}function Mn(){return new c_("serverTimestamp")}function OM(...t){return new u_("arrayUnion",t)}function LI(t){return new d_("increment",t)}(function(e,n=!0){(function(s){Na=s})(ro),cr(new Yn("firestore",(r,{instanceIdentifier:s,options:i})=>{const o=r.getProvider("app").getImmediate(),a=new dr(new J2(r.getProvider("auth-internal")),new tO(o,r.getProvider("app-check-internal")),function(d,h){if(!Object.prototype.hasOwnProperty.apply(d.options,["projectId"]))throw new G(B.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new zi(d.options.projectId,h)}(o,s),o);return i={useFetchStreams:n,...i},a._setSettings(i),a},"PUBLIC").setMultipleInstances(!0)),Sn(fE,pE,e),Sn(fE,pE,"esm2020")})();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nA="firebasestorage.googleapis.com",rA="storageBucket",VM=2*60*1e3,LM=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xt extends Xn{constructor(e,n,r=0){super(_p(e),`Firebase Storage: ${n} (${_p(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,xt.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return _p(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var Tt;(function(t){t.UNKNOWN="unknown",t.OBJECT_NOT_FOUND="object-not-found",t.BUCKET_NOT_FOUND="bucket-not-found",t.PROJECT_NOT_FOUND="project-not-found",t.QUOTA_EXCEEDED="quota-exceeded",t.UNAUTHENTICATED="unauthenticated",t.UNAUTHORIZED="unauthorized",t.UNAUTHORIZED_APP="unauthorized-app",t.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",t.INVALID_CHECKSUM="invalid-checksum",t.CANCELED="canceled",t.INVALID_EVENT_NAME="invalid-event-name",t.INVALID_URL="invalid-url",t.INVALID_DEFAULT_BUCKET="invalid-default-bucket",t.NO_DEFAULT_BUCKET="no-default-bucket",t.CANNOT_SLICE_BLOB="cannot-slice-blob",t.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",t.NO_DOWNLOAD_URL="no-download-url",t.INVALID_ARGUMENT="invalid-argument",t.INVALID_ARGUMENT_COUNT="invalid-argument-count",t.APP_DELETED="app-deleted",t.INVALID_ROOT_OPERATION="invalid-root-operation",t.INVALID_FORMAT="invalid-format",t.INTERNAL_ERROR="internal-error",t.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(Tt||(Tt={}));function _p(t){return"storage/"+t}function w_(){const t="An unknown error occurred, please check the error payload for server response.";return new xt(Tt.UNKNOWN,t)}function MM(t){return new xt(Tt.OBJECT_NOT_FOUND,"Object '"+t+"' does not exist.")}function FM(t){return new xt(Tt.QUOTA_EXCEEDED,"Quota for bucket '"+t+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function UM(){const t="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new xt(Tt.UNAUTHENTICATED,t)}function $M(){return new xt(Tt.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function BM(t){return new xt(Tt.UNAUTHORIZED,"User does not have permission to access '"+t+"'.")}function zM(){return new xt(Tt.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function qM(){return new xt(Tt.CANCELED,"User canceled the upload/download.")}function HM(t){return new xt(Tt.INVALID_URL,"Invalid URL '"+t+"'.")}function WM(t){return new xt(Tt.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}function KM(){return new xt(Tt.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+rA+"' property when initializing the app?")}function GM(){return new xt(Tt.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function QM(){return new xt(Tt.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function YM(t){return new xt(Tt.UNSUPPORTED_ENVIRONMENT,`${t} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function ig(t){return new xt(Tt.INVALID_ARGUMENT,t)}function sA(){return new xt(Tt.APP_DELETED,"The Firebase app was deleted.")}function XM(t){return new xt(Tt.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function Ul(t,e){return new xt(Tt.INVALID_FORMAT,"String does not match format '"+t+"': "+e)}function al(t){throw new xt(Tt.INTERNAL_ERROR,"Internal error: "+t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hn{constructor(e,n){this.bucket=e,this.path_=n}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,n){let r;try{r=hn.makeFromUrl(e,n)}catch{return new hn(e,"")}if(r.path==="")return r;throw WM(e)}static makeFromUrl(e,n){let r=null;const s="([A-Za-z0-9.\\-_]+)";function i(j){j.path.charAt(j.path.length-1)==="/"&&(j.path_=j.path_.slice(0,-1))}const o="(/(.*))?$",a=new RegExp("^gs://"+s+o,"i"),l={bucket:1,path:3};function d(j){j.path_=decodeURIComponent(j.path)}const h="v[A-Za-z0-9_]+",f=n.replace(/[.]/g,"\\."),m="(/([^?#]*).*)?$",w=new RegExp(`^https?://${f}/${h}/b/${s}/o${m}`,"i"),R={bucket:1,path:3},b=n===nA?"(?:storage.googleapis.com|storage.cloud.google.com)":n,A="([^?#]*)",T=new RegExp(`^https?://${b}/${s}/${A}`,"i"),y=[{regex:a,indices:l,postModify:i},{regex:w,indices:R,postModify:d},{regex:T,indices:{bucket:1,path:2},postModify:d}];for(let j=0;j<y.length;j++){const V=y[j],M=V.regex.exec(e);if(M){const x=M[V.indices.bucket];let _=M[V.indices.path];_||(_=""),r=new hn(x,_),V.postModify(r);break}}if(r==null)throw HM(e);return r}}class JM{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZM(t,e,n){let r=1,s=null,i=null,o=!1,a=0;function l(){return a===2}let d=!1;function h(...A){d||(d=!0,e.apply(null,A))}function f(A){s=setTimeout(()=>{s=null,t(w,l())},A)}function m(){i&&clearTimeout(i)}function w(A,...T){if(d){m();return}if(A){m(),h.call(null,A,...T);return}if(l()||o){m(),h.call(null,A,...T);return}r<64&&(r*=2);let y;a===1?(a=2,y=0):y=(r+Math.random())*1e3,f(y)}let R=!1;function b(A){R||(R=!0,m(),!d&&(s!==null?(A||(a=2),clearTimeout(s),f(0)):A||(a=1)))}return f(0),i=setTimeout(()=>{o=!0,b(!0)},n),b}function eF(t){t(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tF(t){return t!==void 0}function nF(t){return typeof t=="object"&&!Array.isArray(t)}function E_(t){return typeof t=="string"||t instanceof String}function MI(t){return I_()&&t instanceof Blob}function I_(){return typeof Blob<"u"}function og(t,e,n,r){if(r<e)throw ig(`Invalid value for '${t}'. Expected ${e} or greater.`);if(r>n)throw ig(`Invalid value for '${t}'. Expected ${n} or less.`)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zc(t,e,n){let r=e;return n==null&&(r=`https://${e}`),`${n}://${r}/v0${t}`}function iA(t){const e=encodeURIComponent;let n="?";for(const r in t)if(t.hasOwnProperty(r)){const s=e(r)+"="+e(t[r]);n=n+s+"&"}return n=n.slice(0,-1),n}var ji;(function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"})(ji||(ji={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rF(t,e){const n=t>=500&&t<600,s=[408,429].indexOf(t)!==-1,i=e.indexOf(t)!==-1;return n||s||i}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sF{constructor(e,n,r,s,i,o,a,l,d,h,f,m=!0,w=!1){this.url_=e,this.method_=n,this.headers_=r,this.body_=s,this.successCodes_=i,this.additionalRetryCodes_=o,this.callback_=a,this.errorCallback_=l,this.timeout_=d,this.progressCallback_=h,this.connectionFactory_=f,this.retry=m,this.isUsingEmulator=w,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((R,b)=>{this.resolve_=R,this.reject_=b,this.start_()})}start_(){const e=(r,s)=>{if(s){r(!1,new bu(!1,null,!0));return}const i=this.connectionFactory_();this.pendingConnection_=i;const o=a=>{const l=a.loaded,d=a.lengthComputable?a.total:-1;this.progressCallback_!==null&&this.progressCallback_(l,d)};this.progressCallback_!==null&&i.addUploadProgressListener(o),i.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&i.removeUploadProgressListener(o),this.pendingConnection_=null;const a=i.getErrorCode()===ji.NO_ERROR,l=i.getStatus();if(!a||rF(l,this.additionalRetryCodes_)&&this.retry){const h=i.getErrorCode()===ji.ABORT;r(!1,new bu(!1,null,h));return}const d=this.successCodes_.indexOf(l)!==-1;r(!0,new bu(d,i))})},n=(r,s)=>{const i=this.resolve_,o=this.reject_,a=s.connection;if(s.wasSuccessCode)try{const l=this.callback_(a,a.getResponse());tF(l)?i(l):i()}catch(l){o(l)}else if(a!==null){const l=w_();l.serverResponse=a.getErrorText(),this.errorCallback_?o(this.errorCallback_(a,l)):o(l)}else if(s.canceled){const l=this.appDelete_?sA():qM();o(l)}else{const l=zM();o(l)}};this.canceled_?n(!1,new bu(!1,null,!0)):this.backoffId_=ZM(e,n,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&eF(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class bu{constructor(e,n,r){this.wasSuccessCode=e,this.connection=n,this.canceled=!!r}}function iF(t,e){e!==null&&e.length>0&&(t.Authorization="Firebase "+e)}function oF(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function aF(t,e){e&&(t["X-Firebase-GMPID"]=e)}function lF(t,e){e!==null&&(t["X-Firebase-AppCheck"]=e)}function cF(t,e,n,r,s,i,o=!0,a=!1){const l=iA(t.urlParams),d=t.url+l,h=Object.assign({},t.headers);return aF(h,e),iF(h,n),oF(h,i),lF(h,r),new sF(d,t.method,h,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,s,o,a)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uF(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function dF(...t){const e=uF();if(e!==void 0){const n=new e;for(let r=0;r<t.length;r++)n.append(t[r]);return n.getBlob()}else{if(I_())return new Blob(t);throw new xt(Tt.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function hF(t,e,n){return t.webkitSlice?t.webkitSlice(e,n):t.mozSlice?t.mozSlice(e,n):t.slice?t.slice(e,n):null}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fF(t){if(typeof atob>"u")throw YM("base-64");return atob(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const br={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class vp{constructor(e,n){this.data=e,this.contentType=n||null}}function pF(t,e){switch(t){case br.RAW:return new vp(oA(e));case br.BASE64:case br.BASE64URL:return new vp(aA(t,e));case br.DATA_URL:return new vp(gF(e),yF(e))}throw w_()}function oA(t){const e=[];for(let n=0;n<t.length;n++){let r=t.charCodeAt(n);if(r<=127)e.push(r);else if(r<=2047)e.push(192|r>>6,128|r&63);else if((r&64512)===55296)if(!(n<t.length-1&&(t.charCodeAt(n+1)&64512)===56320))e.push(239,191,189);else{const i=r,o=t.charCodeAt(++n);r=65536|(i&1023)<<10|o&1023,e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|r&63)}else(r&64512)===56320?e.push(239,191,189):e.push(224|r>>12,128|r>>6&63,128|r&63)}return new Uint8Array(e)}function mF(t){let e;try{e=decodeURIComponent(t)}catch{throw Ul(br.DATA_URL,"Malformed data URL.")}return oA(e)}function aA(t,e){switch(t){case br.BASE64:{const s=e.indexOf("-")!==-1,i=e.indexOf("_")!==-1;if(s||i)throw Ul(t,"Invalid character '"+(s?"-":"_")+"' found: is it base64url encoded?");break}case br.BASE64URL:{const s=e.indexOf("+")!==-1,i=e.indexOf("/")!==-1;if(s||i)throw Ul(t,"Invalid character '"+(s?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let n;try{n=fF(e)}catch(s){throw s.message.includes("polyfill")?s:Ul(t,"Invalid character found")}const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}class lA{constructor(e){this.base64=!1,this.contentType=null;const n=e.match(/^data:([^,]+)?,/);if(n===null)throw Ul(br.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const r=n[1]||null;r!=null&&(this.base64=_F(r,";base64"),this.contentType=this.base64?r.substring(0,r.length-7):r),this.rest=e.substring(e.indexOf(",")+1)}}function gF(t){const e=new lA(t);return e.base64?aA(br.BASE64,e.rest):mF(e.rest)}function yF(t){return new lA(t).contentType}function _F(t,e){return t.length>=e.length?t.substring(t.length-e.length)===e:!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bs{constructor(e,n){let r=0,s="";MI(e)?(this.data_=e,r=e.size,s=e.type):e instanceof ArrayBuffer?(n?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),r=this.data_.length):e instanceof Uint8Array&&(n?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),r=e.length),this.size_=r,this.type_=s}size(){return this.size_}type(){return this.type_}slice(e,n){if(MI(this.data_)){const r=this.data_,s=hF(r,e,n);return s===null?null:new bs(s)}else{const r=new Uint8Array(this.data_.buffer,e,n-e);return new bs(r,!0)}}static getBlob(...e){if(I_()){const n=e.map(r=>r instanceof bs?r.data_:r);return new bs(dF.apply(null,n))}else{const n=e.map(o=>E_(o)?pF(br.RAW,o).data:o.data_);let r=0;n.forEach(o=>{r+=o.byteLength});const s=new Uint8Array(r);let i=0;return n.forEach(o=>{for(let a=0;a<o.length;a++)s[i++]=o[a]}),new bs(s,!0)}}uploadData(){return this.data_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function T_(t){let e;try{e=JSON.parse(t)}catch{return null}return nF(e)?e:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vF(t){if(t.length===0)return null;const e=t.lastIndexOf("/");return e===-1?"":t.slice(0,e)}function wF(t,e){const n=e.split("/").filter(r=>r.length>0).join("/");return t.length===0?n:t+"/"+n}function cA(t){const e=t.lastIndexOf("/",t.length-2);return e===-1?t:t.slice(e+1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function EF(t,e){return e}class cn{constructor(e,n,r,s){this.server=e,this.local=n||e,this.writable=!!r,this.xform=s||EF}}let Cu=null;function IF(t){return!E_(t)||t.length<2?t:cA(t)}function uA(){if(Cu)return Cu;const t=[];t.push(new cn("bucket")),t.push(new cn("generation")),t.push(new cn("metageneration")),t.push(new cn("name","fullPath",!0));function e(i,o){return IF(o)}const n=new cn("name");n.xform=e,t.push(n);function r(i,o){return o!==void 0?Number(o):o}const s=new cn("size");return s.xform=r,t.push(s),t.push(new cn("timeCreated")),t.push(new cn("updated")),t.push(new cn("md5Hash",null,!0)),t.push(new cn("cacheControl",null,!0)),t.push(new cn("contentDisposition",null,!0)),t.push(new cn("contentEncoding",null,!0)),t.push(new cn("contentLanguage",null,!0)),t.push(new cn("contentType",null,!0)),t.push(new cn("metadata","customMetadata",!0)),Cu=t,Cu}function TF(t,e){function n(){const r=t.bucket,s=t.fullPath,i=new hn(r,s);return e._makeStorageReference(i)}Object.defineProperty(t,"ref",{get:n})}function xF(t,e,n){const r={};r.type="file";const s=n.length;for(let i=0;i<s;i++){const o=n[i];r[o.local]=o.xform(r,e[o.server])}return TF(r,t),r}function dA(t,e,n){const r=T_(e);return r===null?null:xF(t,r,n)}function SF(t,e,n,r){const s=T_(e);if(s===null||!E_(s.downloadTokens))return null;const i=s.downloadTokens;if(i.length===0)return null;const o=encodeURIComponent;return i.split(",").map(d=>{const h=t.bucket,f=t.fullPath,m="/b/"+o(h)+"/o/"+o(f),w=zc(m,n,r),R=iA({alt:"media",token:d});return w+R})[0]}function bF(t,e){const n={},r=e.length;for(let s=0;s<r;s++){const i=e[s];i.writable&&(n[i.server]=t[i.local])}return JSON.stringify(n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FI="prefixes",UI="items";function CF(t,e,n){const r={prefixes:[],items:[],nextPageToken:n.nextPageToken};if(n[FI])for(const s of n[FI]){const i=s.replace(/\/$/,""),o=t._makeStorageReference(new hn(e,i));r.prefixes.push(o)}if(n[UI])for(const s of n[UI]){const i=t._makeStorageReference(new hn(e,s.name));r.items.push(i)}return r}function AF(t,e,n){const r=T_(n);return r===null?null:CF(t,e,r)}class df{constructor(e,n,r,s){this.url=e,this.method=n,this.handler=r,this.timeout=s,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function x_(t){if(!t)throw w_()}function RF(t,e){function n(r,s){const i=dA(t,s,e);return x_(i!==null),i}return n}function PF(t,e){function n(r,s){const i=AF(t,e,s);return x_(i!==null),i}return n}function NF(t,e){function n(r,s){const i=dA(t,s,e);return x_(i!==null),SF(i,s,t.host,t._protocol)}return n}function S_(t){function e(n,r){let s;return n.getStatus()===401?n.getErrorText().includes("Firebase App Check token is invalid")?s=$M():s=UM():n.getStatus()===402?s=FM(t.bucket):n.getStatus()===403?s=BM(t.path):s=r,s.status=n.getStatus(),s.serverResponse=r.serverResponse,s}return e}function hA(t){const e=S_(t);function n(r,s){let i=e(r,s);return r.getStatus()===404&&(i=MM(t.path)),i.serverResponse=s.serverResponse,i}return n}function kF(t,e,n,r,s){const i={};e.isRoot?i.prefix="":i.prefix=e.path+"/",n.length>0&&(i.delimiter=n),r&&(i.pageToken=r),s&&(i.maxResults=s);const o=e.bucketOnlyServerUrl(),a=zc(o,t.host,t._protocol),l="GET",d=t.maxOperationRetryTime,h=new df(a,l,PF(t,e.bucket),d);return h.urlParams=i,h.errorHandler=S_(e),h}function DF(t,e,n){const r=e.fullServerUrl(),s=zc(r,t.host,t._protocol),i="GET",o=t.maxOperationRetryTime,a=new df(s,i,NF(t,n),o);return a.errorHandler=hA(e),a}function jF(t,e){const n=e.fullServerUrl(),r=zc(n,t.host,t._protocol),s="DELETE",i=t.maxOperationRetryTime;function o(l,d){}const a=new df(r,s,o,i);return a.successCodes=[200,204],a.errorHandler=hA(e),a}function OF(t,e){return t&&t.contentType||e&&e.type()||"application/octet-stream"}function VF(t,e,n){const r=Object.assign({},n);return r.fullPath=t.path,r.size=e.size(),r.contentType||(r.contentType=OF(null,e)),r}function LF(t,e,n,r,s){const i=e.bucketOnlyServerUrl(),o={"X-Goog-Upload-Protocol":"multipart"};function a(){let y="";for(let j=0;j<2;j++)y=y+Math.random().toString().slice(2);return y}const l=a();o["Content-Type"]="multipart/related; boundary="+l;const d=VF(e,r,s),h=bF(d,n),f="--"+l+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+h+`\r
--`+l+`\r
Content-Type: `+d.contentType+`\r
\r
`,m=`\r
--`+l+"--",w=bs.getBlob(f,r,m);if(w===null)throw GM();const R={name:d.fullPath},b=zc(i,t.host,t._protocol),A="POST",T=t.maxUploadRetryTime,E=new df(b,A,RF(t,n),T);return E.urlParams=R,E.headers=o,E.body=w.uploadData(),E.errorHandler=S_(e),E}class MF{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=ji.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=ji.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=ji.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,n,r,s,i){if(this.sent_)throw al("cannot .send() more than once");if(ei(e)&&r&&(this.xhr_.withCredentials=!0),this.sent_=!0,this.xhr_.open(n,e,!0),i!==void 0)for(const o in i)i.hasOwnProperty(o)&&this.xhr_.setRequestHeader(o,i[o].toString());return s!==void 0?this.xhr_.send(s):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw al("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw al("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw al("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw al("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class FF extends MF{initXhr(){this.xhr_.responseType="text"}}function hf(){return new FF}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xi{constructor(e,n){this._service=e,n instanceof hn?this._location=n:this._location=hn.makeFromUrl(n,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,n){return new Xi(e,n)}get root(){const e=new hn(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return cA(this._location.path)}get storage(){return this._service}get parent(){const e=vF(this._location.path);if(e===null)return null;const n=new hn(this._location.bucket,e);return new Xi(this._service,n)}_throwIfRoot(e){if(this._location.path==="")throw XM(e)}}function UF(t,e,n){t._throwIfRoot("uploadBytes");const r=LF(t.storage,t._location,uA(),new bs(e,!0),n);return t.storage.makeRequestWithTokens(r,hf).then(s=>({metadata:s,ref:t}))}function $F(t){const e={prefixes:[],items:[]};return fA(t,e).then(()=>e)}async function fA(t,e,n){const s=await BF(t,{pageToken:n});e.prefixes.push(...s.prefixes),e.items.push(...s.items),s.nextPageToken!=null&&await fA(t,e,s.nextPageToken)}function BF(t,e){e!=null&&typeof e.maxResults=="number"&&og("options.maxResults",1,1e3,e.maxResults);const n=e||{},r=kF(t.storage,t._location,"/",n.pageToken,n.maxResults);return t.storage.makeRequestWithTokens(r,hf)}function zF(t){t._throwIfRoot("getDownloadURL");const e=DF(t.storage,t._location,uA());return t.storage.makeRequestWithTokens(e,hf).then(n=>{if(n===null)throw QM();return n})}function qF(t){t._throwIfRoot("deleteObject");const e=jF(t.storage,t._location);return t.storage.makeRequestWithTokens(e,hf)}function HF(t,e){const n=wF(t._location.path,e),r=new hn(t._location.bucket,n);return new Xi(t.storage,r)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function WF(t){return/^[A-Za-z]+:\/\//.test(t)}function KF(t,e){return new Xi(t,e)}function pA(t,e){if(t instanceof b_){const n=t;if(n._bucket==null)throw KM();const r=new Xi(n,n._bucket);return e!=null?pA(r,e):r}else return e!==void 0?HF(t,e):t}function GF(t,e){if(e&&WF(e)){if(t instanceof b_)return KF(t,e);throw ig("To use ref(service, url), the first argument must be a Storage instance.")}else return pA(t,e)}function $I(t,e){const n=e==null?void 0:e[rA];return n==null?null:hn.makeFromBucketSpec(n,t)}function QF(t,e,n,r={}){t.host=`${e}:${n}`;const s=ei(e);s&&(cy(`https://${t.host}/b`),uy("Storage",!0)),t._isUsingEmulator=!0,t._protocol=s?"https":"http";const{mockUserToken:i}=r;i&&(t._overrideAuthToken=typeof i=="string"?i:Qx(i,t.app.options.projectId))}class b_{constructor(e,n,r,s,i,o=!1){this.app=e,this._authProvider=n,this._appCheckProvider=r,this._url=s,this._firebaseVersion=i,this._isUsingEmulator=o,this._bucket=null,this._host=nA,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=VM,this._maxUploadRetryTime=LM,this._requests=new Set,s!=null?this._bucket=hn.makeFromBucketSpec(s,this._host):this._bucket=$I(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=hn.makeFromBucketSpec(this._url,e):this._bucket=$I(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){og("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){og("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const n=await e.getToken();if(n!==null)return n.accessToken}return null}async _getAppCheckToken(){if($n(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Xi(this,e)}_makeRequest(e,n,r,s,i=!0){if(this._deleted)return new JM(sA());{const o=cF(e,this._appId,r,s,n,this._firebaseVersion,i,this._isUsingEmulator);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}async makeRequestWithTokens(e,n){const[r,s]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,n,r,s).getPromise()}}const BI="@firebase/storage",zI="0.14.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mA="storage";function qI(t,e,n){return t=Ke(t),UF(t,e,n)}function HI(t){return t=Ke(t),$F(t)}function WI(t){return t=Ke(t),zF(t)}function wp(t){return t=Ke(t),qF(t)}function ll(t,e){return t=Ke(t),GF(t,e)}function Ei(t=Ph(),e){t=Ke(t);const r=ti(t,mA).getImmediate({identifier:e}),s=Wx("storage");return s&&YF(r,...s),r}function YF(t,e,n,r={}){QF(t,e,n,r)}function XF(t,{instanceIdentifier:e}){const n=t.getProvider("app").getImmediate(),r=t.getProvider("auth-internal"),s=t.getProvider("app-check-internal");return new b_(n,r,s,e,ro)}function JF(){cr(new Yn(mA,XF,"PUBLIC").setMultipleInstances(!0)),Sn(BI,zI,""),Sn(BI,zI,"esm2020")}JF();const ZF={apiKey:"AIzaSyC70mGCRrjE8iOap8iTHuid8HEuyadue8Y",authDomain:"odontocloud-d92ac.firebaseapp.com",projectId:"odontocloud-d92ac",storageBucket:"odontocloud-d92ac.firebasestorage.app",messagingSenderId:"267020714981",appId:"1:267020714981:web:a44416ea83aa1d1172650c",measurementId:"G-ZMCC5CFY0C"},C_=fy(ZF),KI=US(C_),GI=$C(C_);Ei(C_);const e4="/odontocloud-react/assets/fondo.png",gA="/odontocloud-react/assets/logo.png",QI=(t,e)=>{const n={email:t,rol:e,timestamp:Date.now()};localStorage.setItem("odc_session",JSON.stringify(n))},Ep=()=>{try{const t=JSON.parse(localStorage.getItem("odc_session"));return t&&Date.now()-t.timestamp<1e3*60*60*24?t:null}catch{return null}},t4=()=>{const t=Sc(),[e,n]=N.useState(""),[r,s]=N.useState(""),[i,o]=N.useState(""),[a,l]=N.useState(navigator.onLine);N.useEffect(()=>{const f=()=>l(!0),m=()=>l(!1);return window.addEventListener("online",f),window.addEventListener("offline",m),()=>{window.removeEventListener("online",f),window.removeEventListener("offline",m)}},[]);const d=f=>{const m=(f||"").toLowerCase();m==="administrador"?t("/dashboard_admin",{replace:!0}):m==="doctor"?t("/dashboard_doctor",{replace:!0}):m==="recepcionista"?t("/dashboard_recepcion",{replace:!0}):o("Rol no reconocido. Contacte al administrador.")};N.useEffect(()=>{if(!navigator.onLine){const m=Ep();m!=null&&m.rol?d(m.rol):o("Sin conexin y no hay sesin guardada.");return}const f=wy(KI,async m=>{if(m){const w=Ep();if(w!=null&&w.rol){d(w.rol);return}try{const R=tt(Ue(GI,"users"),Ye("correo","==",m.email||"")),b=await Wt(R);if(!b.empty){const A=b.docs[0].data().rol||"sin_rol";QI(m.email||"",A),d(A)}}catch{d("administrador")}}});return()=>f()},[]);const h=async f=>{if(f.preventDefault(),o(""),!a){const m=Ep();m!=null&&m.rol?d(m.rol):o("Sin conexin y no hay sesin guardada.");return}try{const w=(await Oj(KI,e,r)).user,R=tt(Ue(GI,"users"),Ye("correo","==",e)),b=await Wt(R);if(b.empty){o("Usuario no encontrado en la base de datos.");return}const T=b.docs[0].data().rol||"sin_rol";QI(e,T),d(T)}catch(m){switch(console.error("Error login:",m),m.code){case"auth/user-not-found":o("Usuario no registrado.");break;case"auth/wrong-password":o("Contrasea incorrecta.");break;case"auth/invalid-email":o("Correo no vlido.");break;case"auth/network-request-failed":o("Sin conexin. Usa la sesin guardada o reconecta.");break;default:o("Error al iniciar sesin.")}}};return u.jsx("div",{className:"login-root",style:{backgroundImage:`url(${e4})`,backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat",backgroundAttachment:"fixed",width:"100vw",height:"100vh",display:"flex",justifyContent:"center",alignItems:"center",overflow:"hidden"},children:u.jsxs("div",{className:"container",children:[u.jsxs("div",{className:"left-panel",children:[u.jsx("img",{src:gA,alt:"OdontoCloud Logo",className:"logo"}),u.jsxs("h2",{children:["Su clnica, ",u.jsx("br",{})," ms conectada."]}),u.jsx("p",{children:"OdontoCloud optimiza cada detalle de su gestin."})]}),u.jsxs("div",{className:"right-panel",children:[u.jsx("h3",{children:"Acceso a la plataforma"}),u.jsxs("form",{onSubmit:h,children:[u.jsx("input",{type:"email",placeholder:"usuario@ejemplo.com",value:e,onChange:f=>n(f.target.value),required:a}),u.jsx("input",{type:"password",placeholder:"Contrasea",value:r,onChange:f=>s(f.target.value),required:a}),u.jsx("button",{type:"submit",children:a?"Iniciar sesin":"Entrar (modo offline)"}),i&&u.jsx("p",{style:{color:"red",marginTop:10},children:i}),!a&&u.jsx("p",{style:{color:"orange",marginTop:10},children:" Modo offline activado"})]})]})]})})},yA="@firebase/installations",A_="0.6.19";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _A=1e4,vA=`w:${A_}`,wA="FIS_v2",n4="https://firebaseinstallations.googleapis.com/v1",r4=60*60*1e3,s4="installations",i4="Installations";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const o4={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},Ji=new no(s4,i4,o4);function EA(t){return t instanceof Xn&&t.code.includes("request-failed")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function IA({projectId:t}){return`${n4}/projects/${t}/installations`}function TA(t){return{token:t.token,requestStatus:2,expiresIn:l4(t.expiresIn),creationTime:Date.now()}}async function xA(t,e){const r=(await e.json()).error;return Ji.create("request-failed",{requestName:t,serverCode:r.code,serverMessage:r.message,serverStatus:r.status})}function SA({apiKey:t}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t})}function a4(t,{refreshToken:e}){const n=SA(t);return n.append("Authorization",c4(e)),n}async function bA(t){const e=await t();return e.status>=500&&e.status<600?t():e}function l4(t){return Number(t.replace("s","000"))}function c4(t){return`${wA} ${t}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function u4({appConfig:t,heartbeatServiceProvider:e},{fid:n}){const r=IA(t),s=SA(t),i=e.getImmediate({optional:!0});if(i){const d=await i.getHeartbeatsHeader();d&&s.append("x-firebase-client",d)}const o={fid:n,authVersion:wA,appId:t.appId,sdkVersion:vA},a={method:"POST",headers:s,body:JSON.stringify(o)},l=await bA(()=>fetch(r,a));if(l.ok){const d=await l.json();return{fid:d.fid||n,registrationStatus:2,refreshToken:d.refreshToken,authToken:TA(d.authToken)}}else throw await xA("Create Installation",l)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function CA(t){return new Promise(e=>{setTimeout(e,t)})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function d4(t){return btoa(String.fromCharCode(...t)).replace(/\+/g,"-").replace(/\//g,"_")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const h4=/^[cdef][\w-]{21}$/,ag="";function f4(){try{const t=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(t),t[0]=112+t[0]%16;const n=p4(t);return h4.test(n)?n:ag}catch{return ag}}function p4(t){return d4(t).substr(0,22)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ff(t){return`${t.appName}!${t.appId}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AA=new Map;function RA(t,e){const n=ff(t);PA(n,e),m4(n,e)}function PA(t,e){const n=AA.get(t);if(n)for(const r of n)r(e)}function m4(t,e){const n=g4();n&&n.postMessage({key:t,fid:e}),y4()}let bi=null;function g4(){return!bi&&"BroadcastChannel"in self&&(bi=new BroadcastChannel("[Firebase] FID Change"),bi.onmessage=t=>{PA(t.data.key,t.data.fid)}),bi}function y4(){AA.size===0&&bi&&(bi.close(),bi=null)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _4="firebase-installations-database",v4=1,Zi="firebase-installations-store";let Ip=null;function R_(){return Ip||(Ip=rS(_4,v4,{upgrade:(t,e)=>{switch(e){case 0:t.createObjectStore(Zi)}}})),Ip}async function ah(t,e){const n=ff(t),s=(await R_()).transaction(Zi,"readwrite"),i=s.objectStore(Zi),o=await i.get(n);return await i.put(e,n),await s.done,(!o||o.fid!==e.fid)&&RA(t,e.fid),e}async function NA(t){const e=ff(t),r=(await R_()).transaction(Zi,"readwrite");await r.objectStore(Zi).delete(e),await r.done}async function pf(t,e){const n=ff(t),s=(await R_()).transaction(Zi,"readwrite"),i=s.objectStore(Zi),o=await i.get(n),a=e(o);return a===void 0?await i.delete(n):await i.put(a,n),await s.done,a&&(!o||o.fid!==a.fid)&&RA(t,a.fid),a}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function P_(t){let e;const n=await pf(t.appConfig,r=>{const s=w4(r),i=E4(t,s);return e=i.registrationPromise,i.installationEntry});return n.fid===ag?{installationEntry:await e}:{installationEntry:n,registrationPromise:e}}function w4(t){const e=t||{fid:f4(),registrationStatus:0};return kA(e)}function E4(t,e){if(e.registrationStatus===0){if(!navigator.onLine){const s=Promise.reject(Ji.create("app-offline"));return{installationEntry:e,registrationPromise:s}}const n={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},r=I4(t,n);return{installationEntry:n,registrationPromise:r}}else return e.registrationStatus===1?{installationEntry:e,registrationPromise:T4(t)}:{installationEntry:e}}async function I4(t,e){try{const n=await u4(t,e);return ah(t.appConfig,n)}catch(n){throw EA(n)&&n.customData.serverCode===409?await NA(t.appConfig):await ah(t.appConfig,{fid:e.fid,registrationStatus:0}),n}}async function T4(t){let e=await YI(t.appConfig);for(;e.registrationStatus===1;)await CA(100),e=await YI(t.appConfig);if(e.registrationStatus===0){const{installationEntry:n,registrationPromise:r}=await P_(t);return r||n}return e}function YI(t){return pf(t,e=>{if(!e)throw Ji.create("installation-not-found");return kA(e)})}function kA(t){return x4(t)?{fid:t.fid,registrationStatus:0}:t}function x4(t){return t.registrationStatus===1&&t.registrationTime+_A<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function S4({appConfig:t,heartbeatServiceProvider:e},n){const r=b4(t,n),s=a4(t,n),i=e.getImmediate({optional:!0});if(i){const d=await i.getHeartbeatsHeader();d&&s.append("x-firebase-client",d)}const o={installation:{sdkVersion:vA,appId:t.appId}},a={method:"POST",headers:s,body:JSON.stringify(o)},l=await bA(()=>fetch(r,a));if(l.ok){const d=await l.json();return TA(d)}else throw await xA("Generate Auth Token",l)}function b4(t,{fid:e}){return`${IA(t)}/${e}/authTokens:generate`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function N_(t,e=!1){let n;const r=await pf(t.appConfig,i=>{if(!DA(i))throw Ji.create("not-registered");const o=i.authToken;if(!e&&R4(o))return i;if(o.requestStatus===1)return n=C4(t,e),i;{if(!navigator.onLine)throw Ji.create("app-offline");const a=N4(i);return n=A4(t,a),a}});return n?await n:r.authToken}async function C4(t,e){let n=await XI(t.appConfig);for(;n.authToken.requestStatus===1;)await CA(100),n=await XI(t.appConfig);const r=n.authToken;return r.requestStatus===0?N_(t,e):r}function XI(t){return pf(t,e=>{if(!DA(e))throw Ji.create("not-registered");const n=e.authToken;return k4(n)?{...e,authToken:{requestStatus:0}}:e})}async function A4(t,e){try{const n=await S4(t,e),r={...e,authToken:n};return await ah(t.appConfig,r),n}catch(n){if(EA(n)&&(n.customData.serverCode===401||n.customData.serverCode===404))await NA(t.appConfig);else{const r={...e,authToken:{requestStatus:0}};await ah(t.appConfig,r)}throw n}}function DA(t){return t!==void 0&&t.registrationStatus===2}function R4(t){return t.requestStatus===2&&!P4(t)}function P4(t){const e=Date.now();return e<t.creationTime||t.creationTime+t.expiresIn<e+r4}function N4(t){const e={requestStatus:1,requestTime:Date.now()};return{...t,authToken:e}}function k4(t){return t.requestStatus===1&&t.requestTime+_A<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function D4(t){const e=t,{installationEntry:n,registrationPromise:r}=await P_(e);return r?r.catch(console.error):N_(e).catch(console.error),n.fid}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function j4(t,e=!1){const n=t;return await O4(n),(await N_(n,e)).token}async function O4(t){const{registrationPromise:e}=await P_(t);e&&await e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function V4(t){if(!t||!t.options)throw Tp("App Configuration");if(!t.name)throw Tp("App Name");const e=["projectId","apiKey","appId"];for(const n of e)if(!t.options[n])throw Tp(n);return{appName:t.name,projectId:t.options.projectId,apiKey:t.options.apiKey,appId:t.options.appId}}function Tp(t){return Ji.create("missing-app-config-values",{valueName:t})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jA="installations",L4="installations-internal",M4=t=>{const e=t.getProvider("app").getImmediate(),n=V4(e),r=ti(e,"heartbeat");return{app:e,appConfig:n,heartbeatServiceProvider:r,_delete:()=>Promise.resolve()}},F4=t=>{const e=t.getProvider("app").getImmediate(),n=ti(e,jA).getImmediate();return{getId:()=>D4(n),getToken:s=>j4(n,s)}};function U4(){cr(new Yn(jA,M4,"PUBLIC")),cr(new Yn(L4,F4,"PRIVATE"))}U4();Sn(yA,A_);Sn(yA,A_,"esm2020");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lh="analytics",$4="firebase_id",B4="origin",z4=60*1e3,q4="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",k_="https://www.googletagmanager.com/gtag/js";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mn=new Rh("@firebase/analytics");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const H4={"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-initialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."},Dn=new no("analytics","Analytics",H4);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function W4(t){if(!t.startsWith(k_)){const e=Dn.create("invalid-gtag-resource",{gtagURL:t});return mn.warn(e.message),""}return t}function OA(t){return Promise.all(t.map(e=>e.catch(n=>n)))}function K4(t,e){let n;return window.trustedTypes&&(n=window.trustedTypes.createPolicy(t,e)),n}function G4(t,e){const n=K4("firebase-js-sdk-policy",{createScriptURL:W4}),r=document.createElement("script"),s=`${k_}?l=${t}&id=${e}`;r.src=n?n==null?void 0:n.createScriptURL(s):s,r.async=!0,document.head.appendChild(r)}function Q4(t){let e=[];return Array.isArray(window[t])?e=window[t]:window[t]=e,e}async function Y4(t,e,n,r,s,i){const o=r[s];try{if(o)await e[o];else{const l=(await OA(n)).find(d=>d.measurementId===s);l&&await e[l.appId]}}catch(a){mn.error(a)}t("config",s,i)}async function X4(t,e,n,r,s){try{let i=[];if(s&&s.send_to){let o=s.send_to;Array.isArray(o)||(o=[o]);const a=await OA(n);for(const l of o){const d=a.find(f=>f.measurementId===l),h=d&&e[d.appId];if(h)i.push(h);else{i=[];break}}}i.length===0&&(i=Object.values(e)),await Promise.all(i),t("event",r,s||{})}catch(i){mn.error(i)}}function J4(t,e,n,r){async function s(i,...o){try{if(i==="event"){const[a,l]=o;await X4(t,e,n,a,l)}else if(i==="config"){const[a,l]=o;await Y4(t,e,n,r,a,l)}else if(i==="consent"){const[a,l]=o;t("consent",a,l)}else if(i==="get"){const[a,l,d]=o;t("get",a,l,d)}else if(i==="set"){const[a]=o;t("set",a)}else t(i,...o)}catch(a){mn.error(a)}}return s}function Z4(t,e,n,r,s){let i=function(...o){window[r].push(arguments)};return window[s]&&typeof window[s]=="function"&&(i=window[s]),window[s]=J4(i,t,e,n),{gtagCore:i,wrappedGtag:window[s]}}function eU(t){const e=window.document.getElementsByTagName("script");for(const n of Object.values(e))if(n.src&&n.src.includes(k_)&&n.src.includes(t))return n;return null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tU=30,nU=1e3;class rU{constructor(e={},n=nU){this.throttleMetadata=e,this.intervalMillis=n}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,n){this.throttleMetadata[e]=n}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}}const VA=new rU;function sU(t){return new Headers({Accept:"application/json","x-goog-api-key":t})}async function iU(t){var o;const{appId:e,apiKey:n}=t,r={method:"GET",headers:sU(n)},s=q4.replace("{app-id}",e),i=await fetch(s,r);if(i.status!==200&&i.status!==304){let a="";try{const l=await i.json();(o=l.error)!=null&&o.message&&(a=l.error.message)}catch{}throw Dn.create("config-fetch-failed",{httpStatus:i.status,responseMessage:a})}return i.json()}async function oU(t,e=VA,n){const{appId:r,apiKey:s,measurementId:i}=t.options;if(!r)throw Dn.create("no-app-id");if(!s){if(i)return{measurementId:i,appId:r};throw Dn.create("no-api-key")}const o=e.getThrottleMetadata(r)||{backoffCount:0,throttleEndTimeMillis:Date.now()},a=new cU;return setTimeout(async()=>{a.abort()},z4),LA({appId:r,apiKey:s,measurementId:i},o,a,e)}async function LA(t,{throttleEndTimeMillis:e,backoffCount:n},r,s=VA){var a;const{appId:i,measurementId:o}=t;try{await aU(r,e)}catch(l){if(o)return mn.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${o} provided in the "measurementId" field in the local Firebase config. [${l==null?void 0:l.message}]`),{appId:i,measurementId:o};throw l}try{const l=await iU(t);return s.deleteThrottleMetadata(i),l}catch(l){const d=l;if(!lU(d)){if(s.deleteThrottleMetadata(i),o)return mn.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${o} provided in the "measurementId" field in the local Firebase config. [${d==null?void 0:d.message}]`),{appId:i,measurementId:o};throw l}const h=Number((a=d==null?void 0:d.customData)==null?void 0:a.httpStatus)===503?Lw(n,s.intervalMillis,tU):Lw(n,s.intervalMillis),f={throttleEndTimeMillis:Date.now()+h,backoffCount:n+1};return s.setThrottleMetadata(i,f),mn.debug(`Calling attemptFetch again in ${h} millis`),LA(t,f,r,s)}}function aU(t,e){return new Promise((n,r)=>{const s=Math.max(e-Date.now(),0),i=setTimeout(n,s);t.addEventListener(()=>{clearTimeout(i),r(Dn.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}function lU(t){if(!(t instanceof Xn)||!t.customData)return!1;const e=Number(t.customData.httpStatus);return e===429||e===500||e===503||e===504}class cU{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach(e=>e())}}async function uU(t,e,n,r,s){if(s&&s.global){t("event",n,r);return}else{const i=await e,o={...r,send_to:i};t("event",n,o)}}async function dU(t,e,n,r){if(r&&r.global){const s={};for(const i of Object.keys(n))s[`user_properties.${i}`]=n[i];return t("set",s),Promise.resolve()}else{const s=await e;t("config",s,{update:!0,user_properties:n})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function hU(){if(dy())try{await eS()}catch(t){return mn.warn(Dn.create("indexeddb-unavailable",{errorInfo:t==null?void 0:t.toString()}).message),!1}else return mn.warn(Dn.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;return!0}async function fU(t,e,n,r,s,i,o){const a=oU(t);a.then(m=>{n[m.measurementId]=m.appId,t.options.measurementId&&m.measurementId!==t.options.measurementId&&mn.warn(`The measurement ID in the local Firebase config (${t.options.measurementId}) does not match the measurement ID fetched from the server (${m.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(m=>mn.error(m)),e.push(a);const l=hU().then(m=>{if(m)return r.getId()}),[d,h]=await Promise.all([a,l]);eU(i)||G4(i,d.measurementId),s("js",new Date);const f=(o==null?void 0:o.config)??{};return f[B4]="firebase",f.update=!0,h!=null&&(f[$4]=h),s("config",d.measurementId,f),d.measurementId}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pU{constructor(e){this.app=e}_delete(){return delete ta[this.app.options.appId],Promise.resolve()}}let ta={},JI=[];const ZI={};let xp="dataLayer",mU="gtag",eT,D_,tT=!1;function gU(){const t=[];if(Xx()&&t.push("This is a browser extension environment."),yk()||t.push("Cookies are not available."),t.length>0){const e=t.map((r,s)=>`(${s+1}) ${r}`).join(" "),n=Dn.create("invalid-analytics-context",{errorInfo:e});mn.warn(n.message)}}function yU(t,e,n){gU();const r=t.options.appId;if(!r)throw Dn.create("no-app-id");if(!t.options.apiKey)if(t.options.measurementId)mn.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${t.options.measurementId} provided in the "measurementId" field in the local Firebase config.`);else throw Dn.create("no-api-key");if(ta[r]!=null)throw Dn.create("already-exists",{id:r});if(!tT){Q4(xp);const{wrappedGtag:i,gtagCore:o}=Z4(ta,JI,ZI,xp,mU);D_=i,eT=o,tT=!0}return ta[r]=fU(t,JI,ZI,e,eT,xp,n),new pU(t)}function _U(t=Ph()){t=Ke(t);const e=ti(t,lh);return e.isInitialized()?e.getImmediate():vU(t)}function vU(t,e={}){const n=ti(t,lh);if(n.isInitialized()){const s=n.getImmediate();if(Yr(e,n.getOptions()))return s;throw Dn.create("already-initialized")}return n.initialize({options:e})}function wU(t,e,n){t=Ke(t),dU(D_,ta[t.app.options.appId],e,n).catch(r=>mn.error(r))}function EU(t,e,n,r){t=Ke(t),uU(D_,ta[t.app.options.appId],e,n,r).catch(s=>mn.error(s))}const nT="@firebase/analytics",rT="0.10.19";function IU(){cr(new Yn(lh,(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("installations-internal").getImmediate();return yU(r,s,n)},"PUBLIC")),cr(new Yn("analytics-internal",t,"PRIVATE")),Sn(nT,rT),Sn(nT,rT,"esm2020");function t(e){try{const n=e.getProvider(lh).getImmediate();return{logEvent:(r,s,i)=>EU(n,r,s,i),setUserProperties:(r,s)=>wU(n,r,s)}}catch(n){throw Dn.create("interop-component-reg-failed",{reason:n})}}}IU();const TU={apiKey:"AIzaSyC70mGCRrjE8iOap8iTHuid8HEuyadue8Y",authDomain:"odontocloud-d92ac.firebaseapp.com",projectId:"odontocloud-d92ac",storageBucket:"odontocloud-d92ac.firebasestorage.app",messagingSenderId:"267020714981",appId:"1:267020714981:web:a44416ea83aa1d1172650c",measurementId:"G-ZMCC5CFY0C"},mf=fy(TU),ch=US(mf),ye=$C(mf);Ei(mf);_U(mf);const Sp="TU EMPRESA S.A.S.",xU="Generado por OdontoCloud",Au=()=>{const t=new Date;return t.setHours(0,0,0,0),t},di=t=>{const e=new Date(t);return e.setHours(0,0,0,0),e},bp=t=>{const e=new Date(t);return e.setHours(23,59,59,999),e},vr=(t,e)=>{const n=new Date(t);return n.setDate(n.getDate()+e),n},sT=t=>{const e=new Date(t),n=e.getDay(),r=(n===0?-6:1)-n;return e.setDate(e.getDate()+r),e.setHours(0,0,0,0),e},iT=(t,e)=>t.getFullYear()===e.getFullYear()&&t.getMonth()===e.getMonth()&&t.getDate()===e.getDate();var uT;const _n=typeof navigator<"u"&&((uT=navigator.language)!=null&&uT.startsWith("es"))?"es-ES":"en-US",Cp=t=>{const e=t.getFullYear(),n=String(t.getMonth()+1).padStart(2,"0"),r=String(t.getDate()).padStart(2,"0");return`${e}-${n}-${r}`},_o=t=>(t||"").toString().toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/\s+/g," ").trim();function SU(){const[t,e]=N.useState("day"),[n,r]=N.useState(Au()),[s,i]=N.useState(Au()),[o,a]=N.useState(!0),[l,d]=N.useState([]),[h,f]=N.useState(""),[m,w]=N.useState(""),[R,b]=N.useState("");N.useEffect(()=>{a(!0);const z=Ue(ye,"citas"),te=tt(z,Gt("fecha","asc")),ue=rr(te,Ee=>{const we=Ee.docs.map(xe=>{const se=xe.data(),De=se.horaInicio||se.hora||"00:00",[it="0",rt="0"]=De.split(":"),ft=parseInt(it,10)||0,q=parseInt(rt,10)||0;let ne;if(se.fecha&&se.fecha.toDate)ne=se.fecha.toDate(),ne.setHours(ft,q,0,0);else if(typeof se.fecha=="string"){const[de,Se,Ae]=se.fecha.split("-");ne=new Date(parseInt(de,10),parseInt(Se,10)-1,parseInt(Ae,10),ft,q,0,0)}else se.fecha instanceof Date?(ne=new Date(se.fecha),ne.setHours(ft,q,0,0)):(ne=new Date,ne.setHours(ft,q,0,0));const H=se.documentoPaciente||se.docPaciente||se.pacienteDocumento||se.documento||"",Q=se.celularPaciente||se.telefonoPaciente||se.celular||se.telefono||"";return{id:xe.id,raw:se,fecha:ne,horaInicio:De,paciente:se.paciente||se.pacienteNombre||"Sin nombre",doctor:se.doctor||se.doctorNombre||"",sucursal:se.sucursal||"",espacio:se.espacio||se.consultorio||"",comentario:se.comentario||"",estado:se.estado||"En espera",recordatorio:se.recordatorio||"",documento:H,telefono:Q}});let ke,ae;if(t==="day")ke=di(n),ae=bp(n);else if(t==="week"){const xe=sT(n),se=vr(xe,6);ke=di(xe),ae=bp(se)}else{const xe=di(n),se=vr(xe,-30),De=vr(xe,60);ke=di(se),ae=bp(De)}const nt=we.filter(xe=>xe.fecha>=ke&&xe.fecha<=ae);d(nt),a(!1)},Ee=>{console.error("Error leyendo citas:",Ee),d([]),a(!1)});return()=>ue()},[t,n]);const A=N.useMemo(()=>{const z=new Set;return l.forEach(te=>te.sucursal&&z.add(te.sucursal)),Array.from(z)},[l]),T=N.useMemo(()=>{const z=new Set;return l.forEach(te=>te.doctor&&z.add(te.doctor)),Array.from(z)},[l]),E=N.useMemo(()=>{const z=R.trim().toLowerCase();return l.filter(te=>{if(h&&te.sucursal!==h||m&&te.doctor!==m)return!1;if(!z)return!0;const ue=[te.paciente,te.doctor,te.comentario,te.documento,te.sucursal,te.espacio,te.estado],Ee=te.raw?JSON.stringify(te.raw):"";return[...ue,Ee].filter(Boolean).some(ke=>String(ke).toLowerCase().includes(z))})},[l,h,m,R]),y=N.useMemo(()=>o?"Ocupacin: cargando...":E.length===0?"Ocupacin: sin citas para el rango seleccionado.":`Ocupacin: ${E.length} cita${E.length!==1?"s":""} en el rango actual.`,[E,o]),j=N.useMemo(()=>{const z=new Date(s.getFullYear(),s.getMonth(),1),te=(z.getDay()+6)%7,ue=new Date(z);ue.setDate(ue.getDate()-te);const Ee=[];for(let we=0;we<6;we++){const ke=[];for(let ae=0;ae<7;ae++){const nt=new Date(ue),xe=nt.getMonth()===s.getMonth(),se=iT(nt,Au()),De=iT(nt,n);ke.push({date:nt,isCurrentMonth:xe,isToday:se,isSelected:De}),ue.setDate(ue.getDate()+1)}Ee.push(ke)}return Ee},[s,n]),V=()=>{const z=new Date(s);z.setMonth(z.getMonth()-1),i(z)},M=()=>{const z=new Date(s);z.setMonth(z.getMonth()+1),i(z)},x=z=>{r(di(z)),i(di(z)),e("day")},_=N.useMemo(()=>s.toLocaleDateString(_n,{month:"long",year:"numeric"}),[s]),S=N.useMemo(()=>{if(t==="day")return n.toLocaleDateString(_n,{weekday:"long",day:"2-digit",month:"long",year:"numeric"});if(t==="week"){const z=sT(n),te=vr(z,6);return z.toLocaleDateString(_n,{day:"2-digit",month:"short"})+" - "+te.toLocaleDateString(_n,{day:"2-digit",month:"short",year:"numeric"})}return"ltimas citas (detalle)"},[t,n]),C=()=>{r(t==="day"?vr(n,-1):t==="week"?vr(n,-7):vr(n,-1))},k=()=>{r(t==="day"?vr(n,1):t==="week"?vr(n,7):vr(n,1))},D=()=>{const z=Au();r(z),i(z),e("day")},P=()=>{var it,rt,ft;const z=q=>String(q??"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),te=((it=document.querySelector('meta[name="company-name"]'))==null?void 0:it.getAttribute("content"))||Sp,ue=((rt=document.querySelector('meta[name="company-logo"]'))==null?void 0:rt.getAttribute("content"))||"",Ee="Generado por OdontoCloud",we=E.length===0?'<tr><td colspan="6" style="padding:8px 6px;color:#6b7280">No hay citas registradas para este rango.</td></tr>':E.map(q=>{const ne=q.fecha.toLocaleDateString(_n),H=q.fecha.toLocaleTimeString(_n,{hour:"2-digit",minute:"2-digit",hour12:!0});return`<tr>
              <td>${z(ne)}</td>
              <td>${z(H)}</td>
              <td>${z(q.paciente)}</td>
              <td>${z(q.doctor)}</td>
              <td>${z(q.espacio)}</td>
              <td>${z(q.comentario)}</td>
            </tr>`}).join(""),ae=`<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>Imprimir  ${z(te)}</title>
  <style>
    @page { size: A4 portrait; margin: 18mm; }
    body { font-family: Segoe UI, Roboto, Arial, sans-serif; color:#0f172a; }
    .hdr { display:flex; align-items:center; gap:12px; border-bottom:2px solid #e5e7eb; padding-bottom:8px; margin-bottom:12px; }
    .brand { font-size:18px; font-weight:700; color:#0a86d8; line-height:1.1; }
    .sub { font-size:12px; color:#6b7280; }
    table { width:100%; border-collapse:collapse; font-size:12px; }
    th { text-align:left; background:#f3f4f6; border-bottom:1px solid #e5e7eb; padding:8px 6px; }
    td { border-bottom:1px solid #f1f5f9; padding:7px 6px; vertical-align:top; }
    .note { margin-top:8px; font-size:10px; color:#9ca3af; }
    tr, .hdr { page-break-inside: avoid; }
  </style>
</head>
<body>
  <div class="hdr">
    ${ue?`<img src="${ue}" alt="Logo" style="height:36px;object-fit:contain">`:""}
    <div>
      <div class="brand">${z(te)}</div>
      <div class="sub">Agenda de citas  ${z(S)}</div>
    </div>
  </div>

  <table>
    <thead>
      <tr>
        <th style="width:18%">Fecha</th>
        <th style="width:10%">Hora</th>
        <th style="width:22%">Paciente</th>
        <th style="width:20%">Doctor</th>
        <th style="width:15%">Espacio</th>
        <th>Comentario</th>
      </tr>
    </thead>
    <tbody>${we}</tbody>
  </table>

  <div class="note">${z(Ee)}. ${z(new Date().toLocaleString(_n))}</div>
  <script>
    // Imprimir cuando termine de cargar la pestaa (incluye el logo)
    window.addEventListener('load', function() {
      try { window.focus(); window.print(); } catch (e) {}
    });
  <\/script>
</body>
</html>`,nt=new Blob([ae],{type:"text/html;charset=utf-8"}),xe=URL.createObjectURL(nt),se=window.open(xe,"_blank","noopener,noreferrer,width=900,height=700");if(!se){alert("El navegador bloque la ventana de impresin. Permite pop-ups para este sitio."),URL.revokeObjectURL(xe);return}const De=()=>{try{URL.revokeObjectURL(xe)}catch{}};(ft=se.addEventListener)==null||ft.call(se,"load",De),setTimeout(De,15e3)},Y=()=>alert("Funcin de confirmar citas se integrar con n8n / correo."),Ge=()=>D(),Lt=()=>{if(E.length===0){alert("No hay citas para exportar.");return}const z=[`Empresa: ${Sp}`],te=["Fecha","Hora","Paciente","Doctor","Espacio","Comentario"],ue=E.map(se=>{const De=se.fecha.toLocaleDateString(_n),it=se.fecha.toLocaleTimeString(_n,{hour:"2-digit",minute:"2-digit",hour12:!0});return[De,it,se.paciente||"",se.doctor||"",se.espacio||"",(se.comentario||"").replace(/\r?\n/g," ")]}),Ee=[xU],we=[z,[],te,...ue,[],Ee].map(se=>(se||[]).map(De=>`"${String(De??"").replace(/"/g,'""')}"`).join(",")).join(`
`),ke=`citas_${Sp.toLowerCase().replace(/\s+/g,"_")}_${Cp(di(n))}`+(t==="week"?"_semana":t==="detail"?"_detalle":"")+".csv",ae=new Blob(["\uFEFF"+we],{type:"text/csv;charset=utf-8;"}),nt=URL.createObjectURL(ae),xe=document.createElement("a");xe.href=nt,xe.download=ke,xe.click(),URL.revokeObjectURL(nt)},he=async(z,te)=>{try{const ue=Kt(ye,"citas",z);await ea(ue,{estado:te})}catch(ue){console.error("Error actualizando estado:",ue),alert("No se pudo actualizar el estado de la cita.")}},Z=(z,te)=>{if(!z){alert("Este paciente no tiene celular registrado.");return}const ue=String(z).replace(/\D/g,""),Ee=te.fecha.toLocaleDateString(_n),we=te.fecha.toLocaleTimeString(_n,{hour:"numeric",minute:"2-digit",hour12:!0}),ke=encodeURIComponent(`Hola ${te.paciente}, le recordamos su cita odontolgica el ${Ee} a las ${we}. Por favor confirme su asistencia.`),ae=`https://wa.me/${ue}?text=${ke}`;window.open(ae,"_blank")},ce=async z=>{if(window.confirm(`Seguro que deseas eliminar la cita de ${z.paciente} del ${z.fecha.toLocaleDateString(_n)}?`))try{const ue=Kt(ye,"citas",z.id);await eA(ue)}catch(ue){console.error("Error eliminando cita:",ue),alert(" No se pudo eliminar la cita.")}},pe=()=>{const z=document.createElement("div");Object.assign(z.style,{position:"fixed",top:"0",left:"0",width:"100%",height:"100%",background:"rgba(0,0,0,0.55)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:"9999"});const te=document.createElement("div");Object.assign(te.style,{background:"#fff",padding:"25px 30px",borderRadius:"14px",width:"520px",maxWidth:"95%",maxHeight:"95%",overflowY:"auto",boxShadow:"0 8px 30px rgba(0,0,0,0.3)",fontFamily:"Segoe UI, Roboto, sans-serif"}),te.innerHTML=`
      <h2 style="margin-top:0;text-align:center;color:#0a86d8;font-weight:600;"> Nueva Cita</h2>
      <form id="formNuevaCita" style="display:flex;flex-direction:column;gap:12px;margin-top:10px;">
        <label style="font-weight:600;">Paciente existente</label>
        <div style="position:relative;">
          <input type="text" id="buscarPaciente" placeholder="Buscar por nombre, apellido o documento..." autocomplete="off"/>
          <div id="acResultados" style="position:absolute;left:0;right:0;top:calc(100% + 6px);z-index:10000;display:none;background:#fff;border:1px solid #ddd;border-radius:8px;box-shadow:0 8px 22px rgba(0,0,0,.12);max-height:240px;overflow:auto;"></div>
        </div>
        <small style="color:gray;">Si el paciente no existe, marca Registrar nuevo paciente.</small>

        <label style="display:flex;align-items:center;gap:8px;margin-top:5px;">
          <input type="checkbox" id="esNuevoPaciente" />
          <span>Registrar nuevo paciente</span>
        </label>

        <div id="nuevoPacienteCampos" style="display:none;flex-direction:column;gap:8px;margin-top:10px;padding:10px;border-radius:8px;background:#f9f9f9;border:1px solid #ddd;">
          <h4 style="margin:0;text-align:center;color:#0a86d8;">Datos del paciente</h4>
          <div style="display:flex;gap:8px;">
            <input type="text" id="npNombre" placeholder="Nombre" style="flex:1;" />
            <input type="text" id="npApellido" placeholder="Apellido" style="flex:1;" />
          </div>
          <select id="npTipoDocumento">
            <option value="">Tipo de documento</option>
            <option value="CC">Cdula de Ciudadana</option>
            <option value="CE">Cdula de Extranjera</option>
            <option value="TI">Tarjeta de Identidad</option>
            <option value="PA">Pasaporte</option>
            <option value="DI">Documento Internacional</option>
            <option value="OTRO">Otro</option>
          </select>
          <input type="text" id="npDocumento" placeholder="Nmero de documento" />
          <input type="email" id="npCorreo" placeholder="Correo electrnico" />
          <div style="display:flex;gap:5px;">
            <select id="npIndicativo" style="width:40%;">
              <option value="+57"> +57</option>
              <option value="+1"> +1</option>
              <option value="+34"> +34</option>
              <option value="+52"> +52</option>
              <option value="+54"> +54</option>
              <option value="+593"> +593</option>
              <option value="+56"> +56</option>
              <option value="+58"> +58</option>
            </select>
            <input type="tel" id="npCelular" placeholder="Celular (obligatorio)" style="flex:1;" />
          </div>
          <input type="tel" id="npTelefono" placeholder="Telfono fijo (opcional)" />
          <label style="font-weight:500;">Fecha de nacimiento:</label>
          <input type="date" id="npNacimiento" />
          <select id="npSexo">
            <option value="">Sexo</option>
            <option value="Masculino">Masculino</option>
            <option value="Femenino">Femenino</option>
            <option value="Otro">Otro</option>
          </select>
          <textarea id="npComentario" placeholder="Comentario o antecedentes del paciente" rows="2"></textarea>
        </div>

        <hr style="margin:10px 0;border:none;border-top:1px solid #ddd;" />
        <h4 style="margin:0;text-align:center;color:#0a86d8;">Detalles de la cita</h4>
        <input type="text" id="ncDoctor" placeholder="Doctor asignado" required />
        <input type="date" id="ncFecha" required value="${Cp(n)}" />
        <input type="time" id="ncHora" required />
        <input type="text" id="ncEspacio" placeholder="Espacio fsico / Sala" />
        <textarea id="ncComentario" placeholder="Comentario sobre la cita" rows="3"></textarea>

        <div style="display:flex;justify-content:flex-end;gap:10px;margin-top:10px;">
          <button type="button" id="btnCancelarModal" class="btn-cancelar">Cancelar</button>
          <button type="submit" class="btn-guardar">Guardar</button>
        </div>
      </form>
    `;const ue=document.createElement("style");ue.textContent=`
      .btn-cancelar, .btn-guardar { padding: 8px 14px; border: none; border-radius: 6px; cursor: pointer; font-weight: 600; font-size: 14px; transition: .2s; }
      .btn-cancelar { background: #e0e0e0; color: #333; } .btn-cancelar:hover { background: #d5d5d5; }
      .btn-guardar { background: #0a86d8; color: white; } .btn-guardar:hover { background: #0669ac; }
      input, select, textarea { width: 100%; padding: 8px 10px; border: 1px solid #ccc; border-radius: 6px; font-size: 14px; outline: none; }
      input:focus, select:focus, textarea:focus { border-color: #0a86d8; box-shadow: 0 0 0 2px rgba(10,134,216,.2); }
      .ac-item { padding: 8px 10px; display:flex; gap:8px; align-items:baseline; cursor:pointer; }
      .ac-item:hover, .ac-item.active { background:#f5f7fb; }
      .ac-name { font-weight:600; } .ac-doc { color:#64748b; font-size:12px; } .ac-tel { margin-left:auto; font-size:12px; color:#0f172a; }
      .ac-empty { padding:10px; color:#9aa4b2; font-size:13px; }
    `,document.head.appendChild(ue),z.appendChild(te),document.body.appendChild(z);const Ee=te.querySelector("#esNuevoPaciente"),we=te.querySelector("#nuevoPacienteCampos"),ke=te.querySelector("#buscarPaciente"),ae=te.querySelector("#acResultados");Ee.addEventListener("change",()=>{we.style.display=Ee.checked?"flex":"none",Ee.checked&&(ae.style.display="none")}),te.querySelector("#btnCancelarModal").addEventListener("click",()=>z.remove());let nt=null,xe=null,se=-1,De=[];const it=Q=>{if(De=Q||[],se=-1,!Q||Q.length===0){ae.innerHTML='<div class="ac-empty">Sin resultados</div>',ae.style.display="block";return}ae.innerHTML=Q.map((de,Se)=>`
            <div class="ac-item" data-index="${Se}" data-id="${de.id}">
              <span class="ac-name">${de.nombre}</span>
              <span class="ac-doc"> ${de.documento||"s/doc"}</span>
              <span class="ac-tel">${de.celular||de.telefono||""}</span>
            </div>`).join(""),ae.style.display="block",[...ae.querySelectorAll(".ac-item")].forEach(de=>{de.addEventListener("click",()=>{const Se=Number(de.getAttribute("data-index"));rt(Se)})})},rt=Q=>{const de=De[Q];de&&(xe=de,ke.value=de.nombre,ae.style.display="none",Ee.checked=!1,we.style.display="none")},ft=Q=>{De.length&&(se=(se+Q+De.length)%De.length,[...ae.querySelectorAll(".ac-item")].forEach((de,Se)=>{Se===se?de.classList.add("active"):de.classList.remove("active")}))},q=(Q,de)=>Q.nombreCompleto||Q.paciente||[Q.nombres,Q.apellidos].filter(Boolean).join(" ")||de,ne=async Q=>{const de=(Q||"").toString().trim(),Se=_o(de);if(!Se||Se.length<2)return[];if(/^\d{5,}$/.test(de))try{const Ae=tt(Ue(ye,"pacientes"),Ye("documento","==",de)),Be=tt(Ue(ye,"pacientes"),Ye("nroDocumento","==",de)),[Te,Le]=await Promise.all([Wt(Ae),Wt(Be)]),me=Te.empty?Le:Te;if(!me.empty)return me.docs.slice(0,10).map(qe=>{const F=qe.data()||{};return{id:qe.id,nombre:q(F,qe.id),documento:F.documento||F.nroDocumento||qe.id,celular:F.celularPaciente||F.celular||"",telefono:F.telefonoPaciente||F.telefono||""}})}catch{}try{const Ae=tt(Ue(ye,"pacientes"),Gt("nombre_busqueda"),DI(Se),jI(Se+""),Zo(10)),Be=await Wt(Ae);if(!Be.empty)return Be.docs.map(Te=>{const Le=Te.data()||{};return{id:Te.id,nombre:q(Le,Te.id),documento:Le.documento||Le.nroDocumento||Te.id,celular:Le.celularPaciente||Le.celular||"",telefono:Le.telefonoPaciente||Le.telefono||""}})}catch{}try{const Ae=tt(Ue(ye,"pacientes"),Gt("creado","desc"),Zo(50));return(await Wt(Ae)).docs.map(me=>({id:me.id,...me.data()||{}})).map(me=>({id:me.id,nombre:q(me,me.id),documento:me.documento||me.nroDocumento||me.id,celular:me.celularPaciente||me.celular||"",telefono:me.telefonoPaciente||me.telefono||"",_norm:_o(`${me.nombreCompleto||me.paciente||""} ${me.nombres||""} ${me.apellidos||""} ${me.documento||me.nroDocumento||""}`)})).filter(me=>me._norm.includes(Se)).slice(0,10).map(({_norm:me,...qe})=>qe)}catch{}return[]};ke.addEventListener("input",()=>{xe=null;const Q=ke.value;if(clearTimeout(nt),!Q||Q.trim().length<2){ae.style.display="none";return}nt=setTimeout(async()=>{const de=await ne(Q.trim());it(de)},220)}),ke.addEventListener("keydown",Q=>{ae.style.display==="block"&&(Q.key==="ArrowDown"?(Q.preventDefault(),ft(1)):Q.key==="ArrowUp"?(Q.preventDefault(),ft(-1)):Q.key==="Enter"?se>=0&&(Q.preventDefault(),rt(se)):Q.key==="Escape"&&(ae.style.display="none"))}),document.addEventListener("click",Q=>{te.contains(Q.target)&&!ae.contains(Q.target)&&Q.target!==ke&&(ae.style.display="none")},{capture:!0});const H=te.querySelector("#formNuevaCita");H.addEventListener("submit",async Q=>{Q.preventDefault();const de=Ee.checked,Se=(H.querySelector("#buscarPaciente").value||"").trim(),Ae=H.querySelector("#ncDoctor").value.trim(),Be=H.querySelector("#ncFecha").value,Te=H.querySelector("#ncHora").value,Le=H.querySelector("#ncEspacio").value.trim(),me=H.querySelector("#ncComentario").value.trim();if(!Be||!Te){alert(" Debes seleccionar fecha y hora para la cita.");return}if(!Ae){alert(" Indica el doctor asignado.");return}try{let qe=null,F=null,X="",v="",U="";if(de){const Me=(H.querySelector("#npNombre").value||"").trim(),Xt=(H.querySelector("#npApellido").value||"").trim();if(X=`${Me} ${Xt}`.trim(),!X){alert(" Debes indicar nombre y apellido para el nuevo paciente.");return}const Nt=(H.querySelector("#npDocumento").value||"").trim(),St=(H.querySelector("#npCelular").value||"").trim(),We=(H.querySelector("#npTelefono").value||"").trim();if(!St&&!We){alert(" Debes registrar al menos un telfono (celular o fijo) del paciente o de un acudiente.");return}if(qe=Nt||X.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/\s+/g,"_"),F=Kt(ye,"pacientes",qe),!(await ih(F)).exists()){const Pe=_o(X);await oh(F,{nombres:Me,apellidos:Xt,nombreCompleto:X,paciente:X,nombre_busqueda:Pe,variantes_busqueda:[Pe,_o(Me),_o(Xt)],tipoDocumento:H.querySelector("#npTipoDocumento").value,documento:Nt,correo:(H.querySelector("#npCorreo").value||"").trim(),indicativo:H.querySelector("#npIndicativo").value,celular:St,telefono:We,celularPaciente:St,telefonoPaciente:We,fechaNacimiento:H.querySelector("#npNacimiento").value,sexo:H.querySelector("#npSexo").value,notas:(H.querySelector("#npComentario").value||"").trim(),creado:new Date().toISOString(),activo:!0,citas:[]},{merge:!0})}v=St,U=We}else if(xe)qe=xe.id,X=xe.nombre,F=Kt(ye,"pacientes",qe),v=xe.celular||"",U=xe.telefono||"";else{if(!Se){alert(" Por favor, escribe o selecciona un paciente.");return}const Me=tt(Ue(ye,"pacientes"),Ye("documento","==",Se)),Xt=tt(Ue(ye,"pacientes"),Ye("nroDocumento","==",Se)),[Nt,St]=await Promise.all([Wt(Me),Wt(Xt)]),We=Nt.empty?St:Nt;if(We.empty){let pt=null;try{const Pe=_o(Se),ss=tt(Ue(ye,"pacientes"),Gt("nombre_busqueda"),DI(Pe),jI(Pe+""),Zo(1)),pr=await Wt(ss);if(!pr.empty){const bn=pr.docs[0],mr=bn.data()||{};pt={id:bn.id,ref:bn.ref,nombre:mr.nombreCompleto||mr.paciente||[mr.nombres,mr.apellidos].filter(Boolean).join(" "),cel:mr.celularPaciente||mr.celular||"",tel:mr.telefonoPaciente||mr.telefono||""}}}catch{}pt?(qe=pt.id,F=pt.ref,X=pt.nombre||Se,v=pt.cel||"",U=pt.tel||""):X=Se}else{const pt=We.docs[0],Pe=pt.data()||{};qe=pt.id,F=pt.ref,X=Pe.nombreCompleto||Pe.paciente||[Pe.nombres,Pe.apellidos].filter(Boolean).join(" ")||Se,v=Pe.celularPaciente||Pe.celular||"",U=Pe.telefonoPaciente||Pe.telefono||""}}if(!(v||U||"").trim()){alert(" Este paciente no tiene ningn telfono registrado. Edita sus datos y agrega un nmero antes de guardar la cita.");return}const ge={paciente:X||"Paciente",pacienteId:qe||null,doctor:Ae,fecha:Be,horaInicio:Te,espacio:Le,comentario:me,estado:"En espera",creado:new Date().toISOString(),celularPaciente:v||"",telefonoPaciente:U||""},Re=await wl(Ue(ye,"citas"),ge);F&&await oh(F,{citas:OM(Re.id)},{merge:!0}),alert(" Cita registrada correctamente y vinculada al paciente."),z.remove()}catch(qe){console.error(" Error al guardar cita:",qe),alert(" Error al guardar la cita. Revisa la consola para ms detalles.")}})},Ve=z=>{var nt,xe;const te=document.createElement("div");Object.assign(te.style,{position:"fixed",top:"0",left:"0",width:"100%",height:"100%",background:"rgba(0,0,0,0.55)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:"9999"});const ue=document.createElement("div");Object.assign(ue.style,{background:"#fff",padding:"25px 30px",borderRadius:"14px",width:"520px",maxWidth:"95%",maxHeight:"95%",overflowY:"auto",boxShadow:"0 8px 30px rgba(0,0,0,0.3)",fontFamily:"Segoe UI, Roboto, sans-serif"});const Ee=(nt=z.raw)!=null&&nt.fecha&&typeof z.raw.fecha=="string"?z.raw.fecha:Cp(z.fecha),we=((xe=z.raw)==null?void 0:xe.horaInicio)||z.fecha.toTimeString().slice(0,5);ue.innerHTML=`
      <h2 style="margin-top:0;text-align:center;color:#0a86d8;font-weight:600;"> Editar Cita</h2>
      <form id="formEditarCita" style="display:flex;flex-direction:column;gap:12px;margin-top:10px;">
        <label>Paciente</label>
        <input type="text" id="editPaciente" value="${z.paciente||""}" />

        <label>Doctor asignado</label>
        <input type="text" id="editDoctor" value="${z.doctor||""}" />

        <div style="display:flex;gap:8px;">
          <div style="flex:1;">
            <label>Fecha</label>
            <input type="date" id="editFecha" value="${Ee}" />
          </div>
          <div style="flex:1;">
            <label>Hora</label>
            <input type="time" id="editHora" value="${we}" />
          </div>
        </div>

        <label>Espacio fsico / Sala</label>
        <input type="text" id="editEspacio" value="${z.espacio||""}" />

        <label>Estado</label>
        <select id="editEstado" className="estado-select">
          <option value="En espera" ${z.estado==="En espera"?"selected":""}>En espera</option>
          <option value="En sala" ${z.estado==="En sala"?"selected":""}>En sala</option>
          <option value="Atendiendo" ${z.estado==="Atendiendo"?"selected":""}>Atendiendo</option>
          <option value="Finalizada" ${z.estado==="Finalizada"?"selected":""}>Finalizada</option>
          <option value="pendiente" ${z.estado==="pendiente"?"selected":""}>Pendiente</option>
          <option value="No asisti" ${z.estado==="No asisti"?"selected":""}>No asisti</option>
        </select>

        <label>Comentario</label>
        <textarea id="editComentario" rows="3">${z.comentario||""}</textarea>

        <div style="display:flex;justify-content:flex-end;gap:10px;margin-top:10px;">
          <button type="button" id="btnCancelarEdit" className="btn-cancelar">Cancelar</button>
          <button type="submit" className="btn-guardar">Guardar cambios</button>
        </div>
      </form>
    `;const ke=document.createElement("style");ke.textContent=`
      .btn-cancelar, .btn-guardar { padding: 8px 14px; border: none; border-radius: 6px; cursor: pointer; font-weight: 600; font-size: 14px; transition: .2s; }
      .btn-cancelar { background: #e0e0e0; color: #333; } .btn-cancelar:hover { background: #d5d5d5; }
      .btn-guardar { background: #0a86d8; color: white; } .btn-guardar:hover { background: #0669ac; }
      #formEditarCita input, #formEditarCita select, #formEditarCita textarea { width: 100%; padding: 8px 10px; border: 1px solid #ccc; border-radius: 6px; font-size: 14px; outline: none; }
      #formEditarCita input:focus, #formEditarCita select:focus, #formEditarCita textarea:focus { border-color: #0a86d8; box-shadow: 0 0 0 2px rgba(10,134,216,.2); }
    `,document.head.appendChild(ke),te.appendChild(ue),document.body.appendChild(te),ue.querySelector("#btnCancelarEdit").addEventListener("click",()=>te.remove());const ae=ue.querySelector("#formEditarCita");ae.addEventListener("submit",async se=>{se.preventDefault();const De=ae.querySelector("#editPaciente").value.trim(),it=ae.querySelector("#editDoctor").value.trim(),rt=ae.querySelector("#editFecha").value,ft=ae.querySelector("#editHora").value,q=ae.querySelector("#editEspacio").value.trim(),ne=ae.querySelector("#editEstado").value,H=ae.querySelector("#editComentario").value.trim();if(!De)return alert(" El nombre del paciente es obligatorio.");if(!rt||!ft)return alert(" Debes indicar fecha y hora.");try{const Q=Kt(ye,"citas",z.id);await ea(Q,{paciente:De,doctor:it,fecha:rt,horaInicio:ft,espacio:q,estado:ne,comentario:H}),alert(" Cita actualizada correctamente."),te.remove()}catch(Q){console.error(" Error al actualizar cita:",Q),alert(" Error al actualizar la cita. Revisa la consola para ms detalles.")}})},Qe=z=>{const te=z.fecha.toLocaleDateString(_n),ue=z.fecha.toLocaleTimeString(_n,{hour:"numeric",minute:"2-digit",hour12:!0}),Ee=`${te}  ${ue}`;return u.jsxs("tr",{className:"fade-in-row",onClick:()=>Ve(z),style:{cursor:"pointer"},children:[u.jsx("td",{children:Ee}),u.jsx("td",{children:z.paciente}),u.jsx("td",{children:z.doctor}),u.jsx("td",{children:z.espacio}),u.jsx("td",{children:z.comentario}),u.jsx("td",{onClick:we=>{we.stopPropagation()},children:u.jsxs("select",{className:"estado-select",value:z.estado,onChange:we=>he(z.id,we.target.value),children:[u.jsx("option",{value:"En espera",children:"En espera"}),u.jsx("option",{value:"En sala",children:"En sala"}),u.jsx("option",{value:"Atendiendo",children:"Atendiendo"}),u.jsx("option",{value:"Finalizada",children:"Finalizada"}),u.jsx("option",{value:"pendiente",children:"Pendiente"}),u.jsx("option",{value:"No asisti",children:"No asisti"})]})}),u.jsxs("td",{className:"acciones-cell",onClick:we=>{we.stopPropagation()},children:[z.telefono?u.jsx("button",{type:"button",className:"btn-whatsapp",onClick:we=>{we.stopPropagation(),Z(z.telefono,z)},children:"WhatsApp"}):u.jsx("span",{className:"acciones-texto",children:"Sin celular"}),u.jsx("button",{type:"button",className:"btn-delete",onClick:we=>{we.stopPropagation(),ce(z)},children:"Eliminar"}),z.recordatorio&&u.jsx("span",{className:"acciones-texto",children:z.recordatorio})]})]},z.id)};return u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"odc-topbar-green"}),u.jsx("div",{className:"odc-topbar-blue",children:"Agenda"}),u.jsx("section",{className:"odc-agenda-root",children:u.jsxs("div",{className:"odc-agenda-inner",children:[u.jsxs("aside",{className:"odc-left","aria-label":"Panel izquierdo - calendario y filtros",children:[u.jsxs("div",{className:"odc-mini-calendar-card",role:"region","aria-label":"Mini calendario",children:[u.jsxs("div",{className:"mini-cal-header",children:[u.jsx("button",{className:"cal-arrow",id:"miniCalPrev","aria-label":"Mes anterior",onClick:V,children:""}),u.jsx("div",{id:"miniCalMonthYear","aria-live":"polite",children:_}),u.jsx("button",{className:"cal-arrow",id:"miniCalNext","aria-label":"Mes siguiente",onClick:M,children:""})]}),u.jsxs("table",{className:"mini-month-table","aria-hidden":"false",children:[u.jsx("thead",{children:u.jsxs("tr",{children:[u.jsx("th",{children:"Lu"}),u.jsx("th",{children:"Ma"}),u.jsx("th",{children:"Mi"}),u.jsx("th",{children:"Ju"}),u.jsx("th",{children:"Vi"}),u.jsx("th",{children:"Sa"}),u.jsx("th",{children:"Do"})]})}),u.jsx("tbody",{id:"miniCalendar",children:j.map((z,te)=>u.jsx("tr",{children:z.map((ue,Ee)=>u.jsx("td",{className:[ue.isCurrentMonth?"":"empty",ue.isToday?"today":"",ue.isSelected?"selected":""].filter(Boolean).join(" "),onClick:()=>ue.isCurrentMonth&&x(ue.date),children:ue.date.getDate()},Ee))},te))})]})]}),u.jsxs("div",{className:"odc-filters-card","aria-label":"Filtros de agenda",children:[u.jsx("label",{htmlFor:"filterSucursal",children:"Sucursal"}),u.jsxs("select",{id:"filterSucursal",value:h,onChange:z=>f(z.target.value),children:[u.jsx("option",{value:"",children:" Todas "}),A.map(z=>u.jsx("option",{value:z,children:z},z))]}),u.jsx("label",{htmlFor:"filterDoctor",children:"Doctores"}),u.jsxs("select",{id:"filterDoctor",value:m,onChange:z=>w(z.target.value),children:[u.jsx("option",{value:"",children:" Todos "}),T.map(z=>u.jsx("option",{value:z,children:z},z))]})]})]}),u.jsxs("main",{className:"odc-right","aria-label":"Panel principal - agenda",children:[u.jsxs("div",{className:"odc-header-bar",role:"region","aria-label":"Controles de la agenda",style:{display:"flex",alignItems:"center",justifyContent:"space-between",gap:12},children:[u.jsxs("div",{className:"odc-header-left",style:{display:"flex",alignItems:"center",gap:12,flexWrap:"wrap"},children:[u.jsx("h3",{className:"odc-title",style:{marginRight:8},children:"Agenda"}),u.jsxs("div",{className:"view-buttons",role:"tablist","aria-label":"Vistas",style:{display:"flex",gap:6},children:[u.jsx("button",{className:`btn view ${t==="day"?"active":""}`,"data-view":"day",role:"tab","aria-selected":t==="day",onClick:()=>e("day"),children:"Da"}),u.jsx("button",{className:`btn view ${t==="week"?"active":""}`,"data-view":"week",role:"tab","aria-selected":t==="week",onClick:()=>e("week"),children:"Semana"}),u.jsx("button",{className:`btn view ${t==="detail"?"active":""}`,"data-view":"detail",role:"tab","aria-selected":t==="detail",onClick:()=>e("detail"),children:"Detalle"})]}),u.jsxs("div",{className:"date-nav",style:{display:"flex",alignItems:"center",gap:6,flex:"0 0 auto"},children:[u.jsx("button",{className:"btn icon",id:"btnPrev","aria-label":"Anterior",onClick:C,children:""}),u.jsx("button",{className:"btn icon",id:"btnNext","aria-label":"Siguiente",onClick:k,children:""}),u.jsx("span",{id:"currentDateDisplay",className:"current-date","aria-live":"polite",style:{whiteSpace:"nowrap"},children:S}),u.jsx("button",{id:"btnHoy",className:"btn small",onClick:D,children:"Hoy"})]})]}),u.jsx("div",{className:"odc-header-right",style:{display:"flex",alignItems:"center",gap:8,flexShrink:0},children:u.jsxs("div",{className:"right-actions",style:{display:"flex",alignItems:"center",gap:8},children:[u.jsx("input",{id:"searchCitas",placeholder:"Buscar...",className:"search-input","aria-label":"Buscar citas",value:R,onChange:z=>b(z.target.value)}),u.jsx("button",{id:"btnNuevaCita",className:"btn green","aria-label":"Nueva cita",onClick:pe,children:"+ Nueva cita"})]})})]}),u.jsxs("div",{className:"odc-content-card",role:"region","aria-label":"Contenido agenda",children:[u.jsxs("div",{className:"tools-row",children:[u.jsx("div",{className:"tools-left",children:u.jsx("div",{id:"ocupacionInfo",className:"ocupacion-info",children:y})}),u.jsxs("div",{className:"tools-right",children:[u.jsx("button",{id:"btnPrint",className:"btn",title:"Imprimir agenda",onClick:P,children:" Imprimir"}),u.jsx("button",{id:"btnConfirmar",className:"btn blue",title:"Confirmar citas",onClick:Y,children:" Confirmar"}),u.jsx("button",{id:"btnHoyCitas",className:"btn",title:"Ver citas de hoy",onClick:Ge,children:" Hoy"}),u.jsx("button",{id:"btnExportar",className:"btn",title:"Exportar citas a CSV",onClick:Lt,children:" Exportar"})]})]}),u.jsx("div",{className:"table-wrap",role:"region","aria-label":"Lista de citas",children:u.jsxs("table",{className:"appointments-table","aria-live":"polite",children:[u.jsx("thead",{children:u.jsxs("tr",{children:[u.jsx("th",{style:{width:"180px"},children:"Fecha / Hora"}),u.jsx("th",{children:"Paciente"}),u.jsx("th",{children:"Doctor"}),u.jsx("th",{children:"Espacio fsico"}),u.jsx("th",{children:"Comentario"}),u.jsx("th",{style:{width:"120px"},children:"Estado"}),u.jsx("th",{children:"Acciones"})]})}),u.jsx("tbody",{id:"citasTbody",children:o?u.jsx("tr",{children:u.jsx("td",{colSpan:7,className:"no-data",children:"Cargando citas..."})}):E.length===0?u.jsx("tr",{children:u.jsx("td",{colSpan:7,className:"no-data",children:"No hay citas registradas para este rango."})}):E.map(Qe)})]})})]})]})]})})]})}function bU(){return u.jsxs("div",{style:{padding:"20px"},children:[u.jsx("h2",{children:"Mdulo de Facturacin"}),u.jsx("p",{children:"Aqu se registrarn los pagos, facturas y cobros."})]})}function CU(){return u.jsxs("div",{style:{padding:"20px"},children:[u.jsx("h2",{children:"Mdulo de Facturacin"}),u.jsx("p",{children:"Aqu se registrarn los pagos, facturas y cobros."})]})}function AU(){return u.jsxs("div",{style:{padding:"20px"},children:[u.jsx("h2",{children:"Mdulo de Facturacin"}),u.jsx("p",{children:"Aqu se registrarn los pagos, facturas y cobros."})]})}const Ru={caja:"caja",pagos:"facturacion/pagos",facturas:"facturacion/facturas"};var dT;const Pu=typeof navigator<"u"&&((dT=navigator.language)!=null&&dT.startsWith("es"))?"es-ES":"en-US",RU=["Colombia","Argentina","Bolivia","Chile","Costa Rica","Cuba","Ecuador","El Salvador","Espaa","Guatemala","Honduras","Mxico","Nicaragua","Panam","Paraguay","Per","Puerto Rico","Repblica Dominicana","Uruguay","Venezuela","Estados Unidos","Canad"],oT={Colombia:["Bogot","Medelln","Cali","Barranquilla","Cartagena","Ccuta","Bucaramanga","Pereira","Santa Marta","Ibagu"],Mxico:["Ciudad de Mxico","Guadalajara","Monterrey","Puebla","Quertaro","Tijuana","Mrida","Len"],Per:["Lima","Arequipa","Trujillo","Chiclayo","Cusco","Piura"],Chile:["Santiago","Valparaso","Concepcin","La Serena","Antofagasta"],Argentina:["Buenos Aires","Crdoba","Rosario","Mendoza","La Plata"],Espaa:["Madrid","Barcelona","Valencia","Sevilla","Zaragoza","Bilbao"],"Estados Unidos":["Miami","New York","Los ngeles","Houston","Chicago"],Ecuador:["Quito","Guayaquil","Cuenca","Manta"],Venezuela:["Caracas","Maracaibo","Valencia","Barquisimeto","Maracay"]},PU=t=>{if(!t)return"";const[e,n,r]=t.split("-").map(l=>parseInt(l,10)),s=new Date(e,(n||1)-1,r||1),i=new Date;let o=i.getFullYear()-s.getFullYear();const a=i.getMonth()-s.getMonth();return(a<0||a===0&&i.getDate()<s.getDate())&&o--,isNaN(o)?"":String(o)};async function NU(t,{maxW:e=900,maxH:n=900,quality:r=.82}={}){var m;if(!t||!((m=t.type)!=null&&m.startsWith("image/")))return t;const s=await new Promise((w,R)=>{const b=new Image;b.onload=()=>w(b),b.onerror=R,b.src=URL.createObjectURL(t)});let{width:i,height:o}=s;const a=Math.min(e/i,n/o,1);i=Math.round(i*a),o=Math.round(o*a);const l=document.createElement("canvas");l.width=i,l.height=o,l.getContext("2d").drawImage(s,0,0,i,o);const h=await new Promise(w=>l.toBlob(w,"image/jpeg",r)),f=new File([h],(t.name||"foto.jpg").replace(/\.[^.]+$/,".jpg"),{type:"image/jpeg",lastModified:Date.now()});return URL.revokeObjectURL(s.src),f}const El=t=>(t||"").toString().toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/\s+/g," ").trim(),kU=t=>El([t.nombres,t.apellidos,t.nombreCompleto,t.nroDocumento,t.celular,t.email].filter(Boolean).join(" ")),vo={tipoDocumento:"",nroDocumento:"",nroHistoria:"",nombres:"",apellidos:"",nombreCompleto:"",sexo:"",estadoCivil:"",paisNacimiento:"",ciudadNacimiento:"",fechaIngreso:"",fechaNacimiento:"",edad:"",paisDomicilio:"",ciudadDomicilio:"",barrio:"",lugarResidencia:"",estrato:"",zonaResidencial:"",esExtranjero:!1,permitePublicidad:!1,celular:"",telDomicilio:"",telOficina:"",extension:"",email:"",ocupacion:"",nombreResponsable:"",parentesco:"",celularResponsable:"",telefonoResponsable:"",emailResponsable:"",nombreAcompanante:"",telefonoAcompanante:"",convenioBeneficio:"",comoConocio:"",campania:"",remitidoPor:"",asesorComercial:"",tipoVinculacion:"",nombreEps:"",polizaSalud:"",doctor:"",notas:"",rxImagenes:[],historiaClinica:{antecedentes:"",alergias:"",medicamentos:"",motivoConsulta:"",notas:""},odontograma:[],periodontograma:[],presupuestos:[],evoluciones:[],facturacion:{saldoFavor:0,saldoCredito:0},fotoUrl:"",activo:!0},Ap=20,wo=t=>Number(t||0);function DU(t){const[e,n]=N.useState(!1),[r,s]=N.useState([]),[i,o]=N.useState([]),[a,l]=N.useState("");N.useEffect(()=>{let A=!0;return(async()=>{if(!t){s([]),o([]);return}n(!0),l("");try{let E=tt(Ue(ye,"facturas"),Ye("patientId","==",t),Gt("fechaISO","desc"));const V=(await Wt(E)).docs.map(C=>({id:C.id,...C.data()})).map(C=>({...C,total:wo(C.total??C.valor??C.montoTotal),estado:(C.estado||"pendiente").toLowerCase(),fechaISO:C.fechaISO||C.fecha||null}));let M=tt(Ue(ye,"pagos"),Ye("patientId","==",t),Gt("fechaISO","desc"));const S=(await Wt(M)).docs.map(C=>({id:C.id,...C.data()})).map(C=>({...C,monto:wo(C.monto??C.valor??C.total),fechaISO:C.fechaISO||C.fecha||null,medio:C.medio||C.metodo||""}));if(!A)return;s(V),o(S)}catch(E){console.warn("Finanzas: no se pudo leer colecciones. Contino solo con saldos del paciente.",E),A&&l("No se pudieron leer facturas/pagos.")}finally{A&&n(!1)}})(),()=>{A=!1}},[t]);const d=r.reduce((A,T)=>A+wo(T.total),0),h=i.reduce((A,T)=>A+wo(T.monto),0),f=r.filter(A=>["pagada","pagado","paid"].includes((A.estado||"").toLowerCase())),m=r.filter(A=>["pendiente","abierta","open","deuda"].includes((A.estado||"").toLowerCase())),w=f.reduce((A,T)=>A+wo(T.total),0),R=m.reduce((A,T)=>A+wo(T.total),0);return{loading:e,error:a,facturas:r,pagos:i,totalFacturado:d,totalPagado:h,totalFacturasPagadas:w,totalFacturasPendientes:R}}function jU(t){const[e,n]=N.useState(!1),[r,s]=N.useState([]);return N.useEffect(()=>{let i=!0;return(async()=>{if(!t){s([]);return}n(!0);try{const a=tt(Ue(ye,"citas"),Ye("patientId","==",t),Gt("fechaISO","desc"));let d=(await Wt(a)).docs.map(h=>({id:h.id,...h.data()}));if(d.length===0){const h=tt(Ue(ye,"citas"),Ye("pacienteId","==",t),Gt("fechaISO","desc"));d=(await Wt(h)).docs.map(m=>({id:m.id,...m.data()}))}i&&s(d)}catch(a){console.warn("No se pudieron leer citas:",a),i&&s([])}finally{i&&n(!1)}})(),()=>{i=!1}},[t]),{loading:e,citas:r}}function OU(){var Se,Ae,Be,Te,Le,me,qe,F,X;const t=Sc(),e=Or(),n=IT.useMemo(()=>{const v=e.pathname.split("/").filter(Boolean),U=v.findIndex(Re=>["pacientes","agenda","caja","facturacion","config","reportes","software"].includes(Re)),ge="/"+v.slice(0,U>=0?U:v.length).join("/");return ge==="/"?"":ge},[e.pathname]),r=v=>{const U=String(v||"").replace(/^\//,""),re=n?`${n}/`:"/";t(`${re}${U}`)},s=(v,U)=>{const re=String(v).replace(/^\//,""),ge=U?new URLSearchParams(U).toString():"";return`${n?`${n}/`:"/"}${re}${ge?`?${ge}`:""}`},[i,o]=N.useState(!0),[a,l]=N.useState([]),[d,h]=N.useState(""),[f,m]=N.useState(null),[w,R]=N.useState(!0),[b,A]=N.useState(!1),[T,E]=N.useState(null),[y,j]=N.useState(null),V=N.useRef(null),[M,x]=N.useState("datos"),[_,S]=N.useState(vo),[C,k]=N.useState(null),[D,P]=N.useState(""),[Y,Ge]=N.useState([]),Lt=N.useMemo(()=>oT[_.paisNacimiento]||[],[_.paisNacimiento]);N.useEffect(()=>((async()=>{o(!0);try{const re=(await Wt(Ue(ye,"eps"))).docs.map(Re=>{var Me;return(Me=Re.data())==null?void 0:Me.nombre}).filter(Boolean),ge=Array.from(new Map(re.map(Re=>[String(Re).toLowerCase(),Re])).values()).sort((Re,Me)=>Re.localeCompare(Me,"es"));Ge(ge),await pe(!0)}catch(U){console.error(U),alert("No se pudieron cargar pacientes/EPS.")}finally{o(!1)}})(),()=>{V.current&&(V.current(),V.current=null)}),[]),N.useEffect(()=>{S(v=>({...v,nombreCompleto:`${v.nombres} ${v.apellidos}`.trim()}))},[_.nombres,_.apellidos]),N.useEffect(()=>{S(v=>({...v,nroHistoria:v.nroDocumento}))},[_.nroDocumento]),N.useEffect(()=>{S(v=>({...v,edad:PU(v.fechaNacimiento)}))},[_.fechaNacimiento]),N.useEffect(()=>{const v=new Date,U=v.toLocaleDateString(Pu)+" - "+v.toLocaleTimeString(Pu,{hour:"2-digit",minute:"2-digit",hour12:!0});S(re=>({...re,fechaIngreso:U}))},[]);const he=(v,U)=>S(re=>({...re,[v]:U})),Z=()=>{S(vo);const v=new Date,U=v.toLocaleDateString(Pu)+" - "+v.toLocaleTimeString(Pu,{hour:"2-digit",minute:"2-digit",hour12:!0});S(re=>({...re,fechaIngreso:U})),k(null),P(""),E(null)},ce=async v=>{if(!v){k(null),P("");return}try{const U=await NU(v,{maxW:900,maxH:900,quality:.82});k(U);const re=new FileReader;re.onload=ge=>P(ge.target.result),re.readAsDataURL(U)}catch{k(v);const U=new FileReader;U.onload=re=>P(re.target.result),U.readAsDataURL(v)}},pe=async(v=!1)=>{o(!0);try{let U;v||!f?U=tt(Ue(ye,"pacientes"),Gt("creado","desc"),Zo(Ap)):U=tt(Ue(ye,"pacientes"),Gt("creado","desc"),RM(f),Zo(Ap));const re=await Wt(U),ge=re.docs.map(Re=>({id:Re.id,...Re.data()}));l(v?ge:Re=>[...Re,...ge]),m(re.docs[re.docs.length-1]||null),R(re.size===Ap)}catch(U){console.error(U),alert("No se pudo cargar pacientes.")}finally{o(!1)}},Ve=async v=>{if(v.preventDefault(),!_.nroDocumento.trim())return alert("El nmero de documento es obligatorio.");if(!_.nombres.trim())return alert("Los nombres son obligatorios.");if(!_.apellidos.trim())return alert("Los apellidos son obligatorios.");if(!_.sexo.trim())return alert("El sexo es obligatorio.");if(!_.fechaNacimiento.trim())return alert("La fecha de nacimiento es obligatoria.");if(!_.celular.trim())return alert("El celular es obligatorio.");if(!_.email.trim())return alert("El correo electrnico es obligatorio.");if(!_.tipoVinculacion.trim())return alert("El tipo de vinculacin es obligatorio.");if(!_.nombreEps.trim())return alert("El nombre de la EPS es obligatorio.");try{const U=_.nroDocumento.trim();if(!T&&(await ih(Kt(ye,"pacientes",U))).exists())return alert("Ya existe un paciente con ese nmero de documento.");const re=(_.nombreEps||"").trim(),ge=Y.map(We=>We.toLowerCase()).includes(re.toLowerCase());if(re&&!ge&&window.confirm(`La EPS "${re}" no existe. Deseas guardarla para futuras selecciones?`)){const pt=re.toLowerCase().replace(/\s+/g,"_");await oh(Kt(ye,"eps",pt),{nombre:re,nombreLower:re.toLowerCase(),creado:Mn()},{merge:!0})}let Re=_.fotoUrl||"",Me="";if(C)try{const We=Ei(),pt=(C.name||"foto.jpg").replace(/\s+/g,"_");Me=`pacientes/${U}/${Date.now()}_${pt}`;const Pe=ll(We,Me),ss={contentType:C.type||"image/jpeg",cacheControl:"public, max-age=86400"};await qI(Pe,C,ss),Re=await WI(Pe)}catch(We){console.error("Foto (warning):",We)}const Xt=_.creado||null,Nt=T&&Xt||Mn(),St={..._,fotoUrl:Re,nombre_busqueda:kU({..._,fotoUrl:Re}),nombresLower:El(_.nombres),apellidosLower:El(_.apellidos),documentoLower:El(_.nroDocumento),emailLower:El(_.email),creado:Nt,createdAt:Nt,actualizado:Mn(),updatedAt:Mn(),activo:_.activo??!0,celularPaciente:_.celular,telefonoPaciente:_.telDomicilio||"",documento:_.nroDocumento,paciente:_.nombreCompleto};if(await oh(Kt(ye,"pacientes",U),St,{merge:!0}),Me)try{const We=Ei(),pt=ll(We,`pacientes/${U}`),Pe=await HI(pt),ss=Me,pr=Pe.items.filter(bn=>bn.fullPath!==ss).map(bn=>wp(bn).catch(()=>null));await Promise.allSettled(pr)}catch(We){console.warn("No se pudo limpiar fotos antiguas:",We)}alert(T?" Paciente actualizado.":" Paciente guardado."),l(We=>{const pt=We.filter(Pe=>Pe.id!==U);return[{id:U,...St},...pt]}),A(!1),E(null),Z()}catch(U){console.error("Error guardando paciente:",U),alert(`No se pudo guardar el paciente.

`+((U==null?void 0:U.message)||U))}},Qe=()=>{Z(),A(!0)},z=()=>{y&&(S({...vo,...y,fotoUrl:y.fotoUrl||""}),k(null),P(y.fotoUrl||""),E(y.id),we(),A(!0))},te=async v=>{if(window.confirm(`Eliminar al paciente "${v.nombreCompleto}"?`))try{await eA(Kt(ye,"pacientes",v.id)),l(U=>U.filter(re=>re.id!==v.id));try{const U=Ei(),re=ll(U,`pacientes/${v.id}`),Re=(await HI(re)).items.map(Me=>wp(Me).catch(()=>null));await Promise.allSettled(Re)}catch(U){console.warn("No se pudo borrar la carpeta de fotos:",U)}}catch(U){console.error(U),alert("No se pudo eliminar.")}},ue=N.useMemo(()=>{const v=d.trim().toLowerCase();return v?a.filter(U=>`${U.nombreCompleto||U.paciente||""} ${U.nroDocumento||""} ${U.celular||U.celularPaciente||""} ${U.email||""}`.toLowerCase().includes(v)):a},[a,d]),Ee=v=>{we();const U=Kt(ye,"pacientes",v.id),re=rr(U,ge=>{ge.exists()?j({id:ge.id,...ke(ge.data())}):j(null)});V.current=re,x("datos")},we=()=>{V.current&&(V.current(),V.current=null),j(null)},ke=v=>({...vo,...v,historiaClinica:{...vo.historiaClinica,...v.historiaClinica||{}},facturacion:{...vo.facturacion,...v.facturacion||{}},rxImagenes:Array.isArray(v.rxImagenes)?v.rxImagenes:[],odontograma:Array.isArray(v.odontograma)?v.odontograma:[],periodontograma:Array.isArray(v.periodontograma)?v.periodontograma:[],presupuestos:Array.isArray(v.presupuestos)?v.presupuestos:[],evoluciones:Array.isArray(v.evoluciones)?v.evoluciones:[]}),ae=async v=>{if(y!=null&&y.id)try{await ea(Kt(ye,"pacientes",y.id),{...v,actualizado:Mn(),updatedAt:Mn()})}catch(U){console.error(U),alert("No se pudo actualizar.")}},nt=async v=>{if(!(y!=null&&y.id)||!(v!=null&&v.length))return;const U=Ei(),re=[];for(const ge of v){const Re=(ge.name||"archivo").replace(/\s+/g,"_"),Me=`pacientes/${y.id}/rx/${Date.now()}_${Re}`,Xt=ll(U,Me);await qI(Xt,ge,{contentType:ge.type});const Nt=await WI(Xt);re.push({url:Nt,name:ge.name,type:ge.type,size:ge.size||0,created:Date.now(),path:Me})}await ae({rxImagenes:[...y.rxImagenes||[],...re]})},xe=async v=>{if(!(y!=null&&y.id))return;const U=y.rxImagenes[v],re=y.rxImagenes.filter((ge,Re)=>Re!==v);await ae({rxImagenes:re});try{if(U!=null&&U.path){const ge=Ei();await wp(ll(ge,U.path))}}catch(ge){console.warn("No se pudo borrar del Storage:",ge)}},se=(v,U)=>{const re={...y.historiaClinica||{},[v]:U};ae({historiaClinica:re})},De=v=>{const U=[...y.presupuestos||[],{id:String(Date.now()),...v}];ae({presupuestos:U})},it=v=>{ae({presupuestos:(y.presupuestos||[]).filter(U=>U.id!==v)})},rt=v=>{const U=[...y.evoluciones||[],{id:String(Date.now()),fechaISO:new Date().toISOString(),nota:v}];ae({evoluciones:U})},ft=v=>{ae({evoluciones:(y.evoluciones||[]).filter(U=>U.id!==v)})},q=(v,U)=>{const re=Array.isArray(y[v])?y[v]:[],ge=re.find(Me=>Me.pieza===U);let Re;ge?Re=re.filter(Me=>Me.pieza!==U):Re=[...re,{pieza:U,estado:"marcada"}],ae({[v]:Re})},ne=(y==null?void 0:y.id)||null,H=DU(ne),{loading:Q,citas:de}=jU(ne);return u.jsxs("div",{className:"odc-container",children:[u.jsx("div",{className:"odc-topbar-green"}),u.jsx("div",{className:"odc-topbar-blue",children:u.jsx("div",{className:"odc-top-inner",children:u.jsx("div",{className:"odc-breadcrumbs",children:"Pacientes"})})}),u.jsxs("div",{className:"odc-card",children:[u.jsxs("div",{className:"odc-card-header",children:[u.jsx("h3",{className:"odc-title",children:"Pacientes"}),u.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[u.jsx("input",{className:"search-input",style:{minWidth:280},placeholder:"Buscar por nombre, documento o telfono",value:d,onChange:v=>h(v.target.value)}),u.jsx("button",{type:"button",className:"btn green",onClick:Qe,children:"+ Nuevo paciente"})]})]}),u.jsx("div",{className:"table-wrap",children:u.jsxs("table",{className:"appointments-table",children:[u.jsx("thead",{children:u.jsxs("tr",{children:[u.jsx("th",{children:"Foto"}),u.jsx("th",{children:"Nombre"}),u.jsx("th",{children:"Documento"}),u.jsx("th",{children:"Celular"}),u.jsx("th",{children:"Correo"}),u.jsx("th",{children:"Estado"})]})}),u.jsx("tbody",{children:i&&a.length===0?u.jsx("tr",{children:u.jsx("td",{className:"no-data",colSpan:6,children:"Cargando"})}):ue.length===0?u.jsx("tr",{children:u.jsx("td",{className:"no-data",colSpan:6,children:"No hay pacientes o no coinciden con la bsqueda."})}):ue.map(v=>u.jsxs("tr",{className:"row-click",onClick:()=>Ee(v),children:[u.jsx("td",{onClick:U=>U.stopPropagation(),children:v.fotoUrl?u.jsx("img",{src:v.fotoUrl,alt:"Foto",style:{width:36,height:36,borderRadius:"50%",objectFit:"cover"}}):u.jsx("div",{className:"avatar-fallback",children:(v.nombreCompleto||"P")[0]})}),u.jsx("td",{children:v.nombreCompleto||v.paciente||""}),u.jsx("td",{children:v.nroDocumento||v.documento||""}),u.jsx("td",{children:v.celular||v.celularPaciente||""}),u.jsx("td",{children:v.email||""}),u.jsx("td",{children:u.jsx("span",{className:"pill pill-ok",children:v.activo?"Activo":"Inactivo"})})]},v.id))})]})}),u.jsxs("div",{className:"footer-actions",children:[u.jsx("button",{type:"button",className:"btn",disabled:i||!w,onClick:()=>pe(!1),children:w?"Cargar ms":"No hay ms"}),u.jsxs("div",{className:"hint",children:[a.length," registros cargados"]})]})]}),b&&u.jsxs("div",{className:"odc-modal",role:"dialog","aria-modal":"true",children:[u.jsx("div",{className:"odc-modal-backdrop",onClick:()=>A(!1)}),u.jsxs("div",{className:"odc-card",style:{width:1e3,maxWidth:"95%",maxHeight:"92vh",overflowY:"auto"},children:[u.jsxs("div",{className:"odc-card-header",children:[u.jsx("h3",{className:"odc-title",children:T?"Editar paciente":"Nuevo paciente"}),u.jsx("button",{type:"button",className:"btn",onClick:()=>A(!1),children:""})]}),u.jsxs("form",{onSubmit:Ve,children:[u.jsx("div",{className:"form-section-title",children:"Foto del paciente"}),u.jsxs("div",{className:"foto-row",children:[u.jsxs("label",{className:"foto-drop",children:[u.jsx("input",{type:"file",accept:"image/*",onChange:v=>{var U;return ce(((U=v.target.files)==null?void 0:U[0])||null)},style:{display:"none"}}),D?u.jsx("img",{src:D,alt:"Preview",className:"foto-preview"}):u.jsx("div",{className:"foto-empty",children:"Arrastra o haz clic para cargar"})]}),D&&u.jsx("button",{type:"button",className:"btn",onClick:()=>ce(null),children:"Quitar foto"})]}),u.jsx("div",{className:"form-section-title",children:"Datos de identificacin"}),u.jsxs("div",{className:"form-grid",children:[u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Tipo de documento *"}),u.jsxs("select",{className:"form-input",value:_.tipoDocumento,onChange:v=>he("tipoDocumento",v.target.value),children:[u.jsx("option",{value:"",children:"Seleccione"}),u.jsx("option",{value:"CC",children:"Cdula"}),u.jsx("option",{value:"TI",children:"Tarjeta de identidad"}),u.jsx("option",{value:"PA",children:"Pasaporte"}),u.jsx("option",{value:"OTRO",children:"Otro"})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Nro. de documento *"}),u.jsx("input",{className:"form-input",value:_.nroDocumento,onChange:v=>he("nroDocumento",v.target.value),placeholder:"Nmero de documento",required:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Nmero de Historia"}),u.jsx("input",{className:"form-input",value:_.nroHistoria,readOnly:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Nombres *"}),u.jsx("input",{className:"form-input",value:_.nombres,onChange:v=>he("nombres",v.target.value),required:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Apellidos *"}),u.jsx("input",{className:"form-input",value:_.apellidos,onChange:v=>he("apellidos",v.target.value),required:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Nombre completo"}),u.jsx("input",{className:"form-input",value:_.nombreCompleto,readOnly:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Sexo *"}),u.jsxs("select",{className:"form-input",value:_.sexo,onChange:v=>he("sexo",v.target.value),required:!0,children:[u.jsx("option",{value:"",children:"Seleccione"}),u.jsx("option",{children:"Masculino"}),u.jsx("option",{children:"Femenino"}),u.jsx("option",{children:"Otro"})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Estado civil *"}),u.jsxs("select",{className:"form-input",value:_.estadoCivil,onChange:v=>he("estadoCivil",v.target.value),required:!0,children:[u.jsx("option",{value:"",children:"Seleccione"}),u.jsx("option",{children:"Soltero"}),u.jsx("option",{children:"Casado"}),u.jsx("option",{children:"Unin libre"}),u.jsx("option",{children:"Divorciado"}),u.jsx("option",{children:"Viudo"})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Pas de nacimiento *"}),u.jsx("input",{className:"form-input",list:"listCountries",value:_.paisNacimiento,onChange:v=>he("paisNacimiento",v.target.value),placeholder:"Escribe y elige",required:!0}),u.jsx("datalist",{id:"listCountries",children:RU.map(v=>u.jsx("option",{value:v},v))})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Ciudad de nacimiento"}),u.jsx("input",{className:"form-input",list:"listCitiesBirth",value:_.ciudadNacimiento,onChange:v=>he("ciudadNacimiento",v.target.value),placeholder:"Escribe y elige"}),u.jsx("datalist",{id:"listCitiesBirth",children:Lt.map(v=>u.jsx("option",{value:v},v))})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Fecha de ingreso"}),u.jsx("input",{className:"form-input",value:_.fechaIngreso,readOnly:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Fecha de nacimiento *"}),u.jsx("input",{type:"date",className:"form-input",value:_.fechaNacimiento,onChange:v=>he("fechaNacimiento",v.target.value),required:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Edad"}),u.jsx("input",{className:"form-input",value:_.edad,readOnly:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Pas de domicilio *"}),u.jsx("input",{className:"form-input",list:"listCountries",value:_.paisDomicilio,onChange:v=>he("paisDomicilio",v.target.value),required:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Ciudad de domicilio *"}),u.jsx("input",{className:"form-input",list:"listCitiesHome",value:_.ciudadDomicilio,onChange:v=>he("ciudadDomicilio",v.target.value),required:!0}),u.jsx("datalist",{id:"listCitiesHome",children:(oT[_.paisDomicilio]||[]).map(v=>u.jsx("option",{value:v},v))})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Barrio *"}),u.jsx("input",{className:"form-input",value:_.barrio,onChange:v=>he("barrio",v.target.value),required:!0,placeholder:"Barrio"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Lugar de residencia *"}),u.jsx("input",{className:"form-input",value:_.lugarResidencia,onChange:v=>he("lugarResidencia",v.target.value),required:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Estrato"}),u.jsxs("select",{className:"form-input",value:_.estrato,onChange:v=>he("estrato",v.target.value),children:[u.jsx("option",{value:"",children:"Seleccione"}),u.jsx("option",{children:"1"}),u.jsx("option",{children:"2"}),u.jsx("option",{children:"3"}),u.jsx("option",{children:"4"}),u.jsx("option",{children:"5"}),u.jsx("option",{children:"6"})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Zona residencial *"}),u.jsxs("select",{className:"form-input",value:_.zonaResidencial,onChange:v=>he("zonaResidencial",v.target.value),required:!0,children:[u.jsx("option",{value:"",children:"Seleccione"}),u.jsx("option",{children:"Urbana"}),u.jsx("option",{children:"Rural"})]})]}),u.jsxs("div",{className:"checkbox-cell",children:[u.jsx("label",{className:"form-label",children:"Es extranjero?"}),u.jsx("input",{type:"checkbox",checked:_.esExtranjero,onChange:v=>he("esExtranjero",v.target.checked)})]}),u.jsxs("div",{className:"checkbox-cell",children:[u.jsx("label",{className:"form-label",children:"Permite publicidad?"}),u.jsx("input",{type:"checkbox",checked:_.permitePublicidad,onChange:v=>he("permitePublicidad",v.target.checked)})]})]}),u.jsx("div",{className:"form-section-title",children:"Contacto"}),u.jsxs("div",{className:"form-grid",children:[u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Celular *"}),u.jsx("input",{className:"form-input",value:_.celular,onChange:v=>he("celular",v.target.value),required:!0,placeholder:"Celular del paciente"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Telfono de domicilio"}),u.jsx("input",{className:"form-input",value:_.telDomicilio,onChange:v=>he("telDomicilio",v.target.value)})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Telfono de oficina"}),u.jsx("input",{className:"form-input",value:_.telOficina,onChange:v=>he("telOficina",v.target.value)})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Extensin"}),u.jsx("input",{className:"form-input",value:_.extension,onChange:v=>he("extension",v.target.value)})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Correo electrnico *"}),u.jsx("input",{type:"email",className:"form-input",value:_.email,onChange:v=>he("email",v.target.value),required:!0,placeholder:"correo@dominio.com"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Ocupacin *"}),u.jsx("input",{className:"form-input",value:_.ocupacion,onChange:v=>he("ocupacion",v.target.value),required:!0})]})]}),u.jsx("div",{className:"form-section-title",children:"Datos de facturacin"}),u.jsxs("div",{className:"form-grid",children:[u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Responsable"}),u.jsx("input",{className:"form-input",value:_.nombreResponsable,onChange:v=>he("nombreResponsable",v.target.value)})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Parentesco"}),u.jsxs("select",{className:"form-input",value:_.parentesco,onChange:v=>he("parentesco",v.target.value),children:[u.jsx("option",{value:"",children:"Seleccione"}),u.jsx("option",{children:"Padre/Madre"}),u.jsx("option",{children:"Hermano"}),u.jsx("option",{children:"Esposo/a"}),u.jsx("option",{children:"Otro"})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Celular"}),u.jsx("input",{className:"form-input",value:_.celularResponsable,onChange:v=>he("celularResponsable",v.target.value)})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Telfono"}),u.jsx("input",{className:"form-input",value:_.telefonoResponsable,onChange:v=>he("telefonoResponsable",v.target.value)})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Correo electrnico"}),u.jsx("input",{type:"email",className:"form-input",value:_.emailResponsable,onChange:v=>he("emailResponsable",v.target.value)})]})]}),u.jsx("div",{className:"form-section-title",children:"Acompaante"}),u.jsxs("div",{className:"form-grid",children:[u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Nombre"}),u.jsx("input",{className:"form-input",value:_.nombreAcompanante,onChange:v=>he("nombreAcompanante",v.target.value),placeholder:"Nombre acompaante"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Telfono"}),u.jsx("input",{className:"form-input",value:_.telefonoAcompanante,onChange:v=>he("telefonoAcompanante",v.target.value),placeholder:"Telfono acompaante"})]})]}),u.jsx("div",{className:"form-section-title",children:"Mercadeo"}),u.jsxs("div",{className:"form-grid",children:[u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Convenio beneficio"}),u.jsx("input",{className:"form-input",value:_.convenioBeneficio,onChange:v=>he("convenioBeneficio",v.target.value)})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Cmo nos conoci?"}),u.jsxs("select",{className:"form-input",value:_.comoConocio,onChange:v=>he("comoConocio",v.target.value),children:[u.jsx("option",{value:"",children:"Seleccione"}),u.jsx("option",{children:"Redes sociales"}),u.jsx("option",{children:"Publicidad"}),u.jsx("option",{children:"Recomendacin"}),u.jsx("option",{children:"Otro"})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Campaa"}),u.jsx("input",{className:"form-input",value:_.campania,onChange:v=>he("campania",v.target.value)})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Remitido por"}),u.jsx("input",{className:"form-input",value:_.remitidoPor,onChange:v=>he("remitidoPor",v.target.value)})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Asesor comercial"}),u.jsx("input",{className:"form-input",value:_.asesorComercial,onChange:v=>he("asesorComercial",v.target.value)})]})]}),u.jsx("div",{className:"form-section-title",children:"EPS"}),u.jsxs("div",{className:"form-grid",children:[u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Tipo de vinculacin *"}),u.jsxs("select",{className:"form-input",value:_.tipoVinculacion,onChange:v=>he("tipoVinculacion",v.target.value),required:!0,children:[u.jsx("option",{value:"",children:"Seleccione"}),u.jsx("option",{children:"Contributivo"}),u.jsx("option",{children:"Subsidiado"}),u.jsx("option",{children:"Particular"}),u.jsx("option",{children:"Otro"})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Nombre de la EPS *"}),u.jsx("input",{className:"form-input",list:"listEps",value:_.nombreEps,onChange:v=>he("nombreEps",v.target.value),placeholder:"Escribe y selecciona",required:!0}),u.jsx("datalist",{id:"listEps",children:Y.map(v=>u.jsx("option",{value:v},v))})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Pliza de salud"}),u.jsx("input",{className:"form-input",value:_.polizaSalud,onChange:v=>he("polizaSalud",v.target.value)})]})]}),u.jsx("div",{className:"form-section-title",children:"Doctor"}),u.jsx("div",{className:"form-grid",children:u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Doctor"}),u.jsx("input",{className:"form-input",value:_.doctor,onChange:v=>he("doctor",v.target.value),placeholder:"Usuario / Libre"})]})}),u.jsx("div",{className:"form-section-title",children:"Alertas y Notas"}),u.jsx("div",{className:"form-grid",children:u.jsx("textarea",{className:"form-input",rows:3,value:_.notas,onChange:v=>he("notas",v.target.value),placeholder:"Notas del paciente"})}),u.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:8,marginTop:12},children:[T?u.jsx("button",{type:"button",className:"btn",onClick:()=>te({id:T,nombreCompleto:_.nombreCompleto}),children:"Eliminar"}):u.jsx("div",{}),u.jsxs("div",{style:{display:"flex",gap:8},children:[u.jsx("button",{type:"button",className:"btn",onClick:()=>A(!1),children:"Cancelar"}),u.jsx("button",{type:"submit",className:"btn blue",children:T?"Actualizar":"Guardar paciente"})]})]})]})]})]}),y&&u.jsxs("div",{className:"odc-modal",role:"dialog","aria-modal":"true",children:[u.jsx("div",{className:"odc-modal-backdrop",onClick:we}),u.jsxs("div",{className:"odc-card ficha-card",children:[u.jsxs("div",{className:"ficha-header",children:[u.jsxs("div",{className:"ficha-header-left",children:[y.fotoUrl?u.jsx("img",{src:y.fotoUrl,alt:"Foto",className:"ficha-avatar"}):u.jsx("div",{className:"avatar-fallback ficha-avatar-fallback",children:(y.nombreCompleto||"P")[0]}),u.jsxs("div",{children:[u.jsx("div",{className:"ficha-nombre",children:y.nombreCompleto||""}),u.jsxs("div",{className:"ficha-doc",children:[y.tipoDocumento||""," ",y.nroDocumento||""]}),u.jsxs("div",{className:"ficha-badges",children:[u.jsx("span",{className:"ficha-badge blue",children:"En valoracin"}),u.jsx("span",{className:"ficha-badge green",children:"Sin deuda"})]})]})]}),u.jsx("div",{className:"ficha-header-right",children:u.jsxs("div",{className:"ficha-actions",children:[u.jsx("button",{type:"button",className:"btn",onClick:we,children:"Cerrar"}),u.jsx("button",{type:"button",className:"btn blue",onClick:z,children:"Editar"}),u.jsx("button",{type:"button",className:"btn green",onClick:()=>t(s(Ru.caja,{cobro:1,patientId:y.id})),title:"Ir a Caja para cobrar a este paciente",children:"Cobrar"})]})})]}),u.jsxs("div",{className:"ficha-body",children:[u.jsxs("aside",{className:"ficha-sidebar",children:[u.jsx("div",{className:"ficha-sidebar-title",children:"Informacin general"}),u.jsx("button",{type:"button",className:`ficha-link ${M==="datos"?"active":""}`,onClick:()=>x("datos"),children:"Datos personales"}),u.jsx("button",{type:"button",className:`ficha-link ${M==="marketing"?"active":""}`,onClick:()=>x("marketing"),children:"Marketing"}),u.jsx("button",{type:"button",className:`ficha-link ${M==="eps"?"active":""}`,onClick:()=>x("eps"),children:"EPS"}),u.jsx("button",{type:"button",className:`ficha-link ${M==="prof"?"active":""}`,onClick:()=>x("prof"),children:"Profesionales"}),u.jsx("button",{type:"button",className:`ficha-link ${M==="rx"?"active":""}`,onClick:()=>x("rx"),children:"Rx/Imgenes/Doc"}),u.jsx("button",{type:"button",className:`ficha-link ${M==="citas"?"active":""}`,onClick:()=>x("citas"),children:"Citas"}),u.jsx("button",{type:"button",className:`ficha-link ${M==="crm"?"active":""}`,onClick:()=>x("crm"),children:"CRM"}),u.jsx("div",{className:"ficha-sidebar-title mt",children:"Historia clnica"}),u.jsx("button",{type:"button",className:`ficha-link ${M==="doc"?"active":""}`,onClick:()=>x("doc"),children:"Doc. Clnicos"}),u.jsx("button",{type:"button",className:`ficha-link ${M==="odonto"?"active":""}`,onClick:()=>x("odonto"),children:"Odontogramas"}),u.jsx("button",{type:"button",className:`ficha-link ${M==="perio"?"active":""}`,onClick:()=>x("perio"),children:"Periodontogramas"}),u.jsx("button",{type:"button",className:`ficha-link ${M==="presu"?"active":""}`,onClick:()=>x("presu"),children:"Presupuestos"}),u.jsx("button",{type:"button",className:`ficha-link ${M==="evo"?"active":""}`,onClick:()=>x("evo"),children:"Evoluciones"}),u.jsx("div",{className:"ficha-sidebar-title mt",children:"Facturacin"}),u.jsx("button",{type:"button",className:`ficha-link ${M==="fact"?"active":""}`,onClick:()=>x("fact"),children:"Resumen"}),u.jsxs("div",{className:"ficha-sidebar-actions",style:{display:"grid",gap:8,marginTop:8},children:[u.jsx("button",{type:"button",className:"btn pay",onClick:()=>t(s(Ru.caja,{cobro:1,patientId:y.id})),title:"Cobrar a este paciente",children:"Realizar pago"}),u.jsx("button",{type:"button",className:"btn history",onClick:()=>r(`${Ru.pagos}?patientId=${encodeURIComponent(y.id)}`),title:"Ver histrico de pagos",children:"Histrico de pagos"}),u.jsx("button",{type:"button",className:"btn history",onClick:()=>r(`${Ru.facturas}?patientId=${encodeURIComponent(y.id)}`),title:"Ver histrico de facturacin",children:"Histrico de facturacin"})]})]}),u.jsxs("main",{className:"ficha-content",children:[M==="datos"&&u.jsxs("section",{className:"ficha-section",children:[u.jsx("h4",{className:"ficha-section-title",children:"Datos personales"}),u.jsx("div",{className:"ficha-grid",children:[["Tipo de documento",y.tipoDocumento],["Nro. de documento",y.nroDocumento],["Nmero de Historia",y.nroHistoria],["Fecha de ingreso",y.fechaIngreso],["Nombres",y.nombres],["Apellidos",y.apellidos],["Nombre completo",y.nombreCompleto],["Sexo",y.sexo],["Estado civil",y.estadoCivil],["Pas de nacimiento",y.paisNacimiento],["Ciudad de nacimiento",y.ciudadNacimiento],["Fecha de nacimiento",y.fechaNacimiento],["Edad",y.edad],["Pas de domicilio",y.paisDomicilio],["Ciudad de domicilio",y.ciudadDomicilio],["Barrio",y.barrio],["Lugar de residencia",y.lugarResidencia],["Estrato",y.estrato],["Zona residencial",y.zonaResidencial],["Extranjero",y.esExtranjero?"S":"No"],["Permite publicidad",y.permitePublicidad?"S":"No"],["Celular",y.celular||y.celularPaciente],["Telfono domicilio",y.telDomicilio||y.telefonoPaciente],["Telfono oficina",y.telOficina],["Extensin",y.extension],["Correo electrnico",y.email],["Ocupacin",y.ocupacion],["Responsable",y.nombreResponsable],["Parentesco",y.parentesco],["Cel. responsable",y.celularResponsable],["Tel. responsable",y.telefonoResponsable],["Email responsable",y.emailResponsable],["Acompaante",y.nombreAcompanante],["Tel. acompaante",y.telefonoAcompanante]].map(([v,U])=>u.jsxs("div",{className:"field",children:[u.jsx("label",{children:v}),u.jsx("input",{className:"form-input",value:U||"",readOnly:!0})]},v))})]}),M==="marketing"&&u.jsxs("section",{className:"ficha-section",children:[u.jsx("h4",{className:"ficha-section-title",children:"Marketing"}),u.jsx("div",{className:"ficha-grid",children:[["Convenio beneficio",y.convenioBeneficio],["Cmo nos conoci?",y.comoConocio],["Campaa",y.campania],["Remitido por",y.remitidoPor],["Asesor comercial",y.asesorComercial]].map(([v,U])=>u.jsxs("div",{className:"field",children:[u.jsx("label",{children:v}),u.jsx("input",{className:"form-input",value:U||"",readOnly:!0})]},v))})]}),M==="eps"&&u.jsxs("section",{className:"ficha-section",children:[u.jsx("h4",{className:"ficha-section-title",children:"EPS"}),u.jsx("div",{className:"ficha-grid",children:[["Tipo de vinculacin",y.tipoVinculacion],["Nombre EPS",y.nombreEps],["Pliza de salud",y.polizaSalud]].map(([v,U])=>u.jsxs("div",{className:"field",children:[u.jsx("label",{children:v}),u.jsx("input",{className:"form-input",value:U||"",readOnly:!0})]},v))})]}),M==="prof"&&u.jsxs("section",{className:"ficha-section",children:[u.jsx("h4",{className:"ficha-section-title",children:"Profesionales"}),u.jsx("div",{className:"ficha-grid",children:u.jsxs("div",{className:"field",children:[u.jsx("label",{children:"Doctor"}),u.jsx("input",{className:"form-input",value:y.doctor||"",readOnly:!0})]})})]}),M==="rx"&&u.jsxs("section",{className:"ficha-section",children:[u.jsx("h4",{className:"ficha-section-title",children:"Rx / Imgenes / Documentos"}),u.jsx("div",{className:"rx-actions",children:u.jsxs("label",{className:"btn blue",children:["Subir archivos",u.jsx("input",{type:"file",multiple:!0,style:{display:"none"},onChange:v=>nt([...v.target.files])})]})}),u.jsxs("div",{className:"rx-grid",children:[(y.rxImagenes||[]).map((v,U)=>{var re;return u.jsxs("div",{className:"rx-item",children:[(re=v.type)!=null&&re.startsWith("image/")?u.jsx("a",{href:v.url,target:"_blank",rel:"noreferrer",children:u.jsx("img",{src:v.url,alt:v.name})}):u.jsx("a",{className:"rx-file",href:v.url,target:"_blank",rel:"noreferrer",children:v.name||"archivo"}),u.jsxs("div",{className:"rx-meta",children:[u.jsx("span",{children:v.name}),u.jsx("button",{type:"button",className:"btn small",onClick:()=>xe(U),children:"Eliminar"})]})]},`${v.url}-${U}`)}),(!y.rxImagenes||y.rxImagenes.length===0)&&u.jsx("div",{className:"no-data",children:"Sin archivos an."})]})]}),M==="doc"&&u.jsxs("section",{className:"ficha-section",children:[u.jsx("h4",{className:"ficha-section-title",children:"Doc. Clnicos"}),u.jsxs("div",{className:"ficha-grid",children:[u.jsxs("div",{className:"field",children:[u.jsx("label",{children:"Motivo de consulta"}),u.jsx("textarea",{className:"form-input",rows:3,value:((Se=y.historiaClinica)==null?void 0:Se.motivoConsulta)||"",onChange:v=>se("motivoConsulta",v.target.value)})]}),u.jsxs("div",{className:"field",children:[u.jsx("label",{children:"Antecedentes"}),u.jsx("textarea",{className:"form-input",rows:3,value:((Ae=y.historiaClinica)==null?void 0:Ae.antecedentes)||"",onChange:v=>se("antecedentes",v.target.value)})]}),u.jsxs("div",{className:"field",children:[u.jsx("label",{children:"Alergias"}),u.jsx("textarea",{className:"form-input",rows:2,value:((Be=y.historiaClinica)==null?void 0:Be.alergias)||"",onChange:v=>se("alergias",v.target.value)})]}),u.jsxs("div",{className:"field",children:[u.jsx("label",{children:"Medicamentos"}),u.jsx("textarea",{className:"form-input",rows:2,value:((Te=y.historiaClinica)==null?void 0:Te.medicamentos)||"",onChange:v=>se("medicamentos",v.target.value)})]}),u.jsxs("div",{className:"field",children:[u.jsx("label",{children:"Notas"}),u.jsx("textarea",{className:"form-input",rows:3,value:((Le=y.historiaClinica)==null?void 0:Le.notas)||"",onChange:v=>se("notas",v.target.value)})]})]})]}),M==="odonto"&&u.jsxs("section",{className:"ficha-section",children:[u.jsx("h4",{className:"ficha-section-title",children:"Odontograma (placeholder)"}),u.jsx("div",{className:"odont-grid",children:Array.from({length:32},(v,U)=>U+1).map(v=>{const U=(y.odontograma||[]).some(re=>re.pieza===v);return u.jsx("button",{type:"button",className:`tooth ${U?"on":""}`,onClick:()=>q("odontograma",v),title:`Pieza ${v}`,children:v},v)})})]}),M==="perio"&&u.jsxs("section",{className:"ficha-section",children:[u.jsx("h4",{className:"ficha-section-title",children:"Periodontograma (placeholder)"}),u.jsx("div",{className:"odont-grid",children:Array.from({length:32},(v,U)=>U+1).map(v=>{const U=(y.periodontograma||[]).some(re=>re.pieza===v);return u.jsx("button",{type:"button",className:`tooth ${U?"on":""}`,onClick:()=>q("periodontograma",v),title:`Pieza ${v}`,children:v},v)})})]}),M==="presu"&&u.jsxs("section",{className:"ficha-section",children:[u.jsx("h4",{className:"ficha-section-title",children:"Presupuestos & planes"}),u.jsx(VU,{onAdd:De}),u.jsxs("div",{className:"presu-list",children:[(y.presupuestos||[]).map(v=>u.jsxs("div",{className:"presu-item",children:[u.jsxs("div",{children:[u.jsx("div",{className:"presu-title",children:v.titulo}),u.jsxs("div",{className:"presu-meta",children:["Costo: $",v.costo||0,"  Estado: ",v.estado||"Pendiente"]})]}),u.jsx("button",{type:"button",className:"btn small",onClick:()=>it(v.id),children:"Eliminar"})]},v.id)),(!y.presupuestos||y.presupuestos.length===0)&&u.jsx("div",{className:"no-data",children:"Sin presupuestos an."})]})]}),M==="evo"&&u.jsxs("section",{className:"ficha-section",children:[u.jsx("h4",{className:"ficha-section-title",children:"Evoluciones & Remisiones"}),u.jsx(LU,{onAdd:rt}),u.jsxs("div",{className:"evo-list",children:[(y.evoluciones||[]).map(v=>u.jsxs("div",{className:"evo-item",children:[u.jsx("div",{className:"evo-date",children:new Date(v.fechaISO).toLocaleString()}),u.jsx("div",{className:"evo-note",children:v.nota}),u.jsx("button",{type:"button",className:"btn small",onClick:()=>ft(v.id),children:"Eliminar"})]},v.id)),(!y.evoluciones||y.evoluciones.length===0)&&u.jsx("div",{className:"no-data",children:"Sin evoluciones an."})]})]}),M==="fact"&&u.jsxs("section",{className:"ficha-section",children:[u.jsx("h4",{className:"ficha-section-title",children:"Facturacin"}),u.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(220px,1fr))",gap:12},children:[u.jsx(Eo,{title:"Total facturado",value:`$ ${H.totalFacturado.toLocaleString()}`}),u.jsx(Eo,{title:"Total pagado",value:`$ ${H.totalPagado.toLocaleString()}`}),u.jsx(Eo,{title:"Facturas pendientes",value:`$ ${H.totalFacturasPendientes.toLocaleString()}`}),u.jsx(Eo,{title:"Saldo pendiente (facturas - pagos)",value:`$ ${(H.totalFacturado-H.totalPagado).toLocaleString()}`}),u.jsx(Eo,{title:"Saldo a favor",value:`$ ${(((me=y.facturacion)==null?void 0:me.saldoFavor)??0).toLocaleString()}`}),u.jsx(Eo,{title:"Saldo crdito",value:`$ ${(((qe=y.facturacion)==null?void 0:qe.saldoCredito)??0).toLocaleString()}`})]}),H.error&&u.jsxs("div",{className:"hint",style:{marginTop:6},children:[" ",H.error]}),u.jsxs("div",{className:"ficha-grid",style:{marginTop:12},children:[u.jsxs("div",{className:"field",children:[u.jsx("label",{children:"Saldo a favor"}),u.jsx("input",{type:"number",className:"form-input",value:((F=y.facturacion)==null?void 0:F.saldoFavor)??0,onChange:v=>ae({facturacion:{...y.facturacion||{},saldoFavor:Number(v.target.value||0)}})})]}),u.jsxs("div",{className:"field",children:[u.jsx("label",{children:"Saldo crdito"}),u.jsx("input",{type:"number",className:"form-input",value:((X=y.facturacion)==null?void 0:X.saldoCredito)??0,onChange:v=>ae({facturacion:{...y.facturacion||{},saldoCredito:Number(v.target.value||0)}})})]})]}),u.jsxs("div",{style:{marginTop:14,display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:[u.jsxs("div",{className:"mini-card",children:[u.jsx("div",{className:"mini-card-title",children:"ltimas facturas"}),u.jsx("div",{className:"table-wrap",children:u.jsxs("table",{className:"appointments-table",children:[u.jsx("thead",{children:u.jsxs("tr",{children:[u.jsx("th",{children:"Fecha"}),u.jsx("th",{children:"Estado"}),u.jsx("th",{children:"Total"})]})}),u.jsxs("tbody",{children:[H.facturas.slice(0,8).map(v=>u.jsxs("tr",{children:[u.jsx("td",{children:v.fechaISO?new Date(v.fechaISO).toLocaleString():""}),u.jsx("td",{children:String(v.estado||"").toUpperCase()}),u.jsxs("td",{children:["$",(v.total||0).toLocaleString()]})]},v.id)),H.facturas.length===0&&u.jsx("tr",{children:u.jsx("td",{className:"no-data",colSpan:3,children:"Sin facturas."})})]})]})})]}),u.jsxs("div",{className:"mini-card",children:[u.jsx("div",{className:"mini-card-title",children:"ltimos pagos"}),u.jsx("div",{className:"table-wrap",children:u.jsxs("table",{className:"appointments-table",children:[u.jsx("thead",{children:u.jsxs("tr",{children:[u.jsx("th",{children:"Fecha"}),u.jsx("th",{children:"Medio"}),u.jsx("th",{children:"Monto"})]})}),u.jsxs("tbody",{children:[H.pagos.slice(0,8).map(v=>u.jsxs("tr",{children:[u.jsx("td",{children:v.fechaISO?new Date(v.fechaISO).toLocaleString():""}),u.jsx("td",{children:v.medio}),u.jsxs("td",{children:["$",(v.monto||0).toLocaleString()]})]},v.id)),H.pagos.length===0&&u.jsx("tr",{children:u.jsx("td",{className:"no-data",colSpan:3,children:"Sin pagos."})})]})]})})]})]})]}),M==="citas"&&u.jsxs("section",{className:"ficha-section",children:[u.jsx("h4",{className:"ficha-section-title",children:"Citas"}),u.jsx("div",{className:"table-wrap",children:u.jsxs("table",{className:"appointments-table",children:[u.jsx("thead",{children:u.jsxs("tr",{children:[u.jsx("th",{children:"Fecha"}),u.jsx("th",{children:"Estado"}),u.jsx("th",{children:"Motivo"}),u.jsx("th",{children:"Profesional"})]})}),u.jsx("tbody",{children:Q?u.jsx("tr",{children:u.jsx("td",{className:"no-data",colSpan:4,children:"Cargando"})}):de.length===0?u.jsx("tr",{children:u.jsx("td",{className:"no-data",colSpan:4,children:"Sin citas registradas."})}):de.map(v=>u.jsxs("tr",{children:[u.jsx("td",{children:v.fechaISO?new Date(v.fechaISO).toLocaleString():""}),u.jsx("td",{children:v.estado||""}),u.jsx("td",{children:v.motivo||""}),u.jsx("td",{children:v.profesional||""})]},v.id))})]})})]}),M==="crm"&&u.jsxs("section",{className:"ficha-section",children:[u.jsx("h4",{className:"ficha-section-title",children:"CRM"}),u.jsx("div",{className:"no-data",children:"Notas / recordatorios comerciales del paciente."})]}),u.jsx("div",{className:"ficha-footer"})]})]})]})]})]})}function Eo({title:t,value:e}){return u.jsxs("div",{className:"mini-card",children:[u.jsx("div",{className:"mini-card-title",children:t}),u.jsx("div",{style:{fontWeight:700,fontSize:20,marginTop:6},children:e})]})}function VU({onAdd:t}){const[e,n]=N.useState(""),[r,s]=N.useState(""),[i,o]=N.useState("Pendiente");return u.jsxs("div",{className:"presu-form",children:[u.jsx("input",{className:"form-input",placeholder:"Procedimiento / plan",value:e,onChange:a=>n(a.target.value)}),u.jsx("input",{type:"number",className:"form-input",placeholder:"Costo",value:r,onChange:a=>s(a.target.value)}),u.jsxs("select",{className:"form-input",value:i,onChange:a=>o(a.target.value),children:[u.jsx("option",{children:"Pendiente"}),u.jsx("option",{children:"Aprobado"}),u.jsx("option",{children:"Rechazado"})]}),u.jsx("button",{type:"button",className:"btn blue",onClick:()=>{if(!e)return alert("Ttulo requerido");t({titulo:e,costo:Number(r||0),estado:i}),n(""),s(""),o("Pendiente")},children:"Agregar"})]})}function LU({onAdd:t}){const[e,n]=N.useState("");return u.jsxs("div",{className:"evo-form",children:[u.jsx("textarea",{className:"form-input",rows:2,placeholder:"Escribe la evolucin / remisin",value:e,onChange:r=>n(r.target.value)}),u.jsx("button",{type:"button",className:"btn blue",onClick:()=>{e.trim()&&(t(e.trim()),n(""))},children:"Guardar evolucin"})]})}function MU(){return u.jsxs("div",{style:{padding:"20px"},children:[u.jsx("h2",{children:"Mdulo de Facturacin"}),u.jsx("p",{children:"Aqu se registrarn los pagos, facturas y cobros."})]})}const wr=t=>(Number(t)||0).toLocaleString("es-CO",{maximumFractionDigits:0}),Io=()=>new Date().toISOString().slice(0,10),FU=(t=new Date)=>new Date(t.getFullYear(),t.getMonth(),t.getDate(),0,0,0,0),UU=(t=new Date)=>new Date(t.getFullYear(),t.getMonth(),t.getDate()+1,0,0,0,0),aT=t=>$e.fromDate(t),$U=()=>{const[t,e]=N.useState(null);return N.useEffect(()=>{const n=wy(ch,r=>e(r||null));return()=>n()},[]),t},Ft=({children:t,align:e})=>u.jsx("th",{className:"oc-th",style:{position:"sticky",top:0,zIndex:1,textAlign:e||"left",background:"var(--oc-surface, #fff)"},children:t}),BU=()=>Math.random().toString(36).slice(2)+Math.random().toString(36).slice(2);function zU(){var qe;const t=$U(),e=[{key:"abrir",label:"Abrir caja",icon:""},{key:"abiertas",label:"Cajas abiertas",icon:""},{key:"cerradas",label:"Cajas cerradas",icon:""},{key:"mio",label:"Mi caja (hoy)",icon:""},{key:"simulados",label:"Cierres simulados",icon:""},{key:"bancos",label:"Bancos",icon:""}],[n,r]=N.useState("abiertas"),[s,i]=N.useState(""),[o,a]=N.useState(""),l=N.useRef(null),[d,h]=N.useState(!1),[f,m]=N.useState(""),[w,R]=N.useState([]),[b,A]=N.useState(!0),[T,E]=N.useState([]),[y,j]=N.useState(!0),[V,M]=N.useState(null),[x,_]=N.useState(!0),[S,C]=N.useState(""),[k,D]=N.useState([]),[P,Y]=N.useState(null),[Ge,Lt]=N.useState(""),[he,Z]=N.useState("efectivo"),[ce,pe]=N.useState(!1),[Ve,Qe]=N.useState("ingreso"),[z,te]=N.useState(""),[ue,Ee]=N.useState(""),[we,ke]=N.useState(!1),[ae,nt]=N.useState([]),[xe,se]=N.useState([]);N.useEffect(()=>{const F=tt(Ue(ye,"cajas"),Ye("estado","==","abierta"),Gt("fechaApertura","desc")),X=rr(F,v=>{R(v.docs.map(U=>De(U.id,U.data()))),A(!1),i("")},v=>{console.error(v),i((v==null?void 0:v.code)==="failed-precondition"?"Falta ndice (estado, fechaApertura) en Firestore.":(v==null?void 0:v.code)==="permission-denied"?"Permiso denegado en Firestore (revisa reglas).":"No se pudieron leer las cajas."),A(!1)});return()=>X()},[]),N.useEffect(()=>{const F=tt(Ue(ye,"cajas"),Ye("estado","==","cerrada"),Gt("fechaCierre","desc")),X=rr(F,v=>{E(v.docs.map(U=>De(U.id,U.data()))),j(!1)},v=>{console.error(v),j(!1)});return()=>X()},[]),N.useEffect(()=>{if(!t){M(null),_(!1);return}_(!0);const F=tt(Ue(ye,"cajas"),Ye("estado","==","abierta"),Ye("usuarioId","==",t.uid),Ye("fechaApertura",">=",aT(FU())),Ye("fechaApertura","<",aT(UU()))),X=rr(F,v=>{const U=v.docs[0];M(U?De(U.id,U.data()):null),_(!1)},v=>{console.error(v),_(!1),(v==null?void 0:v.code)==="failed-precondition"&&i("Falta ndice (estado, usuarioId, fechaApertura) en Firestore.")});return()=>X()},[t]),N.useEffect(()=>{if(!(V!=null&&V.id)){nt([]),se([]);return}const F=tt(Ue(ye,"movimientos"),Ye("cashId","==",V.id),Ye("dia","==",Io()),Gt("fecha","desc")),X=rr(F,re=>nt(re.docs.map(ge=>({id:ge.id,...ge.data()}))),re=>console.error(re)),v=tt(Ue(ye,"payments"),Ye("cashId","==",V.id),Ye("dia","==",Io()),Gt("fecha","desc")),U=rr(v,re=>se(re.docs.map(ge=>({id:ge.id,...ge.data()}))),re=>console.error(re));return()=>{X(),U()}},[V==null?void 0:V.id]),N.useEffect(()=>{if(!(S!=null&&S.trim())){D([]);return}const F=tt(Ue(ye,"patients"),Ye("q",">=",H(S)),Ye("q","<=",H(S)+""),Gt("q","asc")),X=rr(F,v=>D(v.docs.map(U=>({id:U.id,...U.data()}))),v=>console.error(v));return()=>X()},[S]);function De(F,X={}){const v=St=>{var We;return((We=St==null?void 0:St.toDate)==null?void 0:We.call(St))||(typeof St=="string"?new Date(St):St||null)},U=v(X.fechaApertura),re=v(X.fechaCierre),ge=Number(X.baseInicial||0),Re=Number(X.baseActual!==void 0?X.baseActual:ge),Me=Number(X.saldoInicial||0),Xt=Number(X.saldoActual!==void 0?X.saldoActual:Me),Nt=[];return Xt<0&&Nt.push("Saldo negativo"),Re<0&&Nt.push("Base negativa"),{id:F,estado:X.estado||"abierta",usuarioId:X.usuarioId||"",usuarioNombre:X.usuarioNombre||"Usuario",nombre:X.nombre||X.usuarioNombre||"Caja",fechaApertura:U,fechaCierre:re,baseInicial:ge,baseActual:Re,saldoInicial:Me,saldoActual:Xt,ia:Nt}}const it=async F=>{var X;if((X=F==null?void 0:F.preventDefault)==null||X.call(F),!t){i("Debes iniciar sesin para abrir una caja.");return}h(!0);try{const v=Number(f||0);await wl(Ue(ye,"cajas"),{estado:"abierta",usuarioId:t.uid,usuarioNombre:t.displayName||t.email||"Usuario",fechaApertura:Mn(),baseInicial:v,baseActual:v,saldoInicial:0,saldoActual:0,dia:Io()}),m(""),r("mio"),i("")}catch(v){console.error(v),i("No se pudo abrir la caja.")}finally{h(!1)}},rt=async F=>{try{await ea(Kt(ye,"cajas",F),{estado:"cerrada",fechaCierre:Mn()}),r("cerradas")}catch(X){console.error(X),i("No se pudo cerrar la caja.")}},ft=async F=>{var v;if((v=F==null?void 0:F.preventDefault)==null||v.call(F),!(V!=null&&V.id)){i("Debes abrir tu caja para registrar movimientos.");return}const X=Number(ue||0);if(!(!X||X<=0)){ke(!0);try{await wl(Ue(ye,"movimientos"),{cashId:V.id,tipo:Ve,concepto:z||(Ve==="ingreso"?"Ingreso":"Egreso"),valor:X,fecha:Mn(),dia:Io(),usuarioId:(t==null?void 0:t.uid)||null});const U=Ve==="ingreso"?X:-X;await ea(Kt(ye,"cajas",V.id),{saldoActual:LI(U)}),te(""),Ee("")}catch(U){console.error(U),i("No se pudo registrar el movimiento.")}finally{ke(!1)}}},q=async F=>{var v;if((v=F==null?void 0:F.preventDefault)==null||v.call(F),!(V!=null&&V.id))return i("Abre tu caja para cobrar.");const X=Number(Ge||0);if(!(!X||X<=0)){if(!P)return i("Selecciona un paciente.");pe(!0);try{const U=await wl(Ue(ye,"payments"),{cashId:V.id,patientId:P.id,patientName:P.nombre||P.name||"Paciente",invoiceId:null,valor:X,medio:he,estado:"aprobado",fecha:Mn(),dia:Io()});await ea(Kt(ye,"cajas",V.id),{saldoActual:LI(X)}),Lt(""),Z("efectivo"),i(`Pago registrado (${U.id}).`)}catch(U){console.error(U),i("No se pudo registrar el pago.")}finally{pe(!1)}}},ne=async F=>{var v;if((v=F==null?void 0:F.preventDefault)==null||v.call(F),!(V!=null&&V.id))return i("Abre tu caja para cobrar.");const X=Number(Ge||0);if(!(!X||X<=0)){if(!P)return i("Selecciona un paciente.");pe(!0);try{const re=`https://pay.odontocloud/mock/${BU()}`,ge=await wl(Ue(ye,"payments"),{cashId:V.id,patientId:P.id,patientName:P.nombre||P.name||"Paciente",invoiceId:null,valor:X,medio:"link",estado:"pending",linkUrl:re,fecha:Mn(),dia:Io()});i(`Link de pago generado: ${re}`),Lt("")}catch(U){console.error(U),i("No se pudo generar link de pago.")}finally{pe(!1)}}},H=F=>(F||"").toString().normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase(),Q=N.useMemo(()=>{const F=H(o);return F?w.filter(X=>[X.nombre,X.usuarioNombre,wr(X.saldoActual),wr(X.baseActual)].map(H).some(v=>v.includes(F))):w},[o,w]),de=()=>u.jsxs("div",{className:"card",children:[u.jsx("div",{className:"oc-card-head",style:{marginBottom:8},children:u.jsx("h3",{children:"Abrir caja"})}),u.jsxs("form",{className:"oc-form",onSubmit:it,style:{display:"flex",gap:12,alignItems:"end",flexWrap:"wrap"},children:[u.jsxs("label",{style:{display:"inline-flex",flexDirection:"column",gap:6},children:[u.jsx("span",{children:"Base inicial (COP)"}),u.jsx("input",{type:"number",className:"oc-input",min:"0",step:"1000",value:f,onChange:F=>m(F.target.value),placeholder:"0"})]}),u.jsx("button",{className:"oc-btn",type:"submit",disabled:d,children:d?"Abriendo...":"Abrir caja"})]}),u.jsxs("p",{className:"oc-muted",style:{marginTop:8},children:["Se asociar a tu usuario y quedar visible en ",u.jsx("b",{children:"Mi caja (hoy)"}),"."]})]}),Se=()=>u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"card",style:{marginBottom:10},children:u.jsxs("div",{className:"oc-card-head",style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[u.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[u.jsx("h3",{style:{margin:0},children:"Cajas Abiertas"}),u.jsx("span",{className:"oc-tag",children:Q.length}),s&&u.jsx("span",{className:"oc-tag oc-tag-danger",children:s})]}),u.jsx("input",{ref:l,className:"oc-input",style:{maxWidth:280},placeholder:"Buscar...",value:o,onChange:F=>a(F.target.value)})]})}),u.jsx("div",{className:"card",children:u.jsx("div",{className:"oc-table-wrap",children:u.jsxs("table",{className:"oc-table",children:[u.jsx("thead",{className:"oc-thead",children:u.jsxs("tr",{className:"oc-tr",children:[u.jsx(Ft,{children:"Caja"}),u.jsx(Ft,{children:"Fecha apertura"}),u.jsx(Ft,{align:"right",children:"Base actual"}),u.jsx(Ft,{align:"right",children:"Saldo inicial"}),u.jsx(Ft,{align:"right",children:"Saldo actual"}),u.jsx(Ft,{children:"Usuario"}),u.jsx(Ft,{children:"Acciones"})]})}),u.jsx("tbody",{className:"oc-tbody",children:b?u.jsx(lT,{cols:7}):Q.length===0?u.jsx("tr",{className:"oc-tr",children:u.jsx("td",{className:"oc-td",colSpan:7,children:u.jsx("span",{className:"oc-muted",children:"Sin cajas abiertas."})})}):Q.map(F=>{var X;return u.jsxs("tr",{className:"oc-tr",children:[u.jsxs("td",{className:"oc-td",children:[u.jsx("b",{children:F.nombre})," ",(X=F.ia)!=null&&X.length?u.jsx("span",{className:"oc-tag oc-tag-danger",title:F.ia.join("  "),children:"IA"}):null]}),u.jsx("td",{className:"oc-td",children:F.fechaApertura?F.fechaApertura.toLocaleString("es-CO"):""}),u.jsxs("td",{className:"oc-td",style:{textAlign:"right"},children:["$",wr(F.baseActual)]}),u.jsxs("td",{className:"oc-td",style:{textAlign:"right"},children:["$",wr(F.saldoInicial)]}),u.jsxs("td",{className:"oc-td",style:{textAlign:"right",color:F.saldoActual<0?"#b91c1c":void 0,fontWeight:600},children:["$",wr(F.saldoActual)]}),u.jsx("td",{className:"oc-td",children:F.usuarioNombre}),u.jsxs("td",{className:"oc-td",style:{whiteSpace:"nowrap"},children:[u.jsx("button",{className:"oc-small-btn",onClick:()=>r("mio"),children:"Ver"})," ",u.jsx("button",{className:"oc-small-btn oc-danger",onClick:()=>rt(F.id),children:"Cerrar"})]})]},F.id)})})]})})})]}),Ae=()=>u.jsxs("div",{className:"card",children:[u.jsxs("div",{className:"oc-card-head",style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[u.jsx("h3",{children:"Mi caja (hoy)"}),(V==null?void 0:V.estado)==="abierta"&&u.jsxs("div",{style:{display:"flex",gap:8},children:[u.jsx("span",{className:"oc-tag oc-tag-success",children:"Abierta"}),u.jsx("button",{className:"oc-small-btn oc-danger",onClick:()=>rt(V.id),children:"Cerrar caja"})]})]}),x?u.jsx("div",{className:"oc-muted",children:"Cargando"}):V?u.jsxs(u.Fragment,{children:[u.jsxs("div",{className:"oc-stats-row",style:{marginBottom:12},children:[u.jsxs("div",{className:"stat-card",children:[u.jsx("span",{className:"stat-label",children:"Base actual"}),u.jsxs("span",{className:"stat-value",children:["$",wr(V.baseActual)]})]}),u.jsxs("div",{className:"stat-card",children:[u.jsx("span",{className:"stat-label",children:"Saldo actual"}),u.jsxs("span",{className:"stat-value",style:{color:V.saldoActual<0?"#b91c1c":void 0},children:["$",wr(V.saldoActual)]})]})]}),u.jsxs("div",{className:"card",style:{marginBottom:12},children:[u.jsx("h4",{style:{marginBottom:8},children:"Cobro rpido"}),u.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr auto",gap:8},children:[u.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:6},children:[u.jsx("label",{className:"oc-muted",children:"Paciente"}),u.jsx("input",{className:"oc-input",placeholder:"Buscar nombre o documento",value:S,onChange:F=>C(F.target.value)}),S&&k.length>0&&u.jsx("div",{className:"oc-dropdown",children:k.slice(0,6).map(F=>u.jsx("button",{className:`oc-menu-item ${(P==null?void 0:P.id)===F.id?"active":""}`,onClick:()=>{Y(F),C(F.nombre||F.name||F.doc||"")},type:"button",children:(F.nombre||F.name||"Paciente")+(F.doc?`  ${F.doc}`:"")},F.id))})]}),u.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:6},children:[u.jsx("label",{className:"oc-muted",children:"Monto (COP)"}),u.jsx("input",{className:"oc-input",type:"number",min:"0",step:"1000",placeholder:"0",value:Ge,onChange:F=>Lt(F.target.value)})]}),u.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:6},children:[u.jsx("label",{className:"oc-muted",children:"Medio"}),u.jsxs("select",{className:"oc-input",value:he,onChange:F=>Z(F.target.value),children:[u.jsx("option",{value:"efectivo",children:"Efectivo"}),u.jsx("option",{value:"tarjeta",children:"Tarjeta"}),u.jsx("option",{value:"transferencia",children:"Transferencia"}),u.jsx("option",{value:"link",children:"Link (en lnea)"})]})]}),u.jsx("div",{style:{display:"flex",alignItems:"end",gap:6},children:he==="link"?u.jsx("button",{className:"oc-btn",onClick:ne,disabled:ce,children:ce?"Creando":"Generar link"}):u.jsx("button",{className:"oc-btn",onClick:q,disabled:ce,children:ce?"Guardando":"Registrar pago"})})]}),u.jsxs("p",{className:"oc-muted",style:{marginTop:8},children:["Para link, el saldo se actualiza cuando el pago pase a ",u.jsx("b",{children:"aprobado"})," (webhook)."]})]}),u.jsxs("div",{className:"card",style:{marginBottom:12},children:[u.jsx("h4",{style:{marginBottom:8},children:"Movimiento manual"}),u.jsxs("form",{onSubmit:ft,style:{display:"grid",gridTemplateColumns:"120px 1fr 180px auto",gap:8},children:[u.jsxs("select",{className:"oc-input",value:Ve,onChange:F=>Qe(F.target.value),children:[u.jsx("option",{value:"ingreso",children:"Ingreso"}),u.jsx("option",{value:"egreso",children:"Egreso"})]}),u.jsx("input",{className:"oc-input",placeholder:"Concepto (ej. Caja chica, Arriendo, etc.)",value:z,onChange:F=>te(F.target.value)}),u.jsx("input",{className:"oc-input",type:"number",min:"0",step:"1000",placeholder:"0",value:ue,onChange:F=>Ee(F.target.value)}),u.jsx("button",{className:"oc-btn",disabled:we,children:we?"Guardando":"Agregar"})]})]}),u.jsxs("div",{className:"card",children:[u.jsx("h4",{style:{marginBottom:8},children:"Movimientos y pagos (hoy)"}),u.jsx("div",{className:"oc-table-wrap",style:{marginBottom:12},children:u.jsxs("table",{className:"oc-table",children:[u.jsx("thead",{className:"oc-thead",children:u.jsxs("tr",{className:"oc-tr",children:[u.jsx(Ft,{children:"Tipo"}),u.jsx(Ft,{children:"Concepto / Paciente"}),u.jsx(Ft,{children:"Medio"}),u.jsx(Ft,{children:"Estado"}),u.jsx(Ft,{align:"right",children:"Valor"}),u.jsx(Ft,{children:"Hora"})]})}),u.jsx("tbody",{className:"oc-tbody",children:ae.length===0&&xe.length===0?u.jsx("tr",{className:"oc-tr",children:u.jsx("td",{className:"oc-td",colSpan:6,children:u.jsx("span",{className:"oc-muted",children:"Sin movimientos ni pagos an."})})}):u.jsxs(u.Fragment,{children:[xe.map(F=>{var X,v;return u.jsxs("tr",{className:"oc-tr",children:[u.jsx("td",{className:"oc-td",children:"Pago"}),u.jsxs("td",{className:"oc-td",children:[F.patientName||"Paciente"," ",F.linkUrl?u.jsx("a",{href:F.linkUrl,target:"_blank",rel:"noreferrer",children:"(link)"}):null]}),u.jsx("td",{className:"oc-td",children:F.medio}),u.jsx("td",{className:"oc-td",children:u.jsx("span",{className:`oc-tag ${F.estado==="aprobado"?"oc-tag-success":F.estado==="pending"?"oc-tag-warning":"oc-tag-danger"}`,children:F.estado})}),u.jsxs("td",{className:"oc-td",style:{textAlign:"right"},children:["$",wr(F.valor)]}),u.jsx("td",{className:"oc-td",children:(v=(X=F.fecha)==null?void 0:X.toDate)!=null&&v.call(X)?F.fecha.toDate().toLocaleTimeString("es-CO"):""})]},`pay-${F.id}`)}),ae.map(F=>{var X,v;return u.jsxs("tr",{className:"oc-tr",children:[u.jsx("td",{className:"oc-td",children:F.tipo}),u.jsx("td",{className:"oc-td",children:F.concepto}),u.jsx("td",{className:"oc-td",children:""}),u.jsx("td",{className:"oc-td",children:u.jsx("span",{className:"oc-tag",children:(F.tipo==="ingreso","ok")})}),u.jsxs("td",{className:"oc-td",style:{textAlign:"right"},children:["$",wr(F.valor)]}),u.jsx("td",{className:"oc-td",children:(v=(X=F.fecha)==null?void 0:X.toDate)!=null&&v.call(X)?F.fecha.toDate().toLocaleTimeString("es-CO"):""})]},`mov-${F.id}`)})]})})]})}),u.jsx("p",{className:"oc-muted",children:"Sugerencia: crea ndice compuesto para `movimientos(cashId, dia, fecha)` y `payments(cashId, dia, fecha)` para rendimiento."})]})]}):u.jsxs("div",{className:"oc-empty",children:[u.jsx("p",{className:"oc-muted",children:"No tienes una caja abierta hoy."}),u.jsx("button",{className:"oc-btn",onClick:()=>r("abrir"),children:"Abrir caja"})]})]}),Be=()=>u.jsxs("div",{className:"card",children:[u.jsx("div",{className:"oc-card-head",style:{marginBottom:8},children:u.jsxs("h3",{children:["Cajas cerradas ",u.jsx("span",{className:"oc-tag",children:T.length})]})}),u.jsx("div",{className:"oc-table-wrap",children:u.jsxs("table",{className:"oc-table",children:[u.jsx("thead",{className:"oc-thead",children:u.jsxs("tr",{className:"oc-tr",children:[u.jsx(Ft,{children:"Caja"}),u.jsx(Ft,{children:"Usuario"}),u.jsx(Ft,{children:"Apertura"}),u.jsx(Ft,{children:"Cierre"}),u.jsx(Ft,{align:"right",children:"Saldo final"})]})}),u.jsx("tbody",{className:"oc-tbody",children:y?u.jsx(lT,{cols:5}):T.length===0?u.jsx("tr",{className:"oc-tr",children:u.jsx("td",{className:"oc-td",colSpan:5,children:u.jsx("span",{className:"oc-muted",children:"Sin cajas cerradas."})})}):T.map(F=>u.jsxs("tr",{className:"oc-tr",children:[u.jsx("td",{className:"oc-td",children:F.nombre}),u.jsx("td",{className:"oc-td",children:F.usuarioNombre}),u.jsx("td",{className:"oc-td",children:F.fechaApertura?F.fechaApertura.toLocaleString("es-CO"):""}),u.jsx("td",{className:"oc-td",children:F.fechaCierre?F.fechaCierre.toLocaleString("es-CO"):""}),u.jsxs("td",{className:"oc-td",style:{textAlign:"right"},children:["$",wr(F.saldoActual)]})]},F.id))})]})})]}),Te=()=>u.jsxs("div",{className:"card",children:[u.jsx("h3",{children:"Cierres simulados"}),u.jsx("p",{className:"oc-muted",children:"El cierre hipottico compara ventas y movimientos detectando errores y descuadres con IA. (Conectar fuente de datos para activarlo)."})]}),Le=()=>u.jsxs("div",{className:"card",children:[u.jsx("h3",{children:"Bancos"}),u.jsx("p",{className:"oc-muted",children:"Conciliacin de consignaciones/pagos electrnicos contra caja del da. (Conectar pasarela o extractos para habilitar)."})]}),me=({m:F})=>u.jsxs("button",{type:"button",onClick:()=>r(F.key),className:`oc-menu-item ${n===F.key?"active":""}`,style:{width:"100%",textAlign:"left",padding:"10px 12px",borderRadius:10,border:"1px solid transparent",background:n===F.key?"var(--oc-surface-2, #f3f6ff)":"transparent",fontWeight:600},title:F.label,children:[u.jsx("span",{style:{opacity:.8,marginRight:6},children:F.icon}),F.label]});return u.jsxs("div",{className:"oc-main-content",style:{display:"grid",gridTemplateColumns:"240px 1fr",gap:16},children:[u.jsx("aside",{className:"card",role:"navigation","aria-label":"Men de caja",style:{height:"fit-content",padding:12},children:u.jsx("div",{style:{display:"flex",flexDirection:"column",gap:8},children:e.map(F=>u.jsx(me,{m:F},F.key))})}),u.jsxs("section",{children:[u.jsx("div",{className:"card",style:{marginBottom:12,padding:12},children:u.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",gap:12},children:[u.jsxs("div",{className:"oc-breadcrumb",children:[u.jsx("span",{children:"Caja"}),u.jsx("span",{children:""}),u.jsx("b",{children:(qe=e.find(F=>F.key===n))==null?void 0:qe.label})]}),n==="abiertas"&&u.jsx("input",{ref:l,className:"oc-input",placeholder:"Buscar...",value:o,onChange:F=>a(F.target.value),style:{maxWidth:300}})]})}),n==="abrir"&&u.jsx(de,{}),n==="abiertas"&&u.jsx(Se,{}),n==="cerradas"&&u.jsx(Be,{}),n==="mio"&&u.jsx(Ae,{}),n==="simulados"&&u.jsx(Te,{}),n==="bancos"&&u.jsx(Le,{})]})]})}function lT({cols:t=6,n:e=3}){return u.jsx(u.Fragment,{children:Array.from({length:e}).map((n,r)=>u.jsx("tr",{className:"oc-tr",children:Array.from({length:t}).map((s,i)=>u.jsx("td",{className:"oc-td",children:u.jsx("div",{style:{height:12,width:i===0?160:100+i%3*40,background:"var(--oc-skeleton, #e5e7eb)",borderRadius:6}})},i))},r))})}function qU({items:t=[]}){return u.jsxs("div",{className:"card activity-card",children:[u.jsx("h4",{children:"Actividad reciente"}),u.jsx("ul",{className:"activity-list",children:t.map(e=>u.jsxs("li",{children:[u.jsx("strong",{children:e.title}),u.jsx("div",{className:"time",children:e.time})]},e.id))})]})}function HU({status:t}){return t?u.jsxs("div",{className:"card",children:[u.jsx("h4",{children:"Automatizaciones (N8N)"}),u.jsxs("div",{className:"n8n-line",children:[u.jsx("strong",{children:"Conectado:"})," ",t.connected?"S":"No"]}),u.jsxs("div",{className:"n8n-line",children:[u.jsx("strong",{children:"Flujos activos:"})," ",t.flowsRunning]}),t.lastError&&u.jsxs("div",{className:"n8n-error",children:["Error: ",t.lastError]})]}):null}const Rp={es:{nav_home:"Inicio",nav_agenda:"Agenda",nav_patients:"Pacientes",nav_billing:"Facturacin",nav_inventory:"Inventario",nav_odontogram:"Odontograma",nav_reports:"Reportes",nav_cash:"Caja",nav_admin:"Administracin",welcomeTitle:"Bienvenido a OdontoCloud",welcomeSubtitle:"Administra tus pacientes, agenda, inventario y facturacin de manera inteligente y moderna.",clinicLabel:"Clnica",userLabel:"Usuario",roleLabel:"Rol",searchPlaceholder:"Buscar acciones o ir a",stats_patientsToday:"Pacientes totales",stats_appointmentsToday:"Citas hoy",stats_revenueToday:"Facturacin hoy",stats_waiting:"En espera",stats_currency:"COP",n8n_title:"Automatizaciones (n8n)",recent_title:"Actividad reciente",recent_empty:"Sin actividad registrada.",loading:"Cargando...",logout:"Cerrar sesin",module_coming:"Mdulo prximamente.",todays_appts:"Citas de hoy",see_schedule:"Ir a Agenda",no_appts_today:"No hay citas programadas hoy.",at:"a las"},en:{nav_home:"Overview",nav_agenda:"Schedule",nav_patients:"Patients",nav_billing:"Billing",nav_inventory:"Inventory",nav_odontogram:"Odontogram",nav_reports:"Reports",nav_cash:"Cash",nav_admin:"Administration",welcomeTitle:"Welcome to OdontoCloud",welcomeSubtitle:"Manage your patients, schedule, inventory and billing in a smart and modern way.",clinicLabel:"Clinic",userLabel:"User",roleLabel:"Role",searchPlaceholder:"Search actions or go to",stats_patientsToday:"Total patients",stats_appointmentsToday:"Appointments today",stats_revenueToday:"Revenue today",stats_waiting:"In waiting room",stats_currency:"COP",n8n_title:"Automations (n8n)",recent_title:"Recent activity",recent_empty:"No activity yet.",loading:"Loading...",logout:"Log out",module_coming:"Module coming soon.",todays_appts:"Today's appointments",see_schedule:"Open Schedule",no_appts_today:"No appointments today.",at:"at"}},MA=()=>typeof navigator>"u"||(navigator.language||navigator.userLanguage||"es").toLowerCase().startsWith("es")?"es":"en",WU=()=>{try{const t=JSON.parse(localStorage.getItem("odc_session"));return t&&Date.now()-t.timestamp<1e3*60*60*24?t:null}catch{return null}},KU=()=>N.useMemo(()=>{const t=new Date,e=new Date(t.getFullYear(),t.getMonth(),t.getDate(),0,0,0,0),n=new Date(t.getFullYear(),t.getMonth(),t.getDate()+1,0,0,0,0);return{startToday:$e.fromDate(e),endToday:$e.fromDate(n),startTodayJS:e}},[]),GU=t=>`${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,"0")}-${String(t.getDate()).padStart(2,"0")}`,QU=(t,e)=>t.toLocaleTimeString(e==="es"?"es-CO":"en-US",{hour:"2-digit",minute:"2-digit"}),YU=(t,e)=>{try{const[n,r,s]=(t||"").split("-").map(a=>parseInt(a,10)),[i=0,o=0]=(e||"00:00").split(":").map(a=>parseInt(a,10));return new Date(n,(r||1)-1,s||1,i,o,0,0)}catch{return new Date}};function XU({data:t=[]}){const s=Math.max(1,...t.map(d=>Number(d.value)||0)),i=t.length||7,o=10,a=Math.max(16,Math.min(44,(640-o*(i+1))/i)),l=(a+o)*i+o;return u.jsx("div",{style:{width:"100%",overflowX:"auto"},children:u.jsxs("svg",{width:l,height:240,role:"img","aria-label":"Pacientes registrados por da en la ltima semana",children:[[.25,.5,.75,1].map((d,h)=>{const f=18+(1-d)*182;return u.jsx("line",{x1:0,x2:l,y1:f,y2:f,stroke:"#e5e7eb",strokeDasharray:"4 4"},h)}),t.map((d,h)=>{const f=Number(d.value)||0,m=Math.round(f/s*182),w=o+h*(a+o),R=200-m;return u.jsxs("g",{children:[u.jsx("rect",{x:w,y:R,width:a,height:m,rx:"6",ry:"6",fill:f>0?"#0ea5e9":"#cbd5e1",children:u.jsx("title",{children:`${d.label||d.shortLabel||""}  ${f} paciente${f!==1?"s":""}`})}),f>0&&m>14&&u.jsx("text",{x:w+a/2,y:R-6,textAnchor:"middle",fontSize:"11",fill:"#0f172a",children:f}),u.jsx("text",{x:w+a/2,y:214,textAnchor:"middle",fontSize:"11",fill:"#64748b",children:d.shortLabel||""})]},h)})]})})}function JU({onNavigate:t,onAction:e,placeholder:n}){const[r,s]=N.useState(""),[i,o]=N.useState(!1),[a,l]=N.useState(0),d=N.useRef(null),h=N.useMemo(()=>[{group:"Navegacin",label:"Ir a Inicio",keywords:"inicio home overview",run:()=>t==null?void 0:t("Inicio")},{group:"Navegacin",label:"Ir a Agenda",keywords:"agenda calendario schedule",run:()=>t==null?void 0:t("Agenda")},{group:"Navegacin",label:"Ir a Pacientes",keywords:"pacientes",run:()=>t==null?void 0:t("Pacientes")},{group:"Navegacin",label:"Ir a Facturacin",keywords:"facturacion facturas billing",run:()=>t==null?void 0:t("Facturacin")},{group:"Navegacin",label:"Ir a Inventario",keywords:"inventario stock",run:()=>t==null?void 0:t("Inventario")},{group:"Navegacin",label:"Ir a Odontograma",keywords:"odontograma",run:()=>t==null?void 0:t("Odontograma")},{group:"Navegacin",label:"Ir a Reportes",keywords:"reportes informes",run:()=>t==null?void 0:t("Reportes")},{group:"Acciones",label:"Nueva cita",keywords:"nueva cita agendar",run:()=>e==null?void 0:e("new_appointment")},{group:"Acciones",label:"Nuevo paciente",keywords:"nuevo paciente alta",run:()=>e==null?void 0:e("new_patient")},{group:"Acciones",label:"Nueva factura",keywords:"nueva factura",run:()=>e==null?void 0:e("new_invoice")},{group:"Acciones",label:"Exportar agenda",keywords:"exportar agenda",run:()=>e==null?void 0:e("export_agenda")},{group:"Acciones",label:"Ir a hoy (Agenda)",keywords:"hoy today",run:()=>e==null?void 0:e("agenda_today")},{group:"Acciones",label:"Cambiar modo oscuro",keywords:"oscuro dark mode",run:()=>e==null?void 0:e("toggle_dark")},{group:"Acciones",label:"Cerrar sesin",keywords:"logout salir cerrar",run:()=>e==null?void 0:e("logout")},{group:"Ayuda",label:"Ver atajos de teclado",keywords:"atajos ayuda",run:()=>e==null?void 0:e("show_shortcuts")},{group:"Ayuda",label:"Soporte / Contacto",keywords:"soporte ayuda contacto",run:()=>e==null?void 0:e("support")}],[t,e]),f=N.useMemo(()=>{const b=r.toLowerCase().trim();return b?h.filter(A=>A.label.toLowerCase().includes(b)||A.keywords.includes(b)):[]},[r,h]);N.useEffect(()=>{const b=A=>{d.current&&(d.current.contains(A.target)||o(!1))};return document.addEventListener("mousedown",b),()=>document.removeEventListener("mousedown",b)},[]);const m=b=>{var A;(A=b.run)==null||A.call(b),s(""),o(!1)},w=b=>{!i||f.length===0||(b.key==="ArrowDown"&&(b.preventDefault(),l(A=>(A+1)%f.length)),b.key==="ArrowUp"&&(b.preventDefault(),l(A=>(A-1+f.length)%f.length)),b.key==="Enter"&&(b.preventDefault(),f[a]&&m(f[a])),b.key==="Escape"&&o(!1))},R=N.useMemo(()=>{const b=new Map;return f.forEach(A=>{b.has(A.group)||b.set(A.group,[]),b.get(A.group).push(A)}),Array.from(b.entries())},[f]);return u.jsxs("div",{className:"oc-search-wrap",ref:d,children:[u.jsx("input",{className:"oc-search",type:"search",inputMode:"search",placeholder:n,"aria-label":n,value:r,onChange:b=>{s(b.target.value),o(!!b.target.value),l(0)},onFocus:()=>o(!!r),onKeyDown:w}),i&&u.jsx("div",{className:"oc-search-dropdown",role:"listbox","aria-label":"Resultados de comandos",children:R.length===0?u.jsx("div",{className:"oc-search-item empty",children:"Escribe para ver opciones"}):R.map(([b,A])=>u.jsxs("div",{children:[u.jsx("div",{className:"oc-search-group",children:b}),A.map(T=>{const E=f.indexOf(T);return u.jsx("button",{className:`oc-search-item ${E===a?"active":""}`,onMouseEnter:()=>l(E),onClick:()=>m(T),role:"option",children:u.jsx("span",{className:"oc-search-title",children:T.label})},T.label)})]},b))})]})}function ZU({open:t,anchorRect:e,onClose:n,onSoon:r,onNavigatePath:s,onSetFactView:i,dark:o}){const[a,l]=N.useState(null),d=N.useRef(null);if(N.useEffect(()=>{if(!t)return;const Y=Lt=>Lt.key==="Escape"&&(n==null?void 0:n()),Ge=()=>n==null?void 0:n();return window.addEventListener("keydown",Y),window.addEventListener("scroll",Ge,!0),()=>{window.removeEventListener("keydown",Y),window.removeEventListener("scroll",Ge,!0)}},[t,n]),!t)return null;const h=((e==null?void 0:e.bottom)||60)+8,f=Math.max(12,Math.min(((e==null?void 0:e.left)||300)-160,window.innerWidth-920)),m=10,w=f+360+m,R=o?"#0b1220":"#ffffff",b=o?"#e5e7eb":"#0f172a",A=o?"#0f1a32":"#f3f6ff",T=o?"#1f2a44":"#e2e8f0",E=o?"#b6c1d1":"#475569",y={position:"fixed",top:h,left:f,width:880,maxWidth:"calc(100vw - 24px)",background:R,color:b,borderRadius:14,boxShadow:"0 18px 40px rgba(2,6,23,.18)",border:`1px solid ${T}`,zIndex:400,padding:12},j={position:"fixed",top:h,left:w,width:420,maxWidth:"calc(100vw - 24px)",background:R,color:b,borderRadius:14,boxShadow:"0 18px 40px rgba(2,6,23,.18)",border:`1px solid ${T}`,zIndex:410,padding:12},V={display:"flex",flexDirection:"column",gap:6,padding:"8px 10px"},M={height:38,borderRadius:10,padding:"0 12px",display:"flex",alignItems:"center",gap:8,fontSize:".92rem",cursor:"pointer",border:"1px solid transparent",background:"transparent",color:b,fontWeight:500,textAlign:"left"},x=(Y,Ge=!0)=>Object.assign(Y.currentTarget.style,Ge?{background:A,borderColor:T}:{background:"transparent",borderColor:"transparent"}),_=()=>{d.current&&clearTimeout(d.current)},S=()=>{_(),d.current=setTimeout(()=>n==null?void 0:n(),180)},C={position:"fixed",top:h,left:f+360,width:m,height:520,zIndex:405},k=[{label:"Recibo de caja",key:"recibo",path:"facturacion/recibo"},{label:"Saldo a favor",key:"saldo",path:"facturacion/saldo"},{label:"Nota crdito",key:"nc",path:"facturacion/nc"},{label:"Nota dbito",key:"nd",path:"facturacion/nd"},{label:"Liquidaciones",key:"liq",path:"facturacion/liq"},{label:"Traslados",key:"tras",path:"facturacion/tras"},{label:"Pagos",key:"pagos",path:"facturacion/pagos"},{label:"rdenes de compra",key:"oc",path:"facturacion/oc"},{label:"Factura de venta",key:"fv",path:"facturacion/facturas"},{label:"Facturas de compra",key:"fc",path:"facturacion/fc"}],D=[{label:"RIPS anteriores (RS-3374)",key:"rips3374"},{label:"RIPS nuevo (RS-2275)",key:"rips2275"}],P=Y=>{i==null||i(Y.key),s==null||s(Y.path),n==null||n()};return u.jsxs(u.Fragment,{children:[u.jsx("div",{onClick:n,style:{position:"fixed",inset:0,background:"transparent",zIndex:399}}),u.jsx("div",{style:y,onMouseEnter:_,onMouseLeave:S,children:u.jsxs("div",{style:{display:"grid",gridTemplateColumns:"360px 1fr",gap:8,alignItems:"start"},children:[u.jsxs("div",{style:V,children:[u.jsx("button",{type:"button",style:M,onMouseEnter:()=>{_(),l("facturacion")},onFocus:()=>{_(),l("facturacion")},onClick:()=>l(Y=>Y==="facturacion"?null:"facturacion"),onMouseOver:Y=>x(Y,!0),onMouseOut:Y=>x(Y,!1),children:" Facturacin "}),u.jsx("button",{type:"button",style:M,onMouseEnter:()=>{_(),l("rips")},onFocus:()=>{_(),l("rips")},onClick:()=>l(Y=>Y==="rips"?null:"rips"),onMouseOver:Y=>x(Y,!0),onMouseOut:Y=>x(Y,!1),children:" RIPS "}),u.jsx("button",{type:"button",style:M,onClick:()=>s==null?void 0:s("agenda"),onMouseOver:Y=>x(Y,!0),onMouseOut:Y=>x(Y,!1),children:" Gestin de agenda"}),u.jsx("button",{type:"button",style:M,onClick:()=>s==null?void 0:s("inventario"),onMouseOver:Y=>x(Y,!0),onMouseOut:Y=>x(Y,!1),children:" Inventario"}),u.jsx("button",{type:"button",style:M,onClick:()=>r==null?void 0:r(),onMouseOver:Y=>x(Y,!0),onMouseOut:Y=>x(Y,!1),children:" Convenios"}),u.jsx("button",{type:"button",style:M,onClick:()=>r==null?void 0:r(),onMouseOver:Y=>x(Y,!0),onMouseOut:Y=>x(Y,!1),children:" Terceros"}),u.jsx("button",{type:"button",style:M,onClick:()=>r==null?void 0:r(),onMouseOver:Y=>x(Y,!0),onMouseOut:Y=>x(Y,!1),children:" Campaas"}),u.jsx("button",{type:"button",style:M,onClick:()=>r==null?void 0:r(),onMouseOver:Y=>x(Y,!0),onMouseOut:Y=>x(Y,!1),children:" Temperatura y humedad"}),u.jsx("button",{type:"button",style:M,onClick:()=>r==null?void 0:r(),onMouseOver:Y=>x(Y,!0),onMouseOut:Y=>x(Y,!1),children:" Residuos"}),u.jsx("button",{type:"button",style:M,onClick:()=>r==null?void 0:r(),onMouseOver:Y=>x(Y,!0),onMouseOut:Y=>x(Y,!1),children:" Medicamentos y planes"}),u.jsx("button",{type:"button",style:M,onClick:()=>r==null?void 0:r(),onMouseOver:Y=>x(Y,!0),onMouseOut:Y=>x(Y,!1),children:" Esterilizacin"})]}),u.jsx("div",{style:V,children:u.jsxs("div",{style:{fontSize:".85rem",color:E},children:["Accesos rpidos a mdulos de administracin. Pasa el mouse por ",u.jsx("b",{children:"Facturacin"})," o ",u.jsx("b",{children:"RIPS"})," para ver sus acciones."]})})]})}),u.jsx("div",{style:C,onMouseEnter:_,onMouseLeave:S}),a&&u.jsx("div",{style:j,onMouseEnter:_,onMouseLeave:S,children:u.jsx("div",{style:{...V,display:"grid",gridTemplateColumns:"1fr"},children:(a==="facturacion"?k:D).map(Y=>u.jsx("button",{type:"button",style:M,onClick:()=>a==="facturacion"?P(Y):r==null?void 0:r(),onMouseOver:Ge=>x(Ge,!0),onMouseOut:Ge=>x(Ge,!1),children:Y.label},Y.label))})})]})}function e6({t,companyName:e,userName:n,role:r,darkMode:s,weeklySeries:i,weekRangeLabel:o,todaysAppointments:a,todaysLoading:l,metrics:d,metricsLoading:h,n8nState:f,n8nLoading:m,recent:w,recentLoading:R,onGoAgenda:b}){return u.jsxs("div",{className:"oc-main-content",children:[u.jsxs("section",{className:"oc-hero","aria-label":"Resumen general",children:[u.jsxs("div",{className:"oc-hero-text",children:[u.jsx("h1",{children:t("welcomeTitle")}),u.jsx("p",{children:t("welcomeSubtitle")}),u.jsxs("p",{className:"oc-hero-meta",children:[t("clinicLabel"),": ",e,"  ",t("userLabel"),": ",n,"  ",t("roleLabel"),": ",r||""]})]}),u.jsxs("div",{className:"oc-hero-badge","aria-live":"polite",children:[u.jsx("span",{className:"oc-hero-badge-title",children:t("stats_appointmentsToday")}),u.jsx("span",{className:"oc-hero-badge-value",children:h&&l?"":d.citasHoy}),u.jsxs("span",{className:"oc-hero-badge-sub",children:[t("stats_patientsToday"),": ",h?"":d.pacientesHoy]})]})]}),u.jsxs("section",{className:"oc-stats-row","aria-label":"Indicadores del da",children:[u.jsxs("div",{className:"stat-card",children:[u.jsx("span",{className:"stat-label",children:t("stats_patientsToday")}),u.jsx("span",{className:"stat-value",children:d.pacientesHoy})]}),u.jsxs("div",{className:"stat-card",children:[u.jsx("span",{className:"stat-label",children:t("stats_appointmentsToday")}),u.jsx("span",{className:"stat-value",children:d.citasHoy})]}),u.jsxs("div",{className:"stat-card",children:[u.jsx("span",{className:"stat-label",children:t("stats_revenueToday")}),u.jsxs("span",{className:"stat-value",children:[d.facturacionHoy.toLocaleString("es-CO")," ",u.jsx("span",{className:"stat-currency",children:t("stats_currency")})]})]}),u.jsxs("div",{className:"stat-card",children:[u.jsx("span",{className:"stat-label",children:t("stats_waiting")}),u.jsx("span",{className:"stat-value",children:d.enEspera})]})]}),u.jsxs("section",{className:"oc-grid","aria-label":"Contenido principal del dashboard",children:[u.jsx("div",{className:"oc-grid-main",children:u.jsxs("div",{className:"card card-quickcharts",children:[u.jsxs("div",{className:"oc-card-head",style:{display:"flex",justifyContent:"space-between",alignItems:"center",gap:8},children:[u.jsx("h3",{children:"Pacientes registrados  ltimos 7 das"}),u.jsx("span",{className:"oc-muted",style:{marginLeft:8,fontSize:12},children:o})]}),i.length===0||i.every(A=>((A==null?void 0:A.value)||0)===0)?u.jsx("p",{className:"oc-weekly-empty",children:"Sin pacientes registrados en la ltima semana."}):u.jsx(XU,{data:i})]})}),u.jsxs("aside",{className:"oc-grid-side","aria-label":"Panel lateral",children:[u.jsxs("div",{className:"card",children:[u.jsx("h3",{children:t("n8n_title")}),m?u.jsx("span",{className:"oc-muted",children:t("loading")}):u.jsx(HU,{status:f})]}),u.jsxs("div",{className:"card",children:[u.jsxs("div",{className:"oc-card-head",style:{display:"flex",justifyContent:"space-between",alignItems:"center",gap:8},children:[u.jsx("h3",{children:t("todays_appts")}),u.jsx("button",{className:"oc-small-link",type:"button",onClick:b,children:t("see_schedule")})]}),l?u.jsx("span",{className:"oc-muted",children:t("loading")}):a.length===0?u.jsx("p",{className:"oc-muted",children:t("no_appts_today")}):u.jsx("ul",{className:"oc-list",children:a.slice(0,5).map(A=>u.jsxs("li",{className:"oc-list-item",children:[u.jsxs("div",{className:"oc-list-main",children:[u.jsx("b",{children:A.pacienteNombre||"Paciente"})," ",u.jsxs("span",{className:"oc-muted",children:[t("at")," ",QU(A.fecha,MA())]})]}),u.jsx("div",{className:`oc-tag oc-tag-${(A.estado||"programada").toLowerCase().replace(/\s+/g,"-")}`,children:A.estado||"programada"})]},A.id))})]}),u.jsxs("div",{className:"card",children:[u.jsx("h3",{children:"Actividad reciente"}),R?u.jsx("span",{className:"oc-muted",children:t("loading")}):w.length===0?u.jsx("p",{className:"oc-muted",children:t("recent_empty")}):u.jsx(qU,{items:w})]})]})]}),u.jsxs("footer",{className:"oc-footer",children:[" ",new Date().getFullYear()," OdontoCloud | Creado por Ingeniero Juan Madrid"]})]})}function Pp(){const t=Sc(),e=Or(),[n]=N.useState(MA()),r=q=>Rp[n][q]||q,[s,i]=N.useState("Inicio"),[o,a]=N.useState("recibo"),[l,d]=N.useState(()=>{try{return localStorage.getItem("odontocloud:dark")==="1"}catch{return!1}});N.useEffect(()=>{try{localStorage.setItem("odontocloud:dark",l?"1":"0")}catch{}document.documentElement.classList.toggle("dark",l)},[l]);const[h]=N.useState(()=>WU()),[f]=N.useState((h==null?void 0:h.rol)||""),[m]=N.useState((h==null?void 0:h.email)||""),[w,R]=N.useState("OdontoCloud"),[b,A]=N.useState(m||"Usuario"),[T,E]=N.useState(!0);N.useEffect(()=>{const q=wy(ch,async ne=>{try{if(!ne){A(m||"Usuario"),R("OdontoCloud"),E(!1);return}A(ne.displayName||ne.email||m||"Usuario");const H=Kt(ye,"empresas",ne.uid),Q=await ih(H);R(Q.exists()&&Q.data().nombre||"OdontoCloud")}catch(H){console.error("Error cargando empresa/usuario:",H)}finally{E(!1)}});return()=>q()},[m]);const[y,j]=N.useState({pacientesHoy:0,citasHoy:0,facturacionHoy:0,enEspera:0}),[V,M]=N.useState(!0),[x,_]=N.useState([]),[S,C]=N.useState([]),[k,D]=N.useState(!0),{startToday:P,endToday:Y,startTodayJS:Ge}=KU(),Lt=N.useMemo(()=>GU(Ge),[Ge]),he=N.useMemo(()=>{const q=new Date,ne=new Date(q.getFullYear(),q.getMonth(),q.getDate()-6),H=q,Q=de=>de.toLocaleDateString(n==="es"?"es-ES":"en-US",{weekday:"short",day:"2-digit",month:"short"}).replace(".","");return`${Q(ne)}  ${Q(H)}`},[n]),Z=q=>{var Se;const ne=q.data()||{};let H;if((Se=ne.fecha)!=null&&Se.toDate){H=ne.fecha.toDate();const Ae=ne.horaInicio||ne.hora;if(Ae&&typeof Ae=="string"){const[Be=0,Te=0]=Ae.split(":").map(Le=>parseInt(Le,10));H.setHours(Be||0,Te||0,0,0)}}else if(typeof ne.fecha=="string"){const Ae=ne.horaInicio||ne.hora||"00:00";H=YU(ne.fecha,Ae)}else H=new Date;const Q=ne.pacienteNombre||ne.paciente||"Paciente",de=ne.estado&&String(ne.estado)||"programada";return{id:q.id,fecha:H,pacienteId:ne.pacienteId||"",pacienteNombre:Q,estado:de,motivo:ne.motivo||""}};N.useEffect(()=>{const q=tt(Ue(ye,"citas"),Ye("fecha",">=",P),Ye("fecha","<",Y),Gt("fecha","asc")),ne=tt(Ue(ye,"citas"),Ye("fecha","==",Lt));let H=new Map,Q=!1,de=!1;const Se=()=>{const Te=Array.from(H.values()).sort((me,qe)=>me.fecha.getTime()-qe.fecha.getTime()),Le=Te.filter(me=>String(me.estado).toLowerCase().trim()==="en espera").length;C(Te),j(me=>({...me,citasHoy:Te.length,enEspera:Le})),Q&&de&&D(!1)},Ae=rr(q,Te=>{Q=!0;const Le=new Map(H);Te.docs.forEach(me=>Le.set(me.id,Z(me))),H=Le,Se()},Te=>{console.error("Realtime citas hoy (TS):",Te),Q=!0,Se()}),Be=rr(ne,Te=>{de=!0;const Le=new Map(H);Te.docs.forEach(me=>Le.set(me.id,Z(me))),H=Le,Se()},Te=>{console.error("Realtime citas hoy (STR):",Te),de=!0,Se()});return()=>{try{Ae(),Be()}catch{}}},[P,Y,Lt]),N.useEffect(()=>{(async()=>{try{const H=(await DM(Ue(ye,"pacientes"))).data().count||0;let Q=0;try{const de=tt(Ue(ye,"facturas"),Ye("fecha",">=",P),Ye("fecha","<",Y));(await Wt(de)).forEach(Ae=>{const Be=Ae.data();typeof Be.monto=="number"&&(Q+=Be.monto)})}catch{Q=0}j(de=>({...de,pacientesHoy:H,facturacionHoy:Q}))}catch(ne){console.error("Error cargando mtricas:",ne),j(H=>({...H,pacientesHoy:0,facturacionHoy:0}))}finally{M(!1)}})()},[P,Y]),N.useEffect(()=>{const q=new Date,ne=new Date(q.getFullYear(),q.getMonth(),q.getDate()-6),H=new Date(q.getFullYear(),q.getMonth(),q.getDate()+1),Q=new Map;for(let Ae=0;Ae<7;Ae++){const Be=new Date(q.getFullYear(),q.getMonth(),q.getDate()-(6-Ae)),Te=Be.toISOString().slice(0,10),Le=Be.toLocaleDateString(n==="es"?"es-ES":"en-US"),me=Be.toLocaleDateString(n==="es"?"es-ES":"en-US",{weekday:"short",day:"2-digit"}).replace(".","");Q.set(Te,{label:Le,shortLabel:me,value:0})}const de=tt(Ue(ye,"pacientes"),Ye("createdAt",">=",$e.fromDate(ne)),Ye("createdAt","<",$e.fromDate(H))),Se=rr(de,Ae=>{const Be=new Map(Q);Ae.docs.forEach(Te=>{var X;const Le=Te.data()||{},me=(X=Te.data().createdAt)!=null&&X.toDate?Te.data().createdAt.toDate():Le.createdAt?new Date(Le.createdAt):null;if(!me||isNaN(me))return;const qe=me.toISOString().slice(0,10);if(!Be.has(qe))return;const F=Be.get(qe);F.value+=1,Be.set(qe,F)}),_(Array.from(Be.values()))},Ae=>{console.error("Error realtime serie semanal (pacientes):",Ae),_(Array.from(Q.values()))});return()=>{try{Se()}catch{}}},[n]);const[ce,pe]=N.useState([]),[Ve,Qe]=N.useState(!0);N.useEffect(()=>{(async()=>{try{const ne=tt(Ue(ye,"actividad"),Gt("fecha","desc"),Zo(5)),H=await Wt(ne);pe(H.docs.map(Q=>({id:Q.id,title:Q.data().descripcion||Q.data().titulo||"Actividad",time:Q.data().resumenTiempo||""})))}catch(ne){console.error("Error cargando actividad:",ne),pe([])}finally{Qe(!1)}})()},[]);const[z,te]=N.useState(null),[ue,Ee]=N.useState(!0);N.useEffect(()=>{(async()=>{try{const ne=Kt(ye,"integraciones","n8n"),H=await ih(ne);te(H.exists()?{connected:!!H.data().connected,flowsRunning:H.data().flowsRunning||0,lastError:H.data().lastError||null}:{connected:!1,flowsRunning:0,lastError:null})}catch(ne){console.error("Error cargando estado n8n:",ne),te({connected:!1,flowsRunning:0,lastError:"No se pudo leer el estado desde Firebase."})}finally{Ee(!1)}})()},[]);const we=async()=>{try{localStorage.removeItem("odc_session")}catch{}try{await Fj(ch)}catch(q){console.error("Error al cerrar sesin:",q)}window.location.href="/"},[ke,ae]=N.useState(!1),[nt,xe]=N.useState(null),se=N.useRef(null);N.useRef(null);const De=()=>{var ne,H;const q=(H=(ne=se.current)==null?void 0:ne.getBoundingClientRect)==null?void 0:H.call(ne);xe(q),ae(!0)};N.useEffect(()=>{const q=e.pathname.toLowerCase(),ne=q.includes("/pacientes"),H=q.includes("/caja"),Q=q.includes("/agenda"),de=q.includes("/facturacion"),Se=q.includes("/inventario"),Ae=q.includes("/odontograma"),Be=q.includes("/reportes");i(ne?"Pacientes":H?"Caja":Q?"Agenda":Se?"Inventario":Ae?"Odontograma":Be?"Reportes":"Inicio"),de&&(i("Facturacin"),q.includes("/pagos")?a("pagos"):q.includes("/facturas")?a("fv"):q.includes("/recibo")?a("recibo"):q.includes("/saldo")?a("saldo"):q.includes("/nc")?a("nc"):q.includes("/nd")?a("nd"):q.includes("/liq")?a("liq"):q.includes("/tras")?a("tras"):q.includes("/oc")?a("oc"):q.includes("/fc")?a("fc"):a("recibo"))},[e.pathname]);const it=N.useMemo(()=>{const q=e.pathname.split("/").filter(Boolean),ne=q.findIndex(H=>H.startsWith("dashboard_"));return ne>=0?`/${q.slice(0,ne+1).join("/")}`:""},[e.pathname]),rt=(q="")=>{const ne=String(q).replace(/^\/+|\/+$/g,""),H=ne?`${it}/${ne}`:it||"/",Q=e.pathname.toLowerCase()===H.toLowerCase();t(H,{replace:Q})},ft=()=>{switch(s){case"Agenda":return u.jsx(SU,{});case"Pacientes":return u.jsx(N.Suspense,{fallback:u.jsx("div",{style:{padding:16},children:"Cargando"}),children:u.jsx(OU,{})});case"Facturacin":return u.jsx(bU,{view:o});case"Inventario":return u.jsx(CU,{});case"Odontograma":return u.jsx(AU,{});case"Reportes":return u.jsx(MU,{});case"Caja":return u.jsx(zU,{});case"Inicio":default:return null}};return u.jsxs("div",{className:`oc-shell ${l?"oc-dark":""}`,children:[u.jsx("a",{href:"#oc-main",className:"oc-skip-link",children:"Saltar al contenido"}),u.jsxs("header",{className:"oc-header",role:"banner",children:[u.jsxs("div",{className:"oc-header-left",children:[u.jsx("img",{src:gA,alt:"OdontoCloud",className:"oc-logo"}),u.jsxs("div",{className:"oc-brand-text",children:[u.jsx("span",{className:"oc-brand-main",children:"OdontoCloud"}),u.jsx("span",{className:"oc-brand-sub",children:T?"...":w})]})]}),u.jsxs("nav",{className:"oc-nav",role:"navigation","aria-label":"Navegacin principal",children:[u.jsx(xo,{to:it,end:!0,className:({isActive:q})=>q&&s==="Inicio"?"oc-nav-btn active":"oc-nav-btn",title:r("nav_home"),children:r("nav_home")}),u.jsx(xo,{to:`${it}/agenda`,className:({isActive:q})=>q||s==="Agenda"?"oc-nav-btn active":"oc-nav-btn",title:r("nav_agenda"),children:r("nav_agenda")}),u.jsx(xo,{to:`${it}/pacientes`,className:({isActive:q})=>q||s==="Pacientes"?"oc-nav-btn active":"oc-nav-btn",title:r("nav_patients"),children:r("nav_patients")}),u.jsx(xo,{to:`${it}/caja`,className:({isActive:q})=>q||s==="Caja"?"oc-nav-btn active":"oc-nav-btn",title:r("nav_cash"),children:r("nav_cash")}),u.jsx("button",{type:"button",ref:se,className:"oc-nav-btn",title:r("nav_admin"),"aria-haspopup":"true","aria-expanded":ke,onClick:()=>ke?ae(!1):De(),onMouseEnter:()=>De(),onFocus:()=>De(),children:r("nav_admin")}),u.jsx(xo,{to:`${it}/reportes`,className:({isActive:q})=>q||s==="Reportes"?"oc-nav-btn active":"oc-nav-btn",title:r("nav_reports"),children:r("nav_reports")})]}),u.jsxs("div",{className:"oc-header-right",children:[u.jsx(JU,{placeholder:r("searchPlaceholder"),onNavigate:q=>{q==="Inicio"?rt(""):q==="Facturacin"?(a("recibo"),rt("facturacion/recibo")):rt(q.toLowerCase())},onAction:q=>{switch(q){case"new_appointment":case"agenda_today":case"export_agenda":rt("agenda");break;case"new_patient":rt("pacientes");break;case"new_invoice":a("fv"),rt("facturacion/facturas");break;case"toggle_dark":d(ne=>!ne);break;case"logout":we();break;case"show_shortcuts":alert("Atajos: Ctrl/Cmd + K para abrir bsqueda, / para moverse, Enter para ejecutar.");break;case"support":window.open("https://tu-soporte.odc","_blank");break}}}),u.jsx("button",{className:"oc-icon-btn",type:"button",onClick:()=>d(q=>!q),"aria-pressed":l,title:l?"Activar modo claro":"Activar modo oscuro",children:l?"":""}),u.jsx("button",{className:"oc-icon-btn",type:"button",onClick:we,title:Rp[n].logout,children:Rp[n].logout})]})]}),u.jsx(ZU,{open:ke,anchorRect:nt,dark:l,onClose:()=>ae(!1),onSoon:()=>{alert("Prximamente"),ae(!1)},onNavigatePath:q=>{rt(q),ae(!1)},onSetFactView:q=>a(q)}),u.jsxs("main",{id:"oc-main",className:"oc-main-wrapper",role:"main",children:[s!=="Inicio"&&ft(),s==="Inicio"&&u.jsx(e6,{t:r,companyName:w,userName:b,role:f,darkMode:l,weeklySeries:x,weekRangeLabel:he,todaysAppointments:S,todaysLoading:k,metrics:y,metricsLoading:V,n8nState:z,n8nLoading:ue,recent:ce,recentLoading:Ve,onGoAgenda:()=>rt("agenda")})]})]})}const FA=()=>{try{const t=JSON.parse(localStorage.getItem("odc_session"));return t&&Date.now()-t.timestamp<1e3*60*60*24?t:null}catch{return null}},UA=t=>{const e=(t||"").toLowerCase();return e==="administrador"?"/dashboard_admin":e==="doctor"?"/dashboard_doctor":e==="recepcionista"?"/dashboard_recepcion":"/"};function Np({allowedRoles:t,children:e}){var s;const n=FA();if(!n)return u.jsx(kd,{to:"/",replace:!0});const r=(s=n.rol)==null?void 0:s.toLowerCase();return t.map(i=>i.toLowerCase()).includes(r)?e:u.jsx(kd,{to:UA(n.rol),replace:!0})}function t6(){const t=FA();return u.jsxs(SN,{children:[u.jsx(To,{path:"/",element:t?u.jsx(kd,{to:UA(t.rol),replace:!0}):u.jsx(t4,{})}),u.jsx(To,{path:"/dashboard_admin/*",element:u.jsx(Np,{allowedRoles:["administrador"],children:u.jsx(Pp,{})})}),u.jsx(To,{path:"/dashboard_doctor/*",element:u.jsx(Np,{allowedRoles:["doctor"],children:u.jsx(Pp,{})})}),u.jsx(To,{path:"/dashboard_recepcion/*",element:u.jsx(Np,{allowedRoles:["recepcionista"],children:u.jsx(Pp,{})})}),u.jsx(To,{path:"*",element:u.jsx(kd,{to:"/",replace:!0})})]})}async function n6(){try{await Vj(ch,NS),await yM(ye),console.log(" Firebase listo con sesin persistente y modo offline.")}catch(t){console.warn(" Firebase offline/persistencia fall:",t.message)}}const r6="modulepreload",s6=function(t){return"/odontocloud-react/"+t},cT={},i6=function(e,n,r){let s=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),a=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));s=Promise.allSettled(n.map(l=>{if(l=s6(l),l in cT)return;cT[l]=!0;const d=l.endsWith(".css"),h=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${h}`))return;const f=document.createElement("link");if(f.rel=d?"stylesheet":r6,d||(f.as="script"),f.crossOrigin="",f.href=l,a&&f.setAttribute("nonce",a),document.head.appendChild(f),d)return new Promise((m,w)=>{f.addEventListener("load",m),f.addEventListener("error",()=>w(new Error(`Unable to preload CSS for ${l}`)))})}))}function i(o){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=o,window.dispatchEvent(a),!a.defaultPrevented)throw o}return s.then(o=>{for(const a of o||[])a.status==="rejected"&&i(a.reason);return e().catch(i)})};function o6(t={}){const{immediate:e=!1,onNeedRefresh:n,onOfflineReady:r,onRegistered:s,onRegisteredSW:i,onRegisterError:o}=t;let a,l;const d=async(f=!0)=>{await l};async function h(){if("serviceWorker"in navigator){if(a=await i6(async()=>{const{Workbox:f}=await import("./workbox-window.prod.es5-vqzQaGvo.js");return{Workbox:f}},[]).then(({Workbox:f})=>new f("/odontocloud-react/sw.js",{scope:"/odontocloud-react/",type:"classic"})).catch(f=>{o==null||o(f)}),!a)return;a.addEventListener("activated",f=>{(f.isUpdate||f.isExternal)&&window.location.reload()}),a.addEventListener("installed",f=>{f.isUpdate||r==null||r()}),a.register({immediate:e}).then(f=>{i?i("/odontocloud-react/sw.js",f):s==null||s(f)}).catch(f=>{o==null||o(f)})}}return l=h(),d}const a6="/odontocloud-react/";n6();o6({immediate:!0});Sx(document.getElementById("root")).render(u.jsx(IT.StrictMode,{children:u.jsx(GN,{basename:a6,children:u.jsx(t6,{})})}));
