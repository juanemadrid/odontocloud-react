(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();function gR(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Sx={exports:{}},Ch={},bx={exports:{}},Oe={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Mc=Symbol.for("react.element"),yR=Symbol.for("react.portal"),vR=Symbol.for("react.fragment"),_R=Symbol.for("react.strict_mode"),wR=Symbol.for("react.profiler"),ER=Symbol.for("react.provider"),IR=Symbol.for("react.context"),xR=Symbol.for("react.forward_ref"),TR=Symbol.for("react.suspense"),SR=Symbol.for("react.memo"),bR=Symbol.for("react.lazy"),C_=Symbol.iterator;function CR(t){return t===null||typeof t!="object"?null:(t=C_&&t[C_]||t["@@iterator"],typeof t=="function"?t:null)}var Cx={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Ax=Object.assign,Rx={};function Ba(t,e,n){this.props=t,this.context=e,this.refs=Rx,this.updater=n||Cx}Ba.prototype.isReactComponent={};Ba.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Ba.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function Px(){}Px.prototype=Ba.prototype;function Ig(t,e,n){this.props=t,this.context=e,this.refs=Rx,this.updater=n||Cx}var xg=Ig.prototype=new Px;xg.constructor=Ig;Ax(xg,Ba.prototype);xg.isPureReactComponent=!0;var A_=Array.isArray,Nx=Object.prototype.hasOwnProperty,Tg={current:null},kx={key:!0,ref:!0,__self:!0,__source:!0};function Dx(t,e,n){var r,s={},i=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(i=""+e.key),e)Nx.call(e,r)&&!kx.hasOwnProperty(r)&&(s[r]=e[r]);var a=arguments.length-2;if(a===1)s.children=n;else if(1<a){for(var l=Array(a),d=0;d<a;d++)l[d]=arguments[d+2];s.children=l}if(t&&t.defaultProps)for(r in a=t.defaultProps,a)s[r]===void 0&&(s[r]=a[r]);return{$$typeof:Mc,type:t,key:i,ref:o,props:s,_owner:Tg.current}}function AR(t,e){return{$$typeof:Mc,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function Sg(t){return typeof t=="object"&&t!==null&&t.$$typeof===Mc}function RR(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var R_=/\/+/g;function zf(t,e){return typeof t=="object"&&t!==null&&t.key!=null?RR(""+t.key):e.toString(36)}function Ku(t,e,n,r,s){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case Mc:case yR:o=!0}}if(o)return o=t,s=s(o),t=r===""?"."+zf(o,0):r,A_(s)?(n="",t!=null&&(n=t.replace(R_,"$&/")+"/"),Ku(s,e,n,"",function(d){return d})):s!=null&&(Sg(s)&&(s=AR(s,n+(!s.key||o&&o.key===s.key?"":(""+s.key).replace(R_,"$&/")+"/")+t)),e.push(s)),1;if(o=0,r=r===""?".":r+":",A_(t))for(var a=0;a<t.length;a++){i=t[a];var l=r+zf(i,a);o+=Ku(i,e,n,l,s)}else if(l=CR(t),typeof l=="function")for(t=l.call(t),a=0;!(i=t.next()).done;)i=i.value,l=r+zf(i,a++),o+=Ku(i,e,n,l,s);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function vu(t,e,n){if(t==null)return t;var r=[],s=0;return Ku(t,r,"","",function(i){return e.call(n,i,s++)}),r}function PR(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var En={current:null},Qu={transition:null},NR={ReactCurrentDispatcher:En,ReactCurrentBatchConfig:Qu,ReactCurrentOwner:Tg};function jx(){throw Error("act(...) is not supported in production builds of React.")}Oe.Children={map:vu,forEach:function(t,e,n){vu(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return vu(t,function(){e++}),e},toArray:function(t){return vu(t,function(e){return e})||[]},only:function(t){if(!Sg(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Oe.Component=Ba;Oe.Fragment=vR;Oe.Profiler=wR;Oe.PureComponent=Ig;Oe.StrictMode=_R;Oe.Suspense=TR;Oe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=NR;Oe.act=jx;Oe.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=Ax({},t.props),s=t.key,i=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,o=Tg.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(l in e)Nx.call(e,l)&&!kx.hasOwnProperty(l)&&(r[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)r.children=n;else if(1<l){a=Array(l);for(var d=0;d<l;d++)a[d]=arguments[d+2];r.children=a}return{$$typeof:Mc,type:t.type,key:s,ref:i,props:r,_owner:o}};Oe.createContext=function(t){return t={$$typeof:IR,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:ER,_context:t},t.Consumer=t};Oe.createElement=Dx;Oe.createFactory=function(t){var e=Dx.bind(null,t);return e.type=t,e};Oe.createRef=function(){return{current:null}};Oe.forwardRef=function(t){return{$$typeof:xR,render:t}};Oe.isValidElement=Sg;Oe.lazy=function(t){return{$$typeof:bR,_payload:{_status:-1,_result:t},_init:PR}};Oe.memo=function(t,e){return{$$typeof:SR,type:t,compare:e===void 0?null:e}};Oe.startTransition=function(t){var e=Qu.transition;Qu.transition={};try{t()}finally{Qu.transition=e}};Oe.unstable_act=jx;Oe.useCallback=function(t,e){return En.current.useCallback(t,e)};Oe.useContext=function(t){return En.current.useContext(t)};Oe.useDebugValue=function(){};Oe.useDeferredValue=function(t){return En.current.useDeferredValue(t)};Oe.useEffect=function(t,e){return En.current.useEffect(t,e)};Oe.useId=function(){return En.current.useId()};Oe.useImperativeHandle=function(t,e,n){return En.current.useImperativeHandle(t,e,n)};Oe.useInsertionEffect=function(t,e){return En.current.useInsertionEffect(t,e)};Oe.useLayoutEffect=function(t,e){return En.current.useLayoutEffect(t,e)};Oe.useMemo=function(t,e){return En.current.useMemo(t,e)};Oe.useReducer=function(t,e,n){return En.current.useReducer(t,e,n)};Oe.useRef=function(t){return En.current.useRef(t)};Oe.useState=function(t){return En.current.useState(t)};Oe.useSyncExternalStore=function(t,e,n){return En.current.useSyncExternalStore(t,e,n)};Oe.useTransition=function(){return En.current.useTransition()};Oe.version="18.3.1";bx.exports=Oe;var A=bx.exports;const Ox=gR(A);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var kR=A,DR=Symbol.for("react.element"),jR=Symbol.for("react.fragment"),OR=Object.prototype.hasOwnProperty,VR=kR.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,LR={key:!0,ref:!0,__self:!0,__source:!0};function Vx(t,e,n){var r,s={},i=null,o=null;n!==void 0&&(i=""+n),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)OR.call(e,r)&&!LR.hasOwnProperty(r)&&(s[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)s[r]===void 0&&(s[r]=e[r]);return{$$typeof:DR,type:t,key:i,ref:o,props:s,_owner:VR.current}}Ch.Fragment=jR;Ch.jsx=Vx;Ch.jsxs=Vx;Sx.exports=Ch;var c=Sx.exports,Lx={exports:{}},Wn={},Mx={exports:{}},Fx={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(Z,de){var pe=Z.length;Z.push(de);e:for(;0<pe;){var Re=pe-1>>>1,Xe=Z[Re];if(0<s(Xe,de))Z[Re]=de,Z[pe]=Xe,pe=Re;else break e}}function n(Z){return Z.length===0?null:Z[0]}function r(Z){if(Z.length===0)return null;var de=Z[0],pe=Z.pop();if(pe!==de){Z[0]=pe;e:for(var Re=0,Xe=Z.length,Dt=Xe>>>1;Re<Dt;){var U=2*(Re+1)-1,ne=Z[U],ce=U+1,xe=Z[ce];if(0>s(ne,pe))ce<Xe&&0>s(xe,ne)?(Z[Re]=xe,Z[ce]=pe,Re=ce):(Z[Re]=ne,Z[U]=pe,Re=U);else if(ce<Xe&&0>s(xe,pe))Z[Re]=xe,Z[ce]=pe,Re=ce;else break e}}return de}function s(Z,de){var pe=Z.sortIndex-de.sortIndex;return pe!==0?pe:Z.id-de.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var l=[],d=[],h=1,f=null,m=3,v=!1,R=!1,T=!1,P=typeof setTimeout=="function"?setTimeout:null,E=typeof clearTimeout=="function"?clearTimeout:null,I=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function S(Z){for(var de=n(d);de!==null;){if(de.callback===null)r(d);else if(de.startTime<=Z)r(d),de.sortIndex=de.expirationTime,e(l,de);else break;de=n(d)}}function b(Z){if(T=!1,S(Z),!R)if(n(l)!==null)R=!0,Ft(L);else{var de=n(d);de!==null&&dn(b,de.startTime-Z)}}function L(Z,de){R=!1,T&&(T=!1,E(_),_=-1),v=!0;var pe=m;try{for(S(de),f=n(l);f!==null&&(!(f.expirationTime>de)||Z&&!D());){var Re=f.callback;if(typeof Re=="function"){f.callback=null,m=f.priorityLevel;var Xe=Re(f.expirationTime<=de);de=t.unstable_now(),typeof Xe=="function"?f.callback=Xe:f===n(l)&&r(l),S(de)}else r(l);f=n(l)}if(f!==null)var Dt=!0;else{var U=n(d);U!==null&&dn(b,U.startTime-de),Dt=!1}return Dt}finally{f=null,m=pe,v=!1}}var B=!1,w=null,_=-1,y=5,N=-1;function D(){return!(t.unstable_now()-N<y)}function j(){if(w!==null){var Z=t.unstable_now();N=Z;var de=!0;try{de=w(!0,Z)}finally{de?k():(B=!1,w=null)}}else B=!1}var k;if(typeof I=="function")k=function(){I(j)};else if(typeof MessageChannel<"u"){var K=new MessageChannel,Ke=K.port2;K.port1.onmessage=j,k=function(){Ke.postMessage(null)}}else k=function(){P(j,0)};function Ft(Z){w=Z,B||(B=!0,k())}function dn(Z,de){_=P(function(){Z(t.unstable_now())},de)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(Z){Z.callback=null},t.unstable_continueExecution=function(){R||v||(R=!0,Ft(L))},t.unstable_forceFrameRate=function(Z){0>Z||125<Z?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):y=0<Z?Math.floor(1e3/Z):5},t.unstable_getCurrentPriorityLevel=function(){return m},t.unstable_getFirstCallbackNode=function(){return n(l)},t.unstable_next=function(Z){switch(m){case 1:case 2:case 3:var de=3;break;default:de=m}var pe=m;m=de;try{return Z()}finally{m=pe}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(Z,de){switch(Z){case 1:case 2:case 3:case 4:case 5:break;default:Z=3}var pe=m;m=Z;try{return de()}finally{m=pe}},t.unstable_scheduleCallback=function(Z,de,pe){var Re=t.unstable_now();switch(typeof pe=="object"&&pe!==null?(pe=pe.delay,pe=typeof pe=="number"&&0<pe?Re+pe:Re):pe=Re,Z){case 1:var Xe=-1;break;case 2:Xe=250;break;case 5:Xe=1073741823;break;case 4:Xe=1e4;break;default:Xe=5e3}return Xe=pe+Xe,Z={id:h++,callback:de,priorityLevel:Z,startTime:pe,expirationTime:Xe,sortIndex:-1},pe>Re?(Z.sortIndex=pe,e(d,Z),n(l)===null&&Z===n(d)&&(T?(E(_),_=-1):T=!0,dn(b,pe-Re))):(Z.sortIndex=Xe,e(l,Z),R||v||(R=!0,Ft(L))),Z},t.unstable_shouldYield=D,t.unstable_wrapCallback=function(Z){var de=m;return function(){var pe=m;m=de;try{return Z.apply(this,arguments)}finally{m=pe}}}})(Fx);Mx.exports=Fx;var MR=Mx.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var FR=A,qn=MR;function G(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Ux=new Set,oc={};function _o(t,e){Ea(t,e),Ea(t+"Capture",e)}function Ea(t,e){for(oc[t]=e,t=0;t<e.length;t++)Ux.add(e[t])}var cs=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Wp=Object.prototype.hasOwnProperty,UR=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,P_={},N_={};function $R(t){return Wp.call(N_,t)?!0:Wp.call(P_,t)?!1:UR.test(t)?N_[t]=!0:(P_[t]=!0,!1)}function BR(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function zR(t,e,n,r){if(e===null||typeof e>"u"||BR(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function In(t,e,n,r,s,i,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=o}var Jt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Jt[t]=new In(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Jt[e]=new In(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Jt[t]=new In(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Jt[t]=new In(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Jt[t]=new In(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Jt[t]=new In(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Jt[t]=new In(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Jt[t]=new In(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Jt[t]=new In(t,5,!1,t.toLowerCase(),null,!1,!1)});var bg=/[\-:]([a-z])/g;function Cg(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(bg,Cg);Jt[e]=new In(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(bg,Cg);Jt[e]=new In(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(bg,Cg);Jt[e]=new In(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Jt[t]=new In(t,1,!1,t.toLowerCase(),null,!1,!1)});Jt.xlinkHref=new In("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Jt[t]=new In(t,1,!1,t.toLowerCase(),null,!0,!0)});function Ag(t,e,n,r){var s=Jt.hasOwnProperty(e)?Jt[e]:null;(s!==null?s.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(zR(e,n,s,r)&&(n=null),r||s===null?$R(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):s.mustUseProperty?t[s.propertyName]=n===null?s.type===3?!1:"":n:(e=s.attributeName,r=s.attributeNamespace,n===null?t.removeAttribute(e):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var _s=FR.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,_u=Symbol.for("react.element"),Go=Symbol.for("react.portal"),Ko=Symbol.for("react.fragment"),Rg=Symbol.for("react.strict_mode"),Gp=Symbol.for("react.profiler"),$x=Symbol.for("react.provider"),Bx=Symbol.for("react.context"),Pg=Symbol.for("react.forward_ref"),Kp=Symbol.for("react.suspense"),Qp=Symbol.for("react.suspense_list"),Ng=Symbol.for("react.memo"),js=Symbol.for("react.lazy"),zx=Symbol.for("react.offscreen"),k_=Symbol.iterator;function hl(t){return t===null||typeof t!="object"?null:(t=k_&&t[k_]||t["@@iterator"],typeof t=="function"?t:null)}var yt=Object.assign,qf;function Al(t){if(qf===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);qf=e&&e[1]||""}return`
`+qf+t}var Hf=!1;function Wf(t,e){if(!t||Hf)return"";Hf=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(d){var r=d}Reflect.construct(t,[],e)}else{try{e.call()}catch(d){r=d}t.call(e.prototype)}else{try{throw Error()}catch(d){r=d}t()}}catch(d){if(d&&r&&typeof d.stack=="string"){for(var s=d.stack.split(`
`),i=r.stack.split(`
`),o=s.length-1,a=i.length-1;1<=o&&0<=a&&s[o]!==i[a];)a--;for(;1<=o&&0<=a;o--,a--)if(s[o]!==i[a]){if(o!==1||a!==1)do if(o--,a--,0>a||s[o]!==i[a]){var l=`
`+s[o].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=o&&0<=a);break}}}finally{Hf=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Al(t):""}function qR(t){switch(t.tag){case 5:return Al(t.type);case 16:return Al("Lazy");case 13:return Al("Suspense");case 19:return Al("SuspenseList");case 0:case 2:case 15:return t=Wf(t.type,!1),t;case 11:return t=Wf(t.type.render,!1),t;case 1:return t=Wf(t.type,!0),t;default:return""}}function Yp(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Ko:return"Fragment";case Go:return"Portal";case Gp:return"Profiler";case Rg:return"StrictMode";case Kp:return"Suspense";case Qp:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case Bx:return(t.displayName||"Context")+".Consumer";case $x:return(t._context.displayName||"Context")+".Provider";case Pg:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Ng:return e=t.displayName||null,e!==null?e:Yp(t.type)||"Memo";case js:e=t._payload,t=t._init;try{return Yp(t(e))}catch{}}return null}function HR(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Yp(e);case 8:return e===Rg?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function li(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function qx(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function WR(t){var e=qx(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,i=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(o){r=""+o,i.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function wu(t){t._valueTracker||(t._valueTracker=WR(t))}function Hx(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=qx(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function Td(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Xp(t,e){var n=e.checked;return yt({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function D_(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=li(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function Wx(t,e){e=e.checked,e!=null&&Ag(t,"checked",e,!1)}function Jp(t,e){Wx(t,e);var n=li(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Zp(t,e.type,n):e.hasOwnProperty("defaultValue")&&Zp(t,e.type,li(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function j_(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function Zp(t,e,n){(e!=="number"||Td(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var Rl=Array.isArray;function aa(t,e,n,r){if(t=t.options,e){e={};for(var s=0;s<n.length;s++)e["$"+n[s]]=!0;for(n=0;n<t.length;n++)s=e.hasOwnProperty("$"+t[n].value),t[n].selected!==s&&(t[n].selected=s),s&&r&&(t[n].defaultSelected=!0)}else{for(n=""+li(n),e=null,s=0;s<t.length;s++){if(t[s].value===n){t[s].selected=!0,r&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function em(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(G(91));return yt({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function O_(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(G(92));if(Rl(n)){if(1<n.length)throw Error(G(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:li(n)}}function Gx(t,e){var n=li(e.value),r=li(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function V_(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function Kx(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function tm(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?Kx(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Eu,Qx=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,s){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Eu=Eu||document.createElement("div"),Eu.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Eu.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function ac(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var $l={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},GR=["Webkit","ms","Moz","O"];Object.keys($l).forEach(function(t){GR.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),$l[e]=$l[t]})});function Yx(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||$l.hasOwnProperty(t)&&$l[t]?(""+e).trim():e+"px"}function Xx(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=Yx(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,s):t[n]=s}}var KR=yt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function nm(t,e){if(e){if(KR[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(G(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(G(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(G(61))}if(e.style!=null&&typeof e.style!="object")throw Error(G(62))}}function rm(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var sm=null;function kg(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var im=null,la=null,ca=null;function L_(t){if(t=$c(t)){if(typeof im!="function")throw Error(G(280));var e=t.stateNode;e&&(e=kh(e),im(t.stateNode,t.type,e))}}function Jx(t){la?ca?ca.push(t):ca=[t]:la=t}function Zx(){if(la){var t=la,e=ca;if(ca=la=null,L_(t),e)for(t=0;t<e.length;t++)L_(e[t])}}function eT(t,e){return t(e)}function tT(){}var Gf=!1;function nT(t,e,n){if(Gf)return t(e,n);Gf=!0;try{return eT(t,e,n)}finally{Gf=!1,(la!==null||ca!==null)&&(tT(),Zx())}}function lc(t,e){var n=t.stateNode;if(n===null)return null;var r=kh(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(G(231,e,typeof n));return n}var om=!1;if(cs)try{var fl={};Object.defineProperty(fl,"passive",{get:function(){om=!0}}),window.addEventListener("test",fl,fl),window.removeEventListener("test",fl,fl)}catch{om=!1}function QR(t,e,n,r,s,i,o,a,l){var d=Array.prototype.slice.call(arguments,3);try{e.apply(n,d)}catch(h){this.onError(h)}}var Bl=!1,Sd=null,bd=!1,am=null,YR={onError:function(t){Bl=!0,Sd=t}};function XR(t,e,n,r,s,i,o,a,l){Bl=!1,Sd=null,QR.apply(YR,arguments)}function JR(t,e,n,r,s,i,o,a,l){if(XR.apply(this,arguments),Bl){if(Bl){var d=Sd;Bl=!1,Sd=null}else throw Error(G(198));bd||(bd=!0,am=d)}}function wo(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function rT(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function M_(t){if(wo(t)!==t)throw Error(G(188))}function ZR(t){var e=t.alternate;if(!e){if(e=wo(t),e===null)throw Error(G(188));return e!==t?null:t}for(var n=t,r=e;;){var s=n.return;if(s===null)break;var i=s.alternate;if(i===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===n)return M_(s),t;if(i===r)return M_(s),e;i=i.sibling}throw Error(G(188))}if(n.return!==r.return)n=s,r=i;else{for(var o=!1,a=s.child;a;){if(a===n){o=!0,n=s,r=i;break}if(a===r){o=!0,r=s,n=i;break}a=a.sibling}if(!o){for(a=i.child;a;){if(a===n){o=!0,n=i,r=s;break}if(a===r){o=!0,r=i,n=s;break}a=a.sibling}if(!o)throw Error(G(189))}}if(n.alternate!==r)throw Error(G(190))}if(n.tag!==3)throw Error(G(188));return n.stateNode.current===n?t:e}function sT(t){return t=ZR(t),t!==null?iT(t):null}function iT(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=iT(t);if(e!==null)return e;t=t.sibling}return null}var oT=qn.unstable_scheduleCallback,F_=qn.unstable_cancelCallback,e1=qn.unstable_shouldYield,t1=qn.unstable_requestPaint,Tt=qn.unstable_now,n1=qn.unstable_getCurrentPriorityLevel,Dg=qn.unstable_ImmediatePriority,aT=qn.unstable_UserBlockingPriority,Cd=qn.unstable_NormalPriority,r1=qn.unstable_LowPriority,lT=qn.unstable_IdlePriority,Ah=null,zr=null;function s1(t){if(zr&&typeof zr.onCommitFiberRoot=="function")try{zr.onCommitFiberRoot(Ah,t,void 0,(t.current.flags&128)===128)}catch{}}var _r=Math.clz32?Math.clz32:a1,i1=Math.log,o1=Math.LN2;function a1(t){return t>>>=0,t===0?32:31-(i1(t)/o1|0)|0}var Iu=64,xu=4194304;function Pl(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Ad(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,s=t.suspendedLanes,i=t.pingedLanes,o=n&268435455;if(o!==0){var a=o&~s;a!==0?r=Pl(a):(i&=o,i!==0&&(r=Pl(i)))}else o=n&~s,o!==0?r=Pl(o):i!==0&&(r=Pl(i));if(r===0)return 0;if(e!==0&&e!==r&&!(e&s)&&(s=r&-r,i=e&-e,s>=i||s===16&&(i&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-_r(e),s=1<<n,r|=t[n],e&=~s;return r}function l1(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function c1(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,s=t.expirationTimes,i=t.pendingLanes;0<i;){var o=31-_r(i),a=1<<o,l=s[o];l===-1?(!(a&n)||a&r)&&(s[o]=l1(a,e)):l<=e&&(t.expiredLanes|=a),i&=~a}}function lm(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function cT(){var t=Iu;return Iu<<=1,!(Iu&4194240)&&(Iu=64),t}function Kf(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Fc(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-_r(e),t[e]=n}function u1(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var s=31-_r(n),i=1<<s;e[s]=0,r[s]=-1,t[s]=-1,n&=~i}}function jg(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-_r(n),s=1<<r;s&e|t[r]&e&&(t[r]|=e),n&=~s}}var et=0;function uT(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var dT,Og,hT,fT,pT,cm=!1,Tu=[],Ks=null,Qs=null,Ys=null,cc=new Map,uc=new Map,Vs=[],d1="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function U_(t,e){switch(t){case"focusin":case"focusout":Ks=null;break;case"dragenter":case"dragleave":Qs=null;break;case"mouseover":case"mouseout":Ys=null;break;case"pointerover":case"pointerout":cc.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":uc.delete(e.pointerId)}}function pl(t,e,n,r,s,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[s]},e!==null&&(e=$c(e),e!==null&&Og(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function h1(t,e,n,r,s){switch(e){case"focusin":return Ks=pl(Ks,t,e,n,r,s),!0;case"dragenter":return Qs=pl(Qs,t,e,n,r,s),!0;case"mouseover":return Ys=pl(Ys,t,e,n,r,s),!0;case"pointerover":var i=s.pointerId;return cc.set(i,pl(cc.get(i)||null,t,e,n,r,s)),!0;case"gotpointercapture":return i=s.pointerId,uc.set(i,pl(uc.get(i)||null,t,e,n,r,s)),!0}return!1}function mT(t){var e=Ui(t.target);if(e!==null){var n=wo(e);if(n!==null){if(e=n.tag,e===13){if(e=rT(n),e!==null){t.blockedOn=e,pT(t.priority,function(){hT(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Yu(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=um(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);sm=r,n.target.dispatchEvent(r),sm=null}else return e=$c(n),e!==null&&Og(e),t.blockedOn=n,!1;e.shift()}return!0}function $_(t,e,n){Yu(t)&&n.delete(e)}function f1(){cm=!1,Ks!==null&&Yu(Ks)&&(Ks=null),Qs!==null&&Yu(Qs)&&(Qs=null),Ys!==null&&Yu(Ys)&&(Ys=null),cc.forEach($_),uc.forEach($_)}function ml(t,e){t.blockedOn===e&&(t.blockedOn=null,cm||(cm=!0,qn.unstable_scheduleCallback(qn.unstable_NormalPriority,f1)))}function dc(t){function e(s){return ml(s,t)}if(0<Tu.length){ml(Tu[0],t);for(var n=1;n<Tu.length;n++){var r=Tu[n];r.blockedOn===t&&(r.blockedOn=null)}}for(Ks!==null&&ml(Ks,t),Qs!==null&&ml(Qs,t),Ys!==null&&ml(Ys,t),cc.forEach(e),uc.forEach(e),n=0;n<Vs.length;n++)r=Vs[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<Vs.length&&(n=Vs[0],n.blockedOn===null);)mT(n),n.blockedOn===null&&Vs.shift()}var ua=_s.ReactCurrentBatchConfig,Rd=!0;function p1(t,e,n,r){var s=et,i=ua.transition;ua.transition=null;try{et=1,Vg(t,e,n,r)}finally{et=s,ua.transition=i}}function m1(t,e,n,r){var s=et,i=ua.transition;ua.transition=null;try{et=4,Vg(t,e,n,r)}finally{et=s,ua.transition=i}}function Vg(t,e,n,r){if(Rd){var s=um(t,e,n,r);if(s===null)sp(t,e,r,Pd,n),U_(t,r);else if(h1(s,t,e,n,r))r.stopPropagation();else if(U_(t,r),e&4&&-1<d1.indexOf(t)){for(;s!==null;){var i=$c(s);if(i!==null&&dT(i),i=um(t,e,n,r),i===null&&sp(t,e,r,Pd,n),i===s)break;s=i}s!==null&&r.stopPropagation()}else sp(t,e,r,null,n)}}var Pd=null;function um(t,e,n,r){if(Pd=null,t=kg(r),t=Ui(t),t!==null)if(e=wo(t),e===null)t=null;else if(n=e.tag,n===13){if(t=rT(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Pd=t,null}function gT(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(n1()){case Dg:return 1;case aT:return 4;case Cd:case r1:return 16;case lT:return 536870912;default:return 16}default:return 16}}var Hs=null,Lg=null,Xu=null;function yT(){if(Xu)return Xu;var t,e=Lg,n=e.length,r,s="value"in Hs?Hs.value:Hs.textContent,i=s.length;for(t=0;t<n&&e[t]===s[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===s[i-r];r++);return Xu=s.slice(t,1<r?1-r:void 0)}function Ju(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Su(){return!0}function B_(){return!1}function Gn(t){function e(n,r,s,i,o){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(n=t[a],this[a]=n?n(i):i[a]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?Su:B_,this.isPropagationStopped=B_,this}return yt(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Su)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Su)},persist:function(){},isPersistent:Su}),e}var za={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Mg=Gn(za),Uc=yt({},za,{view:0,detail:0}),g1=Gn(Uc),Qf,Yf,gl,Rh=yt({},Uc,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Fg,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==gl&&(gl&&t.type==="mousemove"?(Qf=t.screenX-gl.screenX,Yf=t.screenY-gl.screenY):Yf=Qf=0,gl=t),Qf)},movementY:function(t){return"movementY"in t?t.movementY:Yf}}),z_=Gn(Rh),y1=yt({},Rh,{dataTransfer:0}),v1=Gn(y1),_1=yt({},Uc,{relatedTarget:0}),Xf=Gn(_1),w1=yt({},za,{animationName:0,elapsedTime:0,pseudoElement:0}),E1=Gn(w1),I1=yt({},za,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),x1=Gn(I1),T1=yt({},za,{data:0}),q_=Gn(T1),S1={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},b1={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},C1={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function A1(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=C1[t])?!!e[t]:!1}function Fg(){return A1}var R1=yt({},Uc,{key:function(t){if(t.key){var e=S1[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Ju(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?b1[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Fg,charCode:function(t){return t.type==="keypress"?Ju(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Ju(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),P1=Gn(R1),N1=yt({},Rh,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),H_=Gn(N1),k1=yt({},Uc,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Fg}),D1=Gn(k1),j1=yt({},za,{propertyName:0,elapsedTime:0,pseudoElement:0}),O1=Gn(j1),V1=yt({},Rh,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),L1=Gn(V1),M1=[9,13,27,32],Ug=cs&&"CompositionEvent"in window,zl=null;cs&&"documentMode"in document&&(zl=document.documentMode);var F1=cs&&"TextEvent"in window&&!zl,vT=cs&&(!Ug||zl&&8<zl&&11>=zl),W_=" ",G_=!1;function _T(t,e){switch(t){case"keyup":return M1.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function wT(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Qo=!1;function U1(t,e){switch(t){case"compositionend":return wT(e);case"keypress":return e.which!==32?null:(G_=!0,W_);case"textInput":return t=e.data,t===W_&&G_?null:t;default:return null}}function $1(t,e){if(Qo)return t==="compositionend"||!Ug&&_T(t,e)?(t=yT(),Xu=Lg=Hs=null,Qo=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return vT&&e.locale!=="ko"?null:e.data;default:return null}}var B1={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function K_(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!B1[t.type]:e==="textarea"}function ET(t,e,n,r){Jx(r),e=Nd(e,"onChange"),0<e.length&&(n=new Mg("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var ql=null,hc=null;function z1(t){kT(t,0)}function Ph(t){var e=Jo(t);if(Hx(e))return t}function q1(t,e){if(t==="change")return e}var IT=!1;if(cs){var Jf;if(cs){var Zf="oninput"in document;if(!Zf){var Q_=document.createElement("div");Q_.setAttribute("oninput","return;"),Zf=typeof Q_.oninput=="function"}Jf=Zf}else Jf=!1;IT=Jf&&(!document.documentMode||9<document.documentMode)}function Y_(){ql&&(ql.detachEvent("onpropertychange",xT),hc=ql=null)}function xT(t){if(t.propertyName==="value"&&Ph(hc)){var e=[];ET(e,hc,t,kg(t)),nT(z1,e)}}function H1(t,e,n){t==="focusin"?(Y_(),ql=e,hc=n,ql.attachEvent("onpropertychange",xT)):t==="focusout"&&Y_()}function W1(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Ph(hc)}function G1(t,e){if(t==="click")return Ph(e)}function K1(t,e){if(t==="input"||t==="change")return Ph(e)}function Q1(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Ir=typeof Object.is=="function"?Object.is:Q1;function fc(t,e){if(Ir(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!Wp.call(e,s)||!Ir(t[s],e[s]))return!1}return!0}function X_(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function J_(t,e){var n=X_(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=X_(n)}}function TT(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?TT(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function ST(){for(var t=window,e=Td();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=Td(t.document)}return e}function $g(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function Y1(t){var e=ST(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&TT(n.ownerDocument.documentElement,n)){if(r!==null&&$g(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=n.textContent.length,i=Math.min(r.start,s);r=r.end===void 0?i:Math.min(r.end,s),!t.extend&&i>r&&(s=r,r=i,i=s),s=J_(n,i);var o=J_(n,r);s&&o&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),i>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var X1=cs&&"documentMode"in document&&11>=document.documentMode,Yo=null,dm=null,Hl=null,hm=!1;function Z_(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;hm||Yo==null||Yo!==Td(r)||(r=Yo,"selectionStart"in r&&$g(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Hl&&fc(Hl,r)||(Hl=r,r=Nd(dm,"onSelect"),0<r.length&&(e=new Mg("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=Yo)))}function bu(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Xo={animationend:bu("Animation","AnimationEnd"),animationiteration:bu("Animation","AnimationIteration"),animationstart:bu("Animation","AnimationStart"),transitionend:bu("Transition","TransitionEnd")},ep={},bT={};cs&&(bT=document.createElement("div").style,"AnimationEvent"in window||(delete Xo.animationend.animation,delete Xo.animationiteration.animation,delete Xo.animationstart.animation),"TransitionEvent"in window||delete Xo.transitionend.transition);function Nh(t){if(ep[t])return ep[t];if(!Xo[t])return t;var e=Xo[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in bT)return ep[t]=e[n];return t}var CT=Nh("animationend"),AT=Nh("animationiteration"),RT=Nh("animationstart"),PT=Nh("transitionend"),NT=new Map,ew="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function mi(t,e){NT.set(t,e),_o(e,[t])}for(var tp=0;tp<ew.length;tp++){var np=ew[tp],J1=np.toLowerCase(),Z1=np[0].toUpperCase()+np.slice(1);mi(J1,"on"+Z1)}mi(CT,"onAnimationEnd");mi(AT,"onAnimationIteration");mi(RT,"onAnimationStart");mi("dblclick","onDoubleClick");mi("focusin","onFocus");mi("focusout","onBlur");mi(PT,"onTransitionEnd");Ea("onMouseEnter",["mouseout","mouseover"]);Ea("onMouseLeave",["mouseout","mouseover"]);Ea("onPointerEnter",["pointerout","pointerover"]);Ea("onPointerLeave",["pointerout","pointerover"]);_o("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));_o("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));_o("onBeforeInput",["compositionend","keypress","textInput","paste"]);_o("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));_o("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));_o("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Nl="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),eP=new Set("cancel close invalid load scroll toggle".split(" ").concat(Nl));function tw(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,JR(r,e,void 0,t),t.currentTarget=null}function kT(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],s=r.event;r=r.listeners;e:{var i=void 0;if(e)for(var o=r.length-1;0<=o;o--){var a=r[o],l=a.instance,d=a.currentTarget;if(a=a.listener,l!==i&&s.isPropagationStopped())break e;tw(s,a,d),i=l}else for(o=0;o<r.length;o++){if(a=r[o],l=a.instance,d=a.currentTarget,a=a.listener,l!==i&&s.isPropagationStopped())break e;tw(s,a,d),i=l}}}if(bd)throw t=am,bd=!1,am=null,t}function lt(t,e){var n=e[ym];n===void 0&&(n=e[ym]=new Set);var r=t+"__bubble";n.has(r)||(DT(e,t,2,!1),n.add(r))}function rp(t,e,n){var r=0;e&&(r|=4),DT(n,t,r,e)}var Cu="_reactListening"+Math.random().toString(36).slice(2);function pc(t){if(!t[Cu]){t[Cu]=!0,Ux.forEach(function(n){n!=="selectionchange"&&(eP.has(n)||rp(n,!1,t),rp(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Cu]||(e[Cu]=!0,rp("selectionchange",!1,e))}}function DT(t,e,n,r){switch(gT(e)){case 1:var s=p1;break;case 4:s=m1;break;default:s=Vg}n=s.bind(null,e,n,t),s=void 0,!om||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),r?s!==void 0?t.addEventListener(e,n,{capture:!0,passive:s}):t.addEventListener(e,n,!0):s!==void 0?t.addEventListener(e,n,{passive:s}):t.addEventListener(e,n,!1)}function sp(t,e,n,r,s){var i=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var a=r.stateNode.containerInfo;if(a===s||a.nodeType===8&&a.parentNode===s)break;if(o===4)for(o=r.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===s||l.nodeType===8&&l.parentNode===s))return;o=o.return}for(;a!==null;){if(o=Ui(a),o===null)return;if(l=o.tag,l===5||l===6){r=i=o;continue e}a=a.parentNode}}r=r.return}nT(function(){var d=i,h=kg(n),f=[];e:{var m=NT.get(t);if(m!==void 0){var v=Mg,R=t;switch(t){case"keypress":if(Ju(n)===0)break e;case"keydown":case"keyup":v=P1;break;case"focusin":R="focus",v=Xf;break;case"focusout":R="blur",v=Xf;break;case"beforeblur":case"afterblur":v=Xf;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":v=z_;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":v=v1;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":v=D1;break;case CT:case AT:case RT:v=E1;break;case PT:v=O1;break;case"scroll":v=g1;break;case"wheel":v=L1;break;case"copy":case"cut":case"paste":v=x1;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":v=H_}var T=(e&4)!==0,P=!T&&t==="scroll",E=T?m!==null?m+"Capture":null:m;T=[];for(var I=d,S;I!==null;){S=I;var b=S.stateNode;if(S.tag===5&&b!==null&&(S=b,E!==null&&(b=lc(I,E),b!=null&&T.push(mc(I,b,S)))),P)break;I=I.return}0<T.length&&(m=new v(m,R,null,n,h),f.push({event:m,listeners:T}))}}if(!(e&7)){e:{if(m=t==="mouseover"||t==="pointerover",v=t==="mouseout"||t==="pointerout",m&&n!==sm&&(R=n.relatedTarget||n.fromElement)&&(Ui(R)||R[us]))break e;if((v||m)&&(m=h.window===h?h:(m=h.ownerDocument)?m.defaultView||m.parentWindow:window,v?(R=n.relatedTarget||n.toElement,v=d,R=R?Ui(R):null,R!==null&&(P=wo(R),R!==P||R.tag!==5&&R.tag!==6)&&(R=null)):(v=null,R=d),v!==R)){if(T=z_,b="onMouseLeave",E="onMouseEnter",I="mouse",(t==="pointerout"||t==="pointerover")&&(T=H_,b="onPointerLeave",E="onPointerEnter",I="pointer"),P=v==null?m:Jo(v),S=R==null?m:Jo(R),m=new T(b,I+"leave",v,n,h),m.target=P,m.relatedTarget=S,b=null,Ui(h)===d&&(T=new T(E,I+"enter",R,n,h),T.target=S,T.relatedTarget=P,b=T),P=b,v&&R)t:{for(T=v,E=R,I=0,S=T;S;S=Ro(S))I++;for(S=0,b=E;b;b=Ro(b))S++;for(;0<I-S;)T=Ro(T),I--;for(;0<S-I;)E=Ro(E),S--;for(;I--;){if(T===E||E!==null&&T===E.alternate)break t;T=Ro(T),E=Ro(E)}T=null}else T=null;v!==null&&nw(f,m,v,T,!1),R!==null&&P!==null&&nw(f,P,R,T,!0)}}e:{if(m=d?Jo(d):window,v=m.nodeName&&m.nodeName.toLowerCase(),v==="select"||v==="input"&&m.type==="file")var L=q1;else if(K_(m))if(IT)L=K1;else{L=W1;var B=H1}else(v=m.nodeName)&&v.toLowerCase()==="input"&&(m.type==="checkbox"||m.type==="radio")&&(L=G1);if(L&&(L=L(t,d))){ET(f,L,n,h);break e}B&&B(t,m,d),t==="focusout"&&(B=m._wrapperState)&&B.controlled&&m.type==="number"&&Zp(m,"number",m.value)}switch(B=d?Jo(d):window,t){case"focusin":(K_(B)||B.contentEditable==="true")&&(Yo=B,dm=d,Hl=null);break;case"focusout":Hl=dm=Yo=null;break;case"mousedown":hm=!0;break;case"contextmenu":case"mouseup":case"dragend":hm=!1,Z_(f,n,h);break;case"selectionchange":if(X1)break;case"keydown":case"keyup":Z_(f,n,h)}var w;if(Ug)e:{switch(t){case"compositionstart":var _="onCompositionStart";break e;case"compositionend":_="onCompositionEnd";break e;case"compositionupdate":_="onCompositionUpdate";break e}_=void 0}else Qo?_T(t,n)&&(_="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(_="onCompositionStart");_&&(vT&&n.locale!=="ko"&&(Qo||_!=="onCompositionStart"?_==="onCompositionEnd"&&Qo&&(w=yT()):(Hs=h,Lg="value"in Hs?Hs.value:Hs.textContent,Qo=!0)),B=Nd(d,_),0<B.length&&(_=new q_(_,t,null,n,h),f.push({event:_,listeners:B}),w?_.data=w:(w=wT(n),w!==null&&(_.data=w)))),(w=F1?U1(t,n):$1(t,n))&&(d=Nd(d,"onBeforeInput"),0<d.length&&(h=new q_("onBeforeInput","beforeinput",null,n,h),f.push({event:h,listeners:d}),h.data=w))}kT(f,e)})}function mc(t,e,n){return{instance:t,listener:e,currentTarget:n}}function Nd(t,e){for(var n=e+"Capture",r=[];t!==null;){var s=t,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=lc(t,n),i!=null&&r.unshift(mc(t,i,s)),i=lc(t,e),i!=null&&r.push(mc(t,i,s))),t=t.return}return r}function Ro(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function nw(t,e,n,r,s){for(var i=e._reactName,o=[];n!==null&&n!==r;){var a=n,l=a.alternate,d=a.stateNode;if(l!==null&&l===r)break;a.tag===5&&d!==null&&(a=d,s?(l=lc(n,i),l!=null&&o.unshift(mc(n,l,a))):s||(l=lc(n,i),l!=null&&o.push(mc(n,l,a)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var tP=/\r\n?/g,nP=/\u0000|\uFFFD/g;function rw(t){return(typeof t=="string"?t:""+t).replace(tP,`
`).replace(nP,"")}function Au(t,e,n){if(e=rw(e),rw(t)!==e&&n)throw Error(G(425))}function kd(){}var fm=null,pm=null;function mm(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var gm=typeof setTimeout=="function"?setTimeout:void 0,rP=typeof clearTimeout=="function"?clearTimeout:void 0,sw=typeof Promise=="function"?Promise:void 0,sP=typeof queueMicrotask=="function"?queueMicrotask:typeof sw<"u"?function(t){return sw.resolve(null).then(t).catch(iP)}:gm;function iP(t){setTimeout(function(){throw t})}function ip(t,e){var n=e,r=0;do{var s=n.nextSibling;if(t.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){t.removeChild(s),dc(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);dc(e)}function Xs(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function iw(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var qa=Math.random().toString(36).slice(2),Fr="__reactFiber$"+qa,gc="__reactProps$"+qa,us="__reactContainer$"+qa,ym="__reactEvents$"+qa,oP="__reactListeners$"+qa,aP="__reactHandles$"+qa;function Ui(t){var e=t[Fr];if(e)return e;for(var n=t.parentNode;n;){if(e=n[us]||n[Fr]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=iw(t);t!==null;){if(n=t[Fr])return n;t=iw(t)}return e}t=n,n=t.parentNode}return null}function $c(t){return t=t[Fr]||t[us],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Jo(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(G(33))}function kh(t){return t[gc]||null}var vm=[],Zo=-1;function gi(t){return{current:t}}function ct(t){0>Zo||(t.current=vm[Zo],vm[Zo]=null,Zo--)}function ot(t,e){Zo++,vm[Zo]=t.current,t.current=e}var ci={},un=gi(ci),Pn=gi(!1),Zi=ci;function Ia(t,e){var n=t.type.contextTypes;if(!n)return ci;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in n)s[i]=e[i];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function Nn(t){return t=t.childContextTypes,t!=null}function Dd(){ct(Pn),ct(un)}function ow(t,e,n){if(un.current!==ci)throw Error(G(168));ot(un,e),ot(Pn,n)}function jT(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in e))throw Error(G(108,HR(t)||"Unknown",s));return yt({},n,r)}function jd(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||ci,Zi=un.current,ot(un,t),ot(Pn,Pn.current),!0}function aw(t,e,n){var r=t.stateNode;if(!r)throw Error(G(169));n?(t=jT(t,e,Zi),r.__reactInternalMemoizedMergedChildContext=t,ct(Pn),ct(un),ot(un,t)):ct(Pn),ot(Pn,n)}var ts=null,Dh=!1,op=!1;function OT(t){ts===null?ts=[t]:ts.push(t)}function lP(t){Dh=!0,OT(t)}function yi(){if(!op&&ts!==null){op=!0;var t=0,e=et;try{var n=ts;for(et=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}ts=null,Dh=!1}catch(s){throw ts!==null&&(ts=ts.slice(t+1)),oT(Dg,yi),s}finally{et=e,op=!1}}return null}var ea=[],ta=0,Od=null,Vd=0,Jn=[],Zn=0,eo=null,ns=1,rs="";function Pi(t,e){ea[ta++]=Vd,ea[ta++]=Od,Od=t,Vd=e}function VT(t,e,n){Jn[Zn++]=ns,Jn[Zn++]=rs,Jn[Zn++]=eo,eo=t;var r=ns;t=rs;var s=32-_r(r)-1;r&=~(1<<s),n+=1;var i=32-_r(e)+s;if(30<i){var o=s-s%5;i=(r&(1<<o)-1).toString(32),r>>=o,s-=o,ns=1<<32-_r(e)+s|n<<s|r,rs=i+t}else ns=1<<i|n<<s|r,rs=t}function Bg(t){t.return!==null&&(Pi(t,1),VT(t,1,0))}function zg(t){for(;t===Od;)Od=ea[--ta],ea[ta]=null,Vd=ea[--ta],ea[ta]=null;for(;t===eo;)eo=Jn[--Zn],Jn[Zn]=null,rs=Jn[--Zn],Jn[Zn]=null,ns=Jn[--Zn],Jn[Zn]=null}var Bn=null,Un=null,dt=!1,yr=null;function LT(t,e){var n=nr(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function lw(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Bn=t,Un=Xs(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Bn=t,Un=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=eo!==null?{id:ns,overflow:rs}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=nr(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,Bn=t,Un=null,!0):!1;default:return!1}}function _m(t){return(t.mode&1)!==0&&(t.flags&128)===0}function wm(t){if(dt){var e=Un;if(e){var n=e;if(!lw(t,e)){if(_m(t))throw Error(G(418));e=Xs(n.nextSibling);var r=Bn;e&&lw(t,e)?LT(r,n):(t.flags=t.flags&-4097|2,dt=!1,Bn=t)}}else{if(_m(t))throw Error(G(418));t.flags=t.flags&-4097|2,dt=!1,Bn=t}}}function cw(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Bn=t}function Ru(t){if(t!==Bn)return!1;if(!dt)return cw(t),dt=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!mm(t.type,t.memoizedProps)),e&&(e=Un)){if(_m(t))throw MT(),Error(G(418));for(;e;)LT(t,e),e=Xs(e.nextSibling)}if(cw(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(G(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){Un=Xs(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}Un=null}}else Un=Bn?Xs(t.stateNode.nextSibling):null;return!0}function MT(){for(var t=Un;t;)t=Xs(t.nextSibling)}function xa(){Un=Bn=null,dt=!1}function qg(t){yr===null?yr=[t]:yr.push(t)}var cP=_s.ReactCurrentBatchConfig;function yl(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(G(309));var r=n.stateNode}if(!r)throw Error(G(147,t));var s=r,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(o){var a=s.refs;o===null?delete a[i]:a[i]=o},e._stringRef=i,e)}if(typeof t!="string")throw Error(G(284));if(!n._owner)throw Error(G(290,t))}return t}function Pu(t,e){throw t=Object.prototype.toString.call(e),Error(G(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function uw(t){var e=t._init;return e(t._payload)}function FT(t){function e(E,I){if(t){var S=E.deletions;S===null?(E.deletions=[I],E.flags|=16):S.push(I)}}function n(E,I){if(!t)return null;for(;I!==null;)e(E,I),I=I.sibling;return null}function r(E,I){for(E=new Map;I!==null;)I.key!==null?E.set(I.key,I):E.set(I.index,I),I=I.sibling;return E}function s(E,I){return E=ti(E,I),E.index=0,E.sibling=null,E}function i(E,I,S){return E.index=S,t?(S=E.alternate,S!==null?(S=S.index,S<I?(E.flags|=2,I):S):(E.flags|=2,I)):(E.flags|=1048576,I)}function o(E){return t&&E.alternate===null&&(E.flags|=2),E}function a(E,I,S,b){return I===null||I.tag!==6?(I=fp(S,E.mode,b),I.return=E,I):(I=s(I,S),I.return=E,I)}function l(E,I,S,b){var L=S.type;return L===Ko?h(E,I,S.props.children,b,S.key):I!==null&&(I.elementType===L||typeof L=="object"&&L!==null&&L.$$typeof===js&&uw(L)===I.type)?(b=s(I,S.props),b.ref=yl(E,I,S),b.return=E,b):(b=id(S.type,S.key,S.props,null,E.mode,b),b.ref=yl(E,I,S),b.return=E,b)}function d(E,I,S,b){return I===null||I.tag!==4||I.stateNode.containerInfo!==S.containerInfo||I.stateNode.implementation!==S.implementation?(I=pp(S,E.mode,b),I.return=E,I):(I=s(I,S.children||[]),I.return=E,I)}function h(E,I,S,b,L){return I===null||I.tag!==7?(I=Wi(S,E.mode,b,L),I.return=E,I):(I=s(I,S),I.return=E,I)}function f(E,I,S){if(typeof I=="string"&&I!==""||typeof I=="number")return I=fp(""+I,E.mode,S),I.return=E,I;if(typeof I=="object"&&I!==null){switch(I.$$typeof){case _u:return S=id(I.type,I.key,I.props,null,E.mode,S),S.ref=yl(E,null,I),S.return=E,S;case Go:return I=pp(I,E.mode,S),I.return=E,I;case js:var b=I._init;return f(E,b(I._payload),S)}if(Rl(I)||hl(I))return I=Wi(I,E.mode,S,null),I.return=E,I;Pu(E,I)}return null}function m(E,I,S,b){var L=I!==null?I.key:null;if(typeof S=="string"&&S!==""||typeof S=="number")return L!==null?null:a(E,I,""+S,b);if(typeof S=="object"&&S!==null){switch(S.$$typeof){case _u:return S.key===L?l(E,I,S,b):null;case Go:return S.key===L?d(E,I,S,b):null;case js:return L=S._init,m(E,I,L(S._payload),b)}if(Rl(S)||hl(S))return L!==null?null:h(E,I,S,b,null);Pu(E,S)}return null}function v(E,I,S,b,L){if(typeof b=="string"&&b!==""||typeof b=="number")return E=E.get(S)||null,a(I,E,""+b,L);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case _u:return E=E.get(b.key===null?S:b.key)||null,l(I,E,b,L);case Go:return E=E.get(b.key===null?S:b.key)||null,d(I,E,b,L);case js:var B=b._init;return v(E,I,S,B(b._payload),L)}if(Rl(b)||hl(b))return E=E.get(S)||null,h(I,E,b,L,null);Pu(I,b)}return null}function R(E,I,S,b){for(var L=null,B=null,w=I,_=I=0,y=null;w!==null&&_<S.length;_++){w.index>_?(y=w,w=null):y=w.sibling;var N=m(E,w,S[_],b);if(N===null){w===null&&(w=y);break}t&&w&&N.alternate===null&&e(E,w),I=i(N,I,_),B===null?L=N:B.sibling=N,B=N,w=y}if(_===S.length)return n(E,w),dt&&Pi(E,_),L;if(w===null){for(;_<S.length;_++)w=f(E,S[_],b),w!==null&&(I=i(w,I,_),B===null?L=w:B.sibling=w,B=w);return dt&&Pi(E,_),L}for(w=r(E,w);_<S.length;_++)y=v(w,E,_,S[_],b),y!==null&&(t&&y.alternate!==null&&w.delete(y.key===null?_:y.key),I=i(y,I,_),B===null?L=y:B.sibling=y,B=y);return t&&w.forEach(function(D){return e(E,D)}),dt&&Pi(E,_),L}function T(E,I,S,b){var L=hl(S);if(typeof L!="function")throw Error(G(150));if(S=L.call(S),S==null)throw Error(G(151));for(var B=L=null,w=I,_=I=0,y=null,N=S.next();w!==null&&!N.done;_++,N=S.next()){w.index>_?(y=w,w=null):y=w.sibling;var D=m(E,w,N.value,b);if(D===null){w===null&&(w=y);break}t&&w&&D.alternate===null&&e(E,w),I=i(D,I,_),B===null?L=D:B.sibling=D,B=D,w=y}if(N.done)return n(E,w),dt&&Pi(E,_),L;if(w===null){for(;!N.done;_++,N=S.next())N=f(E,N.value,b),N!==null&&(I=i(N,I,_),B===null?L=N:B.sibling=N,B=N);return dt&&Pi(E,_),L}for(w=r(E,w);!N.done;_++,N=S.next())N=v(w,E,_,N.value,b),N!==null&&(t&&N.alternate!==null&&w.delete(N.key===null?_:N.key),I=i(N,I,_),B===null?L=N:B.sibling=N,B=N);return t&&w.forEach(function(j){return e(E,j)}),dt&&Pi(E,_),L}function P(E,I,S,b){if(typeof S=="object"&&S!==null&&S.type===Ko&&S.key===null&&(S=S.props.children),typeof S=="object"&&S!==null){switch(S.$$typeof){case _u:e:{for(var L=S.key,B=I;B!==null;){if(B.key===L){if(L=S.type,L===Ko){if(B.tag===7){n(E,B.sibling),I=s(B,S.props.children),I.return=E,E=I;break e}}else if(B.elementType===L||typeof L=="object"&&L!==null&&L.$$typeof===js&&uw(L)===B.type){n(E,B.sibling),I=s(B,S.props),I.ref=yl(E,B,S),I.return=E,E=I;break e}n(E,B);break}else e(E,B);B=B.sibling}S.type===Ko?(I=Wi(S.props.children,E.mode,b,S.key),I.return=E,E=I):(b=id(S.type,S.key,S.props,null,E.mode,b),b.ref=yl(E,I,S),b.return=E,E=b)}return o(E);case Go:e:{for(B=S.key;I!==null;){if(I.key===B)if(I.tag===4&&I.stateNode.containerInfo===S.containerInfo&&I.stateNode.implementation===S.implementation){n(E,I.sibling),I=s(I,S.children||[]),I.return=E,E=I;break e}else{n(E,I);break}else e(E,I);I=I.sibling}I=pp(S,E.mode,b),I.return=E,E=I}return o(E);case js:return B=S._init,P(E,I,B(S._payload),b)}if(Rl(S))return R(E,I,S,b);if(hl(S))return T(E,I,S,b);Pu(E,S)}return typeof S=="string"&&S!==""||typeof S=="number"?(S=""+S,I!==null&&I.tag===6?(n(E,I.sibling),I=s(I,S),I.return=E,E=I):(n(E,I),I=fp(S,E.mode,b),I.return=E,E=I),o(E)):n(E,I)}return P}var Ta=FT(!0),UT=FT(!1),Ld=gi(null),Md=null,na=null,Hg=null;function Wg(){Hg=na=Md=null}function Gg(t){var e=Ld.current;ct(Ld),t._currentValue=e}function Em(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function da(t,e){Md=t,Hg=na=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(An=!0),t.firstContext=null)}function or(t){var e=t._currentValue;if(Hg!==t)if(t={context:t,memoizedValue:e,next:null},na===null){if(Md===null)throw Error(G(308));na=t,Md.dependencies={lanes:0,firstContext:t}}else na=na.next=t;return e}var $i=null;function Kg(t){$i===null?$i=[t]:$i.push(t)}function $T(t,e,n,r){var s=e.interleaved;return s===null?(n.next=n,Kg(e)):(n.next=s.next,s.next=n),e.interleaved=n,ds(t,r)}function ds(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Os=!1;function Qg(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function BT(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function as(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Js(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,qe&2){var s=r.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),r.pending=e,ds(t,n)}return s=r.interleaved,s===null?(e.next=e,Kg(r)):(e.next=s.next,s.next=e),r.interleaved=e,ds(t,n)}function Zu(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,jg(t,n)}}function dw(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?s=i=o:i=i.next=o,n=n.next}while(n!==null);i===null?s=i=e:i=i.next=e}else s=i=e;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function Fd(t,e,n,r){var s=t.updateQueue;Os=!1;var i=s.firstBaseUpdate,o=s.lastBaseUpdate,a=s.shared.pending;if(a!==null){s.shared.pending=null;var l=a,d=l.next;l.next=null,o===null?i=d:o.next=d,o=l;var h=t.alternate;h!==null&&(h=h.updateQueue,a=h.lastBaseUpdate,a!==o&&(a===null?h.firstBaseUpdate=d:a.next=d,h.lastBaseUpdate=l))}if(i!==null){var f=s.baseState;o=0,h=d=l=null,a=i;do{var m=a.lane,v=a.eventTime;if((r&m)===m){h!==null&&(h=h.next={eventTime:v,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var R=t,T=a;switch(m=e,v=n,T.tag){case 1:if(R=T.payload,typeof R=="function"){f=R.call(v,f,m);break e}f=R;break e;case 3:R.flags=R.flags&-65537|128;case 0:if(R=T.payload,m=typeof R=="function"?R.call(v,f,m):R,m==null)break e;f=yt({},f,m);break e;case 2:Os=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,m=s.effects,m===null?s.effects=[a]:m.push(a))}else v={eventTime:v,lane:m,tag:a.tag,payload:a.payload,callback:a.callback,next:null},h===null?(d=h=v,l=f):h=h.next=v,o|=m;if(a=a.next,a===null){if(a=s.shared.pending,a===null)break;m=a,a=m.next,m.next=null,s.lastBaseUpdate=m,s.shared.pending=null}}while(!0);if(h===null&&(l=f),s.baseState=l,s.firstBaseUpdate=d,s.lastBaseUpdate=h,e=s.shared.interleaved,e!==null){s=e;do o|=s.lane,s=s.next;while(s!==e)}else i===null&&(s.shared.lanes=0);no|=o,t.lanes=o,t.memoizedState=f}}function hw(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(G(191,s));s.call(r)}}}var Bc={},qr=gi(Bc),yc=gi(Bc),vc=gi(Bc);function Bi(t){if(t===Bc)throw Error(G(174));return t}function Yg(t,e){switch(ot(vc,e),ot(yc,t),ot(qr,Bc),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:tm(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=tm(e,t)}ct(qr),ot(qr,e)}function Sa(){ct(qr),ct(yc),ct(vc)}function zT(t){Bi(vc.current);var e=Bi(qr.current),n=tm(e,t.type);e!==n&&(ot(yc,t),ot(qr,n))}function Xg(t){yc.current===t&&(ct(qr),ct(yc))}var pt=gi(0);function Ud(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var ap=[];function Jg(){for(var t=0;t<ap.length;t++)ap[t]._workInProgressVersionPrimary=null;ap.length=0}var ed=_s.ReactCurrentDispatcher,lp=_s.ReactCurrentBatchConfig,to=0,gt=null,Ot=null,Ht=null,$d=!1,Wl=!1,_c=0,uP=0;function en(){throw Error(G(321))}function Zg(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!Ir(t[n],e[n]))return!1;return!0}function ey(t,e,n,r,s,i){if(to=i,gt=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,ed.current=t===null||t.memoizedState===null?pP:mP,t=n(r,s),Wl){i=0;do{if(Wl=!1,_c=0,25<=i)throw Error(G(301));i+=1,Ht=Ot=null,e.updateQueue=null,ed.current=gP,t=n(r,s)}while(Wl)}if(ed.current=Bd,e=Ot!==null&&Ot.next!==null,to=0,Ht=Ot=gt=null,$d=!1,e)throw Error(G(300));return t}function ty(){var t=_c!==0;return _c=0,t}function Lr(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ht===null?gt.memoizedState=Ht=t:Ht=Ht.next=t,Ht}function ar(){if(Ot===null){var t=gt.alternate;t=t!==null?t.memoizedState:null}else t=Ot.next;var e=Ht===null?gt.memoizedState:Ht.next;if(e!==null)Ht=e,Ot=t;else{if(t===null)throw Error(G(310));Ot=t,t={memoizedState:Ot.memoizedState,baseState:Ot.baseState,baseQueue:Ot.baseQueue,queue:Ot.queue,next:null},Ht===null?gt.memoizedState=Ht=t:Ht=Ht.next=t}return Ht}function wc(t,e){return typeof e=="function"?e(t):e}function cp(t){var e=ar(),n=e.queue;if(n===null)throw Error(G(311));n.lastRenderedReducer=t;var r=Ot,s=r.baseQueue,i=n.pending;if(i!==null){if(s!==null){var o=s.next;s.next=i.next,i.next=o}r.baseQueue=s=i,n.pending=null}if(s!==null){i=s.next,r=r.baseState;var a=o=null,l=null,d=i;do{var h=d.lane;if((to&h)===h)l!==null&&(l=l.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),r=d.hasEagerState?d.eagerState:t(r,d.action);else{var f={lane:h,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};l===null?(a=l=f,o=r):l=l.next=f,gt.lanes|=h,no|=h}d=d.next}while(d!==null&&d!==i);l===null?o=r:l.next=a,Ir(r,e.memoizedState)||(An=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=l,n.lastRenderedState=r}if(t=n.interleaved,t!==null){s=t;do i=s.lane,gt.lanes|=i,no|=i,s=s.next;while(s!==t)}else s===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function up(t){var e=ar(),n=e.queue;if(n===null)throw Error(G(311));n.lastRenderedReducer=t;var r=n.dispatch,s=n.pending,i=e.memoizedState;if(s!==null){n.pending=null;var o=s=s.next;do i=t(i,o.action),o=o.next;while(o!==s);Ir(i,e.memoizedState)||(An=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),n.lastRenderedState=i}return[i,r]}function qT(){}function HT(t,e){var n=gt,r=ar(),s=e(),i=!Ir(r.memoizedState,s);if(i&&(r.memoizedState=s,An=!0),r=r.queue,ny(KT.bind(null,n,r,t),[t]),r.getSnapshot!==e||i||Ht!==null&&Ht.memoizedState.tag&1){if(n.flags|=2048,Ec(9,GT.bind(null,n,r,s,e),void 0,null),Wt===null)throw Error(G(349));to&30||WT(n,e,s)}return s}function WT(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=gt.updateQueue,e===null?(e={lastEffect:null,stores:null},gt.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function GT(t,e,n,r){e.value=n,e.getSnapshot=r,QT(e)&&YT(t)}function KT(t,e,n){return n(function(){QT(e)&&YT(t)})}function QT(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!Ir(t,n)}catch{return!0}}function YT(t){var e=ds(t,1);e!==null&&wr(e,t,1,-1)}function fw(t){var e=Lr();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:wc,lastRenderedState:t},e.queue=t,t=t.dispatch=fP.bind(null,gt,t),[e.memoizedState,t]}function Ec(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=gt.updateQueue,e===null?(e={lastEffect:null,stores:null},gt.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function XT(){return ar().memoizedState}function td(t,e,n,r){var s=Lr();gt.flags|=t,s.memoizedState=Ec(1|e,n,void 0,r===void 0?null:r)}function jh(t,e,n,r){var s=ar();r=r===void 0?null:r;var i=void 0;if(Ot!==null){var o=Ot.memoizedState;if(i=o.destroy,r!==null&&Zg(r,o.deps)){s.memoizedState=Ec(e,n,i,r);return}}gt.flags|=t,s.memoizedState=Ec(1|e,n,i,r)}function pw(t,e){return td(8390656,8,t,e)}function ny(t,e){return jh(2048,8,t,e)}function JT(t,e){return jh(4,2,t,e)}function ZT(t,e){return jh(4,4,t,e)}function e0(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function t0(t,e,n){return n=n!=null?n.concat([t]):null,jh(4,4,e0.bind(null,e,t),n)}function ry(){}function n0(t,e){var n=ar();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Zg(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function r0(t,e){var n=ar();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Zg(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function s0(t,e,n){return to&21?(Ir(n,e)||(n=cT(),gt.lanes|=n,no|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,An=!0),t.memoizedState=n)}function dP(t,e){var n=et;et=n!==0&&4>n?n:4,t(!0);var r=lp.transition;lp.transition={};try{t(!1),e()}finally{et=n,lp.transition=r}}function i0(){return ar().memoizedState}function hP(t,e,n){var r=ei(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},o0(t))a0(e,n);else if(n=$T(t,e,n,r),n!==null){var s=vn();wr(n,t,r,s),l0(n,e,r)}}function fP(t,e,n){var r=ei(t),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(o0(t))a0(e,s);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var o=e.lastRenderedState,a=i(o,n);if(s.hasEagerState=!0,s.eagerState=a,Ir(a,o)){var l=e.interleaved;l===null?(s.next=s,Kg(e)):(s.next=l.next,l.next=s),e.interleaved=s;return}}catch{}finally{}n=$T(t,e,s,r),n!==null&&(s=vn(),wr(n,t,r,s),l0(n,e,r))}}function o0(t){var e=t.alternate;return t===gt||e!==null&&e===gt}function a0(t,e){Wl=$d=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function l0(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,jg(t,n)}}var Bd={readContext:or,useCallback:en,useContext:en,useEffect:en,useImperativeHandle:en,useInsertionEffect:en,useLayoutEffect:en,useMemo:en,useReducer:en,useRef:en,useState:en,useDebugValue:en,useDeferredValue:en,useTransition:en,useMutableSource:en,useSyncExternalStore:en,useId:en,unstable_isNewReconciler:!1},pP={readContext:or,useCallback:function(t,e){return Lr().memoizedState=[t,e===void 0?null:e],t},useContext:or,useEffect:pw,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,td(4194308,4,e0.bind(null,e,t),n)},useLayoutEffect:function(t,e){return td(4194308,4,t,e)},useInsertionEffect:function(t,e){return td(4,2,t,e)},useMemo:function(t,e){var n=Lr();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=Lr();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=hP.bind(null,gt,t),[r.memoizedState,t]},useRef:function(t){var e=Lr();return t={current:t},e.memoizedState=t},useState:fw,useDebugValue:ry,useDeferredValue:function(t){return Lr().memoizedState=t},useTransition:function(){var t=fw(!1),e=t[0];return t=dP.bind(null,t[1]),Lr().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=gt,s=Lr();if(dt){if(n===void 0)throw Error(G(407));n=n()}else{if(n=e(),Wt===null)throw Error(G(349));to&30||WT(r,e,n)}s.memoizedState=n;var i={value:n,getSnapshot:e};return s.queue=i,pw(KT.bind(null,r,i,t),[t]),r.flags|=2048,Ec(9,GT.bind(null,r,i,n,e),void 0,null),n},useId:function(){var t=Lr(),e=Wt.identifierPrefix;if(dt){var n=rs,r=ns;n=(r&~(1<<32-_r(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=_c++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=uP++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},mP={readContext:or,useCallback:n0,useContext:or,useEffect:ny,useImperativeHandle:t0,useInsertionEffect:JT,useLayoutEffect:ZT,useMemo:r0,useReducer:cp,useRef:XT,useState:function(){return cp(wc)},useDebugValue:ry,useDeferredValue:function(t){var e=ar();return s0(e,Ot.memoizedState,t)},useTransition:function(){var t=cp(wc)[0],e=ar().memoizedState;return[t,e]},useMutableSource:qT,useSyncExternalStore:HT,useId:i0,unstable_isNewReconciler:!1},gP={readContext:or,useCallback:n0,useContext:or,useEffect:ny,useImperativeHandle:t0,useInsertionEffect:JT,useLayoutEffect:ZT,useMemo:r0,useReducer:up,useRef:XT,useState:function(){return up(wc)},useDebugValue:ry,useDeferredValue:function(t){var e=ar();return Ot===null?e.memoizedState=t:s0(e,Ot.memoizedState,t)},useTransition:function(){var t=up(wc)[0],e=ar().memoizedState;return[t,e]},useMutableSource:qT,useSyncExternalStore:HT,useId:i0,unstable_isNewReconciler:!1};function pr(t,e){if(t&&t.defaultProps){e=yt({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function Im(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:yt({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var Oh={isMounted:function(t){return(t=t._reactInternals)?wo(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=vn(),s=ei(t),i=as(r,s);i.payload=e,n!=null&&(i.callback=n),e=Js(t,i,s),e!==null&&(wr(e,t,s,r),Zu(e,t,s))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=vn(),s=ei(t),i=as(r,s);i.tag=1,i.payload=e,n!=null&&(i.callback=n),e=Js(t,i,s),e!==null&&(wr(e,t,s,r),Zu(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=vn(),r=ei(t),s=as(n,r);s.tag=2,e!=null&&(s.callback=e),e=Js(t,s,r),e!==null&&(wr(e,t,r,n),Zu(e,t,r))}};function mw(t,e,n,r,s,i,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,i,o):e.prototype&&e.prototype.isPureReactComponent?!fc(n,r)||!fc(s,i):!0}function c0(t,e,n){var r=!1,s=ci,i=e.contextType;return typeof i=="object"&&i!==null?i=or(i):(s=Nn(e)?Zi:un.current,r=e.contextTypes,i=(r=r!=null)?Ia(t,s):ci),e=new e(n,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Oh,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=i),e}function gw(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&Oh.enqueueReplaceState(e,e.state,null)}function xm(t,e,n,r){var s=t.stateNode;s.props=n,s.state=t.memoizedState,s.refs={},Qg(t);var i=e.contextType;typeof i=="object"&&i!==null?s.context=or(i):(i=Nn(e)?Zi:un.current,s.context=Ia(t,i)),s.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(Im(t,e,i,n),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&Oh.enqueueReplaceState(s,s.state,null),Fd(t,n,s,r),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function ba(t,e){try{var n="",r=e;do n+=qR(r),r=r.return;while(r);var s=n}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:s,digest:null}}function dp(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function Tm(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var yP=typeof WeakMap=="function"?WeakMap:Map;function u0(t,e,n){n=as(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){qd||(qd=!0,jm=r),Tm(t,e)},n}function d0(t,e,n){n=as(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var s=e.value;n.payload=function(){return r(s)},n.callback=function(){Tm(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){Tm(t,e),typeof r!="function"&&(Zs===null?Zs=new Set([this]):Zs.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function yw(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new yP;var s=new Set;r.set(e,s)}else s=r.get(e),s===void 0&&(s=new Set,r.set(e,s));s.has(n)||(s.add(n),t=NP.bind(null,t,e,n),e.then(t,t))}function vw(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function _w(t,e,n,r,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=as(-1,1),e.tag=2,Js(n,e,1))),n.lanes|=1),t)}var vP=_s.ReactCurrentOwner,An=!1;function fn(t,e,n,r){e.child=t===null?UT(e,null,n,r):Ta(e,t.child,n,r)}function ww(t,e,n,r,s){n=n.render;var i=e.ref;return da(e,s),r=ey(t,e,n,r,i,s),n=ty(),t!==null&&!An?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,hs(t,e,s)):(dt&&n&&Bg(e),e.flags|=1,fn(t,e,r,s),e.child)}function Ew(t,e,n,r,s){if(t===null){var i=n.type;return typeof i=="function"&&!dy(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=i,h0(t,e,i,r,s)):(t=id(n.type,null,r,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&s)){var o=i.memoizedProps;if(n=n.compare,n=n!==null?n:fc,n(o,r)&&t.ref===e.ref)return hs(t,e,s)}return e.flags|=1,t=ti(i,r),t.ref=e.ref,t.return=e,e.child=t}function h0(t,e,n,r,s){if(t!==null){var i=t.memoizedProps;if(fc(i,r)&&t.ref===e.ref)if(An=!1,e.pendingProps=r=i,(t.lanes&s)!==0)t.flags&131072&&(An=!0);else return e.lanes=t.lanes,hs(t,e,s)}return Sm(t,e,n,r,s)}function f0(t,e,n){var r=e.pendingProps,s=r.children,i=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},ot(sa,Ln),Ln|=n;else{if(!(n&1073741824))return t=i!==null?i.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,ot(sa,Ln),Ln|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,ot(sa,Ln),Ln|=r}else i!==null?(r=i.baseLanes|n,e.memoizedState=null):r=n,ot(sa,Ln),Ln|=r;return fn(t,e,s,n),e.child}function p0(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function Sm(t,e,n,r,s){var i=Nn(n)?Zi:un.current;return i=Ia(e,i),da(e,s),n=ey(t,e,n,r,i,s),r=ty(),t!==null&&!An?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,hs(t,e,s)):(dt&&r&&Bg(e),e.flags|=1,fn(t,e,n,s),e.child)}function Iw(t,e,n,r,s){if(Nn(n)){var i=!0;jd(e)}else i=!1;if(da(e,s),e.stateNode===null)nd(t,e),c0(e,n,r),xm(e,n,r,s),r=!0;else if(t===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var l=o.context,d=n.contextType;typeof d=="object"&&d!==null?d=or(d):(d=Nn(n)?Zi:un.current,d=Ia(e,d));var h=n.getDerivedStateFromProps,f=typeof h=="function"||typeof o.getSnapshotBeforeUpdate=="function";f||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==r||l!==d)&&gw(e,o,r,d),Os=!1;var m=e.memoizedState;o.state=m,Fd(e,r,o,s),l=e.memoizedState,a!==r||m!==l||Pn.current||Os?(typeof h=="function"&&(Im(e,n,h,r),l=e.memoizedState),(a=Os||mw(e,n,a,r,m,l,d))?(f||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=l),o.props=r,o.state=l,o.context=d,r=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,BT(t,e),a=e.memoizedProps,d=e.type===e.elementType?a:pr(e.type,a),o.props=d,f=e.pendingProps,m=o.context,l=n.contextType,typeof l=="object"&&l!==null?l=or(l):(l=Nn(n)?Zi:un.current,l=Ia(e,l));var v=n.getDerivedStateFromProps;(h=typeof v=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==f||m!==l)&&gw(e,o,r,l),Os=!1,m=e.memoizedState,o.state=m,Fd(e,r,o,s);var R=e.memoizedState;a!==f||m!==R||Pn.current||Os?(typeof v=="function"&&(Im(e,n,v,r),R=e.memoizedState),(d=Os||mw(e,n,d,r,m,R,l)||!1)?(h||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,R,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,R,l)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&m===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&m===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=R),o.props=r,o.state=R,o.context=l,r=d):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&m===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&m===t.memoizedState||(e.flags|=1024),r=!1)}return bm(t,e,n,r,i,s)}function bm(t,e,n,r,s,i){p0(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return s&&aw(e,n,!1),hs(t,e,i);r=e.stateNode,vP.current=e;var a=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=Ta(e,t.child,null,i),e.child=Ta(e,null,a,i)):fn(t,e,a,i),e.memoizedState=r.state,s&&aw(e,n,!0),e.child}function m0(t){var e=t.stateNode;e.pendingContext?ow(t,e.pendingContext,e.pendingContext!==e.context):e.context&&ow(t,e.context,!1),Yg(t,e.containerInfo)}function xw(t,e,n,r,s){return xa(),qg(s),e.flags|=256,fn(t,e,n,r),e.child}var Cm={dehydrated:null,treeContext:null,retryLane:0};function Am(t){return{baseLanes:t,cachePool:null,transitions:null}}function g0(t,e,n){var r=e.pendingProps,s=pt.current,i=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=t!==null&&t.memoizedState===null?!1:(s&2)!==0),a?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),ot(pt,s&1),t===null)return wm(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,i?(r=e.mode,i=e.child,o={mode:"hidden",children:o},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=Mh(o,r,0,null),t=Wi(t,r,n,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=Am(n),e.memoizedState=Cm,t):sy(e,o));if(s=t.memoizedState,s!==null&&(a=s.dehydrated,a!==null))return _P(t,e,o,r,a,s,n);if(i){i=r.fallback,o=e.mode,s=t.child,a=s.sibling;var l={mode:"hidden",children:r.children};return!(o&1)&&e.child!==s?(r=e.child,r.childLanes=0,r.pendingProps=l,e.deletions=null):(r=ti(s,l),r.subtreeFlags=s.subtreeFlags&14680064),a!==null?i=ti(a,i):(i=Wi(i,o,n,null),i.flags|=2),i.return=e,r.return=e,r.sibling=i,e.child=r,r=i,i=e.child,o=t.child.memoizedState,o=o===null?Am(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=t.childLanes&~n,e.memoizedState=Cm,r}return i=t.child,t=i.sibling,r=ti(i,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function sy(t,e){return e=Mh({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Nu(t,e,n,r){return r!==null&&qg(r),Ta(e,t.child,null,n),t=sy(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function _P(t,e,n,r,s,i,o){if(n)return e.flags&256?(e.flags&=-257,r=dp(Error(G(422))),Nu(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=r.fallback,s=e.mode,r=Mh({mode:"visible",children:r.children},s,0,null),i=Wi(i,s,o,null),i.flags|=2,r.return=e,i.return=e,r.sibling=i,e.child=r,e.mode&1&&Ta(e,t.child,null,o),e.child.memoizedState=Am(o),e.memoizedState=Cm,i);if(!(e.mode&1))return Nu(t,e,o,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var a=r.dgst;return r=a,i=Error(G(419)),r=dp(i,r,void 0),Nu(t,e,o,r)}if(a=(o&t.childLanes)!==0,An||a){if(r=Wt,r!==null){switch(o&-o){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|o)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,ds(t,s),wr(r,t,s,-1))}return uy(),r=dp(Error(G(421))),Nu(t,e,o,r)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=kP.bind(null,t),s._reactRetry=e,null):(t=i.treeContext,Un=Xs(s.nextSibling),Bn=e,dt=!0,yr=null,t!==null&&(Jn[Zn++]=ns,Jn[Zn++]=rs,Jn[Zn++]=eo,ns=t.id,rs=t.overflow,eo=e),e=sy(e,r.children),e.flags|=4096,e)}function Tw(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),Em(t.return,e,n)}function hp(t,e,n,r,s){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=s)}function y0(t,e,n){var r=e.pendingProps,s=r.revealOrder,i=r.tail;if(fn(t,e,r.children,n),r=pt.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&Tw(t,n,e);else if(t.tag===19)Tw(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(ot(pt,r),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(n=e.child,s=null;n!==null;)t=n.alternate,t!==null&&Ud(t)===null&&(s=n),n=n.sibling;n=s,n===null?(s=e.child,e.child=null):(s=n.sibling,n.sibling=null),hp(e,!1,s,n,i);break;case"backwards":for(n=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&Ud(t)===null){e.child=s;break}t=s.sibling,s.sibling=n,n=s,s=t}hp(e,!0,n,null,i);break;case"together":hp(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function nd(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function hs(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),no|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(G(153));if(e.child!==null){for(t=e.child,n=ti(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=ti(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function wP(t,e,n){switch(e.tag){case 3:m0(e),xa();break;case 5:zT(e);break;case 1:Nn(e.type)&&jd(e);break;case 4:Yg(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,s=e.memoizedProps.value;ot(Ld,r._currentValue),r._currentValue=s;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(ot(pt,pt.current&1),e.flags|=128,null):n&e.child.childLanes?g0(t,e,n):(ot(pt,pt.current&1),t=hs(t,e,n),t!==null?t.sibling:null);ot(pt,pt.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return y0(t,e,n);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),ot(pt,pt.current),r)break;return null;case 22:case 23:return e.lanes=0,f0(t,e,n)}return hs(t,e,n)}var v0,Rm,_0,w0;v0=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Rm=function(){};_0=function(t,e,n,r){var s=t.memoizedProps;if(s!==r){t=e.stateNode,Bi(qr.current);var i=null;switch(n){case"input":s=Xp(t,s),r=Xp(t,r),i=[];break;case"select":s=yt({},s,{value:void 0}),r=yt({},r,{value:void 0}),i=[];break;case"textarea":s=em(t,s),r=em(t,r),i=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=kd)}nm(n,r);var o;n=null;for(d in s)if(!r.hasOwnProperty(d)&&s.hasOwnProperty(d)&&s[d]!=null)if(d==="style"){var a=s[d];for(o in a)a.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(oc.hasOwnProperty(d)?i||(i=[]):(i=i||[]).push(d,null));for(d in r){var l=r[d];if(a=s!=null?s[d]:void 0,r.hasOwnProperty(d)&&l!==a&&(l!=null||a!=null))if(d==="style")if(a){for(o in a)!a.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in l)l.hasOwnProperty(o)&&a[o]!==l[o]&&(n||(n={}),n[o]=l[o])}else n||(i||(i=[]),i.push(d,n)),n=l;else d==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(i=i||[]).push(d,l)):d==="children"?typeof l!="string"&&typeof l!="number"||(i=i||[]).push(d,""+l):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(oc.hasOwnProperty(d)?(l!=null&&d==="onScroll"&&lt("scroll",t),i||a===l||(i=[])):(i=i||[]).push(d,l))}n&&(i=i||[]).push("style",n);var d=i;(e.updateQueue=d)&&(e.flags|=4)}};w0=function(t,e,n,r){n!==r&&(e.flags|=4)};function vl(t,e){if(!dt)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function tn(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function EP(t,e,n){var r=e.pendingProps;switch(zg(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return tn(e),null;case 1:return Nn(e.type)&&Dd(),tn(e),null;case 3:return r=e.stateNode,Sa(),ct(Pn),ct(un),Jg(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(Ru(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,yr!==null&&(Lm(yr),yr=null))),Rm(t,e),tn(e),null;case 5:Xg(e);var s=Bi(vc.current);if(n=e.type,t!==null&&e.stateNode!=null)_0(t,e,n,r,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(G(166));return tn(e),null}if(t=Bi(qr.current),Ru(e)){r=e.stateNode,n=e.type;var i=e.memoizedProps;switch(r[Fr]=e,r[gc]=i,t=(e.mode&1)!==0,n){case"dialog":lt("cancel",r),lt("close",r);break;case"iframe":case"object":case"embed":lt("load",r);break;case"video":case"audio":for(s=0;s<Nl.length;s++)lt(Nl[s],r);break;case"source":lt("error",r);break;case"img":case"image":case"link":lt("error",r),lt("load",r);break;case"details":lt("toggle",r);break;case"input":D_(r,i),lt("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},lt("invalid",r);break;case"textarea":O_(r,i),lt("invalid",r)}nm(n,i),s=null;for(var o in i)if(i.hasOwnProperty(o)){var a=i[o];o==="children"?typeof a=="string"?r.textContent!==a&&(i.suppressHydrationWarning!==!0&&Au(r.textContent,a,t),s=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(i.suppressHydrationWarning!==!0&&Au(r.textContent,a,t),s=["children",""+a]):oc.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&lt("scroll",r)}switch(n){case"input":wu(r),j_(r,i,!0);break;case"textarea":wu(r),V_(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=kd)}r=s,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=Kx(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[Fr]=e,t[gc]=r,v0(t,e,!1,!1),e.stateNode=t;e:{switch(o=rm(n,r),n){case"dialog":lt("cancel",t),lt("close",t),s=r;break;case"iframe":case"object":case"embed":lt("load",t),s=r;break;case"video":case"audio":for(s=0;s<Nl.length;s++)lt(Nl[s],t);s=r;break;case"source":lt("error",t),s=r;break;case"img":case"image":case"link":lt("error",t),lt("load",t),s=r;break;case"details":lt("toggle",t),s=r;break;case"input":D_(t,r),s=Xp(t,r),lt("invalid",t);break;case"option":s=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},s=yt({},r,{value:void 0}),lt("invalid",t);break;case"textarea":O_(t,r),s=em(t,r),lt("invalid",t);break;default:s=r}nm(n,s),a=s;for(i in a)if(a.hasOwnProperty(i)){var l=a[i];i==="style"?Xx(t,l):i==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&Qx(t,l)):i==="children"?typeof l=="string"?(n!=="textarea"||l!=="")&&ac(t,l):typeof l=="number"&&ac(t,""+l):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(oc.hasOwnProperty(i)?l!=null&&i==="onScroll"&&lt("scroll",t):l!=null&&Ag(t,i,l,o))}switch(n){case"input":wu(t),j_(t,r,!1);break;case"textarea":wu(t),V_(t);break;case"option":r.value!=null&&t.setAttribute("value",""+li(r.value));break;case"select":t.multiple=!!r.multiple,i=r.value,i!=null?aa(t,!!r.multiple,i,!1):r.defaultValue!=null&&aa(t,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=kd)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return tn(e),null;case 6:if(t&&e.stateNode!=null)w0(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(G(166));if(n=Bi(vc.current),Bi(qr.current),Ru(e)){if(r=e.stateNode,n=e.memoizedProps,r[Fr]=e,(i=r.nodeValue!==n)&&(t=Bn,t!==null))switch(t.tag){case 3:Au(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Au(r.nodeValue,n,(t.mode&1)!==0)}i&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Fr]=e,e.stateNode=r}return tn(e),null;case 13:if(ct(pt),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(dt&&Un!==null&&e.mode&1&&!(e.flags&128))MT(),xa(),e.flags|=98560,i=!1;else if(i=Ru(e),r!==null&&r.dehydrated!==null){if(t===null){if(!i)throw Error(G(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(G(317));i[Fr]=e}else xa(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;tn(e),i=!1}else yr!==null&&(Lm(yr),yr=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||pt.current&1?Vt===0&&(Vt=3):uy())),e.updateQueue!==null&&(e.flags|=4),tn(e),null);case 4:return Sa(),Rm(t,e),t===null&&pc(e.stateNode.containerInfo),tn(e),null;case 10:return Gg(e.type._context),tn(e),null;case 17:return Nn(e.type)&&Dd(),tn(e),null;case 19:if(ct(pt),i=e.memoizedState,i===null)return tn(e),null;if(r=(e.flags&128)!==0,o=i.rendering,o===null)if(r)vl(i,!1);else{if(Vt!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=Ud(t),o!==null){for(e.flags|=128,vl(i,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)i=n,t=r,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,t=o.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return ot(pt,pt.current&1|2),e.child}t=t.sibling}i.tail!==null&&Tt()>Ca&&(e.flags|=128,r=!0,vl(i,!1),e.lanes=4194304)}else{if(!r)if(t=Ud(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),vl(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!dt)return tn(e),null}else 2*Tt()-i.renderingStartTime>Ca&&n!==1073741824&&(e.flags|=128,r=!0,vl(i,!1),e.lanes=4194304);i.isBackwards?(o.sibling=e.child,e.child=o):(n=i.last,n!==null?n.sibling=o:e.child=o,i.last=o)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=Tt(),e.sibling=null,n=pt.current,ot(pt,r?n&1|2:n&1),e):(tn(e),null);case 22:case 23:return cy(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?Ln&1073741824&&(tn(e),e.subtreeFlags&6&&(e.flags|=8192)):tn(e),null;case 24:return null;case 25:return null}throw Error(G(156,e.tag))}function IP(t,e){switch(zg(e),e.tag){case 1:return Nn(e.type)&&Dd(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Sa(),ct(Pn),ct(un),Jg(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return Xg(e),null;case 13:if(ct(pt),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(G(340));xa()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return ct(pt),null;case 4:return Sa(),null;case 10:return Gg(e.type._context),null;case 22:case 23:return cy(),null;case 24:return null;default:return null}}var ku=!1,sn=!1,xP=typeof WeakSet=="function"?WeakSet:Set,oe=null;function ra(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){_t(t,e,r)}else n.current=null}function Pm(t,e,n){try{n()}catch(r){_t(t,e,r)}}var Sw=!1;function TP(t,e){if(fm=Rd,t=ST(),$g(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var o=0,a=-1,l=-1,d=0,h=0,f=t,m=null;t:for(;;){for(var v;f!==n||s!==0&&f.nodeType!==3||(a=o+s),f!==i||r!==0&&f.nodeType!==3||(l=o+r),f.nodeType===3&&(o+=f.nodeValue.length),(v=f.firstChild)!==null;)m=f,f=v;for(;;){if(f===t)break t;if(m===n&&++d===s&&(a=o),m===i&&++h===r&&(l=o),(v=f.nextSibling)!==null)break;f=m,m=f.parentNode}f=v}n=a===-1||l===-1?null:{start:a,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(pm={focusedElem:t,selectionRange:n},Rd=!1,oe=e;oe!==null;)if(e=oe,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,oe=t;else for(;oe!==null;){e=oe;try{var R=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(R!==null){var T=R.memoizedProps,P=R.memoizedState,E=e.stateNode,I=E.getSnapshotBeforeUpdate(e.elementType===e.type?T:pr(e.type,T),P);E.__reactInternalSnapshotBeforeUpdate=I}break;case 3:var S=e.stateNode.containerInfo;S.nodeType===1?S.textContent="":S.nodeType===9&&S.documentElement&&S.removeChild(S.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(G(163))}}catch(b){_t(e,e.return,b)}if(t=e.sibling,t!==null){t.return=e.return,oe=t;break}oe=e.return}return R=Sw,Sw=!1,R}function Gl(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&t)===t){var i=s.destroy;s.destroy=void 0,i!==void 0&&Pm(e,n,i)}s=s.next}while(s!==r)}}function Vh(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function Nm(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function E0(t){var e=t.alternate;e!==null&&(t.alternate=null,E0(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Fr],delete e[gc],delete e[ym],delete e[oP],delete e[aP])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function I0(t){return t.tag===5||t.tag===3||t.tag===4}function bw(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||I0(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function km(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=kd));else if(r!==4&&(t=t.child,t!==null))for(km(t,e,n),t=t.sibling;t!==null;)km(t,e,n),t=t.sibling}function Dm(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(Dm(t,e,n),t=t.sibling;t!==null;)Dm(t,e,n),t=t.sibling}var Gt=null,mr=!1;function As(t,e,n){for(n=n.child;n!==null;)x0(t,e,n),n=n.sibling}function x0(t,e,n){if(zr&&typeof zr.onCommitFiberUnmount=="function")try{zr.onCommitFiberUnmount(Ah,n)}catch{}switch(n.tag){case 5:sn||ra(n,e);case 6:var r=Gt,s=mr;Gt=null,As(t,e,n),Gt=r,mr=s,Gt!==null&&(mr?(t=Gt,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Gt.removeChild(n.stateNode));break;case 18:Gt!==null&&(mr?(t=Gt,n=n.stateNode,t.nodeType===8?ip(t.parentNode,n):t.nodeType===1&&ip(t,n),dc(t)):ip(Gt,n.stateNode));break;case 4:r=Gt,s=mr,Gt=n.stateNode.containerInfo,mr=!0,As(t,e,n),Gt=r,mr=s;break;case 0:case 11:case 14:case 15:if(!sn&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var i=s,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&Pm(n,e,o),s=s.next}while(s!==r)}As(t,e,n);break;case 1:if(!sn&&(ra(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(a){_t(n,e,a)}As(t,e,n);break;case 21:As(t,e,n);break;case 22:n.mode&1?(sn=(r=sn)||n.memoizedState!==null,As(t,e,n),sn=r):As(t,e,n);break;default:As(t,e,n)}}function Cw(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new xP),e.forEach(function(r){var s=DP.bind(null,t,r);n.has(r)||(n.add(r),r.then(s,s))})}}function fr(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var i=t,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:Gt=a.stateNode,mr=!1;break e;case 3:Gt=a.stateNode.containerInfo,mr=!0;break e;case 4:Gt=a.stateNode.containerInfo,mr=!0;break e}a=a.return}if(Gt===null)throw Error(G(160));x0(i,o,s),Gt=null,mr=!1;var l=s.alternate;l!==null&&(l.return=null),s.return=null}catch(d){_t(s,e,d)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)T0(e,t),e=e.sibling}function T0(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(fr(e,t),jr(t),r&4){try{Gl(3,t,t.return),Vh(3,t)}catch(T){_t(t,t.return,T)}try{Gl(5,t,t.return)}catch(T){_t(t,t.return,T)}}break;case 1:fr(e,t),jr(t),r&512&&n!==null&&ra(n,n.return);break;case 5:if(fr(e,t),jr(t),r&512&&n!==null&&ra(n,n.return),t.flags&32){var s=t.stateNode;try{ac(s,"")}catch(T){_t(t,t.return,T)}}if(r&4&&(s=t.stateNode,s!=null)){var i=t.memoizedProps,o=n!==null?n.memoizedProps:i,a=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{a==="input"&&i.type==="radio"&&i.name!=null&&Wx(s,i),rm(a,o);var d=rm(a,i);for(o=0;o<l.length;o+=2){var h=l[o],f=l[o+1];h==="style"?Xx(s,f):h==="dangerouslySetInnerHTML"?Qx(s,f):h==="children"?ac(s,f):Ag(s,h,f,d)}switch(a){case"input":Jp(s,i);break;case"textarea":Gx(s,i);break;case"select":var m=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var v=i.value;v!=null?aa(s,!!i.multiple,v,!1):m!==!!i.multiple&&(i.defaultValue!=null?aa(s,!!i.multiple,i.defaultValue,!0):aa(s,!!i.multiple,i.multiple?[]:"",!1))}s[gc]=i}catch(T){_t(t,t.return,T)}}break;case 6:if(fr(e,t),jr(t),r&4){if(t.stateNode===null)throw Error(G(162));s=t.stateNode,i=t.memoizedProps;try{s.nodeValue=i}catch(T){_t(t,t.return,T)}}break;case 3:if(fr(e,t),jr(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{dc(e.containerInfo)}catch(T){_t(t,t.return,T)}break;case 4:fr(e,t),jr(t);break;case 13:fr(e,t),jr(t),s=t.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(ay=Tt())),r&4&&Cw(t);break;case 22:if(h=n!==null&&n.memoizedState!==null,t.mode&1?(sn=(d=sn)||h,fr(e,t),sn=d):fr(e,t),jr(t),r&8192){if(d=t.memoizedState!==null,(t.stateNode.isHidden=d)&&!h&&t.mode&1)for(oe=t,h=t.child;h!==null;){for(f=oe=h;oe!==null;){switch(m=oe,v=m.child,m.tag){case 0:case 11:case 14:case 15:Gl(4,m,m.return);break;case 1:ra(m,m.return);var R=m.stateNode;if(typeof R.componentWillUnmount=="function"){r=m,n=m.return;try{e=r,R.props=e.memoizedProps,R.state=e.memoizedState,R.componentWillUnmount()}catch(T){_t(r,n,T)}}break;case 5:ra(m,m.return);break;case 22:if(m.memoizedState!==null){Rw(f);continue}}v!==null?(v.return=m,oe=v):Rw(f)}h=h.sibling}e:for(h=null,f=t;;){if(f.tag===5){if(h===null){h=f;try{s=f.stateNode,d?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(a=f.stateNode,l=f.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=Yx("display",o))}catch(T){_t(t,t.return,T)}}}else if(f.tag===6){if(h===null)try{f.stateNode.nodeValue=d?"":f.memoizedProps}catch(T){_t(t,t.return,T)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===t)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===t)break e;for(;f.sibling===null;){if(f.return===null||f.return===t)break e;h===f&&(h=null),f=f.return}h===f&&(h=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:fr(e,t),jr(t),r&4&&Cw(t);break;case 21:break;default:fr(e,t),jr(t)}}function jr(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(I0(n)){var r=n;break e}n=n.return}throw Error(G(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(ac(s,""),r.flags&=-33);var i=bw(t);Dm(t,i,s);break;case 3:case 4:var o=r.stateNode.containerInfo,a=bw(t);km(t,a,o);break;default:throw Error(G(161))}}catch(l){_t(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function SP(t,e,n){oe=t,S0(t)}function S0(t,e,n){for(var r=(t.mode&1)!==0;oe!==null;){var s=oe,i=s.child;if(s.tag===22&&r){var o=s.memoizedState!==null||ku;if(!o){var a=s.alternate,l=a!==null&&a.memoizedState!==null||sn;a=ku;var d=sn;if(ku=o,(sn=l)&&!d)for(oe=s;oe!==null;)o=oe,l=o.child,o.tag===22&&o.memoizedState!==null?Pw(s):l!==null?(l.return=o,oe=l):Pw(s);for(;i!==null;)oe=i,S0(i),i=i.sibling;oe=s,ku=a,sn=d}Aw(t)}else s.subtreeFlags&8772&&i!==null?(i.return=s,oe=i):Aw(t)}}function Aw(t){for(;oe!==null;){var e=oe;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:sn||Vh(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!sn)if(n===null)r.componentDidMount();else{var s=e.elementType===e.type?n.memoizedProps:pr(e.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&hw(e,i,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}hw(e,o,n)}break;case 5:var a=e.stateNode;if(n===null&&e.flags&4){n=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var d=e.alternate;if(d!==null){var h=d.memoizedState;if(h!==null){var f=h.dehydrated;f!==null&&dc(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(G(163))}sn||e.flags&512&&Nm(e)}catch(m){_t(e,e.return,m)}}if(e===t){oe=null;break}if(n=e.sibling,n!==null){n.return=e.return,oe=n;break}oe=e.return}}function Rw(t){for(;oe!==null;){var e=oe;if(e===t){oe=null;break}var n=e.sibling;if(n!==null){n.return=e.return,oe=n;break}oe=e.return}}function Pw(t){for(;oe!==null;){var e=oe;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{Vh(4,e)}catch(l){_t(e,n,l)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var s=e.return;try{r.componentDidMount()}catch(l){_t(e,s,l)}}var i=e.return;try{Nm(e)}catch(l){_t(e,i,l)}break;case 5:var o=e.return;try{Nm(e)}catch(l){_t(e,o,l)}}}catch(l){_t(e,e.return,l)}if(e===t){oe=null;break}var a=e.sibling;if(a!==null){a.return=e.return,oe=a;break}oe=e.return}}var bP=Math.ceil,zd=_s.ReactCurrentDispatcher,iy=_s.ReactCurrentOwner,sr=_s.ReactCurrentBatchConfig,qe=0,Wt=null,Pt=null,Xt=0,Ln=0,sa=gi(0),Vt=0,Ic=null,no=0,Lh=0,oy=0,Kl=null,Cn=null,ay=0,Ca=1/0,es=null,qd=!1,jm=null,Zs=null,Du=!1,Ws=null,Hd=0,Ql=0,Om=null,rd=-1,sd=0;function vn(){return qe&6?Tt():rd!==-1?rd:rd=Tt()}function ei(t){return t.mode&1?qe&2&&Xt!==0?Xt&-Xt:cP.transition!==null?(sd===0&&(sd=cT()),sd):(t=et,t!==0||(t=window.event,t=t===void 0?16:gT(t.type)),t):1}function wr(t,e,n,r){if(50<Ql)throw Ql=0,Om=null,Error(G(185));Fc(t,n,r),(!(qe&2)||t!==Wt)&&(t===Wt&&(!(qe&2)&&(Lh|=n),Vt===4&&Ls(t,Xt)),kn(t,r),n===1&&qe===0&&!(e.mode&1)&&(Ca=Tt()+500,Dh&&yi()))}function kn(t,e){var n=t.callbackNode;c1(t,e);var r=Ad(t,t===Wt?Xt:0);if(r===0)n!==null&&F_(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&F_(n),e===1)t.tag===0?lP(Nw.bind(null,t)):OT(Nw.bind(null,t)),sP(function(){!(qe&6)&&yi()}),n=null;else{switch(uT(r)){case 1:n=Dg;break;case 4:n=aT;break;case 16:n=Cd;break;case 536870912:n=lT;break;default:n=Cd}n=D0(n,b0.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function b0(t,e){if(rd=-1,sd=0,qe&6)throw Error(G(327));var n=t.callbackNode;if(ha()&&t.callbackNode!==n)return null;var r=Ad(t,t===Wt?Xt:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=Wd(t,r);else{e=r;var s=qe;qe|=2;var i=A0();(Wt!==t||Xt!==e)&&(es=null,Ca=Tt()+500,Hi(t,e));do try{RP();break}catch(a){C0(t,a)}while(!0);Wg(),zd.current=i,qe=s,Pt!==null?e=0:(Wt=null,Xt=0,e=Vt)}if(e!==0){if(e===2&&(s=lm(t),s!==0&&(r=s,e=Vm(t,s))),e===1)throw n=Ic,Hi(t,0),Ls(t,r),kn(t,Tt()),n;if(e===6)Ls(t,r);else{if(s=t.current.alternate,!(r&30)&&!CP(s)&&(e=Wd(t,r),e===2&&(i=lm(t),i!==0&&(r=i,e=Vm(t,i))),e===1))throw n=Ic,Hi(t,0),Ls(t,r),kn(t,Tt()),n;switch(t.finishedWork=s,t.finishedLanes=r,e){case 0:case 1:throw Error(G(345));case 2:Ni(t,Cn,es);break;case 3:if(Ls(t,r),(r&130023424)===r&&(e=ay+500-Tt(),10<e)){if(Ad(t,0)!==0)break;if(s=t.suspendedLanes,(s&r)!==r){vn(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=gm(Ni.bind(null,t,Cn,es),e);break}Ni(t,Cn,es);break;case 4:if(Ls(t,r),(r&4194240)===r)break;for(e=t.eventTimes,s=-1;0<r;){var o=31-_r(r);i=1<<o,o=e[o],o>s&&(s=o),r&=~i}if(r=s,r=Tt()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*bP(r/1960))-r,10<r){t.timeoutHandle=gm(Ni.bind(null,t,Cn,es),r);break}Ni(t,Cn,es);break;case 5:Ni(t,Cn,es);break;default:throw Error(G(329))}}}return kn(t,Tt()),t.callbackNode===n?b0.bind(null,t):null}function Vm(t,e){var n=Kl;return t.current.memoizedState.isDehydrated&&(Hi(t,e).flags|=256),t=Wd(t,e),t!==2&&(e=Cn,Cn=n,e!==null&&Lm(e)),t}function Lm(t){Cn===null?Cn=t:Cn.push.apply(Cn,t)}function CP(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],i=s.getSnapshot;s=s.value;try{if(!Ir(i(),s))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Ls(t,e){for(e&=~oy,e&=~Lh,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-_r(e),r=1<<n;t[n]=-1,e&=~r}}function Nw(t){if(qe&6)throw Error(G(327));ha();var e=Ad(t,0);if(!(e&1))return kn(t,Tt()),null;var n=Wd(t,e);if(t.tag!==0&&n===2){var r=lm(t);r!==0&&(e=r,n=Vm(t,r))}if(n===1)throw n=Ic,Hi(t,0),Ls(t,e),kn(t,Tt()),n;if(n===6)throw Error(G(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Ni(t,Cn,es),kn(t,Tt()),null}function ly(t,e){var n=qe;qe|=1;try{return t(e)}finally{qe=n,qe===0&&(Ca=Tt()+500,Dh&&yi())}}function ro(t){Ws!==null&&Ws.tag===0&&!(qe&6)&&ha();var e=qe;qe|=1;var n=sr.transition,r=et;try{if(sr.transition=null,et=1,t)return t()}finally{et=r,sr.transition=n,qe=e,!(qe&6)&&yi()}}function cy(){Ln=sa.current,ct(sa)}function Hi(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,rP(n)),Pt!==null)for(n=Pt.return;n!==null;){var r=n;switch(zg(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Dd();break;case 3:Sa(),ct(Pn),ct(un),Jg();break;case 5:Xg(r);break;case 4:Sa();break;case 13:ct(pt);break;case 19:ct(pt);break;case 10:Gg(r.type._context);break;case 22:case 23:cy()}n=n.return}if(Wt=t,Pt=t=ti(t.current,null),Xt=Ln=e,Vt=0,Ic=null,oy=Lh=no=0,Cn=Kl=null,$i!==null){for(e=0;e<$i.length;e++)if(n=$i[e],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,i=n.pending;if(i!==null){var o=i.next;i.next=s,r.next=o}n.pending=r}$i=null}return t}function C0(t,e){do{var n=Pt;try{if(Wg(),ed.current=Bd,$d){for(var r=gt.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}$d=!1}if(to=0,Ht=Ot=gt=null,Wl=!1,_c=0,iy.current=null,n===null||n.return===null){Vt=1,Ic=e,Pt=null;break}e:{var i=t,o=n.return,a=n,l=e;if(e=Xt,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var d=l,h=a,f=h.tag;if(!(h.mode&1)&&(f===0||f===11||f===15)){var m=h.alternate;m?(h.updateQueue=m.updateQueue,h.memoizedState=m.memoizedState,h.lanes=m.lanes):(h.updateQueue=null,h.memoizedState=null)}var v=vw(o);if(v!==null){v.flags&=-257,_w(v,o,a,i,e),v.mode&1&&yw(i,d,e),e=v,l=d;var R=e.updateQueue;if(R===null){var T=new Set;T.add(l),e.updateQueue=T}else R.add(l);break e}else{if(!(e&1)){yw(i,d,e),uy();break e}l=Error(G(426))}}else if(dt&&a.mode&1){var P=vw(o);if(P!==null){!(P.flags&65536)&&(P.flags|=256),_w(P,o,a,i,e),qg(ba(l,a));break e}}i=l=ba(l,a),Vt!==4&&(Vt=2),Kl===null?Kl=[i]:Kl.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var E=u0(i,l,e);dw(i,E);break e;case 1:a=l;var I=i.type,S=i.stateNode;if(!(i.flags&128)&&(typeof I.getDerivedStateFromError=="function"||S!==null&&typeof S.componentDidCatch=="function"&&(Zs===null||!Zs.has(S)))){i.flags|=65536,e&=-e,i.lanes|=e;var b=d0(i,a,e);dw(i,b);break e}}i=i.return}while(i!==null)}P0(n)}catch(L){e=L,Pt===n&&n!==null&&(Pt=n=n.return);continue}break}while(!0)}function A0(){var t=zd.current;return zd.current=Bd,t===null?Bd:t}function uy(){(Vt===0||Vt===3||Vt===2)&&(Vt=4),Wt===null||!(no&268435455)&&!(Lh&268435455)||Ls(Wt,Xt)}function Wd(t,e){var n=qe;qe|=2;var r=A0();(Wt!==t||Xt!==e)&&(es=null,Hi(t,e));do try{AP();break}catch(s){C0(t,s)}while(!0);if(Wg(),qe=n,zd.current=r,Pt!==null)throw Error(G(261));return Wt=null,Xt=0,Vt}function AP(){for(;Pt!==null;)R0(Pt)}function RP(){for(;Pt!==null&&!e1();)R0(Pt)}function R0(t){var e=k0(t.alternate,t,Ln);t.memoizedProps=t.pendingProps,e===null?P0(t):Pt=e,iy.current=null}function P0(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=IP(n,e),n!==null){n.flags&=32767,Pt=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Vt=6,Pt=null;return}}else if(n=EP(n,e,Ln),n!==null){Pt=n;return}if(e=e.sibling,e!==null){Pt=e;return}Pt=e=t}while(e!==null);Vt===0&&(Vt=5)}function Ni(t,e,n){var r=et,s=sr.transition;try{sr.transition=null,et=1,PP(t,e,n,r)}finally{sr.transition=s,et=r}return null}function PP(t,e,n,r){do ha();while(Ws!==null);if(qe&6)throw Error(G(327));n=t.finishedWork;var s=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(G(177));t.callbackNode=null,t.callbackPriority=0;var i=n.lanes|n.childLanes;if(u1(t,i),t===Wt&&(Pt=Wt=null,Xt=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Du||(Du=!0,D0(Cd,function(){return ha(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=sr.transition,sr.transition=null;var o=et;et=1;var a=qe;qe|=4,iy.current=null,TP(t,n),T0(n,t),Y1(pm),Rd=!!fm,pm=fm=null,t.current=n,SP(n),t1(),qe=a,et=o,sr.transition=i}else t.current=n;if(Du&&(Du=!1,Ws=t,Hd=s),i=t.pendingLanes,i===0&&(Zs=null),s1(n.stateNode),kn(t,Tt()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)s=e[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(qd)throw qd=!1,t=jm,jm=null,t;return Hd&1&&t.tag!==0&&ha(),i=t.pendingLanes,i&1?t===Om?Ql++:(Ql=0,Om=t):Ql=0,yi(),null}function ha(){if(Ws!==null){var t=uT(Hd),e=sr.transition,n=et;try{if(sr.transition=null,et=16>t?16:t,Ws===null)var r=!1;else{if(t=Ws,Ws=null,Hd=0,qe&6)throw Error(G(331));var s=qe;for(qe|=4,oe=t.current;oe!==null;){var i=oe,o=i.child;if(oe.flags&16){var a=i.deletions;if(a!==null){for(var l=0;l<a.length;l++){var d=a[l];for(oe=d;oe!==null;){var h=oe;switch(h.tag){case 0:case 11:case 15:Gl(8,h,i)}var f=h.child;if(f!==null)f.return=h,oe=f;else for(;oe!==null;){h=oe;var m=h.sibling,v=h.return;if(E0(h),h===d){oe=null;break}if(m!==null){m.return=v,oe=m;break}oe=v}}}var R=i.alternate;if(R!==null){var T=R.child;if(T!==null){R.child=null;do{var P=T.sibling;T.sibling=null,T=P}while(T!==null)}}oe=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,oe=o;else e:for(;oe!==null;){if(i=oe,i.flags&2048)switch(i.tag){case 0:case 11:case 15:Gl(9,i,i.return)}var E=i.sibling;if(E!==null){E.return=i.return,oe=E;break e}oe=i.return}}var I=t.current;for(oe=I;oe!==null;){o=oe;var S=o.child;if(o.subtreeFlags&2064&&S!==null)S.return=o,oe=S;else e:for(o=I;oe!==null;){if(a=oe,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:Vh(9,a)}}catch(L){_t(a,a.return,L)}if(a===o){oe=null;break e}var b=a.sibling;if(b!==null){b.return=a.return,oe=b;break e}oe=a.return}}if(qe=s,yi(),zr&&typeof zr.onPostCommitFiberRoot=="function")try{zr.onPostCommitFiberRoot(Ah,t)}catch{}r=!0}return r}finally{et=n,sr.transition=e}}return!1}function kw(t,e,n){e=ba(n,e),e=u0(t,e,1),t=Js(t,e,1),e=vn(),t!==null&&(Fc(t,1,e),kn(t,e))}function _t(t,e,n){if(t.tag===3)kw(t,t,n);else for(;e!==null;){if(e.tag===3){kw(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Zs===null||!Zs.has(r))){t=ba(n,t),t=d0(e,t,1),e=Js(e,t,1),t=vn(),e!==null&&(Fc(e,1,t),kn(e,t));break}}e=e.return}}function NP(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=vn(),t.pingedLanes|=t.suspendedLanes&n,Wt===t&&(Xt&n)===n&&(Vt===4||Vt===3&&(Xt&130023424)===Xt&&500>Tt()-ay?Hi(t,0):oy|=n),kn(t,e)}function N0(t,e){e===0&&(t.mode&1?(e=xu,xu<<=1,!(xu&130023424)&&(xu=4194304)):e=1);var n=vn();t=ds(t,e),t!==null&&(Fc(t,e,n),kn(t,n))}function kP(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),N0(t,n)}function DP(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,s=t.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(G(314))}r!==null&&r.delete(e),N0(t,n)}var k0;k0=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||Pn.current)An=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return An=!1,wP(t,e,n);An=!!(t.flags&131072)}else An=!1,dt&&e.flags&1048576&&VT(e,Vd,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;nd(t,e),t=e.pendingProps;var s=Ia(e,un.current);da(e,n),s=ey(null,e,r,t,s,n);var i=ty();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Nn(r)?(i=!0,jd(e)):i=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,Qg(e),s.updater=Oh,e.stateNode=s,s._reactInternals=e,xm(e,r,t,n),e=bm(null,e,r,!0,i,n)):(e.tag=0,dt&&i&&Bg(e),fn(null,e,s,n),e=e.child),e;case 16:r=e.elementType;e:{switch(nd(t,e),t=e.pendingProps,s=r._init,r=s(r._payload),e.type=r,s=e.tag=OP(r),t=pr(r,t),s){case 0:e=Sm(null,e,r,t,n);break e;case 1:e=Iw(null,e,r,t,n);break e;case 11:e=ww(null,e,r,t,n);break e;case 14:e=Ew(null,e,r,pr(r.type,t),n);break e}throw Error(G(306,r,""))}return e;case 0:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:pr(r,s),Sm(t,e,r,s,n);case 1:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:pr(r,s),Iw(t,e,r,s,n);case 3:e:{if(m0(e),t===null)throw Error(G(387));r=e.pendingProps,i=e.memoizedState,s=i.element,BT(t,e),Fd(e,r,null,n);var o=e.memoizedState;if(r=o.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){s=ba(Error(G(423)),e),e=xw(t,e,r,n,s);break e}else if(r!==s){s=ba(Error(G(424)),e),e=xw(t,e,r,n,s);break e}else for(Un=Xs(e.stateNode.containerInfo.firstChild),Bn=e,dt=!0,yr=null,n=UT(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(xa(),r===s){e=hs(t,e,n);break e}fn(t,e,r,n)}e=e.child}return e;case 5:return zT(e),t===null&&wm(e),r=e.type,s=e.pendingProps,i=t!==null?t.memoizedProps:null,o=s.children,mm(r,s)?o=null:i!==null&&mm(r,i)&&(e.flags|=32),p0(t,e),fn(t,e,o,n),e.child;case 6:return t===null&&wm(e),null;case 13:return g0(t,e,n);case 4:return Yg(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=Ta(e,null,r,n):fn(t,e,r,n),e.child;case 11:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:pr(r,s),ww(t,e,r,s,n);case 7:return fn(t,e,e.pendingProps,n),e.child;case 8:return fn(t,e,e.pendingProps.children,n),e.child;case 12:return fn(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,s=e.pendingProps,i=e.memoizedProps,o=s.value,ot(Ld,r._currentValue),r._currentValue=o,i!==null)if(Ir(i.value,o)){if(i.children===s.children&&!Pn.current){e=hs(t,e,n);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var a=i.dependencies;if(a!==null){o=i.child;for(var l=a.firstContext;l!==null;){if(l.context===r){if(i.tag===1){l=as(-1,n&-n),l.tag=2;var d=i.updateQueue;if(d!==null){d=d.shared;var h=d.pending;h===null?l.next=l:(l.next=h.next,h.next=l),d.pending=l}}i.lanes|=n,l=i.alternate,l!==null&&(l.lanes|=n),Em(i.return,n,e),a.lanes|=n;break}l=l.next}}else if(i.tag===10)o=i.type===e.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(G(341));o.lanes|=n,a=o.alternate,a!==null&&(a.lanes|=n),Em(o,n,e),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===e){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}fn(t,e,s.children,n),e=e.child}return e;case 9:return s=e.type,r=e.pendingProps.children,da(e,n),s=or(s),r=r(s),e.flags|=1,fn(t,e,r,n),e.child;case 14:return r=e.type,s=pr(r,e.pendingProps),s=pr(r.type,s),Ew(t,e,r,s,n);case 15:return h0(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:pr(r,s),nd(t,e),e.tag=1,Nn(r)?(t=!0,jd(e)):t=!1,da(e,n),c0(e,r,s),xm(e,r,s,n),bm(null,e,r,!0,t,n);case 19:return y0(t,e,n);case 22:return f0(t,e,n)}throw Error(G(156,e.tag))};function D0(t,e){return oT(t,e)}function jP(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function nr(t,e,n,r){return new jP(t,e,n,r)}function dy(t){return t=t.prototype,!(!t||!t.isReactComponent)}function OP(t){if(typeof t=="function")return dy(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Pg)return 11;if(t===Ng)return 14}return 2}function ti(t,e){var n=t.alternate;return n===null?(n=nr(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function id(t,e,n,r,s,i){var o=2;if(r=t,typeof t=="function")dy(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case Ko:return Wi(n.children,s,i,e);case Rg:o=8,s|=8;break;case Gp:return t=nr(12,n,e,s|2),t.elementType=Gp,t.lanes=i,t;case Kp:return t=nr(13,n,e,s),t.elementType=Kp,t.lanes=i,t;case Qp:return t=nr(19,n,e,s),t.elementType=Qp,t.lanes=i,t;case zx:return Mh(n,s,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case $x:o=10;break e;case Bx:o=9;break e;case Pg:o=11;break e;case Ng:o=14;break e;case js:o=16,r=null;break e}throw Error(G(130,t==null?t:typeof t,""))}return e=nr(o,n,e,s),e.elementType=t,e.type=r,e.lanes=i,e}function Wi(t,e,n,r){return t=nr(7,t,r,e),t.lanes=n,t}function Mh(t,e,n,r){return t=nr(22,t,r,e),t.elementType=zx,t.lanes=n,t.stateNode={isHidden:!1},t}function fp(t,e,n){return t=nr(6,t,null,e),t.lanes=n,t}function pp(t,e,n){return e=nr(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function VP(t,e,n,r,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Kf(0),this.expirationTimes=Kf(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Kf(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function hy(t,e,n,r,s,i,o,a,l){return t=new VP(t,e,n,a,l),e===1?(e=1,i===!0&&(e|=8)):e=0,i=nr(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Qg(i),t}function LP(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Go,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function j0(t){if(!t)return ci;t=t._reactInternals;e:{if(wo(t)!==t||t.tag!==1)throw Error(G(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Nn(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(G(171))}if(t.tag===1){var n=t.type;if(Nn(n))return jT(t,n,e)}return e}function O0(t,e,n,r,s,i,o,a,l){return t=hy(n,r,!0,t,s,i,o,a,l),t.context=j0(null),n=t.current,r=vn(),s=ei(n),i=as(r,s),i.callback=e??null,Js(n,i,s),t.current.lanes=s,Fc(t,s,r),kn(t,r),t}function Fh(t,e,n,r){var s=e.current,i=vn(),o=ei(s);return n=j0(n),e.context===null?e.context=n:e.pendingContext=n,e=as(i,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=Js(s,e,o),t!==null&&(wr(t,s,o,i),Zu(t,s,o)),o}function Gd(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function Dw(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function fy(t,e){Dw(t,e),(t=t.alternate)&&Dw(t,e)}function MP(){return null}var V0=typeof reportError=="function"?reportError:function(t){console.error(t)};function py(t){this._internalRoot=t}Uh.prototype.render=py.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(G(409));Fh(t,e,null,null)};Uh.prototype.unmount=py.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;ro(function(){Fh(null,t,null,null)}),e[us]=null}};function Uh(t){this._internalRoot=t}Uh.prototype.unstable_scheduleHydration=function(t){if(t){var e=fT();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Vs.length&&e!==0&&e<Vs[n].priority;n++);Vs.splice(n,0,t),n===0&&mT(t)}};function my(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function $h(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function jw(){}function FP(t,e,n,r,s){if(s){if(typeof r=="function"){var i=r;r=function(){var d=Gd(o);i.call(d)}}var o=O0(e,r,t,0,null,!1,!1,"",jw);return t._reactRootContainer=o,t[us]=o.current,pc(t.nodeType===8?t.parentNode:t),ro(),o}for(;s=t.lastChild;)t.removeChild(s);if(typeof r=="function"){var a=r;r=function(){var d=Gd(l);a.call(d)}}var l=hy(t,0,!1,null,null,!1,!1,"",jw);return t._reactRootContainer=l,t[us]=l.current,pc(t.nodeType===8?t.parentNode:t),ro(function(){Fh(e,l,n,r)}),l}function Bh(t,e,n,r,s){var i=n._reactRootContainer;if(i){var o=i;if(typeof s=="function"){var a=s;s=function(){var l=Gd(o);a.call(l)}}Fh(e,o,t,s)}else o=FP(n,e,t,s,r);return Gd(o)}dT=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=Pl(e.pendingLanes);n!==0&&(jg(e,n|1),kn(e,Tt()),!(qe&6)&&(Ca=Tt()+500,yi()))}break;case 13:ro(function(){var r=ds(t,1);if(r!==null){var s=vn();wr(r,t,1,s)}}),fy(t,1)}};Og=function(t){if(t.tag===13){var e=ds(t,134217728);if(e!==null){var n=vn();wr(e,t,134217728,n)}fy(t,134217728)}};hT=function(t){if(t.tag===13){var e=ei(t),n=ds(t,e);if(n!==null){var r=vn();wr(n,t,e,r)}fy(t,e)}};fT=function(){return et};pT=function(t,e){var n=et;try{return et=t,e()}finally{et=n}};im=function(t,e,n){switch(e){case"input":if(Jp(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var s=kh(r);if(!s)throw Error(G(90));Hx(r),Jp(r,s)}}}break;case"textarea":Gx(t,n);break;case"select":e=n.value,e!=null&&aa(t,!!n.multiple,e,!1)}};eT=ly;tT=ro;var UP={usingClientEntryPoint:!1,Events:[$c,Jo,kh,Jx,Zx,ly]},_l={findFiberByHostInstance:Ui,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},$P={bundleType:_l.bundleType,version:_l.version,rendererPackageName:_l.rendererPackageName,rendererConfig:_l.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:_s.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=sT(t),t===null?null:t.stateNode},findFiberByHostInstance:_l.findFiberByHostInstance||MP,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var ju=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ju.isDisabled&&ju.supportsFiber)try{Ah=ju.inject($P),zr=ju}catch{}}Wn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=UP;Wn.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!my(e))throw Error(G(200));return LP(t,e,null,n)};Wn.createRoot=function(t,e){if(!my(t))throw Error(G(299));var n=!1,r="",s=V0;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=hy(t,1,!1,null,null,n,!1,r,s),t[us]=e.current,pc(t.nodeType===8?t.parentNode:t),new py(e)};Wn.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(G(188)):(t=Object.keys(t).join(","),Error(G(268,t)));return t=sT(e),t=t===null?null:t.stateNode,t};Wn.flushSync=function(t){return ro(t)};Wn.hydrate=function(t,e,n){if(!$h(e))throw Error(G(200));return Bh(null,t,e,!0,n)};Wn.hydrateRoot=function(t,e,n){if(!my(t))throw Error(G(405));var r=n!=null&&n.hydratedSources||null,s=!1,i="",o=V0;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=O0(e,null,t,1,n??null,s,!1,i,o),t[us]=e.current,pc(t),r)for(t=0;t<r.length;t++)n=r[t],s=n._getVersion,s=s(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,s]:e.mutableSourceEagerHydrationData.push(n,s);return new Uh(e)};Wn.render=function(t,e,n){if(!$h(e))throw Error(G(200));return Bh(null,t,e,!1,n)};Wn.unmountComponentAtNode=function(t){if(!$h(t))throw Error(G(40));return t._reactRootContainer?(ro(function(){Bh(null,null,t,!1,function(){t._reactRootContainer=null,t[us]=null})}),!0):!1};Wn.unstable_batchedUpdates=ly;Wn.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!$h(n))throw Error(G(200));if(t==null||t._reactInternals===void 0)throw Error(G(38));return Bh(t,e,n,!1,r)};Wn.version="18.3.1-next-f1338f8080-20240426";function L0(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(L0)}catch(t){console.error(t)}}L0(),Lx.exports=Wn;var BP=Lx.exports,M0,Ow=BP;M0=Ow.createRoot,Ow.hydrateRoot;/**
 * react-router v7.9.6
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var Vw="popstate";function zP(t={}){function e(r,s){let{pathname:i,search:o,hash:a}=r.location;return Mm("",{pathname:i,search:o,hash:a},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function n(r,s){return typeof s=="string"?s:xc(s)}return HP(e,n,null,t)}function ht(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function lr(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function qP(){return Math.random().toString(36).substring(2,10)}function Lw(t,e){return{usr:t.state,key:t.key,idx:e}}function Mm(t,e,n=null,r){return{pathname:typeof t=="string"?t:t.pathname,search:"",hash:"",...typeof e=="string"?Ha(e):e,state:n,key:e&&e.key||r||qP()}}function xc({pathname:t="/",search:e="",hash:n=""}){return e&&e!=="?"&&(t+=e.charAt(0)==="?"?e:"?"+e),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function Ha(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substring(n),t=t.substring(0,n));let r=t.indexOf("?");r>=0&&(e.search=t.substring(r),t=t.substring(0,r)),t&&(e.pathname=t)}return e}function HP(t,e,n,r={}){let{window:s=document.defaultView,v5Compat:i=!1}=r,o=s.history,a="POP",l=null,d=h();d==null&&(d=0,o.replaceState({...o.state,idx:d},""));function h(){return(o.state||{idx:null}).idx}function f(){a="POP";let P=h(),E=P==null?null:P-d;d=P,l&&l({action:a,location:T.location,delta:E})}function m(P,E){a="PUSH";let I=Mm(T.location,P,E);d=h()+1;let S=Lw(I,d),b=T.createHref(I);try{o.pushState(S,"",b)}catch(L){if(L instanceof DOMException&&L.name==="DataCloneError")throw L;s.location.assign(b)}i&&l&&l({action:a,location:T.location,delta:1})}function v(P,E){a="REPLACE";let I=Mm(T.location,P,E);d=h();let S=Lw(I,d),b=T.createHref(I);o.replaceState(S,"",b),i&&l&&l({action:a,location:T.location,delta:0})}function R(P){return WP(P)}let T={get action(){return a},get location(){return t(s,o)},listen(P){if(l)throw new Error("A history only accepts one active listener");return s.addEventListener(Vw,f),l=P,()=>{s.removeEventListener(Vw,f),l=null}},createHref(P){return e(s,P)},createURL:R,encodeLocation(P){let E=R(P);return{pathname:E.pathname,search:E.search,hash:E.hash}},push:m,replace:v,go(P){return o.go(P)}};return T}function WP(t,e=!1){let n="http://localhost";typeof window<"u"&&(n=window.location.origin!=="null"?window.location.origin:window.location.href),ht(n,"No window.location.(origin|href) available to create URL");let r=typeof t=="string"?t:xc(t);return r=r.replace(/ $/,"%20"),!e&&r.startsWith("//")&&(r=n+r),new URL(r,n)}function F0(t,e,n="/"){return GP(t,e,n,!1)}function GP(t,e,n,r){let s=typeof e=="string"?Ha(e):e,i=fs(s.pathname||"/",n);if(i==null)return null;let o=U0(t);KP(o);let a=null;for(let l=0;a==null&&l<o.length;++l){let d=iN(i);a=rN(o[l],d,r)}return a}function U0(t,e=[],n=[],r="",s=!1){let i=(o,a,l=s,d)=>{let h={relativePath:d===void 0?o.path||"":d,caseSensitive:o.caseSensitive===!0,childrenIndex:a,route:o};if(h.relativePath.startsWith("/")){if(!h.relativePath.startsWith(r)&&l)return;ht(h.relativePath.startsWith(r),`Absolute route path "${h.relativePath}" nested under path "${r}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),h.relativePath=h.relativePath.slice(r.length)}let f=ls([r,h.relativePath]),m=n.concat(h);o.children&&o.children.length>0&&(ht(o.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${f}".`),U0(o.children,e,m,f,l)),!(o.path==null&&!o.index)&&e.push({path:f,score:tN(f,o.index),routesMeta:m})};return t.forEach((o,a)=>{var l;if(o.path===""||!((l=o.path)!=null&&l.includes("?")))i(o,a);else for(let d of $0(o.path))i(o,a,!0,d)}),e}function $0(t){let e=t.split("/");if(e.length===0)return[];let[n,...r]=e,s=n.endsWith("?"),i=n.replace(/\?$/,"");if(r.length===0)return s?[i,""]:[i];let o=$0(r.join("/")),a=[];return a.push(...o.map(l=>l===""?i:[i,l].join("/"))),s&&a.push(...o),a.map(l=>t.startsWith("/")&&l===""?"/":l)}function KP(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:nN(e.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}var QP=/^:[\w-]+$/,YP=3,XP=2,JP=1,ZP=10,eN=-2,Mw=t=>t==="*";function tN(t,e){let n=t.split("/"),r=n.length;return n.some(Mw)&&(r+=eN),e&&(r+=XP),n.filter(s=>!Mw(s)).reduce((s,i)=>s+(QP.test(i)?YP:i===""?JP:ZP),r)}function nN(t,e){return t.length===e.length&&t.slice(0,-1).every((r,s)=>r===e[s])?t[t.length-1]-e[e.length-1]:0}function rN(t,e,n=!1){let{routesMeta:r}=t,s={},i="/",o=[];for(let a=0;a<r.length;++a){let l=r[a],d=a===r.length-1,h=i==="/"?e:e.slice(i.length)||"/",f=Kd({path:l.relativePath,caseSensitive:l.caseSensitive,end:d},h),m=l.route;if(!f&&d&&n&&!r[r.length-1].route.index&&(f=Kd({path:l.relativePath,caseSensitive:l.caseSensitive,end:!1},h)),!f)return null;Object.assign(s,f.params),o.push({params:s,pathname:ls([i,f.pathname]),pathnameBase:uN(ls([i,f.pathnameBase])),route:m}),f.pathnameBase!=="/"&&(i=ls([i,f.pathnameBase]))}return o}function Kd(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,r]=sN(t.path,t.caseSensitive,t.end),s=e.match(n);if(!s)return null;let i=s[0],o=i.replace(/(.)\/+$/,"$1"),a=s.slice(1);return{params:r.reduce((d,{paramName:h,isOptional:f},m)=>{if(h==="*"){let R=a[m]||"";o=i.slice(0,i.length-R.length).replace(/(.)\/+$/,"$1")}const v=a[m];return f&&!v?d[h]=void 0:d[h]=(v||"").replace(/%2F/g,"/"),d},{}),pathname:i,pathnameBase:o,pattern:t}}function sN(t,e=!1,n=!0){lr(t==="*"||!t.endsWith("*")||t.endsWith("/*"),`Route path "${t}" will be treated as if it were "${t.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${t.replace(/\*$/,"/*")}".`);let r=[],s="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,a,l)=>(r.push({paramName:a,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return t.endsWith("*")?(r.push({paramName:"*"}),s+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?s+="\\/*$":t!==""&&t!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,e?void 0:"i"),r]}function iN(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return lr(!1,`The URL path "${t}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),t}}function fs(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,r=t.charAt(n);return r&&r!=="/"?null:t.slice(n)||"/"}var oN=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,aN=t=>oN.test(t);function lN(t,e="/"){let{pathname:n,search:r="",hash:s=""}=typeof t=="string"?Ha(t):t,i;if(n)if(aN(n))i=n;else{if(n.includes("//")){let o=n;n=n.replace(/\/\/+/g,"/"),lr(!1,`Pathnames cannot have embedded double slashes - normalizing ${o} -> ${n}`)}n.startsWith("/")?i=Fw(n.substring(1),"/"):i=Fw(n,e)}else i=e;return{pathname:i,search:dN(r),hash:hN(s)}}function Fw(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(s=>{s===".."?n.length>1&&n.pop():s!=="."&&n.push(s)}),n.length>1?n.join("/"):"/"}function mp(t,e,n,r){return`Cannot include a '${t}' character in a manually specified \`to.${e}\` field [${JSON.stringify(r)}].  Please separate it out to the \`to.${n}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function cN(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function gy(t){let e=cN(t);return e.map((n,r)=>r===e.length-1?n.pathname:n.pathnameBase)}function yy(t,e,n,r=!1){let s;typeof t=="string"?s=Ha(t):(s={...t},ht(!s.pathname||!s.pathname.includes("?"),mp("?","pathname","search",s)),ht(!s.pathname||!s.pathname.includes("#"),mp("#","pathname","hash",s)),ht(!s.search||!s.search.includes("#"),mp("#","search","hash",s)));let i=t===""||s.pathname==="",o=i?"/":s.pathname,a;if(o==null)a=n;else{let f=e.length-1;if(!r&&o.startsWith("..")){let m=o.split("/");for(;m[0]==="..";)m.shift(),f-=1;s.pathname=m.join("/")}a=f>=0?e[f]:"/"}let l=lN(s,a),d=o&&o!=="/"&&o.endsWith("/"),h=(i||o===".")&&n.endsWith("/");return!l.pathname.endsWith("/")&&(d||h)&&(l.pathname+="/"),l}var ls=t=>t.join("/").replace(/\/\/+/g,"/"),uN=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),dN=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,hN=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function fN(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var B0=["POST","PUT","PATCH","DELETE"];new Set(B0);var pN=["GET",...B0];new Set(pN);var Wa=A.createContext(null);Wa.displayName="DataRouter";var zh=A.createContext(null);zh.displayName="DataRouterState";A.createContext(!1);var z0=A.createContext({isTransitioning:!1});z0.displayName="ViewTransition";var mN=A.createContext(new Map);mN.displayName="Fetchers";var gN=A.createContext(null);gN.displayName="Await";var br=A.createContext(null);br.displayName="Navigation";var zc=A.createContext(null);zc.displayName="Location";var Cr=A.createContext({outlet:null,matches:[],isDataRoute:!1});Cr.displayName="Route";var vy=A.createContext(null);vy.displayName="RouteError";function yN(t,{relative:e}={}){ht(Ga(),"useHref() may be used only in the context of a <Router> component.");let{basename:n,navigator:r}=A.useContext(br),{hash:s,pathname:i,search:o}=qc(t,{relative:e}),a=i;return n!=="/"&&(a=i==="/"?n:ls([n,i])),r.createHref({pathname:a,search:o,hash:s})}function Ga(){return A.useContext(zc)!=null}function Kn(){return ht(Ga(),"useLocation() may be used only in the context of a <Router> component."),A.useContext(zc).location}var q0="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function H0(t){A.useContext(br).static||A.useLayoutEffect(t)}function Ka(){let{isDataRoute:t}=A.useContext(Cr);return t?NN():vN()}function vN(){ht(Ga(),"useNavigate() may be used only in the context of a <Router> component.");let t=A.useContext(Wa),{basename:e,navigator:n}=A.useContext(br),{matches:r}=A.useContext(Cr),{pathname:s}=Kn(),i=JSON.stringify(gy(r)),o=A.useRef(!1);return H0(()=>{o.current=!0}),A.useCallback((l,d={})=>{if(lr(o.current,q0),!o.current)return;if(typeof l=="number"){n.go(l);return}let h=yy(l,JSON.parse(i),s,d.relative==="path");t==null&&e!=="/"&&(h.pathname=h.pathname==="/"?e:ls([e,h.pathname])),(d.replace?n.replace:n.push)(h,d.state,d)},[e,n,i,s,t])}A.createContext(null);function _N(){let{matches:t}=A.useContext(Cr),e=t[t.length-1];return e?e.params:{}}function qc(t,{relative:e}={}){let{matches:n}=A.useContext(Cr),{pathname:r}=Kn(),s=JSON.stringify(gy(n));return A.useMemo(()=>yy(t,JSON.parse(s),r,e==="path"),[t,s,r,e])}function wN(t,e){return W0(t,e)}function W0(t,e,n,r,s){var I;ht(Ga(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:i}=A.useContext(br),{matches:o}=A.useContext(Cr),a=o[o.length-1],l=a?a.params:{},d=a?a.pathname:"/",h=a?a.pathnameBase:"/",f=a&&a.route;{let S=f&&f.path||"";G0(d,!f||S.endsWith("*")||S.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${d}" (under <Route path="${S}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${S}"> to <Route path="${S==="/"?"*":`${S}/*`}">.`)}let m=Kn(),v;if(e){let S=typeof e=="string"?Ha(e):e;ht(h==="/"||((I=S.pathname)==null?void 0:I.startsWith(h)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${h}" but pathname "${S.pathname}" was given in the \`location\` prop.`),v=S}else v=m;let R=v.pathname||"/",T=R;if(h!=="/"){let S=h.replace(/^\//,"").split("/");T="/"+R.replace(/^\//,"").split("/").slice(S.length).join("/")}let P=F0(t,{pathname:T});lr(f||P!=null,`No routes matched location "${v.pathname}${v.search}${v.hash}" `),lr(P==null||P[P.length-1].route.element!==void 0||P[P.length-1].route.Component!==void 0||P[P.length-1].route.lazy!==void 0,`Matched leaf route at location "${v.pathname}${v.search}${v.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let E=SN(P&&P.map(S=>Object.assign({},S,{params:Object.assign({},l,S.params),pathname:ls([h,i.encodeLocation?i.encodeLocation(S.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:S.pathname]),pathnameBase:S.pathnameBase==="/"?h:ls([h,i.encodeLocation?i.encodeLocation(S.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:S.pathnameBase])})),o,n,r,s);return e&&E?A.createElement(zc.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...v},navigationType:"POP"}},E):E}function EN(){let t=PN(),e=fN(t)?`${t.status} ${t.statusText}`:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,r="rgba(200,200,200, 0.5)",s={padding:"0.5rem",backgroundColor:r},i={padding:"2px 4px",backgroundColor:r},o=null;return console.error("Error handled by React Router default ErrorBoundary:",t),o=A.createElement(A.Fragment,null,A.createElement("p",null," Hey developer "),A.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",A.createElement("code",{style:i},"ErrorBoundary")," or"," ",A.createElement("code",{style:i},"errorElement")," prop on your route.")),A.createElement(A.Fragment,null,A.createElement("h2",null,"Unexpected Application Error!"),A.createElement("h3",{style:{fontStyle:"italic"}},e),n?A.createElement("pre",{style:s},n):null,o)}var IN=A.createElement(EN,null),xN=class extends A.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,e){return e.location!==t.location||e.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:e.error,location:e.location,revalidation:t.revalidation||e.revalidation}}componentDidCatch(t,e){this.props.onError?this.props.onError(t,e):console.error("React Router caught the following error during render",t)}render(){return this.state.error!==void 0?A.createElement(Cr.Provider,{value:this.props.routeContext},A.createElement(vy.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function TN({routeContext:t,match:e,children:n}){let r=A.useContext(Wa);return r&&r.static&&r.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=e.route.id),A.createElement(Cr.Provider,{value:t},n)}function SN(t,e=[],n=null,r=null,s=null){if(t==null){if(!n)return null;if(n.errors)t=n.matches;else if(e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let i=t,o=n==null?void 0:n.errors;if(o!=null){let h=i.findIndex(f=>f.route.id&&(o==null?void 0:o[f.route.id])!==void 0);ht(h>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(o).join(",")}`),i=i.slice(0,Math.min(i.length,h+1))}let a=!1,l=-1;if(n)for(let h=0;h<i.length;h++){let f=i[h];if((f.route.HydrateFallback||f.route.hydrateFallbackElement)&&(l=h),f.route.id){let{loaderData:m,errors:v}=n,R=f.route.loader&&!m.hasOwnProperty(f.route.id)&&(!v||v[f.route.id]===void 0);if(f.route.lazy||R){a=!0,l>=0?i=i.slice(0,l+1):i=[i[0]];break}}}let d=n&&r?(h,f)=>{var m,v;r(h,{location:n.location,params:((v=(m=n.matches)==null?void 0:m[0])==null?void 0:v.params)??{},errorInfo:f})}:void 0;return i.reduceRight((h,f,m)=>{let v,R=!1,T=null,P=null;n&&(v=o&&f.route.id?o[f.route.id]:void 0,T=f.route.errorElement||IN,a&&(l<0&&m===0?(G0("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),R=!0,P=null):l===m&&(R=!0,P=f.route.hydrateFallbackElement||null)));let E=e.concat(i.slice(0,m+1)),I=()=>{let S;return v?S=T:R?S=P:f.route.Component?S=A.createElement(f.route.Component,null):f.route.element?S=f.route.element:S=h,A.createElement(TN,{match:f,routeContext:{outlet:h,matches:E,isDataRoute:n!=null},children:S})};return n&&(f.route.ErrorBoundary||f.route.errorElement||m===0)?A.createElement(xN,{location:n.location,revalidation:n.revalidation,component:T,error:v,children:I(),routeContext:{outlet:null,matches:E,isDataRoute:!0},onError:d}):I()},null)}function _y(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function bN(t){let e=A.useContext(Wa);return ht(e,_y(t)),e}function CN(t){let e=A.useContext(zh);return ht(e,_y(t)),e}function AN(t){let e=A.useContext(Cr);return ht(e,_y(t)),e}function wy(t){let e=AN(t),n=e.matches[e.matches.length-1];return ht(n.route.id,`${t} can only be used on routes that contain a unique "id"`),n.route.id}function RN(){return wy("useRouteId")}function PN(){var r;let t=A.useContext(vy),e=CN("useRouteError"),n=wy("useRouteError");return t!==void 0?t:(r=e.errors)==null?void 0:r[n]}function NN(){let{router:t}=bN("useNavigate"),e=wy("useNavigate"),n=A.useRef(!1);return H0(()=>{n.current=!0}),A.useCallback(async(s,i={})=>{lr(n.current,q0),n.current&&(typeof s=="number"?t.navigate(s):await t.navigate(s,{fromRouteId:e,...i}))},[t,e])}var Uw={};function G0(t,e,n){!e&&!Uw[t]&&(Uw[t]=!0,lr(!1,n))}A.memo(kN);function kN({routes:t,future:e,state:n,unstable_onError:r}){return W0(t,void 0,n,r,e)}function Qd({to:t,replace:e,state:n,relative:r}){ht(Ga(),"<Navigate> may be used only in the context of a <Router> component.");let{static:s}=A.useContext(br);lr(!s,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:i}=A.useContext(Cr),{pathname:o}=Kn(),a=Ka(),l=yy(t,gy(i),o,r==="path"),d=JSON.stringify(l);return A.useEffect(()=>{a(JSON.parse(d),{replace:e,state:n,relative:r})},[a,d,r,e,n]),null}function $o(t){ht(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function DN({basename:t="/",children:e=null,location:n,navigationType:r="POP",navigator:s,static:i=!1}){ht(!Ga(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let o=t.replace(/^\/*/,"/"),a=A.useMemo(()=>({basename:o,navigator:s,static:i,future:{}}),[o,s,i]);typeof n=="string"&&(n=Ha(n));let{pathname:l="/",search:d="",hash:h="",state:f=null,key:m="default"}=n,v=A.useMemo(()=>{let R=fs(l,o);return R==null?null:{location:{pathname:R,search:d,hash:h,state:f,key:m},navigationType:r}},[o,l,d,h,f,m,r]);return lr(v!=null,`<Router basename="${o}"> is not able to match the URL "${l}${d}${h}" because it does not start with the basename, so the <Router> won't render anything.`),v==null?null:A.createElement(br.Provider,{value:a},A.createElement(zc.Provider,{children:e,value:v}))}function jN({children:t,location:e}){return wN(Fm(t),e)}function Fm(t,e=[]){let n=[];return A.Children.forEach(t,(r,s)=>{if(!A.isValidElement(r))return;let i=[...e,s];if(r.type===A.Fragment){n.push.apply(n,Fm(r.props.children,i));return}ht(r.type===$o,`[${typeof r.type=="string"?r.type:r.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),ht(!r.props.index||!r.props.children,"An index route cannot have child routes.");let o={id:r.props.id||i.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,middleware:r.props.middleware,loader:r.props.loader,action:r.props.action,hydrateFallbackElement:r.props.hydrateFallbackElement,HydrateFallback:r.props.HydrateFallback,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.hasErrorBoundary===!0||r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(o.children=Fm(r.props.children,i)),n.push(o)}),n}var od="get",ad="application/x-www-form-urlencoded";function qh(t){return t!=null&&typeof t.tagName=="string"}function ON(t){return qh(t)&&t.tagName.toLowerCase()==="button"}function VN(t){return qh(t)&&t.tagName.toLowerCase()==="form"}function LN(t){return qh(t)&&t.tagName.toLowerCase()==="input"}function MN(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function FN(t,e){return t.button===0&&(!e||e==="_self")&&!MN(t)}var Ou=null;function UN(){if(Ou===null)try{new FormData(document.createElement("form"),0),Ou=!1}catch{Ou=!0}return Ou}var $N=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function gp(t){return t!=null&&!$N.has(t)?(lr(!1,`"${t}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${ad}"`),null):t}function BN(t,e){let n,r,s,i,o;if(VN(t)){let a=t.getAttribute("action");r=a?fs(a,e):null,n=t.getAttribute("method")||od,s=gp(t.getAttribute("enctype"))||ad,i=new FormData(t)}else if(ON(t)||LN(t)&&(t.type==="submit"||t.type==="image")){let a=t.form;if(a==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let l=t.getAttribute("formaction")||a.getAttribute("action");if(r=l?fs(l,e):null,n=t.getAttribute("formmethod")||a.getAttribute("method")||od,s=gp(t.getAttribute("formenctype"))||gp(a.getAttribute("enctype"))||ad,i=new FormData(a,t),!UN()){let{name:d,type:h,value:f}=t;if(h==="image"){let m=d?`${d}.`:"";i.append(`${m}x`,"0"),i.append(`${m}y`,"0")}else d&&i.append(d,f)}}else{if(qh(t))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');n=od,r=null,s=ad,o=t}return i&&s==="text/plain"&&(o=i,i=void 0),{action:r,method:n.toLowerCase(),encType:s,formData:i,body:o}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function Ey(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function zN(t,e,n){let r=typeof t=="string"?new URL(t,typeof window>"u"?"server://singlefetch/":window.location.origin):t;return r.pathname==="/"?r.pathname=`_root.${n}`:e&&fs(r.pathname,e)==="/"?r.pathname=`${e.replace(/\/$/,"")}/_root.${n}`:r.pathname=`${r.pathname.replace(/\/$/,"")}.${n}`,r}async function qN(t,e){if(t.id in e)return e[t.id];try{let n=await import(t.module);return e[t.id]=n,n}catch(n){return console.error(`Error loading route module \`${t.module}\`, reloading page...`),console.error(n),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function HN(t){return t==null?!1:t.href==null?t.rel==="preload"&&typeof t.imageSrcSet=="string"&&typeof t.imageSizes=="string":typeof t.rel=="string"&&typeof t.href=="string"}async function WN(t,e,n){let r=await Promise.all(t.map(async s=>{let i=e.routes[s.route.id];if(i){let o=await qN(i,n);return o.links?o.links():[]}return[]}));return YN(r.flat(1).filter(HN).filter(s=>s.rel==="stylesheet"||s.rel==="preload").map(s=>s.rel==="stylesheet"?{...s,rel:"prefetch",as:"style"}:{...s,rel:"prefetch"}))}function $w(t,e,n,r,s,i){let o=(l,d)=>n[d]?l.route.id!==n[d].route.id:!0,a=(l,d)=>{var h;return n[d].pathname!==l.pathname||((h=n[d].route.path)==null?void 0:h.endsWith("*"))&&n[d].params["*"]!==l.params["*"]};return i==="assets"?e.filter((l,d)=>o(l,d)||a(l,d)):i==="data"?e.filter((l,d)=>{var f;let h=r.routes[l.route.id];if(!h||!h.hasLoader)return!1;if(o(l,d)||a(l,d))return!0;if(l.route.shouldRevalidate){let m=l.route.shouldRevalidate({currentUrl:new URL(s.pathname+s.search+s.hash,window.origin),currentParams:((f=n[0])==null?void 0:f.params)||{},nextUrl:new URL(t,window.origin),nextParams:l.params,defaultShouldRevalidate:!0});if(typeof m=="boolean")return m}return!0}):[]}function GN(t,e,{includeHydrateFallback:n}={}){return KN(t.map(r=>{let s=e.routes[r.route.id];if(!s)return[];let i=[s.module];return s.clientActionModule&&(i=i.concat(s.clientActionModule)),s.clientLoaderModule&&(i=i.concat(s.clientLoaderModule)),n&&s.hydrateFallbackModule&&(i=i.concat(s.hydrateFallbackModule)),s.imports&&(i=i.concat(s.imports)),i}).flat(1))}function KN(t){return[...new Set(t)]}function QN(t){let e={},n=Object.keys(t).sort();for(let r of n)e[r]=t[r];return e}function YN(t,e){let n=new Set;return new Set(e),t.reduce((r,s)=>{let i=JSON.stringify(QN(s));return n.has(i)||(n.add(i),r.push({key:i,link:s})),r},[])}function K0(){let t=A.useContext(Wa);return Ey(t,"You must render this element inside a <DataRouterContext.Provider> element"),t}function XN(){let t=A.useContext(zh);return Ey(t,"You must render this element inside a <DataRouterStateContext.Provider> element"),t}var Iy=A.createContext(void 0);Iy.displayName="FrameworkContext";function Q0(){let t=A.useContext(Iy);return Ey(t,"You must render this element inside a <HydratedRouter> element"),t}function JN(t,e){let n=A.useContext(Iy),[r,s]=A.useState(!1),[i,o]=A.useState(!1),{onFocus:a,onBlur:l,onMouseEnter:d,onMouseLeave:h,onTouchStart:f}=e,m=A.useRef(null);A.useEffect(()=>{if(t==="render"&&o(!0),t==="viewport"){let T=E=>{E.forEach(I=>{o(I.isIntersecting)})},P=new IntersectionObserver(T,{threshold:.5});return m.current&&P.observe(m.current),()=>{P.disconnect()}}},[t]),A.useEffect(()=>{if(r){let T=setTimeout(()=>{o(!0)},100);return()=>{clearTimeout(T)}}},[r]);let v=()=>{s(!0)},R=()=>{s(!1),o(!1)};return n?t!=="intent"?[i,m,{}]:[i,m,{onFocus:wl(a,v),onBlur:wl(l,R),onMouseEnter:wl(d,v),onMouseLeave:wl(h,R),onTouchStart:wl(f,v)}]:[!1,m,{}]}function wl(t,e){return n=>{t&&t(n),n.defaultPrevented||e(n)}}function ZN({page:t,...e}){let{router:n}=K0(),r=A.useMemo(()=>F0(n.routes,t,n.basename),[n.routes,t,n.basename]);return r?A.createElement(tk,{page:t,matches:r,...e}):null}function ek(t){let{manifest:e,routeModules:n}=Q0(),[r,s]=A.useState([]);return A.useEffect(()=>{let i=!1;return WN(t,e,n).then(o=>{i||s(o)}),()=>{i=!0}},[t,e,n]),r}function tk({page:t,matches:e,...n}){let r=Kn(),{manifest:s,routeModules:i}=Q0(),{basename:o}=K0(),{loaderData:a,matches:l}=XN(),d=A.useMemo(()=>$w(t,e,l,s,r,"data"),[t,e,l,s,r]),h=A.useMemo(()=>$w(t,e,l,s,r,"assets"),[t,e,l,s,r]),f=A.useMemo(()=>{if(t===r.pathname+r.search+r.hash)return[];let R=new Set,T=!1;if(e.forEach(E=>{var S;let I=s.routes[E.route.id];!I||!I.hasLoader||(!d.some(b=>b.route.id===E.route.id)&&E.route.id in a&&((S=i[E.route.id])!=null&&S.shouldRevalidate)||I.hasClientLoader?T=!0:R.add(E.route.id))}),R.size===0)return[];let P=zN(t,o,"data");return T&&R.size>0&&P.searchParams.set("_routes",e.filter(E=>R.has(E.route.id)).map(E=>E.route.id).join(",")),[P.pathname+P.search]},[o,a,r,s,d,e,t,i]),m=A.useMemo(()=>GN(h,s),[h,s]),v=ek(h);return A.createElement(A.Fragment,null,f.map(R=>A.createElement("link",{key:R,rel:"prefetch",as:"fetch",href:R,...n})),m.map(R=>A.createElement("link",{key:R,rel:"modulepreload",href:R,...n})),v.map(({key:R,link:T})=>A.createElement("link",{key:R,nonce:n.nonce,...T})))}function nk(...t){return e=>{t.forEach(n=>{typeof n=="function"?n(e):n!=null&&(n.current=e)})}}var Y0=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{Y0&&(window.__reactRouterVersion="7.9.6")}catch{}function rk({basename:t,children:e,window:n}){let r=A.useRef();r.current==null&&(r.current=zP({window:n,v5Compat:!0}));let s=r.current,[i,o]=A.useState({action:s.action,location:s.location}),a=A.useCallback(l=>{A.startTransition(()=>o(l))},[o]);return A.useLayoutEffect(()=>s.listen(a),[s,a]),A.createElement(DN,{basename:t,children:e,location:i.location,navigationType:i.action,navigator:s})}var X0=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,J0=A.forwardRef(function({onClick:e,discover:n="render",prefetch:r="none",relative:s,reloadDocument:i,replace:o,state:a,target:l,to:d,preventScrollReset:h,viewTransition:f,...m},v){let{basename:R}=A.useContext(br),T=typeof d=="string"&&X0.test(d),P,E=!1;if(typeof d=="string"&&T&&(P=d,Y0))try{let y=new URL(window.location.href),N=d.startsWith("//")?new URL(y.protocol+d):new URL(d),D=fs(N.pathname,R);N.origin===y.origin&&D!=null?d=D+N.search+N.hash:E=!0}catch{lr(!1,`<Link to="${d}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let I=yN(d,{relative:s}),[S,b,L]=JN(r,m),B=ok(d,{replace:o,state:a,target:l,preventScrollReset:h,relative:s,viewTransition:f});function w(y){e&&e(y),y.defaultPrevented||B(y)}let _=A.createElement("a",{...m,...L,href:P||I,onClick:E||i?e:w,ref:nk(v,b),target:l,"data-discover":!T&&n==="render"?"true":void 0});return S&&!T?A.createElement(A.Fragment,null,_,A.createElement(ZN,{page:I})):_});J0.displayName="Link";var Bo=A.forwardRef(function({"aria-current":e="page",caseSensitive:n=!1,className:r="",end:s=!1,style:i,to:o,viewTransition:a,children:l,...d},h){let f=qc(o,{relative:d.relative}),m=Kn(),v=A.useContext(zh),{navigator:R,basename:T}=A.useContext(br),P=v!=null&&dk(f)&&a===!0,E=R.encodeLocation?R.encodeLocation(f).pathname:f.pathname,I=m.pathname,S=v&&v.navigation&&v.navigation.location?v.navigation.location.pathname:null;n||(I=I.toLowerCase(),S=S?S.toLowerCase():null,E=E.toLowerCase()),S&&T&&(S=fs(S,T)||S);const b=E!=="/"&&E.endsWith("/")?E.length-1:E.length;let L=I===E||!s&&I.startsWith(E)&&I.charAt(b)==="/",B=S!=null&&(S===E||!s&&S.startsWith(E)&&S.charAt(E.length)==="/"),w={isActive:L,isPending:B,isTransitioning:P},_=L?e:void 0,y;typeof r=="function"?y=r(w):y=[r,L?"active":null,B?"pending":null,P?"transitioning":null].filter(Boolean).join(" ");let N=typeof i=="function"?i(w):i;return A.createElement(J0,{...d,"aria-current":_,className:y,ref:h,style:N,to:o,viewTransition:a},typeof l=="function"?l(w):l)});Bo.displayName="NavLink";var sk=A.forwardRef(({discover:t="render",fetcherKey:e,navigate:n,reloadDocument:r,replace:s,state:i,method:o=od,action:a,onSubmit:l,relative:d,preventScrollReset:h,viewTransition:f,...m},v)=>{let R=ck(),T=uk(a,{relative:d}),P=o.toLowerCase()==="get"?"get":"post",E=typeof a=="string"&&X0.test(a),I=S=>{if(l&&l(S),S.defaultPrevented)return;S.preventDefault();let b=S.nativeEvent.submitter,L=(b==null?void 0:b.getAttribute("formmethod"))||o;R(b||S.currentTarget,{fetcherKey:e,method:L,navigate:n,replace:s,state:i,relative:d,preventScrollReset:h,viewTransition:f})};return A.createElement("form",{ref:v,method:P,action:T,onSubmit:r?l:I,...m,"data-discover":!E&&t==="render"?"true":void 0})});sk.displayName="Form";function ik(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function Z0(t){let e=A.useContext(Wa);return ht(e,ik(t)),e}function ok(t,{target:e,replace:n,state:r,preventScrollReset:s,relative:i,viewTransition:o}={}){let a=Ka(),l=Kn(),d=qc(t,{relative:i});return A.useCallback(h=>{if(FN(h,e)){h.preventDefault();let f=n!==void 0?n:xc(l)===xc(d);a(t,{replace:f,state:r,preventScrollReset:s,relative:i,viewTransition:o})}},[l,a,d,n,r,e,t,s,i,o])}var ak=0,lk=()=>`__${String(++ak)}__`;function ck(){let{router:t}=Z0("useSubmit"),{basename:e}=A.useContext(br),n=RN();return A.useCallback(async(r,s={})=>{let{action:i,method:o,encType:a,formData:l,body:d}=BN(r,e);if(s.navigate===!1){let h=s.fetcherKey||lk();await t.fetch(h,n,s.action||i,{preventScrollReset:s.preventScrollReset,formData:l,body:d,formMethod:s.method||o,formEncType:s.encType||a,flushSync:s.flushSync})}else await t.navigate(s.action||i,{preventScrollReset:s.preventScrollReset,formData:l,body:d,formMethod:s.method||o,formEncType:s.encType||a,replace:s.replace,state:s.state,fromRouteId:n,flushSync:s.flushSync,viewTransition:s.viewTransition})},[t,e,n])}function uk(t,{relative:e}={}){let{basename:n}=A.useContext(br),r=A.useContext(Cr);ht(r,"useFormAction must be used inside a RouteContext");let[s]=r.matches.slice(-1),i={...qc(t||".",{relative:e})},o=Kn();if(t==null){i.search=o.search;let a=new URLSearchParams(i.search),l=a.getAll("index");if(l.some(h=>h==="")){a.delete("index"),l.filter(f=>f).forEach(f=>a.append("index",f));let h=a.toString();i.search=h?`?${h}`:""}}return(!t||t===".")&&s.route.index&&(i.search=i.search?i.search.replace(/^\?/,"?index&"):"?index"),n!=="/"&&(i.pathname=i.pathname==="/"?n:ls([n,i.pathname])),xc(i)}function dk(t,{relative:e}={}){let n=A.useContext(z0);ht(n!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:r}=Z0("useViewTransitionState"),s=qc(t,{relative:e});if(!n.isTransitioning)return!1;let i=fs(n.currentLocation.pathname,r)||n.currentLocation.pathname,o=fs(n.nextLocation.pathname,r)||n.nextLocation.pathname;return Kd(s.pathname,o)!=null||Kd(s.pathname,i)!=null}const hk=()=>{};var Bw={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eS=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let s=t.charCodeAt(r);s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=s&63|128):(s&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=s&63|128):(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=s&63|128)}return e},fk=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const s=t[n++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=t[n++];e[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=t[n++],o=t[n++],a=t[n++],l=((s&7)<<18|(i&63)<<12|(o&63)<<6|a&63)-65536;e[r++]=String.fromCharCode(55296+(l>>10)),e[r++]=String.fromCharCode(56320+(l&1023))}else{const i=t[n++],o=t[n++];e[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|o&63)}}return e.join("")},tS={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<t.length;s+=3){const i=t[s],o=s+1<t.length,a=o?t[s+1]:0,l=s+2<t.length,d=l?t[s+2]:0,h=i>>2,f=(i&3)<<4|a>>4;let m=(a&15)<<2|d>>6,v=d&63;l||(v=64,o||(m=64)),r.push(n[h],n[f],n[m],n[v])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(eS(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):fk(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<t.length;){const i=n[t.charAt(s++)],a=s<t.length?n[t.charAt(s)]:0;++s;const d=s<t.length?n[t.charAt(s)]:64;++s;const f=s<t.length?n[t.charAt(s)]:64;if(++s,i==null||a==null||d==null||f==null)throw new pk;const m=i<<2|a>>4;if(r.push(m),d!==64){const v=a<<4&240|d>>2;if(r.push(v),f!==64){const R=d<<6&192|f;r.push(R)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class pk extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const mk=function(t){const e=eS(t);return tS.encodeByteArray(e,!0)},Yd=function(t){return mk(t).replace(/\./g,"")},nS=function(t){try{return tS.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rS(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gk=()=>rS().__FIREBASE_DEFAULTS__,yk=()=>{if(typeof process>"u"||typeof Bw>"u")return;const t=Bw.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},vk=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&nS(t[1]);return e&&JSON.parse(e)},Hh=()=>{try{return hk()||gk()||yk()||vk()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},sS=t=>{var e,n;return(n=(e=Hh())==null?void 0:e.emulatorHosts)==null?void 0:n[t]},iS=t=>{const e=sS(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},oS=()=>{var t;return(t=Hh())==null?void 0:t.config},aS=t=>{var e;return(e=Hh())==null?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _k{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vi(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function xy(t){return(await fetch(t,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lS(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",s=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o={iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}},...t};return[Yd(JSON.stringify(n)),Yd(JSON.stringify(o)),""].join(".")}const Yl={};function wk(){const t={prod:[],emulator:[]};for(const e of Object.keys(Yl))Yl[e]?t.emulator.push(e):t.prod.push(e);return t}function Ek(t){let e=document.getElementById(t),n=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),n=!0),{created:n,element:e}}let zw=!1;function Ty(t,e){if(typeof window>"u"||typeof document>"u"||!vi(window.location.host)||Yl[t]===e||Yl[t]||zw)return;Yl[t]=e;function n(m){return`__firebase__banner__${m}`}const r="__firebase__banner",i=wk().prod.length>0;function o(){const m=document.getElementById(r);m&&m.remove()}function a(m){m.style.display="flex",m.style.background="#7faaf0",m.style.position="fixed",m.style.bottom="5px",m.style.left="5px",m.style.padding=".5em",m.style.borderRadius="5px",m.style.alignItems="center"}function l(m,v){m.setAttribute("width","24"),m.setAttribute("id",v),m.setAttribute("height","24"),m.setAttribute("viewBox","0 0 24 24"),m.setAttribute("fill","none"),m.style.marginLeft="-6px"}function d(){const m=document.createElement("span");return m.style.cursor="pointer",m.style.marginLeft="16px",m.style.fontSize="24px",m.innerHTML=" &times;",m.onclick=()=>{zw=!0,o()},m}function h(m,v){m.setAttribute("id",v),m.innerText="Learn more",m.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",m.setAttribute("target","__blank"),m.style.paddingLeft="5px",m.style.textDecoration="underline"}function f(){const m=Ek(r),v=n("text"),R=document.getElementById(v)||document.createElement("span"),T=n("learnmore"),P=document.getElementById(T)||document.createElement("a"),E=n("preprendIcon"),I=document.getElementById(E)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(m.created){const S=m.element;a(S),h(P,T);const b=d();l(I,E),S.append(I,R,P,b),document.body.appendChild(S)}i?(R.innerText="Preview backend disconnected.",I.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(I.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,R.innerText="Preview backend running in this workspace."),R.setAttribute("id",v)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",f):f()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lt(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function Ik(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Lt())}function cS(){var e;const t=(e=Hh())==null?void 0:e.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function xk(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function uS(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function Tk(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function Sk(){const t=Lt();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function dS(){return!cS()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function hS(){return!cS()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function Sy(){try{return typeof indexedDB=="object"}catch{return!1}}function fS(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{var i;e(((i=s.error)==null?void 0:i.message)||"")}}catch(n){e(n)}})}function bk(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ck="FirebaseError";class ur extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=Ck,Object.setPrototypeOf(this,ur.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Eo.prototype.create)}}class Eo{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},s=`${this.service}/${e}`,i=this.errors[e],o=i?Ak(i,r):"Error",a=`${this.serviceName}: ${o} (${s}).`;return new ur(s,a,r)}}function Ak(t,e){return t.replace(Rk,(n,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const Rk=/\{\$([^}]+)}/g;function Pk(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function ps(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const s of n){if(!r.includes(s))return!1;const i=t[s],o=e[s];if(qw(i)&&qw(o)){if(!ps(i,o))return!1}else if(i!==o)return!1}for(const s of r)if(!n.includes(s))return!1;return!0}function qw(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hc(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(s=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function kl(t){const e={};return t.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[s,i]=r.split("=");e[decodeURIComponent(s)]=decodeURIComponent(i)}}),e}function Dl(t){const e=t.indexOf("?");if(!e)return"";const n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}function Nk(t,e){const n=new kk(t,e);return n.subscribe.bind(n)}class kk{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let s;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");Dk(e,["next","error","complete"])?s=e:s={next:e,error:n,complete:r},s.next===void 0&&(s.next=yp),s.error===void 0&&(s.error=yp),s.complete===void 0&&(s.complete=yp);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function Dk(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function yp(){}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jk=1e3,Ok=2,Vk=4*60*60*1e3,Lk=.5;function Hw(t,e=jk,n=Ok){const r=e*Math.pow(n,t),s=Math.round(Lk*r*(Math.random()-.5)*2);return Math.min(Vk,r+s)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ye(t){return t&&t._delegate?t._delegate:t}class cr{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ki="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mk{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new _k;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:n});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){const n=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),r=(e==null?void 0:e.optional)??!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(s){if(r)return null;throw s}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(Uk(e))try{this.getOrInitializeService({instanceIdentifier:ki})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(n);try{const i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(e=ki){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=ki){return this.instances.has(e)}getOptions(e=ki){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[i,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(i);r===a&&o.resolve(s)}return s}onInit(e,n){const r=this.normalizeInstanceIdentifier(n),s=this.onInitCallbacks.get(r)??new Set;s.add(e),this.onInitCallbacks.set(r,s);const i=this.instances.get(r);return i&&e(i,r),()=>{s.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const s of r)try{s(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:Fk(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=ki){return this.component?this.component.multipleInstances?e:ki:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function Fk(t){return t===ki?void 0:t}function Uk(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $k{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new Mk(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ve;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Ve||(Ve={}));const Bk={debug:Ve.DEBUG,verbose:Ve.VERBOSE,info:Ve.INFO,warn:Ve.WARN,error:Ve.ERROR,silent:Ve.SILENT},zk=Ve.INFO,qk={[Ve.DEBUG]:"log",[Ve.VERBOSE]:"log",[Ve.INFO]:"info",[Ve.WARN]:"warn",[Ve.ERROR]:"error"},Hk=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),s=qk[e];if(s)console[s](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Wh{constructor(e){this.name=e,this._logLevel=zk,this._logHandler=Hk,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Ve))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?Bk[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Ve.DEBUG,...e),this._logHandler(this,Ve.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Ve.VERBOSE,...e),this._logHandler(this,Ve.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Ve.INFO,...e),this._logHandler(this,Ve.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Ve.WARN,...e),this._logHandler(this,Ve.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Ve.ERROR,...e),this._logHandler(this,Ve.ERROR,...e)}}const Wk=(t,e)=>e.some(n=>t instanceof n);let Ww,Gw;function Gk(){return Ww||(Ww=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Kk(){return Gw||(Gw=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const pS=new WeakMap,Um=new WeakMap,mS=new WeakMap,vp=new WeakMap,by=new WeakMap;function Qk(t){const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("success",i),t.removeEventListener("error",o)},i=()=>{n(ni(t.result)),s()},o=()=>{r(t.error),s()};t.addEventListener("success",i),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&pS.set(n,t)}).catch(()=>{}),by.set(e,t),e}function Yk(t){if(Um.has(t))return;const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",o),t.removeEventListener("abort",o)},i=()=>{n(),s()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",i),t.addEventListener("error",o),t.addEventListener("abort",o)});Um.set(t,e)}let $m={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return Um.get(t);if(e==="objectStoreNames")return t.objectStoreNames||mS.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return ni(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function Xk(t){$m=t($m)}function Jk(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(_p(this),e,...n);return mS.set(r,e.sort?e.sort():[e]),ni(r)}:Kk().includes(t)?function(...e){return t.apply(_p(this),e),ni(pS.get(this))}:function(...e){return ni(t.apply(_p(this),e))}}function Zk(t){return typeof t=="function"?Jk(t):(t instanceof IDBTransaction&&Yk(t),Wk(t,Gk())?new Proxy(t,$m):t)}function ni(t){if(t instanceof IDBRequest)return Qk(t);if(vp.has(t))return vp.get(t);const e=Zk(t);return e!==t&&(vp.set(t,e),by.set(e,t)),e}const _p=t=>by.get(t);function gS(t,e,{blocked:n,upgrade:r,blocking:s,terminated:i}={}){const o=indexedDB.open(t,e),a=ni(o);return r&&o.addEventListener("upgradeneeded",l=>{r(ni(o.result),l.oldVersion,l.newVersion,ni(o.transaction),l)}),n&&o.addEventListener("blocked",l=>n(l.oldVersion,l.newVersion,l)),a.then(l=>{i&&l.addEventListener("close",()=>i()),s&&l.addEventListener("versionchange",d=>s(d.oldVersion,d.newVersion,d))}).catch(()=>{}),a}const eD=["get","getKey","getAll","getAllKeys","count"],tD=["put","add","delete","clear"],wp=new Map;function Kw(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(wp.get(e))return wp.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,s=tD.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(s||eD.includes(n)))return;const i=async function(o,...a){const l=this.transaction(o,s?"readwrite":"readonly");let d=l.store;return r&&(d=d.index(a.shift())),(await Promise.all([d[n](...a),s&&l.done]))[0]};return wp.set(e,i),i}Xk(t=>({...t,get:(e,n,r)=>Kw(e,n)||t.get(e,n,r),has:(e,n)=>!!Kw(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nD{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(rD(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function rD(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Bm="@firebase/app",Qw="0.14.5";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ms=new Wh("@firebase/app"),sD="@firebase/app-compat",iD="@firebase/analytics-compat",oD="@firebase/analytics",aD="@firebase/app-check-compat",lD="@firebase/app-check",cD="@firebase/auth",uD="@firebase/auth-compat",dD="@firebase/database",hD="@firebase/data-connect",fD="@firebase/database-compat",pD="@firebase/functions",mD="@firebase/functions-compat",gD="@firebase/installations",yD="@firebase/installations-compat",vD="@firebase/messaging",_D="@firebase/messaging-compat",wD="@firebase/performance",ED="@firebase/performance-compat",ID="@firebase/remote-config",xD="@firebase/remote-config-compat",TD="@firebase/storage",SD="@firebase/storage-compat",bD="@firebase/firestore",CD="@firebase/ai",AD="@firebase/firestore-compat",RD="firebase",PD="12.5.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zm="[DEFAULT]",ND={[Bm]:"fire-core",[sD]:"fire-core-compat",[oD]:"fire-analytics",[iD]:"fire-analytics-compat",[lD]:"fire-app-check",[aD]:"fire-app-check-compat",[cD]:"fire-auth",[uD]:"fire-auth-compat",[dD]:"fire-rtdb",[hD]:"fire-data-connect",[fD]:"fire-rtdb-compat",[pD]:"fire-fn",[mD]:"fire-fn-compat",[gD]:"fire-iid",[yD]:"fire-iid-compat",[vD]:"fire-fcm",[_D]:"fire-fcm-compat",[wD]:"fire-perf",[ED]:"fire-perf-compat",[ID]:"fire-rc",[xD]:"fire-rc-compat",[TD]:"fire-gcs",[SD]:"fire-gcs-compat",[bD]:"fire-fst",[AD]:"fire-fst-compat",[CD]:"fire-vertex","fire-js":"fire-js",[RD]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xd=new Map,kD=new Map,qm=new Map;function Yw(t,e){try{t.container.addComponent(e)}catch(n){ms.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function xr(t){const e=t.name;if(qm.has(e))return ms.debug(`There were multiple attempts to register component ${e}.`),!1;qm.set(e,t);for(const n of Xd.values())Yw(n,t);for(const n of kD.values())Yw(n,t);return!0}function _i(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function er(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DD={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},ri=new Eo("app","Firebase",DD);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jD{constructor(e,n,r){this._isDeleted=!1,this._options={...e},this._config={...n},this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new cr("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw ri.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Io=PD;function Cy(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r={name:zm,automaticDataCollectionEnabled:!0,...e},s=r.name;if(typeof s!="string"||!s)throw ri.create("bad-app-name",{appName:String(s)});if(n||(n=oS()),!n)throw ri.create("no-options");const i=Xd.get(s);if(i){if(ps(n,i.options)&&ps(r,i.config))return i;throw ri.create("duplicate-app",{appName:s})}const o=new $k(s);for(const l of qm.values())o.addComponent(l);const a=new jD(n,r,o);return Xd.set(s,a),a}function Gh(t=zm){const e=Xd.get(t);if(!e&&t===zm&&oS())return Cy();if(!e)throw ri.create("no-app",{appName:t});return e}function Dn(t,e,n){let r=ND[t]??t;n&&(r+=`-${n}`);const s=r.match(/\s|\//),i=e.match(/\s|\//);if(s||i){const o=[`Unable to register library "${r}" with version "${e}":`];s&&o.push(`library name "${r}" contains illegal characters (whitespace or "/")`),s&&i&&o.push("and"),i&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),ms.warn(o.join(" "));return}xr(new cr(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OD="firebase-heartbeat-database",VD=1,Tc="firebase-heartbeat-store";let Ep=null;function yS(){return Ep||(Ep=gS(OD,VD,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Tc)}catch(n){console.warn(n)}}}}).catch(t=>{throw ri.create("idb-open",{originalErrorMessage:t.message})})),Ep}async function LD(t){try{const n=(await yS()).transaction(Tc),r=await n.objectStore(Tc).get(vS(t));return await n.done,r}catch(e){if(e instanceof ur)ms.warn(e.message);else{const n=ri.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});ms.warn(n.message)}}}async function Xw(t,e){try{const r=(await yS()).transaction(Tc,"readwrite");await r.objectStore(Tc).put(e,vS(t)),await r.done}catch(n){if(n instanceof ur)ms.warn(n.message);else{const r=ri.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});ms.warn(r.message)}}}function vS(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MD=1024,FD=30;class UD{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new BD(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=Jw();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)==null?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(o=>o.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:s}),this._heartbeatsCache.heartbeats.length>FD){const o=zD(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){ms.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=Jw(),{heartbeatsToSend:r,unsentEntries:s}=$D(this._heartbeatsCache.heartbeats),i=Yd(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(n){return ms.warn(n),""}}}function Jw(){return new Date().toISOString().substring(0,10)}function $D(t,e=MD){const n=[];let r=t.slice();for(const s of t){const i=n.find(o=>o.agent===s.agent);if(i){if(i.dates.push(s.date),Zw(n)>e){i.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),Zw(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class BD{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Sy()?fS().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await LD(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return Xw(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return Xw(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function Zw(t){return Yd(JSON.stringify({version:2,heartbeats:t})).length}function zD(t){if(t.length===0)return-1;let e=0,n=t[0].date;for(let r=1;r<t.length;r++)t[r].date<n&&(n=t[r].date,e=r);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qD(t){xr(new cr("platform-logger",e=>new nD(e),"PRIVATE")),xr(new cr("heartbeat",e=>new UD(e),"PRIVATE")),Dn(Bm,Qw,t),Dn(Bm,Qw,"esm2020"),Dn("fire-js","")}qD("");var HD="firebase",WD="12.5.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Dn(HD,WD,"app");function _S(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const GD=_S,wS=new Eo("auth","Firebase",_S());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jd=new Wh("@firebase/auth");function KD(t,...e){Jd.logLevel<=Ve.WARN&&Jd.warn(`Auth (${Io}): ${t}`,...e)}function ld(t,...e){Jd.logLevel<=Ve.ERROR&&Jd.error(`Auth (${Io}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tr(t,...e){throw Ay(t,...e)}function Hr(t,...e){return Ay(t,...e)}function ES(t,e,n){const r={...GD(),[e]:n};return new Eo("auth","Firebase",r).create(e,{appName:t.name})}function si(t){return ES(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Ay(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return wS.create(t,...e)}function ve(t,e,...n){if(!t)throw Ay(e,...n)}function ss(t){const e="INTERNAL ASSERTION FAILED: "+t;throw ld(e),new Error(e)}function gs(t,e){t||ss(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hm(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.href)||""}function QD(){return eE()==="http:"||eE()==="https:"}function eE(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function YD(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(QD()||uS()||"connection"in navigator)?navigator.onLine:!0}function XD(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wc{constructor(e,n){this.shortDelay=e,this.longDelay=n,gs(n>e,"Short delay should be less than long delay!"),this.isMobile=Ik()||Tk()}get(){return YD()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ry(t,e){gs(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IS{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;ss("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;ss("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;ss("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JD={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZD=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],ej=new Wc(3e4,6e4);function xo(t,e){return t.tenantId&&!e.tenantId?{...e,tenantId:t.tenantId}:e}async function wi(t,e,n,r,s={}){return xS(t,s,async()=>{let i={},o={};r&&(e==="GET"?o=r:i={body:JSON.stringify(r)});const a=Hc({key:t.config.apiKey,...o}).slice(1),l=await t._getAdditionalHeaders();l["Content-Type"]="application/json",t.languageCode&&(l["X-Firebase-Locale"]=t.languageCode);const d={method:e,headers:l,...i};return xk()||(d.referrerPolicy="no-referrer"),t.emulatorConfig&&vi(t.emulatorConfig.host)&&(d.credentials="include"),IS.fetch()(await TS(t,t.config.apiHost,n,a),d)})}async function xS(t,e,n){t._canInitEmulator=!1;const r={...JD,...e};try{const s=new nj(t),i=await Promise.race([n(),s.promise]);s.clearNetworkTimeout();const o=await i.json();if("needConfirmation"in o)throw Vu(t,"account-exists-with-different-credential",o);if(i.ok&&!("errorMessage"in o))return o;{const a=i.ok?o.errorMessage:o.error.message,[l,d]=a.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw Vu(t,"credential-already-in-use",o);if(l==="EMAIL_EXISTS")throw Vu(t,"email-already-in-use",o);if(l==="USER_DISABLED")throw Vu(t,"user-disabled",o);const h=r[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(d)throw ES(t,h,d);Tr(t,h)}}catch(s){if(s instanceof ur)throw s;Tr(t,"network-request-failed",{message:String(s)})}}async function Kh(t,e,n,r,s={}){const i=await wi(t,e,n,r,s);return"mfaPendingCredential"in i&&Tr(t,"multi-factor-auth-required",{_serverResponse:i}),i}async function TS(t,e,n,r){const s=`${e}${n}?${r}`,i=t,o=i.config.emulator?Ry(t.config,s):`${t.config.apiScheme}://${s}`;return ZD.includes(n)&&(await i._persistenceManagerAvailable,i._getPersistenceType()==="COOKIE")?i._getPersistence()._getFinalTarget(o).toString():o}function tj(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class nj{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(Hr(this.auth,"network-request-failed")),ej.get())})}}function Vu(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const s=Hr(t,e,r);return s.customData._tokenResponse=n,s}function tE(t){return t!==void 0&&t.enterprise!==void 0}class rj{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const n of this.recaptchaEnforcementState)if(n.provider&&n.provider===e)return tj(n.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function sj(t,e){return wi(t,"GET","/v2/recaptchaConfig",xo(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ij(t,e){return wi(t,"POST","/v1/accounts:delete",e)}async function Zd(t,e){return wi(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xl(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function oj(t,e=!1){const n=Ye(t),r=await n.getIdToken(e),s=Py(r);ve(s&&s.exp&&s.auth_time&&s.iat,n.auth,"internal-error");const i=typeof s.firebase=="object"?s.firebase:void 0,o=i==null?void 0:i.sign_in_provider;return{claims:s,token:r,authTime:Xl(Ip(s.auth_time)),issuedAtTime:Xl(Ip(s.iat)),expirationTime:Xl(Ip(s.exp)),signInProvider:o||null,signInSecondFactor:(i==null?void 0:i.sign_in_second_factor)||null}}function Ip(t){return Number(t)*1e3}function Py(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return ld("JWT malformed, contained fewer than 3 sections"),null;try{const s=nS(n);return s?JSON.parse(s):(ld("Failed to decode base64 JWT payload"),null)}catch(s){return ld("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function nE(t){const e=Py(t);return ve(e,"internal-error"),ve(typeof e.exp<"u","internal-error"),ve(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Sc(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof ur&&aj(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function aj({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lj{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const r=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wm{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=Xl(this.lastLoginAt),this.creationTime=Xl(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function eh(t){var f;const e=t.auth,n=await t.getIdToken(),r=await Sc(t,Zd(e,{idToken:n}));ve(r==null?void 0:r.users.length,e,"internal-error");const s=r.users[0];t._notifyReloadListener(s);const i=(f=s.providerUserInfo)!=null&&f.length?SS(s.providerUserInfo):[],o=uj(t.providerData,i),a=t.isAnonymous,l=!(t.email&&s.passwordHash)&&!(o!=null&&o.length),d=a?l:!1,h={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:o,metadata:new Wm(s.createdAt,s.lastLoginAt),isAnonymous:d};Object.assign(t,h)}async function cj(t){const e=Ye(t);await eh(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function uj(t,e){return[...t.filter(r=>!e.some(s=>s.providerId===r.providerId)),...e]}function SS(t){return t.map(({providerId:e,...n})=>({providerId:e,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function dj(t,e){const n=await xS(t,{},async()=>{const r=Hc({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:i}=t.config,o=await TS(t,s,"/v1/token",`key=${i}`),a=await t._getAdditionalHeaders();a["Content-Type"]="application/x-www-form-urlencoded";const l={method:"POST",headers:a,body:r};return t.emulatorConfig&&vi(t.emulatorConfig.host)&&(l.credentials="include"),IS.fetch()(o,l)});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function hj(t,e){return wi(t,"POST","/v2/accounts:revokeToken",xo(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fa{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){ve(e.idToken,"internal-error"),ve(typeof e.idToken<"u","internal-error"),ve(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):nE(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){ve(e.length!==0,"internal-error");const n=nE(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(ve(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:s,expiresIn:i}=await dj(e,n);this.updateTokensAndExpiration(r,s,Number(i))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:s,expirationTime:i}=n,o=new fa;return r&&(ve(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),s&&(ve(typeof s=="string","internal-error",{appName:e}),o.accessToken=s),i&&(ve(typeof i=="number","internal-error",{appName:e}),o.expirationTime=i),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new fa,this.toJSON())}_performRefresh(){return ss("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rs(t,e){ve(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class vr{constructor({uid:e,auth:n,stsTokenManager:r,...s}){this.providerId="firebase",this.proactiveRefresh=new lj(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=n,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new Wm(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const n=await Sc(this,this.stsTokenManager.getToken(this.auth,e));return ve(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return oj(this,e)}reload(){return cj(this)}_assign(e){this!==e&&(ve(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>({...n})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new vr({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return n.metadata._copy(this.metadata),n}_onReload(e){ve(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await eh(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(er(this.auth.app))return Promise.reject(si(this.auth));const e=await this.getIdToken();return await Sc(this,ij(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){const r=n.displayName??void 0,s=n.email??void 0,i=n.phoneNumber??void 0,o=n.photoURL??void 0,a=n.tenantId??void 0,l=n._redirectEventId??void 0,d=n.createdAt??void 0,h=n.lastLoginAt??void 0,{uid:f,emailVerified:m,isAnonymous:v,providerData:R,stsTokenManager:T}=n;ve(f&&T,e,"internal-error");const P=fa.fromJSON(this.name,T);ve(typeof f=="string",e,"internal-error"),Rs(r,e.name),Rs(s,e.name),ve(typeof m=="boolean",e,"internal-error"),ve(typeof v=="boolean",e,"internal-error"),Rs(i,e.name),Rs(o,e.name),Rs(a,e.name),Rs(l,e.name),Rs(d,e.name),Rs(h,e.name);const E=new vr({uid:f,auth:e,email:s,emailVerified:m,displayName:r,isAnonymous:v,photoURL:o,phoneNumber:i,tenantId:a,stsTokenManager:P,createdAt:d,lastLoginAt:h});return R&&Array.isArray(R)&&(E.providerData=R.map(I=>({...I}))),l&&(E._redirectEventId=l),E}static async _fromIdTokenResponse(e,n,r=!1){const s=new fa;s.updateFromServerResponse(n);const i=new vr({uid:n.localId,auth:e,stsTokenManager:s,isAnonymous:r});return await eh(i),i}static async _fromGetAccountInfoResponse(e,n,r){const s=n.users[0];ve(s.localId!==void 0,"internal-error");const i=s.providerUserInfo!==void 0?SS(s.providerUserInfo):[],o=!(s.email&&s.passwordHash)&&!(i!=null&&i.length),a=new fa;a.updateFromIdToken(r);const l=new vr({uid:s.localId,auth:e,stsTokenManager:a,isAnonymous:o}),d={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:i,metadata:new Wm(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(i!=null&&i.length)};return Object.assign(l,d),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rE=new Map;function is(t){gs(t instanceof Function,"Expected a class definition");let e=rE.get(t);return e?(gs(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,rE.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bS{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}bS.type="NONE";const sE=bS;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cd(t,e,n){return`firebase:${t}:${e}:${n}`}class pa{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:s,name:i}=this.auth;this.fullUserKey=cd(this.userKey,s.apiKey,i),this.fullPersistenceKey=cd("persistence",s.apiKey,i),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const n=await Zd(this.auth,{idToken:e}).catch(()=>{});return n?vr._fromGetAccountInfoResponse(this.auth,n,e):null}return vr._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new pa(is(sE),e,r);const s=(await Promise.all(n.map(async d=>{if(await d._isAvailable())return d}))).filter(d=>d);let i=s[0]||is(sE);const o=cd(r,e.config.apiKey,e.name);let a=null;for(const d of n)try{const h=await d._get(o);if(h){let f;if(typeof h=="string"){const m=await Zd(e,{idToken:h}).catch(()=>{});if(!m)break;f=await vr._fromGetAccountInfoResponse(e,m,h)}else f=vr._fromJSON(e,h);d!==i&&(a=f),i=d;break}}catch{}const l=s.filter(d=>d._shouldAllowMigration);return!i._shouldAllowMigration||!l.length?new pa(i,e,r):(i=l[0],a&&await i._set(o,a.toJSON()),await Promise.all(n.map(async d=>{if(d!==i)try{await d._remove(o)}catch{}})),new pa(i,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iE(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(PS(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(CS(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(kS(e))return"Blackberry";if(DS(e))return"Webos";if(AS(e))return"Safari";if((e.includes("chrome/")||RS(e))&&!e.includes("edge/"))return"Chrome";if(NS(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function CS(t=Lt()){return/firefox\//i.test(t)}function AS(t=Lt()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function RS(t=Lt()){return/crios\//i.test(t)}function PS(t=Lt()){return/iemobile/i.test(t)}function NS(t=Lt()){return/android/i.test(t)}function kS(t=Lt()){return/blackberry/i.test(t)}function DS(t=Lt()){return/webos/i.test(t)}function Ny(t=Lt()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function fj(t=Lt()){var e;return Ny(t)&&!!((e=window.navigator)!=null&&e.standalone)}function pj(){return Sk()&&document.documentMode===10}function jS(t=Lt()){return Ny(t)||NS(t)||DS(t)||kS(t)||/windows phone/i.test(t)||PS(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OS(t,e=[]){let n;switch(t){case"Browser":n=iE(Lt());break;case"Worker":n=`${iE(Lt())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${Io}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mj{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=i=>new Promise((o,a)=>{try{const l=e(i);o(l)}catch(l){a(l)}});r.onAbort=n,this.queue.push(r);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const s of n)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function gj(t,e={}){return wi(t,"GET","/v2/passwordPolicy",xo(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yj=6;class vj{constructor(e){var r;const n=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=n.minPasswordLength??yj,n.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=n.maxPasswordLength),n.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=n.containsLowercaseCharacter),n.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=n.containsUppercaseCharacter),n.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=n.containsNumericCharacter),n.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=n.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=((r=e.allowedNonAlphanumericCharacters)==null?void 0:r.join(""))??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const n={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,n),this.validatePasswordCharacterOptions(e,n),n.isValid&&(n.isValid=n.meetsMinPasswordLength??!0),n.isValid&&(n.isValid=n.meetsMaxPasswordLength??!0),n.isValid&&(n.isValid=n.containsLowercaseLetter??!0),n.isValid&&(n.isValid=n.containsUppercaseLetter??!0),n.isValid&&(n.isValid=n.containsNumericCharacter??!0),n.isValid&&(n.isValid=n.containsNonAlphanumericCharacter??!0),n}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),s&&(n.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let s=0;s<e.length;s++)r=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,s,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _j{constructor(e,n,r,s){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new oE(this),this.idTokenSubscription=new oE(this),this.beforeStateQueue=new mj(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=wS,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion,this._persistenceManagerAvailable=new Promise(i=>this._resolvePersistenceManagerAvailable=i)}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=is(n)),this._initializationPromise=this.queue(async()=>{var r,s,i;if(!this._deleted&&(this.persistenceManager=await pa.create(this,e),(r=this._resolvePersistenceManagerAvailable)==null||r.call(this),!this._deleted)){if((s=this._popupRedirectResolver)!=null&&s._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((i=this.currentUser)==null?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await Zd(this,{idToken:e}),r=await vr._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(r)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var i;if(er(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(a,a))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let r=n,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(i=this.redirectUser)==null?void 0:i._redirectEventId,a=r==null?void 0:r._redirectEventId,l=await this.tryRedirectSignIn(e);(!o||o===a)&&(l!=null&&l.user)&&(r=l.user,s=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(r)}catch(o){r=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return ve(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await eh(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=XD()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(er(this.app))return Promise.reject(si(this));const n=e?Ye(e):null;return n&&ve(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&ve(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return er(this.app)?Promise.reject(si(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return er(this.app)?Promise.reject(si(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(is(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await gj(this),n=new vj(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Eo("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),await hj(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)==null?void 0:e.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&is(e)||this._popupRedirectResolver;ve(n,this,"argument-error"),this.redirectPersistenceManager=await pa.create(this,[is(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)==null?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)==null?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=((n=this.currentUser)==null?void 0:n.uid)??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,s){if(this._deleted)return()=>{};const i=typeof n=="function"?n:n.next.bind(n);let o=!1;const a=this._isInitialized?Promise.resolve():this._initializationPromise;if(ve(a,this,"internal-error"),a.then(()=>{o||i(this.currentUser)}),typeof n=="function"){const l=e.addObserver(n,r,s);return()=>{o=!0,l()}}else{const l=e.addObserver(n);return()=>{o=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return ve(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=OS(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var s;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const n=await((s=this.heartbeatServiceProvider.getImmediate({optional:!0}))==null?void 0:s.getHeartbeatsHeader());n&&(e["X-Firebase-Client"]=n);const r=await this._getAppCheckToken();return r&&(e["X-Firebase-AppCheck"]=r),e}async _getAppCheckToken(){var n;if(er(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await((n=this.appCheckServiceProvider.getImmediate({optional:!0}))==null?void 0:n.getToken());return e!=null&&e.error&&KD(`Error while retrieving App Check token: ${e.error}`),e==null?void 0:e.token}}function Qa(t){return Ye(t)}class oE{constructor(e){this.auth=e,this.observer=null,this.addObserver=Nk(n=>this.observer=n)}get next(){return ve(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Qh={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function wj(t){Qh=t}function VS(t){return Qh.loadJS(t)}function Ej(){return Qh.recaptchaEnterpriseScript}function Ij(){return Qh.gapiScript}function xj(t){return`__${t}${Math.floor(Math.random()*1e6)}`}class Tj{constructor(){this.enterprise=new Sj}ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}class Sj{ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}const bj="recaptcha-enterprise",LS="NO_RECAPTCHA";class Cj{constructor(e){this.type=bj,this.auth=Qa(e)}async verify(e="verify",n=!1){async function r(i){if(!n){if(i.tenantId==null&&i._agentRecaptchaConfig!=null)return i._agentRecaptchaConfig.siteKey;if(i.tenantId!=null&&i._tenantRecaptchaConfigs[i.tenantId]!==void 0)return i._tenantRecaptchaConfigs[i.tenantId].siteKey}return new Promise(async(o,a)=>{sj(i,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(l=>{if(l.recaptchaKey===void 0)a(new Error("recaptcha Enterprise site key undefined"));else{const d=new rj(l);return i.tenantId==null?i._agentRecaptchaConfig=d:i._tenantRecaptchaConfigs[i.tenantId]=d,o(d.siteKey)}}).catch(l=>{a(l)})})}function s(i,o,a){const l=window.grecaptcha;tE(l)?l.enterprise.ready(()=>{l.enterprise.execute(i,{action:e}).then(d=>{o(d)}).catch(()=>{o(LS)})}):a(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new Tj().execute("siteKey",{action:"verify"}):new Promise((i,o)=>{r(this.auth).then(a=>{if(!n&&tE(window.grecaptcha))s(a,i,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let l=Ej();l.length!==0&&(l+=a),VS(l).then(()=>{s(a,i,o)}).catch(d=>{o(d)})}}).catch(a=>{o(a)})})}}async function aE(t,e,n,r=!1,s=!1){const i=new Cj(t);let o;if(s)o=LS;else try{o=await i.verify(n)}catch{o=await i.verify(n,!0)}const a={...e};if(n==="mfaSmsEnrollment"||n==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in a){const l=a.phoneEnrollmentInfo.phoneNumber,d=a.phoneEnrollmentInfo.recaptchaToken;Object.assign(a,{phoneEnrollmentInfo:{phoneNumber:l,recaptchaToken:d,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in a){const l=a.phoneSignInInfo.recaptchaToken;Object.assign(a,{phoneSignInInfo:{recaptchaToken:l,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return a}return r?Object.assign(a,{captchaResp:o}):Object.assign(a,{captchaResponse:o}),Object.assign(a,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(a,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),a}async function lE(t,e,n,r,s){var i;if((i=t._getRecaptchaConfig())!=null&&i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const o=await aE(t,e,n,n==="getOobCode");return r(t,o)}else return r(t,e).catch(async o=>{if(o.code==="auth/missing-recaptcha-token"){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const a=await aE(t,e,n,n==="getOobCode");return r(t,a)}else return Promise.reject(o)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Aj(t,e){const n=_i(t,"auth");if(n.isInitialized()){const s=n.getImmediate(),i=n.getOptions();if(ps(i,e??{}))return s;Tr(s,"already-initialized")}return n.initialize({options:e})}function Rj(t,e){const n=(e==null?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(is);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function Pj(t,e,n){const r=Qa(t);ve(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const s=!1,i=MS(e),{host:o,port:a}=Nj(e),l=a===null?"":`:${a}`,d={url:`${i}//${o}${l}/`},h=Object.freeze({host:o,port:a,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:s})});if(!r._canInitEmulator){ve(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),ve(ps(d,r.config.emulator)&&ps(h,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=d,r.emulatorConfig=h,r.settings.appVerificationDisabledForTesting=!0,vi(o)?(xy(`${i}//${o}${l}`),Ty("Auth",!0)):kj()}function MS(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function Nj(t){const e=MS(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(r);if(s){const i=s[1];return{host:i,port:cE(r.substr(i.length+1))}}else{const[i,o]=r.split(":");return{host:i,port:cE(o)}}}function cE(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function kj(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ky{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return ss("not implemented")}_getIdTokenResponse(e){return ss("not implemented")}_linkToIdToken(e,n){return ss("not implemented")}_getReauthenticationResolver(e){return ss("not implemented")}}async function Dj(t,e){return wi(t,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function jj(t,e){return Kh(t,"POST","/v1/accounts:signInWithPassword",xo(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Oj(t,e){return Kh(t,"POST","/v1/accounts:signInWithEmailLink",xo(t,e))}async function Vj(t,e){return Kh(t,"POST","/v1/accounts:signInWithEmailLink",xo(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bc extends ky{constructor(e,n,r,s=null){super("password",r),this._email=e,this._password=n,this._tenantId=s}static _fromEmailAndPassword(e,n){return new bc(e,n,"password")}static _fromEmailAndCode(e,n,r=null){return new bc(e,n,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;if(n!=null&&n.email&&(n!=null&&n.password)){if(n.signInMethod==="password")return this._fromEmailAndPassword(n.email,n.password);if(n.signInMethod==="emailLink")return this._fromEmailAndCode(n.email,n.password,n.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const n={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return lE(e,n,"signInWithPassword",jj);case"emailLink":return Oj(e,{email:this._email,oobCode:this._password});default:Tr(e,"internal-error")}}async _linkToIdToken(e,n){switch(this.signInMethod){case"password":const r={idToken:n,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return lE(e,r,"signUpPassword",Dj);case"emailLink":return Vj(e,{idToken:n,email:this._email,oobCode:this._password});default:Tr(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ma(t,e){return Kh(t,"POST","/v1/accounts:signInWithIdp",xo(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lj="http://localhost";class so extends ky{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new so(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):Tr("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:s,...i}=n;if(!r||!s)return null;const o=new so(r,s);return o.idToken=i.idToken||void 0,o.accessToken=i.accessToken||void 0,o.secret=i.secret,o.nonce=i.nonce,o.pendingToken=i.pendingToken||null,o}_getIdTokenResponse(e){const n=this.buildRequest();return ma(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,ma(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,ma(e,n)}buildRequest(){const e={requestUri:Lj,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=Hc(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mj(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function Fj(t){const e=kl(Dl(t)).link,n=e?kl(Dl(e)).deep_link_id:null,r=kl(Dl(t)).deep_link_id;return(r?kl(Dl(r)).link:null)||r||n||e||t}class Dy{constructor(e){const n=kl(Dl(e)),r=n.apiKey??null,s=n.oobCode??null,i=Mj(n.mode??null);ve(r&&s&&i,"argument-error"),this.apiKey=r,this.operation=i,this.code=s,this.continueUrl=n.continueUrl??null,this.languageCode=n.lang??null,this.tenantId=n.tenantId??null}static parseLink(e){const n=Fj(e);try{return new Dy(n)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ya{constructor(){this.providerId=Ya.PROVIDER_ID}static credential(e,n){return bc._fromEmailAndPassword(e,n)}static credentialWithLink(e,n){const r=Dy.parseLink(n);return ve(r,"argument-error"),bc._fromEmailAndCode(e,r.code,r.tenantId)}}Ya.PROVIDER_ID="password";Ya.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Ya.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FS{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gc extends FS{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ms extends Gc{constructor(){super("facebook.com")}static credential(e){return so._fromParams({providerId:Ms.PROVIDER_ID,signInMethod:Ms.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ms.credentialFromTaggedObject(e)}static credentialFromError(e){return Ms.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ms.credential(e.oauthAccessToken)}catch{return null}}}Ms.FACEBOOK_SIGN_IN_METHOD="facebook.com";Ms.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fs extends Gc{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return so._fromParams({providerId:Fs.PROVIDER_ID,signInMethod:Fs.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return Fs.credentialFromTaggedObject(e)}static credentialFromError(e){return Fs.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return Fs.credential(n,r)}catch{return null}}}Fs.GOOGLE_SIGN_IN_METHOD="google.com";Fs.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Us extends Gc{constructor(){super("github.com")}static credential(e){return so._fromParams({providerId:Us.PROVIDER_ID,signInMethod:Us.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Us.credentialFromTaggedObject(e)}static credentialFromError(e){return Us.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Us.credential(e.oauthAccessToken)}catch{return null}}}Us.GITHUB_SIGN_IN_METHOD="github.com";Us.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $s extends Gc{constructor(){super("twitter.com")}static credential(e,n){return so._fromParams({providerId:$s.PROVIDER_ID,signInMethod:$s.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return $s.credentialFromTaggedObject(e)}static credentialFromError(e){return $s.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return $s.credential(n,r)}catch{return null}}}$s.TWITTER_SIGN_IN_METHOD="twitter.com";$s.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Aa{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,s=!1){const i=await vr._fromIdTokenResponse(e,r,s),o=uE(r);return new Aa({user:i,providerId:o,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const s=uE(r);return new Aa({user:e,providerId:s,_tokenResponse:r,operationType:n})}}function uE(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class th extends ur{constructor(e,n,r,s){super(n.code,n.message),this.operationType=r,this.user=s,Object.setPrototypeOf(this,th.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,s){return new th(e,n,r,s)}}function US(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?th._fromErrorAndOperation(t,i,e,r):i})}async function Uj(t,e,n=!1){const r=await Sc(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return Aa._forOperation(t,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function $j(t,e,n=!1){const{auth:r}=t;if(er(r.app))return Promise.reject(si(r));const s="reauthenticate";try{const i=await Sc(t,US(r,s,e,t),n);ve(i.idToken,r,"internal-error");const o=Py(i.idToken);ve(o,r,"internal-error");const{sub:a}=o;return ve(t.uid===a,r,"user-mismatch"),Aa._forOperation(t,s,i)}catch(i){throw(i==null?void 0:i.code)==="auth/user-not-found"&&Tr(r,"user-mismatch"),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function $S(t,e,n=!1){if(er(t.app))return Promise.reject(si(t));const r="signIn",s=await US(t,r,e),i=await Aa._fromIdTokenResponse(t,r,s);return n||await t._updateCurrentUser(i.user),i}async function Bj(t,e){return $S(Qa(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function zj(t){const e=Qa(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}function qj(t,e,n){return er(t.app)?Promise.reject(si(t)):Bj(Ye(t),Ya.credential(e,n)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&zj(t),r})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hj(t,e){return Ye(t).setPersistence(e)}function Wj(t,e,n,r){return Ye(t).onIdTokenChanged(e,n,r)}function Gj(t,e,n){return Ye(t).beforeAuthStateChanged(e,n)}function jy(t,e,n,r){return Ye(t).onAuthStateChanged(e,n,r)}function Kj(t){return Ye(t).signOut()}const nh="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BS{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(nh,"1"),this.storage.removeItem(nh),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qj=1e3,Yj=10;class zS extends BS{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=jS(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),s=this.localCache[n];r!==s&&e(n,s,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((o,a,l)=>{this.notifyListeners(o,l)});return}const r=e.key;n?this.detachListener():this.stopPolling();const s=()=>{const o=this.storage.getItem(r);!n&&this.localCache[r]===o||this.notifyListeners(r,o)},i=this.storage.getItem(r);pj()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,Yj):s()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},Qj)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}zS.type="LOCAL";const qS=zS;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HS extends BS{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}HS.type="SESSION";const WS=HS;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xj(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yh{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(s=>s.isListeningto(e));if(n)return n;const r=new Yh(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:s,data:i}=n.data,o=this.handlersMap[s];if(!(o!=null&&o.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:s});const a=Array.from(o).map(async d=>d(n.origin,i)),l=await Xj(a);n.ports[0].postMessage({status:"done",eventId:r,eventType:s,response:l})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Yh.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Oy(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jj{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let i,o;return new Promise((a,l)=>{const d=Oy("",20);s.port1.start();const h=setTimeout(()=>{l(new Error("unsupported_event"))},r);o={messageChannel:s,onMessage(f){const m=f;if(m.data.eventId===d)switch(m.data.status){case"ack":clearTimeout(h),i=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),a(m.data.response);break;default:clearTimeout(h),clearTimeout(i),l(new Error("invalid_response"));break}}},this.handlers.add(o),s.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:d,data:n},[s.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wr(){return window}function Zj(t){Wr().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GS(){return typeof Wr().WorkerGlobalScope<"u"&&typeof Wr().importScripts=="function"}async function e2(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function t2(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)==null?void 0:t.controller)||null}function n2(){return GS()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KS="firebaseLocalStorageDb",r2=1,rh="firebaseLocalStorage",QS="fbase_key";class Kc{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function Xh(t,e){return t.transaction([rh],e?"readwrite":"readonly").objectStore(rh)}function s2(){const t=indexedDB.deleteDatabase(KS);return new Kc(t).toPromise()}function Gm(){const t=indexedDB.open(KS,r2);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(rh,{keyPath:QS})}catch(s){n(s)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(rh)?e(r):(r.close(),await s2(),e(await Gm()))})})}async function dE(t,e,n){const r=Xh(t,!0).put({[QS]:e,value:n});return new Kc(r).toPromise()}async function i2(t,e){const n=Xh(t,!1).get(e),r=await new Kc(n).toPromise();return r===void 0?null:r.value}function hE(t,e){const n=Xh(t,!0).delete(e);return new Kc(n).toPromise()}const o2=800,a2=3;class YS{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Gm(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>a2)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return GS()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Yh._getInstance(n2()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var n,r;if(this.activeServiceWorker=await e2(),!this.activeServiceWorker)return;this.sender=new Jj(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&(n=e[0])!=null&&n.fulfilled&&(r=e[0])!=null&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||t2()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Gm();return await dE(e,nh,"1"),await hE(e,nh),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>dE(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>i2(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>hE(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const i=Xh(s,!1).getAll();return new Kc(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;if(e.length!==0)for(const{fbase_key:s,value:i}of e)r.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(i)&&(this.notifyListeners(s,i),n.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!r.has(s)&&(this.notifyListeners(s,null),n.push(s));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),o2)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}YS.type="LOCAL";const l2=YS;new Wc(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function c2(t,e){return e?is(e):(ve(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vy extends ky{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return ma(e,this._buildIdpRequest())}_linkToIdToken(e,n){return ma(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return ma(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function u2(t){return $S(t.auth,new Vy(t),t.bypassAuthState)}function d2(t){const{auth:e,user:n}=t;return ve(n,e,"internal-error"),$j(n,new Vy(t),t.bypassAuthState)}async function h2(t){const{auth:e,user:n}=t;return ve(n,e,"internal-error"),Uj(n,new Vy(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XS{constructor(e,n,r,s,i=!1){this.auth=e,this.resolver=r,this.user=s,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:s,tenantId:i,error:o,type:a}=e;if(o){this.reject(o);return}const l={auth:this.auth,requestUri:n,sessionId:r,tenantId:i||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(l))}catch(d){this.reject(d)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return u2;case"linkViaPopup":case"linkViaRedirect":return h2;case"reauthViaPopup":case"reauthViaRedirect":return d2;default:Tr(this.auth,"internal-error")}}resolve(e){gs(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){gs(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const f2=new Wc(2e3,1e4);class ia extends XS{constructor(e,n,r,s,i){super(e,n,s,i),this.provider=r,this.authWindow=null,this.pollId=null,ia.currentPopupAction&&ia.currentPopupAction.cancel(),ia.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return ve(e,this.auth,"internal-error"),e}async onExecution(){gs(this.filter.length===1,"Popup operations only handle one event");const e=Oy();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(Hr(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)==null?void 0:e.associatedEvent)||null}cancel(){this.reject(Hr(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,ia.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,r;if((r=(n=this.authWindow)==null?void 0:n.window)!=null&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Hr(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,f2.get())};e()}}ia.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const p2="pendingRedirect",ud=new Map;class m2 extends XS{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=ud.get(this.auth._key());if(!e){try{const r=await g2(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}ud.set(this.auth._key(),e)}return this.bypassAuthState||ud.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function g2(t,e){const n=_2(e),r=v2(t);if(!await r._isAvailable())return!1;const s=await r._get(n)==="true";return await r._remove(n),s}function y2(t,e){ud.set(t._key(),e)}function v2(t){return is(t._redirectPersistence)}function _2(t){return cd(p2,t.config.apiKey,t.name)}async function w2(t,e,n=!1){if(er(t.app))return Promise.reject(si(t));const r=Qa(t),s=c2(r,e),o=await new m2(r,s,n).execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const E2=10*60*1e3;class I2{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!x2(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!JS(e)){const s=((r=e.error.code)==null?void 0:r.split("auth/")[1])||"internal-error";n.onError(Hr(this.auth,s))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=E2&&this.cachedEventUids.clear(),this.cachedEventUids.has(fE(e))}saveEventToCache(e){this.cachedEventUids.add(fE(e)),this.lastProcessedEventTime=Date.now()}}function fE(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function JS({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function x2(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return JS(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function T2(t,e={}){return wi(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const S2=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,b2=/^https?/;async function C2(t){if(t.config.emulator)return;const{authorizedDomains:e}=await T2(t);for(const n of e)try{if(A2(n))return}catch{}Tr(t,"unauthorized-domain")}function A2(t){const e=Hm(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&o.hostname===r}if(!b2.test(n))return!1;if(S2.test(t))return r===t;const s=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const R2=new Wc(3e4,6e4);function pE(){const t=Wr().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function P2(t){return new Promise((e,n)=>{var s,i,o;function r(){pE(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{pE(),n(Hr(t,"network-request-failed"))},timeout:R2.get()})}if((i=(s=Wr().gapi)==null?void 0:s.iframes)!=null&&i.Iframe)e(gapi.iframes.getContext());else if((o=Wr().gapi)!=null&&o.load)r();else{const a=xj("iframefcb");return Wr()[a]=()=>{gapi.load?r():n(Hr(t,"network-request-failed"))},VS(`${Ij()}?onload=${a}`).catch(l=>n(l))}}).catch(e=>{throw dd=null,e})}let dd=null;function N2(t){return dd=dd||P2(t),dd}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const k2=new Wc(5e3,15e3),D2="__/auth/iframe",j2="emulator/auth/iframe",O2={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},V2=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function L2(t){const e=t.config;ve(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?Ry(e,j2):`https://${t.config.authDomain}/${D2}`,r={apiKey:e.apiKey,appName:t.name,v:Io},s=V2.get(t.config.apiHost);s&&(r.eid=s);const i=t._getFrameworks();return i.length&&(r.fw=i.join(",")),`${n}?${Hc(r).slice(1)}`}async function M2(t){const e=await N2(t),n=Wr().gapi;return ve(n,t,"internal-error"),e.open({where:document.body,url:L2(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:O2,dontclear:!0},r=>new Promise(async(s,i)=>{await r.restyle({setHideOnLeave:!1});const o=Hr(t,"network-request-failed"),a=Wr().setTimeout(()=>{i(o)},k2.get());function l(){Wr().clearTimeout(a),s(r)}r.ping(l).then(l,()=>{i(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const F2={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},U2=500,$2=600,B2="_blank",z2="http://localhost";class mE{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function q2(t,e,n,r=U2,s=$2){const i=Math.max((window.screen.availHeight-s)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let a="";const l={...F2,width:r.toString(),height:s.toString(),top:i,left:o},d=Lt().toLowerCase();n&&(a=RS(d)?B2:n),CS(d)&&(e=e||z2,l.scrollbars="yes");const h=Object.entries(l).reduce((m,[v,R])=>`${m}${v}=${R},`,"");if(fj(d)&&a!=="_self")return H2(e||"",a),new mE(null);const f=window.open(e||"",a,h);ve(f,t,"popup-blocked");try{f.focus()}catch{}return new mE(f)}function H2(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const W2="__/auth/handler",G2="emulator/auth/handler",K2=encodeURIComponent("fac");async function gE(t,e,n,r,s,i){ve(t.config.authDomain,t,"auth-domain-config-required"),ve(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:Io,eventId:s};if(e instanceof FS){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",Pk(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[h,f]of Object.entries({}))o[h]=f}if(e instanceof Gc){const h=e.getScopes().filter(f=>f!=="");h.length>0&&(o.scopes=h.join(","))}t.tenantId&&(o.tid=t.tenantId);const a=o;for(const h of Object.keys(a))a[h]===void 0&&delete a[h];const l=await t._getAppCheckToken(),d=l?`#${K2}=${encodeURIComponent(l)}`:"";return`${Q2(t)}?${Hc(a).slice(1)}${d}`}function Q2({config:t}){return t.emulator?Ry(t,G2):`https://${t.authDomain}/${W2}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xp="webStorageSupport";class Y2{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=WS,this._completeRedirectFn=w2,this._overrideRedirectResult=y2}async _openPopup(e,n,r,s){var o;gs((o=this.eventManagers[e._key()])==null?void 0:o.manager,"_initialize() not called before _openPopup()");const i=await gE(e,n,r,Hm(),s);return q2(e,i,Oy())}async _openRedirect(e,n,r,s){await this._originValidation(e);const i=await gE(e,n,r,Hm(),s);return Zj(i),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:s,promise:i}=this.eventManagers[n];return s?Promise.resolve(s):(gs(i,"If manager is not set, promise should be"),i)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await M2(e),r=new I2(e);return n.register("authEvent",s=>(ve(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:r.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(xp,{type:xp},s=>{var o;const i=(o=s==null?void 0:s[0])==null?void 0:o[xp];i!==void 0&&n(!!i),Tr(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=C2(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return jS()||AS()||Ny()}}const X2=Y2;var yE="@firebase/auth",vE="1.11.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J2{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)==null?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){ve(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Z2(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function eO(t){xr(new cr("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=r.options;ve(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const l={apiKey:o,authDomain:a,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:OS(t)},d=new _j(r,s,i,l);return Rj(d,n),d},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),xr(new cr("auth-internal",e=>{const n=Qa(e.getProvider("auth").getImmediate());return(r=>new J2(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),Dn(yE,vE,Z2(t)),Dn(yE,vE,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tO=5*60,nO=aS("authIdTokenMaxAge")||tO;let _E=null;const rO=t=>async e=>{const n=e&&await e.getIdTokenResult(),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>nO)return;const s=n==null?void 0:n.token;_E!==s&&(_E=s,await fetch(t,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function ZS(t=Gh()){const e=_i(t,"auth");if(e.isInitialized())return e.getImmediate();const n=Aj(t,{popupRedirectResolver:X2,persistence:[l2,qS,WS]}),r=aS("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(r,location.origin);if(location.origin===i.origin){const o=rO(i.toString());Gj(n,o,()=>o(n.currentUser)),Wj(n,a=>o(a))}}const s=sS("auth");return s&&Pj(n,`http://${s}`),n}function sO(){var t;return((t=document.getElementsByTagName("head"))==null?void 0:t[0])??document}wj({loadJS(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=s=>{const i=Hr("internal-error");i.customData=s,n(i)},r.type="text/javascript",r.charset="UTF-8",sO().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});eO("Browser");var wE=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var ii,eb;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(w,_){function y(){}y.prototype=_.prototype,w.F=_.prototype,w.prototype=new y,w.prototype.constructor=w,w.D=function(N,D,j){for(var k=Array(arguments.length-2),K=2;K<arguments.length;K++)k[K-2]=arguments[K];return _.prototype[D].apply(N,k)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(r,n),r.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(w,_,y){y||(y=0);const N=Array(16);if(typeof _=="string")for(var D=0;D<16;++D)N[D]=_.charCodeAt(y++)|_.charCodeAt(y++)<<8|_.charCodeAt(y++)<<16|_.charCodeAt(y++)<<24;else for(D=0;D<16;++D)N[D]=_[y++]|_[y++]<<8|_[y++]<<16|_[y++]<<24;_=w.g[0],y=w.g[1],D=w.g[2];let j=w.g[3],k;k=_+(j^y&(D^j))+N[0]+3614090360&4294967295,_=y+(k<<7&4294967295|k>>>25),k=j+(D^_&(y^D))+N[1]+3905402710&4294967295,j=_+(k<<12&4294967295|k>>>20),k=D+(y^j&(_^y))+N[2]+606105819&4294967295,D=j+(k<<17&4294967295|k>>>15),k=y+(_^D&(j^_))+N[3]+3250441966&4294967295,y=D+(k<<22&4294967295|k>>>10),k=_+(j^y&(D^j))+N[4]+4118548399&4294967295,_=y+(k<<7&4294967295|k>>>25),k=j+(D^_&(y^D))+N[5]+1200080426&4294967295,j=_+(k<<12&4294967295|k>>>20),k=D+(y^j&(_^y))+N[6]+2821735955&4294967295,D=j+(k<<17&4294967295|k>>>15),k=y+(_^D&(j^_))+N[7]+4249261313&4294967295,y=D+(k<<22&4294967295|k>>>10),k=_+(j^y&(D^j))+N[8]+1770035416&4294967295,_=y+(k<<7&4294967295|k>>>25),k=j+(D^_&(y^D))+N[9]+2336552879&4294967295,j=_+(k<<12&4294967295|k>>>20),k=D+(y^j&(_^y))+N[10]+4294925233&4294967295,D=j+(k<<17&4294967295|k>>>15),k=y+(_^D&(j^_))+N[11]+2304563134&4294967295,y=D+(k<<22&4294967295|k>>>10),k=_+(j^y&(D^j))+N[12]+1804603682&4294967295,_=y+(k<<7&4294967295|k>>>25),k=j+(D^_&(y^D))+N[13]+4254626195&4294967295,j=_+(k<<12&4294967295|k>>>20),k=D+(y^j&(_^y))+N[14]+2792965006&4294967295,D=j+(k<<17&4294967295|k>>>15),k=y+(_^D&(j^_))+N[15]+1236535329&4294967295,y=D+(k<<22&4294967295|k>>>10),k=_+(D^j&(y^D))+N[1]+4129170786&4294967295,_=y+(k<<5&4294967295|k>>>27),k=j+(y^D&(_^y))+N[6]+3225465664&4294967295,j=_+(k<<9&4294967295|k>>>23),k=D+(_^y&(j^_))+N[11]+643717713&4294967295,D=j+(k<<14&4294967295|k>>>18),k=y+(j^_&(D^j))+N[0]+3921069994&4294967295,y=D+(k<<20&4294967295|k>>>12),k=_+(D^j&(y^D))+N[5]+3593408605&4294967295,_=y+(k<<5&4294967295|k>>>27),k=j+(y^D&(_^y))+N[10]+38016083&4294967295,j=_+(k<<9&4294967295|k>>>23),k=D+(_^y&(j^_))+N[15]+3634488961&4294967295,D=j+(k<<14&4294967295|k>>>18),k=y+(j^_&(D^j))+N[4]+3889429448&4294967295,y=D+(k<<20&4294967295|k>>>12),k=_+(D^j&(y^D))+N[9]+568446438&4294967295,_=y+(k<<5&4294967295|k>>>27),k=j+(y^D&(_^y))+N[14]+3275163606&4294967295,j=_+(k<<9&4294967295|k>>>23),k=D+(_^y&(j^_))+N[3]+4107603335&4294967295,D=j+(k<<14&4294967295|k>>>18),k=y+(j^_&(D^j))+N[8]+1163531501&4294967295,y=D+(k<<20&4294967295|k>>>12),k=_+(D^j&(y^D))+N[13]+2850285829&4294967295,_=y+(k<<5&4294967295|k>>>27),k=j+(y^D&(_^y))+N[2]+4243563512&4294967295,j=_+(k<<9&4294967295|k>>>23),k=D+(_^y&(j^_))+N[7]+1735328473&4294967295,D=j+(k<<14&4294967295|k>>>18),k=y+(j^_&(D^j))+N[12]+2368359562&4294967295,y=D+(k<<20&4294967295|k>>>12),k=_+(y^D^j)+N[5]+4294588738&4294967295,_=y+(k<<4&4294967295|k>>>28),k=j+(_^y^D)+N[8]+2272392833&4294967295,j=_+(k<<11&4294967295|k>>>21),k=D+(j^_^y)+N[11]+1839030562&4294967295,D=j+(k<<16&4294967295|k>>>16),k=y+(D^j^_)+N[14]+4259657740&4294967295,y=D+(k<<23&4294967295|k>>>9),k=_+(y^D^j)+N[1]+2763975236&4294967295,_=y+(k<<4&4294967295|k>>>28),k=j+(_^y^D)+N[4]+1272893353&4294967295,j=_+(k<<11&4294967295|k>>>21),k=D+(j^_^y)+N[7]+4139469664&4294967295,D=j+(k<<16&4294967295|k>>>16),k=y+(D^j^_)+N[10]+3200236656&4294967295,y=D+(k<<23&4294967295|k>>>9),k=_+(y^D^j)+N[13]+681279174&4294967295,_=y+(k<<4&4294967295|k>>>28),k=j+(_^y^D)+N[0]+3936430074&4294967295,j=_+(k<<11&4294967295|k>>>21),k=D+(j^_^y)+N[3]+3572445317&4294967295,D=j+(k<<16&4294967295|k>>>16),k=y+(D^j^_)+N[6]+76029189&4294967295,y=D+(k<<23&4294967295|k>>>9),k=_+(y^D^j)+N[9]+3654602809&4294967295,_=y+(k<<4&4294967295|k>>>28),k=j+(_^y^D)+N[12]+3873151461&4294967295,j=_+(k<<11&4294967295|k>>>21),k=D+(j^_^y)+N[15]+530742520&4294967295,D=j+(k<<16&4294967295|k>>>16),k=y+(D^j^_)+N[2]+3299628645&4294967295,y=D+(k<<23&4294967295|k>>>9),k=_+(D^(y|~j))+N[0]+4096336452&4294967295,_=y+(k<<6&4294967295|k>>>26),k=j+(y^(_|~D))+N[7]+1126891415&4294967295,j=_+(k<<10&4294967295|k>>>22),k=D+(_^(j|~y))+N[14]+2878612391&4294967295,D=j+(k<<15&4294967295|k>>>17),k=y+(j^(D|~_))+N[5]+4237533241&4294967295,y=D+(k<<21&4294967295|k>>>11),k=_+(D^(y|~j))+N[12]+1700485571&4294967295,_=y+(k<<6&4294967295|k>>>26),k=j+(y^(_|~D))+N[3]+2399980690&4294967295,j=_+(k<<10&4294967295|k>>>22),k=D+(_^(j|~y))+N[10]+4293915773&4294967295,D=j+(k<<15&4294967295|k>>>17),k=y+(j^(D|~_))+N[1]+2240044497&4294967295,y=D+(k<<21&4294967295|k>>>11),k=_+(D^(y|~j))+N[8]+1873313359&4294967295,_=y+(k<<6&4294967295|k>>>26),k=j+(y^(_|~D))+N[15]+4264355552&4294967295,j=_+(k<<10&4294967295|k>>>22),k=D+(_^(j|~y))+N[6]+2734768916&4294967295,D=j+(k<<15&4294967295|k>>>17),k=y+(j^(D|~_))+N[13]+1309151649&4294967295,y=D+(k<<21&4294967295|k>>>11),k=_+(D^(y|~j))+N[4]+4149444226&4294967295,_=y+(k<<6&4294967295|k>>>26),k=j+(y^(_|~D))+N[11]+3174756917&4294967295,j=_+(k<<10&4294967295|k>>>22),k=D+(_^(j|~y))+N[2]+718787259&4294967295,D=j+(k<<15&4294967295|k>>>17),k=y+(j^(D|~_))+N[9]+3951481745&4294967295,w.g[0]=w.g[0]+_&4294967295,w.g[1]=w.g[1]+(D+(k<<21&4294967295|k>>>11))&4294967295,w.g[2]=w.g[2]+D&4294967295,w.g[3]=w.g[3]+j&4294967295}r.prototype.v=function(w,_){_===void 0&&(_=w.length);const y=_-this.blockSize,N=this.C;let D=this.h,j=0;for(;j<_;){if(D==0)for(;j<=y;)s(this,w,j),j+=this.blockSize;if(typeof w=="string"){for(;j<_;)if(N[D++]=w.charCodeAt(j++),D==this.blockSize){s(this,N),D=0;break}}else for(;j<_;)if(N[D++]=w[j++],D==this.blockSize){s(this,N),D=0;break}}this.h=D,this.o+=_},r.prototype.A=function(){var w=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);w[0]=128;for(var _=1;_<w.length-8;++_)w[_]=0;_=this.o*8;for(var y=w.length-8;y<w.length;++y)w[y]=_&255,_/=256;for(this.v(w),w=Array(16),_=0,y=0;y<4;++y)for(let N=0;N<32;N+=8)w[_++]=this.g[y]>>>N&255;return w};function i(w,_){var y=a;return Object.prototype.hasOwnProperty.call(y,w)?y[w]:y[w]=_(w)}function o(w,_){this.h=_;const y=[];let N=!0;for(let D=w.length-1;D>=0;D--){const j=w[D]|0;N&&j==_||(y[D]=j,N=!1)}this.g=y}var a={};function l(w){return-128<=w&&w<128?i(w,function(_){return new o([_|0],_<0?-1:0)}):new o([w|0],w<0?-1:0)}function d(w){if(isNaN(w)||!isFinite(w))return f;if(w<0)return P(d(-w));const _=[];let y=1;for(let N=0;w>=y;N++)_[N]=w/y|0,y*=4294967296;return new o(_,0)}function h(w,_){if(w.length==0)throw Error("number format error: empty string");if(_=_||10,_<2||36<_)throw Error("radix out of range: "+_);if(w.charAt(0)=="-")return P(h(w.substring(1),_));if(w.indexOf("-")>=0)throw Error('number format error: interior "-" character');const y=d(Math.pow(_,8));let N=f;for(let j=0;j<w.length;j+=8){var D=Math.min(8,w.length-j);const k=parseInt(w.substring(j,j+D),_);D<8?(D=d(Math.pow(_,D)),N=N.j(D).add(d(k))):(N=N.j(y),N=N.add(d(k)))}return N}var f=l(0),m=l(1),v=l(16777216);t=o.prototype,t.m=function(){if(T(this))return-P(this).m();let w=0,_=1;for(let y=0;y<this.g.length;y++){const N=this.i(y);w+=(N>=0?N:4294967296+N)*_,_*=4294967296}return w},t.toString=function(w){if(w=w||10,w<2||36<w)throw Error("radix out of range: "+w);if(R(this))return"0";if(T(this))return"-"+P(this).toString(w);const _=d(Math.pow(w,6));var y=this;let N="";for(;;){const D=b(y,_).g;y=E(y,D.j(_));let j=((y.g.length>0?y.g[0]:y.h)>>>0).toString(w);if(y=D,R(y))return j+N;for(;j.length<6;)j="0"+j;N=j+N}},t.i=function(w){return w<0?0:w<this.g.length?this.g[w]:this.h};function R(w){if(w.h!=0)return!1;for(let _=0;_<w.g.length;_++)if(w.g[_]!=0)return!1;return!0}function T(w){return w.h==-1}t.l=function(w){return w=E(this,w),T(w)?-1:R(w)?0:1};function P(w){const _=w.g.length,y=[];for(let N=0;N<_;N++)y[N]=~w.g[N];return new o(y,~w.h).add(m)}t.abs=function(){return T(this)?P(this):this},t.add=function(w){const _=Math.max(this.g.length,w.g.length),y=[];let N=0;for(let D=0;D<=_;D++){let j=N+(this.i(D)&65535)+(w.i(D)&65535),k=(j>>>16)+(this.i(D)>>>16)+(w.i(D)>>>16);N=k>>>16,j&=65535,k&=65535,y[D]=k<<16|j}return new o(y,y[y.length-1]&-2147483648?-1:0)};function E(w,_){return w.add(P(_))}t.j=function(w){if(R(this)||R(w))return f;if(T(this))return T(w)?P(this).j(P(w)):P(P(this).j(w));if(T(w))return P(this.j(P(w)));if(this.l(v)<0&&w.l(v)<0)return d(this.m()*w.m());const _=this.g.length+w.g.length,y=[];for(var N=0;N<2*_;N++)y[N]=0;for(N=0;N<this.g.length;N++)for(let D=0;D<w.g.length;D++){const j=this.i(N)>>>16,k=this.i(N)&65535,K=w.i(D)>>>16,Ke=w.i(D)&65535;y[2*N+2*D]+=k*Ke,I(y,2*N+2*D),y[2*N+2*D+1]+=j*Ke,I(y,2*N+2*D+1),y[2*N+2*D+1]+=k*K,I(y,2*N+2*D+1),y[2*N+2*D+2]+=j*K,I(y,2*N+2*D+2)}for(w=0;w<_;w++)y[w]=y[2*w+1]<<16|y[2*w];for(w=_;w<2*_;w++)y[w]=0;return new o(y,0)};function I(w,_){for(;(w[_]&65535)!=w[_];)w[_+1]+=w[_]>>>16,w[_]&=65535,_++}function S(w,_){this.g=w,this.h=_}function b(w,_){if(R(_))throw Error("division by zero");if(R(w))return new S(f,f);if(T(w))return _=b(P(w),_),new S(P(_.g),P(_.h));if(T(_))return _=b(w,P(_)),new S(P(_.g),_.h);if(w.g.length>30){if(T(w)||T(_))throw Error("slowDivide_ only works with positive integers.");for(var y=m,N=_;N.l(w)<=0;)y=L(y),N=L(N);var D=B(y,1),j=B(N,1);for(N=B(N,2),y=B(y,2);!R(N);){var k=j.add(N);k.l(w)<=0&&(D=D.add(y),j=k),N=B(N,1),y=B(y,1)}return _=E(w,D.j(_)),new S(D,_)}for(D=f;w.l(_)>=0;){for(y=Math.max(1,Math.floor(w.m()/_.m())),N=Math.ceil(Math.log(y)/Math.LN2),N=N<=48?1:Math.pow(2,N-48),j=d(y),k=j.j(_);T(k)||k.l(w)>0;)y-=N,j=d(y),k=j.j(_);R(j)&&(j=m),D=D.add(j),w=E(w,k)}return new S(D,w)}t.B=function(w){return b(this,w).h},t.and=function(w){const _=Math.max(this.g.length,w.g.length),y=[];for(let N=0;N<_;N++)y[N]=this.i(N)&w.i(N);return new o(y,this.h&w.h)},t.or=function(w){const _=Math.max(this.g.length,w.g.length),y=[];for(let N=0;N<_;N++)y[N]=this.i(N)|w.i(N);return new o(y,this.h|w.h)},t.xor=function(w){const _=Math.max(this.g.length,w.g.length),y=[];for(let N=0;N<_;N++)y[N]=this.i(N)^w.i(N);return new o(y,this.h^w.h)};function L(w){const _=w.g.length+1,y=[];for(let N=0;N<_;N++)y[N]=w.i(N)<<1|w.i(N-1)>>>31;return new o(y,w.h)}function B(w,_){const y=_>>5;_%=32;const N=w.g.length-y,D=[];for(let j=0;j<N;j++)D[j]=_>0?w.i(j+y)>>>_|w.i(j+y+1)<<32-_:w.i(j+y);return new o(D,w.h)}r.prototype.digest=r.prototype.A,r.prototype.reset=r.prototype.u,r.prototype.update=r.prototype.v,eb=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.B,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=d,o.fromString=h,ii=o}).apply(typeof wE<"u"?wE:typeof self<"u"?self:typeof window<"u"?window:{});var Lu=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var tb,jl,nb,hd,Km,rb,sb,ib;(function(){var t,e=Object.defineProperty;function n(u){u=[typeof globalThis=="object"&&globalThis,u,typeof window=="object"&&window,typeof self=="object"&&self,typeof Lu=="object"&&Lu];for(var p=0;p<u.length;++p){var g=u[p];if(g&&g.Math==Math)return g}throw Error("Cannot find global object")}var r=n(this);function s(u,p){if(p)e:{var g=r;u=u.split(".");for(var C=0;C<u.length-1;C++){var V=u[C];if(!(V in g))break e;g=g[V]}u=u[u.length-1],C=g[u],p=p(C),p!=C&&p!=null&&e(g,u,{configurable:!0,writable:!0,value:p})}}s("Symbol.dispose",function(u){return u||Symbol("Symbol.dispose")}),s("Array.prototype.values",function(u){return u||function(){return this[Symbol.iterator]()}}),s("Object.entries",function(u){return u||function(p){var g=[],C;for(C in p)Object.prototype.hasOwnProperty.call(p,C)&&g.push([C,p[C]]);return g}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var i=i||{},o=this||self;function a(u){var p=typeof u;return p=="object"&&u!=null||p=="function"}function l(u,p,g){return u.call.apply(u.bind,arguments)}function d(u,p,g){return d=l,d.apply(null,arguments)}function h(u,p){var g=Array.prototype.slice.call(arguments,1);return function(){var C=g.slice();return C.push.apply(C,arguments),u.apply(this,C)}}function f(u,p){function g(){}g.prototype=p.prototype,u.Z=p.prototype,u.prototype=new g,u.prototype.constructor=u,u.Ob=function(C,V,F){for(var J=Array(arguments.length-2),Ae=2;Ae<arguments.length;Ae++)J[Ae-2]=arguments[Ae];return p.prototype[V].apply(C,J)}}var m=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?u=>u&&AsyncContext.Snapshot.wrap(u):u=>u;function v(u){const p=u.length;if(p>0){const g=Array(p);for(let C=0;C<p;C++)g[C]=u[C];return g}return[]}function R(u,p){for(let C=1;C<arguments.length;C++){const V=arguments[C];var g=typeof V;if(g=g!="object"?g:V?Array.isArray(V)?"array":g:"null",g=="array"||g=="object"&&typeof V.length=="number"){g=u.length||0;const F=V.length||0;u.length=g+F;for(let J=0;J<F;J++)u[g+J]=V[J]}else u.push(V)}}class T{constructor(p,g){this.i=p,this.j=g,this.h=0,this.g=null}get(){let p;return this.h>0?(this.h--,p=this.g,this.g=p.next,p.next=null):p=this.i(),p}}function P(u){o.setTimeout(()=>{throw u},0)}function E(){var u=w;let p=null;return u.g&&(p=u.g,u.g=u.g.next,u.g||(u.h=null),p.next=null),p}class I{constructor(){this.h=this.g=null}add(p,g){const C=S.get();C.set(p,g),this.h?this.h.next=C:this.g=C,this.h=C}}var S=new T(()=>new b,u=>u.reset());class b{constructor(){this.next=this.g=this.h=null}set(p,g){this.h=p,this.g=g,this.next=null}reset(){this.next=this.g=this.h=null}}let L,B=!1,w=new I,_=()=>{const u=Promise.resolve(void 0);L=()=>{u.then(y)}};function y(){for(var u;u=E();){try{u.h.call(u.g)}catch(g){P(g)}var p=S;p.j(u),p.h<100&&(p.h++,u.next=p.g,p.g=u)}B=!1}function N(){this.u=this.u,this.C=this.C}N.prototype.u=!1,N.prototype.dispose=function(){this.u||(this.u=!0,this.N())},N.prototype[Symbol.dispose]=function(){this.dispose()},N.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function D(u,p){this.type=u,this.g=this.target=p,this.defaultPrevented=!1}D.prototype.h=function(){this.defaultPrevented=!0};var j=function(){if(!o.addEventListener||!Object.defineProperty)return!1;var u=!1,p=Object.defineProperty({},"passive",{get:function(){u=!0}});try{const g=()=>{};o.addEventListener("test",g,p),o.removeEventListener("test",g,p)}catch{}return u}();function k(u){return/^[\s\xa0]*$/.test(u)}function K(u,p){D.call(this,u?u.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,u&&this.init(u,p)}f(K,D),K.prototype.init=function(u,p){const g=this.type=u.type,C=u.changedTouches&&u.changedTouches.length?u.changedTouches[0]:null;this.target=u.target||u.srcElement,this.g=p,p=u.relatedTarget,p||(g=="mouseover"?p=u.fromElement:g=="mouseout"&&(p=u.toElement)),this.relatedTarget=p,C?(this.clientX=C.clientX!==void 0?C.clientX:C.pageX,this.clientY=C.clientY!==void 0?C.clientY:C.pageY,this.screenX=C.screenX||0,this.screenY=C.screenY||0):(this.clientX=u.clientX!==void 0?u.clientX:u.pageX,this.clientY=u.clientY!==void 0?u.clientY:u.pageY,this.screenX=u.screenX||0,this.screenY=u.screenY||0),this.button=u.button,this.key=u.key||"",this.ctrlKey=u.ctrlKey,this.altKey=u.altKey,this.shiftKey=u.shiftKey,this.metaKey=u.metaKey,this.pointerId=u.pointerId||0,this.pointerType=u.pointerType,this.state=u.state,this.i=u,u.defaultPrevented&&K.Z.h.call(this)},K.prototype.h=function(){K.Z.h.call(this);const u=this.i;u.preventDefault?u.preventDefault():u.returnValue=!1};var Ke="closure_listenable_"+(Math.random()*1e6|0),Ft=0;function dn(u,p,g,C,V){this.listener=u,this.proxy=null,this.src=p,this.type=g,this.capture=!!C,this.ha=V,this.key=++Ft,this.da=this.fa=!1}function Z(u){u.da=!0,u.listener=null,u.proxy=null,u.src=null,u.ha=null}function de(u,p,g){for(const C in u)p.call(g,u[C],C,u)}function pe(u,p){for(const g in u)p.call(void 0,u[g],g,u)}function Re(u){const p={};for(const g in u)p[g]=u[g];return p}const Xe="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Dt(u,p){let g,C;for(let V=1;V<arguments.length;V++){C=arguments[V];for(g in C)u[g]=C[g];for(let F=0;F<Xe.length;F++)g=Xe[F],Object.prototype.hasOwnProperty.call(C,g)&&(u[g]=C[g])}}function U(u){this.src=u,this.g={},this.h=0}U.prototype.add=function(u,p,g,C,V){const F=u.toString();u=this.g[F],u||(u=this.g[F]=[],this.h++);const J=ce(u,p,C,V);return J>-1?(p=u[J],g||(p.fa=!1)):(p=new dn(p,this.src,F,!!C,V),p.fa=g,u.push(p)),p};function ne(u,p){const g=p.type;if(g in u.g){var C=u.g[g],V=Array.prototype.indexOf.call(C,p,void 0),F;(F=V>=0)&&Array.prototype.splice.call(C,V,1),F&&(Z(p),u.g[g].length==0&&(delete u.g[g],u.h--))}}function ce(u,p,g,C){for(let V=0;V<u.length;++V){const F=u[V];if(!F.da&&F.listener==p&&F.capture==!!g&&F.ha==C)return V}return-1}var xe="closure_lm_"+(Math.random()*1e6|0),Te={};function je(u,p,g,C,V){if(Array.isArray(p)){for(let F=0;F<p.length;F++)je(u,p[F],g,C,V);return null}return g=se(g),u&&u[Ke]?u.J(p,g,a(C)?!!C.capture:!1,V):we(u,p,g,!1,C,V)}function we(u,p,g,C,V,F){if(!p)throw Error("Invalid event type");const J=a(V)?!!V.capture:!!V;let Ae=He(u);if(Ae||(u[xe]=Ae=new U(u)),g=Ae.add(p,g,C,J,F),g.proxy)return g;if(C=it(),g.proxy=C,C.src=u,C.listener=g,u.addEventListener)j||(V=J),V===void 0&&(V=!1),u.addEventListener(p.toString(),C,V);else if(u.attachEvent)u.attachEvent(Pe(p.toString()),C);else if(u.addListener&&u.removeListener)u.addListener(C);else throw Error("addEventListener and attachEvent are unavailable.");return g}function it(){function u(g){return p.call(u.src,u.listener,g)}const p=Me;return u}function Se(u,p,g,C,V){if(Array.isArray(p))for(var F=0;F<p.length;F++)Se(u,p[F],g,C,V);else C=a(C)?!!C.capture:!!C,g=se(g),u&&u[Ke]?(u=u.i,F=String(p).toString(),F in u.g&&(p=u.g[F],g=ce(p,g,C,V),g>-1&&(Z(p[g]),Array.prototype.splice.call(p,g,1),p.length==0&&(delete u.g[F],u.h--)))):u&&(u=He(u))&&(p=u.g[p.toString()],u=-1,p&&(u=ce(p,g,C,V)),(g=u>-1?p[u]:null)&&ie(g))}function ie(u){if(typeof u!="number"&&u&&!u.da){var p=u.src;if(p&&p[Ke])ne(p.i,u);else{var g=u.type,C=u.proxy;p.removeEventListener?p.removeEventListener(g,C,u.capture):p.detachEvent?p.detachEvent(Pe(g),C):p.addListener&&p.removeListener&&p.removeListener(C),(g=He(p))?(ne(g,u),g.h==0&&(g.src=null,p[xe]=null)):Z(u)}}}function Pe(u){return u in Te?Te[u]:Te[u]="on"+u}function Me(u,p){if(u.da)u=!0;else{p=new K(p,this);const g=u.listener,C=u.ha||u.src;u.fa&&ie(u),u=g.call(C,p)}return u}function He(u){return u=u[xe],u instanceof U?u:null}var H="__closure_events_fn_"+(Math.random()*1e9>>>0);function se(u){return typeof u=="function"?u:(u[H]||(u[H]=function(p){return u.handleEvent(p)}),u[H])}function q(){N.call(this),this.i=new U(this),this.M=this,this.G=null}f(q,N),q.prototype[Ke]=!0,q.prototype.removeEventListener=function(u,p,g,C){Se(this,u,p,g,C)};function re(u,p){var g,C=u.G;if(C)for(g=[];C;C=C.G)g.push(C);if(u=u.M,C=p.type||p,typeof p=="string")p=new D(p,u);else if(p instanceof D)p.target=p.target||u;else{var V=p;p=new D(C,u),Dt(p,V)}V=!0;let F,J;if(g)for(J=g.length-1;J>=0;J--)F=p.g=g[J],V=ae(F,C,!0,p)&&V;if(F=p.g=u,V=ae(F,C,!0,p)&&V,V=ae(F,C,!1,p)&&V,g)for(J=0;J<g.length;J++)F=p.g=g[J],V=ae(F,C,!1,p)&&V}q.prototype.N=function(){if(q.Z.N.call(this),this.i){var u=this.i;for(const p in u.g){const g=u.g[p];for(let C=0;C<g.length;C++)Z(g[C]);delete u.g[p],u.h--}}this.G=null},q.prototype.J=function(u,p,g,C){return this.i.add(String(u),p,!1,g,C)},q.prototype.K=function(u,p,g,C){return this.i.add(String(u),p,!0,g,C)};function ae(u,p,g,C){if(p=u.i.g[String(p)],!p)return!0;p=p.concat();let V=!0;for(let F=0;F<p.length;++F){const J=p[F];if(J&&!J.da&&J.capture==g){const Ae=J.listener,jt=J.ha||J.src;J.fa&&ne(u.i,J),V=Ae.call(jt,C)!==!1&&V}}return V&&!C.defaultPrevented}function ge(u,p){if(typeof u!="function")if(u&&typeof u.handleEvent=="function")u=d(u.handleEvent,u);else throw Error("Invalid listener argument");return Number(p)>2147483647?-1:o.setTimeout(u,p||0)}function _e(u){u.g=ge(()=>{u.g=null,u.i&&(u.i=!1,_e(u))},u.l);const p=u.h;u.h=null,u.m.apply(null,p)}class Fe extends N{constructor(p,g){super(),this.m=p,this.l=g,this.h=null,this.i=!1,this.g=null}j(p){this.h=arguments,this.g?this.i=!0:_e(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Ce(u){N.call(this),this.h=u,this.g={}}f(Ce,N);var ze=[];function De(u){de(u.g,function(p,g){this.g.hasOwnProperty(g)&&ie(p)},u),u.g={}}Ce.prototype.N=function(){Ce.Z.N.call(this),De(this)},Ce.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var be=o.JSON.stringify,M=o.JSON.parse,X=class{stringify(u){return o.JSON.stringify(u,void 0)}parse(u){return o.JSON.parse(u,void 0)}};function te(){}function Ne(){}var nt={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function St(){D.call(this,"d")}f(St,D);function Rr(){D.call(this,"c")}f(Rr,D);var xn={},jn=null;function Zt(){return jn=jn||new q}xn.Ia="serverreachability";function bt(u){D.call(this,xn.Ia,u)}f(bt,D);function Ut(u){const p=Zt();re(p,new bt(p))}xn.STAT_EVENT="statevent";function $t(u,p){D.call(this,xn.STAT_EVENT,u),this.stat=p}f($t,D);function Qe(u){const p=Zt();re(p,new $t(p,u))}xn.Ja="timingevent";function Ct(u,p){D.call(this,xn.Ja,u),this.size=p}f(Ct,D);function Pr(u,p){if(typeof u!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){u()},p)}function dr(){this.g=!0}dr.prototype.ua=function(){this.g=!1};function Is(u,p,g,C,V,F){u.info(function(){if(u.g)if(F){var J="",Ae=F.split("&");for(let rt=0;rt<Ae.length;rt++){var jt=Ae[rt].split("=");if(jt.length>1){const Bt=jt[0];jt=jt[1];const Dr=Bt.split("_");J=Dr.length>=2&&Dr[1]=="type"?J+(Bt+"="+jt+"&"):J+(Bt+"=redacted&")}}}else J=null;else J=F;return"XMLHTTP REQ ("+C+") [attempt "+V+"]: "+p+`
`+g+`
`+J})}function On(u,p,g,C,V,F,J){u.info(function(){return"XMLHTTP RESP ("+C+") [ attempt "+V+"]: "+p+`
`+g+`
`+F+" "+J})}function Yr(u,p,g,C){u.info(function(){return"XMLHTTP TEXT ("+p+"): "+cu(u,g)+(C?" "+C:"")})}function lu(u,p){u.info(function(){return"TIMEOUT: "+p})}dr.prototype.info=function(){};function cu(u,p){if(!u.g)return p;if(!p)return null;try{const F=JSON.parse(p);if(F){for(u=0;u<F.length;u++)if(Array.isArray(F[u])){var g=F[u];if(!(g.length<2)){var C=g[1];if(Array.isArray(C)&&!(C.length<1)){var V=C[0];if(V!="noop"&&V!="stop"&&V!="close")for(let J=1;J<C.length;J++)C[J]=""}}}}return be(F)}catch{return p}}var Ti={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},nl={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},x;function z(){}f(z,te),z.prototype.g=function(){return new XMLHttpRequest},x=new z;function Y(u){return encodeURIComponent(String(u))}function ue(u){var p=1;u=u.split(":");const g=[];for(;p>0&&u.length;)g.push(u.shift()),p--;return u.length&&g.push(u.join(":")),g}function me(u,p,g,C){this.j=u,this.i=p,this.l=g,this.S=C||1,this.V=new Ce(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new Ge}function Ge(){this.i=null,this.g="",this.h=!1}var Nr={},Qn={};function Yn(u,p,g){u.M=1,u.A=uu(kr(p)),u.u=g,u.R=!0,At(u,null)}function At(u,p){u.F=Date.now(),Xr(u),u.B=kr(u.A);var g=u.B,C=u.S;Array.isArray(C)||(C=[String(C)]),i_(g.i,"t",C),u.C=0,g=u.j.L,u.h=new Ge,u.g=x_(u.j,g?p:null,!u.u),u.P>0&&(u.O=new Fe(d(u.Y,u,u.g),u.P)),p=u.V,g=u.g,C=u.ba;var V="readystatechange";Array.isArray(V)||(V&&(ze[0]=V.toString()),V=ze);for(let F=0;F<V.length;F++){const J=je(g,V[F],C||p.handleEvent,!1,p.h||p);if(!J)break;p.g[J.key]=J}p=u.J?Re(u.J):{},u.u?(u.v||(u.v="POST"),p["Content-Type"]="application/x-www-form-urlencoded",u.g.ea(u.B,u.v,u.u,p)):(u.v="GET",u.g.ea(u.B,u.v,null,p)),Ut(),Is(u.i,u.v,u.B,u.l,u.S,u.u)}me.prototype.ba=function(u){u=u.target;const p=this.O;p&&Ss(u)==3?p.j():this.Y(u)},me.prototype.Y=function(u){try{if(u==this.g)e:{const Ae=Ss(this.g),jt=this.g.ya(),rt=this.g.ca();if(!(Ae<3)&&(Ae!=3||this.g&&(this.h.h||this.g.la()||h_(this.g)))){this.K||Ae!=4||jt==7||(jt==8||rt<=0?Ut(3):Ut(2)),bo(this);var p=this.g.ca();this.X=p;var g=Tn(this);if(this.o=p==200,On(this.i,this.v,this.B,this.l,this.S,Ae,p),this.o){if(this.U&&!this.L){t:{if(this.g){var C,V=this.g;if((C=V.g?V.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!k(C)){var F=C;break t}}F=null}if(u=F)Yr(this.i,this.l,u,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,Df(this,u);else{this.o=!1,this.m=3,Qe(12),Si(this),Zr(this);break e}}if(this.R){u=!0;let Bt;for(;!this.K&&this.C<g.length;)if(Bt=hr(this,g),Bt==Qn){Ae==4&&(this.m=4,Qe(14),u=!1),Yr(this.i,this.l,null,"[Incomplete Response]");break}else if(Bt==Nr){this.m=4,Qe(15),Yr(this.i,this.l,g,"[Invalid Chunk]"),u=!1;break}else Yr(this.i,this.l,Bt,null),Df(this,Bt);if(Sn(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Ae!=4||g.length!=0||this.h.h||(this.m=1,Qe(16),u=!1),this.o=this.o&&u,!u)Yr(this.i,this.l,g,"[Invalid Chunked Response]"),Si(this),Zr(this);else if(g.length>0&&!this.W){this.W=!0;var J=this.j;J.g==this&&J.aa&&!J.P&&(J.j.info("Great, no buffering proxy detected. Bytes received: "+g.length),$f(J),J.P=!0,Qe(11))}}else Yr(this.i,this.l,g,null),Df(this,g);Ae==4&&Si(this),this.o&&!this.K&&(Ae==4?__(this.j,this):(this.o=!1,Xr(this)))}else pR(this.g),p==400&&g.indexOf("Unknown SID")>0?(this.m=3,Qe(12)):(this.m=0,Qe(13)),Si(this),Zr(this)}}}catch{}finally{}};function Tn(u){if(!Sn(u))return u.g.la();const p=h_(u.g);if(p==="")return"";let g="";const C=p.length,V=Ss(u.g)==4;if(!u.h.i){if(typeof TextDecoder>"u")return Si(u),Zr(u),"";u.h.i=new o.TextDecoder}for(let F=0;F<C;F++)u.h.h=!0,g+=u.h.i.decode(p[F],{stream:!(V&&F==C-1)});return p.length=0,u.h.g+=g,u.C=0,u.h.g}function Sn(u){return u.g?u.v=="GET"&&u.M!=2&&u.j.Aa:!1}function hr(u,p){var g=u.C,C=p.indexOf(`
`,g);return C==-1?Qn:(g=Number(p.substring(g,C)),isNaN(g)?Nr:(C+=1,C+g>p.length?Qn:(p=p.slice(C,C+g),u.C=C+g,p)))}me.prototype.cancel=function(){this.K=!0,Si(this)};function Xr(u){u.T=Date.now()+u.H,Jr(u,u.H)}function Jr(u,p){if(u.D!=null)throw Error("WatchDog timer not null");u.D=Pr(d(u.aa,u),p)}function bo(u){u.D&&(o.clearTimeout(u.D),u.D=null)}me.prototype.aa=function(){this.D=null;const u=Date.now();u-this.T>=0?(lu(this.i,this.B),this.M!=2&&(Ut(),Qe(17)),Si(this),this.m=2,Zr(this)):Jr(this,this.T-u)};function Zr(u){u.j.I==0||u.K||__(u.j,u)}function Si(u){bo(u);var p=u.O;p&&typeof p.dispose=="function"&&p.dispose(),u.O=null,De(u.V),u.g&&(p=u.g,u.g=null,p.abort(),p.dispose())}function Df(u,p){try{var g=u.j;if(g.I!=0&&(g.g==u||jf(g.h,u))){if(!u.L&&jf(g.h,u)&&g.I==3){try{var C=g.Ba.g.parse(p)}catch{C=null}if(Array.isArray(C)&&C.length==3){var V=C;if(V[0]==0){e:if(!g.v){if(g.g)if(g.g.F+3e3<u.F)mu(g),fu(g);else break e;Uf(g),Qe(18)}}else g.xa=V[1],0<g.xa-g.K&&V[2]<37500&&g.F&&g.A==0&&!g.C&&(g.C=Pr(d(g.Va,g),6e3));Xv(g.h)<=1&&g.ta&&(g.ta=void 0)}else Ci(g,11)}else if((u.L||g.g==u)&&mu(g),!k(p))for(V=g.Ba.g.parse(p),p=0;p<V.length;p++){let rt=V[p];const Bt=rt[0];if(!(Bt<=g.K))if(g.K=Bt,rt=rt[1],g.I==2)if(rt[0]=="c"){g.M=rt[1],g.ba=rt[2];const Dr=rt[3];Dr!=null&&(g.ka=Dr,g.j.info("VER="+g.ka));const Ai=rt[4];Ai!=null&&(g.za=Ai,g.j.info("SVER="+g.za));const bs=rt[5];bs!=null&&typeof bs=="number"&&bs>0&&(C=1.5*bs,g.O=C,g.j.info("backChannelRequestTimeoutMs_="+C)),C=g;const Cs=u.g;if(Cs){const yu=Cs.g?Cs.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(yu){var F=C.h;F.g||yu.indexOf("spdy")==-1&&yu.indexOf("quic")==-1&&yu.indexOf("h2")==-1||(F.j=F.l,F.g=new Set,F.h&&(Of(F,F.h),F.h=null))}if(C.G){const Bf=Cs.g?Cs.g.getResponseHeader("X-HTTP-Session-Id"):null;Bf&&(C.wa=Bf,at(C.J,C.G,Bf))}}g.I=3,g.l&&g.l.ra(),g.aa&&(g.T=Date.now()-u.F,g.j.info("Handshake RTT: "+g.T+"ms")),C=g;var J=u;if(C.na=I_(C,C.L?C.ba:null,C.W),J.L){Jv(C.h,J);var Ae=J,jt=C.O;jt&&(Ae.H=jt),Ae.D&&(bo(Ae),Xr(Ae)),C.g=J}else y_(C);g.i.length>0&&pu(g)}else rt[0]!="stop"&&rt[0]!="close"||Ci(g,7);else g.I==3&&(rt[0]=="stop"||rt[0]=="close"?rt[0]=="stop"?Ci(g,7):Ff(g):rt[0]!="noop"&&g.l&&g.l.qa(rt),g.A=0)}}Ut(4)}catch{}}var tR=class{constructor(u,p){this.g=u,this.map=p}};function Qv(u){this.l=u||10,o.PerformanceNavigationTiming?(u=o.performance.getEntriesByType("navigation"),u=u.length>0&&(u[0].nextHopProtocol=="hq"||u[0].nextHopProtocol=="h2")):u=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=u?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function Yv(u){return u.h?!0:u.g?u.g.size>=u.j:!1}function Xv(u){return u.h?1:u.g?u.g.size:0}function jf(u,p){return u.h?u.h==p:u.g?u.g.has(p):!1}function Of(u,p){u.g?u.g.add(p):u.h=p}function Jv(u,p){u.h&&u.h==p?u.h=null:u.g&&u.g.has(p)&&u.g.delete(p)}Qv.prototype.cancel=function(){if(this.i=Zv(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const u of this.g.values())u.cancel();this.g.clear()}};function Zv(u){if(u.h!=null)return u.i.concat(u.h.G);if(u.g!=null&&u.g.size!==0){let p=u.i;for(const g of u.g.values())p=p.concat(g.G);return p}return v(u.i)}var e_=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function nR(u,p){if(u){u=u.split("&");for(let g=0;g<u.length;g++){const C=u[g].indexOf("=");let V,F=null;C>=0?(V=u[g].substring(0,C),F=u[g].substring(C+1)):V=u[g],p(V,F?decodeURIComponent(F.replace(/\+/g," ")):"")}}}function xs(u){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let p;u instanceof xs?(this.l=u.l,rl(this,u.j),this.o=u.o,this.g=u.g,sl(this,u.u),this.h=u.h,Vf(this,o_(u.i)),this.m=u.m):u&&(p=String(u).match(e_))?(this.l=!1,rl(this,p[1]||"",!0),this.o=il(p[2]||""),this.g=il(p[3]||"",!0),sl(this,p[4]),this.h=il(p[5]||"",!0),Vf(this,p[6]||"",!0),this.m=il(p[7]||"")):(this.l=!1,this.i=new al(null,this.l))}xs.prototype.toString=function(){const u=[];var p=this.j;p&&u.push(ol(p,t_,!0),":");var g=this.g;return(g||p=="file")&&(u.push("//"),(p=this.o)&&u.push(ol(p,t_,!0),"@"),u.push(Y(g).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),g=this.u,g!=null&&u.push(":",String(g))),(g=this.h)&&(this.g&&g.charAt(0)!="/"&&u.push("/"),u.push(ol(g,g.charAt(0)=="/"?iR:sR,!0))),(g=this.i.toString())&&u.push("?",g),(g=this.m)&&u.push("#",ol(g,aR)),u.join("")},xs.prototype.resolve=function(u){const p=kr(this);let g=!!u.j;g?rl(p,u.j):g=!!u.o,g?p.o=u.o:g=!!u.g,g?p.g=u.g:g=u.u!=null;var C=u.h;if(g)sl(p,u.u);else if(g=!!u.h){if(C.charAt(0)!="/")if(this.g&&!this.h)C="/"+C;else{var V=p.h.lastIndexOf("/");V!=-1&&(C=p.h.slice(0,V+1)+C)}if(V=C,V==".."||V==".")C="";else if(V.indexOf("./")!=-1||V.indexOf("/.")!=-1){C=V.lastIndexOf("/",0)==0,V=V.split("/");const F=[];for(let J=0;J<V.length;){const Ae=V[J++];Ae=="."?C&&J==V.length&&F.push(""):Ae==".."?((F.length>1||F.length==1&&F[0]!="")&&F.pop(),C&&J==V.length&&F.push("")):(F.push(Ae),C=!0)}C=F.join("/")}else C=V}return g?p.h=C:g=u.i.toString()!=="",g?Vf(p,o_(u.i)):g=!!u.m,g&&(p.m=u.m),p};function kr(u){return new xs(u)}function rl(u,p,g){u.j=g?il(p,!0):p,u.j&&(u.j=u.j.replace(/:$/,""))}function sl(u,p){if(p){if(p=Number(p),isNaN(p)||p<0)throw Error("Bad port number "+p);u.u=p}else u.u=null}function Vf(u,p,g){p instanceof al?(u.i=p,lR(u.i,u.l)):(g||(p=ol(p,oR)),u.i=new al(p,u.l))}function at(u,p,g){u.i.set(p,g)}function uu(u){return at(u,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),u}function il(u,p){return u?p?decodeURI(u.replace(/%25/g,"%2525")):decodeURIComponent(u):""}function ol(u,p,g){return typeof u=="string"?(u=encodeURI(u).replace(p,rR),g&&(u=u.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),u):null}function rR(u){return u=u.charCodeAt(0),"%"+(u>>4&15).toString(16)+(u&15).toString(16)}var t_=/[#\/\?@]/g,sR=/[#\?:]/g,iR=/[#\?]/g,oR=/[#\?@]/g,aR=/#/g;function al(u,p){this.h=this.g=null,this.i=u||null,this.j=!!p}function bi(u){u.g||(u.g=new Map,u.h=0,u.i&&nR(u.i,function(p,g){u.add(decodeURIComponent(p.replace(/\+/g," ")),g)}))}t=al.prototype,t.add=function(u,p){bi(this),this.i=null,u=Co(this,u);let g=this.g.get(u);return g||this.g.set(u,g=[]),g.push(p),this.h+=1,this};function n_(u,p){bi(u),p=Co(u,p),u.g.has(p)&&(u.i=null,u.h-=u.g.get(p).length,u.g.delete(p))}function r_(u,p){return bi(u),p=Co(u,p),u.g.has(p)}t.forEach=function(u,p){bi(this),this.g.forEach(function(g,C){g.forEach(function(V){u.call(p,V,C,this)},this)},this)};function s_(u,p){bi(u);let g=[];if(typeof p=="string")r_(u,p)&&(g=g.concat(u.g.get(Co(u,p))));else for(u=Array.from(u.g.values()),p=0;p<u.length;p++)g=g.concat(u[p]);return g}t.set=function(u,p){return bi(this),this.i=null,u=Co(this,u),r_(this,u)&&(this.h-=this.g.get(u).length),this.g.set(u,[p]),this.h+=1,this},t.get=function(u,p){return u?(u=s_(this,u),u.length>0?String(u[0]):p):p};function i_(u,p,g){n_(u,p),g.length>0&&(u.i=null,u.g.set(Co(u,p),v(g)),u.h+=g.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const u=[],p=Array.from(this.g.keys());for(let C=0;C<p.length;C++){var g=p[C];const V=Y(g);g=s_(this,g);for(let F=0;F<g.length;F++){let J=V;g[F]!==""&&(J+="="+Y(g[F])),u.push(J)}}return this.i=u.join("&")};function o_(u){const p=new al;return p.i=u.i,u.g&&(p.g=new Map(u.g),p.h=u.h),p}function Co(u,p){return p=String(p),u.j&&(p=p.toLowerCase()),p}function lR(u,p){p&&!u.j&&(bi(u),u.i=null,u.g.forEach(function(g,C){const V=C.toLowerCase();C!=V&&(n_(this,C),i_(this,V,g))},u)),u.j=p}function cR(u,p){const g=new dr;if(o.Image){const C=new Image;C.onload=h(Ts,g,"TestLoadImage: loaded",!0,p,C),C.onerror=h(Ts,g,"TestLoadImage: error",!1,p,C),C.onabort=h(Ts,g,"TestLoadImage: abort",!1,p,C),C.ontimeout=h(Ts,g,"TestLoadImage: timeout",!1,p,C),o.setTimeout(function(){C.ontimeout&&C.ontimeout()},1e4),C.src=u}else p(!1)}function uR(u,p){const g=new dr,C=new AbortController,V=setTimeout(()=>{C.abort(),Ts(g,"TestPingServer: timeout",!1,p)},1e4);fetch(u,{signal:C.signal}).then(F=>{clearTimeout(V),F.ok?Ts(g,"TestPingServer: ok",!0,p):Ts(g,"TestPingServer: server error",!1,p)}).catch(()=>{clearTimeout(V),Ts(g,"TestPingServer: error",!1,p)})}function Ts(u,p,g,C,V){try{V&&(V.onload=null,V.onerror=null,V.onabort=null,V.ontimeout=null),C(g)}catch{}}function dR(){this.g=new X}function Lf(u){this.i=u.Sb||null,this.h=u.ab||!1}f(Lf,te),Lf.prototype.g=function(){return new du(this.i,this.h)};function du(u,p){q.call(this),this.H=u,this.o=p,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}f(du,q),t=du.prototype,t.open=function(u,p){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=u,this.D=p,this.readyState=1,cl(this)},t.send=function(u){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const p={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};u&&(p.body=u),(this.H||o).fetch(new Request(this.D,p)).then(this.Pa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,ll(this)),this.readyState=0},t.Pa=function(u){if(this.g&&(this.l=u,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=u.headers,this.readyState=2,cl(this)),this.g&&(this.readyState=3,cl(this),this.g)))if(this.responseType==="arraybuffer")u.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in u){if(this.j=u.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;a_(this)}else u.text().then(this.Oa.bind(this),this.ga.bind(this))};function a_(u){u.j.read().then(u.Ma.bind(u)).catch(u.ga.bind(u))}t.Ma=function(u){if(this.g){if(this.o&&u.value)this.response.push(u.value);else if(!this.o){var p=u.value?u.value:new Uint8Array(0);(p=this.B.decode(p,{stream:!u.done}))&&(this.response=this.responseText+=p)}u.done?ll(this):cl(this),this.readyState==3&&a_(this)}},t.Oa=function(u){this.g&&(this.response=this.responseText=u,ll(this))},t.Na=function(u){this.g&&(this.response=u,ll(this))},t.ga=function(){this.g&&ll(this)};function ll(u){u.readyState=4,u.l=null,u.j=null,u.B=null,cl(u)}t.setRequestHeader=function(u,p){this.A.append(u,p)},t.getResponseHeader=function(u){return this.h&&this.h.get(u.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const u=[],p=this.h.entries();for(var g=p.next();!g.done;)g=g.value,u.push(g[0]+": "+g[1]),g=p.next();return u.join(`\r
`)};function cl(u){u.onreadystatechange&&u.onreadystatechange.call(u)}Object.defineProperty(du.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(u){this.m=u?"include":"same-origin"}});function l_(u){let p="";return de(u,function(g,C){p+=C,p+=":",p+=g,p+=`\r
`}),p}function Mf(u,p,g){e:{for(C in g){var C=!1;break e}C=!0}C||(g=l_(g),typeof u=="string"?g!=null&&Y(g):at(u,p,g))}function vt(u){q.call(this),this.headers=new Map,this.L=u||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}f(vt,q);var hR=/^https?$/i,fR=["POST","PUT"];t=vt.prototype,t.Fa=function(u){this.H=u},t.ea=function(u,p,g,C){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+u);p=p?p.toUpperCase():"GET",this.D=u,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():x.g(),this.g.onreadystatechange=m(d(this.Ca,this));try{this.B=!0,this.g.open(p,String(u),!0),this.B=!1}catch(F){c_(this,F);return}if(u=g||"",g=new Map(this.headers),C)if(Object.getPrototypeOf(C)===Object.prototype)for(var V in C)g.set(V,C[V]);else if(typeof C.keys=="function"&&typeof C.get=="function")for(const F of C.keys())g.set(F,C.get(F));else throw Error("Unknown input type for opt_headers: "+String(C));C=Array.from(g.keys()).find(F=>F.toLowerCase()=="content-type"),V=o.FormData&&u instanceof o.FormData,!(Array.prototype.indexOf.call(fR,p,void 0)>=0)||C||V||g.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[F,J]of g)this.g.setRequestHeader(F,J);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(u),this.v=!1}catch(F){c_(this,F)}};function c_(u,p){u.h=!1,u.g&&(u.j=!0,u.g.abort(),u.j=!1),u.l=p,u.o=5,u_(u),hu(u)}function u_(u){u.A||(u.A=!0,re(u,"complete"),re(u,"error"))}t.abort=function(u){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=u||7,re(this,"complete"),re(this,"abort"),hu(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),hu(this,!0)),vt.Z.N.call(this)},t.Ca=function(){this.u||(this.B||this.v||this.j?d_(this):this.Xa())},t.Xa=function(){d_(this)};function d_(u){if(u.h&&typeof i<"u"){if(u.v&&Ss(u)==4)setTimeout(u.Ca.bind(u),0);else if(re(u,"readystatechange"),Ss(u)==4){u.h=!1;try{const F=u.ca();e:switch(F){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var p=!0;break e;default:p=!1}var g;if(!(g=p)){var C;if(C=F===0){let J=String(u.D).match(e_)[1]||null;!J&&o.self&&o.self.location&&(J=o.self.location.protocol.slice(0,-1)),C=!hR.test(J?J.toLowerCase():"")}g=C}if(g)re(u,"complete"),re(u,"success");else{u.o=6;try{var V=Ss(u)>2?u.g.statusText:""}catch{V=""}u.l=V+" ["+u.ca()+"]",u_(u)}}finally{hu(u)}}}}function hu(u,p){if(u.g){u.m&&(clearTimeout(u.m),u.m=null);const g=u.g;u.g=null,p||re(u,"ready");try{g.onreadystatechange=null}catch{}}}t.isActive=function(){return!!this.g};function Ss(u){return u.g?u.g.readyState:0}t.ca=function(){try{return Ss(this)>2?this.g.status:-1}catch{return-1}},t.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.La=function(u){if(this.g){var p=this.g.responseText;return u&&p.indexOf(u)==0&&(p=p.substring(u.length)),M(p)}};function h_(u){try{if(!u.g)return null;if("response"in u.g)return u.g.response;switch(u.F){case"":case"text":return u.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in u.g)return u.g.mozResponseArrayBuffer}return null}catch{return null}}function pR(u){const p={};u=(u.g&&Ss(u)>=2&&u.g.getAllResponseHeaders()||"").split(`\r
`);for(let C=0;C<u.length;C++){if(k(u[C]))continue;var g=ue(u[C]);const V=g[0];if(g=g[1],typeof g!="string")continue;g=g.trim();const F=p[V]||[];p[V]=F,F.push(g)}pe(p,function(C){return C.join(", ")})}t.ya=function(){return this.o},t.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function ul(u,p,g){return g&&g.internalChannelParams&&g.internalChannelParams[u]||p}function f_(u){this.za=0,this.i=[],this.j=new dr,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=ul("failFast",!1,u),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=ul("baseRetryDelayMs",5e3,u),this.Za=ul("retryDelaySeedMs",1e4,u),this.Ta=ul("forwardChannelMaxRetries",2,u),this.va=ul("forwardChannelRequestTimeoutMs",2e4,u),this.ma=u&&u.xmlHttpFactory||void 0,this.Ua=u&&u.Rb||void 0,this.Aa=u&&u.useFetchStreams||!1,this.O=void 0,this.L=u&&u.supportsCrossDomainXhr||!1,this.M="",this.h=new Qv(u&&u.concurrentRequestLimit),this.Ba=new dR,this.S=u&&u.fastHandshake||!1,this.R=u&&u.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=u&&u.Pb||!1,u&&u.ua&&this.j.ua(),u&&u.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&u&&u.detectBufferingProxy||!1,this.ia=void 0,u&&u.longPollingTimeout&&u.longPollingTimeout>0&&(this.ia=u.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}t=f_.prototype,t.ka=8,t.I=1,t.connect=function(u,p,g,C){Qe(0),this.W=u,this.H=p||{},g&&C!==void 0&&(this.H.OSID=g,this.H.OAID=C),this.F=this.X,this.J=I_(this,null,this.W),pu(this)};function Ff(u){if(p_(u),u.I==3){var p=u.V++,g=kr(u.J);if(at(g,"SID",u.M),at(g,"RID",p),at(g,"TYPE","terminate"),dl(u,g),p=new me(u,u.j,p),p.M=2,p.A=uu(kr(g)),g=!1,o.navigator&&o.navigator.sendBeacon)try{g=o.navigator.sendBeacon(p.A.toString(),"")}catch{}!g&&o.Image&&(new Image().src=p.A,g=!0),g||(p.g=x_(p.j,null),p.g.ea(p.A)),p.F=Date.now(),Xr(p)}E_(u)}function fu(u){u.g&&($f(u),u.g.cancel(),u.g=null)}function p_(u){fu(u),u.v&&(o.clearTimeout(u.v),u.v=null),mu(u),u.h.cancel(),u.m&&(typeof u.m=="number"&&o.clearTimeout(u.m),u.m=null)}function pu(u){if(!Yv(u.h)&&!u.m){u.m=!0;var p=u.Ea;L||_(),B||(L(),B=!0),w.add(p,u),u.D=0}}function mR(u,p){return Xv(u.h)>=u.h.j-(u.m?1:0)?!1:u.m?(u.i=p.G.concat(u.i),!0):u.I==1||u.I==2||u.D>=(u.Sa?0:u.Ta)?!1:(u.m=Pr(d(u.Ea,u,p),w_(u,u.D)),u.D++,!0)}t.Ea=function(u){if(this.m)if(this.m=null,this.I==1){if(!u){this.V=Math.floor(Math.random()*1e5),u=this.V++;const V=new me(this,this.j,u);let F=this.o;if(this.U&&(F?(F=Re(F),Dt(F,this.U)):F=this.U),this.u!==null||this.R||(V.J=F,F=null),this.S)e:{for(var p=0,g=0;g<this.i.length;g++){t:{var C=this.i[g];if("__data__"in C.map&&(C=C.map.__data__,typeof C=="string")){C=C.length;break t}C=void 0}if(C===void 0)break;if(p+=C,p>4096){p=g;break e}if(p===4096||g===this.i.length-1){p=g+1;break e}}p=1e3}else p=1e3;p=g_(this,V,p),g=kr(this.J),at(g,"RID",u),at(g,"CVER",22),this.G&&at(g,"X-HTTP-Session-Id",this.G),dl(this,g),F&&(this.R?p="headers="+Y(l_(F))+"&"+p:this.u&&Mf(g,this.u,F)),Of(this.h,V),this.Ra&&at(g,"TYPE","init"),this.S?(at(g,"$req",p),at(g,"SID","null"),V.U=!0,Yn(V,g,null)):Yn(V,g,p),this.I=2}}else this.I==3&&(u?m_(this,u):this.i.length==0||Yv(this.h)||m_(this))};function m_(u,p){var g;p?g=p.l:g=u.V++;const C=kr(u.J);at(C,"SID",u.M),at(C,"RID",g),at(C,"AID",u.K),dl(u,C),u.u&&u.o&&Mf(C,u.u,u.o),g=new me(u,u.j,g,u.D+1),u.u===null&&(g.J=u.o),p&&(u.i=p.G.concat(u.i)),p=g_(u,g,1e3),g.H=Math.round(u.va*.5)+Math.round(u.va*.5*Math.random()),Of(u.h,g),Yn(g,C,p)}function dl(u,p){u.H&&de(u.H,function(g,C){at(p,C,g)}),u.l&&de({},function(g,C){at(p,C,g)})}function g_(u,p,g){g=Math.min(u.i.length,g);const C=u.l?d(u.l.Ka,u.l,u):null;e:{var V=u.i;let Ae=-1;for(;;){const jt=["count="+g];Ae==-1?g>0?(Ae=V[0].g,jt.push("ofs="+Ae)):Ae=0:jt.push("ofs="+Ae);let rt=!0;for(let Bt=0;Bt<g;Bt++){var F=V[Bt].g;const Dr=V[Bt].map;if(F-=Ae,F<0)Ae=Math.max(0,V[Bt].g-100),rt=!1;else try{F="req"+F+"_"||"";try{var J=Dr instanceof Map?Dr:Object.entries(Dr);for(const[Ai,bs]of J){let Cs=bs;a(bs)&&(Cs=be(bs)),jt.push(F+Ai+"="+encodeURIComponent(Cs))}}catch(Ai){throw jt.push(F+"type="+encodeURIComponent("_badmap")),Ai}}catch{C&&C(Dr)}}if(rt){J=jt.join("&");break e}}J=void 0}return u=u.i.splice(0,g),p.G=u,J}function y_(u){if(!u.g&&!u.v){u.Y=1;var p=u.Da;L||_(),B||(L(),B=!0),w.add(p,u),u.A=0}}function Uf(u){return u.g||u.v||u.A>=3?!1:(u.Y++,u.v=Pr(d(u.Da,u),w_(u,u.A)),u.A++,!0)}t.Da=function(){if(this.v=null,v_(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var u=4*this.T;this.j.info("BP detection timer enabled: "+u),this.B=Pr(d(this.Wa,this),u)}},t.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,Qe(10),fu(this),v_(this))};function $f(u){u.B!=null&&(o.clearTimeout(u.B),u.B=null)}function v_(u){u.g=new me(u,u.j,"rpc",u.Y),u.u===null&&(u.g.J=u.o),u.g.P=0;var p=kr(u.na);at(p,"RID","rpc"),at(p,"SID",u.M),at(p,"AID",u.K),at(p,"CI",u.F?"0":"1"),!u.F&&u.ia&&at(p,"TO",u.ia),at(p,"TYPE","xmlhttp"),dl(u,p),u.u&&u.o&&Mf(p,u.u,u.o),u.O&&(u.g.H=u.O);var g=u.g;u=u.ba,g.M=1,g.A=uu(kr(p)),g.u=null,g.R=!0,At(g,u)}t.Va=function(){this.C!=null&&(this.C=null,fu(this),Uf(this),Qe(19))};function mu(u){u.C!=null&&(o.clearTimeout(u.C),u.C=null)}function __(u,p){var g=null;if(u.g==p){mu(u),$f(u),u.g=null;var C=2}else if(jf(u.h,p))g=p.G,Jv(u.h,p),C=1;else return;if(u.I!=0){if(p.o)if(C==1){g=p.u?p.u.length:0,p=Date.now()-p.F;var V=u.D;C=Zt(),re(C,new Ct(C,g)),pu(u)}else y_(u);else if(V=p.m,V==3||V==0&&p.X>0||!(C==1&&mR(u,p)||C==2&&Uf(u)))switch(g&&g.length>0&&(p=u.h,p.i=p.i.concat(g)),V){case 1:Ci(u,5);break;case 4:Ci(u,10);break;case 3:Ci(u,6);break;default:Ci(u,2)}}}function w_(u,p){let g=u.Qa+Math.floor(Math.random()*u.Za);return u.isActive()||(g*=2),g*p}function Ci(u,p){if(u.j.info("Error code "+p),p==2){var g=d(u.bb,u),C=u.Ua;const V=!C;C=new xs(C||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||rl(C,"https"),uu(C),V?cR(C.toString(),g):uR(C.toString(),g)}else Qe(2);u.I=0,u.l&&u.l.pa(p),E_(u),p_(u)}t.bb=function(u){u?(this.j.info("Successfully pinged google.com"),Qe(2)):(this.j.info("Failed to ping google.com"),Qe(1))};function E_(u){if(u.I=0,u.ja=[],u.l){const p=Zv(u.h);(p.length!=0||u.i.length!=0)&&(R(u.ja,p),R(u.ja,u.i),u.h.i.length=0,v(u.i),u.i.length=0),u.l.oa()}}function I_(u,p,g){var C=g instanceof xs?kr(g):new xs(g);if(C.g!="")p&&(C.g=p+"."+C.g),sl(C,C.u);else{var V=o.location;C=V.protocol,p=p?p+"."+V.hostname:V.hostname,V=+V.port;const F=new xs(null);C&&rl(F,C),p&&(F.g=p),V&&sl(F,V),g&&(F.h=g),C=F}return g=u.G,p=u.wa,g&&p&&at(C,g,p),at(C,"VER",u.ka),dl(u,C),C}function x_(u,p,g){if(p&&!u.L)throw Error("Can't create secondary domain capable XhrIo object.");return p=u.Aa&&!u.ma?new vt(new Lf({ab:g})):new vt(u.ma),p.Fa(u.L),p}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function T_(){}t=T_.prototype,t.ra=function(){},t.qa=function(){},t.pa=function(){},t.oa=function(){},t.isActive=function(){return!0},t.Ka=function(){};function gu(){}gu.prototype.g=function(u,p){return new Vn(u,p)};function Vn(u,p){q.call(this),this.g=new f_(p),this.l=u,this.h=p&&p.messageUrlParams||null,u=p&&p.messageHeaders||null,p&&p.clientProtocolHeaderRequired&&(u?u["X-Client-Protocol"]="webchannel":u={"X-Client-Protocol":"webchannel"}),this.g.o=u,u=p&&p.initMessageHeaders||null,p&&p.messageContentType&&(u?u["X-WebChannel-Content-Type"]=p.messageContentType:u={"X-WebChannel-Content-Type":p.messageContentType}),p&&p.sa&&(u?u["X-WebChannel-Client-Profile"]=p.sa:u={"X-WebChannel-Client-Profile":p.sa}),this.g.U=u,(u=p&&p.Qb)&&!k(u)&&(this.g.u=u),this.A=p&&p.supportsCrossDomainXhr||!1,this.v=p&&p.sendRawJson||!1,(p=p&&p.httpSessionIdParam)&&!k(p)&&(this.g.G=p,u=this.h,u!==null&&p in u&&(u=this.h,p in u&&delete u[p])),this.j=new Ao(this)}f(Vn,q),Vn.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},Vn.prototype.close=function(){Ff(this.g)},Vn.prototype.o=function(u){var p=this.g;if(typeof u=="string"){var g={};g.__data__=u,u=g}else this.v&&(g={},g.__data__=be(u),u=g);p.i.push(new tR(p.Ya++,u)),p.I==3&&pu(p)},Vn.prototype.N=function(){this.g.l=null,delete this.j,Ff(this.g),delete this.g,Vn.Z.N.call(this)};function S_(u){St.call(this),u.__headers__&&(this.headers=u.__headers__,this.statusCode=u.__status__,delete u.__headers__,delete u.__status__);var p=u.__sm__;if(p){e:{for(const g in p){u=g;break e}u=void 0}(this.i=u)&&(u=this.i,p=p!==null&&u in p?p[u]:void 0),this.data=p}else this.data=u}f(S_,St);function b_(){Rr.call(this),this.status=1}f(b_,Rr);function Ao(u){this.g=u}f(Ao,T_),Ao.prototype.ra=function(){re(this.g,"a")},Ao.prototype.qa=function(u){re(this.g,new S_(u))},Ao.prototype.pa=function(u){re(this.g,new b_)},Ao.prototype.oa=function(){re(this.g,"b")},gu.prototype.createWebChannel=gu.prototype.g,Vn.prototype.send=Vn.prototype.o,Vn.prototype.open=Vn.prototype.m,Vn.prototype.close=Vn.prototype.close,ib=function(){return new gu},sb=function(){return Zt()},rb=xn,Km={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},Ti.NO_ERROR=0,Ti.TIMEOUT=8,Ti.HTTP_ERROR=6,hd=Ti,nl.COMPLETE="complete",nb=nl,Ne.EventType=nt,nt.OPEN="a",nt.CLOSE="b",nt.ERROR="c",nt.MESSAGE="d",q.prototype.listen=q.prototype.J,jl=Ne,vt.prototype.listenOnce=vt.prototype.K,vt.prototype.getLastError=vt.prototype.Ha,vt.prototype.getLastErrorCode=vt.prototype.ya,vt.prototype.getStatus=vt.prototype.ca,vt.prototype.getResponseJson=vt.prototype.La,vt.prototype.getResponseText=vt.prototype.la,vt.prototype.send=vt.prototype.ea,vt.prototype.setWithCredentials=vt.prototype.Fa,tb=vt}).apply(typeof Lu<"u"?Lu:typeof self<"u"?self:typeof window<"u"?window:{});const EE="@firebase/firestore",IE="4.9.2";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kt{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Kt.UNAUTHENTICATED=new Kt(null),Kt.GOOGLE_CREDENTIALS=new Kt("google-credentials-uid"),Kt.FIRST_PARTY=new Kt("first-party-uid"),Kt.MOCK_USER=new Kt("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Xa="12.3.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const io=new Wh("@firebase/firestore");function zo(){return io.logLevel}function W(t,...e){if(io.logLevel<=Ve.DEBUG){const n=e.map(Ly);io.debug(`Firestore (${Xa}): ${t}`,...n)}}function mn(t,...e){if(io.logLevel<=Ve.ERROR){const n=e.map(Ly);io.error(`Firestore (${Xa}): ${t}`,...n)}}function oo(t,...e){if(io.logLevel<=Ve.WARN){const n=e.map(Ly);io.warn(`Firestore (${Xa}): ${t}`,...n)}}function Ly(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function le(t,e,n){let r="Unexpected state";typeof e=="string"?r=e:n=e,ob(t,r,n)}function ob(t,e,n){let r=`FIRESTORE (${Xa}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(n!==void 0)try{r+=" CONTEXT: "+JSON.stringify(n)}catch{r+=" CONTEXT: "+n}throw mn(r),new Error(r)}function he(t,e,n,r){let s="Unexpected state";typeof n=="string"?s=n:r=n,t||ob(e,s,r)}function Ee(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Q extends ur{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Er{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ab{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class iO{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(Kt.UNAUTHENTICATED))}shutdown(){}}class oO{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class aO{constructor(e){this.t=e,this.currentUser=Kt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){he(this.o===void 0,42304);let r=this.i;const s=l=>this.i!==r?(r=this.i,n(l)):Promise.resolve();let i=new Er;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new Er,e.enqueueRetryable(()=>s(this.currentUser))};const o=()=>{const l=i;e.enqueueRetryable(async()=>{await l.promise,await s(this.currentUser)})},a=l=>{W("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(l=>a(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?a(l):(W("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new Er)}},0),o()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(W("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(he(typeof r.accessToken=="string",31837,{l:r}),new ab(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return he(e===null||typeof e=="string",2055,{h:e}),new Kt(e)}}class lO{constructor(e,n,r){this.P=e,this.T=n,this.I=r,this.type="FirstParty",this.user=Kt.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class cO{constructor(e,n,r){this.P=e,this.T=n,this.I=r}getToken(){return Promise.resolve(new lO(this.P,this.T,this.I))}start(e,n){e.enqueueRetryable(()=>n(Kt.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class xE{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class uO{constructor(e,n){this.V=n,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,er(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,n){he(this.o===void 0,3512);const r=i=>{i.error!=null&&W("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.m;return this.m=i.token,W("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>r(i))};const s=i=>{W("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(i=>s(i)),setTimeout(()=>{if(!this.appCheck){const i=this.V.getImmediate({optional:!0});i?s(i):W("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new xE(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(he(typeof n.token=="string",44558,{tokenResult:n}),this.m=n.token,new xE(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dO(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class My{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const s=dO(40);for(let i=0;i<s.length;++i)r.length<20&&s[i]<n&&(r+=e.charAt(s[i]%62))}return r}}function Ie(t,e){return t<e?-1:t>e?1:0}function Qm(t,e){const n=Math.min(t.length,e.length);for(let r=0;r<n;r++){const s=t.charAt(r),i=e.charAt(r);if(s!==i)return Tp(s)===Tp(i)?Ie(s,i):Tp(s)?1:-1}return Ie(t.length,e.length)}const hO=55296,fO=57343;function Tp(t){const e=t.charCodeAt(0);return e>=hO&&e<=fO}function Ra(t,e,n){return t.length===e.length&&t.every((r,s)=>n(r,e[s]))}function lb(t){return t+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TE="__name__";class Mr{constructor(e,n,r){n===void 0?n=0:n>e.length&&le(637,{offset:n,range:e.length}),r===void 0?r=e.length-n:r>e.length-n&&le(1746,{length:r,range:e.length-n}),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return Mr.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof Mr?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let s=0;s<r;s++){const i=Mr.compareSegments(e.get(s),n.get(s));if(i!==0)return i}return Ie(e.length,n.length)}static compareSegments(e,n){const r=Mr.isNumericId(e),s=Mr.isNumericId(n);return r&&!s?-1:!r&&s?1:r&&s?Mr.extractNumericId(e).compare(Mr.extractNumericId(n)):Qm(e,n)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return ii.fromString(e.substring(4,e.length-2))}}class We extends Mr{construct(e,n,r){return new We(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new Q($.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(s=>s.length>0))}return new We(n)}static emptyPath(){return new We([])}}const pO=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class mt extends Mr{construct(e,n,r){return new mt(e,n,r)}static isValidIdentifier(e){return pO.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),mt.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===TE}static keyField(){return new mt([TE])}static fromServerFormat(e){const n=[];let r="",s=0;const i=()=>{if(r.length===0)throw new Q($.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let o=!1;for(;s<e.length;){const a=e[s];if(a==="\\"){if(s+1===e.length)throw new Q($.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[s+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new Q($.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=l,s+=2}else a==="`"?(o=!o,s++):a!=="."||o?(r+=a,s++):(i(),s++)}if(i(),o)throw new Q($.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new mt(n)}static emptyPath(){return new mt([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ee{constructor(e){this.path=e}static fromPath(e){return new ee(We.fromString(e))}static fromName(e){return new ee(We.fromString(e).popFirst(5))}static empty(){return new ee(We.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&We.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return We.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new ee(new We(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cb(t,e,n){if(!n)throw new Q($.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function mO(t,e,n,r){if(e===!0&&r===!0)throw new Q($.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function SE(t){if(!ee.isDocumentKey(t))throw new Q($.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function bE(t){if(ee.isDocumentKey(t))throw new Q($.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function ub(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function Jh(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":le(12329,{type:typeof t})}function ln(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new Q($.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Jh(t);throw new Q($.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}function gO(t,e){if(e<=0)throw new Q($.INVALID_ARGUMENT,`Function ${t}() requires a positive number, but it was: ${e}.`)}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nt(t,e){const n={typeString:t};return e&&(n.value=e),n}function Qc(t,e){if(!ub(t))throw new Q($.INVALID_ARGUMENT,"JSON must be an object");let n;for(const r in e)if(e[r]){const s=e[r].typeString,i="value"in e[r]?{value:e[r].value}:void 0;if(!(r in t)){n=`JSON missing required field: '${r}'`;break}const o=t[r];if(s&&typeof o!==s){n=`JSON field '${r}' must be a ${s}.`;break}if(i!==void 0&&o!==i.value){n=`Expected '${r}' field to equal '${i.value}'`;break}}if(n)throw new Q($.INVALID_ARGUMENT,n);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CE=-62135596800,AE=1e6;class Be{static now(){return Be.fromMillis(Date.now())}static fromDate(e){return Be.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor((e-1e3*n)*AE);return new Be(n,r)}constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new Q($.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new Q($.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<CE)throw new Q($.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Q($.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/AE}_compareTo(e){return this.seconds===e.seconds?Ie(this.nanoseconds,e.nanoseconds):Ie(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:Be._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Qc(e,Be._jsonSchema))return new Be(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-CE;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}Be._jsonSchemaVersion="firestore/timestamp/1.0",Be._jsonSchema={type:Nt("string",Be._jsonSchemaVersion),seconds:Nt("number"),nanoseconds:Nt("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fe{static fromTimestamp(e){return new fe(e)}static min(){return new fe(new Be(0,0))}static max(){return new fe(new Be(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cc=-1;class sh{constructor(e,n,r,s){this.indexId=e,this.collectionGroup=n,this.fields=r,this.indexState=s}}function Ym(t){return t.fields.find(e=>e.kind===2)}function Di(t){return t.fields.filter(e=>e.kind!==2)}sh.UNKNOWN_ID=-1;class fd{constructor(e,n){this.fieldPath=e,this.kind=n}}class Ac{constructor(e,n){this.sequenceNumber=e,this.offset=n}static empty(){return new Ac(0,Hn.min())}}function yO(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,s=fe.fromTimestamp(r===1e9?new Be(n+1,0):new Be(n,r));return new Hn(s,ee.empty(),e)}function db(t){return new Hn(t.readTime,t.key,Cc)}class Hn{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new Hn(fe.min(),ee.empty(),Cc)}static max(){return new Hn(fe.max(),ee.empty(),Cc)}}function Fy(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=ee.comparator(t.documentKey,e.documentKey),n!==0?n:Ie(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hb="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class fb{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function To(t){if(t.code!==$.FAILED_PRECONDITION||t.message!==hb)throw t;W("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&le(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new O((r,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(r,s)},this.catchCallback=i=>{this.wrapFailure(n,i).next(r,s)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof O?n:O.resolve(n)}catch(n){return O.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):O.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):O.reject(n)}static resolve(e){return new O((n,r)=>{n(e)})}static reject(e){return new O((n,r)=>{r(e)})}static waitFor(e){return new O((n,r)=>{let s=0,i=0,o=!1;e.forEach(a=>{++s,a.next(()=>{++i,o&&i===s&&n()},l=>r(l))}),o=!0,i===s&&n()})}static or(e){let n=O.resolve(!1);for(const r of e)n=n.next(s=>s?O.resolve(s):r());return n}static forEach(e,n){const r=[];return e.forEach((s,i)=>{r.push(n.call(this,s,i))}),this.waitFor(r)}static mapArray(e,n){return new O((r,s)=>{const i=e.length,o=new Array(i);let a=0;for(let l=0;l<i;l++){const d=l;n(e[d]).next(h=>{o[d]=h,++a,a===i&&r(o)},h=>s(h))}})}static doWhile(e,n){return new O((r,s)=>{const i=()=>{e()===!0?n().next(()=>{i()},s):r()};i()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mn="SimpleDb";class Zh{static open(e,n,r,s){try{return new Zh(n,e.transaction(s,r))}catch(i){throw new Jl(n,i)}}constructor(e,n){this.action=e,this.transaction=n,this.aborted=!1,this.S=new Er,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{n.error?this.S.reject(new Jl(e,n.error)):this.S.resolve()},this.transaction.onerror=r=>{const s=Uy(r.target.error);this.S.reject(new Jl(e,s))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(W(Mn,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}C(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const n=this.transaction.objectStore(e);return new _O(n)}}class oi{static delete(e){return W(Mn,"Removing database:",e),Oi(rS().indexedDB.deleteDatabase(e)).toPromise()}static v(){if(!Sy())return!1;if(oi.F())return!0;const e=Lt(),n=oi.M(e),r=0<n&&n<10,s=pb(e),i=0<s&&s<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||i)}static F(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)==null?void 0:e.__PRIVATE_USE_MOCK_PERSISTENCE)==="YES"}static O(e,n){return e.store(n)}static M(e){const n=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=n?n[1].split("_").slice(0,2).join("."):"-1";return Number(r)}constructor(e,n,r){this.name=e,this.version=n,this.N=r,this.B=null,oi.M(Lt())===12.2&&mn("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async L(e){return this.db||(W(Mn,"Opening database:",this.name),this.db=await new Promise((n,r)=>{const s=indexedDB.open(this.name,this.version);s.onsuccess=i=>{const o=i.target.result;n(o)},s.onblocked=()=>{r(new Jl(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},s.onerror=i=>{const o=i.target.error;o.name==="VersionError"?r(new Q($.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?r(new Q($.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):r(new Jl(e,o))},s.onupgradeneeded=i=>{W(Mn,'Database "'+this.name+'" requires upgrade from version:',i.oldVersion);const o=i.target.result;this.N.k(o,s.transaction,i.oldVersion,this.version).next(()=>{W(Mn,"Database upgrade to version "+this.version+" complete")})}})),this.q&&(this.db.onversionchange=n=>this.q(n)),this.db}$(e){this.q=e,this.db&&(this.db.onversionchange=n=>e(n))}async runTransaction(e,n,r,s){const i=n==="readonly";let o=0;for(;;){++o;try{this.db=await this.L(e);const a=Zh.open(this.db,e,i?"readonly":"readwrite",r),l=s(a).next(d=>(a.C(),d)).catch(d=>(a.abort(d),O.reject(d))).toPromise();return l.catch(()=>{}),await a.D,l}catch(a){const l=a,d=l.name!=="FirebaseError"&&o<3;if(W(Mn,"Transaction failed with error:",l.message,"Retrying:",d),this.close(),!d)return Promise.reject(l)}}}close(){this.db&&this.db.close(),this.db=void 0}}function pb(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}class vO{constructor(e){this.U=e,this.K=!1,this.W=null}get isDone(){return this.K}get G(){return this.W}set cursor(e){this.U=e}done(){this.K=!0}j(e){this.W=e}delete(){return Oi(this.U.delete())}}class Jl extends Q{constructor(e,n){super($.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${n}`),this.name="IndexedDbTransactionError"}}function Ei(t){return t.name==="IndexedDbTransactionError"}class _O{constructor(e){this.store=e}put(e,n){let r;return n!==void 0?(W(Mn,"PUT",this.store.name,e,n),r=this.store.put(n,e)):(W(Mn,"PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),Oi(r)}add(e){return W(Mn,"ADD",this.store.name,e,e),Oi(this.store.add(e))}get(e){return Oi(this.store.get(e)).next(n=>(n===void 0&&(n=null),W(Mn,"GET",this.store.name,e,n),n))}delete(e){return W(Mn,"DELETE",this.store.name,e),Oi(this.store.delete(e))}count(){return W(Mn,"COUNT",this.store.name),Oi(this.store.count())}J(e,n){const r=this.options(e,n),s=r.index?this.store.index(r.index):this.store;if(typeof s.getAll=="function"){const i=s.getAll(r.range);return new O((o,a)=>{i.onerror=l=>{a(l.target.error)},i.onsuccess=l=>{o(l.target.result)}})}{const i=this.cursor(r),o=[];return this.H(i,(a,l)=>{o.push(l)}).next(()=>o)}}Y(e,n){const r=this.store.getAll(e,n===null?void 0:n);return new O((s,i)=>{r.onerror=o=>{i(o.target.error)},r.onsuccess=o=>{s(o.target.result)}})}Z(e,n){W(Mn,"DELETE ALL",this.store.name);const r=this.options(e,n);r.X=!1;const s=this.cursor(r);return this.H(s,(i,o,a)=>a.delete())}ee(e,n){let r;n?r=e:(r={},n=e);const s=this.cursor(r);return this.H(s,n)}te(e){const n=this.cursor({});return new O((r,s)=>{n.onerror=i=>{const o=Uy(i.target.error);s(o)},n.onsuccess=i=>{const o=i.target.result;o?e(o.primaryKey,o.value).next(a=>{a?o.continue():r()}):r()}})}H(e,n){const r=[];return new O((s,i)=>{e.onerror=o=>{i(o.target.error)},e.onsuccess=o=>{const a=o.target.result;if(!a)return void s();const l=new vO(a),d=n(a.primaryKey,a.value,l);if(d instanceof O){const h=d.catch(f=>(l.done(),O.reject(f)));r.push(h)}l.isDone?s():l.G===null?a.continue():a.continue(l.G)}}).next(()=>O.waitFor(r))}options(e,n){let r;return e!==void 0&&(typeof e=="string"?r=e:n=e),{index:r,range:n}}cursor(e){let n="next";if(e.reverse&&(n="prev"),e.index){const r=this.store.index(e.index);return e.X?r.openKeyCursor(e.range,n):r.openCursor(e.range,n)}return this.store.openCursor(e.range,n)}}function Oi(t){return new O((e,n)=>{t.onsuccess=r=>{const s=r.target.result;e(s)},t.onerror=r=>{const s=Uy(r.target.error);n(s)}})}let RE=!1;function Uy(t){const e=oi.M(Lt());if(e>=12.2&&e<13){const n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){const r=new Q("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${n}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return RE||(RE=!0,setTimeout(()=>{throw r},0)),r}}return t}const Zl="IndexBackfiller";class wO{constructor(e,n){this.asyncQueue=e,this.ne=n,this.task=null}start(){this.re(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}re(e){W(Zl,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{const n=await this.ne.ie();W(Zl,`Documents written: ${n}`)}catch(n){Ei(n)?W(Zl,"Ignoring IndexedDB error during index backfill: ",n):await To(n)}await this.re(6e4)})}}class EO{constructor(e,n){this.localStore=e,this.persistence=n}async ie(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",n=>this.se(n,e))}se(e,n){const r=new Set;let s=n,i=!0;return O.doWhile(()=>i===!0&&s>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(o!==null&&!r.has(o))return W(Zl,`Processing collection: ${o}`),this.oe(e,o,s).next(a=>{s-=a,r.add(o)});i=!1})).next(()=>n-s)}oe(e,n,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,n).next(s=>this.localStore.localDocuments.getNextDocuments(e,n,s,r).next(i=>{const o=i.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this._e(s,i)).next(a=>(W(Zl,`Updating offset: ${a}`),this.localStore.indexManager.updateCollectionGroup(e,n,a))).next(()=>o.size)}))}_e(e,n){let r=e;return n.changes.forEach((s,i)=>{const o=db(i);Fy(o,r)>0&&(r=o)}),new Hn(r.readTime,r.documentKey,Math.max(n.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rr{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ae(r),this.ue=r=>n.writeSequenceNumber(r))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}rr.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gi=-1;function ef(t){return t==null}function Rc(t){return t===0&&1/t==-1/0}function IO(t){return typeof t=="number"&&Number.isInteger(t)&&!Rc(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ih="";function cn(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=PE(e)),e=xO(t.get(n),e);return PE(e)}function xO(t,e){let n=e;const r=t.length;for(let s=0;s<r;s++){const i=t.charAt(s);switch(i){case"\0":n+="";break;case ih:n+="";break;default:n+=i}}return n}function PE(t){return t+ih+""}function Ur(t){const e=t.length;if(he(e>=2,64408,{path:t}),e===2)return he(t.charAt(0)===ih&&t.charAt(1)==="",56145,{path:t}),We.emptyPath();const n=e-2,r=[];let s="";for(let i=0;i<e;){const o=t.indexOf(ih,i);switch((o<0||o>n)&&le(50515,{path:t}),t.charAt(o+1)){case"":const a=t.substring(i,o);let l;s.length===0?l=a:(s+=a,l=s,s=""),r.push(l);break;case"":s+=t.substring(i,o),s+="\0";break;case"":s+=t.substring(i,o+1);break;default:le(61167,{path:t})}i=o+2}return new We(r)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ji="remoteDocuments",Yc="owner",Po="owner",Pc="mutationQueues",TO="userId",gr="mutations",NE="batchId",zi="userMutationsIndex",kE=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pd(t,e){return[t,cn(e)]}function mb(t,e,n){return[t,cn(e),n]}const SO={},Pa="documentMutations",oh="remoteDocumentsV14",bO=["prefixPath","collectionGroup","readTime","documentId"],md="documentKeyIndex",CO=["prefixPath","collectionGroup","documentId"],gb="collectionGroupIndex",AO=["collectionGroup","readTime","prefixPath","documentId"],Nc="remoteDocumentGlobal",Xm="remoteDocumentGlobalKey",Na="targets",yb="queryTargetsIndex",RO=["canonicalId","targetId"],ka="targetDocuments",PO=["targetId","path"],$y="documentTargetsIndex",NO=["path","targetId"],ah="targetGlobalKey",Ki="targetGlobal",kc="collectionParents",kO=["collectionId","parent"],Da="clientMetadata",DO="clientId",tf="bundles",jO="bundleId",nf="namedQueries",OO="name",By="indexConfiguration",VO="indexId",Jm="collectionGroupIndex",LO="collectionGroup",ec="indexState",MO=["indexId","uid"],vb="sequenceNumberIndex",FO=["uid","sequenceNumber"],tc="indexEntries",UO=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],_b="documentKeyIndex",$O=["indexId","uid","orderedDocumentKey"],rf="documentOverlays",BO=["userId","collectionPath","documentId"],Zm="collectionPathOverlayIndex",zO=["userId","collectionPath","largestBatchId"],wb="collectionGroupOverlayIndex",qO=["userId","collectionGroup","largestBatchId"],zy="globals",HO="name",Eb=[Pc,gr,Pa,ji,Na,Yc,Ki,ka,Da,Nc,kc,tf,nf],WO=[...Eb,rf],Ib=[Pc,gr,Pa,oh,Na,Yc,Ki,ka,Da,Nc,kc,tf,nf,rf],xb=Ib,qy=[...xb,By,ec,tc],GO=qy,Tb=[...qy,zy],KO=Tb;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eg extends fb{constructor(e,n){super(),this.le=e,this.currentSequenceNumber=n}}function Mt(t,e){const n=Ee(t);return oi.O(n.le,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DE(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Ii(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function QO(t,e){const n=[];for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&n.push(e(t[r],r,t));return n}function Sb(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ft{constructor(e,n){this.comparator=e,this.root=n||Qt.EMPTY}insert(e,n){return new ft(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,Qt.BLACK,null,null))}remove(e){return new ft(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Qt.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(e,r.key);if(s===0)return n+r.left.size;s<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Mu(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Mu(this.root,e,this.comparator,!1)}getReverseIterator(){return new Mu(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Mu(this.root,e,this.comparator,!0)}}class Mu{constructor(e,n,r,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=n?r(e.key,n):1,n&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Qt{constructor(e,n,r,s,i){this.key=e,this.value=n,this.color=r??Qt.RED,this.left=s??Qt.EMPTY,this.right=i??Qt.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,s,i){return new Qt(e??this.key,n??this.value,r??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let s=this;const i=r(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,n,r),null):i===0?s.copy(null,n,null,null,null):s.copy(null,null,null,null,s.right.insert(e,n,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return Qt.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,s=this;if(n(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,n),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),n(e,s.key)===0){if(s.right.isEmpty())return Qt.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,n))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Qt.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Qt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw le(43730,{key:this.key,value:this.value});if(this.right.isRed())throw le(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw le(27949);return e+(this.isRed()?0:1)}}Qt.EMPTY=null,Qt.RED=!0,Qt.BLACK=!1;Qt.EMPTY=new class{constructor(){this.size=0}get key(){throw le(57766)}get value(){throw le(16141)}get color(){throw le(16727)}get left(){throw le(29726)}get right(){throw le(36894)}copy(e,n,r,s,i){return this}insert(e,n,r){return new Qt(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tt{constructor(e){this.comparator=e,this.data=new ft(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,e[1])>=0)return;n(s.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new jE(this.data.getIterator())}getIteratorFrom(e){return new jE(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof tt)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new tt(this.comparator);return n.data=e,n}}class jE{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function No(t){return t.hasNext()?t.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rn{constructor(e){this.fields=e,e.sort(mt.comparator)}static empty(){return new Rn([])}unionWith(e){let n=new tt(mt.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new Rn(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return Ra(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bb extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kt{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(s){try{return atob(s)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new bb("Invalid base64 string: "+i):i}}(e);return new kt(n)}static fromUint8Array(e){const n=function(s){let i="";for(let o=0;o<s.length;++o)i+=String.fromCharCode(s[o]);return i}(e);return new kt(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Ie(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}kt.EMPTY_BYTE_STRING=new kt("");const YO=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ys(t){if(he(!!t,39018),typeof t=="string"){let e=0;const n=YO.exec(t);if(he(!!n,46558,{timestamp:t}),n[1]){let s=n[1];s=(s+"000000000").substr(0,9),e=Number(s)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:ut(t.seconds),nanos:ut(t.nanos)}}function ut(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function vs(t){return typeof t=="string"?kt.fromBase64String(t):kt.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cb="server_timestamp",Ab="__type__",Rb="__previous_value__",Pb="__local_write_time__";function sf(t){var n,r;return((r=(((n=t==null?void 0:t.mapValue)==null?void 0:n.fields)||{})[Ab])==null?void 0:r.stringValue)===Cb}function of(t){const e=t.mapValue.fields[Rb];return sf(e)?of(e):e}function Dc(t){const e=ys(t.mapValue.fields[Pb].timestampValue);return new Be(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XO{constructor(e,n,r,s,i,o,a,l,d,h){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=s,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=l,this.useFetchStreams=d,this.isUsingEmulator=h}}const lh="(default)";class ao{constructor(e,n){this.projectId=e,this.database=n||lh}static empty(){return new ao("","")}get isDefaultDatabase(){return this.database===lh}isEqual(e){return e instanceof ao&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hy="__type__",Nb="__max__",Gs={mapValue:{fields:{__type__:{stringValue:Nb}}}},Wy="__vector__",ja="value",gd={nullValue:"NULL_VALUE"};function ui(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?sf(t)?4:kb(t)?9007199254740991:af(t)?10:11:le(28295,{value:t})}function Qr(t,e){if(t===e)return!0;const n=ui(t);if(n!==ui(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Dc(t).isEqual(Dc(e));case 3:return function(s,i){if(typeof s.timestampValue=="string"&&typeof i.timestampValue=="string"&&s.timestampValue.length===i.timestampValue.length)return s.timestampValue===i.timestampValue;const o=ys(s.timestampValue),a=ys(i.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(s,i){return vs(s.bytesValue).isEqual(vs(i.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(s,i){return ut(s.geoPointValue.latitude)===ut(i.geoPointValue.latitude)&&ut(s.geoPointValue.longitude)===ut(i.geoPointValue.longitude)}(t,e);case 2:return function(s,i){if("integerValue"in s&&"integerValue"in i)return ut(s.integerValue)===ut(i.integerValue);if("doubleValue"in s&&"doubleValue"in i){const o=ut(s.doubleValue),a=ut(i.doubleValue);return o===a?Rc(o)===Rc(a):isNaN(o)&&isNaN(a)}return!1}(t,e);case 9:return Ra(t.arrayValue.values||[],e.arrayValue.values||[],Qr);case 10:case 11:return function(s,i){const o=s.mapValue.fields||{},a=i.mapValue.fields||{};if(DE(o)!==DE(a))return!1;for(const l in o)if(o.hasOwnProperty(l)&&(a[l]===void 0||!Qr(o[l],a[l])))return!1;return!0}(t,e);default:return le(52216,{left:t})}}function jc(t,e){return(t.values||[]).find(n=>Qr(n,e))!==void 0}function di(t,e){if(t===e)return 0;const n=ui(t),r=ui(e);if(n!==r)return Ie(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return Ie(t.booleanValue,e.booleanValue);case 2:return function(i,o){const a=ut(i.integerValue||i.doubleValue),l=ut(o.integerValue||o.doubleValue);return a<l?-1:a>l?1:a===l?0:isNaN(a)?isNaN(l)?0:-1:1}(t,e);case 3:return OE(t.timestampValue,e.timestampValue);case 4:return OE(Dc(t),Dc(e));case 5:return Qm(t.stringValue,e.stringValue);case 6:return function(i,o){const a=vs(i),l=vs(o);return a.compareTo(l)}(t.bytesValue,e.bytesValue);case 7:return function(i,o){const a=i.split("/"),l=o.split("/");for(let d=0;d<a.length&&d<l.length;d++){const h=Ie(a[d],l[d]);if(h!==0)return h}return Ie(a.length,l.length)}(t.referenceValue,e.referenceValue);case 8:return function(i,o){const a=Ie(ut(i.latitude),ut(o.latitude));return a!==0?a:Ie(ut(i.longitude),ut(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return VE(t.arrayValue,e.arrayValue);case 10:return function(i,o){var m,v,R,T;const a=i.fields||{},l=o.fields||{},d=(m=a[ja])==null?void 0:m.arrayValue,h=(v=l[ja])==null?void 0:v.arrayValue,f=Ie(((R=d==null?void 0:d.values)==null?void 0:R.length)||0,((T=h==null?void 0:h.values)==null?void 0:T.length)||0);return f!==0?f:VE(d,h)}(t.mapValue,e.mapValue);case 11:return function(i,o){if(i===Gs.mapValue&&o===Gs.mapValue)return 0;if(i===Gs.mapValue)return 1;if(o===Gs.mapValue)return-1;const a=i.fields||{},l=Object.keys(a),d=o.fields||{},h=Object.keys(d);l.sort(),h.sort();for(let f=0;f<l.length&&f<h.length;++f){const m=Qm(l[f],h[f]);if(m!==0)return m;const v=di(a[l[f]],d[h[f]]);if(v!==0)return v}return Ie(l.length,h.length)}(t.mapValue,e.mapValue);default:throw le(23264,{he:n})}}function OE(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return Ie(t,e);const n=ys(t),r=ys(e),s=Ie(n.seconds,r.seconds);return s!==0?s:Ie(n.nanos,r.nanos)}function VE(t,e){const n=t.values||[],r=e.values||[];for(let s=0;s<n.length&&s<r.length;++s){const i=di(n[s],r[s]);if(i)return i}return Ie(n.length,r.length)}function Oa(t){return tg(t)}function tg(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=ys(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return vs(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return ee.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",s=!0;for(const i of n.values||[])s?s=!1:r+=",",r+=tg(i);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let s="{",i=!0;for(const o of r)i?i=!1:s+=",",s+=`${o}:${tg(n.fields[o])}`;return s+"}"}(t.mapValue):le(61005,{value:t})}function yd(t){switch(ui(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=of(t);return e?16+yd(e):16;case 5:return 2*t.stringValue.length;case 6:return vs(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return function(r){return(r.values||[]).reduce((s,i)=>s+yd(i),0)}(t.arrayValue);case 10:case 11:return function(r){let s=0;return Ii(r.fields,(i,o)=>{s+=i.length+yd(o)}),s}(t.mapValue);default:throw le(13486,{value:t})}}function lo(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function ng(t){return!!t&&"integerValue"in t}function Oc(t){return!!t&&"arrayValue"in t}function LE(t){return!!t&&"nullValue"in t}function ME(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function vd(t){return!!t&&"mapValue"in t}function af(t){var n,r;return((r=(((n=t==null?void 0:t.mapValue)==null?void 0:n.fields)||{})[Hy])==null?void 0:r.stringValue)===Wy}function nc(t){if(t.geoPointValue)return{geoPointValue:{...t.geoPointValue}};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:{...t.timestampValue}};if(t.mapValue){const e={mapValue:{fields:{}}};return Ii(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=nc(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=nc(t.arrayValue.values[n]);return e}return{...t}}function kb(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===Nb}const Db={mapValue:{fields:{[Hy]:{stringValue:Wy},[ja]:{arrayValue:{}}}}};function JO(t){return"nullValue"in t?gd:"booleanValue"in t?{booleanValue:!1}:"integerValue"in t||"doubleValue"in t?{doubleValue:NaN}:"timestampValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in t?{stringValue:""}:"bytesValue"in t?{bytesValue:""}:"referenceValue"in t?lo(ao.empty(),ee.empty()):"geoPointValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in t?{arrayValue:{}}:"mapValue"in t?af(t)?Db:{mapValue:{}}:le(35942,{value:t})}function ZO(t){return"nullValue"in t?{booleanValue:!1}:"booleanValue"in t?{doubleValue:NaN}:"integerValue"in t||"doubleValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in t?{stringValue:""}:"stringValue"in t?{bytesValue:""}:"bytesValue"in t?lo(ao.empty(),ee.empty()):"referenceValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in t?{arrayValue:{}}:"arrayValue"in t?Db:"mapValue"in t?af(t)?{mapValue:{}}:Gs:le(61959,{value:t})}function FE(t,e){const n=di(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?-1:!t.inclusive&&e.inclusive?1:0}function UE(t,e){const n=di(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?1:!t.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class on{constructor(e){this.value=e}static empty(){return new on({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!vd(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=nc(n)}setAll(e){let n=mt.emptyPath(),r={},s=[];e.forEach((o,a)=>{if(!n.isImmediateParentOf(a)){const l=this.getFieldsMap(n);this.applyChanges(l,r,s),r={},s=[],n=a.popLast()}o?r[a.lastSegment()]=nc(o):s.push(a.lastSegment())});const i=this.getFieldsMap(n);this.applyChanges(i,r,s)}delete(e){const n=this.field(e.popLast());vd(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return Qr(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let s=n.mapValue.fields[e.get(r)];vd(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=s),n=s}return n.mapValue.fields}applyChanges(e,n,r){Ii(n,(s,i)=>e[s]=i);for(const s of r)delete e[s]}clone(){return new on(nc(this.value))}}function jb(t){const e=[];return Ii(t.fields,(n,r)=>{const s=new mt([n]);if(vd(r)){const i=jb(r.mapValue).fields;if(i.length===0)e.push(s);else for(const o of i)e.push(s.child(o))}else e.push(s)}),new Rn(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wt{constructor(e,n,r,s,i,o,a){this.key=e,this.documentType=n,this.version=r,this.readTime=s,this.createTime=i,this.data=o,this.documentState=a}static newInvalidDocument(e){return new wt(e,0,fe.min(),fe.min(),fe.min(),on.empty(),0)}static newFoundDocument(e,n,r,s){return new wt(e,1,n,fe.min(),r,s,0)}static newNoDocument(e,n){return new wt(e,2,n,fe.min(),fe.min(),on.empty(),0)}static newUnknownDocument(e,n){return new wt(e,3,n,fe.min(),fe.min(),on.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(fe.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=on.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=on.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=fe.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof wt&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new wt(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hi{constructor(e,n){this.position=e,this.inclusive=n}}function $E(t,e,n){let r=0;for(let s=0;s<t.position.length;s++){const i=e[s],o=t.position[s];if(i.field.isKeyField()?r=ee.comparator(ee.fromName(o.referenceValue),n.key):r=di(o,n.data.field(i.field)),i.dir==="desc"&&(r*=-1),r!==0)break}return r}function BE(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!Qr(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vc{constructor(e,n="asc"){this.field=e,this.dir=n}}function eV(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ob{}class Le extends Ob{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new tV(e,n,r):n==="array-contains"?new sV(e,r):n==="in"?new $b(e,r):n==="not-in"?new iV(e,r):n==="array-contains-any"?new oV(e,r):new Le(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new nV(e,r):new rV(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&n.nullValue===void 0&&this.matchesComparison(di(n,this.value)):n!==null&&ui(this.value)===ui(n)&&this.matchesComparison(di(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return le(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Ze extends Ob{constructor(e,n){super(),this.filters=e,this.op=n,this.Pe=null}static create(e,n){return new Ze(e,n)}matches(e){return Va(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function Va(t){return t.op==="and"}function rg(t){return t.op==="or"}function Gy(t){return Vb(t)&&Va(t)}function Vb(t){for(const e of t.filters)if(e instanceof Ze)return!1;return!0}function sg(t){if(t instanceof Le)return t.field.canonicalString()+t.op.toString()+Oa(t.value);if(Gy(t))return t.filters.map(e=>sg(e)).join(",");{const e=t.filters.map(n=>sg(n)).join(",");return`${t.op}(${e})`}}function Lb(t,e){return t instanceof Le?function(r,s){return s instanceof Le&&r.op===s.op&&r.field.isEqual(s.field)&&Qr(r.value,s.value)}(t,e):t instanceof Ze?function(r,s){return s instanceof Ze&&r.op===s.op&&r.filters.length===s.filters.length?r.filters.reduce((i,o,a)=>i&&Lb(o,s.filters[a]),!0):!1}(t,e):void le(19439)}function Mb(t,e){const n=t.filters.concat(e);return Ze.create(n,t.op)}function Fb(t){return t instanceof Le?function(n){return`${n.field.canonicalString()} ${n.op} ${Oa(n.value)}`}(t):t instanceof Ze?function(n){return n.op.toString()+" {"+n.getFilters().map(Fb).join(" ,")+"}"}(t):"Filter"}class tV extends Le{constructor(e,n,r){super(e,n,r),this.key=ee.fromName(r.referenceValue)}matches(e){const n=ee.comparator(e.key,this.key);return this.matchesComparison(n)}}class nV extends Le{constructor(e,n){super(e,"in",n),this.keys=Ub("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class rV extends Le{constructor(e,n){super(e,"not-in",n),this.keys=Ub("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function Ub(t,e){var n;return(((n=e.arrayValue)==null?void 0:n.values)||[]).map(r=>ee.fromName(r.referenceValue))}class sV extends Le{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return Oc(n)&&jc(n.arrayValue,this.value)}}class $b extends Le{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&jc(this.value.arrayValue,n)}}class iV extends Le{constructor(e,n){super(e,"not-in",n)}matches(e){if(jc(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&n.nullValue===void 0&&!jc(this.value.arrayValue,n)}}class oV extends Le{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!Oc(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>jc(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aV{constructor(e,n=null,r=[],s=[],i=null,o=null,a=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=s,this.limit=i,this.startAt=o,this.endAt=a,this.Te=null}}function ig(t,e=null,n=[],r=[],s=null,i=null,o=null){return new aV(t,e,n,r,s,i,o)}function co(t){const e=Ee(t);if(e.Te===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>sg(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(i){return i.field.canonicalString()+i.dir}(r)).join(","),ef(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>Oa(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>Oa(r)).join(",")),e.Te=n}return e.Te}function Xc(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!eV(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!Lb(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!BE(t.startAt,e.startAt)&&BE(t.endAt,e.endAt)}function ch(t){return ee.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}function uh(t,e){return t.filters.filter(n=>n instanceof Le&&n.field.isEqual(e))}function zE(t,e,n){let r=gd,s=!0;for(const i of uh(t,e)){let o=gd,a=!0;switch(i.op){case"<":case"<=":o=JO(i.value);break;case"==":case"in":case">=":o=i.value;break;case">":o=i.value,a=!1;break;case"!=":case"not-in":o=gd}FE({value:r,inclusive:s},{value:o,inclusive:a})<0&&(r=o,s=a)}if(n!==null){for(let i=0;i<t.orderBy.length;++i)if(t.orderBy[i].field.isEqual(e)){const o=n.position[i];FE({value:r,inclusive:s},{value:o,inclusive:n.inclusive})<0&&(r=o,s=n.inclusive);break}}return{value:r,inclusive:s}}function qE(t,e,n){let r=Gs,s=!0;for(const i of uh(t,e)){let o=Gs,a=!0;switch(i.op){case">=":case">":o=ZO(i.value),a=!1;break;case"==":case"in":case"<=":o=i.value;break;case"<":o=i.value,a=!1;break;case"!=":case"not-in":o=Gs}UE({value:r,inclusive:s},{value:o,inclusive:a})>0&&(r=o,s=a)}if(n!==null){for(let i=0;i<t.orderBy.length;++i)if(t.orderBy[i].field.isEqual(e)){const o=n.position[i];UE({value:r,inclusive:s},{value:o,inclusive:n.inclusive})>0&&(r=o,s=n.inclusive);break}}return{value:r,inclusive:s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xi{constructor(e,n=null,r=[],s=[],i=null,o="F",a=null,l=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=s,this.limit=i,this.limitType=o,this.startAt=a,this.endAt=l,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function lV(t,e,n,r,s,i,o,a){return new xi(t,e,n,r,s,i,o,a)}function Jc(t){return new xi(t)}function HE(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function Ky(t){return t.collectionGroup!==null}function ga(t){const e=Ee(t);if(e.Ie===null){e.Ie=[];const n=new Set;for(const i of e.explicitOrderBy)e.Ie.push(i),n.add(i.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new tt(mt.comparator);return o.filters.forEach(l=>{l.getFlattenedFilters().forEach(d=>{d.isInequality()&&(a=a.add(d.field))})}),a})(e).forEach(i=>{n.has(i.canonicalString())||i.isKeyField()||e.Ie.push(new Vc(i,r))}),n.has(mt.keyField().canonicalString())||e.Ie.push(new Vc(mt.keyField(),r))}return e.Ie}function ir(t){const e=Ee(t);return e.Ee||(e.Ee=Bb(e,ga(t))),e.Ee}function cV(t){const e=Ee(t);return e.de||(e.de=Bb(e,t.explicitOrderBy)),e.de}function Bb(t,e){if(t.limitType==="F")return ig(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(s=>{const i=s.dir==="desc"?"asc":"desc";return new Vc(s.field,i)});const n=t.endAt?new hi(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new hi(t.startAt.position,t.startAt.inclusive):null;return ig(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function og(t,e){const n=t.filters.concat([e]);return new xi(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function dh(t,e,n){return new xi(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function lf(t,e){return Xc(ir(t),ir(e))&&t.limitType===e.limitType}function zb(t){return`${co(ir(t))}|lt:${t.limitType}`}function qo(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(s=>Fb(s)).join(", ")}]`),ef(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(s=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(s)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(s=>Oa(s)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(s=>Oa(s)).join(",")),`Target(${r})`}(ir(t))}; limitType=${t.limitType})`}function Zc(t,e){return e.isFoundDocument()&&function(r,s){const i=s.key.path;return r.collectionGroup!==null?s.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(i):ee.isDocumentKey(r.path)?r.path.isEqual(i):r.path.isImmediateParentOf(i)}(t,e)&&function(r,s){for(const i of ga(r))if(!i.field.isKeyField()&&s.data.field(i.field)===null)return!1;return!0}(t,e)&&function(r,s){for(const i of r.filters)if(!i.matches(s))return!1;return!0}(t,e)&&function(r,s){return!(r.startAt&&!function(o,a,l){const d=$E(o,a,l);return o.inclusive?d<=0:d<0}(r.startAt,ga(r),s)||r.endAt&&!function(o,a,l){const d=$E(o,a,l);return o.inclusive?d>=0:d>0}(r.endAt,ga(r),s))}(t,e)}function uV(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function qb(t){return(e,n)=>{let r=!1;for(const s of ga(t)){const i=dV(s,e,n);if(i!==0)return i;r=r||s.field.isKeyField()}return 0}}function dV(t,e,n){const r=t.field.isKeyField()?ee.comparator(e.key,n.key):function(i,o,a){const l=o.data.field(i),d=a.data.field(i);return l!==null&&d!==null?di(l,d):le(42886)}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return le(19790,{direction:t.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ws{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[s,i]of r)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),s=this.inner[r];if(s===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,n]);s.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return r.length===1?delete this.inner[n]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(e){Ii(this.inner,(n,r)=>{for(const[s,i]of r)e(s,i)})}isEmpty(){return Sb(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hV=new ft(ee.comparator);function $n(){return hV}const Hb=new ft(ee.comparator);function Ol(...t){let e=Hb;for(const n of t)e=e.insert(n.key,n);return e}function Wb(t){let e=Hb;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function $r(){return rc()}function Gb(){return rc()}function rc(){return new ws(t=>t.toString(),(t,e)=>t.isEqual(e))}const fV=new ft(ee.comparator),pV=new tt(ee.comparator);function ke(...t){let e=pV;for(const n of t)e=e.add(n);return e}const mV=new tt(Ie);function gV(){return mV}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qy(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Rc(e)?"-0":e}}function Kb(t){return{integerValue:""+t}}function Qb(t,e){return IO(e)?Kb(e):Qy(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cf{constructor(){this._=void 0}}function yV(t,e,n){return t instanceof La?function(s,i){const o={fields:{[Ab]:{stringValue:Cb},[Pb]:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return i&&sf(i)&&(i=of(i)),i&&(o.fields[Rb]=i),{mapValue:o}}(n,e):t instanceof uo?Xb(t,e):t instanceof Ma?Jb(t,e):function(s,i){const o=Yb(s,i),a=WE(o)+WE(s.Ae);return ng(o)&&ng(s.Ae)?Kb(a):Qy(s.serializer,a)}(t,e)}function vV(t,e,n){return t instanceof uo?Xb(t,e):t instanceof Ma?Jb(t,e):n}function Yb(t,e){return t instanceof Fa?function(r){return ng(r)||function(i){return!!i&&"doubleValue"in i}(r)}(e)?e:{integerValue:0}:null}class La extends cf{}class uo extends cf{constructor(e){super(),this.elements=e}}function Xb(t,e){const n=Zb(e);for(const r of t.elements)n.some(s=>Qr(s,r))||n.push(r);return{arrayValue:{values:n}}}class Ma extends cf{constructor(e){super(),this.elements=e}}function Jb(t,e){let n=Zb(e);for(const r of t.elements)n=n.filter(s=>!Qr(s,r));return{arrayValue:{values:n}}}class Fa extends cf{constructor(e,n){super(),this.serializer=e,this.Ae=n}}function WE(t){return ut(t.integerValue||t.doubleValue)}function Zb(t){return Oc(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uf{constructor(e,n){this.field=e,this.transform=n}}function _V(t,e){return t.field.isEqual(e.field)&&function(r,s){return r instanceof uo&&s instanceof uo||r instanceof Ma&&s instanceof Ma?Ra(r.elements,s.elements,Qr):r instanceof Fa&&s instanceof Fa?Qr(r.Ae,s.Ae):r instanceof La&&s instanceof La}(t.transform,e.transform)}class wV{constructor(e,n){this.version=e,this.transformResults=n}}class an{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new an}static exists(e){return new an(void 0,e)}static updateTime(e){return new an(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function _d(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class df{}function eC(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new hf(t.key,an.none()):new Ja(t.key,t.data,an.none());{const n=t.data,r=on.empty();let s=new tt(mt.comparator);for(let i of e.fields)if(!s.has(i)){let o=n.field(i);o===null&&i.length>1&&(i=i.popLast(),o=n.field(i)),o===null?r.delete(i):r.set(i,o),s=s.add(i)}return new Es(t.key,r,new Rn(s.toArray()),an.none())}}function EV(t,e,n){t instanceof Ja?function(s,i,o){const a=s.value.clone(),l=KE(s.fieldTransforms,i,o.transformResults);a.setAll(l),i.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(t,e,n):t instanceof Es?function(s,i,o){if(!_d(s.precondition,i))return void i.convertToUnknownDocument(o.version);const a=KE(s.fieldTransforms,i,o.transformResults),l=i.data;l.setAll(tC(s)),l.setAll(a),i.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(t,e,n):function(s,i,o){i.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,n)}function sc(t,e,n,r){return t instanceof Ja?function(i,o,a,l){if(!_d(i.precondition,o))return a;const d=i.value.clone(),h=QE(i.fieldTransforms,l,o);return d.setAll(h),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),null}(t,e,n,r):t instanceof Es?function(i,o,a,l){if(!_d(i.precondition,o))return a;const d=QE(i.fieldTransforms,l,o),h=o.data;return h.setAll(tC(i)),h.setAll(d),o.convertToFoundDocument(o.version,h).setHasLocalMutations(),a===null?null:a.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(f=>f.field))}(t,e,n,r):function(i,o,a){return _d(i.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(t,e,n)}function IV(t,e){let n=null;for(const r of t.fieldTransforms){const s=e.data.field(r.field),i=Yb(r.transform,s||null);i!=null&&(n===null&&(n=on.empty()),n.set(r.field,i))}return n||null}function GE(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,s){return r===void 0&&s===void 0||!(!r||!s)&&Ra(r,s,(i,o)=>_V(i,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class Ja extends df{constructor(e,n,r,s=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class Es extends df{constructor(e,n,r,s,i=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function tC(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function KE(t,e,n){const r=new Map;he(t.length===n.length,32656,{Re:n.length,Ve:t.length});for(let s=0;s<n.length;s++){const i=t[s],o=i.transform,a=e.data.field(i.field);r.set(i.field,vV(o,a,n[s]))}return r}function QE(t,e,n){const r=new Map;for(const s of t){const i=s.transform,o=n.data.field(s.field);r.set(s.field,yV(i,o,e))}return r}class hf extends df{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class nC extends df{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yy{constructor(e,n,r,s){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&EV(i,e,r[s])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=sc(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=sc(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=Gb();return this.mutations.forEach(s=>{const i=e.get(s.key),o=i.overlayedDocument;let a=this.applyToLocalView(o,i.mutatedFields);a=n.has(s.key)?null:a;const l=eC(o,a);l!==null&&r.set(s.key,l),o.isValidDocument()||o.convertToNoDocument(fe.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),ke())}isEqual(e){return this.batchId===e.batchId&&Ra(this.mutations,e.mutations,(n,r)=>GE(n,r))&&Ra(this.baseMutations,e.baseMutations,(n,r)=>GE(n,r))}}class Xy{constructor(e,n,r,s){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=s}static from(e,n,r){he(e.mutations.length===r.length,58842,{me:e.mutations.length,fe:r.length});let s=function(){return fV}();const i=e.mutations;for(let o=0;o<i.length;o++)s=s.insert(i[o].key,r[o].version);return new Xy(e,n,r,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jy{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xV{constructor(e,n,r){this.alias=e,this.aggregateType=n,this.fieldPath=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TV{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Rt,Ue;function SV(t){switch(t){case $.OK:return le(64938);case $.CANCELLED:case $.UNKNOWN:case $.DEADLINE_EXCEEDED:case $.RESOURCE_EXHAUSTED:case $.INTERNAL:case $.UNAVAILABLE:case $.UNAUTHENTICATED:return!1;case $.INVALID_ARGUMENT:case $.NOT_FOUND:case $.ALREADY_EXISTS:case $.PERMISSION_DENIED:case $.FAILED_PRECONDITION:case $.ABORTED:case $.OUT_OF_RANGE:case $.UNIMPLEMENTED:case $.DATA_LOSS:return!0;default:return le(15467,{code:t})}}function rC(t){if(t===void 0)return mn("GRPC error has no .code"),$.UNKNOWN;switch(t){case Rt.OK:return $.OK;case Rt.CANCELLED:return $.CANCELLED;case Rt.UNKNOWN:return $.UNKNOWN;case Rt.DEADLINE_EXCEEDED:return $.DEADLINE_EXCEEDED;case Rt.RESOURCE_EXHAUSTED:return $.RESOURCE_EXHAUSTED;case Rt.INTERNAL:return $.INTERNAL;case Rt.UNAVAILABLE:return $.UNAVAILABLE;case Rt.UNAUTHENTICATED:return $.UNAUTHENTICATED;case Rt.INVALID_ARGUMENT:return $.INVALID_ARGUMENT;case Rt.NOT_FOUND:return $.NOT_FOUND;case Rt.ALREADY_EXISTS:return $.ALREADY_EXISTS;case Rt.PERMISSION_DENIED:return $.PERMISSION_DENIED;case Rt.FAILED_PRECONDITION:return $.FAILED_PRECONDITION;case Rt.ABORTED:return $.ABORTED;case Rt.OUT_OF_RANGE:return $.OUT_OF_RANGE;case Rt.UNIMPLEMENTED:return $.UNIMPLEMENTED;case Rt.DATA_LOSS:return $.DATA_LOSS;default:return le(39323,{code:t})}}(Ue=Rt||(Rt={}))[Ue.OK=0]="OK",Ue[Ue.CANCELLED=1]="CANCELLED",Ue[Ue.UNKNOWN=2]="UNKNOWN",Ue[Ue.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ue[Ue.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ue[Ue.NOT_FOUND=5]="NOT_FOUND",Ue[Ue.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ue[Ue.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ue[Ue.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ue[Ue.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ue[Ue.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ue[Ue.ABORTED=10]="ABORTED",Ue[Ue.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ue[Ue.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ue[Ue.INTERNAL=13]="INTERNAL",Ue[Ue.UNAVAILABLE=14]="UNAVAILABLE",Ue[Ue.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bV(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CV=new ii([4294967295,4294967295],0);function YE(t){const e=bV().encode(t),n=new eb;return n.update(e),new Uint8Array(n.digest())}function XE(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),s=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new ii([n,r],0),new ii([s,i],0)]}class Zy{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new Vl(`Invalid padding: ${n}`);if(r<0)throw new Vl(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Vl(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new Vl(`Invalid padding when bitmap length is 0: ${n}`);this.ge=8*e.length-n,this.pe=ii.fromNumber(this.ge)}ye(e,n,r){let s=e.add(n.multiply(ii.fromNumber(r)));return s.compare(CV)===1&&(s=new ii([s.getBits(0),s.getBits(1)],0)),s.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const n=YE(e),[r,s]=XE(n);for(let i=0;i<this.hashCount;i++){const o=this.ye(r,s,i);if(!this.we(o))return!1}return!0}static create(e,n,r){const s=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),o=new Zy(i,s,n);return r.forEach(a=>o.insert(a)),o}insert(e){if(this.ge===0)return;const n=YE(e),[r,s]=XE(n);for(let i=0;i<this.hashCount;i++){const o=this.ye(r,s,i);this.Se(o)}}Se(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class Vl extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ff{constructor(e,n,r,s,i){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const s=new Map;return s.set(e,eu.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new ff(fe.min(),s,new ft(Ie),$n(),ke())}}class eu{constructor(e,n,r,s,i){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new eu(r,n,ke(),ke(),ke())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wd{constructor(e,n,r,s){this.be=e,this.removedTargetIds=n,this.key=r,this.De=s}}class sC{constructor(e,n){this.targetId=e,this.Ce=n}}class iC{constructor(e,n,r=kt.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=s}}class JE{constructor(){this.ve=0,this.Fe=ZE(),this.Me=kt.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=ke(),n=ke(),r=ke();return this.Fe.forEach((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:n=n.add(s);break;case 1:r=r.add(s);break;default:le(38017,{changeType:i})}}),new eu(this.Me,this.xe,e,n,r)}qe(){this.Oe=!1,this.Fe=ZE()}Qe(e,n){this.Oe=!0,this.Fe=this.Fe.insert(e,n)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,he(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class AV{constructor(e){this.Ge=e,this.ze=new Map,this.je=$n(),this.Je=Fu(),this.He=Fu(),this.Ye=new ft(Ie)}Ze(e){for(const n of e.be)e.De&&e.De.isFoundDocument()?this.Xe(n,e.De):this.et(n,e.key,e.De);for(const n of e.removedTargetIds)this.et(n,e.key,e.De)}tt(e){this.forEachTarget(e,n=>{const r=this.nt(n);switch(e.state){case 0:this.rt(n)&&r.Le(e.resumeToken);break;case 1:r.Ke(),r.Ne||r.qe(),r.Le(e.resumeToken);break;case 2:r.Ke(),r.Ne||this.removeTarget(n);break;case 3:this.rt(n)&&(r.We(),r.Le(e.resumeToken));break;case 4:this.rt(n)&&(this.it(n),r.Le(e.resumeToken));break;default:le(56790,{state:e.state})}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.ze.forEach((r,s)=>{this.rt(s)&&n(s)})}st(e){const n=e.targetId,r=e.Ce.count,s=this.ot(n);if(s){const i=s.target;if(ch(i))if(r===0){const o=new ee(i.path);this.et(n,o,wt.newNoDocument(o,fe.min()))}else he(r===1,20013,{expectedCount:r});else{const o=this._t(n);if(o!==r){const a=this.ut(e),l=a?this.ct(a,e,o):1;if(l!==0){this.it(n);const d=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(n,d)}}}}}ut(e){const n=e.Ce.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:s=0},hashCount:i=0}=n;let o,a;try{o=vs(r).toUint8Array()}catch(l){if(l instanceof bb)return oo("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{a=new Zy(o,s,i)}catch(l){return oo(l instanceof Vl?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return a.ge===0?null:a}ct(e,n,r){return n.Ce.count===r-this.Pt(e,n.targetId)?0:2}Pt(e,n){const r=this.Ge.getRemoteKeysForTarget(n);let s=0;return r.forEach(i=>{const o=this.Ge.ht(),a=`projects/${o.projectId}/databases/${o.database}/documents/${i.path.canonicalString()}`;e.mightContain(a)||(this.et(n,i,null),s++)}),s}Tt(e){const n=new Map;this.ze.forEach((i,o)=>{const a=this.ot(o);if(a){if(i.current&&ch(a.target)){const l=new ee(a.target.path);this.It(l).has(o)||this.Et(o,l)||this.et(o,l,wt.newNoDocument(l,e))}i.Be&&(n.set(o,i.ke()),i.qe())}});let r=ke();this.He.forEach((i,o)=>{let a=!0;o.forEachWhile(l=>{const d=this.ot(l);return!d||d.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(i))}),this.je.forEach((i,o)=>o.setReadTime(e));const s=new ff(e,n,this.Ye,this.je,r);return this.je=$n(),this.Je=Fu(),this.He=Fu(),this.Ye=new ft(Ie),s}Xe(e,n){if(!this.rt(e))return;const r=this.Et(e,n.key)?2:0;this.nt(e).Qe(n.key,r),this.je=this.je.insert(n.key,n),this.Je=this.Je.insert(n.key,this.It(n.key).add(e)),this.He=this.He.insert(n.key,this.dt(n.key).add(e))}et(e,n,r){if(!this.rt(e))return;const s=this.nt(e);this.Et(e,n)?s.Qe(n,1):s.$e(n),this.He=this.He.insert(n,this.dt(n).delete(e)),this.He=this.He.insert(n,this.dt(n).add(e)),r&&(this.je=this.je.insert(n,r))}removeTarget(e){this.ze.delete(e)}_t(e){const n=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let n=this.ze.get(e);return n||(n=new JE,this.ze.set(e,n)),n}dt(e){let n=this.He.get(e);return n||(n=new tt(Ie),this.He=this.He.insert(e,n)),n}It(e){let n=this.Je.get(e);return n||(n=new tt(Ie),this.Je=this.Je.insert(e,n)),n}rt(e){const n=this.ot(e)!==null;return n||W("WatchChangeAggregator","Detected inactive target",e),n}ot(e){const n=this.ze.get(e);return n&&n.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new JE),this.Ge.getRemoteKeysForTarget(e).forEach(n=>{this.et(e,n,null)})}Et(e,n){return this.Ge.getRemoteKeysForTarget(e).has(n)}}function Fu(){return new ft(ee.comparator)}function ZE(){return new ft(ee.comparator)}const RV={asc:"ASCENDING",desc:"DESCENDING"},PV={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},NV={and:"AND",or:"OR"};class kV{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function ag(t,e){return t.useProto3Json||ef(e)?e:{value:e}}function Ua(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function oC(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function DV(t,e){return Ua(t,e.toTimestamp())}function _n(t){return he(!!t,49232),fe.fromTimestamp(function(n){const r=ys(n);return new Be(r.seconds,r.nanos)}(t))}function ev(t,e){return lg(t,e).canonicalString()}function lg(t,e){const n=function(s){return new We(["projects",s.projectId,"databases",s.database])}(t).child("documents");return e===void 0?n:n.child(e)}function aC(t){const e=We.fromString(t);return he(mC(e),10190,{key:e.toString()}),e}function hh(t,e){return ev(t.databaseId,e.path)}function Qi(t,e){const n=aC(e);if(n.get(1)!==t.databaseId.projectId)throw new Q($.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new Q($.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new ee(uC(n))}function lC(t,e){return ev(t.databaseId,e)}function cC(t){const e=aC(t);return e.length===4?We.emptyPath():uC(e)}function cg(t){return new We(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function uC(t){return he(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function eI(t,e,n){return{name:hh(t,e),fields:n.value.mapValue.fields}}function jV(t,e,n){const r=Qi(t,e.name),s=_n(e.updateTime),i=e.createTime?_n(e.createTime):fe.min(),o=new on({mapValue:{fields:e.fields}}),a=wt.newFoundDocument(r,s,i,o);return n&&a.setHasCommittedMutations(),n?a.setHasCommittedMutations():a}function OV(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(d){return d==="NO_CHANGE"?0:d==="ADD"?1:d==="REMOVE"?2:d==="CURRENT"?3:d==="RESET"?4:le(39313,{state:d})}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=function(d,h){return d.useProto3Json?(he(h===void 0||typeof h=="string",58123),kt.fromBase64String(h||"")):(he(h===void 0||h instanceof Buffer||h instanceof Uint8Array,16193),kt.fromUint8Array(h||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(d){const h=d.code===void 0?$.UNKNOWN:rC(d.code);return new Q(h,d.message||"")}(o);n=new iC(r,s,i,a||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const s=Qi(t,r.document.name),i=_n(r.document.updateTime),o=r.document.createTime?_n(r.document.createTime):fe.min(),a=new on({mapValue:{fields:r.document.fields}}),l=wt.newFoundDocument(s,i,o,a),d=r.targetIds||[],h=r.removedTargetIds||[];n=new wd(d,h,l.key,l)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const s=Qi(t,r.document),i=r.readTime?_n(r.readTime):fe.min(),o=wt.newNoDocument(s,i),a=r.removedTargetIds||[];n=new wd([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const s=Qi(t,r.document),i=r.removedTargetIds||[];n=new wd([],i,s,null)}else{if(!("filter"in e))return le(11601,{Rt:e});{e.filter;const r=e.filter;r.targetId;const{count:s=0,unchangedNames:i}=r,o=new TV(s,i),a=r.targetId;n=new sC(a,o)}}return n}function fh(t,e){let n;if(e instanceof Ja)n={update:eI(t,e.key,e.value)};else if(e instanceof hf)n={delete:hh(t,e.key)};else if(e instanceof Es)n={update:eI(t,e.key,e.data),updateMask:BV(e.fieldMask)};else{if(!(e instanceof nC))return le(16599,{Vt:e.type});n={verify:hh(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(i,o){const a=o.transform;if(a instanceof La)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof uo)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof Ma)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof Fa)return{fieldPath:o.field.canonicalString(),increment:a.Ae};throw le(20930,{transform:o.transform})}(0,r))),e.precondition.isNone||(n.currentDocument=function(s,i){return i.updateTime!==void 0?{updateTime:DV(s,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:le(27497)}(t,e.precondition)),n}function ug(t,e){const n=e.currentDocument?function(i){return i.updateTime!==void 0?an.updateTime(_n(i.updateTime)):i.exists!==void 0?an.exists(i.exists):an.none()}(e.currentDocument):an.none(),r=e.updateTransforms?e.updateTransforms.map(s=>function(o,a){let l=null;if("setToServerValue"in a)he(a.setToServerValue==="REQUEST_TIME",16630,{proto:a}),l=new La;else if("appendMissingElements"in a){const h=a.appendMissingElements.values||[];l=new uo(h)}else if("removeAllFromArray"in a){const h=a.removeAllFromArray.values||[];l=new Ma(h)}else"increment"in a?l=new Fa(o,a.increment):le(16584,{proto:a});const d=mt.fromServerFormat(a.fieldPath);return new uf(d,l)}(t,s)):[];if(e.update){e.update.name;const s=Qi(t,e.update.name),i=new on({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=function(l){const d=l.fieldPaths||[];return new Rn(d.map(h=>mt.fromServerFormat(h)))}(e.updateMask);return new Es(s,i,o,n,r)}return new Ja(s,i,n,r)}if(e.delete){const s=Qi(t,e.delete);return new hf(s,n)}if(e.verify){const s=Qi(t,e.verify);return new nC(s,n)}return le(1463,{proto:e})}function VV(t,e){return t&&t.length>0?(he(e!==void 0,14353),t.map(n=>function(s,i){let o=s.updateTime?_n(s.updateTime):_n(i);return o.isEqual(fe.min())&&(o=_n(i)),new wV(o,s.transformResults||[])}(n,e))):[]}function dC(t,e){return{documents:[lC(t,e.path)]}}function tv(t,e){const n={structuredQuery:{}},r=e.path;let s;e.collectionGroup!==null?(s=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=lC(t,s);const i=function(d){if(d.length!==0)return pC(Ze.create(d,"and"))}(e.filters);i&&(n.structuredQuery.where=i);const o=function(d){if(d.length!==0)return d.map(h=>function(m){return{field:Bs(m.field),direction:FV(m.dir)}}(h))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);const a=ag(t,e.limit);return a!==null&&(n.structuredQuery.limit=a),e.startAt&&(n.structuredQuery.startAt=function(d){return{before:d.inclusive,values:d.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(d){return{before:!d.inclusive,values:d.position}}(e.endAt)),{ft:n,parent:s}}function LV(t,e,n,r){const{ft:s,parent:i}=tv(t,e),o={},a=[];let l=0;return n.forEach(d=>{const h="aggregate_"+l++;o[h]=d.alias,d.aggregateType==="count"?a.push({alias:h,count:{}}):d.aggregateType==="avg"?a.push({alias:h,avg:{field:Bs(d.fieldPath)}}):d.aggregateType==="sum"&&a.push({alias:h,sum:{field:Bs(d.fieldPath)}})}),{request:{structuredAggregationQuery:{aggregations:a,structuredQuery:s.structuredQuery},parent:s.parent},gt:o,parent:i}}function hC(t){let e=cC(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let s=null;if(r>0){he(r===1,65062);const h=n.from[0];h.allDescendants?s=h.collectionId:e=e.child(h.collectionId)}let i=[];n.where&&(i=function(f){const m=fC(f);return m instanceof Ze&&Gy(m)?m.getFilters():[m]}(n.where));let o=[];n.orderBy&&(o=function(f){return f.map(m=>function(R){return new Vc(Ho(R.field),function(P){switch(P){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(R.direction))}(m))}(n.orderBy));let a=null;n.limit&&(a=function(f){let m;return m=typeof f=="object"?f.value:f,ef(m)?null:m}(n.limit));let l=null;n.startAt&&(l=function(f){const m=!!f.before,v=f.values||[];return new hi(v,m)}(n.startAt));let d=null;return n.endAt&&(d=function(f){const m=!f.before,v=f.values||[];return new hi(v,m)}(n.endAt)),lV(e,s,o,i,a,"F",l,d)}function MV(t,e){const n=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return le(28987,{purpose:s})}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function fC(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=Ho(n.unaryFilter.field);return Le.create(r,"==",{doubleValue:NaN});case"IS_NULL":const s=Ho(n.unaryFilter.field);return Le.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=Ho(n.unaryFilter.field);return Le.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=Ho(n.unaryFilter.field);return Le.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return le(61313);default:return le(60726)}}(t):t.fieldFilter!==void 0?function(n){return Le.create(Ho(n.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return le(58110);default:return le(50506)}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return Ze.create(n.compositeFilter.filters.map(r=>fC(r)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return le(1026)}}(n.compositeFilter.op))}(t):le(30097,{filter:t})}function FV(t){return RV[t]}function UV(t){return PV[t]}function $V(t){return NV[t]}function Bs(t){return{fieldPath:t.canonicalString()}}function Ho(t){return mt.fromServerFormat(t.fieldPath)}function pC(t){return t instanceof Le?function(n){if(n.op==="=="){if(ME(n.value))return{unaryFilter:{field:Bs(n.field),op:"IS_NAN"}};if(LE(n.value))return{unaryFilter:{field:Bs(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(ME(n.value))return{unaryFilter:{field:Bs(n.field),op:"IS_NOT_NAN"}};if(LE(n.value))return{unaryFilter:{field:Bs(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Bs(n.field),op:UV(n.op),value:n.value}}}(t):t instanceof Ze?function(n){const r=n.getFilters().map(s=>pC(s));return r.length===1?r[0]:{compositeFilter:{op:$V(n.op),filters:r}}}(t):le(54877,{filter:t})}function BV(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function mC(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class os{constructor(e,n,r,s,i=fe.min(),o=fe.min(),a=kt.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=l}withSequenceNumber(e){return new os(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new os(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new os(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new os(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gC{constructor(e){this.yt=e}}function zV(t,e){let n;if(e.document)n=jV(t.yt,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=ee.fromSegments(e.noDocument.path),s=fo(e.noDocument.readTime);n=wt.newNoDocument(r,s),e.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!e.unknownDocument)return le(56709);{const r=ee.fromSegments(e.unknownDocument.path),s=fo(e.unknownDocument.version);n=wt.newUnknownDocument(r,s)}}return e.readTime&&n.setReadTime(function(s){const i=new Be(s[0],s[1]);return fe.fromTimestamp(i)}(e.readTime)),n}function tI(t,e){const n=e.key,r={prefixPath:n.getCollectionPath().popLast().toArray(),collectionGroup:n.collectionGroup,documentId:n.path.lastSegment(),readTime:ph(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=function(i,o){return{name:hh(i,o.key),fields:o.data.value.mapValue.fields,updateTime:Ua(i,o.version.toTimestamp()),createTime:Ua(i,o.createTime.toTimestamp())}}(t.yt,e);else if(e.isNoDocument())r.noDocument={path:n.path.toArray(),readTime:ho(e.version)};else{if(!e.isUnknownDocument())return le(57904,{document:e});r.unknownDocument={path:n.path.toArray(),version:ho(e.version)}}return r}function ph(t){const e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function ho(t){const e=t.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function fo(t){const e=new Be(t.seconds,t.nanoseconds);return fe.fromTimestamp(e)}function Vi(t,e){const n=(e.baseMutations||[]).map(i=>ug(t.yt,i));for(let i=0;i<e.mutations.length-1;++i){const o=e.mutations[i];if(i+1<e.mutations.length&&e.mutations[i+1].transform!==void 0){const a=e.mutations[i+1];o.updateTransforms=a.transform.fieldTransforms,e.mutations.splice(i+1,1),++i}}const r=e.mutations.map(i=>ug(t.yt,i)),s=Be.fromMillis(e.localWriteTimeMs);return new Yy(e.batchId,s,n,r)}function Ll(t){const e=fo(t.readTime),n=t.lastLimboFreeSnapshotVersion!==void 0?fo(t.lastLimboFreeSnapshotVersion):fe.min();let r;return r=function(i){return i.documents!==void 0}(t.query)?function(i){const o=i.documents.length;return he(o===1,1966,{count:o}),ir(Jc(cC(i.documents[0])))}(t.query):function(i){return ir(hC(i))}(t.query),new os(r,t.targetId,"TargetPurposeListen",t.lastListenSequenceNumber,e,n,kt.fromBase64String(t.resumeToken))}function yC(t,e){const n=ho(e.snapshotVersion),r=ho(e.lastLimboFreeSnapshotVersion);let s;s=ch(e.target)?dC(t.yt,e.target):tv(t.yt,e.target).ft;const i=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:co(e.target),readTime:n,resumeToken:i,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:s}}function vC(t){const e=hC({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?dh(e,e.limit,"L"):e}function Sp(t,e){return new Jy(e.largestBatchId,ug(t.yt,e.overlayMutation))}function nI(t,e){const n=e.path.lastSegment();return[t,cn(e.path.popLast()),n]}function rI(t,e,n,r){return{indexId:t,uid:e,sequenceNumber:n,readTime:ho(r.readTime),documentKey:cn(r.documentKey.path),largestBatchId:r.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qV{getBundleMetadata(e,n){return sI(e).get(n).next(r=>{if(r)return function(i){return{id:i.bundleId,createTime:fo(i.createTime),version:i.version}}(r)})}saveBundleMetadata(e,n){return sI(e).put(function(s){return{bundleId:s.id,createTime:ho(_n(s.createTime)),version:s.version}}(n))}getNamedQuery(e,n){return iI(e).get(n).next(r=>{if(r)return function(i){return{name:i.name,query:vC(i.bundledQuery),readTime:fo(i.readTime)}}(r)})}saveNamedQuery(e,n){return iI(e).put(function(s){return{name:s.name,readTime:ho(_n(s.readTime)),bundledQuery:s.bundledQuery}}(n))}}function sI(t){return Mt(t,tf)}function iI(t){return Mt(t,nf)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pf{constructor(e,n){this.serializer=e,this.userId=n}static wt(e,n){const r=n.uid||"";return new pf(e,r)}getOverlay(e,n){return El(e).get(nI(this.userId,n)).next(r=>r?Sp(this.serializer,r):null)}getOverlays(e,n){const r=$r();return O.forEach(n,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,n,r){const s=[];return r.forEach((i,o)=>{const a=new Jy(n,o);s.push(this.St(e,a))}),O.waitFor(s)}removeOverlaysForBatchId(e,n,r){const s=new Set;n.forEach(o=>s.add(cn(o.getCollectionPath())));const i=[];return s.forEach(o=>{const a=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,r+1],!1,!0);i.push(El(e).Z(Zm,a))}),O.waitFor(i)}getOverlaysForCollection(e,n,r){const s=$r(),i=cn(n),o=IDBKeyRange.bound([this.userId,i,r],[this.userId,i,Number.POSITIVE_INFINITY],!0);return El(e).J(Zm,o).next(a=>{for(const l of a){const d=Sp(this.serializer,l);s.set(d.getKey(),d)}return s})}getOverlaysForCollectionGroup(e,n,r,s){const i=$r();let o;const a=IDBKeyRange.bound([this.userId,n,r],[this.userId,n,Number.POSITIVE_INFINITY],!0);return El(e).ee({index:wb,range:a},(l,d,h)=>{const f=Sp(this.serializer,d);i.size()<s||f.largestBatchId===o?(i.set(f.getKey(),f),o=f.largestBatchId):h.done()}).next(()=>i)}St(e,n){return El(e).put(function(s,i,o){const[a,l,d]=nI(i,o.mutation.key);return{userId:i,collectionPath:l,documentId:d,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:fh(s.yt,o.mutation)}}(this.serializer,this.userId,n))}}function El(t){return Mt(t,rf)}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HV{bt(e){return Mt(e,zy)}getSessionToken(e){return this.bt(e).get("sessionToken").next(n=>{const r=n==null?void 0:n.value;return r?kt.fromUint8Array(r):kt.EMPTY_BYTE_STRING})}setSessionToken(e,n){return this.bt(e).put({name:"sessionToken",value:n.toUint8Array()})}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Li{constructor(){}Dt(e,n){this.Ct(e,n),n.vt()}Ct(e,n){if("nullValue"in e)this.Ft(n,5);else if("booleanValue"in e)this.Ft(n,10),n.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(n,15),n.Mt(ut(e.integerValue));else if("doubleValue"in e){const r=ut(e.doubleValue);isNaN(r)?this.Ft(n,13):(this.Ft(n,15),Rc(r)?n.Mt(0):n.Mt(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Ft(n,20),typeof r=="string"&&(r=ys(r)),n.xt(`${r.seconds||""}`),n.Mt(r.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,n),this.Nt(n);else if("bytesValue"in e)this.Ft(n,30),n.Bt(vs(e.bytesValue)),this.Nt(n);else if("referenceValue"in e)this.Lt(e.referenceValue,n);else if("geoPointValue"in e){const r=e.geoPointValue;this.Ft(n,45),n.Mt(r.latitude||0),n.Mt(r.longitude||0)}else"mapValue"in e?kb(e)?this.Ft(n,Number.MAX_SAFE_INTEGER):af(e)?this.kt(e.mapValue,n):(this.qt(e.mapValue,n),this.Nt(n)):"arrayValue"in e?(this.Qt(e.arrayValue,n),this.Nt(n)):le(19022,{$t:e})}Ot(e,n){this.Ft(n,25),this.Ut(e,n)}Ut(e,n){n.xt(e)}qt(e,n){const r=e.fields||{};this.Ft(n,55);for(const s of Object.keys(r))this.Ot(s,n),this.Ct(r[s],n)}kt(e,n){var o,a;const r=e.fields||{};this.Ft(n,53);const s=ja,i=((a=(o=r[s].arrayValue)==null?void 0:o.values)==null?void 0:a.length)||0;this.Ft(n,15),n.Mt(ut(i)),this.Ot(s,n),this.Ct(r[s],n)}Qt(e,n){const r=e.values||[];this.Ft(n,50);for(const s of r)this.Ct(s,n)}Lt(e,n){this.Ft(n,37),ee.fromName(e).path.forEach(r=>{this.Ft(n,60),this.Ut(r,n)})}Ft(e,n){e.Mt(n)}Nt(e){e.Mt(2)}}Li.Kt=new Li;/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law | agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES | CONDITIONS OF ANY KIND, either express | implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ko=255;function WV(t){if(t===0)return 8;let e=0;return t>>4||(e+=4,t<<=4),t>>6||(e+=2,t<<=2),t>>7||(e+=1),e}function oI(t){const e=64-function(r){let s=0;for(let i=0;i<8;++i){const o=WV(255&r[i]);if(s+=o,o!==8)break}return s}(t);return Math.ceil(e/8)}class GV{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Wt(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.Gt(r.value),r=n.next();this.zt()}jt(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.Jt(r.value),r=n.next();this.Ht()}Yt(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.Gt(r);else if(r<2048)this.Gt(960|r>>>6),this.Gt(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Gt(480|r>>>12),this.Gt(128|63&r>>>6),this.Gt(128|63&r);else{const s=n.codePointAt(0);this.Gt(240|s>>>18),this.Gt(128|63&s>>>12),this.Gt(128|63&s>>>6),this.Gt(128|63&s)}}this.zt()}Zt(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.Jt(r);else if(r<2048)this.Jt(960|r>>>6),this.Jt(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Jt(480|r>>>12),this.Jt(128|63&r>>>6),this.Jt(128|63&r);else{const s=n.codePointAt(0);this.Jt(240|s>>>18),this.Jt(128|63&s>>>12),this.Jt(128|63&s>>>6),this.Jt(128|63&s)}}this.Ht()}Xt(e){const n=this.en(e),r=oI(n);this.tn(1+r),this.buffer[this.position++]=255&r;for(let s=n.length-r;s<n.length;++s)this.buffer[this.position++]=255&n[s]}nn(e){const n=this.en(e),r=oI(n);this.tn(1+r),this.buffer[this.position++]=~(255&r);for(let s=n.length-r;s<n.length;++s)this.buffer[this.position++]=~(255&n[s])}rn(){this.sn(ko),this.sn(255)}_n(){this.an(ko),this.an(255)}reset(){this.position=0}seed(e){this.tn(e.length),this.buffer.set(e,this.position),this.position+=e.length}un(){return this.buffer.slice(0,this.position)}en(e){const n=function(i){const o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,i,!1),new Uint8Array(o.buffer)}(e),r=!!(128&n[0]);n[0]^=r?255:128;for(let s=1;s<n.length;++s)n[s]^=r?255:0;return n}Gt(e){const n=255&e;n===0?(this.sn(0),this.sn(255)):n===ko?(this.sn(ko),this.sn(0)):this.sn(n)}Jt(e){const n=255&e;n===0?(this.an(0),this.an(255)):n===ko?(this.an(ko),this.an(0)):this.an(e)}zt(){this.sn(0),this.sn(1)}Ht(){this.an(0),this.an(1)}sn(e){this.tn(1),this.buffer[this.position++]=e}an(e){this.tn(1),this.buffer[this.position++]=~e}tn(e){const n=e+this.position;if(n<=this.buffer.length)return;let r=2*this.buffer.length;r<n&&(r=n);const s=new Uint8Array(r);s.set(this.buffer),this.buffer=s}}class KV{constructor(e){this.cn=e}Bt(e){this.cn.Wt(e)}xt(e){this.cn.Yt(e)}Mt(e){this.cn.Xt(e)}vt(){this.cn.rn()}}class QV{constructor(e){this.cn=e}Bt(e){this.cn.jt(e)}xt(e){this.cn.Zt(e)}Mt(e){this.cn.nn(e)}vt(){this.cn._n()}}class Il{constructor(){this.cn=new GV,this.ln=new KV(this.cn),this.hn=new QV(this.cn)}seed(e){this.cn.seed(e)}Pn(e){return e===0?this.ln:this.hn}un(){return this.cn.un()}reset(){this.cn.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mi{constructor(e,n,r,s){this.Tn=e,this.In=n,this.En=r,this.dn=s}An(){const e=this.dn.length,n=e===0||this.dn[e-1]===255?e+1:e,r=new Uint8Array(n);return r.set(this.dn,0),n!==e?r.set([0],this.dn.length):++r[r.length-1],new Mi(this.Tn,this.In,this.En,r)}Rn(e,n,r){return{indexId:this.Tn,uid:e,arrayValue:Ed(this.En),directionalValue:Ed(this.dn),orderedDocumentKey:Ed(n),documentKey:r.path.toArray()}}Vn(e,n,r){const s=this.Rn(e,n,r);return[s.indexId,s.uid,s.arrayValue,s.directionalValue,s.orderedDocumentKey,s.documentKey]}}function Ps(t,e){let n=t.Tn-e.Tn;return n!==0?n:(n=aI(t.En,e.En),n!==0?n:(n=aI(t.dn,e.dn),n!==0?n:ee.comparator(t.In,e.In)))}function aI(t,e){for(let n=0;n<t.length&&n<e.length;++n){const r=t[n]-e[n];if(r!==0)return r}return t.length-e.length}function Ed(t){return hS()?function(n){let r="";for(let s=0;s<n.length;s++)r+=String.fromCharCode(n[s]);return r}(t):t}function lI(t){return typeof t!="string"?t:function(n){const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}(t)}class cI{constructor(e){this.mn=new tt((n,r)=>mt.comparator(n.field,r.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.fn=e.orderBy,this.gn=[];for(const n of e.filters){const r=n;r.isInequality()?this.mn=this.mn.add(r):this.gn.push(r)}}get pn(){return this.mn.size>1}yn(e){if(he(e.collectionGroup===this.collectionId,49279),this.pn)return!1;const n=Ym(e);if(n!==void 0&&!this.wn(n))return!1;const r=Di(e);let s=new Set,i=0,o=0;for(;i<r.length&&this.wn(r[i]);++i)s=s.add(r[i].fieldPath.canonicalString());if(i===r.length)return!0;if(this.mn.size>0){const a=this.mn.getIterator().getNext();if(!s.has(a.field.canonicalString())){const l=r[i];if(!this.Sn(a,l)||!this.bn(this.fn[o++],l))return!1}++i}for(;i<r.length;++i){const a=r[i];if(o>=this.fn.length||!this.bn(this.fn[o++],a))return!1}return!0}Dn(){if(this.pn)return null;let e=new tt(mt.comparator);const n=[];for(const r of this.gn)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")n.push(new fd(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),n.push(new fd(r.field,0))}for(const r of this.fn)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),n.push(new fd(r.field,r.dir==="asc"?0:1)));return new sh(sh.UNKNOWN_ID,this.collectionId,n,Ac.empty())}wn(e){for(const n of this.gn)if(this.Sn(n,e))return!0;return!1}Sn(e,n){if(e===void 0||!e.field.isEqual(n.fieldPath))return!1;const r=e.op==="array-contains"||e.op==="array-contains-any";return n.kind===2===r}bn(e,n){return!!e.field.isEqual(n.fieldPath)&&(n.kind===0&&e.dir==="asc"||n.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _C(t){var n,r;if(he(t instanceof Le||t instanceof Ze,20012),t instanceof Le){if(t instanceof $b){const s=((r=(n=t.value.arrayValue)==null?void 0:n.values)==null?void 0:r.map(i=>Le.create(t.field,"==",i)))||[];return Ze.create(s,"or")}return t}const e=t.filters.map(s=>_C(s));return Ze.create(e,t.op)}function YV(t){if(t.getFilters().length===0)return[];const e=fg(_C(t));return he(wC(e),7391),dg(e)||hg(e)?[e]:e.getFilters()}function dg(t){return t instanceof Le}function hg(t){return t instanceof Ze&&Gy(t)}function wC(t){return dg(t)||hg(t)||function(n){if(n instanceof Ze&&rg(n)){for(const r of n.getFilters())if(!dg(r)&&!hg(r))return!1;return!0}return!1}(t)}function fg(t){if(he(t instanceof Le||t instanceof Ze,34018),t instanceof Le)return t;if(t.filters.length===1)return fg(t.filters[0]);const e=t.filters.map(r=>fg(r));let n=Ze.create(e,t.op);return n=mh(n),wC(n)?n:(he(n instanceof Ze,64498),he(Va(n),40251),he(n.filters.length>1,57927),n.filters.reduce((r,s)=>nv(r,s)))}function nv(t,e){let n;return he(t instanceof Le||t instanceof Ze,38388),he(e instanceof Le||e instanceof Ze,25473),n=t instanceof Le?e instanceof Le?function(s,i){return Ze.create([s,i],"and")}(t,e):uI(t,e):e instanceof Le?uI(e,t):function(s,i){if(he(s.filters.length>0&&i.filters.length>0,48005),Va(s)&&Va(i))return Mb(s,i.getFilters());const o=rg(s)?s:i,a=rg(s)?i:s,l=o.filters.map(d=>nv(d,a));return Ze.create(l,"or")}(t,e),mh(n)}function uI(t,e){if(Va(e))return Mb(e,t.getFilters());{const n=e.filters.map(r=>nv(t,r));return Ze.create(n,"or")}}function mh(t){if(he(t instanceof Le||t instanceof Ze,11850),t instanceof Le)return t;const e=t.getFilters();if(e.length===1)return mh(e[0]);if(Vb(t))return t;const n=e.map(s=>mh(s)),r=[];return n.forEach(s=>{s instanceof Le?r.push(s):s instanceof Ze&&(s.op===t.op?r.push(...s.filters):r.push(s))}),r.length===1?r[0]:Ze.create(r,t.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XV{constructor(){this.Cn=new rv}addToCollectionParentIndex(e,n){return this.Cn.add(n),O.resolve()}getCollectionParents(e,n){return O.resolve(this.Cn.getEntries(n))}addFieldIndex(e,n){return O.resolve()}deleteFieldIndex(e,n){return O.resolve()}deleteAllFieldIndexes(e){return O.resolve()}createTargetIndexes(e,n){return O.resolve()}getDocumentsMatchingTarget(e,n){return O.resolve(null)}getIndexType(e,n){return O.resolve(0)}getFieldIndexes(e,n){return O.resolve([])}getNextCollectionGroupToUpdate(e){return O.resolve(null)}getMinOffset(e,n){return O.resolve(Hn.min())}getMinOffsetFromCollectionGroup(e,n){return O.resolve(Hn.min())}updateCollectionGroup(e,n,r){return O.resolve()}updateIndexEntries(e,n){return O.resolve()}}class rv{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n]||new tt(We.comparator),i=!s.has(r);return this.index[n]=s.add(r),i}has(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n];return s&&s.has(r)}getEntries(e){return(this.index[e]||new tt(We.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dI="IndexedDbIndexManager",Uu=new Uint8Array(0);class JV{constructor(e,n){this.databaseId=n,this.vn=new rv,this.Fn=new ws(r=>co(r),(r,s)=>Xc(r,s)),this.uid=e.uid||""}addToCollectionParentIndex(e,n){if(!this.vn.has(n)){const r=n.lastSegment(),s=n.popLast();e.addOnCommittedListener(()=>{this.vn.add(n)});const i={collectionId:r,parent:cn(s)};return hI(e).put(i)}return O.resolve()}getCollectionParents(e,n){const r=[],s=IDBKeyRange.bound([n,""],[lb(n),""],!1,!0);return hI(e).J(s).next(i=>{for(const o of i){if(o.collectionId!==n)break;r.push(Ur(o.parent))}return r})}addFieldIndex(e,n){const r=xl(e),s=function(a){return{indexId:a.indexId,collectionGroup:a.collectionGroup,fields:a.fields.map(l=>[l.fieldPath.canonicalString(),l.kind])}}(n);delete s.indexId;const i=r.add(s);if(n.indexState){const o=jo(e);return i.next(a=>{o.put(rI(a,this.uid,n.indexState.sequenceNumber,n.indexState.offset))})}return i.next()}deleteFieldIndex(e,n){const r=xl(e),s=jo(e),i=Do(e);return r.delete(n.indexId).next(()=>s.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0))).next(()=>i.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){const n=xl(e),r=Do(e),s=jo(e);return n.Z().next(()=>r.Z()).next(()=>s.Z())}createTargetIndexes(e,n){return O.forEach(this.Mn(n),r=>this.getIndexType(e,r).next(s=>{if(s===0||s===1){const i=new cI(r).Dn();if(i!=null)return this.addFieldIndex(e,i)}}))}getDocumentsMatchingTarget(e,n){const r=Do(e);let s=!0;const i=new Map;return O.forEach(this.Mn(n),o=>this.xn(e,o).next(a=>{s&&(s=!!a),i.set(o,a)})).next(()=>{if(s){let o=ke();const a=[];return O.forEach(i,(l,d)=>{W(dI,`Using index ${function(S){return`id=${S.indexId}|cg=${S.collectionGroup}|f=${S.fields.map(b=>`${b.fieldPath}:${b.kind}`).join(",")}`}(l)} to execute ${co(n)}`);const h=function(S,b){const L=Ym(b);if(L===void 0)return null;for(const B of uh(S,L.fieldPath))switch(B.op){case"array-contains-any":return B.value.arrayValue.values||[];case"array-contains":return[B.value]}return null}(d,l),f=function(S,b){const L=new Map;for(const B of Di(b))for(const w of uh(S,B.fieldPath))switch(w.op){case"==":case"in":L.set(B.fieldPath.canonicalString(),w.value);break;case"not-in":case"!=":return L.set(B.fieldPath.canonicalString(),w.value),Array.from(L.values())}return null}(d,l),m=function(S,b){const L=[];let B=!0;for(const w of Di(b)){const _=w.kind===0?zE(S,w.fieldPath,S.startAt):qE(S,w.fieldPath,S.startAt);L.push(_.value),B&&(B=_.inclusive)}return new hi(L,B)}(d,l),v=function(S,b){const L=[];let B=!0;for(const w of Di(b)){const _=w.kind===0?qE(S,w.fieldPath,S.endAt):zE(S,w.fieldPath,S.endAt);L.push(_.value),B&&(B=_.inclusive)}return new hi(L,B)}(d,l),R=this.On(l,d,m),T=this.On(l,d,v),P=this.Nn(l,d,f),E=this.Bn(l.indexId,h,R,m.inclusive,T,v.inclusive,P);return O.forEach(E,I=>r.Y(I,n.limit).next(S=>{S.forEach(b=>{const L=ee.fromSegments(b.documentKey);o.has(L)||(o=o.add(L),a.push(L))})}))}).next(()=>a)}return O.resolve(null)})}Mn(e){let n=this.Fn.get(e);return n||(e.filters.length===0?n=[e]:n=YV(Ze.create(e.filters,"and")).map(r=>ig(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.Fn.set(e,n),n)}Bn(e,n,r,s,i,o,a){const l=(n!=null?n.length:1)*Math.max(r.length,i.length),d=l/(n!=null?n.length:1),h=[];for(let f=0;f<l;++f){const m=n?this.Ln(n[f/d]):Uu,v=this.kn(e,m,r[f%d],s),R=this.qn(e,m,i[f%d],o),T=a.map(P=>this.kn(e,m,P,!0));h.push(...this.createRange(v,R,T))}return h}kn(e,n,r,s){const i=new Mi(e,ee.empty(),n,r);return s?i:i.An()}qn(e,n,r,s){const i=new Mi(e,ee.empty(),n,r);return s?i.An():i}xn(e,n){const r=new cI(n),s=n.collectionGroup!=null?n.collectionGroup:n.path.lastSegment();return this.getFieldIndexes(e,s).next(i=>{let o=null;for(const a of i)r.yn(a)&&(!o||a.fields.length>o.fields.length)&&(o=a);return o})}getIndexType(e,n){let r=2;const s=this.Mn(n);return O.forEach(s,i=>this.xn(e,i).next(o=>{o?r!==0&&o.fields.length<function(l){let d=new tt(mt.comparator),h=!1;for(const f of l.filters)for(const m of f.getFlattenedFilters())m.field.isKeyField()||(m.op==="array-contains"||m.op==="array-contains-any"?h=!0:d=d.add(m.field));for(const f of l.orderBy)f.field.isKeyField()||(d=d.add(f.field));return d.size+(h?1:0)}(i)&&(r=1):r=0})).next(()=>function(o){return o.limit!==null}(n)&&s.length>1&&r===2?1:r)}Qn(e,n){const r=new Il;for(const s of Di(e)){const i=n.data.field(s.fieldPath);if(i==null)return null;const o=r.Pn(s.kind);Li.Kt.Dt(i,o)}return r.un()}Ln(e){const n=new Il;return Li.Kt.Dt(e,n.Pn(0)),n.un()}$n(e,n){const r=new Il;return Li.Kt.Dt(lo(this.databaseId,n),r.Pn(function(i){const o=Di(i);return o.length===0?0:o[o.length-1].kind}(e))),r.un()}Nn(e,n,r){if(r===null)return[];let s=[];s.push(new Il);let i=0;for(const o of Di(e)){const a=r[i++];for(const l of s)if(this.Un(n,o.fieldPath)&&Oc(a))s=this.Kn(s,o,a);else{const d=l.Pn(o.kind);Li.Kt.Dt(a,d)}}return this.Wn(s)}On(e,n,r){return this.Nn(e,n,r.position)}Wn(e){const n=[];for(let r=0;r<e.length;++r)n[r]=e[r].un();return n}Kn(e,n,r){const s=[...e],i=[];for(const o of r.arrayValue.values||[])for(const a of s){const l=new Il;l.seed(a.un()),Li.Kt.Dt(o,l.Pn(n.kind)),i.push(l)}return i}Un(e,n){return!!e.filters.find(r=>r instanceof Le&&r.field.isEqual(n)&&(r.op==="in"||r.op==="not-in"))}getFieldIndexes(e,n){const r=xl(e),s=jo(e);return(n?r.J(Jm,IDBKeyRange.bound(n,n)):r.J()).next(i=>{const o=[];return O.forEach(i,a=>s.get([a.indexId,this.uid]).next(l=>{o.push(function(h,f){const m=f?new Ac(f.sequenceNumber,new Hn(fo(f.readTime),new ee(Ur(f.documentKey)),f.largestBatchId)):Ac.empty(),v=h.fields.map(([R,T])=>new fd(mt.fromServerFormat(R),T));return new sh(h.indexId,h.collectionGroup,v,m)}(a,l))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(n=>n.length===0?null:(n.sort((r,s)=>{const i=r.indexState.sequenceNumber-s.indexState.sequenceNumber;return i!==0?i:Ie(r.collectionGroup,s.collectionGroup)}),n[0].collectionGroup))}updateCollectionGroup(e,n,r){const s=xl(e),i=jo(e);return this.Gn(e).next(o=>s.J(Jm,IDBKeyRange.bound(n,n)).next(a=>O.forEach(a,l=>i.put(rI(l.indexId,this.uid,o,r)))))}updateIndexEntries(e,n){const r=new Map;return O.forEach(n,(s,i)=>{const o=r.get(s.collectionGroup);return(o?O.resolve(o):this.getFieldIndexes(e,s.collectionGroup)).next(a=>(r.set(s.collectionGroup,a),O.forEach(a,l=>this.zn(e,s,l).next(d=>{const h=this.jn(i,l);return d.isEqual(h)?O.resolve():this.Jn(e,i,l,d,h)}))))})}Hn(e,n,r,s){return Do(e).put(s.Rn(this.uid,this.$n(r,n.key),n.key))}Yn(e,n,r,s){return Do(e).delete(s.Vn(this.uid,this.$n(r,n.key),n.key))}zn(e,n,r){const s=Do(e);let i=new tt(Ps);return s.ee({index:_b,range:IDBKeyRange.only([r.indexId,this.uid,Ed(this.$n(r,n))])},(o,a)=>{i=i.add(new Mi(r.indexId,n,lI(a.arrayValue),lI(a.directionalValue)))}).next(()=>i)}jn(e,n){let r=new tt(Ps);const s=this.Qn(n,e);if(s==null)return r;const i=Ym(n);if(i!=null){const o=e.data.field(i.fieldPath);if(Oc(o))for(const a of o.arrayValue.values||[])r=r.add(new Mi(n.indexId,e.key,this.Ln(a),s))}else r=r.add(new Mi(n.indexId,e.key,Uu,s));return r}Jn(e,n,r,s,i){W(dI,"Updating index entries for document '%s'",n.key);const o=[];return function(l,d,h,f,m){const v=l.getIterator(),R=d.getIterator();let T=No(v),P=No(R);for(;T||P;){let E=!1,I=!1;if(T&&P){const S=h(T,P);S<0?I=!0:S>0&&(E=!0)}else T!=null?I=!0:E=!0;E?(f(P),P=No(R)):I?(m(T),T=No(v)):(T=No(v),P=No(R))}}(s,i,Ps,a=>{o.push(this.Hn(e,n,r,a))},a=>{o.push(this.Yn(e,n,r,a))}),O.waitFor(o)}Gn(e){let n=1;return jo(e).ee({index:vb,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,s,i)=>{i.done(),n=s.sequenceNumber+1}).next(()=>n)}createRange(e,n,r){r=r.sort((o,a)=>Ps(o,a)).filter((o,a,l)=>!a||Ps(o,l[a-1])!==0);const s=[];s.push(e);for(const o of r){const a=Ps(o,e),l=Ps(o,n);if(a===0)s[0]=e.An();else if(a>0&&l<0)s.push(o),s.push(o.An());else if(l>0)break}s.push(n);const i=[];for(let o=0;o<s.length;o+=2){if(this.Zn(s[o],s[o+1]))return[];const a=s[o].Vn(this.uid,Uu,ee.empty()),l=s[o+1].Vn(this.uid,Uu,ee.empty());i.push(IDBKeyRange.bound(a,l))}return i}Zn(e,n){return Ps(e,n)>0}getMinOffsetFromCollectionGroup(e,n){return this.getFieldIndexes(e,n).next(fI)}getMinOffset(e,n){return O.mapArray(this.Mn(n),r=>this.xn(e,r).next(s=>s||le(44426))).next(fI)}}function hI(t){return Mt(t,kc)}function Do(t){return Mt(t,tc)}function xl(t){return Mt(t,By)}function jo(t){return Mt(t,ec)}function fI(t){he(t.length!==0,28825);let e=t[0].indexState.offset,n=e.largestBatchId;for(let r=1;r<t.length;r++){const s=t[r].indexState.offset;Fy(s,e)<0&&(e=s),n<s.largestBatchId&&(n=s.largestBatchId)}return new Hn(e.readTime,e.documentKey,n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pI={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},EC=41943040;class rn{static withCacheSize(e){return new rn(e,rn.DEFAULT_COLLECTION_PERCENTILE,rn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function IC(t,e,n){const r=t.store(gr),s=t.store(Pa),i=[],o=IDBKeyRange.only(n.batchId);let a=0;const l=r.ee({range:o},(h,f,m)=>(a++,m.delete()));i.push(l.next(()=>{he(a===1,47070,{batchId:n.batchId})}));const d=[];for(const h of n.mutations){const f=mb(e,h.key.path,n.batchId);i.push(s.delete(f)),d.push(h.key)}return O.waitFor(i).next(()=>d)}function gh(t){if(!t)return 0;let e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw le(14731);e=t.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */rn.DEFAULT_COLLECTION_PERCENTILE=10,rn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,rn.DEFAULT=new rn(EC,rn.DEFAULT_COLLECTION_PERCENTILE,rn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),rn.DISABLED=new rn(-1,0,0);class mf{constructor(e,n,r,s){this.userId=e,this.serializer=n,this.indexManager=r,this.referenceDelegate=s,this.Xn={}}static wt(e,n,r,s){he(e.uid!=="",64387);const i=e.isAuthenticated()?e.uid:"";return new mf(i,n,r,s)}checkEmpty(e){let n=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Ns(e).ee({index:zi,range:r},(s,i,o)=>{n=!1,o.done()}).next(()=>n)}addMutationBatch(e,n,r,s){const i=Wo(e),o=Ns(e);return o.add({}).next(a=>{he(typeof a=="number",49019);const l=new Yy(a,n,r,s),d=function(v,R,T){const P=T.baseMutations.map(I=>fh(v.yt,I)),E=T.mutations.map(I=>fh(v.yt,I));return{userId:R,batchId:T.batchId,localWriteTimeMs:T.localWriteTime.toMillis(),baseMutations:P,mutations:E}}(this.serializer,this.userId,l),h=[];let f=new tt((m,v)=>Ie(m.canonicalString(),v.canonicalString()));for(const m of s){const v=mb(this.userId,m.key.path,a);f=f.add(m.key.path.popLast()),h.push(o.put(d)),h.push(i.put(v,SO))}return f.forEach(m=>{h.push(this.indexManager.addToCollectionParentIndex(e,m))}),e.addOnCommittedListener(()=>{this.Xn[a]=l.keys()}),O.waitFor(h).next(()=>l)})}lookupMutationBatch(e,n){return Ns(e).get(n).next(r=>r?(he(r.userId===this.userId,48,"Unexpected user for mutation batch",{userId:r.userId,batchId:n}),Vi(this.serializer,r)):null)}er(e,n){return this.Xn[n]?O.resolve(this.Xn[n]):this.lookupMutationBatch(e,n).next(r=>{if(r){const s=r.keys();return this.Xn[n]=s,s}return null})}getNextMutationBatchAfterBatchId(e,n){const r=n+1,s=IDBKeyRange.lowerBound([this.userId,r]);let i=null;return Ns(e).ee({index:zi,range:s},(o,a,l)=>{a.userId===this.userId&&(he(a.batchId>=r,47524,{tr:r}),i=Vi(this.serializer,a)),l.done()}).next(()=>i)}getHighestUnacknowledgedBatchId(e){const n=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=Gi;return Ns(e).ee({index:zi,range:n,reverse:!0},(s,i,o)=>{r=i.batchId,o.done()}).next(()=>r)}getAllMutationBatches(e){const n=IDBKeyRange.bound([this.userId,Gi],[this.userId,Number.POSITIVE_INFINITY]);return Ns(e).J(zi,n).next(r=>r.map(s=>Vi(this.serializer,s)))}getAllMutationBatchesAffectingDocumentKey(e,n){const r=pd(this.userId,n.path),s=IDBKeyRange.lowerBound(r),i=[];return Wo(e).ee({range:s},(o,a,l)=>{const[d,h,f]=o,m=Ur(h);if(d===this.userId&&n.path.isEqual(m))return Ns(e).get(f).next(v=>{if(!v)throw le(61480,{nr:o,batchId:f});he(v.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:v.userId,batchId:f}),i.push(Vi(this.serializer,v))});l.done()}).next(()=>i)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new tt(Ie);const s=[];return n.forEach(i=>{const o=pd(this.userId,i.path),a=IDBKeyRange.lowerBound(o),l=Wo(e).ee({range:a},(d,h,f)=>{const[m,v,R]=d,T=Ur(v);m===this.userId&&i.path.isEqual(T)?r=r.add(R):f.done()});s.push(l)}),O.waitFor(s).next(()=>this.rr(e,r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,s=r.length+1,i=pd(this.userId,r),o=IDBKeyRange.lowerBound(i);let a=new tt(Ie);return Wo(e).ee({range:o},(l,d,h)=>{const[f,m,v]=l,R=Ur(m);f===this.userId&&r.isPrefixOf(R)?R.length===s&&(a=a.add(v)):h.done()}).next(()=>this.rr(e,a))}rr(e,n){const r=[],s=[];return n.forEach(i=>{s.push(Ns(e).get(i).next(o=>{if(o===null)throw le(35274,{batchId:i});he(o.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:o.userId,batchId:i}),r.push(Vi(this.serializer,o))}))}),O.waitFor(s).next(()=>r)}removeMutationBatch(e,n){return IC(e.le,this.userId,n).next(r=>(e.addOnCommittedListener(()=>{this.ir(n.batchId)}),O.forEach(r,s=>this.referenceDelegate.markPotentiallyOrphaned(e,s))))}ir(e){delete this.Xn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(n=>{if(!n)return O.resolve();const r=IDBKeyRange.lowerBound(function(o){return[o]}(this.userId)),s=[];return Wo(e).ee({range:r},(i,o,a)=>{if(i[0]===this.userId){const l=Ur(i[1]);s.push(l)}else a.done()}).next(()=>{he(s.length===0,56720,{sr:s.map(i=>i.canonicalString())})})})}containsKey(e,n){return xC(e,this.userId,n)}_r(e){return TC(e).get(this.userId).next(n=>n||{userId:this.userId,lastAcknowledgedBatchId:Gi,lastStreamToken:""})}}function xC(t,e,n){const r=pd(e,n.path),s=r[1],i=IDBKeyRange.lowerBound(r);let o=!1;return Wo(t).ee({range:i,X:!0},(a,l,d)=>{const[h,f,m]=a;h===e&&f===s&&(o=!0),d.done()}).next(()=>o)}function Ns(t){return Mt(t,gr)}function Wo(t){return Mt(t,Pa)}function TC(t){return Mt(t,Pc)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class po{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new po(0)}static cr(){return new po(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZV{constructor(e,n){this.referenceDelegate=e,this.serializer=n}allocateTargetId(e){return this.lr(e).next(n=>{const r=new po(n.highestTargetId);return n.highestTargetId=r.next(),this.hr(e,n).next(()=>n.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.lr(e).next(n=>fe.fromTimestamp(new Be(n.lastRemoteSnapshotVersion.seconds,n.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.lr(e).next(n=>n.highestListenSequenceNumber)}setTargetsMetadata(e,n,r){return this.lr(e).next(s=>(s.highestListenSequenceNumber=n,r&&(s.lastRemoteSnapshotVersion=r.toTimestamp()),n>s.highestListenSequenceNumber&&(s.highestListenSequenceNumber=n),this.hr(e,s)))}addTargetData(e,n){return this.Pr(e,n).next(()=>this.lr(e).next(r=>(r.targetCount+=1,this.Tr(n,r),this.hr(e,r))))}updateTargetData(e,n){return this.Pr(e,n)}removeTargetData(e,n){return this.removeMatchingKeysForTargetId(e,n.targetId).next(()=>Oo(e).delete(n.targetId)).next(()=>this.lr(e)).next(r=>(he(r.targetCount>0,8065),r.targetCount-=1,this.hr(e,r)))}removeTargets(e,n,r){let s=0;const i=[];return Oo(e).ee((o,a)=>{const l=Ll(a);l.sequenceNumber<=n&&r.get(l.targetId)===null&&(s++,i.push(this.removeTargetData(e,l)))}).next(()=>O.waitFor(i)).next(()=>s)}forEachTarget(e,n){return Oo(e).ee((r,s)=>{const i=Ll(s);n(i)})}lr(e){return mI(e).get(ah).next(n=>(he(n!==null,2888),n))}hr(e,n){return mI(e).put(ah,n)}Pr(e,n){return Oo(e).put(yC(this.serializer,n))}Tr(e,n){let r=!1;return e.targetId>n.highestTargetId&&(n.highestTargetId=e.targetId,r=!0),e.sequenceNumber>n.highestListenSequenceNumber&&(n.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.lr(e).next(n=>n.targetCount)}getTargetData(e,n){const r=co(n),s=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let i=null;return Oo(e).ee({range:s,index:yb},(o,a,l)=>{const d=Ll(a);Xc(n,d.target)&&(i=d,l.done())}).next(()=>i)}addMatchingKeys(e,n,r){const s=[],i=zs(e);return n.forEach(o=>{const a=cn(o.path);s.push(i.put({targetId:r,path:a})),s.push(this.referenceDelegate.addReference(e,r,o))}),O.waitFor(s)}removeMatchingKeys(e,n,r){const s=zs(e);return O.forEach(n,i=>{const o=cn(i.path);return O.waitFor([s.delete([r,o]),this.referenceDelegate.removeReference(e,r,i)])})}removeMatchingKeysForTargetId(e,n){const r=zs(e),s=IDBKeyRange.bound([n],[n+1],!1,!0);return r.delete(s)}getMatchingKeysForTargetId(e,n){const r=IDBKeyRange.bound([n],[n+1],!1,!0),s=zs(e);let i=ke();return s.ee({range:r,X:!0},(o,a,l)=>{const d=Ur(o[1]),h=new ee(d);i=i.add(h)}).next(()=>i)}containsKey(e,n){const r=cn(n.path),s=IDBKeyRange.bound([r],[lb(r)],!1,!0);let i=0;return zs(e).ee({index:$y,X:!0,range:s},([o,a],l,d)=>{o!==0&&(i++,d.done())}).next(()=>i>0)}At(e,n){return Oo(e).get(n).next(r=>r?Ll(r):null)}}function Oo(t){return Mt(t,Na)}function mI(t){return Mt(t,Ki)}function zs(t){return Mt(t,ka)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gI="LruGarbageCollector",eL=1048576;function yI([t,e],[n,r]){const s=Ie(t,n);return s===0?Ie(e,r):s}class tL{constructor(e){this.Ir=e,this.buffer=new tt(yI),this.Er=0}dr(){return++this.Er}Ar(e){const n=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(n);else{const r=this.buffer.last();yI(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}}class SC{constructor(e,n,r){this.garbageCollector=e,this.asyncQueue=n,this.localStore=r,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){W(gI,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){Ei(n)?W(gI,"Ignoring IndexedDB error during garbage collection: ",n):await To(n)}await this.Vr(3e5)})}}class nL{constructor(e,n){this.mr=e,this.params=n}calculateTargetCount(e,n){return this.mr.gr(e).next(r=>Math.floor(n/100*r))}nthSequenceNumber(e,n){if(n===0)return O.resolve(rr.ce);const r=new tL(n);return this.mr.forEachTarget(e,s=>r.Ar(s.sequenceNumber)).next(()=>this.mr.pr(e,s=>r.Ar(s))).next(()=>r.maxValue)}removeTargets(e,n,r){return this.mr.removeTargets(e,n,r)}removeOrphanedDocuments(e,n){return this.mr.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(W("LruGarbageCollector","Garbage collection skipped; disabled"),O.resolve(pI)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(W("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),pI):this.yr(e,n))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,n){let r,s,i,o,a,l,d;const h=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(f=>(f>this.params.maximumSequenceNumbersToCollect?(W("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${f}`),s=this.params.maximumSequenceNumbersToCollect):s=f,o=Date.now(),this.nthSequenceNumber(e,s))).next(f=>(r=f,a=Date.now(),this.removeTargets(e,r,n))).next(f=>(i=f,l=Date.now(),this.removeOrphanedDocuments(e,r))).next(f=>(d=Date.now(),zo()<=Ve.DEBUG&&W("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-h}ms
	Determined least recently used ${s} in `+(a-o)+`ms
	Removed ${i} targets in `+(l-a)+`ms
	Removed ${f} documents in `+(d-l)+`ms
Total Duration: ${d-h}ms`),O.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:i,documentsRemoved:f})))}}function bC(t,e){return new nL(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rL{constructor(e,n){this.db=e,this.garbageCollector=bC(this,n)}gr(e){const n=this.wr(e);return this.db.getTargetCache().getTargetCount(e).next(r=>n.next(s=>r+s))}wr(e){let n=0;return this.pr(e,r=>{n++}).next(()=>n)}forEachTarget(e,n){return this.db.getTargetCache().forEachTarget(e,n)}pr(e,n){return this.Sr(e,(r,s)=>n(s))}addReference(e,n,r){return $u(e,r)}removeReference(e,n,r){return $u(e,r)}removeTargets(e,n,r){return this.db.getTargetCache().removeTargets(e,n,r)}markPotentiallyOrphaned(e,n){return $u(e,n)}br(e,n){return function(s,i){let o=!1;return TC(s).te(a=>xC(s,a,i).next(l=>(l&&(o=!0),O.resolve(!l)))).next(()=>o)}(e,n)}removeOrphanedDocuments(e,n){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),s=[];let i=0;return this.Sr(e,(o,a)=>{if(a<=n){const l=this.br(e,o).next(d=>{if(!d)return i++,r.getEntry(e,o).next(()=>(r.removeEntry(o,fe.min()),zs(e).delete(function(f){return[0,cn(f.path)]}(o))))});s.push(l)}}).next(()=>O.waitFor(s)).next(()=>r.apply(e)).next(()=>i)}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,n){return $u(e,n)}Sr(e,n){const r=zs(e);let s,i=rr.ce;return r.ee({index:$y},([o,a],{path:l,sequenceNumber:d})=>{o===0?(i!==rr.ce&&n(new ee(Ur(s)),i),i=d,s=l):i=rr.ce}).next(()=>{i!==rr.ce&&n(new ee(Ur(s)),i)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function $u(t,e){return zs(t).put(function(r,s){return{targetId:0,path:cn(r.path),sequenceNumber:s}}(e,t.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CC{constructor(){this.changes=new ws(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,wt.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?O.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sL{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,n,r){return Ri(e).put(r)}removeEntry(e,n,r){return Ri(e).delete(function(i,o){const a=i.path.toArray();return[a.slice(0,a.length-2),a[a.length-2],ph(o),a[a.length-1]]}(n,r))}updateMetadata(e,n){return this.getMetadata(e).next(r=>(r.byteSize+=n,this.Dr(e,r)))}getEntry(e,n){let r=wt.newInvalidDocument(n);return Ri(e).ee({index:md,range:IDBKeyRange.only(Tl(n))},(s,i)=>{r=this.Cr(n,i)}).next(()=>r)}vr(e,n){let r={size:0,document:wt.newInvalidDocument(n)};return Ri(e).ee({index:md,range:IDBKeyRange.only(Tl(n))},(s,i)=>{r={document:this.Cr(n,i),size:gh(i)}}).next(()=>r)}getEntries(e,n){let r=$n();return this.Fr(e,n,(s,i)=>{const o=this.Cr(s,i);r=r.insert(s,o)}).next(()=>r)}Mr(e,n){let r=$n(),s=new ft(ee.comparator);return this.Fr(e,n,(i,o)=>{const a=this.Cr(i,o);r=r.insert(i,a),s=s.insert(i,gh(o))}).next(()=>({documents:r,Or:s}))}Fr(e,n,r){if(n.isEmpty())return O.resolve();let s=new tt(wI);n.forEach(l=>s=s.add(l));const i=IDBKeyRange.bound(Tl(s.first()),Tl(s.last())),o=s.getIterator();let a=o.getNext();return Ri(e).ee({index:md,range:i},(l,d,h)=>{const f=ee.fromSegments([...d.prefixPath,d.collectionGroup,d.documentId]);for(;a&&wI(a,f)<0;)r(a,null),a=o.getNext();a&&a.isEqual(f)&&(r(a,d),a=o.hasNext()?o.getNext():null),a?h.j(Tl(a)):h.done()}).next(()=>{for(;a;)r(a,null),a=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,n,r,s,i){const o=n.path,a=[o.popLast().toArray(),o.lastSegment(),ph(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],l=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Ri(e).J(IDBKeyRange.bound(a,l,!0)).next(d=>{i==null||i.incrementDocumentReadCount(d.length);let h=$n();for(const f of d){const m=this.Cr(ee.fromSegments(f.prefixPath.concat(f.collectionGroup,f.documentId)),f);m.isFoundDocument()&&(Zc(n,m)||s.has(m.key))&&(h=h.insert(m.key,m))}return h})}getAllFromCollectionGroup(e,n,r,s){let i=$n();const o=_I(n,r),a=_I(n,Hn.max());return Ri(e).ee({index:gb,range:IDBKeyRange.bound(o,a,!0)},(l,d,h)=>{const f=this.Cr(ee.fromSegments(d.prefixPath.concat(d.collectionGroup,d.documentId)),d);i=i.insert(f.key,f),i.size===s&&h.done()}).next(()=>i)}newChangeBuffer(e){return new iL(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(n=>n.byteSize)}getMetadata(e){return vI(e).get(Xm).next(n=>(he(!!n,20021),n))}Dr(e,n){return vI(e).put(Xm,n)}Cr(e,n){if(n){const r=zV(this.serializer,n);if(!(r.isNoDocument()&&r.version.isEqual(fe.min())))return r}return wt.newInvalidDocument(e)}}function AC(t){return new sL(t)}class iL extends CC{constructor(e,n){super(),this.Nr=e,this.trackRemovals=n,this.Br=new ws(r=>r.toString(),(r,s)=>r.isEqual(s))}applyChanges(e){const n=[];let r=0,s=new tt((i,o)=>Ie(i.canonicalString(),o.canonicalString()));return this.changes.forEach((i,o)=>{const a=this.Br.get(i);if(n.push(this.Nr.removeEntry(e,i,a.readTime)),o.isValidDocument()){const l=tI(this.Nr.serializer,o);s=s.add(i.path.popLast());const d=gh(l);r+=d-a.size,n.push(this.Nr.addEntry(e,i,l))}else if(r-=a.size,this.trackRemovals){const l=tI(this.Nr.serializer,o.convertToNoDocument(fe.min()));n.push(this.Nr.addEntry(e,i,l))}}),s.forEach(i=>{n.push(this.Nr.indexManager.addToCollectionParentIndex(e,i))}),n.push(this.Nr.updateMetadata(e,r)),O.waitFor(n)}getFromCache(e,n){return this.Nr.vr(e,n).next(r=>(this.Br.set(n,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,n){return this.Nr.Mr(e,n).next(({documents:r,Or:s})=>(s.forEach((i,o)=>{this.Br.set(i,{size:o,readTime:r.get(i).readTime})}),r))}}function vI(t){return Mt(t,Nc)}function Ri(t){return Mt(t,oh)}function Tl(t){const e=t.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function _I(t,e){const n=e.documentKey.path.toArray();return[t,ph(e.readTime),n.slice(0,n.length-2),n.length>0?n[n.length-1]:""]}function wI(t,e){const n=t.path.toArray(),r=e.path.toArray();let s=0;for(let i=0;i<n.length-2&&i<r.length-2;++i)if(s=Ie(n[i],r[i]),s)return s;return s=Ie(n.length,r.length),s||(s=Ie(n[n.length-2],r[r.length-2]),s||Ie(n[n.length-1],r[r.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oL{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RC{constructor(e,n,r,s){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=s}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(s=>(r=s,this.remoteDocumentCache.getEntry(e,n))).next(s=>(r!==null&&sc(r.mutation,s,Rn.empty(),Be.now()),s))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,ke()).next(()=>r))}getLocalViewOfDocuments(e,n,r=ke()){const s=$r();return this.populateOverlays(e,s,n).next(()=>this.computeViews(e,n,s,r).next(i=>{let o=Ol();return i.forEach((a,l)=>{o=o.insert(a,l.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){const r=$r();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,ke()))}populateOverlays(e,n,r){const s=[];return r.forEach(i=>{n.has(i)||s.push(i)}),this.documentOverlayCache.getOverlays(e,s).next(i=>{i.forEach((o,a)=>{n.set(o,a)})})}computeViews(e,n,r,s){let i=$n();const o=rc(),a=function(){return rc()}();return n.forEach((l,d)=>{const h=r.get(d.key);s.has(d.key)&&(h===void 0||h.mutation instanceof Es)?i=i.insert(d.key,d):h!==void 0?(o.set(d.key,h.mutation.getFieldMask()),sc(h.mutation,d,h.mutation.getFieldMask(),Be.now())):o.set(d.key,Rn.empty())}),this.recalculateAndSaveOverlays(e,i).next(l=>(l.forEach((d,h)=>o.set(d,h)),n.forEach((d,h)=>a.set(d,new oL(h,o.get(d)??null))),a))}recalculateAndSaveOverlays(e,n){const r=rc();let s=new ft((o,a)=>o-a),i=ke();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(const a of o)a.keys().forEach(l=>{const d=n.get(l);if(d===null)return;let h=r.get(l)||Rn.empty();h=a.applyToLocalView(d,h),r.set(l,h);const f=(s.get(a.batchId)||ke()).add(l);s=s.insert(a.batchId,f)})}).next(()=>{const o=[],a=s.getReverseIterator();for(;a.hasNext();){const l=a.getNext(),d=l.key,h=l.value,f=Gb();h.forEach(m=>{if(!i.has(m)){const v=eC(n.get(m),r.get(m));v!==null&&f.set(m,v),i=i.add(m)}}),o.push(this.documentOverlayCache.saveOverlays(e,d,f))}return O.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,s){return function(o){return ee.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):Ky(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,s):this.getDocumentsMatchingCollectionQuery(e,n,r,s)}getNextDocuments(e,n,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,s).next(i=>{const o=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,s-i.size):O.resolve($r());let a=Cc,l=i;return o.next(d=>O.forEach(d,(h,f)=>(a<f.largestBatchId&&(a=f.largestBatchId),i.get(h)?O.resolve():this.remoteDocumentCache.getEntry(e,h).next(m=>{l=l.insert(h,m)}))).next(()=>this.populateOverlays(e,d,i)).next(()=>this.computeViews(e,l,d,ke())).next(h=>({batchId:a,changes:Wb(h)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new ee(n)).next(r=>{let s=Ol();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s})}getDocumentsMatchingCollectionGroupQuery(e,n,r,s){const i=n.collectionGroup;let o=Ol();return this.indexManager.getCollectionParents(e,i).next(a=>O.forEach(a,l=>{const d=function(f,m){return new xi(m,null,f.explicitOrderBy.slice(),f.filters.slice(),f.limit,f.limitType,f.startAt,f.endAt)}(n,l.child(i));return this.getDocumentsMatchingCollectionQuery(e,d,r,s).next(h=>{h.forEach((f,m)=>{o=o.insert(f,m)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,n,r,s){let i;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(o=>(i=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,i,s))).next(o=>{i.forEach((l,d)=>{const h=d.getKey();o.get(h)===null&&(o=o.insert(h,wt.newInvalidDocument(h)))});let a=Ol();return o.forEach((l,d)=>{const h=i.get(l);h!==void 0&&sc(h.mutation,d,Rn.empty(),Be.now()),Zc(n,d)&&(a=a.insert(l,d))}),a})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aL{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,n){return O.resolve(this.Lr.get(n))}saveBundleMetadata(e,n){return this.Lr.set(n.id,function(s){return{id:s.id,version:s.version,createTime:_n(s.createTime)}}(n)),O.resolve()}getNamedQuery(e,n){return O.resolve(this.kr.get(n))}saveNamedQuery(e,n){return this.kr.set(n.name,function(s){return{name:s.name,query:vC(s.bundledQuery),readTime:_n(s.readTime)}}(n)),O.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lL{constructor(){this.overlays=new ft(ee.comparator),this.qr=new Map}getOverlay(e,n){return O.resolve(this.overlays.get(n))}getOverlays(e,n){const r=$r();return O.forEach(n,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((s,i)=>{this.St(e,n,i)}),O.resolve()}removeOverlaysForBatchId(e,n,r){const s=this.qr.get(r);return s!==void 0&&(s.forEach(i=>this.overlays=this.overlays.remove(i)),this.qr.delete(r)),O.resolve()}getOverlaysForCollection(e,n,r){const s=$r(),i=n.length+1,o=new ee(n.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const l=a.getNext().value,d=l.getKey();if(!n.isPrefixOf(d.path))break;d.path.length===i&&l.largestBatchId>r&&s.set(l.getKey(),l)}return O.resolve(s)}getOverlaysForCollectionGroup(e,n,r,s){let i=new ft((d,h)=>d-h);const o=this.overlays.getIterator();for(;o.hasNext();){const d=o.getNext().value;if(d.getKey().getCollectionGroup()===n&&d.largestBatchId>r){let h=i.get(d.largestBatchId);h===null&&(h=$r(),i=i.insert(d.largestBatchId,h)),h.set(d.getKey(),d)}}const a=$r(),l=i.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((d,h)=>a.set(d,h)),!(a.size()>=s)););return O.resolve(a)}St(e,n,r){const s=this.overlays.get(r.key);if(s!==null){const o=this.qr.get(s.largestBatchId).delete(r.key);this.qr.set(s.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new Jy(n,r));let i=this.qr.get(n);i===void 0&&(i=ke(),this.qr.set(n,i)),this.qr.set(n,i.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cL{constructor(){this.sessionToken=kt.EMPTY_BYTE_STRING}getSessionToken(e){return O.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,O.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sv{constructor(){this.Qr=new tt(qt.$r),this.Ur=new tt(qt.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,n){const r=new qt(e,n);this.Qr=this.Qr.add(r),this.Ur=this.Ur.add(r)}Wr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Gr(new qt(e,n))}zr(e,n){e.forEach(r=>this.removeReference(r,n))}jr(e){const n=new ee(new We([])),r=new qt(n,e),s=new qt(n,e+1),i=[];return this.Ur.forEachInRange([r,s],o=>{this.Gr(o),i.push(o.key)}),i}Jr(){this.Qr.forEach(e=>this.Gr(e))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const n=new ee(new We([])),r=new qt(n,e),s=new qt(n,e+1);let i=ke();return this.Ur.forEachInRange([r,s],o=>{i=i.add(o.key)}),i}containsKey(e){const n=new qt(e,0),r=this.Qr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class qt{constructor(e,n){this.key=e,this.Yr=n}static $r(e,n){return ee.comparator(e.key,n.key)||Ie(e.Yr,n.Yr)}static Kr(e,n){return Ie(e.Yr,n.Yr)||ee.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uL{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.tr=1,this.Zr=new tt(qt.$r)}checkEmpty(e){return O.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,s){const i=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new Yy(i,n,r,s);this.mutationQueue.push(o);for(const a of s)this.Zr=this.Zr.add(new qt(a.key,i)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return O.resolve(o)}lookupMutationBatch(e,n){return O.resolve(this.Xr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,s=this.ei(r),i=s<0?0:s;return O.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return O.resolve(this.mutationQueue.length===0?Gi:this.tr-1)}getAllMutationBatches(e){return O.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new qt(n,0),s=new qt(n,Number.POSITIVE_INFINITY),i=[];return this.Zr.forEachInRange([r,s],o=>{const a=this.Xr(o.Yr);i.push(a)}),O.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new tt(Ie);return n.forEach(s=>{const i=new qt(s,0),o=new qt(s,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([i,o],a=>{r=r.add(a.Yr)})}),O.resolve(this.ti(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,s=r.length+1;let i=r;ee.isDocumentKey(i)||(i=i.child(""));const o=new qt(new ee(i),0);let a=new tt(Ie);return this.Zr.forEachWhile(l=>{const d=l.key.path;return!!r.isPrefixOf(d)&&(d.length===s&&(a=a.add(l.Yr)),!0)},o),O.resolve(this.ti(a))}ti(e){const n=[];return e.forEach(r=>{const s=this.Xr(r);s!==null&&n.push(s)}),n}removeMutationBatch(e,n){he(this.ni(n.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Zr;return O.forEach(n.mutations,s=>{const i=new qt(s.key,n.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.Zr=r})}ir(e){}containsKey(e,n){const r=new qt(n,0),s=this.Zr.firstAfterOrEqual(r);return O.resolve(n.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,O.resolve()}ni(e,n){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const n=this.ei(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dL{constructor(e){this.ri=e,this.docs=function(){return new ft(ee.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,s=this.docs.get(r),i=s?s.size:0,o=this.ri(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return O.resolve(r?r.document.mutableCopy():wt.newInvalidDocument(n))}getEntries(e,n){let r=$n();return n.forEach(s=>{const i=this.docs.get(s);r=r.insert(s,i?i.document.mutableCopy():wt.newInvalidDocument(s))}),O.resolve(r)}getDocumentsMatchingQuery(e,n,r,s){let i=$n();const o=n.path,a=new ee(o.child("__id-9223372036854775808__")),l=this.docs.getIteratorFrom(a);for(;l.hasNext();){const{key:d,value:{document:h}}=l.getNext();if(!o.isPrefixOf(d.path))break;d.path.length>o.length+1||Fy(db(h),r)<=0||(s.has(h.key)||Zc(n,h))&&(i=i.insert(h.key,h.mutableCopy()))}return O.resolve(i)}getAllFromCollectionGroup(e,n,r,s){le(9500)}ii(e,n){return O.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new hL(this)}getSize(e){return O.resolve(this.size)}}class hL extends CC{constructor(e){super(),this.Nr=e}applyChanges(e){const n=[];return this.changes.forEach((r,s)=>{s.isValidDocument()?n.push(this.Nr.addEntry(e,s)):this.Nr.removeEntry(r)}),O.waitFor(n)}getFromCache(e,n){return this.Nr.getEntry(e,n)}getAllFromCache(e,n){return this.Nr.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fL{constructor(e){this.persistence=e,this.si=new ws(n=>co(n),Xc),this.lastRemoteSnapshotVersion=fe.min(),this.highestTargetId=0,this.oi=0,this._i=new sv,this.targetCount=0,this.ai=po.ur()}forEachTarget(e,n){return this.si.forEach((r,s)=>n(s)),O.resolve()}getLastRemoteSnapshotVersion(e){return O.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return O.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),O.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.oi&&(this.oi=n),O.resolve()}Pr(e){this.si.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.ai=new po(n),this.highestTargetId=n),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,n){return this.Pr(n),this.targetCount+=1,O.resolve()}updateTargetData(e,n){return this.Pr(n),O.resolve()}removeTargetData(e,n){return this.si.delete(n.target),this._i.jr(n.targetId),this.targetCount-=1,O.resolve()}removeTargets(e,n,r){let s=0;const i=[];return this.si.forEach((o,a)=>{a.sequenceNumber<=n&&r.get(a.targetId)===null&&(this.si.delete(o),i.push(this.removeMatchingKeysForTargetId(e,a.targetId)),s++)}),O.waitFor(i).next(()=>s)}getTargetCount(e){return O.resolve(this.targetCount)}getTargetData(e,n){const r=this.si.get(n)||null;return O.resolve(r)}addMatchingKeys(e,n,r){return this._i.Wr(n,r),O.resolve()}removeMatchingKeys(e,n,r){this._i.zr(n,r);const s=this.persistence.referenceDelegate,i=[];return s&&n.forEach(o=>{i.push(s.markPotentiallyOrphaned(e,o))}),O.waitFor(i)}removeMatchingKeysForTargetId(e,n){return this._i.jr(n),O.resolve()}getMatchingKeysForTargetId(e,n){const r=this._i.Hr(n);return O.resolve(r)}containsKey(e,n){return O.resolve(this._i.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iv{constructor(e,n){this.ui={},this.overlays={},this.ci=new rr(0),this.li=!1,this.li=!0,this.hi=new cL,this.referenceDelegate=e(this),this.Pi=new fL(this),this.indexManager=new XV,this.remoteDocumentCache=function(s){return new dL(s)}(r=>this.referenceDelegate.Ti(r)),this.serializer=new gC(n),this.Ii=new aL(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new lL,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.ui[e.toKey()];return r||(r=new uL(n,this.referenceDelegate),this.ui[e.toKey()]=r),r}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,n,r){W("MemoryPersistence","Starting transaction:",e);const s=new pL(this.ci.next());return this.referenceDelegate.Ei(),r(s).next(i=>this.referenceDelegate.di(s).next(()=>i)).toPromise().then(i=>(s.raiseOnCommittedEvent(),i))}Ai(e,n){return O.or(Object.values(this.ui).map(r=>()=>r.containsKey(e,n)))}}class pL extends fb{constructor(e){super(),this.currentSequenceNumber=e}}class gf{constructor(e){this.persistence=e,this.Ri=new sv,this.Vi=null}static mi(e){return new gf(e)}get fi(){if(this.Vi)return this.Vi;throw le(60996)}addReference(e,n,r){return this.Ri.addReference(r,n),this.fi.delete(r.toString()),O.resolve()}removeReference(e,n,r){return this.Ri.removeReference(r,n),this.fi.add(r.toString()),O.resolve()}markPotentiallyOrphaned(e,n){return this.fi.add(n.toString()),O.resolve()}removeTarget(e,n){this.Ri.jr(n.targetId).forEach(s=>this.fi.add(s.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(s=>{s.forEach(i=>this.fi.add(i.toString()))}).next(()=>r.removeTargetData(e,n))}Ei(){this.Vi=new Set}di(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return O.forEach(this.fi,r=>{const s=ee.fromPath(r);return this.gi(e,s).next(i=>{i||n.removeEntry(s,fe.min())})}).next(()=>(this.Vi=null,n.apply(e)))}updateLimboDocument(e,n){return this.gi(e,n).next(r=>{r?this.fi.delete(n.toString()):this.fi.add(n.toString())})}Ti(e){return 0}gi(e,n){return O.or([()=>O.resolve(this.Ri.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Ai(e,n)])}}class yh{constructor(e,n){this.persistence=e,this.pi=new ws(r=>cn(r.path),(r,s)=>r.isEqual(s)),this.garbageCollector=bC(this,n)}static mi(e,n){return new yh(e,n)}Ei(){}di(e){return O.resolve()}forEachTarget(e,n){return this.persistence.getTargetCache().forEachTarget(e,n)}gr(e){const n=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next(r=>n.next(s=>r+s))}wr(e){let n=0;return this.pr(e,r=>{n++}).next(()=>n)}pr(e,n){return O.forEach(this.pi,(r,s)=>this.br(e,r,s).next(i=>i?O.resolve():n(s)))}removeTargets(e,n,r){return this.persistence.getTargetCache().removeTargets(e,n,r)}removeOrphanedDocuments(e,n){let r=0;const s=this.persistence.getRemoteDocumentCache(),i=s.newChangeBuffer();return s.ii(e,o=>this.br(e,o,n).next(a=>{a||(r++,i.removeEntry(o,fe.min()))})).next(()=>i.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,n){return this.pi.set(n,e.currentSequenceNumber),O.resolve()}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,n,r){return this.pi.set(r,e.currentSequenceNumber),O.resolve()}removeReference(e,n,r){return this.pi.set(r,e.currentSequenceNumber),O.resolve()}updateLimboDocument(e,n){return this.pi.set(n,e.currentSequenceNumber),O.resolve()}Ti(e){let n=e.key.toString().length;return e.isFoundDocument()&&(n+=yd(e.data.value)),n}br(e,n,r){return O.or([()=>this.persistence.Ai(e,n),()=>this.persistence.getTargetCache().containsKey(e,n),()=>{const s=this.pi.get(n);return O.resolve(s!==void 0&&s>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mL{constructor(e){this.serializer=e}k(e,n,r,s){const i=new Zh("createOrUpgrade",n);r<1&&s>=1&&(function(l){l.createObjectStore(Yc)}(e),function(l){l.createObjectStore(Pc,{keyPath:TO}),l.createObjectStore(gr,{keyPath:NE,autoIncrement:!0}).createIndex(zi,kE,{unique:!0}),l.createObjectStore(Pa)}(e),EI(e),function(l){l.createObjectStore(ji)}(e));let o=O.resolve();return r<3&&s>=3&&(r!==0&&(function(l){l.deleteObjectStore(ka),l.deleteObjectStore(Na),l.deleteObjectStore(Ki)}(e),EI(e)),o=o.next(()=>function(l){const d=l.store(Ki),h={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:fe.min().toTimestamp(),targetCount:0};return d.put(ah,h)}(i))),r<4&&s>=4&&(r!==0&&(o=o.next(()=>function(l,d){return d.store(gr).J().next(f=>{l.deleteObjectStore(gr),l.createObjectStore(gr,{keyPath:NE,autoIncrement:!0}).createIndex(zi,kE,{unique:!0});const m=d.store(gr),v=f.map(R=>m.put(R));return O.waitFor(v)})}(e,i))),o=o.next(()=>{(function(l){l.createObjectStore(Da,{keyPath:DO})})(e)})),r<5&&s>=5&&(o=o.next(()=>this.yi(i))),r<6&&s>=6&&(o=o.next(()=>(function(l){l.createObjectStore(Nc)}(e),this.wi(i)))),r<7&&s>=7&&(o=o.next(()=>this.Si(i))),r<8&&s>=8&&(o=o.next(()=>this.bi(e,i))),r<9&&s>=9&&(o=o.next(()=>{(function(l){l.objectStoreNames.contains("remoteDocumentChanges")&&l.deleteObjectStore("remoteDocumentChanges")})(e)})),r<10&&s>=10&&(o=o.next(()=>this.Di(i))),r<11&&s>=11&&(o=o.next(()=>{(function(l){l.createObjectStore(tf,{keyPath:jO})})(e),function(l){l.createObjectStore(nf,{keyPath:OO})}(e)})),r<12&&s>=12&&(o=o.next(()=>{(function(l){const d=l.createObjectStore(rf,{keyPath:BO});d.createIndex(Zm,zO,{unique:!1}),d.createIndex(wb,qO,{unique:!1})})(e)})),r<13&&s>=13&&(o=o.next(()=>function(l){const d=l.createObjectStore(oh,{keyPath:bO});d.createIndex(md,CO),d.createIndex(gb,AO)}(e)).next(()=>this.Ci(e,i)).next(()=>e.deleteObjectStore(ji))),r<14&&s>=14&&(o=o.next(()=>this.Fi(e,i))),r<15&&s>=15&&(o=o.next(()=>function(l){l.createObjectStore(By,{keyPath:VO,autoIncrement:!0}).createIndex(Jm,LO,{unique:!1}),l.createObjectStore(ec,{keyPath:MO}).createIndex(vb,FO,{unique:!1}),l.createObjectStore(tc,{keyPath:UO}).createIndex(_b,$O,{unique:!1})}(e))),r<16&&s>=16&&(o=o.next(()=>{n.objectStore(ec).clear()}).next(()=>{n.objectStore(tc).clear()})),r<17&&s>=17&&(o=o.next(()=>{(function(l){l.createObjectStore(zy,{keyPath:HO})})(e)})),r<18&&s>=18&&hS()&&(o=o.next(()=>{n.objectStore(ec).clear()}).next(()=>{n.objectStore(tc).clear()})),o}wi(e){let n=0;return e.store(ji).ee((r,s)=>{n+=gh(s)}).next(()=>{const r={byteSize:n};return e.store(Nc).put(Xm,r)})}yi(e){const n=e.store(Pc),r=e.store(gr);return n.J().next(s=>O.forEach(s,i=>{const o=IDBKeyRange.bound([i.userId,Gi],[i.userId,i.lastAcknowledgedBatchId]);return r.J(zi,o).next(a=>O.forEach(a,l=>{he(l.userId===i.userId,18650,"Cannot process batch from unexpected user",{batchId:l.batchId});const d=Vi(this.serializer,l);return IC(e,i.userId,d).next(()=>{})}))}))}Si(e){const n=e.store(ka),r=e.store(ji);return e.store(Ki).get(ah).next(s=>{const i=[];return r.ee((o,a)=>{const l=new We(o),d=function(f){return[0,cn(f)]}(l);i.push(n.get(d).next(h=>h?O.resolve():(f=>n.put({targetId:0,path:cn(f),sequenceNumber:s.highestListenSequenceNumber}))(l)))}).next(()=>O.waitFor(i))})}bi(e,n){e.createObjectStore(kc,{keyPath:kO});const r=n.store(kc),s=new rv,i=o=>{if(s.add(o)){const a=o.lastSegment(),l=o.popLast();return r.put({collectionId:a,parent:cn(l)})}};return n.store(ji).ee({X:!0},(o,a)=>{const l=new We(o);return i(l.popLast())}).next(()=>n.store(Pa).ee({X:!0},([o,a,l],d)=>{const h=Ur(a);return i(h.popLast())}))}Di(e){const n=e.store(Na);return n.ee((r,s)=>{const i=Ll(s),o=yC(this.serializer,i);return n.put(o)})}Ci(e,n){const r=n.store(ji),s=[];return r.ee((i,o)=>{const a=n.store(oh),l=function(f){return f.document?new ee(We.fromString(f.document.name).popFirst(5)):f.noDocument?ee.fromSegments(f.noDocument.path):f.unknownDocument?ee.fromSegments(f.unknownDocument.path):le(36783)}(o).path.toArray(),d={prefixPath:l.slice(0,l.length-2),collectionGroup:l[l.length-2],documentId:l[l.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};s.push(a.put(d))}).next(()=>O.waitFor(s))}Fi(e,n){const r=n.store(gr),s=AC(this.serializer),i=new iv(gf.mi,this.serializer.yt);return r.J().next(o=>{const a=new Map;return o.forEach(l=>{let d=a.get(l.userId)??ke();Vi(this.serializer,l).keys().forEach(h=>d=d.add(h)),a.set(l.userId,d)}),O.forEach(a,(l,d)=>{const h=new Kt(d),f=pf.wt(this.serializer,h),m=i.getIndexManager(h),v=mf.wt(h,this.serializer,m,i.referenceDelegate);return new RC(s,v,f,m).recalculateAndSaveOverlaysForDocumentKeys(new eg(n,rr.ce),l).next()})})}}function EI(t){t.createObjectStore(ka,{keyPath:PO}).createIndex($y,NO,{unique:!0}),t.createObjectStore(Na,{keyPath:"targetId"}).createIndex(yb,RO,{unique:!0}),t.createObjectStore(Ki)}const ks="IndexedDbPersistence",bp=18e5,Cp=5e3,Ap="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",gL="main";class ov{constructor(e,n,r,s,i,o,a,l,d,h,f=18){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.Mi=i,this.window=o,this.document=a,this.xi=d,this.Oi=h,this.Ni=f,this.ci=null,this.li=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Bi=null,this.inForeground=!1,this.Li=null,this.ki=null,this.qi=Number.NEGATIVE_INFINITY,this.Qi=m=>Promise.resolve(),!ov.v())throw new Q($.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new rL(this,s),this.$i=n+gL,this.serializer=new gC(l),this.Ui=new oi(this.$i,this.Ni,new mL(this.serializer)),this.hi=new HV,this.Pi=new ZV(this.referenceDelegate,this.serializer),this.remoteDocumentCache=AC(this.serializer),this.Ii=new qV,this.window&&this.window.localStorage?this.Ki=this.window.localStorage:(this.Ki=null,h===!1&&mn(ks,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Wi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new Q($.FAILED_PRECONDITION,Ap);return this.Gi(),this.zi(),this.ji(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Pi.getHighestSequenceNumber(e))}).then(e=>{this.ci=new rr(e,this.xi)}).then(()=>{this.li=!0}).catch(e=>(this.Ui&&this.Ui.close(),Promise.reject(e)))}Ji(e){return this.Qi=async n=>{if(this.started)return e(n)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ui.$(async n=>{n.newVersion===null&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Mi.enqueueAndForget(async()=>{this.started&&await this.Wi()}))}Wi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>Bu(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.Hi(e).next(n=>{n||(this.isPrimary=!1,this.Mi.enqueueRetryable(()=>this.Qi(!1)))})}).next(()=>this.Yi(e)).next(n=>this.isPrimary&&!n?this.Zi(e).next(()=>!1):!!n&&this.Xi(e).next(()=>!0))).catch(e=>{if(Ei(e))return W(ks,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return W(ks,"Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.Mi.enqueueRetryable(()=>this.Qi(e)),this.isPrimary=e})}Hi(e){return Sl(e).get(Po).next(n=>O.resolve(this.es(n)))}ts(e){return Bu(e).delete(this.clientId)}async ns(){if(this.isPrimary&&!this.rs(this.qi,bp)){this.qi=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",n=>{const r=Mt(n,Da);return r.J().next(s=>{const i=this.ss(s,bp),o=s.filter(a=>i.indexOf(a)===-1);return O.forEach(o,a=>r.delete(a.clientId)).next(()=>o)})}).catch(()=>[]);if(this.Ki)for(const n of e)this.Ki.removeItem(this._s(n.clientId))}}ji(){this.ki=this.Mi.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.Wi().then(()=>this.ns()).then(()=>this.ji()))}es(e){return!!e&&e.ownerId===this.clientId}Yi(e){return this.Oi?O.resolve(!0):Sl(e).get(Po).next(n=>{if(n!==null&&this.rs(n.leaseTimestampMs,Cp)&&!this.us(n.ownerId)){if(this.es(n)&&this.networkEnabled)return!0;if(!this.es(n)){if(!n.allowTabSynchronization)throw new Q($.FAILED_PRECONDITION,Ap);return!1}}return!(!this.networkEnabled||!this.inForeground)||Bu(e).J().next(r=>this.ss(r,Cp).find(s=>{if(this.clientId!==s.clientId){const i=!this.networkEnabled&&s.networkEnabled,o=!this.inForeground&&s.inForeground,a=this.networkEnabled===s.networkEnabled;if(i||o&&a)return!0}return!1})===void 0)}).next(n=>(this.isPrimary!==n&&W(ks,`Client ${n?"is":"is not"} eligible for a primary lease.`),n))}async shutdown(){this.li=!1,this.cs(),this.ki&&(this.ki.cancel(),this.ki=null),this.ls(),this.hs(),await this.Ui.runTransaction("shutdown","readwrite",[Yc,Da],e=>{const n=new eg(e,rr.ce);return this.Zi(n).next(()=>this.ts(n))}),this.Ui.close(),this.Ps()}ss(e,n){return e.filter(r=>this.rs(r.updateTimeMs,n)&&!this.us(r.clientId))}Ts(){return this.runTransaction("getActiveClients","readonly",e=>Bu(e).J().next(n=>this.ss(n,bp).map(r=>r.clientId)))}get started(){return this.li}getGlobalsCache(){return this.hi}getMutationQueue(e,n){return mf.wt(e,this.serializer,n,this.referenceDelegate)}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new JV(e,this.serializer.yt.databaseId)}getDocumentOverlayCache(e){return pf.wt(this.serializer,e)}getBundleCache(){return this.Ii}runTransaction(e,n,r){W(ks,"Starting transaction:",e);const s=n==="readonly"?"readonly":"readwrite",i=function(l){return l===18?KO:l===17?Tb:l===16?GO:l===15?qy:l===14?xb:l===13?Ib:l===12?WO:l===11?Eb:void le(60245)}(this.Ni);let o;return this.Ui.runTransaction(e,s,i,a=>(o=new eg(a,this.ci?this.ci.next():rr.ce),n==="readwrite-primary"?this.Hi(o).next(l=>!!l||this.Yi(o)).next(l=>{if(!l)throw mn(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Mi.enqueueRetryable(()=>this.Qi(!1)),new Q($.FAILED_PRECONDITION,hb);return r(o)}).next(l=>this.Xi(o).next(()=>l)):this.Is(o).next(()=>r(o)))).then(a=>(o.raiseOnCommittedEvent(),a))}Is(e){return Sl(e).get(Po).next(n=>{if(n!==null&&this.rs(n.leaseTimestampMs,Cp)&&!this.us(n.ownerId)&&!this.es(n)&&!(this.Oi||this.allowTabSynchronization&&n.allowTabSynchronization))throw new Q($.FAILED_PRECONDITION,Ap)})}Xi(e){const n={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return Sl(e).put(Po,n)}static v(){return oi.v()}Zi(e){const n=Sl(e);return n.get(Po).next(r=>this.es(r)?(W(ks,"Releasing primary lease."),n.delete(Po)):O.resolve())}rs(e,n){const r=Date.now();return!(e<r-n)&&(!(e>r)||(mn(`Detected an update time that is in the future: ${e} > ${r}`),!1))}Gi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Li=()=>{this.Mi.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.Wi()))},this.document.addEventListener("visibilitychange",this.Li),this.inForeground=this.document.visibilityState==="visible")}ls(){this.Li&&(this.document.removeEventListener("visibilitychange",this.Li),this.Li=null)}zi(){var e;typeof((e=this.window)==null?void 0:e.addEventListener)=="function"&&(this.Bi=()=>{this.cs();const n=/(?:Version|Mobile)\/1[456]/;dS()&&(navigator.appVersion.match(n)||navigator.userAgent.match(n))&&this.Mi.enterRestrictedMode(!0),this.Mi.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Bi))}hs(){this.Bi&&(this.window.removeEventListener("pagehide",this.Bi),this.Bi=null)}us(e){var n;try{const r=((n=this.Ki)==null?void 0:n.getItem(this._s(e)))!==null;return W(ks,`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return mn(ks,"Failed to get zombied client id.",r),!1}}cs(){if(this.Ki)try{this.Ki.setItem(this._s(this.clientId),String(Date.now()))}catch(e){mn("Failed to set zombie client id.",e)}}Ps(){if(this.Ki)try{this.Ki.removeItem(this._s(this.clientId))}catch{}}_s(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function Sl(t){return Mt(t,Yc)}function Bu(t){return Mt(t,Da)}function yL(t,e){let n=t.projectId;return t.isDefaultDatabase||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class av{constructor(e,n,r,s){this.targetId=e,this.fromCache=n,this.Es=r,this.ds=s}static As(e,n){let r=ke(),s=ke();for(const i of n.docChanges)switch(i.type){case 0:r=r.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new av(e,n.fromCache,r,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vL{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PC{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=function(){return dS()?8:pb(Lt())>0?6:4}()}initialize(e,n){this.ps=e,this.indexManager=n,this.Rs=!0}getDocumentsMatchingQuery(e,n,r,s){const i={result:null};return this.ys(e,n).next(o=>{i.result=o}).next(()=>{if(!i.result)return this.ws(e,n,s,r).next(o=>{i.result=o})}).next(()=>{if(i.result)return;const o=new vL;return this.Ss(e,n,o).next(a=>{if(i.result=a,this.Vs)return this.bs(e,n,o,a.size)})}).next(()=>i.result)}bs(e,n,r,s){return r.documentReadCount<this.fs?(zo()<=Ve.DEBUG&&W("QueryEngine","SDK will not create cache indexes for query:",qo(n),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),O.resolve()):(zo()<=Ve.DEBUG&&W("QueryEngine","Query:",qo(n),"scans",r.documentReadCount,"local documents and returns",s,"documents as results."),r.documentReadCount>this.gs*s?(zo()<=Ve.DEBUG&&W("QueryEngine","The SDK decides to create cache indexes for query:",qo(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,ir(n))):O.resolve())}ys(e,n){if(HE(n))return O.resolve(null);let r=ir(n);return this.indexManager.getIndexType(e,r).next(s=>s===0?null:(n.limit!==null&&s===1&&(n=dh(n,null,"F"),r=ir(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(i=>{const o=ke(...i);return this.ps.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,r).next(l=>{const d=this.Ds(n,a);return this.Cs(n,d,o,l.readTime)?this.ys(e,dh(n,null,"F")):this.vs(e,d,n,l)}))})))}ws(e,n,r,s){return HE(n)||s.isEqual(fe.min())?O.resolve(null):this.ps.getDocuments(e,r).next(i=>{const o=this.Ds(n,i);return this.Cs(n,o,r,s)?O.resolve(null):(zo()<=Ve.DEBUG&&W("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),qo(n)),this.vs(e,o,n,yO(s,Cc)).next(a=>a))})}Ds(e,n){let r=new tt(qb(e));return n.forEach((s,i)=>{Zc(e,i)&&(r=r.add(i))}),r}Cs(e,n,r,s){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const i=e.limitType==="F"?n.last():n.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}Ss(e,n,r){return zo()<=Ve.DEBUG&&W("QueryEngine","Using full collection scan to execute query:",qo(n)),this.ps.getDocumentsMatchingQuery(e,n,Hn.min(),r)}vs(e,n,r,s){return this.ps.getDocumentsMatchingQuery(e,r,s).next(i=>(n.forEach(o=>{i=i.insert(o.key,o)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lv="LocalStore",_L=3e8;class wL{constructor(e,n,r,s){this.persistence=e,this.Fs=n,this.serializer=s,this.Ms=new ft(Ie),this.xs=new ws(i=>co(i),Xc),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(r)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new RC(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.Ms))}}function NC(t,e,n,r){return new wL(t,e,n,r)}async function kC(t,e){const n=Ee(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let s;return n.mutationQueue.getAllMutationBatches(r).next(i=>(s=i,n.Bs(e),n.mutationQueue.getAllMutationBatches(r))).next(i=>{const o=[],a=[];let l=ke();for(const d of s){o.push(d.batchId);for(const h of d.mutations)l=l.add(h.key)}for(const d of i){a.push(d.batchId);for(const h of d.mutations)l=l.add(h.key)}return n.localDocuments.getDocuments(r,l).next(d=>({Ls:d,removedBatchIds:o,addedBatchIds:a}))})})}function EL(t,e){const n=Ee(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const s=e.batch.keys(),i=n.Ns.newChangeBuffer({trackRemovals:!0});return function(a,l,d,h){const f=d.batch,m=f.keys();let v=O.resolve();return m.forEach(R=>{v=v.next(()=>h.getEntry(l,R)).next(T=>{const P=d.docVersions.get(R);he(P!==null,48541),T.version.compareTo(P)<0&&(f.applyToRemoteDocument(T,d),T.isValidDocument()&&(T.setReadTime(d.commitVersion),h.addEntry(T)))})}),v.next(()=>a.mutationQueue.removeMutationBatch(l,f))}(n,r,e,i).next(()=>i.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,s,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let l=ke();for(let d=0;d<a.mutationResults.length;++d)a.mutationResults[d].transformResults.length>0&&(l=l.add(a.batch.mutations[d].key));return l}(e))).next(()=>n.localDocuments.getDocuments(r,s))})}function DC(t){const e=Ee(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Pi.getLastRemoteSnapshotVersion(n))}function IL(t,e){const n=Ee(t),r=e.snapshotVersion;let s=n.Ms;return n.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const o=n.Ns.newChangeBuffer({trackRemovals:!0});s=n.Ms;const a=[];e.targetChanges.forEach((h,f)=>{const m=s.get(f);if(!m)return;a.push(n.Pi.removeMatchingKeys(i,h.removedDocuments,f).next(()=>n.Pi.addMatchingKeys(i,h.addedDocuments,f)));let v=m.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(f)!==null?v=v.withResumeToken(kt.EMPTY_BYTE_STRING,fe.min()).withLastLimboFreeSnapshotVersion(fe.min()):h.resumeToken.approximateByteSize()>0&&(v=v.withResumeToken(h.resumeToken,r)),s=s.insert(f,v),function(T,P,E){return T.resumeToken.approximateByteSize()===0||P.snapshotVersion.toMicroseconds()-T.snapshotVersion.toMicroseconds()>=_L?!0:E.addedDocuments.size+E.modifiedDocuments.size+E.removedDocuments.size>0}(m,v,h)&&a.push(n.Pi.updateTargetData(i,v))});let l=$n(),d=ke();if(e.documentUpdates.forEach(h=>{e.resolvedLimboDocuments.has(h)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(i,h))}),a.push(xL(i,o,e.documentUpdates).next(h=>{l=h.ks,d=h.qs})),!r.isEqual(fe.min())){const h=n.Pi.getLastRemoteSnapshotVersion(i).next(f=>n.Pi.setTargetsMetadata(i,i.currentSequenceNumber,r));a.push(h)}return O.waitFor(a).next(()=>o.apply(i)).next(()=>n.localDocuments.getLocalViewOfDocuments(i,l,d)).next(()=>l)}).then(i=>(n.Ms=s,i))}function xL(t,e,n){let r=ke(),s=ke();return n.forEach(i=>r=r.add(i)),e.getEntries(t,r).next(i=>{let o=$n();return n.forEach((a,l)=>{const d=i.get(a);l.isFoundDocument()!==d.isFoundDocument()&&(s=s.add(a)),l.isNoDocument()&&l.version.isEqual(fe.min())?(e.removeEntry(a,l.readTime),o=o.insert(a,l)):!d.isValidDocument()||l.version.compareTo(d.version)>0||l.version.compareTo(d.version)===0&&d.hasPendingWrites?(e.addEntry(l),o=o.insert(a,l)):W(lv,"Ignoring outdated watch update for ",a,". Current version:",d.version," Watch version:",l.version)}),{ks:o,qs:s}})}function TL(t,e){const n=Ee(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=Gi),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function SL(t,e){const n=Ee(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let s;return n.Pi.getTargetData(r,e).next(i=>i?(s=i,O.resolve(s)):n.Pi.allocateTargetId(r).next(o=>(s=new os(e,o,"TargetPurposeListen",r.currentSequenceNumber),n.Pi.addTargetData(r,s).next(()=>s))))}).then(r=>{const s=n.Ms.get(r.targetId);return(s===null||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(n.Ms=n.Ms.insert(r.targetId,r),n.xs.set(e,r.targetId)),r})}async function pg(t,e,n){const r=Ee(t),s=r.Ms.get(e),i=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",i,o=>r.persistence.referenceDelegate.removeTarget(o,s))}catch(o){if(!Ei(o))throw o;W(lv,`Failed to update sequence numbers for target ${e}: ${o}`)}r.Ms=r.Ms.remove(e),r.xs.delete(s.target)}function II(t,e,n){const r=Ee(t);let s=fe.min(),i=ke();return r.persistence.runTransaction("Execute query","readwrite",o=>function(l,d,h){const f=Ee(l),m=f.xs.get(h);return m!==void 0?O.resolve(f.Ms.get(m)):f.Pi.getTargetData(d,h)}(r,o,ir(e)).next(a=>{if(a)return s=a.lastLimboFreeSnapshotVersion,r.Pi.getMatchingKeysForTargetId(o,a.targetId).next(l=>{i=l})}).next(()=>r.Fs.getDocumentsMatchingQuery(o,e,n?s:fe.min(),n?i:ke())).next(a=>(bL(r,uV(e),a),{documents:a,Qs:i})))}function bL(t,e,n){let r=t.Os.get(e)||fe.min();n.forEach((s,i)=>{i.readTime.compareTo(r)>0&&(r=i.readTime)}),t.Os.set(e,r)}class xI{constructor(){this.activeTargetIds=gV()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class jC{constructor(){this.Mo=new xI,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,n,r){this.xo[e]=n}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new xI,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CL{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TI="ConnectivityMonitor";class SI{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){W(TI,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){W(TI,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let zu=null;function mg(){return zu===null?zu=function(){return 268435456+Math.round(2147483648*Math.random())}():zu++,"0x"+zu.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rp="RestConnection",AL={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class RL{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const n=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Uo=n+"://"+e.host,this.Ko=`projects/${r}/databases/${s}`,this.Wo=this.databaseId.database===lh?`project_id=${r}`:`project_id=${r}&database_id=${s}`}Go(e,n,r,s,i){const o=mg(),a=this.zo(e,n.toUriEncodedString());W(Rp,`Sending RPC '${e}' ${o}:`,a,r);const l={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(l,s,i);const{host:d}=new URL(a),h=vi(d);return this.Jo(e,a,l,r,h).then(f=>(W(Rp,`Received RPC '${e}' ${o}: `,f),f),f=>{throw oo(Rp,`RPC '${e}' ${o} failed with error: `,f,"url: ",a,"request:",r),f})}Ho(e,n,r,s,i,o){return this.Go(e,n,r,s,i)}jo(e,n,r){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Xa}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((s,i)=>e[i]=s),r&&r.headers.forEach((s,i)=>e[i]=s)}zo(e,n){const r=AL[e];return`${this.Uo}/v1/${n}:${r}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PL{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nn="WebChannelConnection";class NL extends RL{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,n,r,s,i){const o=mg();return new Promise((a,l)=>{const d=new tb;d.setWithCredentials(!0),d.listenOnce(nb.COMPLETE,()=>{try{switch(d.getLastErrorCode()){case hd.NO_ERROR:const f=d.getResponseJson();W(nn,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(f)),a(f);break;case hd.TIMEOUT:W(nn,`RPC '${e}' ${o} timed out`),l(new Q($.DEADLINE_EXCEEDED,"Request time out"));break;case hd.HTTP_ERROR:const m=d.getStatus();if(W(nn,`RPC '${e}' ${o} failed with status:`,m,"response text:",d.getResponseText()),m>0){let v=d.getResponseJson();Array.isArray(v)&&(v=v[0]);const R=v==null?void 0:v.error;if(R&&R.status&&R.message){const T=function(E){const I=E.toLowerCase().replace(/_/g,"-");return Object.values($).indexOf(I)>=0?I:$.UNKNOWN}(R.status);l(new Q(T,R.message))}else l(new Q($.UNKNOWN,"Server responded with status "+d.getStatus()))}else l(new Q($.UNAVAILABLE,"Connection failed."));break;default:le(9055,{l_:e,streamId:o,h_:d.getLastErrorCode(),P_:d.getLastError()})}}finally{W(nn,`RPC '${e}' ${o} completed.`)}});const h=JSON.stringify(s);W(nn,`RPC '${e}' ${o} sending request:`,s),d.send(n,"POST",h,r,15)})}T_(e,n,r){const s=mg(),i=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=ib(),a=sb(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},d=this.longPollingOptions.timeoutSeconds;d!==void 0&&(l.longPollingTimeout=Math.round(1e3*d)),this.useFetchStreams&&(l.useFetchStreams=!0),this.jo(l.initMessageHeaders,n,r),l.encodeInitMessageHeaders=!0;const h=i.join("");W(nn,`Creating RPC '${e}' stream ${s}: ${h}`,l);const f=o.createWebChannel(h,l);this.I_(f);let m=!1,v=!1;const R=new PL({Yo:P=>{v?W(nn,`Not sending because RPC '${e}' stream ${s} is closed:`,P):(m||(W(nn,`Opening RPC '${e}' stream ${s} transport.`),f.open(),m=!0),W(nn,`RPC '${e}' stream ${s} sending:`,P),f.send(P))},Zo:()=>f.close()}),T=(P,E,I)=>{P.listen(E,S=>{try{I(S)}catch(b){setTimeout(()=>{throw b},0)}})};return T(f,jl.EventType.OPEN,()=>{v||(W(nn,`RPC '${e}' stream ${s} transport opened.`),R.o_())}),T(f,jl.EventType.CLOSE,()=>{v||(v=!0,W(nn,`RPC '${e}' stream ${s} transport closed`),R.a_(),this.E_(f))}),T(f,jl.EventType.ERROR,P=>{v||(v=!0,oo(nn,`RPC '${e}' stream ${s} transport errored. Name:`,P.name,"Message:",P.message),R.a_(new Q($.UNAVAILABLE,"The operation could not be completed")))}),T(f,jl.EventType.MESSAGE,P=>{var E;if(!v){const I=P.data[0];he(!!I,16349);const S=I,b=(S==null?void 0:S.error)||((E=S[0])==null?void 0:E.error);if(b){W(nn,`RPC '${e}' stream ${s} received error:`,b);const L=b.status;let B=function(y){const N=Rt[y];if(N!==void 0)return rC(N)}(L),w=b.message;B===void 0&&(B=$.INTERNAL,w="Unknown error status: "+L+" with message "+b.message),v=!0,R.a_(new Q(B,w)),f.close()}else W(nn,`RPC '${e}' stream ${s} received:`,I),R.u_(I)}}),T(a,rb.STAT_EVENT,P=>{P.stat===Km.PROXY?W(nn,`RPC '${e}' stream ${s} detected buffering proxy`):P.stat===Km.NOPROXY&&W(nn,`RPC '${e}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{R.__()},0),R}terminate(){this.c_.forEach(e=>e.close()),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter(n=>n===e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kL(){return typeof window<"u"?window:null}function Id(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yf(t){return new kV(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OC{constructor(e,n,r=1e3,s=1.5,i=6e4){this.Mi=e,this.timerId=n,this.d_=r,this.A_=s,this.R_=i,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const n=Math.floor(this.V_+this.y_()),r=Math.max(0,Date.now()-this.f_),s=Math.max(0,n-r);s>0&&W("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.V_} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,s,()=>(this.f_=Date.now(),e())),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bI="PersistentStream";class VC{constructor(e,n,r,s,i,o,a,l){this.Mi=e,this.S_=r,this.b_=s,this.connection=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=l,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new OC(e,n)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,()=>this.k_()))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,n){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():n&&n.code===$.RESOURCE_EXHAUSTED?(mn(n.toString()),mn("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):n&&n.code===$.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(n)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),n=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,s])=>{this.D_===n&&this.G_(r,s)},r=>{e(()=>{const s=new Q($.UNKNOWN,"Fetching auth token failed: "+r.message);return this.z_(s)})})}G_(e,n){const r=this.W_(this.D_);this.stream=this.j_(e,n),this.stream.Xo(()=>{r(()=>this.listener.Xo())}),this.stream.t_(()=>{r(()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.t_()))}),this.stream.r_(s=>{r(()=>this.z_(s))}),this.stream.onMessage(s=>{r(()=>++this.F_==1?this.J_(s):this.onNext(s))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return W(bI,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return n=>{this.Mi.enqueueAndForget(()=>this.D_===e?n():(W(bI,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class DL extends VC{constructor(e,n,r,s,i,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,s,o),this.serializer=i}j_(e,n){return this.connection.T_("Listen",e,n)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const n=OV(this.serializer,e),r=function(i){if(!("targetChange"in i))return fe.min();const o=i.targetChange;return o.targetIds&&o.targetIds.length?fe.min():o.readTime?_n(o.readTime):fe.min()}(e);return this.listener.H_(n,r)}Y_(e){const n={};n.database=cg(this.serializer),n.addTarget=function(i,o){let a;const l=o.target;if(a=ch(l)?{documents:dC(i,l)}:{query:tv(i,l).ft},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=oC(i,o.resumeToken);const d=ag(i,o.expectedCount);d!==null&&(a.expectedCount=d)}else if(o.snapshotVersion.compareTo(fe.min())>0){a.readTime=Ua(i,o.snapshotVersion.toTimestamp());const d=ag(i,o.expectedCount);d!==null&&(a.expectedCount=d)}return a}(this.serializer,e);const r=MV(this.serializer,e);r&&(n.labels=r),this.q_(n)}Z_(e){const n={};n.database=cg(this.serializer),n.removeTarget=e,this.q_(n)}}class jL extends VC{constructor(e,n,r,s,i,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,s,o),this.serializer=i}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,n){return this.connection.T_("Write",e,n)}J_(e){return he(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,he(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){he(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const n=VV(e.writeResults,e.commitTime),r=_n(e.commitTime);return this.listener.na(r,n)}ra(){const e={};e.database=cg(this.serializer),this.q_(e)}ea(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>fh(this.serializer,r))};this.q_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OL{}class VL extends OL{constructor(e,n,r,s){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=s,this.ia=!1}sa(){if(this.ia)throw new Q($.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,n,r,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.connection.Go(e,lg(n,r),s,i,o)).catch(i=>{throw i.name==="FirebaseError"?(i.code===$.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new Q($.UNKNOWN,i.toString())})}Ho(e,n,r,s,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.Ho(e,lg(n,r),s,o,a,i)).catch(o=>{throw o.name==="FirebaseError"?(o.code===$.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new Q($.UNKNOWN,o.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}class LL{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(mn(n),this.aa=!1):W("OnlineStateTracker",n)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mo="RemoteStore";class ML{constructor(e,n,r,s,i){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=i,this.Aa.Oo(o=>{r.enqueueAndForget(async()=>{So(this)&&(W(mo,"Restarting streams for network reachability change."),await async function(l){const d=Ee(l);d.Ea.add(4),await tu(d),d.Ra.set("Unknown"),d.Ea.delete(4),await vf(d)}(this))})}),this.Ra=new LL(r,s)}}async function vf(t){if(So(t))for(const e of t.da)await e(!0)}async function tu(t){for(const e of t.da)await e(!1)}function LC(t,e){const n=Ee(t);n.Ia.has(e.targetId)||(n.Ia.set(e.targetId,e),hv(n)?dv(n):Za(n).O_()&&uv(n,e))}function cv(t,e){const n=Ee(t),r=Za(n);n.Ia.delete(e),r.O_()&&MC(n,e),n.Ia.size===0&&(r.O_()?r.L_():So(n)&&n.Ra.set("Unknown"))}function uv(t,e){if(t.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(fe.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}Za(t).Y_(e)}function MC(t,e){t.Va.Ue(e),Za(t).Z_(e)}function dv(t){t.Va=new AV({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),At:e=>t.Ia.get(e)||null,ht:()=>t.datastore.serializer.databaseId}),Za(t).start(),t.Ra.ua()}function hv(t){return So(t)&&!Za(t).x_()&&t.Ia.size>0}function So(t){return Ee(t).Ea.size===0}function FC(t){t.Va=void 0}async function FL(t){t.Ra.set("Online")}async function UL(t){t.Ia.forEach((e,n)=>{uv(t,e)})}async function $L(t,e){FC(t),hv(t)?(t.Ra.ha(e),dv(t)):t.Ra.set("Unknown")}async function BL(t,e,n){if(t.Ra.set("Online"),e instanceof iC&&e.state===2&&e.cause)try{await async function(s,i){const o=i.cause;for(const a of i.targetIds)s.Ia.has(a)&&(await s.remoteSyncer.rejectListen(a,o),s.Ia.delete(a),s.Va.removeTarget(a))}(t,e)}catch(r){W(mo,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await vh(t,r)}else if(e instanceof wd?t.Va.Ze(e):e instanceof sC?t.Va.st(e):t.Va.tt(e),!n.isEqual(fe.min()))try{const r=await DC(t.localStore);n.compareTo(r)>=0&&await function(i,o){const a=i.Va.Tt(o);return a.targetChanges.forEach((l,d)=>{if(l.resumeToken.approximateByteSize()>0){const h=i.Ia.get(d);h&&i.Ia.set(d,h.withResumeToken(l.resumeToken,o))}}),a.targetMismatches.forEach((l,d)=>{const h=i.Ia.get(l);if(!h)return;i.Ia.set(l,h.withResumeToken(kt.EMPTY_BYTE_STRING,h.snapshotVersion)),MC(i,l);const f=new os(h.target,l,d,h.sequenceNumber);uv(i,f)}),i.remoteSyncer.applyRemoteEvent(a)}(t,n)}catch(r){W(mo,"Failed to raise snapshot:",r),await vh(t,r)}}async function vh(t,e,n){if(!Ei(e))throw e;t.Ea.add(1),await tu(t),t.Ra.set("Offline"),n||(n=()=>DC(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{W(mo,"Retrying IndexedDB access"),await n(),t.Ea.delete(1),await vf(t)})}function UC(t,e){return e().catch(n=>vh(t,n,e))}async function nu(t){const e=Ee(t),n=fi(e);let r=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:Gi;for(;zL(e);)try{const s=await TL(e.localStore,r);if(s===null){e.Ta.length===0&&n.L_();break}r=s.batchId,qL(e,s)}catch(s){await vh(e,s)}$C(e)&&BC(e)}function zL(t){return So(t)&&t.Ta.length<10}function qL(t,e){t.Ta.push(e);const n=fi(t);n.O_()&&n.X_&&n.ea(e.mutations)}function $C(t){return So(t)&&!fi(t).x_()&&t.Ta.length>0}function BC(t){fi(t).start()}async function HL(t){fi(t).ra()}async function WL(t){const e=fi(t);for(const n of t.Ta)e.ea(n.mutations)}async function GL(t,e,n){const r=t.Ta.shift(),s=Xy.from(r,e,n);await UC(t,()=>t.remoteSyncer.applySuccessfulWrite(s)),await nu(t)}async function KL(t,e){e&&fi(t).X_&&await async function(r,s){if(function(o){return SV(o)&&o!==$.ABORTED}(s.code)){const i=r.Ta.shift();fi(r).B_(),await UC(r,()=>r.remoteSyncer.rejectFailedWrite(i.batchId,s)),await nu(r)}}(t,e),$C(t)&&BC(t)}async function CI(t,e){const n=Ee(t);n.asyncQueue.verifyOperationInProgress(),W(mo,"RemoteStore received new credentials");const r=So(n);n.Ea.add(3),await tu(n),r&&n.Ra.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.Ea.delete(3),await vf(n)}async function QL(t,e){const n=Ee(t);e?(n.Ea.delete(2),await vf(n)):e||(n.Ea.add(2),await tu(n),n.Ra.set("Unknown"))}function Za(t){return t.ma||(t.ma=function(n,r,s){const i=Ee(n);return i.sa(),new DL(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Xo:FL.bind(null,t),t_:UL.bind(null,t),r_:$L.bind(null,t),H_:BL.bind(null,t)}),t.da.push(async e=>{e?(t.ma.B_(),hv(t)?dv(t):t.Ra.set("Unknown")):(await t.ma.stop(),FC(t))})),t.ma}function fi(t){return t.fa||(t.fa=function(n,r,s){const i=Ee(n);return i.sa(),new jL(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Xo:()=>Promise.resolve(),t_:HL.bind(null,t),r_:KL.bind(null,t),ta:WL.bind(null,t),na:GL.bind(null,t)}),t.da.push(async e=>{e?(t.fa.B_(),await nu(t)):(await t.fa.stop(),t.Ta.length>0&&(W(mo,`Stopping write stream with ${t.Ta.length} pending writes`),t.Ta=[]))})),t.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fv{constructor(e,n,r,s,i){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=s,this.removalCallback=i,this.deferred=new Er,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,s,i){const o=Date.now()+r,a=new fv(e,n,o,s,i);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Q($.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function pv(t,e){if(mn("AsyncQueue",`${e}: ${t}`),Ei(t))return new Q($.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ya{static emptySet(e){return new ya(e.comparator)}constructor(e){this.comparator=e?(n,r)=>e(n,r)||ee.comparator(n.key,r.key):(n,r)=>ee.comparator(n.key,r.key),this.keyedMap=Ol(),this.sortedSet=new ft(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof ya)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new ya;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AI{constructor(){this.ga=new ft(ee.comparator)}track(e){const n=e.doc.key,r=this.ga.get(n);r?e.type!==0&&r.type===3?this.ga=this.ga.insert(n,e):e.type===3&&r.type!==1?this.ga=this.ga.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.ga=this.ga.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.ga=this.ga.remove(n):e.type===1&&r.type===2?this.ga=this.ga.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):le(63341,{Rt:e,pa:r}):this.ga=this.ga.insert(n,e)}ya(){const e=[];return this.ga.inorderTraversal((n,r)=>{e.push(r)}),e}}class $a{constructor(e,n,r,s,i,o,a,l,d){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=l,this.hasCachedResults=d}static fromInitialDocuments(e,n,r,s,i){const o=[];return n.forEach(a=>{o.push({type:0,doc:a})}),new $a(e,n,ya.emptySet(n),o,r,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&lf(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let s=0;s<n.length;s++)if(n[s].type!==r[s].type||!n[s].doc.isEqual(r[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YL{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some(e=>e.Da())}}class XL{constructor(){this.queries=RI(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(n,r){const s=Ee(n),i=s.queries;s.queries=RI(),i.forEach((o,a)=>{for(const l of a.Sa)l.onError(r)})})(this,new Q($.ABORTED,"Firestore shutting down"))}}function RI(){return new ws(t=>zb(t),lf)}async function mv(t,e){const n=Ee(t);let r=3;const s=e.query;let i=n.queries.get(s);i?!i.ba()&&e.Da()&&(r=2):(i=new YL,r=e.Da()?0:1);try{switch(r){case 0:i.wa=await n.onListen(s,!0);break;case 1:i.wa=await n.onListen(s,!1);break;case 2:await n.onFirstRemoteStoreListen(s)}}catch(o){const a=pv(o,`Initialization of query '${qo(e.query)}' failed`);return void e.onError(a)}n.queries.set(s,i),i.Sa.push(e),e.va(n.onlineState),i.wa&&e.Fa(i.wa)&&yv(n)}async function gv(t,e){const n=Ee(t),r=e.query;let s=3;const i=n.queries.get(r);if(i){const o=i.Sa.indexOf(e);o>=0&&(i.Sa.splice(o,1),i.Sa.length===0?s=e.Da()?0:1:!i.ba()&&e.Da()&&(s=2))}switch(s){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function JL(t,e){const n=Ee(t);let r=!1;for(const s of e){const i=s.query,o=n.queries.get(i);if(o){for(const a of o.Sa)a.Fa(s)&&(r=!0);o.wa=s}}r&&yv(n)}function ZL(t,e,n){const r=Ee(t),s=r.queries.get(e);if(s)for(const i of s.Sa)i.onError(n);r.queries.delete(e)}function yv(t){t.Ca.forEach(e=>{e.next()})}var gg,PI;(PI=gg||(gg={})).Ma="default",PI.Cache="cache";class vv{constructor(e,n,r){this.query=e,this.xa=n,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=r||{}}Fa(e){if(!this.options.includeMetadataChanges){const r=[];for(const s of e.docChanges)s.type!==3&&r.push(s);e=new $a(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),n=!0):this.La(e,this.onlineState)&&(this.ka(e),n=!0),this.Na=e,n}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let n=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),n=!0),n}La(e,n){if(!e.fromCache||!this.Da())return!0;const r=n!=="Offline";return(!this.options.qa||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const n=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}ka(e){e=$a.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==gg.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zC{constructor(e){this.key=e}}class qC{constructor(e){this.key=e}}class eM{constructor(e,n){this.query=e,this.Ya=n,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=ke(),this.mutatedKeys=ke(),this.eu=qb(e),this.tu=new ya(this.eu)}get nu(){return this.Ya}ru(e,n){const r=n?n.iu:new AI,s=n?n.tu:this.tu;let i=n?n.mutatedKeys:this.mutatedKeys,o=s,a=!1;const l=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,d=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((h,f)=>{const m=s.get(h),v=Zc(this.query,f)?f:null,R=!!m&&this.mutatedKeys.has(m.key),T=!!v&&(v.hasLocalMutations||this.mutatedKeys.has(v.key)&&v.hasCommittedMutations);let P=!1;m&&v?m.data.isEqual(v.data)?R!==T&&(r.track({type:3,doc:v}),P=!0):this.su(m,v)||(r.track({type:2,doc:v}),P=!0,(l&&this.eu(v,l)>0||d&&this.eu(v,d)<0)&&(a=!0)):!m&&v?(r.track({type:0,doc:v}),P=!0):m&&!v&&(r.track({type:1,doc:m}),P=!0,(l||d)&&(a=!0)),P&&(v?(o=o.add(v),i=T?i.add(h):i.delete(h)):(o=o.delete(h),i=i.delete(h)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const h=this.query.limitType==="F"?o.last():o.first();o=o.delete(h.key),i=i.delete(h.key),r.track({type:1,doc:h})}return{tu:o,iu:r,Cs:a,mutatedKeys:i}}su(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,s){const i=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const o=e.iu.ya();o.sort((h,f)=>function(v,R){const T=P=>{switch(P){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return le(20277,{Rt:P})}};return T(v)-T(R)}(h.type,f.type)||this.eu(h.doc,f.doc)),this.ou(r),s=s??!1;const a=n&&!s?this._u():[],l=this.Xa.size===0&&this.current&&!s?1:0,d=l!==this.Za;return this.Za=l,o.length!==0||d?{snapshot:new $a(this.query,e.tu,i,o,e.mutatedKeys,l===0,d,!1,!!r&&r.resumeToken.approximateByteSize()>0),au:a}:{au:a}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new AI,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(n=>this.Ya=this.Ya.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Ya=this.Ya.delete(n)),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=ke(),this.tu.forEach(r=>{this.uu(r.key)&&(this.Xa=this.Xa.add(r.key))});const n=[];return e.forEach(r=>{this.Xa.has(r)||n.push(new qC(r))}),this.Xa.forEach(r=>{e.has(r)||n.push(new zC(r))}),n}cu(e){this.Ya=e.Qs,this.Xa=ke();const n=this.ru(e.documents);return this.applyChanges(n,!0)}lu(){return $a.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const _v="SyncEngine";class tM{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class nM{constructor(e){this.key=e,this.hu=!1}}class rM{constructor(e,n,r,s,i,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.Pu={},this.Tu=new ws(a=>zb(a),lf),this.Iu=new Map,this.Eu=new Set,this.du=new ft(ee.comparator),this.Au=new Map,this.Ru=new sv,this.Vu={},this.mu=new Map,this.fu=po.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function sM(t,e,n=!0){const r=YC(t);let s;const i=r.Tu.get(e);return i?(r.sharedClientState.addLocalQueryTarget(i.targetId),s=i.view.lu()):s=await HC(r,e,n,!0),s}async function iM(t,e){const n=YC(t);await HC(n,e,!0,!1)}async function HC(t,e,n,r){const s=await SL(t.localStore,ir(e)),i=s.targetId,o=t.sharedClientState.addLocalQueryTarget(i,n);let a;return r&&(a=await oM(t,e,i,o==="current",s.resumeToken)),t.isPrimaryClient&&n&&LC(t.remoteStore,s),a}async function oM(t,e,n,r,s){t.pu=(f,m,v)=>async function(T,P,E,I){let S=P.view.ru(E);S.Cs&&(S=await II(T.localStore,P.query,!1).then(({documents:w})=>P.view.ru(w,S)));const b=I&&I.targetChanges.get(P.targetId),L=I&&I.targetMismatches.get(P.targetId)!=null,B=P.view.applyChanges(S,T.isPrimaryClient,b,L);return kI(T,P.targetId,B.au),B.snapshot}(t,f,m,v);const i=await II(t.localStore,e,!0),o=new eM(e,i.Qs),a=o.ru(i.documents),l=eu.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",s),d=o.applyChanges(a,t.isPrimaryClient,l);kI(t,n,d.au);const h=new tM(e,n,o);return t.Tu.set(e,h),t.Iu.has(n)?t.Iu.get(n).push(e):t.Iu.set(n,[e]),d.snapshot}async function aM(t,e,n){const r=Ee(t),s=r.Tu.get(e),i=r.Iu.get(s.targetId);if(i.length>1)return r.Iu.set(s.targetId,i.filter(o=>!lf(o,e))),void r.Tu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(s.targetId),r.sharedClientState.isActiveQueryTarget(s.targetId)||await pg(r.localStore,s.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(s.targetId),n&&cv(r.remoteStore,s.targetId),yg(r,s.targetId)}).catch(To)):(yg(r,s.targetId),await pg(r.localStore,s.targetId,!0))}async function lM(t,e){const n=Ee(t),r=n.Tu.get(e),s=n.Iu.get(r.targetId);n.isPrimaryClient&&s.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),cv(n.remoteStore,r.targetId))}async function cM(t,e,n){const r=XC(t);try{const s=await function(o,a){const l=Ee(o),d=Be.now(),h=a.reduce((v,R)=>v.add(R.key),ke());let f,m;return l.persistence.runTransaction("Locally write mutations","readwrite",v=>{let R=$n(),T=ke();return l.Ns.getEntries(v,h).next(P=>{R=P,R.forEach((E,I)=>{I.isValidDocument()||(T=T.add(E))})}).next(()=>l.localDocuments.getOverlayedDocuments(v,R)).next(P=>{f=P;const E=[];for(const I of a){const S=IV(I,f.get(I.key).overlayedDocument);S!=null&&E.push(new Es(I.key,S,jb(S.value.mapValue),an.exists(!0)))}return l.mutationQueue.addMutationBatch(v,d,E,a)}).next(P=>{m=P;const E=P.applyToLocalDocumentSet(f,T);return l.documentOverlayCache.saveOverlays(v,P.batchId,E)})}).then(()=>({batchId:m.batchId,changes:Wb(f)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(s.batchId),function(o,a,l){let d=o.Vu[o.currentUser.toKey()];d||(d=new ft(Ie)),d=d.insert(a,l),o.Vu[o.currentUser.toKey()]=d}(r,s.batchId,n),await ru(r,s.changes),await nu(r.remoteStore)}catch(s){const i=pv(s,"Failed to persist write");n.reject(i)}}async function WC(t,e){const n=Ee(t);try{const r=await IL(n.localStore,e);e.targetChanges.forEach((s,i)=>{const o=n.Au.get(i);o&&(he(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1,22616),s.addedDocuments.size>0?o.hu=!0:s.modifiedDocuments.size>0?he(o.hu,14607):s.removedDocuments.size>0&&(he(o.hu,42227),o.hu=!1))}),await ru(n,r,e)}catch(r){await To(r)}}function NI(t,e,n){const r=Ee(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const s=[];r.Tu.forEach((i,o)=>{const a=o.view.va(e);a.snapshot&&s.push(a.snapshot)}),function(o,a){const l=Ee(o);l.onlineState=a;let d=!1;l.queries.forEach((h,f)=>{for(const m of f.Sa)m.va(a)&&(d=!0)}),d&&yv(l)}(r.eventManager,e),s.length&&r.Pu.H_(s),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function uM(t,e,n){const r=Ee(t);r.sharedClientState.updateQueryState(e,"rejected",n);const s=r.Au.get(e),i=s&&s.key;if(i){let o=new ft(ee.comparator);o=o.insert(i,wt.newNoDocument(i,fe.min()));const a=ke().add(i),l=new ff(fe.min(),new Map,new ft(Ie),o,a);await WC(r,l),r.du=r.du.remove(i),r.Au.delete(e),wv(r)}else await pg(r.localStore,e,!1).then(()=>yg(r,e,n)).catch(To)}async function dM(t,e){const n=Ee(t),r=e.batch.batchId;try{const s=await EL(n.localStore,e);KC(n,r,null),GC(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await ru(n,s)}catch(s){await To(s)}}async function hM(t,e,n){const r=Ee(t);try{const s=await function(o,a){const l=Ee(o);return l.persistence.runTransaction("Reject batch","readwrite-primary",d=>{let h;return l.mutationQueue.lookupMutationBatch(d,a).next(f=>(he(f!==null,37113),h=f.keys(),l.mutationQueue.removeMutationBatch(d,f))).next(()=>l.mutationQueue.performConsistencyCheck(d)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(d,h,a)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(d,h)).next(()=>l.localDocuments.getDocuments(d,h))})}(r.localStore,e);KC(r,e,n),GC(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await ru(r,s)}catch(s){await To(s)}}function GC(t,e){(t.mu.get(e)||[]).forEach(n=>{n.resolve()}),t.mu.delete(e)}function KC(t,e,n){const r=Ee(t);let s=r.Vu[r.currentUser.toKey()];if(s){const i=s.get(e);i&&(n?i.reject(n):i.resolve(),s=s.remove(e)),r.Vu[r.currentUser.toKey()]=s}}function yg(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Iu.get(e))t.Tu.delete(r),n&&t.Pu.yu(r,n);t.Iu.delete(e),t.isPrimaryClient&&t.Ru.jr(e).forEach(r=>{t.Ru.containsKey(r)||QC(t,r)})}function QC(t,e){t.Eu.delete(e.path.canonicalString());const n=t.du.get(e);n!==null&&(cv(t.remoteStore,n),t.du=t.du.remove(e),t.Au.delete(n),wv(t))}function kI(t,e,n){for(const r of n)r instanceof zC?(t.Ru.addReference(r.key,e),fM(t,r)):r instanceof qC?(W(_v,"Document no longer in limbo: "+r.key),t.Ru.removeReference(r.key,e),t.Ru.containsKey(r.key)||QC(t,r.key)):le(19791,{wu:r})}function fM(t,e){const n=e.key,r=n.path.canonicalString();t.du.get(n)||t.Eu.has(r)||(W(_v,"New document in limbo: "+n),t.Eu.add(r),wv(t))}function wv(t){for(;t.Eu.size>0&&t.du.size<t.maxConcurrentLimboResolutions;){const e=t.Eu.values().next().value;t.Eu.delete(e);const n=new ee(We.fromString(e)),r=t.fu.next();t.Au.set(r,new nM(n)),t.du=t.du.insert(n,r),LC(t.remoteStore,new os(ir(Jc(n.path)),r,"TargetPurposeLimboResolution",rr.ce))}}async function ru(t,e,n){const r=Ee(t),s=[],i=[],o=[];r.Tu.isEmpty()||(r.Tu.forEach((a,l)=>{o.push(r.pu(l,e,n).then(d=>{var h;if((d||n)&&r.isPrimaryClient){const f=d?!d.fromCache:(h=n==null?void 0:n.targetChanges.get(l.targetId))==null?void 0:h.current;r.sharedClientState.updateQueryState(l.targetId,f?"current":"not-current")}if(d){s.push(d);const f=av.As(l.targetId,d);i.push(f)}}))}),await Promise.all(o),r.Pu.H_(s),await async function(l,d){const h=Ee(l);try{await h.persistence.runTransaction("notifyLocalViewChanges","readwrite",f=>O.forEach(d,m=>O.forEach(m.Es,v=>h.persistence.referenceDelegate.addReference(f,m.targetId,v)).next(()=>O.forEach(m.ds,v=>h.persistence.referenceDelegate.removeReference(f,m.targetId,v)))))}catch(f){if(!Ei(f))throw f;W(lv,"Failed to update sequence numbers: "+f)}for(const f of d){const m=f.targetId;if(!f.fromCache){const v=h.Ms.get(m),R=v.snapshotVersion,T=v.withLastLimboFreeSnapshotVersion(R);h.Ms=h.Ms.insert(m,T)}}}(r.localStore,i))}async function pM(t,e){const n=Ee(t);if(!n.currentUser.isEqual(e)){W(_v,"User change. New user:",e.toKey());const r=await kC(n.localStore,e);n.currentUser=e,function(i,o){i.mu.forEach(a=>{a.forEach(l=>{l.reject(new Q($.CANCELLED,o))})}),i.mu.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await ru(n,r.Ls)}}function mM(t,e){const n=Ee(t),r=n.Au.get(e);if(r&&r.hu)return ke().add(r.key);{let s=ke();const i=n.Iu.get(e);if(!i)return s;for(const o of i){const a=n.Tu.get(o);s=s.unionWith(a.view.nu)}return s}}function YC(t){const e=Ee(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=WC.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=mM.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=uM.bind(null,e),e.Pu.H_=JL.bind(null,e.eventManager),e.Pu.yu=ZL.bind(null,e.eventManager),e}function XC(t){const e=Ee(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=dM.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=hM.bind(null,e),e}class Lc{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=yf(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,n){return null}Mu(e,n){return null}vu(e){return NC(this.persistence,new PC,e.initialUser,this.serializer)}Cu(e){return new iv(gf.mi,this.serializer)}Du(e){return new jC}async terminate(){var e,n;(e=this.gcScheduler)==null||e.stop(),(n=this.indexBackfillerScheduler)==null||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Lc.provider={build:()=>new Lc};class gM extends Lc{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,n){he(this.persistence.referenceDelegate instanceof yh,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new SC(r,e.asyncQueue,n)}Cu(e){const n=this.cacheSizeBytes!==void 0?rn.withCacheSize(this.cacheSizeBytes):rn.DEFAULT;return new iv(r=>yh.mi(r,n),this.serializer)}}class yM extends Lc{constructor(e,n,r){super(),this.xu=e,this.cacheSizeBytes=n,this.forceOwnership=r,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.xu.initialize(this,e),await XC(this.xu.syncEngine),await nu(this.xu.remoteStore),await this.persistence.Ji(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}vu(e){return NC(this.persistence,new PC,e.initialUser,this.serializer)}Fu(e,n){const r=this.persistence.referenceDelegate.garbageCollector;return new SC(r,e.asyncQueue,n)}Mu(e,n){const r=new EO(n,this.persistence);return new wO(e.asyncQueue,r)}Cu(e){const n=yL(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?rn.withCacheSize(this.cacheSizeBytes):rn.DEFAULT;return new ov(this.synchronizeTabs,n,e.clientId,r,e.asyncQueue,kL(),Id(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Du(e){return new jC}}class _h{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>NI(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=pM.bind(null,this.syncEngine),await QL(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new XL}()}createDatastore(e){const n=yf(e.databaseInfo.databaseId),r=function(i){return new NL(i)}(e.databaseInfo);return function(i,o,a,l){return new VL(i,o,a,l)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,s,i,o,a){return new ML(r,s,i,o,a)}(this.localStore,this.datastore,e.asyncQueue,n=>NI(this.syncEngine,n,0),function(){return SI.v()?new SI:new CL}())}createSyncEngine(e,n){return function(s,i,o,a,l,d,h){const f=new rM(s,i,o,a,l,d);return h&&(f.gu=!0),f}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(s){const i=Ee(s);W(mo,"RemoteStore shutting down."),i.Ea.add(5),await tu(i),i.Aa.shutdown(),i.Ra.set("Unknown")}(this.remoteStore),(e=this.datastore)==null||e.terminate(),(n=this.eventManager)==null||n.terminate()}}_h.provider={build:()=>new _h};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ev{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):mn("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pi="FirestoreClient";class vM{constructor(e,n,r,s,i){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=s,this.user=Kt.UNAUTHENTICATED,this.clientId=My.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(r,async o=>{W(pi,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>(W(pi,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Er;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=pv(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function Pp(t,e){t.asyncQueue.verifyOperationInProgress(),W(pi,"Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async s=>{r.isEqual(s)||(await kC(e.localStore,s),r=s)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function DI(t,e){t.asyncQueue.verifyOperationInProgress();const n=await _M(t);W(pi,"Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>CI(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,s)=>CI(e.remoteStore,s)),t._onlineComponents=e}async function _M(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){W(pi,"Using user provided OfflineComponentProvider");try{await Pp(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(s){return s.name==="FirebaseError"?s.code===$.FAILED_PRECONDITION||s.code===$.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(n))throw n;oo("Error using user provided cache. Falling back to memory cache: "+n),await Pp(t,new Lc)}}else W(pi,"Using default OfflineComponentProvider"),await Pp(t,new gM(void 0));return t._offlineComponents}async function Iv(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(W(pi,"Using user provided OnlineComponentProvider"),await DI(t,t._uninitializedComponentsProvider._online)):(W(pi,"Using default OnlineComponentProvider"),await DI(t,new _h))),t._onlineComponents}function wM(t){return Iv(t).then(e=>e.syncEngine)}function EM(t){return Iv(t).then(e=>e.datastore)}async function wh(t){const e=await Iv(t),n=e.eventManager;return n.onListen=sM.bind(null,e.syncEngine),n.onUnlisten=aM.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=iM.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=lM.bind(null,e.syncEngine),n}function IM(t,e,n={}){const r=new Er;return t.asyncQueue.enqueueAndForget(async()=>function(i,o,a,l,d){const h=new Ev({next:m=>{h.Nu(),o.enqueueAndForget(()=>gv(i,f));const v=m.docs.has(a);!v&&m.fromCache?d.reject(new Q($.UNAVAILABLE,"Failed to get document because the client is offline.")):v&&m.fromCache&&l&&l.source==="server"?d.reject(new Q($.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):d.resolve(m)},error:m=>d.reject(m)}),f=new vv(Jc(a.path),h,{includeMetadataChanges:!0,qa:!0});return mv(i,f)}(await wh(t),t.asyncQueue,e,n,r)),r.promise}function xM(t,e,n={}){const r=new Er;return t.asyncQueue.enqueueAndForget(async()=>function(i,o,a,l,d){const h=new Ev({next:m=>{h.Nu(),o.enqueueAndForget(()=>gv(i,f)),m.fromCache&&l.source==="server"?d.reject(new Q($.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):d.resolve(m)},error:m=>d.reject(m)}),f=new vv(a,h,{includeMetadataChanges:!0,qa:!0});return mv(i,f)}(await wh(t),t.asyncQueue,e,n,r)),r.promise}function TM(t,e,n){const r=new Er;return t.asyncQueue.enqueueAndForget(async()=>{try{const s=await EM(t);r.resolve(async function(o,a,l){var T;const d=Ee(o),{request:h,gt:f,parent:m}=LV(d.serializer,cV(a),l);d.connection.$o||delete h.parent;const v=(await d.Ho("RunAggregationQuery",d.serializer.databaseId,m,h,1)).filter(P=>!!P.result);he(v.length===1,64727);const R=(T=v[0].result)==null?void 0:T.aggregateFields;return Object.keys(R).reduce((P,E)=>(P[f[E]]=R[E],P),{})}(s,e,n))}catch(s){r.reject(s)}}),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function JC(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jI=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZC="firestore.googleapis.com",OI=!0;class VI{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new Q($.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=ZC,this.ssl=OI}else this.host=e.host,this.ssl=e.ssl??OI;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=EC;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<eL)throw new Q($.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}mO("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=JC(e.experimentalLongPollingOptions??{}),function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new Q($.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new Q($.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new Q($.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,s){return r.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class _f{constructor(e,n,r,s){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new VI({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Q($.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Q($.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new VI(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new iO;switch(r.type){case"firstParty":return new cO(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new Q($.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=jI.get(n);r&&(W("ComponentProvider","Removing Datastore"),jI.delete(n),r.terminate())}(this),Promise.resolve()}}function SM(t,e,n,r={}){var d;t=ln(t,_f);const s=vi(e),i=t._getSettings(),o={...i,emulatorOptions:t._getEmulatorOptions()},a=`${e}:${n}`;s&&(xy(`https://${a}`),Ty("Firestore",!0)),i.host!==ZC&&i.host!==a&&oo("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const l={...i,host:a,ssl:s,emulatorOptions:r};if(!ps(l,o)&&(t._setSettings(l),r.mockUserToken)){let h,f;if(typeof r.mockUserToken=="string")h=r.mockUserToken,f=Kt.MOCK_USER;else{h=lS(r.mockUserToken,(d=t._app)==null?void 0:d.options.projectId);const m=r.mockUserToken.sub||r.mockUserToken.user_id;if(!m)throw new Q($.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");f=new Kt(m)}t._authCredentials=new oO(new ab(h,f))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ar{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new Ar(this.firestore,e,this._query)}}class Et{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new ai(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Et(this.firestore,e,this._key)}toJSON(){return{type:Et._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,n,r){if(Qc(n,Et._jsonSchema))return new Et(e,r||null,new ee(We.fromString(n.referencePath)))}}Et._jsonSchemaVersion="firestore/documentReference/1.0",Et._jsonSchema={type:Nt("string",Et._jsonSchemaVersion),referencePath:Nt("string")};class ai extends Ar{constructor(e,n,r){super(e,n,Jc(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Et(this.firestore,null,new ee(e))}withConverter(e){return new ai(this.firestore,e,this._path)}}function $e(t,e,...n){if(t=Ye(t),cb("collection","path",e),t instanceof _f){const r=We.fromString(e,...n);return bE(r),new ai(t,null,r)}{if(!(t instanceof Et||t instanceof ai))throw new Q($.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(We.fromString(e,...n));return bE(r),new ai(t.firestore,null,r)}}function Yt(t,e,...n){if(t=Ye(t),arguments.length===1&&(e=My.newId()),cb("doc","path",e),t instanceof _f){const r=We.fromString(e,...n);return SE(r),new Et(t,null,new ee(r))}{if(!(t instanceof Et||t instanceof ai))throw new Q($.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(We.fromString(e,...n));return SE(r),new Et(t.firestore,t instanceof ai?t.converter:null,new ee(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LI="AsyncQueue";class MI{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new OC(this,"async_queue_retry"),this._c=()=>{const r=Id();r&&W(LI,"Visibility state changed to "+r.visibilityState),this.M_.w_()},this.ac=e;const n=Id();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const n=Id();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});const n=new Er;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Xu.push(e),this.lc()))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!Ei(e))throw e;W(LI,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){const n=this.ac.then(()=>(this.rc=!0,e().catch(r=>{throw this.nc=r,this.rc=!1,mn("INTERNAL UNHANDLED ERROR: ",FI(r)),r}).then(r=>(this.rc=!1,r))));return this.ac=n,n}enqueueAfterDelay(e,n,r){this.uc(),this.oc.indexOf(e)>-1&&(n=0);const s=fv.createAndSchedule(this,e,n,r,i=>this.hc(i));return this.tc.push(s),s}uc(){this.nc&&le(47125,{Pc:FI(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const n of this.tc)if(n.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.tc)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.Tc()})}dc(e){this.oc.push(e)}hc(e){const n=this.tc.indexOf(e);this.tc.splice(n,1)}}function FI(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function UI(t){return function(n,r){if(typeof n!="object"||n===null)return!1;const s=n;for(const i of r)if(i in s&&typeof s[i]=="function")return!0;return!1}(t,["next","error","complete"])}class Sr extends _f{constructor(e,n,r,s){super(e,n,r,s),this.type="firestore",this._queue=new MI,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new MI(e),this._firestoreClient=void 0,await e}}}function eA(t,e){const n=typeof t=="object"?t:Gh(),r=typeof t=="string"?t:lh,s=_i(n,"firestore").getImmediate({identifier:r});if(!s._initialized){const i=iS("firestore");i&&SM(s,...i)}return s}function su(t){if(t._terminated)throw new Q($.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||tA(t),t._firestoreClient}function tA(t){var r,s,i;const e=t._freezeSettings(),n=function(a,l,d,h){return new XO(a,l,d,h.host,h.ssl,h.experimentalForceLongPolling,h.experimentalAutoDetectLongPolling,JC(h.experimentalLongPollingOptions),h.useFetchStreams,h.isUsingEmulator)}(t._databaseId,((r=t._app)==null?void 0:r.options.appId)||"",t._persistenceKey,e);t._componentsProvider||(s=e.localCache)!=null&&s._offlineComponentProvider&&((i=e.localCache)!=null&&i._onlineComponentProvider)&&(t._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),t._firestoreClient=new vM(t._authCredentials,t._appCheckCredentials,t._queue,n,t._componentsProvider&&function(a){const l=a==null?void 0:a._online.build();return{_offline:a==null?void 0:a._offline.build(l),_online:l}}(t._componentsProvider))}function bM(t,e){oo("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const n=t._freezeSettings();return CM(t,_h.provider,{build:r=>new yM(r,n.cacheSizeBytes,e==null?void 0:e.forceOwnership)}),Promise.resolve()}function CM(t,e,n){if((t=ln(t,Sr))._firestoreClient||t._terminated)throw new Q($.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(t._componentsProvider||t._getSettings().localCache)throw new Q($.FAILED_PRECONDITION,"SDK cache is already specified.");t._componentsProvider={_online:e,_offline:n},tA(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AM{constructor(e="count",n){this._internalFieldPath=n,this.type="AggregateField",this.aggregateType=e}}class RM{constructor(e,n,r){this._userDataWriter=n,this._data=r,this.type="AggregateQuerySnapshot",this.query=e}data(){return this._userDataWriter.convertObjectMap(this._data)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tr{constructor(e){this._byteString=e}static fromBase64String(e){try{return new tr(kt.fromBase64String(e))}catch(n){throw new Q($.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new tr(kt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:tr._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Qc(e,tr._jsonSchema))return tr.fromBase64String(e.bytes)}}tr._jsonSchemaVersion="firestore/bytes/1.0",tr._jsonSchema={type:Nt("string",tr._jsonSchemaVersion),bytes:Nt("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wf{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new Q($.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new mt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class el{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gr{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new Q($.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new Q($.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return Ie(this._lat,e._lat)||Ie(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Gr._jsonSchemaVersion}}static fromJSON(e){if(Qc(e,Gr._jsonSchema))return new Gr(e.latitude,e.longitude)}}Gr._jsonSchemaVersion="firestore/geoPoint/1.0",Gr._jsonSchema={type:Nt("string",Gr._jsonSchemaVersion),latitude:Nt("number"),longitude:Nt("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kr{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,s){if(r.length!==s.length)return!1;for(let i=0;i<r.length;++i)if(r[i]!==s[i])return!1;return!0}(this._values,e._values)}toJSON(){return{type:Kr._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Qc(e,Kr._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(n=>typeof n=="number"))return new Kr(e.vectorValues);throw new Q($.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Kr._jsonSchemaVersion="firestore/vectorValue/1.0",Kr._jsonSchema={type:Nt("string",Kr._jsonSchemaVersion),vectorValues:Nt("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PM=/^__.*__$/;class NM{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new Es(e,this.data,this.fieldMask,n,this.fieldTransforms):new Ja(e,this.data,n,this.fieldTransforms)}}class nA{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new Es(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function rA(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw le(40011,{Ac:t})}}class Ef{constructor(e,n,r,s,i,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=s,i===void 0&&this.Rc(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new Ef({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){var s;const n=(s=this.path)==null?void 0:s.child(e),r=this.Vc({path:n,fc:!1});return r.gc(e),r}yc(e){var s;const n=(s=this.path)==null?void 0:s.child(e),r=this.Vc({path:n,fc:!1});return r.Rc(),r}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return Eh(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(rA(this.Ac)&&PM.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class kM{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||yf(e)}Cc(e,n,r,s=!1){return new Ef({Ac:e,methodName:n,Dc:r,path:mt.emptyPath(),fc:!1,bc:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function iu(t){const e=t._freezeSettings(),n=yf(t._databaseId);return new kM(t._databaseId,!!e.ignoreUndefinedProperties,n)}function sA(t,e,n,r,s,i={}){const o=t.Cc(i.merge||i.mergeFields?2:0,e,n,s);bv("Data must be an object, but it was:",o,r);const a=oA(r,o);let l,d;if(i.merge)l=new Rn(o.fieldMask),d=o.fieldTransforms;else if(i.mergeFields){const h=[];for(const f of i.mergeFields){const m=vg(e,f,n);if(!o.contains(m))throw new Q($.INVALID_ARGUMENT,`Field '${m}' is specified in your field mask but missing from your input data.`);lA(h,m)||h.push(m)}l=new Rn(h),d=o.fieldTransforms.filter(f=>l.covers(f.field))}else l=null,d=o.fieldTransforms;return new NM(new on(a),l,d)}class If extends el{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof If}}function DM(t,e,n){return new Ef({Ac:3,Dc:e.settings.Dc,methodName:t._methodName,fc:n},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class xv extends el{_toFieldTransform(e){return new uf(e.path,new La)}isEqual(e){return e instanceof xv}}class Tv extends el{constructor(e,n){super(e),this.vc=n}_toFieldTransform(e){const n=DM(this,e,!0),r=this.vc.map(i=>tl(i,n)),s=new uo(r);return new uf(e.path,s)}isEqual(e){return e instanceof Tv&&ps(this.vc,e.vc)}}class Sv extends el{constructor(e,n){super(e),this.Fc=n}_toFieldTransform(e){const n=new Fa(e.serializer,Qb(e.serializer,this.Fc));return new uf(e.path,n)}isEqual(e){return e instanceof Sv&&this.Fc===e.Fc}}function jM(t,e,n,r){const s=t.Cc(1,e,n);bv("Data must be an object, but it was:",s,r);const i=[],o=on.empty();Ii(r,(l,d)=>{const h=Cv(e,l,n);d=Ye(d);const f=s.yc(h);if(d instanceof If)i.push(h);else{const m=tl(d,f);m!=null&&(i.push(h),o.set(h,m))}});const a=new Rn(i);return new nA(o,a,s.fieldTransforms)}function OM(t,e,n,r,s,i){const o=t.Cc(1,e,n),a=[vg(e,r,n)],l=[s];if(i.length%2!=0)throw new Q($.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let m=0;m<i.length;m+=2)a.push(vg(e,i[m])),l.push(i[m+1]);const d=[],h=on.empty();for(let m=a.length-1;m>=0;--m)if(!lA(d,a[m])){const v=a[m];let R=l[m];R=Ye(R);const T=o.yc(v);if(R instanceof If)d.push(v);else{const P=tl(R,T);P!=null&&(d.push(v),h.set(v,P))}}const f=new Rn(d);return new nA(h,f,o.fieldTransforms)}function iA(t,e,n,r=!1){return tl(n,t.Cc(r?4:3,e))}function tl(t,e){if(aA(t=Ye(t)))return bv("Unsupported field value:",e,t),oA(t,e);if(t instanceof el)return function(r,s){if(!rA(s.Ac))throw s.Sc(`${r._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Sc(`${r._methodName}() is not currently supported inside arrays`);const i=r._toFieldTransform(s);i&&s.fieldTransforms.push(i)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return function(r,s){const i=[];let o=0;for(const a of r){let l=tl(a,s.wc(o));l==null&&(l={nullValue:"NULL_VALUE"}),i.push(l),o++}return{arrayValue:{values:i}}}(t,e)}return function(r,s){if((r=Ye(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return Qb(s.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const i=Be.fromDate(r);return{timestampValue:Ua(s.serializer,i)}}if(r instanceof Be){const i=new Be(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Ua(s.serializer,i)}}if(r instanceof Gr)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof tr)return{bytesValue:oC(s.serializer,r._byteString)};if(r instanceof Et){const i=s.databaseId,o=r.firestore._databaseId;if(!o.isEqual(i))throw s.Sc(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:ev(r.firestore._databaseId||s.databaseId,r._key.path)}}if(r instanceof Kr)return function(o,a){return{mapValue:{fields:{[Hy]:{stringValue:Wy},[ja]:{arrayValue:{values:o.toArray().map(d=>{if(typeof d!="number")throw a.Sc("VectorValues must only contain numeric values.");return Qy(a.serializer,d)})}}}}}}(r,s);throw s.Sc(`Unsupported field value: ${Jh(r)}`)}(t,e)}function oA(t,e){const n={};return Sb(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Ii(t,(r,s)=>{const i=tl(s,e.mc(r));i!=null&&(n[r]=i)}),{mapValue:{fields:n}}}function aA(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof Be||t instanceof Gr||t instanceof tr||t instanceof Et||t instanceof el||t instanceof Kr)}function bv(t,e,n){if(!aA(n)||!ub(n)){const r=Jh(n);throw r==="an object"?e.Sc(t+" a custom object"):e.Sc(t+" "+r)}}function vg(t,e,n){if((e=Ye(e))instanceof wf)return e._internalPath;if(typeof e=="string")return Cv(t,e);throw Eh("Field path arguments must be of type string or ",t,!1,void 0,n)}const VM=new RegExp("[~\\*/\\[\\]]");function Cv(t,e,n){if(e.search(VM)>=0)throw Eh(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new wf(...e.split("."))._internalPath}catch{throw Eh(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function Eh(t,e,n,r,s){const i=r&&!r.isEmpty(),o=s!==void 0;let a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let l="";return(i||o)&&(l+=" (found",i&&(l+=` in field ${r}`),o&&(l+=` in document ${s}`),l+=")"),new Q($.INVALID_ARGUMENT,a+t+l)}function lA(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Av{constructor(e,n,r,s,i){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new Et(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new LM(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(xf("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class LM extends Av{data(){return super.data()}}function xf(t,e){return typeof e=="string"?Cv(t,e):e instanceof wf?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cA(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new Q($.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Rv{}class ou extends Rv{}function st(t,e,...n){let r=[];e instanceof Rv&&r.push(e),r=r.concat(n),function(i){const o=i.filter(l=>l instanceof Pv).length,a=i.filter(l=>l instanceof Tf).length;if(o>1||o>0&&a>0)throw new Q($.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const s of r)t=s._apply(t);return t}class Tf extends ou{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new Tf(e,n,r)}_apply(e){const n=this._parse(e);return dA(e._query,n),new Ar(e.firestore,e.converter,og(e._query,n))}_parse(e){const n=iu(e.firestore);return function(i,o,a,l,d,h,f){let m;if(d.isKeyField()){if(h==="array-contains"||h==="array-contains-any")throw new Q($.INVALID_ARGUMENT,`Invalid Query. You can't perform '${h}' queries on documentId().`);if(h==="in"||h==="not-in"){qI(f,h);const R=[];for(const T of f)R.push(zI(l,i,T));m={arrayValue:{values:R}}}else m=zI(l,i,f)}else h!=="in"&&h!=="not-in"&&h!=="array-contains-any"||qI(f,h),m=iA(a,o,f,h==="in"||h==="not-in");return Le.create(d,h,m)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function Je(t,e,n){const r=e,s=xf("where",t);return Tf._create(s,r,n)}class Pv extends Rv{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new Pv(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:Ze.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(s,i){let o=s;const a=i.getFlattenedFilters();for(const l of a)dA(o,l),o=og(o,l)}(e._query,n),new Ar(e.firestore,e.converter,og(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class Nv extends ou{constructor(e,n){super(),this._field=e,this._direction=n,this.type="orderBy"}static _create(e,n){return new Nv(e,n)}_apply(e){const n=function(s,i,o){if(s.startAt!==null)throw new Q($.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(s.endAt!==null)throw new Q($.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Vc(i,o)}(e._query,this._field,this._direction);return new Ar(e.firestore,e.converter,function(s,i){const o=s.explicitOrderBy.concat([i]);return new xi(s.path,s.collectionGroup,o,s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt)}(e._query,n))}}function gn(t,e="asc"){const n=e,r=xf("orderBy",t);return Nv._create(r,n)}class kv extends ou{constructor(e,n,r){super(),this.type=e,this._limit=n,this._limitType=r}static _create(e,n,r){return new kv(e,n,r)}_apply(e){return new Ar(e.firestore,e.converter,dh(e._query,this._limit,this._limitType))}}function va(t){return gO("limit",t),kv._create("limit",t,"F")}class Sf extends ou{constructor(e,n,r){super(),this.type=e,this._docOrFields=n,this._inclusive=r}static _create(e,n,r){return new Sf(e,n,r)}_apply(e){const n=uA(e,this.type,this._docOrFields,this._inclusive);return new Ar(e.firestore,e.converter,function(s,i){return new xi(s.path,s.collectionGroup,s.explicitOrderBy.slice(),s.filters.slice(),s.limit,s.limitType,i,s.endAt)}(e._query,n))}}function $I(...t){return Sf._create("startAt",t,!0)}function MM(...t){return Sf._create("startAfter",t,!1)}class Dv extends ou{constructor(e,n,r){super(),this.type=e,this._docOrFields=n,this._inclusive=r}static _create(e,n,r){return new Dv(e,n,r)}_apply(e){const n=uA(e,this.type,this._docOrFields,this._inclusive);return new Ar(e.firestore,e.converter,function(s,i){return new xi(s.path,s.collectionGroup,s.explicitOrderBy.slice(),s.filters.slice(),s.limit,s.limitType,s.startAt,i)}(e._query,n))}}function BI(...t){return Dv._create("endAt",t,!0)}function uA(t,e,n,r){if(n[0]=Ye(n[0]),n[0]instanceof Av)return function(i,o,a,l,d){if(!l)throw new Q($.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${a}().`);const h=[];for(const f of ga(i))if(f.field.isKeyField())h.push(lo(o,l.key));else{const m=l.data.field(f.field);if(sf(m))throw new Q($.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+f.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(m===null){const v=f.field.canonicalString();throw new Q($.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${v}' (used as the orderBy) does not exist.`)}h.push(m)}return new hi(h,d)}(t._query,t.firestore._databaseId,e,n[0]._document,r);{const s=iu(t.firestore);return function(o,a,l,d,h,f){const m=o.explicitOrderBy;if(h.length>m.length)throw new Q($.INVALID_ARGUMENT,`Too many arguments provided to ${d}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const v=[];for(let R=0;R<h.length;R++){const T=h[R];if(m[R].field.isKeyField()){if(typeof T!="string")throw new Q($.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${d}(), but got a ${typeof T}`);if(!Ky(o)&&T.indexOf("/")!==-1)throw new Q($.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${d}() must be a plain document ID, but '${T}' contains a slash.`);const P=o.path.child(We.fromString(T));if(!ee.isDocumentKey(P))throw new Q($.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${d}() must result in a valid document path, but '${P}' is not because it contains an odd number of segments.`);const E=new ee(P);v.push(lo(a,E))}else{const P=iA(l,d,T);v.push(P)}}return new hi(v,f)}(t._query,t.firestore._databaseId,s,e,n,r)}}function zI(t,e,n){if(typeof(n=Ye(n))=="string"){if(n==="")throw new Q($.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Ky(e)&&n.indexOf("/")!==-1)throw new Q($.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(We.fromString(n));if(!ee.isDocumentKey(r))throw new Q($.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return lo(t,new ee(r))}if(n instanceof Et)return lo(t,n._key);throw new Q($.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Jh(n)}.`)}function qI(t,e){if(!Array.isArray(t)||t.length===0)throw new Q($.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function dA(t,e){const n=function(s,i){for(const o of s)for(const a of o.getFlattenedFilters())if(i.indexOf(a.op)>=0)return a.op;return null}(t.filters,function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new Q($.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new Q($.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class FM{convertValue(e,n="none"){switch(ui(e)){case 0:return null;case 1:return e.booleanValue;case 2:return ut(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(vs(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw le(62114,{value:e})}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return Ii(e,(s,i)=>{r[s]=this.convertValue(i,n)}),r}convertVectorValue(e){var r,s,i;const n=(i=(s=(r=e.fields)==null?void 0:r[ja].arrayValue)==null?void 0:s.values)==null?void 0:i.map(o=>ut(o.doubleValue));return new Kr(n)}convertGeoPoint(e){return new Gr(ut(e.latitude),ut(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=of(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(Dc(e));default:return null}}convertTimestamp(e){const n=ys(e);return new Be(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=We.fromString(e);he(mC(r),9688,{name:e});const s=new ao(r.get(1),r.get(3)),i=new ee(r.popFirst(5));return s.isEqual(n)||mn(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hA(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}function UM(){return new AM("count")}class Ml{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Yi extends Av{constructor(e,n,r,s,i,o){super(e,n,r,s,o),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new xd(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(xf("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Q($.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,n={};return n.type=Yi._jsonSchemaVersion,n.bundle="",n.bundleSource="DocumentSnapshot",n.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?n:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),n.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),n)}}Yi._jsonSchemaVersion="firestore/documentSnapshot/1.0",Yi._jsonSchema={type:Nt("string",Yi._jsonSchemaVersion),bundleSource:Nt("string","DocumentSnapshot"),bundleName:Nt("string"),bundle:Nt("string")};class xd extends Yi{data(e={}){return super.data(e)}}class Xi{constructor(e,n,r,s){this._firestore=e,this._userDataWriter=n,this._snapshot=s,this.metadata=new Ml(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new xd(this._firestore,this._userDataWriter,r.key,r,new Ml(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new Q($.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(s,i){if(s._snapshot.oldDocs.isEmpty()){let o=0;return s._snapshot.docChanges.map(a=>{const l=new xd(s._firestore,s._userDataWriter,a.doc.key,a.doc,new Ml(s._snapshot.mutatedKeys.has(a.doc.key),s._snapshot.fromCache),s.query.converter);return a.doc,{type:"added",doc:l,oldIndex:-1,newIndex:o++}})}{let o=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(a=>i||a.type!==3).map(a=>{const l=new xd(s._firestore,s._userDataWriter,a.doc.key,a.doc,new Ml(s._snapshot.mutatedKeys.has(a.doc.key),s._snapshot.fromCache),s.query.converter);let d=-1,h=-1;return a.type!==0&&(d=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),h=o.indexOf(a.doc.key)),{type:$M(a.type),doc:l,oldIndex:d,newIndex:h}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Q($.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Xi._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=My.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const n=[],r=[],s=[];return this.docs.forEach(i=>{i._document!==null&&(n.push(i._document),r.push(this._userDataWriter.convertObjectMap(i._document.data.value.mapValue.fields,"previous")),s.push(i.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function $M(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return le(61501,{type:t})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ih(t){t=ln(t,Et);const e=ln(t.firestore,Sr);return IM(su(e),t._key).then(n=>pA(e,t,n))}Xi._jsonSchemaVersion="firestore/querySnapshot/1.0",Xi._jsonSchema={type:Nt("string",Xi._jsonSchemaVersion),bundleSource:Nt("string","QuerySnapshot"),bundleName:Nt("string"),bundle:Nt("string")};class bf extends FM{constructor(e){super(),this.firestore=e}convertBytes(e){return new tr(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new Et(this.firestore,null,n)}}function pn(t){t=ln(t,Ar);const e=ln(t.firestore,Sr),n=su(e),r=new bf(e);return cA(t._query),xM(n,t._query).then(s=>new Xi(e,r,t,s))}function xh(t,e,n){t=ln(t,Et);const r=ln(t.firestore,Sr),s=hA(t.converter,e,n);return Cf(r,[sA(iu(r),"setDoc",t._key,s,t.converter!==null,n).toMutation(t._key,an.none())])}function _a(t,e,n,...r){t=ln(t,Et);const s=ln(t.firestore,Sr),i=iu(s);let o;return o=typeof(e=Ye(e))=="string"||e instanceof wf?OM(i,"updateDoc",t._key,e,n,r):jM(i,"updateDoc",t._key,e),Cf(s,[o.toMutation(t._key,an.exists(!0))])}function fA(t){return Cf(ln(t.firestore,Sr),[new hf(t._key,an.none())])}function oa(t,e){const n=ln(t.firestore,Sr),r=Yt(t),s=hA(t.converter,e);return Cf(n,[sA(iu(t.firestore),"addDoc",r._key,s,t.converter!==null,{}).toMutation(r._key,an.exists(!1))]).then(()=>r)}function Fn(t,...e){var l,d,h;t=Ye(t);let n={includeMetadataChanges:!1,source:"default"},r=0;typeof e[r]!="object"||UI(e[r])||(n=e[r++]);const s={includeMetadataChanges:n.includeMetadataChanges,source:n.source};if(UI(e[r])){const f=e[r];e[r]=(l=f.next)==null?void 0:l.bind(f),e[r+1]=(d=f.error)==null?void 0:d.bind(f),e[r+2]=(h=f.complete)==null?void 0:h.bind(f)}let i,o,a;if(t instanceof Et)o=ln(t.firestore,Sr),a=Jc(t._key.path),i={next:f=>{e[r]&&e[r](pA(o,t,f))},error:e[r+1],complete:e[r+2]};else{const f=ln(t,Ar);o=ln(f.firestore,Sr),a=f._query;const m=new bf(o);i={next:v=>{e[r]&&e[r](new Xi(o,m,f,v))},error:e[r+1],complete:e[r+2]},cA(t._query)}return function(m,v,R,T){const P=new Ev(T),E=new vv(v,P,R);return m.asyncQueue.enqueueAndForget(async()=>mv(await wh(m),E)),()=>{P.Nu(),m.asyncQueue.enqueueAndForget(async()=>gv(await wh(m),E))}}(su(o),a,s,i)}function Cf(t,e){return function(r,s){const i=new Er;return r.asyncQueue.enqueueAndForget(async()=>cM(await wM(r),s,i)),i.promise}(su(t),e)}function pA(t,e,n){const r=n.docs.get(e._key),s=new bf(t);return new Yi(t,s,e._key,r,new Ml(n.hasPendingWrites,n.fromCache),e.converter)}function BM(t){return zM(t,{count:UM()})}function zM(t,e){const n=ln(t.firestore,Sr),r=su(n),s=QO(e,(i,o)=>new xV(o,i.aggregateType,i._internalFieldPath));return TM(r,t._query,s).then(i=>function(a,l,d){const h=new bf(a);return new RM(l,h,d)}(n,t,i))}function Xn(){return new xv("serverTimestamp")}function qM(...t){return new Tv("arrayUnion",t)}function HI(t){return new Sv("increment",t)}(function(e,n=!0){(function(s){Xa=s})(Io),xr(new cr("firestore",(r,{instanceIdentifier:s,options:i})=>{const o=r.getProvider("app").getImmediate(),a=new Sr(new aO(r.getProvider("auth-internal")),new uO(o,r.getProvider("app-check-internal")),function(d,h){if(!Object.prototype.hasOwnProperty.apply(d.options,["projectId"]))throw new Q($.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new ao(d.options.projectId,h)}(o,s),o);return i={useFetchStreams:n,...i},a._setSettings(i),a},"PUBLIC").setMultipleInstances(!0)),Dn(EE,IE,e),Dn(EE,IE,"esm2020")})();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mA="firebasestorage.googleapis.com",gA="storageBucket",HM=2*60*1e3,WM=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xt extends ur{constructor(e,n,r=0){super(Np(e),`Firebase Storage: ${n} (${Np(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,xt.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return Np(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var It;(function(t){t.UNKNOWN="unknown",t.OBJECT_NOT_FOUND="object-not-found",t.BUCKET_NOT_FOUND="bucket-not-found",t.PROJECT_NOT_FOUND="project-not-found",t.QUOTA_EXCEEDED="quota-exceeded",t.UNAUTHENTICATED="unauthenticated",t.UNAUTHORIZED="unauthorized",t.UNAUTHORIZED_APP="unauthorized-app",t.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",t.INVALID_CHECKSUM="invalid-checksum",t.CANCELED="canceled",t.INVALID_EVENT_NAME="invalid-event-name",t.INVALID_URL="invalid-url",t.INVALID_DEFAULT_BUCKET="invalid-default-bucket",t.NO_DEFAULT_BUCKET="no-default-bucket",t.CANNOT_SLICE_BLOB="cannot-slice-blob",t.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",t.NO_DOWNLOAD_URL="no-download-url",t.INVALID_ARGUMENT="invalid-argument",t.INVALID_ARGUMENT_COUNT="invalid-argument-count",t.APP_DELETED="app-deleted",t.INVALID_ROOT_OPERATION="invalid-root-operation",t.INVALID_FORMAT="invalid-format",t.INTERNAL_ERROR="internal-error",t.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(It||(It={}));function Np(t){return"storage/"+t}function jv(){const t="An unknown error occurred, please check the error payload for server response.";return new xt(It.UNKNOWN,t)}function GM(t){return new xt(It.OBJECT_NOT_FOUND,"Object '"+t+"' does not exist.")}function KM(t){return new xt(It.QUOTA_EXCEEDED,"Quota for bucket '"+t+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function QM(){const t="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new xt(It.UNAUTHENTICATED,t)}function YM(){return new xt(It.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function XM(t){return new xt(It.UNAUTHORIZED,"User does not have permission to access '"+t+"'.")}function JM(){return new xt(It.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function ZM(){return new xt(It.CANCELED,"User canceled the upload/download.")}function eF(t){return new xt(It.INVALID_URL,"Invalid URL '"+t+"'.")}function tF(t){return new xt(It.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}function nF(){return new xt(It.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+gA+"' property when initializing the app?")}function rF(){return new xt(It.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function sF(){return new xt(It.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function iF(t){return new xt(It.UNSUPPORTED_ENVIRONMENT,`${t} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function _g(t){return new xt(It.INVALID_ARGUMENT,t)}function yA(){return new xt(It.APP_DELETED,"The Firebase app was deleted.")}function oF(t){return new xt(It.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function ic(t,e){return new xt(It.INVALID_FORMAT,"String does not match format '"+t+"': "+e)}function bl(t){throw new xt(It.INTERNAL_ERROR,"Internal error: "+t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yn{constructor(e,n){this.bucket=e,this.path_=n}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,n){let r;try{r=yn.makeFromUrl(e,n)}catch{return new yn(e,"")}if(r.path==="")return r;throw tF(e)}static makeFromUrl(e,n){let r=null;const s="([A-Za-z0-9.\\-_]+)";function i(b){b.path.charAt(b.path.length-1)==="/"&&(b.path_=b.path_.slice(0,-1))}const o="(/(.*))?$",a=new RegExp("^gs://"+s+o,"i"),l={bucket:1,path:3};function d(b){b.path_=decodeURIComponent(b.path)}const h="v[A-Za-z0-9_]+",f=n.replace(/[.]/g,"\\."),m="(/([^?#]*).*)?$",v=new RegExp(`^https?://${f}/${h}/b/${s}/o${m}`,"i"),R={bucket:1,path:3},T=n===mA?"(?:storage.googleapis.com|storage.cloud.google.com)":n,P="([^?#]*)",E=new RegExp(`^https?://${T}/${s}/${P}`,"i"),S=[{regex:a,indices:l,postModify:i},{regex:v,indices:R,postModify:d},{regex:E,indices:{bucket:1,path:2},postModify:d}];for(let b=0;b<S.length;b++){const L=S[b],B=L.regex.exec(e);if(B){const w=B[L.indices.bucket];let _=B[L.indices.path];_||(_=""),r=new yn(w,_),L.postModify(r);break}}if(r==null)throw eF(e);return r}}class aF{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lF(t,e,n){let r=1,s=null,i=null,o=!1,a=0;function l(){return a===2}let d=!1;function h(...P){d||(d=!0,e.apply(null,P))}function f(P){s=setTimeout(()=>{s=null,t(v,l())},P)}function m(){i&&clearTimeout(i)}function v(P,...E){if(d){m();return}if(P){m(),h.call(null,P,...E);return}if(l()||o){m(),h.call(null,P,...E);return}r<64&&(r*=2);let S;a===1?(a=2,S=0):S=(r+Math.random())*1e3,f(S)}let R=!1;function T(P){R||(R=!0,m(),!d&&(s!==null?(P||(a=2),clearTimeout(s),f(0)):P||(a=1)))}return f(0),i=setTimeout(()=>{o=!0,T(!0)},n),T}function cF(t){t(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uF(t){return t!==void 0}function dF(t){return typeof t=="object"&&!Array.isArray(t)}function Ov(t){return typeof t=="string"||t instanceof String}function WI(t){return Vv()&&t instanceof Blob}function Vv(){return typeof Blob<"u"}function wg(t,e,n,r){if(r<e)throw _g(`Invalid value for '${t}'. Expected ${e} or greater.`);if(r>n)throw _g(`Invalid value for '${t}'. Expected ${n} or less.`)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function au(t,e,n){let r=e;return n==null&&(r=`https://${e}`),`${n}://${r}/v0${t}`}function vA(t){const e=encodeURIComponent;let n="?";for(const r in t)if(t.hasOwnProperty(r)){const s=e(r)+"="+e(t[r]);n=n+s+"&"}return n=n.slice(0,-1),n}var Ji;(function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"})(Ji||(Ji={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hF(t,e){const n=t>=500&&t<600,s=[408,429].indexOf(t)!==-1,i=e.indexOf(t)!==-1;return n||s||i}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fF{constructor(e,n,r,s,i,o,a,l,d,h,f,m=!0,v=!1){this.url_=e,this.method_=n,this.headers_=r,this.body_=s,this.successCodes_=i,this.additionalRetryCodes_=o,this.callback_=a,this.errorCallback_=l,this.timeout_=d,this.progressCallback_=h,this.connectionFactory_=f,this.retry=m,this.isUsingEmulator=v,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((R,T)=>{this.resolve_=R,this.reject_=T,this.start_()})}start_(){const e=(r,s)=>{if(s){r(!1,new qu(!1,null,!0));return}const i=this.connectionFactory_();this.pendingConnection_=i;const o=a=>{const l=a.loaded,d=a.lengthComputable?a.total:-1;this.progressCallback_!==null&&this.progressCallback_(l,d)};this.progressCallback_!==null&&i.addUploadProgressListener(o),i.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&i.removeUploadProgressListener(o),this.pendingConnection_=null;const a=i.getErrorCode()===Ji.NO_ERROR,l=i.getStatus();if(!a||hF(l,this.additionalRetryCodes_)&&this.retry){const h=i.getErrorCode()===Ji.ABORT;r(!1,new qu(!1,null,h));return}const d=this.successCodes_.indexOf(l)!==-1;r(!0,new qu(d,i))})},n=(r,s)=>{const i=this.resolve_,o=this.reject_,a=s.connection;if(s.wasSuccessCode)try{const l=this.callback_(a,a.getResponse());uF(l)?i(l):i()}catch(l){o(l)}else if(a!==null){const l=jv();l.serverResponse=a.getErrorText(),this.errorCallback_?o(this.errorCallback_(a,l)):o(l)}else if(s.canceled){const l=this.appDelete_?yA():ZM();o(l)}else{const l=JM();o(l)}};this.canceled_?n(!1,new qu(!1,null,!0)):this.backoffId_=lF(e,n,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&cF(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class qu{constructor(e,n,r){this.wasSuccessCode=e,this.connection=n,this.canceled=!!r}}function pF(t,e){e!==null&&e.length>0&&(t.Authorization="Firebase "+e)}function mF(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function gF(t,e){e&&(t["X-Firebase-GMPID"]=e)}function yF(t,e){e!==null&&(t["X-Firebase-AppCheck"]=e)}function vF(t,e,n,r,s,i,o=!0,a=!1){const l=vA(t.urlParams),d=t.url+l,h=Object.assign({},t.headers);return gF(h,e),pF(h,n),mF(h,i),yF(h,r),new fF(d,t.method,h,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,s,o,a)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _F(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function wF(...t){const e=_F();if(e!==void 0){const n=new e;for(let r=0;r<t.length;r++)n.append(t[r]);return n.getBlob()}else{if(Vv())return new Blob(t);throw new xt(It.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function EF(t,e,n){return t.webkitSlice?t.webkitSlice(e,n):t.mozSlice?t.mozSlice(e,n):t.slice?t.slice(e,n):null}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function IF(t){if(typeof atob>"u")throw iF("base-64");return atob(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Br={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class kp{constructor(e,n){this.data=e,this.contentType=n||null}}function xF(t,e){switch(t){case Br.RAW:return new kp(_A(e));case Br.BASE64:case Br.BASE64URL:return new kp(wA(t,e));case Br.DATA_URL:return new kp(SF(e),bF(e))}throw jv()}function _A(t){const e=[];for(let n=0;n<t.length;n++){let r=t.charCodeAt(n);if(r<=127)e.push(r);else if(r<=2047)e.push(192|r>>6,128|r&63);else if((r&64512)===55296)if(!(n<t.length-1&&(t.charCodeAt(n+1)&64512)===56320))e.push(239,191,189);else{const i=r,o=t.charCodeAt(++n);r=65536|(i&1023)<<10|o&1023,e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|r&63)}else(r&64512)===56320?e.push(239,191,189):e.push(224|r>>12,128|r>>6&63,128|r&63)}return new Uint8Array(e)}function TF(t){let e;try{e=decodeURIComponent(t)}catch{throw ic(Br.DATA_URL,"Malformed data URL.")}return _A(e)}function wA(t,e){switch(t){case Br.BASE64:{const s=e.indexOf("-")!==-1,i=e.indexOf("_")!==-1;if(s||i)throw ic(t,"Invalid character '"+(s?"-":"_")+"' found: is it base64url encoded?");break}case Br.BASE64URL:{const s=e.indexOf("+")!==-1,i=e.indexOf("/")!==-1;if(s||i)throw ic(t,"Invalid character '"+(s?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let n;try{n=IF(e)}catch(s){throw s.message.includes("polyfill")?s:ic(t,"Invalid character found")}const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}class EA{constructor(e){this.base64=!1,this.contentType=null;const n=e.match(/^data:([^,]+)?,/);if(n===null)throw ic(Br.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const r=n[1]||null;r!=null&&(this.base64=CF(r,";base64"),this.contentType=this.base64?r.substring(0,r.length-7):r),this.rest=e.substring(e.indexOf(",")+1)}}function SF(t){const e=new EA(t);return e.base64?wA(Br.BASE64,e.rest):TF(e.rest)}function bF(t){return new EA(t).contentType}function CF(t,e){return t.length>=e.length?t.substring(t.length-e.length)===e:!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qs{constructor(e,n){let r=0,s="";WI(e)?(this.data_=e,r=e.size,s=e.type):e instanceof ArrayBuffer?(n?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),r=this.data_.length):e instanceof Uint8Array&&(n?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),r=e.length),this.size_=r,this.type_=s}size(){return this.size_}type(){return this.type_}slice(e,n){if(WI(this.data_)){const r=this.data_,s=EF(r,e,n);return s===null?null:new qs(s)}else{const r=new Uint8Array(this.data_.buffer,e,n-e);return new qs(r,!0)}}static getBlob(...e){if(Vv()){const n=e.map(r=>r instanceof qs?r.data_:r);return new qs(wF.apply(null,n))}else{const n=e.map(o=>Ov(o)?xF(Br.RAW,o).data:o.data_);let r=0;n.forEach(o=>{r+=o.byteLength});const s=new Uint8Array(r);let i=0;return n.forEach(o=>{for(let a=0;a<o.length;a++)s[i++]=o[a]}),new qs(s,!0)}}uploadData(){return this.data_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lv(t){let e;try{e=JSON.parse(t)}catch{return null}return dF(e)?e:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function AF(t){if(t.length===0)return null;const e=t.lastIndexOf("/");return e===-1?"":t.slice(0,e)}function RF(t,e){const n=e.split("/").filter(r=>r.length>0).join("/");return t.length===0?n:t+"/"+n}function IA(t){const e=t.lastIndexOf("/",t.length-2);return e===-1?t:t.slice(e+1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PF(t,e){return e}class hn{constructor(e,n,r,s){this.server=e,this.local=n||e,this.writable=!!r,this.xform=s||PF}}let Hu=null;function NF(t){return!Ov(t)||t.length<2?t:IA(t)}function xA(){if(Hu)return Hu;const t=[];t.push(new hn("bucket")),t.push(new hn("generation")),t.push(new hn("metageneration")),t.push(new hn("name","fullPath",!0));function e(i,o){return NF(o)}const n=new hn("name");n.xform=e,t.push(n);function r(i,o){return o!==void 0?Number(o):o}const s=new hn("size");return s.xform=r,t.push(s),t.push(new hn("timeCreated")),t.push(new hn("updated")),t.push(new hn("md5Hash",null,!0)),t.push(new hn("cacheControl",null,!0)),t.push(new hn("contentDisposition",null,!0)),t.push(new hn("contentEncoding",null,!0)),t.push(new hn("contentLanguage",null,!0)),t.push(new hn("contentType",null,!0)),t.push(new hn("metadata","customMetadata",!0)),Hu=t,Hu}function kF(t,e){function n(){const r=t.bucket,s=t.fullPath,i=new yn(r,s);return e._makeStorageReference(i)}Object.defineProperty(t,"ref",{get:n})}function DF(t,e,n){const r={};r.type="file";const s=n.length;for(let i=0;i<s;i++){const o=n[i];r[o.local]=o.xform(r,e[o.server])}return kF(r,t),r}function TA(t,e,n){const r=Lv(e);return r===null?null:DF(t,r,n)}function jF(t,e,n,r){const s=Lv(e);if(s===null||!Ov(s.downloadTokens))return null;const i=s.downloadTokens;if(i.length===0)return null;const o=encodeURIComponent;return i.split(",").map(d=>{const h=t.bucket,f=t.fullPath,m="/b/"+o(h)+"/o/"+o(f),v=au(m,n,r),R=vA({alt:"media",token:d});return v+R})[0]}function OF(t,e){const n={},r=e.length;for(let s=0;s<r;s++){const i=e[s];i.writable&&(n[i.server]=t[i.local])}return JSON.stringify(n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GI="prefixes",KI="items";function VF(t,e,n){const r={prefixes:[],items:[],nextPageToken:n.nextPageToken};if(n[GI])for(const s of n[GI]){const i=s.replace(/\/$/,""),o=t._makeStorageReference(new yn(e,i));r.prefixes.push(o)}if(n[KI])for(const s of n[KI]){const i=t._makeStorageReference(new yn(e,s.name));r.items.push(i)}return r}function LF(t,e,n){const r=Lv(n);return r===null?null:VF(t,e,r)}class Af{constructor(e,n,r,s){this.url=e,this.method=n,this.handler=r,this.timeout=s,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mv(t){if(!t)throw jv()}function MF(t,e){function n(r,s){const i=TA(t,s,e);return Mv(i!==null),i}return n}function FF(t,e){function n(r,s){const i=LF(t,e,s);return Mv(i!==null),i}return n}function UF(t,e){function n(r,s){const i=TA(t,s,e);return Mv(i!==null),jF(i,s,t.host,t._protocol)}return n}function Fv(t){function e(n,r){let s;return n.getStatus()===401?n.getErrorText().includes("Firebase App Check token is invalid")?s=YM():s=QM():n.getStatus()===402?s=KM(t.bucket):n.getStatus()===403?s=XM(t.path):s=r,s.status=n.getStatus(),s.serverResponse=r.serverResponse,s}return e}function SA(t){const e=Fv(t);function n(r,s){let i=e(r,s);return r.getStatus()===404&&(i=GM(t.path)),i.serverResponse=s.serverResponse,i}return n}function $F(t,e,n,r,s){const i={};e.isRoot?i.prefix="":i.prefix=e.path+"/",n.length>0&&(i.delimiter=n),r&&(i.pageToken=r),s&&(i.maxResults=s);const o=e.bucketOnlyServerUrl(),a=au(o,t.host,t._protocol),l="GET",d=t.maxOperationRetryTime,h=new Af(a,l,FF(t,e.bucket),d);return h.urlParams=i,h.errorHandler=Fv(e),h}function BF(t,e,n){const r=e.fullServerUrl(),s=au(r,t.host,t._protocol),i="GET",o=t.maxOperationRetryTime,a=new Af(s,i,UF(t,n),o);return a.errorHandler=SA(e),a}function zF(t,e){const n=e.fullServerUrl(),r=au(n,t.host,t._protocol),s="DELETE",i=t.maxOperationRetryTime;function o(l,d){}const a=new Af(r,s,o,i);return a.successCodes=[200,204],a.errorHandler=SA(e),a}function qF(t,e){return t&&t.contentType||e&&e.type()||"application/octet-stream"}function HF(t,e,n){const r=Object.assign({},n);return r.fullPath=t.path,r.size=e.size(),r.contentType||(r.contentType=qF(null,e)),r}function WF(t,e,n,r,s){const i=e.bucketOnlyServerUrl(),o={"X-Goog-Upload-Protocol":"multipart"};function a(){let S="";for(let b=0;b<2;b++)S=S+Math.random().toString().slice(2);return S}const l=a();o["Content-Type"]="multipart/related; boundary="+l;const d=HF(e,r,s),h=OF(d,n),f="--"+l+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+h+`\r
--`+l+`\r
Content-Type: `+d.contentType+`\r
\r
`,m=`\r
--`+l+"--",v=qs.getBlob(f,r,m);if(v===null)throw rF();const R={name:d.fullPath},T=au(i,t.host,t._protocol),P="POST",E=t.maxUploadRetryTime,I=new Af(T,P,MF(t,n),E);return I.urlParams=R,I.headers=o,I.body=v.uploadData(),I.errorHandler=Fv(e),I}class GF{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=Ji.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=Ji.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=Ji.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,n,r,s,i){if(this.sent_)throw bl("cannot .send() more than once");if(vi(e)&&r&&(this.xhr_.withCredentials=!0),this.sent_=!0,this.xhr_.open(n,e,!0),i!==void 0)for(const o in i)i.hasOwnProperty(o)&&this.xhr_.setRequestHeader(o,i[o].toString());return s!==void 0?this.xhr_.send(s):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw bl("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw bl("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw bl("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw bl("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class KF extends GF{initXhr(){this.xhr_.responseType="text"}}function Rf(){return new KF}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class go{constructor(e,n){this._service=e,n instanceof yn?this._location=n:this._location=yn.makeFromUrl(n,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,n){return new go(e,n)}get root(){const e=new yn(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return IA(this._location.path)}get storage(){return this._service}get parent(){const e=AF(this._location.path);if(e===null)return null;const n=new yn(this._location.bucket,e);return new go(this._service,n)}_throwIfRoot(e){if(this._location.path==="")throw oF(e)}}function QF(t,e,n){t._throwIfRoot("uploadBytes");const r=WF(t.storage,t._location,xA(),new qs(e,!0),n);return t.storage.makeRequestWithTokens(r,Rf).then(s=>({metadata:s,ref:t}))}function YF(t){const e={prefixes:[],items:[]};return bA(t,e).then(()=>e)}async function bA(t,e,n){const s=await XF(t,{pageToken:n});e.prefixes.push(...s.prefixes),e.items.push(...s.items),s.nextPageToken!=null&&await bA(t,e,s.nextPageToken)}function XF(t,e){e!=null&&typeof e.maxResults=="number"&&wg("options.maxResults",1,1e3,e.maxResults);const n=e||{},r=$F(t.storage,t._location,"/",n.pageToken,n.maxResults);return t.storage.makeRequestWithTokens(r,Rf)}function JF(t){t._throwIfRoot("getDownloadURL");const e=BF(t.storage,t._location,xA());return t.storage.makeRequestWithTokens(e,Rf).then(n=>{if(n===null)throw sF();return n})}function ZF(t){t._throwIfRoot("deleteObject");const e=zF(t.storage,t._location);return t.storage.makeRequestWithTokens(e,Rf)}function e4(t,e){const n=RF(t._location.path,e),r=new yn(t._location.bucket,n);return new go(t.storage,r)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function t4(t){return/^[A-Za-z]+:\/\//.test(t)}function n4(t,e){return new go(t,e)}function CA(t,e){if(t instanceof Uv){const n=t;if(n._bucket==null)throw nF();const r=new go(n,n._bucket);return e!=null?CA(r,e):r}else return e!==void 0?e4(t,e):t}function r4(t,e){if(e&&t4(e)){if(t instanceof Uv)return n4(t,e);throw _g("To use ref(service, url), the first argument must be a Storage instance.")}else return CA(t,e)}function QI(t,e){const n=e==null?void 0:e[gA];return n==null?null:yn.makeFromBucketSpec(n,t)}function s4(t,e,n,r={}){t.host=`${e}:${n}`;const s=vi(e);s&&(xy(`https://${t.host}/b`),Ty("Storage",!0)),t._isUsingEmulator=!0,t._protocol=s?"https":"http";const{mockUserToken:i}=r;i&&(t._overrideAuthToken=typeof i=="string"?i:lS(i,t.app.options.projectId))}class Uv{constructor(e,n,r,s,i,o=!1){this.app=e,this._authProvider=n,this._appCheckProvider=r,this._url=s,this._firebaseVersion=i,this._isUsingEmulator=o,this._bucket=null,this._host=mA,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=HM,this._maxUploadRetryTime=WM,this._requests=new Set,s!=null?this._bucket=yn.makeFromBucketSpec(s,this._host):this._bucket=QI(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=yn.makeFromBucketSpec(this._url,e):this._bucket=QI(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){wg("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){wg("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const n=await e.getToken();if(n!==null)return n.accessToken}return null}async _getAppCheckToken(){if(er(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new go(this,e)}_makeRequest(e,n,r,s,i=!0){if(this._deleted)return new aF(yA());{const o=vF(e,this._appId,r,s,n,this._firebaseVersion,i,this._isUsingEmulator);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}async makeRequestWithTokens(e,n){const[r,s]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,n,r,s).getPromise()}}const YI="@firebase/storage",XI="0.14.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AA="storage";function JI(t,e,n){return t=Ye(t),QF(t,e,n)}function ZI(t){return t=Ye(t),YF(t)}function ex(t){return t=Ye(t),JF(t)}function Dp(t){return t=Ye(t),ZF(t)}function Cl(t,e){return t=Ye(t),r4(t,e)}function Fi(t=Gh(),e){t=Ye(t);const r=_i(t,AA).getImmediate({identifier:e}),s=iS("storage");return s&&i4(r,...s),r}function i4(t,e,n,r={}){s4(t,e,n,r)}function o4(t,{instanceIdentifier:e}){const n=t.getProvider("app").getImmediate(),r=t.getProvider("auth-internal"),s=t.getProvider("app-check-internal");return new Uv(n,r,s,e,Io)}function a4(){xr(new cr(AA,o4,"PUBLIC").setMultipleInstances(!0)),Dn(YI,XI,""),Dn(YI,XI,"esm2020")}a4();const l4={apiKey:"AIzaSyC70mGCRrjE8iOap8iTHuid8HEuyadue8Y",authDomain:"odontocloud-d92ac.firebaseapp.com",projectId:"odontocloud-d92ac",storageBucket:"odontocloud-d92ac.firebasestorage.app",messagingSenderId:"267020714981",appId:"1:267020714981:web:a44416ea83aa1d1172650c",measurementId:"G-ZMCC5CFY0C"},$v=Cy(l4),tx=ZS($v),nx=eA($v);Fi($v);const c4="/odontocloud-react/assets/fondo.png",RA="/odontocloud-react/assets/logo.png",rx=(t,e)=>{const n={email:t,rol:e,timestamp:Date.now()};localStorage.setItem("odc_session",JSON.stringify(n))},jp=()=>{try{const t=JSON.parse(localStorage.getItem("odc_session"));return t&&Date.now()-t.timestamp<1e3*60*60*24?t:null}catch{return null}},u4=()=>{const t=Ka(),[e,n]=A.useState(""),[r,s]=A.useState(""),[i,o]=A.useState(""),[a,l]=A.useState(navigator.onLine);A.useEffect(()=>{const f=()=>l(!0),m=()=>l(!1);return window.addEventListener("online",f),window.addEventListener("offline",m),()=>{window.removeEventListener("online",f),window.removeEventListener("offline",m)}},[]);const d=f=>{const m=(f||"").toLowerCase();m==="administrador"?t("/dashboard_admin",{replace:!0}):m==="doctor"?t("/dashboard_doctor",{replace:!0}):m==="recepcionista"?t("/dashboard_recepcion",{replace:!0}):o("Rol no reconocido. Contacte al administrador.")};A.useEffect(()=>{if(!navigator.onLine){const m=jp();m!=null&&m.rol?d(m.rol):o("Sin conexin y no hay sesin guardada.");return}const f=jy(tx,async m=>{if(m){const v=jp();if(v!=null&&v.rol){d(v.rol);return}try{const R=st($e(nx,"users"),Je("correo","==",m.email||"")),T=await pn(R);if(!T.empty){const P=T.docs[0].data().rol||"sin_rol";rx(m.email||"",P),d(P)}}catch{d("administrador")}}});return()=>f()},[]);const h=async f=>{if(f.preventDefault(),o(""),!a){const m=jp();m!=null&&m.rol?d(m.rol):o("Sin conexin y no hay sesin guardada.");return}try{const v=(await qj(tx,e,r)).user,R=st($e(nx,"users"),Je("correo","==",e)),T=await pn(R);if(T.empty){o("Usuario no encontrado en la base de datos.");return}const E=T.docs[0].data().rol||"sin_rol";rx(e,E),d(E)}catch(m){switch(console.error("Error login:",m),m.code){case"auth/user-not-found":o("Usuario no registrado.");break;case"auth/wrong-password":o("Contrasea incorrecta.");break;case"auth/invalid-email":o("Correo no vlido.");break;case"auth/network-request-failed":o("Sin conexin. Usa la sesin guardada o reconecta.");break;default:o("Error al iniciar sesin.")}}};return c.jsx("div",{className:"login-root",style:{backgroundImage:`url(${c4})`,backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat",backgroundAttachment:"fixed",width:"100vw",height:"100vh",display:"flex",justifyContent:"center",alignItems:"center",overflow:"hidden"},children:c.jsxs("div",{className:"container",children:[c.jsxs("div",{className:"left-panel",children:[c.jsx("img",{src:RA,alt:"OdontoCloud Logo",className:"logo"}),c.jsxs("h2",{children:["Su clnica, ",c.jsx("br",{})," ms conectada."]}),c.jsx("p",{children:"OdontoCloud optimiza cada detalle de su gestin."})]}),c.jsxs("div",{className:"right-panel",children:[c.jsx("h3",{children:"Acceso a la plataforma"}),c.jsxs("form",{onSubmit:h,children:[c.jsx("input",{type:"email",placeholder:"usuario@ejemplo.com",value:e,onChange:f=>n(f.target.value),required:a}),c.jsx("input",{type:"password",placeholder:"Contrasea",value:r,onChange:f=>s(f.target.value),required:a}),c.jsx("button",{type:"submit",children:a?"Iniciar sesin":"Entrar (modo offline)"}),i&&c.jsx("p",{style:{color:"red",marginTop:10},children:i}),!a&&c.jsx("p",{style:{color:"orange",marginTop:10},children:" Modo offline activado"})]})]})]})})},PA="@firebase/installations",Bv="0.6.19";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NA=1e4,kA=`w:${Bv}`,DA="FIS_v2",d4="https://firebaseinstallations.googleapis.com/v1",h4=60*60*1e3,f4="installations",p4="Installations";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const m4={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},yo=new Eo(f4,p4,m4);function jA(t){return t instanceof ur&&t.code.includes("request-failed")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OA({projectId:t}){return`${d4}/projects/${t}/installations`}function VA(t){return{token:t.token,requestStatus:2,expiresIn:y4(t.expiresIn),creationTime:Date.now()}}async function LA(t,e){const r=(await e.json()).error;return yo.create("request-failed",{requestName:t,serverCode:r.code,serverMessage:r.message,serverStatus:r.status})}function MA({apiKey:t}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t})}function g4(t,{refreshToken:e}){const n=MA(t);return n.append("Authorization",v4(e)),n}async function FA(t){const e=await t();return e.status>=500&&e.status<600?t():e}function y4(t){return Number(t.replace("s","000"))}function v4(t){return`${DA} ${t}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _4({appConfig:t,heartbeatServiceProvider:e},{fid:n}){const r=OA(t),s=MA(t),i=e.getImmediate({optional:!0});if(i){const d=await i.getHeartbeatsHeader();d&&s.append("x-firebase-client",d)}const o={fid:n,authVersion:DA,appId:t.appId,sdkVersion:kA},a={method:"POST",headers:s,body:JSON.stringify(o)},l=await FA(()=>fetch(r,a));if(l.ok){const d=await l.json();return{fid:d.fid||n,registrationStatus:2,refreshToken:d.refreshToken,authToken:VA(d.authToken)}}else throw await LA("Create Installation",l)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function UA(t){return new Promise(e=>{setTimeout(e,t)})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function w4(t){return btoa(String.fromCharCode(...t)).replace(/\+/g,"-").replace(/\//g,"_")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const E4=/^[cdef][\w-]{21}$/,Eg="";function I4(){try{const t=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(t),t[0]=112+t[0]%16;const n=x4(t);return E4.test(n)?n:Eg}catch{return Eg}}function x4(t){return w4(t).substr(0,22)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pf(t){return`${t.appName}!${t.appId}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $A=new Map;function BA(t,e){const n=Pf(t);zA(n,e),T4(n,e)}function zA(t,e){const n=$A.get(t);if(n)for(const r of n)r(e)}function T4(t,e){const n=S4();n&&n.postMessage({key:t,fid:e}),b4()}let qi=null;function S4(){return!qi&&"BroadcastChannel"in self&&(qi=new BroadcastChannel("[Firebase] FID Change"),qi.onmessage=t=>{zA(t.data.key,t.data.fid)}),qi}function b4(){$A.size===0&&qi&&(qi.close(),qi=null)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const C4="firebase-installations-database",A4=1,vo="firebase-installations-store";let Op=null;function zv(){return Op||(Op=gS(C4,A4,{upgrade:(t,e)=>{switch(e){case 0:t.createObjectStore(vo)}}})),Op}async function Th(t,e){const n=Pf(t),s=(await zv()).transaction(vo,"readwrite"),i=s.objectStore(vo),o=await i.get(n);return await i.put(e,n),await s.done,(!o||o.fid!==e.fid)&&BA(t,e.fid),e}async function qA(t){const e=Pf(t),r=(await zv()).transaction(vo,"readwrite");await r.objectStore(vo).delete(e),await r.done}async function Nf(t,e){const n=Pf(t),s=(await zv()).transaction(vo,"readwrite"),i=s.objectStore(vo),o=await i.get(n),a=e(o);return a===void 0?await i.delete(n):await i.put(a,n),await s.done,a&&(!o||o.fid!==a.fid)&&BA(t,a.fid),a}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function qv(t){let e;const n=await Nf(t.appConfig,r=>{const s=R4(r),i=P4(t,s);return e=i.registrationPromise,i.installationEntry});return n.fid===Eg?{installationEntry:await e}:{installationEntry:n,registrationPromise:e}}function R4(t){const e=t||{fid:I4(),registrationStatus:0};return HA(e)}function P4(t,e){if(e.registrationStatus===0){if(!navigator.onLine){const s=Promise.reject(yo.create("app-offline"));return{installationEntry:e,registrationPromise:s}}const n={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},r=N4(t,n);return{installationEntry:n,registrationPromise:r}}else return e.registrationStatus===1?{installationEntry:e,registrationPromise:k4(t)}:{installationEntry:e}}async function N4(t,e){try{const n=await _4(t,e);return Th(t.appConfig,n)}catch(n){throw jA(n)&&n.customData.serverCode===409?await qA(t.appConfig):await Th(t.appConfig,{fid:e.fid,registrationStatus:0}),n}}async function k4(t){let e=await sx(t.appConfig);for(;e.registrationStatus===1;)await UA(100),e=await sx(t.appConfig);if(e.registrationStatus===0){const{installationEntry:n,registrationPromise:r}=await qv(t);return r||n}return e}function sx(t){return Nf(t,e=>{if(!e)throw yo.create("installation-not-found");return HA(e)})}function HA(t){return D4(t)?{fid:t.fid,registrationStatus:0}:t}function D4(t){return t.registrationStatus===1&&t.registrationTime+NA<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function j4({appConfig:t,heartbeatServiceProvider:e},n){const r=O4(t,n),s=g4(t,n),i=e.getImmediate({optional:!0});if(i){const d=await i.getHeartbeatsHeader();d&&s.append("x-firebase-client",d)}const o={installation:{sdkVersion:kA,appId:t.appId}},a={method:"POST",headers:s,body:JSON.stringify(o)},l=await FA(()=>fetch(r,a));if(l.ok){const d=await l.json();return VA(d)}else throw await LA("Generate Auth Token",l)}function O4(t,{fid:e}){return`${OA(t)}/${e}/authTokens:generate`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Hv(t,e=!1){let n;const r=await Nf(t.appConfig,i=>{if(!WA(i))throw yo.create("not-registered");const o=i.authToken;if(!e&&M4(o))return i;if(o.requestStatus===1)return n=V4(t,e),i;{if(!navigator.onLine)throw yo.create("app-offline");const a=U4(i);return n=L4(t,a),a}});return n?await n:r.authToken}async function V4(t,e){let n=await ix(t.appConfig);for(;n.authToken.requestStatus===1;)await UA(100),n=await ix(t.appConfig);const r=n.authToken;return r.requestStatus===0?Hv(t,e):r}function ix(t){return Nf(t,e=>{if(!WA(e))throw yo.create("not-registered");const n=e.authToken;return $4(n)?{...e,authToken:{requestStatus:0}}:e})}async function L4(t,e){try{const n=await j4(t,e),r={...e,authToken:n};return await Th(t.appConfig,r),n}catch(n){if(jA(n)&&(n.customData.serverCode===401||n.customData.serverCode===404))await qA(t.appConfig);else{const r={...e,authToken:{requestStatus:0}};await Th(t.appConfig,r)}throw n}}function WA(t){return t!==void 0&&t.registrationStatus===2}function M4(t){return t.requestStatus===2&&!F4(t)}function F4(t){const e=Date.now();return e<t.creationTime||t.creationTime+t.expiresIn<e+h4}function U4(t){const e={requestStatus:1,requestTime:Date.now()};return{...t,authToken:e}}function $4(t){return t.requestStatus===1&&t.requestTime+NA<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function B4(t){const e=t,{installationEntry:n,registrationPromise:r}=await qv(e);return r?r.catch(console.error):Hv(e).catch(console.error),n.fid}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function z4(t,e=!1){const n=t;return await q4(n),(await Hv(n,e)).token}async function q4(t){const{registrationPromise:e}=await qv(t);e&&await e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function H4(t){if(!t||!t.options)throw Vp("App Configuration");if(!t.name)throw Vp("App Name");const e=["projectId","apiKey","appId"];for(const n of e)if(!t.options[n])throw Vp(n);return{appName:t.name,projectId:t.options.projectId,apiKey:t.options.apiKey,appId:t.options.appId}}function Vp(t){return yo.create("missing-app-config-values",{valueName:t})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GA="installations",W4="installations-internal",G4=t=>{const e=t.getProvider("app").getImmediate(),n=H4(e),r=_i(e,"heartbeat");return{app:e,appConfig:n,heartbeatServiceProvider:r,_delete:()=>Promise.resolve()}},K4=t=>{const e=t.getProvider("app").getImmediate(),n=_i(e,GA).getImmediate();return{getId:()=>B4(n),getToken:s=>z4(n,s)}};function Q4(){xr(new cr(GA,G4,"PUBLIC")),xr(new cr(W4,K4,"PRIVATE"))}Q4();Dn(PA,Bv);Dn(PA,Bv,"esm2020");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sh="analytics",Y4="firebase_id",X4="origin",J4=60*1e3,Z4="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",Wv="https://www.googletagmanager.com/gtag/js";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wn=new Wh("@firebase/analytics");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eU={"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-initialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."},zn=new Eo("analytics","Analytics",eU);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tU(t){if(!t.startsWith(Wv)){const e=zn.create("invalid-gtag-resource",{gtagURL:t});return wn.warn(e.message),""}return t}function KA(t){return Promise.all(t.map(e=>e.catch(n=>n)))}function nU(t,e){let n;return window.trustedTypes&&(n=window.trustedTypes.createPolicy(t,e)),n}function rU(t,e){const n=nU("firebase-js-sdk-policy",{createScriptURL:tU}),r=document.createElement("script"),s=`${Wv}?l=${t}&id=${e}`;r.src=n?n==null?void 0:n.createScriptURL(s):s,r.async=!0,document.head.appendChild(r)}function sU(t){let e=[];return Array.isArray(window[t])?e=window[t]:window[t]=e,e}async function iU(t,e,n,r,s,i){const o=r[s];try{if(o)await e[o];else{const l=(await KA(n)).find(d=>d.measurementId===s);l&&await e[l.appId]}}catch(a){wn.error(a)}t("config",s,i)}async function oU(t,e,n,r,s){try{let i=[];if(s&&s.send_to){let o=s.send_to;Array.isArray(o)||(o=[o]);const a=await KA(n);for(const l of o){const d=a.find(f=>f.measurementId===l),h=d&&e[d.appId];if(h)i.push(h);else{i=[];break}}}i.length===0&&(i=Object.values(e)),await Promise.all(i),t("event",r,s||{})}catch(i){wn.error(i)}}function aU(t,e,n,r){async function s(i,...o){try{if(i==="event"){const[a,l]=o;await oU(t,e,n,a,l)}else if(i==="config"){const[a,l]=o;await iU(t,e,n,r,a,l)}else if(i==="consent"){const[a,l]=o;t("consent",a,l)}else if(i==="get"){const[a,l,d]=o;t("get",a,l,d)}else if(i==="set"){const[a]=o;t("set",a)}else t(i,...o)}catch(a){wn.error(a)}}return s}function lU(t,e,n,r,s){let i=function(...o){window[r].push(arguments)};return window[s]&&typeof window[s]=="function"&&(i=window[s]),window[s]=aU(i,t,e,n),{gtagCore:i,wrappedGtag:window[s]}}function cU(t){const e=window.document.getElementsByTagName("script");for(const n of Object.values(e))if(n.src&&n.src.includes(Wv)&&n.src.includes(t))return n;return null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uU=30,dU=1e3;class hU{constructor(e={},n=dU){this.throttleMetadata=e,this.intervalMillis=n}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,n){this.throttleMetadata[e]=n}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}}const QA=new hU;function fU(t){return new Headers({Accept:"application/json","x-goog-api-key":t})}async function pU(t){var o;const{appId:e,apiKey:n}=t,r={method:"GET",headers:fU(n)},s=Z4.replace("{app-id}",e),i=await fetch(s,r);if(i.status!==200&&i.status!==304){let a="";try{const l=await i.json();(o=l.error)!=null&&o.message&&(a=l.error.message)}catch{}throw zn.create("config-fetch-failed",{httpStatus:i.status,responseMessage:a})}return i.json()}async function mU(t,e=QA,n){const{appId:r,apiKey:s,measurementId:i}=t.options;if(!r)throw zn.create("no-app-id");if(!s){if(i)return{measurementId:i,appId:r};throw zn.create("no-api-key")}const o=e.getThrottleMetadata(r)||{backoffCount:0,throttleEndTimeMillis:Date.now()},a=new vU;return setTimeout(async()=>{a.abort()},J4),YA({appId:r,apiKey:s,measurementId:i},o,a,e)}async function YA(t,{throttleEndTimeMillis:e,backoffCount:n},r,s=QA){var a;const{appId:i,measurementId:o}=t;try{await gU(r,e)}catch(l){if(o)return wn.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${o} provided in the "measurementId" field in the local Firebase config. [${l==null?void 0:l.message}]`),{appId:i,measurementId:o};throw l}try{const l=await pU(t);return s.deleteThrottleMetadata(i),l}catch(l){const d=l;if(!yU(d)){if(s.deleteThrottleMetadata(i),o)return wn.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${o} provided in the "measurementId" field in the local Firebase config. [${d==null?void 0:d.message}]`),{appId:i,measurementId:o};throw l}const h=Number((a=d==null?void 0:d.customData)==null?void 0:a.httpStatus)===503?Hw(n,s.intervalMillis,uU):Hw(n,s.intervalMillis),f={throttleEndTimeMillis:Date.now()+h,backoffCount:n+1};return s.setThrottleMetadata(i,f),wn.debug(`Calling attemptFetch again in ${h} millis`),YA(t,f,r,s)}}function gU(t,e){return new Promise((n,r)=>{const s=Math.max(e-Date.now(),0),i=setTimeout(n,s);t.addEventListener(()=>{clearTimeout(i),r(zn.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}function yU(t){if(!(t instanceof ur)||!t.customData)return!1;const e=Number(t.customData.httpStatus);return e===429||e===500||e===503||e===504}class vU{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach(e=>e())}}async function _U(t,e,n,r,s){if(s&&s.global){t("event",n,r);return}else{const i=await e,o={...r,send_to:i};t("event",n,o)}}async function wU(t,e,n,r){if(r&&r.global){const s={};for(const i of Object.keys(n))s[`user_properties.${i}`]=n[i];return t("set",s),Promise.resolve()}else{const s=await e;t("config",s,{update:!0,user_properties:n})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function EU(){if(Sy())try{await fS()}catch(t){return wn.warn(zn.create("indexeddb-unavailable",{errorInfo:t==null?void 0:t.toString()}).message),!1}else return wn.warn(zn.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;return!0}async function IU(t,e,n,r,s,i,o){const a=mU(t);a.then(m=>{n[m.measurementId]=m.appId,t.options.measurementId&&m.measurementId!==t.options.measurementId&&wn.warn(`The measurement ID in the local Firebase config (${t.options.measurementId}) does not match the measurement ID fetched from the server (${m.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(m=>wn.error(m)),e.push(a);const l=EU().then(m=>{if(m)return r.getId()}),[d,h]=await Promise.all([a,l]);cU(i)||rU(i,d.measurementId),s("js",new Date);const f=(o==null?void 0:o.config)??{};return f[X4]="firebase",f.update=!0,h!=null&&(f[Y4]=h),s("config",d.measurementId,f),d.measurementId}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xU{constructor(e){this.app=e}_delete(){return delete wa[this.app.options.appId],Promise.resolve()}}let wa={},ox=[];const ax={};let Lp="dataLayer",TU="gtag",lx,Gv,cx=!1;function SU(){const t=[];if(uS()&&t.push("This is a browser extension environment."),bk()||t.push("Cookies are not available."),t.length>0){const e=t.map((r,s)=>`(${s+1}) ${r}`).join(" "),n=zn.create("invalid-analytics-context",{errorInfo:e});wn.warn(n.message)}}function bU(t,e,n){SU();const r=t.options.appId;if(!r)throw zn.create("no-app-id");if(!t.options.apiKey)if(t.options.measurementId)wn.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${t.options.measurementId} provided in the "measurementId" field in the local Firebase config.`);else throw zn.create("no-api-key");if(wa[r]!=null)throw zn.create("already-exists",{id:r});if(!cx){sU(Lp);const{wrappedGtag:i,gtagCore:o}=lU(wa,ox,ax,Lp,TU);Gv=i,lx=o,cx=!0}return wa[r]=IU(t,ox,ax,e,lx,Lp,n),new xU(t)}function CU(t=Gh()){t=Ye(t);const e=_i(t,Sh);return e.isInitialized()?e.getImmediate():AU(t)}function AU(t,e={}){const n=_i(t,Sh);if(n.isInitialized()){const s=n.getImmediate();if(ps(e,n.getOptions()))return s;throw zn.create("already-initialized")}return n.initialize({options:e})}function RU(t,e,n){t=Ye(t),wU(Gv,wa[t.app.options.appId],e,n).catch(r=>wn.error(r))}function PU(t,e,n,r){t=Ye(t),_U(Gv,wa[t.app.options.appId],e,n,r).catch(s=>wn.error(s))}const ux="@firebase/analytics",dx="0.10.19";function NU(){xr(new cr(Sh,(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("installations-internal").getImmediate();return bU(r,s,n)},"PUBLIC")),xr(new cr("analytics-internal",t,"PRIVATE")),Dn(ux,dx),Dn(ux,dx,"esm2020");function t(e){try{const n=e.getProvider(Sh).getImmediate();return{logEvent:(r,s,i)=>PU(n,r,s,i),setUserProperties:(r,s)=>RU(n,r,s)}}catch(n){throw zn.create("interop-component-reg-failed",{reason:n})}}}NU();const kU={apiKey:"AIzaSyC70mGCRrjE8iOap8iTHuid8HEuyadue8Y",authDomain:"odontocloud-d92ac.firebaseapp.com",projectId:"odontocloud-d92ac",storageBucket:"odontocloud-d92ac.firebasestorage.app",messagingSenderId:"267020714981",appId:"1:267020714981:web:a44416ea83aa1d1172650c",measurementId:"G-ZMCC5CFY0C"},kf=Cy(kU),bh=ZS(kf),ye=eA(kf);Fi(kf);CU(kf);const Kv=(t,e="")=>{try{return localStorage.getItem(t)??e}catch{return e}},hx=()=>{var t;return((t=document.querySelector('meta[name="company-name"]'))==null?void 0:t.getAttribute("content"))||Kv("empresa_nombre","OdontoCloud")},DU=()=>{var t;return((t=document.querySelector('meta[name="company-logo"]'))==null?void 0:t.getAttribute("content"))||Kv("empresa_logo_url","")},fx=()=>{var t;return((t=document.querySelector('meta[name="software-footer"]'))==null?void 0:t.getAttribute("content"))||Kv("software_footer_text","Generado por OdontoCloud")},Wu=()=>{const t=new Date;return t.setHours(0,0,0,0),t},Ds=t=>{const e=new Date(t);return e.setHours(0,0,0,0),e},Mp=t=>{const e=new Date(t);return e.setHours(23,59,59,999),e},Or=(t,e)=>{const n=new Date(t);return n.setDate(n.getDate()+e),n},px=t=>{const e=new Date(t),n=e.getDay(),r=(n===0?-6:1)-n;return e.setDate(e.getDate()+r),e.setHours(0,0,0,0),e},mx=(t,e)=>t.getFullYear()===e.getFullYear()&&t.getMonth()===e.getMonth()&&t.getDate()===e.getDate();var xx;const bn=typeof navigator<"u"&&((xx=navigator.language)!=null&&xx.startsWith("es"))?"es-ES":"en-US",Fp=t=>{const e=t.getFullYear(),n=String(t.getMonth()+1).padStart(2,"0"),r=String(t.getDate()).padStart(2,"0");return`${e}-${n}-${r}`},Vo=t=>(t||"").toString().toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/\s+/g," ").trim(),jU=t=>{try{const e=new URLSearchParams(t||""),n=e.get("date")||e.get("day")||e.get("d")||e.get("fecha")||e.get("selectedDate")||(typeof sessionStorage<"u"?sessionStorage.getItem("agenda.targetDate"):""),r=String(n||"").slice(0,10);if(!/^\d{4}-\d{2}-\d{2}$/.test(r))return null;const[s,i,o]=r.split("-").map(l=>parseInt(l,10));return new Date(s,(i||1)-1,o||1,0,0,0,0)}catch{return null}};function OU(){const t=Kn(),[e,n]=A.useState("day"),[r,s]=A.useState(Wu()),[i,o]=A.useState(Wu()),[a,l]=A.useState(!0),[d,h]=A.useState([]),[f,m]=A.useState(""),[v,R]=A.useState(""),[T,P]=A.useState("");A.useEffect(()=>{const U=jU(t.search);if(U){const ne=Ds(U);s(ne),o(ne),n("day");try{sessionStorage.removeItem("agenda.targetDate")}catch{}}},[t.search]),A.useEffect(()=>{l(!0);const U=$e(ye,"citas"),ne=st(U,gn("fecha","asc")),ce=Fn(ne,xe=>{const Te=xe.docs.map(Se=>{const ie=Se.data(),Pe=ie.horaInicio||ie.hora||"00:00",[Me="0",He="0"]=Pe.split(":"),H=parseInt(Me,10)||0,se=parseInt(He,10)||0;let q;if(ie.fecha&&ie.fecha.toDate)q=ie.fecha.toDate(),q.setHours(H,se,0,0);else if(typeof ie.fecha=="string"){const[ge,_e,Fe]=ie.fecha.split("-");q=new Date(parseInt(ge,10),parseInt(_e,10)-1,parseInt(Fe,10),H,se,0,0)}else ie.fecha instanceof Date?(q=new Date(ie.fecha),q.setHours(H,se,0,0)):(q=new Date,q.setHours(H,se,0,0));const re=ie.documentoPaciente||ie.docPaciente||ie.pacienteDocumento||ie.documento||"",ae=ie.celularPaciente||ie.telefonoPaciente||ie.celular||ie.telefono||"";return{id:Se.id,raw:ie,fecha:q,horaInicio:Pe,paciente:ie.paciente||ie.pacienteNombre||"Sin nombre",doctor:ie.doctor||ie.doctorNombre||"",sucursal:ie.sucursal||"",espacio:ie.espacio||ie.consultorio||"",comentario:ie.comentario||"",estado:ie.estado||"En espera",recordatorio:ie.recordatorio||"",documento:re,telefono:ae}});let je,we;if(e==="day")je=Ds(r),we=Mp(r);else if(e==="week"){const Se=px(r),ie=Or(Se,6);je=Ds(Se),we=Mp(ie)}else{const Se=Ds(r),ie=Or(Se,-30),Pe=Or(Se,60);je=Ds(ie),we=Mp(Pe)}const it=Te.filter(Se=>Se.fecha>=je&&Se.fecha<=we);h(it),l(!1)},xe=>{console.error("Error leyendo citas:",xe),h([]),l(!1)});return()=>ce()},[e,r]);const E=A.useMemo(()=>{const U=new Set;return d.forEach(ne=>ne.sucursal&&U.add(ne.sucursal)),Array.from(U)},[d]),I=A.useMemo(()=>{const U=new Set;return d.forEach(ne=>ne.doctor&&U.add(ne.doctor)),Array.from(U)},[d]),S=A.useMemo(()=>{const U=T.trim().toLowerCase();return d.filter(ne=>{if(f&&ne.sucursal!==f||v&&ne.doctor!==v)return!1;if(!U)return!0;const ce=[ne.paciente,ne.doctor,ne.comentario,ne.documento,ne.sucursal,ne.espacio,ne.estado],xe=ne.raw?JSON.stringify(ne.raw):"";return[...ce,xe].filter(Boolean).some(je=>String(je).toLowerCase().includes(U))})},[d,f,v,T]),b=A.useMemo(()=>a?"Ocupacin: cargando...":S.length===0?"Ocupacin: sin citas para el rango seleccionado.":`Ocupacin: ${S.length} cita${S.length!==1?"s":""} en el rango actual.`,[S,a]),L=A.useMemo(()=>{const U=new Date(i.getFullYear(),i.getMonth(),1),ne=(U.getDay()+6)%7,ce=new Date(U);ce.setDate(ce.getDate()-ne);const xe=[];for(let Te=0;Te<6;Te++){const je=[];for(let we=0;we<7;we++){const it=new Date(ce),Se=it.getMonth()===i.getMonth(),ie=mx(it,Wu()),Pe=mx(it,r);je.push({date:it,isCurrentMonth:Se,isToday:ie,isSelected:Pe}),ce.setDate(ce.getDate()+1)}xe.push(je)}return xe},[i,r]),B=()=>{const U=new Date(i);U.setMonth(U.getMonth()-1),o(U)},w=()=>{const U=new Date(i);U.setMonth(U.getMonth()+1),o(U)},_=U=>{s(Ds(U)),o(Ds(U)),n("day")},y=A.useMemo(()=>i.toLocaleDateString(bn,{month:"long",year:"numeric"}),[i]),N=A.useMemo(()=>{if(e==="day")return r.toLocaleDateString(bn,{weekday:"long",day:"2-digit",month:"long",year:"numeric"});if(e==="week"){const U=px(r),ne=Or(U,6);return U.toLocaleDateString(bn,{day:"2-digit",month:"short"})+" - "+ne.toLocaleDateString(bn,{day:"2-digit",month:"short",year:"numeric"})}return"ltimas citas (detalle)"},[e,r]),D=()=>{s(e==="day"?Or(r,-1):e==="week"?Or(r,-7):Or(r,-1))},j=()=>{s(e==="day"?Or(r,1):e==="week"?Or(r,7):Or(r,1))},k=()=>{const U=Wu();s(U),o(U),n("day")},K=()=>{var Me;const U=He=>String(He??"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),ne=hx(),ce=DU(),xe=fx(),Te=S.length===0?'<tr><td colspan="6" style="padding:8px 6px;color:#6b7280">No hay citas registradas para este rango.</td></tr>':S.map(He=>{const H=He.fecha.toLocaleDateString(bn),se=He.fecha.toLocaleTimeString(bn,{hour:"2-digit",minute:"2-digit",hour12:!0});return`<tr>
                <td>${U(H)}</td>
                <td>${U(se)}</td>
                <td>${U(He.paciente)}</td>
                <td>${U(He.doctor)}</td>
                <td>${U(He.espacio)}</td>
                <td>${U(He.comentario)}</td>
              </tr>`}).join(""),we=`<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>Imprimir  ${U(ne)}</title>
  <style>
      @page { size: A4 portrait; margin: 18mm; }
      body { font-family: Segoe UI, Roboto, Arial, sans-serif; color:#0f172a; }
      /* === Cabecera centrada con logo grande === */
      .hdr {
        display:flex;
        flex-direction:column;
        align-items:center;
        text-align:center;
        gap:10px;
        border-bottom:2px solid #e5e7eb;
        padding-bottom:12px;
        margin-bottom:14px;
      }
      .logo {
        max-height: 130px;   /* puedes subir a 150px si lo deseas */
        width: auto;
        max-width: 100%;
        object-fit: contain;
      }
      .brand {
        font-size: 24px;     /* aumenta si lo quieres ms grande */
        font-weight: 800;
        color:#0a86d8;
        line-height:1.15;
      }
      .sub { font-size:12px; color:#6b7280; }

      table { width:100%; border-collapse:collapse; font-size:12px; }
      th { text-align:left; background:#f3f4f6; border-bottom:1px solid #e5e7eb; padding:8px 6px; }
      td { border-bottom:1px solid #f1f5f9; padding:7px 6px; vertical-align:top; }
      .note { margin-top:8px; font-size:10px; color:#9ca3af; }
      tr, .hdr { page-break-inside: avoid; }
    </style>
</head>
<body>
  <div class="hdr">
    ${ce?`<img src="${ce}" alt="Logo" class="logo">`:""}
    <div class="brand">${U(ne)}</div>
    <div class="sub">Agenda de citas  ${U(N)}</div>
  </div>

  <table>
    <thead>
      <tr>
        <th style="width:18%">Fecha</th>
        <th style="width:10%">Hora</th>
        <th style="width:22%">Paciente</th>
        <th style="width:20%">Doctor</th>
        <th style="width:15%">Espacio</th>
        <th>Comentario</th>
      </tr>
    </thead>
    <tbody>${Te}</tbody>
  </table>

  <div class="note">${U(xe)}. ${U(new Date().toLocaleString(bn))}</div>
  <script>
    window.addEventListener('load', function() {
      try { window.focus(); window.print(); } catch (e) {}
    });
  <\/script>
</body>
</html>`,it=new Blob([we],{type:"text/html;charset=utf-8"}),Se=URL.createObjectURL(it),ie=window.open(Se,"_blank","noopener,noreferrer,width=900,height=700");if(!ie){alert("El navegador bloque la ventana de impresin. Permite pop-ups para este sitio."),URL.revokeObjectURL(Se);return}const Pe=()=>{try{URL.revokeObjectURL(Se)}catch{}};(Me=ie.addEventListener)==null||Me.call(ie,"load",Pe),setTimeout(Pe,15e3)},Ke=()=>alert("Funcin de confirmar citas se integrar con n8n / correo."),Ft=()=>k(),dn=()=>{if(S.length===0){alert("No hay citas para exportar.");return}const U=hx(),ne=fx(),ce=[`Empresa: ${U}`],xe=["Fecha","Hora","Paciente","Doctor","Espacio","Comentario"],Te=S.map(Me=>{const He=Me.fecha.toLocaleDateString(bn),H=Me.fecha.toLocaleTimeString(bn,{hour:"2-digit",minute:"2-digit",hour12:!0});return[He,H,Me.paciente||"",Me.doctor||"",Me.espacio||"",(Me.comentario||"").replace(/\r?\n/g," ")]}),je=[ne],we=[ce,[],xe,...Te,[],je].map(Me=>(Me||[]).map(He=>`"${String(He??"").replace(/"/g,'""')}"`).join(",")).join(`
`),it=`citas_${U.toLowerCase().replace(/\s+/g,"_")}_${Fp(Ds(r))}`+(e==="week"?"_semana":e==="detail"?"_detalle":"")+".csv",Se=new Blob(["\uFEFF"+we],{type:"text/csv;charset=utf-8;"}),ie=URL.createObjectURL(Se),Pe=document.createElement("a");Pe.href=ie,Pe.download=it,Pe.click(),URL.revokeObjectURL(ie)},Z=async(U,ne)=>{try{const ce=Yt(ye,"citas",U);await _a(ce,{estado:ne})}catch(ce){console.error("Error actualizando estado:",ce),alert("No se pudo actualizar el estado de la cita.")}},de=(U,ne)=>{if(!U){alert("Este paciente no tiene celular registrado.");return}const ce=String(U).replace(/\D/g,""),xe=ne.fecha.toLocaleDateString(bn),Te=ne.fecha.toLocaleTimeString(bn,{hour:"numeric",minute:"2-digit",hour12:!0}),je=encodeURIComponent(`Hola ${ne.paciente}, le recordamos su cita odontolgica el ${xe} a las ${Te}. Por favor confirme su asistencia.`),we=`https://wa.me/${ce}?text=${je}`;window.open(we,"_blank")},pe=async U=>{if(window.confirm(`Seguro que deseas eliminar la cita de ${U.paciente} del ${U.fecha.toLocaleDateString(bn)}?`))try{const ce=Yt(ye,"citas",U.id);await fA(ce)}catch(ce){console.error("Error eliminando cita:",ce),alert(" No se pudo eliminar la cita.")}},Re=()=>{const U=document.createElement("div");Object.assign(U.style,{position:"fixed",top:"0",left:"0",width:"100%",height:"100%",background:"rgba(0,0,0,0.55)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:"9999"});const ne=document.createElement("div");Object.assign(ne.style,{background:"#fff",padding:"25px 30px",borderRadius:"14px",width:"520px",maxWidth:"95%",maxHeight:"95%",overflowY:"auto",boxShadow:"0 8px 30px rgba(0,0,0,0.3)",fontFamily:"Segoe UI, Roboto, sans-serif"}),ne.innerHTML=`
      <h2 style="margin-top:0;text-align:center;color:#0a86d8;font-weight:600;"> Nueva Cita</h2>
      <form id="formNuevaCita" style="display:flex;flex-direction:column;gap:12px;margin-top:10px;">
        <label style="font-weight:600;">Paciente existente</label>
        <div style="position:relative;">
          <input type="text" id="buscarPaciente" placeholder="Buscar por nombre, apellido o documento..." autocomplete="off"/>
          <div id="acResultados" style="position:absolute;left:0;right:0;top:calc(100% + 6px);z-index:10000;display:none;background:#fff;border:1px solid #ddd;border-radius:8px;box-shadow:0 8px 22px rgba(0,0,0,.12);max-height:240px;overflow:auto;"></div>
        </div>
        <small style="color:gray;">Si el paciente no existe, marca Registrar nuevo paciente.</small>

        <label style="display:flex;align-items:center;gap:8px;margin-top:5px;">
          <input type="checkbox" id="esNuevoPaciente" />
          <span>Registrar nuevo paciente</span>
        </label>

        <div id="nuevoPacienteCampos" style="display:none;flex-direction:column;gap:8px;margin-top:10px;padding:10px;border-radius:8px;background:#f9f9f9;border:1px solid #ddd;">
          <h4 style="margin:0;text-align:center;color:#0a86d8;">Datos del paciente</h4>
          <div style="display:flex;gap:8px;">
            <input type="text" id="npNombre" placeholder="Nombre" style="flex:1;" />
            <input type="text" id="npApellido" placeholder="Apellido" style="flex:1;" />
          </div>
          <select id="npTipoDocumento">
            <option value="">Tipo de documento</option>
            <option value="CC">Cdula de Ciudadana</option>
            <option value="CE">Cdula de Extranjera</option>
            <option value="TI">Tarjeta de Identidad</option>
            <option value="PA">Pasaporte</option>
            <option value="DI">Documento Internacional</option>
            <option value="OTRO">Otro</option>
          </select>
          <input type="text" id="npDocumento" placeholder="Nmero de documento" />
          <input type="email" id="npCorreo" placeholder="Correo electrnico" />
          <div style="display:flex;gap:5px;">
            <select id="npIndicativo" style="width:40%;">
              <option value="+57"> +57</option>
              <option value="+1"> +1</option>
              <option value="+34"> +34</option>
              <option value="+52"> +52</option>
              <option value="+54"> +54</option>
              <option value="+593"> +593</option>
              <option value="+56"> +56</option>
              <option value="+58"> +58</option>
            </select>
            <input type="tel" id="npCelular" placeholder="Celular (obligatorio)" style="flex:1;" />
          </div>
          <input type="tel" id="npTelefono" placeholder="Telfono fijo (opcional)" />
          <label style="font-weight:500;">Fecha de nacimiento:</label>
          <input type="date" id="npNacimiento" />
          <select id="npSexo">
            <option value="">Sexo</option>
            <option value="Masculino">Masculino</option>
            <option value="Femenino">Femenino</option>
            <option value="Otro">Otro</option>
          </select>
          <textarea id="npComentario" placeholder="Comentario o antecedentes del paciente" rows="2"></textarea>
        </div>

        <hr style="margin:10px 0;border:none;border-top:1px solid #ddd;" />
        <h4 style="margin:0;text-align:center;color:#0a86d8;">Detalles de la cita</h4>
        <input type="text" id="ncDoctor" placeholder="Doctor asignado" required />
        <input type="date" id="ncFecha" required value="${Fp(r)}" />
        <input type="time" id="ncHora" required />
        <input type="text" id="ncEspacio" placeholder="Espacio fsico / Sala" />
        <textarea id="ncComentario" placeholder="Comentario sobre la cita" rows="3"></textarea>

        <div style="display:flex;justify-content:flex-end;gap:10px;margin-top:10px;">
          <button type="button" id="btnCancelarModal" class="btn-cancelar">Cancelar</button>
          <button type="submit" class="btn-guardar">Guardar</button>
        </div>
      </form>
    `;const ce=document.createElement("style");ce.textContent=`
      .btn-cancelar, .btn-guardar { padding: 8px 14px; border: none; border-radius: 6px; cursor: pointer; font-weight: 600; font-size: 14px; transition: .2s; }
      .btn-cancelar { background: #e0e0e0; color: #333; } .btn-cancelar:hover { background: #d5d5d5; }
      .btn-guardar { background: #0a86d8; color: white; } .btn-guardar:hover { background: #0669ac; }
      input, select, textarea { width: 100%; padding: 8px 10px; border: 1px solid #ccc; border-radius: 6px; font-size: 14px; outline: none; }
      input:focus, select:focus, textarea:focus { border-color: #0a86d8; box-shadow: 0 0 0 2px rgba(10,134,216,.2); }
      .ac-item { padding: 8px 10px; display:flex; gap:8px; align-items:baseline; cursor:pointer; }
      .ac-item:hover, .ac-item.active { background:#f5f7fb; }
      .ac-name { font-weight:600; } .ac-doc { color:#64748b; font-size:12px; } .ac-tel { margin-left:auto; font-size:12px; color:#0f172a; }
      .ac-empty { padding:10px; color:#9aa4b2; font-size:13px; }
    `,document.head.appendChild(ce),U.appendChild(ne),document.body.appendChild(U);const xe=ne.querySelector("#esNuevoPaciente"),Te=ne.querySelector("#nuevoPacienteCampos"),je=ne.querySelector("#buscarPaciente"),we=ne.querySelector("#acResultados");xe.addEventListener("change",()=>{Te.style.display=xe.checked?"flex":"none",xe.checked&&(we.style.display="none")}),ne.querySelector("#btnCancelarModal").addEventListener("click",()=>U.remove());let it=null,Se=null,ie=-1,Pe=[];const Me=ae=>{if(Pe=ae||[],ie=-1,!ae||ae.length===0){we.innerHTML='<div class="ac-empty">Sin resultados</div>',we.style.display="block";return}we.innerHTML=ae.map((ge,_e)=>`
            <div class="ac-item" data-index="${_e}" data-id="${ge.id}">
              <span class="ac-name">${ge.nombre}</span>
              <span class="ac-doc"> ${ge.documento||"s/doc"}</span>
              <span class="ac-tel">${ge.celular||ge.telefono||""}</span>
            </div>`).join(""),we.style.display="block",[...we.querySelectorAll(".ac-item")].forEach(ge=>{ge.addEventListener("click",()=>{const _e=Number(ge.getAttribute("data-index"));He(_e)})})},He=ae=>{const ge=Pe[ae];ge&&(Se=ge,je.value=ge.nombre,we.style.display="none",xe.checked=!1,Te.style.display="none")},H=ae=>{Pe.length&&(ie=(ie+ae+Pe.length)%Pe.length,[...we.querySelectorAll(".ac-item")].forEach((ge,_e)=>{_e===ie?ge.classList.add("active"):ge.classList.remove("active")}))},se=(ae,ge)=>ae.nombreCompleto||ae.paciente||[ae.nombres,ae.apellidos].filter(Boolean).join(" ")||ge,q=async ae=>{const ge=(ae||"").toString().trim(),_e=Vo(ge);if(!_e||_e.length<2)return[];if(/^\d{5,}$/.test(ge))try{const Fe=st($e(ye,"pacientes"),Je("documento","==",ge)),Ce=st($e(ye,"pacientes"),Je("nroDocumento","==",ge)),[ze,De]=await Promise.all([pn(Fe),pn(Ce)]),be=ze.empty?De:ze;if(!be.empty)return be.docs.slice(0,10).map(M=>{const X=M.data()||{};return{id:M.id,nombre:se(X,M.id),documento:X.documento||X.nroDocumento||M.id,celular:X.celularPaciente||X.celular||"",telefono:X.telefonoPaciente||X.telefono||""}})}catch{}try{const Fe=st($e(ye,"pacientes"),gn("nombre_busqueda"),$I(_e),BI(_e+""),va(10)),Ce=await pn(Fe);if(!Ce.empty)return Ce.docs.map(ze=>{const De=ze.data()||{};return{id:ze.id,nombre:se(De,ze.id),documento:De.documento||De.nroDocumento||ze.id,celular:De.celularPaciente||De.celular||"",telefono:De.telefonoPaciente||De.telefono||""}})}catch{}try{const Fe=st($e(ye,"pacientes"),gn("creado","desc"),va(50));return(await pn(Fe)).docs.map(be=>({id:be.id,...be.data()||{}})).map(be=>({id:be.id,nombre:se(be,be.id),documento:be.documento||be.nroDocumento||be.id,celular:be.celularPaciente||be.celular||"",telefono:be.telefonoPaciente||be.telefono||"",_norm:Vo(`${be.nombreCompleto||be.paciente||""} ${be.nombres||""} ${be.apellidos||""} ${be.documento||be.nroDocumento||""}`)})).filter(be=>be._norm.includes(_e)).slice(0,10).map(({_norm:be,...M})=>M)}catch{}return[]};je.addEventListener("input",()=>{Se=null;const ae=je.value;if(clearTimeout(it),!ae||ae.trim().length<2){we.style.display="none";return}it=setTimeout(async()=>{const ge=await q(ae.trim());Me(ge)},220)}),je.addEventListener("keydown",ae=>{we.style.display==="block"&&(ae.key==="ArrowDown"?(ae.preventDefault(),H(1)):ae.key==="ArrowUp"?(ae.preventDefault(),H(-1)):ae.key==="Enter"?ie>=0&&(ae.preventDefault(),He(ie)):ae.key==="Escape"&&(we.style.display="none"))}),document.addEventListener("click",ae=>{ne.contains(ae.target)&&!we.contains(ae.target)&&ae.target!==je&&(we.style.display="none")},{capture:!0});const re=ne.querySelector("#formNuevaCita");re.addEventListener("submit",async ae=>{ae.preventDefault();const ge=xe.checked,_e=(re.querySelector("#buscarPaciente").value||"").trim(),Fe=re.querySelector("#ncDoctor").value.trim(),Ce=re.querySelector("#ncFecha").value,ze=re.querySelector("#ncHora").value,De=re.querySelector("#ncEspacio").value.trim(),be=re.querySelector("#ncComentario").value.trim();if(!Ce||!ze){alert(" Debes seleccionar fecha y hora para la cita.");return}if(!Fe){alert(" Indica el doctor asignado.");return}try{let M=null,X=null,te="",Ne="",nt="";if(ge){const jn=(re.querySelector("#npNombre").value||"").trim(),Zt=(re.querySelector("#npApellido").value||"").trim();if(te=`${jn} ${Zt}`.trim(),!te){alert(" Debes indicar nombre y apellido para el nuevo paciente.");return}const bt=(re.querySelector("#npDocumento").value||"").trim(),Ut=(re.querySelector("#npCelular").value||"").trim(),$t=(re.querySelector("#npTelefono").value||"").trim();if(!Ut&&!$t){alert(" Debes registrar al menos un telfono (celular o fijo) del paciente o de un acudiente.");return}if(M=bt||te.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/\s+/g,"_"),X=Yt(ye,"pacientes",M),!(await Ih(X)).exists()){const Ct=Vo(te);await xh(X,{nombres:jn,apellidos:Zt,nombreCompleto:te,paciente:te,nombre_busqueda:Ct,variantes_busqueda:[Ct,Vo(jn),Vo(Zt)],tipoDocumento:re.querySelector("#npTipoDocumento").value,documento:bt,correo:(re.querySelector("#npCorreo").value||"").trim(),indicativo:re.querySelector("#npIndicativo").value,celular:Ut,telefono:$t,celularPaciente:Ut,telefonoPaciente:$t,fechaNacimiento:re.querySelector("#npNacimiento").value,sexo:re.querySelector("#npSexo").value,notas:(re.querySelector("#npComentario").value||"").trim(),creado:new Date().toISOString(),activo:!0,citas:[]},{merge:!0})}Ne=Ut,nt=$t}else if(Se)M=Se.id,te=Se.nombre,X=Yt(ye,"pacientes",M),Ne=Se.celular||"",nt=Se.telefono||"";else{if(!_e){alert(" Por favor, escribe o selecciona un paciente.");return}const jn=st($e(ye,"pacientes"),Je("documento","==",_e)),Zt=st($e(ye,"pacientes"),Je("nroDocumento","==",_e)),[bt,Ut]=await Promise.all([pn(jn),pn(Zt)]),$t=bt.empty?Ut:bt;if($t.empty){let Qe=null;try{const Ct=Vo(_e),Pr=st($e(ye,"pacientes"),gn("nombre_busqueda"),$I(Ct),BI(Ct+""),va(1)),dr=await pn(Pr);if(!dr.empty){const Is=dr.docs[0],On=Is.data()||{};Qe={id:Is.id,ref:Is.ref,nombre:On.nombreCompleto||On.paciente||[On.nombres,On.apellidos].filter(Boolean).join(" "),cel:On.celularPaciente||On.celular||"",tel:On.telefonoPaciente||On.telefono||""}}}catch{}Qe?(M=Qe.id,X=Qe.ref,te=Qe.nombre||_e,Ne=Qe.cel||"",nt=Qe.tel||""):te=_e}else{const Qe=$t.docs[0],Ct=Qe.data()||{};M=Qe.id,X=Qe.ref,te=Ct.nombreCompleto||Ct.paciente||[Ct.nombres,Ct.apellidos].filter(Boolean).join(" ")||_e,Ne=Ct.celularPaciente||Ct.celular||"",nt=Ct.telefonoPaciente||Ct.telefono||""}}if(!(Ne||nt||"").trim()){alert(" Este paciente no tiene ningn telfono registrado. Edita sus datos y agrega un nmero antes de guardar la cita.");return}const Rr={paciente:te||"Paciente",pacienteId:M||null,doctor:Fe,fecha:Ce,horaInicio:ze,espacio:De,comentario:be,estado:"En espera",creado:new Date().toISOString(),celularPaciente:Ne||"",telefonoPaciente:nt||""},xn=await oa($e(ye,"citas"),Rr);X&&await xh(X,{citas:qM(xn.id)},{merge:!0}),alert(" Cita registrada correctamente y vinculada al paciente."),U.remove()}catch(M){console.error(" Error al guardar cita:",M),alert(" Error al guardar la cita. Revisa la consola para ms detalles.")}})},Xe=U=>{var it,Se;const ne=document.createElement("div");Object.assign(ne.style,{position:"fixed",top:"0",left:"0",width:"100%",height:"100%",background:"rgba(0,0,0,0.55)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:"9999"});const ce=document.createElement("div");Object.assign(ce.style,{background:"#fff",padding:"25px 30px",borderRadius:"14px",width:"520px",maxWidth:"95%",maxHeight:"95%",overflowY:"auto",boxShadow:"0 8px 30px rgba(0,0,0,0.3)",fontFamily:"Segoe UI, Roboto, sans-serif"});const xe=(it=U.raw)!=null&&it.fecha&&typeof U.raw.fecha=="string"?U.raw.fecha:Fp(U.fecha),Te=((Se=U.raw)==null?void 0:Se.horaInicio)||U.fecha.toTimeString().slice(0,5);ce.innerHTML=`
      <h2 style="margin-top:0;text-align:center;color:#0a86d8;font-weight:600;"> Editar Cita</h2>
      <form id="formEditarCita" style="display:flex;flex-direction:column;gap:12px;margin-top:10px;">
        <label>Paciente</label>
        <input type="text" id="editPaciente" value="${U.paciente||""}" />

        <label>Doctor asignado</label>
        <input type="text" id="editDoctor" value="${U.doctor||""}" />

        <div style="display:flex;gap:8px;">
          <div style="flex:1;">
            <label>Fecha</label>
            <input type="date" id="editFecha" value="${xe}" />
          </div>
          <div style="flex:1;">
            <label>Hora</label>
            <input type="time" id="editHora" value="${Te}" />
          </div>
        </div>

        <label>Espacio fsico / Sala</label>
        <input type="text" id="editEspacio" value="${U.espacio||""}" />

        <label>Estado</label>
        <select id="editEstado" class="estado-select">
          <option value="En espera" ${U.estado==="En espera"?"selected":""}>En espera</option>
          <option value="En sala" ${U.estado==="En sala"?"selected":""}>En sala</option>
          <option value="Atendiendo" ${U.estado==="Atendiendo"?"selected":""}>Atendiendo</option>
          <option value="Finalizada" ${U.estado==="Finalizada"?"selected":""}>Finalizada</option>
          <option value="pendiente" ${U.estado==="pendiente"?"selected":""}>Pendiente</option>
          <option value="No asisti" ${U.estado==="No asisti"?"selected":""}>No asisti</option>
        </select>

        <label>Comentario</label>
        <textarea id="editComentario" rows="3">${U.comentario||""}</textarea>

        <div style="display:flex;justify-content:flex-end;gap:10px;margin-top:10px;">
          <button type="button" id="btnCancelarEdit" class="btn-cancelar">Cancelar</button>
          <button type="submit" class="btn-guardar">Guardar cambios</button>
        </div>
      </form>
    `;const je=document.createElement("style");je.textContent=`
      .btn-cancelar, .btn-guardar { padding: 8px 14px; border: none; border-radius: 6px; cursor: pointer; font-weight: 600; font-size: 14px; transition: .2s; }
      .btn-cancelar { background: #e0e0e0; color: #333; } .btn-cancelar:hover { background: #d5d5d5; }
      .btn-guardar { background: #0a86d8; color: white; } .btn-guardar:hover { background: #0669ac; }
      #formEditarCita input, #formEditarCita select, #formEditarCita textarea { width: 100%; padding: 8px 10px; border: 1px solid #ccc; border-radius: 6px; font-size: 14px; outline: none; }
      #formEditarCita input:focus, #formEditarCita select:focus, #formEditarCita textarea:focus { border-color: #0a86d8; box-shadow: 0 0 0 2px rgba(10,134,216,.2); }
    `,document.head.appendChild(je),ne.appendChild(ce),document.body.appendChild(ne),ce.querySelector("#btnCancelarEdit").addEventListener("click",()=>ne.remove());const we=ce.querySelector("#formEditarCita");we.addEventListener("submit",async ie=>{ie.preventDefault();const Pe=we.querySelector("#editPaciente").value.trim(),Me=we.querySelector("#editDoctor").value.trim(),He=we.querySelector("#editFecha").value,H=we.querySelector("#editHora").value,se=we.querySelector("#editEspacio").value.trim(),q=we.querySelector("#editEstado").value,re=we.querySelector("#editComentario").value.trim();if(!Pe)return alert(" El nombre del paciente es obligatorio.");if(!He||!H)return alert(" Debes indicar fecha y hora.");try{const ae=Yt(ye,"citas",U.id);await _a(ae,{paciente:Pe,doctor:Me,fecha:He,horaInicio:H,espacio:se,estado:q,comentario:re}),alert(" Cita actualizada correctamente."),ne.remove()}catch(ae){console.error(" Error al actualizar cita:",ae),alert(" Error al actualizar la cita. Revisa la consola para ms detalles.")}})},Dt=U=>{const ne=U.fecha.toLocaleDateString(bn),ce=U.fecha.toLocaleTimeString(bn,{hour:"numeric",minute:"2-digit",hour12:!0}),xe=`${ne}  ${ce}`;return c.jsxs("tr",{className:"fade-in-row",onClick:()=>Xe(U),style:{cursor:"pointer"},children:[c.jsx("td",{children:xe}),c.jsx("td",{children:U.paciente}),c.jsx("td",{children:U.doctor}),c.jsx("td",{children:U.espacio}),c.jsx("td",{children:U.comentario}),c.jsx("td",{onClick:Te=>{Te.stopPropagation()},children:c.jsxs("select",{className:"estado-select",value:U.estado,onChange:Te=>Z(U.id,Te.target.value),children:[c.jsx("option",{value:"En espera",children:"En espera"}),c.jsx("option",{value:"En sala",children:"En sala"}),c.jsx("option",{value:"Atendiendo",children:"Atendiendo"}),c.jsx("option",{value:"Finalizada",children:"Finalizada"}),c.jsx("option",{value:"pendiente",children:"Pendiente"}),c.jsx("option",{value:"No asisti",children:"No asisti"})]})}),c.jsxs("td",{className:"acciones-cell",onClick:Te=>{Te.stopPropagation()},children:[U.telefono?c.jsx("button",{type:"button",className:"btn-whatsapp",onClick:Te=>{Te.stopPropagation(),de(U.telefono,U)},children:"WhatsApp"}):c.jsx("span",{className:"acciones-texto",children:"Sin celular"}),c.jsx("button",{type:"button",className:"btn-delete",onClick:Te=>{Te.stopPropagation(),pe(U)},children:"Eliminar"}),U.recordatorio&&c.jsx("span",{className:"acciones-texto",children:U.recordatorio})]})]},U.id)};return c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"odc-topbar-green"}),c.jsx("div",{className:"odc-topbar-blue",children:"Agenda"}),c.jsx("section",{className:"odc-agenda-root",children:c.jsxs("div",{className:"odc-agenda-inner",children:[c.jsxs("aside",{className:"odc-left","aria-label":"Panel izquierdo - calendario y filtros",children:[c.jsxs("div",{className:"odc-mini-calendar-card",role:"region","aria-label":"Mini calendario",children:[c.jsxs("div",{className:"mini-cal-header",children:[c.jsx("button",{className:"cal-arrow",id:"miniCalPrev","aria-label":"Mes anterior",onClick:B,children:""}),c.jsx("div",{id:"miniCalMonthYear","aria-live":"polite",children:y}),c.jsx("button",{className:"cal-arrow",id:"miniCalNext","aria-label":"Mes siguiente",onClick:w,children:""})]}),c.jsxs("table",{className:"mini-month-table","aria-hidden":"false",children:[c.jsx("thead",{children:c.jsxs("tr",{children:[c.jsx("th",{children:"Lu"}),c.jsx("th",{children:"Ma"}),c.jsx("th",{children:"Mi"}),c.jsx("th",{children:"Ju"}),c.jsx("th",{children:"Vi"}),c.jsx("th",{children:"Sa"}),c.jsx("th",{children:"Do"})]})}),c.jsx("tbody",{id:"miniCalendar",children:L.map((U,ne)=>c.jsx("tr",{children:U.map((ce,xe)=>c.jsx("td",{className:[ce.isCurrentMonth?"":"empty",ce.isToday?"today":"",ce.isSelected?"selected":""].filter(Boolean).join(""),onClick:()=>ce.isCurrentMonth&&_(ce.date),children:ce.date.getDate()},xe))},ne))})]})]}),c.jsxs("div",{className:"odc-filters-card","aria-label":"Filtros de agenda",children:[c.jsx("label",{htmlFor:"filterSucursal",children:"Sucursal"}),c.jsxs("select",{id:"filterSucursal",value:f,onChange:U=>m(U.target.value),children:[c.jsx("option",{value:"",children:" Todas "}),E.map(U=>c.jsx("option",{value:U,children:U},U))]}),c.jsx("label",{htmlFor:"filterDoctor",children:"Doctores"}),c.jsxs("select",{id:"filterDoctor",value:v,onChange:U=>R(U.target.value),children:[c.jsx("option",{value:"",children:" Todos "}),I.map(U=>c.jsx("option",{value:U,children:U},U))]})]})]}),c.jsxs("main",{className:"odc-right","aria-label":"Panel principal - agenda",children:[c.jsxs("div",{className:"odc-header-bar",role:"region","aria-label":"Controles de la agenda",style:{display:"flex",alignItems:"center",justifyContent:"space-between",gap:12},children:[c.jsxs("div",{className:"odc-header-left",style:{display:"flex",alignItems:"center",gap:12,flexWrap:"wrap"},children:[c.jsx("h3",{className:"odc-title",style:{marginRight:8},children:"Agenda"}),c.jsxs("div",{className:"view-buttons",role:"tablist","aria-label":"Vistas",style:{display:"flex",gap:6},children:[c.jsx("button",{className:`btn view ${e==="day"?"active":""}`,"data-view":"day",role:"tab","aria-selected":e==="day",onClick:()=>n("day"),children:"Da"}),c.jsx("button",{className:`btn view ${e==="week"?"active":""}`,"data-view":"week",role:"tab","aria-selected":e==="week",onClick:()=>n("week"),children:"Semana"}),c.jsx("button",{className:`btn view ${e==="detail"?"active":""}`,"data-view":"detail",role:"tab","aria-selected":e==="detail",onClick:()=>n("detail"),children:"Detalle"})]}),c.jsxs("div",{className:"date-nav",style:{display:"flex",alignItems:"center",gap:6,flex:"0 0 auto"},children:[c.jsx("button",{className:"btn icon",id:"btnPrev","aria-label":"Anterior",onClick:D,children:""}),c.jsx("button",{className:"btn icon",id:"btnNext","aria-label":"Siguiente",onClick:j,children:""}),c.jsx("span",{id:"currentDateDisplay",className:"current-date","aria-live":"polite",style:{whiteSpace:"nowrap"},children:N}),c.jsx("button",{id:"btnHoy",className:"btn small",onClick:k,children:"Hoy"})]})]}),c.jsx("div",{className:"odc-header-right",style:{display:"flex",alignItems:"center",gap:8,flexShrink:0},children:c.jsxs("div",{className:"right-actions",style:{display:"flex",alignItems:"center",gap:8},children:[c.jsx("input",{id:"searchCitas",placeholder:"Buscar...",className:"search-input","aria-label":"Buscar citas",value:T,onChange:U=>P(U.target.value)}),c.jsx("button",{id:"btnNuevaCita",className:"btn green","aria-label":"Nueva cita",onClick:Re,children:"+ Nueva cita"})]})})]}),c.jsxs("div",{className:"odc-content-card",role:"region","aria-label":"Contenido agenda",children:[c.jsxs("div",{className:"tools-row",children:[c.jsx("div",{className:"tools-left",children:c.jsx("div",{id:"ocupacionInfo",className:"ocupacion-info",children:b})}),c.jsxs("div",{className:"tools-right",children:[c.jsx("button",{id:"btnPrint",className:"btn",title:"Imprimir agenda",onClick:K,children:" Imprimir"}),c.jsx("button",{id:"btnConfirmar",className:"btn blue",title:"Confirmar citas",onClick:Ke,children:" Confirmar"}),c.jsx("button",{id:"btnHoyCitas",className:"btn",title:"Ver citas de hoy",onClick:Ft,children:" Hoy"}),c.jsx("button",{id:"btnExportar",className:"btn",title:"Exportar citas a CSV",onClick:dn,children:" Exportar"})]})]}),c.jsx("div",{className:"table-wrap",role:"region","aria-label":"Lista de citas",children:c.jsxs("table",{className:"appointments-table","aria-live":"polite",children:[c.jsx("thead",{children:c.jsxs("tr",{children:[c.jsx("th",{style:{width:"180px"},children:"Fecha / Hora"}),c.jsx("th",{children:"Paciente"}),c.jsx("th",{children:"Doctor"}),c.jsx("th",{children:"Espacio fsico"}),c.jsx("th",{children:"Comentario"}),c.jsx("th",{style:{width:"120px"},children:"Estado"}),c.jsx("th",{children:"Acciones"})]})}),c.jsx("tbody",{id:"citasTbody",children:a?c.jsx("tr",{children:c.jsx("td",{colSpan:7,className:"no-data",children:"Cargando citas..."})}):S.length===0?c.jsx("tr",{children:c.jsx("td",{colSpan:7,className:"no-data",children:"No hay citas registradas para este rango."})}):S.map(Dt)})]})})]})]})]})})]})}function VU(){return c.jsxs("div",{style:{padding:"20px"},children:[c.jsx("h2",{children:"Mdulo de Facturacin"}),c.jsx("p",{children:"Aqu se registrarn los pagos, facturas y cobros."})]})}function LU(){return c.jsxs("div",{style:{padding:"20px"},children:[c.jsx("h2",{children:"Mdulo de Facturacin"}),c.jsx("p",{children:"Aqu se registrarn los pagos, facturas y cobros."})]})}function MU(){return c.jsxs("div",{style:{padding:"20px"},children:[c.jsx("h2",{children:"Mdulo de Facturacin"}),c.jsx("p",{children:"Aqu se registrarn los pagos, facturas y cobros."})]})}const Gu={caja:"caja",pagos:"facturacion/pagos",facturas:"facturacion/facturas"};var Tx;const Fl=typeof navigator<"u"&&((Tx=navigator.language)!=null&&Tx.startsWith("es"))?"es-ES":"en-US",FU=["Colombia","Argentina","Bolivia","Chile","Costa Rica","Cuba","Ecuador","El Salvador","Espaa","Guatemala","Honduras","Mxico","Nicaragua","Panam","Paraguay","Per","Puerto Rico","Repblica Dominicana","Uruguay","Venezuela","Estados Unidos","Canad"],Up={Colombia:["Bogot","Medelln","Cali","Barranquilla","Cartagena","Ccuta","Bucaramanga","Pereira","Santa Marta","Ibagu"],Mxico:["Ciudad de Mxico","Guadalajara","Monterrey","Puebla","Quertaro","Tijuana","Mrida","Len"],Per:["Lima","Arequipa","Trujillo","Chiclayo","Cusco","Piura"],Chile:["Santiago","Valparaso","Concepcin","La Serena","Antofagasta"],Argentina:["Buenos Aires","Crdoba","Rosario","Mendoza","La Plata"],Espaa:["Madrid","Barcelona","Valencia","Sevilla","Zaragoza","Bilbao"],"Estados Unidos":["Miami","New York","Los ngeles","Houston","Chicago"],Ecuador:["Quito","Guayaquil","Cuenca","Manta"],Venezuela:["Caracas","Maracaibo","Valencia","Barquisimeto","Maracay"]},UU=t=>{if(!t)return"";const[e,n,r]=t.split("-").map(l=>parseInt(l,10)),s=new Date(e,(n||1)-1,r||1),i=new Date;let o=i.getFullYear()-s.getFullYear();const a=i.getMonth()-s.getMonth();return(a<0||a===0&&i.getDate()<s.getDate())&&o--,isNaN(o)?"":String(o)};async function gx(t,{maxW:e=900,maxH:n=900,quality:r=.82}={}){var m;if(!t||!((m=t.type)!=null&&m.startsWith("image/")))return t;const s=await new Promise((v,R)=>{const T=new Image;T.onload=()=>v(T),T.onerror=R,T.src=URL.createObjectURL(t)});let{width:i,height:o}=s;const a=Math.min(e/i,n/o,1);i=Math.round(i*a),o=Math.round(o*a);const l=document.createElement("canvas");l.width=i,l.height=o,l.getContext("2d").drawImage(s,0,0,i,o);const h=await new Promise(v=>l.toBlob(v,"image/jpeg",r)),f=new File([h],(t.name||"foto.jpg").replace(/\.[^.]+$/,".jpg"),{type:"image/jpeg",lastModified:Date.now()});return URL.revokeObjectURL(s.src),f}const Ul=t=>(t||"").toString().toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/\s+/g," ").trim(),$U=t=>Ul([t.nombres,t.apellidos,t.nombreCompleto,t.nroDocumento,t.celular,t.email].filter(Boolean).join(" ")),BU=t=>{if(!t)return"";const e=new Date(t),n=e.getFullYear(),r=String(e.getMonth()+1).padStart(2,"0"),s=String(e.getDate()).padStart(2,"0"),i=String(e.getHours()).padStart(2,"0"),o=String(e.getMinutes()).padStart(2,"0");return`${n}-${r}-${s}T${i}:${o}`},zU=t=>{try{return new Date(t).toLocaleString(Fl,{dateStyle:"medium",timeStyle:"short"})}catch{return""}},Lo={tipoDocumento:"",nroDocumento:"",nroHistoria:"",nombres:"",apellidos:"",nombreCompleto:"",sexo:"",estadoCivil:"",paisNacimiento:"",ciudadNacimiento:"",fechaIngreso:"",fechaNacimiento:"",edad:"",paisDomicilio:"",ciudadDomicilio:"",barrio:"",lugarResidencia:"",estrato:"",zonaResidencial:"",esExtranjero:!1,permitePublicidad:!1,celular:"",telDomicilio:"",telOficina:"",extension:"",email:"",ocupacion:"",nombreResponsable:"",parentesco:"",celularResponsable:"",telefonoResponsable:"",emailResponsable:"",nombreAcompanante:"",telefonoAcompanante:"",convenioBeneficio:"",comoConocio:"",campania:"",remitidoPor:"",asesorComercial:"",tipoVinculacion:"",nombreEps:"",polizaSalud:"",doctor:"",notas:"",rxImagenes:[],historiaClinica:{antecedentes:"",alergias:"",medicamentos:"",motivoConsulta:"",notas:""},odontograma:[],periodontograma:[],presupuestos:[],evoluciones:[],facturacion:{saldoFavor:0,saldoCredito:0},fotoUrl:"",activo:!0},$p=20,Mo=t=>Number(t||0);function qU(t){const[e,n]=A.useState(!1),[r,s]=A.useState([]),[i,o]=A.useState([]),[a,l]=A.useState("");A.useEffect(()=>{let P=!0;return(async()=>{if(!t){s([]),o([]);return}n(!0),l("");try{let I=st($e(ye,"facturas"),Je("patientId","==",t),gn("fechaISO","desc"));const L=(await pn(I)).docs.map(N=>({id:N.id,...N.data()})).map(N=>({...N,total:Mo(N.total??N.valor??N.montoTotal),estado:(N.estado||"pendiente").toLowerCase(),fechaISO:N.fechaISO||N.fecha||null}));let B=st($e(ye,"pagos"),Je("patientId","==",t),gn("fechaISO","desc"));const y=(await pn(B)).docs.map(N=>({id:N.id,...N.data()})).map(N=>({...N,monto:Mo(N.monto??N.valor??N.total),fechaISO:N.fechaISO||N.fecha||null,medio:N.medio||N.metodo||""}));if(!P)return;s(L),o(y)}catch(I){console.warn("Finanzas: no se pudo leer colecciones. Contino solo con saldos del paciente.",I),P&&l("No se pudieron leer facturas/pagos.")}finally{P&&n(!1)}})(),()=>{P=!1}},[t]);const d=r.reduce((P,E)=>P+Mo(E.total),0),h=i.reduce((P,E)=>P+Mo(E.monto),0),f=r.filter(P=>["pagada","pagado","paid"].includes((P.estado||"").toLowerCase())),m=r.filter(P=>["pendiente","abierta","open","deuda"].includes((P.estado||"").toLowerCase())),v=f.reduce((P,E)=>P+Mo(E.total),0),R=m.reduce((P,E)=>P+Mo(E.total),0);return{loading:e,error:a,facturas:r,pagos:i,totalFacturado:d,totalPagado:h,totalFacturasPendientes:R,totalFacturasPagadas:v}}function HU(t){const[e,n]=A.useState(!1),[r,s]=A.useState([]);return A.useEffect(()=>{if(!t){s([]);return}n(!0);const i=$e(ye,"citas"),o=v=>{const R=v.data()||{},T=typeof R.fecha=="string"?R.fecha:"",P=(R.horaInicio||R.hora||"00:00").slice(0,5);let E=null;if(T){const[I,S,b]=T.split("-").map(_=>parseInt(_,10)),[L,B]=P.split(":").map(_=>parseInt(_,10)||0);E=new Date(I,(S||1)-1,b||1,L,B,0,0).toISOString()}return{id:v.id,...R,fechaISO:E,motivo:R.motivo||R.comentario||"",profesional:R.doctor||R.doctorNombre||"",fechaYYYYMMDD:T}};let a=new Map;const l=()=>{const v=Array.from(a.values());v.sort((R,T)=>{const P=R.fechaISO||"",E=T.fechaISO||"";if(P<E)return 1;if(P>E)return-1;const I=R.creado||"",S=T.creado||"";return I<S?1:I>S?-1:0}),s(v),n(!1)},d=st(i,Je("pacienteId","==",t)),h=st(i,Je("patientId","==",t)),f=Fn(d,v=>{v.docChanges().forEach(R=>{R.type==="removed"?a.delete(R.doc.id):a.set(R.doc.id,o(R.doc))}),l()},()=>n(!1)),m=Fn(h,v=>{v.docChanges().forEach(R=>{R.type==="removed"?a.delete(R.doc.id):a.set(R.doc.id,o(R.doc))}),l()},()=>n(!1));return()=>{try{f()}catch{}try{m()}catch{}}},[t]),{loading:e,citas:r}}function WU(){var Pr,dr,Is,On,Yr,lu,cu,Ti,nl;const t=Ka(),e=Kn(),n=Ox.useMemo(()=>{const x=e.pathname.split("/").filter(Boolean),z=x.findIndex(me=>["pacientes","agenda","caja","facturacion","config","reportes","software"].includes(me)),ue="/"+x.slice(0,z>=0?z:x.length).join("/");return ue==="/"?"":ue},[e.pathname]),r=x=>{const z=String(x||"").replace(/^\//,""),Y=n?`${n}/`:"/";t(`${Y}${z}`)},s=(x,z)=>{const Y=String(x).replace(/^\//,""),ue=z?new URLSearchParams(z).toString():"";return`${n?`${n}/`:"/"}${Y}${ue?`?${ue}`:""}`},i=(x,z)=>{const Y=String(x||"").slice(0,10);if(!Y)return r("agenda");try{sessionStorage.setItem("agenda.targetDate",Y)}catch{}const ue=new URLSearchParams({date:Y,day:Y,d:Y,fecha:Y,selectedDate:Y,ts:String(new Date(Y+"T00:00:00").getTime()),patientId:z||""}).toString();r(`agenda?${ue}`)},[o,a]=A.useState(!0),[l,d]=A.useState([]),[h,f]=A.useState(""),[m,v]=A.useState(null),[R,T]=A.useState(!0),[P,E]=A.useState(!1),[I,S]=A.useState(null),[b,L]=A.useState(null),B=A.useRef(null),[w,_]=A.useState("datos"),[y,N]=A.useState(Lo),[D,j]=A.useState(null),[k,K]=A.useState(""),[Ke,Ft]=A.useState([]),[dn,Z]=A.useState(!1),de=A.useRef(null),pe="comfy",[Re,Xe]=A.useState(""),Dt=A.useMemo(()=>{switch(pe){case"comfy":return{thumbW:220,thumbH:165,colMin:240};case"cozy":return{thumbW:160,thumbH:120,colMin:180};default:return{thumbW:120,thumbH:90,colMin:140}}},[pe]),U=x=>{var Y,ue;if((ue=(Y=x==null?void 0:x.type)==null?void 0:Y.startsWith)!=null&&ue.call(Y,"image/"))return!0;const z=((x==null?void 0:x.name)||(x==null?void 0:x.title)||"").toLowerCase();return/\.(png|jpe?g|gif|bmp|webp|tiff?)$/.test(z)},ne=A.useMemo(()=>{const x=Re.trim().toLowerCase(),z=Array.isArray(b==null?void 0:b.rxImagenes)?b.rxImagenes:[];let Y=z;return x?Y=z.filter(ue=>`${ue.name||""} ${ue.title||""} ${ue.desc||""}`.toLowerCase().includes(x)):Y=z.slice(),Y.sort((ue,me)=>{const Ge=ue.uploadedAtMS??ue.created??0;return(me.uploadedAtMS??me.created??0)-Ge}),Y},[b==null?void 0:b.rxImagenes,Re]),ce=async(x,z)=>{if(!(b!=null&&b.id))return;const Y=Array.isArray(b.rxImagenes)?[...b.rxImagenes]:[];Y[x]={...Y[x]||{},...z},await te({rxImagenes:Y})},xe=()=>{const x=new Date,z=x.getFullYear(),Y=String(x.getMonth()+1).padStart(2,"0"),ue=String(x.getDate()).padStart(2,"0");return`${z}-${Y}-${ue}`},[Te,je]=A.useState(xe()),[we,it]=A.useState(""),[Se,ie]=A.useState(""),[Pe,Me]=A.useState(""),[He,H]=A.useState("");A.useEffect(()=>{ie((b==null?void 0:b.doctor)||"")},[b==null?void 0:b.doctor,b==null?void 0:b.id]);const se=async()=>{if(!(b!=null&&b.id))return alert("Paciente no cargado.");if(!Te)return alert("Selecciona la fecha.");if(!we)return alert("Selecciona la hora.");if(!Se.trim())return alert("Indica el doctor.");const x=b.nombreCompleto||b.paciente||"Paciente",z=b.celular||b.celularPaciente||"",Y=b.telDomicilio||b.telefonoPaciente||"";if(!z&&!Y)return alert("Este paciente no tiene telfono registrado (celular o fijo). Agrega uno antes de crear la cita.");try{const ue={paciente:x,pacienteId:b.id,doctor:Se.trim(),fecha:Te,horaInicio:we,espacio:Pe||"",comentario:He||"",estado:"En espera",creado:new Date().toISOString(),celularPaciente:z,telefonoPaciente:Y};await oa($e(ye,"citas"),ue),it(""),Me(""),H(""),alert(" Cita creada. Ya aparece en la lista y en Agenda.")}catch(ue){console.error("Error creando cita:",ue),alert("No se pudo crear la cita.")}};A.useMemo(()=>Up[y.paisNacimiento]||[],[y.paisNacimiento]),A.useEffect(()=>((async()=>{a(!0);try{const Y=(await pn($e(ye,"eps"))).docs.map(me=>{var Ge;return(Ge=me.data())==null?void 0:Ge.nombre}).filter(Boolean),ue=Array.from(new Map(Y.map(me=>[String(me).toLowerCase(),me])).values()).sort((me,Ge)=>me.localeCompare(Ge,"es"));Ft(ue),await ge(!0)}catch(z){console.error(z),alert("No se pudieron cargar pacientes/EPS.")}finally{a(!1)}})(),()=>{B.current&&(B.current(),B.current=null)}),[]),A.useEffect(()=>{N(x=>({...x,nombreCompleto:`${x.nombres} ${x.apellidos}`.trim()}))},[y.nombres,y.apellidos]),A.useEffect(()=>{N(x=>({...x,nroHistoria:x.nroDocumento}))},[y.nroDocumento]),A.useEffect(()=>{N(x=>({...x,edad:UU(x.fechaNacimiento)}))},[y.fechaNacimiento]),A.useEffect(()=>{const x=new Date,z=x.toLocaleDateString(Fl)+" - "+x.toLocaleTimeString(Fl,{hour:"2-digit",minute:"2-digit",hour12:!0});N(Y=>({...Y,fechaIngreso:z}))},[]);const q=(x,z)=>N(Y=>({...Y,[x]:z})),re=()=>{N(Lo);const x=new Date,z=x.toLocaleDateString(Fl)+" - "+x.toLocaleTimeString(Fl,{hour:"2-digit",minute:"2-digit",hour12:!0});N(Y=>({...Y,fechaIngreso:z})),j(null),K(""),S(null)},ae=async x=>{if(!x){j(null),K("");return}try{const z=await gx(x,{maxW:900,maxH:900,quality:.82});j(z);const Y=new FileReader;Y.onload=ue=>K(ue.target.result),Y.readAsDataURL(z)}catch{j(x);const z=new FileReader;z.onload=Y=>K(Y.target.result),z.readAsDataURL(x)}},ge=async(x=!1)=>{a(!0);try{let z;x||!m?z=st($e(ye,"pacientes"),gn("creado","desc"),va($p)):z=st($e(ye,"pacientes"),gn("creado","desc"),MM(m),va($p));const Y=await pn(z),ue=Y.docs.map(me=>({id:me.id,...me.data()}));d(x?ue:me=>[...me,...ue]),v(Y.docs[Y.docs.length-1]||null),T(Y.size===$p)}catch(z){console.error(z),alert("No se pudo cargar pacientes.")}finally{a(!1)}},_e=async x=>{if(x.preventDefault(),!y.nroDocumento.trim())return alert("El nmero de documento es obligatorio.");if(!y.nombres.trim())return alert("Los nombres son obligatorios.");if(!y.apellidos.trim())return alert("Los apellidos son obligatorios.");if(!y.sexo.trim())return alert("El sexo es obligatorio.");if(!y.fechaNacimiento.trim())return alert("La fecha de nacimiento es obligatoria.");if(!y.celular.trim())return alert("El celular es obligatorio.");if(!y.email.trim())return alert("El correo electrnico es obligatorio.");if(!y.tipoVinculacion.trim())return alert("El tipo de vinculacin es obligatorio.");if(!y.nombreEps.trim())return alert("El nombre de la EPS es obligatorio.");try{const z=y.nroDocumento.trim();if(!I&&(await Ih(Yt(ye,"pacientes",z))).exists())return alert("Ya existe un paciente con ese nmero de documento.");const Y=(y.nombreEps||"").trim(),ue=Ke.map(At=>At.toLowerCase()).includes(Y.toLowerCase());if(Y&&!ue&&window.confirm(`La EPS "${Y}" no existe. Deseas guardarla para futuras selecciones?`)){const Tn=Y.toLowerCase().replace(/\s+/g,"_");await xh(Yt(ye,"eps",Tn),{nombre:Y,nombreLower:Y.toLowerCase(),creado:Xn()},{merge:!0})}let me=y.fotoUrl||"",Ge="";if(D)try{const At=Fi(),Tn=(D.name||"foto.jpg").replace(/\s+/g,"_");Ge=`pacientes/${z}/${Date.now()}_${Tn}`;const Sn=Cl(At,Ge),hr={contentType:D.type||"image/jpeg",cacheControl:"public, max-age=86400"};await JI(Sn,D,hr),me=await ex(Sn)}catch(At){console.error("Foto (warning):",At)}const Nr=y.creado||null,Qn=I&&Nr||Xn(),Yn={...y,fotoUrl:me,nombre_busqueda:$U({...y,fotoUrl:me}),nombresLower:Ul(y.nombres),apellidosLower:Ul(y.apellidos),documentoLower:Ul(y.nroDocumento),emailLower:Ul(y.email),creado:Qn,createdAt:Qn,actualizado:Xn(),updatedAt:Xn(),activo:y.activo??!0,celularPaciente:y.celular,telefonoPaciente:y.telDomicilio||"",documento:y.nroDocumento,paciente:y.nombreCompleto};if(await xh(Yt(ye,"pacientes",z),Yn,{merge:!0}),Ge)try{const At=Fi(),Tn=Cl(At,`pacientes/${z}`),Sn=await ZI(Tn),hr=Ge,Xr=Sn.items.filter(Jr=>Jr.fullPath!==hr).map(Jr=>Dp(Jr).catch(()=>null));await Promise.allSettled(Xr)}catch(At){console.warn("No se pudo limpiar fotos antiguas:",At)}alert(I?" Paciente actualizado.":" Paciente guardado."),d(At=>{const Tn=At.filter(Sn=>Sn.id!==z);return[{id:z,...Yn},...Tn]}),E(!1),S(null),re()}catch(z){console.error("Error guardando paciente:",z),alert(`No se pudo guardar el paciente.

`+((z==null?void 0:z.message)||z))}},Fe=()=>{re(),E(!0)},Ce=()=>{b&&(N({...Lo,...b,fotoUrl:b.fotoUrl||""}),j(null),K(b.fotoUrl||""),S(b.id),M(),E(!0))},ze=async x=>{if(window.confirm(`Eliminar al paciente "${x.nombreCompleto}"?`))try{await fA(Yt(ye,"pacientes",x.id)),d(z=>z.filter(Y=>Y.id!==x.id));try{const z=Fi(),Y=Cl(z,`pacientes/${x.id}`),me=(await ZI(Y)).items.map(Ge=>Dp(Ge).catch(()=>null));await Promise.allSettled(me)}catch(z){console.warn("No se pudo borrar la carpeta de fotos:",z)}}catch(z){console.error(z),alert("No se pudo eliminar.")}},De=A.useMemo(()=>{const x=h.trim().toLowerCase();return x?l.filter(z=>`${z.nombreCompleto||z.paciente||""} ${z.nroDocumento||""} ${z.celular||z.celularPaciente||""} ${z.email||""}`.toLowerCase().includes(x)):l},[l,h]),be=x=>{M();const z=Yt(ye,"pacientes",x.id),Y=Fn(z,ue=>{ue.exists()?L({id:ue.id,...X(ue.data())}):L(null)});B.current=Y,_("datos")},M=()=>{B.current&&(B.current(),B.current=null),L(null)},X=x=>({...Lo,...x,historiaClinica:{...Lo.historiaClinica,...x.historiaClinica||{}},facturacion:{...Lo.facturacion,...x.facturacion||{}},rxImagenes:Array.isArray(x.rxImagenes)?x.rxImagenes:[],odontograma:Array.isArray(x.odontograma)?x.odontograma:[],periodontograma:Array.isArray(x.periodontograma)?x.periodontograma:[],presupuestos:Array.isArray(x.presupuestos)?x.presupuestos:[],evoluciones:Array.isArray(x.evoluciones)?x.evoluciones:[]}),te=async x=>{if(b!=null&&b.id)try{await _a(Yt(ye,"pacientes",b.id),{...x,actualizado:Xn(),updatedAt:Xn()})}catch(z){console.error(z),alert("No se pudo actualizar.")}},Ne=async x=>{var Y;if(!(b!=null&&b.id)||!(x!=null&&x.length))return;const z=Fi();try{Z(!0);const ue=[];for(const me of x){let Ge=me;if((Y=me.type)!=null&&Y.startsWith("image/"))try{Ge=await gx(me,{maxW:1600,maxH:1600,quality:.85})}catch{Ge=me}const Nr=(Ge.name||"archivo").replace(/\s+/g,"_"),Qn=`pacientes/${b.id}/rx/${Date.now()}_${Nr}`,Yn=Cl(z,Qn),At={contentType:Ge.type||"application/octet-stream",cacheControl:"public, max-age=31536000"};await JI(Yn,Ge,At);const Tn=await ex(Yn),Sn=new Date().toISOString(),hr=Date.now();ue.push({url:Tn,name:me.name,title:me.name.replace(/\.[^.]+$/,""),desc:"",type:me.type,size:me.size||0,created:hr,uploadedAtMS:hr,uploadedAtISO:Sn,path:Qn})}await te({rxImagenes:[...b.rxImagenes||[],...ue]})}catch(ue){console.error("RX upload error:",ue);const me=`No se pudo subir el/los archivo(s).
 Verifica que el usuario est autenticado.
 Revisa reglas de Storage para permitir escribir en 'pacientes/{id}/**'.
 Si usas Emulador, confirma que el bucket coincida.

`+((ue==null?void 0:ue.message)||"");alert(me)}finally{Z(!1);try{de.current&&(de.current.value="")}catch{}}},nt=async x=>{if(!(b!=null&&b.id))return;const z=b.rxImagenes[x],Y=b.rxImagenes.filter((ue,me)=>me!==x);await te({rxImagenes:Y});try{if(z!=null&&z.path){const ue=Fi();await Dp(Cl(ue,z.path))}}catch(ue){console.warn("No se pudo borrar del Storage:",ue)}},St=(x,z)=>{const Y={...b.historiaClinica||{},[x]:z};te({historiaClinica:Y})},Rr=x=>{const z=[...b.presupuestos||[],{id:String(Date.now()),...x}];te({presupuestos:z})},xn=x=>{te({presupuestos:(b.presupuestos||[]).filter(z=>z.id!==x)})},jn=x=>{const z=[...b.evoluciones||[],{id:String(Date.now()),fechaISO:new Date().toISOString(),nota:x}];te({evoluciones:z})},Zt=x=>{te({evoluciones:(b.evoluciones||[]).filter(z=>z.id!==x)})},bt=(x,z)=>{const Y=Array.isArray(b[x])?b[x]:[],ue=Y.find(Ge=>Ge.pieza===z);let me;ue?me=Y.filter(Ge=>Ge.pieza!==z):me=[...Y,{pieza:z,estado:"marcada"}],te({[x]:me})},Ut=(b==null?void 0:b.id)||null,$t=qU(Ut),{loading:Qe,citas:Ct}=HU(Ut);return c.jsxs("div",{className:"odc-container",children:[c.jsx("div",{className:"odc-topbar-green"}),c.jsx("div",{className:"odc-topbar-blue",children:c.jsx("div",{className:"odc-top-inner",children:c.jsx("div",{className:"odc-breadcrumbs",children:"Pacientes"})})}),c.jsxs("div",{className:"odc-card",children:[c.jsxs("div",{className:"odc-card-header",children:[c.jsx("h3",{className:"odc-title",children:"Pacientes"}),c.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[c.jsx("input",{className:"search-input",style:{minWidth:280},placeholder:"Buscar por nombre, documento o telfono",value:h,onChange:x=>f(x.target.value)}),c.jsx("button",{type:"button",className:"btn green",onClick:Fe,children:"+ Nuevo paciente"})]})]}),c.jsx("div",{className:"table-wrap",children:c.jsxs("table",{className:"appointments-table",children:[c.jsx("thead",{children:c.jsxs("tr",{children:[c.jsx("th",{children:"Foto"}),c.jsx("th",{children:"Nombre"}),c.jsx("th",{children:"Documento"}),c.jsx("th",{children:"Celular"}),c.jsx("th",{children:"Correo"}),c.jsx("th",{children:"Estado"})]})}),c.jsx("tbody",{children:o&&l.length===0?c.jsx("tr",{children:c.jsx("td",{className:"no-data",colSpan:6,children:"Cargando"})}):De.length===0?c.jsx("tr",{children:c.jsx("td",{className:"no-data",colSpan:6,children:"No hay pacientes o no coinciden con la bsqueda."})}):De.map(x=>c.jsxs("tr",{className:"row-click",onClick:()=>be(x),children:[c.jsx("td",{onClick:z=>z.stopPropagation(),children:x.fotoUrl?c.jsx("img",{src:x.fotoUrl,alt:"Foto",style:{width:36,height:36,borderRadius:"50%",objectFit:"cover"}}):c.jsx("div",{className:"avatar-fallback",children:(x.nombreCompleto||"P")[0]})}),c.jsx("td",{children:x.nombreCompleto||x.paciente||""}),c.jsx("td",{children:x.nroDocumento||x.documento||""}),c.jsx("td",{children:x.celular||x.celularPaciente||""}),c.jsx("td",{children:x.email||""}),c.jsx("td",{children:c.jsx("span",{className:"pill pill-ok",children:x.activo?"Activo":"Inactivo"})})]},x.id))})]})}),c.jsxs("div",{className:"footer-actions",children:[c.jsx("button",{type:"button",className:"btn",disabled:o||!R,onClick:()=>ge(!1),children:R?"Cargar ms":"No hay ms"}),c.jsxs("div",{className:"hint",children:[l.length," registros cargados"]})]})]}),P&&c.jsxs("div",{className:"odc-modal",role:"dialog","aria-modal":"true",children:[c.jsx("div",{className:"odc-modal-backdrop",onClick:()=>E(!1)}),c.jsxs("div",{className:"odc-card",style:{width:1e3,maxWidth:"95%",maxHeight:"92vh",overflowY:"auto"},children:[c.jsxs("div",{className:"odc-card-header",children:[c.jsx("h3",{className:"odc-title",children:I?"Editar paciente":"Nuevo paciente"}),c.jsx("button",{type:"button",className:"btn",onClick:()=>E(!1),children:""})]}),c.jsxs("form",{onSubmit:_e,children:[c.jsx("div",{className:"form-section-title",children:"Foto del paciente"}),c.jsxs("div",{className:"foto-row",children:[c.jsxs("label",{className:"foto-drop",children:[c.jsx("input",{type:"file",accept:"image/*",onChange:x=>{var z;return ae(((z=x.target.files)==null?void 0:z[0])||null)},style:{display:"none"}}),k?c.jsx("img",{src:k,alt:"Preview",className:"foto-preview"}):c.jsx("div",{className:"foto-empty",children:"Arrastra o haz clic para cargar"})]}),k&&c.jsx("button",{type:"button",className:"btn",onClick:()=>ae(null),children:"Quitar foto"})]}),c.jsx("div",{className:"form-section-title",children:"Datos de identificacin"}),c.jsxs("div",{className:"form-grid",children:[c.jsxs("div",{children:[c.jsx("label",{className:"form-label",children:"Tipo de documento *"}),c.jsxs("select",{className:"form-input",value:y.tipoDocumento,onChange:x=>q("tipoDocumento",x.target.value),children:[c.jsx("option",{value:"",children:"Seleccione"}),c.jsx("option",{value:"CC",children:"Cdula"}),c.jsx("option",{value:"TI",children:"Tarjeta de identidad"}),c.jsx("option",{value:"PA",children:"Pasaporte"}),c.jsx("option",{value:"OTRO",children:"Otro"})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"form-label",children:"Nro. de documento *"}),c.jsx("input",{className:"form-input",value:y.nroDocumento,onChange:x=>q("nroDocumento",x.target.value),placeholder:"Nmero de documento",required:!0})]}),c.jsxs("div",{children:[c.jsx("label",{className:"form-label",children:"Nmero de Historia"}),c.jsx("input",{className:"form-input",value:y.nroHistoria,readOnly:!0})]}),c.jsxs("div",{children:[c.jsx("label",{className:"form-label",children:"Nombres *"}),c.jsx("input",{className:"form-input",value:y.nombres,onChange:x=>q("nombres",x.target.value),required:!0})]}),c.jsxs("div",{children:[c.jsx("label",{className:"form-label",children:"Apellidos *"}),c.jsx("input",{className:"form-input",value:y.apellidos,onChange:x=>q("apellidos",x.target.value),required:!0})]}),c.jsxs("div",{children:[c.jsx("label",{className:"form-label",children:"Nombre completo"}),c.jsx("input",{className:"form-input",value:y.nombreCompleto,readOnly:!0})]}),c.jsxs("div",{children:[c.jsx("label",{className:"form-label",children:"Sexo *"}),c.jsxs("select",{className:"form-input",value:y.sexo,onChange:x=>q("sexo",x.target.value),required:!0,children:[c.jsx("option",{value:"",children:"Seleccione"}),c.jsx("option",{children:"Masculino"}),c.jsx("option",{children:"Femenino"}),c.jsx("option",{children:"Otro"})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"form-label",children:"Estado civil *"}),c.jsxs("select",{className:"form-input",value:y.estadoCivil,onChange:x=>q("estadoCivil",x.target.value),required:!0,children:[c.jsx("option",{value:"",children:"Seleccione"}),c.jsx("option",{children:"Soltero"}),c.jsx("option",{children:"Casado"}),c.jsx("option",{children:"Unin libre"}),c.jsx("option",{children:"Divorciado"}),c.jsx("option",{children:"Viudo"})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"form-label",children:"Pas de nacimiento *"}),c.jsx("input",{className:"form-input",list:"listCountries",value:y.paisNacimiento,onChange:x=>q("paisNacimiento",x.target.value),placeholder:"Escribe y elige",required:!0}),c.jsx("datalist",{id:"listCountries",children:FU.map(x=>c.jsx("option",{value:x},x))})]}),c.jsxs("div",{children:[c.jsx("label",{className:"form-label",children:"Ciudad de nacimiento"}),c.jsx("input",{className:"form-input",list:"listCitiesBirth",value:y.ciudadNacimiento,onChange:x=>q("ciudadNacimiento",x.target.value),placeholder:"Escribe y elige"}),c.jsx("datalist",{id:"listCitiesBirth",children:(Up[y.paisNacimiento]||[]).map(x=>c.jsx("option",{value:x},x))})]}),c.jsxs("div",{children:[c.jsx("label",{className:"form-label",children:"Fecha de ingreso"}),c.jsx("input",{className:"form-input",value:y.fechaIngreso,readOnly:!0})]}),c.jsxs("div",{children:[c.jsx("label",{className:"form-label",children:"Fecha de nacimiento *"}),c.jsx("input",{type:"date",className:"form-input",value:y.fechaNacimiento,onChange:x=>q("fechaNacimiento",x.target.value),required:!0})]}),c.jsxs("div",{children:[c.jsx("label",{className:"form-label",children:"Edad"}),c.jsx("input",{className:"form-input",value:y.edad,readOnly:!0})]}),c.jsxs("div",{children:[c.jsx("label",{className:"form-label",children:"Pas de domicilio *"}),c.jsx("input",{className:"form-input",list:"listCountries",value:y.paisDomicilio,onChange:x=>q("paisDomicilio",x.target.value),required:!0})]}),c.jsxs("div",{children:[c.jsx("label",{className:"form-label",children:"Ciudad de domicilio *"}),c.jsx("input",{className:"form-input",list:"listCitiesHome",value:y.ciudadDomicilio,onChange:x=>q("ciudadDomicilio",x.target.value),required:!0}),c.jsx("datalist",{id:"listCitiesHome",children:(Up[y.paisDomicilio]||[]).map(x=>c.jsx("option",{value:x},x))})]}),c.jsxs("div",{children:[c.jsx("label",{className:"form-label",children:"Barrio *"}),c.jsx("input",{className:"form-input",value:y.barrio,onChange:x=>q("barrio",x.target.value),required:!0,placeholder:"Barrio"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"form-label",children:"Lugar de residencia *"}),c.jsx("input",{className:"form-input",value:y.lugarResidencia,onChange:x=>q("lugarResidencia",x.target.value),required:!0})]}),c.jsxs("div",{children:[c.jsx("label",{className:"form-label",children:"Estrato"}),c.jsxs("select",{className:"form-input",value:y.estrato,onChange:x=>q("estrato",x.target.value),children:[c.jsx("option",{value:"",children:"Seleccione"}),c.jsx("option",{children:"1"}),c.jsx("option",{children:"2"}),c.jsx("option",{children:"3"}),c.jsx("option",{children:"4"}),c.jsx("option",{children:"5"}),c.jsx("option",{children:"6"})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"form-label",children:"Zona residencial *"}),c.jsxs("select",{className:"form-input",value:y.zonaResidencial,onChange:x=>q("zonaResidencial",x.target.value),required:!0,children:[c.jsx("option",{value:"",children:"Seleccione"}),c.jsx("option",{children:"Urbana"}),c.jsx("option",{children:"Rural"})]})]}),c.jsxs("div",{className:"checkbox-cell",children:[c.jsx("label",{className:"form-label",children:"Es extranjero?"}),c.jsx("input",{type:"checkbox",checked:y.esExtranjero,onChange:x=>q("esExtranjero",x.target.checked)})]}),c.jsxs("div",{className:"checkbox-cell",children:[c.jsx("label",{className:"form-label",children:"Permite publicidad?"}),c.jsx("input",{type:"checkbox",checked:y.permitePublicidad,onChange:x=>q("permitePublicidad",x.target.checked)})]})]}),c.jsx("div",{className:"form-section-title",children:"Contacto"}),c.jsxs("div",{className:"form-grid",children:[c.jsxs("div",{children:[c.jsx("label",{className:"form-label",children:"Celular *"}),c.jsx("input",{className:"form-input",value:y.celular,onChange:x=>q("celular",x.target.value),required:!0,placeholder:"Celular del paciente"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"form-label",children:"Telfono de domicilio"}),c.jsx("input",{className:"form-input",value:y.telDomicilio,onChange:x=>q("telDomicilio",x.target.value)})]}),c.jsxs("div",{children:[c.jsx("label",{className:"form-label",children:"Telfono de oficina"}),c.jsx("input",{className:"form-input",value:y.telOficina,onChange:x=>q("telOficina",x.target.value)})]}),c.jsxs("div",{children:[c.jsx("label",{className:"form-label",children:"Extensin"}),c.jsx("input",{className:"form-input",value:y.extension,onChange:x=>q("extension",x.target.value)})]}),c.jsxs("div",{children:[c.jsx("label",{className:"form-label",children:"Correo electrnico *"}),c.jsx("input",{type:"email",className:"form-input",value:y.email,onChange:x=>q("email",x.target.value),required:!0,placeholder:"correo@dominio.com"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"form-label",children:"Ocupacin *"}),c.jsx("input",{className:"form-input",value:y.ocupacion,onChange:x=>q("ocupacion",x.target.value),required:!0})]})]}),c.jsx("div",{className:"form-section-title",children:"Datos de facturacin"}),c.jsxs("div",{className:"form-grid",children:[c.jsxs("div",{children:[c.jsx("label",{className:"form-label",children:"Responsable"}),c.jsx("input",{className:"form-input",value:y.nombreResponsable,onChange:x=>q("nombreResponsable",x.target.value)})]}),c.jsxs("div",{children:[c.jsx("label",{className:"form-label",children:"Parentesco"}),c.jsxs("select",{className:"form-input",value:y.parentesco,onChange:x=>q("parentesco",x.target.value),children:[c.jsx("option",{value:"",children:"Seleccione"}),c.jsx("option",{children:"Padre/Madre"}),c.jsx("option",{children:"Hermano"}),c.jsx("option",{children:"Esposo/a"}),c.jsx("option",{children:"Otro"})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"form-label",children:"Celular"}),c.jsx("input",{className:"form-input",value:y.celularResponsable,onChange:x=>q("celularResponsable",x.target.value)})]}),c.jsxs("div",{children:[c.jsx("label",{className:"form-label",children:"Telfono"}),c.jsx("input",{className:"form-input",value:y.telefonoResponsable,onChange:x=>q("telefonoResponsable",x.target.value)})]}),c.jsxs("div",{children:[c.jsx("label",{className:"form-label",children:"Correo electrnico"}),c.jsx("input",{type:"email",className:"form-input",value:y.emailResponsable,onChange:x=>q("emailResponsable",x.target.value)})]})]}),c.jsx("div",{className:"form-section-title",children:"Acompaante"}),c.jsxs("div",{className:"form-grid",children:[c.jsxs("div",{children:[c.jsx("label",{className:"form-label",children:"Nombre"}),c.jsx("input",{className:"form-input",value:y.nombreAcompanante,onChange:x=>q("nombreAcompanante",x.target.value),placeholder:"Nombre acompaante"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"form-label",children:"Telfono"}),c.jsx("input",{className:"form-input",value:y.telefonoAcompanante,onChange:x=>q("telefonoAcompanante",x.target.value),placeholder:"Telfono acompaante"})]})]}),c.jsx("div",{className:"form-section-title",children:"Mercadeo"}),c.jsxs("div",{className:"form-grid",children:[c.jsxs("div",{children:[c.jsx("label",{className:"form-label",children:"Convenio beneficio"}),c.jsx("input",{className:"form-input",value:y.convenioBeneficio,onChange:x=>q("convenioBeneficio",x.target.value)})]}),c.jsxs("div",{children:[c.jsx("label",{className:"form-label",children:"Cmo nos conoci?"}),c.jsxs("select",{className:"form-input",value:y.comoConocio,onChange:x=>q("comoConocio",x.target.value),children:[c.jsx("option",{value:"",children:"Seleccione"}),c.jsx("option",{children:"Redes sociales"}),c.jsx("option",{children:"Publicidad"}),c.jsx("option",{children:"Recomendacin"}),c.jsx("option",{children:"Otro"})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"form-label",children:"Campaa"}),c.jsx("input",{className:"form-input",value:y.campania,onChange:x=>q("campania",x.target.value)})]}),c.jsxs("div",{children:[c.jsx("label",{className:"form-label",children:"Remitido por"}),c.jsx("input",{className:"form-input",value:y.remitidoPor,onChange:x=>q("remitidoPor",x.target.value)})]}),c.jsxs("div",{children:[c.jsx("label",{className:"form-label",children:"Asesor comercial"}),c.jsx("input",{className:"form-input",value:y.asesorComercial,onChange:x=>q("asesorComercial",x.target.value)})]})]}),c.jsx("div",{className:"form-section-title",children:"EPS"}),c.jsxs("div",{className:"form-grid",children:[c.jsxs("div",{children:[c.jsx("label",{className:"form-label",children:"Tipo de vinculacin *"}),c.jsxs("select",{className:"form-input",value:y.tipoVinculacion,onChange:x=>q("tipoVinculacion",x.target.value),required:!0,children:[c.jsx("option",{value:"",children:"Seleccione"}),c.jsx("option",{children:"Contributivo"}),c.jsx("option",{children:"Subsidiado"}),c.jsx("option",{children:"Particular"}),c.jsx("option",{children:"Otro"})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"form-label",children:"Nombre de la EPS *"}),c.jsx("input",{className:"form-input",list:"listEps",value:y.nombreEps,onChange:x=>q("nombreEps",x.target.value),placeholder:"Escribe y selecciona",required:!0}),c.jsx("datalist",{id:"listEps",children:Ke.map(x=>c.jsx("option",{value:x},x))})]}),c.jsxs("div",{children:[c.jsx("label",{className:"form-label",children:"Pliza de salud"}),c.jsx("input",{className:"form-input",value:y.polizaSalud,onChange:x=>q("polizaSalud",x.target.value)})]})]}),c.jsx("div",{className:"form-section-title",children:"Doctor"}),c.jsx("div",{className:"form-grid",children:c.jsxs("div",{children:[c.jsx("label",{className:"form-label",children:"Doctor"}),c.jsx("input",{className:"form-input",value:y.doctor,onChange:x=>q("doctor",x.target.value),placeholder:"Usuario / Libre"})]})}),c.jsx("div",{className:"form-section-title",children:"Alertas y Notas"}),c.jsx("div",{className:"form-grid",children:c.jsx("textarea",{className:"form-input",rows:3,value:y.notas,onChange:x=>q("notas",x.target.value),placeholder:"Notas del paciente"})}),c.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:8,marginTop:12},children:[I?c.jsx("button",{type:"button",className:"btn",onClick:()=>ze({id:I,nombreCompleto:y.nombreCompleto}),children:"Eliminar"}):c.jsx("div",{}),c.jsxs("div",{style:{display:"flex",gap:8},children:[c.jsx("button",{type:"button",className:"btn",onClick:()=>E(!1),children:"Cancelar"}),c.jsx("button",{type:"submit",className:"btn blue",children:I?"Actualizar":"Guardar paciente"})]})]})]})]})]}),b&&c.jsxs("div",{className:"odc-modal",role:"dialog","aria-modal":"true",children:[c.jsx("div",{className:"odc-modal-backdrop",onClick:M}),c.jsxs("div",{className:"odc-card ficha-card",children:[c.jsxs("div",{className:"ficha-header",children:[c.jsxs("div",{className:"ficha-header-left",children:[b.fotoUrl?c.jsx("img",{src:b.fotoUrl,alt:"Foto",className:"ficha-avatar"}):c.jsx("div",{className:"avatar-fallback ficha-avatar-fallback",children:(b.nombreCompleto||"P")[0]}),c.jsxs("div",{children:[c.jsx("div",{className:"ficha-nombre",children:b.nombreCompleto||""}),c.jsxs("div",{className:"ficha-doc",children:[b.tipoDocumento||""," ",b.nroDocumento||""]}),c.jsxs("div",{className:"ficha-badges",children:[c.jsx("span",{className:"ficha-badge blue",children:"En valoracin"}),c.jsx("span",{className:"ficha-badge green",children:"Sin deuda"})]})]})]}),c.jsx("div",{className:"ficha-header-right",children:c.jsxs("div",{className:"ficha-actions",children:[c.jsx("button",{type:"button",className:"btn",onClick:M,children:"Cerrar"}),c.jsx("button",{type:"button",className:"btn blue",onClick:Ce,children:"Editar"}),c.jsx("button",{type:"button",className:"btn green",onClick:()=>t(s(Gu.caja,{cobro:1,patientId:b.id})),title:"Ir a Caja para cobrar a este paciente",children:"Cobrar"})]})})]}),c.jsxs("div",{className:"ficha-body",children:[c.jsxs("aside",{className:"ficha-sidebar",children:[c.jsx("div",{className:"ficha-sidebar-title",children:"Informacin general"}),c.jsx("button",{type:"button",className:`ficha-link ${w==="datos"?"active":""}`,onClick:()=>_("datos"),children:"Datos personales"}),c.jsx("button",{type:"button",className:`ficha-link ${w==="marketing"?"active":""}`,onClick:()=>_("marketing"),children:"Marketing"}),c.jsx("button",{type:"button",className:`ficha-link ${w==="eps"?"active":""}`,onClick:()=>_("eps"),children:"EPS"}),c.jsx("button",{type:"button",className:`ficha-link ${w==="prof"?"active":""}`,onClick:()=>_("prof"),children:"Profesionales"}),c.jsx("button",{type:"button",className:`ficha-link ${w==="rx"?"active":""}`,onClick:()=>_("rx"),children:"Rx/Imgenes/Doc"}),c.jsx("button",{type:"button",className:`ficha-link ${w==="citas"?"active":""}`,onClick:()=>_("citas"),children:"Citas"}),c.jsx("button",{type:"button",className:`ficha-link ${w==="crm"?"active":""}`,onClick:()=>_("crm"),children:"CRM"}),c.jsx("div",{className:"ficha-sidebar-title mt",children:"Historia clnica"}),c.jsx("button",{type:"button",className:`ficha-link ${w==="doc"?"active":""}`,onClick:()=>_("doc"),children:"Doc. Clnicos"}),c.jsx("button",{type:"button",className:`ficha-link ${w==="odonto"?"active":""}`,onClick:()=>_("odonto"),children:"Odontogramas"}),c.jsx("button",{type:"button",className:`ficha-link ${w==="perio"?"active":""}`,onClick:()=>_("perio"),children:"Periodontogramas"}),c.jsx("button",{type:"button",className:`ficha-link ${w==="presu"?"active":""}`,onClick:()=>_("presu"),children:"Presupuestos"}),c.jsx("button",{type:"button",className:`ficha-link ${w==="evo"?"active":""}`,onClick:()=>_("evo"),children:"Evoluciones"}),c.jsx("div",{className:"ficha-sidebar-title mt",children:"Facturacin"}),c.jsx("button",{type:"button",className:`ficha-link ${w==="fact"?"active":""}`,onClick:()=>_("fact"),children:"Resumen"}),c.jsxs("div",{className:"ficha-sidebar-actions",style:{display:"grid",gap:8,marginTop:8},children:[c.jsx("button",{type:"button",className:"btn pay",onClick:()=>t(s(Gu.caja,{cobro:1,patientId:b.id})),title:"Cobrar a este paciente",children:"Realizar pago"}),c.jsx("button",{type:"button",className:"btn history",onClick:()=>r(`${Gu.pagos}?patientId=${encodeURIComponent(b.id)}`),title:"Ver histrico de pagos",children:"Histrico de pagos"}),c.jsx("button",{type:"button",className:"btn history",onClick:()=>r(`${Gu.facturas}?patientId=${encodeURIComponent(b.id)}`),title:"Ver histrico de facturacin",children:"Histrico de facturacin"})]})]}),c.jsxs("main",{className:"ficha-content",children:[w==="datos"&&c.jsxs("section",{className:"ficha-section",children:[c.jsx("h4",{className:"ficha-section-title",children:"Datos personales"}),c.jsx("div",{className:"ficha-grid",children:[["Tipo de documento",b.tipoDocumento],["Nro. de documento",b.nroDocumento],["Nmero de Historia",b.nroHistoria],["Fecha de ingreso",b.fechaIngreso],["Nombres",b.nombres],["Apellidos",b.apellidos],["Nombre completo",b.nombreCompleto],["Sexo",b.sexo],["Estado civil",b.estadoCivil],["Pas de nacimiento",b.paisNacimiento],["Ciudad de nacimiento",b.ciudadNacimiento],["Fecha de nacimiento",b.fechaNacimiento],["Edad",b.edad],["Pas de domicilio",b.paisDomicilio],["Ciudad de domicilio",b.ciudadDomicilio],["Barrio",b.barrio],["Lugar de residencia",b.lugarResidencia],["Estrato",b.estrato],["Zona residencial",b.zonaResidencial],["Extranjero",b.esExtranjero?"S":"No"],["Permite publicidad",b.permitePublicidad?"S":"No"],["Celular",b.celular||b.celularPaciente],["Telfono domicilio",b.telDomicilio||b.telefonoPaciente],["Telfono oficina",b.telOficina],["Extensin",b.extension],["Correo electrnico",b.email],["Ocupacin",b.ocupacion],["Responsable",b.nombreResponsable],["Parentesco",b.parentesco],["Cel. responsable",b.celularResponsable],["Tel. responsable",b.telefonoResponsable],["Email responsable",b.emailResponsable],["Acompaante",b.nombreAcompanante],["Tel. acompaante",b.telefonoAcompanante]].map(([x,z])=>c.jsxs("div",{className:"field",children:[c.jsx("label",{children:x}),c.jsx("input",{className:"form-input",value:z||"",readOnly:!0})]},x))})]}),w==="marketing"&&c.jsxs("section",{className:"ficha-section",children:[c.jsx("h4",{className:"ficha-section-title",children:"Marketing"}),c.jsx("div",{className:"ficha-grid",children:[["Convenio beneficio",b.convenioBeneficio],["Cmo nos conoci?",b.comoConocio],["Campaa",b.campania],["Remitido por",b.remitidoPor],["Asesor comercial",b.asesorComercial]].map(([x,z])=>c.jsxs("div",{className:"field",children:[c.jsx("label",{children:x}),c.jsx("input",{className:"form-input",value:z||"",readOnly:!0})]},x))})]}),w==="eps"&&c.jsxs("section",{className:"ficha-section",children:[c.jsx("h4",{className:"ficha-section-title",children:"EPS"}),c.jsx("div",{className:"ficha-grid",children:[["Tipo de vinculacin",b.tipoVinculacion],["Nombre EPS",b.nombreEps],["Pliza de salud",b.polizaSalud]].map(([x,z])=>c.jsxs("div",{className:"field",children:[c.jsx("label",{children:x}),c.jsx("input",{className:"form-input",value:z||"",readOnly:!0})]},x))})]}),w==="prof"&&c.jsxs("section",{className:"ficha-section",children:[c.jsx("h4",{className:"ficha-section-title",children:"Profesionales"}),c.jsx("div",{className:"ficha-grid",children:c.jsxs("div",{className:"field",children:[c.jsx("label",{children:"Doctor"}),c.jsx("input",{className:"form-input",value:b.doctor||"",readOnly:!0})]})})]}),w==="rx"&&c.jsxs("section",{className:"ficha-section",children:[c.jsx("h4",{className:"ficha-section-title",children:"Rx / Imgenes / Documentos"}),c.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",flexWrap:"wrap"},children:[c.jsxs("label",{className:"btn blue",children:["Subir archivos",c.jsx("input",{ref:de,type:"file",multiple:!0,accept:"image/*,.pdf,.doc,.docx,.xls,.xlsx",style:{display:"none"},onChange:x=>Ne([...x.target.files||[]])})]}),dn&&c.jsx("span",{className:"hint",children:"Subiendo"}),c.jsx("div",{style:{marginLeft:"auto",display:"flex",gap:8,alignItems:"center"},children:c.jsx("input",{className:"form-input",style:{width:200},placeholder:"Buscar en Rx",value:Re,onChange:x=>Xe(x.target.value),title:"Filtra por nombre, ttulo o descripcin"})})]}),c.jsxs("div",{className:"hint",style:{marginTop:6},children:[ne.length," elemento(s)",Re?"  filtrado(s)":"","."]}),c.jsxs("div",{className:"rx-grid",style:{display:"grid",gap:10,marginTop:12,gridTemplateColumns:`repeat(auto-fill, minmax(${Dt.colMin}px, 1fr))`,alignItems:"start"},children:[ne.length===0&&c.jsx("div",{className:"no-data",style:{gridColumn:"1 / -1"},children:Re?"Sin coincidencias.":"Sin archivos an."}),ne.map((x,z)=>{var Nr,Qn;const Y=U(x),ue=x.title||x.name||`archivo-${z}`,me=((Nr=(x.name||"").split(".").pop())==null?void 0:Nr.toUpperCase())||((Qn=(x.type||"").split("/").pop())==null?void 0:Qn.toUpperCase())||"",Ge=x.uploadedAtISO||(x.created?new Date(x.created).toISOString():null);return c.jsxs("div",{className:"rx-item mini-card",style:{padding:8,display:"grid",gap:8},title:ue,children:[c.jsx("a",{href:x.url,target:"_blank",rel:"noreferrer",style:{width:"100%",height:Dt.thumbH,borderRadius:8,overflow:"hidden",border:"1px solid #e5e7eb",display:"grid",placeItems:"center",background:"#fafafa"},children:Y?c.jsx("img",{src:x.url,alt:ue,style:{width:Dt.thumbW,height:Dt.thumbH,objectFit:"contain",display:"block"},loading:"lazy"}):c.jsxs("div",{style:{textAlign:"center",padding:10},children:[c.jsx("div",{style:{fontSize:24,fontWeight:700},children:me||"DOC"}),c.jsx("div",{style:{fontSize:12,opacity:.7},children:"Ver / descargar"})]})}),c.jsx("div",{style:{fontWeight:600,fontSize:13,lineHeight:1.2},children:ue.length>40?ue.slice(0,37)+"":ue}),c.jsxs("details",{children:[c.jsx("summary",{style:{cursor:"pointer",fontSize:12,color:"#2563eb"},children:"Editar nombre y descripcin"}),c.jsxs("div",{style:{display:"grid",gap:6,marginTop:6},children:[c.jsx("label",{className:"form-label",style:{marginTop:4},children:"Nombre para mostrar"}),c.jsx("input",{id:`rx-title-${z}`,className:"form-input",defaultValue:x.title||x.name||"",placeholder:"Ej. Rx aleta derecha 2025-11-29"}),c.jsx("label",{className:"form-label",children:"Descripcin"}),c.jsx("textarea",{id:`rx-desc-${z}`,className:"form-input",rows:2,defaultValue:x.desc||"",placeholder:"Observaciones, regin, tcnica, etc."}),c.jsx("label",{className:"form-label",children:"Fecha de subida"}),c.jsx("input",{id:`rx-date-${z}`,type:"datetime-local",className:"form-input",defaultValue:BU(Ge)}),c.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",justifyContent:"space-between"},children:[c.jsx("button",{type:"button",className:"btn blue",onClick:()=>{var Xr,Jr,bo;const Yn=((Xr=document.getElementById(`rx-title-${z}`))==null?void 0:Xr.value)||"",At=((Jr=document.getElementById(`rx-desc-${z}`))==null?void 0:Jr.value)||"",Tn=((bo=document.getElementById(`rx-date-${z}`))==null?void 0:bo.value)||"";let Sn=Ge,hr=x.uploadedAtMS||x.created||null;if(Tn){const Zr=new Date(Tn);isNaN(Zr.getTime())||(Sn=Zr.toISOString(),hr=Zr.getTime())}ce(z,{title:Yn,name:Yn||x.name,desc:At,uploadedAtISO:Sn,uploadedAtMS:hr})},children:"Guardar"}),c.jsx("button",{type:"button",className:"btn",onClick:()=>nt(z),children:"Eliminar"})]}),c.jsxs("div",{className:"hint",style:{fontSize:11},children:["Tipo: ",x.type||"","  Tamao: ",(x.size||0).toLocaleString()," bytes",Ge?`  Subido: ${zU(Ge)}`:""]})]})]})]},`${x.url}-${z}`)})]})]}),w==="doc"&&c.jsxs("section",{className:"ficha-section",children:[c.jsx("h4",{className:"ficha-section-title",children:"Doc. Clnicos"}),c.jsxs("div",{className:"ficha-grid",children:[c.jsxs("div",{className:"field",children:[c.jsx("label",{children:"Motivo de consulta"}),c.jsx("textarea",{className:"form-input",rows:3,value:((Pr=b.historiaClinica)==null?void 0:Pr.motivoConsulta)||"",onChange:x=>St("motivoConsulta",x.target.value)})]}),c.jsxs("div",{className:"field",children:[c.jsx("label",{children:"Antecedentes"}),c.jsx("textarea",{className:"form-input",rows:3,value:((dr=b.historiaClinica)==null?void 0:dr.antecedentes)||"",onChange:x=>St("antecedentes",x.target.value)})]}),c.jsxs("div",{className:"field",children:[c.jsx("label",{children:"Alergias"}),c.jsx("textarea",{className:"form-input",rows:2,value:((Is=b.historiaClinica)==null?void 0:Is.alergias)||"",onChange:x=>St("alergias",x.target.value)})]}),c.jsxs("div",{className:"field",children:[c.jsx("label",{children:"Medicamentos"}),c.jsx("textarea",{className:"form-input",rows:2,value:((On=b.historiaClinica)==null?void 0:On.medicamentos)||"",onChange:x=>St("medicamentos",x.target.value)})]}),c.jsxs("div",{className:"field",children:[c.jsx("label",{children:"Notas"}),c.jsx("textarea",{className:"form-input",rows:3,value:((Yr=b.historiaClinica)==null?void 0:Yr.notas)||"",onChange:x=>St("notas",x.target.value)})]})]})]}),w==="odonto"&&c.jsxs("section",{className:"ficha-section",children:[c.jsx("h4",{className:"ficha-section-title",children:"Odontograma (placeholder)"}),c.jsx("div",{className:"odont-grid",children:Array.from({length:32},(x,z)=>z+1).map(x=>{const z=(b.odontograma||[]).some(Y=>Y.pieza===x);return c.jsx("button",{type:"button",className:`tooth ${z?"on":""}`,onClick:()=>bt("odontograma",x),title:`Pieza ${x}`,children:x},x)})})]}),w==="perio"&&c.jsxs("section",{className:"ficha-section",children:[c.jsx("h4",{className:"ficha-section-title",children:"Periodontograma (placeholder)"}),c.jsx("div",{className:"odont-grid",children:Array.from({length:32},(x,z)=>z+1).map(x=>{const z=(b.periodontograma||[]).some(Y=>Y.pieza===x);return c.jsx("button",{type:"button",className:`tooth ${z?"on":""}`,onClick:()=>bt("periodontograma",x),title:`Pieza ${x}`,children:x},x)})})]}),w==="presu"&&c.jsxs("section",{className:"ficha-section",children:[c.jsx("h4",{className:"ficha-section-title",children:"Presupuestos & planes"}),c.jsx(GU,{onAdd:Rr}),c.jsxs("div",{className:"presu-list",children:[(b.presupuestos||[]).map(x=>c.jsxs("div",{className:"presu-item",children:[c.jsxs("div",{children:[c.jsx("div",{className:"presu-title",children:x.titulo}),c.jsxs("div",{className:"presu-meta",children:["Costo: $",x.costo||0,"  Estado: ",x.estado||"Pendiente"]})]}),c.jsx("button",{type:"button",className:"btn small",onClick:()=>xn(x.id),children:"Eliminar"})]},x.id)),(!b.presupuestos||b.presupuestos.length===0)&&c.jsx("div",{className:"no-data",children:"Sin presupuestos an."})]})]}),w==="evo"&&c.jsxs("section",{className:"ficha-section",children:[c.jsx("h4",{className:"ficha-section-title",children:"Evoluciones & Remisiones"}),c.jsx(KU,{onAdd:jn}),c.jsxs("div",{className:"evo-list",children:[(b.evoluciones||[]).map(x=>c.jsxs("div",{className:"evo-item",children:[c.jsx("div",{className:"evo-date",children:new Date(x.fechaISO).toLocaleString()}),c.jsx("div",{className:"evo-note",children:x.nota}),c.jsx("button",{type:"button",className:"btn small",onClick:()=>Zt(x.id),children:"Eliminar"})]},x.id)),(!b.evoluciones||b.evoluciones.length===0)&&c.jsx("div",{className:"no-data",children:"Sin evoluciones an."})]})]}),w==="fact"&&c.jsxs("section",{className:"ficha-section",children:[c.jsx("h4",{className:"ficha-section-title",children:"Facturacin"}),c.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(220px,1fr))",gap:12},children:[c.jsx(Fo,{title:"Total facturado",value:`$ ${$t.totalFacturado.toLocaleString()}`}),c.jsx(Fo,{title:"Total pagado",value:`$ ${$t.totalPagado.toLocaleString()}`}),c.jsx(Fo,{title:"Facturas pendientes",value:`$ ${$t.totalFacturasPendientes.toLocaleString()}`}),c.jsx(Fo,{title:"Saldo pendiente (facturas - pagos)",value:`$ ${($t.totalFacturado-$t.totalPagado).toLocaleString()}`}),c.jsx(Fo,{title:"Saldo a favor",value:`$ ${(((lu=b.facturacion)==null?void 0:lu.saldoFavor)??0).toLocaleString()}`}),c.jsx(Fo,{title:"Saldo crdito",value:`$ ${(((cu=b.facturacion)==null?void 0:cu.saldoCredito)??0).toLocaleString()}`})]}),$t.error&&c.jsxs("div",{className:"hint",style:{marginTop:6},children:[" ",$t.error]}),c.jsxs("div",{className:"ficha-grid",style:{marginTop:12},children:[c.jsxs("div",{className:"field",children:[c.jsx("label",{children:"Saldo a favor"}),c.jsx("input",{type:"number",className:"form-input",value:((Ti=b.facturacion)==null?void 0:Ti.saldoFavor)??0,onChange:x=>te({facturacion:{...b.facturacion||{},saldoFavor:Number(x.target.value||0)}})})]}),c.jsxs("div",{className:"field",children:[c.jsx("label",{children:"Saldo crdito"}),c.jsx("input",{type:"number",className:"form-input",value:((nl=b.facturacion)==null?void 0:nl.saldoCredito)??0,onChange:x=>te({facturacion:{...b.facturacion||{},saldoCredito:Number(x.target.value||0)}})})]})]})]}),w==="citas"&&c.jsxs("section",{className:"ficha-section",children:[c.jsx("h4",{className:"ficha-section-title",children:"Citas"}),c.jsxs("div",{className:"mini-card",style:{marginBottom:12},children:[c.jsx("div",{className:"mini-card-title",children:"Crear cita para este paciente"}),c.jsxs("div",{className:"ficha-grid",style:{marginTop:8},children:[c.jsxs("div",{className:"field",children:[c.jsx("label",{children:"Fecha"}),c.jsx("input",{type:"date",className:"form-input",value:Te,onChange:x=>je(x.target.value)})]}),c.jsxs("div",{className:"field",children:[c.jsx("label",{children:"Hora"}),c.jsx("input",{type:"time",className:"form-input",value:we,onChange:x=>it(x.target.value)})]}),c.jsxs("div",{className:"field",children:[c.jsx("label",{children:"Doctor"}),c.jsx("input",{className:"form-input",value:Se,onChange:x=>ie(x.target.value),placeholder:"Doctor asignado"})]}),c.jsxs("div",{className:"field",children:[c.jsx("label",{children:"Espacio / Sala"}),c.jsx("input",{className:"form-input",value:Pe,onChange:x=>Me(x.target.value),placeholder:"Consultorio / Silla"})]}),c.jsxs("div",{className:"field",style:{gridColumn:"1 / -1"},children:[c.jsx("label",{children:"Comentario"}),c.jsx("textarea",{className:"form-input",rows:2,value:He,onChange:x=>H(x.target.value),placeholder:"Motivo / notas de la cita"})]})]}),c.jsxs("div",{style:{display:"flex",gap:8,justifyContent:"flex-end"},children:[c.jsx("button",{type:"button",className:"btn blue",onClick:se,children:"Guardar cita"}),Te&&c.jsx("button",{type:"button",className:"btn",onClick:()=>i(Te,b.id),children:"Ver ese da en Agenda"})]})]}),c.jsx("div",{className:"table-wrap",children:c.jsxs("table",{className:"appointments-table",children:[c.jsx("thead",{children:c.jsxs("tr",{children:[c.jsx("th",{children:"Fecha"}),c.jsx("th",{children:"Estado"}),c.jsx("th",{children:"Motivo"}),c.jsx("th",{children:"Profesional / Acciones"})]})}),c.jsx("tbody",{children:Qe?c.jsx("tr",{children:c.jsx("td",{className:"no-data",colSpan:4,children:"Cargando"})}):Ct.length===0?c.jsx("tr",{children:c.jsx("td",{className:"no-data",colSpan:4,children:"Sin citas registradas."})}):Ct.map(x=>c.jsxs("tr",{children:[c.jsx("td",{children:x.fechaISO?new Date(x.fechaISO).toLocaleString():x.fechaYYYYMMDD||""}),c.jsx("td",{children:x.estado||""}),c.jsx("td",{children:x.motivo||""}),c.jsx("td",{children:c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[c.jsx("span",{children:x.profesional||""}),c.jsx("button",{type:"button",className:"btn small",onClick:()=>{const z=x.fechaYYYYMMDD||x.fecha||(x.fechaISO?new Date(x.fechaISO).toISOString().slice(0,10):"");i(z,b.id)},title:"Abrir en Agenda",children:"Ver en Agenda"})]})})]},x.id))})]})})]}),w==="crm"&&c.jsxs("section",{className:"ficha-section",children:[c.jsx("h4",{className:"ficha-section-title",children:"CRM"}),c.jsx("div",{className:"no-data",children:"Notas / recordatorios comerciales del paciente."})]}),c.jsx("div",{className:"ficha-footer"})]})]})]})]})]})}function Fo({title:t,value:e}){return c.jsxs("div",{className:"mini-card",children:[c.jsx("div",{className:"mini-card-title",children:t}),c.jsx("div",{style:{fontWeight:700,fontSize:20,marginTop:6},children:e})]})}function GU({onAdd:t}){const[e,n]=A.useState(""),[r,s]=A.useState(""),[i,o]=A.useState("Pendiente");return c.jsxs("div",{className:"presu-form",children:[c.jsx("input",{className:"form-input",placeholder:"Procedimiento / plan",value:e,onChange:a=>n(a.target.value)}),c.jsx("input",{type:"number",className:"form-input",placeholder:"Costo",value:r,onChange:a=>s(a.target.value)}),c.jsxs("select",{className:"form-input",value:i,onChange:a=>o(a.target.value),children:[c.jsx("option",{children:"Pendiente"}),c.jsx("option",{children:"Aprobado"}),c.jsx("option",{children:"Rechazado"})]}),c.jsx("button",{type:"button",className:"btn blue",onClick:()=>{if(!e)return alert("Ttulo requerido");t({titulo:e,costo:Number(r||0),estado:i}),n(""),s(""),o("Pendiente")},children:"Agregar"})]})}function KU({onAdd:t}){const[e,n]=A.useState("");return c.jsxs("div",{className:"evo-form",children:[c.jsx("textarea",{className:"form-input",rows:2,placeholder:"Escribe la evolucin / remisin",value:e,onChange:r=>n(r.target.value)}),c.jsx("button",{type:"button",className:"btn blue",onClick:()=>{e.trim()&&(t(e.trim()),n(""))},children:"Guardar evolucin"})]})}function QU(){return c.jsxs("div",{style:{padding:"20px"},children:[c.jsx("h2",{children:"Mdulo de Facturacin"}),c.jsx("p",{children:"Aqu se registrarn los pagos, facturas y cobros."})]})}const yx=["Datos bsicos","Logo","Lista de precios","Planes","Consecutivos","Almacenes","Categoras inventario","Sucursales","Mtodos de pago","Bancos","Formulario de pacientes","Especialidades","Perfiles","Usuarios","Condiciones de pago","Parmetros","Recursos fsicos","Plantillas Doc. Clnicos","Pestaas Consulta Med.","Cargos","Impuestos","Catlogo de cuentas","Suscripcin"];function YU(t){return t.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/\./g,"").replace(/\s+/g,"-")}function XU({className:t="",basePath:e=""}){const[n,r]=A.useState(!1),[s,i]=A.useState(!1),[o,a]=A.useState(""),l=A.useRef(null),d=Ka(),h=A.useMemo(()=>{const T=o.trim().toLowerCase();return T?yx.filter(P=>P.toLowerCase().includes(T)):yx},[o]),f=()=>{r(!0),requestAnimationFrame(()=>{i(!0),setTimeout(()=>{var T;return(T=l.current)==null?void 0:T.focus()},60)})},m=()=>{i(!1),setTimeout(()=>r(!1),200)},v=T=>{const P=YU(T),E=e?`${e}`:"";d(`${E}/config/${P}`,{state:{title:T}}),m()};A.useEffect(()=>{if(!n)return;const T=P=>P.key==="Escape"&&m();return window.addEventListener("keydown",T),()=>window.removeEventListener("keydown",T)},[n]);const R=()=>c.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none","aria-hidden":!0,children:c.jsx("path",{d:"M4 7h16M4 12h16M4 17h10",stroke:"#64748b",strokeWidth:"1.7",strokeLinecap:"round"})});return c.jsxs(c.Fragment,{children:[c.jsx("button",{title:"Configuracin",onClick:f,className:`oc-icon-btn ${t}`,"aria-label":"Abrir configuracin",type:"button",children:""}),n&&c.jsx("div",{style:{position:"fixed",inset:0,zIndex:5e3,background:"rgba(2,6,23,0.35)",backdropFilter:"blur(2px)",opacity:s?1:0,transition:"opacity .2s ease"},onClick:m,children:c.jsxs("aside",{role:"dialog","aria-modal":"true","aria-label":"Configuracin",style:{position:"absolute",left:0,top:0,height:"100%",width:"100%",background:"#ffffff",borderRight:"1px solid #e5e7eb",boxShadow:"0 20px 40px rgba(2,6,23,.18)",display:"flex",flexDirection:"column",transform:s?"translateX(0%)":"translateX(-100%)",transition:"transform .2s ease"},onClick:T=>T.stopPropagation(),children:[c.jsxs("div",{style:{position:"sticky",top:0,zIndex:1,background:"#ffffffcc",backdropFilter:"saturate(160%) blur(3px)",borderBottom:"1px solid #e5e7eb"},children:[c.jsxs("div",{style:{padding:"12px 16px",display:"flex",alignItems:"center",gap:10},children:[c.jsx("span",{style:{fontWeight:800,color:"#0f172a"},children:"Informacin general"}),c.jsx("span",{style:{marginLeft:"auto"}}),c.jsx("button",{onClick:m,style:{fontSize:"0.8rem",background:"#f3f4f6",border:"1px solid #e5e7eb",borderRadius:8,padding:"6px 12px",cursor:"pointer",color:"#0f172a",fontWeight:600},children:"Cerrar"})]}),c.jsxs("div",{style:{padding:"0 16px 12px 16px"},children:[c.jsx("input",{ref:l,value:o,onChange:T=>a(T.target.value),placeholder:"Buscar seccin",style:{width:"100%",border:"1px solid #d1d5db",borderRadius:10,padding:"10px 12px",fontSize:".95rem",outline:"none",color:"#0f172a",background:"#fff"}}),c.jsx("div",{style:{fontSize:".8rem",color:"#64748b",marginTop:6},children:"Filtra por nombre y haz clic para abrir la pantalla de configuracin."})]})]}),c.jsxs("div",{style:{padding:"14px 16px 16px",overflowY:"auto",height:"100%"},children:[c.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, minmax(240px, 1fr))",gap:12},children:h.map(T=>c.jsxs("button",{onClick:()=>v(T),style:{display:"flex",alignItems:"center",gap:12,width:"100%",textAlign:"left",padding:"14px 14px",borderRadius:14,border:"1px solid #e5e7eb",background:"#ffffff",cursor:"pointer",fontSize:"1rem",fontWeight:700,color:"#0f172a",boxShadow:"0 1px 0 rgba(2,6,23,.04)",transition:"background .12s ease, border-color .12s ease, transform .06s ease"},onMouseEnter:P=>{P.currentTarget.style.background="#f9fafb",P.currentTarget.style.borderColor="#dbe2ea"},onMouseLeave:P=>{P.currentTarget.style.background="#ffffff",P.currentTarget.style.borderColor="#e5e7eb"},onMouseDown:P=>P.currentTarget.style.transform="scale(.995)",onMouseUp:P=>P.currentTarget.style.transform="scale(1)",children:[c.jsx("span",{style:{width:22,display:"inline-flex",justifyContent:"center"},children:c.jsx(R,{})}),c.jsx("span",{style:{flex:1},children:T}),c.jsx("span",{"aria-hidden":!0,style:{fontSize:12,color:"#94a3b8",fontWeight:700},children:""})]},T))}),h.length===0&&c.jsx("div",{style:{fontSize:".95rem",color:"#94a3b8",padding:12,textAlign:"center"},children:"Sin resultados"})]}),c.jsx("div",{style:{padding:"10px 16px",borderTop:"1px solid #e5e7eb",fontSize:".8rem",color:"#94a3b8"},children:"OdontoCloud  Preferencias del sistema"})]})})]})}const JU={"datos-basicos":"Datos bsicos",logo:"Logo","lista-de-precios":"Lista de precios",planes:"Planes",consecutivos:"Consecutivos",almacenes:"Almacenes","categorias-inventario":"Categoras inventario",sucursales:"Sucursales","metodos-de-pago":"Mtodos de pago",bancos:"Bancos","formulario-de-pacientes":"Formulario de pacientes",especialidades:"Especialidades",perfiles:"Perfiles",usuarios:"Usuarios","condiciones-de-pago":"Condiciones de pago",parametros:"Parmetros","recursos-fisicos":"Recursos fsicos","plantillas-doc-clinicos":"Plantillas Doc. Clnicos","pestanas-consulta-med":"Pestaas Consulta Med.",cargos:"Cargos",impuestos:"Impuestos","catalogo-de-cuentas":"Catlogo de cuentas",suscripcion:"Suscripcin"};function ZU(){const{section:t}=_N(),{state:e}=Kn(),n=(e==null?void 0:e.title)||JU[t]||"Configuracin";return c.jsx("div",{className:"oc-main-content",children:c.jsxs("section",{className:"oc-grid",children:[c.jsx("div",{className:"oc-grid-main",children:c.jsxs("div",{className:"card",children:[c.jsx("h3",{children:n}),c.jsx("div",{className:"mt-3 border rounded-lg p-4",children:c.jsxs("div",{className:"text-sm text-gray-700",children:["(Pendiente de implementar campos de ",c.jsx("b",{children:n}),")"]})})]})}),c.jsx("aside",{className:"oc-grid-side",children:c.jsxs("div",{className:"card",children:[c.jsx("h3",{children:"Ayuda"}),c.jsx("p",{className:"oc-muted",children:"Configura los parmetros generales del sistema."})]})})]})})}function e6(t,e){let n=document.querySelector(`meta[name="${t}"]`);n||(n=document.createElement("meta"),n.setAttribute("name",t),document.head.appendChild(n)),n.setAttribute("content",e)}function XA(){const[t,e]=A.useState({nombre:"",marca:"",pais:"Colombia",ciudad:"",tipoDocumento:"NIT",numeroDocumento:"",tipoPersona:"",telefono:"",celular:"",direccion:"",sitioWeb:"",urlAgendamiento:"",regimen:"",responsabilidadTributaria:"",correo:"",moneda:"Pesos colombianos (COP)",zonaHoraria:"Hora de Colombia",cuentaContable:"",esIPS:!1,usuarioSispro:"",tipoDocSispro:"Cdula de Ciudadana",passwordSispro:"",codigoPrestador:""});A.useEffect(()=>{var s;try{const i=localStorage.getItem("empresa_datos_basicos");if(i){const o=JSON.parse(i);e(a=>({...a,...o}))}else{const o=(s=document.querySelector('meta[name="company-name"]'))==null?void 0:s.getAttribute("content");o&&e(a=>({...a,nombre:o}))}}catch{}},[]);const n=s=>{const{name:i,type:o,value:a,checked:l}=s.target;e(d=>({...d,[i]:o==="checkbox"?l:a}))},r=async s=>{s.preventDefault();try{localStorage.setItem("empresa_datos_basicos",JSON.stringify(t)),localStorage.setItem("empresa_nombre",t.nombre||"OdontoCloud"),e6("company-name",t.nombre||"OdontoCloud")}catch{}console.log("Guardar Empresa  Datos bsicos:",t),alert("Datos bsicos guardados.")};return c.jsxs("div",{className:"oc-main-content",children:[c.jsx("div",{className:"oc-section-title",children:c.jsx("h2",{children:"Configuracin  Datos bsicos"})}),c.jsxs("div",{className:"emp-card",children:[c.jsx("div",{className:"emp-title",children:"Datos bsicos"}),c.jsxs("form",{className:"emp-form",onSubmit:r,children:[c.jsxs("div",{className:"oc-form-grid",children:[c.jsxs("div",{className:"oc-field",children:[c.jsx("label",{className:"emp-label",children:"Nombre *"}),c.jsx("input",{name:"nombre",className:"emp-input",autoComplete:"organization",required:!0,value:t.nombre,onChange:n})]}),c.jsxs("div",{className:"oc-field",children:[c.jsx("label",{className:"emp-label",children:"Marca"}),c.jsx("input",{name:"marca",className:"emp-input",value:t.marca,onChange:n})]}),c.jsxs("div",{className:"oc-field",children:[c.jsx("label",{className:"emp-label",children:"Pas"}),c.jsxs("select",{name:"pais",className:"emp-select",value:t.pais,onChange:n,children:[c.jsx("option",{children:"Colombia"}),c.jsx("option",{children:"Mxico"}),c.jsx("option",{children:"Per"}),c.jsx("option",{children:"Chile"}),c.jsx("option",{children:"Argentina"}),c.jsx("option",{children:"Espaa"})]})]}),c.jsxs("div",{className:"oc-field",children:[c.jsx("label",{className:"emp-label",children:"Ciudad"}),c.jsx("input",{name:"ciudad",className:"emp-input",value:t.ciudad,onChange:n})]}),c.jsxs("div",{className:"oc-field",children:[c.jsx("label",{className:"emp-label",children:"Tipo documento *"}),c.jsxs("select",{name:"tipoDocumento",className:"emp-select",required:!0,value:t.tipoDocumento,onChange:n,children:[c.jsx("option",{children:"NIT"}),c.jsx("option",{children:"CC"}),c.jsx("option",{children:"CE"}),c.jsx("option",{children:"PA"})]})]}),c.jsxs("div",{className:"oc-field",children:[c.jsx("label",{className:"emp-label",children:"Nmero de documento *"}),c.jsx("input",{name:"numeroDocumento",className:"emp-input",required:!0,value:t.numeroDocumento,onChange:n})]}),c.jsxs("div",{className:"oc-field",children:[c.jsx("label",{className:"emp-label",children:"Tipo de persona"}),c.jsxs("select",{name:"tipoPersona",className:"emp-select",value:t.tipoPersona,onChange:n,children:[c.jsx("option",{value:"",children:"Seleccione"}),c.jsx("option",{children:"Natural"}),c.jsx("option",{children:"Jurdica"})]})]}),c.jsxs("div",{className:"oc-field",children:[c.jsx("label",{className:"emp-label",children:"Telfono fijo"}),c.jsx("input",{name:"telefono",className:"emp-input",inputMode:"tel",autoComplete:"tel",value:t.telefono,onChange:n})]}),c.jsxs("div",{className:"oc-field",children:[c.jsx("label",{className:"emp-label",children:"Celular"}),c.jsx("input",{name:"celular",className:"emp-input",inputMode:"tel",autoComplete:"tel",value:t.celular,onChange:n})]}),c.jsxs("div",{className:"oc-field oc-col-2",children:[c.jsx("label",{className:"emp-label",children:"Direccin"}),c.jsx("input",{name:"direccion",className:"emp-input",autoComplete:"street-address",value:t.direccion,onChange:n})]}),c.jsxs("div",{className:"oc-field oc-col-2",children:[c.jsx("label",{className:"emp-label",children:"Sitio web"}),c.jsx("input",{name:"sitioWeb",className:"emp-input",inputMode:"url",placeholder:"https://",value:t.sitioWeb,onChange:n})]}),c.jsxs("div",{className:"oc-field oc-col-2",children:[c.jsx("label",{className:"emp-label",children:"Agendamiento (URL)"}),c.jsx("input",{name:"urlAgendamiento",className:"emp-input",inputMode:"url",placeholder:"https://",value:t.urlAgendamiento,onChange:n})]}),c.jsxs("div",{className:"oc-field",children:[c.jsx("label",{className:"emp-label",children:"Rgimen legal"}),c.jsxs("select",{name:"regimen",className:"emp-select",value:t.regimen,onChange:n,children:[c.jsx("option",{value:"",children:"Seleccione"}),c.jsx("option",{children:"Comn"}),c.jsx("option",{children:"Simplificado"})]})]}),c.jsxs("div",{className:"oc-field",children:[c.jsx("label",{className:"emp-label",children:"Responsabilidad tributaria"}),c.jsxs("select",{name:"responsabilidadTributaria",className:"emp-select",value:t.responsabilidadTributaria,onChange:n,children:[c.jsx("option",{value:"",children:"Seleccione"}),c.jsx("option",{children:"No aplica"}),c.jsx("option",{children:"Autorretenedor"})]})]}),c.jsxs("div",{className:"oc-field oc-col-2",children:[c.jsx("label",{className:"emp-label",children:"Correo electrnico"}),c.jsx("input",{name:"correo",className:"emp-input",type:"email",autoComplete:"email",value:t.correo,onChange:n})]}),c.jsxs("div",{className:"oc-field",children:[c.jsx("label",{className:"emp-label",children:"Moneda"}),c.jsxs("select",{name:"moneda",className:"emp-select",value:t.moneda,onChange:n,children:[c.jsx("option",{children:"Pesos colombianos (COP)"}),c.jsx("option",{children:"Dlares (USD)"}),c.jsx("option",{children:"Euros (EUR)"})]})]}),c.jsxs("div",{className:"oc-field",children:[c.jsx("label",{className:"emp-label",children:"Zona horaria"}),c.jsxs("select",{name:"zonaHoraria",className:"emp-select",value:t.zonaHoraria,onChange:n,children:[c.jsx("option",{children:"Hora de Colombia"}),c.jsx("option",{children:"America/Bogota"}),c.jsx("option",{children:"UTC-5"})]})]}),c.jsxs("div",{className:"oc-field oc-col-2",children:[c.jsx("label",{className:"emp-label",children:"Cuenta contable"}),c.jsx("input",{name:"cuentaContable",className:"emp-input",value:t.cuentaContable,onChange:n})]}),c.jsxs("div",{className:"oc-field",children:[c.jsx("label",{className:"emp-label",children:"Es una institucin prestadora de salud (IPS)?"}),c.jsxs("div",{className:"emp-inline",children:[c.jsx("input",{id:"esIPS",type:"checkbox",name:"esIPS",checked:t.esIPS,onChange:n}),c.jsx("label",{htmlFor:"esIPS",children:"S"})]})]}),c.jsxs("div",{className:"oc-field",children:[c.jsx("label",{className:"emp-label",children:"Usuario SISPRO"}),c.jsx("input",{name:"usuarioSispro",className:"emp-input",value:t.usuarioSispro,onChange:n})]}),c.jsxs("div",{className:"oc-field",children:[c.jsx("label",{className:"emp-label",children:"Tipo documento SISPRO"}),c.jsxs("select",{name:"tipoDocSispro",className:"emp-select",value:t.tipoDocSispro,onChange:n,children:[c.jsx("option",{children:"Cdula de Ciudadana"}),c.jsx("option",{children:"Cdula de Extranjera"}),c.jsx("option",{children:"NIT"})]})]}),c.jsxs("div",{className:"oc-field",children:[c.jsx("label",{className:"emp-label",children:"Contrasea SISPRO"}),c.jsx("input",{name:"passwordSispro",className:"emp-input",type:"password",value:t.passwordSispro,onChange:n})]}),c.jsxs("div",{className:"oc-field",children:[c.jsx("label",{className:"emp-label",children:"Cdigo de prestador"}),c.jsx("input",{name:"codigoPrestador",className:"emp-input",value:t.codigoPrestador,onChange:n})]})]}),c.jsx("div",{className:"oc-form-actions",children:c.jsx("button",{type:"submit",className:"oc-btn primary",children:"Guardar"})})]})]})]})}const Bp="empresa_logo_url";function vx(t,e){let n=document.querySelector(`meta[name="${t}"]`);n||(n=document.createElement("meta"),n.setAttribute("name",t),document.head.appendChild(n)),n.setAttribute("content",e)}function t6(){const[t,e]=A.useState(()=>{try{return localStorage.getItem(Bp)||""}catch{return""}}),[n,r]=A.useState(null),[s,i]=A.useState(!1),o=A.useRef(null),a=A.useCallback(T=>{const P=T==null?void 0:T[0];if(!P)return;if(!P.type.startsWith("image/")){alert("Por favor selecciona una imagen (PNG/JPG/SVG/WebP).");return}r(P);const E=new FileReader;E.onload=I=>{var S;return e(String(((S=I.target)==null?void 0:S.result)||""))},E.readAsDataURL(P)},[]),l=T=>a(T.target.files),d=T=>{T.preventDefault(),T.stopPropagation(),i(!1),a(T.dataTransfer.files)},h=T=>{T.preventDefault(),i(!0)},f=()=>i(!1),m=()=>{var T;return(T=o.current)==null?void 0:T.click()},v=()=>{r(null),e("")},R=async()=>{try{t?(localStorage.setItem(Bp,t),vx("company-logo",t)):(localStorage.removeItem(Bp),vx("company-logo","")),alert("Logo guardado.")}catch(T){console.error(T),alert("No se pudo guardar localmente.")}};return c.jsxs("div",{className:"oc-main-content",children:[c.jsx("div",{className:"oc-section-title",children:c.jsx("h2",{children:"Configuracin  Logo empresa"})}),c.jsxs("div",{className:"emp-card",children:[c.jsx("div",{className:"emp-title",children:"Logo"}),c.jsxs("div",{className:"logo-wrap",children:[c.jsxs("div",{className:"logo-current",children:[c.jsx("div",{className:"emp-label",children:"Logo actual"}),c.jsx("div",{className:"logo-preview","aria-live":"polite",children:t?c.jsx("img",{src:t,alt:"Logo actual de la empresa"}):c.jsx("div",{className:"logo-empty",children:"Sin logo"})}),c.jsx("div",{className:"logo-actions",children:c.jsx("button",{type:"button",className:"oc-btn danger",onClick:v,disabled:!t,children:"Eliminar"})})]}),c.jsxs("div",{className:"logo-uploader",children:[c.jsx("div",{className:"emp-label",children:"Cargar foto"}),c.jsxs("div",{className:`logo-drop ${s?"over":""}`,onDragOver:h,onDragLeave:f,onDrop:d,onClick:m,role:"button",tabIndex:0,onKeyDown:T=>(T.key==="Enter"||T.key===" ")&&m(),"aria-label":"Arrastra o haz click para cargar la imagen del logo",children:[c.jsx("input",{ref:o,type:"file",accept:"image/*",onChange:l,style:{display:"none"}}),c.jsxs("div",{className:"logo-drop-hint",children:["Arrastra o click para cargar la foto.",c.jsx("div",{className:"logo-subhint",children:"Solo archivos de imagen"})]})]}),n&&c.jsxs("div",{className:"logo-file-name",children:["Archivo seleccionado: ",c.jsx("b",{children:n.name})]})]})]}),c.jsx("div",{className:"oc-form-actions",children:c.jsx("button",{type:"button",className:"oc-btn primary",onClick:R,children:"Guardar"})})]})]})}const n6={"datos-basicos":XA,logo:t6};function r6(t=""){const e=t.toLowerCase().indexOf("/config/");return e===-1?"":t.slice(e+8).split("/").filter(Boolean)[0]||""}function s6({title:t="Datos bsicos"}){return c.jsxs("div",{className:"oc-main-content",children:[c.jsx("div",{className:"oc-section-title",children:c.jsxs("h2",{children:["Configuracin  ",t]})}),c.jsxs("div",{className:"card",children:[c.jsx("h3",{children:t}),c.jsx("p",{className:"oc-muted",style:{textAlign:"center",padding:"12px 6px"},children:"Esta pantalla an no est implementada."})]})]})}function i6(){const{pathname:t}=Kn(),e=r6(t),n=n6[e];if(!e)return c.jsx(XA,{});if(!n){const r=e.split("-").map(s=>s.charAt(0).toUpperCase()+s.slice(1)).join(" ");return c.jsx(s6,{title:r})}return c.jsx(n,{})}const Vr=t=>(Number(t)||0).toLocaleString("es-CO",{maximumFractionDigits:0}),Uo=()=>new Date().toISOString().slice(0,10),o6=(t=new Date)=>new Date(t.getFullYear(),t.getMonth(),t.getDate(),0,0,0,0),a6=(t=new Date)=>new Date(t.getFullYear(),t.getMonth(),t.getDate()+1,0,0,0,0),_x=t=>Be.fromDate(t),l6=()=>{const[t,e]=A.useState(null);return A.useEffect(()=>{const n=jy(bh,r=>e(r||null));return()=>n()},[]),t},zt=({children:t,align:e})=>c.jsx("th",{className:"oc-th",style:{position:"sticky",top:0,zIndex:1,textAlign:e||"left",background:"var(--oc-surface, #fff)"},children:t}),c6=()=>Math.random().toString(36).slice(2)+Math.random().toString(36).slice(2);function u6(){var be;const t=l6(),e=[{key:"abrir",label:"Abrir caja",icon:""},{key:"abiertas",label:"Cajas abiertas",icon:""},{key:"cerradas",label:"Cajas cerradas",icon:""},{key:"mio",label:"Mi caja (hoy)",icon:""},{key:"simulados",label:"Cierres simulados",icon:""},{key:"bancos",label:"Bancos",icon:""}],[n,r]=A.useState("abiertas"),[s,i]=A.useState(""),[o,a]=A.useState(""),l=A.useRef(null),[d,h]=A.useState(!1),[f,m]=A.useState(""),[v,R]=A.useState([]),[T,P]=A.useState(!0),[E,I]=A.useState([]),[S,b]=A.useState(!0),[L,B]=A.useState(null),[w,_]=A.useState(!0),[y,N]=A.useState(""),[D,j]=A.useState([]),[k,K]=A.useState(null),[Ke,Ft]=A.useState(""),[dn,Z]=A.useState("efectivo"),[de,pe]=A.useState(!1),[Re,Xe]=A.useState("ingreso"),[Dt,U]=A.useState(""),[ne,ce]=A.useState(""),[xe,Te]=A.useState(!1),[je,we]=A.useState([]),[it,Se]=A.useState([]);A.useEffect(()=>{const M=st($e(ye,"cajas"),Je("estado","==","abierta"),gn("fechaApertura","desc")),X=Fn(M,te=>{R(te.docs.map(Ne=>ie(Ne.id,Ne.data()))),P(!1),i("")},te=>{console.error(te),i((te==null?void 0:te.code)==="failed-precondition"?"Falta ndice (estado, fechaApertura) en Firestore.":(te==null?void 0:te.code)==="permission-denied"?"Permiso denegado en Firestore (revisa reglas).":"No se pudieron leer las cajas."),P(!1)});return()=>X()},[]),A.useEffect(()=>{const M=st($e(ye,"cajas"),Je("estado","==","cerrada"),gn("fechaCierre","desc")),X=Fn(M,te=>{I(te.docs.map(Ne=>ie(Ne.id,Ne.data()))),b(!1)},te=>{console.error(te),b(!1)});return()=>X()},[]),A.useEffect(()=>{if(!t){B(null),_(!1);return}_(!0);const M=st($e(ye,"cajas"),Je("estado","==","abierta"),Je("usuarioId","==",t.uid),Je("fechaApertura",">=",_x(o6())),Je("fechaApertura","<",_x(a6()))),X=Fn(M,te=>{const Ne=te.docs[0];B(Ne?ie(Ne.id,Ne.data()):null),_(!1)},te=>{console.error(te),_(!1),(te==null?void 0:te.code)==="failed-precondition"&&i("Falta ndice (estado, usuarioId, fechaApertura) en Firestore.")});return()=>X()},[t]),A.useEffect(()=>{if(!(L!=null&&L.id)){we([]),Se([]);return}const M=st($e(ye,"movimientos"),Je("cashId","==",L.id),Je("dia","==",Uo()),gn("fecha","desc")),X=Fn(M,nt=>we(nt.docs.map(St=>({id:St.id,...St.data()}))),nt=>console.error(nt)),te=st($e(ye,"payments"),Je("cashId","==",L.id),Je("dia","==",Uo()),gn("fecha","desc")),Ne=Fn(te,nt=>Se(nt.docs.map(St=>({id:St.id,...St.data()}))),nt=>console.error(nt));return()=>{X(),Ne()}},[L==null?void 0:L.id]),A.useEffect(()=>{if(!(y!=null&&y.trim())){j([]);return}const M=st($e(ye,"patients"),Je("q",">=",q(y)),Je("q","<=",q(y)+""),gn("q","asc")),X=Fn(M,te=>j(te.docs.map(Ne=>({id:Ne.id,...Ne.data()}))),te=>console.error(te));return()=>X()},[y]);function ie(M,X={}){const te=bt=>{var Ut;return((Ut=bt==null?void 0:bt.toDate)==null?void 0:Ut.call(bt))||(typeof bt=="string"?new Date(bt):bt||null)},Ne=te(X.fechaApertura),nt=te(X.fechaCierre),St=Number(X.baseInicial||0),Rr=Number(X.baseActual!==void 0?X.baseActual:St),xn=Number(X.saldoInicial||0),jn=Number(X.saldoActual!==void 0?X.saldoActual:xn),Zt=[];return jn<0&&Zt.push("Saldo negativo"),Rr<0&&Zt.push("Base negativa"),{id:M,estado:X.estado||"abierta",usuarioId:X.usuarioId||"",usuarioNombre:X.usuarioNombre||"Usuario",nombre:X.nombre||X.usuarioNombre||"Caja",fechaApertura:Ne,fechaCierre:nt,baseInicial:St,baseActual:Rr,saldoInicial:xn,saldoActual:jn,ia:Zt}}const Pe=async M=>{var X;if((X=M==null?void 0:M.preventDefault)==null||X.call(M),!t){i("Debes iniciar sesin para abrir una caja.");return}h(!0);try{const te=Number(f||0);await oa($e(ye,"cajas"),{estado:"abierta",usuarioId:t.uid,usuarioNombre:t.displayName||t.email||"Usuario",fechaApertura:Xn(),baseInicial:te,baseActual:te,saldoInicial:0,saldoActual:0,dia:Uo()}),m(""),r("mio"),i("")}catch(te){console.error(te),i("No se pudo abrir la caja.")}finally{h(!1)}},Me=async M=>{try{await _a(Yt(ye,"cajas",M),{estado:"cerrada",fechaCierre:Xn()}),r("cerradas")}catch(X){console.error(X),i("No se pudo cerrar la caja.")}},He=async M=>{var te;if((te=M==null?void 0:M.preventDefault)==null||te.call(M),!(L!=null&&L.id)){i("Debes abrir tu caja para registrar movimientos.");return}const X=Number(ne||0);if(!(!X||X<=0)){Te(!0);try{await oa($e(ye,"movimientos"),{cashId:L.id,tipo:Re,concepto:Dt||(Re==="ingreso"?"Ingreso":"Egreso"),valor:X,fecha:Xn(),dia:Uo(),usuarioId:(t==null?void 0:t.uid)||null});const Ne=Re==="ingreso"?X:-X;await _a(Yt(ye,"cajas",L.id),{saldoActual:HI(Ne)}),U(""),ce("")}catch(Ne){console.error(Ne),i("No se pudo registrar el movimiento.")}finally{Te(!1)}}},H=async M=>{var te;if((te=M==null?void 0:M.preventDefault)==null||te.call(M),!(L!=null&&L.id))return i("Abre tu caja para cobrar.");const X=Number(Ke||0);if(!(!X||X<=0)){if(!k)return i("Selecciona un paciente.");pe(!0);try{const Ne=await oa($e(ye,"payments"),{cashId:L.id,patientId:k.id,patientName:k.nombre||k.name||"Paciente",invoiceId:null,valor:X,medio:dn,estado:"aprobado",fecha:Xn(),dia:Uo()});await _a(Yt(ye,"cajas",L.id),{saldoActual:HI(X)}),Ft(""),Z("efectivo"),i(`Pago registrado (${Ne.id}).`)}catch(Ne){console.error(Ne),i("No se pudo registrar el pago.")}finally{pe(!1)}}},se=async M=>{var te;if((te=M==null?void 0:M.preventDefault)==null||te.call(M),!(L!=null&&L.id))return i("Abre tu caja para cobrar.");const X=Number(Ke||0);if(!(!X||X<=0)){if(!k)return i("Selecciona un paciente.");pe(!0);try{const nt=`https://pay.odontocloud/mock/${c6()}`,St=await oa($e(ye,"payments"),{cashId:L.id,patientId:k.id,patientName:k.nombre||k.name||"Paciente",invoiceId:null,valor:X,medio:"link",estado:"pending",linkUrl:nt,fecha:Xn(),dia:Uo()});i(`Link de pago generado: ${nt}`),Ft("")}catch(Ne){console.error(Ne),i("No se pudo generar link de pago.")}finally{pe(!1)}}},q=M=>(M||"").toString().normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase(),re=A.useMemo(()=>{const M=q(o);return M?v.filter(X=>[X.nombre,X.usuarioNombre,Vr(X.saldoActual),Vr(X.baseActual)].map(q).some(te=>te.includes(M))):v},[o,v]),ae=()=>c.jsxs("div",{className:"card",children:[c.jsx("div",{className:"oc-card-head",style:{marginBottom:8},children:c.jsx("h3",{children:"Abrir caja"})}),c.jsxs("form",{className:"oc-form",onSubmit:Pe,style:{display:"flex",gap:12,alignItems:"end",flexWrap:"wrap"},children:[c.jsxs("label",{style:{display:"inline-flex",flexDirection:"column",gap:6},children:[c.jsx("span",{children:"Base inicial (COP)"}),c.jsx("input",{type:"number",className:"oc-input",min:"0",step:"1000",value:f,onChange:M=>m(M.target.value),placeholder:"0"})]}),c.jsx("button",{className:"oc-btn",type:"submit",disabled:d,children:d?"Abriendo...":"Abrir caja"})]}),c.jsxs("p",{className:"oc-muted",style:{marginTop:8},children:["Se asociar a tu usuario y quedar visible en ",c.jsx("b",{children:"Mi caja (hoy)"}),"."]})]}),ge=()=>c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"card",style:{marginBottom:10},children:c.jsxs("div",{className:"oc-card-head",style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[c.jsx("h3",{style:{margin:0},children:"Cajas Abiertas"}),c.jsx("span",{className:"oc-tag",children:re.length}),s&&c.jsx("span",{className:"oc-tag oc-tag-danger",children:s})]}),c.jsx("input",{ref:l,className:"oc-input",style:{maxWidth:280},placeholder:"Buscar...",value:o,onChange:M=>a(M.target.value)})]})}),c.jsx("div",{className:"card",children:c.jsx("div",{className:"oc-table-wrap",children:c.jsxs("table",{className:"oc-table",children:[c.jsx("thead",{className:"oc-thead",children:c.jsxs("tr",{className:"oc-tr",children:[c.jsx(zt,{children:"Caja"}),c.jsx(zt,{children:"Fecha apertura"}),c.jsx(zt,{align:"right",children:"Base actual"}),c.jsx(zt,{align:"right",children:"Saldo inicial"}),c.jsx(zt,{align:"right",children:"Saldo actual"}),c.jsx(zt,{children:"Usuario"}),c.jsx(zt,{children:"Acciones"})]})}),c.jsx("tbody",{className:"oc-tbody",children:T?c.jsx(wx,{cols:7}):re.length===0?c.jsx("tr",{className:"oc-tr",children:c.jsx("td",{className:"oc-td",colSpan:7,children:c.jsx("span",{className:"oc-muted",children:"Sin cajas abiertas."})})}):re.map(M=>{var X;return c.jsxs("tr",{className:"oc-tr",children:[c.jsxs("td",{className:"oc-td",children:[c.jsx("b",{children:M.nombre})," ",(X=M.ia)!=null&&X.length?c.jsx("span",{className:"oc-tag oc-tag-danger",title:M.ia.join("  "),children:"IA"}):null]}),c.jsx("td",{className:"oc-td",children:M.fechaApertura?M.fechaApertura.toLocaleString("es-CO"):""}),c.jsxs("td",{className:"oc-td",style:{textAlign:"right"},children:["$",Vr(M.baseActual)]}),c.jsxs("td",{className:"oc-td",style:{textAlign:"right"},children:["$",Vr(M.saldoInicial)]}),c.jsxs("td",{className:"oc-td",style:{textAlign:"right",color:M.saldoActual<0?"#b91c1c":void 0,fontWeight:600},children:["$",Vr(M.saldoActual)]}),c.jsx("td",{className:"oc-td",children:M.usuarioNombre}),c.jsxs("td",{className:"oc-td",style:{whiteSpace:"nowrap"},children:[c.jsx("button",{className:"oc-small-btn",onClick:()=>r("mio"),children:"Ver"})," ",c.jsx("button",{className:"oc-small-btn oc-danger",onClick:()=>Me(M.id),children:"Cerrar"})]})]},M.id)})})]})})})]}),_e=()=>c.jsxs("div",{className:"card",children:[c.jsxs("div",{className:"oc-card-head",style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[c.jsx("h3",{children:"Mi caja (hoy)"}),(L==null?void 0:L.estado)==="abierta"&&c.jsxs("div",{style:{display:"flex",gap:8},children:[c.jsx("span",{className:"oc-tag oc-tag-success",children:"Abierta"}),c.jsx("button",{className:"oc-small-btn oc-danger",onClick:()=>Me(L.id),children:"Cerrar caja"})]})]}),w?c.jsx("div",{className:"oc-muted",children:"Cargando"}):L?c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"oc-stats-row",style:{marginBottom:12},children:[c.jsxs("div",{className:"stat-card",children:[c.jsx("span",{className:"stat-label",children:"Base actual"}),c.jsxs("span",{className:"stat-value",children:["$",Vr(L.baseActual)]})]}),c.jsxs("div",{className:"stat-card",children:[c.jsx("span",{className:"stat-label",children:"Saldo actual"}),c.jsxs("span",{className:"stat-value",style:{color:L.saldoActual<0?"#b91c1c":void 0},children:["$",Vr(L.saldoActual)]})]})]}),c.jsxs("div",{className:"card",style:{marginBottom:12},children:[c.jsx("h4",{style:{marginBottom:8},children:"Cobro rpido"}),c.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr auto",gap:8},children:[c.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:6},children:[c.jsx("label",{className:"oc-muted",children:"Paciente"}),c.jsx("input",{className:"oc-input",placeholder:"Buscar nombre o documento",value:y,onChange:M=>N(M.target.value)}),y&&D.length>0&&c.jsx("div",{className:"oc-dropdown",children:D.slice(0,6).map(M=>c.jsx("button",{className:`oc-menu-item ${(k==null?void 0:k.id)===M.id?"active":""}`,onClick:()=>{K(M),N(M.nombre||M.name||M.doc||"")},type:"button",children:(M.nombre||M.name||"Paciente")+(M.doc?`  ${M.doc}`:"")},M.id))})]}),c.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:6},children:[c.jsx("label",{className:"oc-muted",children:"Monto (COP)"}),c.jsx("input",{className:"oc-input",type:"number",min:"0",step:"1000",placeholder:"0",value:Ke,onChange:M=>Ft(M.target.value)})]}),c.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:6},children:[c.jsx("label",{className:"oc-muted",children:"Medio"}),c.jsxs("select",{className:"oc-input",value:dn,onChange:M=>Z(M.target.value),children:[c.jsx("option",{value:"efectivo",children:"Efectivo"}),c.jsx("option",{value:"tarjeta",children:"Tarjeta"}),c.jsx("option",{value:"transferencia",children:"Transferencia"}),c.jsx("option",{value:"link",children:"Link (en lnea)"})]})]}),c.jsx("div",{style:{display:"flex",alignItems:"end",gap:6},children:dn==="link"?c.jsx("button",{className:"oc-btn",onClick:se,disabled:de,children:de?"Creando":"Generar link"}):c.jsx("button",{className:"oc-btn",onClick:H,disabled:de,children:de?"Guardando":"Registrar pago"})})]}),c.jsxs("p",{className:"oc-muted",style:{marginTop:8},children:["Para link, el saldo se actualiza cuando el pago pase a ",c.jsx("b",{children:"aprobado"})," (webhook)."]})]}),c.jsxs("div",{className:"card",style:{marginBottom:12},children:[c.jsx("h4",{style:{marginBottom:8},children:"Movimiento manual"}),c.jsxs("form",{onSubmit:He,style:{display:"grid",gridTemplateColumns:"120px 1fr 180px auto",gap:8},children:[c.jsxs("select",{className:"oc-input",value:Re,onChange:M=>Xe(M.target.value),children:[c.jsx("option",{value:"ingreso",children:"Ingreso"}),c.jsx("option",{value:"egreso",children:"Egreso"})]}),c.jsx("input",{className:"oc-input",placeholder:"Concepto (ej. Caja chica, Arriendo, etc.)",value:Dt,onChange:M=>U(M.target.value)}),c.jsx("input",{className:"oc-input",type:"number",min:"0",step:"1000",placeholder:"0",value:ne,onChange:M=>ce(M.target.value)}),c.jsx("button",{className:"oc-btn",disabled:xe,children:xe?"Guardando":"Agregar"})]})]}),c.jsxs("div",{className:"card",children:[c.jsx("h4",{style:{marginBottom:8},children:"Movimientos y pagos (hoy)"}),c.jsx("div",{className:"oc-table-wrap",style:{marginBottom:12},children:c.jsxs("table",{className:"oc-table",children:[c.jsx("thead",{className:"oc-thead",children:c.jsxs("tr",{className:"oc-tr",children:[c.jsx(zt,{children:"Tipo"}),c.jsx(zt,{children:"Concepto / Paciente"}),c.jsx(zt,{children:"Medio"}),c.jsx(zt,{children:"Estado"}),c.jsx(zt,{align:"right",children:"Valor"}),c.jsx(zt,{children:"Hora"})]})}),c.jsx("tbody",{className:"oc-tbody",children:je.length===0&&it.length===0?c.jsx("tr",{className:"oc-tr",children:c.jsx("td",{className:"oc-td",colSpan:6,children:c.jsx("span",{className:"oc-muted",children:"Sin movimientos ni pagos an."})})}):c.jsxs(c.Fragment,{children:[it.map(M=>{var X,te;return c.jsxs("tr",{className:"oc-tr",children:[c.jsx("td",{className:"oc-td",children:"Pago"}),c.jsxs("td",{className:"oc-td",children:[M.patientName||"Paciente"," ",M.linkUrl?c.jsx("a",{href:M.linkUrl,target:"_blank",rel:"noreferrer",children:"(link)"}):null]}),c.jsx("td",{className:"oc-td",children:M.medio}),c.jsx("td",{className:"oc-td",children:c.jsx("span",{className:`oc-tag ${M.estado==="aprobado"?"oc-tag-success":M.estado==="pending"?"oc-tag-warning":"oc-tag-danger"}`,children:M.estado})}),c.jsxs("td",{className:"oc-td",style:{textAlign:"right"},children:["$",Vr(M.valor)]}),c.jsx("td",{className:"oc-td",children:(te=(X=M.fecha)==null?void 0:X.toDate)!=null&&te.call(X)?M.fecha.toDate().toLocaleTimeString("es-CO"):""})]},`pay-${M.id}`)}),je.map(M=>{var X,te;return c.jsxs("tr",{className:"oc-tr",children:[c.jsx("td",{className:"oc-td",children:M.tipo}),c.jsx("td",{className:"oc-td",children:M.concepto}),c.jsx("td",{className:"oc-td",children:""}),c.jsx("td",{className:"oc-td",children:c.jsx("span",{className:"oc-tag",children:(M.tipo==="ingreso","ok")})}),c.jsxs("td",{className:"oc-td",style:{textAlign:"right"},children:["$",Vr(M.valor)]}),c.jsx("td",{className:"oc-td",children:(te=(X=M.fecha)==null?void 0:X.toDate)!=null&&te.call(X)?M.fecha.toDate().toLocaleTimeString("es-CO"):""})]},`mov-${M.id}`)})]})})]})}),c.jsx("p",{className:"oc-muted",children:"Sugerencia: crea ndice compuesto para `movimientos(cashId, dia, fecha)` y `payments(cashId, dia, fecha)` para rendimiento."})]})]}):c.jsxs("div",{className:"oc-empty",children:[c.jsx("p",{className:"oc-muted",children:"No tienes una caja abierta hoy."}),c.jsx("button",{className:"oc-btn",onClick:()=>r("abrir"),children:"Abrir caja"})]})]}),Fe=()=>c.jsxs("div",{className:"card",children:[c.jsx("div",{className:"oc-card-head",style:{marginBottom:8},children:c.jsxs("h3",{children:["Cajas cerradas ",c.jsx("span",{className:"oc-tag",children:E.length})]})}),c.jsx("div",{className:"oc-table-wrap",children:c.jsxs("table",{className:"oc-table",children:[c.jsx("thead",{className:"oc-thead",children:c.jsxs("tr",{className:"oc-tr",children:[c.jsx(zt,{children:"Caja"}),c.jsx(zt,{children:"Usuario"}),c.jsx(zt,{children:"Apertura"}),c.jsx(zt,{children:"Cierre"}),c.jsx(zt,{align:"right",children:"Saldo final"})]})}),c.jsx("tbody",{className:"oc-tbody",children:S?c.jsx(wx,{cols:5}):E.length===0?c.jsx("tr",{className:"oc-tr",children:c.jsx("td",{className:"oc-td",colSpan:5,children:c.jsx("span",{className:"oc-muted",children:"Sin cajas cerradas."})})}):E.map(M=>c.jsxs("tr",{className:"oc-tr",children:[c.jsx("td",{className:"oc-td",children:M.nombre}),c.jsx("td",{className:"oc-td",children:M.usuarioNombre}),c.jsx("td",{className:"oc-td",children:M.fechaApertura?M.fechaApertura.toLocaleString("es-CO"):""}),c.jsx("td",{className:"oc-td",children:M.fechaCierre?M.fechaCierre.toLocaleString("es-CO"):""}),c.jsxs("td",{className:"oc-td",style:{textAlign:"right"},children:["$",Vr(M.saldoActual)]})]},M.id))})]})})]}),Ce=()=>c.jsxs("div",{className:"card",children:[c.jsx("h3",{children:"Cierres simulados"}),c.jsx("p",{className:"oc-muted",children:"El cierre hipottico compara ventas y movimientos detectando errores y descuadres con IA. (Conectar fuente de datos para activarlo)."})]}),ze=()=>c.jsxs("div",{className:"card",children:[c.jsx("h3",{children:"Bancos"}),c.jsx("p",{className:"oc-muted",children:"Conciliacin de consignaciones/pagos electrnicos contra caja del da. (Conectar pasarela o extractos para habilitar)."})]}),De=({m:M})=>c.jsxs("button",{type:"button",onClick:()=>r(M.key),className:`oc-menu-item ${n===M.key?"active":""}`,style:{width:"100%",textAlign:"left",padding:"10px 12px",borderRadius:10,border:"1px solid transparent",background:n===M.key?"var(--oc-surface-2, #f3f6ff)":"transparent",fontWeight:600},title:M.label,children:[c.jsx("span",{style:{opacity:.8,marginRight:6},children:M.icon}),M.label]});return c.jsxs("div",{className:"oc-main-content",style:{display:"grid",gridTemplateColumns:"240px 1fr",gap:16},children:[c.jsx("aside",{className:"card",role:"navigation","aria-label":"Men de caja",style:{height:"fit-content",padding:12},children:c.jsx("div",{style:{display:"flex",flexDirection:"column",gap:8},children:e.map(M=>c.jsx(De,{m:M},M.key))})}),c.jsxs("section",{children:[c.jsx("div",{className:"card",style:{marginBottom:12,padding:12},children:c.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",gap:12},children:[c.jsxs("div",{className:"oc-breadcrumb",children:[c.jsx("span",{children:"Caja"}),c.jsx("span",{children:""}),c.jsx("b",{children:(be=e.find(M=>M.key===n))==null?void 0:be.label})]}),n==="abiertas"&&c.jsx("input",{ref:l,className:"oc-input",placeholder:"Buscar...",value:o,onChange:M=>a(M.target.value),style:{maxWidth:300}})]})}),n==="abrir"&&c.jsx(ae,{}),n==="abiertas"&&c.jsx(ge,{}),n==="cerradas"&&c.jsx(Fe,{}),n==="mio"&&c.jsx(_e,{}),n==="simulados"&&c.jsx(Ce,{}),n==="bancos"&&c.jsx(ze,{})]})]})}function wx({cols:t=6,n:e=3}){return c.jsx(c.Fragment,{children:Array.from({length:e}).map((n,r)=>c.jsx("tr",{className:"oc-tr",children:Array.from({length:t}).map((s,i)=>c.jsx("td",{className:"oc-td",children:c.jsx("div",{style:{height:12,width:i===0?160:100+i%3*40,background:"var(--oc-skeleton, #e5e7eb)",borderRadius:6}})},i))},r))})}function d6({items:t=[]}){return c.jsxs("div",{className:"card activity-card",children:[c.jsx("h4",{children:"Actividad reciente"}),c.jsx("ul",{className:"activity-list",children:t.map(e=>c.jsxs("li",{children:[c.jsx("strong",{children:e.title}),c.jsx("div",{className:"time",children:e.time})]},e.id))})]})}function h6({status:t}){return t?c.jsxs("div",{className:"card",children:[c.jsx("h4",{children:"Automatizaciones (N8N)"}),c.jsxs("div",{className:"n8n-line",children:[c.jsx("strong",{children:"Conectado:"})," ",t.connected?"S":"No"]}),c.jsxs("div",{className:"n8n-line",children:[c.jsx("strong",{children:"Flujos activos:"})," ",t.flowsRunning]}),t.lastError&&c.jsxs("div",{className:"n8n-error",children:["Error: ",t.lastError]})]}):null}const zp={es:{nav_home:"Inicio",nav_agenda:"Agenda",nav_patients:"Pacientes",nav_billing:"Facturacin",nav_inventory:"Inventario",nav_odontogram:"Odontograma",nav_reports:"Reportes",nav_cash:"Caja",nav_admin:"Administracin",welcomeTitle:"Bienvenido a OdontoCloud",welcomeSubtitle:"Administra tus pacientes, agenda, inventario y facturacin de manera inteligente y moderna.",clinicLabel:"Clnica",userLabel:"Usuario",roleLabel:"Rol",searchPlaceholder:"Buscar acciones o ir a",stats_patientsToday:"Pacientes totales",stats_appointmentsToday:"Citas hoy",stats_revenueToday:"Facturacin hoy",stats_waiting:"En espera",stats_currency:"COP",n8n_title:"Automatizaciones (n8n)",recent_title:"Actividad reciente",recent_empty:"Sin actividad registrada.",loading:"Cargando...",logout:"Cerrar sesin",module_coming:"Mdulo prximamente.",todays_appts:"Citas de hoy",see_schedule:"Ir a Agenda",no_appts_today:"No hay citas programadas hoy.",at:"a las"},en:{nav_home:"Overview",nav_agenda:"Schedule",nav_patients:"Patients",nav_billing:"Billing",nav_inventory:"Inventory",nav_odontogram:"Odontogram",nav_reports:"Reports",nav_cash:"Cash",nav_admin:"Administration",welcomeTitle:"Welcome to OdontoCloud",welcomeSubtitle:"Manage your patients, schedule, inventory and billing in a smart and modern way.",clinicLabel:"Clinic",userLabel:"User",roleLabel:"Role",searchPlaceholder:"Search actions or go to",stats_patientsToday:"Total patients",stats_appointmentsToday:"Appointments today",stats_revenueToday:"Revenue today",stats_waiting:"In waiting room",stats_currency:"COP",n8n_title:"Automations (n8n)",recent_title:"Recent activity",recent_empty:"No activity yet.",loading:"Loading...",logout:"Log out",module_coming:"Module coming soon.",todays_appts:"Today's appointments",see_schedule:"Open Schedule",no_appts_today:"No appointments today.",at:"at"}},JA=()=>typeof navigator>"u"||(navigator.language||navigator.userLanguage||"es").toLowerCase().startsWith("es")?"es":"en",f6=()=>{try{const t=JSON.parse(localStorage.getItem("odc_session"));return t&&Date.now()-t.timestamp<1e3*60*60*24?t:null}catch{return null}},p6=()=>A.useMemo(()=>{const t=new Date,e=new Date(t.getFullYear(),t.getMonth(),t.getDate(),0,0,0,0),n=new Date(t.getFullYear(),t.getMonth(),t.getDate()+1,0,0,0,0);return{startToday:Be.fromDate(e),endToday:Be.fromDate(n),startTodayJS:e}},[]),m6=t=>`${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,"0")}-${String(t.getDate()).padStart(2,"0")}`,g6=(t,e)=>t.toLocaleTimeString(e==="es"?"es-CO":"en-US",{hour:"2-digit",minute:"2-digit"}),y6=(t,e)=>{try{const[n,r,s]=(t||"").split("-").map(a=>parseInt(a,10)),[i=0,o=0]=(e||"00:00").split(":").map(a=>parseInt(a,10));return new Date(n,(r||1)-1,s||1,i,o,0,0)}catch{return new Date}};function v6({data:t=[]}){const s=Math.max(1,...t.map(d=>Number(d.value)||0)),i=t.length||7,o=10,a=Math.max(16,Math.min(44,(640-o*(i+1))/i)),l=(a+o)*i+o;return c.jsx("div",{style:{width:"100%",overflowX:"auto"},children:c.jsxs("svg",{width:l,height:240,role:"img","aria-label":"Pacientes registrados por da en la ltima semana",children:[[.25,.5,.75,1].map((d,h)=>{const f=18+(1-d)*182;return c.jsx("line",{x1:0,x2:l,y1:f,y2:f,stroke:"#e5e7eb",strokeDasharray:"4 4"},h)}),t.map((d,h)=>{const f=Number(d.value)||0,m=Math.round(f/s*182),v=o+h*(a+o),R=200-m;return c.jsxs("g",{children:[c.jsx("rect",{x:v,y:R,width:a,height:m,rx:"6",ry:"6",fill:f>0?"#0ea5e9":"#cbd5e1",children:c.jsx("title",{children:`${d.label||d.shortLabel||""}  ${f} paciente${f!==1?"s":""}`})}),f>0&&m>14&&c.jsx("text",{x:v+a/2,y:R-6,textAnchor:"middle",fontSize:"11",fill:"#0f172a",children:f}),c.jsx("text",{x:v+a/2,y:214,textAnchor:"middle",fontSize:"11",fill:"#64748b",children:d.shortLabel||""})]},h)})]})})}function _6({onNavigate:t,onAction:e,placeholder:n}){const[r,s]=A.useState(""),[i,o]=A.useState(!1),[a,l]=A.useState(0),d=A.useRef(null),h=A.useMemo(()=>[{group:"Navegacin",label:"Ir a Inicio",keywords:"inicio home overview",run:()=>t==null?void 0:t("Inicio")},{group:"Navegacin",label:"Ir a Agenda",keywords:"agenda calendario schedule",run:()=>t==null?void 0:t("Agenda")},{group:"Navegacin",label:"Ir a Pacientes",keywords:"pacientes",run:()=>t==null?void 0:t("Pacientes")},{group:"Navegacin",label:"Ir a Facturacin",keywords:"facturacion facturas billing",run:()=>t==null?void 0:t("Facturacin")},{group:"Navegacin",label:"Ir a Inventario",keywords:"inventario stock",run:()=>t==null?void 0:t("Inventario")},{group:"Navegacin",label:"Ir a Odontograma",keywords:"odontograma",run:()=>t==null?void 0:t("Odontograma")},{group:"Navegacin",label:"Ir a Reportes",keywords:"reportes informes",run:()=>t==null?void 0:t("Reportes")},{group:"Acciones",label:"Nueva cita",keywords:"nueva cita agendar",run:()=>e==null?void 0:e("new_appointment")},{group:"Acciones",label:"Nuevo paciente",keywords:"nuevo paciente alta",run:()=>e==null?void 0:e("new_patient")},{group:"Acciones",label:"Nueva factura",keywords:"nueva factura",run:()=>e==null?void 0:e("new_invoice")},{group:"Acciones",label:"Exportar agenda",keywords:"exportar agenda",run:()=>e==null?void 0:e("export_agenda")},{group:"Acciones",label:"Ir a hoy (Agenda)",keywords:"hoy today",run:()=>e==null?void 0:e("agenda_today")},{group:"Acciones",label:"Cambiar modo oscuro",keywords:"oscuro dark mode",run:()=>e==null?void 0:e("toggle_dark")},{group:"Acciones",label:"Cerrar sesin",keywords:"logout salir cerrar",run:()=>e==null?void 0:e("logout")},{group:"Ayuda",label:"Ver atajos de teclado",keywords:"atajos ayuda",run:()=>e==null?void 0:e("show_shortcuts")},{group:"Ayuda",label:"Soporte / Contacto",keywords:"soporte ayuda contacto",run:()=>e==null?void 0:e("support")}],[t,e]),f=A.useMemo(()=>{const T=r.toLowerCase().trim();return T?h.filter(P=>P.label.toLowerCase().includes(T)||P.keywords.includes(T)):[]},[r,h]);A.useEffect(()=>{const T=P=>{d.current&&(d.current.contains(P.target)||o(!1))};return document.addEventListener("mousedown",T),()=>document.removeEventListener("mousedown",T)},[]);const m=T=>{var P;(P=T.run)==null||P.call(T),s(""),o(!1)},v=T=>{!i||f.length===0||(T.key==="ArrowDown"&&(T.preventDefault(),l(P=>(P+1)%f.length)),T.key==="ArrowUp"&&(T.preventDefault(),l(P=>(P-1+f.length)%f.length)),T.key==="Enter"&&(T.preventDefault(),f[a]&&m(f[a])),T.key==="Escape"&&o(!1))},R=A.useMemo(()=>{const T=new Map;return f.forEach(P=>{T.has(P.group)||T.set(P.group,[]),T.get(P.group).push(P)}),Array.from(T.entries())},[f]);return c.jsxs("div",{className:"oc-search-wrap",ref:d,children:[c.jsx("input",{className:"oc-search",type:"search",inputMode:"search",placeholder:n,"aria-label":n,value:r,onChange:T=>{s(T.target.value),o(!!T.target.value),l(0)},onFocus:()=>o(!!r),onKeyDown:v}),i&&c.jsx("div",{className:"oc-search-dropdown",role:"listbox","aria-label":"Resultados de comandos",children:R.length===0?c.jsx("div",{className:"oc-search-item empty",children:"Escribe para ver opciones"}):R.map(([T,P])=>c.jsxs("div",{children:[c.jsx("div",{className:"oc-search-group",children:T}),P.map(E=>{const I=f.indexOf(E);return c.jsx("button",{className:`oc-search-item ${I===a?"active":""}`,onMouseEnter:()=>l(I),onClick:()=>m(E),role:"option",children:c.jsx("span",{className:"oc-search-title",children:E.label})},E.label)})]},T))})]})}function w6({open:t,anchorRect:e,onClose:n,onSoon:r,onNavigatePath:s,onSetFactView:i,dark:o}){const[a,l]=A.useState(null),d=A.useRef(null);if(A.useEffect(()=>{if(!t)return;const K=Ft=>Ft.key==="Escape"&&(n==null?void 0:n()),Ke=()=>n==null?void 0:n();return window.addEventListener("keydown",K),window.addEventListener("scroll",Ke,!0),()=>{window.removeEventListener("keydown",K),window.removeEventListener("scroll",Ke,!0)}},[t,n]),!t)return null;const h=((e==null?void 0:e.bottom)||60)+8,f=Math.max(12,Math.min(((e==null?void 0:e.left)||300)-160,window.innerWidth-920)),m=10,v=f+360+m,R=o?"#0b1220":"#ffffff",T=o?"#e5e7eb":"#0f172a",P=o?"#0f1a32":"#f3f6ff",E=o?"#1f2a44":"#e2e8f0",I=o?"#b6c1d1":"#475569",S={position:"fixed",top:h,left:f,width:880,maxWidth:"calc(100vw - 24px)",background:R,color:T,borderRadius:14,boxShadow:"0 18px 40px rgba(2,6,23,.18)",border:`1px solid ${E}`,zIndex:400,padding:12},b={position:"fixed",top:h,left:v,width:420,maxWidth:"calc(100vw - 24px)",background:R,color:T,borderRadius:14,boxShadow:"0 18px 40px rgba(2,6,23,.18)",border:`1px solid ${E}`,zIndex:410,padding:12},L={display:"flex",flexDirection:"column",gap:6,padding:"8px 10px"},B={height:38,borderRadius:10,padding:"0 12px",display:"flex",alignItems:"center",gap:8,fontSize:".92rem",cursor:"pointer",border:"1px solid transparent",background:"transparent",color:T,fontWeight:500,textAlign:"left"},w=(K,Ke=!0)=>Object.assign(K.currentTarget.style,Ke?{background:P,borderColor:E}:{background:"transparent",borderColor:"transparent"}),_=()=>{d.current&&clearTimeout(d.current)},y=()=>{_(),d.current=setTimeout(()=>n==null?void 0:n(),180)},N={position:"fixed",top:h,left:f+360,width:m,height:520,zIndex:405},D=[{label:"Recibo de caja",key:"recibo",path:"facturacion/recibo"},{label:"Saldo a favor",key:"saldo",path:"facturacion/saldo"},{label:"Nota crdito",key:"nc",path:"facturacion/nc"},{label:"Nota dbito",key:"nd",path:"facturacion/nd"},{label:"Liquidaciones",key:"liq",path:"facturacion/liq"},{label:"Traslados",key:"tras",path:"facturacion/tras"},{label:"Pagos",key:"pagos",path:"facturacion/pagos"},{label:"rdenes de compra",key:"oc",path:"facturacion/oc"},{label:"Factura de venta",key:"fv",path:"facturacion/facturas"},{label:"Facturas de compra",key:"fc",path:"facturacion/fc"}],j=[{label:"RIPS anteriores (RS-3374)",key:"rips3374"},{label:"RIPS nuevo (RS-2275)",key:"rips2275"}],k=K=>{i==null||i(K.key),s==null||s(K.path),n==null||n()};return c.jsxs(c.Fragment,{children:[c.jsx("div",{onClick:n,style:{position:"fixed",inset:0,background:"transparent",zIndex:399}}),c.jsx("div",{style:S,onMouseEnter:_,onMouseLeave:y,children:c.jsxs("div",{style:{display:"grid",gridTemplateColumns:"360px 1fr",gap:8,alignItems:"start"},children:[c.jsxs("div",{style:L,children:[c.jsx("button",{type:"button",style:B,onMouseEnter:()=>{_(),l("facturacion")},onFocus:()=>{_(),l("facturacion")},onClick:()=>l(K=>K==="facturacion"?null:"facturacion"),onMouseOver:K=>w(K,!0),onMouseOut:K=>w(K,!1),children:" Facturacin "}),c.jsx("button",{type:"button",style:B,onMouseEnter:()=>{_(),l("rips")},onFocus:()=>{_(),l("rips")},onClick:()=>l(K=>K==="rips"?null:"rips"),onMouseOver:K=>w(K,!0),onMouseOut:K=>w(K,!1),children:" RIPS "}),c.jsx("button",{type:"button",style:B,onClick:()=>s==null?void 0:s("agenda"),onMouseOver:K=>w(K,!0),onMouseOut:K=>w(K,!1),children:" Gestin de agenda"}),c.jsx("button",{type:"button",style:B,onClick:()=>s==null?void 0:s("inventario"),onMouseOver:K=>w(K,!0),onMouseOut:K=>w(K,!1),children:" Inventario"}),c.jsx("button",{type:"button",style:B,onClick:()=>r==null?void 0:r(),onMouseOver:K=>w(K,!0),onMouseOut:K=>w(K,!1),children:" Convenios"}),c.jsx("button",{type:"button",style:B,onClick:()=>r==null?void 0:r(),onMouseOver:K=>w(K,!0),onMouseOut:K=>w(K,!1),children:" Terceros"}),c.jsx("button",{type:"button",style:B,onClick:()=>r==null?void 0:r(),onMouseOver:K=>w(K,!0),onMouseOut:K=>w(K,!1),children:" Campaas"}),c.jsx("button",{type:"button",style:B,onClick:()=>r==null?void 0:r(),onMouseOver:K=>w(K,!0),onMouseOut:K=>w(K,!1),children:" Temperatura y humedad"}),c.jsx("button",{type:"button",style:B,onClick:()=>r==null?void 0:r(),onMouseOver:K=>w(K,!0),onMouseOut:K=>w(K,!1),children:" Residuos"}),c.jsx("button",{type:"button",style:B,onClick:()=>r==null?void 0:r(),onMouseOver:K=>w(K,!0),onMouseOut:K=>w(K,!1),children:" Medicamentos y planes"}),c.jsx("button",{type:"button",style:B,onClick:()=>r==null?void 0:r(),onMouseOver:K=>w(K,!0),onMouseOut:K=>w(K,!1),children:" Esterilizacin"})]}),c.jsx("div",{style:L,children:c.jsxs("div",{style:{fontSize:".85rem",color:I},children:["Accesos rpidos a mdulos de administracin. Pasa el mouse por ",c.jsx("b",{children:"Facturacin"})," o ",c.jsx("b",{children:"RIPS"})," para ver sus acciones."]})})]})}),c.jsx("div",{style:N,onMouseEnter:_,onMouseLeave:y}),a&&c.jsx("div",{style:b,onMouseEnter:_,onMouseLeave:y,children:c.jsx("div",{style:{...L,display:"grid",gridTemplateColumns:"1fr"},children:(a==="facturacion"?D:j).map(K=>c.jsx("button",{type:"button",style:B,onClick:()=>a==="facturacion"?k(K):r==null?void 0:r(),onMouseOver:Ke=>w(Ke,!0),onMouseOut:Ke=>w(Ke,!1),children:K.label},K.label))})})]})}function E6({t,companyName:e,userName:n,role:r,darkMode:s,weeklySeries:i,weekRangeLabel:o,todaysAppointments:a,todaysLoading:l,metrics:d,metricsLoading:h,n8nState:f,n8nLoading:m,recent:v,recentLoading:R,onGoAgenda:T}){return c.jsxs("div",{className:"oc-main-content",children:[c.jsxs("section",{className:"oc-hero","aria-label":"Resumen general",children:[c.jsxs("div",{className:"oc-hero-text",children:[c.jsx("h1",{children:t("welcomeTitle")}),c.jsx("p",{children:t("welcomeSubtitle")}),c.jsxs("p",{className:"oc-hero-meta",children:[t("clinicLabel"),": ",e,"  ",t("userLabel"),": ",n,"  ",t("roleLabel"),": ",r||""]})]}),c.jsxs("div",{className:"oc-hero-badge","aria-live":"polite",children:[c.jsx("span",{className:"oc-hero-badge-title",children:t("stats_appointmentsToday")}),c.jsx("span",{className:"oc-hero-badge-value",children:h&&l?"":d.citasHoy}),c.jsxs("span",{className:"oc-hero-badge-sub",children:[t("stats_patientsToday"),": ",h?"":d.pacientesHoy]})]})]}),c.jsxs("section",{className:"oc-stats-row","aria-label":"Indicadores del da",children:[c.jsxs("div",{className:"stat-card",children:[c.jsx("span",{className:"stat-label",children:t("stats_patientsToday")}),c.jsx("span",{className:"stat-value",children:d.pacientesHoy})]}),c.jsxs("div",{className:"stat-card",children:[c.jsx("span",{className:"stat-label",children:t("stats_appointmentsToday")}),c.jsx("span",{className:"stat-value",children:d.citasHoy})]}),c.jsxs("div",{className:"stat-card",children:[c.jsx("span",{className:"stat-label",children:t("stats_revenueToday")}),c.jsxs("span",{className:"stat-value",children:[d.facturacionHoy.toLocaleString("es-CO")," ",c.jsx("span",{className:"stat-currency",children:t("stats_currency")})]})]}),c.jsxs("div",{className:"stat-card",children:[c.jsx("span",{className:"stat-label",children:t("stats_waiting")}),c.jsx("span",{className:"stat-value",children:d.enEspera})]})]}),c.jsxs("section",{className:"oc-grid","aria-label":"Contenido principal del dashboard",children:[c.jsx("div",{className:"oc-grid-main",children:c.jsxs("div",{className:"card card-quickcharts",children:[c.jsxs("div",{className:"oc-card-head",style:{display:"flex",justifyContent:"space-between",alignItems:"center",gap:8},children:[c.jsx("h3",{children:"Pacientes registrados  ltimos 7 das"}),c.jsx("span",{className:"oc-muted",style:{marginLeft:8,fontSize:12},children:o})]}),i.length===0||i.every(P=>((P==null?void 0:P.value)||0)===0)?c.jsx("p",{className:"oc-weekly-empty",children:"Sin pacientes registrados en la ltima semana."}):c.jsx(v6,{data:i})]})}),c.jsxs("aside",{className:"oc-grid-side","aria-label":"Panel lateral",children:[c.jsxs("div",{className:"card",children:[c.jsx("h3",{children:t("n8n_title")}),m?c.jsx("span",{className:"oc-muted",children:t("loading")}):c.jsx(h6,{status:f})]}),c.jsxs("div",{className:"card",children:[c.jsxs("div",{className:"oc-card-head",style:{display:"flex",justifyContent:"space-between",alignItems:"center",gap:8},children:[c.jsx("h3",{children:t("todays_appts")}),c.jsx("button",{className:"oc-small-link",type:"button",onClick:T,children:t("see_schedule")})]}),l?c.jsx("span",{className:"oc-muted",children:t("loading")}):a.length===0?c.jsx("p",{className:"oc-muted",children:t("no_appts_today")}):c.jsx("ul",{className:"oc-list",children:a.slice(0,5).map(P=>c.jsxs("li",{className:"oc-list-item",children:[c.jsxs("div",{className:"oc-list-main",children:[c.jsx("b",{children:P.pacienteNombre||"Paciente"})," ",c.jsxs("span",{className:"oc-muted",children:[t("at")," ",g6(P.fecha,JA())]})]}),c.jsx("div",{className:`oc-tag oc-tag-${(P.estado||"programada").toLowerCase().replace(/\s+/g,"-")}`,children:P.estado||"programada"})]},P.id))})]}),c.jsxs("div",{className:"card",children:[c.jsx("h3",{children:"Actividad reciente"}),R?c.jsx("span",{className:"oc-muted",children:t("loading")}):v.length===0?c.jsx("p",{className:"oc-muted",children:t("recent_empty")}):c.jsx(d6,{items:v})]})]})]}),c.jsxs("footer",{className:"oc-footer",children:[" ",new Date().getFullYear()," OdontoCloud | Creado por Ingeniero Juan Madrid"]})]})}function qp(){const t=Ka(),e=Kn(),[n]=A.useState(JA()),r=H=>zp[n][H]||H,[s,i]=A.useState("Inicio"),[o,a]=A.useState("recibo"),[l,d]=A.useState(()=>{try{return localStorage.getItem("odontocloud:dark")==="1"}catch{return!1}});A.useEffect(()=>{try{localStorage.setItem("odontocloud:dark",l?"1":"0")}catch{}document.documentElement.classList.toggle("dark",l)},[l]);const[h]=A.useState(()=>f6()),[f]=A.useState((h==null?void 0:h.rol)||""),[m]=A.useState((h==null?void 0:h.email)||""),[v,R]=A.useState("OdontoCloud"),[T,P]=A.useState(m||"Usuario"),[E,I]=A.useState(!0);A.useEffect(()=>{const H=jy(bh,async se=>{try{if(!se){P(m||"Usuario"),R("OdontoCloud"),I(!1);return}P(se.displayName||se.email||m||"Usuario");const q=Yt(ye,"empresas",se.uid),re=await Ih(q);R(re.exists()&&re.data().nombre||"OdontoCloud")}catch(q){console.error("Error cargando empresa/usuario:",q)}finally{I(!1)}});return()=>H()},[m]);const[S,b]=A.useState({pacientesHoy:0,citasHoy:0,facturacionHoy:0,enEspera:0}),[L,B]=A.useState(!0),[w,_]=A.useState([]),[y,N]=A.useState([]),[D,j]=A.useState(!0),{startToday:k,endToday:K,startTodayJS:Ke}=p6(),Ft=A.useMemo(()=>m6(Ke),[Ke]),dn=A.useMemo(()=>{const H=new Date,se=new Date(H.getFullYear(),H.getMonth(),H.getDate()-6),q=H,re=ae=>ae.toLocaleDateString(n==="es"?"es-ES":"en-US",{weekday:"short",day:"2-digit",month:"short"}).replace(".","");return`${re(se)}  ${re(q)}`},[n]),Z=H=>{var ge;const se=H.data()||{};let q;if((ge=se.fecha)!=null&&ge.toDate){q=se.fecha.toDate();const _e=se.horaInicio||se.hora;if(_e&&typeof _e=="string"){const[Fe=0,Ce=0]=_e.split(":").map(ze=>parseInt(ze,10));q.setHours(Fe||0,Ce||0,0,0)}}else if(typeof se.fecha=="string"){const _e=se.horaInicio||se.hora||"00:00";q=y6(se.fecha,_e)}else q=new Date;const re=se.pacienteNombre||se.paciente||"Paciente",ae=se.estado&&String(se.estado)||"programada";return{id:H.id,fecha:q,pacienteId:se.pacienteId||"",pacienteNombre:re,estado:ae,motivo:se.motivo||""}};A.useEffect(()=>{const H=st($e(ye,"citas"),Je("fecha",">=",k),Je("fecha","<",K),gn("fecha","asc")),se=st($e(ye,"citas"),Je("fecha","==",Ft));let q=new Map,re=!1,ae=!1;const ge=()=>{const Ce=Array.from(q.values()).sort((De,be)=>De.fecha.getTime()-be.fecha.getTime()),ze=Ce.filter(De=>String(De.estado).toLowerCase().trim()==="en espera").length;N(Ce),b(De=>({...De,citasHoy:Ce.length,enEspera:ze})),re&&ae&&j(!1)},_e=Fn(H,Ce=>{re=!0;const ze=new Map(q);Ce.docs.forEach(De=>ze.set(De.id,Z(De))),q=ze,ge()},Ce=>{console.error("Realtime citas hoy (TS):",Ce),re=!0,ge()}),Fe=Fn(se,Ce=>{ae=!0;const ze=new Map(q);Ce.docs.forEach(De=>ze.set(De.id,Z(De))),q=ze,ge()},Ce=>{console.error("Realtime citas hoy (STR):",Ce),ae=!0,ge()});return()=>{try{_e(),Fe()}catch{}}},[k,K,Ft]),A.useEffect(()=>{(async()=>{try{const q=(await BM($e(ye,"pacientes"))).data().count||0;let re=0;try{const ae=st($e(ye,"facturas"),Je("fecha",">=",k),Je("fecha","<",K));(await pn(ae)).forEach(_e=>{const Fe=_e.data();typeof Fe.monto=="number"&&(re+=Fe.monto)})}catch{re=0}b(ae=>({...ae,pacientesHoy:q,facturacionHoy:re}))}catch(se){console.error("Error cargando mtricas:",se),b(q=>({...q,pacientesHoy:0,facturacionHoy:0}))}finally{B(!1)}})()},[k,K]),A.useEffect(()=>{const H=new Date,se=new Date(H.getFullYear(),H.getMonth(),H.getDate()-6),q=new Date(H.getFullYear(),H.getMonth(),H.getDate()+1),re=new Map;for(let _e=0;_e<7;_e++){const Fe=new Date(H.getFullYear(),H.getMonth(),H.getDate()-(6-_e)),Ce=Fe.toISOString().slice(0,10),ze=Fe.toLocaleDateString(n==="es"?"es-ES":"en-US"),De=Fe.toLocaleDateString(n==="es"?"es-ES":"en-US",{weekday:"short",day:"2-digit"}).replace(".","");re.set(Ce,{label:ze,shortLabel:De,value:0})}const ae=st($e(ye,"pacientes"),Je("createdAt",">=",Be.fromDate(se)),Je("createdAt","<",Be.fromDate(q))),ge=Fn(ae,_e=>{const Fe=new Map(re);_e.docs.forEach(Ce=>{var X;const ze=Ce.data()||{},De=(X=Ce.data().createdAt)!=null&&X.toDate?Ce.data().createdAt.toDate():ze.createdAt?new Date(ze.createdAt):null;if(!De||isNaN(De))return;const be=De.toISOString().slice(0,10);if(!Fe.has(be))return;const M=Fe.get(be);M.value+=1,Fe.set(be,M)}),_(Array.from(Fe.values()))},_e=>{console.error("Error realtime serie semanal (pacientes):",_e),_(Array.from(re.values()))});return()=>{try{ge()}catch{}}},[n]);const[de,pe]=A.useState([]),[Re,Xe]=A.useState(!0);A.useEffect(()=>{(async()=>{try{const se=st($e(ye,"actividad"),gn("fecha","desc"),va(5)),q=await pn(se);pe(q.docs.map(re=>({id:re.id,title:re.data().descripcion||re.data().titulo||"Actividad",time:re.data().resumenTiempo||""})))}catch(se){console.error("Error cargando actividad:",se),pe([])}finally{Xe(!1)}})()},[]);const[Dt,U]=A.useState(null),[ne,ce]=A.useState(!0);A.useEffect(()=>{(async()=>{try{const se=Yt(ye,"integraciones","n8n"),q=await Ih(se);U(q.exists()?{connected:!!q.data().connected,flowsRunning:q.data().flowsRunning||0,lastError:q.data().lastError||null}:{connected:!1,flowsRunning:0,lastError:null})}catch(se){console.error("Error cargando estado n8n:",se),U({connected:!1,flowsRunning:0,lastError:"No se pudo leer el estado desde Firebase."})}finally{ce(!1)}})()},[]);const xe=async()=>{try{localStorage.removeItem("odc_session")}catch{}try{await Kj(bh)}catch(H){console.error("Error al cerrar sesin:",H)}window.location.href="/"},[Te,je]=A.useState(!1),[we,it]=A.useState(null),Se=A.useRef(null);A.useRef(null);const ie=()=>{var se,q;const H=(q=(se=Se.current)==null?void 0:se.getBoundingClientRect)==null?void 0:q.call(se);it(H),je(!0)};A.useEffect(()=>{const H=e.pathname.toLowerCase(),se=H.includes("/pacientes"),q=H.includes("/caja"),re=H.includes("/agenda"),ae=H.includes("/facturacion"),ge=H.includes("/inventario"),_e=H.includes("/odontograma"),Fe=H.includes("/reportes"),Ce=H.includes("/config");i(se?"Pacientes":q?"Caja":re?"Agenda":ge?"Inventario":_e?"Odontograma":Fe?"Reportes":Ce?"Config":"Inicio"),ae&&(i("Facturacin"),H.includes("/pagos")?a("pagos"):H.includes("/facturas")?a("fv"):H.includes("/recibo")?a("recibo"):H.includes("/saldo")?a("saldo"):H.includes("/nc")?a("nc"):H.includes("/nd")?a("nd"):H.includes("/liq")?a("liq"):H.includes("/tras")?a("tras"):H.includes("/oc")?a("oc"):H.includes("/fc")?a("fc"):a("recibo"))},[e.pathname]);const Pe=A.useMemo(()=>{const H=e.pathname.split("/").filter(Boolean),se=H.findIndex(q=>q.startsWith("dashboard_"));return se>=0?`/${H.slice(0,se+1).join("/")}`:""},[e.pathname]),Me=(H="")=>{const se=String(H).replace(/^\/+|\/+$/g,""),q=se?`${Pe}/${se}`:Pe||"/",re=e.pathname.toLowerCase()===q.toLowerCase();t(q,{replace:re})},He=()=>{switch(s){case"Agenda":return c.jsx(OU,{});case"Pacientes":return c.jsx(A.Suspense,{fallback:c.jsx("div",{style:{padding:16},children:"Cargando"}),children:c.jsx(WU,{})});case"Facturacin":return c.jsx(VU,{view:o});case"Inventario":return c.jsx(LU,{});case"Odontograma":return c.jsx(MU,{});case"Reportes":return c.jsx(QU,{});case"Caja":return c.jsx(u6,{});case"Config":return e.pathname.toLowerCase().includes("/config/")?c.jsx(i6,{}):c.jsx(ZU,{});case"Inicio":default:return null}};return c.jsxs("div",{className:`oc-shell ${l?"oc-dark":""}`,children:[c.jsx("a",{href:"#oc-main",className:"oc-skip-link",children:"Saltar al contenido"}),c.jsxs("header",{className:"oc-header",role:"banner",children:[c.jsxs("div",{className:"oc-header-left",children:[c.jsx("img",{src:RA,alt:"OdontoCloud",className:"oc-logo"}),c.jsxs("div",{className:"oc-brand-text",children:[c.jsx("span",{className:"oc-brand-main",children:"OdontoCloud"}),c.jsx("span",{className:"oc-brand-sub",children:E?"...":v})]})]}),c.jsxs("nav",{className:"oc-nav",role:"navigation","aria-label":"Navegacin principal",children:[c.jsx(Bo,{to:Pe,end:!0,className:({isActive:H})=>H&&s==="Inicio"?"oc-nav-btn active":"oc-nav-btn",title:r("nav_home"),children:r("nav_home")}),c.jsx(Bo,{to:`${Pe}/agenda`,className:({isActive:H})=>H||s==="Agenda"?"oc-nav-btn active":"oc-nav-btn",title:r("nav_agenda"),children:r("nav_agenda")}),c.jsx(Bo,{to:`${Pe}/pacientes`,className:({isActive:H})=>H||s==="Pacientes"?"oc-nav-btn active":"oc-nav-btn",title:r("nav_patients"),children:r("nav_patients")}),c.jsx(Bo,{to:`${Pe}/caja`,className:({isActive:H})=>H||s==="Caja"?"oc-nav-btn active":"oc-nav-btn",title:r("nav_cash"),children:r("nav_cash")}),c.jsx("button",{type:"button",ref:Se,className:"oc-nav-btn",title:r("nav_admin"),"aria-haspopup":"true","aria-expanded":Te,onClick:()=>Te?je(!1):ie(),onMouseEnter:()=>ie(),onFocus:()=>ie(),children:r("nav_admin")}),c.jsx(Bo,{to:`${Pe}/reportes`,className:({isActive:H})=>H||s==="Reportes"?"oc-nav-btn active":"oc-nav-btn",title:r("nav_reports"),children:r("nav_reports")})]}),c.jsxs("div",{className:"oc-header-right",children:[c.jsx(_6,{placeholder:r("searchPlaceholder"),onNavigate:H=>{H==="Inicio"?Me(""):H==="Facturacin"?(a("recibo"),Me("facturacion/recibo")):Me(H.toLowerCase())},onAction:H=>{switch(H){case"new_appointment":case"agenda_today":case"export_agenda":Me("agenda");break;case"new_patient":Me("pacientes");break;case"new_invoice":a("fv"),Me("facturacion/facturas");break;case"toggle_dark":d(se=>!se);break;case"logout":xe();break;case"show_shortcuts":alert("Atajos: Ctrl/Cmd + K para abrir bsqueda, / para moverse, Enter para ejecutar.");break;case"support":window.open("https://tu-soporte.odc","_blank");break}}}),c.jsx(XU,{basePath:Pe,className:"ml-2"}),c.jsx("button",{className:"oc-icon-btn",type:"button",onClick:()=>d(H=>!H),"aria-pressed":l,title:l?"Activar modo claro":"Activar modo oscuro",children:l?"":""}),c.jsx("button",{className:"oc-icon-btn",type:"button",onClick:xe,title:zp[n].logout,children:zp[n].logout})]})]}),c.jsx(w6,{open:Te,anchorRect:we,dark:l,onClose:()=>je(!1),onSoon:()=>{alert("Prximamente"),je(!1)},onNavigatePath:H=>{Me(H),je(!1)},onSetFactView:H=>a(H)}),c.jsxs("main",{id:"oc-main",className:"oc-main-wrapper",role:"main",children:[s!=="Inicio"&&He(),s==="Inicio"&&c.jsx(E6,{t:r,companyName:v,userName:T,role:f,darkMode:l,weeklySeries:w,weekRangeLabel:dn,todaysAppointments:y,todaysLoading:D,metrics:S,metricsLoading:L,n8nState:Dt,n8nLoading:ne,recent:de,recentLoading:Re,onGoAgenda:()=>Me("agenda")})]})]})}const ZA=()=>{try{const t=JSON.parse(localStorage.getItem("odc_session"));return t&&Date.now()-t.timestamp<1e3*60*60*24?t:null}catch{return null}},eR=t=>{const e=(t||"").toLowerCase();return e==="administrador"?"/dashboard_admin":e==="doctor"?"/dashboard_doctor":e==="recepcionista"?"/dashboard_recepcion":"/"};function Hp({allowedRoles:t,children:e}){var s;const n=ZA();if(!n)return c.jsx(Qd,{to:"/",replace:!0});const r=(s=n.rol)==null?void 0:s.toLowerCase();return t.map(i=>i.toLowerCase()).includes(r)?e:c.jsx(Qd,{to:eR(n.rol),replace:!0})}function I6(){const t=ZA();return c.jsxs(jN,{children:[c.jsx($o,{path:"/",element:t?c.jsx(Qd,{to:eR(t.rol),replace:!0}):c.jsx(u4,{})}),c.jsx($o,{path:"/dashboard_admin/*",element:c.jsx(Hp,{allowedRoles:["administrador"],children:c.jsx(qp,{})})}),c.jsx($o,{path:"/dashboard_doctor/*",element:c.jsx(Hp,{allowedRoles:["doctor"],children:c.jsx(qp,{})})}),c.jsx($o,{path:"/dashboard_recepcion/*",element:c.jsx(Hp,{allowedRoles:["recepcionista"],children:c.jsx(qp,{})})}),c.jsx($o,{path:"*",element:c.jsx(Qd,{to:"/",replace:!0})})]})}async function x6(){try{await Hj(bh,qS),await bM(ye),console.log(" Firebase listo con sesin persistente y modo offline.")}catch(t){console.warn(" Firebase offline/persistencia fall:",t.message)}}const T6="modulepreload",S6=function(t){return"/odontocloud-react/"+t},Ex={},b6=function(e,n,r){let s=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),a=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));s=Promise.allSettled(n.map(l=>{if(l=S6(l),l in Ex)return;Ex[l]=!0;const d=l.endsWith(".css"),h=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${h}`))return;const f=document.createElement("link");if(f.rel=d?"stylesheet":T6,d||(f.as="script"),f.crossOrigin="",f.href=l,a&&f.setAttribute("nonce",a),document.head.appendChild(f),d)return new Promise((m,v)=>{f.addEventListener("load",m),f.addEventListener("error",()=>v(new Error(`Unable to preload CSS for ${l}`)))})}))}function i(o){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=o,window.dispatchEvent(a),!a.defaultPrevented)throw o}return s.then(o=>{for(const a of o||[])a.status==="rejected"&&i(a.reason);return e().catch(i)})};function C6(t={}){const{immediate:e=!1,onNeedRefresh:n,onOfflineReady:r,onRegistered:s,onRegisteredSW:i,onRegisterError:o}=t;let a,l;const d=async(f=!0)=>{await l};async function h(){if("serviceWorker"in navigator){if(a=await b6(async()=>{const{Workbox:f}=await import("./workbox-window.prod.es5-vqzQaGvo.js");return{Workbox:f}},[]).then(({Workbox:f})=>new f("/odontocloud-react/sw.js",{scope:"/odontocloud-react/",type:"classic"})).catch(f=>{o==null||o(f)}),!a)return;a.addEventListener("activated",f=>{(f.isUpdate||f.isExternal)&&window.location.reload()}),a.addEventListener("installed",f=>{f.isUpdate||r==null||r()}),a.register({immediate:e}).then(f=>{i?i("/odontocloud-react/sw.js",f):s==null||s(f)}).catch(f=>{o==null||o(f)})}}return l=h(),d}const A6="empresa_logo_url",Ix="empresa_nombre",R6=A.createContext(null);function P6({children:t}){const[e,n]=A.useState(""),[r,s]=A.useState("OdontoCloud"),[i,o]=A.useState(!0);A.useEffect(()=>{var f;let d="";try{d=localStorage.getItem(A6)||""}catch{}d||(d="/assets/logo.png"),n(d);let h="OdontoCloud";try{h=localStorage.getItem(Ix)||((f=document.querySelector('meta[name="company-name"]'))==null?void 0:f.getAttribute("content"))||"OdontoCloud"}catch{}s(h),o(!1)},[]);const l={logoUrl:e,clinicName:r,loading:i,setLogoUrl:n,setClinicName:d=>{const h=d||"OdontoCloud";try{localStorage.setItem(Ix,h)}catch{}let f=document.querySelector('meta[name="company-name"]');f||(f=document.createElement("meta"),f.setAttribute("name","company-name"),document.head.appendChild(f)),f.setAttribute("content",h),s(h)}};return c.jsx(R6.Provider,{value:l,children:t})}const N6="/odontocloud-react/";x6();C6({immediate:!0});M0(document.getElementById("root")).render(c.jsx(Ox.StrictMode,{children:c.jsx(P6,{children:c.jsx(rk,{basename:N6,children:c.jsx(I6,{})})})}));
