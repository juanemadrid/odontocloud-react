(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();function uR(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var wT={exports:{}},Ch={},ET={exports:{}},Oe={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Vc=Symbol.for("react.element"),dR=Symbol.for("react.portal"),hR=Symbol.for("react.fragment"),fR=Symbol.for("react.strict_mode"),pR=Symbol.for("react.profiler"),mR=Symbol.for("react.provider"),gR=Symbol.for("react.context"),yR=Symbol.for("react.forward_ref"),_R=Symbol.for("react.suspense"),vR=Symbol.for("react.memo"),wR=Symbol.for("react.lazy"),Sv=Symbol.iterator;function ER(t){return t===null||typeof t!="object"?null:(t=Sv&&t[Sv]||t["@@iterator"],typeof t=="function"?t:null)}var IT={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},TT=Object.assign,xT={};function Fa(t,e,n){this.props=t,this.context=e,this.refs=xT,this.updater=n||IT}Fa.prototype.isReactComponent={};Fa.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Fa.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function ST(){}ST.prototype=Fa.prototype;function Eg(t,e,n){this.props=t,this.context=e,this.refs=xT,this.updater=n||IT}var Ig=Eg.prototype=new ST;Ig.constructor=Eg;TT(Ig,Fa.prototype);Ig.isPureReactComponent=!0;var bv=Array.isArray,bT=Object.prototype.hasOwnProperty,Tg={current:null},CT={key:!0,ref:!0,__self:!0,__source:!0};function AT(t,e,n){var r,s={},i=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(i=""+e.key),e)bT.call(e,r)&&!CT.hasOwnProperty(r)&&(s[r]=e[r]);var a=arguments.length-2;if(a===1)s.children=n;else if(1<a){for(var l=Array(a),d=0;d<a;d++)l[d]=arguments[d+2];s.children=l}if(t&&t.defaultProps)for(r in a=t.defaultProps,a)s[r]===void 0&&(s[r]=a[r]);return{$$typeof:Vc,type:t,key:i,ref:o,props:s,_owner:Tg.current}}function IR(t,e){return{$$typeof:Vc,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function xg(t){return typeof t=="object"&&t!==null&&t.$$typeof===Vc}function TR(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var Cv=/\/+/g;function zf(t,e){return typeof t=="object"&&t!==null&&t.key!=null?TR(""+t.key):e.toString(36)}function Gu(t,e,n,r,s){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case Vc:case dR:o=!0}}if(o)return o=t,s=s(o),t=r===""?"."+zf(o,0):r,bv(s)?(n="",t!=null&&(n=t.replace(Cv,"$&/")+"/"),Gu(s,e,n,"",function(d){return d})):s!=null&&(xg(s)&&(s=IR(s,n+(!s.key||o&&o.key===s.key?"":(""+s.key).replace(Cv,"$&/")+"/")+t)),e.push(s)),1;if(o=0,r=r===""?".":r+":",bv(t))for(var a=0;a<t.length;a++){i=t[a];var l=r+zf(i,a);o+=Gu(i,e,n,l,s)}else if(l=ER(t),typeof l=="function")for(t=l.call(t),a=0;!(i=t.next()).done;)i=i.value,l=r+zf(i,a++),o+=Gu(i,e,n,l,s);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function yu(t,e,n){if(t==null)return t;var r=[],s=0;return Gu(t,r,"","",function(i){return e.call(n,i,s++)}),r}function xR(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var En={current:null},Qu={transition:null},SR={ReactCurrentDispatcher:En,ReactCurrentBatchConfig:Qu,ReactCurrentOwner:Tg};function RT(){throw Error("act(...) is not supported in production builds of React.")}Oe.Children={map:yu,forEach:function(t,e,n){yu(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return yu(t,function(){e++}),e},toArray:function(t){return yu(t,function(e){return e})||[]},only:function(t){if(!xg(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Oe.Component=Fa;Oe.Fragment=hR;Oe.Profiler=pR;Oe.PureComponent=Eg;Oe.StrictMode=fR;Oe.Suspense=_R;Oe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=SR;Oe.act=RT;Oe.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=TT({},t.props),s=t.key,i=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,o=Tg.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(l in e)bT.call(e,l)&&!CT.hasOwnProperty(l)&&(r[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)r.children=n;else if(1<l){a=Array(l);for(var d=0;d<l;d++)a[d]=arguments[d+2];r.children=a}return{$$typeof:Vc,type:t.type,key:s,ref:i,props:r,_owner:o}};Oe.createContext=function(t){return t={$$typeof:gR,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:mR,_context:t},t.Consumer=t};Oe.createElement=AT;Oe.createFactory=function(t){var e=AT.bind(null,t);return e.type=t,e};Oe.createRef=function(){return{current:null}};Oe.forwardRef=function(t){return{$$typeof:yR,render:t}};Oe.isValidElement=xg;Oe.lazy=function(t){return{$$typeof:wR,_payload:{_status:-1,_result:t},_init:xR}};Oe.memo=function(t,e){return{$$typeof:vR,type:t,compare:e===void 0?null:e}};Oe.startTransition=function(t){var e=Qu.transition;Qu.transition={};try{t()}finally{Qu.transition=e}};Oe.unstable_act=RT;Oe.useCallback=function(t,e){return En.current.useCallback(t,e)};Oe.useContext=function(t){return En.current.useContext(t)};Oe.useDebugValue=function(){};Oe.useDeferredValue=function(t){return En.current.useDeferredValue(t)};Oe.useEffect=function(t,e){return En.current.useEffect(t,e)};Oe.useId=function(){return En.current.useId()};Oe.useImperativeHandle=function(t,e,n){return En.current.useImperativeHandle(t,e,n)};Oe.useInsertionEffect=function(t,e){return En.current.useInsertionEffect(t,e)};Oe.useLayoutEffect=function(t,e){return En.current.useLayoutEffect(t,e)};Oe.useMemo=function(t,e){return En.current.useMemo(t,e)};Oe.useReducer=function(t,e,n){return En.current.useReducer(t,e,n)};Oe.useRef=function(t){return En.current.useRef(t)};Oe.useState=function(t){return En.current.useState(t)};Oe.useSyncExternalStore=function(t,e,n){return En.current.useSyncExternalStore(t,e,n)};Oe.useTransition=function(){return En.current.useTransition()};Oe.version="18.3.1";ET.exports=Oe;var P=ET.exports;const PT=uR(P);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var bR=P,CR=Symbol.for("react.element"),AR=Symbol.for("react.fragment"),RR=Object.prototype.hasOwnProperty,PR=bR.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,NR={key:!0,ref:!0,__self:!0,__source:!0};function NT(t,e,n){var r,s={},i=null,o=null;n!==void 0&&(i=""+n),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)RR.call(e,r)&&!NR.hasOwnProperty(r)&&(s[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)s[r]===void 0&&(s[r]=e[r]);return{$$typeof:CR,type:t,key:i,ref:o,props:s,_owner:PR.current}}Ch.Fragment=AR;Ch.jsx=NT;Ch.jsxs=NT;wT.exports=Ch;var u=wT.exports,kT={exports:{}},Wn={},DT={exports:{}},jT={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(Z,de){var pe=Z.length;Z.push(de);e:for(;0<pe;){var Pe=pe-1>>>1,Ge=Z[Pe];if(0<s(Ge,de))Z[Pe]=de,Z[pe]=Ge,pe=Pe;else break e}}function n(Z){return Z.length===0?null:Z[0]}function r(Z){if(Z.length===0)return null;var de=Z[0],pe=Z.pop();if(pe!==de){Z[0]=pe;e:for(var Pe=0,Ge=Z.length,Pt=Ge>>>1;Pe<Pt;){var B=2*(Pe+1)-1,re=Z[B],ce=B+1,xe=Z[ce];if(0>s(re,pe))ce<Ge&&0>s(xe,re)?(Z[Pe]=xe,Z[ce]=pe,Pe=ce):(Z[Pe]=re,Z[B]=pe,Pe=B);else if(ce<Ge&&0>s(xe,pe))Z[Pe]=xe,Z[ce]=pe,Pe=ce;else break e}}return de}function s(Z,de){var pe=Z.sortIndex-de.sortIndex;return pe!==0?pe:Z.id-de.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var l=[],d=[],h=1,f=null,m=3,_=!1,A=!1,R=!1,C=typeof setTimeout=="function"?setTimeout:null,w=typeof clearTimeout=="function"?clearTimeout:null,I=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function b(Z){for(var de=n(d);de!==null;){if(de.callback===null)r(d);else if(de.startTime<=Z)r(d),de.sortIndex=de.expirationTime,e(l,de);else break;de=n(d)}}function x(Z){if(R=!1,b(Z),!A)if(n(l)!==null)A=!0,Mt(L);else{var de=n(d);de!==null&&un(x,de.startTime-Z)}}function L(Z,de){A=!1,R&&(R=!1,w(v),v=-1),_=!0;var pe=m;try{for(b(de),f=n(l);f!==null&&(!(f.expirationTime>de)||Z&&!D());){var Pe=f.callback;if(typeof Pe=="function"){f.callback=null,m=f.priorityLevel;var Ge=Pe(f.expirationTime<=de);de=t.unstable_now(),typeof Ge=="function"?f.callback=Ge:f===n(l)&&r(l),b(de)}else r(l);f=n(l)}if(f!==null)var Pt=!0;else{var B=n(d);B!==null&&un(x,B.startTime-de),Pt=!1}return Pt}finally{f=null,m=pe,_=!1}}var $=!1,E=null,v=-1,y=5,N=-1;function D(){return!(t.unstable_now()-N<y)}function j(){if(E!==null){var Z=t.unstable_now();N=Z;var de=!0;try{de=E(!0,Z)}finally{de?k():($=!1,E=null)}}else $=!1}var k;if(typeof I=="function")k=function(){I(j)};else if(typeof MessageChannel<"u"){var G=new MessageChannel,We=G.port2;G.port1.onmessage=j,k=function(){We.postMessage(null)}}else k=function(){C(j,0)};function Mt(Z){E=Z,$||($=!0,k())}function un(Z,de){v=C(function(){Z(t.unstable_now())},de)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(Z){Z.callback=null},t.unstable_continueExecution=function(){A||_||(A=!0,Mt(L))},t.unstable_forceFrameRate=function(Z){0>Z||125<Z?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):y=0<Z?Math.floor(1e3/Z):5},t.unstable_getCurrentPriorityLevel=function(){return m},t.unstable_getFirstCallbackNode=function(){return n(l)},t.unstable_next=function(Z){switch(m){case 1:case 2:case 3:var de=3;break;default:de=m}var pe=m;m=de;try{return Z()}finally{m=pe}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(Z,de){switch(Z){case 1:case 2:case 3:case 4:case 5:break;default:Z=3}var pe=m;m=Z;try{return de()}finally{m=pe}},t.unstable_scheduleCallback=function(Z,de,pe){var Pe=t.unstable_now();switch(typeof pe=="object"&&pe!==null?(pe=pe.delay,pe=typeof pe=="number"&&0<pe?Pe+pe:Pe):pe=Pe,Z){case 1:var Ge=-1;break;case 2:Ge=250;break;case 5:Ge=1073741823;break;case 4:Ge=1e4;break;default:Ge=5e3}return Ge=pe+Ge,Z={id:h++,callback:de,priorityLevel:Z,startTime:pe,expirationTime:Ge,sortIndex:-1},pe>Pe?(Z.sortIndex=pe,e(d,Z),n(l)===null&&Z===n(d)&&(R?(w(v),v=-1):R=!0,un(x,pe-Pe))):(Z.sortIndex=Ge,e(l,Z),A||_||(A=!0,Mt(L))),Z},t.unstable_shouldYield=D,t.unstable_wrapCallback=function(Z){var de=m;return function(){var pe=m;m=de;try{return Z.apply(this,arguments)}finally{m=pe}}}})(jT);DT.exports=jT;var kR=DT.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var DR=P,qn=kR;function K(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var OT=new Set,sc={};function yo(t,e){_a(t,e),_a(t+"Capture",e)}function _a(t,e){for(sc[t]=e,t=0;t<e.length;t++)OT.add(e[t])}var ss=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Hp=Object.prototype.hasOwnProperty,jR=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Av={},Rv={};function OR(t){return Hp.call(Rv,t)?!0:Hp.call(Av,t)?!1:jR.test(t)?Rv[t]=!0:(Av[t]=!0,!1)}function VR(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function LR(t,e,n,r){if(e===null||typeof e>"u"||VR(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function In(t,e,n,r,s,i,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=o}var Yt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Yt[t]=new In(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Yt[e]=new In(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Yt[t]=new In(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Yt[t]=new In(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Yt[t]=new In(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Yt[t]=new In(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Yt[t]=new In(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Yt[t]=new In(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Yt[t]=new In(t,5,!1,t.toLowerCase(),null,!1,!1)});var Sg=/[\-:]([a-z])/g;function bg(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Sg,bg);Yt[e]=new In(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Sg,bg);Yt[e]=new In(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Sg,bg);Yt[e]=new In(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Yt[t]=new In(t,1,!1,t.toLowerCase(),null,!1,!1)});Yt.xlinkHref=new In("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Yt[t]=new In(t,1,!1,t.toLowerCase(),null,!0,!0)});function Cg(t,e,n,r){var s=Yt.hasOwnProperty(e)?Yt[e]:null;(s!==null?s.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(LR(e,n,s,r)&&(n=null),r||s===null?OR(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):s.mustUseProperty?t[s.propertyName]=n===null?s.type===3?!1:"":n:(e=s.attributeName,r=s.attributeNamespace,n===null?t.removeAttribute(e):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var ps=DR.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,_u=Symbol.for("react.element"),qo=Symbol.for("react.portal"),Ho=Symbol.for("react.fragment"),Ag=Symbol.for("react.strict_mode"),Wp=Symbol.for("react.profiler"),VT=Symbol.for("react.provider"),LT=Symbol.for("react.context"),Rg=Symbol.for("react.forward_ref"),Kp=Symbol.for("react.suspense"),Gp=Symbol.for("react.suspense_list"),Pg=Symbol.for("react.memo"),Ns=Symbol.for("react.lazy"),MT=Symbol.for("react.offscreen"),Pv=Symbol.iterator;function dl(t){return t===null||typeof t!="object"?null:(t=Pv&&t[Pv]||t["@@iterator"],typeof t=="function"?t:null)}var gt=Object.assign,qf;function Cl(t){if(qf===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);qf=e&&e[1]||""}return`
`+qf+t}var Hf=!1;function Wf(t,e){if(!t||Hf)return"";Hf=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(d){var r=d}Reflect.construct(t,[],e)}else{try{e.call()}catch(d){r=d}t.call(e.prototype)}else{try{throw Error()}catch(d){r=d}t()}}catch(d){if(d&&r&&typeof d.stack=="string"){for(var s=d.stack.split(`
`),i=r.stack.split(`
`),o=s.length-1,a=i.length-1;1<=o&&0<=a&&s[o]!==i[a];)a--;for(;1<=o&&0<=a;o--,a--)if(s[o]!==i[a]){if(o!==1||a!==1)do if(o--,a--,0>a||s[o]!==i[a]){var l=`
`+s[o].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=o&&0<=a);break}}}finally{Hf=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Cl(t):""}function MR(t){switch(t.tag){case 5:return Cl(t.type);case 16:return Cl("Lazy");case 13:return Cl("Suspense");case 19:return Cl("SuspenseList");case 0:case 2:case 15:return t=Wf(t.type,!1),t;case 11:return t=Wf(t.type.render,!1),t;case 1:return t=Wf(t.type,!0),t;default:return""}}function Qp(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Ho:return"Fragment";case qo:return"Portal";case Wp:return"Profiler";case Ag:return"StrictMode";case Kp:return"Suspense";case Gp:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case LT:return(t.displayName||"Context")+".Consumer";case VT:return(t._context.displayName||"Context")+".Provider";case Rg:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Pg:return e=t.displayName||null,e!==null?e:Qp(t.type)||"Memo";case Ns:e=t._payload,t=t._init;try{return Qp(t(e))}catch{}}return null}function FR(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Qp(e);case 8:return e===Ag?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function ii(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function FT(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function UR(t){var e=FT(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,i=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(o){r=""+o,i.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function vu(t){t._valueTracker||(t._valueTracker=UR(t))}function UT(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=FT(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function xd(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Yp(t,e){var n=e.checked;return gt({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function Nv(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=ii(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function $T(t,e){e=e.checked,e!=null&&Cg(t,"checked",e,!1)}function Xp(t,e){$T(t,e);var n=ii(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Jp(t,e.type,n):e.hasOwnProperty("defaultValue")&&Jp(t,e.type,ii(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function kv(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function Jp(t,e,n){(e!=="number"||xd(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var Al=Array.isArray;function sa(t,e,n,r){if(t=t.options,e){e={};for(var s=0;s<n.length;s++)e["$"+n[s]]=!0;for(n=0;n<t.length;n++)s=e.hasOwnProperty("$"+t[n].value),t[n].selected!==s&&(t[n].selected=s),s&&r&&(t[n].defaultSelected=!0)}else{for(n=""+ii(n),e=null,s=0;s<t.length;s++){if(t[s].value===n){t[s].selected=!0,r&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function Zp(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(K(91));return gt({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function Dv(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(K(92));if(Al(n)){if(1<n.length)throw Error(K(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:ii(n)}}function BT(t,e){var n=ii(e.value),r=ii(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function jv(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function zT(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function em(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?zT(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var wu,qT=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,s){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(wu=wu||document.createElement("div"),wu.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=wu.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function ic(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var Fl={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},$R=["Webkit","ms","Moz","O"];Object.keys(Fl).forEach(function(t){$R.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Fl[e]=Fl[t]})});function HT(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||Fl.hasOwnProperty(t)&&Fl[t]?(""+e).trim():e+"px"}function WT(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=HT(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,s):t[n]=s}}var BR=gt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function tm(t,e){if(e){if(BR[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(K(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(K(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(K(61))}if(e.style!=null&&typeof e.style!="object")throw Error(K(62))}}function nm(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var rm=null;function Ng(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var sm=null,ia=null,oa=null;function Ov(t){if(t=Fc(t)){if(typeof sm!="function")throw Error(K(280));var e=t.stateNode;e&&(e=kh(e),sm(t.stateNode,t.type,e))}}function KT(t){ia?oa?oa.push(t):oa=[t]:ia=t}function GT(){if(ia){var t=ia,e=oa;if(oa=ia=null,Ov(t),e)for(t=0;t<e.length;t++)Ov(e[t])}}function QT(t,e){return t(e)}function YT(){}var Kf=!1;function XT(t,e,n){if(Kf)return t(e,n);Kf=!0;try{return QT(t,e,n)}finally{Kf=!1,(ia!==null||oa!==null)&&(YT(),GT())}}function oc(t,e){var n=t.stateNode;if(n===null)return null;var r=kh(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(K(231,e,typeof n));return n}var im=!1;if(ss)try{var hl={};Object.defineProperty(hl,"passive",{get:function(){im=!0}}),window.addEventListener("test",hl,hl),window.removeEventListener("test",hl,hl)}catch{im=!1}function zR(t,e,n,r,s,i,o,a,l){var d=Array.prototype.slice.call(arguments,3);try{e.apply(n,d)}catch(h){this.onError(h)}}var Ul=!1,Sd=null,bd=!1,om=null,qR={onError:function(t){Ul=!0,Sd=t}};function HR(t,e,n,r,s,i,o,a,l){Ul=!1,Sd=null,zR.apply(qR,arguments)}function WR(t,e,n,r,s,i,o,a,l){if(HR.apply(this,arguments),Ul){if(Ul){var d=Sd;Ul=!1,Sd=null}else throw Error(K(198));bd||(bd=!0,om=d)}}function _o(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function JT(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function Vv(t){if(_o(t)!==t)throw Error(K(188))}function KR(t){var e=t.alternate;if(!e){if(e=_o(t),e===null)throw Error(K(188));return e!==t?null:t}for(var n=t,r=e;;){var s=n.return;if(s===null)break;var i=s.alternate;if(i===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===n)return Vv(s),t;if(i===r)return Vv(s),e;i=i.sibling}throw Error(K(188))}if(n.return!==r.return)n=s,r=i;else{for(var o=!1,a=s.child;a;){if(a===n){o=!0,n=s,r=i;break}if(a===r){o=!0,r=s,n=i;break}a=a.sibling}if(!o){for(a=i.child;a;){if(a===n){o=!0,n=i,r=s;break}if(a===r){o=!0,r=i,n=s;break}a=a.sibling}if(!o)throw Error(K(189))}}if(n.alternate!==r)throw Error(K(190))}if(n.tag!==3)throw Error(K(188));return n.stateNode.current===n?t:e}function ZT(t){return t=KR(t),t!==null?ex(t):null}function ex(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=ex(t);if(e!==null)return e;t=t.sibling}return null}var tx=qn.unstable_scheduleCallback,Lv=qn.unstable_cancelCallback,GR=qn.unstable_shouldYield,QR=qn.unstable_requestPaint,xt=qn.unstable_now,YR=qn.unstable_getCurrentPriorityLevel,kg=qn.unstable_ImmediatePriority,nx=qn.unstable_UserBlockingPriority,Cd=qn.unstable_NormalPriority,XR=qn.unstable_LowPriority,rx=qn.unstable_IdlePriority,Ah=null,$r=null;function JR(t){if($r&&typeof $r.onCommitFiberRoot=="function")try{$r.onCommitFiberRoot(Ah,t,void 0,(t.current.flags&128)===128)}catch{}}var yr=Math.clz32?Math.clz32:t1,ZR=Math.log,e1=Math.LN2;function t1(t){return t>>>=0,t===0?32:31-(ZR(t)/e1|0)|0}var Eu=64,Iu=4194304;function Rl(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Ad(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,s=t.suspendedLanes,i=t.pingedLanes,o=n&268435455;if(o!==0){var a=o&~s;a!==0?r=Rl(a):(i&=o,i!==0&&(r=Rl(i)))}else o=n&~s,o!==0?r=Rl(o):i!==0&&(r=Rl(i));if(r===0)return 0;if(e!==0&&e!==r&&!(e&s)&&(s=r&-r,i=e&-e,s>=i||s===16&&(i&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-yr(e),s=1<<n,r|=t[n],e&=~s;return r}function n1(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function r1(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,s=t.expirationTimes,i=t.pendingLanes;0<i;){var o=31-yr(i),a=1<<o,l=s[o];l===-1?(!(a&n)||a&r)&&(s[o]=n1(a,e)):l<=e&&(t.expiredLanes|=a),i&=~a}}function am(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function sx(){var t=Eu;return Eu<<=1,!(Eu&4194240)&&(Eu=64),t}function Gf(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Lc(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-yr(e),t[e]=n}function s1(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var s=31-yr(n),i=1<<s;e[s]=0,r[s]=-1,t[s]=-1,n&=~i}}function Dg(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-yr(n),s=1<<r;s&e|t[r]&e&&(t[r]|=e),n&=~s}}var Xe=0;function ix(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var ox,jg,ax,lx,cx,lm=!1,Tu=[],Hs=null,Ws=null,Ks=null,ac=new Map,lc=new Map,Ds=[],i1="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Mv(t,e){switch(t){case"focusin":case"focusout":Hs=null;break;case"dragenter":case"dragleave":Ws=null;break;case"mouseover":case"mouseout":Ks=null;break;case"pointerover":case"pointerout":ac.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":lc.delete(e.pointerId)}}function fl(t,e,n,r,s,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[s]},e!==null&&(e=Fc(e),e!==null&&jg(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function o1(t,e,n,r,s){switch(e){case"focusin":return Hs=fl(Hs,t,e,n,r,s),!0;case"dragenter":return Ws=fl(Ws,t,e,n,r,s),!0;case"mouseover":return Ks=fl(Ks,t,e,n,r,s),!0;case"pointerover":var i=s.pointerId;return ac.set(i,fl(ac.get(i)||null,t,e,n,r,s)),!0;case"gotpointercapture":return i=s.pointerId,lc.set(i,fl(lc.get(i)||null,t,e,n,r,s)),!0}return!1}function ux(t){var e=Mi(t.target);if(e!==null){var n=_o(e);if(n!==null){if(e=n.tag,e===13){if(e=JT(n),e!==null){t.blockedOn=e,cx(t.priority,function(){ax(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Yu(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=cm(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);rm=r,n.target.dispatchEvent(r),rm=null}else return e=Fc(n),e!==null&&jg(e),t.blockedOn=n,!1;e.shift()}return!0}function Fv(t,e,n){Yu(t)&&n.delete(e)}function a1(){lm=!1,Hs!==null&&Yu(Hs)&&(Hs=null),Ws!==null&&Yu(Ws)&&(Ws=null),Ks!==null&&Yu(Ks)&&(Ks=null),ac.forEach(Fv),lc.forEach(Fv)}function pl(t,e){t.blockedOn===e&&(t.blockedOn=null,lm||(lm=!0,qn.unstable_scheduleCallback(qn.unstable_NormalPriority,a1)))}function cc(t){function e(s){return pl(s,t)}if(0<Tu.length){pl(Tu[0],t);for(var n=1;n<Tu.length;n++){var r=Tu[n];r.blockedOn===t&&(r.blockedOn=null)}}for(Hs!==null&&pl(Hs,t),Ws!==null&&pl(Ws,t),Ks!==null&&pl(Ks,t),ac.forEach(e),lc.forEach(e),n=0;n<Ds.length;n++)r=Ds[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<Ds.length&&(n=Ds[0],n.blockedOn===null);)ux(n),n.blockedOn===null&&Ds.shift()}var aa=ps.ReactCurrentBatchConfig,Rd=!0;function l1(t,e,n,r){var s=Xe,i=aa.transition;aa.transition=null;try{Xe=1,Og(t,e,n,r)}finally{Xe=s,aa.transition=i}}function c1(t,e,n,r){var s=Xe,i=aa.transition;aa.transition=null;try{Xe=4,Og(t,e,n,r)}finally{Xe=s,aa.transition=i}}function Og(t,e,n,r){if(Rd){var s=cm(t,e,n,r);if(s===null)sp(t,e,r,Pd,n),Mv(t,r);else if(o1(s,t,e,n,r))r.stopPropagation();else if(Mv(t,r),e&4&&-1<i1.indexOf(t)){for(;s!==null;){var i=Fc(s);if(i!==null&&ox(i),i=cm(t,e,n,r),i===null&&sp(t,e,r,Pd,n),i===s)break;s=i}s!==null&&r.stopPropagation()}else sp(t,e,r,null,n)}}var Pd=null;function cm(t,e,n,r){if(Pd=null,t=Ng(r),t=Mi(t),t!==null)if(e=_o(t),e===null)t=null;else if(n=e.tag,n===13){if(t=JT(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Pd=t,null}function dx(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(YR()){case kg:return 1;case nx:return 4;case Cd:case XR:return 16;case rx:return 536870912;default:return 16}default:return 16}}var Bs=null,Vg=null,Xu=null;function hx(){if(Xu)return Xu;var t,e=Vg,n=e.length,r,s="value"in Bs?Bs.value:Bs.textContent,i=s.length;for(t=0;t<n&&e[t]===s[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===s[i-r];r++);return Xu=s.slice(t,1<r?1-r:void 0)}function Ju(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function xu(){return!0}function Uv(){return!1}function Kn(t){function e(n,r,s,i,o){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(n=t[a],this[a]=n?n(i):i[a]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?xu:Uv,this.isPropagationStopped=Uv,this}return gt(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=xu)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=xu)},persist:function(){},isPersistent:xu}),e}var Ua={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Lg=Kn(Ua),Mc=gt({},Ua,{view:0,detail:0}),u1=Kn(Mc),Qf,Yf,ml,Rh=gt({},Mc,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Mg,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==ml&&(ml&&t.type==="mousemove"?(Qf=t.screenX-ml.screenX,Yf=t.screenY-ml.screenY):Yf=Qf=0,ml=t),Qf)},movementY:function(t){return"movementY"in t?t.movementY:Yf}}),$v=Kn(Rh),d1=gt({},Rh,{dataTransfer:0}),h1=Kn(d1),f1=gt({},Mc,{relatedTarget:0}),Xf=Kn(f1),p1=gt({},Ua,{animationName:0,elapsedTime:0,pseudoElement:0}),m1=Kn(p1),g1=gt({},Ua,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),y1=Kn(g1),_1=gt({},Ua,{data:0}),Bv=Kn(_1),v1={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},w1={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},E1={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function I1(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=E1[t])?!!e[t]:!1}function Mg(){return I1}var T1=gt({},Mc,{key:function(t){if(t.key){var e=v1[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Ju(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?w1[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Mg,charCode:function(t){return t.type==="keypress"?Ju(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Ju(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),x1=Kn(T1),S1=gt({},Rh,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),zv=Kn(S1),b1=gt({},Mc,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Mg}),C1=Kn(b1),A1=gt({},Ua,{propertyName:0,elapsedTime:0,pseudoElement:0}),R1=Kn(A1),P1=gt({},Rh,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),N1=Kn(P1),k1=[9,13,27,32],Fg=ss&&"CompositionEvent"in window,$l=null;ss&&"documentMode"in document&&($l=document.documentMode);var D1=ss&&"TextEvent"in window&&!$l,fx=ss&&(!Fg||$l&&8<$l&&11>=$l),qv=" ",Hv=!1;function px(t,e){switch(t){case"keyup":return k1.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function mx(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Wo=!1;function j1(t,e){switch(t){case"compositionend":return mx(e);case"keypress":return e.which!==32?null:(Hv=!0,qv);case"textInput":return t=e.data,t===qv&&Hv?null:t;default:return null}}function O1(t,e){if(Wo)return t==="compositionend"||!Fg&&px(t,e)?(t=hx(),Xu=Vg=Bs=null,Wo=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return fx&&e.locale!=="ko"?null:e.data;default:return null}}var V1={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Wv(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!V1[t.type]:e==="textarea"}function gx(t,e,n,r){KT(r),e=Nd(e,"onChange"),0<e.length&&(n=new Lg("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var Bl=null,uc=null;function L1(t){Cx(t,0)}function Ph(t){var e=Qo(t);if(UT(e))return t}function M1(t,e){if(t==="change")return e}var yx=!1;if(ss){var Jf;if(ss){var Zf="oninput"in document;if(!Zf){var Kv=document.createElement("div");Kv.setAttribute("oninput","return;"),Zf=typeof Kv.oninput=="function"}Jf=Zf}else Jf=!1;yx=Jf&&(!document.documentMode||9<document.documentMode)}function Gv(){Bl&&(Bl.detachEvent("onpropertychange",_x),uc=Bl=null)}function _x(t){if(t.propertyName==="value"&&Ph(uc)){var e=[];gx(e,uc,t,Ng(t)),XT(L1,e)}}function F1(t,e,n){t==="focusin"?(Gv(),Bl=e,uc=n,Bl.attachEvent("onpropertychange",_x)):t==="focusout"&&Gv()}function U1(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Ph(uc)}function $1(t,e){if(t==="click")return Ph(e)}function B1(t,e){if(t==="input"||t==="change")return Ph(e)}function z1(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var wr=typeof Object.is=="function"?Object.is:z1;function dc(t,e){if(wr(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!Hp.call(e,s)||!wr(t[s],e[s]))return!1}return!0}function Qv(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Yv(t,e){var n=Qv(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Qv(n)}}function vx(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?vx(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function wx(){for(var t=window,e=xd();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=xd(t.document)}return e}function Ug(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function q1(t){var e=wx(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&vx(n.ownerDocument.documentElement,n)){if(r!==null&&Ug(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=n.textContent.length,i=Math.min(r.start,s);r=r.end===void 0?i:Math.min(r.end,s),!t.extend&&i>r&&(s=r,r=i,i=s),s=Yv(n,i);var o=Yv(n,r);s&&o&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),i>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var H1=ss&&"documentMode"in document&&11>=document.documentMode,Ko=null,um=null,zl=null,dm=!1;function Xv(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;dm||Ko==null||Ko!==xd(r)||(r=Ko,"selectionStart"in r&&Ug(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),zl&&dc(zl,r)||(zl=r,r=Nd(um,"onSelect"),0<r.length&&(e=new Lg("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=Ko)))}function Su(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Go={animationend:Su("Animation","AnimationEnd"),animationiteration:Su("Animation","AnimationIteration"),animationstart:Su("Animation","AnimationStart"),transitionend:Su("Transition","TransitionEnd")},ep={},Ex={};ss&&(Ex=document.createElement("div").style,"AnimationEvent"in window||(delete Go.animationend.animation,delete Go.animationiteration.animation,delete Go.animationstart.animation),"TransitionEvent"in window||delete Go.transitionend.transition);function Nh(t){if(ep[t])return ep[t];if(!Go[t])return t;var e=Go[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in Ex)return ep[t]=e[n];return t}var Ix=Nh("animationend"),Tx=Nh("animationiteration"),xx=Nh("animationstart"),Sx=Nh("transitionend"),bx=new Map,Jv="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function hi(t,e){bx.set(t,e),yo(e,[t])}for(var tp=0;tp<Jv.length;tp++){var np=Jv[tp],W1=np.toLowerCase(),K1=np[0].toUpperCase()+np.slice(1);hi(W1,"on"+K1)}hi(Ix,"onAnimationEnd");hi(Tx,"onAnimationIteration");hi(xx,"onAnimationStart");hi("dblclick","onDoubleClick");hi("focusin","onFocus");hi("focusout","onBlur");hi(Sx,"onTransitionEnd");_a("onMouseEnter",["mouseout","mouseover"]);_a("onMouseLeave",["mouseout","mouseover"]);_a("onPointerEnter",["pointerout","pointerover"]);_a("onPointerLeave",["pointerout","pointerover"]);yo("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));yo("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));yo("onBeforeInput",["compositionend","keypress","textInput","paste"]);yo("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));yo("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));yo("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Pl="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),G1=new Set("cancel close invalid load scroll toggle".split(" ").concat(Pl));function Zv(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,WR(r,e,void 0,t),t.currentTarget=null}function Cx(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],s=r.event;r=r.listeners;e:{var i=void 0;if(e)for(var o=r.length-1;0<=o;o--){var a=r[o],l=a.instance,d=a.currentTarget;if(a=a.listener,l!==i&&s.isPropagationStopped())break e;Zv(s,a,d),i=l}else for(o=0;o<r.length;o++){if(a=r[o],l=a.instance,d=a.currentTarget,a=a.listener,l!==i&&s.isPropagationStopped())break e;Zv(s,a,d),i=l}}}if(bd)throw t=om,bd=!1,om=null,t}function at(t,e){var n=e[gm];n===void 0&&(n=e[gm]=new Set);var r=t+"__bubble";n.has(r)||(Ax(e,t,2,!1),n.add(r))}function rp(t,e,n){var r=0;e&&(r|=4),Ax(n,t,r,e)}var bu="_reactListening"+Math.random().toString(36).slice(2);function hc(t){if(!t[bu]){t[bu]=!0,OT.forEach(function(n){n!=="selectionchange"&&(G1.has(n)||rp(n,!1,t),rp(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[bu]||(e[bu]=!0,rp("selectionchange",!1,e))}}function Ax(t,e,n,r){switch(dx(e)){case 1:var s=l1;break;case 4:s=c1;break;default:s=Og}n=s.bind(null,e,n,t),s=void 0,!im||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),r?s!==void 0?t.addEventListener(e,n,{capture:!0,passive:s}):t.addEventListener(e,n,!0):s!==void 0?t.addEventListener(e,n,{passive:s}):t.addEventListener(e,n,!1)}function sp(t,e,n,r,s){var i=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var a=r.stateNode.containerInfo;if(a===s||a.nodeType===8&&a.parentNode===s)break;if(o===4)for(o=r.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===s||l.nodeType===8&&l.parentNode===s))return;o=o.return}for(;a!==null;){if(o=Mi(a),o===null)return;if(l=o.tag,l===5||l===6){r=i=o;continue e}a=a.parentNode}}r=r.return}XT(function(){var d=i,h=Ng(n),f=[];e:{var m=bx.get(t);if(m!==void 0){var _=Lg,A=t;switch(t){case"keypress":if(Ju(n)===0)break e;case"keydown":case"keyup":_=x1;break;case"focusin":A="focus",_=Xf;break;case"focusout":A="blur",_=Xf;break;case"beforeblur":case"afterblur":_=Xf;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":_=$v;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":_=h1;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":_=C1;break;case Ix:case Tx:case xx:_=m1;break;case Sx:_=R1;break;case"scroll":_=u1;break;case"wheel":_=N1;break;case"copy":case"cut":case"paste":_=y1;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":_=zv}var R=(e&4)!==0,C=!R&&t==="scroll",w=R?m!==null?m+"Capture":null:m;R=[];for(var I=d,b;I!==null;){b=I;var x=b.stateNode;if(b.tag===5&&x!==null&&(b=x,w!==null&&(x=oc(I,w),x!=null&&R.push(fc(I,x,b)))),C)break;I=I.return}0<R.length&&(m=new _(m,A,null,n,h),f.push({event:m,listeners:R}))}}if(!(e&7)){e:{if(m=t==="mouseover"||t==="pointerover",_=t==="mouseout"||t==="pointerout",m&&n!==rm&&(A=n.relatedTarget||n.fromElement)&&(Mi(A)||A[is]))break e;if((_||m)&&(m=h.window===h?h:(m=h.ownerDocument)?m.defaultView||m.parentWindow:window,_?(A=n.relatedTarget||n.toElement,_=d,A=A?Mi(A):null,A!==null&&(C=_o(A),A!==C||A.tag!==5&&A.tag!==6)&&(A=null)):(_=null,A=d),_!==A)){if(R=$v,x="onMouseLeave",w="onMouseEnter",I="mouse",(t==="pointerout"||t==="pointerover")&&(R=zv,x="onPointerLeave",w="onPointerEnter",I="pointer"),C=_==null?m:Qo(_),b=A==null?m:Qo(A),m=new R(x,I+"leave",_,n,h),m.target=C,m.relatedTarget=b,x=null,Mi(h)===d&&(R=new R(w,I+"enter",A,n,h),R.target=b,R.relatedTarget=C,x=R),C=x,_&&A)t:{for(R=_,w=A,I=0,b=R;b;b=bo(b))I++;for(b=0,x=w;x;x=bo(x))b++;for(;0<I-b;)R=bo(R),I--;for(;0<b-I;)w=bo(w),b--;for(;I--;){if(R===w||w!==null&&R===w.alternate)break t;R=bo(R),w=bo(w)}R=null}else R=null;_!==null&&ew(f,m,_,R,!1),A!==null&&C!==null&&ew(f,C,A,R,!0)}}e:{if(m=d?Qo(d):window,_=m.nodeName&&m.nodeName.toLowerCase(),_==="select"||_==="input"&&m.type==="file")var L=M1;else if(Wv(m))if(yx)L=B1;else{L=U1;var $=F1}else(_=m.nodeName)&&_.toLowerCase()==="input"&&(m.type==="checkbox"||m.type==="radio")&&(L=$1);if(L&&(L=L(t,d))){gx(f,L,n,h);break e}$&&$(t,m,d),t==="focusout"&&($=m._wrapperState)&&$.controlled&&m.type==="number"&&Jp(m,"number",m.value)}switch($=d?Qo(d):window,t){case"focusin":(Wv($)||$.contentEditable==="true")&&(Ko=$,um=d,zl=null);break;case"focusout":zl=um=Ko=null;break;case"mousedown":dm=!0;break;case"contextmenu":case"mouseup":case"dragend":dm=!1,Xv(f,n,h);break;case"selectionchange":if(H1)break;case"keydown":case"keyup":Xv(f,n,h)}var E;if(Fg)e:{switch(t){case"compositionstart":var v="onCompositionStart";break e;case"compositionend":v="onCompositionEnd";break e;case"compositionupdate":v="onCompositionUpdate";break e}v=void 0}else Wo?px(t,n)&&(v="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(v="onCompositionStart");v&&(fx&&n.locale!=="ko"&&(Wo||v!=="onCompositionStart"?v==="onCompositionEnd"&&Wo&&(E=hx()):(Bs=h,Vg="value"in Bs?Bs.value:Bs.textContent,Wo=!0)),$=Nd(d,v),0<$.length&&(v=new Bv(v,t,null,n,h),f.push({event:v,listeners:$}),E?v.data=E:(E=mx(n),E!==null&&(v.data=E)))),(E=D1?j1(t,n):O1(t,n))&&(d=Nd(d,"onBeforeInput"),0<d.length&&(h=new Bv("onBeforeInput","beforeinput",null,n,h),f.push({event:h,listeners:d}),h.data=E))}Cx(f,e)})}function fc(t,e,n){return{instance:t,listener:e,currentTarget:n}}function Nd(t,e){for(var n=e+"Capture",r=[];t!==null;){var s=t,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=oc(t,n),i!=null&&r.unshift(fc(t,i,s)),i=oc(t,e),i!=null&&r.push(fc(t,i,s))),t=t.return}return r}function bo(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function ew(t,e,n,r,s){for(var i=e._reactName,o=[];n!==null&&n!==r;){var a=n,l=a.alternate,d=a.stateNode;if(l!==null&&l===r)break;a.tag===5&&d!==null&&(a=d,s?(l=oc(n,i),l!=null&&o.unshift(fc(n,l,a))):s||(l=oc(n,i),l!=null&&o.push(fc(n,l,a)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var Q1=/\r\n?/g,Y1=/\u0000|\uFFFD/g;function tw(t){return(typeof t=="string"?t:""+t).replace(Q1,`
`).replace(Y1,"")}function Cu(t,e,n){if(e=tw(e),tw(t)!==e&&n)throw Error(K(425))}function kd(){}var hm=null,fm=null;function pm(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var mm=typeof setTimeout=="function"?setTimeout:void 0,X1=typeof clearTimeout=="function"?clearTimeout:void 0,nw=typeof Promise=="function"?Promise:void 0,J1=typeof queueMicrotask=="function"?queueMicrotask:typeof nw<"u"?function(t){return nw.resolve(null).then(t).catch(Z1)}:mm;function Z1(t){setTimeout(function(){throw t})}function ip(t,e){var n=e,r=0;do{var s=n.nextSibling;if(t.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){t.removeChild(s),cc(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);cc(e)}function Gs(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function rw(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var $a=Math.random().toString(36).slice(2),Lr="__reactFiber$"+$a,pc="__reactProps$"+$a,is="__reactContainer$"+$a,gm="__reactEvents$"+$a,eP="__reactListeners$"+$a,tP="__reactHandles$"+$a;function Mi(t){var e=t[Lr];if(e)return e;for(var n=t.parentNode;n;){if(e=n[is]||n[Lr]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=rw(t);t!==null;){if(n=t[Lr])return n;t=rw(t)}return e}t=n,n=t.parentNode}return null}function Fc(t){return t=t[Lr]||t[is],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Qo(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(K(33))}function kh(t){return t[pc]||null}var ym=[],Yo=-1;function fi(t){return{current:t}}function lt(t){0>Yo||(t.current=ym[Yo],ym[Yo]=null,Yo--)}function it(t,e){Yo++,ym[Yo]=t.current,t.current=e}var oi={},cn=fi(oi),Rn=fi(!1),Xi=oi;function va(t,e){var n=t.type.contextTypes;if(!n)return oi;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in n)s[i]=e[i];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function Pn(t){return t=t.childContextTypes,t!=null}function Dd(){lt(Rn),lt(cn)}function sw(t,e,n){if(cn.current!==oi)throw Error(K(168));it(cn,e),it(Rn,n)}function Rx(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in e))throw Error(K(108,FR(t)||"Unknown",s));return gt({},n,r)}function jd(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||oi,Xi=cn.current,it(cn,t),it(Rn,Rn.current),!0}function iw(t,e,n){var r=t.stateNode;if(!r)throw Error(K(169));n?(t=Rx(t,e,Xi),r.__reactInternalMemoizedMergedChildContext=t,lt(Rn),lt(cn),it(cn,t)):lt(Rn),it(Rn,n)}var Yr=null,Dh=!1,op=!1;function Px(t){Yr===null?Yr=[t]:Yr.push(t)}function nP(t){Dh=!0,Px(t)}function pi(){if(!op&&Yr!==null){op=!0;var t=0,e=Xe;try{var n=Yr;for(Xe=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}Yr=null,Dh=!1}catch(s){throw Yr!==null&&(Yr=Yr.slice(t+1)),tx(kg,pi),s}finally{Xe=e,op=!1}}return null}var Xo=[],Jo=0,Od=null,Vd=0,Yn=[],Xn=0,Ji=null,Xr=1,Jr="";function Ai(t,e){Xo[Jo++]=Vd,Xo[Jo++]=Od,Od=t,Vd=e}function Nx(t,e,n){Yn[Xn++]=Xr,Yn[Xn++]=Jr,Yn[Xn++]=Ji,Ji=t;var r=Xr;t=Jr;var s=32-yr(r)-1;r&=~(1<<s),n+=1;var i=32-yr(e)+s;if(30<i){var o=s-s%5;i=(r&(1<<o)-1).toString(32),r>>=o,s-=o,Xr=1<<32-yr(e)+s|n<<s|r,Jr=i+t}else Xr=1<<i|n<<s|r,Jr=t}function $g(t){t.return!==null&&(Ai(t,1),Nx(t,1,0))}function Bg(t){for(;t===Od;)Od=Xo[--Jo],Xo[Jo]=null,Vd=Xo[--Jo],Xo[Jo]=null;for(;t===Ji;)Ji=Yn[--Xn],Yn[Xn]=null,Jr=Yn[--Xn],Yn[Xn]=null,Xr=Yn[--Xn],Yn[Xn]=null}var Bn=null,Un=null,ut=!1,mr=null;function kx(t,e){var n=er(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function ow(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Bn=t,Un=Gs(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Bn=t,Un=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=Ji!==null?{id:Xr,overflow:Jr}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=er(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,Bn=t,Un=null,!0):!1;default:return!1}}function _m(t){return(t.mode&1)!==0&&(t.flags&128)===0}function vm(t){if(ut){var e=Un;if(e){var n=e;if(!ow(t,e)){if(_m(t))throw Error(K(418));e=Gs(n.nextSibling);var r=Bn;e&&ow(t,e)?kx(r,n):(t.flags=t.flags&-4097|2,ut=!1,Bn=t)}}else{if(_m(t))throw Error(K(418));t.flags=t.flags&-4097|2,ut=!1,Bn=t}}}function aw(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Bn=t}function Au(t){if(t!==Bn)return!1;if(!ut)return aw(t),ut=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!pm(t.type,t.memoizedProps)),e&&(e=Un)){if(_m(t))throw Dx(),Error(K(418));for(;e;)kx(t,e),e=Gs(e.nextSibling)}if(aw(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(K(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){Un=Gs(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}Un=null}}else Un=Bn?Gs(t.stateNode.nextSibling):null;return!0}function Dx(){for(var t=Un;t;)t=Gs(t.nextSibling)}function wa(){Un=Bn=null,ut=!1}function zg(t){mr===null?mr=[t]:mr.push(t)}var rP=ps.ReactCurrentBatchConfig;function gl(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(K(309));var r=n.stateNode}if(!r)throw Error(K(147,t));var s=r,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(o){var a=s.refs;o===null?delete a[i]:a[i]=o},e._stringRef=i,e)}if(typeof t!="string")throw Error(K(284));if(!n._owner)throw Error(K(290,t))}return t}function Ru(t,e){throw t=Object.prototype.toString.call(e),Error(K(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function lw(t){var e=t._init;return e(t._payload)}function jx(t){function e(w,I){if(t){var b=w.deletions;b===null?(w.deletions=[I],w.flags|=16):b.push(I)}}function n(w,I){if(!t)return null;for(;I!==null;)e(w,I),I=I.sibling;return null}function r(w,I){for(w=new Map;I!==null;)I.key!==null?w.set(I.key,I):w.set(I.index,I),I=I.sibling;return w}function s(w,I){return w=Js(w,I),w.index=0,w.sibling=null,w}function i(w,I,b){return w.index=b,t?(b=w.alternate,b!==null?(b=b.index,b<I?(w.flags|=2,I):b):(w.flags|=2,I)):(w.flags|=1048576,I)}function o(w){return t&&w.alternate===null&&(w.flags|=2),w}function a(w,I,b,x){return I===null||I.tag!==6?(I=fp(b,w.mode,x),I.return=w,I):(I=s(I,b),I.return=w,I)}function l(w,I,b,x){var L=b.type;return L===Ho?h(w,I,b.props.children,x,b.key):I!==null&&(I.elementType===L||typeof L=="object"&&L!==null&&L.$$typeof===Ns&&lw(L)===I.type)?(x=s(I,b.props),x.ref=gl(w,I,b),x.return=w,x):(x=id(b.type,b.key,b.props,null,w.mode,x),x.ref=gl(w,I,b),x.return=w,x)}function d(w,I,b,x){return I===null||I.tag!==4||I.stateNode.containerInfo!==b.containerInfo||I.stateNode.implementation!==b.implementation?(I=pp(b,w.mode,x),I.return=w,I):(I=s(I,b.children||[]),I.return=w,I)}function h(w,I,b,x,L){return I===null||I.tag!==7?(I=qi(b,w.mode,x,L),I.return=w,I):(I=s(I,b),I.return=w,I)}function f(w,I,b){if(typeof I=="string"&&I!==""||typeof I=="number")return I=fp(""+I,w.mode,b),I.return=w,I;if(typeof I=="object"&&I!==null){switch(I.$$typeof){case _u:return b=id(I.type,I.key,I.props,null,w.mode,b),b.ref=gl(w,null,I),b.return=w,b;case qo:return I=pp(I,w.mode,b),I.return=w,I;case Ns:var x=I._init;return f(w,x(I._payload),b)}if(Al(I)||dl(I))return I=qi(I,w.mode,b,null),I.return=w,I;Ru(w,I)}return null}function m(w,I,b,x){var L=I!==null?I.key:null;if(typeof b=="string"&&b!==""||typeof b=="number")return L!==null?null:a(w,I,""+b,x);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case _u:return b.key===L?l(w,I,b,x):null;case qo:return b.key===L?d(w,I,b,x):null;case Ns:return L=b._init,m(w,I,L(b._payload),x)}if(Al(b)||dl(b))return L!==null?null:h(w,I,b,x,null);Ru(w,b)}return null}function _(w,I,b,x,L){if(typeof x=="string"&&x!==""||typeof x=="number")return w=w.get(b)||null,a(I,w,""+x,L);if(typeof x=="object"&&x!==null){switch(x.$$typeof){case _u:return w=w.get(x.key===null?b:x.key)||null,l(I,w,x,L);case qo:return w=w.get(x.key===null?b:x.key)||null,d(I,w,x,L);case Ns:var $=x._init;return _(w,I,b,$(x._payload),L)}if(Al(x)||dl(x))return w=w.get(b)||null,h(I,w,x,L,null);Ru(I,x)}return null}function A(w,I,b,x){for(var L=null,$=null,E=I,v=I=0,y=null;E!==null&&v<b.length;v++){E.index>v?(y=E,E=null):y=E.sibling;var N=m(w,E,b[v],x);if(N===null){E===null&&(E=y);break}t&&E&&N.alternate===null&&e(w,E),I=i(N,I,v),$===null?L=N:$.sibling=N,$=N,E=y}if(v===b.length)return n(w,E),ut&&Ai(w,v),L;if(E===null){for(;v<b.length;v++)E=f(w,b[v],x),E!==null&&(I=i(E,I,v),$===null?L=E:$.sibling=E,$=E);return ut&&Ai(w,v),L}for(E=r(w,E);v<b.length;v++)y=_(E,w,v,b[v],x),y!==null&&(t&&y.alternate!==null&&E.delete(y.key===null?v:y.key),I=i(y,I,v),$===null?L=y:$.sibling=y,$=y);return t&&E.forEach(function(D){return e(w,D)}),ut&&Ai(w,v),L}function R(w,I,b,x){var L=dl(b);if(typeof L!="function")throw Error(K(150));if(b=L.call(b),b==null)throw Error(K(151));for(var $=L=null,E=I,v=I=0,y=null,N=b.next();E!==null&&!N.done;v++,N=b.next()){E.index>v?(y=E,E=null):y=E.sibling;var D=m(w,E,N.value,x);if(D===null){E===null&&(E=y);break}t&&E&&D.alternate===null&&e(w,E),I=i(D,I,v),$===null?L=D:$.sibling=D,$=D,E=y}if(N.done)return n(w,E),ut&&Ai(w,v),L;if(E===null){for(;!N.done;v++,N=b.next())N=f(w,N.value,x),N!==null&&(I=i(N,I,v),$===null?L=N:$.sibling=N,$=N);return ut&&Ai(w,v),L}for(E=r(w,E);!N.done;v++,N=b.next())N=_(E,w,v,N.value,x),N!==null&&(t&&N.alternate!==null&&E.delete(N.key===null?v:N.key),I=i(N,I,v),$===null?L=N:$.sibling=N,$=N);return t&&E.forEach(function(j){return e(w,j)}),ut&&Ai(w,v),L}function C(w,I,b,x){if(typeof b=="object"&&b!==null&&b.type===Ho&&b.key===null&&(b=b.props.children),typeof b=="object"&&b!==null){switch(b.$$typeof){case _u:e:{for(var L=b.key,$=I;$!==null;){if($.key===L){if(L=b.type,L===Ho){if($.tag===7){n(w,$.sibling),I=s($,b.props.children),I.return=w,w=I;break e}}else if($.elementType===L||typeof L=="object"&&L!==null&&L.$$typeof===Ns&&lw(L)===$.type){n(w,$.sibling),I=s($,b.props),I.ref=gl(w,$,b),I.return=w,w=I;break e}n(w,$);break}else e(w,$);$=$.sibling}b.type===Ho?(I=qi(b.props.children,w.mode,x,b.key),I.return=w,w=I):(x=id(b.type,b.key,b.props,null,w.mode,x),x.ref=gl(w,I,b),x.return=w,w=x)}return o(w);case qo:e:{for($=b.key;I!==null;){if(I.key===$)if(I.tag===4&&I.stateNode.containerInfo===b.containerInfo&&I.stateNode.implementation===b.implementation){n(w,I.sibling),I=s(I,b.children||[]),I.return=w,w=I;break e}else{n(w,I);break}else e(w,I);I=I.sibling}I=pp(b,w.mode,x),I.return=w,w=I}return o(w);case Ns:return $=b._init,C(w,I,$(b._payload),x)}if(Al(b))return A(w,I,b,x);if(dl(b))return R(w,I,b,x);Ru(w,b)}return typeof b=="string"&&b!==""||typeof b=="number"?(b=""+b,I!==null&&I.tag===6?(n(w,I.sibling),I=s(I,b),I.return=w,w=I):(n(w,I),I=fp(b,w.mode,x),I.return=w,w=I),o(w)):n(w,I)}return C}var Ea=jx(!0),Ox=jx(!1),Ld=fi(null),Md=null,Zo=null,qg=null;function Hg(){qg=Zo=Md=null}function Wg(t){var e=Ld.current;lt(Ld),t._currentValue=e}function wm(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function la(t,e){Md=t,qg=Zo=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Cn=!0),t.firstContext=null)}function sr(t){var e=t._currentValue;if(qg!==t)if(t={context:t,memoizedValue:e,next:null},Zo===null){if(Md===null)throw Error(K(308));Zo=t,Md.dependencies={lanes:0,firstContext:t}}else Zo=Zo.next=t;return e}var Fi=null;function Kg(t){Fi===null?Fi=[t]:Fi.push(t)}function Vx(t,e,n,r){var s=e.interleaved;return s===null?(n.next=n,Kg(e)):(n.next=s.next,s.next=n),e.interleaved=n,os(t,r)}function os(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var ks=!1;function Gg(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Lx(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function ns(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Qs(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,qe&2){var s=r.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),r.pending=e,os(t,n)}return s=r.interleaved,s===null?(e.next=e,Kg(r)):(e.next=s.next,s.next=e),r.interleaved=e,os(t,n)}function Zu(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Dg(t,n)}}function cw(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?s=i=o:i=i.next=o,n=n.next}while(n!==null);i===null?s=i=e:i=i.next=e}else s=i=e;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function Fd(t,e,n,r){var s=t.updateQueue;ks=!1;var i=s.firstBaseUpdate,o=s.lastBaseUpdate,a=s.shared.pending;if(a!==null){s.shared.pending=null;var l=a,d=l.next;l.next=null,o===null?i=d:o.next=d,o=l;var h=t.alternate;h!==null&&(h=h.updateQueue,a=h.lastBaseUpdate,a!==o&&(a===null?h.firstBaseUpdate=d:a.next=d,h.lastBaseUpdate=l))}if(i!==null){var f=s.baseState;o=0,h=d=l=null,a=i;do{var m=a.lane,_=a.eventTime;if((r&m)===m){h!==null&&(h=h.next={eventTime:_,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var A=t,R=a;switch(m=e,_=n,R.tag){case 1:if(A=R.payload,typeof A=="function"){f=A.call(_,f,m);break e}f=A;break e;case 3:A.flags=A.flags&-65537|128;case 0:if(A=R.payload,m=typeof A=="function"?A.call(_,f,m):A,m==null)break e;f=gt({},f,m);break e;case 2:ks=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,m=s.effects,m===null?s.effects=[a]:m.push(a))}else _={eventTime:_,lane:m,tag:a.tag,payload:a.payload,callback:a.callback,next:null},h===null?(d=h=_,l=f):h=h.next=_,o|=m;if(a=a.next,a===null){if(a=s.shared.pending,a===null)break;m=a,a=m.next,m.next=null,s.lastBaseUpdate=m,s.shared.pending=null}}while(!0);if(h===null&&(l=f),s.baseState=l,s.firstBaseUpdate=d,s.lastBaseUpdate=h,e=s.shared.interleaved,e!==null){s=e;do o|=s.lane,s=s.next;while(s!==e)}else i===null&&(s.shared.lanes=0);eo|=o,t.lanes=o,t.memoizedState=f}}function uw(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(K(191,s));s.call(r)}}}var Uc={},Br=fi(Uc),mc=fi(Uc),gc=fi(Uc);function Ui(t){if(t===Uc)throw Error(K(174));return t}function Qg(t,e){switch(it(gc,e),it(mc,t),it(Br,Uc),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:em(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=em(e,t)}lt(Br),it(Br,e)}function Ia(){lt(Br),lt(mc),lt(gc)}function Mx(t){Ui(gc.current);var e=Ui(Br.current),n=em(e,t.type);e!==n&&(it(mc,t),it(Br,n))}function Yg(t){mc.current===t&&(lt(Br),lt(mc))}var ft=fi(0);function Ud(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var ap=[];function Xg(){for(var t=0;t<ap.length;t++)ap[t]._workInProgressVersionPrimary=null;ap.length=0}var ed=ps.ReactCurrentDispatcher,lp=ps.ReactCurrentBatchConfig,Zi=0,mt=null,jt=null,zt=null,$d=!1,ql=!1,yc=0,sP=0;function Zt(){throw Error(K(321))}function Jg(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!wr(t[n],e[n]))return!1;return!0}function Zg(t,e,n,r,s,i){if(Zi=i,mt=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,ed.current=t===null||t.memoizedState===null?lP:cP,t=n(r,s),ql){i=0;do{if(ql=!1,yc=0,25<=i)throw Error(K(301));i+=1,zt=jt=null,e.updateQueue=null,ed.current=uP,t=n(r,s)}while(ql)}if(ed.current=Bd,e=jt!==null&&jt.next!==null,Zi=0,zt=jt=mt=null,$d=!1,e)throw Error(K(300));return t}function ey(){var t=yc!==0;return yc=0,t}function Or(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return zt===null?mt.memoizedState=zt=t:zt=zt.next=t,zt}function ir(){if(jt===null){var t=mt.alternate;t=t!==null?t.memoizedState:null}else t=jt.next;var e=zt===null?mt.memoizedState:zt.next;if(e!==null)zt=e,jt=t;else{if(t===null)throw Error(K(310));jt=t,t={memoizedState:jt.memoizedState,baseState:jt.baseState,baseQueue:jt.baseQueue,queue:jt.queue,next:null},zt===null?mt.memoizedState=zt=t:zt=zt.next=t}return zt}function _c(t,e){return typeof e=="function"?e(t):e}function cp(t){var e=ir(),n=e.queue;if(n===null)throw Error(K(311));n.lastRenderedReducer=t;var r=jt,s=r.baseQueue,i=n.pending;if(i!==null){if(s!==null){var o=s.next;s.next=i.next,i.next=o}r.baseQueue=s=i,n.pending=null}if(s!==null){i=s.next,r=r.baseState;var a=o=null,l=null,d=i;do{var h=d.lane;if((Zi&h)===h)l!==null&&(l=l.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),r=d.hasEagerState?d.eagerState:t(r,d.action);else{var f={lane:h,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};l===null?(a=l=f,o=r):l=l.next=f,mt.lanes|=h,eo|=h}d=d.next}while(d!==null&&d!==i);l===null?o=r:l.next=a,wr(r,e.memoizedState)||(Cn=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=l,n.lastRenderedState=r}if(t=n.interleaved,t!==null){s=t;do i=s.lane,mt.lanes|=i,eo|=i,s=s.next;while(s!==t)}else s===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function up(t){var e=ir(),n=e.queue;if(n===null)throw Error(K(311));n.lastRenderedReducer=t;var r=n.dispatch,s=n.pending,i=e.memoizedState;if(s!==null){n.pending=null;var o=s=s.next;do i=t(i,o.action),o=o.next;while(o!==s);wr(i,e.memoizedState)||(Cn=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),n.lastRenderedState=i}return[i,r]}function Fx(){}function Ux(t,e){var n=mt,r=ir(),s=e(),i=!wr(r.memoizedState,s);if(i&&(r.memoizedState=s,Cn=!0),r=r.queue,ty(zx.bind(null,n,r,t),[t]),r.getSnapshot!==e||i||zt!==null&&zt.memoizedState.tag&1){if(n.flags|=2048,vc(9,Bx.bind(null,n,r,s,e),void 0,null),qt===null)throw Error(K(349));Zi&30||$x(n,e,s)}return s}function $x(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=mt.updateQueue,e===null?(e={lastEffect:null,stores:null},mt.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function Bx(t,e,n,r){e.value=n,e.getSnapshot=r,qx(e)&&Hx(t)}function zx(t,e,n){return n(function(){qx(e)&&Hx(t)})}function qx(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!wr(t,n)}catch{return!0}}function Hx(t){var e=os(t,1);e!==null&&_r(e,t,1,-1)}function dw(t){var e=Or();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:_c,lastRenderedState:t},e.queue=t,t=t.dispatch=aP.bind(null,mt,t),[e.memoizedState,t]}function vc(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=mt.updateQueue,e===null?(e={lastEffect:null,stores:null},mt.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function Wx(){return ir().memoizedState}function td(t,e,n,r){var s=Or();mt.flags|=t,s.memoizedState=vc(1|e,n,void 0,r===void 0?null:r)}function jh(t,e,n,r){var s=ir();r=r===void 0?null:r;var i=void 0;if(jt!==null){var o=jt.memoizedState;if(i=o.destroy,r!==null&&Jg(r,o.deps)){s.memoizedState=vc(e,n,i,r);return}}mt.flags|=t,s.memoizedState=vc(1|e,n,i,r)}function hw(t,e){return td(8390656,8,t,e)}function ty(t,e){return jh(2048,8,t,e)}function Kx(t,e){return jh(4,2,t,e)}function Gx(t,e){return jh(4,4,t,e)}function Qx(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function Yx(t,e,n){return n=n!=null?n.concat([t]):null,jh(4,4,Qx.bind(null,e,t),n)}function ny(){}function Xx(t,e){var n=ir();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Jg(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function Jx(t,e){var n=ir();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Jg(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function Zx(t,e,n){return Zi&21?(wr(n,e)||(n=sx(),mt.lanes|=n,eo|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Cn=!0),t.memoizedState=n)}function iP(t,e){var n=Xe;Xe=n!==0&&4>n?n:4,t(!0);var r=lp.transition;lp.transition={};try{t(!1),e()}finally{Xe=n,lp.transition=r}}function e0(){return ir().memoizedState}function oP(t,e,n){var r=Xs(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},t0(t))n0(e,n);else if(n=Vx(t,e,n,r),n!==null){var s=_n();_r(n,t,r,s),r0(n,e,r)}}function aP(t,e,n){var r=Xs(t),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(t0(t))n0(e,s);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var o=e.lastRenderedState,a=i(o,n);if(s.hasEagerState=!0,s.eagerState=a,wr(a,o)){var l=e.interleaved;l===null?(s.next=s,Kg(e)):(s.next=l.next,l.next=s),e.interleaved=s;return}}catch{}finally{}n=Vx(t,e,s,r),n!==null&&(s=_n(),_r(n,t,r,s),r0(n,e,r))}}function t0(t){var e=t.alternate;return t===mt||e!==null&&e===mt}function n0(t,e){ql=$d=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function r0(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Dg(t,n)}}var Bd={readContext:sr,useCallback:Zt,useContext:Zt,useEffect:Zt,useImperativeHandle:Zt,useInsertionEffect:Zt,useLayoutEffect:Zt,useMemo:Zt,useReducer:Zt,useRef:Zt,useState:Zt,useDebugValue:Zt,useDeferredValue:Zt,useTransition:Zt,useMutableSource:Zt,useSyncExternalStore:Zt,useId:Zt,unstable_isNewReconciler:!1},lP={readContext:sr,useCallback:function(t,e){return Or().memoizedState=[t,e===void 0?null:e],t},useContext:sr,useEffect:hw,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,td(4194308,4,Qx.bind(null,e,t),n)},useLayoutEffect:function(t,e){return td(4194308,4,t,e)},useInsertionEffect:function(t,e){return td(4,2,t,e)},useMemo:function(t,e){var n=Or();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=Or();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=oP.bind(null,mt,t),[r.memoizedState,t]},useRef:function(t){var e=Or();return t={current:t},e.memoizedState=t},useState:dw,useDebugValue:ny,useDeferredValue:function(t){return Or().memoizedState=t},useTransition:function(){var t=dw(!1),e=t[0];return t=iP.bind(null,t[1]),Or().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=mt,s=Or();if(ut){if(n===void 0)throw Error(K(407));n=n()}else{if(n=e(),qt===null)throw Error(K(349));Zi&30||$x(r,e,n)}s.memoizedState=n;var i={value:n,getSnapshot:e};return s.queue=i,hw(zx.bind(null,r,i,t),[t]),r.flags|=2048,vc(9,Bx.bind(null,r,i,n,e),void 0,null),n},useId:function(){var t=Or(),e=qt.identifierPrefix;if(ut){var n=Jr,r=Xr;n=(r&~(1<<32-yr(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=yc++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=sP++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},cP={readContext:sr,useCallback:Xx,useContext:sr,useEffect:ty,useImperativeHandle:Yx,useInsertionEffect:Kx,useLayoutEffect:Gx,useMemo:Jx,useReducer:cp,useRef:Wx,useState:function(){return cp(_c)},useDebugValue:ny,useDeferredValue:function(t){var e=ir();return Zx(e,jt.memoizedState,t)},useTransition:function(){var t=cp(_c)[0],e=ir().memoizedState;return[t,e]},useMutableSource:Fx,useSyncExternalStore:Ux,useId:e0,unstable_isNewReconciler:!1},uP={readContext:sr,useCallback:Xx,useContext:sr,useEffect:ty,useImperativeHandle:Yx,useInsertionEffect:Kx,useLayoutEffect:Gx,useMemo:Jx,useReducer:up,useRef:Wx,useState:function(){return up(_c)},useDebugValue:ny,useDeferredValue:function(t){var e=ir();return jt===null?e.memoizedState=t:Zx(e,jt.memoizedState,t)},useTransition:function(){var t=up(_c)[0],e=ir().memoizedState;return[t,e]},useMutableSource:Fx,useSyncExternalStore:Ux,useId:e0,unstable_isNewReconciler:!1};function hr(t,e){if(t&&t.defaultProps){e=gt({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function Em(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:gt({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var Oh={isMounted:function(t){return(t=t._reactInternals)?_o(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=_n(),s=Xs(t),i=ns(r,s);i.payload=e,n!=null&&(i.callback=n),e=Qs(t,i,s),e!==null&&(_r(e,t,s,r),Zu(e,t,s))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=_n(),s=Xs(t),i=ns(r,s);i.tag=1,i.payload=e,n!=null&&(i.callback=n),e=Qs(t,i,s),e!==null&&(_r(e,t,s,r),Zu(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=_n(),r=Xs(t),s=ns(n,r);s.tag=2,e!=null&&(s.callback=e),e=Qs(t,s,r),e!==null&&(_r(e,t,r,n),Zu(e,t,r))}};function fw(t,e,n,r,s,i,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,i,o):e.prototype&&e.prototype.isPureReactComponent?!dc(n,r)||!dc(s,i):!0}function s0(t,e,n){var r=!1,s=oi,i=e.contextType;return typeof i=="object"&&i!==null?i=sr(i):(s=Pn(e)?Xi:cn.current,r=e.contextTypes,i=(r=r!=null)?va(t,s):oi),e=new e(n,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Oh,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=i),e}function pw(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&Oh.enqueueReplaceState(e,e.state,null)}function Im(t,e,n,r){var s=t.stateNode;s.props=n,s.state=t.memoizedState,s.refs={},Gg(t);var i=e.contextType;typeof i=="object"&&i!==null?s.context=sr(i):(i=Pn(e)?Xi:cn.current,s.context=va(t,i)),s.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(Em(t,e,i,n),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&Oh.enqueueReplaceState(s,s.state,null),Fd(t,n,s,r),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function Ta(t,e){try{var n="",r=e;do n+=MR(r),r=r.return;while(r);var s=n}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:s,digest:null}}function dp(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function Tm(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var dP=typeof WeakMap=="function"?WeakMap:Map;function i0(t,e,n){n=ns(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){qd||(qd=!0,Dm=r),Tm(t,e)},n}function o0(t,e,n){n=ns(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var s=e.value;n.payload=function(){return r(s)},n.callback=function(){Tm(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){Tm(t,e),typeof r!="function"&&(Ys===null?Ys=new Set([this]):Ys.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function mw(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new dP;var s=new Set;r.set(e,s)}else s=r.get(e),s===void 0&&(s=new Set,r.set(e,s));s.has(n)||(s.add(n),t=SP.bind(null,t,e,n),e.then(t,t))}function gw(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function yw(t,e,n,r,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=ns(-1,1),e.tag=2,Qs(n,e,1))),n.lanes|=1),t)}var hP=ps.ReactCurrentOwner,Cn=!1;function fn(t,e,n,r){e.child=t===null?Ox(e,null,n,r):Ea(e,t.child,n,r)}function _w(t,e,n,r,s){n=n.render;var i=e.ref;return la(e,s),r=Zg(t,e,n,r,i,s),n=ey(),t!==null&&!Cn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,as(t,e,s)):(ut&&n&&$g(e),e.flags|=1,fn(t,e,r,s),e.child)}function vw(t,e,n,r,s){if(t===null){var i=n.type;return typeof i=="function"&&!uy(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=i,a0(t,e,i,r,s)):(t=id(n.type,null,r,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&s)){var o=i.memoizedProps;if(n=n.compare,n=n!==null?n:dc,n(o,r)&&t.ref===e.ref)return as(t,e,s)}return e.flags|=1,t=Js(i,r),t.ref=e.ref,t.return=e,e.child=t}function a0(t,e,n,r,s){if(t!==null){var i=t.memoizedProps;if(dc(i,r)&&t.ref===e.ref)if(Cn=!1,e.pendingProps=r=i,(t.lanes&s)!==0)t.flags&131072&&(Cn=!0);else return e.lanes=t.lanes,as(t,e,s)}return xm(t,e,n,r,s)}function l0(t,e,n){var r=e.pendingProps,s=r.children,i=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},it(ta,Ln),Ln|=n;else{if(!(n&1073741824))return t=i!==null?i.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,it(ta,Ln),Ln|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,it(ta,Ln),Ln|=r}else i!==null?(r=i.baseLanes|n,e.memoizedState=null):r=n,it(ta,Ln),Ln|=r;return fn(t,e,s,n),e.child}function c0(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function xm(t,e,n,r,s){var i=Pn(n)?Xi:cn.current;return i=va(e,i),la(e,s),n=Zg(t,e,n,r,i,s),r=ey(),t!==null&&!Cn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,as(t,e,s)):(ut&&r&&$g(e),e.flags|=1,fn(t,e,n,s),e.child)}function ww(t,e,n,r,s){if(Pn(n)){var i=!0;jd(e)}else i=!1;if(la(e,s),e.stateNode===null)nd(t,e),s0(e,n,r),Im(e,n,r,s),r=!0;else if(t===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var l=o.context,d=n.contextType;typeof d=="object"&&d!==null?d=sr(d):(d=Pn(n)?Xi:cn.current,d=va(e,d));var h=n.getDerivedStateFromProps,f=typeof h=="function"||typeof o.getSnapshotBeforeUpdate=="function";f||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==r||l!==d)&&pw(e,o,r,d),ks=!1;var m=e.memoizedState;o.state=m,Fd(e,r,o,s),l=e.memoizedState,a!==r||m!==l||Rn.current||ks?(typeof h=="function"&&(Em(e,n,h,r),l=e.memoizedState),(a=ks||fw(e,n,a,r,m,l,d))?(f||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=l),o.props=r,o.state=l,o.context=d,r=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,Lx(t,e),a=e.memoizedProps,d=e.type===e.elementType?a:hr(e.type,a),o.props=d,f=e.pendingProps,m=o.context,l=n.contextType,typeof l=="object"&&l!==null?l=sr(l):(l=Pn(n)?Xi:cn.current,l=va(e,l));var _=n.getDerivedStateFromProps;(h=typeof _=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==f||m!==l)&&pw(e,o,r,l),ks=!1,m=e.memoizedState,o.state=m,Fd(e,r,o,s);var A=e.memoizedState;a!==f||m!==A||Rn.current||ks?(typeof _=="function"&&(Em(e,n,_,r),A=e.memoizedState),(d=ks||fw(e,n,d,r,m,A,l)||!1)?(h||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,A,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,A,l)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&m===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&m===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=A),o.props=r,o.state=A,o.context=l,r=d):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&m===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&m===t.memoizedState||(e.flags|=1024),r=!1)}return Sm(t,e,n,r,i,s)}function Sm(t,e,n,r,s,i){c0(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return s&&iw(e,n,!1),as(t,e,i);r=e.stateNode,hP.current=e;var a=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=Ea(e,t.child,null,i),e.child=Ea(e,null,a,i)):fn(t,e,a,i),e.memoizedState=r.state,s&&iw(e,n,!0),e.child}function u0(t){var e=t.stateNode;e.pendingContext?sw(t,e.pendingContext,e.pendingContext!==e.context):e.context&&sw(t,e.context,!1),Qg(t,e.containerInfo)}function Ew(t,e,n,r,s){return wa(),zg(s),e.flags|=256,fn(t,e,n,r),e.child}var bm={dehydrated:null,treeContext:null,retryLane:0};function Cm(t){return{baseLanes:t,cachePool:null,transitions:null}}function d0(t,e,n){var r=e.pendingProps,s=ft.current,i=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=t!==null&&t.memoizedState===null?!1:(s&2)!==0),a?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),it(ft,s&1),t===null)return vm(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,i?(r=e.mode,i=e.child,o={mode:"hidden",children:o},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=Mh(o,r,0,null),t=qi(t,r,n,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=Cm(n),e.memoizedState=bm,t):ry(e,o));if(s=t.memoizedState,s!==null&&(a=s.dehydrated,a!==null))return fP(t,e,o,r,a,s,n);if(i){i=r.fallback,o=e.mode,s=t.child,a=s.sibling;var l={mode:"hidden",children:r.children};return!(o&1)&&e.child!==s?(r=e.child,r.childLanes=0,r.pendingProps=l,e.deletions=null):(r=Js(s,l),r.subtreeFlags=s.subtreeFlags&14680064),a!==null?i=Js(a,i):(i=qi(i,o,n,null),i.flags|=2),i.return=e,r.return=e,r.sibling=i,e.child=r,r=i,i=e.child,o=t.child.memoizedState,o=o===null?Cm(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=t.childLanes&~n,e.memoizedState=bm,r}return i=t.child,t=i.sibling,r=Js(i,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function ry(t,e){return e=Mh({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Pu(t,e,n,r){return r!==null&&zg(r),Ea(e,t.child,null,n),t=ry(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function fP(t,e,n,r,s,i,o){if(n)return e.flags&256?(e.flags&=-257,r=dp(Error(K(422))),Pu(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=r.fallback,s=e.mode,r=Mh({mode:"visible",children:r.children},s,0,null),i=qi(i,s,o,null),i.flags|=2,r.return=e,i.return=e,r.sibling=i,e.child=r,e.mode&1&&Ea(e,t.child,null,o),e.child.memoizedState=Cm(o),e.memoizedState=bm,i);if(!(e.mode&1))return Pu(t,e,o,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var a=r.dgst;return r=a,i=Error(K(419)),r=dp(i,r,void 0),Pu(t,e,o,r)}if(a=(o&t.childLanes)!==0,Cn||a){if(r=qt,r!==null){switch(o&-o){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|o)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,os(t,s),_r(r,t,s,-1))}return cy(),r=dp(Error(K(421))),Pu(t,e,o,r)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=bP.bind(null,t),s._reactRetry=e,null):(t=i.treeContext,Un=Gs(s.nextSibling),Bn=e,ut=!0,mr=null,t!==null&&(Yn[Xn++]=Xr,Yn[Xn++]=Jr,Yn[Xn++]=Ji,Xr=t.id,Jr=t.overflow,Ji=e),e=ry(e,r.children),e.flags|=4096,e)}function Iw(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),wm(t.return,e,n)}function hp(t,e,n,r,s){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=s)}function h0(t,e,n){var r=e.pendingProps,s=r.revealOrder,i=r.tail;if(fn(t,e,r.children,n),r=ft.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&Iw(t,n,e);else if(t.tag===19)Iw(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(it(ft,r),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(n=e.child,s=null;n!==null;)t=n.alternate,t!==null&&Ud(t)===null&&(s=n),n=n.sibling;n=s,n===null?(s=e.child,e.child=null):(s=n.sibling,n.sibling=null),hp(e,!1,s,n,i);break;case"backwards":for(n=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&Ud(t)===null){e.child=s;break}t=s.sibling,s.sibling=n,n=s,s=t}hp(e,!0,n,null,i);break;case"together":hp(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function nd(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function as(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),eo|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(K(153));if(e.child!==null){for(t=e.child,n=Js(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Js(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function pP(t,e,n){switch(e.tag){case 3:u0(e),wa();break;case 5:Mx(e);break;case 1:Pn(e.type)&&jd(e);break;case 4:Qg(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,s=e.memoizedProps.value;it(Ld,r._currentValue),r._currentValue=s;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(it(ft,ft.current&1),e.flags|=128,null):n&e.child.childLanes?d0(t,e,n):(it(ft,ft.current&1),t=as(t,e,n),t!==null?t.sibling:null);it(ft,ft.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return h0(t,e,n);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),it(ft,ft.current),r)break;return null;case 22:case 23:return e.lanes=0,l0(t,e,n)}return as(t,e,n)}var f0,Am,p0,m0;f0=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Am=function(){};p0=function(t,e,n,r){var s=t.memoizedProps;if(s!==r){t=e.stateNode,Ui(Br.current);var i=null;switch(n){case"input":s=Yp(t,s),r=Yp(t,r),i=[];break;case"select":s=gt({},s,{value:void 0}),r=gt({},r,{value:void 0}),i=[];break;case"textarea":s=Zp(t,s),r=Zp(t,r),i=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=kd)}tm(n,r);var o;n=null;for(d in s)if(!r.hasOwnProperty(d)&&s.hasOwnProperty(d)&&s[d]!=null)if(d==="style"){var a=s[d];for(o in a)a.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(sc.hasOwnProperty(d)?i||(i=[]):(i=i||[]).push(d,null));for(d in r){var l=r[d];if(a=s!=null?s[d]:void 0,r.hasOwnProperty(d)&&l!==a&&(l!=null||a!=null))if(d==="style")if(a){for(o in a)!a.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in l)l.hasOwnProperty(o)&&a[o]!==l[o]&&(n||(n={}),n[o]=l[o])}else n||(i||(i=[]),i.push(d,n)),n=l;else d==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(i=i||[]).push(d,l)):d==="children"?typeof l!="string"&&typeof l!="number"||(i=i||[]).push(d,""+l):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(sc.hasOwnProperty(d)?(l!=null&&d==="onScroll"&&at("scroll",t),i||a===l||(i=[])):(i=i||[]).push(d,l))}n&&(i=i||[]).push("style",n);var d=i;(e.updateQueue=d)&&(e.flags|=4)}};m0=function(t,e,n,r){n!==r&&(e.flags|=4)};function yl(t,e){if(!ut)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function en(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function mP(t,e,n){var r=e.pendingProps;switch(Bg(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return en(e),null;case 1:return Pn(e.type)&&Dd(),en(e),null;case 3:return r=e.stateNode,Ia(),lt(Rn),lt(cn),Xg(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(Au(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,mr!==null&&(Vm(mr),mr=null))),Am(t,e),en(e),null;case 5:Yg(e);var s=Ui(gc.current);if(n=e.type,t!==null&&e.stateNode!=null)p0(t,e,n,r,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(K(166));return en(e),null}if(t=Ui(Br.current),Au(e)){r=e.stateNode,n=e.type;var i=e.memoizedProps;switch(r[Lr]=e,r[pc]=i,t=(e.mode&1)!==0,n){case"dialog":at("cancel",r),at("close",r);break;case"iframe":case"object":case"embed":at("load",r);break;case"video":case"audio":for(s=0;s<Pl.length;s++)at(Pl[s],r);break;case"source":at("error",r);break;case"img":case"image":case"link":at("error",r),at("load",r);break;case"details":at("toggle",r);break;case"input":Nv(r,i),at("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},at("invalid",r);break;case"textarea":Dv(r,i),at("invalid",r)}tm(n,i),s=null;for(var o in i)if(i.hasOwnProperty(o)){var a=i[o];o==="children"?typeof a=="string"?r.textContent!==a&&(i.suppressHydrationWarning!==!0&&Cu(r.textContent,a,t),s=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(i.suppressHydrationWarning!==!0&&Cu(r.textContent,a,t),s=["children",""+a]):sc.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&at("scroll",r)}switch(n){case"input":vu(r),kv(r,i,!0);break;case"textarea":vu(r),jv(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=kd)}r=s,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=zT(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[Lr]=e,t[pc]=r,f0(t,e,!1,!1),e.stateNode=t;e:{switch(o=nm(n,r),n){case"dialog":at("cancel",t),at("close",t),s=r;break;case"iframe":case"object":case"embed":at("load",t),s=r;break;case"video":case"audio":for(s=0;s<Pl.length;s++)at(Pl[s],t);s=r;break;case"source":at("error",t),s=r;break;case"img":case"image":case"link":at("error",t),at("load",t),s=r;break;case"details":at("toggle",t),s=r;break;case"input":Nv(t,r),s=Yp(t,r),at("invalid",t);break;case"option":s=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},s=gt({},r,{value:void 0}),at("invalid",t);break;case"textarea":Dv(t,r),s=Zp(t,r),at("invalid",t);break;default:s=r}tm(n,s),a=s;for(i in a)if(a.hasOwnProperty(i)){var l=a[i];i==="style"?WT(t,l):i==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&qT(t,l)):i==="children"?typeof l=="string"?(n!=="textarea"||l!=="")&&ic(t,l):typeof l=="number"&&ic(t,""+l):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(sc.hasOwnProperty(i)?l!=null&&i==="onScroll"&&at("scroll",t):l!=null&&Cg(t,i,l,o))}switch(n){case"input":vu(t),kv(t,r,!1);break;case"textarea":vu(t),jv(t);break;case"option":r.value!=null&&t.setAttribute("value",""+ii(r.value));break;case"select":t.multiple=!!r.multiple,i=r.value,i!=null?sa(t,!!r.multiple,i,!1):r.defaultValue!=null&&sa(t,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=kd)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return en(e),null;case 6:if(t&&e.stateNode!=null)m0(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(K(166));if(n=Ui(gc.current),Ui(Br.current),Au(e)){if(r=e.stateNode,n=e.memoizedProps,r[Lr]=e,(i=r.nodeValue!==n)&&(t=Bn,t!==null))switch(t.tag){case 3:Cu(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Cu(r.nodeValue,n,(t.mode&1)!==0)}i&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Lr]=e,e.stateNode=r}return en(e),null;case 13:if(lt(ft),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(ut&&Un!==null&&e.mode&1&&!(e.flags&128))Dx(),wa(),e.flags|=98560,i=!1;else if(i=Au(e),r!==null&&r.dehydrated!==null){if(t===null){if(!i)throw Error(K(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(K(317));i[Lr]=e}else wa(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;en(e),i=!1}else mr!==null&&(Vm(mr),mr=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||ft.current&1?Ot===0&&(Ot=3):cy())),e.updateQueue!==null&&(e.flags|=4),en(e),null);case 4:return Ia(),Am(t,e),t===null&&hc(e.stateNode.containerInfo),en(e),null;case 10:return Wg(e.type._context),en(e),null;case 17:return Pn(e.type)&&Dd(),en(e),null;case 19:if(lt(ft),i=e.memoizedState,i===null)return en(e),null;if(r=(e.flags&128)!==0,o=i.rendering,o===null)if(r)yl(i,!1);else{if(Ot!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=Ud(t),o!==null){for(e.flags|=128,yl(i,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)i=n,t=r,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,t=o.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return it(ft,ft.current&1|2),e.child}t=t.sibling}i.tail!==null&&xt()>xa&&(e.flags|=128,r=!0,yl(i,!1),e.lanes=4194304)}else{if(!r)if(t=Ud(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),yl(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!ut)return en(e),null}else 2*xt()-i.renderingStartTime>xa&&n!==1073741824&&(e.flags|=128,r=!0,yl(i,!1),e.lanes=4194304);i.isBackwards?(o.sibling=e.child,e.child=o):(n=i.last,n!==null?n.sibling=o:e.child=o,i.last=o)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=xt(),e.sibling=null,n=ft.current,it(ft,r?n&1|2:n&1),e):(en(e),null);case 22:case 23:return ly(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?Ln&1073741824&&(en(e),e.subtreeFlags&6&&(e.flags|=8192)):en(e),null;case 24:return null;case 25:return null}throw Error(K(156,e.tag))}function gP(t,e){switch(Bg(e),e.tag){case 1:return Pn(e.type)&&Dd(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Ia(),lt(Rn),lt(cn),Xg(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return Yg(e),null;case 13:if(lt(ft),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(K(340));wa()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return lt(ft),null;case 4:return Ia(),null;case 10:return Wg(e.type._context),null;case 22:case 23:return ly(),null;case 24:return null;default:return null}}var Nu=!1,rn=!1,yP=typeof WeakSet=="function"?WeakSet:Set,oe=null;function ea(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){_t(t,e,r)}else n.current=null}function Rm(t,e,n){try{n()}catch(r){_t(t,e,r)}}var Tw=!1;function _P(t,e){if(hm=Rd,t=wx(),Ug(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var o=0,a=-1,l=-1,d=0,h=0,f=t,m=null;t:for(;;){for(var _;f!==n||s!==0&&f.nodeType!==3||(a=o+s),f!==i||r!==0&&f.nodeType!==3||(l=o+r),f.nodeType===3&&(o+=f.nodeValue.length),(_=f.firstChild)!==null;)m=f,f=_;for(;;){if(f===t)break t;if(m===n&&++d===s&&(a=o),m===i&&++h===r&&(l=o),(_=f.nextSibling)!==null)break;f=m,m=f.parentNode}f=_}n=a===-1||l===-1?null:{start:a,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(fm={focusedElem:t,selectionRange:n},Rd=!1,oe=e;oe!==null;)if(e=oe,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,oe=t;else for(;oe!==null;){e=oe;try{var A=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(A!==null){var R=A.memoizedProps,C=A.memoizedState,w=e.stateNode,I=w.getSnapshotBeforeUpdate(e.elementType===e.type?R:hr(e.type,R),C);w.__reactInternalSnapshotBeforeUpdate=I}break;case 3:var b=e.stateNode.containerInfo;b.nodeType===1?b.textContent="":b.nodeType===9&&b.documentElement&&b.removeChild(b.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(K(163))}}catch(x){_t(e,e.return,x)}if(t=e.sibling,t!==null){t.return=e.return,oe=t;break}oe=e.return}return A=Tw,Tw=!1,A}function Hl(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&t)===t){var i=s.destroy;s.destroy=void 0,i!==void 0&&Rm(e,n,i)}s=s.next}while(s!==r)}}function Vh(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function Pm(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function g0(t){var e=t.alternate;e!==null&&(t.alternate=null,g0(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Lr],delete e[pc],delete e[gm],delete e[eP],delete e[tP])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function y0(t){return t.tag===5||t.tag===3||t.tag===4}function xw(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||y0(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Nm(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=kd));else if(r!==4&&(t=t.child,t!==null))for(Nm(t,e,n),t=t.sibling;t!==null;)Nm(t,e,n),t=t.sibling}function km(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(km(t,e,n),t=t.sibling;t!==null;)km(t,e,n),t=t.sibling}var Ht=null,fr=!1;function Ss(t,e,n){for(n=n.child;n!==null;)_0(t,e,n),n=n.sibling}function _0(t,e,n){if($r&&typeof $r.onCommitFiberUnmount=="function")try{$r.onCommitFiberUnmount(Ah,n)}catch{}switch(n.tag){case 5:rn||ea(n,e);case 6:var r=Ht,s=fr;Ht=null,Ss(t,e,n),Ht=r,fr=s,Ht!==null&&(fr?(t=Ht,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Ht.removeChild(n.stateNode));break;case 18:Ht!==null&&(fr?(t=Ht,n=n.stateNode,t.nodeType===8?ip(t.parentNode,n):t.nodeType===1&&ip(t,n),cc(t)):ip(Ht,n.stateNode));break;case 4:r=Ht,s=fr,Ht=n.stateNode.containerInfo,fr=!0,Ss(t,e,n),Ht=r,fr=s;break;case 0:case 11:case 14:case 15:if(!rn&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var i=s,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&Rm(n,e,o),s=s.next}while(s!==r)}Ss(t,e,n);break;case 1:if(!rn&&(ea(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(a){_t(n,e,a)}Ss(t,e,n);break;case 21:Ss(t,e,n);break;case 22:n.mode&1?(rn=(r=rn)||n.memoizedState!==null,Ss(t,e,n),rn=r):Ss(t,e,n);break;default:Ss(t,e,n)}}function Sw(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new yP),e.forEach(function(r){var s=CP.bind(null,t,r);n.has(r)||(n.add(r),r.then(s,s))})}}function dr(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var i=t,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:Ht=a.stateNode,fr=!1;break e;case 3:Ht=a.stateNode.containerInfo,fr=!0;break e;case 4:Ht=a.stateNode.containerInfo,fr=!0;break e}a=a.return}if(Ht===null)throw Error(K(160));_0(i,o,s),Ht=null,fr=!1;var l=s.alternate;l!==null&&(l.return=null),s.return=null}catch(d){_t(s,e,d)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)v0(e,t),e=e.sibling}function v0(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(dr(e,t),kr(t),r&4){try{Hl(3,t,t.return),Vh(3,t)}catch(R){_t(t,t.return,R)}try{Hl(5,t,t.return)}catch(R){_t(t,t.return,R)}}break;case 1:dr(e,t),kr(t),r&512&&n!==null&&ea(n,n.return);break;case 5:if(dr(e,t),kr(t),r&512&&n!==null&&ea(n,n.return),t.flags&32){var s=t.stateNode;try{ic(s,"")}catch(R){_t(t,t.return,R)}}if(r&4&&(s=t.stateNode,s!=null)){var i=t.memoizedProps,o=n!==null?n.memoizedProps:i,a=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{a==="input"&&i.type==="radio"&&i.name!=null&&$T(s,i),nm(a,o);var d=nm(a,i);for(o=0;o<l.length;o+=2){var h=l[o],f=l[o+1];h==="style"?WT(s,f):h==="dangerouslySetInnerHTML"?qT(s,f):h==="children"?ic(s,f):Cg(s,h,f,d)}switch(a){case"input":Xp(s,i);break;case"textarea":BT(s,i);break;case"select":var m=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var _=i.value;_!=null?sa(s,!!i.multiple,_,!1):m!==!!i.multiple&&(i.defaultValue!=null?sa(s,!!i.multiple,i.defaultValue,!0):sa(s,!!i.multiple,i.multiple?[]:"",!1))}s[pc]=i}catch(R){_t(t,t.return,R)}}break;case 6:if(dr(e,t),kr(t),r&4){if(t.stateNode===null)throw Error(K(162));s=t.stateNode,i=t.memoizedProps;try{s.nodeValue=i}catch(R){_t(t,t.return,R)}}break;case 3:if(dr(e,t),kr(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{cc(e.containerInfo)}catch(R){_t(t,t.return,R)}break;case 4:dr(e,t),kr(t);break;case 13:dr(e,t),kr(t),s=t.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(oy=xt())),r&4&&Sw(t);break;case 22:if(h=n!==null&&n.memoizedState!==null,t.mode&1?(rn=(d=rn)||h,dr(e,t),rn=d):dr(e,t),kr(t),r&8192){if(d=t.memoizedState!==null,(t.stateNode.isHidden=d)&&!h&&t.mode&1)for(oe=t,h=t.child;h!==null;){for(f=oe=h;oe!==null;){switch(m=oe,_=m.child,m.tag){case 0:case 11:case 14:case 15:Hl(4,m,m.return);break;case 1:ea(m,m.return);var A=m.stateNode;if(typeof A.componentWillUnmount=="function"){r=m,n=m.return;try{e=r,A.props=e.memoizedProps,A.state=e.memoizedState,A.componentWillUnmount()}catch(R){_t(r,n,R)}}break;case 5:ea(m,m.return);break;case 22:if(m.memoizedState!==null){Cw(f);continue}}_!==null?(_.return=m,oe=_):Cw(f)}h=h.sibling}e:for(h=null,f=t;;){if(f.tag===5){if(h===null){h=f;try{s=f.stateNode,d?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(a=f.stateNode,l=f.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=HT("display",o))}catch(R){_t(t,t.return,R)}}}else if(f.tag===6){if(h===null)try{f.stateNode.nodeValue=d?"":f.memoizedProps}catch(R){_t(t,t.return,R)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===t)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===t)break e;for(;f.sibling===null;){if(f.return===null||f.return===t)break e;h===f&&(h=null),f=f.return}h===f&&(h=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:dr(e,t),kr(t),r&4&&Sw(t);break;case 21:break;default:dr(e,t),kr(t)}}function kr(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(y0(n)){var r=n;break e}n=n.return}throw Error(K(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(ic(s,""),r.flags&=-33);var i=xw(t);km(t,i,s);break;case 3:case 4:var o=r.stateNode.containerInfo,a=xw(t);Nm(t,a,o);break;default:throw Error(K(161))}}catch(l){_t(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function vP(t,e,n){oe=t,w0(t)}function w0(t,e,n){for(var r=(t.mode&1)!==0;oe!==null;){var s=oe,i=s.child;if(s.tag===22&&r){var o=s.memoizedState!==null||Nu;if(!o){var a=s.alternate,l=a!==null&&a.memoizedState!==null||rn;a=Nu;var d=rn;if(Nu=o,(rn=l)&&!d)for(oe=s;oe!==null;)o=oe,l=o.child,o.tag===22&&o.memoizedState!==null?Aw(s):l!==null?(l.return=o,oe=l):Aw(s);for(;i!==null;)oe=i,w0(i),i=i.sibling;oe=s,Nu=a,rn=d}bw(t)}else s.subtreeFlags&8772&&i!==null?(i.return=s,oe=i):bw(t)}}function bw(t){for(;oe!==null;){var e=oe;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:rn||Vh(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!rn)if(n===null)r.componentDidMount();else{var s=e.elementType===e.type?n.memoizedProps:hr(e.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&uw(e,i,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}uw(e,o,n)}break;case 5:var a=e.stateNode;if(n===null&&e.flags&4){n=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var d=e.alternate;if(d!==null){var h=d.memoizedState;if(h!==null){var f=h.dehydrated;f!==null&&cc(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(K(163))}rn||e.flags&512&&Pm(e)}catch(m){_t(e,e.return,m)}}if(e===t){oe=null;break}if(n=e.sibling,n!==null){n.return=e.return,oe=n;break}oe=e.return}}function Cw(t){for(;oe!==null;){var e=oe;if(e===t){oe=null;break}var n=e.sibling;if(n!==null){n.return=e.return,oe=n;break}oe=e.return}}function Aw(t){for(;oe!==null;){var e=oe;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{Vh(4,e)}catch(l){_t(e,n,l)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var s=e.return;try{r.componentDidMount()}catch(l){_t(e,s,l)}}var i=e.return;try{Pm(e)}catch(l){_t(e,i,l)}break;case 5:var o=e.return;try{Pm(e)}catch(l){_t(e,o,l)}}}catch(l){_t(e,e.return,l)}if(e===t){oe=null;break}var a=e.sibling;if(a!==null){a.return=e.return,oe=a;break}oe=e.return}}var wP=Math.ceil,zd=ps.ReactCurrentDispatcher,sy=ps.ReactCurrentOwner,nr=ps.ReactCurrentBatchConfig,qe=0,qt=null,Ct=null,Qt=0,Ln=0,ta=fi(0),Ot=0,wc=null,eo=0,Lh=0,iy=0,Wl=null,bn=null,oy=0,xa=1/0,Qr=null,qd=!1,Dm=null,Ys=null,ku=!1,zs=null,Hd=0,Kl=0,jm=null,rd=-1,sd=0;function _n(){return qe&6?xt():rd!==-1?rd:rd=xt()}function Xs(t){return t.mode&1?qe&2&&Qt!==0?Qt&-Qt:rP.transition!==null?(sd===0&&(sd=sx()),sd):(t=Xe,t!==0||(t=window.event,t=t===void 0?16:dx(t.type)),t):1}function _r(t,e,n,r){if(50<Kl)throw Kl=0,jm=null,Error(K(185));Lc(t,n,r),(!(qe&2)||t!==qt)&&(t===qt&&(!(qe&2)&&(Lh|=n),Ot===4&&js(t,Qt)),Nn(t,r),n===1&&qe===0&&!(e.mode&1)&&(xa=xt()+500,Dh&&pi()))}function Nn(t,e){var n=t.callbackNode;r1(t,e);var r=Ad(t,t===qt?Qt:0);if(r===0)n!==null&&Lv(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&Lv(n),e===1)t.tag===0?nP(Rw.bind(null,t)):Px(Rw.bind(null,t)),J1(function(){!(qe&6)&&pi()}),n=null;else{switch(ix(r)){case 1:n=kg;break;case 4:n=nx;break;case 16:n=Cd;break;case 536870912:n=rx;break;default:n=Cd}n=A0(n,E0.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function E0(t,e){if(rd=-1,sd=0,qe&6)throw Error(K(327));var n=t.callbackNode;if(ca()&&t.callbackNode!==n)return null;var r=Ad(t,t===qt?Qt:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=Wd(t,r);else{e=r;var s=qe;qe|=2;var i=T0();(qt!==t||Qt!==e)&&(Qr=null,xa=xt()+500,zi(t,e));do try{TP();break}catch(a){I0(t,a)}while(!0);Hg(),zd.current=i,qe=s,Ct!==null?e=0:(qt=null,Qt=0,e=Ot)}if(e!==0){if(e===2&&(s=am(t),s!==0&&(r=s,e=Om(t,s))),e===1)throw n=wc,zi(t,0),js(t,r),Nn(t,xt()),n;if(e===6)js(t,r);else{if(s=t.current.alternate,!(r&30)&&!EP(s)&&(e=Wd(t,r),e===2&&(i=am(t),i!==0&&(r=i,e=Om(t,i))),e===1))throw n=wc,zi(t,0),js(t,r),Nn(t,xt()),n;switch(t.finishedWork=s,t.finishedLanes=r,e){case 0:case 1:throw Error(K(345));case 2:Ri(t,bn,Qr);break;case 3:if(js(t,r),(r&130023424)===r&&(e=oy+500-xt(),10<e)){if(Ad(t,0)!==0)break;if(s=t.suspendedLanes,(s&r)!==r){_n(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=mm(Ri.bind(null,t,bn,Qr),e);break}Ri(t,bn,Qr);break;case 4:if(js(t,r),(r&4194240)===r)break;for(e=t.eventTimes,s=-1;0<r;){var o=31-yr(r);i=1<<o,o=e[o],o>s&&(s=o),r&=~i}if(r=s,r=xt()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*wP(r/1960))-r,10<r){t.timeoutHandle=mm(Ri.bind(null,t,bn,Qr),r);break}Ri(t,bn,Qr);break;case 5:Ri(t,bn,Qr);break;default:throw Error(K(329))}}}return Nn(t,xt()),t.callbackNode===n?E0.bind(null,t):null}function Om(t,e){var n=Wl;return t.current.memoizedState.isDehydrated&&(zi(t,e).flags|=256),t=Wd(t,e),t!==2&&(e=bn,bn=n,e!==null&&Vm(e)),t}function Vm(t){bn===null?bn=t:bn.push.apply(bn,t)}function EP(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],i=s.getSnapshot;s=s.value;try{if(!wr(i(),s))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function js(t,e){for(e&=~iy,e&=~Lh,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-yr(e),r=1<<n;t[n]=-1,e&=~r}}function Rw(t){if(qe&6)throw Error(K(327));ca();var e=Ad(t,0);if(!(e&1))return Nn(t,xt()),null;var n=Wd(t,e);if(t.tag!==0&&n===2){var r=am(t);r!==0&&(e=r,n=Om(t,r))}if(n===1)throw n=wc,zi(t,0),js(t,e),Nn(t,xt()),n;if(n===6)throw Error(K(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Ri(t,bn,Qr),Nn(t,xt()),null}function ay(t,e){var n=qe;qe|=1;try{return t(e)}finally{qe=n,qe===0&&(xa=xt()+500,Dh&&pi())}}function to(t){zs!==null&&zs.tag===0&&!(qe&6)&&ca();var e=qe;qe|=1;var n=nr.transition,r=Xe;try{if(nr.transition=null,Xe=1,t)return t()}finally{Xe=r,nr.transition=n,qe=e,!(qe&6)&&pi()}}function ly(){Ln=ta.current,lt(ta)}function zi(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,X1(n)),Ct!==null)for(n=Ct.return;n!==null;){var r=n;switch(Bg(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Dd();break;case 3:Ia(),lt(Rn),lt(cn),Xg();break;case 5:Yg(r);break;case 4:Ia();break;case 13:lt(ft);break;case 19:lt(ft);break;case 10:Wg(r.type._context);break;case 22:case 23:ly()}n=n.return}if(qt=t,Ct=t=Js(t.current,null),Qt=Ln=e,Ot=0,wc=null,iy=Lh=eo=0,bn=Wl=null,Fi!==null){for(e=0;e<Fi.length;e++)if(n=Fi[e],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,i=n.pending;if(i!==null){var o=i.next;i.next=s,r.next=o}n.pending=r}Fi=null}return t}function I0(t,e){do{var n=Ct;try{if(Hg(),ed.current=Bd,$d){for(var r=mt.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}$d=!1}if(Zi=0,zt=jt=mt=null,ql=!1,yc=0,sy.current=null,n===null||n.return===null){Ot=1,wc=e,Ct=null;break}e:{var i=t,o=n.return,a=n,l=e;if(e=Qt,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var d=l,h=a,f=h.tag;if(!(h.mode&1)&&(f===0||f===11||f===15)){var m=h.alternate;m?(h.updateQueue=m.updateQueue,h.memoizedState=m.memoizedState,h.lanes=m.lanes):(h.updateQueue=null,h.memoizedState=null)}var _=gw(o);if(_!==null){_.flags&=-257,yw(_,o,a,i,e),_.mode&1&&mw(i,d,e),e=_,l=d;var A=e.updateQueue;if(A===null){var R=new Set;R.add(l),e.updateQueue=R}else A.add(l);break e}else{if(!(e&1)){mw(i,d,e),cy();break e}l=Error(K(426))}}else if(ut&&a.mode&1){var C=gw(o);if(C!==null){!(C.flags&65536)&&(C.flags|=256),yw(C,o,a,i,e),zg(Ta(l,a));break e}}i=l=Ta(l,a),Ot!==4&&(Ot=2),Wl===null?Wl=[i]:Wl.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var w=i0(i,l,e);cw(i,w);break e;case 1:a=l;var I=i.type,b=i.stateNode;if(!(i.flags&128)&&(typeof I.getDerivedStateFromError=="function"||b!==null&&typeof b.componentDidCatch=="function"&&(Ys===null||!Ys.has(b)))){i.flags|=65536,e&=-e,i.lanes|=e;var x=o0(i,a,e);cw(i,x);break e}}i=i.return}while(i!==null)}S0(n)}catch(L){e=L,Ct===n&&n!==null&&(Ct=n=n.return);continue}break}while(!0)}function T0(){var t=zd.current;return zd.current=Bd,t===null?Bd:t}function cy(){(Ot===0||Ot===3||Ot===2)&&(Ot=4),qt===null||!(eo&268435455)&&!(Lh&268435455)||js(qt,Qt)}function Wd(t,e){var n=qe;qe|=2;var r=T0();(qt!==t||Qt!==e)&&(Qr=null,zi(t,e));do try{IP();break}catch(s){I0(t,s)}while(!0);if(Hg(),qe=n,zd.current=r,Ct!==null)throw Error(K(261));return qt=null,Qt=0,Ot}function IP(){for(;Ct!==null;)x0(Ct)}function TP(){for(;Ct!==null&&!GR();)x0(Ct)}function x0(t){var e=C0(t.alternate,t,Ln);t.memoizedProps=t.pendingProps,e===null?S0(t):Ct=e,sy.current=null}function S0(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=gP(n,e),n!==null){n.flags&=32767,Ct=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Ot=6,Ct=null;return}}else if(n=mP(n,e,Ln),n!==null){Ct=n;return}if(e=e.sibling,e!==null){Ct=e;return}Ct=e=t}while(e!==null);Ot===0&&(Ot=5)}function Ri(t,e,n){var r=Xe,s=nr.transition;try{nr.transition=null,Xe=1,xP(t,e,n,r)}finally{nr.transition=s,Xe=r}return null}function xP(t,e,n,r){do ca();while(zs!==null);if(qe&6)throw Error(K(327));n=t.finishedWork;var s=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(K(177));t.callbackNode=null,t.callbackPriority=0;var i=n.lanes|n.childLanes;if(s1(t,i),t===qt&&(Ct=qt=null,Qt=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||ku||(ku=!0,A0(Cd,function(){return ca(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=nr.transition,nr.transition=null;var o=Xe;Xe=1;var a=qe;qe|=4,sy.current=null,_P(t,n),v0(n,t),q1(fm),Rd=!!hm,fm=hm=null,t.current=n,vP(n),QR(),qe=a,Xe=o,nr.transition=i}else t.current=n;if(ku&&(ku=!1,zs=t,Hd=s),i=t.pendingLanes,i===0&&(Ys=null),JR(n.stateNode),Nn(t,xt()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)s=e[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(qd)throw qd=!1,t=Dm,Dm=null,t;return Hd&1&&t.tag!==0&&ca(),i=t.pendingLanes,i&1?t===jm?Kl++:(Kl=0,jm=t):Kl=0,pi(),null}function ca(){if(zs!==null){var t=ix(Hd),e=nr.transition,n=Xe;try{if(nr.transition=null,Xe=16>t?16:t,zs===null)var r=!1;else{if(t=zs,zs=null,Hd=0,qe&6)throw Error(K(331));var s=qe;for(qe|=4,oe=t.current;oe!==null;){var i=oe,o=i.child;if(oe.flags&16){var a=i.deletions;if(a!==null){for(var l=0;l<a.length;l++){var d=a[l];for(oe=d;oe!==null;){var h=oe;switch(h.tag){case 0:case 11:case 15:Hl(8,h,i)}var f=h.child;if(f!==null)f.return=h,oe=f;else for(;oe!==null;){h=oe;var m=h.sibling,_=h.return;if(g0(h),h===d){oe=null;break}if(m!==null){m.return=_,oe=m;break}oe=_}}}var A=i.alternate;if(A!==null){var R=A.child;if(R!==null){A.child=null;do{var C=R.sibling;R.sibling=null,R=C}while(R!==null)}}oe=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,oe=o;else e:for(;oe!==null;){if(i=oe,i.flags&2048)switch(i.tag){case 0:case 11:case 15:Hl(9,i,i.return)}var w=i.sibling;if(w!==null){w.return=i.return,oe=w;break e}oe=i.return}}var I=t.current;for(oe=I;oe!==null;){o=oe;var b=o.child;if(o.subtreeFlags&2064&&b!==null)b.return=o,oe=b;else e:for(o=I;oe!==null;){if(a=oe,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:Vh(9,a)}}catch(L){_t(a,a.return,L)}if(a===o){oe=null;break e}var x=a.sibling;if(x!==null){x.return=a.return,oe=x;break e}oe=a.return}}if(qe=s,pi(),$r&&typeof $r.onPostCommitFiberRoot=="function")try{$r.onPostCommitFiberRoot(Ah,t)}catch{}r=!0}return r}finally{Xe=n,nr.transition=e}}return!1}function Pw(t,e,n){e=Ta(n,e),e=i0(t,e,1),t=Qs(t,e,1),e=_n(),t!==null&&(Lc(t,1,e),Nn(t,e))}function _t(t,e,n){if(t.tag===3)Pw(t,t,n);else for(;e!==null;){if(e.tag===3){Pw(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Ys===null||!Ys.has(r))){t=Ta(n,t),t=o0(e,t,1),e=Qs(e,t,1),t=_n(),e!==null&&(Lc(e,1,t),Nn(e,t));break}}e=e.return}}function SP(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=_n(),t.pingedLanes|=t.suspendedLanes&n,qt===t&&(Qt&n)===n&&(Ot===4||Ot===3&&(Qt&130023424)===Qt&&500>xt()-oy?zi(t,0):iy|=n),Nn(t,e)}function b0(t,e){e===0&&(t.mode&1?(e=Iu,Iu<<=1,!(Iu&130023424)&&(Iu=4194304)):e=1);var n=_n();t=os(t,e),t!==null&&(Lc(t,e,n),Nn(t,n))}function bP(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),b0(t,n)}function CP(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,s=t.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(K(314))}r!==null&&r.delete(e),b0(t,n)}var C0;C0=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||Rn.current)Cn=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return Cn=!1,pP(t,e,n);Cn=!!(t.flags&131072)}else Cn=!1,ut&&e.flags&1048576&&Nx(e,Vd,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;nd(t,e),t=e.pendingProps;var s=va(e,cn.current);la(e,n),s=Zg(null,e,r,t,s,n);var i=ey();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Pn(r)?(i=!0,jd(e)):i=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,Gg(e),s.updater=Oh,e.stateNode=s,s._reactInternals=e,Im(e,r,t,n),e=Sm(null,e,r,!0,i,n)):(e.tag=0,ut&&i&&$g(e),fn(null,e,s,n),e=e.child),e;case 16:r=e.elementType;e:{switch(nd(t,e),t=e.pendingProps,s=r._init,r=s(r._payload),e.type=r,s=e.tag=RP(r),t=hr(r,t),s){case 0:e=xm(null,e,r,t,n);break e;case 1:e=ww(null,e,r,t,n);break e;case 11:e=_w(null,e,r,t,n);break e;case 14:e=vw(null,e,r,hr(r.type,t),n);break e}throw Error(K(306,r,""))}return e;case 0:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:hr(r,s),xm(t,e,r,s,n);case 1:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:hr(r,s),ww(t,e,r,s,n);case 3:e:{if(u0(e),t===null)throw Error(K(387));r=e.pendingProps,i=e.memoizedState,s=i.element,Lx(t,e),Fd(e,r,null,n);var o=e.memoizedState;if(r=o.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){s=Ta(Error(K(423)),e),e=Ew(t,e,r,n,s);break e}else if(r!==s){s=Ta(Error(K(424)),e),e=Ew(t,e,r,n,s);break e}else for(Un=Gs(e.stateNode.containerInfo.firstChild),Bn=e,ut=!0,mr=null,n=Ox(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(wa(),r===s){e=as(t,e,n);break e}fn(t,e,r,n)}e=e.child}return e;case 5:return Mx(e),t===null&&vm(e),r=e.type,s=e.pendingProps,i=t!==null?t.memoizedProps:null,o=s.children,pm(r,s)?o=null:i!==null&&pm(r,i)&&(e.flags|=32),c0(t,e),fn(t,e,o,n),e.child;case 6:return t===null&&vm(e),null;case 13:return d0(t,e,n);case 4:return Qg(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=Ea(e,null,r,n):fn(t,e,r,n),e.child;case 11:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:hr(r,s),_w(t,e,r,s,n);case 7:return fn(t,e,e.pendingProps,n),e.child;case 8:return fn(t,e,e.pendingProps.children,n),e.child;case 12:return fn(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,s=e.pendingProps,i=e.memoizedProps,o=s.value,it(Ld,r._currentValue),r._currentValue=o,i!==null)if(wr(i.value,o)){if(i.children===s.children&&!Rn.current){e=as(t,e,n);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var a=i.dependencies;if(a!==null){o=i.child;for(var l=a.firstContext;l!==null;){if(l.context===r){if(i.tag===1){l=ns(-1,n&-n),l.tag=2;var d=i.updateQueue;if(d!==null){d=d.shared;var h=d.pending;h===null?l.next=l:(l.next=h.next,h.next=l),d.pending=l}}i.lanes|=n,l=i.alternate,l!==null&&(l.lanes|=n),wm(i.return,n,e),a.lanes|=n;break}l=l.next}}else if(i.tag===10)o=i.type===e.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(K(341));o.lanes|=n,a=o.alternate,a!==null&&(a.lanes|=n),wm(o,n,e),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===e){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}fn(t,e,s.children,n),e=e.child}return e;case 9:return s=e.type,r=e.pendingProps.children,la(e,n),s=sr(s),r=r(s),e.flags|=1,fn(t,e,r,n),e.child;case 14:return r=e.type,s=hr(r,e.pendingProps),s=hr(r.type,s),vw(t,e,r,s,n);case 15:return a0(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:hr(r,s),nd(t,e),e.tag=1,Pn(r)?(t=!0,jd(e)):t=!1,la(e,n),s0(e,r,s),Im(e,r,s,n),Sm(null,e,r,!0,t,n);case 19:return h0(t,e,n);case 22:return l0(t,e,n)}throw Error(K(156,e.tag))};function A0(t,e){return tx(t,e)}function AP(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function er(t,e,n,r){return new AP(t,e,n,r)}function uy(t){return t=t.prototype,!(!t||!t.isReactComponent)}function RP(t){if(typeof t=="function")return uy(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Rg)return 11;if(t===Pg)return 14}return 2}function Js(t,e){var n=t.alternate;return n===null?(n=er(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function id(t,e,n,r,s,i){var o=2;if(r=t,typeof t=="function")uy(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case Ho:return qi(n.children,s,i,e);case Ag:o=8,s|=8;break;case Wp:return t=er(12,n,e,s|2),t.elementType=Wp,t.lanes=i,t;case Kp:return t=er(13,n,e,s),t.elementType=Kp,t.lanes=i,t;case Gp:return t=er(19,n,e,s),t.elementType=Gp,t.lanes=i,t;case MT:return Mh(n,s,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case VT:o=10;break e;case LT:o=9;break e;case Rg:o=11;break e;case Pg:o=14;break e;case Ns:o=16,r=null;break e}throw Error(K(130,t==null?t:typeof t,""))}return e=er(o,n,e,s),e.elementType=t,e.type=r,e.lanes=i,e}function qi(t,e,n,r){return t=er(7,t,r,e),t.lanes=n,t}function Mh(t,e,n,r){return t=er(22,t,r,e),t.elementType=MT,t.lanes=n,t.stateNode={isHidden:!1},t}function fp(t,e,n){return t=er(6,t,null,e),t.lanes=n,t}function pp(t,e,n){return e=er(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function PP(t,e,n,r,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Gf(0),this.expirationTimes=Gf(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Gf(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function dy(t,e,n,r,s,i,o,a,l){return t=new PP(t,e,n,a,l),e===1?(e=1,i===!0&&(e|=8)):e=0,i=er(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Gg(i),t}function NP(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:qo,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function R0(t){if(!t)return oi;t=t._reactInternals;e:{if(_o(t)!==t||t.tag!==1)throw Error(K(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Pn(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(K(171))}if(t.tag===1){var n=t.type;if(Pn(n))return Rx(t,n,e)}return e}function P0(t,e,n,r,s,i,o,a,l){return t=dy(n,r,!0,t,s,i,o,a,l),t.context=R0(null),n=t.current,r=_n(),s=Xs(n),i=ns(r,s),i.callback=e??null,Qs(n,i,s),t.current.lanes=s,Lc(t,s,r),Nn(t,r),t}function Fh(t,e,n,r){var s=e.current,i=_n(),o=Xs(s);return n=R0(n),e.context===null?e.context=n:e.pendingContext=n,e=ns(i,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=Qs(s,e,o),t!==null&&(_r(t,s,o,i),Zu(t,s,o)),o}function Kd(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function Nw(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function hy(t,e){Nw(t,e),(t=t.alternate)&&Nw(t,e)}function kP(){return null}var N0=typeof reportError=="function"?reportError:function(t){console.error(t)};function fy(t){this._internalRoot=t}Uh.prototype.render=fy.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(K(409));Fh(t,e,null,null)};Uh.prototype.unmount=fy.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;to(function(){Fh(null,t,null,null)}),e[is]=null}};function Uh(t){this._internalRoot=t}Uh.prototype.unstable_scheduleHydration=function(t){if(t){var e=lx();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Ds.length&&e!==0&&e<Ds[n].priority;n++);Ds.splice(n,0,t),n===0&&ux(t)}};function py(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function $h(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function kw(){}function DP(t,e,n,r,s){if(s){if(typeof r=="function"){var i=r;r=function(){var d=Kd(o);i.call(d)}}var o=P0(e,r,t,0,null,!1,!1,"",kw);return t._reactRootContainer=o,t[is]=o.current,hc(t.nodeType===8?t.parentNode:t),to(),o}for(;s=t.lastChild;)t.removeChild(s);if(typeof r=="function"){var a=r;r=function(){var d=Kd(l);a.call(d)}}var l=dy(t,0,!1,null,null,!1,!1,"",kw);return t._reactRootContainer=l,t[is]=l.current,hc(t.nodeType===8?t.parentNode:t),to(function(){Fh(e,l,n,r)}),l}function Bh(t,e,n,r,s){var i=n._reactRootContainer;if(i){var o=i;if(typeof s=="function"){var a=s;s=function(){var l=Kd(o);a.call(l)}}Fh(e,o,t,s)}else o=DP(n,e,t,s,r);return Kd(o)}ox=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=Rl(e.pendingLanes);n!==0&&(Dg(e,n|1),Nn(e,xt()),!(qe&6)&&(xa=xt()+500,pi()))}break;case 13:to(function(){var r=os(t,1);if(r!==null){var s=_n();_r(r,t,1,s)}}),hy(t,1)}};jg=function(t){if(t.tag===13){var e=os(t,134217728);if(e!==null){var n=_n();_r(e,t,134217728,n)}hy(t,134217728)}};ax=function(t){if(t.tag===13){var e=Xs(t),n=os(t,e);if(n!==null){var r=_n();_r(n,t,e,r)}hy(t,e)}};lx=function(){return Xe};cx=function(t,e){var n=Xe;try{return Xe=t,e()}finally{Xe=n}};sm=function(t,e,n){switch(e){case"input":if(Xp(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var s=kh(r);if(!s)throw Error(K(90));UT(r),Xp(r,s)}}}break;case"textarea":BT(t,n);break;case"select":e=n.value,e!=null&&sa(t,!!n.multiple,e,!1)}};QT=ay;YT=to;var jP={usingClientEntryPoint:!1,Events:[Fc,Qo,kh,KT,GT,ay]},_l={findFiberByHostInstance:Mi,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},OP={bundleType:_l.bundleType,version:_l.version,rendererPackageName:_l.rendererPackageName,rendererConfig:_l.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ps.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=ZT(t),t===null?null:t.stateNode},findFiberByHostInstance:_l.findFiberByHostInstance||kP,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Du=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Du.isDisabled&&Du.supportsFiber)try{Ah=Du.inject(OP),$r=Du}catch{}}Wn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=jP;Wn.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!py(e))throw Error(K(200));return NP(t,e,null,n)};Wn.createRoot=function(t,e){if(!py(t))throw Error(K(299));var n=!1,r="",s=N0;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=dy(t,1,!1,null,null,n,!1,r,s),t[is]=e.current,hc(t.nodeType===8?t.parentNode:t),new fy(e)};Wn.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(K(188)):(t=Object.keys(t).join(","),Error(K(268,t)));return t=ZT(e),t=t===null?null:t.stateNode,t};Wn.flushSync=function(t){return to(t)};Wn.hydrate=function(t,e,n){if(!$h(e))throw Error(K(200));return Bh(null,t,e,!0,n)};Wn.hydrateRoot=function(t,e,n){if(!py(t))throw Error(K(405));var r=n!=null&&n.hydratedSources||null,s=!1,i="",o=N0;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=P0(e,null,t,1,n??null,s,!1,i,o),t[is]=e.current,hc(t),r)for(t=0;t<r.length;t++)n=r[t],s=n._getVersion,s=s(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,s]:e.mutableSourceEagerHydrationData.push(n,s);return new Uh(e)};Wn.render=function(t,e,n){if(!$h(e))throw Error(K(200));return Bh(null,t,e,!1,n)};Wn.unmountComponentAtNode=function(t){if(!$h(t))throw Error(K(40));return t._reactRootContainer?(to(function(){Bh(null,null,t,!1,function(){t._reactRootContainer=null,t[is]=null})}),!0):!1};Wn.unstable_batchedUpdates=ay;Wn.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!$h(n))throw Error(K(200));if(t==null||t._reactInternals===void 0)throw Error(K(38));return Bh(t,e,n,!1,r)};Wn.version="18.3.1-next-f1338f8080-20240426";function k0(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(k0)}catch(t){console.error(t)}}k0(),kT.exports=Wn;var VP=kT.exports,D0,Dw=VP;D0=Dw.createRoot,Dw.hydrateRoot;/**
 * react-router v7.9.6
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var jw="popstate";function LP(t={}){function e(r,s){let{pathname:i,search:o,hash:a}=r.location;return Lm("",{pathname:i,search:o,hash:a},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function n(r,s){return typeof s=="string"?s:Ec(s)}return FP(e,n,null,t)}function dt(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function or(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function MP(){return Math.random().toString(36).substring(2,10)}function Ow(t,e){return{usr:t.state,key:t.key,idx:e}}function Lm(t,e,n=null,r){return{pathname:typeof t=="string"?t:t.pathname,search:"",hash:"",...typeof e=="string"?Ba(e):e,state:n,key:e&&e.key||r||MP()}}function Ec({pathname:t="/",search:e="",hash:n=""}){return e&&e!=="?"&&(t+=e.charAt(0)==="?"?e:"?"+e),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function Ba(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substring(n),t=t.substring(0,n));let r=t.indexOf("?");r>=0&&(e.search=t.substring(r),t=t.substring(0,r)),t&&(e.pathname=t)}return e}function FP(t,e,n,r={}){let{window:s=document.defaultView,v5Compat:i=!1}=r,o=s.history,a="POP",l=null,d=h();d==null&&(d=0,o.replaceState({...o.state,idx:d},""));function h(){return(o.state||{idx:null}).idx}function f(){a="POP";let C=h(),w=C==null?null:C-d;d=C,l&&l({action:a,location:R.location,delta:w})}function m(C,w){a="PUSH";let I=Lm(R.location,C,w);d=h()+1;let b=Ow(I,d),x=R.createHref(I);try{o.pushState(b,"",x)}catch(L){if(L instanceof DOMException&&L.name==="DataCloneError")throw L;s.location.assign(x)}i&&l&&l({action:a,location:R.location,delta:1})}function _(C,w){a="REPLACE";let I=Lm(R.location,C,w);d=h();let b=Ow(I,d),x=R.createHref(I);o.replaceState(b,"",x),i&&l&&l({action:a,location:R.location,delta:0})}function A(C){return UP(C)}let R={get action(){return a},get location(){return t(s,o)},listen(C){if(l)throw new Error("A history only accepts one active listener");return s.addEventListener(jw,f),l=C,()=>{s.removeEventListener(jw,f),l=null}},createHref(C){return e(s,C)},createURL:A,encodeLocation(C){let w=A(C);return{pathname:w.pathname,search:w.search,hash:w.hash}},push:m,replace:_,go(C){return o.go(C)}};return R}function UP(t,e=!1){let n="http://localhost";typeof window<"u"&&(n=window.location.origin!=="null"?window.location.origin:window.location.href),dt(n,"No window.location.(origin|href) available to create URL");let r=typeof t=="string"?t:Ec(t);return r=r.replace(/ $/,"%20"),!e&&r.startsWith("//")&&(r=n+r),new URL(r,n)}function j0(t,e,n="/"){return $P(t,e,n,!1)}function $P(t,e,n,r){let s=typeof e=="string"?Ba(e):e,i=ls(s.pathname||"/",n);if(i==null)return null;let o=O0(t);BP(o);let a=null;for(let l=0;a==null&&l<o.length;++l){let d=ZP(i);a=XP(o[l],d,r)}return a}function O0(t,e=[],n=[],r="",s=!1){let i=(o,a,l=s,d)=>{let h={relativePath:d===void 0?o.path||"":d,caseSensitive:o.caseSensitive===!0,childrenIndex:a,route:o};if(h.relativePath.startsWith("/")){if(!h.relativePath.startsWith(r)&&l)return;dt(h.relativePath.startsWith(r),`Absolute route path "${h.relativePath}" nested under path "${r}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),h.relativePath=h.relativePath.slice(r.length)}let f=rs([r,h.relativePath]),m=n.concat(h);o.children&&o.children.length>0&&(dt(o.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${f}".`),O0(o.children,e,m,f,l)),!(o.path==null&&!o.index)&&e.push({path:f,score:QP(f,o.index),routesMeta:m})};return t.forEach((o,a)=>{var l;if(o.path===""||!((l=o.path)!=null&&l.includes("?")))i(o,a);else for(let d of V0(o.path))i(o,a,!0,d)}),e}function V0(t){let e=t.split("/");if(e.length===0)return[];let[n,...r]=e,s=n.endsWith("?"),i=n.replace(/\?$/,"");if(r.length===0)return s?[i,""]:[i];let o=V0(r.join("/")),a=[];return a.push(...o.map(l=>l===""?i:[i,l].join("/"))),s&&a.push(...o),a.map(l=>t.startsWith("/")&&l===""?"/":l)}function BP(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:YP(e.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}var zP=/^:[\w-]+$/,qP=3,HP=2,WP=1,KP=10,GP=-2,Vw=t=>t==="*";function QP(t,e){let n=t.split("/"),r=n.length;return n.some(Vw)&&(r+=GP),e&&(r+=HP),n.filter(s=>!Vw(s)).reduce((s,i)=>s+(zP.test(i)?qP:i===""?WP:KP),r)}function YP(t,e){return t.length===e.length&&t.slice(0,-1).every((r,s)=>r===e[s])?t[t.length-1]-e[e.length-1]:0}function XP(t,e,n=!1){let{routesMeta:r}=t,s={},i="/",o=[];for(let a=0;a<r.length;++a){let l=r[a],d=a===r.length-1,h=i==="/"?e:e.slice(i.length)||"/",f=Gd({path:l.relativePath,caseSensitive:l.caseSensitive,end:d},h),m=l.route;if(!f&&d&&n&&!r[r.length-1].route.index&&(f=Gd({path:l.relativePath,caseSensitive:l.caseSensitive,end:!1},h)),!f)return null;Object.assign(s,f.params),o.push({params:s,pathname:rs([i,f.pathname]),pathnameBase:sN(rs([i,f.pathnameBase])),route:m}),f.pathnameBase!=="/"&&(i=rs([i,f.pathnameBase]))}return o}function Gd(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,r]=JP(t.path,t.caseSensitive,t.end),s=e.match(n);if(!s)return null;let i=s[0],o=i.replace(/(.)\/+$/,"$1"),a=s.slice(1);return{params:r.reduce((d,{paramName:h,isOptional:f},m)=>{if(h==="*"){let A=a[m]||"";o=i.slice(0,i.length-A.length).replace(/(.)\/+$/,"$1")}const _=a[m];return f&&!_?d[h]=void 0:d[h]=(_||"").replace(/%2F/g,"/"),d},{}),pathname:i,pathnameBase:o,pattern:t}}function JP(t,e=!1,n=!0){or(t==="*"||!t.endsWith("*")||t.endsWith("/*"),`Route path "${t}" will be treated as if it were "${t.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${t.replace(/\*$/,"/*")}".`);let r=[],s="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,a,l)=>(r.push({paramName:a,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return t.endsWith("*")?(r.push({paramName:"*"}),s+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?s+="\\/*$":t!==""&&t!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,e?void 0:"i"),r]}function ZP(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return or(!1,`The URL path "${t}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),t}}function ls(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,r=t.charAt(n);return r&&r!=="/"?null:t.slice(n)||"/"}var eN=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,tN=t=>eN.test(t);function nN(t,e="/"){let{pathname:n,search:r="",hash:s=""}=typeof t=="string"?Ba(t):t,i;if(n)if(tN(n))i=n;else{if(n.includes("//")){let o=n;n=n.replace(/\/\/+/g,"/"),or(!1,`Pathnames cannot have embedded double slashes - normalizing ${o} -> ${n}`)}n.startsWith("/")?i=Lw(n.substring(1),"/"):i=Lw(n,e)}else i=e;return{pathname:i,search:iN(r),hash:oN(s)}}function Lw(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(s=>{s===".."?n.length>1&&n.pop():s!=="."&&n.push(s)}),n.length>1?n.join("/"):"/"}function mp(t,e,n,r){return`Cannot include a '${t}' character in a manually specified \`to.${e}\` field [${JSON.stringify(r)}].  Please separate it out to the \`to.${n}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function rN(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function my(t){let e=rN(t);return e.map((n,r)=>r===e.length-1?n.pathname:n.pathnameBase)}function gy(t,e,n,r=!1){let s;typeof t=="string"?s=Ba(t):(s={...t},dt(!s.pathname||!s.pathname.includes("?"),mp("?","pathname","search",s)),dt(!s.pathname||!s.pathname.includes("#"),mp("#","pathname","hash",s)),dt(!s.search||!s.search.includes("#"),mp("#","search","hash",s)));let i=t===""||s.pathname==="",o=i?"/":s.pathname,a;if(o==null)a=n;else{let f=e.length-1;if(!r&&o.startsWith("..")){let m=o.split("/");for(;m[0]==="..";)m.shift(),f-=1;s.pathname=m.join("/")}a=f>=0?e[f]:"/"}let l=nN(s,a),d=o&&o!=="/"&&o.endsWith("/"),h=(i||o===".")&&n.endsWith("/");return!l.pathname.endsWith("/")&&(d||h)&&(l.pathname+="/"),l}var rs=t=>t.join("/").replace(/\/\/+/g,"/"),sN=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),iN=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,oN=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function aN(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var L0=["POST","PUT","PATCH","DELETE"];new Set(L0);var lN=["GET",...L0];new Set(lN);var za=P.createContext(null);za.displayName="DataRouter";var zh=P.createContext(null);zh.displayName="DataRouterState";P.createContext(!1);var M0=P.createContext({isTransitioning:!1});M0.displayName="ViewTransition";var cN=P.createContext(new Map);cN.displayName="Fetchers";var uN=P.createContext(null);uN.displayName="Await";var xr=P.createContext(null);xr.displayName="Navigation";var $c=P.createContext(null);$c.displayName="Location";var Sr=P.createContext({outlet:null,matches:[],isDataRoute:!1});Sr.displayName="Route";var yy=P.createContext(null);yy.displayName="RouteError";function dN(t,{relative:e}={}){dt(qa(),"useHref() may be used only in the context of a <Router> component.");let{basename:n,navigator:r}=P.useContext(xr),{hash:s,pathname:i,search:o}=Bc(t,{relative:e}),a=i;return n!=="/"&&(a=i==="/"?n:rs([n,i])),r.createHref({pathname:a,search:o,hash:s})}function qa(){return P.useContext($c)!=null}function lr(){return dt(qa(),"useLocation() may be used only in the context of a <Router> component."),P.useContext($c).location}var F0="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function U0(t){P.useContext(xr).static||P.useLayoutEffect(t)}function Ha(){let{isDataRoute:t}=P.useContext(Sr);return t?SN():hN()}function hN(){dt(qa(),"useNavigate() may be used only in the context of a <Router> component.");let t=P.useContext(za),{basename:e,navigator:n}=P.useContext(xr),{matches:r}=P.useContext(Sr),{pathname:s}=lr(),i=JSON.stringify(my(r)),o=P.useRef(!1);return U0(()=>{o.current=!0}),P.useCallback((l,d={})=>{if(or(o.current,F0),!o.current)return;if(typeof l=="number"){n.go(l);return}let h=gy(l,JSON.parse(i),s,d.relative==="path");t==null&&e!=="/"&&(h.pathname=h.pathname==="/"?e:rs([e,h.pathname])),(d.replace?n.replace:n.push)(h,d.state,d)},[e,n,i,s,t])}P.createContext(null);function fN(){let{matches:t}=P.useContext(Sr),e=t[t.length-1];return e?e.params:{}}function Bc(t,{relative:e}={}){let{matches:n}=P.useContext(Sr),{pathname:r}=lr(),s=JSON.stringify(my(n));return P.useMemo(()=>gy(t,JSON.parse(s),r,e==="path"),[t,s,r,e])}function pN(t,e){return $0(t,e)}function $0(t,e,n,r,s){var I;dt(qa(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:i}=P.useContext(xr),{matches:o}=P.useContext(Sr),a=o[o.length-1],l=a?a.params:{},d=a?a.pathname:"/",h=a?a.pathnameBase:"/",f=a&&a.route;{let b=f&&f.path||"";B0(d,!f||b.endsWith("*")||b.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${d}" (under <Route path="${b}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${b}"> to <Route path="${b==="/"?"*":`${b}/*`}">.`)}let m=lr(),_;if(e){let b=typeof e=="string"?Ba(e):e;dt(h==="/"||((I=b.pathname)==null?void 0:I.startsWith(h)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${h}" but pathname "${b.pathname}" was given in the \`location\` prop.`),_=b}else _=m;let A=_.pathname||"/",R=A;if(h!=="/"){let b=h.replace(/^\//,"").split("/");R="/"+A.replace(/^\//,"").split("/").slice(b.length).join("/")}let C=j0(t,{pathname:R});or(f||C!=null,`No routes matched location "${_.pathname}${_.search}${_.hash}" `),or(C==null||C[C.length-1].route.element!==void 0||C[C.length-1].route.Component!==void 0||C[C.length-1].route.lazy!==void 0,`Matched leaf route at location "${_.pathname}${_.search}${_.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let w=vN(C&&C.map(b=>Object.assign({},b,{params:Object.assign({},l,b.params),pathname:rs([h,i.encodeLocation?i.encodeLocation(b.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:b.pathname]),pathnameBase:b.pathnameBase==="/"?h:rs([h,i.encodeLocation?i.encodeLocation(b.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:b.pathnameBase])})),o,n,r,s);return e&&w?P.createElement($c.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",..._},navigationType:"POP"}},w):w}function mN(){let t=xN(),e=aN(t)?`${t.status} ${t.statusText}`:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,r="rgba(200,200,200, 0.5)",s={padding:"0.5rem",backgroundColor:r},i={padding:"2px 4px",backgroundColor:r},o=null;return console.error("Error handled by React Router default ErrorBoundary:",t),o=P.createElement(P.Fragment,null,P.createElement("p",null," Hey developer "),P.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",P.createElement("code",{style:i},"ErrorBoundary")," or"," ",P.createElement("code",{style:i},"errorElement")," prop on your route.")),P.createElement(P.Fragment,null,P.createElement("h2",null,"Unexpected Application Error!"),P.createElement("h3",{style:{fontStyle:"italic"}},e),n?P.createElement("pre",{style:s},n):null,o)}var gN=P.createElement(mN,null),yN=class extends P.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,e){return e.location!==t.location||e.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:e.error,location:e.location,revalidation:t.revalidation||e.revalidation}}componentDidCatch(t,e){this.props.onError?this.props.onError(t,e):console.error("React Router caught the following error during render",t)}render(){return this.state.error!==void 0?P.createElement(Sr.Provider,{value:this.props.routeContext},P.createElement(yy.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function _N({routeContext:t,match:e,children:n}){let r=P.useContext(za);return r&&r.static&&r.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=e.route.id),P.createElement(Sr.Provider,{value:t},n)}function vN(t,e=[],n=null,r=null,s=null){if(t==null){if(!n)return null;if(n.errors)t=n.matches;else if(e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let i=t,o=n==null?void 0:n.errors;if(o!=null){let h=i.findIndex(f=>f.route.id&&(o==null?void 0:o[f.route.id])!==void 0);dt(h>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(o).join(",")}`),i=i.slice(0,Math.min(i.length,h+1))}let a=!1,l=-1;if(n)for(let h=0;h<i.length;h++){let f=i[h];if((f.route.HydrateFallback||f.route.hydrateFallbackElement)&&(l=h),f.route.id){let{loaderData:m,errors:_}=n,A=f.route.loader&&!m.hasOwnProperty(f.route.id)&&(!_||_[f.route.id]===void 0);if(f.route.lazy||A){a=!0,l>=0?i=i.slice(0,l+1):i=[i[0]];break}}}let d=n&&r?(h,f)=>{var m,_;r(h,{location:n.location,params:((_=(m=n.matches)==null?void 0:m[0])==null?void 0:_.params)??{},errorInfo:f})}:void 0;return i.reduceRight((h,f,m)=>{let _,A=!1,R=null,C=null;n&&(_=o&&f.route.id?o[f.route.id]:void 0,R=f.route.errorElement||gN,a&&(l<0&&m===0?(B0("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),A=!0,C=null):l===m&&(A=!0,C=f.route.hydrateFallbackElement||null)));let w=e.concat(i.slice(0,m+1)),I=()=>{let b;return _?b=R:A?b=C:f.route.Component?b=P.createElement(f.route.Component,null):f.route.element?b=f.route.element:b=h,P.createElement(_N,{match:f,routeContext:{outlet:h,matches:w,isDataRoute:n!=null},children:b})};return n&&(f.route.ErrorBoundary||f.route.errorElement||m===0)?P.createElement(yN,{location:n.location,revalidation:n.revalidation,component:R,error:_,children:I(),routeContext:{outlet:null,matches:w,isDataRoute:!0},onError:d}):I()},null)}function _y(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function wN(t){let e=P.useContext(za);return dt(e,_y(t)),e}function EN(t){let e=P.useContext(zh);return dt(e,_y(t)),e}function IN(t){let e=P.useContext(Sr);return dt(e,_y(t)),e}function vy(t){let e=IN(t),n=e.matches[e.matches.length-1];return dt(n.route.id,`${t} can only be used on routes that contain a unique "id"`),n.route.id}function TN(){return vy("useRouteId")}function xN(){var r;let t=P.useContext(yy),e=EN("useRouteError"),n=vy("useRouteError");return t!==void 0?t:(r=e.errors)==null?void 0:r[n]}function SN(){let{router:t}=wN("useNavigate"),e=vy("useNavigate"),n=P.useRef(!1);return U0(()=>{n.current=!0}),P.useCallback(async(s,i={})=>{or(n.current,F0),n.current&&(typeof s=="number"?t.navigate(s):await t.navigate(s,{fromRouteId:e,...i}))},[t,e])}var Mw={};function B0(t,e,n){!e&&!Mw[t]&&(Mw[t]=!0,or(!1,n))}P.memo(bN);function bN({routes:t,future:e,state:n,unstable_onError:r}){return $0(t,void 0,n,r,e)}function Qd({to:t,replace:e,state:n,relative:r}){dt(qa(),"<Navigate> may be used only in the context of a <Router> component.");let{static:s}=P.useContext(xr);or(!s,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:i}=P.useContext(Sr),{pathname:o}=lr(),a=Ha(),l=gy(t,my(i),o,r==="path"),d=JSON.stringify(l);return P.useEffect(()=>{a(JSON.parse(d),{replace:e,state:n,relative:r})},[a,d,r,e,n]),null}function Mo(t){dt(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function CN({basename:t="/",children:e=null,location:n,navigationType:r="POP",navigator:s,static:i=!1}){dt(!qa(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let o=t.replace(/^\/*/,"/"),a=P.useMemo(()=>({basename:o,navigator:s,static:i,future:{}}),[o,s,i]);typeof n=="string"&&(n=Ba(n));let{pathname:l="/",search:d="",hash:h="",state:f=null,key:m="default"}=n,_=P.useMemo(()=>{let A=ls(l,o);return A==null?null:{location:{pathname:A,search:d,hash:h,state:f,key:m},navigationType:r}},[o,l,d,h,f,m,r]);return or(_!=null,`<Router basename="${o}"> is not able to match the URL "${l}${d}${h}" because it does not start with the basename, so the <Router> won't render anything.`),_==null?null:P.createElement(xr.Provider,{value:a},P.createElement($c.Provider,{children:e,value:_}))}function AN({children:t,location:e}){return pN(Mm(t),e)}function Mm(t,e=[]){let n=[];return P.Children.forEach(t,(r,s)=>{if(!P.isValidElement(r))return;let i=[...e,s];if(r.type===P.Fragment){n.push.apply(n,Mm(r.props.children,i));return}dt(r.type===Mo,`[${typeof r.type=="string"?r.type:r.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),dt(!r.props.index||!r.props.children,"An index route cannot have child routes.");let o={id:r.props.id||i.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,middleware:r.props.middleware,loader:r.props.loader,action:r.props.action,hydrateFallbackElement:r.props.hydrateFallbackElement,HydrateFallback:r.props.HydrateFallback,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.hasErrorBoundary===!0||r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(o.children=Mm(r.props.children,i)),n.push(o)}),n}var od="get",ad="application/x-www-form-urlencoded";function qh(t){return t!=null&&typeof t.tagName=="string"}function RN(t){return qh(t)&&t.tagName.toLowerCase()==="button"}function PN(t){return qh(t)&&t.tagName.toLowerCase()==="form"}function NN(t){return qh(t)&&t.tagName.toLowerCase()==="input"}function kN(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function DN(t,e){return t.button===0&&(!e||e==="_self")&&!kN(t)}var ju=null;function jN(){if(ju===null)try{new FormData(document.createElement("form"),0),ju=!1}catch{ju=!0}return ju}var ON=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function gp(t){return t!=null&&!ON.has(t)?(or(!1,`"${t}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${ad}"`),null):t}function VN(t,e){let n,r,s,i,o;if(PN(t)){let a=t.getAttribute("action");r=a?ls(a,e):null,n=t.getAttribute("method")||od,s=gp(t.getAttribute("enctype"))||ad,i=new FormData(t)}else if(RN(t)||NN(t)&&(t.type==="submit"||t.type==="image")){let a=t.form;if(a==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let l=t.getAttribute("formaction")||a.getAttribute("action");if(r=l?ls(l,e):null,n=t.getAttribute("formmethod")||a.getAttribute("method")||od,s=gp(t.getAttribute("formenctype"))||gp(a.getAttribute("enctype"))||ad,i=new FormData(a,t),!jN()){let{name:d,type:h,value:f}=t;if(h==="image"){let m=d?`${d}.`:"";i.append(`${m}x`,"0"),i.append(`${m}y`,"0")}else d&&i.append(d,f)}}else{if(qh(t))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');n=od,r=null,s=ad,o=t}return i&&s==="text/plain"&&(o=i,i=void 0),{action:r,method:n.toLowerCase(),encType:s,formData:i,body:o}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function wy(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function LN(t,e,n){let r=typeof t=="string"?new URL(t,typeof window>"u"?"server://singlefetch/":window.location.origin):t;return r.pathname==="/"?r.pathname=`_root.${n}`:e&&ls(r.pathname,e)==="/"?r.pathname=`${e.replace(/\/$/,"")}/_root.${n}`:r.pathname=`${r.pathname.replace(/\/$/,"")}.${n}`,r}async function MN(t,e){if(t.id in e)return e[t.id];try{let n=await import(t.module);return e[t.id]=n,n}catch(n){return console.error(`Error loading route module \`${t.module}\`, reloading page...`),console.error(n),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function FN(t){return t==null?!1:t.href==null?t.rel==="preload"&&typeof t.imageSrcSet=="string"&&typeof t.imageSizes=="string":typeof t.rel=="string"&&typeof t.href=="string"}async function UN(t,e,n){let r=await Promise.all(t.map(async s=>{let i=e.routes[s.route.id];if(i){let o=await MN(i,n);return o.links?o.links():[]}return[]}));return qN(r.flat(1).filter(FN).filter(s=>s.rel==="stylesheet"||s.rel==="preload").map(s=>s.rel==="stylesheet"?{...s,rel:"prefetch",as:"style"}:{...s,rel:"prefetch"}))}function Fw(t,e,n,r,s,i){let o=(l,d)=>n[d]?l.route.id!==n[d].route.id:!0,a=(l,d)=>{var h;return n[d].pathname!==l.pathname||((h=n[d].route.path)==null?void 0:h.endsWith("*"))&&n[d].params["*"]!==l.params["*"]};return i==="assets"?e.filter((l,d)=>o(l,d)||a(l,d)):i==="data"?e.filter((l,d)=>{var f;let h=r.routes[l.route.id];if(!h||!h.hasLoader)return!1;if(o(l,d)||a(l,d))return!0;if(l.route.shouldRevalidate){let m=l.route.shouldRevalidate({currentUrl:new URL(s.pathname+s.search+s.hash,window.origin),currentParams:((f=n[0])==null?void 0:f.params)||{},nextUrl:new URL(t,window.origin),nextParams:l.params,defaultShouldRevalidate:!0});if(typeof m=="boolean")return m}return!0}):[]}function $N(t,e,{includeHydrateFallback:n}={}){return BN(t.map(r=>{let s=e.routes[r.route.id];if(!s)return[];let i=[s.module];return s.clientActionModule&&(i=i.concat(s.clientActionModule)),s.clientLoaderModule&&(i=i.concat(s.clientLoaderModule)),n&&s.hydrateFallbackModule&&(i=i.concat(s.hydrateFallbackModule)),s.imports&&(i=i.concat(s.imports)),i}).flat(1))}function BN(t){return[...new Set(t)]}function zN(t){let e={},n=Object.keys(t).sort();for(let r of n)e[r]=t[r];return e}function qN(t,e){let n=new Set;return new Set(e),t.reduce((r,s)=>{let i=JSON.stringify(zN(s));return n.has(i)||(n.add(i),r.push({key:i,link:s})),r},[])}function z0(){let t=P.useContext(za);return wy(t,"You must render this element inside a <DataRouterContext.Provider> element"),t}function HN(){let t=P.useContext(zh);return wy(t,"You must render this element inside a <DataRouterStateContext.Provider> element"),t}var Ey=P.createContext(void 0);Ey.displayName="FrameworkContext";function q0(){let t=P.useContext(Ey);return wy(t,"You must render this element inside a <HydratedRouter> element"),t}function WN(t,e){let n=P.useContext(Ey),[r,s]=P.useState(!1),[i,o]=P.useState(!1),{onFocus:a,onBlur:l,onMouseEnter:d,onMouseLeave:h,onTouchStart:f}=e,m=P.useRef(null);P.useEffect(()=>{if(t==="render"&&o(!0),t==="viewport"){let R=w=>{w.forEach(I=>{o(I.isIntersecting)})},C=new IntersectionObserver(R,{threshold:.5});return m.current&&C.observe(m.current),()=>{C.disconnect()}}},[t]),P.useEffect(()=>{if(r){let R=setTimeout(()=>{o(!0)},100);return()=>{clearTimeout(R)}}},[r]);let _=()=>{s(!0)},A=()=>{s(!1),o(!1)};return n?t!=="intent"?[i,m,{}]:[i,m,{onFocus:vl(a,_),onBlur:vl(l,A),onMouseEnter:vl(d,_),onMouseLeave:vl(h,A),onTouchStart:vl(f,_)}]:[!1,m,{}]}function vl(t,e){return n=>{t&&t(n),n.defaultPrevented||e(n)}}function KN({page:t,...e}){let{router:n}=z0(),r=P.useMemo(()=>j0(n.routes,t,n.basename),[n.routes,t,n.basename]);return r?P.createElement(QN,{page:t,matches:r,...e}):null}function GN(t){let{manifest:e,routeModules:n}=q0(),[r,s]=P.useState([]);return P.useEffect(()=>{let i=!1;return UN(t,e,n).then(o=>{i||s(o)}),()=>{i=!0}},[t,e,n]),r}function QN({page:t,matches:e,...n}){let r=lr(),{manifest:s,routeModules:i}=q0(),{basename:o}=z0(),{loaderData:a,matches:l}=HN(),d=P.useMemo(()=>Fw(t,e,l,s,r,"data"),[t,e,l,s,r]),h=P.useMemo(()=>Fw(t,e,l,s,r,"assets"),[t,e,l,s,r]),f=P.useMemo(()=>{if(t===r.pathname+r.search+r.hash)return[];let A=new Set,R=!1;if(e.forEach(w=>{var b;let I=s.routes[w.route.id];!I||!I.hasLoader||(!d.some(x=>x.route.id===w.route.id)&&w.route.id in a&&((b=i[w.route.id])!=null&&b.shouldRevalidate)||I.hasClientLoader?R=!0:A.add(w.route.id))}),A.size===0)return[];let C=LN(t,o,"data");return R&&A.size>0&&C.searchParams.set("_routes",e.filter(w=>A.has(w.route.id)).map(w=>w.route.id).join(",")),[C.pathname+C.search]},[o,a,r,s,d,e,t,i]),m=P.useMemo(()=>$N(h,s),[h,s]),_=GN(h);return P.createElement(P.Fragment,null,f.map(A=>P.createElement("link",{key:A,rel:"prefetch",as:"fetch",href:A,...n})),m.map(A=>P.createElement("link",{key:A,rel:"modulepreload",href:A,...n})),_.map(({key:A,link:R})=>P.createElement("link",{key:A,nonce:n.nonce,...R})))}function YN(...t){return e=>{t.forEach(n=>{typeof n=="function"?n(e):n!=null&&(n.current=e)})}}var H0=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{H0&&(window.__reactRouterVersion="7.9.6")}catch{}function XN({basename:t,children:e,window:n}){let r=P.useRef();r.current==null&&(r.current=LP({window:n,v5Compat:!0}));let s=r.current,[i,o]=P.useState({action:s.action,location:s.location}),a=P.useCallback(l=>{P.startTransition(()=>o(l))},[o]);return P.useLayoutEffect(()=>s.listen(a),[s,a]),P.createElement(CN,{basename:t,children:e,location:i.location,navigationType:i.action,navigator:s})}var W0=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,K0=P.forwardRef(function({onClick:e,discover:n="render",prefetch:r="none",relative:s,reloadDocument:i,replace:o,state:a,target:l,to:d,preventScrollReset:h,viewTransition:f,...m},_){let{basename:A}=P.useContext(xr),R=typeof d=="string"&&W0.test(d),C,w=!1;if(typeof d=="string"&&R&&(C=d,H0))try{let y=new URL(window.location.href),N=d.startsWith("//")?new URL(y.protocol+d):new URL(d),D=ls(N.pathname,A);N.origin===y.origin&&D!=null?d=D+N.search+N.hash:w=!0}catch{or(!1,`<Link to="${d}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let I=dN(d,{relative:s}),[b,x,L]=WN(r,m),$=ek(d,{replace:o,state:a,target:l,preventScrollReset:h,relative:s,viewTransition:f});function E(y){e&&e(y),y.defaultPrevented||$(y)}let v=P.createElement("a",{...m,...L,href:C||I,onClick:w||i?e:E,ref:YN(_,x),target:l,"data-discover":!R&&n==="render"?"true":void 0});return b&&!R?P.createElement(P.Fragment,null,v,P.createElement(KN,{page:I})):v});K0.displayName="Link";var Fo=P.forwardRef(function({"aria-current":e="page",caseSensitive:n=!1,className:r="",end:s=!1,style:i,to:o,viewTransition:a,children:l,...d},h){let f=Bc(o,{relative:d.relative}),m=lr(),_=P.useContext(zh),{navigator:A,basename:R}=P.useContext(xr),C=_!=null&&ik(f)&&a===!0,w=A.encodeLocation?A.encodeLocation(f).pathname:f.pathname,I=m.pathname,b=_&&_.navigation&&_.navigation.location?_.navigation.location.pathname:null;n||(I=I.toLowerCase(),b=b?b.toLowerCase():null,w=w.toLowerCase()),b&&R&&(b=ls(b,R)||b);const x=w!=="/"&&w.endsWith("/")?w.length-1:w.length;let L=I===w||!s&&I.startsWith(w)&&I.charAt(x)==="/",$=b!=null&&(b===w||!s&&b.startsWith(w)&&b.charAt(w.length)==="/"),E={isActive:L,isPending:$,isTransitioning:C},v=L?e:void 0,y;typeof r=="function"?y=r(E):y=[r,L?"active":null,$?"pending":null,C?"transitioning":null].filter(Boolean).join(" ");let N=typeof i=="function"?i(E):i;return P.createElement(K0,{...d,"aria-current":v,className:y,ref:h,style:N,to:o,viewTransition:a},typeof l=="function"?l(E):l)});Fo.displayName="NavLink";var JN=P.forwardRef(({discover:t="render",fetcherKey:e,navigate:n,reloadDocument:r,replace:s,state:i,method:o=od,action:a,onSubmit:l,relative:d,preventScrollReset:h,viewTransition:f,...m},_)=>{let A=rk(),R=sk(a,{relative:d}),C=o.toLowerCase()==="get"?"get":"post",w=typeof a=="string"&&W0.test(a),I=b=>{if(l&&l(b),b.defaultPrevented)return;b.preventDefault();let x=b.nativeEvent.submitter,L=(x==null?void 0:x.getAttribute("formmethod"))||o;A(x||b.currentTarget,{fetcherKey:e,method:L,navigate:n,replace:s,state:i,relative:d,preventScrollReset:h,viewTransition:f})};return P.createElement("form",{ref:_,method:C,action:R,onSubmit:r?l:I,...m,"data-discover":!w&&t==="render"?"true":void 0})});JN.displayName="Form";function ZN(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function G0(t){let e=P.useContext(za);return dt(e,ZN(t)),e}function ek(t,{target:e,replace:n,state:r,preventScrollReset:s,relative:i,viewTransition:o}={}){let a=Ha(),l=lr(),d=Bc(t,{relative:i});return P.useCallback(h=>{if(DN(h,e)){h.preventDefault();let f=n!==void 0?n:Ec(l)===Ec(d);a(t,{replace:f,state:r,preventScrollReset:s,relative:i,viewTransition:o})}},[l,a,d,n,r,e,t,s,i,o])}var tk=0,nk=()=>`__${String(++tk)}__`;function rk(){let{router:t}=G0("useSubmit"),{basename:e}=P.useContext(xr),n=TN();return P.useCallback(async(r,s={})=>{let{action:i,method:o,encType:a,formData:l,body:d}=VN(r,e);if(s.navigate===!1){let h=s.fetcherKey||nk();await t.fetch(h,n,s.action||i,{preventScrollReset:s.preventScrollReset,formData:l,body:d,formMethod:s.method||o,formEncType:s.encType||a,flushSync:s.flushSync})}else await t.navigate(s.action||i,{preventScrollReset:s.preventScrollReset,formData:l,body:d,formMethod:s.method||o,formEncType:s.encType||a,replace:s.replace,state:s.state,fromRouteId:n,flushSync:s.flushSync,viewTransition:s.viewTransition})},[t,e,n])}function sk(t,{relative:e}={}){let{basename:n}=P.useContext(xr),r=P.useContext(Sr);dt(r,"useFormAction must be used inside a RouteContext");let[s]=r.matches.slice(-1),i={...Bc(t||".",{relative:e})},o=lr();if(t==null){i.search=o.search;let a=new URLSearchParams(i.search),l=a.getAll("index");if(l.some(h=>h==="")){a.delete("index"),l.filter(f=>f).forEach(f=>a.append("index",f));let h=a.toString();i.search=h?`?${h}`:""}}return(!t||t===".")&&s.route.index&&(i.search=i.search?i.search.replace(/^\?/,"?index&"):"?index"),n!=="/"&&(i.pathname=i.pathname==="/"?n:rs([n,i.pathname])),Ec(i)}function ik(t,{relative:e}={}){let n=P.useContext(M0);dt(n!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:r}=G0("useViewTransitionState"),s=Bc(t,{relative:e});if(!n.isTransitioning)return!1;let i=ls(n.currentLocation.pathname,r)||n.currentLocation.pathname,o=ls(n.nextLocation.pathname,r)||n.nextLocation.pathname;return Gd(s.pathname,o)!=null||Gd(s.pathname,i)!=null}const ok=()=>{};var Uw={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Q0=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let s=t.charCodeAt(r);s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=s&63|128):(s&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=s&63|128):(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=s&63|128)}return e},ak=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const s=t[n++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=t[n++];e[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=t[n++],o=t[n++],a=t[n++],l=((s&7)<<18|(i&63)<<12|(o&63)<<6|a&63)-65536;e[r++]=String.fromCharCode(55296+(l>>10)),e[r++]=String.fromCharCode(56320+(l&1023))}else{const i=t[n++],o=t[n++];e[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|o&63)}}return e.join("")},Y0={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<t.length;s+=3){const i=t[s],o=s+1<t.length,a=o?t[s+1]:0,l=s+2<t.length,d=l?t[s+2]:0,h=i>>2,f=(i&3)<<4|a>>4;let m=(a&15)<<2|d>>6,_=d&63;l||(_=64,o||(m=64)),r.push(n[h],n[f],n[m],n[_])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(Q0(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):ak(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<t.length;){const i=n[t.charAt(s++)],a=s<t.length?n[t.charAt(s)]:0;++s;const d=s<t.length?n[t.charAt(s)]:64;++s;const f=s<t.length?n[t.charAt(s)]:64;if(++s,i==null||a==null||d==null||f==null)throw new lk;const m=i<<2|a>>4;if(r.push(m),d!==64){const _=a<<4&240|d>>2;if(r.push(_),f!==64){const A=d<<6&192|f;r.push(A)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class lk extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const ck=function(t){const e=Q0(t);return Y0.encodeByteArray(e,!0)},Yd=function(t){return ck(t).replace(/\./g,"")},X0=function(t){try{return Y0.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function J0(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uk=()=>J0().__FIREBASE_DEFAULTS__,dk=()=>{if(typeof process>"u"||typeof Uw>"u")return;const t=Uw.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},hk=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&X0(t[1]);return e&&JSON.parse(e)},Hh=()=>{try{return ok()||uk()||dk()||hk()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},Z0=t=>{var e,n;return(n=(e=Hh())==null?void 0:e.emulatorHosts)==null?void 0:n[t]},eS=t=>{const e=Z0(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},tS=()=>{var t;return(t=Hh())==null?void 0:t.config},nS=t=>{var e;return(e=Hh())==null?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fk{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mi(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function Iy(t){return(await fetch(t,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rS(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",s=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o={iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}},...t};return[Yd(JSON.stringify(n)),Yd(JSON.stringify(o)),""].join(".")}const Gl={};function pk(){const t={prod:[],emulator:[]};for(const e of Object.keys(Gl))Gl[e]?t.emulator.push(e):t.prod.push(e);return t}function mk(t){let e=document.getElementById(t),n=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),n=!0),{created:n,element:e}}let $w=!1;function Ty(t,e){if(typeof window>"u"||typeof document>"u"||!mi(window.location.host)||Gl[t]===e||Gl[t]||$w)return;Gl[t]=e;function n(m){return`__firebase__banner__${m}`}const r="__firebase__banner",i=pk().prod.length>0;function o(){const m=document.getElementById(r);m&&m.remove()}function a(m){m.style.display="flex",m.style.background="#7faaf0",m.style.position="fixed",m.style.bottom="5px",m.style.left="5px",m.style.padding=".5em",m.style.borderRadius="5px",m.style.alignItems="center"}function l(m,_){m.setAttribute("width","24"),m.setAttribute("id",_),m.setAttribute("height","24"),m.setAttribute("viewBox","0 0 24 24"),m.setAttribute("fill","none"),m.style.marginLeft="-6px"}function d(){const m=document.createElement("span");return m.style.cursor="pointer",m.style.marginLeft="16px",m.style.fontSize="24px",m.innerHTML=" &times;",m.onclick=()=>{$w=!0,o()},m}function h(m,_){m.setAttribute("id",_),m.innerText="Learn more",m.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",m.setAttribute("target","__blank"),m.style.paddingLeft="5px",m.style.textDecoration="underline"}function f(){const m=mk(r),_=n("text"),A=document.getElementById(_)||document.createElement("span"),R=n("learnmore"),C=document.getElementById(R)||document.createElement("a"),w=n("preprendIcon"),I=document.getElementById(w)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(m.created){const b=m.element;a(b),h(C,R);const x=d();l(I,w),b.append(I,A,C,x),document.body.appendChild(b)}i?(A.innerText="Preview backend disconnected.",I.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(I.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,A.innerText="Preview backend running in this workspace."),A.setAttribute("id",_)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",f):f()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vt(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function gk(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Vt())}function sS(){var e;const t=(e=Hh())==null?void 0:e.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function yk(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function iS(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function _k(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function vk(){const t=Vt();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function oS(){return!sS()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function aS(){return!sS()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function xy(){try{return typeof indexedDB=="object"}catch{return!1}}function lS(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{var i;e(((i=s.error)==null?void 0:i.message)||"")}}catch(n){e(n)}})}function wk(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ek="FirebaseError";class cr extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=Ek,Object.setPrototypeOf(this,cr.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,vo.prototype.create)}}class vo{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},s=`${this.service}/${e}`,i=this.errors[e],o=i?Ik(i,r):"Error",a=`${this.serviceName}: ${o} (${s}).`;return new cr(s,a,r)}}function Ik(t,e){return t.replace(Tk,(n,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const Tk=/\{\$([^}]+)}/g;function xk(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function cs(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const s of n){if(!r.includes(s))return!1;const i=t[s],o=e[s];if(Bw(i)&&Bw(o)){if(!cs(i,o))return!1}else if(i!==o)return!1}for(const s of r)if(!n.includes(s))return!1;return!0}function Bw(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zc(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(s=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function Nl(t){const e={};return t.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[s,i]=r.split("=");e[decodeURIComponent(s)]=decodeURIComponent(i)}}),e}function kl(t){const e=t.indexOf("?");if(!e)return"";const n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}function Sk(t,e){const n=new bk(t,e);return n.subscribe.bind(n)}class bk{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let s;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");Ck(e,["next","error","complete"])?s=e:s={next:e,error:n,complete:r},s.next===void 0&&(s.next=yp),s.error===void 0&&(s.error=yp),s.complete===void 0&&(s.complete=yp);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function Ck(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function yp(){}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ak=1e3,Rk=2,Pk=4*60*60*1e3,Nk=.5;function zw(t,e=Ak,n=Rk){const r=e*Math.pow(n,t),s=Math.round(Nk*r*(Math.random()-.5)*2);return Math.min(Pk,r+s)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ke(t){return t&&t._delegate?t._delegate:t}class ar{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pi="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kk{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new fk;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:n});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){const n=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),r=(e==null?void 0:e.optional)??!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(s){if(r)return null;throw s}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(jk(e))try{this.getOrInitializeService({instanceIdentifier:Pi})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(n);try{const i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(e=Pi){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Pi){return this.instances.has(e)}getOptions(e=Pi){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[i,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(i);r===a&&o.resolve(s)}return s}onInit(e,n){const r=this.normalizeInstanceIdentifier(n),s=this.onInitCallbacks.get(r)??new Set;s.add(e),this.onInitCallbacks.set(r,s);const i=this.instances.get(r);return i&&e(i,r),()=>{s.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const s of r)try{s(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:Dk(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Pi){return this.component?this.component.multipleInstances?e:Pi:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function Dk(t){return t===Pi?void 0:t}function jk(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ok{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new kk(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Le;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Le||(Le={}));const Vk={debug:Le.DEBUG,verbose:Le.VERBOSE,info:Le.INFO,warn:Le.WARN,error:Le.ERROR,silent:Le.SILENT},Lk=Le.INFO,Mk={[Le.DEBUG]:"log",[Le.VERBOSE]:"log",[Le.INFO]:"info",[Le.WARN]:"warn",[Le.ERROR]:"error"},Fk=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),s=Mk[e];if(s)console[s](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Wh{constructor(e){this.name=e,this._logLevel=Lk,this._logHandler=Fk,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Le))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?Vk[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Le.DEBUG,...e),this._logHandler(this,Le.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Le.VERBOSE,...e),this._logHandler(this,Le.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Le.INFO,...e),this._logHandler(this,Le.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Le.WARN,...e),this._logHandler(this,Le.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Le.ERROR,...e),this._logHandler(this,Le.ERROR,...e)}}const Uk=(t,e)=>e.some(n=>t instanceof n);let qw,Hw;function $k(){return qw||(qw=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Bk(){return Hw||(Hw=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const cS=new WeakMap,Fm=new WeakMap,uS=new WeakMap,_p=new WeakMap,Sy=new WeakMap;function zk(t){const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("success",i),t.removeEventListener("error",o)},i=()=>{n(Zs(t.result)),s()},o=()=>{r(t.error),s()};t.addEventListener("success",i),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&cS.set(n,t)}).catch(()=>{}),Sy.set(e,t),e}function qk(t){if(Fm.has(t))return;const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",o),t.removeEventListener("abort",o)},i=()=>{n(),s()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",i),t.addEventListener("error",o),t.addEventListener("abort",o)});Fm.set(t,e)}let Um={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return Fm.get(t);if(e==="objectStoreNames")return t.objectStoreNames||uS.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Zs(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function Hk(t){Um=t(Um)}function Wk(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(vp(this),e,...n);return uS.set(r,e.sort?e.sort():[e]),Zs(r)}:Bk().includes(t)?function(...e){return t.apply(vp(this),e),Zs(cS.get(this))}:function(...e){return Zs(t.apply(vp(this),e))}}function Kk(t){return typeof t=="function"?Wk(t):(t instanceof IDBTransaction&&qk(t),Uk(t,$k())?new Proxy(t,Um):t)}function Zs(t){if(t instanceof IDBRequest)return zk(t);if(_p.has(t))return _p.get(t);const e=Kk(t);return e!==t&&(_p.set(t,e),Sy.set(e,t)),e}const vp=t=>Sy.get(t);function dS(t,e,{blocked:n,upgrade:r,blocking:s,terminated:i}={}){const o=indexedDB.open(t,e),a=Zs(o);return r&&o.addEventListener("upgradeneeded",l=>{r(Zs(o.result),l.oldVersion,l.newVersion,Zs(o.transaction),l)}),n&&o.addEventListener("blocked",l=>n(l.oldVersion,l.newVersion,l)),a.then(l=>{i&&l.addEventListener("close",()=>i()),s&&l.addEventListener("versionchange",d=>s(d.oldVersion,d.newVersion,d))}).catch(()=>{}),a}const Gk=["get","getKey","getAll","getAllKeys","count"],Qk=["put","add","delete","clear"],wp=new Map;function Ww(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(wp.get(e))return wp.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,s=Qk.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(s||Gk.includes(n)))return;const i=async function(o,...a){const l=this.transaction(o,s?"readwrite":"readonly");let d=l.store;return r&&(d=d.index(a.shift())),(await Promise.all([d[n](...a),s&&l.done]))[0]};return wp.set(e,i),i}Hk(t=>({...t,get:(e,n,r)=>Ww(e,n)||t.get(e,n,r),has:(e,n)=>!!Ww(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yk{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(Xk(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function Xk(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const $m="@firebase/app",Kw="0.14.5";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const us=new Wh("@firebase/app"),Jk="@firebase/app-compat",Zk="@firebase/analytics-compat",eD="@firebase/analytics",tD="@firebase/app-check-compat",nD="@firebase/app-check",rD="@firebase/auth",sD="@firebase/auth-compat",iD="@firebase/database",oD="@firebase/data-connect",aD="@firebase/database-compat",lD="@firebase/functions",cD="@firebase/functions-compat",uD="@firebase/installations",dD="@firebase/installations-compat",hD="@firebase/messaging",fD="@firebase/messaging-compat",pD="@firebase/performance",mD="@firebase/performance-compat",gD="@firebase/remote-config",yD="@firebase/remote-config-compat",_D="@firebase/storage",vD="@firebase/storage-compat",wD="@firebase/firestore",ED="@firebase/ai",ID="@firebase/firestore-compat",TD="firebase",xD="12.5.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bm="[DEFAULT]",SD={[$m]:"fire-core",[Jk]:"fire-core-compat",[eD]:"fire-analytics",[Zk]:"fire-analytics-compat",[nD]:"fire-app-check",[tD]:"fire-app-check-compat",[rD]:"fire-auth",[sD]:"fire-auth-compat",[iD]:"fire-rtdb",[oD]:"fire-data-connect",[aD]:"fire-rtdb-compat",[lD]:"fire-fn",[cD]:"fire-fn-compat",[uD]:"fire-iid",[dD]:"fire-iid-compat",[hD]:"fire-fcm",[fD]:"fire-fcm-compat",[pD]:"fire-perf",[mD]:"fire-perf-compat",[gD]:"fire-rc",[yD]:"fire-rc-compat",[_D]:"fire-gcs",[vD]:"fire-gcs-compat",[wD]:"fire-fst",[ID]:"fire-fst-compat",[ED]:"fire-vertex","fire-js":"fire-js",[TD]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xd=new Map,bD=new Map,zm=new Map;function Gw(t,e){try{t.container.addComponent(e)}catch(n){us.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function Er(t){const e=t.name;if(zm.has(e))return us.debug(`There were multiple attempts to register component ${e}.`),!1;zm.set(e,t);for(const n of Xd.values())Gw(n,t);for(const n of bD.values())Gw(n,t);return!0}function gi(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function Jn(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CD={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},ei=new vo("app","Firebase",CD);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AD{constructor(e,n,r){this._isDeleted=!1,this._options={...e},this._config={...n},this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new ar("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw ei.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wo=xD;function by(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r={name:Bm,automaticDataCollectionEnabled:!0,...e},s=r.name;if(typeof s!="string"||!s)throw ei.create("bad-app-name",{appName:String(s)});if(n||(n=tS()),!n)throw ei.create("no-options");const i=Xd.get(s);if(i){if(cs(n,i.options)&&cs(r,i.config))return i;throw ei.create("duplicate-app",{appName:s})}const o=new Ok(s);for(const l of zm.values())o.addComponent(l);const a=new AD(n,r,o);return Xd.set(s,a),a}function Kh(t=Bm){const e=Xd.get(t);if(!e&&t===Bm&&tS())return by();if(!e)throw ei.create("no-app",{appName:t});return e}function kn(t,e,n){let r=SD[t]??t;n&&(r+=`-${n}`);const s=r.match(/\s|\//),i=e.match(/\s|\//);if(s||i){const o=[`Unable to register library "${r}" with version "${e}":`];s&&o.push(`library name "${r}" contains illegal characters (whitespace or "/")`),s&&i&&o.push("and"),i&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),us.warn(o.join(" "));return}Er(new ar(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RD="firebase-heartbeat-database",PD=1,Ic="firebase-heartbeat-store";let Ep=null;function hS(){return Ep||(Ep=dS(RD,PD,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Ic)}catch(n){console.warn(n)}}}}).catch(t=>{throw ei.create("idb-open",{originalErrorMessage:t.message})})),Ep}async function ND(t){try{const n=(await hS()).transaction(Ic),r=await n.objectStore(Ic).get(fS(t));return await n.done,r}catch(e){if(e instanceof cr)us.warn(e.message);else{const n=ei.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});us.warn(n.message)}}}async function Qw(t,e){try{const r=(await hS()).transaction(Ic,"readwrite");await r.objectStore(Ic).put(e,fS(t)),await r.done}catch(n){if(n instanceof cr)us.warn(n.message);else{const r=ei.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});us.warn(r.message)}}}function fS(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kD=1024,DD=30;class jD{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new VD(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=Yw();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)==null?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(o=>o.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:s}),this._heartbeatsCache.heartbeats.length>DD){const o=LD(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){us.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=Yw(),{heartbeatsToSend:r,unsentEntries:s}=OD(this._heartbeatsCache.heartbeats),i=Yd(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(n){return us.warn(n),""}}}function Yw(){return new Date().toISOString().substring(0,10)}function OD(t,e=kD){const n=[];let r=t.slice();for(const s of t){const i=n.find(o=>o.agent===s.agent);if(i){if(i.dates.push(s.date),Xw(n)>e){i.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),Xw(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class VD{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return xy()?lS().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await ND(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return Qw(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return Qw(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function Xw(t){return Yd(JSON.stringify({version:2,heartbeats:t})).length}function LD(t){if(t.length===0)return-1;let e=0,n=t[0].date;for(let r=1;r<t.length;r++)t[r].date<n&&(n=t[r].date,e=r);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function MD(t){Er(new ar("platform-logger",e=>new Yk(e),"PRIVATE")),Er(new ar("heartbeat",e=>new jD(e),"PRIVATE")),kn($m,Kw,t),kn($m,Kw,"esm2020"),kn("fire-js","")}MD("");var FD="firebase",UD="12.5.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */kn(FD,UD,"app");function pS(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const $D=pS,mS=new vo("auth","Firebase",pS());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jd=new Wh("@firebase/auth");function BD(t,...e){Jd.logLevel<=Le.WARN&&Jd.warn(`Auth (${wo}): ${t}`,...e)}function ld(t,...e){Jd.logLevel<=Le.ERROR&&Jd.error(`Auth (${wo}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ir(t,...e){throw Cy(t,...e)}function zr(t,...e){return Cy(t,...e)}function gS(t,e,n){const r={...$D(),[e]:n};return new vo("auth","Firebase",r).create(e,{appName:t.name})}function ti(t){return gS(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Cy(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return mS.create(t,...e)}function ve(t,e,...n){if(!t)throw Cy(e,...n)}function Zr(t){const e="INTERNAL ASSERTION FAILED: "+t;throw ld(e),new Error(e)}function ds(t,e){t||Zr(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qm(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.href)||""}function zD(){return Jw()==="http:"||Jw()==="https:"}function Jw(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qD(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(zD()||iS()||"connection"in navigator)?navigator.onLine:!0}function HD(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qc{constructor(e,n){this.shortDelay=e,this.longDelay=n,ds(n>e,"Short delay should be less than long delay!"),this.isMobile=gk()||_k()}get(){return qD()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ay(t,e){ds(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yS{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Zr("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Zr("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Zr("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WD={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KD=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],GD=new qc(3e4,6e4);function Eo(t,e){return t.tenantId&&!e.tenantId?{...e,tenantId:t.tenantId}:e}async function yi(t,e,n,r,s={}){return _S(t,s,async()=>{let i={},o={};r&&(e==="GET"?o=r:i={body:JSON.stringify(r)});const a=zc({key:t.config.apiKey,...o}).slice(1),l=await t._getAdditionalHeaders();l["Content-Type"]="application/json",t.languageCode&&(l["X-Firebase-Locale"]=t.languageCode);const d={method:e,headers:l,...i};return yk()||(d.referrerPolicy="no-referrer"),t.emulatorConfig&&mi(t.emulatorConfig.host)&&(d.credentials="include"),yS.fetch()(await vS(t,t.config.apiHost,n,a),d)})}async function _S(t,e,n){t._canInitEmulator=!1;const r={...WD,...e};try{const s=new YD(t),i=await Promise.race([n(),s.promise]);s.clearNetworkTimeout();const o=await i.json();if("needConfirmation"in o)throw Ou(t,"account-exists-with-different-credential",o);if(i.ok&&!("errorMessage"in o))return o;{const a=i.ok?o.errorMessage:o.error.message,[l,d]=a.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw Ou(t,"credential-already-in-use",o);if(l==="EMAIL_EXISTS")throw Ou(t,"email-already-in-use",o);if(l==="USER_DISABLED")throw Ou(t,"user-disabled",o);const h=r[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(d)throw gS(t,h,d);Ir(t,h)}}catch(s){if(s instanceof cr)throw s;Ir(t,"network-request-failed",{message:String(s)})}}async function Gh(t,e,n,r,s={}){const i=await yi(t,e,n,r,s);return"mfaPendingCredential"in i&&Ir(t,"multi-factor-auth-required",{_serverResponse:i}),i}async function vS(t,e,n,r){const s=`${e}${n}?${r}`,i=t,o=i.config.emulator?Ay(t.config,s):`${t.config.apiScheme}://${s}`;return KD.includes(n)&&(await i._persistenceManagerAvailable,i._getPersistenceType()==="COOKIE")?i._getPersistence()._getFinalTarget(o).toString():o}function QD(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class YD{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(zr(this.auth,"network-request-failed")),GD.get())})}}function Ou(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const s=zr(t,e,r);return s.customData._tokenResponse=n,s}function Zw(t){return t!==void 0&&t.enterprise!==void 0}class XD{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const n of this.recaptchaEnforcementState)if(n.provider&&n.provider===e)return QD(n.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function JD(t,e){return yi(t,"GET","/v2/recaptchaConfig",Eo(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ZD(t,e){return yi(t,"POST","/v1/accounts:delete",e)}async function Zd(t,e){return yi(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ql(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function ej(t,e=!1){const n=Ke(t),r=await n.getIdToken(e),s=Ry(r);ve(s&&s.exp&&s.auth_time&&s.iat,n.auth,"internal-error");const i=typeof s.firebase=="object"?s.firebase:void 0,o=i==null?void 0:i.sign_in_provider;return{claims:s,token:r,authTime:Ql(Ip(s.auth_time)),issuedAtTime:Ql(Ip(s.iat)),expirationTime:Ql(Ip(s.exp)),signInProvider:o||null,signInSecondFactor:(i==null?void 0:i.sign_in_second_factor)||null}}function Ip(t){return Number(t)*1e3}function Ry(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return ld("JWT malformed, contained fewer than 3 sections"),null;try{const s=X0(n);return s?JSON.parse(s):(ld("Failed to decode base64 JWT payload"),null)}catch(s){return ld("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function eE(t){const e=Ry(t);return ve(e,"internal-error"),ve(typeof e.exp<"u","internal-error"),ve(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Tc(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof cr&&tj(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function tj({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nj{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const r=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hm{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=Ql(this.lastLoginAt),this.creationTime=Ql(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function eh(t){var f;const e=t.auth,n=await t.getIdToken(),r=await Tc(t,Zd(e,{idToken:n}));ve(r==null?void 0:r.users.length,e,"internal-error");const s=r.users[0];t._notifyReloadListener(s);const i=(f=s.providerUserInfo)!=null&&f.length?wS(s.providerUserInfo):[],o=sj(t.providerData,i),a=t.isAnonymous,l=!(t.email&&s.passwordHash)&&!(o!=null&&o.length),d=a?l:!1,h={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:o,metadata:new Hm(s.createdAt,s.lastLoginAt),isAnonymous:d};Object.assign(t,h)}async function rj(t){const e=Ke(t);await eh(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function sj(t,e){return[...t.filter(r=>!e.some(s=>s.providerId===r.providerId)),...e]}function wS(t){return t.map(({providerId:e,...n})=>({providerId:e,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ij(t,e){const n=await _S(t,{},async()=>{const r=zc({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:i}=t.config,o=await vS(t,s,"/v1/token",`key=${i}`),a=await t._getAdditionalHeaders();a["Content-Type"]="application/x-www-form-urlencoded";const l={method:"POST",headers:a,body:r};return t.emulatorConfig&&mi(t.emulatorConfig.host)&&(l.credentials="include"),yS.fetch()(o,l)});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function oj(t,e){return yi(t,"POST","/v2/accounts:revokeToken",Eo(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ua{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){ve(e.idToken,"internal-error"),ve(typeof e.idToken<"u","internal-error"),ve(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):eE(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){ve(e.length!==0,"internal-error");const n=eE(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(ve(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:s,expiresIn:i}=await ij(e,n);this.updateTokensAndExpiration(r,s,Number(i))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:s,expirationTime:i}=n,o=new ua;return r&&(ve(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),s&&(ve(typeof s=="string","internal-error",{appName:e}),o.accessToken=s),i&&(ve(typeof i=="number","internal-error",{appName:e}),o.expirationTime=i),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new ua,this.toJSON())}_performRefresh(){return Zr("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bs(t,e){ve(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class gr{constructor({uid:e,auth:n,stsTokenManager:r,...s}){this.providerId="firebase",this.proactiveRefresh=new nj(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=n,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new Hm(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const n=await Tc(this,this.stsTokenManager.getToken(this.auth,e));return ve(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return ej(this,e)}reload(){return rj(this)}_assign(e){this!==e&&(ve(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>({...n})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new gr({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return n.metadata._copy(this.metadata),n}_onReload(e){ve(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await eh(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Jn(this.auth.app))return Promise.reject(ti(this.auth));const e=await this.getIdToken();return await Tc(this,ZD(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){const r=n.displayName??void 0,s=n.email??void 0,i=n.phoneNumber??void 0,o=n.photoURL??void 0,a=n.tenantId??void 0,l=n._redirectEventId??void 0,d=n.createdAt??void 0,h=n.lastLoginAt??void 0,{uid:f,emailVerified:m,isAnonymous:_,providerData:A,stsTokenManager:R}=n;ve(f&&R,e,"internal-error");const C=ua.fromJSON(this.name,R);ve(typeof f=="string",e,"internal-error"),bs(r,e.name),bs(s,e.name),ve(typeof m=="boolean",e,"internal-error"),ve(typeof _=="boolean",e,"internal-error"),bs(i,e.name),bs(o,e.name),bs(a,e.name),bs(l,e.name),bs(d,e.name),bs(h,e.name);const w=new gr({uid:f,auth:e,email:s,emailVerified:m,displayName:r,isAnonymous:_,photoURL:o,phoneNumber:i,tenantId:a,stsTokenManager:C,createdAt:d,lastLoginAt:h});return A&&Array.isArray(A)&&(w.providerData=A.map(I=>({...I}))),l&&(w._redirectEventId=l),w}static async _fromIdTokenResponse(e,n,r=!1){const s=new ua;s.updateFromServerResponse(n);const i=new gr({uid:n.localId,auth:e,stsTokenManager:s,isAnonymous:r});return await eh(i),i}static async _fromGetAccountInfoResponse(e,n,r){const s=n.users[0];ve(s.localId!==void 0,"internal-error");const i=s.providerUserInfo!==void 0?wS(s.providerUserInfo):[],o=!(s.email&&s.passwordHash)&&!(i!=null&&i.length),a=new ua;a.updateFromIdToken(r);const l=new gr({uid:s.localId,auth:e,stsTokenManager:a,isAnonymous:o}),d={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:i,metadata:new Hm(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(i!=null&&i.length)};return Object.assign(l,d),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tE=new Map;function es(t){ds(t instanceof Function,"Expected a class definition");let e=tE.get(t);return e?(ds(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,tE.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ES{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}ES.type="NONE";const nE=ES;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cd(t,e,n){return`firebase:${t}:${e}:${n}`}class da{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:s,name:i}=this.auth;this.fullUserKey=cd(this.userKey,s.apiKey,i),this.fullPersistenceKey=cd("persistence",s.apiKey,i),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const n=await Zd(this.auth,{idToken:e}).catch(()=>{});return n?gr._fromGetAccountInfoResponse(this.auth,n,e):null}return gr._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new da(es(nE),e,r);const s=(await Promise.all(n.map(async d=>{if(await d._isAvailable())return d}))).filter(d=>d);let i=s[0]||es(nE);const o=cd(r,e.config.apiKey,e.name);let a=null;for(const d of n)try{const h=await d._get(o);if(h){let f;if(typeof h=="string"){const m=await Zd(e,{idToken:h}).catch(()=>{});if(!m)break;f=await gr._fromGetAccountInfoResponse(e,m,h)}else f=gr._fromJSON(e,h);d!==i&&(a=f),i=d;break}}catch{}const l=s.filter(d=>d._shouldAllowMigration);return!i._shouldAllowMigration||!l.length?new da(i,e,r):(i=l[0],a&&await i._set(o,a.toJSON()),await Promise.all(n.map(async d=>{if(d!==i)try{await d._remove(o)}catch{}})),new da(i,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rE(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(SS(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(IS(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(CS(e))return"Blackberry";if(AS(e))return"Webos";if(TS(e))return"Safari";if((e.includes("chrome/")||xS(e))&&!e.includes("edge/"))return"Chrome";if(bS(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function IS(t=Vt()){return/firefox\//i.test(t)}function TS(t=Vt()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function xS(t=Vt()){return/crios\//i.test(t)}function SS(t=Vt()){return/iemobile/i.test(t)}function bS(t=Vt()){return/android/i.test(t)}function CS(t=Vt()){return/blackberry/i.test(t)}function AS(t=Vt()){return/webos/i.test(t)}function Py(t=Vt()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function aj(t=Vt()){var e;return Py(t)&&!!((e=window.navigator)!=null&&e.standalone)}function lj(){return vk()&&document.documentMode===10}function RS(t=Vt()){return Py(t)||bS(t)||AS(t)||CS(t)||/windows phone/i.test(t)||SS(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PS(t,e=[]){let n;switch(t){case"Browser":n=rE(Vt());break;case"Worker":n=`${rE(Vt())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${wo}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cj{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=i=>new Promise((o,a)=>{try{const l=e(i);o(l)}catch(l){a(l)}});r.onAbort=n,this.queue.push(r);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const s of n)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function uj(t,e={}){return yi(t,"GET","/v2/passwordPolicy",Eo(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dj=6;class hj{constructor(e){var r;const n=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=n.minPasswordLength??dj,n.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=n.maxPasswordLength),n.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=n.containsLowercaseCharacter),n.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=n.containsUppercaseCharacter),n.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=n.containsNumericCharacter),n.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=n.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=((r=e.allowedNonAlphanumericCharacters)==null?void 0:r.join(""))??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const n={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,n),this.validatePasswordCharacterOptions(e,n),n.isValid&&(n.isValid=n.meetsMinPasswordLength??!0),n.isValid&&(n.isValid=n.meetsMaxPasswordLength??!0),n.isValid&&(n.isValid=n.containsLowercaseLetter??!0),n.isValid&&(n.isValid=n.containsUppercaseLetter??!0),n.isValid&&(n.isValid=n.containsNumericCharacter??!0),n.isValid&&(n.isValid=n.containsNonAlphanumericCharacter??!0),n}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),s&&(n.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let s=0;s<e.length;s++)r=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,s,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fj{constructor(e,n,r,s){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new sE(this),this.idTokenSubscription=new sE(this),this.beforeStateQueue=new cj(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=mS,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion,this._persistenceManagerAvailable=new Promise(i=>this._resolvePersistenceManagerAvailable=i)}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=es(n)),this._initializationPromise=this.queue(async()=>{var r,s,i;if(!this._deleted&&(this.persistenceManager=await da.create(this,e),(r=this._resolvePersistenceManagerAvailable)==null||r.call(this),!this._deleted)){if((s=this._popupRedirectResolver)!=null&&s._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((i=this.currentUser)==null?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await Zd(this,{idToken:e}),r=await gr._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(r)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var i;if(Jn(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(a,a))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let r=n,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(i=this.redirectUser)==null?void 0:i._redirectEventId,a=r==null?void 0:r._redirectEventId,l=await this.tryRedirectSignIn(e);(!o||o===a)&&(l!=null&&l.user)&&(r=l.user,s=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(r)}catch(o){r=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return ve(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await eh(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=HD()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Jn(this.app))return Promise.reject(ti(this));const n=e?Ke(e):null;return n&&ve(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&ve(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Jn(this.app)?Promise.reject(ti(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Jn(this.app)?Promise.reject(ti(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(es(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await uj(this),n=new hj(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new vo("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),await oj(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)==null?void 0:e.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&es(e)||this._popupRedirectResolver;ve(n,this,"argument-error"),this.redirectPersistenceManager=await da.create(this,[es(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)==null?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)==null?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=((n=this.currentUser)==null?void 0:n.uid)??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,s){if(this._deleted)return()=>{};const i=typeof n=="function"?n:n.next.bind(n);let o=!1;const a=this._isInitialized?Promise.resolve():this._initializationPromise;if(ve(a,this,"internal-error"),a.then(()=>{o||i(this.currentUser)}),typeof n=="function"){const l=e.addObserver(n,r,s);return()=>{o=!0,l()}}else{const l=e.addObserver(n);return()=>{o=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return ve(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=PS(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var s;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const n=await((s=this.heartbeatServiceProvider.getImmediate({optional:!0}))==null?void 0:s.getHeartbeatsHeader());n&&(e["X-Firebase-Client"]=n);const r=await this._getAppCheckToken();return r&&(e["X-Firebase-AppCheck"]=r),e}async _getAppCheckToken(){var n;if(Jn(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await((n=this.appCheckServiceProvider.getImmediate({optional:!0}))==null?void 0:n.getToken());return e!=null&&e.error&&BD(`Error while retrieving App Check token: ${e.error}`),e==null?void 0:e.token}}function Wa(t){return Ke(t)}class sE{constructor(e){this.auth=e,this.observer=null,this.addObserver=Sk(n=>this.observer=n)}get next(){return ve(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Qh={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function pj(t){Qh=t}function NS(t){return Qh.loadJS(t)}function mj(){return Qh.recaptchaEnterpriseScript}function gj(){return Qh.gapiScript}function yj(t){return`__${t}${Math.floor(Math.random()*1e6)}`}class _j{constructor(){this.enterprise=new vj}ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}class vj{ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}const wj="recaptcha-enterprise",kS="NO_RECAPTCHA";class Ej{constructor(e){this.type=wj,this.auth=Wa(e)}async verify(e="verify",n=!1){async function r(i){if(!n){if(i.tenantId==null&&i._agentRecaptchaConfig!=null)return i._agentRecaptchaConfig.siteKey;if(i.tenantId!=null&&i._tenantRecaptchaConfigs[i.tenantId]!==void 0)return i._tenantRecaptchaConfigs[i.tenantId].siteKey}return new Promise(async(o,a)=>{JD(i,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(l=>{if(l.recaptchaKey===void 0)a(new Error("recaptcha Enterprise site key undefined"));else{const d=new XD(l);return i.tenantId==null?i._agentRecaptchaConfig=d:i._tenantRecaptchaConfigs[i.tenantId]=d,o(d.siteKey)}}).catch(l=>{a(l)})})}function s(i,o,a){const l=window.grecaptcha;Zw(l)?l.enterprise.ready(()=>{l.enterprise.execute(i,{action:e}).then(d=>{o(d)}).catch(()=>{o(kS)})}):a(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new _j().execute("siteKey",{action:"verify"}):new Promise((i,o)=>{r(this.auth).then(a=>{if(!n&&Zw(window.grecaptcha))s(a,i,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let l=mj();l.length!==0&&(l+=a),NS(l).then(()=>{s(a,i,o)}).catch(d=>{o(d)})}}).catch(a=>{o(a)})})}}async function iE(t,e,n,r=!1,s=!1){const i=new Ej(t);let o;if(s)o=kS;else try{o=await i.verify(n)}catch{o=await i.verify(n,!0)}const a={...e};if(n==="mfaSmsEnrollment"||n==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in a){const l=a.phoneEnrollmentInfo.phoneNumber,d=a.phoneEnrollmentInfo.recaptchaToken;Object.assign(a,{phoneEnrollmentInfo:{phoneNumber:l,recaptchaToken:d,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in a){const l=a.phoneSignInInfo.recaptchaToken;Object.assign(a,{phoneSignInInfo:{recaptchaToken:l,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return a}return r?Object.assign(a,{captchaResp:o}):Object.assign(a,{captchaResponse:o}),Object.assign(a,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(a,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),a}async function oE(t,e,n,r,s){var i;if((i=t._getRecaptchaConfig())!=null&&i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const o=await iE(t,e,n,n==="getOobCode");return r(t,o)}else return r(t,e).catch(async o=>{if(o.code==="auth/missing-recaptcha-token"){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const a=await iE(t,e,n,n==="getOobCode");return r(t,a)}else return Promise.reject(o)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ij(t,e){const n=gi(t,"auth");if(n.isInitialized()){const s=n.getImmediate(),i=n.getOptions();if(cs(i,e??{}))return s;Ir(s,"already-initialized")}return n.initialize({options:e})}function Tj(t,e){const n=(e==null?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(es);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function xj(t,e,n){const r=Wa(t);ve(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const s=!1,i=DS(e),{host:o,port:a}=Sj(e),l=a===null?"":`:${a}`,d={url:`${i}//${o}${l}/`},h=Object.freeze({host:o,port:a,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:s})});if(!r._canInitEmulator){ve(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),ve(cs(d,r.config.emulator)&&cs(h,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=d,r.emulatorConfig=h,r.settings.appVerificationDisabledForTesting=!0,mi(o)?(Iy(`${i}//${o}${l}`),Ty("Auth",!0)):bj()}function DS(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function Sj(t){const e=DS(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(r);if(s){const i=s[1];return{host:i,port:aE(r.substr(i.length+1))}}else{const[i,o]=r.split(":");return{host:i,port:aE(o)}}}function aE(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function bj(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ny{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return Zr("not implemented")}_getIdTokenResponse(e){return Zr("not implemented")}_linkToIdToken(e,n){return Zr("not implemented")}_getReauthenticationResolver(e){return Zr("not implemented")}}async function Cj(t,e){return yi(t,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Aj(t,e){return Gh(t,"POST","/v1/accounts:signInWithPassword",Eo(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Rj(t,e){return Gh(t,"POST","/v1/accounts:signInWithEmailLink",Eo(t,e))}async function Pj(t,e){return Gh(t,"POST","/v1/accounts:signInWithEmailLink",Eo(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xc extends Ny{constructor(e,n,r,s=null){super("password",r),this._email=e,this._password=n,this._tenantId=s}static _fromEmailAndPassword(e,n){return new xc(e,n,"password")}static _fromEmailAndCode(e,n,r=null){return new xc(e,n,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;if(n!=null&&n.email&&(n!=null&&n.password)){if(n.signInMethod==="password")return this._fromEmailAndPassword(n.email,n.password);if(n.signInMethod==="emailLink")return this._fromEmailAndCode(n.email,n.password,n.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const n={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return oE(e,n,"signInWithPassword",Aj);case"emailLink":return Rj(e,{email:this._email,oobCode:this._password});default:Ir(e,"internal-error")}}async _linkToIdToken(e,n){switch(this.signInMethod){case"password":const r={idToken:n,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return oE(e,r,"signUpPassword",Cj);case"emailLink":return Pj(e,{idToken:n,email:this._email,oobCode:this._password});default:Ir(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ha(t,e){return Gh(t,"POST","/v1/accounts:signInWithIdp",Eo(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nj="http://localhost";class no extends Ny{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new no(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):Ir("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:s,...i}=n;if(!r||!s)return null;const o=new no(r,s);return o.idToken=i.idToken||void 0,o.accessToken=i.accessToken||void 0,o.secret=i.secret,o.nonce=i.nonce,o.pendingToken=i.pendingToken||null,o}_getIdTokenResponse(e){const n=this.buildRequest();return ha(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,ha(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,ha(e,n)}buildRequest(){const e={requestUri:Nj,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=zc(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kj(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function Dj(t){const e=Nl(kl(t)).link,n=e?Nl(kl(e)).deep_link_id:null,r=Nl(kl(t)).deep_link_id;return(r?Nl(kl(r)).link:null)||r||n||e||t}class ky{constructor(e){const n=Nl(kl(e)),r=n.apiKey??null,s=n.oobCode??null,i=kj(n.mode??null);ve(r&&s&&i,"argument-error"),this.apiKey=r,this.operation=i,this.code=s,this.continueUrl=n.continueUrl??null,this.languageCode=n.lang??null,this.tenantId=n.tenantId??null}static parseLink(e){const n=Dj(e);try{return new ky(n)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ka{constructor(){this.providerId=Ka.PROVIDER_ID}static credential(e,n){return xc._fromEmailAndPassword(e,n)}static credentialWithLink(e,n){const r=ky.parseLink(n);return ve(r,"argument-error"),xc._fromEmailAndCode(e,r.code,r.tenantId)}}Ka.PROVIDER_ID="password";Ka.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Ka.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jS{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hc extends jS{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Os extends Hc{constructor(){super("facebook.com")}static credential(e){return no._fromParams({providerId:Os.PROVIDER_ID,signInMethod:Os.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Os.credentialFromTaggedObject(e)}static credentialFromError(e){return Os.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Os.credential(e.oauthAccessToken)}catch{return null}}}Os.FACEBOOK_SIGN_IN_METHOD="facebook.com";Os.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vs extends Hc{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return no._fromParams({providerId:Vs.PROVIDER_ID,signInMethod:Vs.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return Vs.credentialFromTaggedObject(e)}static credentialFromError(e){return Vs.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return Vs.credential(n,r)}catch{return null}}}Vs.GOOGLE_SIGN_IN_METHOD="google.com";Vs.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ls extends Hc{constructor(){super("github.com")}static credential(e){return no._fromParams({providerId:Ls.PROVIDER_ID,signInMethod:Ls.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ls.credentialFromTaggedObject(e)}static credentialFromError(e){return Ls.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ls.credential(e.oauthAccessToken)}catch{return null}}}Ls.GITHUB_SIGN_IN_METHOD="github.com";Ls.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ms extends Hc{constructor(){super("twitter.com")}static credential(e,n){return no._fromParams({providerId:Ms.PROVIDER_ID,signInMethod:Ms.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return Ms.credentialFromTaggedObject(e)}static credentialFromError(e){return Ms.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return Ms.credential(n,r)}catch{return null}}}Ms.TWITTER_SIGN_IN_METHOD="twitter.com";Ms.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sa{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,s=!1){const i=await gr._fromIdTokenResponse(e,r,s),o=lE(r);return new Sa({user:i,providerId:o,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const s=lE(r);return new Sa({user:e,providerId:s,_tokenResponse:r,operationType:n})}}function lE(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class th extends cr{constructor(e,n,r,s){super(n.code,n.message),this.operationType=r,this.user=s,Object.setPrototypeOf(this,th.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,s){return new th(e,n,r,s)}}function OS(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?th._fromErrorAndOperation(t,i,e,r):i})}async function jj(t,e,n=!1){const r=await Tc(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return Sa._forOperation(t,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Oj(t,e,n=!1){const{auth:r}=t;if(Jn(r.app))return Promise.reject(ti(r));const s="reauthenticate";try{const i=await Tc(t,OS(r,s,e,t),n);ve(i.idToken,r,"internal-error");const o=Ry(i.idToken);ve(o,r,"internal-error");const{sub:a}=o;return ve(t.uid===a,r,"user-mismatch"),Sa._forOperation(t,s,i)}catch(i){throw(i==null?void 0:i.code)==="auth/user-not-found"&&Ir(r,"user-mismatch"),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function VS(t,e,n=!1){if(Jn(t.app))return Promise.reject(ti(t));const r="signIn",s=await OS(t,r,e),i=await Sa._fromIdTokenResponse(t,r,s);return n||await t._updateCurrentUser(i.user),i}async function Vj(t,e){return VS(Wa(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Lj(t){const e=Wa(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}function Mj(t,e,n){return Jn(t.app)?Promise.reject(ti(t)):Vj(Ke(t),Ka.credential(e,n)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&Lj(t),r})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fj(t,e){return Ke(t).setPersistence(e)}function Uj(t,e,n,r){return Ke(t).onIdTokenChanged(e,n,r)}function $j(t,e,n){return Ke(t).beforeAuthStateChanged(e,n)}function Dy(t,e,n,r){return Ke(t).onAuthStateChanged(e,n,r)}function Bj(t){return Ke(t).signOut()}const nh="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LS{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(nh,"1"),this.storage.removeItem(nh),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zj=1e3,qj=10;class MS extends LS{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=RS(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),s=this.localCache[n];r!==s&&e(n,s,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((o,a,l)=>{this.notifyListeners(o,l)});return}const r=e.key;n?this.detachListener():this.stopPolling();const s=()=>{const o=this.storage.getItem(r);!n&&this.localCache[r]===o||this.notifyListeners(r,o)},i=this.storage.getItem(r);lj()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,qj):s()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},zj)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}MS.type="LOCAL";const FS=MS;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class US extends LS{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}US.type="SESSION";const $S=US;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hj(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yh{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(s=>s.isListeningto(e));if(n)return n;const r=new Yh(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:s,data:i}=n.data,o=this.handlersMap[s];if(!(o!=null&&o.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:s});const a=Array.from(o).map(async d=>d(n.origin,i)),l=await Hj(a);n.ports[0].postMessage({status:"done",eventId:r,eventType:s,response:l})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Yh.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jy(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wj{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let i,o;return new Promise((a,l)=>{const d=jy("",20);s.port1.start();const h=setTimeout(()=>{l(new Error("unsupported_event"))},r);o={messageChannel:s,onMessage(f){const m=f;if(m.data.eventId===d)switch(m.data.status){case"ack":clearTimeout(h),i=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),a(m.data.response);break;default:clearTimeout(h),clearTimeout(i),l(new Error("invalid_response"));break}}},this.handlers.add(o),s.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:d,data:n},[s.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qr(){return window}function Kj(t){qr().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function BS(){return typeof qr().WorkerGlobalScope<"u"&&typeof qr().importScripts=="function"}async function Gj(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function Qj(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)==null?void 0:t.controller)||null}function Yj(){return BS()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zS="firebaseLocalStorageDb",Xj=1,rh="firebaseLocalStorage",qS="fbase_key";class Wc{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function Xh(t,e){return t.transaction([rh],e?"readwrite":"readonly").objectStore(rh)}function Jj(){const t=indexedDB.deleteDatabase(zS);return new Wc(t).toPromise()}function Wm(){const t=indexedDB.open(zS,Xj);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(rh,{keyPath:qS})}catch(s){n(s)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(rh)?e(r):(r.close(),await Jj(),e(await Wm()))})})}async function cE(t,e,n){const r=Xh(t,!0).put({[qS]:e,value:n});return new Wc(r).toPromise()}async function Zj(t,e){const n=Xh(t,!1).get(e),r=await new Wc(n).toPromise();return r===void 0?null:r.value}function uE(t,e){const n=Xh(t,!0).delete(e);return new Wc(n).toPromise()}const e2=800,t2=3;class HS{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Wm(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>t2)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return BS()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Yh._getInstance(Yj()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var n,r;if(this.activeServiceWorker=await Gj(),!this.activeServiceWorker)return;this.sender=new Wj(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&(n=e[0])!=null&&n.fulfilled&&(r=e[0])!=null&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||Qj()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Wm();return await cE(e,nh,"1"),await uE(e,nh),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>cE(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>Zj(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>uE(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const i=Xh(s,!1).getAll();return new Wc(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;if(e.length!==0)for(const{fbase_key:s,value:i}of e)r.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(i)&&(this.notifyListeners(s,i),n.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!r.has(s)&&(this.notifyListeners(s,null),n.push(s));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),e2)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}HS.type="LOCAL";const n2=HS;new qc(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function r2(t,e){return e?es(e):(ve(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oy extends Ny{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return ha(e,this._buildIdpRequest())}_linkToIdToken(e,n){return ha(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return ha(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function s2(t){return VS(t.auth,new Oy(t),t.bypassAuthState)}function i2(t){const{auth:e,user:n}=t;return ve(n,e,"internal-error"),Oj(n,new Oy(t),t.bypassAuthState)}async function o2(t){const{auth:e,user:n}=t;return ve(n,e,"internal-error"),jj(n,new Oy(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WS{constructor(e,n,r,s,i=!1){this.auth=e,this.resolver=r,this.user=s,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:s,tenantId:i,error:o,type:a}=e;if(o){this.reject(o);return}const l={auth:this.auth,requestUri:n,sessionId:r,tenantId:i||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(l))}catch(d){this.reject(d)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return s2;case"linkViaPopup":case"linkViaRedirect":return o2;case"reauthViaPopup":case"reauthViaRedirect":return i2;default:Ir(this.auth,"internal-error")}}resolve(e){ds(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){ds(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const a2=new qc(2e3,1e4);class na extends WS{constructor(e,n,r,s,i){super(e,n,s,i),this.provider=r,this.authWindow=null,this.pollId=null,na.currentPopupAction&&na.currentPopupAction.cancel(),na.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return ve(e,this.auth,"internal-error"),e}async onExecution(){ds(this.filter.length===1,"Popup operations only handle one event");const e=jy();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(zr(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)==null?void 0:e.associatedEvent)||null}cancel(){this.reject(zr(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,na.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,r;if((r=(n=this.authWindow)==null?void 0:n.window)!=null&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(zr(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,a2.get())};e()}}na.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const l2="pendingRedirect",ud=new Map;class c2 extends WS{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=ud.get(this.auth._key());if(!e){try{const r=await u2(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}ud.set(this.auth._key(),e)}return this.bypassAuthState||ud.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function u2(t,e){const n=f2(e),r=h2(t);if(!await r._isAvailable())return!1;const s=await r._get(n)==="true";return await r._remove(n),s}function d2(t,e){ud.set(t._key(),e)}function h2(t){return es(t._redirectPersistence)}function f2(t){return cd(l2,t.config.apiKey,t.name)}async function p2(t,e,n=!1){if(Jn(t.app))return Promise.reject(ti(t));const r=Wa(t),s=r2(r,e),o=await new c2(r,s,n).execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const m2=10*60*1e3;class g2{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!y2(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!KS(e)){const s=((r=e.error.code)==null?void 0:r.split("auth/")[1])||"internal-error";n.onError(zr(this.auth,s))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=m2&&this.cachedEventUids.clear(),this.cachedEventUids.has(dE(e))}saveEventToCache(e){this.cachedEventUids.add(dE(e)),this.lastProcessedEventTime=Date.now()}}function dE(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function KS({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function y2(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return KS(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _2(t,e={}){return yi(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const v2=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,w2=/^https?/;async function E2(t){if(t.config.emulator)return;const{authorizedDomains:e}=await _2(t);for(const n of e)try{if(I2(n))return}catch{}Ir(t,"unauthorized-domain")}function I2(t){const e=qm(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&o.hostname===r}if(!w2.test(n))return!1;if(v2.test(t))return r===t;const s=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const T2=new qc(3e4,6e4);function hE(){const t=qr().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function x2(t){return new Promise((e,n)=>{var s,i,o;function r(){hE(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{hE(),n(zr(t,"network-request-failed"))},timeout:T2.get()})}if((i=(s=qr().gapi)==null?void 0:s.iframes)!=null&&i.Iframe)e(gapi.iframes.getContext());else if((o=qr().gapi)!=null&&o.load)r();else{const a=yj("iframefcb");return qr()[a]=()=>{gapi.load?r():n(zr(t,"network-request-failed"))},NS(`${gj()}?onload=${a}`).catch(l=>n(l))}}).catch(e=>{throw dd=null,e})}let dd=null;function S2(t){return dd=dd||x2(t),dd}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const b2=new qc(5e3,15e3),C2="__/auth/iframe",A2="emulator/auth/iframe",R2={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},P2=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function N2(t){const e=t.config;ve(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?Ay(e,A2):`https://${t.config.authDomain}/${C2}`,r={apiKey:e.apiKey,appName:t.name,v:wo},s=P2.get(t.config.apiHost);s&&(r.eid=s);const i=t._getFrameworks();return i.length&&(r.fw=i.join(",")),`${n}?${zc(r).slice(1)}`}async function k2(t){const e=await S2(t),n=qr().gapi;return ve(n,t,"internal-error"),e.open({where:document.body,url:N2(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:R2,dontclear:!0},r=>new Promise(async(s,i)=>{await r.restyle({setHideOnLeave:!1});const o=zr(t,"network-request-failed"),a=qr().setTimeout(()=>{i(o)},b2.get());function l(){qr().clearTimeout(a),s(r)}r.ping(l).then(l,()=>{i(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const D2={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},j2=500,O2=600,V2="_blank",L2="http://localhost";class fE{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function M2(t,e,n,r=j2,s=O2){const i=Math.max((window.screen.availHeight-s)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let a="";const l={...D2,width:r.toString(),height:s.toString(),top:i,left:o},d=Vt().toLowerCase();n&&(a=xS(d)?V2:n),IS(d)&&(e=e||L2,l.scrollbars="yes");const h=Object.entries(l).reduce((m,[_,A])=>`${m}${_}=${A},`,"");if(aj(d)&&a!=="_self")return F2(e||"",a),new fE(null);const f=window.open(e||"",a,h);ve(f,t,"popup-blocked");try{f.focus()}catch{}return new fE(f)}function F2(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const U2="__/auth/handler",$2="emulator/auth/handler",B2=encodeURIComponent("fac");async function pE(t,e,n,r,s,i){ve(t.config.authDomain,t,"auth-domain-config-required"),ve(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:wo,eventId:s};if(e instanceof jS){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",xk(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[h,f]of Object.entries({}))o[h]=f}if(e instanceof Hc){const h=e.getScopes().filter(f=>f!=="");h.length>0&&(o.scopes=h.join(","))}t.tenantId&&(o.tid=t.tenantId);const a=o;for(const h of Object.keys(a))a[h]===void 0&&delete a[h];const l=await t._getAppCheckToken(),d=l?`#${B2}=${encodeURIComponent(l)}`:"";return`${z2(t)}?${zc(a).slice(1)}${d}`}function z2({config:t}){return t.emulator?Ay(t,$2):`https://${t.authDomain}/${U2}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Tp="webStorageSupport";class q2{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=$S,this._completeRedirectFn=p2,this._overrideRedirectResult=d2}async _openPopup(e,n,r,s){var o;ds((o=this.eventManagers[e._key()])==null?void 0:o.manager,"_initialize() not called before _openPopup()");const i=await pE(e,n,r,qm(),s);return M2(e,i,jy())}async _openRedirect(e,n,r,s){await this._originValidation(e);const i=await pE(e,n,r,qm(),s);return Kj(i),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:s,promise:i}=this.eventManagers[n];return s?Promise.resolve(s):(ds(i,"If manager is not set, promise should be"),i)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await k2(e),r=new g2(e);return n.register("authEvent",s=>(ve(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:r.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(Tp,{type:Tp},s=>{var o;const i=(o=s==null?void 0:s[0])==null?void 0:o[Tp];i!==void 0&&n(!!i),Ir(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=E2(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return RS()||TS()||Py()}}const H2=q2;var mE="@firebase/auth",gE="1.11.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W2{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)==null?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){ve(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function K2(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function G2(t){Er(new ar("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=r.options;ve(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const l={apiKey:o,authDomain:a,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:PS(t)},d=new fj(r,s,i,l);return Tj(d,n),d},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),Er(new ar("auth-internal",e=>{const n=Wa(e.getProvider("auth").getImmediate());return(r=>new W2(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),kn(mE,gE,K2(t)),kn(mE,gE,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Q2=5*60,Y2=nS("authIdTokenMaxAge")||Q2;let yE=null;const X2=t=>async e=>{const n=e&&await e.getIdTokenResult(),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>Y2)return;const s=n==null?void 0:n.token;yE!==s&&(yE=s,await fetch(t,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function GS(t=Kh()){const e=gi(t,"auth");if(e.isInitialized())return e.getImmediate();const n=Ij(t,{popupRedirectResolver:H2,persistence:[n2,FS,$S]}),r=nS("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(r,location.origin);if(location.origin===i.origin){const o=X2(i.toString());$j(n,o,()=>o(n.currentUser)),Uj(n,a=>o(a))}}const s=Z0("auth");return s&&xj(n,`http://${s}`),n}function J2(){var t;return((t=document.getElementsByTagName("head"))==null?void 0:t[0])??document}pj({loadJS(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=s=>{const i=zr("internal-error");i.customData=s,n(i)},r.type="text/javascript",r.charset="UTF-8",J2().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});G2("Browser");var _E=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var ni,QS;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(E,v){function y(){}y.prototype=v.prototype,E.F=v.prototype,E.prototype=new y,E.prototype.constructor=E,E.D=function(N,D,j){for(var k=Array(arguments.length-2),G=2;G<arguments.length;G++)k[G-2]=arguments[G];return v.prototype[D].apply(N,k)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(r,n),r.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(E,v,y){y||(y=0);const N=Array(16);if(typeof v=="string")for(var D=0;D<16;++D)N[D]=v.charCodeAt(y++)|v.charCodeAt(y++)<<8|v.charCodeAt(y++)<<16|v.charCodeAt(y++)<<24;else for(D=0;D<16;++D)N[D]=v[y++]|v[y++]<<8|v[y++]<<16|v[y++]<<24;v=E.g[0],y=E.g[1],D=E.g[2];let j=E.g[3],k;k=v+(j^y&(D^j))+N[0]+3614090360&4294967295,v=y+(k<<7&4294967295|k>>>25),k=j+(D^v&(y^D))+N[1]+3905402710&4294967295,j=v+(k<<12&4294967295|k>>>20),k=D+(y^j&(v^y))+N[2]+606105819&4294967295,D=j+(k<<17&4294967295|k>>>15),k=y+(v^D&(j^v))+N[3]+3250441966&4294967295,y=D+(k<<22&4294967295|k>>>10),k=v+(j^y&(D^j))+N[4]+4118548399&4294967295,v=y+(k<<7&4294967295|k>>>25),k=j+(D^v&(y^D))+N[5]+1200080426&4294967295,j=v+(k<<12&4294967295|k>>>20),k=D+(y^j&(v^y))+N[6]+2821735955&4294967295,D=j+(k<<17&4294967295|k>>>15),k=y+(v^D&(j^v))+N[7]+4249261313&4294967295,y=D+(k<<22&4294967295|k>>>10),k=v+(j^y&(D^j))+N[8]+1770035416&4294967295,v=y+(k<<7&4294967295|k>>>25),k=j+(D^v&(y^D))+N[9]+2336552879&4294967295,j=v+(k<<12&4294967295|k>>>20),k=D+(y^j&(v^y))+N[10]+4294925233&4294967295,D=j+(k<<17&4294967295|k>>>15),k=y+(v^D&(j^v))+N[11]+2304563134&4294967295,y=D+(k<<22&4294967295|k>>>10),k=v+(j^y&(D^j))+N[12]+1804603682&4294967295,v=y+(k<<7&4294967295|k>>>25),k=j+(D^v&(y^D))+N[13]+4254626195&4294967295,j=v+(k<<12&4294967295|k>>>20),k=D+(y^j&(v^y))+N[14]+2792965006&4294967295,D=j+(k<<17&4294967295|k>>>15),k=y+(v^D&(j^v))+N[15]+1236535329&4294967295,y=D+(k<<22&4294967295|k>>>10),k=v+(D^j&(y^D))+N[1]+4129170786&4294967295,v=y+(k<<5&4294967295|k>>>27),k=j+(y^D&(v^y))+N[6]+3225465664&4294967295,j=v+(k<<9&4294967295|k>>>23),k=D+(v^y&(j^v))+N[11]+643717713&4294967295,D=j+(k<<14&4294967295|k>>>18),k=y+(j^v&(D^j))+N[0]+3921069994&4294967295,y=D+(k<<20&4294967295|k>>>12),k=v+(D^j&(y^D))+N[5]+3593408605&4294967295,v=y+(k<<5&4294967295|k>>>27),k=j+(y^D&(v^y))+N[10]+38016083&4294967295,j=v+(k<<9&4294967295|k>>>23),k=D+(v^y&(j^v))+N[15]+3634488961&4294967295,D=j+(k<<14&4294967295|k>>>18),k=y+(j^v&(D^j))+N[4]+3889429448&4294967295,y=D+(k<<20&4294967295|k>>>12),k=v+(D^j&(y^D))+N[9]+568446438&4294967295,v=y+(k<<5&4294967295|k>>>27),k=j+(y^D&(v^y))+N[14]+3275163606&4294967295,j=v+(k<<9&4294967295|k>>>23),k=D+(v^y&(j^v))+N[3]+4107603335&4294967295,D=j+(k<<14&4294967295|k>>>18),k=y+(j^v&(D^j))+N[8]+1163531501&4294967295,y=D+(k<<20&4294967295|k>>>12),k=v+(D^j&(y^D))+N[13]+2850285829&4294967295,v=y+(k<<5&4294967295|k>>>27),k=j+(y^D&(v^y))+N[2]+4243563512&4294967295,j=v+(k<<9&4294967295|k>>>23),k=D+(v^y&(j^v))+N[7]+1735328473&4294967295,D=j+(k<<14&4294967295|k>>>18),k=y+(j^v&(D^j))+N[12]+2368359562&4294967295,y=D+(k<<20&4294967295|k>>>12),k=v+(y^D^j)+N[5]+4294588738&4294967295,v=y+(k<<4&4294967295|k>>>28),k=j+(v^y^D)+N[8]+2272392833&4294967295,j=v+(k<<11&4294967295|k>>>21),k=D+(j^v^y)+N[11]+1839030562&4294967295,D=j+(k<<16&4294967295|k>>>16),k=y+(D^j^v)+N[14]+4259657740&4294967295,y=D+(k<<23&4294967295|k>>>9),k=v+(y^D^j)+N[1]+2763975236&4294967295,v=y+(k<<4&4294967295|k>>>28),k=j+(v^y^D)+N[4]+1272893353&4294967295,j=v+(k<<11&4294967295|k>>>21),k=D+(j^v^y)+N[7]+4139469664&4294967295,D=j+(k<<16&4294967295|k>>>16),k=y+(D^j^v)+N[10]+3200236656&4294967295,y=D+(k<<23&4294967295|k>>>9),k=v+(y^D^j)+N[13]+681279174&4294967295,v=y+(k<<4&4294967295|k>>>28),k=j+(v^y^D)+N[0]+3936430074&4294967295,j=v+(k<<11&4294967295|k>>>21),k=D+(j^v^y)+N[3]+3572445317&4294967295,D=j+(k<<16&4294967295|k>>>16),k=y+(D^j^v)+N[6]+76029189&4294967295,y=D+(k<<23&4294967295|k>>>9),k=v+(y^D^j)+N[9]+3654602809&4294967295,v=y+(k<<4&4294967295|k>>>28),k=j+(v^y^D)+N[12]+3873151461&4294967295,j=v+(k<<11&4294967295|k>>>21),k=D+(j^v^y)+N[15]+530742520&4294967295,D=j+(k<<16&4294967295|k>>>16),k=y+(D^j^v)+N[2]+3299628645&4294967295,y=D+(k<<23&4294967295|k>>>9),k=v+(D^(y|~j))+N[0]+4096336452&4294967295,v=y+(k<<6&4294967295|k>>>26),k=j+(y^(v|~D))+N[7]+1126891415&4294967295,j=v+(k<<10&4294967295|k>>>22),k=D+(v^(j|~y))+N[14]+2878612391&4294967295,D=j+(k<<15&4294967295|k>>>17),k=y+(j^(D|~v))+N[5]+4237533241&4294967295,y=D+(k<<21&4294967295|k>>>11),k=v+(D^(y|~j))+N[12]+1700485571&4294967295,v=y+(k<<6&4294967295|k>>>26),k=j+(y^(v|~D))+N[3]+2399980690&4294967295,j=v+(k<<10&4294967295|k>>>22),k=D+(v^(j|~y))+N[10]+4293915773&4294967295,D=j+(k<<15&4294967295|k>>>17),k=y+(j^(D|~v))+N[1]+2240044497&4294967295,y=D+(k<<21&4294967295|k>>>11),k=v+(D^(y|~j))+N[8]+1873313359&4294967295,v=y+(k<<6&4294967295|k>>>26),k=j+(y^(v|~D))+N[15]+4264355552&4294967295,j=v+(k<<10&4294967295|k>>>22),k=D+(v^(j|~y))+N[6]+2734768916&4294967295,D=j+(k<<15&4294967295|k>>>17),k=y+(j^(D|~v))+N[13]+1309151649&4294967295,y=D+(k<<21&4294967295|k>>>11),k=v+(D^(y|~j))+N[4]+4149444226&4294967295,v=y+(k<<6&4294967295|k>>>26),k=j+(y^(v|~D))+N[11]+3174756917&4294967295,j=v+(k<<10&4294967295|k>>>22),k=D+(v^(j|~y))+N[2]+718787259&4294967295,D=j+(k<<15&4294967295|k>>>17),k=y+(j^(D|~v))+N[9]+3951481745&4294967295,E.g[0]=E.g[0]+v&4294967295,E.g[1]=E.g[1]+(D+(k<<21&4294967295|k>>>11))&4294967295,E.g[2]=E.g[2]+D&4294967295,E.g[3]=E.g[3]+j&4294967295}r.prototype.v=function(E,v){v===void 0&&(v=E.length);const y=v-this.blockSize,N=this.C;let D=this.h,j=0;for(;j<v;){if(D==0)for(;j<=y;)s(this,E,j),j+=this.blockSize;if(typeof E=="string"){for(;j<v;)if(N[D++]=E.charCodeAt(j++),D==this.blockSize){s(this,N),D=0;break}}else for(;j<v;)if(N[D++]=E[j++],D==this.blockSize){s(this,N),D=0;break}}this.h=D,this.o+=v},r.prototype.A=function(){var E=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);E[0]=128;for(var v=1;v<E.length-8;++v)E[v]=0;v=this.o*8;for(var y=E.length-8;y<E.length;++y)E[y]=v&255,v/=256;for(this.v(E),E=Array(16),v=0,y=0;y<4;++y)for(let N=0;N<32;N+=8)E[v++]=this.g[y]>>>N&255;return E};function i(E,v){var y=a;return Object.prototype.hasOwnProperty.call(y,E)?y[E]:y[E]=v(E)}function o(E,v){this.h=v;const y=[];let N=!0;for(let D=E.length-1;D>=0;D--){const j=E[D]|0;N&&j==v||(y[D]=j,N=!1)}this.g=y}var a={};function l(E){return-128<=E&&E<128?i(E,function(v){return new o([v|0],v<0?-1:0)}):new o([E|0],E<0?-1:0)}function d(E){if(isNaN(E)||!isFinite(E))return f;if(E<0)return C(d(-E));const v=[];let y=1;for(let N=0;E>=y;N++)v[N]=E/y|0,y*=4294967296;return new o(v,0)}function h(E,v){if(E.length==0)throw Error("number format error: empty string");if(v=v||10,v<2||36<v)throw Error("radix out of range: "+v);if(E.charAt(0)=="-")return C(h(E.substring(1),v));if(E.indexOf("-")>=0)throw Error('number format error: interior "-" character');const y=d(Math.pow(v,8));let N=f;for(let j=0;j<E.length;j+=8){var D=Math.min(8,E.length-j);const k=parseInt(E.substring(j,j+D),v);D<8?(D=d(Math.pow(v,D)),N=N.j(D).add(d(k))):(N=N.j(y),N=N.add(d(k)))}return N}var f=l(0),m=l(1),_=l(16777216);t=o.prototype,t.m=function(){if(R(this))return-C(this).m();let E=0,v=1;for(let y=0;y<this.g.length;y++){const N=this.i(y);E+=(N>=0?N:4294967296+N)*v,v*=4294967296}return E},t.toString=function(E){if(E=E||10,E<2||36<E)throw Error("radix out of range: "+E);if(A(this))return"0";if(R(this))return"-"+C(this).toString(E);const v=d(Math.pow(E,6));var y=this;let N="";for(;;){const D=x(y,v).g;y=w(y,D.j(v));let j=((y.g.length>0?y.g[0]:y.h)>>>0).toString(E);if(y=D,A(y))return j+N;for(;j.length<6;)j="0"+j;N=j+N}},t.i=function(E){return E<0?0:E<this.g.length?this.g[E]:this.h};function A(E){if(E.h!=0)return!1;for(let v=0;v<E.g.length;v++)if(E.g[v]!=0)return!1;return!0}function R(E){return E.h==-1}t.l=function(E){return E=w(this,E),R(E)?-1:A(E)?0:1};function C(E){const v=E.g.length,y=[];for(let N=0;N<v;N++)y[N]=~E.g[N];return new o(y,~E.h).add(m)}t.abs=function(){return R(this)?C(this):this},t.add=function(E){const v=Math.max(this.g.length,E.g.length),y=[];let N=0;for(let D=0;D<=v;D++){let j=N+(this.i(D)&65535)+(E.i(D)&65535),k=(j>>>16)+(this.i(D)>>>16)+(E.i(D)>>>16);N=k>>>16,j&=65535,k&=65535,y[D]=k<<16|j}return new o(y,y[y.length-1]&-2147483648?-1:0)};function w(E,v){return E.add(C(v))}t.j=function(E){if(A(this)||A(E))return f;if(R(this))return R(E)?C(this).j(C(E)):C(C(this).j(E));if(R(E))return C(this.j(C(E)));if(this.l(_)<0&&E.l(_)<0)return d(this.m()*E.m());const v=this.g.length+E.g.length,y=[];for(var N=0;N<2*v;N++)y[N]=0;for(N=0;N<this.g.length;N++)for(let D=0;D<E.g.length;D++){const j=this.i(N)>>>16,k=this.i(N)&65535,G=E.i(D)>>>16,We=E.i(D)&65535;y[2*N+2*D]+=k*We,I(y,2*N+2*D),y[2*N+2*D+1]+=j*We,I(y,2*N+2*D+1),y[2*N+2*D+1]+=k*G,I(y,2*N+2*D+1),y[2*N+2*D+2]+=j*G,I(y,2*N+2*D+2)}for(E=0;E<v;E++)y[E]=y[2*E+1]<<16|y[2*E];for(E=v;E<2*v;E++)y[E]=0;return new o(y,0)};function I(E,v){for(;(E[v]&65535)!=E[v];)E[v+1]+=E[v]>>>16,E[v]&=65535,v++}function b(E,v){this.g=E,this.h=v}function x(E,v){if(A(v))throw Error("division by zero");if(A(E))return new b(f,f);if(R(E))return v=x(C(E),v),new b(C(v.g),C(v.h));if(R(v))return v=x(E,C(v)),new b(C(v.g),v.h);if(E.g.length>30){if(R(E)||R(v))throw Error("slowDivide_ only works with positive integers.");for(var y=m,N=v;N.l(E)<=0;)y=L(y),N=L(N);var D=$(y,1),j=$(N,1);for(N=$(N,2),y=$(y,2);!A(N);){var k=j.add(N);k.l(E)<=0&&(D=D.add(y),j=k),N=$(N,1),y=$(y,1)}return v=w(E,D.j(v)),new b(D,v)}for(D=f;E.l(v)>=0;){for(y=Math.max(1,Math.floor(E.m()/v.m())),N=Math.ceil(Math.log(y)/Math.LN2),N=N<=48?1:Math.pow(2,N-48),j=d(y),k=j.j(v);R(k)||k.l(E)>0;)y-=N,j=d(y),k=j.j(v);A(j)&&(j=m),D=D.add(j),E=w(E,k)}return new b(D,E)}t.B=function(E){return x(this,E).h},t.and=function(E){const v=Math.max(this.g.length,E.g.length),y=[];for(let N=0;N<v;N++)y[N]=this.i(N)&E.i(N);return new o(y,this.h&E.h)},t.or=function(E){const v=Math.max(this.g.length,E.g.length),y=[];for(let N=0;N<v;N++)y[N]=this.i(N)|E.i(N);return new o(y,this.h|E.h)},t.xor=function(E){const v=Math.max(this.g.length,E.g.length),y=[];for(let N=0;N<v;N++)y[N]=this.i(N)^E.i(N);return new o(y,this.h^E.h)};function L(E){const v=E.g.length+1,y=[];for(let N=0;N<v;N++)y[N]=E.i(N)<<1|E.i(N-1)>>>31;return new o(y,E.h)}function $(E,v){const y=v>>5;v%=32;const N=E.g.length-y,D=[];for(let j=0;j<N;j++)D[j]=v>0?E.i(j+y)>>>v|E.i(j+y+1)<<32-v:E.i(j+y);return new o(D,E.h)}r.prototype.digest=r.prototype.A,r.prototype.reset=r.prototype.u,r.prototype.update=r.prototype.v,QS=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.B,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=d,o.fromString=h,ni=o}).apply(typeof _E<"u"?_E:typeof self<"u"?self:typeof window<"u"?window:{});var Vu=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var YS,Dl,XS,hd,Km,JS,ZS,eb;(function(){var t,e=Object.defineProperty;function n(c){c=[typeof globalThis=="object"&&globalThis,c,typeof window=="object"&&window,typeof self=="object"&&self,typeof Vu=="object"&&Vu];for(var p=0;p<c.length;++p){var g=c[p];if(g&&g.Math==Math)return g}throw Error("Cannot find global object")}var r=n(this);function s(c,p){if(p)e:{var g=r;c=c.split(".");for(var S=0;S<c.length-1;S++){var V=c[S];if(!(V in g))break e;g=g[V]}c=c[c.length-1],S=g[c],p=p(S),p!=S&&p!=null&&e(g,c,{configurable:!0,writable:!0,value:p})}}s("Symbol.dispose",function(c){return c||Symbol("Symbol.dispose")}),s("Array.prototype.values",function(c){return c||function(){return this[Symbol.iterator]()}}),s("Object.entries",function(c){return c||function(p){var g=[],S;for(S in p)Object.prototype.hasOwnProperty.call(p,S)&&g.push([S,p[S]]);return g}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var i=i||{},o=this||self;function a(c){var p=typeof c;return p=="object"&&c!=null||p=="function"}function l(c,p,g){return c.call.apply(c.bind,arguments)}function d(c,p,g){return d=l,d.apply(null,arguments)}function h(c,p){var g=Array.prototype.slice.call(arguments,1);return function(){var S=g.slice();return S.push.apply(S,arguments),c.apply(this,S)}}function f(c,p){function g(){}g.prototype=p.prototype,c.Z=p.prototype,c.prototype=new g,c.prototype.constructor=c,c.Ob=function(S,V,F){for(var J=Array(arguments.length-2),Re=2;Re<arguments.length;Re++)J[Re-2]=arguments[Re];return p.prototype[V].apply(S,J)}}var m=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?c=>c&&AsyncContext.Snapshot.wrap(c):c=>c;function _(c){const p=c.length;if(p>0){const g=Array(p);for(let S=0;S<p;S++)g[S]=c[S];return g}return[]}function A(c,p){for(let S=1;S<arguments.length;S++){const V=arguments[S];var g=typeof V;if(g=g!="object"?g:V?Array.isArray(V)?"array":g:"null",g=="array"||g=="object"&&typeof V.length=="number"){g=c.length||0;const F=V.length||0;c.length=g+F;for(let J=0;J<F;J++)c[g+J]=V[J]}else c.push(V)}}class R{constructor(p,g){this.i=p,this.j=g,this.h=0,this.g=null}get(){let p;return this.h>0?(this.h--,p=this.g,this.g=p.next,p.next=null):p=this.i(),p}}function C(c){o.setTimeout(()=>{throw c},0)}function w(){var c=E;let p=null;return c.g&&(p=c.g,c.g=c.g.next,c.g||(c.h=null),p.next=null),p}class I{constructor(){this.h=this.g=null}add(p,g){const S=b.get();S.set(p,g),this.h?this.h.next=S:this.g=S,this.h=S}}var b=new R(()=>new x,c=>c.reset());class x{constructor(){this.next=this.g=this.h=null}set(p,g){this.h=p,this.g=g,this.next=null}reset(){this.next=this.g=this.h=null}}let L,$=!1,E=new I,v=()=>{const c=Promise.resolve(void 0);L=()=>{c.then(y)}};function y(){for(var c;c=w();){try{c.h.call(c.g)}catch(g){C(g)}var p=b;p.j(c),p.h<100&&(p.h++,c.next=p.g,p.g=c)}$=!1}function N(){this.u=this.u,this.C=this.C}N.prototype.u=!1,N.prototype.dispose=function(){this.u||(this.u=!0,this.N())},N.prototype[Symbol.dispose]=function(){this.dispose()},N.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function D(c,p){this.type=c,this.g=this.target=p,this.defaultPrevented=!1}D.prototype.h=function(){this.defaultPrevented=!0};var j=function(){if(!o.addEventListener||!Object.defineProperty)return!1;var c=!1,p=Object.defineProperty({},"passive",{get:function(){c=!0}});try{const g=()=>{};o.addEventListener("test",g,p),o.removeEventListener("test",g,p)}catch{}return c}();function k(c){return/^[\s\xa0]*$/.test(c)}function G(c,p){D.call(this,c?c.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,c&&this.init(c,p)}f(G,D),G.prototype.init=function(c,p){const g=this.type=c.type,S=c.changedTouches&&c.changedTouches.length?c.changedTouches[0]:null;this.target=c.target||c.srcElement,this.g=p,p=c.relatedTarget,p||(g=="mouseover"?p=c.fromElement:g=="mouseout"&&(p=c.toElement)),this.relatedTarget=p,S?(this.clientX=S.clientX!==void 0?S.clientX:S.pageX,this.clientY=S.clientY!==void 0?S.clientY:S.pageY,this.screenX=S.screenX||0,this.screenY=S.screenY||0):(this.clientX=c.clientX!==void 0?c.clientX:c.pageX,this.clientY=c.clientY!==void 0?c.clientY:c.pageY,this.screenX=c.screenX||0,this.screenY=c.screenY||0),this.button=c.button,this.key=c.key||"",this.ctrlKey=c.ctrlKey,this.altKey=c.altKey,this.shiftKey=c.shiftKey,this.metaKey=c.metaKey,this.pointerId=c.pointerId||0,this.pointerType=c.pointerType,this.state=c.state,this.i=c,c.defaultPrevented&&G.Z.h.call(this)},G.prototype.h=function(){G.Z.h.call(this);const c=this.i;c.preventDefault?c.preventDefault():c.returnValue=!1};var We="closure_listenable_"+(Math.random()*1e6|0),Mt=0;function un(c,p,g,S,V){this.listener=c,this.proxy=null,this.src=p,this.type=g,this.capture=!!S,this.ha=V,this.key=++Mt,this.da=this.fa=!1}function Z(c){c.da=!0,c.listener=null,c.proxy=null,c.src=null,c.ha=null}function de(c,p,g){for(const S in c)p.call(g,c[S],S,c)}function pe(c,p){for(const g in c)p.call(void 0,c[g],g,c)}function Pe(c){const p={};for(const g in c)p[g]=c[g];return p}const Ge="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Pt(c,p){let g,S;for(let V=1;V<arguments.length;V++){S=arguments[V];for(g in S)c[g]=S[g];for(let F=0;F<Ge.length;F++)g=Ge[F],Object.prototype.hasOwnProperty.call(S,g)&&(c[g]=S[g])}}function B(c){this.src=c,this.g={},this.h=0}B.prototype.add=function(c,p,g,S,V){const F=c.toString();c=this.g[F],c||(c=this.g[F]=[],this.h++);const J=ce(c,p,S,V);return J>-1?(p=c[J],g||(p.fa=!1)):(p=new un(p,this.src,F,!!S,V),p.fa=g,c.push(p)),p};function re(c,p){const g=p.type;if(g in c.g){var S=c.g[g],V=Array.prototype.indexOf.call(S,p,void 0),F;(F=V>=0)&&Array.prototype.splice.call(S,V,1),F&&(Z(p),c.g[g].length==0&&(delete c.g[g],c.h--))}}function ce(c,p,g,S){for(let V=0;V<c.length;++V){const F=c[V];if(!F.da&&F.listener==p&&F.capture==!!g&&F.ha==S)return V}return-1}var xe="closure_lm_"+(Math.random()*1e6|0),Se={};function De(c,p,g,S,V){if(Array.isArray(p)){for(let F=0;F<p.length;F++)De(c,p[F],g,S,V);return null}return g=ee(g),c&&c[We]?c.J(p,g,a(S)?!!S.capture:!1,V):we(c,p,g,!1,S,V)}function we(c,p,g,S,V,F){if(!p)throw Error("Invalid event type");const J=a(V)?!!V.capture:!!V;let Re=Tt(c);if(Re||(c[xe]=Re=new B(c)),g=Re.add(p,g,S,J,F),g.proxy)return g;if(S=Ze(),g.proxy=S,S.src=c,S.listener=g,c.addEventListener)j||(V=J),V===void 0&&(V=!1),c.addEventListener(p.toString(),S,V);else if(c.attachEvent)c.attachEvent(Ne(p.toString()),S);else if(c.addListener&&c.removeListener)c.addListener(S);else throw Error("addEventListener and attachEvent are unavailable.");return g}function Ze(){function c(g){return p.call(c.src,c.listener,g)}const p=et;return c}function Ie(c,p,g,S,V){if(Array.isArray(p))for(var F=0;F<p.length;F++)Ie(c,p[F],g,S,V);else S=a(S)?!!S.capture:!!S,g=ee(g),c&&c[We]?(c=c.i,F=String(p).toString(),F in c.g&&(p=c.g[F],g=ce(p,g,S,V),g>-1&&(Z(p[g]),Array.prototype.splice.call(p,g,1),p.length==0&&(delete c.g[F],c.h--)))):c&&(c=Tt(c))&&(p=c.g[p.toString()],c=-1,p&&(c=ce(p,g,S,V)),(g=c>-1?p[c]:null)&&se(g))}function se(c){if(typeof c!="number"&&c&&!c.da){var p=c.src;if(p&&p[We])re(p.i,c);else{var g=c.type,S=c.proxy;p.removeEventListener?p.removeEventListener(g,S,c.capture):p.detachEvent?p.detachEvent(Ne(g),S):p.addListener&&p.removeListener&&p.removeListener(S),(g=Tt(p))?(re(g,c),g.h==0&&(g.src=null,p[xe]=null)):Z(c)}}}function Ne(c){return c in Se?Se[c]:Se[c]="on"+c}function et(c,p){if(c.da)c=!0;else{p=new G(p,this);const g=c.listener,S=c.ha||c.src;c.fa&&se(c),c=g.call(S,p)}return c}function Tt(c){return c=c[xe],c instanceof B?c:null}var H="__closure_events_fn_"+(Math.random()*1e9>>>0);function ee(c){return typeof c=="function"?c:(c[H]||(c[H]=function(p){return c.handleEvent(p)}),c[H])}function te(){N.call(this),this.i=new B(this),this.M=this,this.G=null}f(te,N),te.prototype[We]=!0,te.prototype.removeEventListener=function(c,p,g,S){Ie(this,c,p,g,S)};function q(c,p){var g,S=c.G;if(S)for(g=[];S;S=S.G)g.push(S);if(c=c.M,S=p.type||p,typeof p=="string")p=new D(p,c);else if(p instanceof D)p.target=p.target||c;else{var V=p;p=new D(S,c),Pt(p,V)}V=!0;let F,J;if(g)for(J=g.length-1;J>=0;J--)F=p.g=g[J],V=ae(F,S,!0,p)&&V;if(F=p.g=c,V=ae(F,S,!0,p)&&V,V=ae(F,S,!1,p)&&V,g)for(J=0;J<g.length;J++)F=p.g=g[J],V=ae(F,S,!1,p)&&V}te.prototype.N=function(){if(te.Z.N.call(this),this.i){var c=this.i;for(const p in c.g){const g=c.g[p];for(let S=0;S<g.length;S++)Z(g[S]);delete c.g[p],c.h--}}this.G=null},te.prototype.J=function(c,p,g,S){return this.i.add(String(c),p,!1,g,S)},te.prototype.K=function(c,p,g,S){return this.i.add(String(c),p,!0,g,S)};function ae(c,p,g,S){if(p=c.i.g[String(p)],!p)return!0;p=p.concat();let V=!0;for(let F=0;F<p.length;++F){const J=p[F];if(J&&!J.da&&J.capture==g){const Re=J.listener,Dt=J.ha||J.src;J.fa&&re(c.i,J),V=Re.call(Dt,S)!==!1&&V}}return V&&!S.defaultPrevented}function me(c,p){if(typeof c!="function")if(c&&typeof c.handleEvent=="function")c=d(c.handleEvent,c);else throw Error("Invalid listener argument");return Number(p)>2147483647?-1:o.setTimeout(c,p||0)}function ge(c){c.g=me(()=>{c.g=null,c.i&&(c.i=!1,ge(c))},c.l);const p=c.h;c.h=null,c.m.apply(null,p)}class Fe extends N{constructor(p,g){super(),this.m=p,this.l=g,this.h=null,this.i=!1,this.g=null}j(p){this.h=arguments,this.g?this.i=!0:ge(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Ae(c){N.call(this),this.h=c,this.g={}}f(Ae,N);var ze=[];function je(c){de(c.g,function(p,g){this.g.hasOwnProperty(g)&&se(p)},c),c.g={}}Ae.prototype.N=function(){Ae.Z.N.call(this),je(this)},Ae.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var be=o.JSON.stringify,M=o.JSON.parse,Y=class{stringify(c){return o.JSON.stringify(c,void 0)}parse(c){return o.JSON.parse(c,void 0)}};function ie(){}function ye(){}var tt={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function Xt(){D.call(this,"d")}f(Xt,D);function Tn(){D.call(this,"c")}f(Tn,D);var xn={},Dn=null;function Jt(){return Dn=Dn||new te}xn.Ia="serverreachability";function Nt(c){D.call(this,xn.Ia,c)}f(Nt,D);function Ft(c){const p=Jt();q(p,new Nt(p))}xn.STAT_EVENT="statevent";function jn(c,p){D.call(this,xn.STAT_EVENT,c),this.stat=p}f(jn,D);function Ve(c){const p=Jt();q(p,new jn(p,c))}xn.Ja="timingevent";function kt(c,p){D.call(this,xn.Ja,c),this.size=p}f(kt,D);function Cr(c,p){if(typeof c!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){c()},p)}function ur(){this.g=!0}ur.prototype.ua=function(){this.g=!1};function ys(c,p,g,S,V,F){c.info(function(){if(c.g)if(F){var J="",Re=F.split("&");for(let rt=0;rt<Re.length;rt++){var Dt=Re[rt].split("=");if(Dt.length>1){const Ut=Dt[0];Dt=Dt[1];const Nr=Ut.split("_");J=Nr.length>=2&&Nr[1]=="type"?J+(Ut+"="+Dt+"&"):J+(Ut+"=redacted&")}}}else J=null;else J=F;return"XMLHTTP REQ ("+S+") [attempt "+V+"]: "+p+`
`+g+`
`+J})}function On(c,p,g,S,V,F,J){c.info(function(){return"XMLHTTP RESP ("+S+") [ attempt "+V+"]: "+p+`
`+g+`
`+F+" "+J})}function Gr(c,p,g,S){c.info(function(){return"XMLHTTP TEXT ("+p+"): "+au(c,g)+(S?" "+S:"")})}function ou(c,p){c.info(function(){return"TIMEOUT: "+p})}ur.prototype.info=function(){};function au(c,p){if(!c.g)return p;if(!p)return null;try{const F=JSON.parse(p);if(F){for(c=0;c<F.length;c++)if(Array.isArray(F[c])){var g=F[c];if(!(g.length<2)){var S=g[1];if(Array.isArray(S)&&!(S.length<1)){var V=S[0];if(V!="noop"&&V!="stop"&&V!="close")for(let J=1;J<S.length;J++)S[J]=""}}}}return be(F)}catch{return p}}var Ei={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},Za={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},el;function T(){}f(T,ie),T.prototype.g=function(){return new XMLHttpRequest},el=new T;function z(c){return encodeURIComponent(String(c))}function X(c){var p=1;c=c.split(":");const g=[];for(;p>0&&c.length;)g.push(c.shift()),p--;return c.length&&g.push(c.join(":")),g}function ue(c,p,g,S){this.j=c,this.i=p,this.l=g,this.S=S||1,this.V=new Ae(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new Ce}function Ce(){this.i=null,this.g="",this.h=!1}var nt={},Ar={};function Gn(c,p,g){c.M=1,c.A=cu(Pr(p)),c.u=g,c.R=!0,Rr(c,null)}function Rr(c,p){c.F=Date.now(),vs(c),c.B=Pr(c.A);var g=c.B,S=c.S;Array.isArray(S)||(S=[String(S)]),rv(g.i,"t",S),c.C=0,g=c.j.L,c.h=new Ce,c.g=Ev(c.j,g?p:null,!c.u),c.P>0&&(c.O=new Fe(d(c.Y,c,c.g),c.P)),p=c.V,g=c.g,S=c.ba;var V="readystatechange";Array.isArray(V)||(V&&(ze[0]=V.toString()),V=ze);for(let F=0;F<V.length;F++){const J=De(g,V[F],S||p.handleEvent,!1,p.h||p);if(!J)break;p.g[J.key]=J}p=c.J?Pe(c.J):{},c.u?(c.v||(c.v="POST"),p["Content-Type"]="application/x-www-form-urlencoded",c.g.ea(c.B,c.v,c.u,p)):(c.v="GET",c.g.ea(c.B,c.v,null,p)),Ft(),ys(c.i,c.v,c.B,c.l,c.S,c.u)}ue.prototype.ba=function(c){c=c.target;const p=this.O;p&&Is(c)==3?p.j():this.Y(c)},ue.prototype.Y=function(c){try{if(c==this.g)e:{const Re=Is(this.g),Dt=this.g.ya(),rt=this.g.ca();if(!(Re<3)&&(Re!=3||this.g&&(this.h.h||this.g.la()||uv(this.g)))){this.K||Re!=4||Dt==7||(Dt==8||rt<=0?Ft(3):Ft(2)),Ii(this);var p=this.g.ca();this.X=p;var g=St(this);if(this.o=p==200,On(this.i,this.v,this.B,this.l,this.S,Re,p),this.o){if(this.U&&!this.L){t:{if(this.g){var S,V=this.g;if((S=V.g?V.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!k(S)){var F=S;break t}}F=null}if(c=F)Gr(this.i,this.l,c,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,Df(this,c);else{this.o=!1,this.m=3,Ve(12),Ti(this),tl(this);break e}}if(this.R){c=!0;let Ut;for(;!this.K&&this.C<g.length;)if(Ut=_s(this,g),Ut==Ar){Re==4&&(this.m=4,Ve(14),c=!1),Gr(this.i,this.l,null,"[Incomplete Response]");break}else if(Ut==nt){this.m=4,Ve(15),Gr(this.i,this.l,g,"[Invalid Chunk]"),c=!1;break}else Gr(this.i,this.l,Ut,null),Df(this,Ut);if(dn(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Re!=4||g.length!=0||this.h.h||(this.m=1,Ve(16),c=!1),this.o=this.o&&c,!c)Gr(this.i,this.l,g,"[Invalid Chunked Response]"),Ti(this),tl(this);else if(g.length>0&&!this.W){this.W=!0;var J=this.j;J.g==this&&J.aa&&!J.P&&(J.j.info("Great, no buffering proxy detected. Bytes received: "+g.length),$f(J),J.P=!0,Ve(11))}}else Gr(this.i,this.l,g,null),Df(this,g);Re==4&&Ti(this),this.o&&!this.K&&(Re==4?yv(this.j,this):(this.o=!1,vs(this)))}else lR(this.g),p==400&&g.indexOf("Unknown SID")>0?(this.m=3,Ve(12)):(this.m=0,Ve(13)),Ti(this),tl(this)}}}catch{}finally{}};function St(c){if(!dn(c))return c.g.la();const p=uv(c.g);if(p==="")return"";let g="";const S=p.length,V=Is(c.g)==4;if(!c.h.i){if(typeof TextDecoder>"u")return Ti(c),tl(c),"";c.h.i=new o.TextDecoder}for(let F=0;F<S;F++)c.h.h=!0,g+=c.h.i.decode(p[F],{stream:!(V&&F==S-1)});return p.length=0,c.h.g+=g,c.C=0,c.h.g}function dn(c){return c.g?c.v=="GET"&&c.M!=2&&c.j.Aa:!1}function _s(c,p){var g=c.C,S=p.indexOf(`
`,g);return S==-1?Ar:(g=Number(p.substring(g,S)),isNaN(g)?nt:(S+=1,S+g>p.length?Ar:(p=p.slice(S,S+g),c.C=S+g,p)))}ue.prototype.cancel=function(){this.K=!0,Ti(this)};function vs(c){c.T=Date.now()+c.H,lu(c,c.H)}function lu(c,p){if(c.D!=null)throw Error("WatchDog timer not null");c.D=Cr(d(c.aa,c),p)}function Ii(c){c.D&&(o.clearTimeout(c.D),c.D=null)}ue.prototype.aa=function(){this.D=null;const c=Date.now();c-this.T>=0?(ou(this.i,this.B),this.M!=2&&(Ft(),Ve(17)),Ti(this),this.m=2,tl(this)):lu(this,this.T-c)};function tl(c){c.j.I==0||c.K||yv(c.j,c)}function Ti(c){Ii(c);var p=c.O;p&&typeof p.dispose=="function"&&p.dispose(),c.O=null,je(c.V),c.g&&(p=c.g,c.g=null,p.abort(),p.dispose())}function Df(c,p){try{var g=c.j;if(g.I!=0&&(g.g==c||jf(g.h,c))){if(!c.L&&jf(g.h,c)&&g.I==3){try{var S=g.Ba.g.parse(p)}catch{S=null}if(Array.isArray(S)&&S.length==3){var V=S;if(V[0]==0){e:if(!g.v){if(g.g)if(g.g.F+3e3<c.F)pu(g),hu(g);else break e;Uf(g),Ve(18)}}else g.xa=V[1],0<g.xa-g.K&&V[2]<37500&&g.F&&g.A==0&&!g.C&&(g.C=Cr(d(g.Va,g),6e3));Q_(g.h)<=1&&g.ta&&(g.ta=void 0)}else Si(g,11)}else if((c.L||g.g==c)&&pu(g),!k(p))for(V=g.Ba.g.parse(p),p=0;p<V.length;p++){let rt=V[p];const Ut=rt[0];if(!(Ut<=g.K))if(g.K=Ut,rt=rt[1],g.I==2)if(rt[0]=="c"){g.M=rt[1],g.ba=rt[2];const Nr=rt[3];Nr!=null&&(g.ka=Nr,g.j.info("VER="+g.ka));const bi=rt[4];bi!=null&&(g.za=bi,g.j.info("SVER="+g.za));const Ts=rt[5];Ts!=null&&typeof Ts=="number"&&Ts>0&&(S=1.5*Ts,g.O=S,g.j.info("backChannelRequestTimeoutMs_="+S)),S=g;const xs=c.g;if(xs){const gu=xs.g?xs.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(gu){var F=S.h;F.g||gu.indexOf("spdy")==-1&&gu.indexOf("quic")==-1&&gu.indexOf("h2")==-1||(F.j=F.l,F.g=new Set,F.h&&(Of(F,F.h),F.h=null))}if(S.G){const Bf=xs.g?xs.g.getResponseHeader("X-HTTP-Session-Id"):null;Bf&&(S.wa=Bf,ot(S.J,S.G,Bf))}}g.I=3,g.l&&g.l.ra(),g.aa&&(g.T=Date.now()-c.F,g.j.info("Handshake RTT: "+g.T+"ms")),S=g;var J=c;if(S.na=wv(S,S.L?S.ba:null,S.W),J.L){Y_(S.h,J);var Re=J,Dt=S.O;Dt&&(Re.H=Dt),Re.D&&(Ii(Re),vs(Re)),S.g=J}else mv(S);g.i.length>0&&fu(g)}else rt[0]!="stop"&&rt[0]!="close"||Si(g,7);else g.I==3&&(rt[0]=="stop"||rt[0]=="close"?rt[0]=="stop"?Si(g,7):Ff(g):rt[0]!="noop"&&g.l&&g.l.qa(rt),g.A=0)}}Ft(4)}catch{}}var QA=class{constructor(c,p){this.g=c,this.map=p}};function K_(c){this.l=c||10,o.PerformanceNavigationTiming?(c=o.performance.getEntriesByType("navigation"),c=c.length>0&&(c[0].nextHopProtocol=="hq"||c[0].nextHopProtocol=="h2")):c=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=c?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function G_(c){return c.h?!0:c.g?c.g.size>=c.j:!1}function Q_(c){return c.h?1:c.g?c.g.size:0}function jf(c,p){return c.h?c.h==p:c.g?c.g.has(p):!1}function Of(c,p){c.g?c.g.add(p):c.h=p}function Y_(c,p){c.h&&c.h==p?c.h=null:c.g&&c.g.has(p)&&c.g.delete(p)}K_.prototype.cancel=function(){if(this.i=X_(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const c of this.g.values())c.cancel();this.g.clear()}};function X_(c){if(c.h!=null)return c.i.concat(c.h.G);if(c.g!=null&&c.g.size!==0){let p=c.i;for(const g of c.g.values())p=p.concat(g.G);return p}return _(c.i)}var J_=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function YA(c,p){if(c){c=c.split("&");for(let g=0;g<c.length;g++){const S=c[g].indexOf("=");let V,F=null;S>=0?(V=c[g].substring(0,S),F=c[g].substring(S+1)):V=c[g],p(V,F?decodeURIComponent(F.replace(/\+/g," ")):"")}}}function ws(c){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let p;c instanceof ws?(this.l=c.l,nl(this,c.j),this.o=c.o,this.g=c.g,rl(this,c.u),this.h=c.h,Vf(this,sv(c.i)),this.m=c.m):c&&(p=String(c).match(J_))?(this.l=!1,nl(this,p[1]||"",!0),this.o=sl(p[2]||""),this.g=sl(p[3]||"",!0),rl(this,p[4]),this.h=sl(p[5]||"",!0),Vf(this,p[6]||"",!0),this.m=sl(p[7]||"")):(this.l=!1,this.i=new ol(null,this.l))}ws.prototype.toString=function(){const c=[];var p=this.j;p&&c.push(il(p,Z_,!0),":");var g=this.g;return(g||p=="file")&&(c.push("//"),(p=this.o)&&c.push(il(p,Z_,!0),"@"),c.push(z(g).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),g=this.u,g!=null&&c.push(":",String(g))),(g=this.h)&&(this.g&&g.charAt(0)!="/"&&c.push("/"),c.push(il(g,g.charAt(0)=="/"?ZA:JA,!0))),(g=this.i.toString())&&c.push("?",g),(g=this.m)&&c.push("#",il(g,tR)),c.join("")},ws.prototype.resolve=function(c){const p=Pr(this);let g=!!c.j;g?nl(p,c.j):g=!!c.o,g?p.o=c.o:g=!!c.g,g?p.g=c.g:g=c.u!=null;var S=c.h;if(g)rl(p,c.u);else if(g=!!c.h){if(S.charAt(0)!="/")if(this.g&&!this.h)S="/"+S;else{var V=p.h.lastIndexOf("/");V!=-1&&(S=p.h.slice(0,V+1)+S)}if(V=S,V==".."||V==".")S="";else if(V.indexOf("./")!=-1||V.indexOf("/.")!=-1){S=V.lastIndexOf("/",0)==0,V=V.split("/");const F=[];for(let J=0;J<V.length;){const Re=V[J++];Re=="."?S&&J==V.length&&F.push(""):Re==".."?((F.length>1||F.length==1&&F[0]!="")&&F.pop(),S&&J==V.length&&F.push("")):(F.push(Re),S=!0)}S=F.join("/")}else S=V}return g?p.h=S:g=c.i.toString()!=="",g?Vf(p,sv(c.i)):g=!!c.m,g&&(p.m=c.m),p};function Pr(c){return new ws(c)}function nl(c,p,g){c.j=g?sl(p,!0):p,c.j&&(c.j=c.j.replace(/:$/,""))}function rl(c,p){if(p){if(p=Number(p),isNaN(p)||p<0)throw Error("Bad port number "+p);c.u=p}else c.u=null}function Vf(c,p,g){p instanceof ol?(c.i=p,nR(c.i,c.l)):(g||(p=il(p,eR)),c.i=new ol(p,c.l))}function ot(c,p,g){c.i.set(p,g)}function cu(c){return ot(c,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),c}function sl(c,p){return c?p?decodeURI(c.replace(/%25/g,"%2525")):decodeURIComponent(c):""}function il(c,p,g){return typeof c=="string"?(c=encodeURI(c).replace(p,XA),g&&(c=c.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),c):null}function XA(c){return c=c.charCodeAt(0),"%"+(c>>4&15).toString(16)+(c&15).toString(16)}var Z_=/[#\/\?@]/g,JA=/[#\?:]/g,ZA=/[#\?]/g,eR=/[#\?@]/g,tR=/#/g;function ol(c,p){this.h=this.g=null,this.i=c||null,this.j=!!p}function xi(c){c.g||(c.g=new Map,c.h=0,c.i&&YA(c.i,function(p,g){c.add(decodeURIComponent(p.replace(/\+/g," ")),g)}))}t=ol.prototype,t.add=function(c,p){xi(this),this.i=null,c=xo(this,c);let g=this.g.get(c);return g||this.g.set(c,g=[]),g.push(p),this.h+=1,this};function ev(c,p){xi(c),p=xo(c,p),c.g.has(p)&&(c.i=null,c.h-=c.g.get(p).length,c.g.delete(p))}function tv(c,p){return xi(c),p=xo(c,p),c.g.has(p)}t.forEach=function(c,p){xi(this),this.g.forEach(function(g,S){g.forEach(function(V){c.call(p,V,S,this)},this)},this)};function nv(c,p){xi(c);let g=[];if(typeof p=="string")tv(c,p)&&(g=g.concat(c.g.get(xo(c,p))));else for(c=Array.from(c.g.values()),p=0;p<c.length;p++)g=g.concat(c[p]);return g}t.set=function(c,p){return xi(this),this.i=null,c=xo(this,c),tv(this,c)&&(this.h-=this.g.get(c).length),this.g.set(c,[p]),this.h+=1,this},t.get=function(c,p){return c?(c=nv(this,c),c.length>0?String(c[0]):p):p};function rv(c,p,g){ev(c,p),g.length>0&&(c.i=null,c.g.set(xo(c,p),_(g)),c.h+=g.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const c=[],p=Array.from(this.g.keys());for(let S=0;S<p.length;S++){var g=p[S];const V=z(g);g=nv(this,g);for(let F=0;F<g.length;F++){let J=V;g[F]!==""&&(J+="="+z(g[F])),c.push(J)}}return this.i=c.join("&")};function sv(c){const p=new ol;return p.i=c.i,c.g&&(p.g=new Map(c.g),p.h=c.h),p}function xo(c,p){return p=String(p),c.j&&(p=p.toLowerCase()),p}function nR(c,p){p&&!c.j&&(xi(c),c.i=null,c.g.forEach(function(g,S){const V=S.toLowerCase();S!=V&&(ev(this,S),rv(this,V,g))},c)),c.j=p}function rR(c,p){const g=new ur;if(o.Image){const S=new Image;S.onload=h(Es,g,"TestLoadImage: loaded",!0,p,S),S.onerror=h(Es,g,"TestLoadImage: error",!1,p,S),S.onabort=h(Es,g,"TestLoadImage: abort",!1,p,S),S.ontimeout=h(Es,g,"TestLoadImage: timeout",!1,p,S),o.setTimeout(function(){S.ontimeout&&S.ontimeout()},1e4),S.src=c}else p(!1)}function sR(c,p){const g=new ur,S=new AbortController,V=setTimeout(()=>{S.abort(),Es(g,"TestPingServer: timeout",!1,p)},1e4);fetch(c,{signal:S.signal}).then(F=>{clearTimeout(V),F.ok?Es(g,"TestPingServer: ok",!0,p):Es(g,"TestPingServer: server error",!1,p)}).catch(()=>{clearTimeout(V),Es(g,"TestPingServer: error",!1,p)})}function Es(c,p,g,S,V){try{V&&(V.onload=null,V.onerror=null,V.onabort=null,V.ontimeout=null),S(g)}catch{}}function iR(){this.g=new Y}function Lf(c){this.i=c.Sb||null,this.h=c.ab||!1}f(Lf,ie),Lf.prototype.g=function(){return new uu(this.i,this.h)};function uu(c,p){te.call(this),this.H=c,this.o=p,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}f(uu,te),t=uu.prototype,t.open=function(c,p){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=c,this.D=p,this.readyState=1,ll(this)},t.send=function(c){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const p={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};c&&(p.body=c),(this.H||o).fetch(new Request(this.D,p)).then(this.Pa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,al(this)),this.readyState=0},t.Pa=function(c){if(this.g&&(this.l=c,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=c.headers,this.readyState=2,ll(this)),this.g&&(this.readyState=3,ll(this),this.g)))if(this.responseType==="arraybuffer")c.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in c){if(this.j=c.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;iv(this)}else c.text().then(this.Oa.bind(this),this.ga.bind(this))};function iv(c){c.j.read().then(c.Ma.bind(c)).catch(c.ga.bind(c))}t.Ma=function(c){if(this.g){if(this.o&&c.value)this.response.push(c.value);else if(!this.o){var p=c.value?c.value:new Uint8Array(0);(p=this.B.decode(p,{stream:!c.done}))&&(this.response=this.responseText+=p)}c.done?al(this):ll(this),this.readyState==3&&iv(this)}},t.Oa=function(c){this.g&&(this.response=this.responseText=c,al(this))},t.Na=function(c){this.g&&(this.response=c,al(this))},t.ga=function(){this.g&&al(this)};function al(c){c.readyState=4,c.l=null,c.j=null,c.B=null,ll(c)}t.setRequestHeader=function(c,p){this.A.append(c,p)},t.getResponseHeader=function(c){return this.h&&this.h.get(c.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const c=[],p=this.h.entries();for(var g=p.next();!g.done;)g=g.value,c.push(g[0]+": "+g[1]),g=p.next();return c.join(`\r
`)};function ll(c){c.onreadystatechange&&c.onreadystatechange.call(c)}Object.defineProperty(uu.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(c){this.m=c?"include":"same-origin"}});function ov(c){let p="";return de(c,function(g,S){p+=S,p+=":",p+=g,p+=`\r
`}),p}function Mf(c,p,g){e:{for(S in g){var S=!1;break e}S=!0}S||(g=ov(g),typeof c=="string"?g!=null&&z(g):ot(c,p,g))}function yt(c){te.call(this),this.headers=new Map,this.L=c||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}f(yt,te);var oR=/^https?$/i,aR=["POST","PUT"];t=yt.prototype,t.Fa=function(c){this.H=c},t.ea=function(c,p,g,S){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+c);p=p?p.toUpperCase():"GET",this.D=c,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():el.g(),this.g.onreadystatechange=m(d(this.Ca,this));try{this.B=!0,this.g.open(p,String(c),!0),this.B=!1}catch(F){av(this,F);return}if(c=g||"",g=new Map(this.headers),S)if(Object.getPrototypeOf(S)===Object.prototype)for(var V in S)g.set(V,S[V]);else if(typeof S.keys=="function"&&typeof S.get=="function")for(const F of S.keys())g.set(F,S.get(F));else throw Error("Unknown input type for opt_headers: "+String(S));S=Array.from(g.keys()).find(F=>F.toLowerCase()=="content-type"),V=o.FormData&&c instanceof o.FormData,!(Array.prototype.indexOf.call(aR,p,void 0)>=0)||S||V||g.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[F,J]of g)this.g.setRequestHeader(F,J);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(c),this.v=!1}catch(F){av(this,F)}};function av(c,p){c.h=!1,c.g&&(c.j=!0,c.g.abort(),c.j=!1),c.l=p,c.o=5,lv(c),du(c)}function lv(c){c.A||(c.A=!0,q(c,"complete"),q(c,"error"))}t.abort=function(c){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=c||7,q(this,"complete"),q(this,"abort"),du(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),du(this,!0)),yt.Z.N.call(this)},t.Ca=function(){this.u||(this.B||this.v||this.j?cv(this):this.Xa())},t.Xa=function(){cv(this)};function cv(c){if(c.h&&typeof i<"u"){if(c.v&&Is(c)==4)setTimeout(c.Ca.bind(c),0);else if(q(c,"readystatechange"),Is(c)==4){c.h=!1;try{const F=c.ca();e:switch(F){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var p=!0;break e;default:p=!1}var g;if(!(g=p)){var S;if(S=F===0){let J=String(c.D).match(J_)[1]||null;!J&&o.self&&o.self.location&&(J=o.self.location.protocol.slice(0,-1)),S=!oR.test(J?J.toLowerCase():"")}g=S}if(g)q(c,"complete"),q(c,"success");else{c.o=6;try{var V=Is(c)>2?c.g.statusText:""}catch{V=""}c.l=V+" ["+c.ca()+"]",lv(c)}}finally{du(c)}}}}function du(c,p){if(c.g){c.m&&(clearTimeout(c.m),c.m=null);const g=c.g;c.g=null,p||q(c,"ready");try{g.onreadystatechange=null}catch{}}}t.isActive=function(){return!!this.g};function Is(c){return c.g?c.g.readyState:0}t.ca=function(){try{return Is(this)>2?this.g.status:-1}catch{return-1}},t.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.La=function(c){if(this.g){var p=this.g.responseText;return c&&p.indexOf(c)==0&&(p=p.substring(c.length)),M(p)}};function uv(c){try{if(!c.g)return null;if("response"in c.g)return c.g.response;switch(c.F){case"":case"text":return c.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in c.g)return c.g.mozResponseArrayBuffer}return null}catch{return null}}function lR(c){const p={};c=(c.g&&Is(c)>=2&&c.g.getAllResponseHeaders()||"").split(`\r
`);for(let S=0;S<c.length;S++){if(k(c[S]))continue;var g=X(c[S]);const V=g[0];if(g=g[1],typeof g!="string")continue;g=g.trim();const F=p[V]||[];p[V]=F,F.push(g)}pe(p,function(S){return S.join(", ")})}t.ya=function(){return this.o},t.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function cl(c,p,g){return g&&g.internalChannelParams&&g.internalChannelParams[c]||p}function dv(c){this.za=0,this.i=[],this.j=new ur,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=cl("failFast",!1,c),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=cl("baseRetryDelayMs",5e3,c),this.Za=cl("retryDelaySeedMs",1e4,c),this.Ta=cl("forwardChannelMaxRetries",2,c),this.va=cl("forwardChannelRequestTimeoutMs",2e4,c),this.ma=c&&c.xmlHttpFactory||void 0,this.Ua=c&&c.Rb||void 0,this.Aa=c&&c.useFetchStreams||!1,this.O=void 0,this.L=c&&c.supportsCrossDomainXhr||!1,this.M="",this.h=new K_(c&&c.concurrentRequestLimit),this.Ba=new iR,this.S=c&&c.fastHandshake||!1,this.R=c&&c.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=c&&c.Pb||!1,c&&c.ua&&this.j.ua(),c&&c.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&c&&c.detectBufferingProxy||!1,this.ia=void 0,c&&c.longPollingTimeout&&c.longPollingTimeout>0&&(this.ia=c.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}t=dv.prototype,t.ka=8,t.I=1,t.connect=function(c,p,g,S){Ve(0),this.W=c,this.H=p||{},g&&S!==void 0&&(this.H.OSID=g,this.H.OAID=S),this.F=this.X,this.J=wv(this,null,this.W),fu(this)};function Ff(c){if(hv(c),c.I==3){var p=c.V++,g=Pr(c.J);if(ot(g,"SID",c.M),ot(g,"RID",p),ot(g,"TYPE","terminate"),ul(c,g),p=new ue(c,c.j,p),p.M=2,p.A=cu(Pr(g)),g=!1,o.navigator&&o.navigator.sendBeacon)try{g=o.navigator.sendBeacon(p.A.toString(),"")}catch{}!g&&o.Image&&(new Image().src=p.A,g=!0),g||(p.g=Ev(p.j,null),p.g.ea(p.A)),p.F=Date.now(),vs(p)}vv(c)}function hu(c){c.g&&($f(c),c.g.cancel(),c.g=null)}function hv(c){hu(c),c.v&&(o.clearTimeout(c.v),c.v=null),pu(c),c.h.cancel(),c.m&&(typeof c.m=="number"&&o.clearTimeout(c.m),c.m=null)}function fu(c){if(!G_(c.h)&&!c.m){c.m=!0;var p=c.Ea;L||v(),$||(L(),$=!0),E.add(p,c),c.D=0}}function cR(c,p){return Q_(c.h)>=c.h.j-(c.m?1:0)?!1:c.m?(c.i=p.G.concat(c.i),!0):c.I==1||c.I==2||c.D>=(c.Sa?0:c.Ta)?!1:(c.m=Cr(d(c.Ea,c,p),_v(c,c.D)),c.D++,!0)}t.Ea=function(c){if(this.m)if(this.m=null,this.I==1){if(!c){this.V=Math.floor(Math.random()*1e5),c=this.V++;const V=new ue(this,this.j,c);let F=this.o;if(this.U&&(F?(F=Pe(F),Pt(F,this.U)):F=this.U),this.u!==null||this.R||(V.J=F,F=null),this.S)e:{for(var p=0,g=0;g<this.i.length;g++){t:{var S=this.i[g];if("__data__"in S.map&&(S=S.map.__data__,typeof S=="string")){S=S.length;break t}S=void 0}if(S===void 0)break;if(p+=S,p>4096){p=g;break e}if(p===4096||g===this.i.length-1){p=g+1;break e}}p=1e3}else p=1e3;p=pv(this,V,p),g=Pr(this.J),ot(g,"RID",c),ot(g,"CVER",22),this.G&&ot(g,"X-HTTP-Session-Id",this.G),ul(this,g),F&&(this.R?p="headers="+z(ov(F))+"&"+p:this.u&&Mf(g,this.u,F)),Of(this.h,V),this.Ra&&ot(g,"TYPE","init"),this.S?(ot(g,"$req",p),ot(g,"SID","null"),V.U=!0,Gn(V,g,null)):Gn(V,g,p),this.I=2}}else this.I==3&&(c?fv(this,c):this.i.length==0||G_(this.h)||fv(this))};function fv(c,p){var g;p?g=p.l:g=c.V++;const S=Pr(c.J);ot(S,"SID",c.M),ot(S,"RID",g),ot(S,"AID",c.K),ul(c,S),c.u&&c.o&&Mf(S,c.u,c.o),g=new ue(c,c.j,g,c.D+1),c.u===null&&(g.J=c.o),p&&(c.i=p.G.concat(c.i)),p=pv(c,g,1e3),g.H=Math.round(c.va*.5)+Math.round(c.va*.5*Math.random()),Of(c.h,g),Gn(g,S,p)}function ul(c,p){c.H&&de(c.H,function(g,S){ot(p,S,g)}),c.l&&de({},function(g,S){ot(p,S,g)})}function pv(c,p,g){g=Math.min(c.i.length,g);const S=c.l?d(c.l.Ka,c.l,c):null;e:{var V=c.i;let Re=-1;for(;;){const Dt=["count="+g];Re==-1?g>0?(Re=V[0].g,Dt.push("ofs="+Re)):Re=0:Dt.push("ofs="+Re);let rt=!0;for(let Ut=0;Ut<g;Ut++){var F=V[Ut].g;const Nr=V[Ut].map;if(F-=Re,F<0)Re=Math.max(0,V[Ut].g-100),rt=!1;else try{F="req"+F+"_"||"";try{var J=Nr instanceof Map?Nr:Object.entries(Nr);for(const[bi,Ts]of J){let xs=Ts;a(Ts)&&(xs=be(Ts)),Dt.push(F+bi+"="+encodeURIComponent(xs))}}catch(bi){throw Dt.push(F+"type="+encodeURIComponent("_badmap")),bi}}catch{S&&S(Nr)}}if(rt){J=Dt.join("&");break e}}J=void 0}return c=c.i.splice(0,g),p.G=c,J}function mv(c){if(!c.g&&!c.v){c.Y=1;var p=c.Da;L||v(),$||(L(),$=!0),E.add(p,c),c.A=0}}function Uf(c){return c.g||c.v||c.A>=3?!1:(c.Y++,c.v=Cr(d(c.Da,c),_v(c,c.A)),c.A++,!0)}t.Da=function(){if(this.v=null,gv(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var c=4*this.T;this.j.info("BP detection timer enabled: "+c),this.B=Cr(d(this.Wa,this),c)}},t.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,Ve(10),hu(this),gv(this))};function $f(c){c.B!=null&&(o.clearTimeout(c.B),c.B=null)}function gv(c){c.g=new ue(c,c.j,"rpc",c.Y),c.u===null&&(c.g.J=c.o),c.g.P=0;var p=Pr(c.na);ot(p,"RID","rpc"),ot(p,"SID",c.M),ot(p,"AID",c.K),ot(p,"CI",c.F?"0":"1"),!c.F&&c.ia&&ot(p,"TO",c.ia),ot(p,"TYPE","xmlhttp"),ul(c,p),c.u&&c.o&&Mf(p,c.u,c.o),c.O&&(c.g.H=c.O);var g=c.g;c=c.ba,g.M=1,g.A=cu(Pr(p)),g.u=null,g.R=!0,Rr(g,c)}t.Va=function(){this.C!=null&&(this.C=null,hu(this),Uf(this),Ve(19))};function pu(c){c.C!=null&&(o.clearTimeout(c.C),c.C=null)}function yv(c,p){var g=null;if(c.g==p){pu(c),$f(c),c.g=null;var S=2}else if(jf(c.h,p))g=p.G,Y_(c.h,p),S=1;else return;if(c.I!=0){if(p.o)if(S==1){g=p.u?p.u.length:0,p=Date.now()-p.F;var V=c.D;S=Jt(),q(S,new kt(S,g)),fu(c)}else mv(c);else if(V=p.m,V==3||V==0&&p.X>0||!(S==1&&cR(c,p)||S==2&&Uf(c)))switch(g&&g.length>0&&(p=c.h,p.i=p.i.concat(g)),V){case 1:Si(c,5);break;case 4:Si(c,10);break;case 3:Si(c,6);break;default:Si(c,2)}}}function _v(c,p){let g=c.Qa+Math.floor(Math.random()*c.Za);return c.isActive()||(g*=2),g*p}function Si(c,p){if(c.j.info("Error code "+p),p==2){var g=d(c.bb,c),S=c.Ua;const V=!S;S=new ws(S||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||nl(S,"https"),cu(S),V?rR(S.toString(),g):sR(S.toString(),g)}else Ve(2);c.I=0,c.l&&c.l.pa(p),vv(c),hv(c)}t.bb=function(c){c?(this.j.info("Successfully pinged google.com"),Ve(2)):(this.j.info("Failed to ping google.com"),Ve(1))};function vv(c){if(c.I=0,c.ja=[],c.l){const p=X_(c.h);(p.length!=0||c.i.length!=0)&&(A(c.ja,p),A(c.ja,c.i),c.h.i.length=0,_(c.i),c.i.length=0),c.l.oa()}}function wv(c,p,g){var S=g instanceof ws?Pr(g):new ws(g);if(S.g!="")p&&(S.g=p+"."+S.g),rl(S,S.u);else{var V=o.location;S=V.protocol,p=p?p+"."+V.hostname:V.hostname,V=+V.port;const F=new ws(null);S&&nl(F,S),p&&(F.g=p),V&&rl(F,V),g&&(F.h=g),S=F}return g=c.G,p=c.wa,g&&p&&ot(S,g,p),ot(S,"VER",c.ka),ul(c,S),S}function Ev(c,p,g){if(p&&!c.L)throw Error("Can't create secondary domain capable XhrIo object.");return p=c.Aa&&!c.ma?new yt(new Lf({ab:g})):new yt(c.ma),p.Fa(c.L),p}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function Iv(){}t=Iv.prototype,t.ra=function(){},t.qa=function(){},t.pa=function(){},t.oa=function(){},t.isActive=function(){return!0},t.Ka=function(){};function mu(){}mu.prototype.g=function(c,p){return new Vn(c,p)};function Vn(c,p){te.call(this),this.g=new dv(p),this.l=c,this.h=p&&p.messageUrlParams||null,c=p&&p.messageHeaders||null,p&&p.clientProtocolHeaderRequired&&(c?c["X-Client-Protocol"]="webchannel":c={"X-Client-Protocol":"webchannel"}),this.g.o=c,c=p&&p.initMessageHeaders||null,p&&p.messageContentType&&(c?c["X-WebChannel-Content-Type"]=p.messageContentType:c={"X-WebChannel-Content-Type":p.messageContentType}),p&&p.sa&&(c?c["X-WebChannel-Client-Profile"]=p.sa:c={"X-WebChannel-Client-Profile":p.sa}),this.g.U=c,(c=p&&p.Qb)&&!k(c)&&(this.g.u=c),this.A=p&&p.supportsCrossDomainXhr||!1,this.v=p&&p.sendRawJson||!1,(p=p&&p.httpSessionIdParam)&&!k(p)&&(this.g.G=p,c=this.h,c!==null&&p in c&&(c=this.h,p in c&&delete c[p])),this.j=new So(this)}f(Vn,te),Vn.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},Vn.prototype.close=function(){Ff(this.g)},Vn.prototype.o=function(c){var p=this.g;if(typeof c=="string"){var g={};g.__data__=c,c=g}else this.v&&(g={},g.__data__=be(c),c=g);p.i.push(new QA(p.Ya++,c)),p.I==3&&fu(p)},Vn.prototype.N=function(){this.g.l=null,delete this.j,Ff(this.g),delete this.g,Vn.Z.N.call(this)};function Tv(c){Xt.call(this),c.__headers__&&(this.headers=c.__headers__,this.statusCode=c.__status__,delete c.__headers__,delete c.__status__);var p=c.__sm__;if(p){e:{for(const g in p){c=g;break e}c=void 0}(this.i=c)&&(c=this.i,p=p!==null&&c in p?p[c]:void 0),this.data=p}else this.data=c}f(Tv,Xt);function xv(){Tn.call(this),this.status=1}f(xv,Tn);function So(c){this.g=c}f(So,Iv),So.prototype.ra=function(){q(this.g,"a")},So.prototype.qa=function(c){q(this.g,new Tv(c))},So.prototype.pa=function(c){q(this.g,new xv)},So.prototype.oa=function(){q(this.g,"b")},mu.prototype.createWebChannel=mu.prototype.g,Vn.prototype.send=Vn.prototype.o,Vn.prototype.open=Vn.prototype.m,Vn.prototype.close=Vn.prototype.close,eb=function(){return new mu},ZS=function(){return Jt()},JS=xn,Km={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},Ei.NO_ERROR=0,Ei.TIMEOUT=8,Ei.HTTP_ERROR=6,hd=Ei,Za.COMPLETE="complete",XS=Za,ye.EventType=tt,tt.OPEN="a",tt.CLOSE="b",tt.ERROR="c",tt.MESSAGE="d",te.prototype.listen=te.prototype.J,Dl=ye,yt.prototype.listenOnce=yt.prototype.K,yt.prototype.getLastError=yt.prototype.Ha,yt.prototype.getLastErrorCode=yt.prototype.ya,yt.prototype.getStatus=yt.prototype.ca,yt.prototype.getResponseJson=yt.prototype.La,yt.prototype.getResponseText=yt.prototype.la,yt.prototype.send=yt.prototype.ea,yt.prototype.setWithCredentials=yt.prototype.Fa,YS=yt}).apply(typeof Vu<"u"?Vu:typeof self<"u"?self:typeof window<"u"?window:{});const vE="@firebase/firestore",wE="4.9.2";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wt{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Wt.UNAUTHENTICATED=new Wt(null),Wt.GOOGLE_CREDENTIALS=new Wt("google-credentials-uid"),Wt.FIRST_PARTY=new Wt("first-party-uid"),Wt.MOCK_USER=new Wt("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ga="12.3.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ro=new Wh("@firebase/firestore");function Uo(){return ro.logLevel}function W(t,...e){if(ro.logLevel<=Le.DEBUG){const n=e.map(Vy);ro.debug(`Firestore (${Ga}): ${t}`,...n)}}function mn(t,...e){if(ro.logLevel<=Le.ERROR){const n=e.map(Vy);ro.error(`Firestore (${Ga}): ${t}`,...n)}}function so(t,...e){if(ro.logLevel<=Le.WARN){const n=e.map(Vy);ro.warn(`Firestore (${Ga}): ${t}`,...n)}}function Vy(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function le(t,e,n){let r="Unexpected state";typeof e=="string"?r=e:n=e,tb(t,r,n)}function tb(t,e,n){let r=`FIRESTORE (${Ga}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(n!==void 0)try{r+=" CONTEXT: "+JSON.stringify(n)}catch{r+=" CONTEXT: "+n}throw mn(r),new Error(r)}function he(t,e,n,r){let s="Unexpected state";typeof n=="string"?s=n:r=n,t||tb(e,s,r)}function Ee(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const U={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Q extends cr{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vr{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nb{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class Z2{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(Wt.UNAUTHENTICATED))}shutdown(){}}class eO{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class tO{constructor(e){this.t=e,this.currentUser=Wt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){he(this.o===void 0,42304);let r=this.i;const s=l=>this.i!==r?(r=this.i,n(l)):Promise.resolve();let i=new vr;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new vr,e.enqueueRetryable(()=>s(this.currentUser))};const o=()=>{const l=i;e.enqueueRetryable(async()=>{await l.promise,await s(this.currentUser)})},a=l=>{W("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(l=>a(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?a(l):(W("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new vr)}},0),o()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(W("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(he(typeof r.accessToken=="string",31837,{l:r}),new nb(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return he(e===null||typeof e=="string",2055,{h:e}),new Wt(e)}}class nO{constructor(e,n,r){this.P=e,this.T=n,this.I=r,this.type="FirstParty",this.user=Wt.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class rO{constructor(e,n,r){this.P=e,this.T=n,this.I=r}getToken(){return Promise.resolve(new nO(this.P,this.T,this.I))}start(e,n){e.enqueueRetryable(()=>n(Wt.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class EE{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class sO{constructor(e,n){this.V=n,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Jn(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,n){he(this.o===void 0,3512);const r=i=>{i.error!=null&&W("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.m;return this.m=i.token,W("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>r(i))};const s=i=>{W("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(i=>s(i)),setTimeout(()=>{if(!this.appCheck){const i=this.V.getImmediate({optional:!0});i?s(i):W("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new EE(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(he(typeof n.token=="string",44558,{tokenResult:n}),this.m=n.token,new EE(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iO(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ly{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const s=iO(40);for(let i=0;i<s.length;++i)r.length<20&&s[i]<n&&(r+=e.charAt(s[i]%62))}return r}}function Te(t,e){return t<e?-1:t>e?1:0}function Gm(t,e){const n=Math.min(t.length,e.length);for(let r=0;r<n;r++){const s=t.charAt(r),i=e.charAt(r);if(s!==i)return xp(s)===xp(i)?Te(s,i):xp(s)?1:-1}return Te(t.length,e.length)}const oO=55296,aO=57343;function xp(t){const e=t.charCodeAt(0);return e>=oO&&e<=aO}function ba(t,e,n){return t.length===e.length&&t.every((r,s)=>n(r,e[s]))}function rb(t){return t+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IE="__name__";class Vr{constructor(e,n,r){n===void 0?n=0:n>e.length&&le(637,{offset:n,range:e.length}),r===void 0?r=e.length-n:r>e.length-n&&le(1746,{length:r,range:e.length-n}),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return Vr.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof Vr?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let s=0;s<r;s++){const i=Vr.compareSegments(e.get(s),n.get(s));if(i!==0)return i}return Te(e.length,n.length)}static compareSegments(e,n){const r=Vr.isNumericId(e),s=Vr.isNumericId(n);return r&&!s?-1:!r&&s?1:r&&s?Vr.extractNumericId(e).compare(Vr.extractNumericId(n)):Gm(e,n)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return ni.fromString(e.substring(4,e.length-2))}}class He extends Vr{construct(e,n,r){return new He(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new Q(U.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(s=>s.length>0))}return new He(n)}static emptyPath(){return new He([])}}const lO=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class pt extends Vr{construct(e,n,r){return new pt(e,n,r)}static isValidIdentifier(e){return lO.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),pt.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===IE}static keyField(){return new pt([IE])}static fromServerFormat(e){const n=[];let r="",s=0;const i=()=>{if(r.length===0)throw new Q(U.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let o=!1;for(;s<e.length;){const a=e[s];if(a==="\\"){if(s+1===e.length)throw new Q(U.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[s+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new Q(U.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=l,s+=2}else a==="`"?(o=!o,s++):a!=="."||o?(r+=a,s++):(i(),s++)}if(i(),o)throw new Q(U.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new pt(n)}static emptyPath(){return new pt([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ne{constructor(e){this.path=e}static fromPath(e){return new ne(He.fromString(e))}static fromName(e){return new ne(He.fromString(e).popFirst(5))}static empty(){return new ne(He.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&He.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return He.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new ne(new He(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sb(t,e,n){if(!n)throw new Q(U.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function cO(t,e,n,r){if(e===!0&&r===!0)throw new Q(U.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function TE(t){if(!ne.isDocumentKey(t))throw new Q(U.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function xE(t){if(ne.isDocumentKey(t))throw new Q(U.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function ib(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function Jh(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":le(12329,{type:typeof t})}function an(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new Q(U.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Jh(t);throw new Q(U.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}function uO(t,e){if(e<=0)throw new Q(U.INVALID_ARGUMENT,`Function ${t}() requires a positive number, but it was: ${e}.`)}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function At(t,e){const n={typeString:t};return e&&(n.value=e),n}function Kc(t,e){if(!ib(t))throw new Q(U.INVALID_ARGUMENT,"JSON must be an object");let n;for(const r in e)if(e[r]){const s=e[r].typeString,i="value"in e[r]?{value:e[r].value}:void 0;if(!(r in t)){n=`JSON missing required field: '${r}'`;break}const o=t[r];if(s&&typeof o!==s){n=`JSON field '${r}' must be a ${s}.`;break}if(i!==void 0&&o!==i.value){n=`Expected '${r}' field to equal '${i.value}'`;break}}if(n)throw new Q(U.INVALID_ARGUMENT,n);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SE=-62135596800,bE=1e6;class Be{static now(){return Be.fromMillis(Date.now())}static fromDate(e){return Be.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor((e-1e3*n)*bE);return new Be(n,r)}constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new Q(U.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new Q(U.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<SE)throw new Q(U.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Q(U.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/bE}_compareTo(e){return this.seconds===e.seconds?Te(this.nanoseconds,e.nanoseconds):Te(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:Be._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Kc(e,Be._jsonSchema))return new Be(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-SE;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}Be._jsonSchemaVersion="firestore/timestamp/1.0",Be._jsonSchema={type:At("string",Be._jsonSchemaVersion),seconds:At("number"),nanoseconds:At("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fe{static fromTimestamp(e){return new fe(e)}static min(){return new fe(new Be(0,0))}static max(){return new fe(new Be(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sc=-1;class sh{constructor(e,n,r,s){this.indexId=e,this.collectionGroup=n,this.fields=r,this.indexState=s}}function Qm(t){return t.fields.find(e=>e.kind===2)}function Ni(t){return t.fields.filter(e=>e.kind!==2)}sh.UNKNOWN_ID=-1;class fd{constructor(e,n){this.fieldPath=e,this.kind=n}}class bc{constructor(e,n){this.sequenceNumber=e,this.offset=n}static empty(){return new bc(0,Hn.min())}}function dO(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,s=fe.fromTimestamp(r===1e9?new Be(n+1,0):new Be(n,r));return new Hn(s,ne.empty(),e)}function ob(t){return new Hn(t.readTime,t.key,Sc)}class Hn{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new Hn(fe.min(),ne.empty(),Sc)}static max(){return new Hn(fe.max(),ne.empty(),Sc)}}function My(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=ne.comparator(t.documentKey,e.documentKey),n!==0?n:Te(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ab="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class lb{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Io(t){if(t.code!==U.FAILED_PRECONDITION||t.message!==ab)throw t;W("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&le(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new O((r,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(r,s)},this.catchCallback=i=>{this.wrapFailure(n,i).next(r,s)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof O?n:O.resolve(n)}catch(n){return O.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):O.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):O.reject(n)}static resolve(e){return new O((n,r)=>{n(e)})}static reject(e){return new O((n,r)=>{r(e)})}static waitFor(e){return new O((n,r)=>{let s=0,i=0,o=!1;e.forEach(a=>{++s,a.next(()=>{++i,o&&i===s&&n()},l=>r(l))}),o=!0,i===s&&n()})}static or(e){let n=O.resolve(!1);for(const r of e)n=n.next(s=>s?O.resolve(s):r());return n}static forEach(e,n){const r=[];return e.forEach((s,i)=>{r.push(n.call(this,s,i))}),this.waitFor(r)}static mapArray(e,n){return new O((r,s)=>{const i=e.length,o=new Array(i);let a=0;for(let l=0;l<i;l++){const d=l;n(e[d]).next(h=>{o[d]=h,++a,a===i&&r(o)},h=>s(h))}})}static doWhile(e,n){return new O((r,s)=>{const i=()=>{e()===!0?n().next(()=>{i()},s):r()};i()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mn="SimpleDb";class Zh{static open(e,n,r,s){try{return new Zh(n,e.transaction(s,r))}catch(i){throw new Yl(n,i)}}constructor(e,n){this.action=e,this.transaction=n,this.aborted=!1,this.S=new vr,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{n.error?this.S.reject(new Yl(e,n.error)):this.S.resolve()},this.transaction.onerror=r=>{const s=Fy(r.target.error);this.S.reject(new Yl(e,s))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(W(Mn,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}C(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const n=this.transaction.objectStore(e);return new fO(n)}}class ri{static delete(e){return W(Mn,"Removing database:",e),Di(J0().indexedDB.deleteDatabase(e)).toPromise()}static v(){if(!xy())return!1;if(ri.F())return!0;const e=Vt(),n=ri.M(e),r=0<n&&n<10,s=cb(e),i=0<s&&s<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||i)}static F(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)==null?void 0:e.__PRIVATE_USE_MOCK_PERSISTENCE)==="YES"}static O(e,n){return e.store(n)}static M(e){const n=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=n?n[1].split("_").slice(0,2).join("."):"-1";return Number(r)}constructor(e,n,r){this.name=e,this.version=n,this.N=r,this.B=null,ri.M(Vt())===12.2&&mn("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async L(e){return this.db||(W(Mn,"Opening database:",this.name),this.db=await new Promise((n,r)=>{const s=indexedDB.open(this.name,this.version);s.onsuccess=i=>{const o=i.target.result;n(o)},s.onblocked=()=>{r(new Yl(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},s.onerror=i=>{const o=i.target.error;o.name==="VersionError"?r(new Q(U.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?r(new Q(U.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):r(new Yl(e,o))},s.onupgradeneeded=i=>{W(Mn,'Database "'+this.name+'" requires upgrade from version:',i.oldVersion);const o=i.target.result;this.N.k(o,s.transaction,i.oldVersion,this.version).next(()=>{W(Mn,"Database upgrade to version "+this.version+" complete")})}})),this.q&&(this.db.onversionchange=n=>this.q(n)),this.db}$(e){this.q=e,this.db&&(this.db.onversionchange=n=>e(n))}async runTransaction(e,n,r,s){const i=n==="readonly";let o=0;for(;;){++o;try{this.db=await this.L(e);const a=Zh.open(this.db,e,i?"readonly":"readwrite",r),l=s(a).next(d=>(a.C(),d)).catch(d=>(a.abort(d),O.reject(d))).toPromise();return l.catch(()=>{}),await a.D,l}catch(a){const l=a,d=l.name!=="FirebaseError"&&o<3;if(W(Mn,"Transaction failed with error:",l.message,"Retrying:",d),this.close(),!d)return Promise.reject(l)}}}close(){this.db&&this.db.close(),this.db=void 0}}function cb(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}class hO{constructor(e){this.U=e,this.K=!1,this.W=null}get isDone(){return this.K}get G(){return this.W}set cursor(e){this.U=e}done(){this.K=!0}j(e){this.W=e}delete(){return Di(this.U.delete())}}class Yl extends Q{constructor(e,n){super(U.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${n}`),this.name="IndexedDbTransactionError"}}function _i(t){return t.name==="IndexedDbTransactionError"}class fO{constructor(e){this.store=e}put(e,n){let r;return n!==void 0?(W(Mn,"PUT",this.store.name,e,n),r=this.store.put(n,e)):(W(Mn,"PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),Di(r)}add(e){return W(Mn,"ADD",this.store.name,e,e),Di(this.store.add(e))}get(e){return Di(this.store.get(e)).next(n=>(n===void 0&&(n=null),W(Mn,"GET",this.store.name,e,n),n))}delete(e){return W(Mn,"DELETE",this.store.name,e),Di(this.store.delete(e))}count(){return W(Mn,"COUNT",this.store.name),Di(this.store.count())}J(e,n){const r=this.options(e,n),s=r.index?this.store.index(r.index):this.store;if(typeof s.getAll=="function"){const i=s.getAll(r.range);return new O((o,a)=>{i.onerror=l=>{a(l.target.error)},i.onsuccess=l=>{o(l.target.result)}})}{const i=this.cursor(r),o=[];return this.H(i,(a,l)=>{o.push(l)}).next(()=>o)}}Y(e,n){const r=this.store.getAll(e,n===null?void 0:n);return new O((s,i)=>{r.onerror=o=>{i(o.target.error)},r.onsuccess=o=>{s(o.target.result)}})}Z(e,n){W(Mn,"DELETE ALL",this.store.name);const r=this.options(e,n);r.X=!1;const s=this.cursor(r);return this.H(s,(i,o,a)=>a.delete())}ee(e,n){let r;n?r=e:(r={},n=e);const s=this.cursor(r);return this.H(s,n)}te(e){const n=this.cursor({});return new O((r,s)=>{n.onerror=i=>{const o=Fy(i.target.error);s(o)},n.onsuccess=i=>{const o=i.target.result;o?e(o.primaryKey,o.value).next(a=>{a?o.continue():r()}):r()}})}H(e,n){const r=[];return new O((s,i)=>{e.onerror=o=>{i(o.target.error)},e.onsuccess=o=>{const a=o.target.result;if(!a)return void s();const l=new hO(a),d=n(a.primaryKey,a.value,l);if(d instanceof O){const h=d.catch(f=>(l.done(),O.reject(f)));r.push(h)}l.isDone?s():l.G===null?a.continue():a.continue(l.G)}}).next(()=>O.waitFor(r))}options(e,n){let r;return e!==void 0&&(typeof e=="string"?r=e:n=e),{index:r,range:n}}cursor(e){let n="next";if(e.reverse&&(n="prev"),e.index){const r=this.store.index(e.index);return e.X?r.openKeyCursor(e.range,n):r.openCursor(e.range,n)}return this.store.openCursor(e.range,n)}}function Di(t){return new O((e,n)=>{t.onsuccess=r=>{const s=r.target.result;e(s)},t.onerror=r=>{const s=Fy(r.target.error);n(s)}})}let CE=!1;function Fy(t){const e=ri.M(Vt());if(e>=12.2&&e<13){const n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){const r=new Q("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${n}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return CE||(CE=!0,setTimeout(()=>{throw r},0)),r}}return t}const Xl="IndexBackfiller";class pO{constructor(e,n){this.asyncQueue=e,this.ne=n,this.task=null}start(){this.re(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}re(e){W(Xl,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{const n=await this.ne.ie();W(Xl,`Documents written: ${n}`)}catch(n){_i(n)?W(Xl,"Ignoring IndexedDB error during index backfill: ",n):await Io(n)}await this.re(6e4)})}}class mO{constructor(e,n){this.localStore=e,this.persistence=n}async ie(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",n=>this.se(n,e))}se(e,n){const r=new Set;let s=n,i=!0;return O.doWhile(()=>i===!0&&s>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(o!==null&&!r.has(o))return W(Xl,`Processing collection: ${o}`),this.oe(e,o,s).next(a=>{s-=a,r.add(o)});i=!1})).next(()=>n-s)}oe(e,n,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,n).next(s=>this.localStore.localDocuments.getNextDocuments(e,n,s,r).next(i=>{const o=i.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this._e(s,i)).next(a=>(W(Xl,`Updating offset: ${a}`),this.localStore.indexManager.updateCollectionGroup(e,n,a))).next(()=>o.size)}))}_e(e,n){let r=e;return n.changes.forEach((s,i)=>{const o=ob(i);My(o,r)>0&&(r=o)}),new Hn(r.readTime,r.documentKey,Math.max(n.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tr{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ae(r),this.ue=r=>n.writeSequenceNumber(r))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}tr.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hi=-1;function ef(t){return t==null}function Cc(t){return t===0&&1/t==-1/0}function gO(t){return typeof t=="number"&&Number.isInteger(t)&&!Cc(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ih="";function ln(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=AE(e)),e=yO(t.get(n),e);return AE(e)}function yO(t,e){let n=e;const r=t.length;for(let s=0;s<r;s++){const i=t.charAt(s);switch(i){case"\0":n+="";break;case ih:n+="";break;default:n+=i}}return n}function AE(t){return t+ih+""}function Mr(t){const e=t.length;if(he(e>=2,64408,{path:t}),e===2)return he(t.charAt(0)===ih&&t.charAt(1)==="",56145,{path:t}),He.emptyPath();const n=e-2,r=[];let s="";for(let i=0;i<e;){const o=t.indexOf(ih,i);switch((o<0||o>n)&&le(50515,{path:t}),t.charAt(o+1)){case"":const a=t.substring(i,o);let l;s.length===0?l=a:(s+=a,l=s,s=""),r.push(l);break;case"":s+=t.substring(i,o),s+="\0";break;case"":s+=t.substring(i,o+1);break;default:le(61167,{path:t})}i=o+2}return new He(r)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ki="remoteDocuments",Gc="owner",Co="owner",Ac="mutationQueues",_O="userId",pr="mutations",RE="batchId",$i="userMutationsIndex",PE=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pd(t,e){return[t,ln(e)]}function ub(t,e,n){return[t,ln(e),n]}const vO={},Ca="documentMutations",oh="remoteDocumentsV14",wO=["prefixPath","collectionGroup","readTime","documentId"],md="documentKeyIndex",EO=["prefixPath","collectionGroup","documentId"],db="collectionGroupIndex",IO=["collectionGroup","readTime","prefixPath","documentId"],Rc="remoteDocumentGlobal",Ym="remoteDocumentGlobalKey",Aa="targets",hb="queryTargetsIndex",TO=["canonicalId","targetId"],Ra="targetDocuments",xO=["targetId","path"],Uy="documentTargetsIndex",SO=["path","targetId"],ah="targetGlobalKey",Wi="targetGlobal",Pc="collectionParents",bO=["collectionId","parent"],Pa="clientMetadata",CO="clientId",tf="bundles",AO="bundleId",nf="namedQueries",RO="name",$y="indexConfiguration",PO="indexId",Xm="collectionGroupIndex",NO="collectionGroup",Jl="indexState",kO=["indexId","uid"],fb="sequenceNumberIndex",DO=["uid","sequenceNumber"],Zl="indexEntries",jO=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],pb="documentKeyIndex",OO=["indexId","uid","orderedDocumentKey"],rf="documentOverlays",VO=["userId","collectionPath","documentId"],Jm="collectionPathOverlayIndex",LO=["userId","collectionPath","largestBatchId"],mb="collectionGroupOverlayIndex",MO=["userId","collectionGroup","largestBatchId"],By="globals",FO="name",gb=[Ac,pr,Ca,ki,Aa,Gc,Wi,Ra,Pa,Rc,Pc,tf,nf],UO=[...gb,rf],yb=[Ac,pr,Ca,oh,Aa,Gc,Wi,Ra,Pa,Rc,Pc,tf,nf,rf],_b=yb,zy=[..._b,$y,Jl,Zl],$O=zy,vb=[...zy,By],BO=vb;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zm extends lb{constructor(e,n){super(),this.le=e,this.currentSequenceNumber=n}}function Lt(t,e){const n=Ee(t);return ri.O(n.le,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NE(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function vi(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function zO(t,e){const n=[];for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&n.push(e(t[r],r,t));return n}function wb(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ht{constructor(e,n){this.comparator=e,this.root=n||Kt.EMPTY}insert(e,n){return new ht(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,Kt.BLACK,null,null))}remove(e){return new ht(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Kt.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(e,r.key);if(s===0)return n+r.left.size;s<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Lu(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Lu(this.root,e,this.comparator,!1)}getReverseIterator(){return new Lu(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Lu(this.root,e,this.comparator,!0)}}class Lu{constructor(e,n,r,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=n?r(e.key,n):1,n&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Kt{constructor(e,n,r,s,i){this.key=e,this.value=n,this.color=r??Kt.RED,this.left=s??Kt.EMPTY,this.right=i??Kt.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,s,i){return new Kt(e??this.key,n??this.value,r??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let s=this;const i=r(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,n,r),null):i===0?s.copy(null,n,null,null,null):s.copy(null,null,null,null,s.right.insert(e,n,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return Kt.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,s=this;if(n(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,n),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),n(e,s.key)===0){if(s.right.isEmpty())return Kt.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,n))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Kt.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Kt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw le(43730,{key:this.key,value:this.value});if(this.right.isRed())throw le(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw le(27949);return e+(this.isRed()?0:1)}}Kt.EMPTY=null,Kt.RED=!0,Kt.BLACK=!1;Kt.EMPTY=new class{constructor(){this.size=0}get key(){throw le(57766)}get value(){throw le(16141)}get color(){throw le(16727)}get left(){throw le(29726)}get right(){throw le(36894)}copy(e,n,r,s,i){return this}insert(e,n,r){return new Kt(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Je{constructor(e){this.comparator=e,this.data=new ht(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,e[1])>=0)return;n(s.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new kE(this.data.getIterator())}getIteratorFrom(e){return new kE(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof Je)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new Je(this.comparator);return n.data=e,n}}class kE{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function Ao(t){return t.hasNext()?t.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class An{constructor(e){this.fields=e,e.sort(pt.comparator)}static empty(){return new An([])}unionWith(e){let n=new Je(pt.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new An(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return ba(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Eb extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rt{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(s){try{return atob(s)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new Eb("Invalid base64 string: "+i):i}}(e);return new Rt(n)}static fromUint8Array(e){const n=function(s){let i="";for(let o=0;o<s.length;++o)i+=String.fromCharCode(s[o]);return i}(e);return new Rt(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Te(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Rt.EMPTY_BYTE_STRING=new Rt("");const qO=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function hs(t){if(he(!!t,39018),typeof t=="string"){let e=0;const n=qO.exec(t);if(he(!!n,46558,{timestamp:t}),n[1]){let s=n[1];s=(s+"000000000").substr(0,9),e=Number(s)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:ct(t.seconds),nanos:ct(t.nanos)}}function ct(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function fs(t){return typeof t=="string"?Rt.fromBase64String(t):Rt.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ib="server_timestamp",Tb="__type__",xb="__previous_value__",Sb="__local_write_time__";function sf(t){var n,r;return((r=(((n=t==null?void 0:t.mapValue)==null?void 0:n.fields)||{})[Tb])==null?void 0:r.stringValue)===Ib}function of(t){const e=t.mapValue.fields[xb];return sf(e)?of(e):e}function Nc(t){const e=hs(t.mapValue.fields[Sb].timestampValue);return new Be(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HO{constructor(e,n,r,s,i,o,a,l,d,h){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=s,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=l,this.useFetchStreams=d,this.isUsingEmulator=h}}const lh="(default)";class io{constructor(e,n){this.projectId=e,this.database=n||lh}static empty(){return new io("","")}get isDefaultDatabase(){return this.database===lh}isEqual(e){return e instanceof io&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qy="__type__",bb="__max__",qs={mapValue:{fields:{__type__:{stringValue:bb}}}},Hy="__vector__",Na="value",gd={nullValue:"NULL_VALUE"};function ai(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?sf(t)?4:Cb(t)?9007199254740991:af(t)?10:11:le(28295,{value:t})}function Kr(t,e){if(t===e)return!0;const n=ai(t);if(n!==ai(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Nc(t).isEqual(Nc(e));case 3:return function(s,i){if(typeof s.timestampValue=="string"&&typeof i.timestampValue=="string"&&s.timestampValue.length===i.timestampValue.length)return s.timestampValue===i.timestampValue;const o=hs(s.timestampValue),a=hs(i.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(s,i){return fs(s.bytesValue).isEqual(fs(i.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(s,i){return ct(s.geoPointValue.latitude)===ct(i.geoPointValue.latitude)&&ct(s.geoPointValue.longitude)===ct(i.geoPointValue.longitude)}(t,e);case 2:return function(s,i){if("integerValue"in s&&"integerValue"in i)return ct(s.integerValue)===ct(i.integerValue);if("doubleValue"in s&&"doubleValue"in i){const o=ct(s.doubleValue),a=ct(i.doubleValue);return o===a?Cc(o)===Cc(a):isNaN(o)&&isNaN(a)}return!1}(t,e);case 9:return ba(t.arrayValue.values||[],e.arrayValue.values||[],Kr);case 10:case 11:return function(s,i){const o=s.mapValue.fields||{},a=i.mapValue.fields||{};if(NE(o)!==NE(a))return!1;for(const l in o)if(o.hasOwnProperty(l)&&(a[l]===void 0||!Kr(o[l],a[l])))return!1;return!0}(t,e);default:return le(52216,{left:t})}}function kc(t,e){return(t.values||[]).find(n=>Kr(n,e))!==void 0}function li(t,e){if(t===e)return 0;const n=ai(t),r=ai(e);if(n!==r)return Te(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return Te(t.booleanValue,e.booleanValue);case 2:return function(i,o){const a=ct(i.integerValue||i.doubleValue),l=ct(o.integerValue||o.doubleValue);return a<l?-1:a>l?1:a===l?0:isNaN(a)?isNaN(l)?0:-1:1}(t,e);case 3:return DE(t.timestampValue,e.timestampValue);case 4:return DE(Nc(t),Nc(e));case 5:return Gm(t.stringValue,e.stringValue);case 6:return function(i,o){const a=fs(i),l=fs(o);return a.compareTo(l)}(t.bytesValue,e.bytesValue);case 7:return function(i,o){const a=i.split("/"),l=o.split("/");for(let d=0;d<a.length&&d<l.length;d++){const h=Te(a[d],l[d]);if(h!==0)return h}return Te(a.length,l.length)}(t.referenceValue,e.referenceValue);case 8:return function(i,o){const a=Te(ct(i.latitude),ct(o.latitude));return a!==0?a:Te(ct(i.longitude),ct(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return jE(t.arrayValue,e.arrayValue);case 10:return function(i,o){var m,_,A,R;const a=i.fields||{},l=o.fields||{},d=(m=a[Na])==null?void 0:m.arrayValue,h=(_=l[Na])==null?void 0:_.arrayValue,f=Te(((A=d==null?void 0:d.values)==null?void 0:A.length)||0,((R=h==null?void 0:h.values)==null?void 0:R.length)||0);return f!==0?f:jE(d,h)}(t.mapValue,e.mapValue);case 11:return function(i,o){if(i===qs.mapValue&&o===qs.mapValue)return 0;if(i===qs.mapValue)return 1;if(o===qs.mapValue)return-1;const a=i.fields||{},l=Object.keys(a),d=o.fields||{},h=Object.keys(d);l.sort(),h.sort();for(let f=0;f<l.length&&f<h.length;++f){const m=Gm(l[f],h[f]);if(m!==0)return m;const _=li(a[l[f]],d[h[f]]);if(_!==0)return _}return Te(l.length,h.length)}(t.mapValue,e.mapValue);default:throw le(23264,{he:n})}}function DE(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return Te(t,e);const n=hs(t),r=hs(e),s=Te(n.seconds,r.seconds);return s!==0?s:Te(n.nanos,r.nanos)}function jE(t,e){const n=t.values||[],r=e.values||[];for(let s=0;s<n.length&&s<r.length;++s){const i=li(n[s],r[s]);if(i)return i}return Te(n.length,r.length)}function ka(t){return eg(t)}function eg(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=hs(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return fs(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return ne.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",s=!0;for(const i of n.values||[])s?s=!1:r+=",",r+=eg(i);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let s="{",i=!0;for(const o of r)i?i=!1:s+=",",s+=`${o}:${eg(n.fields[o])}`;return s+"}"}(t.mapValue):le(61005,{value:t})}function yd(t){switch(ai(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=of(t);return e?16+yd(e):16;case 5:return 2*t.stringValue.length;case 6:return fs(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return function(r){return(r.values||[]).reduce((s,i)=>s+yd(i),0)}(t.arrayValue);case 10:case 11:return function(r){let s=0;return vi(r.fields,(i,o)=>{s+=i.length+yd(o)}),s}(t.mapValue);default:throw le(13486,{value:t})}}function oo(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function tg(t){return!!t&&"integerValue"in t}function Dc(t){return!!t&&"arrayValue"in t}function OE(t){return!!t&&"nullValue"in t}function VE(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function _d(t){return!!t&&"mapValue"in t}function af(t){var n,r;return((r=(((n=t==null?void 0:t.mapValue)==null?void 0:n.fields)||{})[qy])==null?void 0:r.stringValue)===Hy}function ec(t){if(t.geoPointValue)return{geoPointValue:{...t.geoPointValue}};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:{...t.timestampValue}};if(t.mapValue){const e={mapValue:{fields:{}}};return vi(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=ec(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=ec(t.arrayValue.values[n]);return e}return{...t}}function Cb(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===bb}const Ab={mapValue:{fields:{[qy]:{stringValue:Hy},[Na]:{arrayValue:{}}}}};function WO(t){return"nullValue"in t?gd:"booleanValue"in t?{booleanValue:!1}:"integerValue"in t||"doubleValue"in t?{doubleValue:NaN}:"timestampValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in t?{stringValue:""}:"bytesValue"in t?{bytesValue:""}:"referenceValue"in t?oo(io.empty(),ne.empty()):"geoPointValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in t?{arrayValue:{}}:"mapValue"in t?af(t)?Ab:{mapValue:{}}:le(35942,{value:t})}function KO(t){return"nullValue"in t?{booleanValue:!1}:"booleanValue"in t?{doubleValue:NaN}:"integerValue"in t||"doubleValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in t?{stringValue:""}:"stringValue"in t?{bytesValue:""}:"bytesValue"in t?oo(io.empty(),ne.empty()):"referenceValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in t?{arrayValue:{}}:"arrayValue"in t?Ab:"mapValue"in t?af(t)?{mapValue:{}}:qs:le(61959,{value:t})}function LE(t,e){const n=li(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?-1:!t.inclusive&&e.inclusive?1:0}function ME(t,e){const n=li(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?1:!t.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sn{constructor(e){this.value=e}static empty(){return new sn({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!_d(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=ec(n)}setAll(e){let n=pt.emptyPath(),r={},s=[];e.forEach((o,a)=>{if(!n.isImmediateParentOf(a)){const l=this.getFieldsMap(n);this.applyChanges(l,r,s),r={},s=[],n=a.popLast()}o?r[a.lastSegment()]=ec(o):s.push(a.lastSegment())});const i=this.getFieldsMap(n);this.applyChanges(i,r,s)}delete(e){const n=this.field(e.popLast());_d(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return Kr(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let s=n.mapValue.fields[e.get(r)];_d(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=s),n=s}return n.mapValue.fields}applyChanges(e,n,r){vi(n,(s,i)=>e[s]=i);for(const s of r)delete e[s]}clone(){return new sn(ec(this.value))}}function Rb(t){const e=[];return vi(t.fields,(n,r)=>{const s=new pt([n]);if(_d(r)){const i=Rb(r.mapValue).fields;if(i.length===0)e.push(s);else for(const o of i)e.push(s.child(o))}else e.push(s)}),new An(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vt{constructor(e,n,r,s,i,o,a){this.key=e,this.documentType=n,this.version=r,this.readTime=s,this.createTime=i,this.data=o,this.documentState=a}static newInvalidDocument(e){return new vt(e,0,fe.min(),fe.min(),fe.min(),sn.empty(),0)}static newFoundDocument(e,n,r,s){return new vt(e,1,n,fe.min(),r,s,0)}static newNoDocument(e,n){return new vt(e,2,n,fe.min(),fe.min(),sn.empty(),0)}static newUnknownDocument(e,n){return new vt(e,3,n,fe.min(),fe.min(),sn.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(fe.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=sn.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=sn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=fe.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof vt&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new vt(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ci{constructor(e,n){this.position=e,this.inclusive=n}}function FE(t,e,n){let r=0;for(let s=0;s<t.position.length;s++){const i=e[s],o=t.position[s];if(i.field.isKeyField()?r=ne.comparator(ne.fromName(o.referenceValue),n.key):r=li(o,n.data.field(i.field)),i.dir==="desc"&&(r*=-1),r!==0)break}return r}function UE(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!Kr(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jc{constructor(e,n="asc"){this.field=e,this.dir=n}}function GO(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pb{}class Me extends Pb{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new QO(e,n,r):n==="array-contains"?new JO(e,r):n==="in"?new Vb(e,r):n==="not-in"?new ZO(e,r):n==="array-contains-any"?new eV(e,r):new Me(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new YO(e,r):new XO(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&n.nullValue===void 0&&this.matchesComparison(li(n,this.value)):n!==null&&ai(this.value)===ai(n)&&this.matchesComparison(li(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return le(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Ye extends Pb{constructor(e,n){super(),this.filters=e,this.op=n,this.Pe=null}static create(e,n){return new Ye(e,n)}matches(e){return Da(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function Da(t){return t.op==="and"}function ng(t){return t.op==="or"}function Wy(t){return Nb(t)&&Da(t)}function Nb(t){for(const e of t.filters)if(e instanceof Ye)return!1;return!0}function rg(t){if(t instanceof Me)return t.field.canonicalString()+t.op.toString()+ka(t.value);if(Wy(t))return t.filters.map(e=>rg(e)).join(",");{const e=t.filters.map(n=>rg(n)).join(",");return`${t.op}(${e})`}}function kb(t,e){return t instanceof Me?function(r,s){return s instanceof Me&&r.op===s.op&&r.field.isEqual(s.field)&&Kr(r.value,s.value)}(t,e):t instanceof Ye?function(r,s){return s instanceof Ye&&r.op===s.op&&r.filters.length===s.filters.length?r.filters.reduce((i,o,a)=>i&&kb(o,s.filters[a]),!0):!1}(t,e):void le(19439)}function Db(t,e){const n=t.filters.concat(e);return Ye.create(n,t.op)}function jb(t){return t instanceof Me?function(n){return`${n.field.canonicalString()} ${n.op} ${ka(n.value)}`}(t):t instanceof Ye?function(n){return n.op.toString()+" {"+n.getFilters().map(jb).join(" ,")+"}"}(t):"Filter"}class QO extends Me{constructor(e,n,r){super(e,n,r),this.key=ne.fromName(r.referenceValue)}matches(e){const n=ne.comparator(e.key,this.key);return this.matchesComparison(n)}}class YO extends Me{constructor(e,n){super(e,"in",n),this.keys=Ob("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class XO extends Me{constructor(e,n){super(e,"not-in",n),this.keys=Ob("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function Ob(t,e){var n;return(((n=e.arrayValue)==null?void 0:n.values)||[]).map(r=>ne.fromName(r.referenceValue))}class JO extends Me{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return Dc(n)&&kc(n.arrayValue,this.value)}}class Vb extends Me{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&kc(this.value.arrayValue,n)}}class ZO extends Me{constructor(e,n){super(e,"not-in",n)}matches(e){if(kc(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&n.nullValue===void 0&&!kc(this.value.arrayValue,n)}}class eV extends Me{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!Dc(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>kc(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tV{constructor(e,n=null,r=[],s=[],i=null,o=null,a=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=s,this.limit=i,this.startAt=o,this.endAt=a,this.Te=null}}function sg(t,e=null,n=[],r=[],s=null,i=null,o=null){return new tV(t,e,n,r,s,i,o)}function ao(t){const e=Ee(t);if(e.Te===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>rg(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(i){return i.field.canonicalString()+i.dir}(r)).join(","),ef(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>ka(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>ka(r)).join(",")),e.Te=n}return e.Te}function Qc(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!GO(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!kb(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!UE(t.startAt,e.startAt)&&UE(t.endAt,e.endAt)}function ch(t){return ne.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}function uh(t,e){return t.filters.filter(n=>n instanceof Me&&n.field.isEqual(e))}function $E(t,e,n){let r=gd,s=!0;for(const i of uh(t,e)){let o=gd,a=!0;switch(i.op){case"<":case"<=":o=WO(i.value);break;case"==":case"in":case">=":o=i.value;break;case">":o=i.value,a=!1;break;case"!=":case"not-in":o=gd}LE({value:r,inclusive:s},{value:o,inclusive:a})<0&&(r=o,s=a)}if(n!==null){for(let i=0;i<t.orderBy.length;++i)if(t.orderBy[i].field.isEqual(e)){const o=n.position[i];LE({value:r,inclusive:s},{value:o,inclusive:n.inclusive})<0&&(r=o,s=n.inclusive);break}}return{value:r,inclusive:s}}function BE(t,e,n){let r=qs,s=!0;for(const i of uh(t,e)){let o=qs,a=!0;switch(i.op){case">=":case">":o=KO(i.value),a=!1;break;case"==":case"in":case"<=":o=i.value;break;case"<":o=i.value,a=!1;break;case"!=":case"not-in":o=qs}ME({value:r,inclusive:s},{value:o,inclusive:a})>0&&(r=o,s=a)}if(n!==null){for(let i=0;i<t.orderBy.length;++i)if(t.orderBy[i].field.isEqual(e)){const o=n.position[i];ME({value:r,inclusive:s},{value:o,inclusive:n.inclusive})>0&&(r=o,s=n.inclusive);break}}return{value:r,inclusive:s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wi{constructor(e,n=null,r=[],s=[],i=null,o="F",a=null,l=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=s,this.limit=i,this.limitType=o,this.startAt=a,this.endAt=l,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function nV(t,e,n,r,s,i,o,a){return new wi(t,e,n,r,s,i,o,a)}function Yc(t){return new wi(t)}function zE(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function Ky(t){return t.collectionGroup!==null}function fa(t){const e=Ee(t);if(e.Ie===null){e.Ie=[];const n=new Set;for(const i of e.explicitOrderBy)e.Ie.push(i),n.add(i.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new Je(pt.comparator);return o.filters.forEach(l=>{l.getFlattenedFilters().forEach(d=>{d.isInequality()&&(a=a.add(d.field))})}),a})(e).forEach(i=>{n.has(i.canonicalString())||i.isKeyField()||e.Ie.push(new jc(i,r))}),n.has(pt.keyField().canonicalString())||e.Ie.push(new jc(pt.keyField(),r))}return e.Ie}function rr(t){const e=Ee(t);return e.Ee||(e.Ee=Lb(e,fa(t))),e.Ee}function rV(t){const e=Ee(t);return e.de||(e.de=Lb(e,t.explicitOrderBy)),e.de}function Lb(t,e){if(t.limitType==="F")return sg(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(s=>{const i=s.dir==="desc"?"asc":"desc";return new jc(s.field,i)});const n=t.endAt?new ci(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new ci(t.startAt.position,t.startAt.inclusive):null;return sg(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function ig(t,e){const n=t.filters.concat([e]);return new wi(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function dh(t,e,n){return new wi(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function lf(t,e){return Qc(rr(t),rr(e))&&t.limitType===e.limitType}function Mb(t){return`${ao(rr(t))}|lt:${t.limitType}`}function $o(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(s=>jb(s)).join(", ")}]`),ef(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(s=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(s)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(s=>ka(s)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(s=>ka(s)).join(",")),`Target(${r})`}(rr(t))}; limitType=${t.limitType})`}function Xc(t,e){return e.isFoundDocument()&&function(r,s){const i=s.key.path;return r.collectionGroup!==null?s.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(i):ne.isDocumentKey(r.path)?r.path.isEqual(i):r.path.isImmediateParentOf(i)}(t,e)&&function(r,s){for(const i of fa(r))if(!i.field.isKeyField()&&s.data.field(i.field)===null)return!1;return!0}(t,e)&&function(r,s){for(const i of r.filters)if(!i.matches(s))return!1;return!0}(t,e)&&function(r,s){return!(r.startAt&&!function(o,a,l){const d=FE(o,a,l);return o.inclusive?d<=0:d<0}(r.startAt,fa(r),s)||r.endAt&&!function(o,a,l){const d=FE(o,a,l);return o.inclusive?d>=0:d>0}(r.endAt,fa(r),s))}(t,e)}function sV(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function Fb(t){return(e,n)=>{let r=!1;for(const s of fa(t)){const i=iV(s,e,n);if(i!==0)return i;r=r||s.field.isKeyField()}return 0}}function iV(t,e,n){const r=t.field.isKeyField()?ne.comparator(e.key,n.key):function(i,o,a){const l=o.data.field(i),d=a.data.field(i);return l!==null&&d!==null?li(l,d):le(42886)}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return le(19790,{direction:t.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ms{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[s,i]of r)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),s=this.inner[r];if(s===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,n]);s.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return r.length===1?delete this.inner[n]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(e){vi(this.inner,(n,r)=>{for(const[s,i]of r)e(s,i)})}isEmpty(){return wb(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oV=new ht(ne.comparator);function $n(){return oV}const Ub=new ht(ne.comparator);function jl(...t){let e=Ub;for(const n of t)e=e.insert(n.key,n);return e}function $b(t){let e=Ub;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function Fr(){return tc()}function Bb(){return tc()}function tc(){return new ms(t=>t.toString(),(t,e)=>t.isEqual(e))}const aV=new ht(ne.comparator),lV=new Je(ne.comparator);function ke(...t){let e=lV;for(const n of t)e=e.add(n);return e}const cV=new Je(Te);function uV(){return cV}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gy(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Cc(e)?"-0":e}}function zb(t){return{integerValue:""+t}}function qb(t,e){return gO(e)?zb(e):Gy(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cf{constructor(){this._=void 0}}function dV(t,e,n){return t instanceof ja?function(s,i){const o={fields:{[Tb]:{stringValue:Ib},[Sb]:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return i&&sf(i)&&(i=of(i)),i&&(o.fields[xb]=i),{mapValue:o}}(n,e):t instanceof lo?Wb(t,e):t instanceof Oa?Kb(t,e):function(s,i){const o=Hb(s,i),a=qE(o)+qE(s.Ae);return tg(o)&&tg(s.Ae)?zb(a):Gy(s.serializer,a)}(t,e)}function hV(t,e,n){return t instanceof lo?Wb(t,e):t instanceof Oa?Kb(t,e):n}function Hb(t,e){return t instanceof Va?function(r){return tg(r)||function(i){return!!i&&"doubleValue"in i}(r)}(e)?e:{integerValue:0}:null}class ja extends cf{}class lo extends cf{constructor(e){super(),this.elements=e}}function Wb(t,e){const n=Gb(e);for(const r of t.elements)n.some(s=>Kr(s,r))||n.push(r);return{arrayValue:{values:n}}}class Oa extends cf{constructor(e){super(),this.elements=e}}function Kb(t,e){let n=Gb(e);for(const r of t.elements)n=n.filter(s=>!Kr(s,r));return{arrayValue:{values:n}}}class Va extends cf{constructor(e,n){super(),this.serializer=e,this.Ae=n}}function qE(t){return ct(t.integerValue||t.doubleValue)}function Gb(t){return Dc(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uf{constructor(e,n){this.field=e,this.transform=n}}function fV(t,e){return t.field.isEqual(e.field)&&function(r,s){return r instanceof lo&&s instanceof lo||r instanceof Oa&&s instanceof Oa?ba(r.elements,s.elements,Kr):r instanceof Va&&s instanceof Va?Kr(r.Ae,s.Ae):r instanceof ja&&s instanceof ja}(t.transform,e.transform)}class pV{constructor(e,n){this.version=e,this.transformResults=n}}class on{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new on}static exists(e){return new on(void 0,e)}static updateTime(e){return new on(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function vd(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class df{}function Qb(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new hf(t.key,on.none()):new Qa(t.key,t.data,on.none());{const n=t.data,r=sn.empty();let s=new Je(pt.comparator);for(let i of e.fields)if(!s.has(i)){let o=n.field(i);o===null&&i.length>1&&(i=i.popLast(),o=n.field(i)),o===null?r.delete(i):r.set(i,o),s=s.add(i)}return new gs(t.key,r,new An(s.toArray()),on.none())}}function mV(t,e,n){t instanceof Qa?function(s,i,o){const a=s.value.clone(),l=WE(s.fieldTransforms,i,o.transformResults);a.setAll(l),i.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(t,e,n):t instanceof gs?function(s,i,o){if(!vd(s.precondition,i))return void i.convertToUnknownDocument(o.version);const a=WE(s.fieldTransforms,i,o.transformResults),l=i.data;l.setAll(Yb(s)),l.setAll(a),i.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(t,e,n):function(s,i,o){i.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,n)}function nc(t,e,n,r){return t instanceof Qa?function(i,o,a,l){if(!vd(i.precondition,o))return a;const d=i.value.clone(),h=KE(i.fieldTransforms,l,o);return d.setAll(h),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),null}(t,e,n,r):t instanceof gs?function(i,o,a,l){if(!vd(i.precondition,o))return a;const d=KE(i.fieldTransforms,l,o),h=o.data;return h.setAll(Yb(i)),h.setAll(d),o.convertToFoundDocument(o.version,h).setHasLocalMutations(),a===null?null:a.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(f=>f.field))}(t,e,n,r):function(i,o,a){return vd(i.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(t,e,n)}function gV(t,e){let n=null;for(const r of t.fieldTransforms){const s=e.data.field(r.field),i=Hb(r.transform,s||null);i!=null&&(n===null&&(n=sn.empty()),n.set(r.field,i))}return n||null}function HE(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,s){return r===void 0&&s===void 0||!(!r||!s)&&ba(r,s,(i,o)=>fV(i,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class Qa extends df{constructor(e,n,r,s=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class gs extends df{constructor(e,n,r,s,i=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function Yb(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function WE(t,e,n){const r=new Map;he(t.length===n.length,32656,{Re:n.length,Ve:t.length});for(let s=0;s<n.length;s++){const i=t[s],o=i.transform,a=e.data.field(i.field);r.set(i.field,hV(o,a,n[s]))}return r}function KE(t,e,n){const r=new Map;for(const s of t){const i=s.transform,o=n.data.field(s.field);r.set(s.field,dV(i,o,e))}return r}class hf extends df{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Xb extends df{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qy{constructor(e,n,r,s){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&mV(i,e,r[s])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=nc(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=nc(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=Bb();return this.mutations.forEach(s=>{const i=e.get(s.key),o=i.overlayedDocument;let a=this.applyToLocalView(o,i.mutatedFields);a=n.has(s.key)?null:a;const l=Qb(o,a);l!==null&&r.set(s.key,l),o.isValidDocument()||o.convertToNoDocument(fe.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),ke())}isEqual(e){return this.batchId===e.batchId&&ba(this.mutations,e.mutations,(n,r)=>HE(n,r))&&ba(this.baseMutations,e.baseMutations,(n,r)=>HE(n,r))}}class Yy{constructor(e,n,r,s){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=s}static from(e,n,r){he(e.mutations.length===r.length,58842,{me:e.mutations.length,fe:r.length});let s=function(){return aV}();const i=e.mutations;for(let o=0;o<i.length;o++)s=s.insert(i[o].key,r[o].version);return new Yy(e,n,r,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xy{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yV{constructor(e,n,r){this.alias=e,this.aggregateType=n,this.fieldPath=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _V{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var bt,Ue;function vV(t){switch(t){case U.OK:return le(64938);case U.CANCELLED:case U.UNKNOWN:case U.DEADLINE_EXCEEDED:case U.RESOURCE_EXHAUSTED:case U.INTERNAL:case U.UNAVAILABLE:case U.UNAUTHENTICATED:return!1;case U.INVALID_ARGUMENT:case U.NOT_FOUND:case U.ALREADY_EXISTS:case U.PERMISSION_DENIED:case U.FAILED_PRECONDITION:case U.ABORTED:case U.OUT_OF_RANGE:case U.UNIMPLEMENTED:case U.DATA_LOSS:return!0;default:return le(15467,{code:t})}}function Jb(t){if(t===void 0)return mn("GRPC error has no .code"),U.UNKNOWN;switch(t){case bt.OK:return U.OK;case bt.CANCELLED:return U.CANCELLED;case bt.UNKNOWN:return U.UNKNOWN;case bt.DEADLINE_EXCEEDED:return U.DEADLINE_EXCEEDED;case bt.RESOURCE_EXHAUSTED:return U.RESOURCE_EXHAUSTED;case bt.INTERNAL:return U.INTERNAL;case bt.UNAVAILABLE:return U.UNAVAILABLE;case bt.UNAUTHENTICATED:return U.UNAUTHENTICATED;case bt.INVALID_ARGUMENT:return U.INVALID_ARGUMENT;case bt.NOT_FOUND:return U.NOT_FOUND;case bt.ALREADY_EXISTS:return U.ALREADY_EXISTS;case bt.PERMISSION_DENIED:return U.PERMISSION_DENIED;case bt.FAILED_PRECONDITION:return U.FAILED_PRECONDITION;case bt.ABORTED:return U.ABORTED;case bt.OUT_OF_RANGE:return U.OUT_OF_RANGE;case bt.UNIMPLEMENTED:return U.UNIMPLEMENTED;case bt.DATA_LOSS:return U.DATA_LOSS;default:return le(39323,{code:t})}}(Ue=bt||(bt={}))[Ue.OK=0]="OK",Ue[Ue.CANCELLED=1]="CANCELLED",Ue[Ue.UNKNOWN=2]="UNKNOWN",Ue[Ue.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ue[Ue.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ue[Ue.NOT_FOUND=5]="NOT_FOUND",Ue[Ue.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ue[Ue.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ue[Ue.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ue[Ue.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ue[Ue.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ue[Ue.ABORTED=10]="ABORTED",Ue[Ue.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ue[Ue.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ue[Ue.INTERNAL=13]="INTERNAL",Ue[Ue.UNAVAILABLE=14]="UNAVAILABLE",Ue[Ue.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wV(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EV=new ni([4294967295,4294967295],0);function GE(t){const e=wV().encode(t),n=new QS;return n.update(e),new Uint8Array(n.digest())}function QE(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),s=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new ni([n,r],0),new ni([s,i],0)]}class Jy{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new Ol(`Invalid padding: ${n}`);if(r<0)throw new Ol(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Ol(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new Ol(`Invalid padding when bitmap length is 0: ${n}`);this.ge=8*e.length-n,this.pe=ni.fromNumber(this.ge)}ye(e,n,r){let s=e.add(n.multiply(ni.fromNumber(r)));return s.compare(EV)===1&&(s=new ni([s.getBits(0),s.getBits(1)],0)),s.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const n=GE(e),[r,s]=QE(n);for(let i=0;i<this.hashCount;i++){const o=this.ye(r,s,i);if(!this.we(o))return!1}return!0}static create(e,n,r){const s=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),o=new Jy(i,s,n);return r.forEach(a=>o.insert(a)),o}insert(e){if(this.ge===0)return;const n=GE(e),[r,s]=QE(n);for(let i=0;i<this.hashCount;i++){const o=this.ye(r,s,i);this.Se(o)}}Se(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class Ol extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ff{constructor(e,n,r,s,i){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const s=new Map;return s.set(e,Jc.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new ff(fe.min(),s,new ht(Te),$n(),ke())}}class Jc{constructor(e,n,r,s,i){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new Jc(r,n,ke(),ke(),ke())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wd{constructor(e,n,r,s){this.be=e,this.removedTargetIds=n,this.key=r,this.De=s}}class Zb{constructor(e,n){this.targetId=e,this.Ce=n}}class eC{constructor(e,n,r=Rt.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=s}}class YE{constructor(){this.ve=0,this.Fe=XE(),this.Me=Rt.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=ke(),n=ke(),r=ke();return this.Fe.forEach((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:n=n.add(s);break;case 1:r=r.add(s);break;default:le(38017,{changeType:i})}}),new Jc(this.Me,this.xe,e,n,r)}qe(){this.Oe=!1,this.Fe=XE()}Qe(e,n){this.Oe=!0,this.Fe=this.Fe.insert(e,n)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,he(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class IV{constructor(e){this.Ge=e,this.ze=new Map,this.je=$n(),this.Je=Mu(),this.He=Mu(),this.Ye=new ht(Te)}Ze(e){for(const n of e.be)e.De&&e.De.isFoundDocument()?this.Xe(n,e.De):this.et(n,e.key,e.De);for(const n of e.removedTargetIds)this.et(n,e.key,e.De)}tt(e){this.forEachTarget(e,n=>{const r=this.nt(n);switch(e.state){case 0:this.rt(n)&&r.Le(e.resumeToken);break;case 1:r.Ke(),r.Ne||r.qe(),r.Le(e.resumeToken);break;case 2:r.Ke(),r.Ne||this.removeTarget(n);break;case 3:this.rt(n)&&(r.We(),r.Le(e.resumeToken));break;case 4:this.rt(n)&&(this.it(n),r.Le(e.resumeToken));break;default:le(56790,{state:e.state})}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.ze.forEach((r,s)=>{this.rt(s)&&n(s)})}st(e){const n=e.targetId,r=e.Ce.count,s=this.ot(n);if(s){const i=s.target;if(ch(i))if(r===0){const o=new ne(i.path);this.et(n,o,vt.newNoDocument(o,fe.min()))}else he(r===1,20013,{expectedCount:r});else{const o=this._t(n);if(o!==r){const a=this.ut(e),l=a?this.ct(a,e,o):1;if(l!==0){this.it(n);const d=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(n,d)}}}}}ut(e){const n=e.Ce.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:s=0},hashCount:i=0}=n;let o,a;try{o=fs(r).toUint8Array()}catch(l){if(l instanceof Eb)return so("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{a=new Jy(o,s,i)}catch(l){return so(l instanceof Ol?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return a.ge===0?null:a}ct(e,n,r){return n.Ce.count===r-this.Pt(e,n.targetId)?0:2}Pt(e,n){const r=this.Ge.getRemoteKeysForTarget(n);let s=0;return r.forEach(i=>{const o=this.Ge.ht(),a=`projects/${o.projectId}/databases/${o.database}/documents/${i.path.canonicalString()}`;e.mightContain(a)||(this.et(n,i,null),s++)}),s}Tt(e){const n=new Map;this.ze.forEach((i,o)=>{const a=this.ot(o);if(a){if(i.current&&ch(a.target)){const l=new ne(a.target.path);this.It(l).has(o)||this.Et(o,l)||this.et(o,l,vt.newNoDocument(l,e))}i.Be&&(n.set(o,i.ke()),i.qe())}});let r=ke();this.He.forEach((i,o)=>{let a=!0;o.forEachWhile(l=>{const d=this.ot(l);return!d||d.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(i))}),this.je.forEach((i,o)=>o.setReadTime(e));const s=new ff(e,n,this.Ye,this.je,r);return this.je=$n(),this.Je=Mu(),this.He=Mu(),this.Ye=new ht(Te),s}Xe(e,n){if(!this.rt(e))return;const r=this.Et(e,n.key)?2:0;this.nt(e).Qe(n.key,r),this.je=this.je.insert(n.key,n),this.Je=this.Je.insert(n.key,this.It(n.key).add(e)),this.He=this.He.insert(n.key,this.dt(n.key).add(e))}et(e,n,r){if(!this.rt(e))return;const s=this.nt(e);this.Et(e,n)?s.Qe(n,1):s.$e(n),this.He=this.He.insert(n,this.dt(n).delete(e)),this.He=this.He.insert(n,this.dt(n).add(e)),r&&(this.je=this.je.insert(n,r))}removeTarget(e){this.ze.delete(e)}_t(e){const n=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let n=this.ze.get(e);return n||(n=new YE,this.ze.set(e,n)),n}dt(e){let n=this.He.get(e);return n||(n=new Je(Te),this.He=this.He.insert(e,n)),n}It(e){let n=this.Je.get(e);return n||(n=new Je(Te),this.Je=this.Je.insert(e,n)),n}rt(e){const n=this.ot(e)!==null;return n||W("WatchChangeAggregator","Detected inactive target",e),n}ot(e){const n=this.ze.get(e);return n&&n.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new YE),this.Ge.getRemoteKeysForTarget(e).forEach(n=>{this.et(e,n,null)})}Et(e,n){return this.Ge.getRemoteKeysForTarget(e).has(n)}}function Mu(){return new ht(ne.comparator)}function XE(){return new ht(ne.comparator)}const TV={asc:"ASCENDING",desc:"DESCENDING"},xV={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},SV={and:"AND",or:"OR"};class bV{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function og(t,e){return t.useProto3Json||ef(e)?e:{value:e}}function La(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function tC(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function CV(t,e){return La(t,e.toTimestamp())}function vn(t){return he(!!t,49232),fe.fromTimestamp(function(n){const r=hs(n);return new Be(r.seconds,r.nanos)}(t))}function Zy(t,e){return ag(t,e).canonicalString()}function ag(t,e){const n=function(s){return new He(["projects",s.projectId,"databases",s.database])}(t).child("documents");return e===void 0?n:n.child(e)}function nC(t){const e=He.fromString(t);return he(uC(e),10190,{key:e.toString()}),e}function hh(t,e){return Zy(t.databaseId,e.path)}function Ki(t,e){const n=nC(e);if(n.get(1)!==t.databaseId.projectId)throw new Q(U.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new Q(U.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new ne(iC(n))}function rC(t,e){return Zy(t.databaseId,e)}function sC(t){const e=nC(t);return e.length===4?He.emptyPath():iC(e)}function lg(t){return new He(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function iC(t){return he(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function JE(t,e,n){return{name:hh(t,e),fields:n.value.mapValue.fields}}function AV(t,e,n){const r=Ki(t,e.name),s=vn(e.updateTime),i=e.createTime?vn(e.createTime):fe.min(),o=new sn({mapValue:{fields:e.fields}}),a=vt.newFoundDocument(r,s,i,o);return n&&a.setHasCommittedMutations(),n?a.setHasCommittedMutations():a}function RV(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(d){return d==="NO_CHANGE"?0:d==="ADD"?1:d==="REMOVE"?2:d==="CURRENT"?3:d==="RESET"?4:le(39313,{state:d})}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=function(d,h){return d.useProto3Json?(he(h===void 0||typeof h=="string",58123),Rt.fromBase64String(h||"")):(he(h===void 0||h instanceof Buffer||h instanceof Uint8Array,16193),Rt.fromUint8Array(h||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(d){const h=d.code===void 0?U.UNKNOWN:Jb(d.code);return new Q(h,d.message||"")}(o);n=new eC(r,s,i,a||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const s=Ki(t,r.document.name),i=vn(r.document.updateTime),o=r.document.createTime?vn(r.document.createTime):fe.min(),a=new sn({mapValue:{fields:r.document.fields}}),l=vt.newFoundDocument(s,i,o,a),d=r.targetIds||[],h=r.removedTargetIds||[];n=new wd(d,h,l.key,l)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const s=Ki(t,r.document),i=r.readTime?vn(r.readTime):fe.min(),o=vt.newNoDocument(s,i),a=r.removedTargetIds||[];n=new wd([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const s=Ki(t,r.document),i=r.removedTargetIds||[];n=new wd([],i,s,null)}else{if(!("filter"in e))return le(11601,{Rt:e});{e.filter;const r=e.filter;r.targetId;const{count:s=0,unchangedNames:i}=r,o=new _V(s,i),a=r.targetId;n=new Zb(a,o)}}return n}function fh(t,e){let n;if(e instanceof Qa)n={update:JE(t,e.key,e.value)};else if(e instanceof hf)n={delete:hh(t,e.key)};else if(e instanceof gs)n={update:JE(t,e.key,e.data),updateMask:VV(e.fieldMask)};else{if(!(e instanceof Xb))return le(16599,{Vt:e.type});n={verify:hh(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(i,o){const a=o.transform;if(a instanceof ja)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof lo)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof Oa)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof Va)return{fieldPath:o.field.canonicalString(),increment:a.Ae};throw le(20930,{transform:o.transform})}(0,r))),e.precondition.isNone||(n.currentDocument=function(s,i){return i.updateTime!==void 0?{updateTime:CV(s,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:le(27497)}(t,e.precondition)),n}function cg(t,e){const n=e.currentDocument?function(i){return i.updateTime!==void 0?on.updateTime(vn(i.updateTime)):i.exists!==void 0?on.exists(i.exists):on.none()}(e.currentDocument):on.none(),r=e.updateTransforms?e.updateTransforms.map(s=>function(o,a){let l=null;if("setToServerValue"in a)he(a.setToServerValue==="REQUEST_TIME",16630,{proto:a}),l=new ja;else if("appendMissingElements"in a){const h=a.appendMissingElements.values||[];l=new lo(h)}else if("removeAllFromArray"in a){const h=a.removeAllFromArray.values||[];l=new Oa(h)}else"increment"in a?l=new Va(o,a.increment):le(16584,{proto:a});const d=pt.fromServerFormat(a.fieldPath);return new uf(d,l)}(t,s)):[];if(e.update){e.update.name;const s=Ki(t,e.update.name),i=new sn({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=function(l){const d=l.fieldPaths||[];return new An(d.map(h=>pt.fromServerFormat(h)))}(e.updateMask);return new gs(s,i,o,n,r)}return new Qa(s,i,n,r)}if(e.delete){const s=Ki(t,e.delete);return new hf(s,n)}if(e.verify){const s=Ki(t,e.verify);return new Xb(s,n)}return le(1463,{proto:e})}function PV(t,e){return t&&t.length>0?(he(e!==void 0,14353),t.map(n=>function(s,i){let o=s.updateTime?vn(s.updateTime):vn(i);return o.isEqual(fe.min())&&(o=vn(i)),new pV(o,s.transformResults||[])}(n,e))):[]}function oC(t,e){return{documents:[rC(t,e.path)]}}function e_(t,e){const n={structuredQuery:{}},r=e.path;let s;e.collectionGroup!==null?(s=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=rC(t,s);const i=function(d){if(d.length!==0)return cC(Ye.create(d,"and"))}(e.filters);i&&(n.structuredQuery.where=i);const o=function(d){if(d.length!==0)return d.map(h=>function(m){return{field:Fs(m.field),direction:DV(m.dir)}}(h))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);const a=og(t,e.limit);return a!==null&&(n.structuredQuery.limit=a),e.startAt&&(n.structuredQuery.startAt=function(d){return{before:d.inclusive,values:d.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(d){return{before:!d.inclusive,values:d.position}}(e.endAt)),{ft:n,parent:s}}function NV(t,e,n,r){const{ft:s,parent:i}=e_(t,e),o={},a=[];let l=0;return n.forEach(d=>{const h="aggregate_"+l++;o[h]=d.alias,d.aggregateType==="count"?a.push({alias:h,count:{}}):d.aggregateType==="avg"?a.push({alias:h,avg:{field:Fs(d.fieldPath)}}):d.aggregateType==="sum"&&a.push({alias:h,sum:{field:Fs(d.fieldPath)}})}),{request:{structuredAggregationQuery:{aggregations:a,structuredQuery:s.structuredQuery},parent:s.parent},gt:o,parent:i}}function aC(t){let e=sC(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let s=null;if(r>0){he(r===1,65062);const h=n.from[0];h.allDescendants?s=h.collectionId:e=e.child(h.collectionId)}let i=[];n.where&&(i=function(f){const m=lC(f);return m instanceof Ye&&Wy(m)?m.getFilters():[m]}(n.where));let o=[];n.orderBy&&(o=function(f){return f.map(m=>function(A){return new jc(Bo(A.field),function(C){switch(C){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(A.direction))}(m))}(n.orderBy));let a=null;n.limit&&(a=function(f){let m;return m=typeof f=="object"?f.value:f,ef(m)?null:m}(n.limit));let l=null;n.startAt&&(l=function(f){const m=!!f.before,_=f.values||[];return new ci(_,m)}(n.startAt));let d=null;return n.endAt&&(d=function(f){const m=!f.before,_=f.values||[];return new ci(_,m)}(n.endAt)),nV(e,s,o,i,a,"F",l,d)}function kV(t,e){const n=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return le(28987,{purpose:s})}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function lC(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=Bo(n.unaryFilter.field);return Me.create(r,"==",{doubleValue:NaN});case"IS_NULL":const s=Bo(n.unaryFilter.field);return Me.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=Bo(n.unaryFilter.field);return Me.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=Bo(n.unaryFilter.field);return Me.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return le(61313);default:return le(60726)}}(t):t.fieldFilter!==void 0?function(n){return Me.create(Bo(n.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return le(58110);default:return le(50506)}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return Ye.create(n.compositeFilter.filters.map(r=>lC(r)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return le(1026)}}(n.compositeFilter.op))}(t):le(30097,{filter:t})}function DV(t){return TV[t]}function jV(t){return xV[t]}function OV(t){return SV[t]}function Fs(t){return{fieldPath:t.canonicalString()}}function Bo(t){return pt.fromServerFormat(t.fieldPath)}function cC(t){return t instanceof Me?function(n){if(n.op==="=="){if(VE(n.value))return{unaryFilter:{field:Fs(n.field),op:"IS_NAN"}};if(OE(n.value))return{unaryFilter:{field:Fs(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(VE(n.value))return{unaryFilter:{field:Fs(n.field),op:"IS_NOT_NAN"}};if(OE(n.value))return{unaryFilter:{field:Fs(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Fs(n.field),op:jV(n.op),value:n.value}}}(t):t instanceof Ye?function(n){const r=n.getFilters().map(s=>cC(s));return r.length===1?r[0]:{compositeFilter:{op:OV(n.op),filters:r}}}(t):le(54877,{filter:t})}function VV(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function uC(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ts{constructor(e,n,r,s,i=fe.min(),o=fe.min(),a=Rt.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=l}withSequenceNumber(e){return new ts(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new ts(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new ts(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new ts(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dC{constructor(e){this.yt=e}}function LV(t,e){let n;if(e.document)n=AV(t.yt,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=ne.fromSegments(e.noDocument.path),s=uo(e.noDocument.readTime);n=vt.newNoDocument(r,s),e.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!e.unknownDocument)return le(56709);{const r=ne.fromSegments(e.unknownDocument.path),s=uo(e.unknownDocument.version);n=vt.newUnknownDocument(r,s)}}return e.readTime&&n.setReadTime(function(s){const i=new Be(s[0],s[1]);return fe.fromTimestamp(i)}(e.readTime)),n}function ZE(t,e){const n=e.key,r={prefixPath:n.getCollectionPath().popLast().toArray(),collectionGroup:n.collectionGroup,documentId:n.path.lastSegment(),readTime:ph(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=function(i,o){return{name:hh(i,o.key),fields:o.data.value.mapValue.fields,updateTime:La(i,o.version.toTimestamp()),createTime:La(i,o.createTime.toTimestamp())}}(t.yt,e);else if(e.isNoDocument())r.noDocument={path:n.path.toArray(),readTime:co(e.version)};else{if(!e.isUnknownDocument())return le(57904,{document:e});r.unknownDocument={path:n.path.toArray(),version:co(e.version)}}return r}function ph(t){const e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function co(t){const e=t.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function uo(t){const e=new Be(t.seconds,t.nanoseconds);return fe.fromTimestamp(e)}function ji(t,e){const n=(e.baseMutations||[]).map(i=>cg(t.yt,i));for(let i=0;i<e.mutations.length-1;++i){const o=e.mutations[i];if(i+1<e.mutations.length&&e.mutations[i+1].transform!==void 0){const a=e.mutations[i+1];o.updateTransforms=a.transform.fieldTransforms,e.mutations.splice(i+1,1),++i}}const r=e.mutations.map(i=>cg(t.yt,i)),s=Be.fromMillis(e.localWriteTimeMs);return new Qy(e.batchId,s,n,r)}function Vl(t){const e=uo(t.readTime),n=t.lastLimboFreeSnapshotVersion!==void 0?uo(t.lastLimboFreeSnapshotVersion):fe.min();let r;return r=function(i){return i.documents!==void 0}(t.query)?function(i){const o=i.documents.length;return he(o===1,1966,{count:o}),rr(Yc(sC(i.documents[0])))}(t.query):function(i){return rr(aC(i))}(t.query),new ts(r,t.targetId,"TargetPurposeListen",t.lastListenSequenceNumber,e,n,Rt.fromBase64String(t.resumeToken))}function hC(t,e){const n=co(e.snapshotVersion),r=co(e.lastLimboFreeSnapshotVersion);let s;s=ch(e.target)?oC(t.yt,e.target):e_(t.yt,e.target).ft;const i=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:ao(e.target),readTime:n,resumeToken:i,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:s}}function fC(t){const e=aC({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?dh(e,e.limit,"L"):e}function Sp(t,e){return new Xy(e.largestBatchId,cg(t.yt,e.overlayMutation))}function eI(t,e){const n=e.path.lastSegment();return[t,ln(e.path.popLast()),n]}function tI(t,e,n,r){return{indexId:t,uid:e,sequenceNumber:n,readTime:co(r.readTime),documentKey:ln(r.documentKey.path),largestBatchId:r.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MV{getBundleMetadata(e,n){return nI(e).get(n).next(r=>{if(r)return function(i){return{id:i.bundleId,createTime:uo(i.createTime),version:i.version}}(r)})}saveBundleMetadata(e,n){return nI(e).put(function(s){return{bundleId:s.id,createTime:co(vn(s.createTime)),version:s.version}}(n))}getNamedQuery(e,n){return rI(e).get(n).next(r=>{if(r)return function(i){return{name:i.name,query:fC(i.bundledQuery),readTime:uo(i.readTime)}}(r)})}saveNamedQuery(e,n){return rI(e).put(function(s){return{name:s.name,readTime:co(vn(s.readTime)),bundledQuery:s.bundledQuery}}(n))}}function nI(t){return Lt(t,tf)}function rI(t){return Lt(t,nf)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pf{constructor(e,n){this.serializer=e,this.userId=n}static wt(e,n){const r=n.uid||"";return new pf(e,r)}getOverlay(e,n){return wl(e).get(eI(this.userId,n)).next(r=>r?Sp(this.serializer,r):null)}getOverlays(e,n){const r=Fr();return O.forEach(n,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,n,r){const s=[];return r.forEach((i,o)=>{const a=new Xy(n,o);s.push(this.St(e,a))}),O.waitFor(s)}removeOverlaysForBatchId(e,n,r){const s=new Set;n.forEach(o=>s.add(ln(o.getCollectionPath())));const i=[];return s.forEach(o=>{const a=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,r+1],!1,!0);i.push(wl(e).Z(Jm,a))}),O.waitFor(i)}getOverlaysForCollection(e,n,r){const s=Fr(),i=ln(n),o=IDBKeyRange.bound([this.userId,i,r],[this.userId,i,Number.POSITIVE_INFINITY],!0);return wl(e).J(Jm,o).next(a=>{for(const l of a){const d=Sp(this.serializer,l);s.set(d.getKey(),d)}return s})}getOverlaysForCollectionGroup(e,n,r,s){const i=Fr();let o;const a=IDBKeyRange.bound([this.userId,n,r],[this.userId,n,Number.POSITIVE_INFINITY],!0);return wl(e).ee({index:mb,range:a},(l,d,h)=>{const f=Sp(this.serializer,d);i.size()<s||f.largestBatchId===o?(i.set(f.getKey(),f),o=f.largestBatchId):h.done()}).next(()=>i)}St(e,n){return wl(e).put(function(s,i,o){const[a,l,d]=eI(i,o.mutation.key);return{userId:i,collectionPath:l,documentId:d,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:fh(s.yt,o.mutation)}}(this.serializer,this.userId,n))}}function wl(t){return Lt(t,rf)}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FV{bt(e){return Lt(e,By)}getSessionToken(e){return this.bt(e).get("sessionToken").next(n=>{const r=n==null?void 0:n.value;return r?Rt.fromUint8Array(r):Rt.EMPTY_BYTE_STRING})}setSessionToken(e,n){return this.bt(e).put({name:"sessionToken",value:n.toUint8Array()})}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oi{constructor(){}Dt(e,n){this.Ct(e,n),n.vt()}Ct(e,n){if("nullValue"in e)this.Ft(n,5);else if("booleanValue"in e)this.Ft(n,10),n.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(n,15),n.Mt(ct(e.integerValue));else if("doubleValue"in e){const r=ct(e.doubleValue);isNaN(r)?this.Ft(n,13):(this.Ft(n,15),Cc(r)?n.Mt(0):n.Mt(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Ft(n,20),typeof r=="string"&&(r=hs(r)),n.xt(`${r.seconds||""}`),n.Mt(r.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,n),this.Nt(n);else if("bytesValue"in e)this.Ft(n,30),n.Bt(fs(e.bytesValue)),this.Nt(n);else if("referenceValue"in e)this.Lt(e.referenceValue,n);else if("geoPointValue"in e){const r=e.geoPointValue;this.Ft(n,45),n.Mt(r.latitude||0),n.Mt(r.longitude||0)}else"mapValue"in e?Cb(e)?this.Ft(n,Number.MAX_SAFE_INTEGER):af(e)?this.kt(e.mapValue,n):(this.qt(e.mapValue,n),this.Nt(n)):"arrayValue"in e?(this.Qt(e.arrayValue,n),this.Nt(n)):le(19022,{$t:e})}Ot(e,n){this.Ft(n,25),this.Ut(e,n)}Ut(e,n){n.xt(e)}qt(e,n){const r=e.fields||{};this.Ft(n,55);for(const s of Object.keys(r))this.Ot(s,n),this.Ct(r[s],n)}kt(e,n){var o,a;const r=e.fields||{};this.Ft(n,53);const s=Na,i=((a=(o=r[s].arrayValue)==null?void 0:o.values)==null?void 0:a.length)||0;this.Ft(n,15),n.Mt(ct(i)),this.Ot(s,n),this.Ct(r[s],n)}Qt(e,n){const r=e.values||[];this.Ft(n,50);for(const s of r)this.Ct(s,n)}Lt(e,n){this.Ft(n,37),ne.fromName(e).path.forEach(r=>{this.Ft(n,60),this.Ut(r,n)})}Ft(e,n){e.Mt(n)}Nt(e){e.Mt(2)}}Oi.Kt=new Oi;/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law | agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES | CONDITIONS OF ANY KIND, either express | implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ro=255;function UV(t){if(t===0)return 8;let e=0;return t>>4||(e+=4,t<<=4),t>>6||(e+=2,t<<=2),t>>7||(e+=1),e}function sI(t){const e=64-function(r){let s=0;for(let i=0;i<8;++i){const o=UV(255&r[i]);if(s+=o,o!==8)break}return s}(t);return Math.ceil(e/8)}class $V{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Wt(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.Gt(r.value),r=n.next();this.zt()}jt(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.Jt(r.value),r=n.next();this.Ht()}Yt(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.Gt(r);else if(r<2048)this.Gt(960|r>>>6),this.Gt(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Gt(480|r>>>12),this.Gt(128|63&r>>>6),this.Gt(128|63&r);else{const s=n.codePointAt(0);this.Gt(240|s>>>18),this.Gt(128|63&s>>>12),this.Gt(128|63&s>>>6),this.Gt(128|63&s)}}this.zt()}Zt(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.Jt(r);else if(r<2048)this.Jt(960|r>>>6),this.Jt(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Jt(480|r>>>12),this.Jt(128|63&r>>>6),this.Jt(128|63&r);else{const s=n.codePointAt(0);this.Jt(240|s>>>18),this.Jt(128|63&s>>>12),this.Jt(128|63&s>>>6),this.Jt(128|63&s)}}this.Ht()}Xt(e){const n=this.en(e),r=sI(n);this.tn(1+r),this.buffer[this.position++]=255&r;for(let s=n.length-r;s<n.length;++s)this.buffer[this.position++]=255&n[s]}nn(e){const n=this.en(e),r=sI(n);this.tn(1+r),this.buffer[this.position++]=~(255&r);for(let s=n.length-r;s<n.length;++s)this.buffer[this.position++]=~(255&n[s])}rn(){this.sn(Ro),this.sn(255)}_n(){this.an(Ro),this.an(255)}reset(){this.position=0}seed(e){this.tn(e.length),this.buffer.set(e,this.position),this.position+=e.length}un(){return this.buffer.slice(0,this.position)}en(e){const n=function(i){const o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,i,!1),new Uint8Array(o.buffer)}(e),r=!!(128&n[0]);n[0]^=r?255:128;for(let s=1;s<n.length;++s)n[s]^=r?255:0;return n}Gt(e){const n=255&e;n===0?(this.sn(0),this.sn(255)):n===Ro?(this.sn(Ro),this.sn(0)):this.sn(n)}Jt(e){const n=255&e;n===0?(this.an(0),this.an(255)):n===Ro?(this.an(Ro),this.an(0)):this.an(e)}zt(){this.sn(0),this.sn(1)}Ht(){this.an(0),this.an(1)}sn(e){this.tn(1),this.buffer[this.position++]=e}an(e){this.tn(1),this.buffer[this.position++]=~e}tn(e){const n=e+this.position;if(n<=this.buffer.length)return;let r=2*this.buffer.length;r<n&&(r=n);const s=new Uint8Array(r);s.set(this.buffer),this.buffer=s}}class BV{constructor(e){this.cn=e}Bt(e){this.cn.Wt(e)}xt(e){this.cn.Yt(e)}Mt(e){this.cn.Xt(e)}vt(){this.cn.rn()}}class zV{constructor(e){this.cn=e}Bt(e){this.cn.jt(e)}xt(e){this.cn.Zt(e)}Mt(e){this.cn.nn(e)}vt(){this.cn._n()}}class El{constructor(){this.cn=new $V,this.ln=new BV(this.cn),this.hn=new zV(this.cn)}seed(e){this.cn.seed(e)}Pn(e){return e===0?this.ln:this.hn}un(){return this.cn.un()}reset(){this.cn.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vi{constructor(e,n,r,s){this.Tn=e,this.In=n,this.En=r,this.dn=s}An(){const e=this.dn.length,n=e===0||this.dn[e-1]===255?e+1:e,r=new Uint8Array(n);return r.set(this.dn,0),n!==e?r.set([0],this.dn.length):++r[r.length-1],new Vi(this.Tn,this.In,this.En,r)}Rn(e,n,r){return{indexId:this.Tn,uid:e,arrayValue:Ed(this.En),directionalValue:Ed(this.dn),orderedDocumentKey:Ed(n),documentKey:r.path.toArray()}}Vn(e,n,r){const s=this.Rn(e,n,r);return[s.indexId,s.uid,s.arrayValue,s.directionalValue,s.orderedDocumentKey,s.documentKey]}}function Cs(t,e){let n=t.Tn-e.Tn;return n!==0?n:(n=iI(t.En,e.En),n!==0?n:(n=iI(t.dn,e.dn),n!==0?n:ne.comparator(t.In,e.In)))}function iI(t,e){for(let n=0;n<t.length&&n<e.length;++n){const r=t[n]-e[n];if(r!==0)return r}return t.length-e.length}function Ed(t){return aS()?function(n){let r="";for(let s=0;s<n.length;s++)r+=String.fromCharCode(n[s]);return r}(t):t}function oI(t){return typeof t!="string"?t:function(n){const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}(t)}class aI{constructor(e){this.mn=new Je((n,r)=>pt.comparator(n.field,r.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.fn=e.orderBy,this.gn=[];for(const n of e.filters){const r=n;r.isInequality()?this.mn=this.mn.add(r):this.gn.push(r)}}get pn(){return this.mn.size>1}yn(e){if(he(e.collectionGroup===this.collectionId,49279),this.pn)return!1;const n=Qm(e);if(n!==void 0&&!this.wn(n))return!1;const r=Ni(e);let s=new Set,i=0,o=0;for(;i<r.length&&this.wn(r[i]);++i)s=s.add(r[i].fieldPath.canonicalString());if(i===r.length)return!0;if(this.mn.size>0){const a=this.mn.getIterator().getNext();if(!s.has(a.field.canonicalString())){const l=r[i];if(!this.Sn(a,l)||!this.bn(this.fn[o++],l))return!1}++i}for(;i<r.length;++i){const a=r[i];if(o>=this.fn.length||!this.bn(this.fn[o++],a))return!1}return!0}Dn(){if(this.pn)return null;let e=new Je(pt.comparator);const n=[];for(const r of this.gn)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")n.push(new fd(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),n.push(new fd(r.field,0))}for(const r of this.fn)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),n.push(new fd(r.field,r.dir==="asc"?0:1)));return new sh(sh.UNKNOWN_ID,this.collectionId,n,bc.empty())}wn(e){for(const n of this.gn)if(this.Sn(n,e))return!0;return!1}Sn(e,n){if(e===void 0||!e.field.isEqual(n.fieldPath))return!1;const r=e.op==="array-contains"||e.op==="array-contains-any";return n.kind===2===r}bn(e,n){return!!e.field.isEqual(n.fieldPath)&&(n.kind===0&&e.dir==="asc"||n.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pC(t){var n,r;if(he(t instanceof Me||t instanceof Ye,20012),t instanceof Me){if(t instanceof Vb){const s=((r=(n=t.value.arrayValue)==null?void 0:n.values)==null?void 0:r.map(i=>Me.create(t.field,"==",i)))||[];return Ye.create(s,"or")}return t}const e=t.filters.map(s=>pC(s));return Ye.create(e,t.op)}function qV(t){if(t.getFilters().length===0)return[];const e=hg(pC(t));return he(mC(e),7391),ug(e)||dg(e)?[e]:e.getFilters()}function ug(t){return t instanceof Me}function dg(t){return t instanceof Ye&&Wy(t)}function mC(t){return ug(t)||dg(t)||function(n){if(n instanceof Ye&&ng(n)){for(const r of n.getFilters())if(!ug(r)&&!dg(r))return!1;return!0}return!1}(t)}function hg(t){if(he(t instanceof Me||t instanceof Ye,34018),t instanceof Me)return t;if(t.filters.length===1)return hg(t.filters[0]);const e=t.filters.map(r=>hg(r));let n=Ye.create(e,t.op);return n=mh(n),mC(n)?n:(he(n instanceof Ye,64498),he(Da(n),40251),he(n.filters.length>1,57927),n.filters.reduce((r,s)=>t_(r,s)))}function t_(t,e){let n;return he(t instanceof Me||t instanceof Ye,38388),he(e instanceof Me||e instanceof Ye,25473),n=t instanceof Me?e instanceof Me?function(s,i){return Ye.create([s,i],"and")}(t,e):lI(t,e):e instanceof Me?lI(e,t):function(s,i){if(he(s.filters.length>0&&i.filters.length>0,48005),Da(s)&&Da(i))return Db(s,i.getFilters());const o=ng(s)?s:i,a=ng(s)?i:s,l=o.filters.map(d=>t_(d,a));return Ye.create(l,"or")}(t,e),mh(n)}function lI(t,e){if(Da(e))return Db(e,t.getFilters());{const n=e.filters.map(r=>t_(t,r));return Ye.create(n,"or")}}function mh(t){if(he(t instanceof Me||t instanceof Ye,11850),t instanceof Me)return t;const e=t.getFilters();if(e.length===1)return mh(e[0]);if(Nb(t))return t;const n=e.map(s=>mh(s)),r=[];return n.forEach(s=>{s instanceof Me?r.push(s):s instanceof Ye&&(s.op===t.op?r.push(...s.filters):r.push(s))}),r.length===1?r[0]:Ye.create(r,t.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HV{constructor(){this.Cn=new n_}addToCollectionParentIndex(e,n){return this.Cn.add(n),O.resolve()}getCollectionParents(e,n){return O.resolve(this.Cn.getEntries(n))}addFieldIndex(e,n){return O.resolve()}deleteFieldIndex(e,n){return O.resolve()}deleteAllFieldIndexes(e){return O.resolve()}createTargetIndexes(e,n){return O.resolve()}getDocumentsMatchingTarget(e,n){return O.resolve(null)}getIndexType(e,n){return O.resolve(0)}getFieldIndexes(e,n){return O.resolve([])}getNextCollectionGroupToUpdate(e){return O.resolve(null)}getMinOffset(e,n){return O.resolve(Hn.min())}getMinOffsetFromCollectionGroup(e,n){return O.resolve(Hn.min())}updateCollectionGroup(e,n,r){return O.resolve()}updateIndexEntries(e,n){return O.resolve()}}class n_{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n]||new Je(He.comparator),i=!s.has(r);return this.index[n]=s.add(r),i}has(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n];return s&&s.has(r)}getEntries(e){return(this.index[e]||new Je(He.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cI="IndexedDbIndexManager",Fu=new Uint8Array(0);class WV{constructor(e,n){this.databaseId=n,this.vn=new n_,this.Fn=new ms(r=>ao(r),(r,s)=>Qc(r,s)),this.uid=e.uid||""}addToCollectionParentIndex(e,n){if(!this.vn.has(n)){const r=n.lastSegment(),s=n.popLast();e.addOnCommittedListener(()=>{this.vn.add(n)});const i={collectionId:r,parent:ln(s)};return uI(e).put(i)}return O.resolve()}getCollectionParents(e,n){const r=[],s=IDBKeyRange.bound([n,""],[rb(n),""],!1,!0);return uI(e).J(s).next(i=>{for(const o of i){if(o.collectionId!==n)break;r.push(Mr(o.parent))}return r})}addFieldIndex(e,n){const r=Il(e),s=function(a){return{indexId:a.indexId,collectionGroup:a.collectionGroup,fields:a.fields.map(l=>[l.fieldPath.canonicalString(),l.kind])}}(n);delete s.indexId;const i=r.add(s);if(n.indexState){const o=No(e);return i.next(a=>{o.put(tI(a,this.uid,n.indexState.sequenceNumber,n.indexState.offset))})}return i.next()}deleteFieldIndex(e,n){const r=Il(e),s=No(e),i=Po(e);return r.delete(n.indexId).next(()=>s.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0))).next(()=>i.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){const n=Il(e),r=Po(e),s=No(e);return n.Z().next(()=>r.Z()).next(()=>s.Z())}createTargetIndexes(e,n){return O.forEach(this.Mn(n),r=>this.getIndexType(e,r).next(s=>{if(s===0||s===1){const i=new aI(r).Dn();if(i!=null)return this.addFieldIndex(e,i)}}))}getDocumentsMatchingTarget(e,n){const r=Po(e);let s=!0;const i=new Map;return O.forEach(this.Mn(n),o=>this.xn(e,o).next(a=>{s&&(s=!!a),i.set(o,a)})).next(()=>{if(s){let o=ke();const a=[];return O.forEach(i,(l,d)=>{W(cI,`Using index ${function(b){return`id=${b.indexId}|cg=${b.collectionGroup}|f=${b.fields.map(x=>`${x.fieldPath}:${x.kind}`).join(",")}`}(l)} to execute ${ao(n)}`);const h=function(b,x){const L=Qm(x);if(L===void 0)return null;for(const $ of uh(b,L.fieldPath))switch($.op){case"array-contains-any":return $.value.arrayValue.values||[];case"array-contains":return[$.value]}return null}(d,l),f=function(b,x){const L=new Map;for(const $ of Ni(x))for(const E of uh(b,$.fieldPath))switch(E.op){case"==":case"in":L.set($.fieldPath.canonicalString(),E.value);break;case"not-in":case"!=":return L.set($.fieldPath.canonicalString(),E.value),Array.from(L.values())}return null}(d,l),m=function(b,x){const L=[];let $=!0;for(const E of Ni(x)){const v=E.kind===0?$E(b,E.fieldPath,b.startAt):BE(b,E.fieldPath,b.startAt);L.push(v.value),$&&($=v.inclusive)}return new ci(L,$)}(d,l),_=function(b,x){const L=[];let $=!0;for(const E of Ni(x)){const v=E.kind===0?BE(b,E.fieldPath,b.endAt):$E(b,E.fieldPath,b.endAt);L.push(v.value),$&&($=v.inclusive)}return new ci(L,$)}(d,l),A=this.On(l,d,m),R=this.On(l,d,_),C=this.Nn(l,d,f),w=this.Bn(l.indexId,h,A,m.inclusive,R,_.inclusive,C);return O.forEach(w,I=>r.Y(I,n.limit).next(b=>{b.forEach(x=>{const L=ne.fromSegments(x.documentKey);o.has(L)||(o=o.add(L),a.push(L))})}))}).next(()=>a)}return O.resolve(null)})}Mn(e){let n=this.Fn.get(e);return n||(e.filters.length===0?n=[e]:n=qV(Ye.create(e.filters,"and")).map(r=>sg(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.Fn.set(e,n),n)}Bn(e,n,r,s,i,o,a){const l=(n!=null?n.length:1)*Math.max(r.length,i.length),d=l/(n!=null?n.length:1),h=[];for(let f=0;f<l;++f){const m=n?this.Ln(n[f/d]):Fu,_=this.kn(e,m,r[f%d],s),A=this.qn(e,m,i[f%d],o),R=a.map(C=>this.kn(e,m,C,!0));h.push(...this.createRange(_,A,R))}return h}kn(e,n,r,s){const i=new Vi(e,ne.empty(),n,r);return s?i:i.An()}qn(e,n,r,s){const i=new Vi(e,ne.empty(),n,r);return s?i.An():i}xn(e,n){const r=new aI(n),s=n.collectionGroup!=null?n.collectionGroup:n.path.lastSegment();return this.getFieldIndexes(e,s).next(i=>{let o=null;for(const a of i)r.yn(a)&&(!o||a.fields.length>o.fields.length)&&(o=a);return o})}getIndexType(e,n){let r=2;const s=this.Mn(n);return O.forEach(s,i=>this.xn(e,i).next(o=>{o?r!==0&&o.fields.length<function(l){let d=new Je(pt.comparator),h=!1;for(const f of l.filters)for(const m of f.getFlattenedFilters())m.field.isKeyField()||(m.op==="array-contains"||m.op==="array-contains-any"?h=!0:d=d.add(m.field));for(const f of l.orderBy)f.field.isKeyField()||(d=d.add(f.field));return d.size+(h?1:0)}(i)&&(r=1):r=0})).next(()=>function(o){return o.limit!==null}(n)&&s.length>1&&r===2?1:r)}Qn(e,n){const r=new El;for(const s of Ni(e)){const i=n.data.field(s.fieldPath);if(i==null)return null;const o=r.Pn(s.kind);Oi.Kt.Dt(i,o)}return r.un()}Ln(e){const n=new El;return Oi.Kt.Dt(e,n.Pn(0)),n.un()}$n(e,n){const r=new El;return Oi.Kt.Dt(oo(this.databaseId,n),r.Pn(function(i){const o=Ni(i);return o.length===0?0:o[o.length-1].kind}(e))),r.un()}Nn(e,n,r){if(r===null)return[];let s=[];s.push(new El);let i=0;for(const o of Ni(e)){const a=r[i++];for(const l of s)if(this.Un(n,o.fieldPath)&&Dc(a))s=this.Kn(s,o,a);else{const d=l.Pn(o.kind);Oi.Kt.Dt(a,d)}}return this.Wn(s)}On(e,n,r){return this.Nn(e,n,r.position)}Wn(e){const n=[];for(let r=0;r<e.length;++r)n[r]=e[r].un();return n}Kn(e,n,r){const s=[...e],i=[];for(const o of r.arrayValue.values||[])for(const a of s){const l=new El;l.seed(a.un()),Oi.Kt.Dt(o,l.Pn(n.kind)),i.push(l)}return i}Un(e,n){return!!e.filters.find(r=>r instanceof Me&&r.field.isEqual(n)&&(r.op==="in"||r.op==="not-in"))}getFieldIndexes(e,n){const r=Il(e),s=No(e);return(n?r.J(Xm,IDBKeyRange.bound(n,n)):r.J()).next(i=>{const o=[];return O.forEach(i,a=>s.get([a.indexId,this.uid]).next(l=>{o.push(function(h,f){const m=f?new bc(f.sequenceNumber,new Hn(uo(f.readTime),new ne(Mr(f.documentKey)),f.largestBatchId)):bc.empty(),_=h.fields.map(([A,R])=>new fd(pt.fromServerFormat(A),R));return new sh(h.indexId,h.collectionGroup,_,m)}(a,l))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(n=>n.length===0?null:(n.sort((r,s)=>{const i=r.indexState.sequenceNumber-s.indexState.sequenceNumber;return i!==0?i:Te(r.collectionGroup,s.collectionGroup)}),n[0].collectionGroup))}updateCollectionGroup(e,n,r){const s=Il(e),i=No(e);return this.Gn(e).next(o=>s.J(Xm,IDBKeyRange.bound(n,n)).next(a=>O.forEach(a,l=>i.put(tI(l.indexId,this.uid,o,r)))))}updateIndexEntries(e,n){const r=new Map;return O.forEach(n,(s,i)=>{const o=r.get(s.collectionGroup);return(o?O.resolve(o):this.getFieldIndexes(e,s.collectionGroup)).next(a=>(r.set(s.collectionGroup,a),O.forEach(a,l=>this.zn(e,s,l).next(d=>{const h=this.jn(i,l);return d.isEqual(h)?O.resolve():this.Jn(e,i,l,d,h)}))))})}Hn(e,n,r,s){return Po(e).put(s.Rn(this.uid,this.$n(r,n.key),n.key))}Yn(e,n,r,s){return Po(e).delete(s.Vn(this.uid,this.$n(r,n.key),n.key))}zn(e,n,r){const s=Po(e);let i=new Je(Cs);return s.ee({index:pb,range:IDBKeyRange.only([r.indexId,this.uid,Ed(this.$n(r,n))])},(o,a)=>{i=i.add(new Vi(r.indexId,n,oI(a.arrayValue),oI(a.directionalValue)))}).next(()=>i)}jn(e,n){let r=new Je(Cs);const s=this.Qn(n,e);if(s==null)return r;const i=Qm(n);if(i!=null){const o=e.data.field(i.fieldPath);if(Dc(o))for(const a of o.arrayValue.values||[])r=r.add(new Vi(n.indexId,e.key,this.Ln(a),s))}else r=r.add(new Vi(n.indexId,e.key,Fu,s));return r}Jn(e,n,r,s,i){W(cI,"Updating index entries for document '%s'",n.key);const o=[];return function(l,d,h,f,m){const _=l.getIterator(),A=d.getIterator();let R=Ao(_),C=Ao(A);for(;R||C;){let w=!1,I=!1;if(R&&C){const b=h(R,C);b<0?I=!0:b>0&&(w=!0)}else R!=null?I=!0:w=!0;w?(f(C),C=Ao(A)):I?(m(R),R=Ao(_)):(R=Ao(_),C=Ao(A))}}(s,i,Cs,a=>{o.push(this.Hn(e,n,r,a))},a=>{o.push(this.Yn(e,n,r,a))}),O.waitFor(o)}Gn(e){let n=1;return No(e).ee({index:fb,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,s,i)=>{i.done(),n=s.sequenceNumber+1}).next(()=>n)}createRange(e,n,r){r=r.sort((o,a)=>Cs(o,a)).filter((o,a,l)=>!a||Cs(o,l[a-1])!==0);const s=[];s.push(e);for(const o of r){const a=Cs(o,e),l=Cs(o,n);if(a===0)s[0]=e.An();else if(a>0&&l<0)s.push(o),s.push(o.An());else if(l>0)break}s.push(n);const i=[];for(let o=0;o<s.length;o+=2){if(this.Zn(s[o],s[o+1]))return[];const a=s[o].Vn(this.uid,Fu,ne.empty()),l=s[o+1].Vn(this.uid,Fu,ne.empty());i.push(IDBKeyRange.bound(a,l))}return i}Zn(e,n){return Cs(e,n)>0}getMinOffsetFromCollectionGroup(e,n){return this.getFieldIndexes(e,n).next(dI)}getMinOffset(e,n){return O.mapArray(this.Mn(n),r=>this.xn(e,r).next(s=>s||le(44426))).next(dI)}}function uI(t){return Lt(t,Pc)}function Po(t){return Lt(t,Zl)}function Il(t){return Lt(t,$y)}function No(t){return Lt(t,Jl)}function dI(t){he(t.length!==0,28825);let e=t[0].indexState.offset,n=e.largestBatchId;for(let r=1;r<t.length;r++){const s=t[r].indexState.offset;My(s,e)<0&&(e=s),n<s.largestBatchId&&(n=s.largestBatchId)}return new Hn(e.readTime,e.documentKey,n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hI={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},gC=41943040;class nn{static withCacheSize(e){return new nn(e,nn.DEFAULT_COLLECTION_PERCENTILE,nn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yC(t,e,n){const r=t.store(pr),s=t.store(Ca),i=[],o=IDBKeyRange.only(n.batchId);let a=0;const l=r.ee({range:o},(h,f,m)=>(a++,m.delete()));i.push(l.next(()=>{he(a===1,47070,{batchId:n.batchId})}));const d=[];for(const h of n.mutations){const f=ub(e,h.key.path,n.batchId);i.push(s.delete(f)),d.push(h.key)}return O.waitFor(i).next(()=>d)}function gh(t){if(!t)return 0;let e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw le(14731);e=t.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */nn.DEFAULT_COLLECTION_PERCENTILE=10,nn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,nn.DEFAULT=new nn(gC,nn.DEFAULT_COLLECTION_PERCENTILE,nn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),nn.DISABLED=new nn(-1,0,0);class mf{constructor(e,n,r,s){this.userId=e,this.serializer=n,this.indexManager=r,this.referenceDelegate=s,this.Xn={}}static wt(e,n,r,s){he(e.uid!=="",64387);const i=e.isAuthenticated()?e.uid:"";return new mf(i,n,r,s)}checkEmpty(e){let n=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return As(e).ee({index:$i,range:r},(s,i,o)=>{n=!1,o.done()}).next(()=>n)}addMutationBatch(e,n,r,s){const i=zo(e),o=As(e);return o.add({}).next(a=>{he(typeof a=="number",49019);const l=new Qy(a,n,r,s),d=function(_,A,R){const C=R.baseMutations.map(I=>fh(_.yt,I)),w=R.mutations.map(I=>fh(_.yt,I));return{userId:A,batchId:R.batchId,localWriteTimeMs:R.localWriteTime.toMillis(),baseMutations:C,mutations:w}}(this.serializer,this.userId,l),h=[];let f=new Je((m,_)=>Te(m.canonicalString(),_.canonicalString()));for(const m of s){const _=ub(this.userId,m.key.path,a);f=f.add(m.key.path.popLast()),h.push(o.put(d)),h.push(i.put(_,vO))}return f.forEach(m=>{h.push(this.indexManager.addToCollectionParentIndex(e,m))}),e.addOnCommittedListener(()=>{this.Xn[a]=l.keys()}),O.waitFor(h).next(()=>l)})}lookupMutationBatch(e,n){return As(e).get(n).next(r=>r?(he(r.userId===this.userId,48,"Unexpected user for mutation batch",{userId:r.userId,batchId:n}),ji(this.serializer,r)):null)}er(e,n){return this.Xn[n]?O.resolve(this.Xn[n]):this.lookupMutationBatch(e,n).next(r=>{if(r){const s=r.keys();return this.Xn[n]=s,s}return null})}getNextMutationBatchAfterBatchId(e,n){const r=n+1,s=IDBKeyRange.lowerBound([this.userId,r]);let i=null;return As(e).ee({index:$i,range:s},(o,a,l)=>{a.userId===this.userId&&(he(a.batchId>=r,47524,{tr:r}),i=ji(this.serializer,a)),l.done()}).next(()=>i)}getHighestUnacknowledgedBatchId(e){const n=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=Hi;return As(e).ee({index:$i,range:n,reverse:!0},(s,i,o)=>{r=i.batchId,o.done()}).next(()=>r)}getAllMutationBatches(e){const n=IDBKeyRange.bound([this.userId,Hi],[this.userId,Number.POSITIVE_INFINITY]);return As(e).J($i,n).next(r=>r.map(s=>ji(this.serializer,s)))}getAllMutationBatchesAffectingDocumentKey(e,n){const r=pd(this.userId,n.path),s=IDBKeyRange.lowerBound(r),i=[];return zo(e).ee({range:s},(o,a,l)=>{const[d,h,f]=o,m=Mr(h);if(d===this.userId&&n.path.isEqual(m))return As(e).get(f).next(_=>{if(!_)throw le(61480,{nr:o,batchId:f});he(_.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:_.userId,batchId:f}),i.push(ji(this.serializer,_))});l.done()}).next(()=>i)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Je(Te);const s=[];return n.forEach(i=>{const o=pd(this.userId,i.path),a=IDBKeyRange.lowerBound(o),l=zo(e).ee({range:a},(d,h,f)=>{const[m,_,A]=d,R=Mr(_);m===this.userId&&i.path.isEqual(R)?r=r.add(A):f.done()});s.push(l)}),O.waitFor(s).next(()=>this.rr(e,r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,s=r.length+1,i=pd(this.userId,r),o=IDBKeyRange.lowerBound(i);let a=new Je(Te);return zo(e).ee({range:o},(l,d,h)=>{const[f,m,_]=l,A=Mr(m);f===this.userId&&r.isPrefixOf(A)?A.length===s&&(a=a.add(_)):h.done()}).next(()=>this.rr(e,a))}rr(e,n){const r=[],s=[];return n.forEach(i=>{s.push(As(e).get(i).next(o=>{if(o===null)throw le(35274,{batchId:i});he(o.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:o.userId,batchId:i}),r.push(ji(this.serializer,o))}))}),O.waitFor(s).next(()=>r)}removeMutationBatch(e,n){return yC(e.le,this.userId,n).next(r=>(e.addOnCommittedListener(()=>{this.ir(n.batchId)}),O.forEach(r,s=>this.referenceDelegate.markPotentiallyOrphaned(e,s))))}ir(e){delete this.Xn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(n=>{if(!n)return O.resolve();const r=IDBKeyRange.lowerBound(function(o){return[o]}(this.userId)),s=[];return zo(e).ee({range:r},(i,o,a)=>{if(i[0]===this.userId){const l=Mr(i[1]);s.push(l)}else a.done()}).next(()=>{he(s.length===0,56720,{sr:s.map(i=>i.canonicalString())})})})}containsKey(e,n){return _C(e,this.userId,n)}_r(e){return vC(e).get(this.userId).next(n=>n||{userId:this.userId,lastAcknowledgedBatchId:Hi,lastStreamToken:""})}}function _C(t,e,n){const r=pd(e,n.path),s=r[1],i=IDBKeyRange.lowerBound(r);let o=!1;return zo(t).ee({range:i,X:!0},(a,l,d)=>{const[h,f,m]=a;h===e&&f===s&&(o=!0),d.done()}).next(()=>o)}function As(t){return Lt(t,pr)}function zo(t){return Lt(t,Ca)}function vC(t){return Lt(t,Ac)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ho{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new ho(0)}static cr(){return new ho(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KV{constructor(e,n){this.referenceDelegate=e,this.serializer=n}allocateTargetId(e){return this.lr(e).next(n=>{const r=new ho(n.highestTargetId);return n.highestTargetId=r.next(),this.hr(e,n).next(()=>n.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.lr(e).next(n=>fe.fromTimestamp(new Be(n.lastRemoteSnapshotVersion.seconds,n.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.lr(e).next(n=>n.highestListenSequenceNumber)}setTargetsMetadata(e,n,r){return this.lr(e).next(s=>(s.highestListenSequenceNumber=n,r&&(s.lastRemoteSnapshotVersion=r.toTimestamp()),n>s.highestListenSequenceNumber&&(s.highestListenSequenceNumber=n),this.hr(e,s)))}addTargetData(e,n){return this.Pr(e,n).next(()=>this.lr(e).next(r=>(r.targetCount+=1,this.Tr(n,r),this.hr(e,r))))}updateTargetData(e,n){return this.Pr(e,n)}removeTargetData(e,n){return this.removeMatchingKeysForTargetId(e,n.targetId).next(()=>ko(e).delete(n.targetId)).next(()=>this.lr(e)).next(r=>(he(r.targetCount>0,8065),r.targetCount-=1,this.hr(e,r)))}removeTargets(e,n,r){let s=0;const i=[];return ko(e).ee((o,a)=>{const l=Vl(a);l.sequenceNumber<=n&&r.get(l.targetId)===null&&(s++,i.push(this.removeTargetData(e,l)))}).next(()=>O.waitFor(i)).next(()=>s)}forEachTarget(e,n){return ko(e).ee((r,s)=>{const i=Vl(s);n(i)})}lr(e){return fI(e).get(ah).next(n=>(he(n!==null,2888),n))}hr(e,n){return fI(e).put(ah,n)}Pr(e,n){return ko(e).put(hC(this.serializer,n))}Tr(e,n){let r=!1;return e.targetId>n.highestTargetId&&(n.highestTargetId=e.targetId,r=!0),e.sequenceNumber>n.highestListenSequenceNumber&&(n.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.lr(e).next(n=>n.targetCount)}getTargetData(e,n){const r=ao(n),s=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let i=null;return ko(e).ee({range:s,index:hb},(o,a,l)=>{const d=Vl(a);Qc(n,d.target)&&(i=d,l.done())}).next(()=>i)}addMatchingKeys(e,n,r){const s=[],i=Us(e);return n.forEach(o=>{const a=ln(o.path);s.push(i.put({targetId:r,path:a})),s.push(this.referenceDelegate.addReference(e,r,o))}),O.waitFor(s)}removeMatchingKeys(e,n,r){const s=Us(e);return O.forEach(n,i=>{const o=ln(i.path);return O.waitFor([s.delete([r,o]),this.referenceDelegate.removeReference(e,r,i)])})}removeMatchingKeysForTargetId(e,n){const r=Us(e),s=IDBKeyRange.bound([n],[n+1],!1,!0);return r.delete(s)}getMatchingKeysForTargetId(e,n){const r=IDBKeyRange.bound([n],[n+1],!1,!0),s=Us(e);let i=ke();return s.ee({range:r,X:!0},(o,a,l)=>{const d=Mr(o[1]),h=new ne(d);i=i.add(h)}).next(()=>i)}containsKey(e,n){const r=ln(n.path),s=IDBKeyRange.bound([r],[rb(r)],!1,!0);let i=0;return Us(e).ee({index:Uy,X:!0,range:s},([o,a],l,d)=>{o!==0&&(i++,d.done())}).next(()=>i>0)}At(e,n){return ko(e).get(n).next(r=>r?Vl(r):null)}}function ko(t){return Lt(t,Aa)}function fI(t){return Lt(t,Wi)}function Us(t){return Lt(t,Ra)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pI="LruGarbageCollector",GV=1048576;function mI([t,e],[n,r]){const s=Te(t,n);return s===0?Te(e,r):s}class QV{constructor(e){this.Ir=e,this.buffer=new Je(mI),this.Er=0}dr(){return++this.Er}Ar(e){const n=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(n);else{const r=this.buffer.last();mI(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}}class wC{constructor(e,n,r){this.garbageCollector=e,this.asyncQueue=n,this.localStore=r,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){W(pI,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){_i(n)?W(pI,"Ignoring IndexedDB error during garbage collection: ",n):await Io(n)}await this.Vr(3e5)})}}class YV{constructor(e,n){this.mr=e,this.params=n}calculateTargetCount(e,n){return this.mr.gr(e).next(r=>Math.floor(n/100*r))}nthSequenceNumber(e,n){if(n===0)return O.resolve(tr.ce);const r=new QV(n);return this.mr.forEachTarget(e,s=>r.Ar(s.sequenceNumber)).next(()=>this.mr.pr(e,s=>r.Ar(s))).next(()=>r.maxValue)}removeTargets(e,n,r){return this.mr.removeTargets(e,n,r)}removeOrphanedDocuments(e,n){return this.mr.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(W("LruGarbageCollector","Garbage collection skipped; disabled"),O.resolve(hI)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(W("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),hI):this.yr(e,n))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,n){let r,s,i,o,a,l,d;const h=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(f=>(f>this.params.maximumSequenceNumbersToCollect?(W("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${f}`),s=this.params.maximumSequenceNumbersToCollect):s=f,o=Date.now(),this.nthSequenceNumber(e,s))).next(f=>(r=f,a=Date.now(),this.removeTargets(e,r,n))).next(f=>(i=f,l=Date.now(),this.removeOrphanedDocuments(e,r))).next(f=>(d=Date.now(),Uo()<=Le.DEBUG&&W("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-h}ms
	Determined least recently used ${s} in `+(a-o)+`ms
	Removed ${i} targets in `+(l-a)+`ms
	Removed ${f} documents in `+(d-l)+`ms
Total Duration: ${d-h}ms`),O.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:i,documentsRemoved:f})))}}function EC(t,e){return new YV(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XV{constructor(e,n){this.db=e,this.garbageCollector=EC(this,n)}gr(e){const n=this.wr(e);return this.db.getTargetCache().getTargetCount(e).next(r=>n.next(s=>r+s))}wr(e){let n=0;return this.pr(e,r=>{n++}).next(()=>n)}forEachTarget(e,n){return this.db.getTargetCache().forEachTarget(e,n)}pr(e,n){return this.Sr(e,(r,s)=>n(s))}addReference(e,n,r){return Uu(e,r)}removeReference(e,n,r){return Uu(e,r)}removeTargets(e,n,r){return this.db.getTargetCache().removeTargets(e,n,r)}markPotentiallyOrphaned(e,n){return Uu(e,n)}br(e,n){return function(s,i){let o=!1;return vC(s).te(a=>_C(s,a,i).next(l=>(l&&(o=!0),O.resolve(!l)))).next(()=>o)}(e,n)}removeOrphanedDocuments(e,n){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),s=[];let i=0;return this.Sr(e,(o,a)=>{if(a<=n){const l=this.br(e,o).next(d=>{if(!d)return i++,r.getEntry(e,o).next(()=>(r.removeEntry(o,fe.min()),Us(e).delete(function(f){return[0,ln(f.path)]}(o))))});s.push(l)}}).next(()=>O.waitFor(s)).next(()=>r.apply(e)).next(()=>i)}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,n){return Uu(e,n)}Sr(e,n){const r=Us(e);let s,i=tr.ce;return r.ee({index:Uy},([o,a],{path:l,sequenceNumber:d})=>{o===0?(i!==tr.ce&&n(new ne(Mr(s)),i),i=d,s=l):i=tr.ce}).next(()=>{i!==tr.ce&&n(new ne(Mr(s)),i)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function Uu(t,e){return Us(t).put(function(r,s){return{targetId:0,path:ln(r.path),sequenceNumber:s}}(e,t.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IC{constructor(){this.changes=new ms(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,vt.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?O.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JV{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,n,r){return Ci(e).put(r)}removeEntry(e,n,r){return Ci(e).delete(function(i,o){const a=i.path.toArray();return[a.slice(0,a.length-2),a[a.length-2],ph(o),a[a.length-1]]}(n,r))}updateMetadata(e,n){return this.getMetadata(e).next(r=>(r.byteSize+=n,this.Dr(e,r)))}getEntry(e,n){let r=vt.newInvalidDocument(n);return Ci(e).ee({index:md,range:IDBKeyRange.only(Tl(n))},(s,i)=>{r=this.Cr(n,i)}).next(()=>r)}vr(e,n){let r={size:0,document:vt.newInvalidDocument(n)};return Ci(e).ee({index:md,range:IDBKeyRange.only(Tl(n))},(s,i)=>{r={document:this.Cr(n,i),size:gh(i)}}).next(()=>r)}getEntries(e,n){let r=$n();return this.Fr(e,n,(s,i)=>{const o=this.Cr(s,i);r=r.insert(s,o)}).next(()=>r)}Mr(e,n){let r=$n(),s=new ht(ne.comparator);return this.Fr(e,n,(i,o)=>{const a=this.Cr(i,o);r=r.insert(i,a),s=s.insert(i,gh(o))}).next(()=>({documents:r,Or:s}))}Fr(e,n,r){if(n.isEmpty())return O.resolve();let s=new Je(_I);n.forEach(l=>s=s.add(l));const i=IDBKeyRange.bound(Tl(s.first()),Tl(s.last())),o=s.getIterator();let a=o.getNext();return Ci(e).ee({index:md,range:i},(l,d,h)=>{const f=ne.fromSegments([...d.prefixPath,d.collectionGroup,d.documentId]);for(;a&&_I(a,f)<0;)r(a,null),a=o.getNext();a&&a.isEqual(f)&&(r(a,d),a=o.hasNext()?o.getNext():null),a?h.j(Tl(a)):h.done()}).next(()=>{for(;a;)r(a,null),a=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,n,r,s,i){const o=n.path,a=[o.popLast().toArray(),o.lastSegment(),ph(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],l=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Ci(e).J(IDBKeyRange.bound(a,l,!0)).next(d=>{i==null||i.incrementDocumentReadCount(d.length);let h=$n();for(const f of d){const m=this.Cr(ne.fromSegments(f.prefixPath.concat(f.collectionGroup,f.documentId)),f);m.isFoundDocument()&&(Xc(n,m)||s.has(m.key))&&(h=h.insert(m.key,m))}return h})}getAllFromCollectionGroup(e,n,r,s){let i=$n();const o=yI(n,r),a=yI(n,Hn.max());return Ci(e).ee({index:db,range:IDBKeyRange.bound(o,a,!0)},(l,d,h)=>{const f=this.Cr(ne.fromSegments(d.prefixPath.concat(d.collectionGroup,d.documentId)),d);i=i.insert(f.key,f),i.size===s&&h.done()}).next(()=>i)}newChangeBuffer(e){return new ZV(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(n=>n.byteSize)}getMetadata(e){return gI(e).get(Ym).next(n=>(he(!!n,20021),n))}Dr(e,n){return gI(e).put(Ym,n)}Cr(e,n){if(n){const r=LV(this.serializer,n);if(!(r.isNoDocument()&&r.version.isEqual(fe.min())))return r}return vt.newInvalidDocument(e)}}function TC(t){return new JV(t)}class ZV extends IC{constructor(e,n){super(),this.Nr=e,this.trackRemovals=n,this.Br=new ms(r=>r.toString(),(r,s)=>r.isEqual(s))}applyChanges(e){const n=[];let r=0,s=new Je((i,o)=>Te(i.canonicalString(),o.canonicalString()));return this.changes.forEach((i,o)=>{const a=this.Br.get(i);if(n.push(this.Nr.removeEntry(e,i,a.readTime)),o.isValidDocument()){const l=ZE(this.Nr.serializer,o);s=s.add(i.path.popLast());const d=gh(l);r+=d-a.size,n.push(this.Nr.addEntry(e,i,l))}else if(r-=a.size,this.trackRemovals){const l=ZE(this.Nr.serializer,o.convertToNoDocument(fe.min()));n.push(this.Nr.addEntry(e,i,l))}}),s.forEach(i=>{n.push(this.Nr.indexManager.addToCollectionParentIndex(e,i))}),n.push(this.Nr.updateMetadata(e,r)),O.waitFor(n)}getFromCache(e,n){return this.Nr.vr(e,n).next(r=>(this.Br.set(n,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,n){return this.Nr.Mr(e,n).next(({documents:r,Or:s})=>(s.forEach((i,o)=>{this.Br.set(i,{size:o,readTime:r.get(i).readTime})}),r))}}function gI(t){return Lt(t,Rc)}function Ci(t){return Lt(t,oh)}function Tl(t){const e=t.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function yI(t,e){const n=e.documentKey.path.toArray();return[t,ph(e.readTime),n.slice(0,n.length-2),n.length>0?n[n.length-1]:""]}function _I(t,e){const n=t.path.toArray(),r=e.path.toArray();let s=0;for(let i=0;i<n.length-2&&i<r.length-2;++i)if(s=Te(n[i],r[i]),s)return s;return s=Te(n.length,r.length),s||(s=Te(n[n.length-2],r[r.length-2]),s||Te(n[n.length-1],r[r.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eL{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xC{constructor(e,n,r,s){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=s}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(s=>(r=s,this.remoteDocumentCache.getEntry(e,n))).next(s=>(r!==null&&nc(r.mutation,s,An.empty(),Be.now()),s))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,ke()).next(()=>r))}getLocalViewOfDocuments(e,n,r=ke()){const s=Fr();return this.populateOverlays(e,s,n).next(()=>this.computeViews(e,n,s,r).next(i=>{let o=jl();return i.forEach((a,l)=>{o=o.insert(a,l.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){const r=Fr();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,ke()))}populateOverlays(e,n,r){const s=[];return r.forEach(i=>{n.has(i)||s.push(i)}),this.documentOverlayCache.getOverlays(e,s).next(i=>{i.forEach((o,a)=>{n.set(o,a)})})}computeViews(e,n,r,s){let i=$n();const o=tc(),a=function(){return tc()}();return n.forEach((l,d)=>{const h=r.get(d.key);s.has(d.key)&&(h===void 0||h.mutation instanceof gs)?i=i.insert(d.key,d):h!==void 0?(o.set(d.key,h.mutation.getFieldMask()),nc(h.mutation,d,h.mutation.getFieldMask(),Be.now())):o.set(d.key,An.empty())}),this.recalculateAndSaveOverlays(e,i).next(l=>(l.forEach((d,h)=>o.set(d,h)),n.forEach((d,h)=>a.set(d,new eL(h,o.get(d)??null))),a))}recalculateAndSaveOverlays(e,n){const r=tc();let s=new ht((o,a)=>o-a),i=ke();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(const a of o)a.keys().forEach(l=>{const d=n.get(l);if(d===null)return;let h=r.get(l)||An.empty();h=a.applyToLocalView(d,h),r.set(l,h);const f=(s.get(a.batchId)||ke()).add(l);s=s.insert(a.batchId,f)})}).next(()=>{const o=[],a=s.getReverseIterator();for(;a.hasNext();){const l=a.getNext(),d=l.key,h=l.value,f=Bb();h.forEach(m=>{if(!i.has(m)){const _=Qb(n.get(m),r.get(m));_!==null&&f.set(m,_),i=i.add(m)}}),o.push(this.documentOverlayCache.saveOverlays(e,d,f))}return O.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,s){return function(o){return ne.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):Ky(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,s):this.getDocumentsMatchingCollectionQuery(e,n,r,s)}getNextDocuments(e,n,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,s).next(i=>{const o=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,s-i.size):O.resolve(Fr());let a=Sc,l=i;return o.next(d=>O.forEach(d,(h,f)=>(a<f.largestBatchId&&(a=f.largestBatchId),i.get(h)?O.resolve():this.remoteDocumentCache.getEntry(e,h).next(m=>{l=l.insert(h,m)}))).next(()=>this.populateOverlays(e,d,i)).next(()=>this.computeViews(e,l,d,ke())).next(h=>({batchId:a,changes:$b(h)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new ne(n)).next(r=>{let s=jl();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s})}getDocumentsMatchingCollectionGroupQuery(e,n,r,s){const i=n.collectionGroup;let o=jl();return this.indexManager.getCollectionParents(e,i).next(a=>O.forEach(a,l=>{const d=function(f,m){return new wi(m,null,f.explicitOrderBy.slice(),f.filters.slice(),f.limit,f.limitType,f.startAt,f.endAt)}(n,l.child(i));return this.getDocumentsMatchingCollectionQuery(e,d,r,s).next(h=>{h.forEach((f,m)=>{o=o.insert(f,m)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,n,r,s){let i;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(o=>(i=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,i,s))).next(o=>{i.forEach((l,d)=>{const h=d.getKey();o.get(h)===null&&(o=o.insert(h,vt.newInvalidDocument(h)))});let a=jl();return o.forEach((l,d)=>{const h=i.get(l);h!==void 0&&nc(h.mutation,d,An.empty(),Be.now()),Xc(n,d)&&(a=a.insert(l,d))}),a})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tL{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,n){return O.resolve(this.Lr.get(n))}saveBundleMetadata(e,n){return this.Lr.set(n.id,function(s){return{id:s.id,version:s.version,createTime:vn(s.createTime)}}(n)),O.resolve()}getNamedQuery(e,n){return O.resolve(this.kr.get(n))}saveNamedQuery(e,n){return this.kr.set(n.name,function(s){return{name:s.name,query:fC(s.bundledQuery),readTime:vn(s.readTime)}}(n)),O.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nL{constructor(){this.overlays=new ht(ne.comparator),this.qr=new Map}getOverlay(e,n){return O.resolve(this.overlays.get(n))}getOverlays(e,n){const r=Fr();return O.forEach(n,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((s,i)=>{this.St(e,n,i)}),O.resolve()}removeOverlaysForBatchId(e,n,r){const s=this.qr.get(r);return s!==void 0&&(s.forEach(i=>this.overlays=this.overlays.remove(i)),this.qr.delete(r)),O.resolve()}getOverlaysForCollection(e,n,r){const s=Fr(),i=n.length+1,o=new ne(n.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const l=a.getNext().value,d=l.getKey();if(!n.isPrefixOf(d.path))break;d.path.length===i&&l.largestBatchId>r&&s.set(l.getKey(),l)}return O.resolve(s)}getOverlaysForCollectionGroup(e,n,r,s){let i=new ht((d,h)=>d-h);const o=this.overlays.getIterator();for(;o.hasNext();){const d=o.getNext().value;if(d.getKey().getCollectionGroup()===n&&d.largestBatchId>r){let h=i.get(d.largestBatchId);h===null&&(h=Fr(),i=i.insert(d.largestBatchId,h)),h.set(d.getKey(),d)}}const a=Fr(),l=i.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((d,h)=>a.set(d,h)),!(a.size()>=s)););return O.resolve(a)}St(e,n,r){const s=this.overlays.get(r.key);if(s!==null){const o=this.qr.get(s.largestBatchId).delete(r.key);this.qr.set(s.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new Xy(n,r));let i=this.qr.get(n);i===void 0&&(i=ke(),this.qr.set(n,i)),this.qr.set(n,i.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rL{constructor(){this.sessionToken=Rt.EMPTY_BYTE_STRING}getSessionToken(e){return O.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,O.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class r_{constructor(){this.Qr=new Je(Bt.$r),this.Ur=new Je(Bt.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,n){const r=new Bt(e,n);this.Qr=this.Qr.add(r),this.Ur=this.Ur.add(r)}Wr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Gr(new Bt(e,n))}zr(e,n){e.forEach(r=>this.removeReference(r,n))}jr(e){const n=new ne(new He([])),r=new Bt(n,e),s=new Bt(n,e+1),i=[];return this.Ur.forEachInRange([r,s],o=>{this.Gr(o),i.push(o.key)}),i}Jr(){this.Qr.forEach(e=>this.Gr(e))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const n=new ne(new He([])),r=new Bt(n,e),s=new Bt(n,e+1);let i=ke();return this.Ur.forEachInRange([r,s],o=>{i=i.add(o.key)}),i}containsKey(e){const n=new Bt(e,0),r=this.Qr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class Bt{constructor(e,n){this.key=e,this.Yr=n}static $r(e,n){return ne.comparator(e.key,n.key)||Te(e.Yr,n.Yr)}static Kr(e,n){return Te(e.Yr,n.Yr)||ne.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sL{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.tr=1,this.Zr=new Je(Bt.$r)}checkEmpty(e){return O.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,s){const i=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new Qy(i,n,r,s);this.mutationQueue.push(o);for(const a of s)this.Zr=this.Zr.add(new Bt(a.key,i)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return O.resolve(o)}lookupMutationBatch(e,n){return O.resolve(this.Xr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,s=this.ei(r),i=s<0?0:s;return O.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return O.resolve(this.mutationQueue.length===0?Hi:this.tr-1)}getAllMutationBatches(e){return O.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new Bt(n,0),s=new Bt(n,Number.POSITIVE_INFINITY),i=[];return this.Zr.forEachInRange([r,s],o=>{const a=this.Xr(o.Yr);i.push(a)}),O.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Je(Te);return n.forEach(s=>{const i=new Bt(s,0),o=new Bt(s,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([i,o],a=>{r=r.add(a.Yr)})}),O.resolve(this.ti(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,s=r.length+1;let i=r;ne.isDocumentKey(i)||(i=i.child(""));const o=new Bt(new ne(i),0);let a=new Je(Te);return this.Zr.forEachWhile(l=>{const d=l.key.path;return!!r.isPrefixOf(d)&&(d.length===s&&(a=a.add(l.Yr)),!0)},o),O.resolve(this.ti(a))}ti(e){const n=[];return e.forEach(r=>{const s=this.Xr(r);s!==null&&n.push(s)}),n}removeMutationBatch(e,n){he(this.ni(n.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Zr;return O.forEach(n.mutations,s=>{const i=new Bt(s.key,n.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.Zr=r})}ir(e){}containsKey(e,n){const r=new Bt(n,0),s=this.Zr.firstAfterOrEqual(r);return O.resolve(n.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,O.resolve()}ni(e,n){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const n=this.ei(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iL{constructor(e){this.ri=e,this.docs=function(){return new ht(ne.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,s=this.docs.get(r),i=s?s.size:0,o=this.ri(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return O.resolve(r?r.document.mutableCopy():vt.newInvalidDocument(n))}getEntries(e,n){let r=$n();return n.forEach(s=>{const i=this.docs.get(s);r=r.insert(s,i?i.document.mutableCopy():vt.newInvalidDocument(s))}),O.resolve(r)}getDocumentsMatchingQuery(e,n,r,s){let i=$n();const o=n.path,a=new ne(o.child("__id-9223372036854775808__")),l=this.docs.getIteratorFrom(a);for(;l.hasNext();){const{key:d,value:{document:h}}=l.getNext();if(!o.isPrefixOf(d.path))break;d.path.length>o.length+1||My(ob(h),r)<=0||(s.has(h.key)||Xc(n,h))&&(i=i.insert(h.key,h.mutableCopy()))}return O.resolve(i)}getAllFromCollectionGroup(e,n,r,s){le(9500)}ii(e,n){return O.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new oL(this)}getSize(e){return O.resolve(this.size)}}class oL extends IC{constructor(e){super(),this.Nr=e}applyChanges(e){const n=[];return this.changes.forEach((r,s)=>{s.isValidDocument()?n.push(this.Nr.addEntry(e,s)):this.Nr.removeEntry(r)}),O.waitFor(n)}getFromCache(e,n){return this.Nr.getEntry(e,n)}getAllFromCache(e,n){return this.Nr.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aL{constructor(e){this.persistence=e,this.si=new ms(n=>ao(n),Qc),this.lastRemoteSnapshotVersion=fe.min(),this.highestTargetId=0,this.oi=0,this._i=new r_,this.targetCount=0,this.ai=ho.ur()}forEachTarget(e,n){return this.si.forEach((r,s)=>n(s)),O.resolve()}getLastRemoteSnapshotVersion(e){return O.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return O.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),O.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.oi&&(this.oi=n),O.resolve()}Pr(e){this.si.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.ai=new ho(n),this.highestTargetId=n),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,n){return this.Pr(n),this.targetCount+=1,O.resolve()}updateTargetData(e,n){return this.Pr(n),O.resolve()}removeTargetData(e,n){return this.si.delete(n.target),this._i.jr(n.targetId),this.targetCount-=1,O.resolve()}removeTargets(e,n,r){let s=0;const i=[];return this.si.forEach((o,a)=>{a.sequenceNumber<=n&&r.get(a.targetId)===null&&(this.si.delete(o),i.push(this.removeMatchingKeysForTargetId(e,a.targetId)),s++)}),O.waitFor(i).next(()=>s)}getTargetCount(e){return O.resolve(this.targetCount)}getTargetData(e,n){const r=this.si.get(n)||null;return O.resolve(r)}addMatchingKeys(e,n,r){return this._i.Wr(n,r),O.resolve()}removeMatchingKeys(e,n,r){this._i.zr(n,r);const s=this.persistence.referenceDelegate,i=[];return s&&n.forEach(o=>{i.push(s.markPotentiallyOrphaned(e,o))}),O.waitFor(i)}removeMatchingKeysForTargetId(e,n){return this._i.jr(n),O.resolve()}getMatchingKeysForTargetId(e,n){const r=this._i.Hr(n);return O.resolve(r)}containsKey(e,n){return O.resolve(this._i.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s_{constructor(e,n){this.ui={},this.overlays={},this.ci=new tr(0),this.li=!1,this.li=!0,this.hi=new rL,this.referenceDelegate=e(this),this.Pi=new aL(this),this.indexManager=new HV,this.remoteDocumentCache=function(s){return new iL(s)}(r=>this.referenceDelegate.Ti(r)),this.serializer=new dC(n),this.Ii=new tL(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new nL,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.ui[e.toKey()];return r||(r=new sL(n,this.referenceDelegate),this.ui[e.toKey()]=r),r}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,n,r){W("MemoryPersistence","Starting transaction:",e);const s=new lL(this.ci.next());return this.referenceDelegate.Ei(),r(s).next(i=>this.referenceDelegate.di(s).next(()=>i)).toPromise().then(i=>(s.raiseOnCommittedEvent(),i))}Ai(e,n){return O.or(Object.values(this.ui).map(r=>()=>r.containsKey(e,n)))}}class lL extends lb{constructor(e){super(),this.currentSequenceNumber=e}}class gf{constructor(e){this.persistence=e,this.Ri=new r_,this.Vi=null}static mi(e){return new gf(e)}get fi(){if(this.Vi)return this.Vi;throw le(60996)}addReference(e,n,r){return this.Ri.addReference(r,n),this.fi.delete(r.toString()),O.resolve()}removeReference(e,n,r){return this.Ri.removeReference(r,n),this.fi.add(r.toString()),O.resolve()}markPotentiallyOrphaned(e,n){return this.fi.add(n.toString()),O.resolve()}removeTarget(e,n){this.Ri.jr(n.targetId).forEach(s=>this.fi.add(s.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(s=>{s.forEach(i=>this.fi.add(i.toString()))}).next(()=>r.removeTargetData(e,n))}Ei(){this.Vi=new Set}di(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return O.forEach(this.fi,r=>{const s=ne.fromPath(r);return this.gi(e,s).next(i=>{i||n.removeEntry(s,fe.min())})}).next(()=>(this.Vi=null,n.apply(e)))}updateLimboDocument(e,n){return this.gi(e,n).next(r=>{r?this.fi.delete(n.toString()):this.fi.add(n.toString())})}Ti(e){return 0}gi(e,n){return O.or([()=>O.resolve(this.Ri.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Ai(e,n)])}}class yh{constructor(e,n){this.persistence=e,this.pi=new ms(r=>ln(r.path),(r,s)=>r.isEqual(s)),this.garbageCollector=EC(this,n)}static mi(e,n){return new yh(e,n)}Ei(){}di(e){return O.resolve()}forEachTarget(e,n){return this.persistence.getTargetCache().forEachTarget(e,n)}gr(e){const n=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next(r=>n.next(s=>r+s))}wr(e){let n=0;return this.pr(e,r=>{n++}).next(()=>n)}pr(e,n){return O.forEach(this.pi,(r,s)=>this.br(e,r,s).next(i=>i?O.resolve():n(s)))}removeTargets(e,n,r){return this.persistence.getTargetCache().removeTargets(e,n,r)}removeOrphanedDocuments(e,n){let r=0;const s=this.persistence.getRemoteDocumentCache(),i=s.newChangeBuffer();return s.ii(e,o=>this.br(e,o,n).next(a=>{a||(r++,i.removeEntry(o,fe.min()))})).next(()=>i.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,n){return this.pi.set(n,e.currentSequenceNumber),O.resolve()}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,n,r){return this.pi.set(r,e.currentSequenceNumber),O.resolve()}removeReference(e,n,r){return this.pi.set(r,e.currentSequenceNumber),O.resolve()}updateLimboDocument(e,n){return this.pi.set(n,e.currentSequenceNumber),O.resolve()}Ti(e){let n=e.key.toString().length;return e.isFoundDocument()&&(n+=yd(e.data.value)),n}br(e,n,r){return O.or([()=>this.persistence.Ai(e,n),()=>this.persistence.getTargetCache().containsKey(e,n),()=>{const s=this.pi.get(n);return O.resolve(s!==void 0&&s>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cL{constructor(e){this.serializer=e}k(e,n,r,s){const i=new Zh("createOrUpgrade",n);r<1&&s>=1&&(function(l){l.createObjectStore(Gc)}(e),function(l){l.createObjectStore(Ac,{keyPath:_O}),l.createObjectStore(pr,{keyPath:RE,autoIncrement:!0}).createIndex($i,PE,{unique:!0}),l.createObjectStore(Ca)}(e),vI(e),function(l){l.createObjectStore(ki)}(e));let o=O.resolve();return r<3&&s>=3&&(r!==0&&(function(l){l.deleteObjectStore(Ra),l.deleteObjectStore(Aa),l.deleteObjectStore(Wi)}(e),vI(e)),o=o.next(()=>function(l){const d=l.store(Wi),h={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:fe.min().toTimestamp(),targetCount:0};return d.put(ah,h)}(i))),r<4&&s>=4&&(r!==0&&(o=o.next(()=>function(l,d){return d.store(pr).J().next(f=>{l.deleteObjectStore(pr),l.createObjectStore(pr,{keyPath:RE,autoIncrement:!0}).createIndex($i,PE,{unique:!0});const m=d.store(pr),_=f.map(A=>m.put(A));return O.waitFor(_)})}(e,i))),o=o.next(()=>{(function(l){l.createObjectStore(Pa,{keyPath:CO})})(e)})),r<5&&s>=5&&(o=o.next(()=>this.yi(i))),r<6&&s>=6&&(o=o.next(()=>(function(l){l.createObjectStore(Rc)}(e),this.wi(i)))),r<7&&s>=7&&(o=o.next(()=>this.Si(i))),r<8&&s>=8&&(o=o.next(()=>this.bi(e,i))),r<9&&s>=9&&(o=o.next(()=>{(function(l){l.objectStoreNames.contains("remoteDocumentChanges")&&l.deleteObjectStore("remoteDocumentChanges")})(e)})),r<10&&s>=10&&(o=o.next(()=>this.Di(i))),r<11&&s>=11&&(o=o.next(()=>{(function(l){l.createObjectStore(tf,{keyPath:AO})})(e),function(l){l.createObjectStore(nf,{keyPath:RO})}(e)})),r<12&&s>=12&&(o=o.next(()=>{(function(l){const d=l.createObjectStore(rf,{keyPath:VO});d.createIndex(Jm,LO,{unique:!1}),d.createIndex(mb,MO,{unique:!1})})(e)})),r<13&&s>=13&&(o=o.next(()=>function(l){const d=l.createObjectStore(oh,{keyPath:wO});d.createIndex(md,EO),d.createIndex(db,IO)}(e)).next(()=>this.Ci(e,i)).next(()=>e.deleteObjectStore(ki))),r<14&&s>=14&&(o=o.next(()=>this.Fi(e,i))),r<15&&s>=15&&(o=o.next(()=>function(l){l.createObjectStore($y,{keyPath:PO,autoIncrement:!0}).createIndex(Xm,NO,{unique:!1}),l.createObjectStore(Jl,{keyPath:kO}).createIndex(fb,DO,{unique:!1}),l.createObjectStore(Zl,{keyPath:jO}).createIndex(pb,OO,{unique:!1})}(e))),r<16&&s>=16&&(o=o.next(()=>{n.objectStore(Jl).clear()}).next(()=>{n.objectStore(Zl).clear()})),r<17&&s>=17&&(o=o.next(()=>{(function(l){l.createObjectStore(By,{keyPath:FO})})(e)})),r<18&&s>=18&&aS()&&(o=o.next(()=>{n.objectStore(Jl).clear()}).next(()=>{n.objectStore(Zl).clear()})),o}wi(e){let n=0;return e.store(ki).ee((r,s)=>{n+=gh(s)}).next(()=>{const r={byteSize:n};return e.store(Rc).put(Ym,r)})}yi(e){const n=e.store(Ac),r=e.store(pr);return n.J().next(s=>O.forEach(s,i=>{const o=IDBKeyRange.bound([i.userId,Hi],[i.userId,i.lastAcknowledgedBatchId]);return r.J($i,o).next(a=>O.forEach(a,l=>{he(l.userId===i.userId,18650,"Cannot process batch from unexpected user",{batchId:l.batchId});const d=ji(this.serializer,l);return yC(e,i.userId,d).next(()=>{})}))}))}Si(e){const n=e.store(Ra),r=e.store(ki);return e.store(Wi).get(ah).next(s=>{const i=[];return r.ee((o,a)=>{const l=new He(o),d=function(f){return[0,ln(f)]}(l);i.push(n.get(d).next(h=>h?O.resolve():(f=>n.put({targetId:0,path:ln(f),sequenceNumber:s.highestListenSequenceNumber}))(l)))}).next(()=>O.waitFor(i))})}bi(e,n){e.createObjectStore(Pc,{keyPath:bO});const r=n.store(Pc),s=new n_,i=o=>{if(s.add(o)){const a=o.lastSegment(),l=o.popLast();return r.put({collectionId:a,parent:ln(l)})}};return n.store(ki).ee({X:!0},(o,a)=>{const l=new He(o);return i(l.popLast())}).next(()=>n.store(Ca).ee({X:!0},([o,a,l],d)=>{const h=Mr(a);return i(h.popLast())}))}Di(e){const n=e.store(Aa);return n.ee((r,s)=>{const i=Vl(s),o=hC(this.serializer,i);return n.put(o)})}Ci(e,n){const r=n.store(ki),s=[];return r.ee((i,o)=>{const a=n.store(oh),l=function(f){return f.document?new ne(He.fromString(f.document.name).popFirst(5)):f.noDocument?ne.fromSegments(f.noDocument.path):f.unknownDocument?ne.fromSegments(f.unknownDocument.path):le(36783)}(o).path.toArray(),d={prefixPath:l.slice(0,l.length-2),collectionGroup:l[l.length-2],documentId:l[l.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};s.push(a.put(d))}).next(()=>O.waitFor(s))}Fi(e,n){const r=n.store(pr),s=TC(this.serializer),i=new s_(gf.mi,this.serializer.yt);return r.J().next(o=>{const a=new Map;return o.forEach(l=>{let d=a.get(l.userId)??ke();ji(this.serializer,l).keys().forEach(h=>d=d.add(h)),a.set(l.userId,d)}),O.forEach(a,(l,d)=>{const h=new Wt(d),f=pf.wt(this.serializer,h),m=i.getIndexManager(h),_=mf.wt(h,this.serializer,m,i.referenceDelegate);return new xC(s,_,f,m).recalculateAndSaveOverlaysForDocumentKeys(new Zm(n,tr.ce),l).next()})})}}function vI(t){t.createObjectStore(Ra,{keyPath:xO}).createIndex(Uy,SO,{unique:!0}),t.createObjectStore(Aa,{keyPath:"targetId"}).createIndex(hb,TO,{unique:!0}),t.createObjectStore(Wi)}const Rs="IndexedDbPersistence",bp=18e5,Cp=5e3,Ap="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",uL="main";class i_{constructor(e,n,r,s,i,o,a,l,d,h,f=18){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.Mi=i,this.window=o,this.document=a,this.xi=d,this.Oi=h,this.Ni=f,this.ci=null,this.li=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Bi=null,this.inForeground=!1,this.Li=null,this.ki=null,this.qi=Number.NEGATIVE_INFINITY,this.Qi=m=>Promise.resolve(),!i_.v())throw new Q(U.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new XV(this,s),this.$i=n+uL,this.serializer=new dC(l),this.Ui=new ri(this.$i,this.Ni,new cL(this.serializer)),this.hi=new FV,this.Pi=new KV(this.referenceDelegate,this.serializer),this.remoteDocumentCache=TC(this.serializer),this.Ii=new MV,this.window&&this.window.localStorage?this.Ki=this.window.localStorage:(this.Ki=null,h===!1&&mn(Rs,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Wi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new Q(U.FAILED_PRECONDITION,Ap);return this.Gi(),this.zi(),this.ji(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Pi.getHighestSequenceNumber(e))}).then(e=>{this.ci=new tr(e,this.xi)}).then(()=>{this.li=!0}).catch(e=>(this.Ui&&this.Ui.close(),Promise.reject(e)))}Ji(e){return this.Qi=async n=>{if(this.started)return e(n)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ui.$(async n=>{n.newVersion===null&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Mi.enqueueAndForget(async()=>{this.started&&await this.Wi()}))}Wi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>$u(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.Hi(e).next(n=>{n||(this.isPrimary=!1,this.Mi.enqueueRetryable(()=>this.Qi(!1)))})}).next(()=>this.Yi(e)).next(n=>this.isPrimary&&!n?this.Zi(e).next(()=>!1):!!n&&this.Xi(e).next(()=>!0))).catch(e=>{if(_i(e))return W(Rs,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return W(Rs,"Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.Mi.enqueueRetryable(()=>this.Qi(e)),this.isPrimary=e})}Hi(e){return xl(e).get(Co).next(n=>O.resolve(this.es(n)))}ts(e){return $u(e).delete(this.clientId)}async ns(){if(this.isPrimary&&!this.rs(this.qi,bp)){this.qi=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",n=>{const r=Lt(n,Pa);return r.J().next(s=>{const i=this.ss(s,bp),o=s.filter(a=>i.indexOf(a)===-1);return O.forEach(o,a=>r.delete(a.clientId)).next(()=>o)})}).catch(()=>[]);if(this.Ki)for(const n of e)this.Ki.removeItem(this._s(n.clientId))}}ji(){this.ki=this.Mi.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.Wi().then(()=>this.ns()).then(()=>this.ji()))}es(e){return!!e&&e.ownerId===this.clientId}Yi(e){return this.Oi?O.resolve(!0):xl(e).get(Co).next(n=>{if(n!==null&&this.rs(n.leaseTimestampMs,Cp)&&!this.us(n.ownerId)){if(this.es(n)&&this.networkEnabled)return!0;if(!this.es(n)){if(!n.allowTabSynchronization)throw new Q(U.FAILED_PRECONDITION,Ap);return!1}}return!(!this.networkEnabled||!this.inForeground)||$u(e).J().next(r=>this.ss(r,Cp).find(s=>{if(this.clientId!==s.clientId){const i=!this.networkEnabled&&s.networkEnabled,o=!this.inForeground&&s.inForeground,a=this.networkEnabled===s.networkEnabled;if(i||o&&a)return!0}return!1})===void 0)}).next(n=>(this.isPrimary!==n&&W(Rs,`Client ${n?"is":"is not"} eligible for a primary lease.`),n))}async shutdown(){this.li=!1,this.cs(),this.ki&&(this.ki.cancel(),this.ki=null),this.ls(),this.hs(),await this.Ui.runTransaction("shutdown","readwrite",[Gc,Pa],e=>{const n=new Zm(e,tr.ce);return this.Zi(n).next(()=>this.ts(n))}),this.Ui.close(),this.Ps()}ss(e,n){return e.filter(r=>this.rs(r.updateTimeMs,n)&&!this.us(r.clientId))}Ts(){return this.runTransaction("getActiveClients","readonly",e=>$u(e).J().next(n=>this.ss(n,bp).map(r=>r.clientId)))}get started(){return this.li}getGlobalsCache(){return this.hi}getMutationQueue(e,n){return mf.wt(e,this.serializer,n,this.referenceDelegate)}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new WV(e,this.serializer.yt.databaseId)}getDocumentOverlayCache(e){return pf.wt(this.serializer,e)}getBundleCache(){return this.Ii}runTransaction(e,n,r){W(Rs,"Starting transaction:",e);const s=n==="readonly"?"readonly":"readwrite",i=function(l){return l===18?BO:l===17?vb:l===16?$O:l===15?zy:l===14?_b:l===13?yb:l===12?UO:l===11?gb:void le(60245)}(this.Ni);let o;return this.Ui.runTransaction(e,s,i,a=>(o=new Zm(a,this.ci?this.ci.next():tr.ce),n==="readwrite-primary"?this.Hi(o).next(l=>!!l||this.Yi(o)).next(l=>{if(!l)throw mn(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Mi.enqueueRetryable(()=>this.Qi(!1)),new Q(U.FAILED_PRECONDITION,ab);return r(o)}).next(l=>this.Xi(o).next(()=>l)):this.Is(o).next(()=>r(o)))).then(a=>(o.raiseOnCommittedEvent(),a))}Is(e){return xl(e).get(Co).next(n=>{if(n!==null&&this.rs(n.leaseTimestampMs,Cp)&&!this.us(n.ownerId)&&!this.es(n)&&!(this.Oi||this.allowTabSynchronization&&n.allowTabSynchronization))throw new Q(U.FAILED_PRECONDITION,Ap)})}Xi(e){const n={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return xl(e).put(Co,n)}static v(){return ri.v()}Zi(e){const n=xl(e);return n.get(Co).next(r=>this.es(r)?(W(Rs,"Releasing primary lease."),n.delete(Co)):O.resolve())}rs(e,n){const r=Date.now();return!(e<r-n)&&(!(e>r)||(mn(`Detected an update time that is in the future: ${e} > ${r}`),!1))}Gi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Li=()=>{this.Mi.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.Wi()))},this.document.addEventListener("visibilitychange",this.Li),this.inForeground=this.document.visibilityState==="visible")}ls(){this.Li&&(this.document.removeEventListener("visibilitychange",this.Li),this.Li=null)}zi(){var e;typeof((e=this.window)==null?void 0:e.addEventListener)=="function"&&(this.Bi=()=>{this.cs();const n=/(?:Version|Mobile)\/1[456]/;oS()&&(navigator.appVersion.match(n)||navigator.userAgent.match(n))&&this.Mi.enterRestrictedMode(!0),this.Mi.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Bi))}hs(){this.Bi&&(this.window.removeEventListener("pagehide",this.Bi),this.Bi=null)}us(e){var n;try{const r=((n=this.Ki)==null?void 0:n.getItem(this._s(e)))!==null;return W(Rs,`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return mn(Rs,"Failed to get zombied client id.",r),!1}}cs(){if(this.Ki)try{this.Ki.setItem(this._s(this.clientId),String(Date.now()))}catch(e){mn("Failed to set zombie client id.",e)}}Ps(){if(this.Ki)try{this.Ki.removeItem(this._s(this.clientId))}catch{}}_s(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function xl(t){return Lt(t,Gc)}function $u(t){return Lt(t,Pa)}function dL(t,e){let n=t.projectId;return t.isDefaultDatabase||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class o_{constructor(e,n,r,s){this.targetId=e,this.fromCache=n,this.Es=r,this.ds=s}static As(e,n){let r=ke(),s=ke();for(const i of n.docChanges)switch(i.type){case 0:r=r.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new o_(e,n.fromCache,r,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hL{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SC{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=function(){return oS()?8:cb(Vt())>0?6:4}()}initialize(e,n){this.ps=e,this.indexManager=n,this.Rs=!0}getDocumentsMatchingQuery(e,n,r,s){const i={result:null};return this.ys(e,n).next(o=>{i.result=o}).next(()=>{if(!i.result)return this.ws(e,n,s,r).next(o=>{i.result=o})}).next(()=>{if(i.result)return;const o=new hL;return this.Ss(e,n,o).next(a=>{if(i.result=a,this.Vs)return this.bs(e,n,o,a.size)})}).next(()=>i.result)}bs(e,n,r,s){return r.documentReadCount<this.fs?(Uo()<=Le.DEBUG&&W("QueryEngine","SDK will not create cache indexes for query:",$o(n),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),O.resolve()):(Uo()<=Le.DEBUG&&W("QueryEngine","Query:",$o(n),"scans",r.documentReadCount,"local documents and returns",s,"documents as results."),r.documentReadCount>this.gs*s?(Uo()<=Le.DEBUG&&W("QueryEngine","The SDK decides to create cache indexes for query:",$o(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,rr(n))):O.resolve())}ys(e,n){if(zE(n))return O.resolve(null);let r=rr(n);return this.indexManager.getIndexType(e,r).next(s=>s===0?null:(n.limit!==null&&s===1&&(n=dh(n,null,"F"),r=rr(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(i=>{const o=ke(...i);return this.ps.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,r).next(l=>{const d=this.Ds(n,a);return this.Cs(n,d,o,l.readTime)?this.ys(e,dh(n,null,"F")):this.vs(e,d,n,l)}))})))}ws(e,n,r,s){return zE(n)||s.isEqual(fe.min())?O.resolve(null):this.ps.getDocuments(e,r).next(i=>{const o=this.Ds(n,i);return this.Cs(n,o,r,s)?O.resolve(null):(Uo()<=Le.DEBUG&&W("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),$o(n)),this.vs(e,o,n,dO(s,Sc)).next(a=>a))})}Ds(e,n){let r=new Je(Fb(e));return n.forEach((s,i)=>{Xc(e,i)&&(r=r.add(i))}),r}Cs(e,n,r,s){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const i=e.limitType==="F"?n.last():n.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}Ss(e,n,r){return Uo()<=Le.DEBUG&&W("QueryEngine","Using full collection scan to execute query:",$o(n)),this.ps.getDocumentsMatchingQuery(e,n,Hn.min(),r)}vs(e,n,r,s){return this.ps.getDocumentsMatchingQuery(e,r,s).next(i=>(n.forEach(o=>{i=i.insert(o.key,o)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const a_="LocalStore",fL=3e8;class pL{constructor(e,n,r,s){this.persistence=e,this.Fs=n,this.serializer=s,this.Ms=new ht(Te),this.xs=new ms(i=>ao(i),Qc),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(r)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new xC(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.Ms))}}function bC(t,e,n,r){return new pL(t,e,n,r)}async function CC(t,e){const n=Ee(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let s;return n.mutationQueue.getAllMutationBatches(r).next(i=>(s=i,n.Bs(e),n.mutationQueue.getAllMutationBatches(r))).next(i=>{const o=[],a=[];let l=ke();for(const d of s){o.push(d.batchId);for(const h of d.mutations)l=l.add(h.key)}for(const d of i){a.push(d.batchId);for(const h of d.mutations)l=l.add(h.key)}return n.localDocuments.getDocuments(r,l).next(d=>({Ls:d,removedBatchIds:o,addedBatchIds:a}))})})}function mL(t,e){const n=Ee(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const s=e.batch.keys(),i=n.Ns.newChangeBuffer({trackRemovals:!0});return function(a,l,d,h){const f=d.batch,m=f.keys();let _=O.resolve();return m.forEach(A=>{_=_.next(()=>h.getEntry(l,A)).next(R=>{const C=d.docVersions.get(A);he(C!==null,48541),R.version.compareTo(C)<0&&(f.applyToRemoteDocument(R,d),R.isValidDocument()&&(R.setReadTime(d.commitVersion),h.addEntry(R)))})}),_.next(()=>a.mutationQueue.removeMutationBatch(l,f))}(n,r,e,i).next(()=>i.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,s,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let l=ke();for(let d=0;d<a.mutationResults.length;++d)a.mutationResults[d].transformResults.length>0&&(l=l.add(a.batch.mutations[d].key));return l}(e))).next(()=>n.localDocuments.getDocuments(r,s))})}function AC(t){const e=Ee(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Pi.getLastRemoteSnapshotVersion(n))}function gL(t,e){const n=Ee(t),r=e.snapshotVersion;let s=n.Ms;return n.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const o=n.Ns.newChangeBuffer({trackRemovals:!0});s=n.Ms;const a=[];e.targetChanges.forEach((h,f)=>{const m=s.get(f);if(!m)return;a.push(n.Pi.removeMatchingKeys(i,h.removedDocuments,f).next(()=>n.Pi.addMatchingKeys(i,h.addedDocuments,f)));let _=m.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(f)!==null?_=_.withResumeToken(Rt.EMPTY_BYTE_STRING,fe.min()).withLastLimboFreeSnapshotVersion(fe.min()):h.resumeToken.approximateByteSize()>0&&(_=_.withResumeToken(h.resumeToken,r)),s=s.insert(f,_),function(R,C,w){return R.resumeToken.approximateByteSize()===0||C.snapshotVersion.toMicroseconds()-R.snapshotVersion.toMicroseconds()>=fL?!0:w.addedDocuments.size+w.modifiedDocuments.size+w.removedDocuments.size>0}(m,_,h)&&a.push(n.Pi.updateTargetData(i,_))});let l=$n(),d=ke();if(e.documentUpdates.forEach(h=>{e.resolvedLimboDocuments.has(h)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(i,h))}),a.push(yL(i,o,e.documentUpdates).next(h=>{l=h.ks,d=h.qs})),!r.isEqual(fe.min())){const h=n.Pi.getLastRemoteSnapshotVersion(i).next(f=>n.Pi.setTargetsMetadata(i,i.currentSequenceNumber,r));a.push(h)}return O.waitFor(a).next(()=>o.apply(i)).next(()=>n.localDocuments.getLocalViewOfDocuments(i,l,d)).next(()=>l)}).then(i=>(n.Ms=s,i))}function yL(t,e,n){let r=ke(),s=ke();return n.forEach(i=>r=r.add(i)),e.getEntries(t,r).next(i=>{let o=$n();return n.forEach((a,l)=>{const d=i.get(a);l.isFoundDocument()!==d.isFoundDocument()&&(s=s.add(a)),l.isNoDocument()&&l.version.isEqual(fe.min())?(e.removeEntry(a,l.readTime),o=o.insert(a,l)):!d.isValidDocument()||l.version.compareTo(d.version)>0||l.version.compareTo(d.version)===0&&d.hasPendingWrites?(e.addEntry(l),o=o.insert(a,l)):W(a_,"Ignoring outdated watch update for ",a,". Current version:",d.version," Watch version:",l.version)}),{ks:o,qs:s}})}function _L(t,e){const n=Ee(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=Hi),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function vL(t,e){const n=Ee(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let s;return n.Pi.getTargetData(r,e).next(i=>i?(s=i,O.resolve(s)):n.Pi.allocateTargetId(r).next(o=>(s=new ts(e,o,"TargetPurposeListen",r.currentSequenceNumber),n.Pi.addTargetData(r,s).next(()=>s))))}).then(r=>{const s=n.Ms.get(r.targetId);return(s===null||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(n.Ms=n.Ms.insert(r.targetId,r),n.xs.set(e,r.targetId)),r})}async function fg(t,e,n){const r=Ee(t),s=r.Ms.get(e),i=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",i,o=>r.persistence.referenceDelegate.removeTarget(o,s))}catch(o){if(!_i(o))throw o;W(a_,`Failed to update sequence numbers for target ${e}: ${o}`)}r.Ms=r.Ms.remove(e),r.xs.delete(s.target)}function wI(t,e,n){const r=Ee(t);let s=fe.min(),i=ke();return r.persistence.runTransaction("Execute query","readwrite",o=>function(l,d,h){const f=Ee(l),m=f.xs.get(h);return m!==void 0?O.resolve(f.Ms.get(m)):f.Pi.getTargetData(d,h)}(r,o,rr(e)).next(a=>{if(a)return s=a.lastLimboFreeSnapshotVersion,r.Pi.getMatchingKeysForTargetId(o,a.targetId).next(l=>{i=l})}).next(()=>r.Fs.getDocumentsMatchingQuery(o,e,n?s:fe.min(),n?i:ke())).next(a=>(wL(r,sV(e),a),{documents:a,Qs:i})))}function wL(t,e,n){let r=t.Os.get(e)||fe.min();n.forEach((s,i)=>{i.readTime.compareTo(r)>0&&(r=i.readTime)}),t.Os.set(e,r)}class EI{constructor(){this.activeTargetIds=uV()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class RC{constructor(){this.Mo=new EI,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,n,r){this.xo[e]=n}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new EI,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EL{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const II="ConnectivityMonitor";class TI{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){W(II,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){W(II,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Bu=null;function pg(){return Bu===null?Bu=function(){return 268435456+Math.round(2147483648*Math.random())}():Bu++,"0x"+Bu.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rp="RestConnection",IL={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class TL{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const n=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Uo=n+"://"+e.host,this.Ko=`projects/${r}/databases/${s}`,this.Wo=this.databaseId.database===lh?`project_id=${r}`:`project_id=${r}&database_id=${s}`}Go(e,n,r,s,i){const o=pg(),a=this.zo(e,n.toUriEncodedString());W(Rp,`Sending RPC '${e}' ${o}:`,a,r);const l={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(l,s,i);const{host:d}=new URL(a),h=mi(d);return this.Jo(e,a,l,r,h).then(f=>(W(Rp,`Received RPC '${e}' ${o}: `,f),f),f=>{throw so(Rp,`RPC '${e}' ${o} failed with error: `,f,"url: ",a,"request:",r),f})}Ho(e,n,r,s,i,o){return this.Go(e,n,r,s,i)}jo(e,n,r){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Ga}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((s,i)=>e[i]=s),r&&r.headers.forEach((s,i)=>e[i]=s)}zo(e,n){const r=IL[e];return`${this.Uo}/v1/${n}:${r}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xL{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tn="WebChannelConnection";class SL extends TL{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,n,r,s,i){const o=pg();return new Promise((a,l)=>{const d=new YS;d.setWithCredentials(!0),d.listenOnce(XS.COMPLETE,()=>{try{switch(d.getLastErrorCode()){case hd.NO_ERROR:const f=d.getResponseJson();W(tn,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(f)),a(f);break;case hd.TIMEOUT:W(tn,`RPC '${e}' ${o} timed out`),l(new Q(U.DEADLINE_EXCEEDED,"Request time out"));break;case hd.HTTP_ERROR:const m=d.getStatus();if(W(tn,`RPC '${e}' ${o} failed with status:`,m,"response text:",d.getResponseText()),m>0){let _=d.getResponseJson();Array.isArray(_)&&(_=_[0]);const A=_==null?void 0:_.error;if(A&&A.status&&A.message){const R=function(w){const I=w.toLowerCase().replace(/_/g,"-");return Object.values(U).indexOf(I)>=0?I:U.UNKNOWN}(A.status);l(new Q(R,A.message))}else l(new Q(U.UNKNOWN,"Server responded with status "+d.getStatus()))}else l(new Q(U.UNAVAILABLE,"Connection failed."));break;default:le(9055,{l_:e,streamId:o,h_:d.getLastErrorCode(),P_:d.getLastError()})}}finally{W(tn,`RPC '${e}' ${o} completed.`)}});const h=JSON.stringify(s);W(tn,`RPC '${e}' ${o} sending request:`,s),d.send(n,"POST",h,r,15)})}T_(e,n,r){const s=pg(),i=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=eb(),a=ZS(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},d=this.longPollingOptions.timeoutSeconds;d!==void 0&&(l.longPollingTimeout=Math.round(1e3*d)),this.useFetchStreams&&(l.useFetchStreams=!0),this.jo(l.initMessageHeaders,n,r),l.encodeInitMessageHeaders=!0;const h=i.join("");W(tn,`Creating RPC '${e}' stream ${s}: ${h}`,l);const f=o.createWebChannel(h,l);this.I_(f);let m=!1,_=!1;const A=new xL({Yo:C=>{_?W(tn,`Not sending because RPC '${e}' stream ${s} is closed:`,C):(m||(W(tn,`Opening RPC '${e}' stream ${s} transport.`),f.open(),m=!0),W(tn,`RPC '${e}' stream ${s} sending:`,C),f.send(C))},Zo:()=>f.close()}),R=(C,w,I)=>{C.listen(w,b=>{try{I(b)}catch(x){setTimeout(()=>{throw x},0)}})};return R(f,Dl.EventType.OPEN,()=>{_||(W(tn,`RPC '${e}' stream ${s} transport opened.`),A.o_())}),R(f,Dl.EventType.CLOSE,()=>{_||(_=!0,W(tn,`RPC '${e}' stream ${s} transport closed`),A.a_(),this.E_(f))}),R(f,Dl.EventType.ERROR,C=>{_||(_=!0,so(tn,`RPC '${e}' stream ${s} transport errored. Name:`,C.name,"Message:",C.message),A.a_(new Q(U.UNAVAILABLE,"The operation could not be completed")))}),R(f,Dl.EventType.MESSAGE,C=>{var w;if(!_){const I=C.data[0];he(!!I,16349);const b=I,x=(b==null?void 0:b.error)||((w=b[0])==null?void 0:w.error);if(x){W(tn,`RPC '${e}' stream ${s} received error:`,x);const L=x.status;let $=function(y){const N=bt[y];if(N!==void 0)return Jb(N)}(L),E=x.message;$===void 0&&($=U.INTERNAL,E="Unknown error status: "+L+" with message "+x.message),_=!0,A.a_(new Q($,E)),f.close()}else W(tn,`RPC '${e}' stream ${s} received:`,I),A.u_(I)}}),R(a,JS.STAT_EVENT,C=>{C.stat===Km.PROXY?W(tn,`RPC '${e}' stream ${s} detected buffering proxy`):C.stat===Km.NOPROXY&&W(tn,`RPC '${e}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{A.__()},0),A}terminate(){this.c_.forEach(e=>e.close()),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter(n=>n===e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bL(){return typeof window<"u"?window:null}function Id(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yf(t){return new bV(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PC{constructor(e,n,r=1e3,s=1.5,i=6e4){this.Mi=e,this.timerId=n,this.d_=r,this.A_=s,this.R_=i,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const n=Math.floor(this.V_+this.y_()),r=Math.max(0,Date.now()-this.f_),s=Math.max(0,n-r);s>0&&W("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.V_} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,s,()=>(this.f_=Date.now(),e())),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xI="PersistentStream";class NC{constructor(e,n,r,s,i,o,a,l){this.Mi=e,this.S_=r,this.b_=s,this.connection=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=l,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new PC(e,n)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,()=>this.k_()))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,n){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():n&&n.code===U.RESOURCE_EXHAUSTED?(mn(n.toString()),mn("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):n&&n.code===U.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(n)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),n=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,s])=>{this.D_===n&&this.G_(r,s)},r=>{e(()=>{const s=new Q(U.UNKNOWN,"Fetching auth token failed: "+r.message);return this.z_(s)})})}G_(e,n){const r=this.W_(this.D_);this.stream=this.j_(e,n),this.stream.Xo(()=>{r(()=>this.listener.Xo())}),this.stream.t_(()=>{r(()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.t_()))}),this.stream.r_(s=>{r(()=>this.z_(s))}),this.stream.onMessage(s=>{r(()=>++this.F_==1?this.J_(s):this.onNext(s))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return W(xI,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return n=>{this.Mi.enqueueAndForget(()=>this.D_===e?n():(W(xI,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class CL extends NC{constructor(e,n,r,s,i,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,s,o),this.serializer=i}j_(e,n){return this.connection.T_("Listen",e,n)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const n=RV(this.serializer,e),r=function(i){if(!("targetChange"in i))return fe.min();const o=i.targetChange;return o.targetIds&&o.targetIds.length?fe.min():o.readTime?vn(o.readTime):fe.min()}(e);return this.listener.H_(n,r)}Y_(e){const n={};n.database=lg(this.serializer),n.addTarget=function(i,o){let a;const l=o.target;if(a=ch(l)?{documents:oC(i,l)}:{query:e_(i,l).ft},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=tC(i,o.resumeToken);const d=og(i,o.expectedCount);d!==null&&(a.expectedCount=d)}else if(o.snapshotVersion.compareTo(fe.min())>0){a.readTime=La(i,o.snapshotVersion.toTimestamp());const d=og(i,o.expectedCount);d!==null&&(a.expectedCount=d)}return a}(this.serializer,e);const r=kV(this.serializer,e);r&&(n.labels=r),this.q_(n)}Z_(e){const n={};n.database=lg(this.serializer),n.removeTarget=e,this.q_(n)}}class AL extends NC{constructor(e,n,r,s,i,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,s,o),this.serializer=i}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,n){return this.connection.T_("Write",e,n)}J_(e){return he(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,he(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){he(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const n=PV(e.writeResults,e.commitTime),r=vn(e.commitTime);return this.listener.na(r,n)}ra(){const e={};e.database=lg(this.serializer),this.q_(e)}ea(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>fh(this.serializer,r))};this.q_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RL{}class PL extends RL{constructor(e,n,r,s){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=s,this.ia=!1}sa(){if(this.ia)throw new Q(U.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,n,r,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.connection.Go(e,ag(n,r),s,i,o)).catch(i=>{throw i.name==="FirebaseError"?(i.code===U.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new Q(U.UNKNOWN,i.toString())})}Ho(e,n,r,s,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.Ho(e,ag(n,r),s,o,a,i)).catch(o=>{throw o.name==="FirebaseError"?(o.code===U.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new Q(U.UNKNOWN,o.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}class NL{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(mn(n),this.aa=!1):W("OnlineStateTracker",n)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fo="RemoteStore";class kL{constructor(e,n,r,s,i){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=i,this.Aa.Oo(o=>{r.enqueueAndForget(async()=>{To(this)&&(W(fo,"Restarting streams for network reachability change."),await async function(l){const d=Ee(l);d.Ea.add(4),await Zc(d),d.Ra.set("Unknown"),d.Ea.delete(4),await _f(d)}(this))})}),this.Ra=new NL(r,s)}}async function _f(t){if(To(t))for(const e of t.da)await e(!0)}async function Zc(t){for(const e of t.da)await e(!1)}function kC(t,e){const n=Ee(t);n.Ia.has(e.targetId)||(n.Ia.set(e.targetId,e),d_(n)?u_(n):Ya(n).O_()&&c_(n,e))}function l_(t,e){const n=Ee(t),r=Ya(n);n.Ia.delete(e),r.O_()&&DC(n,e),n.Ia.size===0&&(r.O_()?r.L_():To(n)&&n.Ra.set("Unknown"))}function c_(t,e){if(t.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(fe.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}Ya(t).Y_(e)}function DC(t,e){t.Va.Ue(e),Ya(t).Z_(e)}function u_(t){t.Va=new IV({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),At:e=>t.Ia.get(e)||null,ht:()=>t.datastore.serializer.databaseId}),Ya(t).start(),t.Ra.ua()}function d_(t){return To(t)&&!Ya(t).x_()&&t.Ia.size>0}function To(t){return Ee(t).Ea.size===0}function jC(t){t.Va=void 0}async function DL(t){t.Ra.set("Online")}async function jL(t){t.Ia.forEach((e,n)=>{c_(t,e)})}async function OL(t,e){jC(t),d_(t)?(t.Ra.ha(e),u_(t)):t.Ra.set("Unknown")}async function VL(t,e,n){if(t.Ra.set("Online"),e instanceof eC&&e.state===2&&e.cause)try{await async function(s,i){const o=i.cause;for(const a of i.targetIds)s.Ia.has(a)&&(await s.remoteSyncer.rejectListen(a,o),s.Ia.delete(a),s.Va.removeTarget(a))}(t,e)}catch(r){W(fo,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await _h(t,r)}else if(e instanceof wd?t.Va.Ze(e):e instanceof Zb?t.Va.st(e):t.Va.tt(e),!n.isEqual(fe.min()))try{const r=await AC(t.localStore);n.compareTo(r)>=0&&await function(i,o){const a=i.Va.Tt(o);return a.targetChanges.forEach((l,d)=>{if(l.resumeToken.approximateByteSize()>0){const h=i.Ia.get(d);h&&i.Ia.set(d,h.withResumeToken(l.resumeToken,o))}}),a.targetMismatches.forEach((l,d)=>{const h=i.Ia.get(l);if(!h)return;i.Ia.set(l,h.withResumeToken(Rt.EMPTY_BYTE_STRING,h.snapshotVersion)),DC(i,l);const f=new ts(h.target,l,d,h.sequenceNumber);c_(i,f)}),i.remoteSyncer.applyRemoteEvent(a)}(t,n)}catch(r){W(fo,"Failed to raise snapshot:",r),await _h(t,r)}}async function _h(t,e,n){if(!_i(e))throw e;t.Ea.add(1),await Zc(t),t.Ra.set("Offline"),n||(n=()=>AC(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{W(fo,"Retrying IndexedDB access"),await n(),t.Ea.delete(1),await _f(t)})}function OC(t,e){return e().catch(n=>_h(t,n,e))}async function eu(t){const e=Ee(t),n=ui(e);let r=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:Hi;for(;LL(e);)try{const s=await _L(e.localStore,r);if(s===null){e.Ta.length===0&&n.L_();break}r=s.batchId,ML(e,s)}catch(s){await _h(e,s)}VC(e)&&LC(e)}function LL(t){return To(t)&&t.Ta.length<10}function ML(t,e){t.Ta.push(e);const n=ui(t);n.O_()&&n.X_&&n.ea(e.mutations)}function VC(t){return To(t)&&!ui(t).x_()&&t.Ta.length>0}function LC(t){ui(t).start()}async function FL(t){ui(t).ra()}async function UL(t){const e=ui(t);for(const n of t.Ta)e.ea(n.mutations)}async function $L(t,e,n){const r=t.Ta.shift(),s=Yy.from(r,e,n);await OC(t,()=>t.remoteSyncer.applySuccessfulWrite(s)),await eu(t)}async function BL(t,e){e&&ui(t).X_&&await async function(r,s){if(function(o){return vV(o)&&o!==U.ABORTED}(s.code)){const i=r.Ta.shift();ui(r).B_(),await OC(r,()=>r.remoteSyncer.rejectFailedWrite(i.batchId,s)),await eu(r)}}(t,e),VC(t)&&LC(t)}async function SI(t,e){const n=Ee(t);n.asyncQueue.verifyOperationInProgress(),W(fo,"RemoteStore received new credentials");const r=To(n);n.Ea.add(3),await Zc(n),r&&n.Ra.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.Ea.delete(3),await _f(n)}async function zL(t,e){const n=Ee(t);e?(n.Ea.delete(2),await _f(n)):e||(n.Ea.add(2),await Zc(n),n.Ra.set("Unknown"))}function Ya(t){return t.ma||(t.ma=function(n,r,s){const i=Ee(n);return i.sa(),new CL(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Xo:DL.bind(null,t),t_:jL.bind(null,t),r_:OL.bind(null,t),H_:VL.bind(null,t)}),t.da.push(async e=>{e?(t.ma.B_(),d_(t)?u_(t):t.Ra.set("Unknown")):(await t.ma.stop(),jC(t))})),t.ma}function ui(t){return t.fa||(t.fa=function(n,r,s){const i=Ee(n);return i.sa(),new AL(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Xo:()=>Promise.resolve(),t_:FL.bind(null,t),r_:BL.bind(null,t),ta:UL.bind(null,t),na:$L.bind(null,t)}),t.da.push(async e=>{e?(t.fa.B_(),await eu(t)):(await t.fa.stop(),t.Ta.length>0&&(W(fo,`Stopping write stream with ${t.Ta.length} pending writes`),t.Ta=[]))})),t.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h_{constructor(e,n,r,s,i){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=s,this.removalCallback=i,this.deferred=new vr,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,s,i){const o=Date.now()+r,a=new h_(e,n,o,s,i);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Q(U.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function f_(t,e){if(mn("AsyncQueue",`${e}: ${t}`),_i(t))return new Q(U.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pa{static emptySet(e){return new pa(e.comparator)}constructor(e){this.comparator=e?(n,r)=>e(n,r)||ne.comparator(n.key,r.key):(n,r)=>ne.comparator(n.key,r.key),this.keyedMap=jl(),this.sortedSet=new ht(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof pa)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new pa;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bI{constructor(){this.ga=new ht(ne.comparator)}track(e){const n=e.doc.key,r=this.ga.get(n);r?e.type!==0&&r.type===3?this.ga=this.ga.insert(n,e):e.type===3&&r.type!==1?this.ga=this.ga.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.ga=this.ga.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.ga=this.ga.remove(n):e.type===1&&r.type===2?this.ga=this.ga.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):le(63341,{Rt:e,pa:r}):this.ga=this.ga.insert(n,e)}ya(){const e=[];return this.ga.inorderTraversal((n,r)=>{e.push(r)}),e}}class Ma{constructor(e,n,r,s,i,o,a,l,d){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=l,this.hasCachedResults=d}static fromInitialDocuments(e,n,r,s,i){const o=[];return n.forEach(a=>{o.push({type:0,doc:a})}),new Ma(e,n,pa.emptySet(n),o,r,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&lf(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let s=0;s<n.length;s++)if(n[s].type!==r[s].type||!n[s].doc.isEqual(r[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qL{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some(e=>e.Da())}}class HL{constructor(){this.queries=CI(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(n,r){const s=Ee(n),i=s.queries;s.queries=CI(),i.forEach((o,a)=>{for(const l of a.Sa)l.onError(r)})})(this,new Q(U.ABORTED,"Firestore shutting down"))}}function CI(){return new ms(t=>Mb(t),lf)}async function p_(t,e){const n=Ee(t);let r=3;const s=e.query;let i=n.queries.get(s);i?!i.ba()&&e.Da()&&(r=2):(i=new qL,r=e.Da()?0:1);try{switch(r){case 0:i.wa=await n.onListen(s,!0);break;case 1:i.wa=await n.onListen(s,!1);break;case 2:await n.onFirstRemoteStoreListen(s)}}catch(o){const a=f_(o,`Initialization of query '${$o(e.query)}' failed`);return void e.onError(a)}n.queries.set(s,i),i.Sa.push(e),e.va(n.onlineState),i.wa&&e.Fa(i.wa)&&g_(n)}async function m_(t,e){const n=Ee(t),r=e.query;let s=3;const i=n.queries.get(r);if(i){const o=i.Sa.indexOf(e);o>=0&&(i.Sa.splice(o,1),i.Sa.length===0?s=e.Da()?0:1:!i.ba()&&e.Da()&&(s=2))}switch(s){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function WL(t,e){const n=Ee(t);let r=!1;for(const s of e){const i=s.query,o=n.queries.get(i);if(o){for(const a of o.Sa)a.Fa(s)&&(r=!0);o.wa=s}}r&&g_(n)}function KL(t,e,n){const r=Ee(t),s=r.queries.get(e);if(s)for(const i of s.Sa)i.onError(n);r.queries.delete(e)}function g_(t){t.Ca.forEach(e=>{e.next()})}var mg,AI;(AI=mg||(mg={})).Ma="default",AI.Cache="cache";class y_{constructor(e,n,r){this.query=e,this.xa=n,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=r||{}}Fa(e){if(!this.options.includeMetadataChanges){const r=[];for(const s of e.docChanges)s.type!==3&&r.push(s);e=new Ma(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),n=!0):this.La(e,this.onlineState)&&(this.ka(e),n=!0),this.Na=e,n}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let n=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),n=!0),n}La(e,n){if(!e.fromCache||!this.Da())return!0;const r=n!=="Offline";return(!this.options.qa||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const n=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}ka(e){e=Ma.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==mg.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MC{constructor(e){this.key=e}}class FC{constructor(e){this.key=e}}class GL{constructor(e,n){this.query=e,this.Ya=n,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=ke(),this.mutatedKeys=ke(),this.eu=Fb(e),this.tu=new pa(this.eu)}get nu(){return this.Ya}ru(e,n){const r=n?n.iu:new bI,s=n?n.tu:this.tu;let i=n?n.mutatedKeys:this.mutatedKeys,o=s,a=!1;const l=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,d=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((h,f)=>{const m=s.get(h),_=Xc(this.query,f)?f:null,A=!!m&&this.mutatedKeys.has(m.key),R=!!_&&(_.hasLocalMutations||this.mutatedKeys.has(_.key)&&_.hasCommittedMutations);let C=!1;m&&_?m.data.isEqual(_.data)?A!==R&&(r.track({type:3,doc:_}),C=!0):this.su(m,_)||(r.track({type:2,doc:_}),C=!0,(l&&this.eu(_,l)>0||d&&this.eu(_,d)<0)&&(a=!0)):!m&&_?(r.track({type:0,doc:_}),C=!0):m&&!_&&(r.track({type:1,doc:m}),C=!0,(l||d)&&(a=!0)),C&&(_?(o=o.add(_),i=R?i.add(h):i.delete(h)):(o=o.delete(h),i=i.delete(h)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const h=this.query.limitType==="F"?o.last():o.first();o=o.delete(h.key),i=i.delete(h.key),r.track({type:1,doc:h})}return{tu:o,iu:r,Cs:a,mutatedKeys:i}}su(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,s){const i=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const o=e.iu.ya();o.sort((h,f)=>function(_,A){const R=C=>{switch(C){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return le(20277,{Rt:C})}};return R(_)-R(A)}(h.type,f.type)||this.eu(h.doc,f.doc)),this.ou(r),s=s??!1;const a=n&&!s?this._u():[],l=this.Xa.size===0&&this.current&&!s?1:0,d=l!==this.Za;return this.Za=l,o.length!==0||d?{snapshot:new Ma(this.query,e.tu,i,o,e.mutatedKeys,l===0,d,!1,!!r&&r.resumeToken.approximateByteSize()>0),au:a}:{au:a}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new bI,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(n=>this.Ya=this.Ya.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Ya=this.Ya.delete(n)),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=ke(),this.tu.forEach(r=>{this.uu(r.key)&&(this.Xa=this.Xa.add(r.key))});const n=[];return e.forEach(r=>{this.Xa.has(r)||n.push(new FC(r))}),this.Xa.forEach(r=>{e.has(r)||n.push(new MC(r))}),n}cu(e){this.Ya=e.Qs,this.Xa=ke();const n=this.ru(e.documents);return this.applyChanges(n,!0)}lu(){return Ma.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const __="SyncEngine";class QL{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class YL{constructor(e){this.key=e,this.hu=!1}}class XL{constructor(e,n,r,s,i,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.Pu={},this.Tu=new ms(a=>Mb(a),lf),this.Iu=new Map,this.Eu=new Set,this.du=new ht(ne.comparator),this.Au=new Map,this.Ru=new r_,this.Vu={},this.mu=new Map,this.fu=ho.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function JL(t,e,n=!0){const r=HC(t);let s;const i=r.Tu.get(e);return i?(r.sharedClientState.addLocalQueryTarget(i.targetId),s=i.view.lu()):s=await UC(r,e,n,!0),s}async function ZL(t,e){const n=HC(t);await UC(n,e,!0,!1)}async function UC(t,e,n,r){const s=await vL(t.localStore,rr(e)),i=s.targetId,o=t.sharedClientState.addLocalQueryTarget(i,n);let a;return r&&(a=await eM(t,e,i,o==="current",s.resumeToken)),t.isPrimaryClient&&n&&kC(t.remoteStore,s),a}async function eM(t,e,n,r,s){t.pu=(f,m,_)=>async function(R,C,w,I){let b=C.view.ru(w);b.Cs&&(b=await wI(R.localStore,C.query,!1).then(({documents:E})=>C.view.ru(E,b)));const x=I&&I.targetChanges.get(C.targetId),L=I&&I.targetMismatches.get(C.targetId)!=null,$=C.view.applyChanges(b,R.isPrimaryClient,x,L);return PI(R,C.targetId,$.au),$.snapshot}(t,f,m,_);const i=await wI(t.localStore,e,!0),o=new GL(e,i.Qs),a=o.ru(i.documents),l=Jc.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",s),d=o.applyChanges(a,t.isPrimaryClient,l);PI(t,n,d.au);const h=new QL(e,n,o);return t.Tu.set(e,h),t.Iu.has(n)?t.Iu.get(n).push(e):t.Iu.set(n,[e]),d.snapshot}async function tM(t,e,n){const r=Ee(t),s=r.Tu.get(e),i=r.Iu.get(s.targetId);if(i.length>1)return r.Iu.set(s.targetId,i.filter(o=>!lf(o,e))),void r.Tu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(s.targetId),r.sharedClientState.isActiveQueryTarget(s.targetId)||await fg(r.localStore,s.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(s.targetId),n&&l_(r.remoteStore,s.targetId),gg(r,s.targetId)}).catch(Io)):(gg(r,s.targetId),await fg(r.localStore,s.targetId,!0))}async function nM(t,e){const n=Ee(t),r=n.Tu.get(e),s=n.Iu.get(r.targetId);n.isPrimaryClient&&s.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),l_(n.remoteStore,r.targetId))}async function rM(t,e,n){const r=WC(t);try{const s=await function(o,a){const l=Ee(o),d=Be.now(),h=a.reduce((_,A)=>_.add(A.key),ke());let f,m;return l.persistence.runTransaction("Locally write mutations","readwrite",_=>{let A=$n(),R=ke();return l.Ns.getEntries(_,h).next(C=>{A=C,A.forEach((w,I)=>{I.isValidDocument()||(R=R.add(w))})}).next(()=>l.localDocuments.getOverlayedDocuments(_,A)).next(C=>{f=C;const w=[];for(const I of a){const b=gV(I,f.get(I.key).overlayedDocument);b!=null&&w.push(new gs(I.key,b,Rb(b.value.mapValue),on.exists(!0)))}return l.mutationQueue.addMutationBatch(_,d,w,a)}).next(C=>{m=C;const w=C.applyToLocalDocumentSet(f,R);return l.documentOverlayCache.saveOverlays(_,C.batchId,w)})}).then(()=>({batchId:m.batchId,changes:$b(f)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(s.batchId),function(o,a,l){let d=o.Vu[o.currentUser.toKey()];d||(d=new ht(Te)),d=d.insert(a,l),o.Vu[o.currentUser.toKey()]=d}(r,s.batchId,n),await tu(r,s.changes),await eu(r.remoteStore)}catch(s){const i=f_(s,"Failed to persist write");n.reject(i)}}async function $C(t,e){const n=Ee(t);try{const r=await gL(n.localStore,e);e.targetChanges.forEach((s,i)=>{const o=n.Au.get(i);o&&(he(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1,22616),s.addedDocuments.size>0?o.hu=!0:s.modifiedDocuments.size>0?he(o.hu,14607):s.removedDocuments.size>0&&(he(o.hu,42227),o.hu=!1))}),await tu(n,r,e)}catch(r){await Io(r)}}function RI(t,e,n){const r=Ee(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const s=[];r.Tu.forEach((i,o)=>{const a=o.view.va(e);a.snapshot&&s.push(a.snapshot)}),function(o,a){const l=Ee(o);l.onlineState=a;let d=!1;l.queries.forEach((h,f)=>{for(const m of f.Sa)m.va(a)&&(d=!0)}),d&&g_(l)}(r.eventManager,e),s.length&&r.Pu.H_(s),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function sM(t,e,n){const r=Ee(t);r.sharedClientState.updateQueryState(e,"rejected",n);const s=r.Au.get(e),i=s&&s.key;if(i){let o=new ht(ne.comparator);o=o.insert(i,vt.newNoDocument(i,fe.min()));const a=ke().add(i),l=new ff(fe.min(),new Map,new ht(Te),o,a);await $C(r,l),r.du=r.du.remove(i),r.Au.delete(e),v_(r)}else await fg(r.localStore,e,!1).then(()=>gg(r,e,n)).catch(Io)}async function iM(t,e){const n=Ee(t),r=e.batch.batchId;try{const s=await mL(n.localStore,e);zC(n,r,null),BC(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await tu(n,s)}catch(s){await Io(s)}}async function oM(t,e,n){const r=Ee(t);try{const s=await function(o,a){const l=Ee(o);return l.persistence.runTransaction("Reject batch","readwrite-primary",d=>{let h;return l.mutationQueue.lookupMutationBatch(d,a).next(f=>(he(f!==null,37113),h=f.keys(),l.mutationQueue.removeMutationBatch(d,f))).next(()=>l.mutationQueue.performConsistencyCheck(d)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(d,h,a)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(d,h)).next(()=>l.localDocuments.getDocuments(d,h))})}(r.localStore,e);zC(r,e,n),BC(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await tu(r,s)}catch(s){await Io(s)}}function BC(t,e){(t.mu.get(e)||[]).forEach(n=>{n.resolve()}),t.mu.delete(e)}function zC(t,e,n){const r=Ee(t);let s=r.Vu[r.currentUser.toKey()];if(s){const i=s.get(e);i&&(n?i.reject(n):i.resolve(),s=s.remove(e)),r.Vu[r.currentUser.toKey()]=s}}function gg(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Iu.get(e))t.Tu.delete(r),n&&t.Pu.yu(r,n);t.Iu.delete(e),t.isPrimaryClient&&t.Ru.jr(e).forEach(r=>{t.Ru.containsKey(r)||qC(t,r)})}function qC(t,e){t.Eu.delete(e.path.canonicalString());const n=t.du.get(e);n!==null&&(l_(t.remoteStore,n),t.du=t.du.remove(e),t.Au.delete(n),v_(t))}function PI(t,e,n){for(const r of n)r instanceof MC?(t.Ru.addReference(r.key,e),aM(t,r)):r instanceof FC?(W(__,"Document no longer in limbo: "+r.key),t.Ru.removeReference(r.key,e),t.Ru.containsKey(r.key)||qC(t,r.key)):le(19791,{wu:r})}function aM(t,e){const n=e.key,r=n.path.canonicalString();t.du.get(n)||t.Eu.has(r)||(W(__,"New document in limbo: "+n),t.Eu.add(r),v_(t))}function v_(t){for(;t.Eu.size>0&&t.du.size<t.maxConcurrentLimboResolutions;){const e=t.Eu.values().next().value;t.Eu.delete(e);const n=new ne(He.fromString(e)),r=t.fu.next();t.Au.set(r,new YL(n)),t.du=t.du.insert(n,r),kC(t.remoteStore,new ts(rr(Yc(n.path)),r,"TargetPurposeLimboResolution",tr.ce))}}async function tu(t,e,n){const r=Ee(t),s=[],i=[],o=[];r.Tu.isEmpty()||(r.Tu.forEach((a,l)=>{o.push(r.pu(l,e,n).then(d=>{var h;if((d||n)&&r.isPrimaryClient){const f=d?!d.fromCache:(h=n==null?void 0:n.targetChanges.get(l.targetId))==null?void 0:h.current;r.sharedClientState.updateQueryState(l.targetId,f?"current":"not-current")}if(d){s.push(d);const f=o_.As(l.targetId,d);i.push(f)}}))}),await Promise.all(o),r.Pu.H_(s),await async function(l,d){const h=Ee(l);try{await h.persistence.runTransaction("notifyLocalViewChanges","readwrite",f=>O.forEach(d,m=>O.forEach(m.Es,_=>h.persistence.referenceDelegate.addReference(f,m.targetId,_)).next(()=>O.forEach(m.ds,_=>h.persistence.referenceDelegate.removeReference(f,m.targetId,_)))))}catch(f){if(!_i(f))throw f;W(a_,"Failed to update sequence numbers: "+f)}for(const f of d){const m=f.targetId;if(!f.fromCache){const _=h.Ms.get(m),A=_.snapshotVersion,R=_.withLastLimboFreeSnapshotVersion(A);h.Ms=h.Ms.insert(m,R)}}}(r.localStore,i))}async function lM(t,e){const n=Ee(t);if(!n.currentUser.isEqual(e)){W(__,"User change. New user:",e.toKey());const r=await CC(n.localStore,e);n.currentUser=e,function(i,o){i.mu.forEach(a=>{a.forEach(l=>{l.reject(new Q(U.CANCELLED,o))})}),i.mu.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await tu(n,r.Ls)}}function cM(t,e){const n=Ee(t),r=n.Au.get(e);if(r&&r.hu)return ke().add(r.key);{let s=ke();const i=n.Iu.get(e);if(!i)return s;for(const o of i){const a=n.Tu.get(o);s=s.unionWith(a.view.nu)}return s}}function HC(t){const e=Ee(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=$C.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=cM.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=sM.bind(null,e),e.Pu.H_=WL.bind(null,e.eventManager),e.Pu.yu=KL.bind(null,e.eventManager),e}function WC(t){const e=Ee(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=iM.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=oM.bind(null,e),e}class Oc{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=yf(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,n){return null}Mu(e,n){return null}vu(e){return bC(this.persistence,new SC,e.initialUser,this.serializer)}Cu(e){return new s_(gf.mi,this.serializer)}Du(e){return new RC}async terminate(){var e,n;(e=this.gcScheduler)==null||e.stop(),(n=this.indexBackfillerScheduler)==null||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Oc.provider={build:()=>new Oc};class uM extends Oc{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,n){he(this.persistence.referenceDelegate instanceof yh,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new wC(r,e.asyncQueue,n)}Cu(e){const n=this.cacheSizeBytes!==void 0?nn.withCacheSize(this.cacheSizeBytes):nn.DEFAULT;return new s_(r=>yh.mi(r,n),this.serializer)}}class dM extends Oc{constructor(e,n,r){super(),this.xu=e,this.cacheSizeBytes=n,this.forceOwnership=r,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.xu.initialize(this,e),await WC(this.xu.syncEngine),await eu(this.xu.remoteStore),await this.persistence.Ji(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}vu(e){return bC(this.persistence,new SC,e.initialUser,this.serializer)}Fu(e,n){const r=this.persistence.referenceDelegate.garbageCollector;return new wC(r,e.asyncQueue,n)}Mu(e,n){const r=new mO(n,this.persistence);return new pO(e.asyncQueue,r)}Cu(e){const n=dL(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?nn.withCacheSize(this.cacheSizeBytes):nn.DEFAULT;return new i_(this.synchronizeTabs,n,e.clientId,r,e.asyncQueue,bL(),Id(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Du(e){return new RC}}class vh{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>RI(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=lM.bind(null,this.syncEngine),await zL(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new HL}()}createDatastore(e){const n=yf(e.databaseInfo.databaseId),r=function(i){return new SL(i)}(e.databaseInfo);return function(i,o,a,l){return new PL(i,o,a,l)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,s,i,o,a){return new kL(r,s,i,o,a)}(this.localStore,this.datastore,e.asyncQueue,n=>RI(this.syncEngine,n,0),function(){return TI.v()?new TI:new EL}())}createSyncEngine(e,n){return function(s,i,o,a,l,d,h){const f=new XL(s,i,o,a,l,d);return h&&(f.gu=!0),f}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(s){const i=Ee(s);W(fo,"RemoteStore shutting down."),i.Ea.add(5),await Zc(i),i.Aa.shutdown(),i.Ra.set("Unknown")}(this.remoteStore),(e=this.datastore)==null||e.terminate(),(n=this.eventManager)==null||n.terminate()}}vh.provider={build:()=>new vh};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class w_{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):mn("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const di="FirestoreClient";class hM{constructor(e,n,r,s,i){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=s,this.user=Wt.UNAUTHENTICATED,this.clientId=Ly.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(r,async o=>{W(di,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>(W(di,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new vr;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=f_(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function Pp(t,e){t.asyncQueue.verifyOperationInProgress(),W(di,"Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async s=>{r.isEqual(s)||(await CC(e.localStore,s),r=s)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function NI(t,e){t.asyncQueue.verifyOperationInProgress();const n=await fM(t);W(di,"Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>SI(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,s)=>SI(e.remoteStore,s)),t._onlineComponents=e}async function fM(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){W(di,"Using user provided OfflineComponentProvider");try{await Pp(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(s){return s.name==="FirebaseError"?s.code===U.FAILED_PRECONDITION||s.code===U.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(n))throw n;so("Error using user provided cache. Falling back to memory cache: "+n),await Pp(t,new Oc)}}else W(di,"Using default OfflineComponentProvider"),await Pp(t,new uM(void 0));return t._offlineComponents}async function E_(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(W(di,"Using user provided OnlineComponentProvider"),await NI(t,t._uninitializedComponentsProvider._online)):(W(di,"Using default OnlineComponentProvider"),await NI(t,new vh))),t._onlineComponents}function pM(t){return E_(t).then(e=>e.syncEngine)}function mM(t){return E_(t).then(e=>e.datastore)}async function wh(t){const e=await E_(t),n=e.eventManager;return n.onListen=JL.bind(null,e.syncEngine),n.onUnlisten=tM.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=ZL.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=nM.bind(null,e.syncEngine),n}function gM(t,e,n={}){const r=new vr;return t.asyncQueue.enqueueAndForget(async()=>function(i,o,a,l,d){const h=new w_({next:m=>{h.Nu(),o.enqueueAndForget(()=>m_(i,f));const _=m.docs.has(a);!_&&m.fromCache?d.reject(new Q(U.UNAVAILABLE,"Failed to get document because the client is offline.")):_&&m.fromCache&&l&&l.source==="server"?d.reject(new Q(U.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):d.resolve(m)},error:m=>d.reject(m)}),f=new y_(Yc(a.path),h,{includeMetadataChanges:!0,qa:!0});return p_(i,f)}(await wh(t),t.asyncQueue,e,n,r)),r.promise}function yM(t,e,n={}){const r=new vr;return t.asyncQueue.enqueueAndForget(async()=>function(i,o,a,l,d){const h=new w_({next:m=>{h.Nu(),o.enqueueAndForget(()=>m_(i,f)),m.fromCache&&l.source==="server"?d.reject(new Q(U.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):d.resolve(m)},error:m=>d.reject(m)}),f=new y_(a,h,{includeMetadataChanges:!0,qa:!0});return p_(i,f)}(await wh(t),t.asyncQueue,e,n,r)),r.promise}function _M(t,e,n){const r=new vr;return t.asyncQueue.enqueueAndForget(async()=>{try{const s=await mM(t);r.resolve(async function(o,a,l){var R;const d=Ee(o),{request:h,gt:f,parent:m}=NV(d.serializer,rV(a),l);d.connection.$o||delete h.parent;const _=(await d.Ho("RunAggregationQuery",d.serializer.databaseId,m,h,1)).filter(C=>!!C.result);he(_.length===1,64727);const A=(R=_[0].result)==null?void 0:R.aggregateFields;return Object.keys(A).reduce((C,w)=>(C[f[w]]=A[w],C),{})}(s,e,n))}catch(s){r.reject(s)}}),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function KC(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kI=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GC="firestore.googleapis.com",DI=!0;class jI{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new Q(U.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=GC,this.ssl=DI}else this.host=e.host,this.ssl=e.ssl??DI;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=gC;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<GV)throw new Q(U.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}cO("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=KC(e.experimentalLongPollingOptions??{}),function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new Q(U.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new Q(U.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new Q(U.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,s){return r.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class vf{constructor(e,n,r,s){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new jI({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Q(U.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Q(U.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new jI(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new Z2;switch(r.type){case"firstParty":return new rO(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new Q(U.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=kI.get(n);r&&(W("ComponentProvider","Removing Datastore"),kI.delete(n),r.terminate())}(this),Promise.resolve()}}function vM(t,e,n,r={}){var d;t=an(t,vf);const s=mi(e),i=t._getSettings(),o={...i,emulatorOptions:t._getEmulatorOptions()},a=`${e}:${n}`;s&&(Iy(`https://${a}`),Ty("Firestore",!0)),i.host!==GC&&i.host!==a&&so("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const l={...i,host:a,ssl:s,emulatorOptions:r};if(!cs(l,o)&&(t._setSettings(l),r.mockUserToken)){let h,f;if(typeof r.mockUserToken=="string")h=r.mockUserToken,f=Wt.MOCK_USER;else{h=rS(r.mockUserToken,(d=t._app)==null?void 0:d.options.projectId);const m=r.mockUserToken.sub||r.mockUserToken.user_id;if(!m)throw new Q(U.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");f=new Wt(m)}t._authCredentials=new eO(new nb(h,f))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class br{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new br(this.firestore,e,this._query)}}class wt{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new si(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new wt(this.firestore,e,this._key)}toJSON(){return{type:wt._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,n,r){if(Kc(n,wt._jsonSchema))return new wt(e,r||null,new ne(He.fromString(n.referencePath)))}}wt._jsonSchemaVersion="firestore/documentReference/1.0",wt._jsonSchema={type:At("string",wt._jsonSchemaVersion),referencePath:At("string")};class si extends br{constructor(e,n,r){super(e,n,Yc(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new wt(this.firestore,null,new ne(e))}withConverter(e){return new si(this.firestore,e,this._path)}}function $e(t,e,...n){if(t=Ke(t),sb("collection","path",e),t instanceof vf){const r=He.fromString(e,...n);return xE(r),new si(t,null,r)}{if(!(t instanceof wt||t instanceof si))throw new Q(U.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(He.fromString(e,...n));return xE(r),new si(t.firestore,null,r)}}function Gt(t,e,...n){if(t=Ke(t),arguments.length===1&&(e=Ly.newId()),sb("doc","path",e),t instanceof vf){const r=He.fromString(e,...n);return TE(r),new wt(t,null,new ne(r))}{if(!(t instanceof wt||t instanceof si))throw new Q(U.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(He.fromString(e,...n));return TE(r),new wt(t.firestore,t instanceof si?t.converter:null,new ne(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OI="AsyncQueue";class VI{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new PC(this,"async_queue_retry"),this._c=()=>{const r=Id();r&&W(OI,"Visibility state changed to "+r.visibilityState),this.M_.w_()},this.ac=e;const n=Id();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const n=Id();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});const n=new vr;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Xu.push(e),this.lc()))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!_i(e))throw e;W(OI,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){const n=this.ac.then(()=>(this.rc=!0,e().catch(r=>{throw this.nc=r,this.rc=!1,mn("INTERNAL UNHANDLED ERROR: ",LI(r)),r}).then(r=>(this.rc=!1,r))));return this.ac=n,n}enqueueAfterDelay(e,n,r){this.uc(),this.oc.indexOf(e)>-1&&(n=0);const s=h_.createAndSchedule(this,e,n,r,i=>this.hc(i));return this.tc.push(s),s}uc(){this.nc&&le(47125,{Pc:LI(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const n of this.tc)if(n.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.tc)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.Tc()})}dc(e){this.oc.push(e)}hc(e){const n=this.tc.indexOf(e);this.tc.splice(n,1)}}function LI(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function MI(t){return function(n,r){if(typeof n!="object"||n===null)return!1;const s=n;for(const i of r)if(i in s&&typeof s[i]=="function")return!0;return!1}(t,["next","error","complete"])}class Tr extends vf{constructor(e,n,r,s){super(e,n,r,s),this.type="firestore",this._queue=new VI,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new VI(e),this._firestoreClient=void 0,await e}}}function QC(t,e){const n=typeof t=="object"?t:Kh(),r=typeof t=="string"?t:lh,s=gi(n,"firestore").getImmediate({identifier:r});if(!s._initialized){const i=eS("firestore");i&&vM(s,...i)}return s}function nu(t){if(t._terminated)throw new Q(U.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||YC(t),t._firestoreClient}function YC(t){var r,s,i;const e=t._freezeSettings(),n=function(a,l,d,h){return new HO(a,l,d,h.host,h.ssl,h.experimentalForceLongPolling,h.experimentalAutoDetectLongPolling,KC(h.experimentalLongPollingOptions),h.useFetchStreams,h.isUsingEmulator)}(t._databaseId,((r=t._app)==null?void 0:r.options.appId)||"",t._persistenceKey,e);t._componentsProvider||(s=e.localCache)!=null&&s._offlineComponentProvider&&((i=e.localCache)!=null&&i._onlineComponentProvider)&&(t._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),t._firestoreClient=new hM(t._authCredentials,t._appCheckCredentials,t._queue,n,t._componentsProvider&&function(a){const l=a==null?void 0:a._online.build();return{_offline:a==null?void 0:a._offline.build(l),_online:l}}(t._componentsProvider))}function wM(t,e){so("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const n=t._freezeSettings();return EM(t,vh.provider,{build:r=>new dM(r,n.cacheSizeBytes,e==null?void 0:e.forceOwnership)}),Promise.resolve()}function EM(t,e,n){if((t=an(t,Tr))._firestoreClient||t._terminated)throw new Q(U.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(t._componentsProvider||t._getSettings().localCache)throw new Q(U.FAILED_PRECONDITION,"SDK cache is already specified.");t._componentsProvider={_online:e,_offline:n},YC(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IM{constructor(e="count",n){this._internalFieldPath=n,this.type="AggregateField",this.aggregateType=e}}class TM{constructor(e,n,r){this._userDataWriter=n,this._data=r,this.type="AggregateQuerySnapshot",this.query=e}data(){return this._userDataWriter.convertObjectMap(this._data)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zn{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Zn(Rt.fromBase64String(e))}catch(n){throw new Q(U.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new Zn(Rt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Zn._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Kc(e,Zn._jsonSchema))return Zn.fromBase64String(e.bytes)}}Zn._jsonSchemaVersion="firestore/bytes/1.0",Zn._jsonSchema={type:At("string",Zn._jsonSchemaVersion),bytes:At("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wf{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new Q(U.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new pt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xa{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hr{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new Q(U.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new Q(U.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return Te(this._lat,e._lat)||Te(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Hr._jsonSchemaVersion}}static fromJSON(e){if(Kc(e,Hr._jsonSchema))return new Hr(e.latitude,e.longitude)}}Hr._jsonSchemaVersion="firestore/geoPoint/1.0",Hr._jsonSchema={type:At("string",Hr._jsonSchemaVersion),latitude:At("number"),longitude:At("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wr{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,s){if(r.length!==s.length)return!1;for(let i=0;i<r.length;++i)if(r[i]!==s[i])return!1;return!0}(this._values,e._values)}toJSON(){return{type:Wr._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Kc(e,Wr._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(n=>typeof n=="number"))return new Wr(e.vectorValues);throw new Q(U.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Wr._jsonSchemaVersion="firestore/vectorValue/1.0",Wr._jsonSchema={type:At("string",Wr._jsonSchemaVersion),vectorValues:At("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xM=/^__.*__$/;class SM{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new gs(e,this.data,this.fieldMask,n,this.fieldTransforms):new Qa(e,this.data,n,this.fieldTransforms)}}class XC{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new gs(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function JC(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw le(40011,{Ac:t})}}class Ef{constructor(e,n,r,s,i,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=s,i===void 0&&this.Rc(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new Ef({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){var s;const n=(s=this.path)==null?void 0:s.child(e),r=this.Vc({path:n,fc:!1});return r.gc(e),r}yc(e){var s;const n=(s=this.path)==null?void 0:s.child(e),r=this.Vc({path:n,fc:!1});return r.Rc(),r}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return Eh(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(JC(this.Ac)&&xM.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class bM{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||yf(e)}Cc(e,n,r,s=!1){return new Ef({Ac:e,methodName:n,Dc:r,path:pt.emptyPath(),fc:!1,bc:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function ru(t){const e=t._freezeSettings(),n=yf(t._databaseId);return new bM(t._databaseId,!!e.ignoreUndefinedProperties,n)}function ZC(t,e,n,r,s,i={}){const o=t.Cc(i.merge||i.mergeFields?2:0,e,n,s);S_("Data must be an object, but it was:",o,r);const a=tA(r,o);let l,d;if(i.merge)l=new An(o.fieldMask),d=o.fieldTransforms;else if(i.mergeFields){const h=[];for(const f of i.mergeFields){const m=yg(e,f,n);if(!o.contains(m))throw new Q(U.INVALID_ARGUMENT,`Field '${m}' is specified in your field mask but missing from your input data.`);rA(h,m)||h.push(m)}l=new An(h),d=o.fieldTransforms.filter(f=>l.covers(f.field))}else l=null,d=o.fieldTransforms;return new SM(new sn(a),l,d)}class If extends Xa{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof If}}function CM(t,e,n){return new Ef({Ac:3,Dc:e.settings.Dc,methodName:t._methodName,fc:n},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class I_ extends Xa{_toFieldTransform(e){return new uf(e.path,new ja)}isEqual(e){return e instanceof I_}}class T_ extends Xa{constructor(e,n){super(e),this.vc=n}_toFieldTransform(e){const n=CM(this,e,!0),r=this.vc.map(i=>Ja(i,n)),s=new lo(r);return new uf(e.path,s)}isEqual(e){return e instanceof T_&&cs(this.vc,e.vc)}}class x_ extends Xa{constructor(e,n){super(e),this.Fc=n}_toFieldTransform(e){const n=new Va(e.serializer,qb(e.serializer,this.Fc));return new uf(e.path,n)}isEqual(e){return e instanceof x_&&this.Fc===e.Fc}}function AM(t,e,n,r){const s=t.Cc(1,e,n);S_("Data must be an object, but it was:",s,r);const i=[],o=sn.empty();vi(r,(l,d)=>{const h=b_(e,l,n);d=Ke(d);const f=s.yc(h);if(d instanceof If)i.push(h);else{const m=Ja(d,f);m!=null&&(i.push(h),o.set(h,m))}});const a=new An(i);return new XC(o,a,s.fieldTransforms)}function RM(t,e,n,r,s,i){const o=t.Cc(1,e,n),a=[yg(e,r,n)],l=[s];if(i.length%2!=0)throw new Q(U.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let m=0;m<i.length;m+=2)a.push(yg(e,i[m])),l.push(i[m+1]);const d=[],h=sn.empty();for(let m=a.length-1;m>=0;--m)if(!rA(d,a[m])){const _=a[m];let A=l[m];A=Ke(A);const R=o.yc(_);if(A instanceof If)d.push(_);else{const C=Ja(A,R);C!=null&&(d.push(_),h.set(_,C))}}const f=new An(d);return new XC(h,f,o.fieldTransforms)}function eA(t,e,n,r=!1){return Ja(n,t.Cc(r?4:3,e))}function Ja(t,e){if(nA(t=Ke(t)))return S_("Unsupported field value:",e,t),tA(t,e);if(t instanceof Xa)return function(r,s){if(!JC(s.Ac))throw s.Sc(`${r._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Sc(`${r._methodName}() is not currently supported inside arrays`);const i=r._toFieldTransform(s);i&&s.fieldTransforms.push(i)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return function(r,s){const i=[];let o=0;for(const a of r){let l=Ja(a,s.wc(o));l==null&&(l={nullValue:"NULL_VALUE"}),i.push(l),o++}return{arrayValue:{values:i}}}(t,e)}return function(r,s){if((r=Ke(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return qb(s.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const i=Be.fromDate(r);return{timestampValue:La(s.serializer,i)}}if(r instanceof Be){const i=new Be(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:La(s.serializer,i)}}if(r instanceof Hr)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Zn)return{bytesValue:tC(s.serializer,r._byteString)};if(r instanceof wt){const i=s.databaseId,o=r.firestore._databaseId;if(!o.isEqual(i))throw s.Sc(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:Zy(r.firestore._databaseId||s.databaseId,r._key.path)}}if(r instanceof Wr)return function(o,a){return{mapValue:{fields:{[qy]:{stringValue:Hy},[Na]:{arrayValue:{values:o.toArray().map(d=>{if(typeof d!="number")throw a.Sc("VectorValues must only contain numeric values.");return Gy(a.serializer,d)})}}}}}}(r,s);throw s.Sc(`Unsupported field value: ${Jh(r)}`)}(t,e)}function tA(t,e){const n={};return wb(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):vi(t,(r,s)=>{const i=Ja(s,e.mc(r));i!=null&&(n[r]=i)}),{mapValue:{fields:n}}}function nA(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof Be||t instanceof Hr||t instanceof Zn||t instanceof wt||t instanceof Xa||t instanceof Wr)}function S_(t,e,n){if(!nA(n)||!ib(n)){const r=Jh(n);throw r==="an object"?e.Sc(t+" a custom object"):e.Sc(t+" "+r)}}function yg(t,e,n){if((e=Ke(e))instanceof wf)return e._internalPath;if(typeof e=="string")return b_(t,e);throw Eh("Field path arguments must be of type string or ",t,!1,void 0,n)}const PM=new RegExp("[~\\*/\\[\\]]");function b_(t,e,n){if(e.search(PM)>=0)throw Eh(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new wf(...e.split("."))._internalPath}catch{throw Eh(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function Eh(t,e,n,r,s){const i=r&&!r.isEmpty(),o=s!==void 0;let a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let l="";return(i||o)&&(l+=" (found",i&&(l+=` in field ${r}`),o&&(l+=` in document ${s}`),l+=")"),new Q(U.INVALID_ARGUMENT,a+t+l)}function rA(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C_{constructor(e,n,r,s,i){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new wt(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new NM(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(Tf("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class NM extends C_{data(){return super.data()}}function Tf(t,e){return typeof e=="string"?b_(t,e):e instanceof wf?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sA(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new Q(U.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class A_{}class su extends A_{}function st(t,e,...n){let r=[];e instanceof A_&&r.push(e),r=r.concat(n),function(i){const o=i.filter(l=>l instanceof R_).length,a=i.filter(l=>l instanceof xf).length;if(o>1||o>0&&a>0)throw new Q(U.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const s of r)t=s._apply(t);return t}class xf extends su{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new xf(e,n,r)}_apply(e){const n=this._parse(e);return oA(e._query,n),new br(e.firestore,e.converter,ig(e._query,n))}_parse(e){const n=ru(e.firestore);return function(i,o,a,l,d,h,f){let m;if(d.isKeyField()){if(h==="array-contains"||h==="array-contains-any")throw new Q(U.INVALID_ARGUMENT,`Invalid Query. You can't perform '${h}' queries on documentId().`);if(h==="in"||h==="not-in"){BI(f,h);const A=[];for(const R of f)A.push($I(l,i,R));m={arrayValue:{values:A}}}else m=$I(l,i,f)}else h!=="in"&&h!=="not-in"&&h!=="array-contains-any"||BI(f,h),m=eA(a,o,f,h==="in"||h==="not-in");return Me.create(d,h,m)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function Qe(t,e,n){const r=e,s=Tf("where",t);return xf._create(s,r,n)}class R_ extends A_{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new R_(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:Ye.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(s,i){let o=s;const a=i.getFlattenedFilters();for(const l of a)oA(o,l),o=ig(o,l)}(e._query,n),new br(e.firestore,e.converter,ig(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class P_ extends su{constructor(e,n){super(),this._field=e,this._direction=n,this.type="orderBy"}static _create(e,n){return new P_(e,n)}_apply(e){const n=function(s,i,o){if(s.startAt!==null)throw new Q(U.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(s.endAt!==null)throw new Q(U.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new jc(i,o)}(e._query,this._field,this._direction);return new br(e.firestore,e.converter,function(s,i){const o=s.explicitOrderBy.concat([i]);return new wi(s.path,s.collectionGroup,o,s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt)}(e._query,n))}}function gn(t,e="asc"){const n=e,r=Tf("orderBy",t);return P_._create(r,n)}class N_ extends su{constructor(e,n,r){super(),this.type=e,this._limit=n,this._limitType=r}static _create(e,n,r){return new N_(e,n,r)}_apply(e){return new br(e.firestore,e.converter,dh(e._query,this._limit,this._limitType))}}function ma(t){return uO("limit",t),N_._create("limit",t,"F")}class Sf extends su{constructor(e,n,r){super(),this.type=e,this._docOrFields=n,this._inclusive=r}static _create(e,n,r){return new Sf(e,n,r)}_apply(e){const n=iA(e,this.type,this._docOrFields,this._inclusive);return new br(e.firestore,e.converter,function(s,i){return new wi(s.path,s.collectionGroup,s.explicitOrderBy.slice(),s.filters.slice(),s.limit,s.limitType,i,s.endAt)}(e._query,n))}}function FI(...t){return Sf._create("startAt",t,!0)}function kM(...t){return Sf._create("startAfter",t,!1)}class k_ extends su{constructor(e,n,r){super(),this.type=e,this._docOrFields=n,this._inclusive=r}static _create(e,n,r){return new k_(e,n,r)}_apply(e){const n=iA(e,this.type,this._docOrFields,this._inclusive);return new br(e.firestore,e.converter,function(s,i){return new wi(s.path,s.collectionGroup,s.explicitOrderBy.slice(),s.filters.slice(),s.limit,s.limitType,s.startAt,i)}(e._query,n))}}function UI(...t){return k_._create("endAt",t,!0)}function iA(t,e,n,r){if(n[0]=Ke(n[0]),n[0]instanceof C_)return function(i,o,a,l,d){if(!l)throw new Q(U.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${a}().`);const h=[];for(const f of fa(i))if(f.field.isKeyField())h.push(oo(o,l.key));else{const m=l.data.field(f.field);if(sf(m))throw new Q(U.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+f.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(m===null){const _=f.field.canonicalString();throw new Q(U.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${_}' (used as the orderBy) does not exist.`)}h.push(m)}return new ci(h,d)}(t._query,t.firestore._databaseId,e,n[0]._document,r);{const s=ru(t.firestore);return function(o,a,l,d,h,f){const m=o.explicitOrderBy;if(h.length>m.length)throw new Q(U.INVALID_ARGUMENT,`Too many arguments provided to ${d}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const _=[];for(let A=0;A<h.length;A++){const R=h[A];if(m[A].field.isKeyField()){if(typeof R!="string")throw new Q(U.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${d}(), but got a ${typeof R}`);if(!Ky(o)&&R.indexOf("/")!==-1)throw new Q(U.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${d}() must be a plain document ID, but '${R}' contains a slash.`);const C=o.path.child(He.fromString(R));if(!ne.isDocumentKey(C))throw new Q(U.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${d}() must result in a valid document path, but '${C}' is not because it contains an odd number of segments.`);const w=new ne(C);_.push(oo(a,w))}else{const C=eA(l,d,R);_.push(C)}}return new ci(_,f)}(t._query,t.firestore._databaseId,s,e,n,r)}}function $I(t,e,n){if(typeof(n=Ke(n))=="string"){if(n==="")throw new Q(U.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Ky(e)&&n.indexOf("/")!==-1)throw new Q(U.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(He.fromString(n));if(!ne.isDocumentKey(r))throw new Q(U.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return oo(t,new ne(r))}if(n instanceof wt)return oo(t,n._key);throw new Q(U.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Jh(n)}.`)}function BI(t,e){if(!Array.isArray(t)||t.length===0)throw new Q(U.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function oA(t,e){const n=function(s,i){for(const o of s)for(const a of o.getFlattenedFilters())if(i.indexOf(a.op)>=0)return a.op;return null}(t.filters,function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new Q(U.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new Q(U.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class DM{convertValue(e,n="none"){switch(ai(e)){case 0:return null;case 1:return e.booleanValue;case 2:return ct(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(fs(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw le(62114,{value:e})}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return vi(e,(s,i)=>{r[s]=this.convertValue(i,n)}),r}convertVectorValue(e){var r,s,i;const n=(i=(s=(r=e.fields)==null?void 0:r[Na].arrayValue)==null?void 0:s.values)==null?void 0:i.map(o=>ct(o.doubleValue));return new Wr(n)}convertGeoPoint(e){return new Hr(ct(e.latitude),ct(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=of(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(Nc(e));default:return null}}convertTimestamp(e){const n=hs(e);return new Be(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=He.fromString(e);he(uC(r),9688,{name:e});const s=new io(r.get(1),r.get(3)),i=new ne(r.popFirst(5));return s.isEqual(n)||mn(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aA(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}function jM(){return new IM("count")}class Ll{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Gi extends C_{constructor(e,n,r,s,i,o){super(e,n,r,s,o),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new Td(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(Tf("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Q(U.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,n={};return n.type=Gi._jsonSchemaVersion,n.bundle="",n.bundleSource="DocumentSnapshot",n.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?n:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),n.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),n)}}Gi._jsonSchemaVersion="firestore/documentSnapshot/1.0",Gi._jsonSchema={type:At("string",Gi._jsonSchemaVersion),bundleSource:At("string","DocumentSnapshot"),bundleName:At("string"),bundle:At("string")};class Td extends Gi{data(e={}){return super.data(e)}}class Qi{constructor(e,n,r,s){this._firestore=e,this._userDataWriter=n,this._snapshot=s,this.metadata=new Ll(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new Td(this._firestore,this._userDataWriter,r.key,r,new Ll(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new Q(U.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(s,i){if(s._snapshot.oldDocs.isEmpty()){let o=0;return s._snapshot.docChanges.map(a=>{const l=new Td(s._firestore,s._userDataWriter,a.doc.key,a.doc,new Ll(s._snapshot.mutatedKeys.has(a.doc.key),s._snapshot.fromCache),s.query.converter);return a.doc,{type:"added",doc:l,oldIndex:-1,newIndex:o++}})}{let o=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(a=>i||a.type!==3).map(a=>{const l=new Td(s._firestore,s._userDataWriter,a.doc.key,a.doc,new Ll(s._snapshot.mutatedKeys.has(a.doc.key),s._snapshot.fromCache),s.query.converter);let d=-1,h=-1;return a.type!==0&&(d=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),h=o.indexOf(a.doc.key)),{type:OM(a.type),doc:l,oldIndex:d,newIndex:h}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Q(U.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Qi._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Ly.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const n=[],r=[],s=[];return this.docs.forEach(i=>{i._document!==null&&(n.push(i._document),r.push(this._userDataWriter.convertObjectMap(i._document.data.value.mapValue.fields,"previous")),s.push(i.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function OM(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return le(61501,{type:t})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ih(t){t=an(t,wt);const e=an(t.firestore,Tr);return gM(nu(e),t._key).then(n=>cA(e,t,n))}Qi._jsonSchemaVersion="firestore/querySnapshot/1.0",Qi._jsonSchema={type:At("string",Qi._jsonSchemaVersion),bundleSource:At("string","QuerySnapshot"),bundleName:At("string"),bundle:At("string")};class bf extends DM{constructor(e){super(),this.firestore=e}convertBytes(e){return new Zn(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new wt(this.firestore,null,n)}}function pn(t){t=an(t,br);const e=an(t.firestore,Tr),n=nu(e),r=new bf(e);return sA(t._query),yM(n,t._query).then(s=>new Qi(e,r,t,s))}function Th(t,e,n){t=an(t,wt);const r=an(t.firestore,Tr),s=aA(t.converter,e,n);return Cf(r,[ZC(ru(r),"setDoc",t._key,s,t.converter!==null,n).toMutation(t._key,on.none())])}function ga(t,e,n,...r){t=an(t,wt);const s=an(t.firestore,Tr),i=ru(s);let o;return o=typeof(e=Ke(e))=="string"||e instanceof wf?RM(i,"updateDoc",t._key,e,n,r):AM(i,"updateDoc",t._key,e),Cf(s,[o.toMutation(t._key,on.exists(!0))])}function lA(t){return Cf(an(t.firestore,Tr),[new hf(t._key,on.none())])}function ra(t,e){const n=an(t.firestore,Tr),r=Gt(t),s=aA(t.converter,e);return Cf(n,[ZC(ru(t.firestore),"addDoc",r._key,s,t.converter!==null,{}).toMutation(r._key,on.exists(!1))]).then(()=>r)}function Fn(t,...e){var l,d,h;t=Ke(t);let n={includeMetadataChanges:!1,source:"default"},r=0;typeof e[r]!="object"||MI(e[r])||(n=e[r++]);const s={includeMetadataChanges:n.includeMetadataChanges,source:n.source};if(MI(e[r])){const f=e[r];e[r]=(l=f.next)==null?void 0:l.bind(f),e[r+1]=(d=f.error)==null?void 0:d.bind(f),e[r+2]=(h=f.complete)==null?void 0:h.bind(f)}let i,o,a;if(t instanceof wt)o=an(t.firestore,Tr),a=Yc(t._key.path),i={next:f=>{e[r]&&e[r](cA(o,t,f))},error:e[r+1],complete:e[r+2]};else{const f=an(t,br);o=an(f.firestore,Tr),a=f._query;const m=new bf(o);i={next:_=>{e[r]&&e[r](new Qi(o,m,f,_))},error:e[r+1],complete:e[r+2]},sA(t._query)}return function(m,_,A,R){const C=new w_(R),w=new y_(_,C,A);return m.asyncQueue.enqueueAndForget(async()=>p_(await wh(m),w)),()=>{C.Nu(),m.asyncQueue.enqueueAndForget(async()=>m_(await wh(m),w))}}(nu(o),a,s,i)}function Cf(t,e){return function(r,s){const i=new vr;return r.asyncQueue.enqueueAndForget(async()=>rM(await pM(r),s,i)),i.promise}(nu(t),e)}function cA(t,e,n){const r=n.docs.get(e._key),s=new bf(t);return new Gi(t,s,e._key,r,new Ll(n.hasPendingWrites,n.fromCache),e.converter)}function VM(t){return LM(t,{count:jM()})}function LM(t,e){const n=an(t.firestore,Tr),r=nu(n),s=zO(e,(i,o)=>new yV(o,i.aggregateType,i._internalFieldPath));return _M(r,t._query,s).then(i=>function(a,l,d){const h=new bf(a);return new TM(l,h,d)}(n,t,i))}function Qn(){return new I_("serverTimestamp")}function MM(...t){return new T_("arrayUnion",t)}function zI(t){return new x_("increment",t)}(function(e,n=!0){(function(s){Ga=s})(wo),Er(new ar("firestore",(r,{instanceIdentifier:s,options:i})=>{const o=r.getProvider("app").getImmediate(),a=new Tr(new tO(r.getProvider("auth-internal")),new sO(o,r.getProvider("app-check-internal")),function(d,h){if(!Object.prototype.hasOwnProperty.apply(d.options,["projectId"]))throw new Q(U.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new io(d.options.projectId,h)}(o,s),o);return i={useFetchStreams:n,...i},a._setSettings(i),a},"PUBLIC").setMultipleInstances(!0)),kn(vE,wE,e),kn(vE,wE,"esm2020")})();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uA="firebasestorage.googleapis.com",dA="storageBucket",FM=2*60*1e3,UM=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class It extends cr{constructor(e,n,r=0){super(Np(e),`Firebase Storage: ${n} (${Np(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,It.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return Np(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var Et;(function(t){t.UNKNOWN="unknown",t.OBJECT_NOT_FOUND="object-not-found",t.BUCKET_NOT_FOUND="bucket-not-found",t.PROJECT_NOT_FOUND="project-not-found",t.QUOTA_EXCEEDED="quota-exceeded",t.UNAUTHENTICATED="unauthenticated",t.UNAUTHORIZED="unauthorized",t.UNAUTHORIZED_APP="unauthorized-app",t.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",t.INVALID_CHECKSUM="invalid-checksum",t.CANCELED="canceled",t.INVALID_EVENT_NAME="invalid-event-name",t.INVALID_URL="invalid-url",t.INVALID_DEFAULT_BUCKET="invalid-default-bucket",t.NO_DEFAULT_BUCKET="no-default-bucket",t.CANNOT_SLICE_BLOB="cannot-slice-blob",t.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",t.NO_DOWNLOAD_URL="no-download-url",t.INVALID_ARGUMENT="invalid-argument",t.INVALID_ARGUMENT_COUNT="invalid-argument-count",t.APP_DELETED="app-deleted",t.INVALID_ROOT_OPERATION="invalid-root-operation",t.INVALID_FORMAT="invalid-format",t.INTERNAL_ERROR="internal-error",t.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(Et||(Et={}));function Np(t){return"storage/"+t}function D_(){const t="An unknown error occurred, please check the error payload for server response.";return new It(Et.UNKNOWN,t)}function $M(t){return new It(Et.OBJECT_NOT_FOUND,"Object '"+t+"' does not exist.")}function BM(t){return new It(Et.QUOTA_EXCEEDED,"Quota for bucket '"+t+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function zM(){const t="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new It(Et.UNAUTHENTICATED,t)}function qM(){return new It(Et.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function HM(t){return new It(Et.UNAUTHORIZED,"User does not have permission to access '"+t+"'.")}function WM(){return new It(Et.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function KM(){return new It(Et.CANCELED,"User canceled the upload/download.")}function GM(t){return new It(Et.INVALID_URL,"Invalid URL '"+t+"'.")}function QM(t){return new It(Et.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}function YM(){return new It(Et.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+dA+"' property when initializing the app?")}function XM(){return new It(Et.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function JM(){return new It(Et.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function ZM(t){return new It(Et.UNSUPPORTED_ENVIRONMENT,`${t} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function _g(t){return new It(Et.INVALID_ARGUMENT,t)}function hA(){return new It(Et.APP_DELETED,"The Firebase app was deleted.")}function eF(t){return new It(Et.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function rc(t,e){return new It(Et.INVALID_FORMAT,"String does not match format '"+t+"': "+e)}function Sl(t){throw new It(Et.INTERNAL_ERROR,"Internal error: "+t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yn{constructor(e,n){this.bucket=e,this.path_=n}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,n){let r;try{r=yn.makeFromUrl(e,n)}catch{return new yn(e,"")}if(r.path==="")return r;throw QM(e)}static makeFromUrl(e,n){let r=null;const s="([A-Za-z0-9.\\-_]+)";function i(x){x.path.charAt(x.path.length-1)==="/"&&(x.path_=x.path_.slice(0,-1))}const o="(/(.*))?$",a=new RegExp("^gs://"+s+o,"i"),l={bucket:1,path:3};function d(x){x.path_=decodeURIComponent(x.path)}const h="v[A-Za-z0-9_]+",f=n.replace(/[.]/g,"\\."),m="(/([^?#]*).*)?$",_=new RegExp(`^https?://${f}/${h}/b/${s}/o${m}`,"i"),A={bucket:1,path:3},R=n===uA?"(?:storage.googleapis.com|storage.cloud.google.com)":n,C="([^?#]*)",w=new RegExp(`^https?://${R}/${s}/${C}`,"i"),b=[{regex:a,indices:l,postModify:i},{regex:_,indices:A,postModify:d},{regex:w,indices:{bucket:1,path:2},postModify:d}];for(let x=0;x<b.length;x++){const L=b[x],$=L.regex.exec(e);if($){const E=$[L.indices.bucket];let v=$[L.indices.path];v||(v=""),r=new yn(E,v),L.postModify(r);break}}if(r==null)throw GM(e);return r}}class tF{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nF(t,e,n){let r=1,s=null,i=null,o=!1,a=0;function l(){return a===2}let d=!1;function h(...C){d||(d=!0,e.apply(null,C))}function f(C){s=setTimeout(()=>{s=null,t(_,l())},C)}function m(){i&&clearTimeout(i)}function _(C,...w){if(d){m();return}if(C){m(),h.call(null,C,...w);return}if(l()||o){m(),h.call(null,C,...w);return}r<64&&(r*=2);let b;a===1?(a=2,b=0):b=(r+Math.random())*1e3,f(b)}let A=!1;function R(C){A||(A=!0,m(),!d&&(s!==null?(C||(a=2),clearTimeout(s),f(0)):C||(a=1)))}return f(0),i=setTimeout(()=>{o=!0,R(!0)},n),R}function rF(t){t(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sF(t){return t!==void 0}function iF(t){return typeof t=="object"&&!Array.isArray(t)}function j_(t){return typeof t=="string"||t instanceof String}function qI(t){return O_()&&t instanceof Blob}function O_(){return typeof Blob<"u"}function vg(t,e,n,r){if(r<e)throw _g(`Invalid value for '${t}'. Expected ${e} or greater.`);if(r>n)throw _g(`Invalid value for '${t}'. Expected ${n} or less.`)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iu(t,e,n){let r=e;return n==null&&(r=`https://${e}`),`${n}://${r}/v0${t}`}function fA(t){const e=encodeURIComponent;let n="?";for(const r in t)if(t.hasOwnProperty(r)){const s=e(r)+"="+e(t[r]);n=n+s+"&"}return n=n.slice(0,-1),n}var Yi;(function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"})(Yi||(Yi={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oF(t,e){const n=t>=500&&t<600,s=[408,429].indexOf(t)!==-1,i=e.indexOf(t)!==-1;return n||s||i}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aF{constructor(e,n,r,s,i,o,a,l,d,h,f,m=!0,_=!1){this.url_=e,this.method_=n,this.headers_=r,this.body_=s,this.successCodes_=i,this.additionalRetryCodes_=o,this.callback_=a,this.errorCallback_=l,this.timeout_=d,this.progressCallback_=h,this.connectionFactory_=f,this.retry=m,this.isUsingEmulator=_,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((A,R)=>{this.resolve_=A,this.reject_=R,this.start_()})}start_(){const e=(r,s)=>{if(s){r(!1,new zu(!1,null,!0));return}const i=this.connectionFactory_();this.pendingConnection_=i;const o=a=>{const l=a.loaded,d=a.lengthComputable?a.total:-1;this.progressCallback_!==null&&this.progressCallback_(l,d)};this.progressCallback_!==null&&i.addUploadProgressListener(o),i.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&i.removeUploadProgressListener(o),this.pendingConnection_=null;const a=i.getErrorCode()===Yi.NO_ERROR,l=i.getStatus();if(!a||oF(l,this.additionalRetryCodes_)&&this.retry){const h=i.getErrorCode()===Yi.ABORT;r(!1,new zu(!1,null,h));return}const d=this.successCodes_.indexOf(l)!==-1;r(!0,new zu(d,i))})},n=(r,s)=>{const i=this.resolve_,o=this.reject_,a=s.connection;if(s.wasSuccessCode)try{const l=this.callback_(a,a.getResponse());sF(l)?i(l):i()}catch(l){o(l)}else if(a!==null){const l=D_();l.serverResponse=a.getErrorText(),this.errorCallback_?o(this.errorCallback_(a,l)):o(l)}else if(s.canceled){const l=this.appDelete_?hA():KM();o(l)}else{const l=WM();o(l)}};this.canceled_?n(!1,new zu(!1,null,!0)):this.backoffId_=nF(e,n,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&rF(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class zu{constructor(e,n,r){this.wasSuccessCode=e,this.connection=n,this.canceled=!!r}}function lF(t,e){e!==null&&e.length>0&&(t.Authorization="Firebase "+e)}function cF(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function uF(t,e){e&&(t["X-Firebase-GMPID"]=e)}function dF(t,e){e!==null&&(t["X-Firebase-AppCheck"]=e)}function hF(t,e,n,r,s,i,o=!0,a=!1){const l=fA(t.urlParams),d=t.url+l,h=Object.assign({},t.headers);return uF(h,e),lF(h,n),cF(h,i),dF(h,r),new aF(d,t.method,h,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,s,o,a)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fF(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function pF(...t){const e=fF();if(e!==void 0){const n=new e;for(let r=0;r<t.length;r++)n.append(t[r]);return n.getBlob()}else{if(O_())return new Blob(t);throw new It(Et.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function mF(t,e,n){return t.webkitSlice?t.webkitSlice(e,n):t.mozSlice?t.mozSlice(e,n):t.slice?t.slice(e,n):null}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gF(t){if(typeof atob>"u")throw ZM("base-64");return atob(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ur={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class kp{constructor(e,n){this.data=e,this.contentType=n||null}}function yF(t,e){switch(t){case Ur.RAW:return new kp(pA(e));case Ur.BASE64:case Ur.BASE64URL:return new kp(mA(t,e));case Ur.DATA_URL:return new kp(vF(e),wF(e))}throw D_()}function pA(t){const e=[];for(let n=0;n<t.length;n++){let r=t.charCodeAt(n);if(r<=127)e.push(r);else if(r<=2047)e.push(192|r>>6,128|r&63);else if((r&64512)===55296)if(!(n<t.length-1&&(t.charCodeAt(n+1)&64512)===56320))e.push(239,191,189);else{const i=r,o=t.charCodeAt(++n);r=65536|(i&1023)<<10|o&1023,e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|r&63)}else(r&64512)===56320?e.push(239,191,189):e.push(224|r>>12,128|r>>6&63,128|r&63)}return new Uint8Array(e)}function _F(t){let e;try{e=decodeURIComponent(t)}catch{throw rc(Ur.DATA_URL,"Malformed data URL.")}return pA(e)}function mA(t,e){switch(t){case Ur.BASE64:{const s=e.indexOf("-")!==-1,i=e.indexOf("_")!==-1;if(s||i)throw rc(t,"Invalid character '"+(s?"-":"_")+"' found: is it base64url encoded?");break}case Ur.BASE64URL:{const s=e.indexOf("+")!==-1,i=e.indexOf("/")!==-1;if(s||i)throw rc(t,"Invalid character '"+(s?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let n;try{n=gF(e)}catch(s){throw s.message.includes("polyfill")?s:rc(t,"Invalid character found")}const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}class gA{constructor(e){this.base64=!1,this.contentType=null;const n=e.match(/^data:([^,]+)?,/);if(n===null)throw rc(Ur.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const r=n[1]||null;r!=null&&(this.base64=EF(r,";base64"),this.contentType=this.base64?r.substring(0,r.length-7):r),this.rest=e.substring(e.indexOf(",")+1)}}function vF(t){const e=new gA(t);return e.base64?mA(Ur.BASE64,e.rest):_F(e.rest)}function wF(t){return new gA(t).contentType}function EF(t,e){return t.length>=e.length?t.substring(t.length-e.length)===e:!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $s{constructor(e,n){let r=0,s="";qI(e)?(this.data_=e,r=e.size,s=e.type):e instanceof ArrayBuffer?(n?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),r=this.data_.length):e instanceof Uint8Array&&(n?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),r=e.length),this.size_=r,this.type_=s}size(){return this.size_}type(){return this.type_}slice(e,n){if(qI(this.data_)){const r=this.data_,s=mF(r,e,n);return s===null?null:new $s(s)}else{const r=new Uint8Array(this.data_.buffer,e,n-e);return new $s(r,!0)}}static getBlob(...e){if(O_()){const n=e.map(r=>r instanceof $s?r.data_:r);return new $s(pF.apply(null,n))}else{const n=e.map(o=>j_(o)?yF(Ur.RAW,o).data:o.data_);let r=0;n.forEach(o=>{r+=o.byteLength});const s=new Uint8Array(r);let i=0;return n.forEach(o=>{for(let a=0;a<o.length;a++)s[i++]=o[a]}),new $s(s,!0)}}uploadData(){return this.data_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function V_(t){let e;try{e=JSON.parse(t)}catch{return null}return iF(e)?e:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function IF(t){if(t.length===0)return null;const e=t.lastIndexOf("/");return e===-1?"":t.slice(0,e)}function TF(t,e){const n=e.split("/").filter(r=>r.length>0).join("/");return t.length===0?n:t+"/"+n}function yA(t){const e=t.lastIndexOf("/",t.length-2);return e===-1?t:t.slice(e+1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xF(t,e){return e}class hn{constructor(e,n,r,s){this.server=e,this.local=n||e,this.writable=!!r,this.xform=s||xF}}let qu=null;function SF(t){return!j_(t)||t.length<2?t:yA(t)}function _A(){if(qu)return qu;const t=[];t.push(new hn("bucket")),t.push(new hn("generation")),t.push(new hn("metageneration")),t.push(new hn("name","fullPath",!0));function e(i,o){return SF(o)}const n=new hn("name");n.xform=e,t.push(n);function r(i,o){return o!==void 0?Number(o):o}const s=new hn("size");return s.xform=r,t.push(s),t.push(new hn("timeCreated")),t.push(new hn("updated")),t.push(new hn("md5Hash",null,!0)),t.push(new hn("cacheControl",null,!0)),t.push(new hn("contentDisposition",null,!0)),t.push(new hn("contentEncoding",null,!0)),t.push(new hn("contentLanguage",null,!0)),t.push(new hn("contentType",null,!0)),t.push(new hn("metadata","customMetadata",!0)),qu=t,qu}function bF(t,e){function n(){const r=t.bucket,s=t.fullPath,i=new yn(r,s);return e._makeStorageReference(i)}Object.defineProperty(t,"ref",{get:n})}function CF(t,e,n){const r={};r.type="file";const s=n.length;for(let i=0;i<s;i++){const o=n[i];r[o.local]=o.xform(r,e[o.server])}return bF(r,t),r}function vA(t,e,n){const r=V_(e);return r===null?null:CF(t,r,n)}function AF(t,e,n,r){const s=V_(e);if(s===null||!j_(s.downloadTokens))return null;const i=s.downloadTokens;if(i.length===0)return null;const o=encodeURIComponent;return i.split(",").map(d=>{const h=t.bucket,f=t.fullPath,m="/b/"+o(h)+"/o/"+o(f),_=iu(m,n,r),A=fA({alt:"media",token:d});return _+A})[0]}function RF(t,e){const n={},r=e.length;for(let s=0;s<r;s++){const i=e[s];i.writable&&(n[i.server]=t[i.local])}return JSON.stringify(n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HI="prefixes",WI="items";function PF(t,e,n){const r={prefixes:[],items:[],nextPageToken:n.nextPageToken};if(n[HI])for(const s of n[HI]){const i=s.replace(/\/$/,""),o=t._makeStorageReference(new yn(e,i));r.prefixes.push(o)}if(n[WI])for(const s of n[WI]){const i=t._makeStorageReference(new yn(e,s.name));r.items.push(i)}return r}function NF(t,e,n){const r=V_(n);return r===null?null:PF(t,e,r)}class Af{constructor(e,n,r,s){this.url=e,this.method=n,this.handler=r,this.timeout=s,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function L_(t){if(!t)throw D_()}function kF(t,e){function n(r,s){const i=vA(t,s,e);return L_(i!==null),i}return n}function DF(t,e){function n(r,s){const i=NF(t,e,s);return L_(i!==null),i}return n}function jF(t,e){function n(r,s){const i=vA(t,s,e);return L_(i!==null),AF(i,s,t.host,t._protocol)}return n}function M_(t){function e(n,r){let s;return n.getStatus()===401?n.getErrorText().includes("Firebase App Check token is invalid")?s=qM():s=zM():n.getStatus()===402?s=BM(t.bucket):n.getStatus()===403?s=HM(t.path):s=r,s.status=n.getStatus(),s.serverResponse=r.serverResponse,s}return e}function wA(t){const e=M_(t);function n(r,s){let i=e(r,s);return r.getStatus()===404&&(i=$M(t.path)),i.serverResponse=s.serverResponse,i}return n}function OF(t,e,n,r,s){const i={};e.isRoot?i.prefix="":i.prefix=e.path+"/",n.length>0&&(i.delimiter=n),r&&(i.pageToken=r),s&&(i.maxResults=s);const o=e.bucketOnlyServerUrl(),a=iu(o,t.host,t._protocol),l="GET",d=t.maxOperationRetryTime,h=new Af(a,l,DF(t,e.bucket),d);return h.urlParams=i,h.errorHandler=M_(e),h}function VF(t,e,n){const r=e.fullServerUrl(),s=iu(r,t.host,t._protocol),i="GET",o=t.maxOperationRetryTime,a=new Af(s,i,jF(t,n),o);return a.errorHandler=wA(e),a}function LF(t,e){const n=e.fullServerUrl(),r=iu(n,t.host,t._protocol),s="DELETE",i=t.maxOperationRetryTime;function o(l,d){}const a=new Af(r,s,o,i);return a.successCodes=[200,204],a.errorHandler=wA(e),a}function MF(t,e){return t&&t.contentType||e&&e.type()||"application/octet-stream"}function FF(t,e,n){const r=Object.assign({},n);return r.fullPath=t.path,r.size=e.size(),r.contentType||(r.contentType=MF(null,e)),r}function UF(t,e,n,r,s){const i=e.bucketOnlyServerUrl(),o={"X-Goog-Upload-Protocol":"multipart"};function a(){let b="";for(let x=0;x<2;x++)b=b+Math.random().toString().slice(2);return b}const l=a();o["Content-Type"]="multipart/related; boundary="+l;const d=FF(e,r,s),h=RF(d,n),f="--"+l+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+h+`\r
--`+l+`\r
Content-Type: `+d.contentType+`\r
\r
`,m=`\r
--`+l+"--",_=$s.getBlob(f,r,m);if(_===null)throw XM();const A={name:d.fullPath},R=iu(i,t.host,t._protocol),C="POST",w=t.maxUploadRetryTime,I=new Af(R,C,kF(t,n),w);return I.urlParams=A,I.headers=o,I.body=_.uploadData(),I.errorHandler=M_(e),I}class $F{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=Yi.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=Yi.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=Yi.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,n,r,s,i){if(this.sent_)throw Sl("cannot .send() more than once");if(mi(e)&&r&&(this.xhr_.withCredentials=!0),this.sent_=!0,this.xhr_.open(n,e,!0),i!==void 0)for(const o in i)i.hasOwnProperty(o)&&this.xhr_.setRequestHeader(o,i[o].toString());return s!==void 0?this.xhr_.send(s):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw Sl("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw Sl("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw Sl("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw Sl("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class BF extends $F{initXhr(){this.xhr_.responseType="text"}}function Rf(){return new BF}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class po{constructor(e,n){this._service=e,n instanceof yn?this._location=n:this._location=yn.makeFromUrl(n,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,n){return new po(e,n)}get root(){const e=new yn(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return yA(this._location.path)}get storage(){return this._service}get parent(){const e=IF(this._location.path);if(e===null)return null;const n=new yn(this._location.bucket,e);return new po(this._service,n)}_throwIfRoot(e){if(this._location.path==="")throw eF(e)}}function zF(t,e,n){t._throwIfRoot("uploadBytes");const r=UF(t.storage,t._location,_A(),new $s(e,!0),n);return t.storage.makeRequestWithTokens(r,Rf).then(s=>({metadata:s,ref:t}))}function qF(t){const e={prefixes:[],items:[]};return EA(t,e).then(()=>e)}async function EA(t,e,n){const s=await HF(t,{pageToken:n});e.prefixes.push(...s.prefixes),e.items.push(...s.items),s.nextPageToken!=null&&await EA(t,e,s.nextPageToken)}function HF(t,e){e!=null&&typeof e.maxResults=="number"&&vg("options.maxResults",1,1e3,e.maxResults);const n=e||{},r=OF(t.storage,t._location,"/",n.pageToken,n.maxResults);return t.storage.makeRequestWithTokens(r,Rf)}function WF(t){t._throwIfRoot("getDownloadURL");const e=VF(t.storage,t._location,_A());return t.storage.makeRequestWithTokens(e,Rf).then(n=>{if(n===null)throw JM();return n})}function KF(t){t._throwIfRoot("deleteObject");const e=LF(t.storage,t._location);return t.storage.makeRequestWithTokens(e,Rf)}function GF(t,e){const n=TF(t._location.path,e),r=new yn(t._location.bucket,n);return new po(t.storage,r)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function QF(t){return/^[A-Za-z]+:\/\//.test(t)}function YF(t,e){return new po(t,e)}function IA(t,e){if(t instanceof F_){const n=t;if(n._bucket==null)throw YM();const r=new po(n,n._bucket);return e!=null?IA(r,e):r}else return e!==void 0?GF(t,e):t}function XF(t,e){if(e&&QF(e)){if(t instanceof F_)return YF(t,e);throw _g("To use ref(service, url), the first argument must be a Storage instance.")}else return IA(t,e)}function KI(t,e){const n=e==null?void 0:e[dA];return n==null?null:yn.makeFromBucketSpec(n,t)}function JF(t,e,n,r={}){t.host=`${e}:${n}`;const s=mi(e);s&&(Iy(`https://${t.host}/b`),Ty("Storage",!0)),t._isUsingEmulator=!0,t._protocol=s?"https":"http";const{mockUserToken:i}=r;i&&(t._overrideAuthToken=typeof i=="string"?i:rS(i,t.app.options.projectId))}class F_{constructor(e,n,r,s,i,o=!1){this.app=e,this._authProvider=n,this._appCheckProvider=r,this._url=s,this._firebaseVersion=i,this._isUsingEmulator=o,this._bucket=null,this._host=uA,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=FM,this._maxUploadRetryTime=UM,this._requests=new Set,s!=null?this._bucket=yn.makeFromBucketSpec(s,this._host):this._bucket=KI(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=yn.makeFromBucketSpec(this._url,e):this._bucket=KI(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){vg("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){vg("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const n=await e.getToken();if(n!==null)return n.accessToken}return null}async _getAppCheckToken(){if(Jn(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new po(this,e)}_makeRequest(e,n,r,s,i=!0){if(this._deleted)return new tF(hA());{const o=hF(e,this._appId,r,s,n,this._firebaseVersion,i,this._isUsingEmulator);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}async makeRequestWithTokens(e,n){const[r,s]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,n,r,s).getPromise()}}const GI="@firebase/storage",QI="0.14.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TA="storage";function YI(t,e,n){return t=Ke(t),zF(t,e,n)}function XI(t){return t=Ke(t),qF(t)}function JI(t){return t=Ke(t),WF(t)}function Dp(t){return t=Ke(t),KF(t)}function bl(t,e){return t=Ke(t),XF(t,e)}function Li(t=Kh(),e){t=Ke(t);const r=gi(t,TA).getImmediate({identifier:e}),s=eS("storage");return s&&ZF(r,...s),r}function ZF(t,e,n,r={}){JF(t,e,n,r)}function e4(t,{instanceIdentifier:e}){const n=t.getProvider("app").getImmediate(),r=t.getProvider("auth-internal"),s=t.getProvider("app-check-internal");return new F_(n,r,s,e,wo)}function t4(){Er(new ar(TA,e4,"PUBLIC").setMultipleInstances(!0)),kn(GI,QI,""),kn(GI,QI,"esm2020")}t4();const n4={apiKey:"AIzaSyC70mGCRrjE8iOap8iTHuid8HEuyadue8Y",authDomain:"odontocloud-d92ac.firebaseapp.com",projectId:"odontocloud-d92ac",storageBucket:"odontocloud-d92ac.firebasestorage.app",messagingSenderId:"267020714981",appId:"1:267020714981:web:a44416ea83aa1d1172650c",measurementId:"G-ZMCC5CFY0C"},U_=by(n4),ZI=GS(U_),eT=QC(U_);Li(U_);const r4="/odontocloud-react/assets/fondo.png",xA="/odontocloud-react/assets/logo.png",tT=(t,e)=>{const n={email:t,rol:e,timestamp:Date.now()};localStorage.setItem("odc_session",JSON.stringify(n))},jp=()=>{try{const t=JSON.parse(localStorage.getItem("odc_session"));return t&&Date.now()-t.timestamp<1e3*60*60*24?t:null}catch{return null}},s4=()=>{const t=Ha(),[e,n]=P.useState(""),[r,s]=P.useState(""),[i,o]=P.useState(""),[a,l]=P.useState(navigator.onLine);P.useEffect(()=>{const f=()=>l(!0),m=()=>l(!1);return window.addEventListener("online",f),window.addEventListener("offline",m),()=>{window.removeEventListener("online",f),window.removeEventListener("offline",m)}},[]);const d=f=>{const m=(f||"").toLowerCase();m==="administrador"?t("/dashboard_admin",{replace:!0}):m==="doctor"?t("/dashboard_doctor",{replace:!0}):m==="recepcionista"?t("/dashboard_recepcion",{replace:!0}):o("Rol no reconocido. Contacte al administrador.")};P.useEffect(()=>{if(!navigator.onLine){const m=jp();m!=null&&m.rol?d(m.rol):o("Sin conexin y no hay sesin guardada.");return}const f=Dy(ZI,async m=>{if(m){const _=jp();if(_!=null&&_.rol){d(_.rol);return}try{const A=st($e(eT,"users"),Qe("correo","==",m.email||"")),R=await pn(A);if(!R.empty){const C=R.docs[0].data().rol||"sin_rol";tT(m.email||"",C),d(C)}}catch{d("administrador")}}});return()=>f()},[]);const h=async f=>{if(f.preventDefault(),o(""),!a){const m=jp();m!=null&&m.rol?d(m.rol):o("Sin conexin y no hay sesin guardada.");return}try{const _=(await Mj(ZI,e,r)).user,A=st($e(eT,"users"),Qe("correo","==",e)),R=await pn(A);if(R.empty){o("Usuario no encontrado en la base de datos.");return}const w=R.docs[0].data().rol||"sin_rol";tT(e,w),d(w)}catch(m){switch(console.error("Error login:",m),m.code){case"auth/user-not-found":o("Usuario no registrado.");break;case"auth/wrong-password":o("Contrasea incorrecta.");break;case"auth/invalid-email":o("Correo no vlido.");break;case"auth/network-request-failed":o("Sin conexin. Usa la sesin guardada o reconecta.");break;default:o("Error al iniciar sesin.")}}};return u.jsx("div",{className:"login-root",style:{backgroundImage:`url(${r4})`,backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat",backgroundAttachment:"fixed",width:"100vw",height:"100vh",display:"flex",justifyContent:"center",alignItems:"center",overflow:"hidden"},children:u.jsxs("div",{className:"container",children:[u.jsxs("div",{className:"left-panel",children:[u.jsx("img",{src:xA,alt:"OdontoCloud Logo",className:"logo"}),u.jsxs("h2",{children:["Su clnica, ",u.jsx("br",{})," ms conectada."]}),u.jsx("p",{children:"OdontoCloud optimiza cada detalle de su gestin."})]}),u.jsxs("div",{className:"right-panel",children:[u.jsx("h3",{children:"Acceso a la plataforma"}),u.jsxs("form",{onSubmit:h,children:[u.jsx("input",{type:"email",placeholder:"usuario@ejemplo.com",value:e,onChange:f=>n(f.target.value),required:a}),u.jsx("input",{type:"password",placeholder:"Contrasea",value:r,onChange:f=>s(f.target.value),required:a}),u.jsx("button",{type:"submit",children:a?"Iniciar sesin":"Entrar (modo offline)"}),i&&u.jsx("p",{style:{color:"red",marginTop:10},children:i}),!a&&u.jsx("p",{style:{color:"orange",marginTop:10},children:" Modo offline activado"})]})]})]})})},SA="@firebase/installations",$_="0.6.19";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bA=1e4,CA=`w:${$_}`,AA="FIS_v2",i4="https://firebaseinstallations.googleapis.com/v1",o4=60*60*1e3,a4="installations",l4="Installations";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const c4={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},mo=new vo(a4,l4,c4);function RA(t){return t instanceof cr&&t.code.includes("request-failed")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PA({projectId:t}){return`${i4}/projects/${t}/installations`}function NA(t){return{token:t.token,requestStatus:2,expiresIn:d4(t.expiresIn),creationTime:Date.now()}}async function kA(t,e){const r=(await e.json()).error;return mo.create("request-failed",{requestName:t,serverCode:r.code,serverMessage:r.message,serverStatus:r.status})}function DA({apiKey:t}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t})}function u4(t,{refreshToken:e}){const n=DA(t);return n.append("Authorization",h4(e)),n}async function jA(t){const e=await t();return e.status>=500&&e.status<600?t():e}function d4(t){return Number(t.replace("s","000"))}function h4(t){return`${AA} ${t}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function f4({appConfig:t,heartbeatServiceProvider:e},{fid:n}){const r=PA(t),s=DA(t),i=e.getImmediate({optional:!0});if(i){const d=await i.getHeartbeatsHeader();d&&s.append("x-firebase-client",d)}const o={fid:n,authVersion:AA,appId:t.appId,sdkVersion:CA},a={method:"POST",headers:s,body:JSON.stringify(o)},l=await jA(()=>fetch(r,a));if(l.ok){const d=await l.json();return{fid:d.fid||n,registrationStatus:2,refreshToken:d.refreshToken,authToken:NA(d.authToken)}}else throw await kA("Create Installation",l)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OA(t){return new Promise(e=>{setTimeout(e,t)})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function p4(t){return btoa(String.fromCharCode(...t)).replace(/\+/g,"-").replace(/\//g,"_")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const m4=/^[cdef][\w-]{21}$/,wg="";function g4(){try{const t=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(t),t[0]=112+t[0]%16;const n=y4(t);return m4.test(n)?n:wg}catch{return wg}}function y4(t){return p4(t).substr(0,22)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pf(t){return`${t.appName}!${t.appId}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VA=new Map;function LA(t,e){const n=Pf(t);MA(n,e),_4(n,e)}function MA(t,e){const n=VA.get(t);if(n)for(const r of n)r(e)}function _4(t,e){const n=v4();n&&n.postMessage({key:t,fid:e}),w4()}let Bi=null;function v4(){return!Bi&&"BroadcastChannel"in self&&(Bi=new BroadcastChannel("[Firebase] FID Change"),Bi.onmessage=t=>{MA(t.data.key,t.data.fid)}),Bi}function w4(){VA.size===0&&Bi&&(Bi.close(),Bi=null)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const E4="firebase-installations-database",I4=1,go="firebase-installations-store";let Op=null;function B_(){return Op||(Op=dS(E4,I4,{upgrade:(t,e)=>{switch(e){case 0:t.createObjectStore(go)}}})),Op}async function xh(t,e){const n=Pf(t),s=(await B_()).transaction(go,"readwrite"),i=s.objectStore(go),o=await i.get(n);return await i.put(e,n),await s.done,(!o||o.fid!==e.fid)&&LA(t,e.fid),e}async function FA(t){const e=Pf(t),r=(await B_()).transaction(go,"readwrite");await r.objectStore(go).delete(e),await r.done}async function Nf(t,e){const n=Pf(t),s=(await B_()).transaction(go,"readwrite"),i=s.objectStore(go),o=await i.get(n),a=e(o);return a===void 0?await i.delete(n):await i.put(a,n),await s.done,a&&(!o||o.fid!==a.fid)&&LA(t,a.fid),a}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function z_(t){let e;const n=await Nf(t.appConfig,r=>{const s=T4(r),i=x4(t,s);return e=i.registrationPromise,i.installationEntry});return n.fid===wg?{installationEntry:await e}:{installationEntry:n,registrationPromise:e}}function T4(t){const e=t||{fid:g4(),registrationStatus:0};return UA(e)}function x4(t,e){if(e.registrationStatus===0){if(!navigator.onLine){const s=Promise.reject(mo.create("app-offline"));return{installationEntry:e,registrationPromise:s}}const n={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},r=S4(t,n);return{installationEntry:n,registrationPromise:r}}else return e.registrationStatus===1?{installationEntry:e,registrationPromise:b4(t)}:{installationEntry:e}}async function S4(t,e){try{const n=await f4(t,e);return xh(t.appConfig,n)}catch(n){throw RA(n)&&n.customData.serverCode===409?await FA(t.appConfig):await xh(t.appConfig,{fid:e.fid,registrationStatus:0}),n}}async function b4(t){let e=await nT(t.appConfig);for(;e.registrationStatus===1;)await OA(100),e=await nT(t.appConfig);if(e.registrationStatus===0){const{installationEntry:n,registrationPromise:r}=await z_(t);return r||n}return e}function nT(t){return Nf(t,e=>{if(!e)throw mo.create("installation-not-found");return UA(e)})}function UA(t){return C4(t)?{fid:t.fid,registrationStatus:0}:t}function C4(t){return t.registrationStatus===1&&t.registrationTime+bA<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function A4({appConfig:t,heartbeatServiceProvider:e},n){const r=R4(t,n),s=u4(t,n),i=e.getImmediate({optional:!0});if(i){const d=await i.getHeartbeatsHeader();d&&s.append("x-firebase-client",d)}const o={installation:{sdkVersion:CA,appId:t.appId}},a={method:"POST",headers:s,body:JSON.stringify(o)},l=await jA(()=>fetch(r,a));if(l.ok){const d=await l.json();return NA(d)}else throw await kA("Generate Auth Token",l)}function R4(t,{fid:e}){return`${PA(t)}/${e}/authTokens:generate`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function q_(t,e=!1){let n;const r=await Nf(t.appConfig,i=>{if(!$A(i))throw mo.create("not-registered");const o=i.authToken;if(!e&&k4(o))return i;if(o.requestStatus===1)return n=P4(t,e),i;{if(!navigator.onLine)throw mo.create("app-offline");const a=j4(i);return n=N4(t,a),a}});return n?await n:r.authToken}async function P4(t,e){let n=await rT(t.appConfig);for(;n.authToken.requestStatus===1;)await OA(100),n=await rT(t.appConfig);const r=n.authToken;return r.requestStatus===0?q_(t,e):r}function rT(t){return Nf(t,e=>{if(!$A(e))throw mo.create("not-registered");const n=e.authToken;return O4(n)?{...e,authToken:{requestStatus:0}}:e})}async function N4(t,e){try{const n=await A4(t,e),r={...e,authToken:n};return await xh(t.appConfig,r),n}catch(n){if(RA(n)&&(n.customData.serverCode===401||n.customData.serverCode===404))await FA(t.appConfig);else{const r={...e,authToken:{requestStatus:0}};await xh(t.appConfig,r)}throw n}}function $A(t){return t!==void 0&&t.registrationStatus===2}function k4(t){return t.requestStatus===2&&!D4(t)}function D4(t){const e=Date.now();return e<t.creationTime||t.creationTime+t.expiresIn<e+o4}function j4(t){const e={requestStatus:1,requestTime:Date.now()};return{...t,authToken:e}}function O4(t){return t.requestStatus===1&&t.requestTime+bA<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function V4(t){const e=t,{installationEntry:n,registrationPromise:r}=await z_(e);return r?r.catch(console.error):q_(e).catch(console.error),n.fid}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function L4(t,e=!1){const n=t;return await M4(n),(await q_(n,e)).token}async function M4(t){const{registrationPromise:e}=await z_(t);e&&await e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function F4(t){if(!t||!t.options)throw Vp("App Configuration");if(!t.name)throw Vp("App Name");const e=["projectId","apiKey","appId"];for(const n of e)if(!t.options[n])throw Vp(n);return{appName:t.name,projectId:t.options.projectId,apiKey:t.options.apiKey,appId:t.options.appId}}function Vp(t){return mo.create("missing-app-config-values",{valueName:t})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BA="installations",U4="installations-internal",$4=t=>{const e=t.getProvider("app").getImmediate(),n=F4(e),r=gi(e,"heartbeat");return{app:e,appConfig:n,heartbeatServiceProvider:r,_delete:()=>Promise.resolve()}},B4=t=>{const e=t.getProvider("app").getImmediate(),n=gi(e,BA).getImmediate();return{getId:()=>V4(n),getToken:s=>L4(n,s)}};function z4(){Er(new ar(BA,$4,"PUBLIC")),Er(new ar(U4,B4,"PRIVATE"))}z4();kn(SA,$_);kn(SA,$_,"esm2020");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sh="analytics",q4="firebase_id",H4="origin",W4=60*1e3,K4="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",H_="https://www.googletagmanager.com/gtag/js";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wn=new Wh("@firebase/analytics");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const G4={"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-initialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."},zn=new vo("analytics","Analytics",G4);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Q4(t){if(!t.startsWith(H_)){const e=zn.create("invalid-gtag-resource",{gtagURL:t});return wn.warn(e.message),""}return t}function zA(t){return Promise.all(t.map(e=>e.catch(n=>n)))}function Y4(t,e){let n;return window.trustedTypes&&(n=window.trustedTypes.createPolicy(t,e)),n}function X4(t,e){const n=Y4("firebase-js-sdk-policy",{createScriptURL:Q4}),r=document.createElement("script"),s=`${H_}?l=${t}&id=${e}`;r.src=n?n==null?void 0:n.createScriptURL(s):s,r.async=!0,document.head.appendChild(r)}function J4(t){let e=[];return Array.isArray(window[t])?e=window[t]:window[t]=e,e}async function Z4(t,e,n,r,s,i){const o=r[s];try{if(o)await e[o];else{const l=(await zA(n)).find(d=>d.measurementId===s);l&&await e[l.appId]}}catch(a){wn.error(a)}t("config",s,i)}async function eU(t,e,n,r,s){try{let i=[];if(s&&s.send_to){let o=s.send_to;Array.isArray(o)||(o=[o]);const a=await zA(n);for(const l of o){const d=a.find(f=>f.measurementId===l),h=d&&e[d.appId];if(h)i.push(h);else{i=[];break}}}i.length===0&&(i=Object.values(e)),await Promise.all(i),t("event",r,s||{})}catch(i){wn.error(i)}}function tU(t,e,n,r){async function s(i,...o){try{if(i==="event"){const[a,l]=o;await eU(t,e,n,a,l)}else if(i==="config"){const[a,l]=o;await Z4(t,e,n,r,a,l)}else if(i==="consent"){const[a,l]=o;t("consent",a,l)}else if(i==="get"){const[a,l,d]=o;t("get",a,l,d)}else if(i==="set"){const[a]=o;t("set",a)}else t(i,...o)}catch(a){wn.error(a)}}return s}function nU(t,e,n,r,s){let i=function(...o){window[r].push(arguments)};return window[s]&&typeof window[s]=="function"&&(i=window[s]),window[s]=tU(i,t,e,n),{gtagCore:i,wrappedGtag:window[s]}}function rU(t){const e=window.document.getElementsByTagName("script");for(const n of Object.values(e))if(n.src&&n.src.includes(H_)&&n.src.includes(t))return n;return null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sU=30,iU=1e3;class oU{constructor(e={},n=iU){this.throttleMetadata=e,this.intervalMillis=n}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,n){this.throttleMetadata[e]=n}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}}const qA=new oU;function aU(t){return new Headers({Accept:"application/json","x-goog-api-key":t})}async function lU(t){var o;const{appId:e,apiKey:n}=t,r={method:"GET",headers:aU(n)},s=K4.replace("{app-id}",e),i=await fetch(s,r);if(i.status!==200&&i.status!==304){let a="";try{const l=await i.json();(o=l.error)!=null&&o.message&&(a=l.error.message)}catch{}throw zn.create("config-fetch-failed",{httpStatus:i.status,responseMessage:a})}return i.json()}async function cU(t,e=qA,n){const{appId:r,apiKey:s,measurementId:i}=t.options;if(!r)throw zn.create("no-app-id");if(!s){if(i)return{measurementId:i,appId:r};throw zn.create("no-api-key")}const o=e.getThrottleMetadata(r)||{backoffCount:0,throttleEndTimeMillis:Date.now()},a=new hU;return setTimeout(async()=>{a.abort()},W4),HA({appId:r,apiKey:s,measurementId:i},o,a,e)}async function HA(t,{throttleEndTimeMillis:e,backoffCount:n},r,s=qA){var a;const{appId:i,measurementId:o}=t;try{await uU(r,e)}catch(l){if(o)return wn.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${o} provided in the "measurementId" field in the local Firebase config. [${l==null?void 0:l.message}]`),{appId:i,measurementId:o};throw l}try{const l=await lU(t);return s.deleteThrottleMetadata(i),l}catch(l){const d=l;if(!dU(d)){if(s.deleteThrottleMetadata(i),o)return wn.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${o} provided in the "measurementId" field in the local Firebase config. [${d==null?void 0:d.message}]`),{appId:i,measurementId:o};throw l}const h=Number((a=d==null?void 0:d.customData)==null?void 0:a.httpStatus)===503?zw(n,s.intervalMillis,sU):zw(n,s.intervalMillis),f={throttleEndTimeMillis:Date.now()+h,backoffCount:n+1};return s.setThrottleMetadata(i,f),wn.debug(`Calling attemptFetch again in ${h} millis`),HA(t,f,r,s)}}function uU(t,e){return new Promise((n,r)=>{const s=Math.max(e-Date.now(),0),i=setTimeout(n,s);t.addEventListener(()=>{clearTimeout(i),r(zn.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}function dU(t){if(!(t instanceof cr)||!t.customData)return!1;const e=Number(t.customData.httpStatus);return e===429||e===500||e===503||e===504}class hU{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach(e=>e())}}async function fU(t,e,n,r,s){if(s&&s.global){t("event",n,r);return}else{const i=await e,o={...r,send_to:i};t("event",n,o)}}async function pU(t,e,n,r){if(r&&r.global){const s={};for(const i of Object.keys(n))s[`user_properties.${i}`]=n[i];return t("set",s),Promise.resolve()}else{const s=await e;t("config",s,{update:!0,user_properties:n})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function mU(){if(xy())try{await lS()}catch(t){return wn.warn(zn.create("indexeddb-unavailable",{errorInfo:t==null?void 0:t.toString()}).message),!1}else return wn.warn(zn.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;return!0}async function gU(t,e,n,r,s,i,o){const a=cU(t);a.then(m=>{n[m.measurementId]=m.appId,t.options.measurementId&&m.measurementId!==t.options.measurementId&&wn.warn(`The measurement ID in the local Firebase config (${t.options.measurementId}) does not match the measurement ID fetched from the server (${m.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(m=>wn.error(m)),e.push(a);const l=mU().then(m=>{if(m)return r.getId()}),[d,h]=await Promise.all([a,l]);rU(i)||X4(i,d.measurementId),s("js",new Date);const f=(o==null?void 0:o.config)??{};return f[H4]="firebase",f.update=!0,h!=null&&(f[q4]=h),s("config",d.measurementId,f),d.measurementId}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yU{constructor(e){this.app=e}_delete(){return delete ya[this.app.options.appId],Promise.resolve()}}let ya={},sT=[];const iT={};let Lp="dataLayer",_U="gtag",oT,W_,aT=!1;function vU(){const t=[];if(iS()&&t.push("This is a browser extension environment."),wk()||t.push("Cookies are not available."),t.length>0){const e=t.map((r,s)=>`(${s+1}) ${r}`).join(" "),n=zn.create("invalid-analytics-context",{errorInfo:e});wn.warn(n.message)}}function wU(t,e,n){vU();const r=t.options.appId;if(!r)throw zn.create("no-app-id");if(!t.options.apiKey)if(t.options.measurementId)wn.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${t.options.measurementId} provided in the "measurementId" field in the local Firebase config.`);else throw zn.create("no-api-key");if(ya[r]!=null)throw zn.create("already-exists",{id:r});if(!aT){J4(Lp);const{wrappedGtag:i,gtagCore:o}=nU(ya,sT,iT,Lp,_U);W_=i,oT=o,aT=!0}return ya[r]=gU(t,sT,iT,e,oT,Lp,n),new yU(t)}function EU(t=Kh()){t=Ke(t);const e=gi(t,Sh);return e.isInitialized()?e.getImmediate():IU(t)}function IU(t,e={}){const n=gi(t,Sh);if(n.isInitialized()){const s=n.getImmediate();if(cs(e,n.getOptions()))return s;throw zn.create("already-initialized")}return n.initialize({options:e})}function TU(t,e,n){t=Ke(t),pU(W_,ya[t.app.options.appId],e,n).catch(r=>wn.error(r))}function xU(t,e,n,r){t=Ke(t),fU(W_,ya[t.app.options.appId],e,n,r).catch(s=>wn.error(s))}const lT="@firebase/analytics",cT="0.10.19";function SU(){Er(new ar(Sh,(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("installations-internal").getImmediate();return wU(r,s,n)},"PUBLIC")),Er(new ar("analytics-internal",t,"PRIVATE")),kn(lT,cT),kn(lT,cT,"esm2020");function t(e){try{const n=e.getProvider(Sh).getImmediate();return{logEvent:(r,s,i)=>xU(n,r,s,i),setUserProperties:(r,s)=>TU(n,r,s)}}catch(n){throw zn.create("interop-component-reg-failed",{reason:n})}}}SU();const bU={apiKey:"AIzaSyC70mGCRrjE8iOap8iTHuid8HEuyadue8Y",authDomain:"odontocloud-d92ac.firebaseapp.com",projectId:"odontocloud-d92ac",storageBucket:"odontocloud-d92ac.firebasestorage.app",messagingSenderId:"267020714981",appId:"1:267020714981:web:a44416ea83aa1d1172650c",measurementId:"G-ZMCC5CFY0C"},kf=by(bU),bh=GS(kf),_e=QC(kf);Li(kf);EU(kf);const Mp="TU EMPRESA S.A.S.",CU="Generado por OdontoCloud",Hu=()=>{const t=new Date;return t.setHours(0,0,0,0),t},Ps=t=>{const e=new Date(t);return e.setHours(0,0,0,0),e},Fp=t=>{const e=new Date(t);return e.setHours(23,59,59,999),e},Dr=(t,e)=>{const n=new Date(t);return n.setDate(n.getDate()+e),n},uT=t=>{const e=new Date(t),n=e.getDay(),r=(n===0?-6:1)-n;return e.setDate(e.getDate()+r),e.setHours(0,0,0,0),e},dT=(t,e)=>t.getFullYear()===e.getFullYear()&&t.getMonth()===e.getMonth()&&t.getDate()===e.getDate();var _T;const Sn=typeof navigator<"u"&&((_T=navigator.language)!=null&&_T.startsWith("es"))?"es-ES":"en-US",Up=t=>{const e=t.getFullYear(),n=String(t.getMonth()+1).padStart(2,"0"),r=String(t.getDate()).padStart(2,"0");return`${e}-${n}-${r}`},Do=t=>(t||"").toString().toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/\s+/g," ").trim(),AU=t=>{try{const e=new URLSearchParams(t||""),n=e.get("date")||e.get("day")||e.get("d")||e.get("fecha")||e.get("selectedDate")||(typeof sessionStorage<"u"?sessionStorage.getItem("agenda.targetDate"):""),r=String(n||"").slice(0,10);if(!/^\d{4}-\d{2}-\d{2}$/.test(r))return null;const[s,i,o]=r.split("-").map(l=>parseInt(l,10));return new Date(s,(i||1)-1,o||1,0,0,0,0)}catch{return null}};function RU(){const t=lr(),[e,n]=P.useState("day"),[r,s]=P.useState(Hu()),[i,o]=P.useState(Hu()),[a,l]=P.useState(!0),[d,h]=P.useState([]),[f,m]=P.useState(""),[_,A]=P.useState(""),[R,C]=P.useState("");P.useEffect(()=>{const B=AU(t.search);if(B){const re=Ps(B);s(re),o(re),n("day");try{sessionStorage.removeItem("agenda.targetDate")}catch{}}},[t.search]),P.useEffect(()=>{l(!0);const B=$e(_e,"citas"),re=st(B,gn("fecha","asc")),ce=Fn(re,xe=>{const Se=xe.docs.map(Ie=>{const se=Ie.data(),Ne=se.horaInicio||se.hora||"00:00",[et="0",Tt="0"]=Ne.split(":"),H=parseInt(et,10)||0,ee=parseInt(Tt,10)||0;let te;if(se.fecha&&se.fecha.toDate)te=se.fecha.toDate(),te.setHours(H,ee,0,0);else if(typeof se.fecha=="string"){const[me,ge,Fe]=se.fecha.split("-");te=new Date(parseInt(me,10),parseInt(ge,10)-1,parseInt(Fe,10),H,ee,0,0)}else se.fecha instanceof Date?(te=new Date(se.fecha),te.setHours(H,ee,0,0)):(te=new Date,te.setHours(H,ee,0,0));const q=se.documentoPaciente||se.docPaciente||se.pacienteDocumento||se.documento||"",ae=se.celularPaciente||se.telefonoPaciente||se.celular||se.telefono||"";return{id:Ie.id,raw:se,fecha:te,horaInicio:Ne,paciente:se.paciente||se.pacienteNombre||"Sin nombre",doctor:se.doctor||se.doctorNombre||"",sucursal:se.sucursal||"",espacio:se.espacio||se.consultorio||"",comentario:se.comentario||"",estado:se.estado||"En espera",recordatorio:se.recordatorio||"",documento:q,telefono:ae}});let De,we;if(e==="day")De=Ps(r),we=Fp(r);else if(e==="week"){const Ie=uT(r),se=Dr(Ie,6);De=Ps(Ie),we=Fp(se)}else{const Ie=Ps(r),se=Dr(Ie,-30),Ne=Dr(Ie,60);De=Ps(se),we=Fp(Ne)}const Ze=Se.filter(Ie=>Ie.fecha>=De&&Ie.fecha<=we);h(Ze),l(!1)},xe=>{console.error("Error leyendo citas:",xe),h([]),l(!1)});return()=>ce()},[e,r]);const w=P.useMemo(()=>{const B=new Set;return d.forEach(re=>re.sucursal&&B.add(re.sucursal)),Array.from(B)},[d]),I=P.useMemo(()=>{const B=new Set;return d.forEach(re=>re.doctor&&B.add(re.doctor)),Array.from(B)},[d]),b=P.useMemo(()=>{const B=R.trim().toLowerCase();return d.filter(re=>{if(f&&re.sucursal!==f||_&&re.doctor!==_)return!1;if(!B)return!0;const ce=[re.paciente,re.doctor,re.comentario,re.documento,re.sucursal,re.espacio,re.estado],xe=re.raw?JSON.stringify(re.raw):"";return[...ce,xe].filter(Boolean).some(De=>String(De).toLowerCase().includes(B))})},[d,f,_,R]),x=P.useMemo(()=>a?"Ocupacin: cargando...":b.length===0?"Ocupacin: sin citas para el rango seleccionado.":`Ocupacin: ${b.length} cita${b.length!==1?"s":""} en el rango actual.`,[b,a]),L=P.useMemo(()=>{const B=new Date(i.getFullYear(),i.getMonth(),1),re=(B.getDay()+6)%7,ce=new Date(B);ce.setDate(ce.getDate()-re);const xe=[];for(let Se=0;Se<6;Se++){const De=[];for(let we=0;we<7;we++){const Ze=new Date(ce),Ie=Ze.getMonth()===i.getMonth(),se=dT(Ze,Hu()),Ne=dT(Ze,r);De.push({date:Ze,isCurrentMonth:Ie,isToday:se,isSelected:Ne}),ce.setDate(ce.getDate()+1)}xe.push(De)}return xe},[i,r]),$=()=>{const B=new Date(i);B.setMonth(B.getMonth()-1),o(B)},E=()=>{const B=new Date(i);B.setMonth(B.getMonth()+1),o(B)},v=B=>{s(Ps(B)),o(Ps(B)),n("day")},y=P.useMemo(()=>i.toLocaleDateString(Sn,{month:"long",year:"numeric"}),[i]),N=P.useMemo(()=>{if(e==="day")return r.toLocaleDateString(Sn,{weekday:"long",day:"2-digit",month:"long",year:"numeric"});if(e==="week"){const B=uT(r),re=Dr(B,6);return B.toLocaleDateString(Sn,{day:"2-digit",month:"short"})+" - "+re.toLocaleDateString(Sn,{day:"2-digit",month:"short",year:"numeric"})}return"ltimas citas (detalle)"},[e,r]),D=()=>{s(e==="day"?Dr(r,-1):e==="week"?Dr(r,-7):Dr(r,-1))},j=()=>{s(e==="day"?Dr(r,1):e==="week"?Dr(r,7):Dr(r,1))},k=()=>{const B=Hu();s(B),o(B),n("day")},G=()=>{var et,Tt,H;const B=ee=>String(ee??"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),re=((et=document.querySelector('meta[name="company-name"]'))==null?void 0:et.getAttribute("content"))||Mp,ce=((Tt=document.querySelector('meta[name="company-logo"]'))==null?void 0:Tt.getAttribute("content"))||"",xe="Generado por OdontoCloud",Se=b.length===0?'<tr><td colspan="6" style="padding:8px 6px;color:#6b7280">No hay citas registradas para este rango.</td></tr>':b.map(ee=>{const te=ee.fecha.toLocaleDateString(Sn),q=ee.fecha.toLocaleTimeString(Sn,{hour:"2-digit",minute:"2-digit",hour12:!0});return`<tr>
              <td>${B(te)}</td>
              <td>${B(q)}</td>
              <td>${B(ee.paciente)}</td>
              <td>${B(ee.doctor)}</td>
              <td>${B(ee.espacio)}</td>
              <td>${B(ee.comentario)}</td>
            </tr>`}).join(""),we=`<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>Imprimir  ${B(re)}</title>
  <style>
    @page { size: A4 portrait; margin: 18mm; }
    body { font-family: Segoe UI, Roboto, Arial, sans-serif; color:#0f172a; }
    .hdr { display:flex; align-items:center; gap:12px; border-bottom:2px solid #e5e7eb; padding-bottom:8px; margin-bottom:12px; }
    .brand { font-size:18px; font-weight:700; color:#0a86d8; line-height:1.1; }
    .sub { font-size:12px; color:#6b7280; }
    table { width:100%; border-collapse:collapse; font-size:12px; }
    th { text-align:left; background:#f3f4f6; border-bottom:1px solid #e5e7eb; padding:8px 6px; }
    td { border-bottom:1px solid #f1f5f9; padding:7px 6px; vertical-align:top; }
    .note { margin-top:8px; font-size:10px; color:#9ca3af; }
    tr, .hdr { page-break-inside: avoid; }
  </style>
</head>
<body>
  <div class="hdr">
    ${ce?`<img src="${ce}" alt="Logo" style="height:36px;object-fit:contain">`:""}
    <div>
      <div class="brand">${B(re)}</div>
      <div class="sub">Agenda de citas  ${B(N)}</div>
    </div>
  </div>

  <table>
    <thead>
      <tr>
        <th style="width:18%">Fecha</th>
        <th style="width:10%">Hora</th>
        <th style="width:22%">Paciente</th>
        <th style="width:20%">Doctor</th>
        <th style="width:15%">Espacio</th>
        <th>Comentario</th>
      </tr>
    </thead>
    <tbody>${Se}</tbody>
  </table>

  <div class="note">${B(xe)}. ${B(new Date().toLocaleString(Sn))}</div>
  <script>
    // Imprimir cuando termine de cargar la pestaa (incluye el logo)
    window.addEventListener('load', function() {
      try { window.focus(); window.print(); } catch (e) {}
    });
  <\/script>
</body>
</html>`,Ze=new Blob([we],{type:"text/html;charset=utf-8"}),Ie=URL.createObjectURL(Ze),se=window.open(Ie,"_blank","noopener,noreferrer,width=900,height=700");if(!se){alert("El navegador bloque la ventana de impresin. Permite pop-ups para este sitio."),URL.revokeObjectURL(Ie);return}const Ne=()=>{try{URL.revokeObjectURL(Ie)}catch{}};(H=se.addEventListener)==null||H.call(se,"load",Ne),setTimeout(Ne,15e3)},We=()=>alert("Funcin de confirmar citas se integrar con n8n / correo."),Mt=()=>k(),un=()=>{if(b.length===0){alert("No hay citas para exportar.");return}const B=[`Empresa: ${Mp}`],re=["Fecha","Hora","Paciente","Doctor","Espacio","Comentario"],ce=b.map(se=>{const Ne=se.fecha.toLocaleDateString(Sn),et=se.fecha.toLocaleTimeString(Sn,{hour:"2-digit",minute:"2-digit",hour12:!0});return[Ne,et,se.paciente||"",se.doctor||"",se.espacio||"",(se.comentario||"").replace(/\r?\n/g," ")]}),xe=[CU],Se=[B,[],re,...ce,[],xe].map(se=>(se||[]).map(Ne=>`"${String(Ne??"").replace(/"/g,'""')}"`).join(",")).join(`
`),De=`citas_${Mp.toLowerCase().replace(/\s+/g,"_")}_${Up(Ps(r))}`+(e==="week"?"_semana":e==="detail"?"_detalle":"")+".csv",we=new Blob(["\uFEFF"+Se],{type:"text/csv;charset=utf-8;"}),Ze=URL.createObjectURL(we),Ie=document.createElement("a");Ie.href=Ze,Ie.download=De,Ie.click(),URL.revokeObjectURL(Ze)},Z=async(B,re)=>{try{const ce=Gt(_e,"citas",B);await ga(ce,{estado:re})}catch(ce){console.error("Error actualizando estado:",ce),alert("No se pudo actualizar el estado de la cita.")}},de=(B,re)=>{if(!B){alert("Este paciente no tiene celular registrado.");return}const ce=String(B).replace(/\D/g,""),xe=re.fecha.toLocaleDateString(Sn),Se=re.fecha.toLocaleTimeString(Sn,{hour:"numeric",minute:"2-digit",hour12:!0}),De=encodeURIComponent(`Hola ${re.paciente}, le recordamos su cita odontolgica el ${xe} a las ${Se}. Por favor confirme su asistencia.`),we=`https://wa.me/${ce}?text=${De}`;window.open(we,"_blank")},pe=async B=>{if(window.confirm(`Seguro que deseas eliminar la cita de ${B.paciente} del ${B.fecha.toLocaleDateString(Sn)}?`))try{const ce=Gt(_e,"citas",B.id);await lA(ce)}catch(ce){console.error("Error eliminando cita:",ce),alert(" No se pudo eliminar la cita.")}},Pe=()=>{const B=document.createElement("div");Object.assign(B.style,{position:"fixed",top:"0",left:"0",width:"100%",height:"100%",background:"rgba(0,0,0,0.55)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:"9999"});const re=document.createElement("div");Object.assign(re.style,{background:"#fff",padding:"25px 30px",borderRadius:"14px",width:"520px",maxWidth:"95%",maxHeight:"95%",overflowY:"auto",boxShadow:"0 8px 30px rgba(0,0,0,0.3)",fontFamily:"Segoe UI, Roboto, sans-serif"}),re.innerHTML=`
      <h2 style="margin-top:0;text-align:center;color:#0a86d8;font-weight:600;"> Nueva Cita</h2>
      <form id="formNuevaCita" style="display:flex;flex-direction:column;gap:12px;margin-top:10px;">
        <label style="font-weight:600;">Paciente existente</label>
        <div style="position:relative;">
          <input type="text" id="buscarPaciente" placeholder="Buscar por nombre, apellido o documento..." autocomplete="off"/>
          <div id="acResultados" style="position:absolute;left:0;right:0;top:calc(100% + 6px);z-index:10000;display:none;background:#fff;border:1px solid #ddd;border-radius:8px;box-shadow:0 8px 22px rgba(0,0,0,.12);max-height:240px;overflow:auto;"></div>
        </div>
        <small style="color:gray;">Si el paciente no existe, marca Registrar nuevo paciente.</small>

        <label style="display:flex;align-items:center;gap:8px;margin-top:5px;">
          <input type="checkbox" id="esNuevoPaciente" />
          <span>Registrar nuevo paciente</span>
        </label>

        <div id="nuevoPacienteCampos" style="display:none;flex-direction:column;gap:8px;margin-top:10px;padding:10px;border-radius:8px;background:#f9f9f9;border:1px solid #ddd;">
          <h4 style="margin:0;text-align:center;color:#0a86d8;">Datos del paciente</h4>
          <div style="display:flex;gap:8px;">
            <input type="text" id="npNombre" placeholder="Nombre" style="flex:1;" />
            <input type="text" id="npApellido" placeholder="Apellido" style="flex:1;" />
          </div>
          <select id="npTipoDocumento">
            <option value="">Tipo de documento</option>
            <option value="CC">Cdula de Ciudadana</option>
            <option value="CE">Cdula de Extranjera</option>
            <option value="TI">Tarjeta de Identidad</option>
            <option value="PA">Pasaporte</option>
            <option value="DI">Documento Internacional</option>
            <option value="OTRO">Otro</option>
          </select>
          <input type="text" id="npDocumento" placeholder="Nmero de documento" />
          <input type="email" id="npCorreo" placeholder="Correo electrnico" />
          <div style="display:flex;gap:5px;">
            <select id="npIndicativo" style="width:40%;">
              <option value="+57"> +57</option>
              <option value="+1"> +1</option>
              <option value="+34"> +34</option>
              <option value="+52"> +52</option>
              <option value="+54"> +54</option>
              <option value="+593"> +593</option>
              <option value="+56"> +56</option>
              <option value="+58"> +58</option>
            </select>
            <input type="tel" id="npCelular" placeholder="Celular (obligatorio)" style="flex:1;" />
          </div>
          <input type="tel" id="npTelefono" placeholder="Telfono fijo (opcional)" />
          <label style="font-weight:500;">Fecha de nacimiento:</label>
          <input type="date" id="npNacimiento" />
          <select id="npSexo">
            <option value="">Sexo</option>
            <option value="Masculino">Masculino</option>
            <option value="Femenino">Femenino</option>
            <option value="Otro">Otro</option>
          </select>
          <textarea id="npComentario" placeholder="Comentario o antecedentes del paciente" rows="2"></textarea>
        </div>

        <hr style="margin:10px 0;border:none;border-top:1px solid #ddd;" />
        <h4 style="margin:0;text-align:center;color:#0a86d8;">Detalles de la cita</h4>
        <input type="text" id="ncDoctor" placeholder="Doctor asignado" required />
        <input type="date" id="ncFecha" required value="${Up(r)}" />
        <input type="time" id="ncHora" required />
        <input type="text" id="ncEspacio" placeholder="Espacio fsico / Sala" />
        <textarea id="ncComentario" placeholder="Comentario sobre la cita" rows="3"></textarea>

        <div style="display:flex;justify-content:flex-end;gap:10px;margin-top:10px;">
          <button type="button" id="btnCancelarModal" class="btn-cancelar">Cancelar</button>
          <button type="submit" class="btn-guardar">Guardar</button>
        </div>
      </form>
    `;const ce=document.createElement("style");ce.textContent=`
      .btn-cancelar, .btn-guardar { padding: 8px 14px; border: none; border-radius: 6px; cursor: pointer; font-weight: 600; font-size: 14px; transition: .2s; }
      .btn-cancelar { background: #e0e0e0; color: #333; } .btn-cancelar:hover { background: #d5d5d5; }
      .btn-guardar { background: #0a86d8; color: white; } .btn-guardar:hover { background: #0669ac; }
      input, select, textarea { width: 100%; padding: 8px 10px; border: 1px solid #ccc; border-radius: 6px; font-size: 14px; outline: none; }
      input:focus, select:focus, textarea:focus { border-color: #0a86d8; box-shadow: 0 0 0 2px rgba(10,134,216,.2); }
      .ac-item { padding: 8px 10px; display:flex; gap:8px; align-items:baseline; cursor:pointer; }
      .ac-item:hover, .ac-item.active { background:#f5f7fb; }
      .ac-name { font-weight:600; } .ac-doc { color:#64748b; font-size:12px; } .ac-tel { margin-left:auto; font-size:12px; color:#0f172a; }
      .ac-empty { padding:10px; color:#9aa4b2; font-size:13px; }
    `,document.head.appendChild(ce),B.appendChild(re),document.body.appendChild(B);const xe=re.querySelector("#esNuevoPaciente"),Se=re.querySelector("#nuevoPacienteCampos"),De=re.querySelector("#buscarPaciente"),we=re.querySelector("#acResultados");xe.addEventListener("change",()=>{Se.style.display=xe.checked?"flex":"none",xe.checked&&(we.style.display="none")}),re.querySelector("#btnCancelarModal").addEventListener("click",()=>B.remove());let Ze=null,Ie=null,se=-1,Ne=[];const et=ae=>{if(Ne=ae||[],se=-1,!ae||ae.length===0){we.innerHTML='<div class="ac-empty">Sin resultados</div>',we.style.display="block";return}we.innerHTML=ae.map((me,ge)=>`
            <div class="ac-item" data-index="${ge}" data-id="${me.id}">
              <span class="ac-name">${me.nombre}</span>
              <span class="ac-doc"> ${me.documento||"s/doc"}</span>
              <span class="ac-tel">${me.celular||me.telefono||""}</span>
            </div>`).join(""),we.style.display="block",[...we.querySelectorAll(".ac-item")].forEach(me=>{me.addEventListener("click",()=>{const ge=Number(me.getAttribute("data-index"));Tt(ge)})})},Tt=ae=>{const me=Ne[ae];me&&(Ie=me,De.value=me.nombre,we.style.display="none",xe.checked=!1,Se.style.display="none")},H=ae=>{Ne.length&&(se=(se+ae+Ne.length)%Ne.length,[...we.querySelectorAll(".ac-item")].forEach((me,ge)=>{ge===se?me.classList.add("active"):me.classList.remove("active")}))},ee=(ae,me)=>ae.nombreCompleto||ae.paciente||[ae.nombres,ae.apellidos].filter(Boolean).join(" ")||me,te=async ae=>{const me=(ae||"").toString().trim(),ge=Do(me);if(!ge||ge.length<2)return[];if(/^\d{5,}$/.test(me))try{const Fe=st($e(_e,"pacientes"),Qe("documento","==",me)),Ae=st($e(_e,"pacientes"),Qe("nroDocumento","==",me)),[ze,je]=await Promise.all([pn(Fe),pn(Ae)]),be=ze.empty?je:ze;if(!be.empty)return be.docs.slice(0,10).map(M=>{const Y=M.data()||{};return{id:M.id,nombre:ee(Y,M.id),documento:Y.documento||Y.nroDocumento||M.id,celular:Y.celularPaciente||Y.celular||"",telefono:Y.telefonoPaciente||Y.telefono||""}})}catch{}try{const Fe=st($e(_e,"pacientes"),gn("nombre_busqueda"),FI(ge),UI(ge+""),ma(10)),Ae=await pn(Fe);if(!Ae.empty)return Ae.docs.map(ze=>{const je=ze.data()||{};return{id:ze.id,nombre:ee(je,ze.id),documento:je.documento||je.nroDocumento||ze.id,celular:je.celularPaciente||je.celular||"",telefono:je.telefonoPaciente||je.telefono||""}})}catch{}try{const Fe=st($e(_e,"pacientes"),gn("creado","desc"),ma(50));return(await pn(Fe)).docs.map(be=>({id:be.id,...be.data()||{}})).map(be=>({id:be.id,nombre:ee(be,be.id),documento:be.documento||be.nroDocumento||be.id,celular:be.celularPaciente||be.celular||"",telefono:be.telefonoPaciente||be.telefono||"",_norm:Do(`${be.nombreCompleto||be.paciente||""} ${be.nombres||""} ${be.apellidos||""} ${be.documento||be.nroDocumento||""}`)})).filter(be=>be._norm.includes(ge)).slice(0,10).map(({_norm:be,...M})=>M)}catch{}return[]};De.addEventListener("input",()=>{Ie=null;const ae=De.value;if(clearTimeout(Ze),!ae||ae.trim().length<2){we.style.display="none";return}Ze=setTimeout(async()=>{const me=await te(ae.trim());et(me)},220)}),De.addEventListener("keydown",ae=>{we.style.display==="block"&&(ae.key==="ArrowDown"?(ae.preventDefault(),H(1)):ae.key==="ArrowUp"?(ae.preventDefault(),H(-1)):ae.key==="Enter"?se>=0&&(ae.preventDefault(),Tt(se)):ae.key==="Escape"&&(we.style.display="none"))}),document.addEventListener("click",ae=>{re.contains(ae.target)&&!we.contains(ae.target)&&ae.target!==De&&(we.style.display="none")},{capture:!0});const q=re.querySelector("#formNuevaCita");q.addEventListener("submit",async ae=>{ae.preventDefault();const me=xe.checked,ge=(q.querySelector("#buscarPaciente").value||"").trim(),Fe=q.querySelector("#ncDoctor").value.trim(),Ae=q.querySelector("#ncFecha").value,ze=q.querySelector("#ncHora").value,je=q.querySelector("#ncEspacio").value.trim(),be=q.querySelector("#ncComentario").value.trim();if(!Ae||!ze){alert(" Debes seleccionar fecha y hora para la cita.");return}if(!Fe){alert(" Indica el doctor asignado.");return}try{let M=null,Y=null,ie="",ye="",tt="";if(me){const Dn=(q.querySelector("#npNombre").value||"").trim(),Jt=(q.querySelector("#npApellido").value||"").trim();if(ie=`${Dn} ${Jt}`.trim(),!ie){alert(" Debes indicar nombre y apellido para el nuevo paciente.");return}const Nt=(q.querySelector("#npDocumento").value||"").trim(),Ft=(q.querySelector("#npCelular").value||"").trim(),jn=(q.querySelector("#npTelefono").value||"").trim();if(!Ft&&!jn){alert(" Debes registrar al menos un telfono (celular o fijo) del paciente o de un acudiente.");return}if(M=Nt||ie.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/\s+/g,"_"),Y=Gt(_e,"pacientes",M),!(await Ih(Y)).exists()){const kt=Do(ie);await Th(Y,{nombres:Dn,apellidos:Jt,nombreCompleto:ie,paciente:ie,nombre_busqueda:kt,variantes_busqueda:[kt,Do(Dn),Do(Jt)],tipoDocumento:q.querySelector("#npTipoDocumento").value,documento:Nt,correo:(q.querySelector("#npCorreo").value||"").trim(),indicativo:q.querySelector("#npIndicativo").value,celular:Ft,telefono:jn,celularPaciente:Ft,telefonoPaciente:jn,fechaNacimiento:q.querySelector("#npNacimiento").value,sexo:q.querySelector("#npSexo").value,notas:(q.querySelector("#npComentario").value||"").trim(),creado:new Date().toISOString(),activo:!0,citas:[]},{merge:!0})}ye=Ft,tt=jn}else if(Ie)M=Ie.id,ie=Ie.nombre,Y=Gt(_e,"pacientes",M),ye=Ie.celular||"",tt=Ie.telefono||"";else{if(!ge){alert(" Por favor, escribe o selecciona un paciente.");return}const Dn=st($e(_e,"pacientes"),Qe("documento","==",ge)),Jt=st($e(_e,"pacientes"),Qe("nroDocumento","==",ge)),[Nt,Ft]=await Promise.all([pn(Dn),pn(Jt)]),jn=Nt.empty?Ft:Nt;if(jn.empty){let Ve=null;try{const kt=Do(ge),Cr=st($e(_e,"pacientes"),gn("nombre_busqueda"),FI(kt),UI(kt+""),ma(1)),ur=await pn(Cr);if(!ur.empty){const ys=ur.docs[0],On=ys.data()||{};Ve={id:ys.id,ref:ys.ref,nombre:On.nombreCompleto||On.paciente||[On.nombres,On.apellidos].filter(Boolean).join(" "),cel:On.celularPaciente||On.celular||"",tel:On.telefonoPaciente||On.telefono||""}}}catch{}Ve?(M=Ve.id,Y=Ve.ref,ie=Ve.nombre||ge,ye=Ve.cel||"",tt=Ve.tel||""):ie=ge}else{const Ve=jn.docs[0],kt=Ve.data()||{};M=Ve.id,Y=Ve.ref,ie=kt.nombreCompleto||kt.paciente||[kt.nombres,kt.apellidos].filter(Boolean).join(" ")||ge,ye=kt.celularPaciente||kt.celular||"",tt=kt.telefonoPaciente||kt.telefono||""}}if(!(ye||tt||"").trim()){alert(" Este paciente no tiene ningn telfono registrado. Edita sus datos y agrega un nmero antes de guardar la cita.");return}const Tn={paciente:ie||"Paciente",pacienteId:M||null,doctor:Fe,fecha:Ae,horaInicio:ze,espacio:je,comentario:be,estado:"En espera",creado:new Date().toISOString(),celularPaciente:ye||"",telefonoPaciente:tt||""},xn=await ra($e(_e,"citas"),Tn);Y&&await Th(Y,{citas:MM(xn.id)},{merge:!0}),alert(" Cita registrada correctamente y vinculada al paciente."),B.remove()}catch(M){console.error(" Error al guardar cita:",M),alert(" Error al guardar la cita. Revisa la consola para ms detalles.")}})},Ge=B=>{var Ze,Ie;const re=document.createElement("div");Object.assign(re.style,{position:"fixed",top:"0",left:"0",width:"100%",height:"100%",background:"rgba(0,0,0,0.55)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:"9999"});const ce=document.createElement("div");Object.assign(ce.style,{background:"#fff",padding:"25px 30px",borderRadius:"14px",width:"520px",maxWidth:"95%",maxHeight:"95%",overflowY:"auto",boxShadow:"0 8px 30px rgba(0,0,0,0.3)",fontFamily:"Segoe UI, Roboto, sans-serif"});const xe=(Ze=B.raw)!=null&&Ze.fecha&&typeof B.raw.fecha=="string"?B.raw.fecha:Up(B.fecha),Se=((Ie=B.raw)==null?void 0:Ie.horaInicio)||B.fecha.toTimeString().slice(0,5);ce.innerHTML=`
      <h2 style="margin-top:0;text-align:center;color:#0a86d8;font-weight:600;"> Editar Cita</h2>
      <form id="formEditarCita" style="display:flex;flex-direction:column;gap:12px;margin-top:10px;">
        <label>Paciente</label>
        <input type="text" id="editPaciente" value="${B.paciente||""}" />

        <label>Doctor asignado</label>
        <input type="text" id="editDoctor" value="${B.doctor||""}" />

        <div style="display:flex;gap:8px;">
          <div style="flex:1;">
            <label>Fecha</label>
            <input type="date" id="editFecha" value="${xe}" />
          </div>
          <div style="flex:1;">
            <label>Hora</label>
            <input type="time" id="editHora" value="${Se}" />
          </div>
        </div>

        <label>Espacio fsico / Sala</label>
        <input type="text" id="editEspacio" value="${B.espacio||""}" />

        <label>Estado</label>
        <select id="editEstado" className="estado-select">
          <option value="En espera" ${B.estado==="En espera"?"selected":""}>En espera</option>
          <option value="En sala" ${B.estado==="En sala"?"selected":""}>En sala</option>
          <option value="Atendiendo" ${B.estado==="Atendiendo"?"selected":""}>Atendiendo</option>
          <option value="Finalizada" ${B.estado==="Finalizada"?"selected":""}>Finalizada</option>
          <option value="pendiente" ${B.estado==="pendiente"?"selected":""}>Pendiente</option>
          <option value="No asisti" ${B.estado==="No asisti"?"selected":""}>No asisti</option>
        </select>

        <label>Comentario</label>
        <textarea id="editComentario" rows="3">${B.comentario||""}</textarea>

        <div style="display:flex;justify-content:flex-end;gap:10px;margin-top:10px;">
          <button type="button" id="btnCancelarEdit" class="btn-cancelar">Cancelar</button>
          <button type="submit" class="btn-guardar">Guardar cambios</button>
        </div>
      </form>
    `;const De=document.createElement("style");De.textContent=`
      .btn-cancelar, .btn-guardar { padding: 8px 14px; border: none; border-radius: 6px; cursor: pointer; font-weight: 600; font-size: 14px; transition: .2s; }
      .btn-cancelar { background: #e0e0e0; color: #333; } .btn-cancelar:hover { background: #d5d5d5; }
      .btn-guardar { background: #0a86d8; color: white; } .btn-guardar:hover { background: #0669ac; }
      #formEditarCita input, #formEditarCita select, #formEditarCita textarea { width: 100%; padding: 8px 10px; border: 1px solid #ccc; border-radius: 6px; font-size: 14px; outline: none; }
      #formEditarCita input:focus, #formEditarCita select:focus, #formEditarCita textarea:focus { border-color: #0a86d8; box-shadow: 0 0 0 2px rgba(10,134,216,.2); }
    `,document.head.appendChild(De),re.appendChild(ce),document.body.appendChild(re),ce.querySelector("#btnCancelarEdit").addEventListener("click",()=>re.remove());const we=ce.querySelector("#formEditarCita");we.addEventListener("submit",async se=>{se.preventDefault();const Ne=we.querySelector("#editPaciente").value.trim(),et=we.querySelector("#editDoctor").value.trim(),Tt=we.querySelector("#editFecha").value,H=we.querySelector("#editHora").value,ee=we.querySelector("#editEspacio").value.trim(),te=we.querySelector("#editEstado").value,q=we.querySelector("#editComentario").value.trim();if(!Ne)return alert(" El nombre del paciente es obligatorio.");if(!Tt||!H)return alert(" Debes indicar fecha y hora.");try{const ae=Gt(_e,"citas",B.id);await ga(ae,{paciente:Ne,doctor:et,fecha:Tt,horaInicio:H,espacio:ee,estado:te,comentario:q}),alert(" Cita actualizada correctamente."),re.remove()}catch(ae){console.error(" Error al actualizar cita:",ae),alert(" Error al actualizar la cita. Revisa la consola para ms detalles.")}})},Pt=B=>{const re=B.fecha.toLocaleDateString(Sn),ce=B.fecha.toLocaleTimeString(Sn,{hour:"numeric",minute:"2-digit",hour12:!0}),xe=`${re}  ${ce}`;return u.jsxs("tr",{className:"fade-in-row",onClick:()=>Ge(B),style:{cursor:"pointer"},children:[u.jsx("td",{children:xe}),u.jsx("td",{children:B.paciente}),u.jsx("td",{children:B.doctor}),u.jsx("td",{children:B.espacio}),u.jsx("td",{children:B.comentario}),u.jsx("td",{onClick:Se=>{Se.stopPropagation()},children:u.jsxs("select",{className:"estado-select",value:B.estado,onChange:Se=>Z(B.id,Se.target.value),children:[u.jsx("option",{value:"En espera",children:"En espera"}),u.jsx("option",{value:"En sala",children:"En sala"}),u.jsx("option",{value:"Atendiendo",children:"Atendiendo"}),u.jsx("option",{value:"Finalizada",children:"Finalizada"}),u.jsx("option",{value:"pendiente",children:"Pendiente"}),u.jsx("option",{value:"No asisti",children:"No asisti"})]})}),u.jsxs("td",{className:"acciones-cell",onClick:Se=>{Se.stopPropagation()},children:[B.telefono?u.jsx("button",{type:"button",className:"btn-whatsapp",onClick:Se=>{Se.stopPropagation(),de(B.telefono,B)},children:"WhatsApp"}):u.jsx("span",{className:"acciones-texto",children:"Sin celular"}),u.jsx("button",{type:"button",className:"btn-delete",onClick:Se=>{Se.stopPropagation(),pe(B)},children:"Eliminar"}),B.recordatorio&&u.jsx("span",{className:"acciones-texto",children:B.recordatorio})]})]},B.id)};return u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"odc-topbar-green"}),u.jsx("div",{className:"odc-topbar-blue",children:"Agenda"}),u.jsx("section",{className:"odc-agenda-root",children:u.jsxs("div",{className:"odc-agenda-inner",children:[u.jsxs("aside",{className:"odc-left","aria-label":"Panel izquierdo - calendario y filtros",children:[u.jsxs("div",{className:"odc-mini-calendar-card",role:"region","aria-label":"Mini calendario",children:[u.jsxs("div",{className:"mini-cal-header",children:[u.jsx("button",{className:"cal-arrow",id:"miniCalPrev","aria-label":"Mes anterior",onClick:$,children:""}),u.jsx("div",{id:"miniCalMonthYear","aria-live":"polite",children:y}),u.jsx("button",{className:"cal-arrow",id:"miniCalNext","aria-label":"Mes siguiente",onClick:E,children:""})]}),u.jsxs("table",{className:"mini-month-table","aria-hidden":"false",children:[u.jsx("thead",{children:u.jsxs("tr",{children:[u.jsx("th",{children:"Lu"}),u.jsx("th",{children:"Ma"}),u.jsx("th",{children:"Mi"}),u.jsx("th",{children:"Ju"}),u.jsx("th",{children:"Vi"}),u.jsx("th",{children:"Sa"}),u.jsx("th",{children:"Do"})]})}),u.jsx("tbody",{id:"miniCalendar",children:L.map((B,re)=>u.jsx("tr",{children:B.map((ce,xe)=>u.jsx("td",{className:[ce.isCurrentMonth?"":"empty",ce.isToday?"today":"",ce.isSelected?"selected":""].filter(Boolean).join(" "),onClick:()=>ce.isCurrentMonth&&v(ce.date),children:ce.date.getDate()},xe))},re))})]})]}),u.jsxs("div",{className:"odc-filters-card","aria-label":"Filtros de agenda",children:[u.jsx("label",{htmlFor:"filterSucursal",children:"Sucursal"}),u.jsxs("select",{id:"filterSucursal",value:f,onChange:B=>m(B.target.value),children:[u.jsx("option",{value:"",children:" Todas "}),w.map(B=>u.jsx("option",{value:B,children:B},B))]}),u.jsx("label",{htmlFor:"filterDoctor",children:"Doctores"}),u.jsxs("select",{id:"filterDoctor",value:_,onChange:B=>A(B.target.value),children:[u.jsx("option",{value:"",children:" Todos "}),I.map(B=>u.jsx("option",{value:B,children:B},B))]})]})]}),u.jsxs("main",{className:"odc-right","aria-label":"Panel principal - agenda",children:[u.jsxs("div",{className:"odc-header-bar",role:"region","aria-label":"Controles de la agenda",style:{display:"flex",alignItems:"center",justifyContent:"space-between",gap:12},children:[u.jsxs("div",{className:"odc-header-left",style:{display:"flex",alignItems:"center",gap:12,flexWrap:"wrap"},children:[u.jsx("h3",{className:"odc-title",style:{marginRight:8},children:"Agenda"}),u.jsxs("div",{className:"view-buttons",role:"tablist","aria-label":"Vistas",style:{display:"flex",gap:6},children:[u.jsx("button",{className:`btn view ${e==="day"?"active":""}`,"data-view":"day",role:"tab","aria-selected":e==="day",onClick:()=>n("day"),children:"Da"}),u.jsx("button",{className:`btn view ${e==="week"?"active":""}`,"data-view":"week",role:"tab","aria-selected":e==="week",onClick:()=>n("week"),children:"Semana"}),u.jsx("button",{className:`btn view ${e==="detail"?"active":""}`,"data-view":"detail",role:"tab","aria-selected":e==="detail",onClick:()=>n("detail"),children:"Detalle"})]}),u.jsxs("div",{className:"date-nav",style:{display:"flex",alignItems:"center",gap:6,flex:"0 0 auto"},children:[u.jsx("button",{className:"btn icon",id:"btnPrev","aria-label":"Anterior",onClick:D,children:""}),u.jsx("button",{className:"btn icon",id:"btnNext","aria-label":"Siguiente",onClick:j,children:""}),u.jsx("span",{id:"currentDateDisplay",className:"current-date","aria-live":"polite",style:{whiteSpace:"nowrap"},children:N}),u.jsx("button",{id:"btnHoy",className:"btn small",onClick:k,children:"Hoy"})]})]}),u.jsx("div",{className:"odc-header-right",style:{display:"flex",alignItems:"center",gap:8,flexShrink:0},children:u.jsxs("div",{className:"right-actions",style:{display:"flex",alignItems:"center",gap:8},children:[u.jsx("input",{id:"searchCitas",placeholder:"Buscar...",className:"search-input","aria-label":"Buscar citas",value:R,onChange:B=>C(B.target.value)}),u.jsx("button",{id:"btnNuevaCita",className:"btn green","aria-label":"Nueva cita",onClick:Pe,children:"+ Nueva cita"})]})})]}),u.jsxs("div",{className:"odc-content-card",role:"region","aria-label":"Contenido agenda",children:[u.jsxs("div",{className:"tools-row",children:[u.jsx("div",{className:"tools-left",children:u.jsx("div",{id:"ocupacionInfo",className:"ocupacion-info",children:x})}),u.jsxs("div",{className:"tools-right",children:[u.jsx("button",{id:"btnPrint",className:"btn",title:"Imprimir agenda",onClick:G,children:" Imprimir"}),u.jsx("button",{id:"btnConfirmar",className:"btn blue",title:"Confirmar citas",onClick:We,children:" Confirmar"}),u.jsx("button",{id:"btnHoyCitas",className:"btn",title:"Ver citas de hoy",onClick:Mt,children:" Hoy"}),u.jsx("button",{id:"btnExportar",className:"btn",title:"Exportar citas a CSV",onClick:un,children:" Exportar"})]})]}),u.jsx("div",{className:"table-wrap",role:"region","aria-label":"Lista de citas",children:u.jsxs("table",{className:"appointments-table","aria-live":"polite",children:[u.jsx("thead",{children:u.jsxs("tr",{children:[u.jsx("th",{style:{width:"180px"},children:"Fecha / Hora"}),u.jsx("th",{children:"Paciente"}),u.jsx("th",{children:"Doctor"}),u.jsx("th",{children:"Espacio fsico"}),u.jsx("th",{children:"Comentario"}),u.jsx("th",{style:{width:"120px"},children:"Estado"}),u.jsx("th",{children:"Acciones"})]})}),u.jsx("tbody",{id:"citasTbody",children:a?u.jsx("tr",{children:u.jsx("td",{colSpan:7,className:"no-data",children:"Cargando citas..."})}):b.length===0?u.jsx("tr",{children:u.jsx("td",{colSpan:7,className:"no-data",children:"No hay citas registradas para este rango."})}):b.map(Pt)})]})})]})]})]})})]})}function PU(){return u.jsxs("div",{style:{padding:"20px"},children:[u.jsx("h2",{children:"Mdulo de Facturacin"}),u.jsx("p",{children:"Aqu se registrarn los pagos, facturas y cobros."})]})}function NU(){return u.jsxs("div",{style:{padding:"20px"},children:[u.jsx("h2",{children:"Mdulo de Facturacin"}),u.jsx("p",{children:"Aqu se registrarn los pagos, facturas y cobros."})]})}function kU(){return u.jsxs("div",{style:{padding:"20px"},children:[u.jsx("h2",{children:"Mdulo de Facturacin"}),u.jsx("p",{children:"Aqu se registrarn los pagos, facturas y cobros."})]})}const Wu={caja:"caja",pagos:"facturacion/pagos",facturas:"facturacion/facturas"};var vT;const Ku=typeof navigator<"u"&&((vT=navigator.language)!=null&&vT.startsWith("es"))?"es-ES":"en-US",DU=["Colombia","Argentina","Bolivia","Chile","Costa Rica","Cuba","Ecuador","El Salvador","Espaa","Guatemala","Honduras","Mxico","Nicaragua","Panam","Paraguay","Per","Puerto Rico","Repblica Dominicana","Uruguay","Venezuela","Estados Unidos","Canad"],hT={Colombia:["Bogot","Medelln","Cali","Barranquilla","Cartagena","Ccuta","Bucaramanga","Pereira","Santa Marta","Ibagu"],Mxico:["Ciudad de Mxico","Guadalajara","Monterrey","Puebla","Quertaro","Tijuana","Mrida","Len"],Per:["Lima","Arequipa","Trujillo","Chiclayo","Cusco","Piura"],Chile:["Santiago","Valparaso","Concepcin","La Serena","Antofagasta"],Argentina:["Buenos Aires","Crdoba","Rosario","Mendoza","La Plata"],Espaa:["Madrid","Barcelona","Valencia","Sevilla","Zaragoza","Bilbao"],"Estados Unidos":["Miami","New York","Los ngeles","Houston","Chicago"],Ecuador:["Quito","Guayaquil","Cuenca","Manta"],Venezuela:["Caracas","Maracaibo","Valencia","Barquisimeto","Maracay"]},jU=t=>{if(!t)return"";const[e,n,r]=t.split("-").map(l=>parseInt(l,10)),s=new Date(e,(n||1)-1,r||1),i=new Date;let o=i.getFullYear()-s.getFullYear();const a=i.getMonth()-s.getMonth();return(a<0||a===0&&i.getDate()<s.getDate())&&o--,isNaN(o)?"":String(o)};async function fT(t,{maxW:e=900,maxH:n=900,quality:r=.82}={}){var m;if(!t||!((m=t.type)!=null&&m.startsWith("image/")))return t;const s=await new Promise((_,A)=>{const R=new Image;R.onload=()=>_(R),R.onerror=A,R.src=URL.createObjectURL(t)});let{width:i,height:o}=s;const a=Math.min(e/i,n/o,1);i=Math.round(i*a),o=Math.round(o*a);const l=document.createElement("canvas");l.width=i,l.height=o,l.getContext("2d").drawImage(s,0,0,i,o);const h=await new Promise(_=>l.toBlob(_,"image/jpeg",r)),f=new File([h],(t.name||"foto.jpg").replace(/\.[^.]+$/,".jpg"),{type:"image/jpeg",lastModified:Date.now()});return URL.revokeObjectURL(s.src),f}const Ml=t=>(t||"").toString().toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/\s+/g," ").trim(),OU=t=>Ml([t.nombres,t.apellidos,t.nombreCompleto,t.nroDocumento,t.celular,t.email].filter(Boolean).join(" ")),jo={tipoDocumento:"",nroDocumento:"",nroHistoria:"",nombres:"",apellidos:"",nombreCompleto:"",sexo:"",estadoCivil:"",paisNacimiento:"",ciudadNacimiento:"",fechaIngreso:"",fechaNacimiento:"",edad:"",paisDomicilio:"",ciudadDomicilio:"",barrio:"",lugarResidencia:"",estrato:"",zonaResidencial:"",esExtranjero:!1,permitePublicidad:!1,celular:"",telDomicilio:"",telOficina:"",extension:"",email:"",ocupacion:"",nombreResponsable:"",parentesco:"",celularResponsable:"",telefonoResponsable:"",emailResponsable:"",nombreAcompanante:"",telefonoAcompanante:"",convenioBeneficio:"",comoConocio:"",campania:"",remitidoPor:"",asesorComercial:"",tipoVinculacion:"",nombreEps:"",polizaSalud:"",doctor:"",notas:"",rxImagenes:[],historiaClinica:{antecedentes:"",alergias:"",medicamentos:"",motivoConsulta:"",notas:""},odontograma:[],periodontograma:[],presupuestos:[],evoluciones:[],facturacion:{saldoFavor:0,saldoCredito:0},fotoUrl:"",activo:!0},$p=20,Oo=t=>Number(t||0);function VU(t){const[e,n]=P.useState(!1),[r,s]=P.useState([]),[i,o]=P.useState([]),[a,l]=P.useState("");P.useEffect(()=>{let C=!0;return(async()=>{if(!t){s([]),o([]);return}n(!0),l("");try{let I=st($e(_e,"facturas"),Qe("patientId","==",t),gn("fechaISO","desc"));const L=(await pn(I)).docs.map(N=>({id:N.id,...N.data()})).map(N=>({...N,total:Oo(N.total??N.valor??N.montoTotal),estado:(N.estado||"pendiente").toLowerCase(),fechaISO:N.fechaISO||N.fecha||null}));let $=st($e(_e,"pagos"),Qe("patientId","==",t),gn("fechaISO","desc"));const y=(await pn($)).docs.map(N=>({id:N.id,...N.data()})).map(N=>({...N,monto:Oo(N.monto??N.valor??N.total),fechaISO:N.fechaISO||N.fecha||null,medio:N.medio||N.metodo||""}));if(!C)return;s(L),o(y)}catch(I){console.warn("Finanzas: no se pudo leer colecciones. Contino solo con saldos del paciente.",I),C&&l("No se pudieron leer facturas/pagos.")}finally{C&&n(!1)}})(),()=>{C=!1}},[t]);const d=r.reduce((C,w)=>C+Oo(w.total),0),h=i.reduce((C,w)=>C+Oo(w.monto),0),f=r.filter(C=>["pagada","pagado","paid"].includes((C.estado||"").toLowerCase())),m=r.filter(C=>["pendiente","abierta","open","deuda"].includes((C.estado||"").toLowerCase())),_=f.reduce((C,w)=>C+Oo(w.total),0),A=m.reduce((C,w)=>C+Oo(w.total),0);return{loading:e,error:a,facturas:r,pagos:i,totalFacturado:d,totalPagado:h,totalFacturasPagadas:_,totalFacturasPendientes:A}}function LU(t){const[e,n]=P.useState(!1),[r,s]=P.useState([]);return P.useEffect(()=>{if(!t){s([]);return}n(!0);const i=$e(_e,"citas"),o=_=>{const A=_.data()||{},R=typeof A.fecha=="string"?A.fecha:"",C=(A.horaInicio||A.hora||"00:00").slice(0,5);let w=null;if(R){const[I,b,x]=R.split("-").map(v=>parseInt(v,10)),[L,$]=C.split(":").map(v=>parseInt(v,10)||0);w=new Date(I,(b||1)-1,x||1,L,$,0,0).toISOString()}return{id:_.id,...A,fechaISO:w,motivo:A.motivo||A.comentario||"",profesional:A.doctor||A.doctorNombre||"",fechaYYYYMMDD:R}};let a=new Map;const l=()=>{const _=Array.from(a.values());_.sort((A,R)=>{const C=A.fechaISO||"",w=R.fechaISO||"";if(C<w)return 1;if(C>w)return-1;const I=A.creado||"",b=R.creado||"";return I<b?1:I>b?-1:0}),s(_),n(!1)},d=st(i,Qe("pacienteId","==",t)),h=st(i,Qe("patientId","==",t)),f=Fn(d,_=>{_.docChanges().forEach(A=>{A.type==="removed"?a.delete(A.doc.id):a.set(A.doc.id,o(A.doc))}),l()},()=>n(!1)),m=Fn(h,_=>{_.docChanges().forEach(A=>{A.type==="removed"?a.delete(A.doc.id):a.set(A.doc.id,o(A.doc))}),l()},()=>n(!1));return()=>{try{f()}catch{}try{m()}catch{}}},[t]),{loading:e,citas:r}}function MU(){var ur,ys,On,Gr,ou,au,Ei,Za,el;const t=Ha(),e=lr(),n=PT.useMemo(()=>{const T=e.pathname.split("/").filter(Boolean),z=T.findIndex(Ce=>["pacientes","agenda","caja","facturacion","config","reportes","software"].includes(Ce)),ue="/"+T.slice(0,z>=0?z:T.length).join("/");return ue==="/"?"":ue},[e.pathname]),r=T=>{const z=String(T||"").replace(/^\//,""),X=n?`${n}/`:"/";t(`${X}${z}`)},s=(T,z)=>{const X=String(T).replace(/^\//,""),ue=z?new URLSearchParams(z).toString():"";return`${n?`${n}/`:"/"}${X}${ue?`?${ue}`:""}`},i=(T,z)=>{const X=String(T||"").slice(0,10);if(!X)return r("agenda");try{sessionStorage.setItem("agenda.targetDate",X)}catch{}const ue=new URLSearchParams({date:X,day:X,d:X,fecha:X,selectedDate:X,ts:String(new Date(X+"T00:00:00").getTime()),patientId:z||""}).toString();r(`agenda?${ue}`)},[o,a]=P.useState(!0),[l,d]=P.useState([]),[h,f]=P.useState(""),[m,_]=P.useState(null),[A,R]=P.useState(!0),[C,w]=P.useState(!1),[I,b]=P.useState(null),[x,L]=P.useState(null),$=P.useRef(null),[E,v]=P.useState("datos"),[y,N]=P.useState(jo),[D,j]=P.useState(null),[k,G]=P.useState(""),[We,Mt]=P.useState([]),[un,Z]=P.useState(!1),de=P.useRef(null),pe="comfy",[Pe,Ge]=P.useState(""),Pt=P.useMemo(()=>{switch(pe){case"comfy":return{thumbW:220,thumbH:165,colMin:240};case"cozy":return{thumbW:160,thumbH:120,colMin:180};default:return{thumbW:120,thumbH:90,colMin:140}}},[pe]),B=T=>{var X,ue;if((ue=(X=T==null?void 0:T.type)==null?void 0:X.startsWith)!=null&&ue.call(X,"image/"))return!0;const z=((T==null?void 0:T.name)||(T==null?void 0:T.title)||"").toLowerCase();return/\.(png|jpe?g|gif|bmp|webp|tiff?)$/.test(z)},re=P.useMemo(()=>{const T=Pe.trim().toLowerCase(),z=Array.isArray(x==null?void 0:x.rxImagenes)?x.rxImagenes:[];return T?z.filter(X=>`${X.name||""} ${X.title||""} ${X.desc||""}`.toLowerCase().includes(T)):z},[x==null?void 0:x.rxImagenes,Pe]),ce=async(T,z)=>{if(!(x!=null&&x.id))return;const X=Array.isArray(x.rxImagenes)?[...x.rxImagenes]:[];X[T]={...X[T]||{},...z},await ye({rxImagenes:X})},xe=()=>{const T=new Date,z=T.getFullYear(),X=String(T.getMonth()+1).padStart(2,"0"),ue=String(T.getDate()).padStart(2,"0");return`${z}-${X}-${ue}`},[Se,De]=P.useState(xe()),[we,Ze]=P.useState(""),[Ie,se]=P.useState(""),[Ne,et]=P.useState(""),[Tt,H]=P.useState("");P.useEffect(()=>{se((x==null?void 0:x.doctor)||"")},[x==null?void 0:x.doctor,x==null?void 0:x.id]);const ee=async()=>{if(!(x!=null&&x.id))return alert("Paciente no cargado.");if(!Se)return alert("Selecciona la fecha.");if(!we)return alert("Selecciona la hora.");if(!Ie.trim())return alert("Indica el doctor.");const T=x.nombreCompleto||x.paciente||"Paciente",z=x.celular||x.celularPaciente||"",X=x.telDomicilio||x.telefonoPaciente||"";if(!z&&!X)return alert("Este paciente no tiene telfono registrado (celular o fijo). Agrega uno antes de crear la cita.");try{const ue={paciente:T,pacienteId:x.id,doctor:Ie.trim(),fecha:Se,horaInicio:we,espacio:Ne||"",comentario:Tt||"",estado:"En espera",creado:new Date().toISOString(),celularPaciente:z,telefonoPaciente:X};await ra($e(_e,"citas"),ue),Ze(""),et(""),H(""),alert(" Cita creada. Ya aparece en la lista y en Agenda.")}catch(ue){console.error("Error creando cita:",ue),alert("No se pudo crear la cita.")}},te=P.useMemo(()=>hT[y.paisNacimiento]||[],[y.paisNacimiento]);P.useEffect(()=>((async()=>{a(!0);try{const X=(await pn($e(_e,"eps"))).docs.map(Ce=>{var nt;return(nt=Ce.data())==null?void 0:nt.nombre}).filter(Boolean),ue=Array.from(new Map(X.map(Ce=>[String(Ce).toLowerCase(),Ce])).values()).sort((Ce,nt)=>Ce.localeCompare(nt,"es"));Mt(ue),await ge(!0)}catch(z){console.error(z),alert("No se pudieron cargar pacientes/EPS.")}finally{a(!1)}})(),()=>{$.current&&($.current(),$.current=null)}),[]),P.useEffect(()=>{N(T=>({...T,nombreCompleto:`${T.nombres} ${T.apellidos}`.trim()}))},[y.nombres,y.apellidos]),P.useEffect(()=>{N(T=>({...T,nroHistoria:T.nroDocumento}))},[y.nroDocumento]),P.useEffect(()=>{N(T=>({...T,edad:jU(T.fechaNacimiento)}))},[y.fechaNacimiento]),P.useEffect(()=>{const T=new Date,z=T.toLocaleDateString(Ku)+" - "+T.toLocaleTimeString(Ku,{hour:"2-digit",minute:"2-digit",hour12:!0});N(X=>({...X,fechaIngreso:z}))},[]);const q=(T,z)=>N(X=>({...X,[T]:z})),ae=()=>{N(jo);const T=new Date,z=T.toLocaleDateString(Ku)+" - "+T.toLocaleTimeString(Ku,{hour:"2-digit",minute:"2-digit",hour12:!0});N(X=>({...X,fechaIngreso:z})),j(null),G(""),b(null)},me=async T=>{if(!T){j(null),G("");return}try{const z=await fT(T,{maxW:900,maxH:900,quality:.82});j(z);const X=new FileReader;X.onload=ue=>G(ue.target.result),X.readAsDataURL(z)}catch{j(T);const z=new FileReader;z.onload=X=>G(X.target.result),z.readAsDataURL(T)}},ge=async(T=!1)=>{a(!0);try{let z;T||!m?z=st($e(_e,"pacientes"),gn("creado","desc"),ma($p)):z=st($e(_e,"pacientes"),gn("creado","desc"),kM(m),ma($p));const X=await pn(z),ue=X.docs.map(Ce=>({id:Ce.id,...Ce.data()}));d(T?ue:Ce=>[...Ce,...ue]),_(X.docs[X.docs.length-1]||null),R(X.size===$p)}catch(z){console.error(z),alert("No se pudo cargar pacientes.")}finally{a(!1)}},Fe=async T=>{if(T.preventDefault(),!y.nroDocumento.trim())return alert("El nmero de documento es obligatorio.");if(!y.nombres.trim())return alert("Los nombres son obligatorios.");if(!y.apellidos.trim())return alert("Los apellidos son obligatorios.");if(!y.sexo.trim())return alert("El sexo es obligatorio.");if(!y.fechaNacimiento.trim())return alert("La fecha de nacimiento es obligatoria.");if(!y.celular.trim())return alert("El celular es obligatorio.");if(!y.email.trim())return alert("El correo electrnico es obligatorio.");if(!y.tipoVinculacion.trim())return alert("El tipo de vinculacin es obligatorio.");if(!y.nombreEps.trim())return alert("El nombre de la EPS es obligatorio.");try{const z=y.nroDocumento.trim();if(!I&&(await Ih(Gt(_e,"pacientes",z))).exists())return alert("Ya existe un paciente con ese nmero de documento.");const X=(y.nombreEps||"").trim(),ue=We.map(St=>St.toLowerCase()).includes(X.toLowerCase());if(X&&!ue&&window.confirm(`La EPS "${X}" no existe. Deseas guardarla para futuras selecciones?`)){const dn=X.toLowerCase().replace(/\s+/g,"_");await Th(Gt(_e,"eps",dn),{nombre:X,nombreLower:X.toLowerCase(),creado:Qn()},{merge:!0})}let Ce=y.fotoUrl||"",nt="";if(D)try{const St=Li(),dn=(D.name||"foto.jpg").replace(/\s+/g,"_");nt=`pacientes/${z}/${Date.now()}_${dn}`;const _s=bl(St,nt),vs={contentType:D.type||"image/jpeg",cacheControl:"public, max-age=86400"};await YI(_s,D,vs),Ce=await JI(_s)}catch(St){console.error("Foto (warning):",St)}const Ar=y.creado||null,Gn=I&&Ar||Qn(),Rr={...y,fotoUrl:Ce,nombre_busqueda:OU({...y,fotoUrl:Ce}),nombresLower:Ml(y.nombres),apellidosLower:Ml(y.apellidos),documentoLower:Ml(y.nroDocumento),emailLower:Ml(y.email),creado:Gn,createdAt:Gn,actualizado:Qn(),updatedAt:Qn(),activo:y.activo??!0,celularPaciente:y.celular,telefonoPaciente:y.telDomicilio||"",documento:y.nroDocumento,paciente:y.nombreCompleto};if(await Th(Gt(_e,"pacientes",z),Rr,{merge:!0}),nt)try{const St=Li(),dn=bl(St,`pacientes/${z}`),_s=await XI(dn),vs=nt,lu=_s.items.filter(Ii=>Ii.fullPath!==vs).map(Ii=>Dp(Ii).catch(()=>null));await Promise.allSettled(lu)}catch(St){console.warn("No se pudo limpiar fotos antiguas:",St)}alert(I?" Paciente actualizado.":" Paciente guardado."),d(St=>{const dn=St.filter(_s=>_s.id!==z);return[{id:z,...Rr},...dn]}),w(!1),b(null),ae()}catch(z){console.error("Error guardando paciente:",z),alert(`No se pudo guardar el paciente.

`+((z==null?void 0:z.message)||z))}},Ae=()=>{ae(),w(!0)},ze=()=>{x&&(N({...jo,...x,fotoUrl:x.fotoUrl||""}),j(null),G(x.fotoUrl||""),b(x.id),Y(),w(!0))},je=async T=>{if(window.confirm(`Eliminar al paciente "${T.nombreCompleto}"?`))try{await lA(Gt(_e,"pacientes",T.id)),d(z=>z.filter(X=>X.id!==T.id));try{const z=Li(),X=bl(z,`pacientes/${T.id}`),Ce=(await XI(X)).items.map(nt=>Dp(nt).catch(()=>null));await Promise.allSettled(Ce)}catch(z){console.warn("No se pudo borrar la carpeta de fotos:",z)}}catch(z){console.error(z),alert("No se pudo eliminar.")}},be=P.useMemo(()=>{const T=h.trim().toLowerCase();return T?l.filter(z=>`${z.nombreCompleto||z.paciente||""} ${z.nroDocumento||""} ${z.celular||z.celularPaciente||""} ${z.email||""}`.toLowerCase().includes(T)):l},[l,h]),M=T=>{Y();const z=Gt(_e,"pacientes",T.id),X=Fn(z,ue=>{ue.exists()?L({id:ue.id,...ie(ue.data())}):L(null)});$.current=X,v("datos")},Y=()=>{$.current&&($.current(),$.current=null),L(null)},ie=T=>({...jo,...T,historiaClinica:{...jo.historiaClinica,...T.historiaClinica||{}},facturacion:{...jo.facturacion,...T.facturacion||{}},rxImagenes:Array.isArray(T.rxImagenes)?T.rxImagenes:[],odontograma:Array.isArray(T.odontograma)?T.odontograma:[],periodontograma:Array.isArray(T.periodontograma)?T.periodontograma:[],presupuestos:Array.isArray(T.presupuestos)?T.presupuestos:[],evoluciones:Array.isArray(T.evoluciones)?T.evoluciones:[]}),ye=async T=>{if(x!=null&&x.id)try{await ga(Gt(_e,"pacientes",x.id),{...T,actualizado:Qn(),updatedAt:Qn()})}catch(z){console.error(z),alert("No se pudo actualizar.")}},tt=async T=>{var X;if(!(x!=null&&x.id)||!(T!=null&&T.length))return;const z=Li();try{Z(!0);const ue=[];for(const Ce of T){let nt=Ce;if((X=Ce.type)!=null&&X.startsWith("image/"))try{nt=await fT(Ce,{maxW:1600,maxH:1600,quality:.85})}catch{nt=Ce}const Ar=(nt.name||"archivo").replace(/\s+/g,"_"),Gn=`pacientes/${x.id}/rx/${Date.now()}_${Ar}`,Rr=bl(z,Gn),St={contentType:nt.type||"application/octet-stream",cacheControl:"public, max-age=31536000"};await YI(Rr,nt,St);const dn=await JI(Rr);ue.push({url:dn,name:Ce.name,title:Ce.name.replace(/\.[^.]+$/,""),desc:"",type:Ce.type,size:Ce.size||0,created:Date.now(),path:Gn})}await ye({rxImagenes:[...x.rxImagenes||[],...ue]})}catch(ue){console.error("RX upload error:",ue);const Ce=`No se pudo subir el/los archivo(s).
 Verifica que el usuario est autenticado.
 Revisa reglas de Storage para permitir escribir en 'pacientes/{id}/**'.
 Si usas Emulador, confirma que el bucket coincida.

`+((ue==null?void 0:ue.message)||"");alert(Ce)}finally{Z(!1);try{de.current&&(de.current.value="")}catch{}}},Xt=async T=>{if(!(x!=null&&x.id))return;const z=x.rxImagenes[T],X=x.rxImagenes.filter((ue,Ce)=>Ce!==T);await ye({rxImagenes:X});try{if(z!=null&&z.path){const ue=Li();await Dp(bl(ue,z.path))}}catch(ue){console.warn("No se pudo borrar del Storage:",ue)}},Tn=(T,z)=>{const X={...x.historiaClinica||{},[T]:z};ye({historiaClinica:X})},xn=T=>{const z=[...x.presupuestos||[],{id:String(Date.now()),...T}];ye({presupuestos:z})},Dn=T=>{ye({presupuestos:(x.presupuestos||[]).filter(z=>z.id!==T)})},Jt=T=>{const z=[...x.evoluciones||[],{id:String(Date.now()),fechaISO:new Date().toISOString(),nota:T}];ye({evoluciones:z})},Nt=T=>{ye({evoluciones:(x.evoluciones||[]).filter(z=>z.id!==T)})},Ft=(T,z)=>{const X=Array.isArray(x[T])?x[T]:[],ue=X.find(nt=>nt.pieza===z);let Ce;ue?Ce=X.filter(nt=>nt.pieza!==z):Ce=[...X,{pieza:z,estado:"marcada"}],ye({[T]:Ce})},jn=(x==null?void 0:x.id)||null,Ve=VU(jn),{loading:kt,citas:Cr}=LU(jn);return u.jsxs("div",{className:"odc-container",children:[u.jsx("div",{className:"odc-topbar-green"}),u.jsx("div",{className:"odc-topbar-blue",children:u.jsx("div",{className:"odc-top-inner",children:u.jsx("div",{className:"odc-breadcrumbs",children:"Pacientes"})})}),u.jsxs("div",{className:"odc-card",children:[u.jsxs("div",{className:"odc-card-header",children:[u.jsx("h3",{className:"odc-title",children:"Pacientes"}),u.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[u.jsx("input",{className:"search-input",style:{minWidth:280},placeholder:"Buscar por nombre, documento o telfono",value:h,onChange:T=>f(T.target.value)}),u.jsx("button",{type:"button",className:"btn green",onClick:Ae,children:"+ Nuevo paciente"})]})]}),u.jsx("div",{className:"table-wrap",children:u.jsxs("table",{className:"appointments-table",children:[u.jsx("thead",{children:u.jsxs("tr",{children:[u.jsx("th",{children:"Foto"}),u.jsx("th",{children:"Nombre"}),u.jsx("th",{children:"Documento"}),u.jsx("th",{children:"Celular"}),u.jsx("th",{children:"Correo"}),u.jsx("th",{children:"Estado"})]})}),u.jsx("tbody",{children:o&&l.length===0?u.jsx("tr",{children:u.jsx("td",{className:"no-data",colSpan:6,children:"Cargando"})}):be.length===0?u.jsx("tr",{children:u.jsx("td",{className:"no-data",colSpan:6,children:"No hay pacientes o no coinciden con la bsqueda."})}):be.map(T=>u.jsxs("tr",{className:"row-click",onClick:()=>M(T),children:[u.jsx("td",{onClick:z=>z.stopPropagation(),children:T.fotoUrl?u.jsx("img",{src:T.fotoUrl,alt:"Foto",style:{width:36,height:36,borderRadius:"50%",objectFit:"cover"}}):u.jsx("div",{className:"avatar-fallback",children:(T.nombreCompleto||"P")[0]})}),u.jsx("td",{children:T.nombreCompleto||T.paciente||""}),u.jsx("td",{children:T.nroDocumento||T.documento||""}),u.jsx("td",{children:T.celular||T.celularPaciente||""}),u.jsx("td",{children:T.email||""}),u.jsx("td",{children:u.jsx("span",{className:"pill pill-ok",children:T.activo?"Activo":"Inactivo"})})]},T.id))})]})}),u.jsxs("div",{className:"footer-actions",children:[u.jsx("button",{type:"button",className:"btn",disabled:o||!A,onClick:()=>ge(!1),children:A?"Cargar ms":"No hay ms"}),u.jsxs("div",{className:"hint",children:[l.length," registros cargados"]})]})]}),C&&u.jsxs("div",{className:"odc-modal",role:"dialog","aria-modal":"true",children:[u.jsx("div",{className:"odc-modal-backdrop",onClick:()=>w(!1)}),u.jsxs("div",{className:"odc-card",style:{width:1e3,maxWidth:"95%",maxHeight:"92vh",overflowY:"auto"},children:[u.jsxs("div",{className:"odc-card-header",children:[u.jsx("h3",{className:"odc-title",children:I?"Editar paciente":"Nuevo paciente"}),u.jsx("button",{type:"button",className:"btn",onClick:()=>w(!1),children:""})]}),u.jsxs("form",{onSubmit:Fe,children:[u.jsx("div",{className:"form-section-title",children:"Foto del paciente"}),u.jsxs("div",{className:"foto-row",children:[u.jsxs("label",{className:"foto-drop",children:[u.jsx("input",{type:"file",accept:"image/*",onChange:T=>{var z;return me(((z=T.target.files)==null?void 0:z[0])||null)},style:{display:"none"}}),k?u.jsx("img",{src:k,alt:"Preview",className:"foto-preview"}):u.jsx("div",{className:"foto-empty",children:"Arrastra o haz clic para cargar"})]}),k&&u.jsx("button",{type:"button",className:"btn",onClick:()=>me(null),children:"Quitar foto"})]}),u.jsx("div",{className:"form-section-title",children:"Datos de identificacin"}),u.jsxs("div",{className:"form-grid",children:[u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Tipo de documento *"}),u.jsxs("select",{className:"form-input",value:y.tipoDocumento,onChange:T=>q("tipoDocumento",T.target.value),children:[u.jsx("option",{value:"",children:"Seleccione"}),u.jsx("option",{value:"CC",children:"Cdula"}),u.jsx("option",{value:"TI",children:"Tarjeta de identidad"}),u.jsx("option",{value:"PA",children:"Pasaporte"}),u.jsx("option",{value:"OTRO",children:"Otro"})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Nro. de documento *"}),u.jsx("input",{className:"form-input",value:y.nroDocumento,onChange:T=>q("nroDocumento",T.target.value),placeholder:"Nmero de documento",required:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Nmero de Historia"}),u.jsx("input",{className:"form-input",value:y.nroHistoria,readOnly:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Nombres *"}),u.jsx("input",{className:"form-input",value:y.nombres,onChange:T=>q("nombres",T.target.value),required:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Apellidos *"}),u.jsx("input",{className:"form-input",value:y.apellidos,onChange:T=>q("apellidos",T.target.value),required:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Nombre completo"}),u.jsx("input",{className:"form-input",value:y.nombreCompleto,readOnly:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Sexo *"}),u.jsxs("select",{className:"form-input",value:y.sexo,onChange:T=>q("sexo",T.target.value),required:!0,children:[u.jsx("option",{value:"",children:"Seleccione"}),u.jsx("option",{children:"Masculino"}),u.jsx("option",{children:"Femenino"}),u.jsx("option",{children:"Otro"})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Estado civil *"}),u.jsxs("select",{className:"form-input",value:y.estadoCivil,onChange:T=>q("estadoCivil",T.target.value),required:!0,children:[u.jsx("option",{value:"",children:"Seleccione"}),u.jsx("option",{children:"Soltero"}),u.jsx("option",{children:"Casado"}),u.jsx("option",{children:"Unin libre"}),u.jsx("option",{children:"Divorciado"}),u.jsx("option",{children:"Viudo"})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Pas de nacimiento *"}),u.jsx("input",{className:"form-input",list:"listCountries",value:y.paisNacimiento,onChange:T=>q("paisNacimiento",T.target.value),placeholder:"Escribe y elige",required:!0}),u.jsx("datalist",{id:"listCountries",children:DU.map(T=>u.jsx("option",{value:T},T))})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Ciudad de nacimiento"}),u.jsx("input",{className:"form-input",list:"listCitiesBirth",value:y.ciudadNacimiento,onChange:T=>q("ciudadNacimiento",T.target.value),placeholder:"Escribe y elige"}),u.jsx("datalist",{id:"listCitiesBirth",children:te.map(T=>u.jsx("option",{value:T},T))})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Fecha de ingreso"}),u.jsx("input",{className:"form-input",value:y.fechaIngreso,readOnly:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Fecha de nacimiento *"}),u.jsx("input",{type:"date",className:"form-input",value:y.fechaNacimiento,onChange:T=>q("fechaNacimiento",T.target.value),required:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Edad"}),u.jsx("input",{className:"form-input",value:y.edad,readOnly:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Pas de domicilio *"}),u.jsx("input",{className:"form-input",list:"listCountries",value:y.paisDomicilio,onChange:T=>q("paisDomicilio",T.target.value),required:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Ciudad de domicilio *"}),u.jsx("input",{className:"form-input",list:"listCitiesHome",value:y.ciudadDomicilio,onChange:T=>q("ciudadDomicilio",T.target.value),required:!0}),u.jsx("datalist",{id:"listCitiesHome",children:(hT[y.paisDomicilio]||[]).map(T=>u.jsx("option",{value:T},T))})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Barrio *"}),u.jsx("input",{className:"form-input",value:y.barrio,onChange:T=>q("barrio",T.target.value),required:!0,placeholder:"Barrio"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Lugar de residencia *"}),u.jsx("input",{className:"form-input",value:y.lugarResidencia,onChange:T=>q("lugarResidencia",T.target.value),required:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Estrato"}),u.jsxs("select",{className:"form-input",value:y.estrato,onChange:T=>q("estrato",T.target.value),children:[u.jsx("option",{value:"",children:"Seleccione"}),u.jsx("option",{children:"1"}),u.jsx("option",{children:"2"}),u.jsx("option",{children:"3"}),u.jsx("option",{children:"4"}),u.jsx("option",{children:"5"}),u.jsx("option",{children:"6"})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Zona residencial *"}),u.jsxs("select",{className:"form-input",value:y.zonaResidencial,onChange:T=>q("zonaResidencial",T.target.value),required:!0,children:[u.jsx("option",{value:"",children:"Seleccione"}),u.jsx("option",{children:"Urbana"}),u.jsx("option",{children:"Rural"})]})]}),u.jsxs("div",{className:"checkbox-cell",children:[u.jsx("label",{className:"form-label",children:"Es extranjero?"}),u.jsx("input",{type:"checkbox",checked:y.esExtranjero,onChange:T=>q("esExtranjero",T.target.checked)})]}),u.jsxs("div",{className:"checkbox-cell",children:[u.jsx("label",{className:"form-label",children:"Permite publicidad?"}),u.jsx("input",{type:"checkbox",checked:y.permitePublicidad,onChange:T=>q("permitePublicidad",T.target.checked)})]})]}),u.jsx("div",{className:"form-section-title",children:"Contacto"}),u.jsxs("div",{className:"form-grid",children:[u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Celular *"}),u.jsx("input",{className:"form-input",value:y.celular,onChange:T=>q("celular",T.target.value),required:!0,placeholder:"Celular del paciente"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Telfono de domicilio"}),u.jsx("input",{className:"form-input",value:y.telDomicilio,onChange:T=>q("telDomicilio",T.target.value)})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Telfono de oficina"}),u.jsx("input",{className:"form-input",value:y.telOficina,onChange:T=>q("telOficina",T.target.value)})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Extensin"}),u.jsx("input",{className:"form-input",value:y.extension,onChange:T=>q("extension",T.target.value)})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Correo electrnico *"}),u.jsx("input",{type:"email",className:"form-input",value:y.email,onChange:T=>q("email",T.target.value),required:!0,placeholder:"correo@dominio.com"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Ocupacin *"}),u.jsx("input",{className:"form-input",value:y.ocupacion,onChange:T=>q("ocupacion",T.target.value),required:!0})]})]}),u.jsx("div",{className:"form-section-title",children:"Datos de facturacin"}),u.jsxs("div",{className:"form-grid",children:[u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Responsable"}),u.jsx("input",{className:"form-input",value:y.nombreResponsable,onChange:T=>q("nombreResponsable",T.target.value)})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Parentesco"}),u.jsxs("select",{className:"form-input",value:y.parentesco,onChange:T=>q("parentesco",T.target.value),children:[u.jsx("option",{value:"",children:"Seleccione"}),u.jsx("option",{children:"Padre/Madre"}),u.jsx("option",{children:"Hermano"}),u.jsx("option",{children:"Esposo/a"}),u.jsx("option",{children:"Otro"})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Celular"}),u.jsx("input",{className:"form-input",value:y.celularResponsable,onChange:T=>q("celularResponsable",T.target.value)})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Telfono"}),u.jsx("input",{className:"form-input",value:y.telefonoResponsable,onChange:T=>q("telefonoResponsable",T.target.value)})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Correo electrnico"}),u.jsx("input",{type:"email",className:"form-input",value:y.emailResponsable,onChange:T=>q("emailResponsable",T.target.value)})]})]}),u.jsx("div",{className:"form-section-title",children:"Acompaante"}),u.jsxs("div",{className:"form-grid",children:[u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Nombre"}),u.jsx("input",{className:"form-input",value:y.nombreAcompanante,onChange:T=>q("nombreAcompanante",T.target.value),placeholder:"Nombre acompaante"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Telfono"}),u.jsx("input",{className:"form-input",value:y.telefonoAcompanante,onChange:T=>q("telefonoAcompanante",T.target.value),placeholder:"Telfono acompaante"})]})]}),u.jsx("div",{className:"form-section-title",children:"Mercadeo"}),u.jsxs("div",{className:"form-grid",children:[u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Convenio beneficio"}),u.jsx("input",{className:"form-input",value:y.convenioBeneficio,onChange:T=>q("convenioBeneficio",T.target.value)})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Cmo nos conoci?"}),u.jsxs("select",{className:"form-input",value:y.comoConocio,onChange:T=>q("comoConocio",T.target.value),children:[u.jsx("option",{value:"",children:"Seleccione"}),u.jsx("option",{children:"Redes sociales"}),u.jsx("option",{children:"Publicidad"}),u.jsx("option",{children:"Recomendacin"}),u.jsx("option",{children:"Otro"})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Campaa"}),u.jsx("input",{className:"form-input",value:y.campania,onChange:T=>q("campania",T.target.value)})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Remitido por"}),u.jsx("input",{className:"form-input",value:y.remitidoPor,onChange:T=>q("remitidoPor",T.target.value)})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Asesor comercial"}),u.jsx("input",{className:"form-input",value:y.asesorComercial,onChange:T=>q("asesorComercial",T.target.value)})]})]}),u.jsx("div",{className:"form-section-title",children:"EPS"}),u.jsxs("div",{className:"form-grid",children:[u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Tipo de vinculacin *"}),u.jsxs("select",{className:"form-input",value:y.tipoVinculacion,onChange:T=>q("tipoVinculacion",T.target.value),required:!0,children:[u.jsx("option",{value:"",children:"Seleccione"}),u.jsx("option",{children:"Contributivo"}),u.jsx("option",{children:"Subsidiado"}),u.jsx("option",{children:"Particular"}),u.jsx("option",{children:"Otro"})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Nombre de la EPS *"}),u.jsx("input",{className:"form-input",list:"listEps",value:y.nombreEps,onChange:T=>q("nombreEps",T.target.value),placeholder:"Escribe y selecciona",required:!0}),u.jsx("datalist",{id:"listEps",children:We.map(T=>u.jsx("option",{value:T},T))})]}),u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Pliza de salud"}),u.jsx("input",{className:"form-input",value:y.polizaSalud,onChange:T=>q("polizaSalud",T.target.value)})]})]}),u.jsx("div",{className:"form-section-title",children:"Doctor"}),u.jsx("div",{className:"form-grid",children:u.jsxs("div",{children:[u.jsx("label",{className:"form-label",children:"Doctor"}),u.jsx("input",{className:"form-input",value:y.doctor,onChange:T=>q("doctor",T.target.value),placeholder:"Usuario / Libre"})]})}),u.jsx("div",{className:"form-section-title",children:"Alertas y Notas"}),u.jsx("div",{className:"form-grid",children:u.jsx("textarea",{className:"form-input",rows:3,value:y.notas,onChange:T=>q("notas",T.target.value),placeholder:"Notas del paciente"})}),u.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:8,marginTop:12},children:[I?u.jsx("button",{type:"button",className:"btn",onClick:()=>je({id:I,nombreCompleto:y.nombreCompleto}),children:"Eliminar"}):u.jsx("div",{}),u.jsxs("div",{style:{display:"flex",gap:8},children:[u.jsx("button",{type:"button",className:"btn",onClick:()=>w(!1),children:"Cancelar"}),u.jsx("button",{type:"submit",className:"btn blue",children:I?"Actualizar":"Guardar paciente"})]})]})]})]})]}),x&&u.jsxs("div",{className:"odc-modal",role:"dialog","aria-modal":"true",children:[u.jsx("div",{className:"odc-modal-backdrop",onClick:Y}),u.jsxs("div",{className:"odc-card ficha-card",children:[u.jsxs("div",{className:"ficha-header",children:[u.jsxs("div",{className:"ficha-header-left",children:[x.fotoUrl?u.jsx("img",{src:x.fotoUrl,alt:"Foto",className:"ficha-avatar"}):u.jsx("div",{className:"avatar-fallback ficha-avatar-fallback",children:(x.nombreCompleto||"P")[0]}),u.jsxs("div",{children:[u.jsx("div",{className:"ficha-nombre",children:x.nombreCompleto||""}),u.jsxs("div",{className:"ficha-doc",children:[x.tipoDocumento||""," ",x.nroDocumento||""]}),u.jsxs("div",{className:"ficha-badges",children:[u.jsx("span",{className:"ficha-badge blue",children:"En valoracin"}),u.jsx("span",{className:"ficha-badge green",children:"Sin deuda"})]})]})]}),u.jsx("div",{className:"ficha-header-right",children:u.jsxs("div",{className:"ficha-actions",children:[u.jsx("button",{type:"button",className:"btn",onClick:Y,children:"Cerrar"}),u.jsx("button",{type:"button",className:"btn blue",onClick:ze,children:"Editar"}),u.jsx("button",{type:"button",className:"btn green",onClick:()=>t(s(Wu.caja,{cobro:1,patientId:x.id})),title:"Ir a Caja para cobrar a este paciente",children:"Cobrar"})]})})]}),u.jsxs("div",{className:"ficha-body",children:[u.jsxs("aside",{className:"ficha-sidebar",children:[u.jsx("div",{className:"ficha-sidebar-title",children:"Informacin general"}),u.jsx("button",{type:"button",className:`ficha-link ${E==="datos"?"active":""}`,onClick:()=>v("datos"),children:"Datos personales"}),u.jsx("button",{type:"button",className:`ficha-link ${E==="marketing"?"active":""}`,onClick:()=>v("marketing"),children:"Marketing"}),u.jsx("button",{type:"button",className:`ficha-link ${E==="eps"?"active":""}`,onClick:()=>v("eps"),children:"EPS"}),u.jsx("button",{type:"button",className:`ficha-link ${E==="prof"?"active":""}`,onClick:()=>v("prof"),children:"Profesionales"}),u.jsx("button",{type:"button",className:`ficha-link ${E==="rx"?"active":""}`,onClick:()=>v("rx"),children:"Rx/Imgenes/Doc"}),u.jsx("button",{type:"button",className:`ficha-link ${E==="citas"?"active":""}`,onClick:()=>v("citas"),children:"Citas"}),u.jsx("button",{type:"button",className:`ficha-link ${E==="crm"?"active":""}`,onClick:()=>v("crm"),children:"CRM"}),u.jsx("div",{className:"ficha-sidebar-title mt",children:"Historia clnica"}),u.jsx("button",{type:"button",className:`ficha-link ${E==="doc"?"active":""}`,onClick:()=>v("doc"),children:"Doc. Clnicos"}),u.jsx("button",{type:"button",className:`ficha-link ${E==="odonto"?"active":""}`,onClick:()=>v("odonto"),children:"Odontogramas"}),u.jsx("button",{type:"button",className:`ficha-link ${E==="perio"?"active":""}`,onClick:()=>v("perio"),children:"Periodontogramas"}),u.jsx("button",{type:"button",className:`ficha-link ${E==="presu"?"active":""}`,onClick:()=>v("presu"),children:"Presupuestos"}),u.jsx("button",{type:"button",className:`ficha-link ${E==="evo"?"active":""}`,onClick:()=>v("evo"),children:"Evoluciones"}),u.jsx("div",{className:"ficha-sidebar-title mt",children:"Facturacin"}),u.jsx("button",{type:"button",className:`ficha-link ${E==="fact"?"active":""}`,onClick:()=>v("fact"),children:"Resumen"}),u.jsxs("div",{className:"ficha-sidebar-actions",style:{display:"grid",gap:8,marginTop:8},children:[u.jsx("button",{type:"button",className:"btn pay",onClick:()=>t(s(Wu.caja,{cobro:1,patientId:x.id})),title:"Cobrar a este paciente",children:"Realizar pago"}),u.jsx("button",{type:"button",className:"btn history",onClick:()=>r(`${Wu.pagos}?patientId=${encodeURIComponent(x.id)}`),title:"Ver histrico de pagos",children:"Histrico de pagos"}),u.jsx("button",{type:"button",className:"btn history",onClick:()=>r(`${Wu.facturas}?patientId=${encodeURIComponent(x.id)}`),title:"Ver histrico de facturacin",children:"Histrico de facturacin"})]})]}),u.jsxs("main",{className:"ficha-content",children:[E==="datos"&&u.jsxs("section",{className:"ficha-section",children:[u.jsx("h4",{className:"ficha-section-title",children:"Datos personales"}),u.jsx("div",{className:"ficha-grid",children:[["Tipo de documento",x.tipoDocumento],["Nro. de documento",x.nroDocumento],["Nmero de Historia",x.nroHistoria],["Fecha de ingreso",x.fechaIngreso],["Nombres",x.nombres],["Apellidos",x.apellidos],["Nombre completo",x.nombreCompleto],["Sexo",x.sexo],["Estado civil",x.estadoCivil],["Pas de nacimiento",x.paisNacimiento],["Ciudad de nacimiento",x.ciudadNacimiento],["Fecha de nacimiento",x.fechaNacimiento],["Edad",x.edad],["Pas de domicilio",x.paisDomicilio],["Ciudad de domicilio",x.ciudadDomicilio],["Barrio",x.barrio],["Lugar de residencia",x.lugarResidencia],["Estrato",x.estrato],["Zona residencial",x.zonaResidencial],["Extranjero",x.esExtranjero?"S":"No"],["Permite publicidad",x.permitePublicidad?"S":"No"],["Celular",x.celular||x.celularPaciente],["Telfono domicilio",x.telDomicilio||x.telefonoPaciente],["Telfono oficina",x.telOficina],["Extensin",x.extension],["Correo electrnico",x.email],["Ocupacin",x.ocupacion],["Responsable",x.nombreResponsable],["Parentesco",x.parentesco],["Cel. responsable",x.celularResponsable],["Tel. responsable",x.telefonoResponsable],["Email responsable",x.emailResponsable],["Acompaante",x.nombreAcompanante],["Tel. acompaante",x.telefonoAcompanante]].map(([T,z])=>u.jsxs("div",{className:"field",children:[u.jsx("label",{children:T}),u.jsx("input",{className:"form-input",value:z||"",readOnly:!0})]},T))})]}),E==="marketing"&&u.jsxs("section",{className:"ficha-section",children:[u.jsx("h4",{className:"ficha-section-title",children:"Marketing"}),u.jsx("div",{className:"ficha-grid",children:[["Convenio beneficio",x.convenioBeneficio],["Cmo nos conoci?",x.comoConocio],["Campaa",x.campania],["Remitido por",x.remitidoPor],["Asesor comercial",x.asesorComercial]].map(([T,z])=>u.jsxs("div",{className:"field",children:[u.jsx("label",{children:T}),u.jsx("input",{className:"form-input",value:z||"",readOnly:!0})]},T))})]}),E==="eps"&&u.jsxs("section",{className:"ficha-section",children:[u.jsx("h4",{className:"ficha-section-title",children:"EPS"}),u.jsx("div",{className:"ficha-grid",children:[["Tipo de vinculacin",x.tipoVinculacion],["Nombre EPS",x.nombreEps],["Pliza de salud",x.polizaSalud]].map(([T,z])=>u.jsxs("div",{className:"field",children:[u.jsx("label",{children:T}),u.jsx("input",{className:"form-input",value:z||"",readOnly:!0})]},T))})]}),E==="prof"&&u.jsxs("section",{className:"ficha-section",children:[u.jsx("h4",{className:"ficha-section-title",children:"Profesionales"}),u.jsx("div",{className:"ficha-grid",children:u.jsxs("div",{className:"field",children:[u.jsx("label",{children:"Doctor"}),u.jsx("input",{className:"form-input",value:x.doctor||"",readOnly:!0})]})})]}),E==="rx"&&u.jsxs("section",{className:"ficha-section",children:[u.jsx("h4",{className:"ficha-section-title",children:"Rx / Imgenes / Documentos"}),u.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",flexWrap:"wrap"},children:[u.jsxs("label",{className:"btn blue",children:["Subir archivos",u.jsx("input",{ref:de,type:"file",multiple:!0,accept:"image/*,.pdf,.doc,.docx,.xls,.xlsx",style:{display:"none"},onChange:T=>tt([...T.target.files||[]])})]}),un&&u.jsx("span",{className:"hint",children:"Subiendo"}),u.jsx("div",{style:{marginLeft:"auto",display:"flex",gap:8,alignItems:"center"},children:u.jsx("input",{className:"form-input",style:{width:200},placeholder:"Buscar en Rx",value:Pe,onChange:T=>Ge(T.target.value),title:"Filtra por nombre, ttulo o descripcin"})})]}),u.jsxs("div",{className:"hint",style:{marginTop:6},children:[re.length," elemento(s)",Pe?"  filtrado(s)":"","."]}),u.jsxs("div",{className:"rx-grid",style:{display:"grid",gap:10,marginTop:12,gridTemplateColumns:`repeat(auto-fill, minmax(${Pt.colMin}px, 1fr))`,alignItems:"start"},children:[re.length===0&&u.jsx("div",{className:"no-data",style:{gridColumn:"1 / -1"},children:Pe?"Sin coincidencias.":"Sin archivos an."}),re.map((T,z)=>{var nt,Ar;const X=B(T),ue=T.title||T.name||`archivo-${z}`,Ce=((nt=(T.name||"").split(".").pop())==null?void 0:nt.toUpperCase())||((Ar=(T.type||"").split("/").pop())==null?void 0:Ar.toUpperCase())||"";return u.jsxs("div",{className:"rx-item mini-card",style:{padding:8,display:"grid",gap:8},title:ue,children:[u.jsx("a",{href:T.url,target:"_blank",rel:"noreferrer",style:{width:"100%",height:Pt.thumbH,borderRadius:8,overflow:"hidden",border:"1px solid #e5e7eb",display:"grid",placeItems:"center",background:"#fafafa"},children:X?u.jsx("img",{src:T.url,alt:ue,style:{width:Pt.thumbW,height:Pt.thumbH,objectFit:"contain",display:"block"},loading:"lazy"}):u.jsxs("div",{style:{textAlign:"center",padding:10},children:[u.jsx("div",{style:{fontSize:24,fontWeight:700},children:Ce||"DOC"}),u.jsx("div",{style:{fontSize:12,opacity:.7},children:"Ver / descargar"})]})}),u.jsx("div",{style:{fontWeight:600,fontSize:13,lineHeight:1.2},children:ue.length>40?ue.slice(0,37)+"":ue}),u.jsxs("details",{children:[u.jsx("summary",{style:{cursor:"pointer",fontSize:12,color:"#2563eb"},children:"Editar nombre y descripcin"}),u.jsxs("div",{style:{display:"grid",gap:6,marginTop:6},children:[u.jsx("label",{className:"form-label",style:{marginTop:4},children:"Nombre para mostrar"}),u.jsx("input",{id:`rx-title-${z}`,className:"form-input",defaultValue:T.title||T.name||"",placeholder:"Ej. Rx aleta derecha 2025-11-29"}),u.jsx("label",{className:"form-label",children:"Descripcin"}),u.jsx("textarea",{id:`rx-desc-${z}`,className:"form-input",rows:2,defaultValue:T.desc||"",placeholder:"Observaciones, regin, tcnica, etc."}),u.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",justifyContent:"space-between"},children:[u.jsx("button",{type:"button",className:"btn blue",onClick:()=>{var St,dn;const Gn=((St=document.getElementById(`rx-title-${z}`))==null?void 0:St.value)||"",Rr=((dn=document.getElementById(`rx-desc-${z}`))==null?void 0:dn.value)||"";ce(z,{title:Gn,name:Gn||T.name,desc:Rr})},children:"Guardar"}),u.jsx("button",{type:"button",className:"btn",onClick:()=>Xt(z),children:"Eliminar"})]}),u.jsxs("div",{className:"hint",style:{fontSize:11},children:["Tipo: ",T.type||"","  Tamao: ",(T.size||0).toLocaleString()," bytes"]})]})]})]},`${T.url}-${z}`)})]})]}),E==="doc"&&u.jsxs("section",{className:"ficha-section",children:[u.jsx("h4",{className:"ficha-section-title",children:"Doc. Clnicos"}),u.jsxs("div",{className:"ficha-grid",children:[u.jsxs("div",{className:"field",children:[u.jsx("label",{children:"Motivo de consulta"}),u.jsx("textarea",{className:"form-input",rows:3,value:((ur=x.historiaClinica)==null?void 0:ur.motivoConsulta)||"",onChange:T=>Tn("motivoConsulta",T.target.value)})]}),u.jsxs("div",{className:"field",children:[u.jsx("label",{children:"Antecedentes"}),u.jsx("textarea",{className:"form-input",rows:3,value:((ys=x.historiaClinica)==null?void 0:ys.antecedentes)||"",onChange:T=>Tn("antecedentes",T.target.value)})]}),u.jsxs("div",{className:"field",children:[u.jsx("label",{children:"Alergias"}),u.jsx("textarea",{className:"form-input",rows:2,value:((On=x.historiaClinica)==null?void 0:On.alergias)||"",onChange:T=>Tn("alergias",T.target.value)})]}),u.jsxs("div",{className:"field",children:[u.jsx("label",{children:"Medicamentos"}),u.jsx("textarea",{className:"form-input",rows:2,value:((Gr=x.historiaClinica)==null?void 0:Gr.medicamentos)||"",onChange:T=>Tn("medicamentos",T.target.value)})]}),u.jsxs("div",{className:"field",children:[u.jsx("label",{children:"Notas"}),u.jsx("textarea",{className:"form-input",rows:3,value:((ou=x.historiaClinica)==null?void 0:ou.notas)||"",onChange:T=>Tn("notas",T.target.value)})]})]})]}),E==="odonto"&&u.jsxs("section",{className:"ficha-section",children:[u.jsx("h4",{className:"ficha-section-title",children:"Odontograma (placeholder)"}),u.jsx("div",{className:"odont-grid",children:Array.from({length:32},(T,z)=>z+1).map(T=>{const z=(x.odontograma||[]).some(X=>X.pieza===T);return u.jsx("button",{type:"button",className:`tooth ${z?"on":""}`,onClick:()=>Ft("odontograma",T),title:`Pieza ${T}`,children:T},T)})})]}),E==="perio"&&u.jsxs("section",{className:"ficha-section",children:[u.jsx("h4",{className:"ficha-section-title",children:"Periodontograma (placeholder)"}),u.jsx("div",{className:"odont-grid",children:Array.from({length:32},(T,z)=>z+1).map(T=>{const z=(x.periodontograma||[]).some(X=>X.pieza===T);return u.jsx("button",{type:"button",className:`tooth ${z?"on":""}`,onClick:()=>Ft("periodontograma",T),title:`Pieza ${T}`,children:T},T)})})]}),E==="presu"&&u.jsxs("section",{className:"ficha-section",children:[u.jsx("h4",{className:"ficha-section-title",children:"Presupuestos & planes"}),u.jsx(FU,{onAdd:xn}),u.jsxs("div",{className:"presu-list",children:[(x.presupuestos||[]).map(T=>u.jsxs("div",{className:"presu-item",children:[u.jsxs("div",{children:[u.jsx("div",{className:"presu-title",children:T.titulo}),u.jsxs("div",{className:"presu-meta",children:["Costo: $",T.costo||0,"  Estado: ",T.estado||"Pendiente"]})]}),u.jsx("button",{type:"button",className:"btn small",onClick:()=>Dn(T.id),children:"Eliminar"})]},T.id)),(!x.presupuestos||x.presupuestos.length===0)&&u.jsx("div",{className:"no-data",children:"Sin presupuestos an."})]})]}),E==="evo"&&u.jsxs("section",{className:"ficha-section",children:[u.jsx("h4",{className:"ficha-section-title",children:"Evoluciones & Remisiones"}),u.jsx(UU,{onAdd:Jt}),u.jsxs("div",{className:"evo-list",children:[(x.evoluciones||[]).map(T=>u.jsxs("div",{className:"evo-item",children:[u.jsx("div",{className:"evo-date",children:new Date(T.fechaISO).toLocaleString()}),u.jsx("div",{className:"evo-note",children:T.nota}),u.jsx("button",{type:"button",className:"btn small",onClick:()=>Nt(T.id),children:"Eliminar"})]},T.id)),(!x.evoluciones||x.evoluciones.length===0)&&u.jsx("div",{className:"no-data",children:"Sin evoluciones an."})]})]}),E==="fact"&&u.jsxs("section",{className:"ficha-section",children:[u.jsx("h4",{className:"ficha-section-title",children:"Facturacin"}),u.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(220px,1fr))",gap:12},children:[u.jsx(Vo,{title:"Total facturado",value:`$ ${Ve.totalFacturado.toLocaleString()}`}),u.jsx(Vo,{title:"Total pagado",value:`$ ${Ve.totalPagado.toLocaleString()}`}),u.jsx(Vo,{title:"Facturas pendientes",value:`$ ${Ve.totalFacturasPendientes.toLocaleString()}`}),u.jsx(Vo,{title:"Saldo pendiente (facturas - pagos)",value:`$ ${(Ve.totalFacturado-Ve.totalPagado).toLocaleString()}`}),u.jsx(Vo,{title:"Saldo a favor",value:`$ ${(((au=x.facturacion)==null?void 0:au.saldoFavor)??0).toLocaleString()}`}),u.jsx(Vo,{title:"Saldo crdito",value:`$ ${(((Ei=x.facturacion)==null?void 0:Ei.saldoCredito)??0).toLocaleString()}`})]}),Ve.error&&u.jsxs("div",{className:"hint",style:{marginTop:6},children:[" ",Ve.error]}),u.jsxs("div",{className:"ficha-grid",style:{marginTop:12},children:[u.jsxs("div",{className:"field",children:[u.jsx("label",{children:"Saldo a favor"}),u.jsx("input",{type:"number",className:"form-input",value:((Za=x.facturacion)==null?void 0:Za.saldoFavor)??0,onChange:T=>ye({facturacion:{...x.facturacion||{},saldoFavor:Number(T.target.value||0)}})})]}),u.jsxs("div",{className:"field",children:[u.jsx("label",{children:"Saldo crdito"}),u.jsx("input",{type:"number",className:"form-input",value:((el=x.facturacion)==null?void 0:el.saldoCredito)??0,onChange:T=>ye({facturacion:{...x.facturacion||{},saldoCredito:Number(T.target.value||0)}})})]})]})]}),E==="citas"&&u.jsxs("section",{className:"ficha-section",children:[u.jsx("h4",{className:"ficha-section-title",children:"Citas"}),u.jsxs("div",{className:"mini-card",style:{marginBottom:12},children:[u.jsx("div",{className:"mini-card-title",children:"Crear cita para este paciente"}),u.jsxs("div",{className:"ficha-grid",style:{marginTop:8},children:[u.jsxs("div",{className:"field",children:[u.jsx("label",{children:"Fecha"}),u.jsx("input",{type:"date",className:"form-input",value:Se,onChange:T=>De(T.target.value)})]}),u.jsxs("div",{className:"field",children:[u.jsx("label",{children:"Hora"}),u.jsx("input",{type:"time",className:"form-input",value:we,onChange:T=>Ze(T.target.value)})]}),u.jsxs("div",{className:"field",children:[u.jsx("label",{children:"Doctor"}),u.jsx("input",{className:"form-input",value:Ie,onChange:T=>se(T.target.value),placeholder:"Doctor asignado"})]}),u.jsxs("div",{className:"field",children:[u.jsx("label",{children:"Espacio / Sala"}),u.jsx("input",{className:"form-input",value:Ne,onChange:T=>et(T.target.value),placeholder:"Consultorio / Silla"})]}),u.jsxs("div",{className:"field",style:{gridColumn:"1 / -1"},children:[u.jsx("label",{children:"Comentario"}),u.jsx("textarea",{className:"form-input",rows:2,value:Tt,onChange:T=>H(T.target.value),placeholder:"Motivo / notas de la cita"})]})]}),u.jsxs("div",{style:{display:"flex",gap:8,justifyContent:"flex-end"},children:[u.jsx("button",{type:"button",className:"btn blue",onClick:ee,children:"Guardar cita"}),Se&&u.jsx("button",{type:"button",className:"btn",onClick:()=>i(Se,x.id),children:"Ver ese da en Agenda"})]})]}),u.jsx("div",{className:"table-wrap",children:u.jsxs("table",{className:"appointments-table",children:[u.jsx("thead",{children:u.jsxs("tr",{children:[u.jsx("th",{children:"Fecha"}),u.jsx("th",{children:"Estado"}),u.jsx("th",{children:"Motivo"}),u.jsx("th",{children:"Profesional / Acciones"})]})}),u.jsx("tbody",{children:kt?u.jsx("tr",{children:u.jsx("td",{className:"no-data",colSpan:4,children:"Cargando"})}):Cr.length===0?u.jsx("tr",{children:u.jsx("td",{className:"no-data",colSpan:4,children:"Sin citas registradas."})}):Cr.map(T=>u.jsxs("tr",{children:[u.jsx("td",{children:T.fechaISO?new Date(T.fechaISO).toLocaleString():T.fechaYYYYMMDD||""}),u.jsx("td",{children:T.estado||""}),u.jsx("td",{children:T.motivo||""}),u.jsx("td",{children:u.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[u.jsx("span",{children:T.profesional||""}),u.jsx("button",{type:"button",className:"btn small",onClick:()=>{const z=T.fechaYYYYMMDD||T.fecha||(T.fechaISO?new Date(T.fechaISO).toISOString().slice(0,10):"");i(z,x.id)},title:"Abrir en Agenda",children:"Ver en Agenda"})]})})]},T.id))})]})})]}),E==="crm"&&u.jsxs("section",{className:"ficha-section",children:[u.jsx("h4",{className:"ficha-section-title",children:"CRM"}),u.jsx("div",{className:"no-data",children:"Notas / recordatorios comerciales del paciente."})]}),u.jsx("div",{className:"ficha-footer"})]})]})]})]})]})}function Vo({title:t,value:e}){return u.jsxs("div",{className:"mini-card",children:[u.jsx("div",{className:"mini-card-title",children:t}),u.jsx("div",{style:{fontWeight:700,fontSize:20,marginTop:6},children:e})]})}function FU({onAdd:t}){const[e,n]=P.useState(""),[r,s]=P.useState(""),[i,o]=P.useState("Pendiente");return u.jsxs("div",{className:"presu-form",children:[u.jsx("input",{className:"form-input",placeholder:"Procedimiento / plan",value:e,onChange:a=>n(a.target.value)}),u.jsx("input",{type:"number",className:"form-input",placeholder:"Costo",value:r,onChange:a=>s(a.target.value)}),u.jsxs("select",{className:"form-input",value:i,onChange:a=>o(a.target.value),children:[u.jsx("option",{children:"Pendiente"}),u.jsx("option",{children:"Aprobado"}),u.jsx("option",{children:"Rechazado"})]}),u.jsx("button",{type:"button",className:"btn blue",onClick:()=>{if(!e)return alert("Ttulo requerido");t({titulo:e,costo:Number(r||0),estado:i}),n(""),s(""),o("Pendiente")},children:"Agregar"})]})}function UU({onAdd:t}){const[e,n]=P.useState("");return u.jsxs("div",{className:"evo-form",children:[u.jsx("textarea",{className:"form-input",rows:2,placeholder:"Escribe la evolucin / remisin",value:e,onChange:r=>n(r.target.value)}),u.jsx("button",{type:"button",className:"btn blue",onClick:()=>{e.trim()&&(t(e.trim()),n(""))},children:"Guardar evolucin"})]})}function $U(){return u.jsxs("div",{style:{padding:"20px"},children:[u.jsx("h2",{children:"Mdulo de Facturacin"}),u.jsx("p",{children:"Aqu se registrarn los pagos, facturas y cobros."})]})}const pT=["Datos bsicos","Logo","Lista de precios","Planes","Consecutivos","Almacenes","Categoras inventario","Sucursales","Mtodos de pago","Bancos","Formulario de pacientes","Especialidades","Perfiles","Usuarios","Condiciones de pago","Parmetros","Recursos fsicos","Plantillas Doc. Clnicos","Pestaas Consulta Med.","Cargos","Impuestos","Catlogo de cuentas","Suscripcin"];function BU(t){return t.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/\./g,"").replace(/\s+/g,"-")}function zU({className:t="",basePath:e=""}){const[n,r]=P.useState(!1),[s,i]=P.useState(!1),[o,a]=P.useState(""),l=Ha(),d=P.useRef(null),h=P.useMemo(()=>{const C=o.trim().toLowerCase();return C?pT.filter(w=>w.toLowerCase().includes(C)):pT},[o]),f=()=>{const C=Math.max(document.documentElement.clientWidth||0,window.innerWidth||0);return C<640?C:C<1024?400:420},m=()=>{r(!0),requestAnimationFrame(()=>{i(!0),setTimeout(()=>{var C;return(C=d.current)==null?void 0:C.focus()},50)})},_=()=>{i(!1),setTimeout(()=>r(!1),200)},A=C=>{const w=BU(C),I=e?`${e}`:"";l(`${I}/config/${w}`,{state:{title:C}}),_()};P.useEffect(()=>{if(!n)return;const C=w=>w.key==="Escape"&&_();return window.addEventListener("keydown",C),()=>window.removeEventListener("keydown",C)},[n]);const R=()=>u.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none","aria-hidden":!0,children:u.jsx("path",{d:"M4 7h16M4 12h16M4 17h10",stroke:"#64748b",strokeWidth:"1.7",strokeLinecap:"round"})});return u.jsxs(u.Fragment,{children:[u.jsx("button",{title:"Configuracin",onClick:m,className:`oc-icon-btn ${t}`,"aria-label":"Abrir configuracin",type:"button",children:""}),n&&u.jsx("div",{style:{position:"fixed",inset:0,zIndex:5e3,background:"rgba(2,6,23,0.35)",backdropFilter:"blur(2px)",opacity:s?1:0,transition:"opacity .2s ease"},onClick:_,children:u.jsxs("aside",{role:"dialog","aria-modal":"true","aria-label":"Configuracin",style:{position:"absolute",left:0,top:0,height:"100%",width:f()+"px",background:"#ffffff",borderRight:"1px solid #e5e7eb",boxShadow:"0 20px 40px rgba(2,6,23,.18)",display:"flex",flexDirection:"column",transform:s?"translateX(0%)":"translateX(-100%)",transition:"transform .2s ease"},onClick:C=>C.stopPropagation(),children:[u.jsxs("div",{style:{position:"sticky",top:0,zIndex:1,background:"#ffffffcc",backdropFilter:"saturate(160%) blur(3px)",borderBottom:"1px solid #e5e7eb"},children:[u.jsxs("div",{style:{padding:"12px 16px",display:"flex",alignItems:"center",gap:10},children:[u.jsx("span",{style:{fontWeight:800,color:"#0f172a"},children:"Informacin general"}),u.jsx("span",{style:{marginLeft:"auto"}}),u.jsx("button",{onClick:_,style:{fontSize:"0.8rem",background:"#f3f4f6",border:"1px solid #e5e7eb",borderRadius:8,padding:"6px 12px",cursor:"pointer",color:"#0f172a",fontWeight:600},children:"Cerrar"})]}),u.jsxs("div",{style:{padding:"0 16px 12px 16px"},children:[u.jsx("input",{ref:d,value:o,onChange:C=>a(C.target.value),placeholder:"Buscar seccin",style:{width:"100%",border:"1px solid #d1d5db",borderRadius:10,padding:"10px 12px",fontSize:".95rem",outline:"none",color:"#0f172a",background:"#fff"}}),u.jsx("div",{style:{fontSize:".8rem",color:"#64748b",marginTop:6},children:"Filtra por nombre y haz clic para abrir la pantalla de configuracin."})]})]}),u.jsxs("nav",{style:{padding:"10px 12px 14px",overflowY:"auto",height:"100%"},children:[u.jsx("div",{style:{display:"grid",gridTemplateColumns:"1fr",gap:8},children:h.map(C=>u.jsxs("button",{onClick:()=>A(C),style:{display:"flex",alignItems:"center",gap:10,width:"100%",textAlign:"left",padding:"12px 12px",borderRadius:12,border:"1px solid #e5e7eb",background:"#ffffff",cursor:"pointer",fontSize:"0.95rem",fontWeight:700,color:"#0f172a",boxShadow:"0 1px 0 rgba(2,6,23,.04)",transition:"background .12s ease, border-color .12s ease, transform .06s ease"},onMouseEnter:w=>{w.currentTarget.style.background="#f9fafb",w.currentTarget.style.borderColor="#dbe2ea"},onMouseLeave:w=>{w.currentTarget.style.background="#ffffff",w.currentTarget.style.borderColor="#e5e7eb"},onMouseDown:w=>w.currentTarget.style.transform="scale(.995)",onMouseUp:w=>w.currentTarget.style.transform="scale(1)",children:[u.jsx("span",{style:{width:22,display:"inline-flex",justifyContent:"center"},children:u.jsx(R,{})}),u.jsx("span",{style:{flex:1},children:C}),u.jsx("span",{"aria-hidden":!0,style:{fontSize:12,color:"#94a3b8",fontWeight:700},children:""})]},C))}),h.length===0&&u.jsx("div",{style:{fontSize:".9rem",color:"#94a3b8",padding:12,textAlign:"center"},children:"Sin resultados"})]}),u.jsx("div",{style:{padding:"10px 14px",borderTop:"1px solid #e5e7eb",fontSize:".8rem",color:"#94a3b8"},children:"OdontoCloud  Preferencias del sistema"})]})})]})}const qU={"datos-basicos":"Datos bsicos",logo:"Logo","lista-de-precios":"Lista de precios",planes:"Planes",consecutivos:"Consecutivos",almacenes:"Almacenes","categorias-inventario":"Categoras inventario",sucursales:"Sucursales","metodos-de-pago":"Mtodos de pago",bancos:"Bancos","formulario-de-pacientes":"Formulario de pacientes",especialidades:"Especialidades",perfiles:"Perfiles",usuarios:"Usuarios","condiciones-de-pago":"Condiciones de pago",parametros:"Parmetros","recursos-fisicos":"Recursos fsicos","plantillas-doc-clinicos":"Plantillas Doc. Clnicos","pestanas-consulta-med":"Pestaas Consulta Med.",cargos:"Cargos",impuestos:"Impuestos","catalogo-de-cuentas":"Catlogo de cuentas",suscripcion:"Suscripcin"};function HU(){const{section:t}=fN(),{state:e}=lr(),n=(e==null?void 0:e.title)||qU[t]||"Configuracin";return u.jsx("div",{className:"oc-main-content",children:u.jsxs("section",{className:"oc-grid",children:[u.jsx("div",{className:"oc-grid-main",children:u.jsxs("div",{className:"card",children:[u.jsx("h3",{children:n}),u.jsx("div",{className:"mt-3 border rounded-lg p-4",children:u.jsxs("div",{className:"text-sm text-gray-700",children:["(Pendiente de implementar campos de ",u.jsx("b",{children:n}),")"]})})]})}),u.jsx("aside",{className:"oc-grid-side",children:u.jsxs("div",{className:"card",children:[u.jsx("h3",{children:"Ayuda"}),u.jsx("p",{className:"oc-muted",children:"Configura los parmetros generales del sistema."})]})})]})})}const jr=t=>(Number(t)||0).toLocaleString("es-CO",{maximumFractionDigits:0}),Lo=()=>new Date().toISOString().slice(0,10),WU=(t=new Date)=>new Date(t.getFullYear(),t.getMonth(),t.getDate(),0,0,0,0),KU=(t=new Date)=>new Date(t.getFullYear(),t.getMonth(),t.getDate()+1,0,0,0,0),mT=t=>Be.fromDate(t),GU=()=>{const[t,e]=P.useState(null);return P.useEffect(()=>{const n=Dy(bh,r=>e(r||null));return()=>n()},[]),t},$t=({children:t,align:e})=>u.jsx("th",{className:"oc-th",style:{position:"sticky",top:0,zIndex:1,textAlign:e||"left",background:"var(--oc-surface, #fff)"},children:t}),QU=()=>Math.random().toString(36).slice(2)+Math.random().toString(36).slice(2);function YU(){var be;const t=GU(),e=[{key:"abrir",label:"Abrir caja",icon:""},{key:"abiertas",label:"Cajas abiertas",icon:""},{key:"cerradas",label:"Cajas cerradas",icon:""},{key:"mio",label:"Mi caja (hoy)",icon:""},{key:"simulados",label:"Cierres simulados",icon:""},{key:"bancos",label:"Bancos",icon:""}],[n,r]=P.useState("abiertas"),[s,i]=P.useState(""),[o,a]=P.useState(""),l=P.useRef(null),[d,h]=P.useState(!1),[f,m]=P.useState(""),[_,A]=P.useState([]),[R,C]=P.useState(!0),[w,I]=P.useState([]),[b,x]=P.useState(!0),[L,$]=P.useState(null),[E,v]=P.useState(!0),[y,N]=P.useState(""),[D,j]=P.useState([]),[k,G]=P.useState(null),[We,Mt]=P.useState(""),[un,Z]=P.useState("efectivo"),[de,pe]=P.useState(!1),[Pe,Ge]=P.useState("ingreso"),[Pt,B]=P.useState(""),[re,ce]=P.useState(""),[xe,Se]=P.useState(!1),[De,we]=P.useState([]),[Ze,Ie]=P.useState([]);P.useEffect(()=>{const M=st($e(_e,"cajas"),Qe("estado","==","abierta"),gn("fechaApertura","desc")),Y=Fn(M,ie=>{A(ie.docs.map(ye=>se(ye.id,ye.data()))),C(!1),i("")},ie=>{console.error(ie),i((ie==null?void 0:ie.code)==="failed-precondition"?"Falta ndice (estado, fechaApertura) en Firestore.":(ie==null?void 0:ie.code)==="permission-denied"?"Permiso denegado en Firestore (revisa reglas).":"No se pudieron leer las cajas."),C(!1)});return()=>Y()},[]),P.useEffect(()=>{const M=st($e(_e,"cajas"),Qe("estado","==","cerrada"),gn("fechaCierre","desc")),Y=Fn(M,ie=>{I(ie.docs.map(ye=>se(ye.id,ye.data()))),x(!1)},ie=>{console.error(ie),x(!1)});return()=>Y()},[]),P.useEffect(()=>{if(!t){$(null),v(!1);return}v(!0);const M=st($e(_e,"cajas"),Qe("estado","==","abierta"),Qe("usuarioId","==",t.uid),Qe("fechaApertura",">=",mT(WU())),Qe("fechaApertura","<",mT(KU()))),Y=Fn(M,ie=>{const ye=ie.docs[0];$(ye?se(ye.id,ye.data()):null),v(!1)},ie=>{console.error(ie),v(!1),(ie==null?void 0:ie.code)==="failed-precondition"&&i("Falta ndice (estado, usuarioId, fechaApertura) en Firestore.")});return()=>Y()},[t]),P.useEffect(()=>{if(!(L!=null&&L.id)){we([]),Ie([]);return}const M=st($e(_e,"movimientos"),Qe("cashId","==",L.id),Qe("dia","==",Lo()),gn("fecha","desc")),Y=Fn(M,tt=>we(tt.docs.map(Xt=>({id:Xt.id,...Xt.data()}))),tt=>console.error(tt)),ie=st($e(_e,"payments"),Qe("cashId","==",L.id),Qe("dia","==",Lo()),gn("fecha","desc")),ye=Fn(ie,tt=>Ie(tt.docs.map(Xt=>({id:Xt.id,...Xt.data()}))),tt=>console.error(tt));return()=>{Y(),ye()}},[L==null?void 0:L.id]),P.useEffect(()=>{if(!(y!=null&&y.trim())){j([]);return}const M=st($e(_e,"patients"),Qe("q",">=",te(y)),Qe("q","<=",te(y)+""),gn("q","asc")),Y=Fn(M,ie=>j(ie.docs.map(ye=>({id:ye.id,...ye.data()}))),ie=>console.error(ie));return()=>Y()},[y]);function se(M,Y={}){const ie=Nt=>{var Ft;return((Ft=Nt==null?void 0:Nt.toDate)==null?void 0:Ft.call(Nt))||(typeof Nt=="string"?new Date(Nt):Nt||null)},ye=ie(Y.fechaApertura),tt=ie(Y.fechaCierre),Xt=Number(Y.baseInicial||0),Tn=Number(Y.baseActual!==void 0?Y.baseActual:Xt),xn=Number(Y.saldoInicial||0),Dn=Number(Y.saldoActual!==void 0?Y.saldoActual:xn),Jt=[];return Dn<0&&Jt.push("Saldo negativo"),Tn<0&&Jt.push("Base negativa"),{id:M,estado:Y.estado||"abierta",usuarioId:Y.usuarioId||"",usuarioNombre:Y.usuarioNombre||"Usuario",nombre:Y.nombre||Y.usuarioNombre||"Caja",fechaApertura:ye,fechaCierre:tt,baseInicial:Xt,baseActual:Tn,saldoInicial:xn,saldoActual:Dn,ia:Jt}}const Ne=async M=>{var Y;if((Y=M==null?void 0:M.preventDefault)==null||Y.call(M),!t){i("Debes iniciar sesin para abrir una caja.");return}h(!0);try{const ie=Number(f||0);await ra($e(_e,"cajas"),{estado:"abierta",usuarioId:t.uid,usuarioNombre:t.displayName||t.email||"Usuario",fechaApertura:Qn(),baseInicial:ie,baseActual:ie,saldoInicial:0,saldoActual:0,dia:Lo()}),m(""),r("mio"),i("")}catch(ie){console.error(ie),i("No se pudo abrir la caja.")}finally{h(!1)}},et=async M=>{try{await ga(Gt(_e,"cajas",M),{estado:"cerrada",fechaCierre:Qn()}),r("cerradas")}catch(Y){console.error(Y),i("No se pudo cerrar la caja.")}},Tt=async M=>{var ie;if((ie=M==null?void 0:M.preventDefault)==null||ie.call(M),!(L!=null&&L.id)){i("Debes abrir tu caja para registrar movimientos.");return}const Y=Number(re||0);if(!(!Y||Y<=0)){Se(!0);try{await ra($e(_e,"movimientos"),{cashId:L.id,tipo:Pe,concepto:Pt||(Pe==="ingreso"?"Ingreso":"Egreso"),valor:Y,fecha:Qn(),dia:Lo(),usuarioId:(t==null?void 0:t.uid)||null});const ye=Pe==="ingreso"?Y:-Y;await ga(Gt(_e,"cajas",L.id),{saldoActual:zI(ye)}),B(""),ce("")}catch(ye){console.error(ye),i("No se pudo registrar el movimiento.")}finally{Se(!1)}}},H=async M=>{var ie;if((ie=M==null?void 0:M.preventDefault)==null||ie.call(M),!(L!=null&&L.id))return i("Abre tu caja para cobrar.");const Y=Number(We||0);if(!(!Y||Y<=0)){if(!k)return i("Selecciona un paciente.");pe(!0);try{const ye=await ra($e(_e,"payments"),{cashId:L.id,patientId:k.id,patientName:k.nombre||k.name||"Paciente",invoiceId:null,valor:Y,medio:un,estado:"aprobado",fecha:Qn(),dia:Lo()});await ga(Gt(_e,"cajas",L.id),{saldoActual:zI(Y)}),Mt(""),Z("efectivo"),i(`Pago registrado (${ye.id}).`)}catch(ye){console.error(ye),i("No se pudo registrar el pago.")}finally{pe(!1)}}},ee=async M=>{var ie;if((ie=M==null?void 0:M.preventDefault)==null||ie.call(M),!(L!=null&&L.id))return i("Abre tu caja para cobrar.");const Y=Number(We||0);if(!(!Y||Y<=0)){if(!k)return i("Selecciona un paciente.");pe(!0);try{const tt=`https://pay.odontocloud/mock/${QU()}`,Xt=await ra($e(_e,"payments"),{cashId:L.id,patientId:k.id,patientName:k.nombre||k.name||"Paciente",invoiceId:null,valor:Y,medio:"link",estado:"pending",linkUrl:tt,fecha:Qn(),dia:Lo()});i(`Link de pago generado: ${tt}`),Mt("")}catch(ye){console.error(ye),i("No se pudo generar link de pago.")}finally{pe(!1)}}},te=M=>(M||"").toString().normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase(),q=P.useMemo(()=>{const M=te(o);return M?_.filter(Y=>[Y.nombre,Y.usuarioNombre,jr(Y.saldoActual),jr(Y.baseActual)].map(te).some(ie=>ie.includes(M))):_},[o,_]),ae=()=>u.jsxs("div",{className:"card",children:[u.jsx("div",{className:"oc-card-head",style:{marginBottom:8},children:u.jsx("h3",{children:"Abrir caja"})}),u.jsxs("form",{className:"oc-form",onSubmit:Ne,style:{display:"flex",gap:12,alignItems:"end",flexWrap:"wrap"},children:[u.jsxs("label",{style:{display:"inline-flex",flexDirection:"column",gap:6},children:[u.jsx("span",{children:"Base inicial (COP)"}),u.jsx("input",{type:"number",className:"oc-input",min:"0",step:"1000",value:f,onChange:M=>m(M.target.value),placeholder:"0"})]}),u.jsx("button",{className:"oc-btn",type:"submit",disabled:d,children:d?"Abriendo...":"Abrir caja"})]}),u.jsxs("p",{className:"oc-muted",style:{marginTop:8},children:["Se asociar a tu usuario y quedar visible en ",u.jsx("b",{children:"Mi caja (hoy)"}),"."]})]}),me=()=>u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"card",style:{marginBottom:10},children:u.jsxs("div",{className:"oc-card-head",style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[u.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[u.jsx("h3",{style:{margin:0},children:"Cajas Abiertas"}),u.jsx("span",{className:"oc-tag",children:q.length}),s&&u.jsx("span",{className:"oc-tag oc-tag-danger",children:s})]}),u.jsx("input",{ref:l,className:"oc-input",style:{maxWidth:280},placeholder:"Buscar...",value:o,onChange:M=>a(M.target.value)})]})}),u.jsx("div",{className:"card",children:u.jsx("div",{className:"oc-table-wrap",children:u.jsxs("table",{className:"oc-table",children:[u.jsx("thead",{className:"oc-thead",children:u.jsxs("tr",{className:"oc-tr",children:[u.jsx($t,{children:"Caja"}),u.jsx($t,{children:"Fecha apertura"}),u.jsx($t,{align:"right",children:"Base actual"}),u.jsx($t,{align:"right",children:"Saldo inicial"}),u.jsx($t,{align:"right",children:"Saldo actual"}),u.jsx($t,{children:"Usuario"}),u.jsx($t,{children:"Acciones"})]})}),u.jsx("tbody",{className:"oc-tbody",children:R?u.jsx(gT,{cols:7}):q.length===0?u.jsx("tr",{className:"oc-tr",children:u.jsx("td",{className:"oc-td",colSpan:7,children:u.jsx("span",{className:"oc-muted",children:"Sin cajas abiertas."})})}):q.map(M=>{var Y;return u.jsxs("tr",{className:"oc-tr",children:[u.jsxs("td",{className:"oc-td",children:[u.jsx("b",{children:M.nombre})," ",(Y=M.ia)!=null&&Y.length?u.jsx("span",{className:"oc-tag oc-tag-danger",title:M.ia.join("  "),children:"IA"}):null]}),u.jsx("td",{className:"oc-td",children:M.fechaApertura?M.fechaApertura.toLocaleString("es-CO"):""}),u.jsxs("td",{className:"oc-td",style:{textAlign:"right"},children:["$",jr(M.baseActual)]}),u.jsxs("td",{className:"oc-td",style:{textAlign:"right"},children:["$",jr(M.saldoInicial)]}),u.jsxs("td",{className:"oc-td",style:{textAlign:"right",color:M.saldoActual<0?"#b91c1c":void 0,fontWeight:600},children:["$",jr(M.saldoActual)]}),u.jsx("td",{className:"oc-td",children:M.usuarioNombre}),u.jsxs("td",{className:"oc-td",style:{whiteSpace:"nowrap"},children:[u.jsx("button",{className:"oc-small-btn",onClick:()=>r("mio"),children:"Ver"})," ",u.jsx("button",{className:"oc-small-btn oc-danger",onClick:()=>et(M.id),children:"Cerrar"})]})]},M.id)})})]})})})]}),ge=()=>u.jsxs("div",{className:"card",children:[u.jsxs("div",{className:"oc-card-head",style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[u.jsx("h3",{children:"Mi caja (hoy)"}),(L==null?void 0:L.estado)==="abierta"&&u.jsxs("div",{style:{display:"flex",gap:8},children:[u.jsx("span",{className:"oc-tag oc-tag-success",children:"Abierta"}),u.jsx("button",{className:"oc-small-btn oc-danger",onClick:()=>et(L.id),children:"Cerrar caja"})]})]}),E?u.jsx("div",{className:"oc-muted",children:"Cargando"}):L?u.jsxs(u.Fragment,{children:[u.jsxs("div",{className:"oc-stats-row",style:{marginBottom:12},children:[u.jsxs("div",{className:"stat-card",children:[u.jsx("span",{className:"stat-label",children:"Base actual"}),u.jsxs("span",{className:"stat-value",children:["$",jr(L.baseActual)]})]}),u.jsxs("div",{className:"stat-card",children:[u.jsx("span",{className:"stat-label",children:"Saldo actual"}),u.jsxs("span",{className:"stat-value",style:{color:L.saldoActual<0?"#b91c1c":void 0},children:["$",jr(L.saldoActual)]})]})]}),u.jsxs("div",{className:"card",style:{marginBottom:12},children:[u.jsx("h4",{style:{marginBottom:8},children:"Cobro rpido"}),u.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr auto",gap:8},children:[u.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:6},children:[u.jsx("label",{className:"oc-muted",children:"Paciente"}),u.jsx("input",{className:"oc-input",placeholder:"Buscar nombre o documento",value:y,onChange:M=>N(M.target.value)}),y&&D.length>0&&u.jsx("div",{className:"oc-dropdown",children:D.slice(0,6).map(M=>u.jsx("button",{className:`oc-menu-item ${(k==null?void 0:k.id)===M.id?"active":""}`,onClick:()=>{G(M),N(M.nombre||M.name||M.doc||"")},type:"button",children:(M.nombre||M.name||"Paciente")+(M.doc?`  ${M.doc}`:"")},M.id))})]}),u.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:6},children:[u.jsx("label",{className:"oc-muted",children:"Monto (COP)"}),u.jsx("input",{className:"oc-input",type:"number",min:"0",step:"1000",placeholder:"0",value:We,onChange:M=>Mt(M.target.value)})]}),u.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:6},children:[u.jsx("label",{className:"oc-muted",children:"Medio"}),u.jsxs("select",{className:"oc-input",value:un,onChange:M=>Z(M.target.value),children:[u.jsx("option",{value:"efectivo",children:"Efectivo"}),u.jsx("option",{value:"tarjeta",children:"Tarjeta"}),u.jsx("option",{value:"transferencia",children:"Transferencia"}),u.jsx("option",{value:"link",children:"Link (en lnea)"})]})]}),u.jsx("div",{style:{display:"flex",alignItems:"end",gap:6},children:un==="link"?u.jsx("button",{className:"oc-btn",onClick:ee,disabled:de,children:de?"Creando":"Generar link"}):u.jsx("button",{className:"oc-btn",onClick:H,disabled:de,children:de?"Guardando":"Registrar pago"})})]}),u.jsxs("p",{className:"oc-muted",style:{marginTop:8},children:["Para link, el saldo se actualiza cuando el pago pase a ",u.jsx("b",{children:"aprobado"})," (webhook)."]})]}),u.jsxs("div",{className:"card",style:{marginBottom:12},children:[u.jsx("h4",{style:{marginBottom:8},children:"Movimiento manual"}),u.jsxs("form",{onSubmit:Tt,style:{display:"grid",gridTemplateColumns:"120px 1fr 180px auto",gap:8},children:[u.jsxs("select",{className:"oc-input",value:Pe,onChange:M=>Ge(M.target.value),children:[u.jsx("option",{value:"ingreso",children:"Ingreso"}),u.jsx("option",{value:"egreso",children:"Egreso"})]}),u.jsx("input",{className:"oc-input",placeholder:"Concepto (ej. Caja chica, Arriendo, etc.)",value:Pt,onChange:M=>B(M.target.value)}),u.jsx("input",{className:"oc-input",type:"number",min:"0",step:"1000",placeholder:"0",value:re,onChange:M=>ce(M.target.value)}),u.jsx("button",{className:"oc-btn",disabled:xe,children:xe?"Guardando":"Agregar"})]})]}),u.jsxs("div",{className:"card",children:[u.jsx("h4",{style:{marginBottom:8},children:"Movimientos y pagos (hoy)"}),u.jsx("div",{className:"oc-table-wrap",style:{marginBottom:12},children:u.jsxs("table",{className:"oc-table",children:[u.jsx("thead",{className:"oc-thead",children:u.jsxs("tr",{className:"oc-tr",children:[u.jsx($t,{children:"Tipo"}),u.jsx($t,{children:"Concepto / Paciente"}),u.jsx($t,{children:"Medio"}),u.jsx($t,{children:"Estado"}),u.jsx($t,{align:"right",children:"Valor"}),u.jsx($t,{children:"Hora"})]})}),u.jsx("tbody",{className:"oc-tbody",children:De.length===0&&Ze.length===0?u.jsx("tr",{className:"oc-tr",children:u.jsx("td",{className:"oc-td",colSpan:6,children:u.jsx("span",{className:"oc-muted",children:"Sin movimientos ni pagos an."})})}):u.jsxs(u.Fragment,{children:[Ze.map(M=>{var Y,ie;return u.jsxs("tr",{className:"oc-tr",children:[u.jsx("td",{className:"oc-td",children:"Pago"}),u.jsxs("td",{className:"oc-td",children:[M.patientName||"Paciente"," ",M.linkUrl?u.jsx("a",{href:M.linkUrl,target:"_blank",rel:"noreferrer",children:"(link)"}):null]}),u.jsx("td",{className:"oc-td",children:M.medio}),u.jsx("td",{className:"oc-td",children:u.jsx("span",{className:`oc-tag ${M.estado==="aprobado"?"oc-tag-success":M.estado==="pending"?"oc-tag-warning":"oc-tag-danger"}`,children:M.estado})}),u.jsxs("td",{className:"oc-td",style:{textAlign:"right"},children:["$",jr(M.valor)]}),u.jsx("td",{className:"oc-td",children:(ie=(Y=M.fecha)==null?void 0:Y.toDate)!=null&&ie.call(Y)?M.fecha.toDate().toLocaleTimeString("es-CO"):""})]},`pay-${M.id}`)}),De.map(M=>{var Y,ie;return u.jsxs("tr",{className:"oc-tr",children:[u.jsx("td",{className:"oc-td",children:M.tipo}),u.jsx("td",{className:"oc-td",children:M.concepto}),u.jsx("td",{className:"oc-td",children:""}),u.jsx("td",{className:"oc-td",children:u.jsx("span",{className:"oc-tag",children:(M.tipo==="ingreso","ok")})}),u.jsxs("td",{className:"oc-td",style:{textAlign:"right"},children:["$",jr(M.valor)]}),u.jsx("td",{className:"oc-td",children:(ie=(Y=M.fecha)==null?void 0:Y.toDate)!=null&&ie.call(Y)?M.fecha.toDate().toLocaleTimeString("es-CO"):""})]},`mov-${M.id}`)})]})})]})}),u.jsx("p",{className:"oc-muted",children:"Sugerencia: crea ndice compuesto para `movimientos(cashId, dia, fecha)` y `payments(cashId, dia, fecha)` para rendimiento."})]})]}):u.jsxs("div",{className:"oc-empty",children:[u.jsx("p",{className:"oc-muted",children:"No tienes una caja abierta hoy."}),u.jsx("button",{className:"oc-btn",onClick:()=>r("abrir"),children:"Abrir caja"})]})]}),Fe=()=>u.jsxs("div",{className:"card",children:[u.jsx("div",{className:"oc-card-head",style:{marginBottom:8},children:u.jsxs("h3",{children:["Cajas cerradas ",u.jsx("span",{className:"oc-tag",children:w.length})]})}),u.jsx("div",{className:"oc-table-wrap",children:u.jsxs("table",{className:"oc-table",children:[u.jsx("thead",{className:"oc-thead",children:u.jsxs("tr",{className:"oc-tr",children:[u.jsx($t,{children:"Caja"}),u.jsx($t,{children:"Usuario"}),u.jsx($t,{children:"Apertura"}),u.jsx($t,{children:"Cierre"}),u.jsx($t,{align:"right",children:"Saldo final"})]})}),u.jsx("tbody",{className:"oc-tbody",children:b?u.jsx(gT,{cols:5}):w.length===0?u.jsx("tr",{className:"oc-tr",children:u.jsx("td",{className:"oc-td",colSpan:5,children:u.jsx("span",{className:"oc-muted",children:"Sin cajas cerradas."})})}):w.map(M=>u.jsxs("tr",{className:"oc-tr",children:[u.jsx("td",{className:"oc-td",children:M.nombre}),u.jsx("td",{className:"oc-td",children:M.usuarioNombre}),u.jsx("td",{className:"oc-td",children:M.fechaApertura?M.fechaApertura.toLocaleString("es-CO"):""}),u.jsx("td",{className:"oc-td",children:M.fechaCierre?M.fechaCierre.toLocaleString("es-CO"):""}),u.jsxs("td",{className:"oc-td",style:{textAlign:"right"},children:["$",jr(M.saldoActual)]})]},M.id))})]})})]}),Ae=()=>u.jsxs("div",{className:"card",children:[u.jsx("h3",{children:"Cierres simulados"}),u.jsx("p",{className:"oc-muted",children:"El cierre hipottico compara ventas y movimientos detectando errores y descuadres con IA. (Conectar fuente de datos para activarlo)."})]}),ze=()=>u.jsxs("div",{className:"card",children:[u.jsx("h3",{children:"Bancos"}),u.jsx("p",{className:"oc-muted",children:"Conciliacin de consignaciones/pagos electrnicos contra caja del da. (Conectar pasarela o extractos para habilitar)."})]}),je=({m:M})=>u.jsxs("button",{type:"button",onClick:()=>r(M.key),className:`oc-menu-item ${n===M.key?"active":""}`,style:{width:"100%",textAlign:"left",padding:"10px 12px",borderRadius:10,border:"1px solid transparent",background:n===M.key?"var(--oc-surface-2, #f3f6ff)":"transparent",fontWeight:600},title:M.label,children:[u.jsx("span",{style:{opacity:.8,marginRight:6},children:M.icon}),M.label]});return u.jsxs("div",{className:"oc-main-content",style:{display:"grid",gridTemplateColumns:"240px 1fr",gap:16},children:[u.jsx("aside",{className:"card",role:"navigation","aria-label":"Men de caja",style:{height:"fit-content",padding:12},children:u.jsx("div",{style:{display:"flex",flexDirection:"column",gap:8},children:e.map(M=>u.jsx(je,{m:M},M.key))})}),u.jsxs("section",{children:[u.jsx("div",{className:"card",style:{marginBottom:12,padding:12},children:u.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",gap:12},children:[u.jsxs("div",{className:"oc-breadcrumb",children:[u.jsx("span",{children:"Caja"}),u.jsx("span",{children:""}),u.jsx("b",{children:(be=e.find(M=>M.key===n))==null?void 0:be.label})]}),n==="abiertas"&&u.jsx("input",{ref:l,className:"oc-input",placeholder:"Buscar...",value:o,onChange:M=>a(M.target.value),style:{maxWidth:300}})]})}),n==="abrir"&&u.jsx(ae,{}),n==="abiertas"&&u.jsx(me,{}),n==="cerradas"&&u.jsx(Fe,{}),n==="mio"&&u.jsx(ge,{}),n==="simulados"&&u.jsx(Ae,{}),n==="bancos"&&u.jsx(ze,{})]})]})}function gT({cols:t=6,n:e=3}){return u.jsx(u.Fragment,{children:Array.from({length:e}).map((n,r)=>u.jsx("tr",{className:"oc-tr",children:Array.from({length:t}).map((s,i)=>u.jsx("td",{className:"oc-td",children:u.jsx("div",{style:{height:12,width:i===0?160:100+i%3*40,background:"var(--oc-skeleton, #e5e7eb)",borderRadius:6}})},i))},r))})}function XU({items:t=[]}){return u.jsxs("div",{className:"card activity-card",children:[u.jsx("h4",{children:"Actividad reciente"}),u.jsx("ul",{className:"activity-list",children:t.map(e=>u.jsxs("li",{children:[u.jsx("strong",{children:e.title}),u.jsx("div",{className:"time",children:e.time})]},e.id))})]})}function JU({status:t}){return t?u.jsxs("div",{className:"card",children:[u.jsx("h4",{children:"Automatizaciones (N8N)"}),u.jsxs("div",{className:"n8n-line",children:[u.jsx("strong",{children:"Conectado:"})," ",t.connected?"S":"No"]}),u.jsxs("div",{className:"n8n-line",children:[u.jsx("strong",{children:"Flujos activos:"})," ",t.flowsRunning]}),t.lastError&&u.jsxs("div",{className:"n8n-error",children:["Error: ",t.lastError]})]}):null}const Bp={es:{nav_home:"Inicio",nav_agenda:"Agenda",nav_patients:"Pacientes",nav_billing:"Facturacin",nav_inventory:"Inventario",nav_odontogram:"Odontograma",nav_reports:"Reportes",nav_cash:"Caja",nav_admin:"Administracin",welcomeTitle:"Bienvenido a OdontoCloud",welcomeSubtitle:"Administra tus pacientes, agenda, inventario y facturacin de manera inteligente y moderna.",clinicLabel:"Clnica",userLabel:"Usuario",roleLabel:"Rol",searchPlaceholder:"Buscar acciones o ir a",stats_patientsToday:"Pacientes totales",stats_appointmentsToday:"Citas hoy",stats_revenueToday:"Facturacin hoy",stats_waiting:"En espera",stats_currency:"COP",n8n_title:"Automatizaciones (n8n)",recent_title:"Actividad reciente",recent_empty:"Sin actividad registrada.",loading:"Cargando...",logout:"Cerrar sesin",module_coming:"Mdulo prximamente.",todays_appts:"Citas de hoy",see_schedule:"Ir a Agenda",no_appts_today:"No hay citas programadas hoy.",at:"a las"},en:{nav_home:"Overview",nav_agenda:"Schedule",nav_patients:"Patients",nav_billing:"Billing",nav_inventory:"Inventory",nav_odontogram:"Odontogram",nav_reports:"Reports",nav_cash:"Cash",nav_admin:"Administration",welcomeTitle:"Welcome to OdontoCloud",welcomeSubtitle:"Manage your patients, schedule, inventory and billing in a smart and modern way.",clinicLabel:"Clinic",userLabel:"User",roleLabel:"Role",searchPlaceholder:"Search actions or go to",stats_patientsToday:"Total patients",stats_appointmentsToday:"Appointments today",stats_revenueToday:"Revenue today",stats_waiting:"In waiting room",stats_currency:"COP",n8n_title:"Automations (n8n)",recent_title:"Recent activity",recent_empty:"No activity yet.",loading:"Loading...",logout:"Log out",module_coming:"Module coming soon.",todays_appts:"Today's appointments",see_schedule:"Open Schedule",no_appts_today:"No appointments today.",at:"at"}},WA=()=>typeof navigator>"u"||(navigator.language||navigator.userLanguage||"es").toLowerCase().startsWith("es")?"es":"en",ZU=()=>{try{const t=JSON.parse(localStorage.getItem("odc_session"));return t&&Date.now()-t.timestamp<1e3*60*60*24?t:null}catch{return null}},e6=()=>P.useMemo(()=>{const t=new Date,e=new Date(t.getFullYear(),t.getMonth(),t.getDate(),0,0,0,0),n=new Date(t.getFullYear(),t.getMonth(),t.getDate()+1,0,0,0,0);return{startToday:Be.fromDate(e),endToday:Be.fromDate(n),startTodayJS:e}},[]),t6=t=>`${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,"0")}-${String(t.getDate()).padStart(2,"0")}`,n6=(t,e)=>t.toLocaleTimeString(e==="es"?"es-CO":"en-US",{hour:"2-digit",minute:"2-digit"}),r6=(t,e)=>{try{const[n,r,s]=(t||"").split("-").map(a=>parseInt(a,10)),[i=0,o=0]=(e||"00:00").split(":").map(a=>parseInt(a,10));return new Date(n,(r||1)-1,s||1,i,o,0,0)}catch{return new Date}};function s6({data:t=[]}){const s=Math.max(1,...t.map(d=>Number(d.value)||0)),i=t.length||7,o=10,a=Math.max(16,Math.min(44,(640-o*(i+1))/i)),l=(a+o)*i+o;return u.jsx("div",{style:{width:"100%",overflowX:"auto"},children:u.jsxs("svg",{width:l,height:240,role:"img","aria-label":"Pacientes registrados por da en la ltima semana",children:[[.25,.5,.75,1].map((d,h)=>{const f=18+(1-d)*182;return u.jsx("line",{x1:0,x2:l,y1:f,y2:f,stroke:"#e5e7eb",strokeDasharray:"4 4"},h)}),t.map((d,h)=>{const f=Number(d.value)||0,m=Math.round(f/s*182),_=o+h*(a+o),A=200-m;return u.jsxs("g",{children:[u.jsx("rect",{x:_,y:A,width:a,height:m,rx:"6",ry:"6",fill:f>0?"#0ea5e9":"#cbd5e1",children:u.jsx("title",{children:`${d.label||d.shortLabel||""}  ${f} paciente${f!==1?"s":""}`})}),f>0&&m>14&&u.jsx("text",{x:_+a/2,y:A-6,textAnchor:"middle",fontSize:"11",fill:"#0f172a",children:f}),u.jsx("text",{x:_+a/2,y:214,textAnchor:"middle",fontSize:"11",fill:"#64748b",children:d.shortLabel||""})]},h)})]})})}function i6({onNavigate:t,onAction:e,placeholder:n}){const[r,s]=P.useState(""),[i,o]=P.useState(!1),[a,l]=P.useState(0),d=P.useRef(null),h=P.useMemo(()=>[{group:"Navegacin",label:"Ir a Inicio",keywords:"inicio home overview",run:()=>t==null?void 0:t("Inicio")},{group:"Navegacin",label:"Ir a Agenda",keywords:"agenda calendario schedule",run:()=>t==null?void 0:t("Agenda")},{group:"Navegacin",label:"Ir a Pacientes",keywords:"pacientes",run:()=>t==null?void 0:t("Pacientes")},{group:"Navegacin",label:"Ir a Facturacin",keywords:"facturacion facturas billing",run:()=>t==null?void 0:t("Facturacin")},{group:"Navegacin",label:"Ir a Inventario",keywords:"inventario stock",run:()=>t==null?void 0:t("Inventario")},{group:"Navegacin",label:"Ir a Odontograma",keywords:"odontograma",run:()=>t==null?void 0:t("Odontograma")},{group:"Navegacin",label:"Ir a Reportes",keywords:"reportes informes",run:()=>t==null?void 0:t("Reportes")},{group:"Acciones",label:"Nueva cita",keywords:"nueva cita agendar",run:()=>e==null?void 0:e("new_appointment")},{group:"Acciones",label:"Nuevo paciente",keywords:"nuevo paciente alta",run:()=>e==null?void 0:e("new_patient")},{group:"Acciones",label:"Nueva factura",keywords:"nueva factura",run:()=>e==null?void 0:e("new_invoice")},{group:"Acciones",label:"Exportar agenda",keywords:"exportar agenda",run:()=>e==null?void 0:e("export_agenda")},{group:"Acciones",label:"Ir a hoy (Agenda)",keywords:"hoy today",run:()=>e==null?void 0:e("agenda_today")},{group:"Acciones",label:"Cambiar modo oscuro",keywords:"oscuro dark mode",run:()=>e==null?void 0:e("toggle_dark")},{group:"Acciones",label:"Cerrar sesin",keywords:"logout salir cerrar",run:()=>e==null?void 0:e("logout")},{group:"Ayuda",label:"Ver atajos de teclado",keywords:"atajos ayuda",run:()=>e==null?void 0:e("show_shortcuts")},{group:"Ayuda",label:"Soporte / Contacto",keywords:"soporte ayuda contacto",run:()=>e==null?void 0:e("support")}],[t,e]),f=P.useMemo(()=>{const R=r.toLowerCase().trim();return R?h.filter(C=>C.label.toLowerCase().includes(R)||C.keywords.includes(R)):[]},[r,h]);P.useEffect(()=>{const R=C=>{d.current&&(d.current.contains(C.target)||o(!1))};return document.addEventListener("mousedown",R),()=>document.removeEventListener("mousedown",R)},[]);const m=R=>{var C;(C=R.run)==null||C.call(R),s(""),o(!1)},_=R=>{!i||f.length===0||(R.key==="ArrowDown"&&(R.preventDefault(),l(C=>(C+1)%f.length)),R.key==="ArrowUp"&&(R.preventDefault(),l(C=>(C-1+f.length)%f.length)),R.key==="Enter"&&(R.preventDefault(),f[a]&&m(f[a])),R.key==="Escape"&&o(!1))},A=P.useMemo(()=>{const R=new Map;return f.forEach(C=>{R.has(C.group)||R.set(C.group,[]),R.get(C.group).push(C)}),Array.from(R.entries())},[f]);return u.jsxs("div",{className:"oc-search-wrap",ref:d,children:[u.jsx("input",{className:"oc-search",type:"search",inputMode:"search",placeholder:n,"aria-label":n,value:r,onChange:R=>{s(R.target.value),o(!!R.target.value),l(0)},onFocus:()=>o(!!r),onKeyDown:_}),i&&u.jsx("div",{className:"oc-search-dropdown",role:"listbox","aria-label":"Resultados de comandos",children:A.length===0?u.jsx("div",{className:"oc-search-item empty",children:"Escribe para ver opciones"}):A.map(([R,C])=>u.jsxs("div",{children:[u.jsx("div",{className:"oc-search-group",children:R}),C.map(w=>{const I=f.indexOf(w);return u.jsx("button",{className:`oc-search-item ${I===a?"active":""}`,onMouseEnter:()=>l(I),onClick:()=>m(w),role:"option",children:u.jsx("span",{className:"oc-search-title",children:w.label})},w.label)})]},R))})]})}function o6({open:t,anchorRect:e,onClose:n,onSoon:r,onNavigatePath:s,onSetFactView:i,dark:o}){const[a,l]=P.useState(null),d=P.useRef(null);if(P.useEffect(()=>{if(!t)return;const G=Mt=>Mt.key==="Escape"&&(n==null?void 0:n()),We=()=>n==null?void 0:n();return window.addEventListener("keydown",G),window.addEventListener("scroll",We,!0),()=>{window.removeEventListener("keydown",G),window.removeEventListener("scroll",We,!0)}},[t,n]),!t)return null;const h=((e==null?void 0:e.bottom)||60)+8,f=Math.max(12,Math.min(((e==null?void 0:e.left)||300)-160,window.innerWidth-920)),m=10,_=f+360+m,A=o?"#0b1220":"#ffffff",R=o?"#e5e7eb":"#0f172a",C=o?"#0f1a32":"#f3f6ff",w=o?"#1f2a44":"#e2e8f0",I=o?"#b6c1d1":"#475569",b={position:"fixed",top:h,left:f,width:880,maxWidth:"calc(100vw - 24px)",background:A,color:R,borderRadius:14,boxShadow:"0 18px 40px rgba(2,6,23,.18)",border:`1px solid ${w}`,zIndex:400,padding:12},x={position:"fixed",top:h,left:_,width:420,maxWidth:"calc(100vw - 24px)",background:A,color:R,borderRadius:14,boxShadow:"0 18px 40px rgba(2,6,23,.18)",border:`1px solid ${w}`,zIndex:410,padding:12},L={display:"flex",flexDirection:"column",gap:6,padding:"8px 10px"},$={height:38,borderRadius:10,padding:"0 12px",display:"flex",alignItems:"center",gap:8,fontSize:".92rem",cursor:"pointer",border:"1px solid transparent",background:"transparent",color:R,fontWeight:500,textAlign:"left"},E=(G,We=!0)=>Object.assign(G.currentTarget.style,We?{background:C,borderColor:w}:{background:"transparent",borderColor:"transparent"}),v=()=>{d.current&&clearTimeout(d.current)},y=()=>{v(),d.current=setTimeout(()=>n==null?void 0:n(),180)},N={position:"fixed",top:h,left:f+360,width:m,height:520,zIndex:405},D=[{label:"Recibo de caja",key:"recibo",path:"facturacion/recibo"},{label:"Saldo a favor",key:"saldo",path:"facturacion/saldo"},{label:"Nota crdito",key:"nc",path:"facturacion/nc"},{label:"Nota dbito",key:"nd",path:"facturacion/nd"},{label:"Liquidaciones",key:"liq",path:"facturacion/liq"},{label:"Traslados",key:"tras",path:"facturacion/tras"},{label:"Pagos",key:"pagos",path:"facturacion/pagos"},{label:"rdenes de compra",key:"oc",path:"facturacion/oc"},{label:"Factura de venta",key:"fv",path:"facturacion/facturas"},{label:"Facturas de compra",key:"fc",path:"facturacion/fc"}],j=[{label:"RIPS anteriores (RS-3374)",key:"rips3374"},{label:"RIPS nuevo (RS-2275)",key:"rips2275"}],k=G=>{i==null||i(G.key),s==null||s(G.path),n==null||n()};return u.jsxs(u.Fragment,{children:[u.jsx("div",{onClick:n,style:{position:"fixed",inset:0,background:"transparent",zIndex:399}}),u.jsx("div",{style:b,onMouseEnter:v,onMouseLeave:y,children:u.jsxs("div",{style:{display:"grid",gridTemplateColumns:"360px 1fr",gap:8,alignItems:"start"},children:[u.jsxs("div",{style:L,children:[u.jsx("button",{type:"button",style:$,onMouseEnter:()=>{v(),l("facturacion")},onFocus:()=>{v(),l("facturacion")},onClick:()=>l(G=>G==="facturacion"?null:"facturacion"),onMouseOver:G=>E(G,!0),onMouseOut:G=>E(G,!1),children:" Facturacin "}),u.jsx("button",{type:"button",style:$,onMouseEnter:()=>{v(),l("rips")},onFocus:()=>{v(),l("rips")},onClick:()=>l(G=>G==="rips"?null:"rips"),onMouseOver:G=>E(G,!0),onMouseOut:G=>E(G,!1),children:" RIPS "}),u.jsx("button",{type:"button",style:$,onClick:()=>s==null?void 0:s("agenda"),onMouseOver:G=>E(G,!0),onMouseOut:G=>E(G,!1),children:" Gestin de agenda"}),u.jsx("button",{type:"button",style:$,onClick:()=>s==null?void 0:s("inventario"),onMouseOver:G=>E(G,!0),onMouseOut:G=>E(G,!1),children:" Inventario"}),u.jsx("button",{type:"button",style:$,onClick:()=>r==null?void 0:r(),onMouseOver:G=>E(G,!0),onMouseOut:G=>E(G,!1),children:" Convenios"}),u.jsx("button",{type:"button",style:$,onClick:()=>r==null?void 0:r(),onMouseOver:G=>E(G,!0),onMouseOut:G=>E(G,!1),children:" Terceros"}),u.jsx("button",{type:"button",style:$,onClick:()=>r==null?void 0:r(),onMouseOver:G=>E(G,!0),onMouseOut:G=>E(G,!1),children:" Campaas"}),u.jsx("button",{type:"button",style:$,onClick:()=>r==null?void 0:r(),onMouseOver:G=>E(G,!0),onMouseOut:G=>E(G,!1),children:" Temperatura y humedad"}),u.jsx("button",{type:"button",style:$,onClick:()=>r==null?void 0:r(),onMouseOver:G=>E(G,!0),onMouseOut:G=>E(G,!1),children:" Residuos"}),u.jsx("button",{type:"button",style:$,onClick:()=>r==null?void 0:r(),onMouseOver:G=>E(G,!0),onMouseOut:G=>E(G,!1),children:" Medicamentos y planes"}),u.jsx("button",{type:"button",style:$,onClick:()=>r==null?void 0:r(),onMouseOver:G=>E(G,!0),onMouseOut:G=>E(G,!1),children:" Esterilizacin"})]}),u.jsx("div",{style:L,children:u.jsxs("div",{style:{fontSize:".85rem",color:I},children:["Accesos rpidos a mdulos de administracin. Pasa el mouse por ",u.jsx("b",{children:"Facturacin"})," o ",u.jsx("b",{children:"RIPS"})," para ver sus acciones."]})})]})}),u.jsx("div",{style:N,onMouseEnter:v,onMouseLeave:y}),a&&u.jsx("div",{style:x,onMouseEnter:v,onMouseLeave:y,children:u.jsx("div",{style:{...L,display:"grid",gridTemplateColumns:"1fr"},children:(a==="facturacion"?D:j).map(G=>u.jsx("button",{type:"button",style:$,onClick:()=>a==="facturacion"?k(G):r==null?void 0:r(),onMouseOver:We=>E(We,!0),onMouseOut:We=>E(We,!1),children:G.label},G.label))})})]})}function a6({t,companyName:e,userName:n,role:r,darkMode:s,weeklySeries:i,weekRangeLabel:o,todaysAppointments:a,todaysLoading:l,metrics:d,metricsLoading:h,n8nState:f,n8nLoading:m,recent:_,recentLoading:A,onGoAgenda:R}){return u.jsxs("div",{className:"oc-main-content",children:[u.jsxs("section",{className:"oc-hero","aria-label":"Resumen general",children:[u.jsxs("div",{className:"oc-hero-text",children:[u.jsx("h1",{children:t("welcomeTitle")}),u.jsx("p",{children:t("welcomeSubtitle")}),u.jsxs("p",{className:"oc-hero-meta",children:[t("clinicLabel"),": ",e,"  ",t("userLabel"),": ",n,"  ",t("roleLabel"),": ",r||""]})]}),u.jsxs("div",{className:"oc-hero-badge","aria-live":"polite",children:[u.jsx("span",{className:"oc-hero-badge-title",children:t("stats_appointmentsToday")}),u.jsx("span",{className:"oc-hero-badge-value",children:h&&l?"":d.citasHoy}),u.jsxs("span",{className:"oc-hero-badge-sub",children:[t("stats_patientsToday"),": ",h?"":d.pacientesHoy]})]})]}),u.jsxs("section",{className:"oc-stats-row","aria-label":"Indicadores del da",children:[u.jsxs("div",{className:"stat-card",children:[u.jsx("span",{className:"stat-label",children:t("stats_patientsToday")}),u.jsx("span",{className:"stat-value",children:d.pacientesHoy})]}),u.jsxs("div",{className:"stat-card",children:[u.jsx("span",{className:"stat-label",children:t("stats_appointmentsToday")}),u.jsx("span",{className:"stat-value",children:d.citasHoy})]}),u.jsxs("div",{className:"stat-card",children:[u.jsx("span",{className:"stat-label",children:t("stats_revenueToday")}),u.jsxs("span",{className:"stat-value",children:[d.facturacionHoy.toLocaleString("es-CO")," ",u.jsx("span",{className:"stat-currency",children:t("stats_currency")})]})]}),u.jsxs("div",{className:"stat-card",children:[u.jsx("span",{className:"stat-label",children:t("stats_waiting")}),u.jsx("span",{className:"stat-value",children:d.enEspera})]})]}),u.jsxs("section",{className:"oc-grid","aria-label":"Contenido principal del dashboard",children:[u.jsx("div",{className:"oc-grid-main",children:u.jsxs("div",{className:"card card-quickcharts",children:[u.jsxs("div",{className:"oc-card-head",style:{display:"flex",justifyContent:"space-between",alignItems:"center",gap:8},children:[u.jsx("h3",{children:"Pacientes registrados  ltimos 7 das"}),u.jsx("span",{className:"oc-muted",style:{marginLeft:8,fontSize:12},children:o})]}),i.length===0||i.every(C=>((C==null?void 0:C.value)||0)===0)?u.jsx("p",{className:"oc-weekly-empty",children:"Sin pacientes registrados en la ltima semana."}):u.jsx(s6,{data:i})]})}),u.jsxs("aside",{className:"oc-grid-side","aria-label":"Panel lateral",children:[u.jsxs("div",{className:"card",children:[u.jsx("h3",{children:t("n8n_title")}),m?u.jsx("span",{className:"oc-muted",children:t("loading")}):u.jsx(JU,{status:f})]}),u.jsxs("div",{className:"card",children:[u.jsxs("div",{className:"oc-card-head",style:{display:"flex",justifyContent:"space-between",alignItems:"center",gap:8},children:[u.jsx("h3",{children:t("todays_appts")}),u.jsx("button",{className:"oc-small-link",type:"button",onClick:R,children:t("see_schedule")})]}),l?u.jsx("span",{className:"oc-muted",children:t("loading")}):a.length===0?u.jsx("p",{className:"oc-muted",children:t("no_appts_today")}):u.jsx("ul",{className:"oc-list",children:a.slice(0,5).map(C=>u.jsxs("li",{className:"oc-list-item",children:[u.jsxs("div",{className:"oc-list-main",children:[u.jsx("b",{children:C.pacienteNombre||"Paciente"})," ",u.jsxs("span",{className:"oc-muted",children:[t("at")," ",n6(C.fecha,WA())]})]}),u.jsx("div",{className:`oc-tag oc-tag-${(C.estado||"programada").toLowerCase().replace(/\s+/g,"-")}`,children:C.estado||"programada"})]},C.id))})]}),u.jsxs("div",{className:"card",children:[u.jsx("h3",{children:"Actividad reciente"}),A?u.jsx("span",{className:"oc-muted",children:t("loading")}):_.length===0?u.jsx("p",{className:"oc-muted",children:t("recent_empty")}):u.jsx(XU,{items:_})]})]})]}),u.jsxs("footer",{className:"oc-footer",children:[" ",new Date().getFullYear()," OdontoCloud | Creado por Ingeniero Juan Madrid"]})]})}function zp(){const t=Ha(),e=lr(),[n]=P.useState(WA()),r=H=>Bp[n][H]||H,[s,i]=P.useState("Inicio"),[o,a]=P.useState("recibo"),[l,d]=P.useState(()=>{try{return localStorage.getItem("odontocloud:dark")==="1"}catch{return!1}});P.useEffect(()=>{try{localStorage.setItem("odontocloud:dark",l?"1":"0")}catch{}document.documentElement.classList.toggle("dark",l)},[l]);const[h]=P.useState(()=>ZU()),[f]=P.useState((h==null?void 0:h.rol)||""),[m]=P.useState((h==null?void 0:h.email)||""),[_,A]=P.useState("OdontoCloud"),[R,C]=P.useState(m||"Usuario"),[w,I]=P.useState(!0);P.useEffect(()=>{const H=Dy(bh,async ee=>{try{if(!ee){C(m||"Usuario"),A("OdontoCloud"),I(!1);return}C(ee.displayName||ee.email||m||"Usuario");const te=Gt(_e,"empresas",ee.uid),q=await Ih(te);A(q.exists()&&q.data().nombre||"OdontoCloud")}catch(te){console.error("Error cargando empresa/usuario:",te)}finally{I(!1)}});return()=>H()},[m]);const[b,x]=P.useState({pacientesHoy:0,citasHoy:0,facturacionHoy:0,enEspera:0}),[L,$]=P.useState(!0),[E,v]=P.useState([]),[y,N]=P.useState([]),[D,j]=P.useState(!0),{startToday:k,endToday:G,startTodayJS:We}=e6(),Mt=P.useMemo(()=>t6(We),[We]),un=P.useMemo(()=>{const H=new Date,ee=new Date(H.getFullYear(),H.getMonth(),H.getDate()-6),te=H,q=ae=>ae.toLocaleDateString(n==="es"?"es-ES":"en-US",{weekday:"short",day:"2-digit",month:"short"}).replace(".","");return`${q(ee)}  ${q(te)}`},[n]),Z=H=>{var me;const ee=H.data()||{};let te;if((me=ee.fecha)!=null&&me.toDate){te=ee.fecha.toDate();const ge=ee.horaInicio||ee.hora;if(ge&&typeof ge=="string"){const[Fe=0,Ae=0]=ge.split(":").map(ze=>parseInt(ze,10));te.setHours(Fe||0,Ae||0,0,0)}}else if(typeof ee.fecha=="string"){const ge=ee.horaInicio||ee.hora||"00:00";te=r6(ee.fecha,ge)}else te=new Date;const q=ee.pacienteNombre||ee.paciente||"Paciente",ae=ee.estado&&String(ee.estado)||"programada";return{id:H.id,fecha:te,pacienteId:ee.pacienteId||"",pacienteNombre:q,estado:ae,motivo:ee.motivo||""}};P.useEffect(()=>{const H=st($e(_e,"citas"),Qe("fecha",">=",k),Qe("fecha","<",G),gn("fecha","asc")),ee=st($e(_e,"citas"),Qe("fecha","==",Mt));let te=new Map,q=!1,ae=!1;const me=()=>{const Ae=Array.from(te.values()).sort((je,be)=>je.fecha.getTime()-be.fecha.getTime()),ze=Ae.filter(je=>String(je.estado).toLowerCase().trim()==="en espera").length;N(Ae),x(je=>({...je,citasHoy:Ae.length,enEspera:ze})),q&&ae&&j(!1)},ge=Fn(H,Ae=>{q=!0;const ze=new Map(te);Ae.docs.forEach(je=>ze.set(je.id,Z(je))),te=ze,me()},Ae=>{console.error("Realtime citas hoy (TS):",Ae),q=!0,me()}),Fe=Fn(ee,Ae=>{ae=!0;const ze=new Map(te);Ae.docs.forEach(je=>ze.set(je.id,Z(je))),te=ze,me()},Ae=>{console.error("Realtime citas hoy (STR):",Ae),ae=!0,me()});return()=>{try{ge(),Fe()}catch{}}},[k,G,Mt]),P.useEffect(()=>{(async()=>{try{const te=(await VM($e(_e,"pacientes"))).data().count||0;let q=0;try{const ae=st($e(_e,"facturas"),Qe("fecha",">=",k),Qe("fecha","<",G));(await pn(ae)).forEach(ge=>{const Fe=ge.data();typeof Fe.monto=="number"&&(q+=Fe.monto)})}catch{q=0}x(ae=>({...ae,pacientesHoy:te,facturacionHoy:q}))}catch(ee){console.error("Error cargando mtricas:",ee),x(te=>({...te,pacientesHoy:0,facturacionHoy:0}))}finally{$(!1)}})()},[k,G]),P.useEffect(()=>{const H=new Date,ee=new Date(H.getFullYear(),H.getMonth(),H.getDate()-6),te=new Date(H.getFullYear(),H.getMonth(),H.getDate()+1),q=new Map;for(let ge=0;ge<7;ge++){const Fe=new Date(H.getFullYear(),H.getMonth(),H.getDate()-(6-ge)),Ae=Fe.toISOString().slice(0,10),ze=Fe.toLocaleDateString(n==="es"?"es-ES":"en-US"),je=Fe.toLocaleDateString(n==="es"?"es-ES":"en-US",{weekday:"short",day:"2-digit"}).replace(".","");q.set(Ae,{label:ze,shortLabel:je,value:0})}const ae=st($e(_e,"pacientes"),Qe("createdAt",">=",Be.fromDate(ee)),Qe("createdAt","<",Be.fromDate(te))),me=Fn(ae,ge=>{const Fe=new Map(q);ge.docs.forEach(Ae=>{var Y;const ze=Ae.data()||{},je=(Y=Ae.data().createdAt)!=null&&Y.toDate?Ae.data().createdAt.toDate():ze.createdAt?new Date(ze.createdAt):null;if(!je||isNaN(je))return;const be=je.toISOString().slice(0,10);if(!Fe.has(be))return;const M=Fe.get(be);M.value+=1,Fe.set(be,M)}),v(Array.from(Fe.values()))},ge=>{console.error("Error realtime serie semanal (pacientes):",ge),v(Array.from(q.values()))});return()=>{try{me()}catch{}}},[n]);const[de,pe]=P.useState([]),[Pe,Ge]=P.useState(!0);P.useEffect(()=>{(async()=>{try{const ee=st($e(_e,"actividad"),gn("fecha","desc"),ma(5)),te=await pn(ee);pe(te.docs.map(q=>({id:q.id,title:q.data().descripcion||q.data().titulo||"Actividad",time:q.data().resumenTiempo||""})))}catch(ee){console.error("Error cargando actividad:",ee),pe([])}finally{Ge(!1)}})()},[]);const[Pt,B]=P.useState(null),[re,ce]=P.useState(!0);P.useEffect(()=>{(async()=>{try{const ee=Gt(_e,"integraciones","n8n"),te=await Ih(ee);B(te.exists()?{connected:!!te.data().connected,flowsRunning:te.data().flowsRunning||0,lastError:te.data().lastError||null}:{connected:!1,flowsRunning:0,lastError:null})}catch(ee){console.error("Error cargando estado n8n:",ee),B({connected:!1,flowsRunning:0,lastError:"No se pudo leer el estado desde Firebase."})}finally{ce(!1)}})()},[]);const xe=async()=>{try{localStorage.removeItem("odc_session")}catch{}try{await Bj(bh)}catch(H){console.error("Error al cerrar sesin:",H)}window.location.href="/"},[Se,De]=P.useState(!1),[we,Ze]=P.useState(null),Ie=P.useRef(null);P.useRef(null);const se=()=>{var ee,te;const H=(te=(ee=Ie.current)==null?void 0:ee.getBoundingClientRect)==null?void 0:te.call(ee);Ze(H),De(!0)};P.useEffect(()=>{const H=e.pathname.toLowerCase(),ee=H.includes("/pacientes"),te=H.includes("/caja"),q=H.includes("/agenda"),ae=H.includes("/facturacion"),me=H.includes("/inventario"),ge=H.includes("/odontograma"),Fe=H.includes("/reportes"),Ae=H.includes("/config");i(ee?"Pacientes":te?"Caja":q?"Agenda":me?"Inventario":ge?"Odontograma":Fe?"Reportes":Ae?"Config":"Inicio"),ae&&(i("Facturacin"),H.includes("/pagos")?a("pagos"):H.includes("/facturas")?a("fv"):H.includes("/recibo")?a("recibo"):H.includes("/saldo")?a("saldo"):H.includes("/nc")?a("nc"):H.includes("/nd")?a("nd"):H.includes("/liq")?a("liq"):H.includes("/tras")?a("tras"):H.includes("/oc")?a("oc"):H.includes("/fc")?a("fc"):a("recibo"))},[e.pathname]);const Ne=P.useMemo(()=>{const H=e.pathname.split("/").filter(Boolean),ee=H.findIndex(te=>te.startsWith("dashboard_"));return ee>=0?`/${H.slice(0,ee+1).join("/")}`:""},[e.pathname]),et=(H="")=>{const ee=String(H).replace(/^\/+|\/+$/g,""),te=ee?`${Ne}/${ee}`:Ne||"/",q=e.pathname.toLowerCase()===te.toLowerCase();t(te,{replace:q})},Tt=()=>{switch(s){case"Agenda":return u.jsx(RU,{});case"Pacientes":return u.jsx(P.Suspense,{fallback:u.jsx("div",{style:{padding:16},children:"Cargando"}),children:u.jsx(MU,{})});case"Facturacin":return u.jsx(PU,{view:o});case"Inventario":return u.jsx(NU,{});case"Odontograma":return u.jsx(kU,{});case"Reportes":return u.jsx($U,{});case"Caja":return u.jsx(YU,{});case"Config":return u.jsx(HU,{});case"Inicio":default:return null}};return u.jsxs("div",{className:`oc-shell ${l?"oc-dark":""}`,children:[u.jsx("a",{href:"#oc-main",className:"oc-skip-link",children:"Saltar al contenido"}),u.jsxs("header",{className:"oc-header",role:"banner",children:[u.jsxs("div",{className:"oc-header-left",children:[u.jsx("img",{src:xA,alt:"OdontoCloud",className:"oc-logo"}),u.jsxs("div",{className:"oc-brand-text",children:[u.jsx("span",{className:"oc-brand-main",children:"OdontoCloud"}),u.jsx("span",{className:"oc-brand-sub",children:w?"...":_})]})]}),u.jsxs("nav",{className:"oc-nav",role:"navigation","aria-label":"Navegacin principal",children:[u.jsx(Fo,{to:Ne,end:!0,className:({isActive:H})=>H&&s==="Inicio"?"oc-nav-btn active":"oc-nav-btn",title:r("nav_home"),children:r("nav_home")}),u.jsx(Fo,{to:`${Ne}/agenda`,className:({isActive:H})=>H||s==="Agenda"?"oc-nav-btn active":"oc-nav-btn",title:r("nav_agenda"),children:r("nav_agenda")}),u.jsx(Fo,{to:`${Ne}/pacientes`,className:({isActive:H})=>H||s==="Pacientes"?"oc-nav-btn active":"oc-nav-btn",title:r("nav_patients"),children:r("nav_patients")}),u.jsx(Fo,{to:`${Ne}/caja`,className:({isActive:H})=>H||s==="Caja"?"oc-nav-btn active":"oc-nav-btn",title:r("nav_cash"),children:r("nav_cash")}),u.jsx("button",{type:"button",ref:Ie,className:"oc-nav-btn",title:r("nav_admin"),"aria-haspopup":"true","aria-expanded":Se,onClick:()=>Se?De(!1):se(),onMouseEnter:()=>se(),onFocus:()=>se(),children:r("nav_admin")}),u.jsx(Fo,{to:`${Ne}/reportes`,className:({isActive:H})=>H||s==="Reportes"?"oc-nav-btn active":"oc-nav-btn",title:r("nav_reports"),children:r("nav_reports")})]}),u.jsxs("div",{className:"oc-header-right",children:[u.jsx(i6,{placeholder:r("searchPlaceholder"),onNavigate:H=>{H==="Inicio"?et(""):H==="Facturacin"?(a("recibo"),et("facturacion/recibo")):et(H.toLowerCase())},onAction:H=>{switch(H){case"new_appointment":case"agenda_today":case"export_agenda":et("agenda");break;case"new_patient":et("pacientes");break;case"new_invoice":a("fv"),et("facturacion/facturas");break;case"toggle_dark":d(ee=>!ee);break;case"logout":xe();break;case"show_shortcuts":alert("Atajos: Ctrl/Cmd + K para abrir bsqueda, / para moverse, Enter para ejecutar.");break;case"support":window.open("https://tu-soporte.odc","_blank");break}}}),u.jsx(zU,{basePath:Ne,className:"ml-2"}),u.jsx("button",{className:"oc-icon-btn",type:"button",onClick:()=>d(H=>!H),"aria-pressed":l,title:l?"Activar modo claro":"Activar modo oscuro",children:l?"":""}),u.jsx("button",{className:"oc-icon-btn",type:"button",onClick:xe,title:Bp[n].logout,children:Bp[n].logout})]})]}),u.jsx(o6,{open:Se,anchorRect:we,dark:l,onClose:()=>De(!1),onSoon:()=>{alert("Prximamente"),De(!1)},onNavigatePath:H=>{et(H),De(!1)},onSetFactView:H=>a(H)}),u.jsxs("main",{id:"oc-main",className:"oc-main-wrapper",role:"main",children:[s!=="Inicio"&&Tt(),s==="Inicio"&&u.jsx(a6,{t:r,companyName:_,userName:R,role:f,darkMode:l,weeklySeries:E,weekRangeLabel:un,todaysAppointments:y,todaysLoading:D,metrics:b,metricsLoading:L,n8nState:Pt,n8nLoading:re,recent:de,recentLoading:Pe,onGoAgenda:()=>et("agenda")})]})]})}const KA=()=>{try{const t=JSON.parse(localStorage.getItem("odc_session"));return t&&Date.now()-t.timestamp<1e3*60*60*24?t:null}catch{return null}},GA=t=>{const e=(t||"").toLowerCase();return e==="administrador"?"/dashboard_admin":e==="doctor"?"/dashboard_doctor":e==="recepcionista"?"/dashboard_recepcion":"/"};function qp({allowedRoles:t,children:e}){var s;const n=KA();if(!n)return u.jsx(Qd,{to:"/",replace:!0});const r=(s=n.rol)==null?void 0:s.toLowerCase();return t.map(i=>i.toLowerCase()).includes(r)?e:u.jsx(Qd,{to:GA(n.rol),replace:!0})}function l6(){const t=KA();return u.jsxs(AN,{children:[u.jsx(Mo,{path:"/",element:t?u.jsx(Qd,{to:GA(t.rol),replace:!0}):u.jsx(s4,{})}),u.jsx(Mo,{path:"/dashboard_admin/*",element:u.jsx(qp,{allowedRoles:["administrador"],children:u.jsx(zp,{})})}),u.jsx(Mo,{path:"/dashboard_doctor/*",element:u.jsx(qp,{allowedRoles:["doctor"],children:u.jsx(zp,{})})}),u.jsx(Mo,{path:"/dashboard_recepcion/*",element:u.jsx(qp,{allowedRoles:["recepcionista"],children:u.jsx(zp,{})})}),u.jsx(Mo,{path:"*",element:u.jsx(Qd,{to:"/",replace:!0})})]})}async function c6(){try{await Fj(bh,FS),await wM(_e),console.log(" Firebase listo con sesin persistente y modo offline.")}catch(t){console.warn(" Firebase offline/persistencia fall:",t.message)}}const u6="modulepreload",d6=function(t){return"/odontocloud-react/"+t},yT={},h6=function(e,n,r){let s=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),a=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));s=Promise.allSettled(n.map(l=>{if(l=d6(l),l in yT)return;yT[l]=!0;const d=l.endsWith(".css"),h=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${h}`))return;const f=document.createElement("link");if(f.rel=d?"stylesheet":u6,d||(f.as="script"),f.crossOrigin="",f.href=l,a&&f.setAttribute("nonce",a),document.head.appendChild(f),d)return new Promise((m,_)=>{f.addEventListener("load",m),f.addEventListener("error",()=>_(new Error(`Unable to preload CSS for ${l}`)))})}))}function i(o){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=o,window.dispatchEvent(a),!a.defaultPrevented)throw o}return s.then(o=>{for(const a of o||[])a.status==="rejected"&&i(a.reason);return e().catch(i)})};function f6(t={}){const{immediate:e=!1,onNeedRefresh:n,onOfflineReady:r,onRegistered:s,onRegisteredSW:i,onRegisterError:o}=t;let a,l;const d=async(f=!0)=>{await l};async function h(){if("serviceWorker"in navigator){if(a=await h6(async()=>{const{Workbox:f}=await import("./workbox-window.prod.es5-vqzQaGvo.js");return{Workbox:f}},[]).then(({Workbox:f})=>new f("/odontocloud-react/sw.js",{scope:"/odontocloud-react/",type:"classic"})).catch(f=>{o==null||o(f)}),!a)return;a.addEventListener("activated",f=>{(f.isUpdate||f.isExternal)&&window.location.reload()}),a.addEventListener("installed",f=>{f.isUpdate||r==null||r()}),a.register({immediate:e}).then(f=>{i?i("/odontocloud-react/sw.js",f):s==null||s(f)}).catch(f=>{o==null||o(f)})}}return l=h(),d}const p6="/odontocloud-react/";c6();f6({immediate:!0});D0(document.getElementById("root")).render(u.jsx(PT.StrictMode,{children:u.jsx(XN,{basename:p6,children:u.jsx(l6,{})})}));
